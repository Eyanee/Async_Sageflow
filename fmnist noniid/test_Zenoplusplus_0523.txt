
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 100

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5104796290397644
distance x is tensor(108.5121, device='cuda:3')
benign distance is  tensor(108.5121, device='cuda:3')
norm1 res is  tensor(0.1245, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.810060977935791
distance x is tensor(117.6999, device='cuda:3')
benign distance is  tensor(117.6999, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.5745405554771423
distance x is tensor(124.2834, device='cuda:3')
benign distance is  tensor(124.2834, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6813650131225586
distance x is tensor(114.2250, device='cuda:3')
benign distance is  tensor(114.2250, device='cuda:3')
norm1 res is  tensor(0.1295, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  1.020298719406128
distance x is tensor(113.3258, device='cuda:3')
benign distance is  tensor(113.3258, device='cuda:3')
norm1 res is  tensor(0.1302, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3340436816215515
distance x is tensor(119.7480, device='cuda:3')
benign distance is  tensor(119.7480, device='cuda:3')
norm1 res is  tensor(0.1381, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.6779212951660156
distance x is tensor(109.0127, device='cuda:3')
benign distance is  tensor(109.0127, device='cuda:3')
norm1 res is  tensor(0.1236, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.7326038479804993
distance x is tensor(121.1697, device='cuda:3')
benign distance is  tensor(121.1697, device='cuda:3')
norm1 res is  tensor(0.1428, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.2733074724674225
distance x is tensor(133.8256, device='cuda:3')
benign distance is  tensor(133.8256, device='cuda:3')
norm1 res is  tensor(0.1545, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.6834940314292908
distance x is tensor(145.9111, device='cuda:3')
benign distance is  tensor(145.9111, device='cuda:3')
norm1 res is  tensor(0.1653, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.6356474161148071
distance x is tensor(123.6275, device='cuda:3')
benign distance is  tensor(123.6275, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.24726662039756775
distance x is tensor(123.3176, device='cuda:3')
benign distance is  tensor(123.3176, device='cuda:3')
norm1 res is  tensor(0.1447, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.7235208749771118
distance x is tensor(132.8028, device='cuda:3')
benign distance is  tensor(132.8028, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.27129101753234863
distance x is tensor(142.9903, device='cuda:3')
benign distance is  tensor(142.9903, device='cuda:3')
norm1 res is  tensor(0.1666, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.7303743958473206
distance x is tensor(137.9458, device='cuda:3')
benign distance is  tensor(137.9458, device='cuda:3')
norm1 res is  tensor(0.1598, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.38519707322120667
distance x is tensor(136.5021, device='cuda:3')
benign distance is  tensor(136.5021, device='cuda:3')
norm1 res is  tensor(0.1576, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.26603856682777405
distance x is tensor(128.1085, device='cuda:3')
benign distance is  tensor(128.1085, device='cuda:3')
norm1 res is  tensor(0.1476, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.6492247581481934
distance x is tensor(144.1451, device='cuda:3')
benign distance is  tensor(144.1451, device='cuda:3')
norm1 res is  tensor(0.1678, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.7117961645126343
distance x is tensor(127.6926, device='cuda:3')
benign distance is  tensor(127.6926, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.5927656888961792
distance x is tensor(128.5847, device='cuda:3')
benign distance is  tensor(128.5847, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.1767982542514801
distance x is tensor(125.2466, device='cuda:3')
benign distance is  tensor(125.2466, device='cuda:3')
norm1 res is  tensor(0.1429, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.23373909294605255
distance x is tensor(127.2234, device='cuda:3')
benign distance is  tensor(127.2234, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.451022207736969
distance x is tensor(138.3242, device='cuda:3')
benign distance is  tensor(138.3242, device='cuda:3')
norm1 res is  tensor(0.1588, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  1.0744155645370483
distance x is tensor(131.1663, device='cuda:3')
benign distance is  tensor(131.1663, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.437946617603302
distance x is tensor(140.2657, device='cuda:3')
benign distance is  tensor(140.2657, device='cuda:3')
norm1 res is  tensor(0.1623, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.5187896490097046
distance x is tensor(120.9570, device='cuda:3')
benign distance is  tensor(120.9570, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.6813775300979614
distance x is tensor(142.1255, device='cuda:3')
benign distance is  tensor(142.1255, device='cuda:3')
norm1 res is  tensor(0.1624, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.2966426908969879
distance x is tensor(141.5715, device='cuda:3')
benign distance is  tensor(141.5715, device='cuda:3')
norm1 res is  tensor(0.1601, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.5169304013252258
distance x is tensor(122.4110, device='cuda:3')
benign distance is  tensor(122.4110, device='cuda:3')
norm1 res is  tensor(0.1401, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.5133460164070129
distance x is tensor(133.8605, device='cuda:3')
benign distance is  tensor(133.8605, device='cuda:3')
norm1 res is  tensor(0.1564, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.8932298421859741
distance x is tensor(123.9767, device='cuda:3')
benign distance is  tensor(123.9767, device='cuda:3')
norm1 res is  tensor(0.1453, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.8721550107002258
distance x is tensor(132.9537, device='cuda:3')
benign distance is  tensor(132.9537, device='cuda:3')
norm1 res is  tensor(0.1588, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.40402722358703613
distance x is tensor(137.6805, device='cuda:3')
benign distance is  tensor(137.6805, device='cuda:3')
norm1 res is  tensor(0.1567, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.3861083984375
distance x is tensor(128.2346, device='cuda:3')
benign distance is  tensor(128.2346, device='cuda:3')
norm1 res is  tensor(0.1483, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.34378233551979065
distance x is tensor(141.7650, device='cuda:3')
benign distance is  tensor(141.7650, device='cuda:3')
norm1 res is  tensor(0.1664, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.08587781339883804
distance x is tensor(129.5688, device='cuda:3')
benign distance is  tensor(129.5688, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.4769926965236664
distance x is tensor(130.2703, device='cuda:3')
benign distance is  tensor(130.2703, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.4516738951206207
distance x is tensor(128.4728, device='cuda:3')
benign distance is  tensor(128.4728, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.2364485263824463
distance x is tensor(126.9716, device='cuda:3')
benign distance is  tensor(126.9716, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.1867228001356125
distance x is tensor(127.1844, device='cuda:3')
benign distance is  tensor(127.1844, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.10562700033187866
distance x is tensor(124.5164, device='cuda:3')
benign distance is  tensor(124.5164, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.34677597880363464
distance x is tensor(122.0320, device='cuda:3')
benign distance is  tensor(122.0320, device='cuda:3')
norm1 res is  tensor(0.1402, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.07829561084508896
distance x is tensor(131.2839, device='cuda:3')
benign distance is  tensor(131.2839, device='cuda:3')
norm1 res is  tensor(0.1505, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.33636826276779175
distance x is tensor(130.2374, device='cuda:3')
benign distance is  tensor(130.2374, device='cuda:3')
norm1 res is  tensor(0.1477, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.3478294014930725
distance x is tensor(142.3081, device='cuda:3')
benign distance is  tensor(142.3081, device='cuda:3')
norm1 res is  tensor(0.1610, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.6792527437210083
distance x is tensor(126.7808, device='cuda:3')
benign distance is  tensor(126.7808, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.9762026071548462
distance x is tensor(137.5315, device='cuda:3')
benign distance is  tensor(137.5315, device='cuda:3')
norm1 res is  tensor(0.1573, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.11401593685150146
distance x is tensor(135.5177, device='cuda:3')
benign distance is  tensor(135.5177, device='cuda:3')
norm1 res is  tensor(0.1566, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(109.9422, device='cuda:3')
compute distance is  tensor(109.9422, device='cuda:3')
compute norm is  tensor(45.4963, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.7614, device='cuda:3')
compute distance is  tensor(110.7614, device='cuda:3')
compute norm is  tensor(45.5197, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9444, device='cuda:3')
compute distance is  tensor(131.9444, device='cuda:3')
compute norm is  tensor(46.1575, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.5946, device='cuda:3')
compute distance is  tensor(107.5946, device='cuda:3')
compute norm is  tensor(45.4860, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8565, device='cuda:3')
compute distance is  tensor(122.8565, device='cuda:3')
compute norm is  tensor(45.7016, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2308, device='cuda:3')
compute distance is  tensor(118.2308, device='cuda:3')
compute norm is  tensor(45.8094, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.8270, device='cuda:3')
compute distance is  tensor(119.8270, device='cuda:3')
compute norm is  tensor(45.7474, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0275, device='cuda:3')
compute distance is  tensor(132.0275, device='cuda:3')
compute norm is  tensor(45.9120, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8251, device='cuda:3')
compute distance is  tensor(120.8251, device='cuda:3')
compute norm is  tensor(45.7333, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4608, device='cuda:3')
compute distance is  tensor(126.4608, device='cuda:3')
compute norm is  tensor(46.0010, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9687, device='cuda:3')
compute distance is  tensor(120.9687, device='cuda:3')
compute norm is  tensor(45.8722, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5966, device='cuda:3')
compute distance is  tensor(125.5966, device='cuda:3')
compute norm is  tensor(45.8929, device='cuda:3', dtype=torch.float64)
batch acc is 0.1023166668229986
mal_rand_acc is 0.10000000049999999
mal_rand loss is 119521490763776.0
len of model dicts is  12
distance x is tensor(109.9422, device='cuda:3')
compute distance is  tensor(109.9422, device='cuda:3')
compute norm is  tensor(45.4963, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.7614, device='cuda:3')
compute distance is  tensor(110.7614, device='cuda:3')
compute norm is  tensor(45.5197, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9444, device='cuda:3')
compute distance is  tensor(131.9444, device='cuda:3')
compute norm is  tensor(46.1575, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.5946, device='cuda:3')
compute distance is  tensor(107.5946, device='cuda:3')
compute norm is  tensor(45.4860, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8565, device='cuda:3')
compute distance is  tensor(122.8565, device='cuda:3')
compute norm is  tensor(45.7016, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2308, device='cuda:3')
compute distance is  tensor(118.2308, device='cuda:3')
compute norm is  tensor(45.8094, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.8270, device='cuda:3')
compute distance is  tensor(119.8270, device='cuda:3')
compute norm is  tensor(45.7474, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0275, device='cuda:3')
compute distance is  tensor(132.0275, device='cuda:3')
compute norm is  tensor(45.9120, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8251, device='cuda:3')
compute distance is  tensor(120.8251, device='cuda:3')
compute norm is  tensor(45.7333, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4608, device='cuda:3')
compute distance is  tensor(126.4608, device='cuda:3')
compute norm is  tensor(46.0010, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9687, device='cuda:3')
compute distance is  tensor(120.9687, device='cuda:3')
compute norm is  tensor(45.8722, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5966, device='cuda:3')
compute distance is  tensor(125.5966, device='cuda:3')
compute norm is  tensor(45.8929, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(132.0275, device='cuda:3')
distance x is tensor(107710.2031, device='cuda:3')
distance x is tensor(107710.2031, device='cuda:3')
________________________________
test distance is  tensor(107710.2031, device='cuda:3')
test distance1 is  tensor(107710.2031, device='cuda:3')
test similarity is  tensor(-0.1075, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130124721503382.66
test entropy is  0.0
________________________________
cal ratio is  0.03431072759472126
distance x is tensor(3695.6211, device='cuda:3')
cal_distance is  tensor(3695.6211, device='cuda:3')
cal ratio is  0.18523140667194582
distance x is tensor(684.5493, device='cuda:3')
cal_distance is  tensor(684.5493, device='cuda:3')
cal ratio is  0.43038385693707065
distance x is tensor(294.6219, device='cuda:3')
cal_distance is  tensor(294.6219, device='cuda:3')
cal ratio is  0.6560332075613236
distance x is tensor(193.2836, device='cuda:3')
cal_distance is  tensor(193.2836, device='cuda:3')
cal ratio is  0.8099549815683564
distance x is tensor(156.5520, device='cuda:3')
cal_distance is  tensor(156.5520, device='cuda:3')
cal ratio is  0.8999721019844977
distance x is tensor(140.8929, device='cuda:3')
cal_distance is  tensor(140.8929, device='cuda:3')
cal ratio is  0.9486668511343817
distance x is tensor(133.6607, device='cuda:3')
cal_distance is  tensor(133.6607, device='cuda:3')
cal ratio is  0.9739943112397175
distance x is tensor(130.1850, device='cuda:3')
cal_distance is  tensor(130.1850, device='cuda:3')
distance x is tensor(130.1850, device='cuda:3')
return_distance is  tensor(130.1850, device='cuda:3')
distance x is tensor(130.1746, device='cuda:3')
distance x is tensor(130.1746, device='cuda:3')
________________________________
test distance is  tensor(130.1746, device='cuda:3')
test distance1 is  tensor(130.1746, device='cuda:3')
test similarity is  tensor(0.9434, device='cuda:3')
test acc is  0.10010000015633198
test loss is 307.93509047778684
test entropy is  1.3729616009612228e-05
________________________________
0
distance x is tensor(130.1746, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.365083363339869e-05
avg test loss is  308.23378726007587
avg accuracy is  0.34586666682300704
solo acc is  0.10013333348966531
compute similarity  is  tensor(0.9434, device='cuda:3')
compute_distance is  tensor(130.1746, device='cuda:3')
compute_norm is  tensor(44.3006, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(108.9859, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9585505232119611
avg test loss is  1.4130011605047215
avg accuracy is  0.8538666668229901
solo acc is  0.3595833334896739
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(108.9859, device='cuda:3')
compute_norm is  tensor(43.1394, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.4911, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8700956868083238
avg test loss is  1.5583846114083393
avg accuracy is  0.8531833334896567
solo acc is  0.27841666682300564
compute similarity  is  tensor(0.9505, device='cuda:3')
compute_distance is  tensor(111.4911, device='cuda:3')
compute_norm is  tensor(42.8418, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.5783, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8799473005317168
avg test loss is  1.496996276668394
avg accuracy is  0.8565833334896564
solo acc is  0.27455000015633885
compute similarity  is  tensor(0.9501, device='cuda:3')
compute_distance is  tensor(113.5783, device='cuda:3')
compute_norm is  tensor(42.5742, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.5642, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8695092488453586
avg test loss is  1.455039811922289
avg accuracy is  0.8586666668229898
solo acc is  0.2763500001563389
compute similarity  is  tensor(0.9497, device='cuda:3')
compute_distance is  tensor(115.5642, device='cuda:3')
compute_norm is  tensor(42.3234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.4408, device='cuda:3')
distance x is tensor(117.4408, device='cuda:3')
________________________________
test distance is  tensor(117.4408, device='cuda:3')
test distance1 is  tensor(117.4408, device='cuda:3')
test similarity is  tensor(0.9493, device='cuda:3')
test acc is  0.27608333348967234
test loss is 1.4233730519250003
test entropy is  0.8701068428533671
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2755210399627686
mal norm is  tensor(616.7264, device='cuda:3')
distance x is tensor(117.4485, device='cuda:3')
mal distance is  tensor(117.4485, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(25.9314, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(490.5821, device='cuda:3')
user_param_square tensor(112.7895, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(0.4975, device='cuda:3')
score : tensor(-0.0208, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.4213, device='cuda:3')
user_param_square tensor(119.3618, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(-3.1169, device='cuda:3')
score : tensor(-0.0569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.9996, device='cuda:3')
user_param_square tensor(120.7204, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(34.8714, device='cuda:3')
score : tensor(0.3230, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.6599, device='cuda:3')
user_param_square tensor(115.2995, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(18.8520, device='cuda:3')
score : tensor(0.1628, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.0352, device='cuda:3')
user_param_square tensor(115.2292, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(-28.5401, device='cuda:3')
score : tensor(-0.3111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.7167, device='cuda:3')
user_param_square tensor(118.7405, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(-6.5350, device='cuda:3')
score : tensor(-0.0911, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(486.8905, device='cuda:3')
user_param_square tensor(112.3643, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(25.6593, device='cuda:3')
score : tensor(0.2309, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.7969, device='cuda:3')
user_param_square tensor(121.2346, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(5.4773, device='cuda:3')
score : tensor(0.0290, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7264, device='cuda:3')
user_param_square tensor(126.4617, device='cuda:3')
global_param_square tensor(25.9314, device='cuda:3')
part1 is  tensor(49.0972, device='cuda:3')
score : tensor(0.4652, device='cuda:3')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 85.42% 

Test Accuracy: 84.37% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3363693058490753
distance x is tensor(143.4467, device='cuda:3')
benign distance is  tensor(143.4467, device='cuda:3')
norm1 res is  tensor(0.1607, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.9704536199569702
distance x is tensor(144.1825, device='cuda:3')
benign distance is  tensor(144.1825, device='cuda:3')
norm1 res is  tensor(0.1561, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.22170238196849823
distance x is tensor(146.6410, device='cuda:3')
benign distance is  tensor(146.6410, device='cuda:3')
norm1 res is  tensor(0.1596, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.9644834399223328
distance x is tensor(133.7867, device='cuda:3')
benign distance is  tensor(133.7867, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.49168163537979126
distance x is tensor(138.5826, device='cuda:3')
benign distance is  tensor(138.5826, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4279295802116394
distance x is tensor(127.4619, device='cuda:3')
benign distance is  tensor(127.4619, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.690677285194397
distance x is tensor(133.2626, device='cuda:3')
benign distance is  tensor(133.2626, device='cuda:3')
norm1 res is  tensor(0.1437, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.6519709825515747
distance x is tensor(133.2741, device='cuda:3')
benign distance is  tensor(133.2741, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(136.8352, device='cuda:3')
compute distance is  tensor(136.8352, device='cuda:3')
compute norm is  tensor(44.4169, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1719, device='cuda:3')
compute distance is  tensor(122.1719, device='cuda:3')
compute norm is  tensor(44.1449, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.0086, device='cuda:3')
compute distance is  tensor(147.0086, device='cuda:3')
compute norm is  tensor(45.0295, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.3483, device='cuda:3')
compute distance is  tensor(149.3483, device='cuda:3')
compute norm is  tensor(45.0190, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.4716, device='cuda:3')
compute distance is  tensor(154.4716, device='cuda:3')
compute norm is  tensor(45.0505, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.4008, device='cuda:3')
compute distance is  tensor(138.4008, device='cuda:3')
compute norm is  tensor(44.7161, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.0652, device='cuda:3')
compute distance is  tensor(145.0652, device='cuda:3')
compute norm is  tensor(44.7484, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2650, device='cuda:3')
compute distance is  tensor(138.2650, device='cuda:3')
compute norm is  tensor(44.6335, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4409, device='cuda:3')
compute distance is  tensor(137.4409, device='cuda:3')
compute norm is  tensor(44.5342, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1726, device='cuda:3')
compute distance is  tensor(132.1726, device='cuda:3')
compute norm is  tensor(44.5844, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.0671, device='cuda:3')
compute distance is  tensor(140.0671, device='cuda:3')
compute norm is  tensor(44.6981, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.9729, device='cuda:3')
compute distance is  tensor(145.9729, device='cuda:3')
compute norm is  tensor(44.9419, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.4716, device='cuda:3')
distance x is tensor(107667.9453, device='cuda:3')
distance x is tensor(107667.9453, device='cuda:3')
________________________________
test distance is  tensor(107667.9453, device='cuda:3')
test distance1 is  tensor(107667.9453, device='cuda:3')
test similarity is  tensor(0.0571, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129999656229636.9
test entropy is  0.0
________________________________
cal ratio is  0.03711992867126791
distance x is tensor(3996.6316, device='cuda:3')
cal_distance is  tensor(3996.6316, device='cuda:3')
cal ratio is  0.19266520401256182
distance x is tensor(770.0160, device='cuda:3')
cal_distance is  tensor(770.0160, device='cuda:3')
cal ratio is  0.43893526475009426
distance x is tensor(337.9901, device='cuda:3')
cal_distance is  tensor(337.9901, device='cuda:3')
cal ratio is  0.6625190748221753
distance x is tensor(223.9266, device='cuda:3')
cal_distance is  tensor(223.9266, device='cuda:3')
cal ratio is  0.8139495221486046
distance x is tensor(182.2659, device='cuda:3')
cal_distance is  tensor(182.2659, device='cuda:3')
cal ratio is  0.9021890879010245
distance x is tensor(164.4388, device='cuda:3')
cal_distance is  tensor(164.4388, device='cuda:3')
cal ratio is  0.9498349232427455
distance x is tensor(156.1900, device='cuda:3')
cal_distance is  tensor(156.1900, device='cuda:3')
cal ratio is  0.974593872986703
distance x is tensor(152.2220, device='cuda:3')
cal_distance is  tensor(152.2220, device='cuda:3')
distance x is tensor(152.2220, device='cuda:3')
return_distance is  tensor(152.2220, device='cuda:3')
distance x is tensor(152.2117, device='cuda:3')
distance x is tensor(152.2117, device='cuda:3')
________________________________
test distance is  tensor(152.2117, device='cuda:3')
test distance1 is  tensor(152.2117, device='cuda:3')
test similarity is  tensor(0.9285, device='cuda:3')
test acc is  0.10000000015633198
test loss is 739.6388312301148
test entropy is  0.0
________________________________
0
distance x is tensor(152.2117, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.3762628244926295e-46
avg test loss is  739.8311225549498
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9285, device='cuda:3')
compute_distance is  tensor(152.2117, device='cuda:3')
compute_norm is  tensor(45.1786, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.8425, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1391240037453454
avg test loss is  1.7785050074683069
avg accuracy is  0.4392500001563415
solo acc is  0.24305000015633813
compute similarity  is  tensor(0.9326, device='cuda:3')
compute_distance is  tensor(142.8425, device='cuda:3')
compute_norm is  tensor(45.3271, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(143.4959, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6577303225933108
avg test loss is  2.627897966899343
avg accuracy is  0.3150500001563398
solo acc is  0.11425000015633194
compute similarity  is  tensor(0.9324, device='cuda:3')
compute_distance is  tensor(143.4959, device='cuda:3')
compute_norm is  tensor(45.2162, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.0405, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9715959333153422
avg test loss is  1.5186217880960722
avg accuracy is  0.4715500001563419
solo acc is  0.28275000015633917
compute similarity  is  tensor(0.9328, device='cuda:3')
compute_distance is  tensor(144.0405, device='cuda:3')
compute_norm is  tensor(44.8914, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(144.0405, device='cuda:3')
distance x is tensor(144.0405, device='cuda:3')
________________________________
test distance is  tensor(144.0405, device='cuda:3')
test distance1 is  tensor(144.0405, device='cuda:3')
test similarity is  tensor(0.9328, device='cuda:3')
test acc is  0.2820166668230058
test loss is 1.5145650630566612
test entropy is  0.97104472531947
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.4679666757583618
mal norm is  tensor(737.8015, device='cuda:3')
distance x is tensor(144.0480, device='cuda:3')
mal distance is  tensor(144.0480, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(18.8024, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.8350, device='cuda:3')
user_param_square tensor(109.3401, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(135.4912, device='cuda:3')
score : tensor(1.3363, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.7444, device='cuda:3')
user_param_square tensor(108.1218, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(116.6095, device='cuda:3')
score : tensor(1.1475, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.2828, device='cuda:3')
user_param_square tensor(109.0342, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(149.6699, device='cuda:3')
score : tensor(1.4781, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.8141, device='cuda:3')
user_param_square tensor(104.9511, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(81.2125, device='cuda:3')
score : tensor(0.7935, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.5762, device='cuda:3')
user_param_square tensor(105.7331, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(99.6968, device='cuda:3')
score : tensor(0.9784, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.2100, device='cuda:3')
user_param_square tensor(102.4486, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(122.6055, device='cuda:3')
score : tensor(1.2075, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.7490, device='cuda:3')
user_param_square tensor(103.5928, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(134.9129, device='cuda:3')
score : tensor(1.3305, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.8859, device='cuda:3')
user_param_square tensor(104.4187, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(120.7469, device='cuda:3')
score : tensor(1.1889, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.8015, device='cuda:3')
user_param_square tensor(117.7815, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(-158.7717, device='cuda:3')
score : tensor(-1.6063, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.8390, device='cuda:3')
user_param_square tensor(115.6093, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(120.5194, device='cuda:3')
score : tensor(1.1866, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.9493, device='cuda:3')
user_param_square tensor(118.1917, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(98.2264, device='cuda:3')
score : tensor(0.9637, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.7552, device='cuda:3')
user_param_square tensor(112.8036, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(111.1445, device='cuda:3')
score : tensor(1.0928, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.5374, device='cuda:3')
user_param_square tensor(112.9520, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(115.1657, device='cuda:3')
score : tensor(1.1331, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.3901, device='cuda:3')
user_param_square tensor(115.5728, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(96.3223, device='cuda:3')
score : tensor(0.9446, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(759.2294, device='cuda:3')
user_param_square tensor(119.4796, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(133.3773, device='cuda:3')
score : tensor(1.3152, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.6719, device='cuda:3')
user_param_square tensor(117.5314, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(76.4577, device='cuda:3')
score : tensor(0.7460, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.7396, device='cuda:3')
user_param_square tensor(116.8952, device='cuda:3')
global_param_square tensor(18.8024, device='cuda:3')
part1 is  tensor(110.5354, device='cuda:3')
score : tensor(1.0868, device='cuda:3')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 89.38% 

Test Accuracy: 88.55% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.29821911454200745
distance x is tensor(122.3626, device='cuda:3')
benign distance is  tensor(122.3626, device='cuda:3')
norm1 res is  tensor(0.1357, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5392698049545288
distance x is tensor(128.7203, device='cuda:3')
benign distance is  tensor(128.7203, device='cuda:3')
norm1 res is  tensor(0.1459, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.44678884744644165
distance x is tensor(115.8560, device='cuda:3')
benign distance is  tensor(115.8560, device='cuda:3')
norm1 res is  tensor(0.1301, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.503555953502655
distance x is tensor(108.5709, device='cuda:3')
benign distance is  tensor(108.5709, device='cuda:3')
norm1 res is  tensor(0.1228, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  1.1653579473495483
distance x is tensor(100.3136, device='cuda:3')
benign distance is  tensor(100.3136, device='cuda:3')
norm1 res is  tensor(0.1117, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5371969938278198
distance x is tensor(124.9813, device='cuda:3')
benign distance is  tensor(124.9813, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.8657233119010925
distance x is tensor(118.5421, device='cuda:3')
benign distance is  tensor(118.5421, device='cuda:3')
norm1 res is  tensor(0.1306, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2888595163822174
distance x is tensor(133.2726, device='cuda:3')
benign distance is  tensor(133.2726, device='cuda:3')
norm1 res is  tensor(0.1508, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.2789575457572937
distance x is tensor(134.2130, device='cuda:3')
benign distance is  tensor(134.2130, device='cuda:3')
norm1 res is  tensor(0.1522, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.391427218914032
distance x is tensor(142.3366, device='cuda:3')
benign distance is  tensor(142.3366, device='cuda:3')
norm1 res is  tensor(0.1576, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.8991938829421997
distance x is tensor(131.3032, device='cuda:3')
benign distance is  tensor(131.3032, device='cuda:3')
norm1 res is  tensor(0.1477, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.740253210067749
distance x is tensor(133.0361, device='cuda:3')
benign distance is  tensor(133.0361, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.5283585786819458
distance x is tensor(117.7173, device='cuda:3')
benign distance is  tensor(117.7173, device='cuda:3')
norm1 res is  tensor(0.1369, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.16746465861797333
distance x is tensor(132.7067, device='cuda:3')
benign distance is  tensor(132.7067, device='cuda:3')
norm1 res is  tensor(0.1459, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.5182216763496399
distance x is tensor(134.4586, device='cuda:3')
benign distance is  tensor(134.4586, device='cuda:3')
norm1 res is  tensor(0.1490, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.2516193687915802
distance x is tensor(130.1999, device='cuda:3')
benign distance is  tensor(130.1999, device='cuda:3')
norm1 res is  tensor(0.1470, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(119.1787, device='cuda:3')
compute distance is  tensor(119.1787, device='cuda:3')
compute norm is  tensor(45.1329, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.4647, device='cuda:3')
compute distance is  tensor(124.4647, device='cuda:3')
compute norm is  tensor(45.4134, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0239, device='cuda:3')
compute distance is  tensor(132.0239, device='cuda:3')
compute norm is  tensor(45.5452, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6687, device='cuda:3')
compute distance is  tensor(125.6687, device='cuda:3')
compute norm is  tensor(45.3465, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9142, device='cuda:3')
compute distance is  tensor(126.9142, device='cuda:3')
compute norm is  tensor(45.4622, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8682, device='cuda:3')
compute distance is  tensor(127.8682, device='cuda:3')
compute norm is  tensor(45.4684, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.2987, device='cuda:3')
compute distance is  tensor(122.2987, device='cuda:3')
compute norm is  tensor(45.3311, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.8640, device='cuda:3')
compute distance is  tensor(117.8640, device='cuda:3')
compute norm is  tensor(45.1187, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1529, device='cuda:3')
compute distance is  tensor(126.1529, device='cuda:3')
compute norm is  tensor(45.3931, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.8251, device='cuda:3')
compute distance is  tensor(114.8251, device='cuda:3')
compute norm is  tensor(45.1899, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6001, device='cuda:3')
compute distance is  tensor(132.6001, device='cuda:3')
compute norm is  tensor(45.5663, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.0199, device='cuda:3')
compute distance is  tensor(120.0199, device='cuda:3')
compute norm is  tensor(45.1046, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(132.6001, device='cuda:3')
distance x is tensor(107690.8516, device='cuda:3')
distance x is tensor(107690.8516, device='cuda:3')
________________________________
test distance is  tensor(107690.8516, device='cuda:3')
test distance1 is  tensor(107690.8516, device='cuda:3')
test similarity is  tensor(-0.0270, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130044655951400.39
test entropy is  0.0
________________________________
cal ratio is  0.034388130030027726
distance x is tensor(3703.2927, device='cuda:3')
cal_distance is  tensor(3703.2927, device='cuda:3')
cal ratio is  0.18544023038627014
distance x is tensor(686.7437, device='cuda:3')
cal_distance is  tensor(686.7437, device='cuda:3')
cal ratio is  0.43062639436233063
distance x is tensor(295.7329, device='cuda:3')
cal_distance is  tensor(295.7329, device='cuda:3')
cal ratio is  0.6562180380985176
distance x is tensor(194.0670, device='cuda:3')
cal_distance is  tensor(194.0670, device='cuda:3')
cal ratio is  0.8100691151124804
distance x is tensor(157.2087, device='cuda:3')
cal_distance is  tensor(157.2087, device='cuda:3')
cal ratio is  0.9000355792827729
distance x is tensor(141.4939, device='cuda:3')
cal_distance is  tensor(141.4939, device='cuda:3')
cal ratio is  0.9487003100931597
distance x is tensor(134.2356, device='cuda:3')
cal_distance is  tensor(134.2356, device='cuda:3')
cal ratio is  0.9740115314962268
distance x is tensor(130.7472, device='cuda:3')
cal_distance is  tensor(130.7472, device='cuda:3')
distance x is tensor(130.7472, device='cuda:3')
return_distance is  tensor(130.7472, device='cuda:3')
distance x is tensor(130.7369, device='cuda:3')
distance x is tensor(130.7369, device='cuda:3')
________________________________
test distance is  tensor(130.7369, device='cuda:3')
test distance1 is  tensor(130.7369, device='cuda:3')
test similarity is  tensor(0.9443, device='cuda:3')
test acc is  0.10003333348966531
test loss is 323.5831319325006
test entropy is  1.571095998277892e-05
________________________________
0
distance x is tensor(130.7369, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.2494287902276466e-07
avg test loss is  323.06579524774287
avg accuracy is  0.17186666682300142
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9443, device='cuda:3')
compute_distance is  tensor(130.7369, device='cuda:3')
compute_norm is  tensor(44.7119, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(110.0556, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9267964809179814
avg test loss is  1.4168177427513513
avg accuracy is  0.8278833334896576
solo acc is  0.34225000015634033
compute similarity  is  tensor(0.9507, device='cuda:3')
compute_distance is  tensor(110.0556, device='cuda:3')
compute_norm is  tensor(43.8695, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.7689, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8924797320289652
avg test loss is  1.485569234722967
avg accuracy is  0.8281333334896577
solo acc is  0.28090000015633904
compute similarity  is  tensor(0.9504, device='cuda:3')
compute_distance is  tensor(111.7689, device='cuda:3')
compute_norm is  tensor(43.5910, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.2668, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8765946756929223
avg test loss is  1.462565247692279
avg accuracy is  0.8322000001563242
solo acc is  0.27608333348967223
compute similarity  is  tensor(0.9502, device='cuda:3')
compute_distance is  tensor(113.2668, device='cuda:3')
compute_norm is  tensor(43.3393, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.8242, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8587634308633011
avg test loss is  1.4573076198350137
avg accuracy is  0.8343166668229908
solo acc is  0.26730000015633876
compute similarity  is  tensor(0.9499, device='cuda:3')
compute_distance is  tensor(114.8242, device='cuda:3')
compute_norm is  tensor(43.0992, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.4121, device='cuda:3')
distance x is tensor(116.4121, device='cuda:3')
________________________________
test distance is  tensor(116.4121, device='cuda:3')
test distance1 is  tensor(116.4121, device='cuda:3')
test similarity is  tensor(0.9497, device='cuda:3')
test acc is  0.2718000001563388
test loss is 1.4101885173366522
test entropy is  0.8727209049501399
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2410070896148682
mal norm is  tensor(615.7446, device='cuda:3')
distance x is tensor(116.4204, device='cuda:3')
mal distance is  tensor(116.4204, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(26.6144, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.1255, device='cuda:3')
user_param_square tensor(119.5628, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(33.1854, device='cuda:3')
score : tensor(0.3054, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.9967, device='cuda:3')
user_param_square tensor(124.0284, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(-9.6111, device='cuda:3')
score : tensor(-0.1225, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.9879, device='cuda:3')
user_param_square tensor(116.7315, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(29.6422, device='cuda:3')
score : tensor(0.2700, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(481.3652, device='cuda:3')
user_param_square tensor(113.1868, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(-32.1802, device='cuda:3')
score : tensor(-0.3482, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(443.0522, device='cuda:3')
user_param_square tensor(108.5890, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(-109.0366, device='cuda:3')
score : tensor(-1.1168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.8788, device='cuda:3')
user_param_square tensor(120.8639, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(-38.5088, device='cuda:3')
score : tensor(-0.4115, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.1126, device='cuda:3')
user_param_square tensor(116.8597, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(1.2294, device='cuda:3')
score : tensor(-0.0141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.1275, device='cuda:3')
user_param_square tensor(125.0042, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(52.6911, device='cuda:3')
score : tensor(0.5005, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7446, device='cuda:3')
user_param_square tensor(128.0143, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(4.9837, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.2173, device='cuda:3')
user_param_square tensor(127.9595, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(8.3720, device='cuda:3')
score : tensor(0.0573, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.6196, device='cuda:3')
user_param_square tensor(136.4550, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(-16.4408, device='cuda:3')
score : tensor(-0.1908, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.7943, device='cuda:3')
user_param_square tensor(128.4346, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(39.9826, device='cuda:3')
score : tensor(0.3734, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.1397, device='cuda:3')
user_param_square tensor(129.9124, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(42.0973, device='cuda:3')
score : tensor(0.3946, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.1609, device='cuda:3')
user_param_square tensor(126.9094, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(50.8646, device='cuda:3')
score : tensor(0.4822, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.8052, device='cuda:3')
user_param_square tensor(127.3954, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(-51.4623, device='cuda:3')
score : tensor(-0.5410, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.7579, device='cuda:3')
user_param_square tensor(133.4113, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(-11.0890, device='cuda:3')
score : tensor(-0.1373, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.8495, device='cuda:3')
user_param_square tensor(128.6474, device='cuda:3')
global_param_square tensor(26.6144, device='cuda:3')
part1 is  tensor(-18.8113, device='cuda:3')
score : tensor(-0.2145, device='cuda:3')
len accept list 19
len all weights is 19
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 86.06% 

Test Accuracy: 84.76% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.19857792556285858
distance x is tensor(117.7652, device='cuda:3')
benign distance is  tensor(117.7652, device='cuda:3')
norm1 res is  tensor(0.1300, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4742416441440582
distance x is tensor(157.9199, device='cuda:3')
benign distance is  tensor(157.9199, device='cuda:3')
norm1 res is  tensor(0.1680, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.29169344902038574
distance x is tensor(132.0249, device='cuda:3')
benign distance is  tensor(132.0249, device='cuda:3')
norm1 res is  tensor(0.1442, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7757651209831238
distance x is tensor(139.6328, device='cuda:3')
benign distance is  tensor(139.6328, device='cuda:3')
norm1 res is  tensor(0.1504, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6972240209579468
distance x is tensor(129.3365, device='cuda:3')
benign distance is  tensor(129.3365, device='cuda:3')
norm1 res is  tensor(0.1392, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4252610206604004
distance x is tensor(147.1393, device='cuda:3')
benign distance is  tensor(147.1393, device='cuda:3')
norm1 res is  tensor(0.1620, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.17729662358760834
distance x is tensor(123.9847, device='cuda:3')
benign distance is  tensor(123.9847, device='cuda:3')
norm1 res is  tensor(0.1322, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.6581180095672607
distance x is tensor(132.3504, device='cuda:3')
benign distance is  tensor(132.3504, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.25706154108047485
distance x is tensor(147.4306, device='cuda:3')
benign distance is  tensor(147.4306, device='cuda:3')
norm1 res is  tensor(0.1575, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.8706945180892944
distance x is tensor(170.1180, device='cuda:3')
benign distance is  tensor(170.1180, device='cuda:3')
norm1 res is  tensor(0.1832, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.7031177282333374
distance x is tensor(151.3804, device='cuda:3')
benign distance is  tensor(151.3804, device='cuda:3')
norm1 res is  tensor(0.1623, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.33562666177749634
distance x is tensor(142.7244, device='cuda:3')
benign distance is  tensor(142.7244, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.1575738489627838
distance x is tensor(163.6897, device='cuda:3')
benign distance is  tensor(163.6897, device='cuda:3')
norm1 res is  tensor(0.1734, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  1.1161974668502808
distance x is tensor(138.5480, device='cuda:3')
benign distance is  tensor(138.5480, device='cuda:3')
norm1 res is  tensor(0.1488, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.542630672454834
distance x is tensor(159.0759, device='cuda:3')
benign distance is  tensor(159.0759, device='cuda:3')
norm1 res is  tensor(0.1711, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.5827387571334839
distance x is tensor(144.8077, device='cuda:3')
benign distance is  tensor(144.8077, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(143.3808, device='cuda:3')
compute distance is  tensor(143.3808, device='cuda:3')
compute norm is  tensor(44.9028, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3533, device='cuda:3')
compute distance is  tensor(140.3533, device='cuda:3')
compute norm is  tensor(44.8094, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.3611, device='cuda:3')
compute distance is  tensor(141.3611, device='cuda:3')
compute norm is  tensor(45.0789, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3798, device='cuda:3')
compute distance is  tensor(137.3798, device='cuda:3')
compute norm is  tensor(44.9181, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.6832, device='cuda:3')
compute distance is  tensor(145.6832, device='cuda:3')
compute norm is  tensor(45.0862, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2053, device='cuda:3')
compute distance is  tensor(140.2053, device='cuda:3')
compute norm is  tensor(45.0704, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.2720, device='cuda:3')
compute distance is  tensor(145.2720, device='cuda:3')
compute norm is  tensor(45.0065, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.5121, device='cuda:3')
compute distance is  tensor(149.5121, device='cuda:3')
compute norm is  tensor(45.0082, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.8041, device='cuda:3')
compute distance is  tensor(150.8041, device='cuda:3')
compute norm is  tensor(45.1626, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.7769, device='cuda:3')
compute distance is  tensor(154.7769, device='cuda:3')
compute norm is  tensor(45.2625, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.0925, device='cuda:3')
compute distance is  tensor(147.0925, device='cuda:3')
compute norm is  tensor(45.1304, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6631, device='cuda:3')
compute distance is  tensor(139.6631, device='cuda:3')
compute norm is  tensor(44.8551, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.7769, device='cuda:3')
distance x is tensor(107657.5234, device='cuda:3')
distance x is tensor(107657.5234, device='cuda:3')
________________________________
test distance is  tensor(107657.5234, device='cuda:3')
test distance1 is  tensor(107657.5234, device='cuda:3')
test similarity is  tensor(0.1009, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130071299189919.39
test entropy is  0.0
________________________________
cal ratio is  0.03715839007477218
distance x is tensor(4000.3860, device='cuda:3')
cal_distance is  tensor(4000.3860, device='cuda:3')
cal ratio is  0.19276498197043382
distance x is tensor(771.1385, device='cuda:3')
cal_distance is  tensor(771.1385, device='cuda:3')
cal ratio is  0.4390488915218079
distance x is tensor(338.5704, device='cuda:3')
cal_distance is  tensor(338.5704, device='cuda:3')
cal ratio is  0.6626048468450508
distance x is tensor(224.3401, device='cuda:3')
cal_distance is  tensor(224.3401, device='cuda:3')
cal ratio is  0.814002196906497
distance x is tensor(182.6143, device='cuda:3')
cal_distance is  tensor(182.6143, device='cuda:3')
cal ratio is  0.902218338082894
distance x is tensor(164.7585, device='cuda:3')
cal_distance is  tensor(164.7585, device='cuda:3')
cal ratio is  0.9498502612310432
distance x is tensor(156.4962, device='cuda:3')
cal_distance is  tensor(156.4962, device='cuda:3')
cal ratio is  0.9746018023913403
distance x is tensor(152.5216, device='cuda:3')
cal_distance is  tensor(152.5216, device='cuda:3')
distance x is tensor(152.5216, device='cuda:3')
return_distance is  tensor(152.5216, device='cuda:3')
distance x is tensor(152.5114, device='cuda:3')
distance x is tensor(152.5114, device='cuda:3')
________________________________
test distance is  tensor(152.5114, device='cuda:3')
test distance1 is  tensor(152.5114, device='cuda:3')
test similarity is  tensor(0.9319, device='cuda:3')
test acc is  0.10000000015633198
test loss is 658.5864985289096
test entropy is  2.9878432075156014e-48
________________________________
0
distance x is tensor(152.5114, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9501391383887304e-28
avg test loss is  658.3978878582465
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9319, device='cuda:3')
compute_distance is  tensor(152.5114, device='cuda:3')
compute_norm is  tensor(45.9191, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.5193, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2188340248837908
avg test loss is  1.8914148801171196
avg accuracy is  0.5207666668230089
solo acc is  0.2072000001563367
compute similarity  is  tensor(0.9339, device='cuda:3')
compute_distance is  tensor(144.5193, device='cuda:3')
compute_norm is  tensor(46.3398, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(145.4367, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6768120780174158
avg test loss is  2.6922323599553057
avg accuracy is  0.37436666682300745
solo acc is  0.11056666682299861
compute similarity  is  tensor(0.9336, device='cuda:3')
compute_distance is  tensor(145.4367, device='cuda:3')
compute_norm is  tensor(46.2952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.7379, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0133293942729038
avg test loss is  1.6143688423547156
avg accuracy is  0.5438000001563423
solo acc is  0.2436166668230047
compute similarity  is  tensor(0.9346, device='cuda:3')
compute_distance is  tensor(145.7379, device='cuda:3')
compute_norm is  tensor(45.9308, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(146.2393, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6175308572585141
avg test loss is  2.4381644963455607
avg accuracy is  0.3944833334896744
solo acc is  0.11013333348966528
compute similarity  is  tensor(0.9342, device='cuda:3')
compute_distance is  tensor(146.2393, device='cuda:3')
compute_norm is  tensor(45.7945, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(146.2989, device='cuda:3')
distance x is tensor(146.2989, device='cuda:3')
________________________________
test distance is  tensor(146.2989, device='cuda:3')
test distance1 is  tensor(146.2989, device='cuda:3')
test similarity is  tensor(0.9346, device='cuda:3')
test acc is  0.27650000015633897
test loss is 1.4661342754547022
test entropy is  0.9573907603078814
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.2168998718261719
mal norm is  tensor(739.8501, device='cuda:3')
distance x is tensor(146.3067, device='cuda:3')
mal distance is  tensor(146.3067, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(21.2873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(510.3219, device='cuda:3')
user_param_square tensor(104.2275, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(173.0344, device='cuda:3')
score : tensor(1.7093, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.6388, device='cuda:3')
user_param_square tensor(118.9468, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(107.1159, device='cuda:3')
score : tensor(1.0501, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.1625, device='cuda:3')
user_param_square tensor(109.8788, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(159.6479, device='cuda:3')
score : tensor(1.5754, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.9358, device='cuda:3')
user_param_square tensor(112.5369, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(49.6741, device='cuda:3')
score : tensor(0.4757, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.7421, device='cuda:3')
user_param_square tensor(107.6851, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(121.6851, device='cuda:3')
score : tensor(1.1958, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.6774, device='cuda:3')
user_param_square tensor(116.8741, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(86.5031, device='cuda:3')
score : tensor(0.8439, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.0045, device='cuda:3')
user_param_square tensor(105.6155, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(136.3140, device='cuda:3')
score : tensor(1.3421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.3258, device='cuda:3')
user_param_square tensor(110.0881, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(76.4537, device='cuda:3')
score : tensor(0.7434, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.8501, device='cuda:3')
user_param_square tensor(125.4966, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(-142.3768, device='cuda:3')
score : tensor(-1.4449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(791.1539, device='cuda:3')
user_param_square tensor(129.7749, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(110.9445, device='cuda:3')
score : tensor(1.0884, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.3691, device='cuda:3')
user_param_square tensor(123.6613, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(95.4616, device='cuda:3')
score : tensor(0.9335, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(801.7549, device='cuda:3')
user_param_square tensor(130.6414, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(91.6516, device='cuda:3')
score : tensor(0.8954, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.1937, device='cuda:3')
user_param_square tensor(129.4496, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(71.5830, device='cuda:3')
score : tensor(0.6947, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.6517, device='cuda:3')
user_param_square tensor(124.5432, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(73.4271, device='cuda:3')
score : tensor(0.7132, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1487, device='cuda:3')
user_param_square tensor(128.5383, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(100.2856, device='cuda:3')
score : tensor(0.9818, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.7630, device='cuda:3')
user_param_square tensor(125.8280, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(119.4039, device='cuda:3')
score : tensor(1.1730, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.6525, device='cuda:3')
user_param_square tensor(128.5800, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(30.3998, device='cuda:3')
score : tensor(0.2829, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.6732, device='cuda:3')
user_param_square tensor(119.2181, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(130.4070, device='cuda:3')
score : tensor(1.2830, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.9431, device='cuda:3')
user_param_square tensor(121.6283, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(29.0449, device='cuda:3')
score : tensor(0.2694, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.4053, device='cuda:3')
user_param_square tensor(118.3877, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(66.9241, device='cuda:3')
score : tensor(0.6482, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.7891, device='cuda:3')
user_param_square tensor(118.7812, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(50.0126, device='cuda:3')
score : tensor(0.4790, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9905, device='cuda:3')
user_param_square tensor(114.2318, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(77.5422, device='cuda:3')
score : tensor(0.7543, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.5453, device='cuda:3')
user_param_square tensor(118.3104, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(133.4561, device='cuda:3')
score : tensor(1.3135, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.0089, device='cuda:3')
user_param_square tensor(119.5155, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(70.1186, device='cuda:3')
score : tensor(0.6801, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.6605, device='cuda:3')
user_param_square tensor(118.3208, device='cuda:3')
global_param_square tensor(21.2873, device='cuda:3')
part1 is  tensor(79.6121, device='cuda:3')
score : tensor(0.7750, device='cuda:3')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 89.54% 

Test Accuracy: 88.73% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7261654138565063
distance x is tensor(107.8680, device='cuda:3')
benign distance is  tensor(107.8680, device='cuda:3')
norm1 res is  tensor(0.1216, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.3133727312088013
distance x is tensor(116.5986, device='cuda:3')
benign distance is  tensor(116.5986, device='cuda:3')
norm1 res is  tensor(0.1297, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2670857608318329
distance x is tensor(127.6990, device='cuda:3')
benign distance is  tensor(127.6990, device='cuda:3')
norm1 res is  tensor(0.1397, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.431499719619751
distance x is tensor(108.9648, device='cuda:3')
benign distance is  tensor(108.9648, device='cuda:3')
norm1 res is  tensor(0.1206, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4019767642021179
distance x is tensor(121.7033, device='cuda:3')
benign distance is  tensor(121.7033, device='cuda:3')
norm1 res is  tensor(0.1346, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5408666133880615
distance x is tensor(132.2349, device='cuda:3')
benign distance is  tensor(132.2349, device='cuda:3')
norm1 res is  tensor(0.1465, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.29852190613746643
distance x is tensor(125.5449, device='cuda:3')
benign distance is  tensor(125.5449, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.4407498240470886
distance x is tensor(120.3989, device='cuda:3')
benign distance is  tensor(120.3989, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.644195020198822
distance x is tensor(132.1652, device='cuda:3')
benign distance is  tensor(132.1652, device='cuda:3')
norm1 res is  tensor(0.1464, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.480155885219574
distance x is tensor(135.6478, device='cuda:3')
benign distance is  tensor(135.6478, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.512944757938385
distance x is tensor(129.6672, device='cuda:3')
benign distance is  tensor(129.6672, device='cuda:3')
norm1 res is  tensor(0.1450, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5140723586082458
distance x is tensor(129.4035, device='cuda:3')
benign distance is  tensor(129.4035, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.4696429669857025
distance x is tensor(132.6703, device='cuda:3')
benign distance is  tensor(132.6703, device='cuda:3')
norm1 res is  tensor(0.1469, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.2181510478258133
distance x is tensor(132.0712, device='cuda:3')
benign distance is  tensor(132.0712, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.5193769335746765
distance x is tensor(127.2792, device='cuda:3')
benign distance is  tensor(127.2792, device='cuda:3')
norm1 res is  tensor(0.1450, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3795091211795807
distance x is tensor(138.5982, device='cuda:3')
benign distance is  tensor(138.5982, device='cuda:3')
norm1 res is  tensor(0.1569, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.7827631235122681
distance x is tensor(134.8128, device='cuda:3')
benign distance is  tensor(134.8128, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.4323335289955139
distance x is tensor(124.8764, device='cuda:3')
benign distance is  tensor(124.8764, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.24057026207447052
distance x is tensor(140.9574, device='cuda:3')
benign distance is  tensor(140.9574, device='cuda:3')
norm1 res is  tensor(0.1576, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.6655109524726868
distance x is tensor(140.2164, device='cuda:3')
benign distance is  tensor(140.2164, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  1.0330193042755127
distance x is tensor(120.8949, device='cuda:3')
benign distance is  tensor(120.8949, device='cuda:3')
norm1 res is  tensor(0.1346, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.37629398703575134
distance x is tensor(131.6683, device='cuda:3')
benign distance is  tensor(131.6683, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.33770912885665894
distance x is tensor(134.7164, device='cuda:3')
benign distance is  tensor(134.7164, device='cuda:3')
norm1 res is  tensor(0.1510, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.23130583763122559
distance x is tensor(130.0032, device='cuda:3')
benign distance is  tensor(130.0032, device='cuda:3')
norm1 res is  tensor(0.1476, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(110.5112, device='cuda:3')
compute distance is  tensor(110.5112, device='cuda:3')
compute norm is  tensor(44.9914, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.1947, device='cuda:3')
compute distance is  tensor(114.1947, device='cuda:3')
compute norm is  tensor(45.1025, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.2406, device='cuda:3')
compute distance is  tensor(121.2406, device='cuda:3')
compute norm is  tensor(45.3289, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.3115, device='cuda:3')
compute distance is  tensor(108.3115, device='cuda:3')
compute norm is  tensor(45.0252, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.5200, device='cuda:3')
compute distance is  tensor(118.5200, device='cuda:3')
compute norm is  tensor(45.2453, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9824, device='cuda:3')
compute distance is  tensor(119.9824, device='cuda:3')
compute norm is  tensor(45.4172, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.4548, device='cuda:3')
compute distance is  tensor(119.4548, device='cuda:3')
compute norm is  tensor(45.2151, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.2974, device='cuda:3')
compute distance is  tensor(124.2974, device='cuda:3')
compute norm is  tensor(45.3506, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.2406, device='cuda:3')
compute distance is  tensor(121.2406, device='cuda:3')
compute norm is  tensor(45.3896, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0208, device='cuda:3')
compute distance is  tensor(118.0208, device='cuda:3')
compute norm is  tensor(45.3145, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.0934, device='cuda:3')
compute distance is  tensor(122.0934, device='cuda:3')
compute norm is  tensor(45.4553, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.6847, device='cuda:3')
compute distance is  tensor(117.6847, device='cuda:3')
compute norm is  tensor(45.2540, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(124.2974, device='cuda:3')
distance x is tensor(107686.9219, device='cuda:3')
distance x is tensor(107686.9219, device='cuda:3')
________________________________
test distance is  tensor(107686.9219, device='cuda:3')
test distance1 is  tensor(107686.9219, device='cuda:3')
test similarity is  tensor(-0.0059, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130150841616501.9
test entropy is  0.0
________________________________
cal ratio is  0.03329474131143656
distance x is tensor(3585.4138, device='cuda:3')
cal_distance is  tensor(3585.4138, device='cuda:3')
cal ratio is  0.18246832014145273
distance x is tensor(654.2286, device='cuda:3')
cal_distance is  tensor(654.2286, device='cuda:3')
cal ratio is  0.42716174157542225
distance x is tensor(279.4644, device='cuda:3')
cal_distance is  tensor(279.4644, device='cuda:3')
cal ratio is  0.65357268846444
distance x is tensor(182.6521, device='cuda:3')
cal_distance is  tensor(182.6521, device='cuda:3')
cal ratio is  0.8084344464227068
distance x is tensor(147.6632, device='cuda:3')
cal_distance is  tensor(147.6632, device='cuda:3')
cal ratio is  0.899126784725001
distance x is tensor(132.7685, device='cuda:3')
cal_distance is  tensor(132.7685, device='cuda:3')
cal ratio is  0.948221091767886
distance x is tensor(125.8942, device='cuda:3')
cal_distance is  tensor(125.8942, device='cuda:3')
cal ratio is  0.9737653939569176
distance x is tensor(122.5915, device='cuda:3')
cal_distance is  tensor(122.5915, device='cuda:3')
distance x is tensor(122.5915, device='cuda:3')
return_distance is  tensor(122.5915, device='cuda:3')
distance x is tensor(122.5812, device='cuda:3')
distance x is tensor(122.5812, device='cuda:3')
________________________________
test distance is  tensor(122.5812, device='cuda:3')
test distance1 is  tensor(122.5812, device='cuda:3')
test similarity is  tensor(0.9514, device='cuda:3')
test acc is  0.10003333348966531
test loss is 245.19800795370074
test entropy is  1.3333629682119513e-05
________________________________
0
distance x is tensor(122.5812, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.9249254915553734e-05
avg test loss is  245.1605701405865
avg accuracy is  0.242800000156338
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9514, device='cuda:3')
compute_distance is  tensor(122.5812, device='cuda:3')
compute_norm is  tensor(44.8405, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(106.8697, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9011369972213753
avg test loss is  1.4307448604722013
avg accuracy is  0.836650000156324
solo acc is  0.3340500001563401
compute similarity  is  tensor(0.9559, device='cuda:3')
compute_distance is  tensor(106.8697, device='cuda:3')
compute_norm is  tensor(44.0597, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(108.6225, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8754002077620167
avg test loss is  1.4945195162220042
avg accuracy is  0.836750000156324
solo acc is  0.2725333334896722
compute similarity  is  tensor(0.9556, device='cuda:3')
compute_distance is  tensor(108.6225, device='cuda:3')
compute_norm is  tensor(43.7841, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.1419, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8670002132463557
avg test loss is  1.4581853378810354
avg accuracy is  0.8386500001563238
solo acc is  0.2723000001563389
compute similarity  is  tensor(0.9553, device='cuda:3')
compute_distance is  tensor(110.1419, device='cuda:3')
compute_norm is  tensor(43.5310, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.5326, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8627350855229506
avg test loss is  1.4316323269913191
avg accuracy is  0.8407333334896571
solo acc is  0.27128333348967215
compute similarity  is  tensor(0.9551, device='cuda:3')
compute_distance is  tensor(111.5326, device='cuda:3')
compute_norm is  tensor(43.2918, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.0564, device='cuda:3')
distance x is tensor(113.0564, device='cuda:3')
________________________________
test distance is  tensor(113.0564, device='cuda:3')
test distance1 is  tensor(113.0564, device='cuda:3')
test similarity is  tensor(0.9548, device='cuda:3')
test acc is  0.2632833334896719
test loss is 1.4337191317381381
test entropy is  0.846014020031195
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2192983627319336
mal norm is  tensor(585.4124, device='cuda:3')
distance x is tensor(113.0646, device='cuda:3')
mal distance is  tensor(113.0646, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(27.3957, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.9584, device='cuda:3')
user_param_square tensor(115.0260, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-34.8998, device='cuda:3')
score : tensor(-0.3762, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(509.8380, device='cuda:3')
user_param_square tensor(118.1836, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-19.6127, device='cuda:3')
score : tensor(-0.2233, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.1255, device='cuda:3')
user_param_square tensor(123.0986, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(78.5396, device='cuda:3')
score : tensor(0.7582, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(475.0382, device='cuda:3')
user_param_square tensor(114.0789, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-47.4670, device='cuda:3')
score : tensor(-0.5019, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(525.7631, device='cuda:3')
user_param_square tensor(120.0152, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-36.8714, device='cuda:3')
score : tensor(-0.3959, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.6415, device='cuda:3')
user_param_square tensor(126.1233, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-104.1684, device='cuda:3')
score : tensor(-1.0689, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.7112, device='cuda:3')
user_param_square tensor(122.4946, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(10.7725, device='cuda:3')
score : tensor(0.0805, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.2838, device='cuda:3')
user_param_square tensor(120.8705, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-29.4264, device='cuda:3')
score : tensor(-0.3215, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4124, device='cuda:3')
user_param_square tensor(126.6404, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-20.2468, device='cuda:3')
score : tensor(-0.2297, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.5454, device='cuda:3')
user_param_square tensor(136.0406, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(88.9832, device='cuda:3')
score : tensor(0.8626, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4782, device='cuda:3')
user_param_square tensor(132.7725, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(40.6908, device='cuda:3')
score : tensor(0.3797, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.4699, device='cuda:3')
user_param_square tensor(138.9225, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(74.4066, device='cuda:3')
score : tensor(0.7169, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.7484, device='cuda:3')
user_param_square tensor(132.4906, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(231.5351, device='cuda:3')
score : tensor(2.2882, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.8735, device='cuda:3')
user_param_square tensor(134.2494, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(17.6379, device='cuda:3')
score : tensor(0.1492, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.9170, device='cuda:3')
user_param_square tensor(131.3660, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-46.6505, device='cuda:3')
score : tensor(-0.4937, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.6180, device='cuda:3')
user_param_square tensor(132.1665, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(-22.5338, device='cuda:3')
score : tensor(-0.2525, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.2346, device='cuda:3')
user_param_square tensor(130.8768, device='cuda:3')
global_param_square tensor(27.3957, device='cuda:3')
part1 is  tensor(27.1492, device='cuda:3')
score : tensor(0.2443, device='cuda:3')
accept
len accept list 8
len all weights is 8
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 89.41% 

Test Accuracy: 88.81% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
 benign loss is  0.220998615026474
distance x is tensor(118.7638, device='cuda:3')
benign distance is  tensor(118.7638, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.1858968734741211
distance x is tensor(124.2883, device='cuda:3')
benign distance is  tensor(124.2883, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.06831835955381393
distance x is tensor(118.8597, device='cuda:3')
benign distance is  tensor(118.8597, device='cuda:3')
norm1 res is  tensor(0.1328, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.44272178411483765
distance x is tensor(103.5537, device='cuda:3')
benign distance is  tensor(103.5537, device='cuda:3')
norm1 res is  tensor(0.1180, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4227953553199768
distance x is tensor(93.8528, device='cuda:3')
benign distance is  tensor(93.8528, device='cuda:3')
norm1 res is  tensor(0.1052, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5067260265350342
distance x is tensor(117.0877, device='cuda:3')
benign distance is  tensor(117.0877, device='cuda:3')
norm1 res is  tensor(0.1323, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2585829794406891
distance x is tensor(113.2932, device='cuda:3')
benign distance is  tensor(113.2932, device='cuda:3')
norm1 res is  tensor(0.1301, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.352220356464386
distance x is tensor(121.8992, device='cuda:3')
benign distance is  tensor(121.8992, device='cuda:3')
norm1 res is  tensor(0.1377, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.2501893639564514
distance x is tensor(126.7029, device='cuda:3')
benign distance is  tensor(126.7029, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.13167794048786163
distance x is tensor(133.7737, device='cuda:3')
benign distance is  tensor(133.7737, device='cuda:3')
norm1 res is  tensor(0.1551, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.24457542598247528
distance x is tensor(134.2444, device='cuda:3')
benign distance is  tensor(134.2444, device='cuda:3')
norm1 res is  tensor(0.1536, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.08764518797397614
distance x is tensor(128.7791, device='cuda:3')
benign distance is  tensor(128.7791, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.23016877472400665
distance x is tensor(115.8843, device='cuda:3')
benign distance is  tensor(115.8843, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.2553882896900177
distance x is tensor(125.8379, device='cuda:3')
benign distance is  tensor(125.8379, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.4170190691947937
distance x is tensor(118.3081, device='cuda:3')
benign distance is  tensor(118.3081, device='cuda:3')
norm1 res is  tensor(0.1329, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.4708114266395569
distance x is tensor(119.0313, device='cuda:3')
benign distance is  tensor(119.0313, device='cuda:3')
norm1 res is  tensor(0.1313, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(110.0703, device='cuda:3')
compute distance is  tensor(110.0703, device='cuda:3')
compute norm is  tensor(45.6238, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.5717, device='cuda:3')
compute distance is  tensor(111.5717, device='cuda:3')
compute norm is  tensor(45.6702, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5049, device='cuda:3')
compute distance is  tensor(125.5049, device='cuda:3')
compute norm is  tensor(46.1075, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.8903, device='cuda:3')
compute distance is  tensor(113.8903, device='cuda:3')
compute norm is  tensor(45.8175, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.4617, device='cuda:3')
compute distance is  tensor(113.4617, device='cuda:3')
compute norm is  tensor(45.7727, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0903, device='cuda:3')
compute distance is  tensor(127.0903, device='cuda:3')
compute norm is  tensor(46.1778, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.8780, device='cuda:3')
compute distance is  tensor(113.8780, device='cuda:3')
compute norm is  tensor(45.8557, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.9010, device='cuda:3')
compute distance is  tensor(115.9010, device='cuda:3')
compute norm is  tensor(45.7680, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.7903, device='cuda:3')
compute distance is  tensor(111.7903, device='cuda:3')
compute norm is  tensor(45.8060, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.4222, device='cuda:3')
compute distance is  tensor(117.4222, device='cuda:3')
compute norm is  tensor(45.9853, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7467, device='cuda:3')
compute distance is  tensor(120.7467, device='cuda:3')
compute norm is  tensor(46.0740, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3382, device='cuda:3')
compute distance is  tensor(129.3382, device='cuda:3')
compute norm is  tensor(45.9499, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(129.3382, device='cuda:3')
distance x is tensor(107703.6484, device='cuda:3')
distance x is tensor(107703.6484, device='cuda:3')
________________________________
test distance is  tensor(107703.6484, device='cuda:3')
test distance1 is  tensor(107703.6484, device='cuda:3')
test similarity is  tensor(-0.0703, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130117860274883.4
test entropy is  0.0
________________________________
cal ratio is  0.03396051174816835
distance x is tensor(3657.6765, device='cuda:3')
cal_distance is  tensor(3657.6765, device='cuda:3')
cal ratio is  0.1842836415438231
distance x is tensor(674.0542, device='cuda:3')
cal_distance is  tensor(674.0542, device='cuda:3')
cal ratio is  0.42928134180626015
distance x is tensor(289.3618, device='cuda:3')
cal_distance is  tensor(289.3618, device='cuda:3')
cal ratio is  0.6551923500521247
distance x is tensor(189.5895, device='cuda:3')
cal_distance is  tensor(189.5895, device='cuda:3')
cal ratio is  0.8094355945071361
distance x is tensor(153.4615, device='cuda:3')
cal_distance is  tensor(153.4615, device='cuda:3')
cal ratio is  0.8996834718747213
distance x is tensor(138.0673, device='cuda:3')
cal_distance is  tensor(138.0673, device='cuda:3')
cal ratio is  0.9485146568123102
distance x is tensor(130.9591, device='cuda:3')
cal_distance is  tensor(130.9591, device='cuda:3')
cal ratio is  0.9739161697658542
distance x is tensor(127.5433, device='cuda:3')
cal_distance is  tensor(127.5433, device='cuda:3')
distance x is tensor(127.5433, device='cuda:3')
return_distance is  tensor(127.5433, device='cuda:3')
distance x is tensor(127.5330, device='cuda:3')
distance x is tensor(127.5330, device='cuda:3')
________________________________
test distance is  tensor(127.5330, device='cuda:3')
test distance1 is  tensor(127.5330, device='cuda:3')
test similarity is  tensor(0.9470, device='cuda:3')
test acc is  0.10005000015633199
test loss is 287.43376992557097
test entropy is  1.2964237588826388e-06
________________________________
0
distance x is tensor(127.5330, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.970502836312094e-06
avg test loss is  287.5896961399233
avg accuracy is  0.28016666682300573
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9470, device='cuda:3')
compute_distance is  tensor(127.5330, device='cuda:3')
compute_norm is  tensor(44.9098, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(108.4722, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8965758992029406
avg test loss is  1.5150821088219502
avg accuracy is  0.8491333334896567
solo acc is  0.3139666668230065
compute similarity  is  tensor(0.9534, device='cuda:3')
compute_distance is  tensor(108.4722, device='cuda:3')
compute_norm is  tensor(43.8794, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.6368, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8904552800950211
avg test loss is  1.501947768207298
avg accuracy is  0.8486666668229901
solo acc is  0.2869000001563392
compute similarity  is  tensor(0.9529, device='cuda:3')
compute_distance is  tensor(110.6368, device='cuda:3')
compute_norm is  tensor(43.5784, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.5333, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8830344633761246
avg test loss is  1.4465258901815679
avg accuracy is  0.8535166668229899
solo acc is  0.2890500001563393
compute similarity  is  tensor(0.9526, device='cuda:3')
compute_distance is  tensor(112.5333, device='cuda:3')
compute_norm is  tensor(43.3087, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.3794, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8679537337853201
avg test loss is  1.4365767244336956
avg accuracy is  0.8537333334896565
solo acc is  0.279850000156339
compute similarity  is  tensor(0.9522, device='cuda:3')
compute_distance is  tensor(114.3794, device='cuda:3')
compute_norm is  tensor(43.0556, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.2507, device='cuda:3')
distance x is tensor(116.2507, device='cuda:3')
________________________________
test distance is  tensor(116.2507, device='cuda:3')
test distance1 is  tensor(116.2507, device='cuda:3')
test similarity is  tensor(0.9519, device='cuda:3')
test acc is  0.27843333348967236
test loss is 1.4145565022791882
test entropy is  0.8621379456667504
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2855199575424194
mal norm is  tensor(605.9530, device='cuda:3')
distance x is tensor(116.2586, device='cuda:3')
mal distance is  tensor(116.2586, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(12.5569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.1234, device='cuda:3')
user_param_square tensor(82.7347, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(5.1075, device='cuda:3')
score : tensor(0.0387, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.4326, device='cuda:3')
user_param_square tensor(83.8884, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(5.3828, device='cuda:3')
score : tensor(0.0415, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(525.4780, device='cuda:3')
user_param_square tensor(81.2302, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(8.5583, device='cuda:3')
score : tensor(0.0732, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.2342, device='cuda:3')
user_param_square tensor(76.4322, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(7.6311, device='cuda:3')
score : tensor(0.0640, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(418.7720, device='cuda:3')
user_param_square tensor(72.5152, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-2.5403, device='cuda:3')
score : tensor(-0.0378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.7444, device='cuda:3')
user_param_square tensor(81.0187, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(2.1856, device='cuda:3')
score : tensor(0.0095, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.7645, device='cuda:3')
user_param_square tensor(79.8494, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(18.9106, device='cuda:3')
score : tensor(0.1767, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.8486, device='cuda:3')
user_param_square tensor(82.7139, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(4.1799, device='cuda:3')
score : tensor(0.0294, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9530, device='cuda:3')
user_param_square tensor(87.2288, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(16.8176, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.9160, device='cuda:3')
user_param_square tensor(86.5759, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-3.6395, device='cuda:3')
score : tensor(-0.0488, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.9744, device='cuda:3')
user_param_square tensor(85.5589, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(4.4675, device='cuda:3')
score : tensor(0.0323, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.8270, device='cuda:3')
user_param_square tensor(88.2217, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(8.1311, device='cuda:3')
score : tensor(0.0690, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9005, device='cuda:3')
user_param_square tensor(87.7274, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-7.6141, device='cuda:3')
score : tensor(-0.0885, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.7467, device='cuda:3')
user_param_square tensor(91.3626, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(2.5220, device='cuda:3')
score : tensor(0.0129, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.5010, device='cuda:3')
user_param_square tensor(86.1823, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-14.7765, device='cuda:3')
score : tensor(-0.1601, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.7286, device='cuda:3')
user_param_square tensor(90.4636, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-28.2047, device='cuda:3')
score : tensor(-0.2944, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.5180, device='cuda:3')
user_param_square tensor(89.7522, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-14.7204, device='cuda:3')
score : tensor(-0.1596, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.2783, device='cuda:3')
user_param_square tensor(94.4397, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(0.9463, device='cuda:3')
score : tensor(-0.0029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.9811, device='cuda:3')
user_param_square tensor(99.3451, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-30.1631, device='cuda:3')
score : tensor(-0.3140, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.8149, device='cuda:3')
user_param_square tensor(95.2695, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-23.6359, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.5724, device='cuda:3')
user_param_square tensor(93.3897, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(7.7554, device='cuda:3')
score : tensor(0.0652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.7368, device='cuda:3')
user_param_square tensor(96.8980, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-10.7718, device='cuda:3')
score : tensor(-0.1201, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.3521, device='cuda:3')
user_param_square tensor(92.2248, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-2.2894, device='cuda:3')
score : tensor(-0.0353, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.8951, device='cuda:3')
user_param_square tensor(96.8434, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(1.2070, device='cuda:3')
score : tensor(-0.0003, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7775, device='cuda:3')
user_param_square tensor(93.6720, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-18.5056, device='cuda:3')
score : tensor(-0.1974, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.6338, device='cuda:3')
user_param_square tensor(88.4213, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(1.1733, device='cuda:3')
score : tensor(-0.0006, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.2824, device='cuda:3')
user_param_square tensor(89.5255, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-13.9554, device='cuda:3')
score : tensor(-0.1519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.7191, device='cuda:3')
user_param_square tensor(88.0716, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-13.5083, device='cuda:3')
score : tensor(-0.1474, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.2587, device='cuda:3')
user_param_square tensor(87.2508, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-36.7727, device='cuda:3')
score : tensor(-0.3801, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7094, device='cuda:3')
user_param_square tensor(88.6394, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-14.8038, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.0159, device='cuda:3')
user_param_square tensor(88.1640, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(4.3602, device='cuda:3')
score : tensor(0.0312, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.2278, device='cuda:3')
user_param_square tensor(87.9652, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-22.9749, device='cuda:3')
score : tensor(-0.2421, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.9117, device='cuda:3')
user_param_square tensor(91.0297, device='cuda:3')
global_param_square tensor(12.5569, device='cuda:3')
part1 is  tensor(-37.2184, device='cuda:3')
score : tensor(-0.3845, device='cuda:3')
len accept list 24
len all weights is 24
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 88.18% 

Test Accuracy: 87.30% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4278525710105896
distance x is tensor(119.1066, device='cuda:3')
benign distance is  tensor(119.1066, device='cuda:3')
norm1 res is  tensor(0.1325, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8195193409919739
distance x is tensor(130.9539, device='cuda:3')
benign distance is  tensor(130.9539, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3598167300224304
distance x is tensor(127.1206, device='cuda:3')
benign distance is  tensor(127.1206, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7955462336540222
distance x is tensor(129.2147, device='cuda:3')
benign distance is  tensor(129.2147, device='cuda:3')
norm1 res is  tensor(0.1406, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7040242552757263
distance x is tensor(113.4962, device='cuda:3')
benign distance is  tensor(113.4962, device='cuda:3')
norm1 res is  tensor(0.1246, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6514975428581238
distance x is tensor(129.7268, device='cuda:3')
benign distance is  tensor(129.7268, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.24171757698059082
distance x is tensor(128.4767, device='cuda:3')
benign distance is  tensor(128.4767, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.47729477286338806
distance x is tensor(145.0054, device='cuda:3')
benign distance is  tensor(145.0054, device='cuda:3')
norm1 res is  tensor(0.1578, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3153446316719055
distance x is tensor(140.3754, device='cuda:3')
benign distance is  tensor(140.3754, device='cuda:3')
norm1 res is  tensor(0.1559, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.1969624012708664
distance x is tensor(144.4131, device='cuda:3')
benign distance is  tensor(144.4131, device='cuda:3')
norm1 res is  tensor(0.1566, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.5613808631896973
distance x is tensor(126.2880, device='cuda:3')
benign distance is  tensor(126.2880, device='cuda:3')
norm1 res is  tensor(0.1358, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.31341081857681274
distance x is tensor(132.7621, device='cuda:3')
benign distance is  tensor(132.7621, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.3337264955043793
distance x is tensor(136.9990, device='cuda:3')
benign distance is  tensor(136.9990, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.20771875977516174
distance x is tensor(140.5971, device='cuda:3')
benign distance is  tensor(140.5971, device='cuda:3')
norm1 res is  tensor(0.1524, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4696231484413147
distance x is tensor(132.7779, device='cuda:3')
benign distance is  tensor(132.7779, device='cuda:3')
norm1 res is  tensor(0.1492, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3952590525150299
distance x is tensor(143.4902, device='cuda:3')
benign distance is  tensor(143.4902, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.22933073341846466
distance x is tensor(133.4893, device='cuda:3')
benign distance is  tensor(133.4893, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.5868511199951172
distance x is tensor(148.6929, device='cuda:3')
benign distance is  tensor(148.6929, device='cuda:3')
norm1 res is  tensor(0.1627, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.35922160744667053
distance x is tensor(132.9616, device='cuda:3')
benign distance is  tensor(132.9616, device='cuda:3')
norm1 res is  tensor(0.1454, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.33648067712783813
distance x is tensor(136.3337, device='cuda:3')
benign distance is  tensor(136.3337, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.08464056253433228
distance x is tensor(139.9396, device='cuda:3')
benign distance is  tensor(139.9396, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.4350431561470032
distance x is tensor(130.0866, device='cuda:3')
benign distance is  tensor(130.0866, device='cuda:3')
norm1 res is  tensor(0.1428, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.16820386052131653
distance x is tensor(148.4909, device='cuda:3')
benign distance is  tensor(148.4909, device='cuda:3')
norm1 res is  tensor(0.1618, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.5397643446922302
distance x is tensor(143.3096, device='cuda:3')
benign distance is  tensor(143.3096, device='cuda:3')
norm1 res is  tensor(0.1561, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.39422452449798584
distance x is tensor(134.2265, device='cuda:3')
benign distance is  tensor(134.2265, device='cuda:3')
norm1 res is  tensor(0.1459, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.3231669068336487
distance x is tensor(133.6349, device='cuda:3')
benign distance is  tensor(133.6349, device='cuda:3')
norm1 res is  tensor(0.1422, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.11882929503917694
distance x is tensor(138.8314, device='cuda:3')
benign distance is  tensor(138.8314, device='cuda:3')
norm1 res is  tensor(0.1519, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.14545294642448425
distance x is tensor(143.2628, device='cuda:3')
benign distance is  tensor(143.2628, device='cuda:3')
norm1 res is  tensor(0.1602, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.4088265895843506
distance x is tensor(128.6768, device='cuda:3')
benign distance is  tensor(128.6768, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.3753938376903534
distance x is tensor(135.9049, device='cuda:3')
benign distance is  tensor(135.9049, device='cuda:3')
norm1 res is  tensor(0.1450, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.6972929835319519
distance x is tensor(140.5388, device='cuda:3')
benign distance is  tensor(140.5388, device='cuda:3')
norm1 res is  tensor(0.1533, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.3506769835948944
distance x is tensor(143.0466, device='cuda:3')
benign distance is  tensor(143.0466, device='cuda:3')
norm1 res is  tensor(0.1577, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(124.1035, device='cuda:3')
compute distance is  tensor(124.1035, device='cuda:3')
compute norm is  tensor(44.9503, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4004, device='cuda:3')
compute distance is  tensor(126.4004, device='cuda:3')
compute norm is  tensor(44.9121, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.1015, device='cuda:3')
compute distance is  tensor(145.1015, device='cuda:3')
compute norm is  tensor(45.6710, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5825, device='cuda:3')
compute distance is  tensor(124.5825, device='cuda:3')
compute norm is  tensor(45.1039, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8744, device='cuda:3')
compute distance is  tensor(137.8744, device='cuda:3')
compute norm is  tensor(45.4375, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8264, device='cuda:3')
compute distance is  tensor(132.8264, device='cuda:3')
compute norm is  tensor(45.3598, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8933, device='cuda:3')
compute distance is  tensor(131.8933, device='cuda:3')
compute norm is  tensor(45.2856, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.9510, device='cuda:3')
compute distance is  tensor(133.9510, device='cuda:3')
compute norm is  tensor(45.1443, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.9974, device='cuda:3')
compute distance is  tensor(133.9974, device='cuda:3')
compute norm is  tensor(45.3714, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7968, device='cuda:3')
compute distance is  tensor(131.7968, device='cuda:3')
compute norm is  tensor(45.3434, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7790, device='cuda:3')
compute distance is  tensor(131.7790, device='cuda:3')
compute norm is  tensor(45.3263, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3328, device='cuda:3')
compute distance is  tensor(134.3328, device='cuda:3')
compute norm is  tensor(45.2919, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.1015, device='cuda:3')
distance x is tensor(107674.9844, device='cuda:3')
distance x is tensor(107674.9844, device='cuda:3')
________________________________
test distance is  tensor(107674.9844, device='cuda:3')
test distance1 is  tensor(107674.9844, device='cuda:3')
test similarity is  tensor(0.0384, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130050990495154.48
test entropy is  0.0
________________________________
cal ratio is  0.035975310715964846
distance x is tensor(3873.6472, device='cuda:3')
cal_distance is  tensor(3873.6472, device='cuda:3')
cal ratio is  0.1896714327981685
distance x is tensor(734.7242, device='cuda:3')
cal_distance is  tensor(734.7242, device='cuda:3')
cal ratio is  0.43551164150308347
distance x is tensor(319.9838, device='cuda:3')
cal_distance is  tensor(319.9838, device='cuda:3')
cal ratio is  0.6599301045336953
distance x is tensor(211.1688, device='cuda:3')
cal_distance is  tensor(211.1688, device='cuda:3')
cal ratio is  0.8123573326447184
distance x is tensor(171.5455, device='cuda:3')
cal_distance is  tensor(171.5455, device='cuda:3')
cal ratio is  0.9013061553163567
distance x is tensor(154.6155, device='cuda:3')
cal_distance is  tensor(154.6155, device='cuda:3')
cal ratio is  0.94936984460723
distance x is tensor(146.7876, device='cuda:3')
cal_distance is  tensor(146.7876, device='cuda:3')
cal ratio is  0.9743551970788565
distance x is tensor(143.0234, device='cuda:3')
cal_distance is  tensor(143.0234, device='cuda:3')
distance x is tensor(143.0234, device='cuda:3')
return_distance is  tensor(143.0234, device='cuda:3')
distance x is tensor(143.0131, device='cuda:3')
distance x is tensor(143.0131, device='cuda:3')
________________________________
test distance is  tensor(143.0131, device='cuda:3')
test distance1 is  tensor(143.0131, device='cuda:3')
test similarity is  tensor(0.9369, device='cuda:3')
test acc is  0.10000000015633198
test loss is 503.3908920776107
test entropy is  2.8449504229728354e-22
________________________________
0
distance x is tensor(143.0131, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.9849595857141607e-31
avg test loss is  503.88323128706355
avg accuracy is  0.10065000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9369, device='cuda:3')
compute_distance is  tensor(143.0131, device='cuda:3')
compute_norm is  tensor(45.4984, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(121.8355, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9630620813827271
avg test loss is  1.46771709713092
avg accuracy is  0.679250000156332
solo acc is  0.306433333489673
compute similarity  is  tensor(0.9442, device='cuda:3')
compute_distance is  tensor(121.8355, device='cuda:3')
compute_norm is  tensor(44.9921, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(121.8355, device='cuda:3')
distance x is tensor(121.8355, device='cuda:3')
________________________________
test distance is  tensor(121.8355, device='cuda:3')
test distance1 is  tensor(121.8355, device='cuda:3')
test similarity is  tensor(0.9442, device='cuda:3')
test acc is  0.3061666668230063
test loss is 1.466254572370159
test entropy is  0.9618150717668188
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1260521411895752
mal norm is  tensor(676.1449, device='cuda:3')
distance x is tensor(121.8446, device='cuda:3')
mal distance is  tensor(121.8446, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(13.4243, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.1479, device='cuda:3')
user_param_square tensor(83.7226, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(24.2556, device='cuda:3')
score : tensor(0.2293, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.7570, device='cuda:3')
user_param_square tensor(87.3794, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(23.8277, device='cuda:3')
score : tensor(0.2251, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.3502, device='cuda:3')
user_param_square tensor(86.8086, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(22.5770, device='cuda:3')
score : tensor(0.2125, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.5684, device='cuda:3')
user_param_square tensor(85.5012, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(6.4670, device='cuda:3')
score : tensor(0.0514, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(493.4514, device='cuda:3')
user_param_square tensor(81.3894, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(15.9191, device='cuda:3')
score : tensor(0.1460, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.4757, device='cuda:3')
user_param_square tensor(86.8956, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-1.6645, device='cuda:3')
score : tensor(-0.0299, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.3196, device='cuda:3')
user_param_square tensor(85.4816, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(2.6144, device='cuda:3')
score : tensor(0.0129, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.2026, device='cuda:3')
user_param_square tensor(91.4662, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(9.7785, device='cuda:3')
score : tensor(0.0846, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1449, device='cuda:3')
user_param_square tensor(95.2721, device='cuda:3')
global_param_square tensor(13.4243, device='cuda:3')
part1 is  tensor(-37.9485, device='cuda:3')
score : tensor(-0.3927, device='cuda:3')
len accept list 7
len all weights is 7
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 89.35% 

Test Accuracy: 88.49% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
 benign loss is  1.2030256986618042
distance x is tensor(114.0579, device='cuda:3')
benign distance is  tensor(114.0579, device='cuda:3')
norm1 res is  tensor(0.1282, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3561778962612152
distance x is tensor(119.9715, device='cuda:3')
benign distance is  tensor(119.9715, device='cuda:3')
norm1 res is  tensor(0.1320, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.22611775994300842
distance x is tensor(117.6449, device='cuda:3')
benign distance is  tensor(117.6449, device='cuda:3')
norm1 res is  tensor(0.1268, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6298754811286926
distance x is tensor(112.8323, device='cuda:3')
benign distance is  tensor(112.8323, device='cuda:3')
norm1 res is  tensor(0.1237, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6934814453125
distance x is tensor(103.6815, device='cuda:3')
benign distance is  tensor(103.6815, device='cuda:3')
norm1 res is  tensor(0.1151, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6411100029945374
distance x is tensor(128.2179, device='cuda:3')
benign distance is  tensor(128.2179, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.23498249053955078
distance x is tensor(118.0665, device='cuda:3')
benign distance is  tensor(118.0665, device='cuda:3')
norm1 res is  tensor(0.1292, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.14059653878211975
distance x is tensor(121.0705, device='cuda:3')
benign distance is  tensor(121.0705, device='cuda:3')
norm1 res is  tensor(0.1368, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(120.1039, device='cuda:3')
compute distance is  tensor(120.1039, device='cuda:3')
compute norm is  tensor(45.5122, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8519, device='cuda:3')
compute distance is  tensor(133.8519, device='cuda:3')
compute norm is  tensor(45.9200, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0551, device='cuda:3')
compute distance is  tensor(133.0551, device='cuda:3')
compute norm is  tensor(46.0513, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1288, device='cuda:3')
compute distance is  tensor(118.1288, device='cuda:3')
compute norm is  tensor(45.4777, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9537, device='cuda:3')
compute distance is  tensor(124.9537, device='cuda:3')
compute norm is  tensor(45.6586, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2058, device='cuda:3')
compute distance is  tensor(134.2058, device='cuda:3')
compute norm is  tensor(46.0446, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6618, device='cuda:3')
compute distance is  tensor(127.6618, device='cuda:3')
compute norm is  tensor(45.8268, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.8242, device='cuda:3')
compute distance is  tensor(129.8242, device='cuda:3')
compute norm is  tensor(45.5811, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4118, device='cuda:3')
compute distance is  tensor(134.4118, device='cuda:3')
compute norm is  tensor(45.8859, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1162, device='cuda:3')
compute distance is  tensor(122.1162, device='cuda:3')
compute norm is  tensor(45.6473, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0235, device='cuda:3')
compute distance is  tensor(134.0235, device='cuda:3')
compute norm is  tensor(45.9368, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.6747, device='cuda:3')
compute distance is  tensor(120.6747, device='cuda:3')
compute norm is  tensor(45.6245, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(134.4118, device='cuda:3')
distance x is tensor(107683.3984, device='cuda:3')
distance x is tensor(107683.3984, device='cuda:3')
________________________________
test distance is  tensor(107683.3984, device='cuda:3')
test distance1 is  tensor(107683.3984, device='cuda:3')
test similarity is  tensor(0.0125, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130086677806754.66
test entropy is  0.0
________________________________
cal ratio is  0.03462345682040163
distance x is tensor(3728.3767, device='cuda:3')
cal_distance is  tensor(3728.3767, device='cuda:3')
cal ratio is  0.18607366919173593
distance x is tensor(693.7569, device='cuda:3')
cal_distance is  tensor(693.7569, device='cuda:3')
cal ratio is  0.4313612669718354
distance x is tensor(299.2628, device='cuda:3')
cal_distance is  tensor(299.2628, device='cuda:3')
cal ratio is  0.6567777740470753
distance x is tensor(196.5509, device='cuda:3')
cal_distance is  tensor(196.5509, device='cuda:3')
cal ratio is  0.8104146332376134
distance x is tensor(159.2887, device='cuda:3')
cal_distance is  tensor(159.2887, device='cuda:3')
cal ratio is  0.9002275104520858
distance x is tensor(143.3966, device='cuda:3')
cal_distance is  tensor(143.3966, device='cuda:3')
cal ratio is  0.948801554722843
distance x is tensor(136.0552, device='cuda:3')
cal_distance is  tensor(136.0552, device='cuda:3')
cal ratio is  0.9740634548976844
distance x is tensor(132.5265, device='cuda:3')
cal_distance is  tensor(132.5265, device='cuda:3')
distance x is tensor(132.5265, device='cuda:3')
return_distance is  tensor(132.5265, device='cuda:3')
distance x is tensor(132.5163, device='cuda:3')
distance x is tensor(132.5163, device='cuda:3')
________________________________
test distance is  tensor(132.5163, device='cuda:3')
test distance1 is  tensor(132.5163, device='cuda:3')
test similarity is  tensor(0.9454, device='cuda:3')
test acc is  0.10003333348966531
test loss is 302.3693582335515
test entropy is  1.413069234314832e-05
________________________________
0
distance x is tensor(132.5163, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2517407668579544e-06
avg test loss is  302.50276680236686
avg accuracy is  0.20293333348966977
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9454, device='cuda:3')
compute_distance is  tensor(132.5163, device='cuda:3')
compute_norm is  tensor(45.5724, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(114.1299, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9380851159217769
avg test loss is  1.3963511171879799
avg accuracy is  0.8375666668229905
solo acc is  0.33761666682300695
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(114.1299, device='cuda:3')
compute_norm is  tensor(44.8754, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.5426, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8765866016782423
avg test loss is  1.5076468684780064
avg accuracy is  0.8366000001563239
solo acc is  0.2643333334896719
compute similarity  is  tensor(0.9507, device='cuda:3')
compute_distance is  tensor(115.5426, device='cuda:3')
compute_norm is  tensor(44.6030, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.8087, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8661713273540489
avg test loss is  1.463838364650954
avg accuracy is  0.8394500001563239
solo acc is  0.2689166668230055
compute similarity  is  tensor(0.9505, device='cuda:3')
compute_distance is  tensor(116.8087, device='cuda:3')
compute_norm is  tensor(44.3523, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.1310, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8602128309735866
avg test loss is  1.4488755050244362
avg accuracy is  0.842233333489657
solo acc is  0.26176666682300526
compute similarity  is  tensor(0.9503, device='cuda:3')
compute_distance is  tensor(118.1310, device='cuda:3')
compute_norm is  tensor(44.1117, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.4439, device='cuda:3')
distance x is tensor(119.4439, device='cuda:3')
________________________________
test distance is  tensor(119.4439, device='cuda:3')
test distance1 is  tensor(119.4439, device='cuda:3')
test similarity is  tensor(0.9501, device='cuda:3')
test acc is  0.2702500001563388
test loss is 1.404931277862744
test entropy is  0.8622715326387491
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3214056491851807
mal norm is  tensor(626.3483, device='cuda:3')
distance x is tensor(119.4524, device='cuda:3')
mal distance is  tensor(119.4524, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(21.0522, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.4847, device='cuda:3')
user_param_square tensor(102.9537, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(13.5756, device='cuda:3')
score : tensor(0.1149, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.4994, device='cuda:3')
user_param_square tensor(104.8798, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(25.3775, device='cuda:3')
score : tensor(0.2329, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.1982, device='cuda:3')
user_param_square tensor(102.7197, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(36.7230, device='cuda:3')
score : tensor(0.3464, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.6863, device='cuda:3')
user_param_square tensor(101.5332, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-36.1616, device='cuda:3')
score : tensor(-0.3825, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.0914, device='cuda:3')
user_param_square tensor(97.7734, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-13.2143, device='cuda:3')
score : tensor(-0.1530, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.7069, device='cuda:3')
user_param_square tensor(109.2265, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-20.0203, device='cuda:3')
score : tensor(-0.2211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.1498, device='cuda:3')
user_param_square tensor(102.6122, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-7.0229, device='cuda:3')
score : tensor(-0.0911, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(540.8272, device='cuda:3')
user_param_square tensor(106.7034, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-18.7956, device='cuda:3')
score : tensor(-0.2088, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3483, device='cuda:3')
user_param_square tensor(114.8304, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-15.0235, device='cuda:3')
score : tensor(-0.1711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.1155, device='cuda:3')
user_param_square tensor(115.4491, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-10.7149, device='cuda:3')
score : tensor(-0.1280, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.7695, device='cuda:3')
user_param_square tensor(110.6686, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-19.4654, device='cuda:3')
score : tensor(-0.2155, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.3572, device='cuda:3')
user_param_square tensor(117.6385, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(38.6702, device='cuda:3')
score : tensor(0.3658, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.9589, device='cuda:3')
user_param_square tensor(117.4238, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-21.7918, device='cuda:3')
score : tensor(-0.2388, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.1542, device='cuda:3')
user_param_square tensor(110.1332, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-37.1696, device='cuda:3')
score : tensor(-0.3925, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.0665, device='cuda:3')
user_param_square tensor(113.8840, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-5.5056, device='cuda:3')
score : tensor(-0.0759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.5508, device='cuda:3')
user_param_square tensor(116.0343, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(75.5824, device='cuda:3')
score : tensor(0.7350, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.9083, device='cuda:3')
user_param_square tensor(114.6065, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(36.8694, device='cuda:3')
score : tensor(0.3478, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.1833, device='cuda:3')
user_param_square tensor(114.6318, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(62.5076, device='cuda:3')
score : tensor(0.6042, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.9886, device='cuda:3')
user_param_square tensor(114.8891, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-20.6016, device='cuda:3')
score : tensor(-0.2269, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.9861, device='cuda:3')
user_param_square tensor(107.2111, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-5.0280, device='cuda:3')
score : tensor(-0.0711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.3760, device='cuda:3')
user_param_square tensor(111.2952, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-17.5088, device='cuda:3')
score : tensor(-0.1959, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.5184, device='cuda:3')
user_param_square tensor(113.3700, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(34.3285, device='cuda:3')
score : tensor(0.3224, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.4708, device='cuda:3')
user_param_square tensor(113.3656, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-3.5257, device='cuda:3')
score : tensor(-0.0561, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.6389, device='cuda:3')
user_param_square tensor(112.1678, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(-20.9236, device='cuda:3')
score : tensor(-0.2301, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.1882, device='cuda:3')
user_param_square tensor(114.7240, device='cuda:3')
global_param_square tensor(21.0522, device='cuda:3')
part1 is  tensor(7.5913, device='cuda:3')
score : tensor(0.0551, device='cuda:3')
accept
len accept list 9
len all weights is 9
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.81% 

Test Accuracy: 88.96% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4881228506565094
distance x is tensor(96.2112, device='cuda:3')
benign distance is  tensor(96.2112, device='cuda:3')
norm1 res is  tensor(0.1085, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.0527063608169556
distance x is tensor(99.4675, device='cuda:3')
benign distance is  tensor(99.4675, device='cuda:3')
norm1 res is  tensor(0.1116, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.08467201888561249
distance x is tensor(112.8337, device='cuda:3')
benign distance is  tensor(112.8337, device='cuda:3')
norm1 res is  tensor(0.1274, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4398372173309326
distance x is tensor(115.1898, device='cuda:3')
benign distance is  tensor(115.1898, device='cuda:3')
norm1 res is  tensor(0.1304, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3076048493385315
distance x is tensor(117.9139, device='cuda:3')
benign distance is  tensor(117.9139, device='cuda:3')
norm1 res is  tensor(0.1309, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.860427975654602
distance x is tensor(123.8617, device='cuda:3')
benign distance is  tensor(123.8617, device='cuda:3')
norm1 res is  tensor(0.1381, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.1524147391319275
distance x is tensor(99.5417, device='cuda:3')
benign distance is  tensor(99.5417, device='cuda:3')
norm1 res is  tensor(0.1098, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.1698789894580841
distance x is tensor(116.3951, device='cuda:3')
benign distance is  tensor(116.3951, device='cuda:3')
norm1 res is  tensor(0.1328, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.27584221959114075
distance x is tensor(142.9994, device='cuda:3')
benign distance is  tensor(142.9994, device='cuda:3')
norm1 res is  tensor(0.1602, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.2945210933685303
distance x is tensor(131.6886, device='cuda:3')
benign distance is  tensor(131.6886, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.6250923871994019
distance x is tensor(127.9921, device='cuda:3')
benign distance is  tensor(127.9921, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.33491721749305725
distance x is tensor(127.5470, device='cuda:3')
benign distance is  tensor(127.5470, device='cuda:3')
norm1 res is  tensor(0.1428, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.46874362230300903
distance x is tensor(125.0014, device='cuda:3')
benign distance is  tensor(125.0014, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.24913200736045837
distance x is tensor(141.8348, device='cuda:3')
benign distance is  tensor(141.8348, device='cuda:3')
norm1 res is  tensor(0.1569, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.44724297523498535
distance x is tensor(130.3864, device='cuda:3')
benign distance is  tensor(130.3864, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.7185295224189758
distance x is tensor(134.4938, device='cuda:3')
benign distance is  tensor(134.4938, device='cuda:3')
norm1 res is  tensor(0.1499, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.1576753556728363
distance x is tensor(133.8102, device='cuda:3')
benign distance is  tensor(133.8102, device='cuda:3')
norm1 res is  tensor(0.1484, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.2740422785282135
distance x is tensor(124.2848, device='cuda:3')
benign distance is  tensor(124.2848, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.6201759576797485
distance x is tensor(136.9688, device='cuda:3')
benign distance is  tensor(136.9688, device='cuda:3')
norm1 res is  tensor(0.1510, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.7318147420883179
distance x is tensor(142.8306, device='cuda:3')
benign distance is  tensor(142.8306, device='cuda:3')
norm1 res is  tensor(0.1598, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.6442002654075623
distance x is tensor(132.1211, device='cuda:3')
benign distance is  tensor(132.1211, device='cuda:3')
norm1 res is  tensor(0.1443, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.35491013526916504
distance x is tensor(136.3450, device='cuda:3')
benign distance is  tensor(136.3450, device='cuda:3')
norm1 res is  tensor(0.1500, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.24289441108703613
distance x is tensor(126.9283, device='cuda:3')
benign distance is  tensor(126.9283, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.3052956461906433
distance x is tensor(126.1566, device='cuda:3')
benign distance is  tensor(126.1566, device='cuda:3')
norm1 res is  tensor(0.1425, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(115.6245, device='cuda:3')
compute distance is  tensor(115.6245, device='cuda:3')
compute norm is  tensor(45.5142, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.4489, device='cuda:3')
compute distance is  tensor(118.4489, device='cuda:3')
compute norm is  tensor(45.7622, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8723, device='cuda:3')
compute distance is  tensor(128.8723, device='cuda:3')
compute norm is  tensor(46.0451, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5559, device='cuda:3')
compute distance is  tensor(135.5559, device='cuda:3')
compute norm is  tensor(46.1389, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.5107, device='cuda:3')
compute distance is  tensor(123.5107, device='cuda:3')
compute norm is  tensor(45.8303, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7885, device='cuda:3')
compute distance is  tensor(137.7885, device='cuda:3')
compute norm is  tensor(46.3712, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.7450, device='cuda:3')
compute distance is  tensor(113.7450, device='cuda:3')
compute norm is  tensor(45.6043, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.6737, device='cuda:3')
compute distance is  tensor(117.6737, device='cuda:3')
compute norm is  tensor(45.7362, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8052, device='cuda:3')
compute distance is  tensor(122.8052, device='cuda:3')
compute norm is  tensor(45.8679, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6704, device='cuda:3')
compute distance is  tensor(127.6704, device='cuda:3')
compute norm is  tensor(45.9061, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.3637, device='cuda:3')
compute distance is  tensor(128.3637, device='cuda:3')
compute norm is  tensor(45.9786, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6583, device='cuda:3')
compute distance is  tensor(127.6583, device='cuda:3')
compute norm is  tensor(45.9687, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.7885, device='cuda:3')
distance x is tensor(107688.2969, device='cuda:3')
distance x is tensor(107688.2969, device='cuda:3')
________________________________
test distance is  tensor(107688.2969, device='cuda:3')
test distance1 is  tensor(107688.2969, device='cuda:3')
test similarity is  tensor(-0.0035, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130080164240447.31
test entropy is  0.0
________________________________
cal ratio is  0.03505485942671209
distance x is tensor(3775.0032, device='cuda:3')
cal_distance is  tensor(3775.0032, device='cuda:3')
cal ratio is  0.18722930900617415
distance x is tensor(706.7953, device='cuda:3')
cal_distance is  tensor(706.7953, device='cuda:3')
cal ratio is  0.4326987461271714
distance x is tensor(305.8324, device='cuda:3')
cal_distance is  tensor(305.8324, device='cuda:3')
cal ratio is  0.657795224649291
distance x is tensor(201.1769, device='cuda:3')
cal_distance is  tensor(201.1769, device='cuda:3')
cal ratio is  0.8110422014034954
distance x is tensor(163.1639, device='cuda:3')
cal_distance is  tensor(163.1639, device='cuda:3')
cal ratio is  0.9005761316080377
distance x is tensor(146.9420, device='cuda:3')
cal_distance is  tensor(146.9420, device='cuda:3')
cal ratio is  0.9489852215879405
distance x is tensor(139.4461, device='cuda:3')
cal_distance is  tensor(139.4461, device='cuda:3')
cal ratio is  0.9741577444791045
distance x is tensor(135.8426, device='cuda:3')
cal_distance is  tensor(135.8426, device='cuda:3')
distance x is tensor(135.8426, device='cuda:3')
return_distance is  tensor(135.8426, device='cuda:3')
distance x is tensor(135.8324, device='cuda:3')
distance x is tensor(135.8324, device='cuda:3')
________________________________
test distance is  tensor(135.8324, device='cuda:3')
test distance1 is  tensor(135.8324, device='cuda:3')
test similarity is  tensor(0.9426, device='cuda:3')
test acc is  0.10006666682299865
test loss is 293.48686164579414
test entropy is  2.1352564018610318e-05
________________________________
0
distance x is tensor(135.8324, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.497829918430312e-05
avg test loss is  293.4181126023152
avg accuracy is  0.25091666682300495
solo acc is  0.10013333348966531
compute similarity  is  tensor(0.9426, device='cuda:3')
compute_distance is  tensor(135.8324, device='cuda:3')
compute_norm is  tensor(45.6799, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(117.4031, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9150153751185199
avg test loss is  1.4190832821290884
avg accuracy is  0.8519500001563234
solo acc is  0.33596666682300685
compute similarity  is  tensor(0.9484, device='cuda:3')
compute_distance is  tensor(117.4031, device='cuda:3')
compute_norm is  tensor(44.9470, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.0179, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8788435918562956
avg test loss is  1.4933716328159323
avg accuracy is  0.8534833334896565
solo acc is  0.27420000015633894
compute similarity  is  tensor(0.9480, device='cuda:3')
compute_distance is  tensor(119.0179, device='cuda:3')
compute_norm is  tensor(44.6720, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.3161, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8656773489040098
avg test loss is  1.4586601625881723
avg accuracy is  0.8544666668229899
solo acc is  0.2746166668230056
compute similarity  is  tensor(0.9478, device='cuda:3')
compute_distance is  tensor(120.3161, device='cuda:3')
compute_norm is  tensor(44.4196, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.5747, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8734624802049543
avg test loss is  1.4275732440734976
avg accuracy is  0.8564833334896564
solo acc is  0.2714833334896722
compute similarity  is  tensor(0.9476, device='cuda:3')
compute_distance is  tensor(121.5747, device='cuda:3')
compute_norm is  tensor(44.1785, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.8662, device='cuda:3')
distance x is tensor(122.8662, device='cuda:3')
________________________________
test distance is  tensor(122.8662, device='cuda:3')
test distance1 is  tensor(122.8662, device='cuda:3')
test similarity is  tensor(0.9474, device='cuda:3')
test acc is  0.27248333348967213
test loss is 1.4034640348033864
test entropy is  0.8635743244497507
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.5207771062850952
mal norm is  tensor(643.2684, device='cuda:3')
distance x is tensor(122.8746, device='cuda:3')
mal distance is  tensor(122.8746, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(9.8568, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(418.6092, device='cuda:3')
user_param_square tensor(64.2352, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(10.3697, device='cuda:3')
score : tensor(0.0940, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(436.7992, device='cuda:3')
user_param_square tensor(65.6160, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-6.1892, device='cuda:3')
score : tensor(-0.0715, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.8652, device='cuda:3')
user_param_square tensor(69.4876, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(20.1223, device='cuda:3')
score : tensor(0.1916, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.8510, device='cuda:3')
user_param_square tensor(70.6123, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-7.4524, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.7622, device='cuda:3')
user_param_square tensor(71.4388, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-10.7066, device='cuda:3')
score : tensor(-0.1167, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.7480, device='cuda:3')
user_param_square tensor(73.4112, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-16.8021, device='cuda:3')
score : tensor(-0.1777, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(435.8280, device='cuda:3')
user_param_square tensor(65.5430, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(6.0183, device='cuda:3')
score : tensor(0.0505, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.7725, device='cuda:3')
user_param_square tensor(71.9208, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-8.9629, device='cuda:3')
score : tensor(-0.0993, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2684, device='cuda:3')
user_param_square tensor(79.6278, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-11.3976, device='cuda:3')
score : tensor(-0.1236, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.9670, device='cuda:3')
user_param_square tensor(76.1282, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-8.9472, device='cuda:3')
score : tensor(-0.0991, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.9803, device='cuda:3')
user_param_square tensor(80.2881, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-22.0246, device='cuda:3')
score : tensor(-0.2299, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.6492, device='cuda:3')
user_param_square tensor(76.4951, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-4.1836, device='cuda:3')
score : tensor(-0.0515, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.5895, device='cuda:3')
user_param_square tensor(77.8959, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-5.5247, device='cuda:3')
score : tensor(-0.0649, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.7238, device='cuda:3')
user_param_square tensor(77.8411, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-4.2915, device='cuda:3')
score : tensor(-0.0526, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.1106, device='cuda:3')
user_param_square tensor(75.6830, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-4.7525, device='cuda:3')
score : tensor(-0.0572, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5689, device='cuda:3')
user_param_square tensor(80.0168, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(4.9927, device='cuda:3')
score : tensor(0.0403, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.1621, device='cuda:3')
user_param_square tensor(78.8125, device='cuda:3')
global_param_square tensor(9.8568, device='cuda:3')
part1 is  tensor(-5.3473, device='cuda:3')
score : tensor(-0.0631, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.57% 

Test Accuracy: 88.78% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
 benign loss is  0.771783709526062
distance x is tensor(95.7011, device='cuda:3')
benign distance is  tensor(95.7011, device='cuda:3')
norm1 res is  tensor(0.1058, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3127664029598236
distance x is tensor(128.9795, device='cuda:3')
benign distance is  tensor(128.9795, device='cuda:3')
norm1 res is  tensor(0.1428, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.016346286982297897
distance x is tensor(105.7193, device='cuda:3')
benign distance is  tensor(105.7193, device='cuda:3')
norm1 res is  tensor(0.1209, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4090065062046051
distance x is tensor(116.9032, device='cuda:3')
benign distance is  tensor(116.9032, device='cuda:3')
norm1 res is  tensor(0.1257, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.26224106550216675
distance x is tensor(108.8607, device='cuda:3')
benign distance is  tensor(108.8607, device='cuda:3')
norm1 res is  tensor(0.1196, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.2977718412876129
distance x is tensor(124.2549, device='cuda:3')
benign distance is  tensor(124.2549, device='cuda:3')
norm1 res is  tensor(0.1378, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.15151560306549072
distance x is tensor(109.0601, device='cuda:3')
benign distance is  tensor(109.0601, device='cuda:3')
norm1 res is  tensor(0.1189, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.008700243197381496
distance x is tensor(131.0300, device='cuda:3')
benign distance is  tensor(131.0300, device='cuda:3')
norm1 res is  tensor(0.1485, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.6956914663314819
distance x is tensor(140.9945, device='cuda:3')
benign distance is  tensor(140.9945, device='cuda:3')
norm1 res is  tensor(0.1542, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.37470072507858276
distance x is tensor(156.3238, device='cuda:3')
benign distance is  tensor(156.3238, device='cuda:3')
norm1 res is  tensor(0.1731, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.2934420704841614
distance x is tensor(122.1046, device='cuda:3')
benign distance is  tensor(122.1046, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.09002353250980377
distance x is tensor(140.9774, device='cuda:3')
benign distance is  tensor(140.9774, device='cuda:3')
norm1 res is  tensor(0.1566, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.3519802391529083
distance x is tensor(129.6168, device='cuda:3')
benign distance is  tensor(129.6168, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5258693099021912
distance x is tensor(136.8803, device='cuda:3')
benign distance is  tensor(136.8803, device='cuda:3')
norm1 res is  tensor(0.1501, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.24083483219146729
distance x is tensor(137.7073, device='cuda:3')
benign distance is  tensor(137.7073, device='cuda:3')
norm1 res is  tensor(0.1501, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.4647415280342102
distance x is tensor(144.1920, device='cuda:3')
benign distance is  tensor(144.1920, device='cuda:3')
norm1 res is  tensor(0.1546, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(128.3363, device='cuda:3')
compute distance is  tensor(128.3363, device='cuda:3')
compute norm is  tensor(46.2397, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3052, device='cuda:3')
compute distance is  tensor(137.3052, device='cuda:3')
compute norm is  tensor(46.3816, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8684, device='cuda:3')
compute distance is  tensor(124.8684, device='cuda:3')
compute norm is  tensor(46.4321, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.0757, device='cuda:3')
compute distance is  tensor(141.0757, device='cuda:3')
compute norm is  tensor(46.5463, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5373, device='cuda:3')
compute distance is  tensor(127.5373, device='cuda:3')
compute norm is  tensor(46.1848, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.7935, device='cuda:3')
compute distance is  tensor(134.7935, device='cuda:3')
compute norm is  tensor(46.6403, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8974, device='cuda:3')
compute distance is  tensor(133.8974, device='cuda:3')
compute norm is  tensor(46.4148, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0526, device='cuda:3')
compute distance is  tensor(124.0526, device='cuda:3')
compute norm is  tensor(46.1972, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3073, device='cuda:3')
compute distance is  tensor(129.3073, device='cuda:3')
compute norm is  tensor(46.2432, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5734, device='cuda:3')
compute distance is  tensor(124.5734, device='cuda:3')
compute norm is  tensor(46.2341, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8499, device='cuda:3')
compute distance is  tensor(133.8499, device='cuda:3')
compute norm is  tensor(46.5029, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.7505, device='cuda:3')
compute distance is  tensor(122.7505, device='cuda:3')
compute norm is  tensor(46.1610, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(141.0757, device='cuda:3')
distance x is tensor(107687.7422, device='cuda:3')
distance x is tensor(107687.7422, device='cuda:3')
________________________________
test distance is  tensor(107687.7422, device='cuda:3')
test distance1 is  tensor(107687.7422, device='cuda:3')
test similarity is  tensor(-0.0040, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130047822677749.62
test entropy is  0.0
________________________________
cal ratio is  0.0354706452484062
distance x is tensor(3819.7590, device='cuda:3')
cal_distance is  tensor(3819.7590, device='cuda:3')
cal ratio is  0.1883363942438927
distance x is tensor(719.4037, device='cuda:3')
cal_distance is  tensor(719.4037, device='cuda:3')
cal ratio is  0.43397616256923155
distance x is tensor(312.2070, device='cuda:3')
cal_distance is  tensor(312.2070, device='cuda:3')
cal ratio is  0.6587656370058776
distance x is tensor(205.6730, device='cuda:3')
cal_distance is  tensor(205.6730, device='cuda:3')
cal ratio is  0.8116403326463076
distance x is tensor(166.9335, device='cuda:3')
cal_distance is  tensor(166.9335, device='cuda:3')
cal ratio is  0.9009081927510147
distance x is tensor(150.3922, device='cuda:3')
cal_distance is  tensor(150.3922, device='cuda:3')
cal ratio is  0.9491602285547475
distance x is tensor(142.7466, device='cuda:3')
cal_distance is  tensor(142.7466, device='cuda:3')
cal ratio is  0.9742477062727916
distance x is tensor(139.0707, device='cuda:3')
cal_distance is  tensor(139.0707, device='cuda:3')
distance x is tensor(139.0707, device='cuda:3')
return_distance is  tensor(139.0707, device='cuda:3')
distance x is tensor(139.0605, device='cuda:3')
distance x is tensor(139.0605, device='cuda:3')
________________________________
test distance is  tensor(139.0605, device='cuda:3')
test distance1 is  tensor(139.0605, device='cuda:3')
test similarity is  tensor(0.9412, device='cuda:3')
test acc is  0.10010000015633198
test loss is 356.3480860012681
test entropy is  6.013018086442736e-05
________________________________
0
distance x is tensor(139.0605, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.741894857072383e-05
avg test loss is  356.46912327097425
avg accuracy is  0.22583333348967077
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9412, device='cuda:3')
compute_distance is  tensor(139.0605, device='cuda:3')
compute_norm is  tensor(46.1519, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(120.7808, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9407321390693885
avg test loss is  1.4352345722062247
avg accuracy is  0.8412666668229903
solo acc is  0.3350333334896735
compute similarity  is  tensor(0.9473, device='cuda:3')
compute_distance is  tensor(120.7808, device='cuda:3')
compute_norm is  tensor(45.5211, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.3919, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8937124601050989
avg test loss is  1.5001017022997076
avg accuracy is  0.8432333334896569
solo acc is  0.2820333334896725
compute similarity  is  tensor(0.9469, device='cuda:3')
compute_distance is  tensor(122.3919, device='cuda:3')
compute_norm is  tensor(45.2495, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.8506, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8890499569205587
avg test loss is  1.4914613680036337
avg accuracy is  0.8455666668229901
solo acc is  0.26186666682300525
compute similarity  is  tensor(0.9466, device='cuda:3')
compute_distance is  tensor(123.8506, device='cuda:3')
compute_norm is  tensor(44.9967, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.1793, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8705728327922984
avg test loss is  1.4578430172222763
avg accuracy is  0.8473333334896567
solo acc is  0.26615000015633866
compute similarity  is  tensor(0.9463, device='cuda:3')
compute_distance is  tensor(125.1793, device='cuda:3')
compute_norm is  tensor(44.7558, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.5437, device='cuda:3')
distance x is tensor(126.5437, device='cuda:3')
________________________________
test distance is  tensor(126.5437, device='cuda:3')
test distance1 is  tensor(126.5437, device='cuda:3')
test similarity is  tensor(0.9460, device='cuda:3')
test acc is  0.2627666668230053
test loss is 1.4363607464314523
test entropy is  0.8672561153038733
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1930499076843262
mal norm is  tensor(658.9745, device='cuda:3')
distance x is tensor(126.5517, device='cuda:3')
mal distance is  tensor(126.5517, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(16.8019, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(419.2519, device='cuda:3')
user_param_square tensor(83.9298, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-13.1560, device='cuda:3')
score : tensor(-0.1482, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.6595, device='cuda:3')
user_param_square tensor(97.3166, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-30.4201, device='cuda:3')
score : tensor(-0.3208, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.2395, device='cuda:3')
user_param_square tensor(88.4132, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(50.7660, device='cuda:3')
score : tensor(0.4911, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.1032, device='cuda:3')
user_param_square tensor(91.4826, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-31.3847, device='cuda:3')
score : tensor(-0.3304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.2508, device='cuda:3')
user_param_square tensor(88.9825, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-12.0123, device='cuda:3')
score : tensor(-0.1367, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.7100, device='cuda:3')
user_param_square tensor(95.8423, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-11.9192, device='cuda:3')
score : tensor(-0.1358, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(468.7773, device='cuda:3')
user_param_square tensor(88.7487, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-27.4286, device='cuda:3')
score : tensor(-0.2909, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.4404, device='cuda:3')
user_param_square tensor(99.0943, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-6.0666, device='cuda:3')
score : tensor(-0.0773, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9745, device='cuda:3')
user_param_square tensor(105.2235, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(12.6647, device='cuda:3')
score : tensor(0.1100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.0437, device='cuda:3')
user_param_square tensor(105.2291, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(30.8470, device='cuda:3')
score : tensor(0.2919, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.4896, device='cuda:3')
user_param_square tensor(106.7702, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(29.2728, device='cuda:3')
score : tensor(0.2761, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.0435, device='cuda:3')
user_param_square tensor(107.7535, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-7.2799, device='cuda:3')
score : tensor(-0.0894, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.2246, device='cuda:3')
user_param_square tensor(105.1637, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(16.5458, device='cuda:3')
score : tensor(0.1489, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.7703, device='cuda:3')
user_param_square tensor(101.8808, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(8.7338, device='cuda:3')
score : tensor(0.0707, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.3687, device='cuda:3')
user_param_square tensor(103.0775, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-1.5905, device='cuda:3')
score : tensor(-0.0325, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.0522, device='cuda:3')
user_param_square tensor(101.4081, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-17.5224, device='cuda:3')
score : tensor(-0.1918, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.1328, device='cuda:3')
user_param_square tensor(101.7456, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(18.3148, device='cuda:3')
score : tensor(0.1665, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.3787, device='cuda:3')
user_param_square tensor(105.4950, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(5.7508, device='cuda:3')
score : tensor(0.0409, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.5756, device='cuda:3')
user_param_square tensor(100.1178, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-23.7633, device='cuda:3')
score : tensor(-0.2542, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.1708, device='cuda:3')
user_param_square tensor(100.4190, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-15.2741, device='cuda:3')
score : tensor(-0.1693, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.5919, device='cuda:3')
user_param_square tensor(100.0352, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-5.4889, device='cuda:3')
score : tensor(-0.0715, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.2235, device='cuda:3')
user_param_square tensor(99.0759, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(6.1577, device='cuda:3')
score : tensor(0.0450, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7465, device='cuda:3')
user_param_square tensor(104.4842, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-0.7607, device='cuda:3')
score : tensor(-0.0242, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.1923, device='cuda:3')
user_param_square tensor(101.1709, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-49.7606, device='cuda:3')
score : tensor(-0.5142, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.2839, device='cuda:3')
user_param_square tensor(102.4164, device='cuda:3')
global_param_square tensor(16.8019, device='cuda:3')
part1 is  tensor(-38.5957, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
len accept list 20
len all weights is 20
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 86.91% 

Test Accuracy: 86.05% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6584705114364624
distance x is tensor(130.9744, device='cuda:3')
benign distance is  tensor(130.9744, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.0671603679656982
distance x is tensor(139.2510, device='cuda:3')
benign distance is  tensor(139.2510, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.21724112331867218
distance x is tensor(140.7254, device='cuda:3')
benign distance is  tensor(140.7254, device='cuda:3')
norm1 res is  tensor(0.1515, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.41842976212501526
distance x is tensor(142.7997, device='cuda:3')
benign distance is  tensor(142.7997, device='cuda:3')
norm1 res is  tensor(0.1485, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5042349696159363
distance x is tensor(137.4531, device='cuda:3')
benign distance is  tensor(137.4531, device='cuda:3')
norm1 res is  tensor(0.1454, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3926641047000885
distance x is tensor(145.0341, device='cuda:3')
benign distance is  tensor(145.0341, device='cuda:3')
norm1 res is  tensor(0.1567, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.483671098947525
distance x is tensor(128.2034, device='cuda:3')
benign distance is  tensor(128.2034, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2777506411075592
distance x is tensor(153.8304, device='cuda:3')
benign distance is  tensor(153.8304, device='cuda:3')
norm1 res is  tensor(0.1654, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3363977074623108
distance x is tensor(141.0288, device='cuda:3')
benign distance is  tensor(141.0288, device='cuda:3')
norm1 res is  tensor(0.1476, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.2806971073150635
distance x is tensor(137.8723, device='cuda:3')
benign distance is  tensor(137.8723, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.45381635427474976
distance x is tensor(145.1231, device='cuda:3')
benign distance is  tensor(145.1231, device='cuda:3')
norm1 res is  tensor(0.1542, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.1283276230096817
distance x is tensor(150.5715, device='cuda:3')
benign distance is  tensor(150.5715, device='cuda:3')
norm1 res is  tensor(0.1636, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.538573682308197
distance x is tensor(151.0485, device='cuda:3')
benign distance is  tensor(151.0485, device='cuda:3')
norm1 res is  tensor(0.1590, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.0778609961271286
distance x is tensor(157.7623, device='cuda:3')
benign distance is  tensor(157.7623, device='cuda:3')
norm1 res is  tensor(0.1644, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.47867459058761597
distance x is tensor(152.9921, device='cuda:3')
benign distance is  tensor(152.9921, device='cuda:3')
norm1 res is  tensor(0.1658, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3228888213634491
distance x is tensor(145.0026, device='cuda:3')
benign distance is  tensor(145.0026, device='cuda:3')
norm1 res is  tensor(0.1551, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.637450098991394
distance x is tensor(140.5977, device='cuda:3')
benign distance is  tensor(140.5977, device='cuda:3')
norm1 res is  tensor(0.1546, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.1460380107164383
distance x is tensor(145.1060, device='cuda:3')
benign distance is  tensor(145.1060, device='cuda:3')
norm1 res is  tensor(0.1595, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.38196349143981934
distance x is tensor(145.0415, device='cuda:3')
benign distance is  tensor(145.0415, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.31662943959236145
distance x is tensor(145.8591, device='cuda:3')
benign distance is  tensor(145.8591, device='cuda:3')
norm1 res is  tensor(0.1542, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.2486342489719391
distance x is tensor(142.5717, device='cuda:3')
benign distance is  tensor(142.5717, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.35633689165115356
distance x is tensor(145.7959, device='cuda:3')
benign distance is  tensor(145.7959, device='cuda:3')
norm1 res is  tensor(0.1552, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.21413442492485046
distance x is tensor(144.5135, device='cuda:3')
benign distance is  tensor(144.5135, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.17740647494792938
distance x is tensor(138.3860, device='cuda:3')
benign distance is  tensor(138.3860, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(146.0447, device='cuda:3')
compute distance is  tensor(146.0447, device='cuda:3')
compute norm is  tensor(45.9367, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5746, device='cuda:3')
compute distance is  tensor(137.5746, device='cuda:3')
compute norm is  tensor(45.8418, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.4600, device='cuda:3')
compute distance is  tensor(158.4600, device='cuda:3')
compute norm is  tensor(46.3835, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3696, device='cuda:3')
compute distance is  tensor(140.3696, device='cuda:3')
compute norm is  tensor(45.9612, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.4758, device='cuda:3')
compute distance is  tensor(144.4758, device='cuda:3')
compute norm is  tensor(46.0031, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7918, device='cuda:3')
compute distance is  tensor(144.7918, device='cuda:3')
compute norm is  tensor(46.1920, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.2411, device='cuda:3')
compute distance is  tensor(145.2411, device='cuda:3')
compute norm is  tensor(46.0492, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.8960, device='cuda:3')
compute distance is  tensor(147.8960, device='cuda:3')
compute norm is  tensor(46.1158, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6889, device='cuda:3')
compute distance is  tensor(146.6889, device='cuda:3')
compute norm is  tensor(45.9581, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.4848, device='cuda:3')
compute distance is  tensor(148.4848, device='cuda:3')
compute norm is  tensor(46.1422, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1063, device='cuda:3')
compute distance is  tensor(137.1063, device='cuda:3')
compute norm is  tensor(45.9392, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.4727, device='cuda:3')
compute distance is  tensor(153.4727, device='cuda:3')
compute norm is  tensor(46.1782, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(158.4600, device='cuda:3')
distance x is tensor(107655.7188, device='cuda:3')
distance x is tensor(107655.7188, device='cuda:3')
________________________________
test distance is  tensor(107655.7188, device='cuda:3')
test distance1 is  tensor(107655.7188, device='cuda:3')
test similarity is  tensor(0.1206, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130140863233139.72
test entropy is  0.0
________________________________
cal ratio is  0.03759822972033711
distance x is tensor(4047.6699, device='cuda:3')
cal_distance is  tensor(4047.6699, device='cuda:3')
cal ratio is  0.19390249724372347
distance x is tensor(784.8573, device='cuda:3')
cal_distance is  tensor(784.8573, device='cuda:3')
cal ratio is  0.4403424991015704
distance x is tensor(345.6089, device='cuda:3')
cal_distance is  tensor(345.6089, device='cuda:3')
cal ratio is  0.6635802597657927
distance x is tensor(229.3410, device='cuda:3')
cal_distance is  tensor(229.3410, device='cuda:3')
cal ratio is  0.8146013170112484
distance x is tensor(186.8224, device='cuda:3')
cal_distance is  tensor(186.8224, device='cuda:3')
cal ratio is  0.9025503658601419
distance x is tensor(168.6172, device='cuda:3')
cal_distance is  tensor(168.6172, device='cuda:3')
cal ratio is  0.9500250787185399
distance x is tensor(160.1908, device='cuda:3')
cal_distance is  tensor(160.1908, device='cuda:3')
cal ratio is  0.9746914295460999
distance x is tensor(156.1367, device='cuda:3')
cal_distance is  tensor(156.1367, device='cuda:3')
distance x is tensor(156.1367, device='cuda:3')
return_distance is  tensor(156.1367, device='cuda:3')
distance x is tensor(156.1265, device='cuda:3')
distance x is tensor(156.1265, device='cuda:3')
________________________________
test distance is  tensor(156.1265, device='cuda:3')
test distance1 is  tensor(156.1265, device='cuda:3')
test similarity is  tensor(0.9332, device='cuda:3')
test acc is  0.10000000015633198
test loss is 576.7139429608897
test entropy is  1.5961590681627432e-24
________________________________
0
distance x is tensor(156.1265, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0160019053597998e-33
avg test loss is  576.7923086202983
avg accuracy is  0.10046666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9332, device='cuda:3')
compute_distance is  tensor(156.1265, device='cuda:3')
compute_norm is  tensor(47.2558, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.6690, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2313837212031837
avg test loss is  1.7508805286147193
avg accuracy is  0.493950000156342
solo acc is  0.24745000015633814
compute similarity  is  tensor(0.9340, device='cuda:3')
compute_distance is  tensor(154.6690, device='cuda:3')
compute_norm is  tensor(47.9386, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.5202, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6744323294681273
avg test loss is  2.6791762621926347
avg accuracy is  0.34353333348967363
solo acc is  0.10771666682299862
compute similarity  is  tensor(0.9337, device='cuda:3')
compute_distance is  tensor(155.5202, device='cuda:3')
compute_norm is  tensor(47.8747, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.8132, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0286946843809157
avg test loss is  1.6174716934212234
avg accuracy is  0.5074000001563421
solo acc is  0.23960000015633792
compute similarity  is  tensor(0.9344, device='cuda:3')
compute_distance is  tensor(155.8132, device='cuda:3')
compute_norm is  tensor(47.5083, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.3658, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6194018961778328
avg test loss is  2.4503779660409957
avg accuracy is  0.36641666682300733
solo acc is  0.10818333348966529
compute similarity  is  tensor(0.9341, device='cuda:3')
compute_distance is  tensor(156.3658, device='cuda:3')
compute_norm is  tensor(47.3651, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.9177, device='cuda:3')
distance x is tensor(156.9177, device='cuda:3')
________________________________
test distance is  tensor(156.9177, device='cuda:3')
test distance1 is  tensor(156.9177, device='cuda:3')
test similarity is  tensor(0.9344, device='cuda:3')
test acc is  0.2577333334896718
test loss is 1.5127926912389076
test entropy is  0.9638637788514338
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3285720348358154
mal norm is  tensor(768.8975, device='cuda:3')
distance x is tensor(156.9252, device='cuda:3')
mal distance is  tensor(156.9252, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(13.8272, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.5367, device='cuda:3')
user_param_square tensor(88.0377, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(78.8835, device='cuda:3')
score : tensor(0.7752, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.5550, device='cuda:3')
user_param_square tensor(90.8983, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(69.5316, device='cuda:3')
score : tensor(0.6817, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.6343, device='cuda:3')
user_param_square tensor(90.3704, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(86.4313, device='cuda:3')
score : tensor(0.8507, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.3979, device='cuda:3')
user_param_square tensor(90.3523, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(27.1002, device='cuda:3')
score : tensor(0.2574, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.0977, device='cuda:3')
user_param_square tensor(89.4062, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(47.2411, device='cuda:3')
score : tensor(0.4588, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.0937, device='cuda:3')
user_param_square tensor(92.3724, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(36.7254, device='cuda:3')
score : tensor(0.3536, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.6660, device='cuda:3')
user_param_square tensor(86.5431, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(71.5477, device='cuda:3')
score : tensor(0.7018, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.4178, device='cuda:3')
user_param_square tensor(94.7608, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(42.8761, device='cuda:3')
score : tensor(0.4151, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.8975, device='cuda:3')
user_param_square tensor(103.1101, device='cuda:3')
global_param_square tensor(13.8272, device='cuda:3')
part1 is  tensor(-106.8339, device='cuda:3')
score : tensor(-1.0820, device='cuda:3')
len accept list 8
len all weights is 8
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 89.46% 

Test Accuracy: 88.47% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5866722464561462
distance x is tensor(132.3622, device='cuda:3')
benign distance is  tensor(132.3622, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.967978298664093
distance x is tensor(110.8653, device='cuda:3')
benign distance is  tensor(110.8653, device='cuda:3')
norm1 res is  tensor(0.1243, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.06438011676073074
distance x is tensor(109.2661, device='cuda:3')
benign distance is  tensor(109.2661, device='cuda:3')
norm1 res is  tensor(0.1193, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3787790834903717
distance x is tensor(107.8950, device='cuda:3')
benign distance is  tensor(107.8950, device='cuda:3')
norm1 res is  tensor(0.1167, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4864731431007385
distance x is tensor(110.4593, device='cuda:3')
benign distance is  tensor(110.4593, device='cuda:3')
norm1 res is  tensor(0.1177, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3854833245277405
distance x is tensor(132.4167, device='cuda:3')
benign distance is  tensor(132.4167, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5503861904144287
distance x is tensor(121.3759, device='cuda:3')
benign distance is  tensor(121.3759, device='cuda:3')
norm1 res is  tensor(0.1274, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5598195791244507
distance x is tensor(115.4738, device='cuda:3')
benign distance is  tensor(115.4738, device='cuda:3')
norm1 res is  tensor(0.1266, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(132.9717, device='cuda:3')
compute distance is  tensor(132.9717, device='cuda:3')
compute norm is  tensor(46.2849, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3883, device='cuda:3')
compute distance is  tensor(125.3883, device='cuda:3')
compute norm is  tensor(46.2889, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5176, device='cuda:3')
compute distance is  tensor(134.5176, device='cuda:3')
compute norm is  tensor(46.4373, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6161, device='cuda:3')
compute distance is  tensor(134.6161, device='cuda:3')
compute norm is  tensor(46.4666, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.1138, device='cuda:3')
compute distance is  tensor(123.1138, device='cuda:3')
compute norm is  tensor(46.1579, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.4940, device='cuda:3')
compute distance is  tensor(140.4940, device='cuda:3')
compute norm is  tensor(46.6604, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5953, device='cuda:3')
compute distance is  tensor(125.5953, device='cuda:3')
compute norm is  tensor(46.2547, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7963, device='cuda:3')
compute distance is  tensor(133.7963, device='cuda:3')
compute norm is  tensor(46.3550, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.1482, device='cuda:3')
compute distance is  tensor(133.1482, device='cuda:3')
compute norm is  tensor(46.4866, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6775, device='cuda:3')
compute distance is  tensor(128.6775, device='cuda:3')
compute norm is  tensor(46.4953, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0381, device='cuda:3')
compute distance is  tensor(134.0381, device='cuda:3')
compute norm is  tensor(46.4909, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7047, device='cuda:3')
compute distance is  tensor(125.7047, device='cuda:3')
compute norm is  tensor(46.2797, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(140.4940, device='cuda:3')
distance x is tensor(107670.9609, device='cuda:3')
distance x is tensor(107670.9609, device='cuda:3')
________________________________
test distance is  tensor(107670.9609, device='cuda:3')
test distance1 is  tensor(107670.9609, device='cuda:3')
test similarity is  tensor(0.0833, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130093246453484.89
test entropy is  0.0
________________________________
cal ratio is  0.03540020103601134
distance x is tensor(3811.5789, device='cuda:3')
cal_distance is  tensor(3811.5789, device='cuda:3')
cal ratio is  0.1881492788428033
distance x is tensor(717.1499, device='cuda:3')
cal_distance is  tensor(717.1499, device='cuda:3')
cal ratio is  0.4337605407145896
distance x is tensor(311.0742, device='cuda:3')
cal_distance is  tensor(311.0742, device='cuda:3')
cal ratio is  0.6586019692049494
distance x is tensor(204.8758, device='cuda:3')
cal_distance is  tensor(204.8758, device='cuda:3')
cal ratio is  0.8115394696980548
distance x is tensor(166.2658, device='cuda:3')
cal_distance is  tensor(166.2658, device='cuda:3')
cal ratio is  0.900852243462887
distance x is tensor(149.7814, device='cuda:3')
cal_distance is  tensor(149.7814, device='cuda:3')
cal ratio is  0.9491307061198556
distance x is tensor(142.1624, device='cuda:3')
cal_distance is  tensor(142.1624, device='cuda:3')
cal ratio is  0.9742325173562315
distance x is tensor(138.4994, device='cuda:3')
cal_distance is  tensor(138.4994, device='cuda:3')
distance x is tensor(138.4994, device='cuda:3')
return_distance is  tensor(138.4994, device='cuda:3')
distance x is tensor(138.4892, device='cuda:3')
distance x is tensor(138.4892, device='cuda:3')
________________________________
test distance is  tensor(138.4892, device='cuda:3')
test distance1 is  tensor(138.4892, device='cuda:3')
test similarity is  tensor(0.9455, device='cuda:3')
test acc is  0.10016666682299866
test loss is 237.97172684659327
test entropy is  3.591347652105066e-05
________________________________
0
distance x is tensor(138.4892, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.862502839506895e-05
avg test loss is  237.89930887771314
avg accuracy is  0.3935166668230077
solo acc is  0.10011666682299865
compute similarity  is  tensor(0.9455, device='cuda:3')
compute_distance is  tensor(138.4892, device='cuda:3')
compute_norm is  tensor(46.9483, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(124.5983, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9227641228673809
avg test loss is  1.4182261403943939
avg accuracy is  0.8363166668229907
solo acc is  0.3174833334896732
compute similarity  is  tensor(0.9497, device='cuda:3')
compute_distance is  tensor(124.5983, device='cuda:3')
compute_norm is  tensor(46.5331, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.5688, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8893403200579605
avg test loss is  1.4874601174773439
avg accuracy is  0.8352666668229904
solo acc is  0.2590166668230051
compute similarity  is  tensor(0.9495, device='cuda:3')
compute_distance is  tensor(125.5688, device='cuda:3')
compute_norm is  tensor(46.2872, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.4599, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8753670291351611
avg test loss is  1.4597096328796355
avg accuracy is  0.8391833334896571
solo acc is  0.25861666682300516
compute similarity  is  tensor(0.9493, device='cuda:3')
compute_distance is  tensor(126.4599, device='cuda:3')
compute_norm is  tensor(46.0511, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.4174, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8713094062134147
avg test loss is  1.4422609572217409
avg accuracy is  0.8408500001563237
solo acc is  0.254816666823005
compute similarity  is  tensor(0.9491, device='cuda:3')
compute_distance is  tensor(127.4174, device='cuda:3')
compute_norm is  tensor(45.8190, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.3608, device='cuda:3')
distance x is tensor(128.3608, device='cuda:3')
________________________________
test distance is  tensor(128.3608, device='cuda:3')
test distance1 is  tensor(128.3608, device='cuda:3')
test similarity is  tensor(0.9489, device='cuda:3')
test acc is  0.2571666668230051
test loss is 1.4167826457826822
test entropy is  0.866364179516652
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1956021785736084
mal norm is  tensor(660.5949, device='cuda:3')
distance x is tensor(128.3696, device='cuda:3')
mal distance is  tensor(128.3696, device='cuda:3')
len current grad  20
len all grad 52
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(21.8725, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.2719, device='cuda:3')
user_param_square tensor(112.0748, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-19.0399, device='cuda:3')
score : tensor(-0.2121, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(485.9083, device='cuda:3')
user_param_square tensor(103.0924, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-18.2928, device='cuda:3')
score : tensor(-0.2046, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(467.0213, device='cuda:3')
user_param_square tensor(101.0689, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(72.3190, device='cuda:3')
score : tensor(0.7015, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(457.6529, device='cuda:3')
user_param_square tensor(100.0501, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(11.4599, device='cuda:3')
score : tensor(0.0929, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(466.8801, device='cuda:3')
user_param_square tensor(101.0536, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-34.7449, device='cuda:3')
score : tensor(-0.3691, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.2111, device='cuda:3')
user_param_square tensor(112.0689, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-29.7083, device='cuda:3')
score : tensor(-0.3188, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.5732, device='cuda:3')
user_param_square tensor(104.8453, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(18.3413, device='cuda:3')
score : tensor(0.1617, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(495.7371, device='cuda:3')
user_param_square tensor(104.1298, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-44.6819, device='cuda:3')
score : tensor(-0.4685, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5949, device='cuda:3')
user_param_square tensor(120.2034, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(52.6793, device='cuda:3')
score : tensor(0.5051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.4591, device='cuda:3')
user_param_square tensor(118.4497, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(3.4032, device='cuda:3')
score : tensor(0.0124, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.8652, device='cuda:3')
user_param_square tensor(117.8393, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-25.4658, device='cuda:3')
score : tensor(-0.2763, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.3949, device='cuda:3')
user_param_square tensor(121.5425, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(54.3611, device='cuda:3')
score : tensor(0.5219, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.7919, device='cuda:3')
user_param_square tensor(122.8311, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(63.5286, device='cuda:3')
score : tensor(0.6136, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4365, device='cuda:3')
user_param_square tensor(116.8674, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(25.3066, device='cuda:3')
score : tensor(0.2314, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.6141, device='cuda:3')
user_param_square tensor(119.1084, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-30.4691, device='cuda:3')
score : tensor(-0.3264, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.5464, device='cuda:3')
user_param_square tensor(120.8342, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-56.1991, device='cuda:3')
score : tensor(-0.5837, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.1057, device='cuda:3')
user_param_square tensor(122.6809, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(3.9372, device='cuda:3')
score : tensor(0.0177, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.1043, device='cuda:3')
user_param_square tensor(120.5223, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-24.5883, device='cuda:3')
score : tensor(-0.2676, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.5989, device='cuda:3')
user_param_square tensor(117.2563, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-8.2361, device='cuda:3')
score : tensor(-0.1040, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1638, device='cuda:3')
user_param_square tensor(122.1500, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-11.0656, device='cuda:3')
score : tensor(-0.1323, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.2200, device='cuda:3')
user_param_square tensor(124.1091, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-30.5291, device='cuda:3')
score : tensor(-0.3270, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.3967, device='cuda:3')
user_param_square tensor(119.3636, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-62.4389, device='cuda:3')
score : tensor(-0.6461, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.8788, device='cuda:3')
user_param_square tensor(121.5860, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(29.5448, device='cuda:3')
score : tensor(0.2738, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.8835, device='cuda:3')
user_param_square tensor(118.2116, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(6.4172, device='cuda:3')
score : tensor(0.0425, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.5345, device='cuda:3')
user_param_square tensor(119.3763, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(29.6930, device='cuda:3')
score : tensor(0.2753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.8075, device='cuda:3')
user_param_square tensor(121.5796, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(0.8863, device='cuda:3')
score : tensor(-0.0128, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.1517, device='cuda:3')
user_param_square tensor(127.0639, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(0.6124, device='cuda:3')
score : tensor(-0.0155, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.0804, device='cuda:3')
user_param_square tensor(115.4215, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-7.0180, device='cuda:3')
score : tensor(-0.0919, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.8765, device='cuda:3')
user_param_square tensor(122.1243, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(43.0662, device='cuda:3')
score : tensor(0.4090, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.8663, device='cuda:3')
user_param_square tensor(117.6536, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(38.4208, device='cuda:3')
score : tensor(0.3625, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.6380, device='cuda:3')
user_param_square tensor(119.7516, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-55.4478, device='cuda:3')
score : tensor(-0.5762, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.7049, device='cuda:3')
user_param_square tensor(120.8486, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(13.9324, device='cuda:3')
score : tensor(0.1177, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1289, device='cuda:3')
user_param_square tensor(121.4285, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-33.0646, device='cuda:3')
score : tensor(-0.3523, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.5925, device='cuda:3')
user_param_square tensor(113.1741, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-8.1108, device='cuda:3')
score : tensor(-0.1028, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.5499, device='cuda:3')
user_param_square tensor(113.4595, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(7.6823, device='cuda:3')
score : tensor(0.0552, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.0260, device='cuda:3')
user_param_square tensor(115.4163, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-30.0675, device='cuda:3')
score : tensor(-0.3223, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.2219, device='cuda:3')
user_param_square tensor(118.1504, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-46.6717, device='cuda:3')
score : tensor(-0.4884, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.4532, device='cuda:3')
user_param_square tensor(117.5222, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(-31.8775, device='cuda:3')
score : tensor(-0.3404, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.3735, device='cuda:3')
user_param_square tensor(119.1781, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(47.7524, device='cuda:3')
score : tensor(0.4559, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.7034, device='cuda:3')
user_param_square tensor(119.5748, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(29.8531, device='cuda:3')
score : tensor(0.2769, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.2437, device='cuda:3')
user_param_square tensor(115.9097, device='cuda:3')
global_param_square tensor(21.8725, device='cuda:3')
part1 is  tensor(11.6671, device='cuda:3')
score : tensor(0.0950, device='cuda:3')
accept
len accept list 30
len all weights is 30
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 88.53% 

Test Accuracy: 87.82% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8712576627731323
distance x is tensor(119.5955, device='cuda:3')
benign distance is  tensor(119.5955, device='cuda:3')
norm1 res is  tensor(0.1307, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.2265910804271698
distance x is tensor(141.3596, device='cuda:3')
benign distance is  tensor(141.3596, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3095129728317261
distance x is tensor(123.9527, device='cuda:3')
benign distance is  tensor(123.9527, device='cuda:3')
norm1 res is  tensor(0.1312, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.9051975011825562
distance x is tensor(125.9365, device='cuda:3')
benign distance is  tensor(125.9365, device='cuda:3')
norm1 res is  tensor(0.1352, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3388143479824066
distance x is tensor(123.6186, device='cuda:3')
benign distance is  tensor(123.6186, device='cuda:3')
norm1 res is  tensor(0.1307, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.47417545318603516
distance x is tensor(144.4657, device='cuda:3')
benign distance is  tensor(144.4657, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.7321157455444336
distance x is tensor(132.5856, device='cuda:3')
benign distance is  tensor(132.5856, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.22571472823619843
distance x is tensor(146.8439, device='cuda:3')
benign distance is  tensor(146.8439, device='cuda:3')
norm1 res is  tensor(0.1565, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.6455162763595581
distance x is tensor(153.3867, device='cuda:3')
benign distance is  tensor(153.3867, device='cuda:3')
norm1 res is  tensor(0.1643, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.8491113781929016
distance x is tensor(154.2972, device='cuda:3')
benign distance is  tensor(154.2972, device='cuda:3')
norm1 res is  tensor(0.1639, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.11079031229019165
distance x is tensor(131.7170, device='cuda:3')
benign distance is  tensor(131.7170, device='cuda:3')
norm1 res is  tensor(0.1409, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6321110725402832
distance x is tensor(139.9216, device='cuda:3')
benign distance is  tensor(139.9216, device='cuda:3')
norm1 res is  tensor(0.1482, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.33479276299476624
distance x is tensor(134.6607, device='cuda:3')
benign distance is  tensor(134.6607, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.14062011241912842
distance x is tensor(144.2849, device='cuda:3')
benign distance is  tensor(144.2849, device='cuda:3')
norm1 res is  tensor(0.1493, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.2261696755886078
distance x is tensor(140.1996, device='cuda:3')
benign distance is  tensor(140.1996, device='cuda:3')
norm1 res is  tensor(0.1484, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.7158437967300415
distance x is tensor(140.5393, device='cuda:3')
benign distance is  tensor(140.5393, device='cuda:3')
norm1 res is  tensor(0.1497, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.5569912195205688
distance x is tensor(147.6423, device='cuda:3')
benign distance is  tensor(147.6423, device='cuda:3')
norm1 res is  tensor(0.1564, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.7288476824760437
distance x is tensor(155.4645, device='cuda:3')
benign distance is  tensor(155.4645, device='cuda:3')
norm1 res is  tensor(0.1673, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.2308814823627472
distance x is tensor(156.6006, device='cuda:3')
benign distance is  tensor(156.6006, device='cuda:3')
norm1 res is  tensor(0.1677, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.23163199424743652
distance x is tensor(132.2544, device='cuda:3')
benign distance is  tensor(132.2544, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.6334290504455566
distance x is tensor(148.5108, device='cuda:3')
benign distance is  tensor(148.5108, device='cuda:3')
norm1 res is  tensor(0.1558, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.4429873526096344
distance x is tensor(145.9935, device='cuda:3')
benign distance is  tensor(145.9935, device='cuda:3')
norm1 res is  tensor(0.1563, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.3409713804721832
distance x is tensor(145.2396, device='cuda:3')
benign distance is  tensor(145.2396, device='cuda:3')
norm1 res is  tensor(0.1514, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.5514160394668579
distance x is tensor(152.1154, device='cuda:3')
benign distance is  tensor(152.1154, device='cuda:3')
norm1 res is  tensor(0.1618, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.42288899421691895
distance x is tensor(155.5468, device='cuda:3')
benign distance is  tensor(155.5468, device='cuda:3')
norm1 res is  tensor(0.1632, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  1.1150498390197754
distance x is tensor(130.9677, device='cuda:3')
benign distance is  tensor(130.9677, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.28753867745399475
distance x is tensor(146.8519, device='cuda:3')
benign distance is  tensor(146.8519, device='cuda:3')
norm1 res is  tensor(0.1558, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.5288676619529724
distance x is tensor(146.6934, device='cuda:3')
benign distance is  tensor(146.6934, device='cuda:3')
norm1 res is  tensor(0.1557, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.6382869482040405
distance x is tensor(145.9073, device='cuda:3')
benign distance is  tensor(145.9073, device='cuda:3')
norm1 res is  tensor(0.1545, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.17511531710624695
distance x is tensor(154.3939, device='cuda:3')
benign distance is  tensor(154.3939, device='cuda:3')
norm1 res is  tensor(0.1640, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.2511669397354126
distance x is tensor(133.2498, device='cuda:3')
benign distance is  tensor(133.2498, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.21362003684043884
distance x is tensor(153.1580, device='cuda:3')
benign distance is  tensor(153.1580, device='cuda:3')
norm1 res is  tensor(0.1636, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.283883273601532
distance x is tensor(138.9159, device='cuda:3')
benign distance is  tensor(138.9159, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.3874734938144684
distance x is tensor(135.4947, device='cuda:3')
benign distance is  tensor(135.4947, device='cuda:3')
norm1 res is  tensor(0.1446, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.14329935610294342
distance x is tensor(136.3985, device='cuda:3')
benign distance is  tensor(136.3985, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.6898208260536194
distance x is tensor(143.3937, device='cuda:3')
benign distance is  tensor(143.3937, device='cuda:3')
norm1 res is  tensor(0.1551, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.28427398204803467
distance x is tensor(144.4708, device='cuda:3')
benign distance is  tensor(144.4708, device='cuda:3')
norm1 res is  tensor(0.1538, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.27728068828582764
distance x is tensor(154.0475, device='cuda:3')
benign distance is  tensor(154.0475, device='cuda:3')
norm1 res is  tensor(0.1645, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.5309704542160034
distance x is tensor(144.1341, device='cuda:3')
benign distance is  tensor(144.1341, device='cuda:3')
norm1 res is  tensor(0.1522, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.21355192363262177
distance x is tensor(152.3350, device='cuda:3')
benign distance is  tensor(152.3350, device='cuda:3')
norm1 res is  tensor(0.1631, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(133.1943, device='cuda:3')
compute distance is  tensor(133.1943, device='cuda:3')
compute norm is  tensor(46.1671, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3480, device='cuda:3')
compute distance is  tensor(132.3480, device='cuda:3')
compute norm is  tensor(46.1867, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.3293, device='cuda:3')
compute distance is  tensor(145.3293, device='cuda:3')
compute norm is  tensor(46.4411, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.1313, device='cuda:3')
compute distance is  tensor(127.1313, device='cuda:3')
compute norm is  tensor(45.9542, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3675, device='cuda:3')
compute distance is  tensor(133.3675, device='cuda:3')
compute norm is  tensor(46.2237, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.3896, device='cuda:3')
compute distance is  tensor(143.3896, device='cuda:3')
compute norm is  tensor(46.5115, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8638, device='cuda:3')
compute distance is  tensor(137.8638, device='cuda:3')
compute norm is  tensor(46.2084, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2470, device='cuda:3')
compute distance is  tensor(130.2470, device='cuda:3')
compute norm is  tensor(46.0918, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.8305, device='cuda:3')
compute distance is  tensor(149.8305, device='cuda:3')
compute norm is  tensor(46.5839, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7936, device='cuda:3')
compute distance is  tensor(138.7936, device='cuda:3')
compute norm is  tensor(46.4131, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2713, device='cuda:3')
compute distance is  tensor(140.2713, device='cuda:3')
compute norm is  tensor(46.2379, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4086, device='cuda:3')
compute distance is  tensor(145.4086, device='cuda:3')
compute norm is  tensor(46.4194, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.8305, device='cuda:3')
distance x is tensor(107648.2266, device='cuda:3')
distance x is tensor(107648.2266, device='cuda:3')
________________________________
test distance is  tensor(107648.2266, device='cuda:3')
test distance1 is  tensor(107648.2266, device='cuda:3')
test similarity is  tensor(0.1523, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130082379163853.23
test entropy is  0.0
________________________________
cal ratio is  0.03656139181823523
distance x is tensor(3935.7744, device='cuda:3')
cal_distance is  tensor(3935.7744, device='cuda:3')
cal ratio is  0.19121020118797608
distance x is tensor(752.5643, device='cuda:3')
cal_distance is  tensor(752.5643, device='cuda:3')
cal ratio is  0.4372746958429867
distance x is tensor(329.0802, device='cuda:3')
cal_distance is  tensor(329.0802, device='cuda:3')
cal ratio is  0.6612645970682208
distance x is tensor(217.6108, device='cuda:3')
cal_distance is  tensor(217.6108, device='cuda:3')
cal ratio is  0.8131784911744052
distance x is tensor(176.9574, device='cuda:3')
cal_distance is  tensor(176.9574, device='cuda:3')
cal ratio is  0.9017617113650028
distance x is tensor(159.5739, device='cuda:3')
cal_distance is  tensor(159.5739, device='cuda:3')
cal ratio is  0.9496097366790522
distance x is tensor(151.5332, device='cuda:3')
cal_distance is  tensor(151.5332, device='cuda:3')
cal ratio is  0.974478390048907
distance x is tensor(147.6660, device='cuda:3')
cal_distance is  tensor(147.6660, device='cuda:3')
distance x is tensor(147.6660, device='cuda:3')
return_distance is  tensor(147.6660, device='cuda:3')
distance x is tensor(147.6558, device='cuda:3')
distance x is tensor(147.6558, device='cuda:3')
________________________________
test distance is  tensor(147.6558, device='cuda:3')
test distance1 is  tensor(147.6558, device='cuda:3')
test similarity is  tensor(0.9421, device='cuda:3')
test acc is  0.10001666682299865
test loss is 374.4152078526869
test entropy is  1.1154698042881691e-05
________________________________
0
distance x is tensor(147.6558, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  8.717308772952965e-09
avg test loss is  374.47486988059495
avg accuracy is  0.12621666682299856
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9421, device='cuda:3')
compute_distance is  tensor(147.6558, device='cuda:3')
compute_norm is  tensor(47.5679, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.5602, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0722138884225125
avg test loss is  1.6770995995129094
avg accuracy is  0.6574666668229999
solo acc is  0.23836666682300453
compute similarity  is  tensor(0.9452, device='cuda:3')
compute_distance is  tensor(138.5602, device='cuda:3')
compute_norm is  tensor(47.7799, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(139.5111, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6349482964605156
avg test loss is  2.5059988239426603
avg accuracy is  0.5410666668230091
solo acc is  0.11031666682299861
compute similarity  is  tensor(0.9449, device='cuda:3')
compute_distance is  tensor(139.5111, device='cuda:3')
compute_norm is  tensor(47.6194, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.7771, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9872672057736402
avg test loss is  1.5043477836702424
avg accuracy is  0.7002166668229973
solo acc is  0.26026666682300525
compute similarity  is  tensor(0.9453, device='cuda:3')
compute_distance is  tensor(139.7771, device='cuda:3')
compute_norm is  tensor(47.3085, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(139.7771, device='cuda:3')
distance x is tensor(139.7771, device='cuda:3')
________________________________
test distance is  tensor(139.7771, device='cuda:3')
test distance1 is  tensor(139.7771, device='cuda:3')
test similarity is  tensor(0.9453, device='cuda:3')
test acc is  0.2577500001563385
test loss is 1.509818497242958
test entropy is  0.9878207488990287
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.611798882484436
mal norm is  tensor(717.6932, device='cuda:3')
distance x is tensor(139.7859, device='cuda:3')
mal distance is  tensor(139.7859, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(10.9579, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(515.8248, device='cuda:3')
user_param_square tensor(75.1820, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(10.0992, device='cuda:3')
score : tensor(0.0902, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.1172, device='cuda:3')
user_param_square tensor(80.9573, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(11.5819, device='cuda:3')
score : tensor(0.1051, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.3759, device='cuda:3')
user_param_square tensor(75.5854, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(20.9296, device='cuda:3')
score : tensor(0.1985, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.7745, device='cuda:3')
user_param_square tensor(75.5418, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(2.6893, device='cuda:3')
score : tensor(0.0161, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(516.7577, device='cuda:3')
user_param_square tensor(75.2499, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(8.2435, device='cuda:3')
score : tensor(0.0717, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.1031, device='cuda:3')
user_param_square tensor(81.1591, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(11.7002, device='cuda:3')
score : tensor(0.1062, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.4424, device='cuda:3')
user_param_square tensor(77.8752, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-2.4853, device='cuda:3')
score : tensor(-0.0356, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.0847, device='cuda:3')
user_param_square tensor(82.3641, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(15.1986, device='cuda:3')
score : tensor(0.1412, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.6932, device='cuda:3')
user_param_square tensor(88.6813, device='cuda:3')
global_param_square tensor(10.9579, device='cuda:3')
part1 is  tensor(-41.8555, device='cuda:3')
score : tensor(-0.4293, device='cuda:3')
len accept list 7
len all weights is 7
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 89.48% 

Test Accuracy: 88.60% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
 benign loss is  0.47404012084007263
distance x is tensor(122.8805, device='cuda:3')
benign distance is  tensor(122.8805, device='cuda:3')
norm1 res is  tensor(0.1355, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3345964848995209
distance x is tensor(121.7972, device='cuda:3')
benign distance is  tensor(121.7972, device='cuda:3')
norm1 res is  tensor(0.1333, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2909885346889496
distance x is tensor(135.4731, device='cuda:3')
benign distance is  tensor(135.4731, device='cuda:3')
norm1 res is  tensor(0.1513, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3886259198188782
distance x is tensor(112.4251, device='cuda:3')
benign distance is  tensor(112.4251, device='cuda:3')
norm1 res is  tensor(0.1249, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3886905312538147
distance x is tensor(123.6398, device='cuda:3')
benign distance is  tensor(123.6398, device='cuda:3')
norm1 res is  tensor(0.1301, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.2262573540210724
distance x is tensor(125.3404, device='cuda:3')
benign distance is  tensor(125.3404, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.29251331090927124
distance x is tensor(125.4975, device='cuda:3')
benign distance is  tensor(125.4975, device='cuda:3')
norm1 res is  tensor(0.1353, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.34445175528526306
distance x is tensor(126.8921, device='cuda:3')
benign distance is  tensor(126.8921, device='cuda:3')
norm1 res is  tensor(0.1397, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(122.5589, device='cuda:3')
compute distance is  tensor(122.5589, device='cuda:3')
compute norm is  tensor(46.5015, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.0320, device='cuda:3')
compute distance is  tensor(121.0320, device='cuda:3')
compute norm is  tensor(46.5261, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.5220, device='cuda:3')
compute distance is  tensor(138.5220, device='cuda:3')
compute norm is  tensor(47.1037, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.4859, device='cuda:3')
compute distance is  tensor(139.4859, device='cuda:3')
compute norm is  tensor(47.0066, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1828, device='cuda:3')
compute distance is  tensor(138.1828, device='cuda:3')
compute norm is  tensor(46.7712, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.8264, device='cuda:3')
compute distance is  tensor(139.8264, device='cuda:3')
compute norm is  tensor(47.1765, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8485, device='cuda:3')
compute distance is  tensor(131.8485, device='cuda:3')
compute norm is  tensor(46.6375, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.2535, device='cuda:3')
compute distance is  tensor(151.2535, device='cuda:3')
compute norm is  tensor(47.2340, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.0639, device='cuda:3')
compute distance is  tensor(136.0639, device='cuda:3')
compute norm is  tensor(46.8612, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5164, device='cuda:3')
compute distance is  tensor(129.5164, device='cuda:3')
compute norm is  tensor(46.9217, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6728, device='cuda:3')
compute distance is  tensor(133.6728, device='cuda:3')
compute norm is  tensor(46.8219, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.4048, device='cuda:3')
compute distance is  tensor(130.4048, device='cuda:3')
compute norm is  tensor(46.7529, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.2535, device='cuda:3')
distance x is tensor(107661.0781, device='cuda:3')
distance x is tensor(107661.0781, device='cuda:3')
________________________________
test distance is  tensor(107661.0781, device='cuda:3')
test distance1 is  tensor(107661.0781, device='cuda:3')
test similarity is  tensor(0.1200, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130027555452041.55
test entropy is  0.0
________________________________
cal ratio is  0.03673240734379864
distance x is tensor(3954.6562, device='cuda:3')
cal_distance is  tensor(3954.6562, device='cuda:3')
cal ratio is  0.1916568673680748
distance x is tensor(757.9410, device='cuda:3')
cal_distance is  tensor(757.9410, device='cuda:3')
cal ratio is  0.4377851819399548
distance x is tensor(331.8182, device='cuda:3')
cal_distance is  tensor(331.8182, device='cuda:3')
cal ratio is  0.6616504908263183
distance x is tensor(219.5494, device='cuda:3')
cal_distance is  tensor(219.5494, device='cuda:3')
cal ratio is  0.8134158309705821
distance x is tensor(178.5859, device='cuda:3')
cal_distance is  tensor(178.5859, device='cuda:3')
cal ratio is  0.9018932968789771
distance x is tensor(161.0659, device='cuda:3')
cal_distance is  tensor(161.0659, device='cuda:3')
cal ratio is  0.9496791789150689
distance x is tensor(152.9612, device='cuda:3')
cal_distance is  tensor(152.9612, device='cuda:3')
cal ratio is  0.9745139586073818
distance x is tensor(149.0630, device='cuda:3')
cal_distance is  tensor(149.0630, device='cuda:3')
distance x is tensor(149.0630, device='cuda:3')
return_distance is  tensor(149.0630, device='cuda:3')
distance x is tensor(149.0529, device='cuda:3')
distance x is tensor(149.0529, device='cuda:3')
________________________________
test distance is  tensor(149.0529, device='cuda:3')
test distance1 is  tensor(149.0529, device='cuda:3')
test similarity is  tensor(0.9410, device='cuda:3')
test acc is  0.10041666682299864
test loss is 300.30100806588047
test entropy is  0.0001364969110390813
________________________________
0
distance x is tensor(149.0529, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00012637232745579864
avg test loss is  299.9777475938614
avg accuracy is  0.3368166668230069
solo acc is  0.10026666682299865
compute similarity  is  tensor(0.9410, device='cuda:3')
compute_distance is  tensor(149.0529, device='cuda:3')
compute_norm is  tensor(47.9761, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.2651, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1389074294424768
avg test loss is  1.727913228052257
avg accuracy is  0.7463333334896616
solo acc is  0.24800000015633816
compute similarity  is  tensor(0.9427, device='cuda:3')
compute_distance is  tensor(141.2651, device='cuda:3')
compute_norm is  tensor(48.3122, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(142.8363, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.655626785907664
avg test loss is  2.598073428627779
avg accuracy is  0.6859666668229982
solo acc is  0.11218333348966528
compute similarity  is  tensor(0.9422, device='cuda:3')
compute_distance is  tensor(142.8363, device='cuda:3')
compute_norm is  tensor(48.1890, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.2156, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9863895566732899
avg test loss is  1.5417427263026044
avg accuracy is  0.77443333348966
solo acc is  0.2591000001563385
compute similarity  is  tensor(0.9427, device='cuda:3')
compute_distance is  tensor(143.2156, device='cuda:3')
compute_norm is  tensor(47.8691, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(143.2156, device='cuda:3')
distance x is tensor(143.2156, device='cuda:3')
________________________________
test distance is  tensor(143.2156, device='cuda:3')
test distance1 is  tensor(143.2156, device='cuda:3')
test similarity is  tensor(0.9427, device='cuda:3')
test acc is  0.26026666682300525
test loss is 1.5429889990576804
test entropy is  0.9854244562481512
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.301552414894104
mal norm is  tensor(734.8576, device='cuda:3')
distance x is tensor(143.2240, device='cuda:3')
mal distance is  tensor(143.2240, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(24.2967, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.3839, device='cuda:3')
user_param_square tensor(113.8396, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(41.7369, device='cuda:3')
score : tensor(0.3933, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.9665, device='cuda:3')
user_param_square tensor(113.2600, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-8.4643, device='cuda:3')
score : tensor(-0.1087, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.0612, device='cuda:3')
user_param_square tensor(119.0228, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(29.7509, device='cuda:3')
score : tensor(0.2734, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.8145, device='cuda:3')
user_param_square tensor(108.4208, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(20.4260, device='cuda:3')
score : tensor(0.1802, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.2979, device='cuda:3')
user_param_square tensor(111.6755, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-30.9335, device='cuda:3')
score : tensor(-0.3334, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(538.8905, device='cuda:3')
user_param_square tensor(114.4257, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-19.0291, device='cuda:3')
score : tensor(-0.2144, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.1780, device='cuda:3')
user_param_square tensor(113.3898, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(40.4180, device='cuda:3')
score : tensor(0.3801, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.7102, device='cuda:3')
user_param_square tensor(115.4635, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(43.8253, device='cuda:3')
score : tensor(0.4142, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8576, device='cuda:3')
user_param_square tensor(133.6210, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-31.7481, device='cuda:3')
score : tensor(-0.3416, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.9254, device='cuda:3')
user_param_square tensor(126.0484, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(43.5643, device='cuda:3')
score : tensor(0.4115, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.8697, device='cuda:3')
user_param_square tensor(125.4634, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-0.9024, device='cuda:3')
score : tensor(-0.0331, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.2896, device='cuda:3')
user_param_square tensor(117.1949, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(16.5994, device='cuda:3')
score : tensor(0.1419, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.9518, device='cuda:3')
user_param_square tensor(119.7241, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(-18.5537, device='cuda:3')
score : tensor(-0.2096, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.1379, device='cuda:3')
user_param_square tensor(118.5193, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(16.6695, device='cuda:3')
score : tensor(0.1426, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.3329, device='cuda:3')
user_param_square tensor(120.8734, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(33.2774, device='cuda:3')
score : tensor(0.3087, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.8598, device='cuda:3')
user_param_square tensor(120.4230, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(53.0221, device='cuda:3')
score : tensor(0.5061, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.2845, device='cuda:3')
user_param_square tensor(121.1697, device='cuda:3')
global_param_square tensor(24.2967, device='cuda:3')
part1 is  tensor(4.6775, device='cuda:3')
score : tensor(0.0227, device='cuda:3')
accept
len accept list 11
len all weights is 11
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.69% 

Test Accuracy: 88.81% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7343531847000122
distance x is tensor(90.3014, device='cuda:3')
benign distance is  tensor(90.3014, device='cuda:3')
norm1 res is  tensor(0.1020, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.1294451802968979
distance x is tensor(120.0661, device='cuda:3')
benign distance is  tensor(120.0661, device='cuda:3')
norm1 res is  tensor(0.1340, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.17748801410198212
distance x is tensor(102.4732, device='cuda:3')
benign distance is  tensor(102.4732, device='cuda:3')
norm1 res is  tensor(0.1119, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.38766610622406006
distance x is tensor(104.7438, device='cuda:3')
benign distance is  tensor(104.7438, device='cuda:3')
norm1 res is  tensor(0.1135, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.39281922578811646
distance x is tensor(108.4119, device='cuda:3')
benign distance is  tensor(108.4119, device='cuda:3')
norm1 res is  tensor(0.1157, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5195934176445007
distance x is tensor(128.6711, device='cuda:3')
benign distance is  tensor(128.6711, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5292588472366333
distance x is tensor(119.2984, device='cuda:3')
benign distance is  tensor(119.2984, device='cuda:3')
norm1 res is  tensor(0.1282, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.11442700773477554
distance x is tensor(114.9229, device='cuda:3')
benign distance is  tensor(114.9229, device='cuda:3')
norm1 res is  tensor(0.1269, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.7049938440322876
distance x is tensor(135.1673, device='cuda:3')
benign distance is  tensor(135.1673, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.4730835556983948
distance x is tensor(131.9392, device='cuda:3')
benign distance is  tensor(131.9392, device='cuda:3')
norm1 res is  tensor(0.1420, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  1.4787899255752563
distance x is tensor(133.1886, device='cuda:3')
benign distance is  tensor(133.1886, device='cuda:3')
norm1 res is  tensor(0.1421, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.9011306762695312
distance x is tensor(137.0078, device='cuda:3')
benign distance is  tensor(137.0078, device='cuda:3')
norm1 res is  tensor(0.1487, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.6519436836242676
distance x is tensor(133.8525, device='cuda:3')
benign distance is  tensor(133.8525, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.19384482502937317
distance x is tensor(140.2885, device='cuda:3')
benign distance is  tensor(140.2885, device='cuda:3')
norm1 res is  tensor(0.1505, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4068858027458191
distance x is tensor(124.1408, device='cuda:3')
benign distance is  tensor(124.1408, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.6012555360794067
distance x is tensor(138.9951, device='cuda:3')
benign distance is  tensor(138.9951, device='cuda:3')
norm1 res is  tensor(0.1505, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(132.1369, device='cuda:3')
compute distance is  tensor(132.1369, device='cuda:3')
compute norm is  tensor(47.0059, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.0229, device='cuda:3')
compute distance is  tensor(122.0229, device='cuda:3')
compute norm is  tensor(46.7744, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6592, device='cuda:3')
compute distance is  tensor(131.6592, device='cuda:3')
compute norm is  tensor(46.9816, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5294, device='cuda:3')
compute distance is  tensor(121.5294, device='cuda:3')
compute norm is  tensor(46.7969, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9022, device='cuda:3')
compute distance is  tensor(130.9022, device='cuda:3')
compute norm is  tensor(46.9912, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.6991, device='cuda:3')
compute distance is  tensor(136.6991, device='cuda:3')
compute norm is  tensor(47.2280, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7122, device='cuda:3')
compute distance is  tensor(128.7122, device='cuda:3')
compute norm is  tensor(46.9493, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.0151, device='cuda:3')
compute distance is  tensor(128.0151, device='cuda:3')
compute norm is  tensor(46.9600, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7240, device='cuda:3')
compute distance is  tensor(138.7240, device='cuda:3')
compute norm is  tensor(47.3328, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9850, device='cuda:3')
compute distance is  tensor(132.9850, device='cuda:3')
compute norm is  tensor(47.1781, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1270, device='cuda:3')
compute distance is  tensor(131.1270, device='cuda:3')
compute norm is  tensor(46.9752, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0012, device='cuda:3')
compute distance is  tensor(127.0012, device='cuda:3')
compute norm is  tensor(46.9505, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.7240, device='cuda:3')
distance x is tensor(107665.2344, device='cuda:3')
distance x is tensor(107665.2344, device='cuda:3')
________________________________
test distance is  tensor(107665.2344, device='cuda:3')
test distance1 is  tensor(107665.2344, device='cuda:3')
test similarity is  tensor(0.1078, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129965153205258.92
test entropy is  0.0
________________________________
cal ratio is  0.035177435267474445
distance x is tensor(3787.3921, device='cuda:3')
cal_distance is  tensor(3787.3921, device='cuda:3')
cal ratio is  0.18755636088948835
distance x is tensor(710.3536, device='cuda:3')
cal_distance is  tensor(710.3536, device='cuda:3')
cal ratio is  0.433076501211753
distance x is tensor(307.6403, device='cuda:3')
cal_distance is  tensor(307.6403, device='cuda:3')
cal ratio is  0.6580824298259086
distance x is tensor(202.4544, device='cuda:3')
cal_distance is  tensor(202.4544, device='cuda:3')
cal ratio is  0.8112193054922666
distance x is tensor(164.2359, device='cuda:3')
cal_distance is  tensor(164.2359, device='cuda:3')
cal ratio is  0.9006744281062957
distance x is tensor(147.9236, device='cuda:3')
cal_distance is  tensor(147.9236, device='cuda:3')
cal ratio is  0.9490370062631166
distance x is tensor(140.3852, device='cuda:3')
cal_distance is  tensor(140.3852, device='cuda:3')
cal ratio is  0.9741844812161518
distance x is tensor(136.7613, device='cuda:3')
cal_distance is  tensor(136.7613, device='cuda:3')
distance x is tensor(136.7613, device='cuda:3')
return_distance is  tensor(136.7613, device='cuda:3')
distance x is tensor(136.7511, device='cuda:3')
distance x is tensor(136.7511, device='cuda:3')
________________________________
test distance is  tensor(136.7511, device='cuda:3')
test distance1 is  tensor(136.7511, device='cuda:3')
test similarity is  tensor(0.9492, device='cuda:3')
test acc is  0.1014833334896653
test loss is 205.78683079636173
test entropy is  0.0005680244445052078
________________________________
0
distance x is tensor(136.7511, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0005546127366831774
avg test loss is  205.57826955181196
avg accuracy is  0.5193500001563423
solo acc is  0.10136666682299864
compute similarity  is  tensor(0.9492, device='cuda:3')
compute_distance is  tensor(136.7511, device='cuda:3')
compute_norm is  tensor(47.7381, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(127.2031, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9805196776573084
avg test loss is  1.5032790540886332
avg accuracy is  0.834250000156324
solo acc is  0.2931666668230061
compute similarity  is  tensor(0.9523, device='cuda:3')
compute_distance is  tensor(127.2031, device='cuda:3')
compute_norm is  tensor(47.5466, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.8440, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9158432422670474
avg test loss is  1.5431074183632825
avg accuracy is  0.8380666668229905
solo acc is  0.24466666682300472
compute similarity  is  tensor(0.9521, device='cuda:3')
compute_distance is  tensor(127.8440, device='cuda:3')
compute_norm is  tensor(47.3086, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.4449, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9091815598992142
avg test loss is  1.4934895001748987
avg accuracy is  0.8404833334896571
solo acc is  0.24556666682300476
compute similarity  is  tensor(0.9519, device='cuda:3')
compute_distance is  tensor(128.4449, device='cuda:3')
compute_norm is  tensor(47.0719, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.0897, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8763190376987335
avg test loss is  1.475549736638059
avg accuracy is  0.8470000001563235
solo acc is  0.24963333348967157
compute similarity  is  tensor(0.9518, device='cuda:3')
compute_distance is  tensor(129.0897, device='cuda:3')
compute_norm is  tensor(46.8406, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.8194, device='cuda:3')
distance x is tensor(129.8194, device='cuda:3')
________________________________
test distance is  tensor(129.8194, device='cuda:3')
test distance1 is  tensor(129.8194, device='cuda:3')
test similarity is  tensor(0.9516, device='cuda:3')
test acc is  0.24538333348967145
test loss is 1.4454331711919577
test entropy is  0.8831160423725144
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4415863752365112
mal norm is  tensor(658.0359, device='cuda:3')
distance x is tensor(129.8279, device='cuda:3')
mal distance is  tensor(129.8279, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(16.9612, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(397.8921, device='cuda:3')
user_param_square tensor(82.1506, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-24.1226, device='cuda:3')
score : tensor(-0.2580, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.5350, device='cuda:3')
user_param_square tensor(94.2325, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(0.1278, device='cuda:3')
score : tensor(-0.0155, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(443.9192, device='cuda:3')
user_param_square tensor(86.7720, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-0.2171, device='cuda:3')
score : tensor(-0.0189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(445.0441, device='cuda:3')
user_param_square tensor(86.8819, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(16.7736, device='cuda:3')
score : tensor(0.1510, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.4065, device='cuda:3')
user_param_square tensor(87.7910, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-8.8970, device='cuda:3')
score : tensor(-0.1057, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.4979, device='cuda:3')
user_param_square tensor(96.4529, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-12.1029, device='cuda:3')
score : tensor(-0.1378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.8510, device='cuda:3')
user_param_square tensor(92.2604, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-26.5043, device='cuda:3')
score : tensor(-0.2818, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.6892, device='cuda:3')
user_param_square tensor(91.3215, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(9.9742, device='cuda:3')
score : tensor(0.0830, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0359, device='cuda:3')
user_param_square tensor(105.6459, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(2.6479, device='cuda:3')
score : tensor(0.0097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.8812, device='cuda:3')
user_param_square tensor(103.4431, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(10.7982, device='cuda:3')
score : tensor(0.0912, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.7349, device='cuda:3')
user_param_square tensor(104.2478, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(0.3548, device='cuda:3')
score : tensor(-0.0132, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.7229, device='cuda:3')
user_param_square tensor(102.7721, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(4.9441, device='cuda:3')
score : tensor(0.0327, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.0245, device='cuda:3')
user_param_square tensor(103.7005, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(19.6903, device='cuda:3')
score : tensor(0.1801, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.5049, device='cuda:3')
user_param_square tensor(102.7541, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-7.6430, device='cuda:3')
score : tensor(-0.0932, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.0137, device='cuda:3')
user_param_square tensor(103.5359, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(19.1146, device='cuda:3')
score : tensor(0.1744, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.3651, device='cuda:3')
user_param_square tensor(103.2366, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-25.5216, device='cuda:3')
score : tensor(-0.2720, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.0914, device='cuda:3')
user_param_square tensor(101.8910, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(4.6820, device='cuda:3')
score : tensor(0.0301, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.9620, device='cuda:3')
user_param_square tensor(102.7093, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-17.9689, device='cuda:3')
score : tensor(-0.1965, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9813, device='cuda:3')
user_param_square tensor(106.4413, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-19.7499, device='cuda:3')
score : tensor(-0.2143, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3142, device='cuda:3')
user_param_square tensor(106.3083, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(8.6305, device='cuda:3')
score : tensor(0.0695, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.0164, device='cuda:3')
user_param_square tensor(98.7570, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(22.3846, device='cuda:3')
score : tensor(0.2071, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.3592, device='cuda:3')
user_param_square tensor(102.7421, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(19.6098, device='cuda:3')
score : tensor(0.1793, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8253, device='cuda:3')
user_param_square tensor(102.9454, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-8.0904, device='cuda:3')
score : tensor(-0.0977, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.4443, device='cuda:3')
user_param_square tensor(101.3363, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-6.5578, device='cuda:3')
score : tensor(-0.0823, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.4422, device='cuda:3')
user_param_square tensor(104.7111, device='cuda:3')
global_param_square tensor(16.9612, device='cuda:3')
part1 is  tensor(-2.4370, device='cuda:3')
score : tensor(-0.0411, device='cuda:3')
len accept list 22
len all weights is 22
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 87.63% 

Test Accuracy: 86.83% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
 benign loss is  0.337102472782135
distance x is tensor(132.6842, device='cuda:3')
benign distance is  tensor(132.6842, device='cuda:3')
norm1 res is  tensor(0.1439, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.42360299825668335
distance x is tensor(152.5880, device='cuda:3')
benign distance is  tensor(152.5880, device='cuda:3')
norm1 res is  tensor(0.1617, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.19266632199287415
distance x is tensor(132.8756, device='cuda:3')
benign distance is  tensor(132.8756, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.24630387127399445
distance x is tensor(134.6623, device='cuda:3')
benign distance is  tensor(134.6623, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.761886477470398
distance x is tensor(122.5673, device='cuda:3')
benign distance is  tensor(122.5673, device='cuda:3')
norm1 res is  tensor(0.1306, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.32718193531036377
distance x is tensor(157.7731, device='cuda:3')
benign distance is  tensor(157.7731, device='cuda:3')
norm1 res is  tensor(0.1653, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.32635563611984253
distance x is tensor(139.7223, device='cuda:3')
benign distance is  tensor(139.7223, device='cuda:3')
norm1 res is  tensor(0.1440, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2549210488796234
distance x is tensor(138.9357, device='cuda:3')
benign distance is  tensor(138.9357, device='cuda:3')
norm1 res is  tensor(0.1489, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.21858899295330048
distance x is tensor(150.3574, device='cuda:3')
benign distance is  tensor(150.3574, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.3715858459472656
distance x is tensor(161.3473, device='cuda:3')
benign distance is  tensor(161.3473, device='cuda:3')
norm1 res is  tensor(0.1706, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.17650385200977325
distance x is tensor(150.3422, device='cuda:3')
benign distance is  tensor(150.3422, device='cuda:3')
norm1 res is  tensor(0.1577, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.23701786994934082
distance x is tensor(141.4697, device='cuda:3')
benign distance is  tensor(141.4697, device='cuda:3')
norm1 res is  tensor(0.1544, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.247501403093338
distance x is tensor(143.4106, device='cuda:3')
benign distance is  tensor(143.4106, device='cuda:3')
norm1 res is  tensor(0.1504, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.6358364224433899
distance x is tensor(131.5369, device='cuda:3')
benign distance is  tensor(131.5369, device='cuda:3')
norm1 res is  tensor(0.1375, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.9883553385734558
distance x is tensor(147.2524, device='cuda:3')
benign distance is  tensor(147.2524, device='cuda:3')
norm1 res is  tensor(0.1568, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.3911300003528595
distance x is tensor(150.0034, device='cuda:3')
benign distance is  tensor(150.0034, device='cuda:3')
norm1 res is  tensor(0.1589, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.49468469619750977
distance x is tensor(137.2025, device='cuda:3')
benign distance is  tensor(137.2025, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.06397000700235367
distance x is tensor(151.6303, device='cuda:3')
benign distance is  tensor(151.6303, device='cuda:3')
norm1 res is  tensor(0.1624, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.37398916482925415
distance x is tensor(148.0729, device='cuda:3')
benign distance is  tensor(148.0729, device='cuda:3')
norm1 res is  tensor(0.1570, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.0765191838145256
distance x is tensor(145.1986, device='cuda:3')
benign distance is  tensor(145.1986, device='cuda:3')
norm1 res is  tensor(0.1540, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.57740718126297
distance x is tensor(145.6986, device='cuda:3')
benign distance is  tensor(145.6986, device='cuda:3')
norm1 res is  tensor(0.1543, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.21683350205421448
distance x is tensor(138.4048, device='cuda:3')
benign distance is  tensor(138.4048, device='cuda:3')
norm1 res is  tensor(0.1442, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.5225720405578613
distance x is tensor(153.9742, device='cuda:3')
benign distance is  tensor(153.9742, device='cuda:3')
norm1 res is  tensor(0.1608, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.10030603408813477
distance x is tensor(148.8880, device='cuda:3')
benign distance is  tensor(148.8880, device='cuda:3')
norm1 res is  tensor(0.1564, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(145.2234, device='cuda:3')
compute distance is  tensor(145.2234, device='cuda:3')
compute norm is  tensor(47.2247, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9256, device='cuda:3')
compute distance is  tensor(124.9256, device='cuda:3')
compute norm is  tensor(46.8099, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.3009, device='cuda:3')
compute distance is  tensor(153.3009, device='cuda:3')
compute norm is  tensor(47.5058, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.8274, device='cuda:3')
compute distance is  tensor(135.8274, device='cuda:3')
compute norm is  tensor(47.1305, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.3910, device='cuda:3')
compute distance is  tensor(152.3910, device='cuda:3')
compute norm is  tensor(47.3956, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.3200, device='cuda:3')
compute distance is  tensor(156.3200, device='cuda:3')
compute norm is  tensor(47.6861, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.4968, device='cuda:3')
compute distance is  tensor(148.4968, device='cuda:3')
compute norm is  tensor(47.3537, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4466, device='cuda:3')
compute distance is  tensor(131.4466, device='cuda:3')
compute norm is  tensor(47.0620, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.4292, device='cuda:3')
compute distance is  tensor(146.4292, device='cuda:3')
compute norm is  tensor(47.3562, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.2645, device='cuda:3')
compute distance is  tensor(131.2645, device='cuda:3')
compute norm is  tensor(47.0622, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5524, device='cuda:3')
compute distance is  tensor(137.5524, device='cuda:3')
compute norm is  tensor(47.2003, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5003, device='cuda:3')
compute distance is  tensor(137.5003, device='cuda:3')
compute norm is  tensor(47.1775, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(156.3200, device='cuda:3')
distance x is tensor(107627.4062, device='cuda:3')
distance x is tensor(107627.4062, device='cuda:3')
________________________________
test distance is  tensor(107627.4062, device='cuda:3')
test distance1 is  tensor(107627.4062, device='cuda:3')
test similarity is  tensor(0.2274, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130079872919652.44
test entropy is  0.0
________________________________
cal ratio is  0.037348395214180354
distance x is tensor(4019.7158, device='cuda:3')
cal_distance is  tensor(4019.7158, device='cuda:3')
cal ratio is  0.1932572120191152
distance x is tensor(776.8433, device='cuda:3')
cal_distance is  tensor(776.8433, device='cuda:3')
cal ratio is  0.439609097470009
distance x is tensor(341.5102, device='cuda:3')
cal_distance is  tensor(341.5102, device='cuda:3')
cal ratio is  0.6630274753242862
distance x is tensor(226.4324, device='cuda:3')
cal_distance is  tensor(226.4324, device='cuda:3')
cal ratio is  0.8142619341853249
distance x is tensor(184.3762, device='cuda:3')
cal_distance is  tensor(184.3762, device='cuda:3')
cal ratio is  0.9023622909952972
distance x is tensor(166.3746, device='cuda:3')
cal_distance is  tensor(166.3746, device='cuda:3')
cal ratio is  0.9499261037922377
distance x is tensor(158.0439, device='cuda:3')
cal_distance is  tensor(158.0439, device='cuda:3')
cal ratio is  0.9746407142752991
distance x is tensor(154.0361, device='cuda:3')
cal_distance is  tensor(154.0361, device='cuda:3')
distance x is tensor(154.0361, device='cuda:3')
return_distance is  tensor(154.0361, device='cuda:3')
distance x is tensor(154.0260, device='cuda:3')
distance x is tensor(154.0260, device='cuda:3')
________________________________
test distance is  tensor(154.0260, device='cuda:3')
test distance1 is  tensor(154.0260, device='cuda:3')
test similarity is  tensor(0.9449, device='cuda:3')
test acc is  0.10006666682299865
test loss is 324.3143999957835
test entropy is  2.3085567476950894e-05
________________________________
0
distance x is tensor(154.0260, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.0282877186131014e-05
avg test loss is  324.80719303220576
avg accuracy is  0.2442666668230047
solo acc is  0.10011666682299865
compute similarity  is  tensor(0.9449, device='cuda:3')
compute_distance is  tensor(154.0260, device='cuda:3')
compute_norm is  tensor(49.2842, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.6086, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1351911735687175
avg test loss is  1.7864881434928634
avg accuracy is  0.497700000156342
solo acc is  0.21048333348967013
compute similarity  is  tensor(0.9468, device='cuda:3')
compute_distance is  tensor(147.6086, device='cuda:3')
compute_norm is  tensor(49.9368, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(148.5501, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6529904426669261
avg test loss is  2.5741316179222644
avg accuracy is  0.3573500001563405
solo acc is  0.10888333348966528
compute similarity  is  tensor(0.9466, device='cuda:3')
compute_distance is  tensor(148.5501, device='cuda:3')
compute_norm is  tensor(49.8195, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(148.7698, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9854708419425655
avg test loss is  1.5481001329320325
avg accuracy is  0.5256000001563422
solo acc is  0.2514000001563383
compute similarity  is  tensor(0.9472, device='cuda:3')
compute_distance is  tensor(148.7698, device='cuda:3')
compute_norm is  tensor(49.4953, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(148.7698, device='cuda:3')
distance x is tensor(148.7698, device='cuda:3')
________________________________
test distance is  tensor(148.7698, device='cuda:3')
test distance1 is  tensor(148.7698, device='cuda:3')
test similarity is  tensor(0.9472, device='cuda:3')
test acc is  0.2555500001563384
test loss is 1.5421577284076828
test entropy is  0.9865067583411488
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.437373399734497
mal norm is  tensor(756.7240, device='cuda:3')
distance x is tensor(148.7786, device='cuda:3')
mal distance is  tensor(148.7786, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(15.6186, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.0142, device='cuda:3')
user_param_square tensor(94.0231, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(58.4008, device='cuda:3')
score : tensor(0.5686, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.6694, device='cuda:3')
user_param_square tensor(100.1098, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(39.9135, device='cuda:3')
score : tensor(0.3837, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(551.5633, device='cuda:3')
user_param_square tensor(92.8151, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(64.0610, device='cuda:3')
score : tensor(0.6252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.1715, device='cuda:3')
user_param_square tensor(93.2020, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(24.7918, device='cuda:3')
score : tensor(0.2325, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.4742, device='cuda:3')
user_param_square tensor(89.4658, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(45.2144, device='cuda:3')
score : tensor(0.4367, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.2911, device='cuda:3')
user_param_square tensor(101.1668, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(64.1266, device='cuda:3')
score : tensor(0.6258, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.6729, device='cuda:3')
user_param_square tensor(94.0778, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(47.2761, device='cuda:3')
score : tensor(0.4573, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.2358, device='cuda:3')
user_param_square tensor(95.6063, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(52.1677, device='cuda:3')
score : tensor(0.5063, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.7240, device='cuda:3')
user_param_square tensor(108.7150, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(-80.7151, device='cuda:3')
score : tensor(-0.8226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.5956, device='cuda:3')
user_param_square tensor(104.1566, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(59.7147, device='cuda:3')
score : tensor(0.5817, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.3607, device='cuda:3')
user_param_square tensor(95.7797, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(29.6332, device='cuda:3')
score : tensor(0.2809, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.0473, device='cuda:3')
user_param_square tensor(102.1467, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(58.7905, device='cuda:3')
score : tensor(0.5725, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3198, device='cuda:3')
user_param_square tensor(101.8614, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(45.3223, device='cuda:3')
score : tensor(0.4378, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.0148, device='cuda:3')
user_param_square tensor(101.6845, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(42.5430, device='cuda:3')
score : tensor(0.4100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.2883, device='cuda:3')
user_param_square tensor(104.5079, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(24.2675, device='cuda:3')
score : tensor(0.2273, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.4285, device='cuda:3')
user_param_square tensor(97.5624, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(57.0712, device='cuda:3')
score : tensor(0.5553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.6523, device='cuda:3')
user_param_square tensor(104.2358, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(57.8155, device='cuda:3')
score : tensor(0.5627, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.4300, device='cuda:3')
user_param_square tensor(101.4858, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(59.7517, device='cuda:3')
score : tensor(0.5821, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.7609, device='cuda:3')
user_param_square tensor(100.0389, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(26.2072, device='cuda:3')
score : tensor(0.2467, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.9498, device='cuda:3')
user_param_square tensor(100.2875, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(52.8286, device='cuda:3')
score : tensor(0.5129, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.0892, device='cuda:3')
user_param_square tensor(102.0735, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(40.9739, device='cuda:3')
score : tensor(0.3943, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.5864, device='cuda:3')
user_param_square tensor(101.9584, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(37.3044, device='cuda:3')
score : tensor(0.3576, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.6599, device='cuda:3')
user_param_square tensor(102.8031, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(60.0267, device='cuda:3')
score : tensor(0.5848, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.0853, device='cuda:3')
user_param_square tensor(98.4910, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(36.2466, device='cuda:3')
score : tensor(0.3470, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.6314, device='cuda:3')
user_param_square tensor(102.4966, device='cuda:3')
global_param_square tensor(15.6186, device='cuda:3')
part1 is  tensor(39.3188, device='cuda:3')
score : tensor(0.3778, device='cuda:3')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.61% 

Test Accuracy: 88.85% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
 benign loss is  0.9089218974113464
distance x is tensor(109.9179, device='cuda:3')
benign distance is  tensor(109.9179, device='cuda:3')
norm1 res is  tensor(0.1186, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.6202342510223389
distance x is tensor(126.8126, device='cuda:3')
benign distance is  tensor(126.8126, device='cuda:3')
norm1 res is  tensor(0.1373, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3045089840888977
distance x is tensor(112.2218, device='cuda:3')
benign distance is  tensor(112.2218, device='cuda:3')
norm1 res is  tensor(0.1203, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7362316846847534
distance x is tensor(129.0353, device='cuda:3')
benign distance is  tensor(129.0353, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7188447117805481
distance x is tensor(111.4631, device='cuda:3')
benign distance is  tensor(111.4631, device='cuda:3')
norm1 res is  tensor(0.1219, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3281923532485962
distance x is tensor(126.3773, device='cuda:3')
benign distance is  tensor(126.3773, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.15430191159248352
distance x is tensor(102.5404, device='cuda:3')
benign distance is  tensor(102.5404, device='cuda:3')
norm1 res is  tensor(0.1100, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.18676622211933136
distance x is tensor(115.8198, device='cuda:3')
benign distance is  tensor(115.8198, device='cuda:3')
norm1 res is  tensor(0.1266, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3451331555843353
distance x is tensor(133.8531, device='cuda:3')
benign distance is  tensor(133.8531, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.5840290188789368
distance x is tensor(125.0239, device='cuda:3')
benign distance is  tensor(125.0239, device='cuda:3')
norm1 res is  tensor(0.1345, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  1.1753596067428589
distance x is tensor(128.8942, device='cuda:3')
benign distance is  tensor(128.8942, device='cuda:3')
norm1 res is  tensor(0.1378, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5009950399398804
distance x is tensor(130.9081, device='cuda:3')
benign distance is  tensor(130.9081, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.2560169994831085
distance x is tensor(120.0006, device='cuda:3')
benign distance is  tensor(120.0006, device='cuda:3')
norm1 res is  tensor(0.1295, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.15175442397594452
distance x is tensor(134.3724, device='cuda:3')
benign distance is  tensor(134.3724, device='cuda:3')
norm1 res is  tensor(0.1437, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.8431989550590515
distance x is tensor(135.3400, device='cuda:3')
benign distance is  tensor(135.3400, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.8734104037284851
distance x is tensor(130.4521, device='cuda:3')
benign distance is  tensor(130.4521, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.2404555082321167
distance x is tensor(127.6471, device='cuda:3')
benign distance is  tensor(127.6471, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.15643736720085144
distance x is tensor(125.1489, device='cuda:3')
benign distance is  tensor(125.1489, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.2405402660369873
distance x is tensor(132.2755, device='cuda:3')
benign distance is  tensor(132.2755, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.2951556146144867
distance x is tensor(142.2046, device='cuda:3')
benign distance is  tensor(142.2046, device='cuda:3')
norm1 res is  tensor(0.1505, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.8213027119636536
distance x is tensor(127.8855, device='cuda:3')
benign distance is  tensor(127.8855, device='cuda:3')
norm1 res is  tensor(0.1380, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.46523672342300415
distance x is tensor(136.5148, device='cuda:3')
benign distance is  tensor(136.5148, device='cuda:3')
norm1 res is  tensor(0.1475, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.6224778890609741
distance x is tensor(133.3175, device='cuda:3')
benign distance is  tensor(133.3175, device='cuda:3')
norm1 res is  tensor(0.1454, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.5339053869247437
distance x is tensor(127.9639, device='cuda:3')
benign distance is  tensor(127.9639, device='cuda:3')
norm1 res is  tensor(0.1415, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(120.2143, device='cuda:3')
compute distance is  tensor(120.2143, device='cuda:3')
compute norm is  tensor(46.9399, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.5933, device='cuda:3')
compute distance is  tensor(122.5933, device='cuda:3')
compute norm is  tensor(47.1636, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.5164, device='cuda:3')
compute distance is  tensor(131.5164, device='cuda:3')
compute norm is  tensor(47.3230, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1136, device='cuda:3')
compute distance is  tensor(122.1136, device='cuda:3')
compute norm is  tensor(47.0506, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.0011, device='cuda:3')
compute distance is  tensor(129.0011, device='cuda:3')
compute norm is  tensor(47.1204, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9958, device='cuda:3')
compute distance is  tensor(120.9958, device='cuda:3')
compute norm is  tensor(47.1221, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.5369, device='cuda:3')
compute distance is  tensor(131.5369, device='cuda:3')
compute norm is  tensor(47.2710, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9062, device='cuda:3')
compute distance is  tensor(119.9062, device='cuda:3')
compute norm is  tensor(47.0194, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4188, device='cuda:3')
compute distance is  tensor(134.4188, device='cuda:3')
compute norm is  tensor(47.2160, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.0188, device='cuda:3')
compute distance is  tensor(125.0188, device='cuda:3')
compute norm is  tensor(47.1862, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.2735, device='cuda:3')
compute distance is  tensor(137.2735, device='cuda:3')
compute norm is  tensor(47.6136, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.6949, device='cuda:3')
compute distance is  tensor(118.6949, device='cuda:3')
compute norm is  tensor(47.0336, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.2735, device='cuda:3')
distance x is tensor(107655.5781, device='cuda:3')
distance x is tensor(107655.5781, device='cuda:3')
________________________________
test distance is  tensor(107655.5781, device='cuda:3')
test distance1 is  tensor(107655.5781, device='cuda:3')
test similarity is  tensor(0.1482, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130060384752375.81
test entropy is  0.0
________________________________
cal ratio is  0.03499460382232706
distance x is tensor(3767.3694, device='cuda:3')
cal_distance is  tensor(3767.3694, device='cuda:3')
cal ratio is  0.1870683227293048
distance x is tensor(704.7596, device='cuda:3')
cal_distance is  tensor(704.7596, device='cuda:3')
cal ratio is  0.43251268144989996
distance x is tensor(304.8203, device='cuda:3')
cal_distance is  tensor(304.8203, device='cuda:3')
cal ratio is  0.6576538816750612
distance x is tensor(200.4680, device='cuda:3')
cal_distance is  tensor(200.4680, device='cuda:3')
cal ratio is  0.8109550642783164
distance x is tensor(162.5715, device='cuda:3')
cal_distance is  tensor(162.5715, device='cuda:3')
cal ratio is  0.9005277262538421
distance x is tensor(146.4007, device='cuda:3')
cal_distance is  tensor(146.4007, device='cuda:3')
cal ratio is  0.948959735372424
distance x is tensor(138.9286, device='cuda:3')
cal_distance is  tensor(138.9286, device='cuda:3')
cal ratio is  0.9741447577991907
distance x is tensor(135.3367, device='cuda:3')
cal_distance is  tensor(135.3367, device='cuda:3')
distance x is tensor(135.3367, device='cuda:3')
return_distance is  tensor(135.3367, device='cuda:3')
distance x is tensor(135.3266, device='cuda:3')
distance x is tensor(135.3266, device='cuda:3')
________________________________
test distance is  tensor(135.3266, device='cuda:3')
test distance1 is  tensor(135.3266, device='cuda:3')
test similarity is  tensor(0.9523, device='cuda:3')
test acc is  0.1026833334896653
test loss is 164.77289079450594
test entropy is  0.0014883596003678818
________________________________
0
distance x is tensor(135.3266, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0012108924812149092
avg test loss is  164.23898381312517
avg accuracy is  0.5934500001563381
solo acc is  0.10315000015633197
compute similarity  is  tensor(0.9523, device='cuda:3')
compute_distance is  tensor(135.3266, device='cuda:3')
compute_norm is  tensor(48.1973, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(126.0124, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9626781083246284
avg test loss is  1.4234013285464062
avg accuracy is  0.8301500001563241
solo acc is  0.3042500001563395
compute similarity  is  tensor(0.9551, device='cuda:3')
compute_distance is  tensor(126.0124, device='cuda:3')
compute_norm is  tensor(48.0242, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.6641, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9072926437168487
avg test loss is  1.4879173617373143
avg accuracy is  0.8301833334896574
solo acc is  0.2501000001563382
compute similarity  is  tensor(0.9549, device='cuda:3')
compute_distance is  tensor(126.6641, device='cuda:3')
compute_norm is  tensor(47.7850, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.2893, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8928787436947894
avg test loss is  1.4614486836675387
avg accuracy is  0.8335666668229907
solo acc is  0.24843333348967153
compute similarity  is  tensor(0.9548, device='cuda:3')
compute_distance is  tensor(127.2893, device='cuda:3')
compute_norm is  tensor(47.5525, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.8542, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8758566511719466
avg test loss is  1.441611213343484
avg accuracy is  0.8387500001563238
solo acc is  0.24693333348967145
compute similarity  is  tensor(0.9547, device='cuda:3')
compute_distance is  tensor(127.8542, device='cuda:3')
compute_norm is  tensor(47.3199, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.5835, device='cuda:3')
distance x is tensor(128.5835, device='cuda:3')
________________________________
test distance is  tensor(128.5835, device='cuda:3')
test distance1 is  tensor(128.5835, device='cuda:3')
test similarity is  tensor(0.9545, device='cuda:3')
test acc is  0.2512166668230049
test loss is 1.4045488249772646
test entropy is  0.8819514112686043
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.157842755317688
mal norm is  tensor(649.5978, device='cuda:3')
distance x is tensor(128.5925, device='cuda:3')
mal distance is  tensor(128.5925, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(19.8625, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(468.7293, device='cuda:3')
user_param_square tensor(96.4891, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(-23.0746, device='cuda:3')
score : tensor(-0.2504, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.0336, device='cuda:3')
user_param_square tensor(103.2804, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(-4.5839, device='cuda:3')
score : tensor(-0.0655, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(469.7169, device='cuda:3')
user_param_square tensor(96.5907, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(5.3178, device='cuda:3')
score : tensor(0.0335, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(538.3177, device='cuda:3')
user_param_square tensor(103.4038, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(-52.0872, device='cuda:3')
score : tensor(-0.5405, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(474.6231, device='cuda:3')
user_param_square tensor(97.0939, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(-37.6716, device='cuda:3')
score : tensor(-0.3964, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.9067, device='cuda:3')
user_param_square tensor(104.4159, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(-24.4688, device='cuda:3')
score : tensor(-0.2644, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(426.9411, device='cuda:3')
user_param_square tensor(92.0876, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(42.2945, device='cuda:3')
score : tensor(0.4033, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.5713, device='cuda:3')
user_param_square tensor(99.6130, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(-15.3628, device='cuda:3')
score : tensor(-0.1733, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.5978, device='cuda:3')
user_param_square tensor(113.5899, device='cuda:3')
global_param_square tensor(19.8625, device='cuda:3')
part1 is  tensor(4.3239, device='cuda:3')
score : tensor(0.0236, device='cuda:3')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 81.40% 

Test Accuracy: 80.49% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
 benign loss is  0.16917897760868073
distance x is tensor(176.6953, device='cuda:3')
benign distance is  tensor(176.6953, device='cuda:3')
norm1 res is  tensor(0.1829, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.3793399333953857
distance x is tensor(159.7177, device='cuda:3')
benign distance is  tensor(159.7177, device='cuda:3')
norm1 res is  tensor(0.1670, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2835502624511719
distance x is tensor(169.7254, device='cuda:3')
benign distance is  tensor(169.7254, device='cuda:3')
norm1 res is  tensor(0.1754, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.662249743938446
distance x is tensor(160.1534, device='cuda:3')
benign distance is  tensor(160.1534, device='cuda:3')
norm1 res is  tensor(0.1654, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5973325967788696
distance x is tensor(150.7408, device='cuda:3')
benign distance is  tensor(150.7408, device='cuda:3')
norm1 res is  tensor(0.1570, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3258879780769348
distance x is tensor(170.1059, device='cuda:3')
benign distance is  tensor(170.1059, device='cuda:3')
norm1 res is  tensor(0.1765, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.4158158302307129
distance x is tensor(157.8057, device='cuda:3')
benign distance is  tensor(157.8057, device='cuda:3')
norm1 res is  tensor(0.1629, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.6757753491401672
distance x is tensor(155.0022, device='cuda:3')
benign distance is  tensor(155.0022, device='cuda:3')
norm1 res is  tensor(0.1648, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(167.9372, device='cuda:3')
compute distance is  tensor(167.9372, device='cuda:3')
compute norm is  tensor(48.8166, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.5567, device='cuda:3')
compute distance is  tensor(153.5567, device='cuda:3')
compute norm is  tensor(48.5671, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.0923, device='cuda:3')
compute distance is  tensor(177.0923, device='cuda:3')
compute norm is  tensor(49.4263, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.5882, device='cuda:3')
compute distance is  tensor(165.5882, device='cuda:3')
compute norm is  tensor(48.8669, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.7903, device='cuda:3')
compute distance is  tensor(170.7903, device='cuda:3')
compute norm is  tensor(49.1125, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.9526, device='cuda:3')
compute distance is  tensor(166.9526, device='cuda:3')
compute norm is  tensor(49.0496, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.1020, device='cuda:3')
compute distance is  tensor(156.1020, device='cuda:3')
compute norm is  tensor(48.6560, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.8906, device='cuda:3')
compute distance is  tensor(162.8906, device='cuda:3')
compute norm is  tensor(48.7795, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.2827, device='cuda:3')
compute distance is  tensor(168.2827, device='cuda:3')
compute norm is  tensor(48.8579, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.5303, device='cuda:3')
compute distance is  tensor(163.5303, device='cuda:3')
compute norm is  tensor(48.8891, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.5157, device='cuda:3')
compute distance is  tensor(175.5157, device='cuda:3')
compute norm is  tensor(49.3012, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.4289, device='cuda:3')
compute distance is  tensor(161.4289, device='cuda:3')
compute norm is  tensor(48.5912, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(177.0923, device='cuda:3')
distance x is tensor(107591., device='cuda:3')
distance x is tensor(107591., device='cuda:3')
________________________________
test distance is  tensor(107591., device='cuda:3')
test distance1 is  tensor(107591., device='cuda:3')
test similarity is  tensor(0.3345, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130162428278456.5
test entropy is  0.0
________________________________
cal ratio is  0.03975923379465645
distance x is tensor(4277.7412, device='cuda:3')
cal_distance is  tensor(4277.7412, device='cuda:3')
cal ratio is  0.19939704860922006
distance x is tensor(852.9730, device='cuda:3')
cal_distance is  tensor(852.9730, device='cuda:3')
cal ratio is  0.4465379003178656
distance x is tensor(380.8876, device='cuda:3')
cal_distance is  tensor(380.8876, device='cuda:3')
cal ratio is  0.668232443130758
distance x is tensor(254.5231, device='cuda:3')
cal_distance is  tensor(254.5231, device='cuda:3')
cal ratio is  0.8174521441407562
distance x is tensor(208.0614, device='cuda:3')
cal_distance is  tensor(208.0614, device='cuda:3')
cal ratio is  0.9041286184960253
distance x is tensor(188.1148, device='cuda:3')
cal_distance is  tensor(188.1148, device='cuda:3')
cal ratio is  0.9508554593341688
distance x is tensor(178.8702, device='cuda:3')
cal_distance is  tensor(178.8702, device='cuda:3')
cal ratio is  0.975117574376211
distance x is tensor(174.4196, device='cuda:3')
cal_distance is  tensor(174.4196, device='cuda:3')
distance x is tensor(174.4196, device='cuda:3')
return_distance is  tensor(174.4196, device='cuda:3')
distance x is tensor(174.4095, device='cuda:3')
distance x is tensor(174.4095, device='cuda:3')
________________________________
test distance is  tensor(174.4095, device='cuda:3')
test distance1 is  tensor(174.4095, device='cuda:3')
test similarity is  tensor(0.9440, device='cuda:3')
test acc is  0.10003333348966531
test loss is 582.1156760014451
test entropy is  7.626483879901355e-06
________________________________
0
distance x is tensor(174.4095, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.269162321116763e-06
avg test loss is  581.8741241650287
avg accuracy is  0.10756666682299862
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9440, device='cuda:3')
compute_distance is  tensor(174.4095, device='cuda:3')
compute_norm is  tensor(52.0186, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(624.5104, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5586940971518886
avg test loss is  2.8702401093074252
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7536, device='cuda:3')
compute_distance is  tensor(624.5104, device='cuda:3')
compute_norm is  tensor(71.0400, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(622.2327, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.851538436880498
avg test loss is  3.613429552710641
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7537, device='cuda:3')
compute_distance is  tensor(622.2327, device='cuda:3')
compute_norm is  tensor(71.0808, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(618.9607, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5586896484086254
avg test loss is  2.8600270186405954
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7534, device='cuda:3')
compute_distance is  tensor(618.9607, device='cuda:3')
compute_norm is  tensor(70.3392, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(616.7785, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8521757634845115
avg test loss is  3.5998658894984197
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7536, device='cuda:3')
compute_distance is  tensor(616.7785, device='cuda:3')
compute_norm is  tensor(70.4054, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(613.6032, device='cuda:3')
distance x is tensor(613.6032, device='cuda:3')
________________________________
test distance is  tensor(613.6032, device='cuda:3')
test distance1 is  tensor(613.6032, device='cuda:3')
test similarity is  tensor(0.7533, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8576767223476094
test entropy is  1.5601842918121485
________________________________
cal ratio is  0.526480333409248
distance x is tensor(323.0516, device='cuda:3')
cal_distance is  tensor(323.0516, device='cuda:3')
cal ratio is  0.7255878471339114
distance x is tensor(234.4027, device='cuda:3')
cal_distance is  tensor(234.4027, device='cuda:3')
cal ratio is  0.8518138279015487
distance x is tensor(199.6676, device='cuda:3')
cal_distance is  tensor(199.6676, device='cuda:3')
cal ratio is  0.9229372830739737
distance x is tensor(184.2808, device='cuda:3')
cal_distance is  tensor(184.2808, device='cuda:3')
cal ratio is  0.9606959735188186
distance x is tensor(177.0378, device='cuda:3')
cal_distance is  tensor(177.0378, device='cuda:3')
distance x is tensor(177.0378, device='cuda:3')
return_distance is  tensor(177.0378, device='cuda:3')
distance x is tensor(177.0357, device='cuda:3')
distance x is tensor(177.0357, device='cuda:3')
________________________________
test distance is  tensor(177.0357, device='cuda:3')
test distance1 is  tensor(177.0357, device='cuda:3')
test similarity is  tensor(0.9646, device='cuda:3')
test acc is  0.09995000015633199
test loss is 2.5519266832611964
test entropy is  2.040974865844255
________________________________
0
distance x is tensor(177.0357, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.040970543300165
avg test loss is  2.5510229939845073
avg accuracy is  0.10823333348966528
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9646, device='cuda:3')
compute_distance is  tensor(177.0357, device='cuda:3')
compute_norm is  tensor(49.8993, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(178.1363, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8616378077947254
avg test loss is  3.4846768541885083
avg accuracy is  0.10053333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9637, device='cuda:3')
compute_distance is  tensor(178.1363, device='cuda:3')
compute_norm is  tensor(50.2577, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.8886, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1506406863106848
avg test loss is  1.921079708187819
avg accuracy is  0.12435000015633191
solo acc is  0.19388333348966938
compute similarity  is  tensor(0.9638, device='cuda:3')
compute_distance is  tensor(180.8886, device='cuda:3')
compute_norm is  tensor(49.6861, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.9476, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6622515367165304
avg test loss is  2.7030010563986644
avg accuracy is  0.10918333348966529
solo acc is  0.1058333334896653
compute similarity  is  tensor(0.9634, device='cuda:3')
compute_distance is  tensor(180.9476, device='cuda:3')
compute_norm is  tensor(49.5469, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.6555, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0260088112054349
avg test loss is  1.7365232856034725
avg accuracy is  0.12488333348966525
solo acc is  0.21290000015633687
compute similarity  is  tensor(0.9628, device='cuda:3')
compute_distance is  tensor(182.6555, device='cuda:3')
compute_norm is  tensor(49.2495, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.4909, device='cuda:3')
distance x is tensor(182.4909, device='cuda:3')
________________________________
test distance is  tensor(182.4909, device='cuda:3')
test distance1 is  tensor(182.4909, device='cuda:3')
test similarity is  tensor(0.9625, device='cuda:3')
test acc is  0.10416666682299863
test loss is 2.5412746731406335
test entropy is  0.6249932570498127
________________________________
cal ratio is  0.9653956971479426
distance x is tensor(176.1764, device='cuda:3')
cal_distance is  tensor(176.1764, device='cuda:3')
distance x is tensor(176.1764, device='cuda:3')
return_distance is  tensor(176.1764, device='cuda:3')
distance x is tensor(176.1759, device='cuda:3')
distance x is tensor(176.1759, device='cuda:3')
________________________________
test distance is  tensor(176.1759, device='cuda:3')
test distance1 is  tensor(176.1759, device='cuda:3')
test similarity is  tensor(0.9649, device='cuda:3')
test acc is  0.10443333348966528
test loss is 2.3916832338263996
test entropy is  0.7351208174787859
________________________________
0
distance x is tensor(176.1759, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7352031467438761
avg test loss is  2.3924359616948596
avg accuracy is  0.11140000015633193
solo acc is  0.1046833334896653
compute similarity  is  tensor(0.9649, device='cuda:3')
compute_distance is  tensor(176.1759, device='cuda:3')
compute_norm is  tensor(48.9225, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.7944, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.011642631055958
avg test loss is  1.6295431482512306
avg accuracy is  0.1287666668229986
solo acc is  0.22276666682300397
compute similarity  is  tensor(0.9642, device='cuda:3')
compute_distance is  tensor(177.7944, device='cuda:3')
compute_norm is  tensor(48.6629, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(177.7315, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6172716196920318
avg test loss is  2.442201997171333
avg accuracy is  0.11296666682299861
solo acc is  0.1028833334896653
compute similarity  is  tensor(0.9638, device='cuda:3')
compute_distance is  tensor(177.7315, device='cuda:3')
compute_norm is  tensor(48.5012, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(179.0431, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9758588627838631
avg test loss is  1.5857243872146363
avg accuracy is  0.13306666682299856
solo acc is  0.2259500001563375
compute similarity  is  tensor(0.9631, device='cuda:3')
compute_distance is  tensor(179.0431, device='cuda:3')
compute_norm is  tensor(48.2471, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(179.0433, device='cuda:3')
________________________________
test distance is  tensor(179.0433, device='cuda:3')
test similarity is  tensor(0.9631, device='cuda:3')
test acc is  0.13231666682299859
test loss is 1.5870726618177093
test entropy is  0.9764349261707843
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.0976793766021729
mal norm is  tensor(587.5791, device='cuda:3')
distance x is tensor(179.0433, device='cuda:3')
mal distance is  tensor(179.0433, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(29.3683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.8007, device='cuda:3')
user_param_square tensor(145.4946, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(315.8038, device='cuda:3')
score : tensor(3.1289, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.3524, device='cuda:3')
user_param_square tensor(139.1547, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(268.7966, device='cuda:3')
score : tensor(2.6588, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.9509, device='cuda:3')
user_param_square tensor(142.3470, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(196.4085, device='cuda:3')
score : tensor(1.9349, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.4072, device='cuda:3')
user_param_square tensor(138.2076, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(355.0811, device='cuda:3')
score : tensor(3.5216, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.1747, device='cuda:3')
user_param_square tensor(134.9573, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(266.5063, device='cuda:3')
score : tensor(2.6359, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.4616, device='cuda:3')
user_param_square tensor(142.7087, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(250.8456, device='cuda:3')
score : tensor(2.4793, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.2006, device='cuda:3')
user_param_square tensor(136.7972, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(314.3696, device='cuda:3')
score : tensor(3.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.8067, device='cuda:3')
user_param_square tensor(136.4324, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(293.8575, device='cuda:3')
score : tensor(2.9094, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5791, device='cuda:3')
user_param_square tensor(131.3628, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(-610.1243, device='cuda:3')
score : tensor(-6.1304, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(781.7222, device='cuda:3')
user_param_square tensor(151.5184, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(255.8084, device='cuda:3')
score : tensor(2.5289, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4116, device='cuda:3')
user_param_square tensor(150.3206, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(286.8632, device='cuda:3')
score : tensor(2.8395, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(780.0383, device='cuda:3')
user_param_square tensor(151.3551, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(272.8453, device='cuda:3')
score : tensor(2.6993, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(803.7307, device='cuda:3')
user_param_square tensor(153.6365, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(293.4633, device='cuda:3')
score : tensor(2.9055, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.9577, device='cuda:3')
user_param_square tensor(152.7957, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(326.1492, device='cuda:3')
score : tensor(3.2323, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(839.8958, device='cuda:3')
user_param_square tensor(157.0551, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(228.7379, device='cuda:3')
score : tensor(2.2582, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.7033, device='cuda:3')
user_param_square tensor(152.7713, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(286.1481, device='cuda:3')
score : tensor(2.8323, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(834.4799, device='cuda:3')
user_param_square tensor(156.5479, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(310.2855, device='cuda:3')
score : tensor(3.0737, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.0267, device='cuda:3')
user_param_square tensor(143.4850, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(286.0884, device='cuda:3')
score : tensor(2.8317, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.1787, device='cuda:3')
user_param_square tensor(148.3310, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(225.2621, device='cuda:3')
score : tensor(2.2235, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.3221, device='cuda:3')
user_param_square tensor(144.7378, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(258.7542, device='cuda:3')
score : tensor(2.5584, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9358, device='cuda:3')
user_param_square tensor(142.0356, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(293.1613, device='cuda:3')
score : tensor(2.9024, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.0232, device='cuda:3')
user_param_square tensor(142.0447, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(336.0757, device='cuda:3')
score : tensor(3.3316, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.8867, device='cuda:3')
user_param_square tensor(136.2256, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(316.0761, device='cuda:3')
score : tensor(3.1316, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7710, device='cuda:3')
user_param_square tensor(143.5612, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(344.3215, device='cuda:3')
score : tensor(3.4140, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5693, device='cuda:3')
user_param_square tensor(144.4583, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(173.4921, device='cuda:3')
score : tensor(1.7058, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(748.7031, device='cuda:3')
user_param_square tensor(148.2839, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(175.4194, device='cuda:3')
score : tensor(1.7250, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(716.0854, device='cuda:3')
user_param_square tensor(145.0179, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(321.6383, device='cuda:3')
score : tensor(3.1872, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.6058, device='cuda:3')
user_param_square tensor(146.4808, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(277.2573, device='cuda:3')
score : tensor(2.7434, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.1372, device='cuda:3')
user_param_square tensor(146.8344, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(321.2633, device='cuda:3')
score : tensor(3.1835, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.7227, device='cuda:3')
user_param_square tensor(143.8627, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(325.4594, device='cuda:3')
score : tensor(3.2254, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9094, device='cuda:3')
user_param_square tensor(148.8972, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(285.0349, device='cuda:3')
score : tensor(2.8212, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.2811, device='cuda:3')
user_param_square tensor(150.4055, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(269.5144, device='cuda:3')
score : tensor(2.6660, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.6769, device='cuda:3')
user_param_square tensor(146.9883, device='cuda:3')
global_param_square tensor(29.3683, device='cuda:3')
part1 is  tensor(297.1459, device='cuda:3')
score : tensor(2.9423, device='cuda:3')
accept
len accept list 32
len all weights is 32
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 88.61% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
 benign loss is  1.129113793373108
distance x is tensor(107.5844, device='cuda:3')
benign distance is  tensor(107.5844, device='cuda:3')
norm1 res is  tensor(0.1214, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3987748622894287
distance x is tensor(120.8436, device='cuda:3')
benign distance is  tensor(120.8436, device='cuda:3')
norm1 res is  tensor(0.1332, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.4259713590145111
distance x is tensor(115.0848, device='cuda:3')
benign distance is  tensor(115.0848, device='cuda:3')
norm1 res is  tensor(0.1257, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.27729931473731995
distance x is tensor(115.3943, device='cuda:3')
benign distance is  tensor(115.3943, device='cuda:3')
norm1 res is  tensor(0.1240, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.18263129889965057
distance x is tensor(118.6564, device='cuda:3')
benign distance is  tensor(118.6564, device='cuda:3')
norm1 res is  tensor(0.1258, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.9212993383407593
distance x is tensor(122.4749, device='cuda:3')
benign distance is  tensor(122.4749, device='cuda:3')
norm1 res is  tensor(0.1332, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2529856562614441
distance x is tensor(110.7929, device='cuda:3')
benign distance is  tensor(110.7929, device='cuda:3')
norm1 res is  tensor(0.1159, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.331125944852829
distance x is tensor(120.3173, device='cuda:3')
benign distance is  tensor(120.3173, device='cuda:3')
norm1 res is  tensor(0.1305, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.6352542042732239
distance x is tensor(140.0125, device='cuda:3')
benign distance is  tensor(140.0125, device='cuda:3')
norm1 res is  tensor(0.1501, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.46939617395401
distance x is tensor(132.6796, device='cuda:3')
benign distance is  tensor(132.6796, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.9831464886665344
distance x is tensor(122.3457, device='cuda:3')
benign distance is  tensor(122.3457, device='cuda:3')
norm1 res is  tensor(0.1294, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.37599363923072815
distance x is tensor(140.1198, device='cuda:3')
benign distance is  tensor(140.1198, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.7666563987731934
distance x is tensor(123.9171, device='cuda:3')
benign distance is  tensor(123.9171, device='cuda:3')
norm1 res is  tensor(0.1333, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.3539605140686035
distance x is tensor(127.5392, device='cuda:3')
benign distance is  tensor(127.5392, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.6285359263420105
distance x is tensor(129.5430, device='cuda:3')
benign distance is  tensor(129.5430, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3195401132106781
distance x is tensor(143.1756, device='cuda:3')
benign distance is  tensor(143.1756, device='cuda:3')
norm1 res is  tensor(0.1547, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.34691137075424194
distance x is tensor(131.7307, device='cuda:3')
benign distance is  tensor(131.7307, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.42098990082740784
distance x is tensor(143.6243, device='cuda:3')
benign distance is  tensor(143.6243, device='cuda:3')
norm1 res is  tensor(0.1560, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.20482492446899414
distance x is tensor(125.2554, device='cuda:3')
benign distance is  tensor(125.2554, device='cuda:3')
norm1 res is  tensor(0.1352, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.21551518142223358
distance x is tensor(130.1672, device='cuda:3')
benign distance is  tensor(130.1672, device='cuda:3')
norm1 res is  tensor(0.1431, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.4846341609954834
distance x is tensor(132.2285, device='cuda:3')
benign distance is  tensor(132.2285, device='cuda:3')
norm1 res is  tensor(0.1443, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.7097254991531372
distance x is tensor(121.3743, device='cuda:3')
benign distance is  tensor(121.3743, device='cuda:3')
norm1 res is  tensor(0.1305, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.28958767652511597
distance x is tensor(138.3023, device='cuda:3')
benign distance is  tensor(138.3023, device='cuda:3')
norm1 res is  tensor(0.1470, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.49125057458877563
distance x is tensor(133.3850, device='cuda:3')
benign distance is  tensor(133.3850, device='cuda:3')
norm1 res is  tensor(0.1421, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.08144254982471466
distance x is tensor(126.0390, device='cuda:3')
benign distance is  tensor(126.0390, device='cuda:3')
norm1 res is  tensor(0.1331, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.4402953088283539
distance x is tensor(133.7465, device='cuda:3')
benign distance is  tensor(133.7465, device='cuda:3')
norm1 res is  tensor(0.1418, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.15539392828941345
distance x is tensor(130.3410, device='cuda:3')
benign distance is  tensor(130.3410, device='cuda:3')
norm1 res is  tensor(0.1385, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.6117677092552185
distance x is tensor(142.5239, device='cuda:3')
benign distance is  tensor(142.5239, device='cuda:3')
norm1 res is  tensor(0.1533, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.48397427797317505
distance x is tensor(123.0125, device='cuda:3')
benign distance is  tensor(123.0125, device='cuda:3')
norm1 res is  tensor(0.1306, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.5671496391296387
distance x is tensor(128.8807, device='cuda:3')
benign distance is  tensor(128.8807, device='cuda:3')
norm1 res is  tensor(0.1343, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.38266342878341675
distance x is tensor(134.4585, device='cuda:3')
benign distance is  tensor(134.4585, device='cuda:3')
norm1 res is  tensor(0.1446, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.27256491780281067
distance x is tensor(135.3087, device='cuda:3')
benign distance is  tensor(135.3087, device='cuda:3')
norm1 res is  tensor(0.1454, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(119.0136, device='cuda:3')
compute distance is  tensor(119.0136, device='cuda:3')
compute norm is  tensor(47.5093, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0020, device='cuda:3')
compute distance is  tensor(126.0020, device='cuda:3')
compute norm is  tensor(47.5221, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.9446, device='cuda:3')
compute distance is  tensor(147.9446, device='cuda:3')
compute norm is  tensor(48.0654, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9407, device='cuda:3')
compute distance is  tensor(132.9407, device='cuda:3')
compute norm is  tensor(47.7733, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.1635, device='cuda:3')
compute distance is  tensor(130.1635, device='cuda:3')
compute norm is  tensor(47.6983, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5822, device='cuda:3')
compute distance is  tensor(144.5822, device='cuda:3')
compute norm is  tensor(48.2954, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1155, device='cuda:3')
compute distance is  tensor(122.1155, device='cuda:3')
compute norm is  tensor(47.6161, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.4766, device='cuda:3')
compute distance is  tensor(118.4766, device='cuda:3')
compute norm is  tensor(47.4487, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.8219, device='cuda:3')
compute distance is  tensor(126.8219, device='cuda:3')
compute norm is  tensor(47.5961, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9492, device='cuda:3')
compute distance is  tensor(128.9492, device='cuda:3')
compute norm is  tensor(47.7019, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9814, device='cuda:3')
compute distance is  tensor(132.9814, device='cuda:3')
compute norm is  tensor(47.7486, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1956, device='cuda:3')
compute distance is  tensor(125.1956, device='cuda:3')
compute norm is  tensor(47.7910, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.9446, device='cuda:3')
distance x is tensor(107638.0703, device='cuda:3')
distance x is tensor(107638.0703, device='cuda:3')
________________________________
test distance is  tensor(107638.0703, device='cuda:3')
test distance1 is  tensor(107638.0703, device='cuda:3')
test similarity is  tensor(0.2092, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129932472842960.52
test entropy is  0.0
________________________________
cal ratio is  0.03633228616186204
distance x is tensor(3910.7424, device='cuda:3')
cal_distance is  tensor(3910.7424, device='cuda:3')
cal ratio is  0.19061016508911652
distance x is tensor(745.4314, device='cuda:3')
cal_distance is  tensor(745.4314, device='cuda:3')
cal ratio is  0.436588032992285
distance x is tensor(325.4492, device='cuda:3')
cal_distance is  tensor(325.4492, device='cuda:3')
cal ratio is  0.6607452669627262
distance x is tensor(215.0408, device='cuda:3')
cal_distance is  tensor(215.0408, device='cuda:3')
cal ratio is  0.8128590781723115
distance x is tensor(174.7988, device='cuda:3')
cal_distance is  tensor(174.7988, device='cuda:3')
cal ratio is  0.9015844880832501
distance x is tensor(157.5964, device='cuda:3')
cal_distance is  tensor(157.5964, device='cuda:3')
cal ratio is  0.9495164759649265
distance x is tensor(149.6406, device='cuda:3')
cal_distance is  tensor(149.6406, device='cuda:3')
cal ratio is  0.9744305422687847
distance x is tensor(145.8146, device='cuda:3')
cal_distance is  tensor(145.8146, device='cuda:3')
distance x is tensor(145.8146, device='cuda:3')
return_distance is  tensor(145.8146, device='cuda:3')
distance x is tensor(145.8044, device='cuda:3')
distance x is tensor(145.8044, device='cuda:3')
________________________________
test distance is  tensor(145.8044, device='cuda:3')
test distance1 is  tensor(145.8044, device='cuda:3')
test similarity is  tensor(0.9500, device='cuda:3')
test acc is  0.1021833334896653
test loss is 190.61587220214324
test entropy is  0.0010361948430832903
________________________________
0
distance x is tensor(145.8044, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0010710916564950275
avg test loss is  190.7908463142574
avg accuracy is  0.57325000015634
solo acc is  0.10231666682299863
compute similarity  is  tensor(0.9500, device='cuda:3')
compute_distance is  tensor(145.8044, device='cuda:3')
compute_norm is  tensor(49.4413, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.4705, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0454305444063663
avg test loss is  1.5927412526439757
avg accuracy is  0.7494333334896612
solo acc is  0.2511500001563383
compute similarity  is  tensor(0.9522, device='cuda:3')
compute_distance is  tensor(138.4705, device='cuda:3')
compute_norm is  tensor(49.6796, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(139.6354, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6270676715923017
avg test loss is  2.433548465593537
avg accuracy is  0.6834500001563316
solo acc is  0.11073333348966527
compute similarity  is  tensor(0.9519, device='cuda:3')
compute_distance is  tensor(139.6354, device='cuda:3')
compute_norm is  tensor(49.5058, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.5037, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9792563633115561
avg test loss is  1.4371092358886053
avg accuracy is  0.7818333334896596
solo acc is  0.2771333334896723
compute similarity  is  tensor(0.9522, device='cuda:3')
compute_distance is  tensor(139.5037, device='cuda:3')
compute_norm is  tensor(49.2145, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(139.5037, device='cuda:3')
distance x is tensor(139.5037, device='cuda:3')
________________________________
test distance is  tensor(139.5037, device='cuda:3')
test distance1 is  tensor(139.5037, device='cuda:3')
test similarity is  tensor(0.9522, device='cuda:3')
test acc is  0.27345000015633886
test loss is 1.437238216654324
test entropy is  0.9791550335726504
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4308538436889648
mal norm is  tensor(711.5363, device='cuda:3')
distance x is tensor(139.5129, device='cuda:3')
mal distance is  tensor(139.5129, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(17.4515, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(456.2260, device='cuda:3')
user_param_square tensor(89.2290, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(-12.6091, device='cuda:3')
score : tensor(-0.1433, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.6398, device='cuda:3')
user_param_square tensor(95.0451, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(-40.3487, device='cuda:3')
score : tensor(-0.4207, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.7551, device='cuda:3')
user_param_square tensor(91.7866, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(27.9388, device='cuda:3')
score : tensor(0.2621, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.1765, device='cuda:3')
user_param_square tensor(92.3951, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(-20.2575, device='cuda:3')
score : tensor(-0.2198, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.7477, device='cuda:3')
user_param_square tensor(93.4815, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(-14.6229, device='cuda:3')
score : tensor(-0.1635, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.6235, device='cuda:3')
user_param_square tensor(94.5835, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(-25.3661, device='cuda:3')
score : tensor(-0.2709, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(455.6545, device='cuda:3')
user_param_square tensor(89.1731, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(-3.7430, device='cuda:3')
score : tensor(-0.0547, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.4832, device='cuda:3')
user_param_square tensor(94.7549, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(7.8985, device='cuda:3')
score : tensor(0.0617, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5363, device='cuda:3')
user_param_square tensor(111.4332, device='cuda:3')
global_param_square tensor(17.4515, device='cuda:3')
part1 is  tensor(42.0127, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 71.86% 

Test Accuracy: 71.07% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
 benign loss is  0.08711421489715576
distance x is tensor(164.5123, device='cuda:3')
benign distance is  tensor(164.5123, device='cuda:3')
norm1 res is  tensor(0.1674, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.9283979535102844
distance x is tensor(161.2322, device='cuda:3')
benign distance is  tensor(161.2322, device='cuda:3')
norm1 res is  tensor(0.1704, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.1546861082315445
distance x is tensor(157.3676, device='cuda:3')
benign distance is  tensor(157.3676, device='cuda:3')
norm1 res is  tensor(0.1632, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.8772312998771667
distance x is tensor(184.6798, device='cuda:3')
benign distance is  tensor(184.6798, device='cuda:3')
norm1 res is  tensor(0.1840, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3033847212791443
distance x is tensor(165.4585, device='cuda:3')
benign distance is  tensor(165.4585, device='cuda:3')
norm1 res is  tensor(0.1676, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.33462730050086975
distance x is tensor(178.5344, device='cuda:3')
benign distance is  tensor(178.5344, device='cuda:3')
norm1 res is  tensor(0.1852, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.8230369687080383
distance x is tensor(175.9197, device='cuda:3')
benign distance is  tensor(175.9197, device='cuda:3')
norm1 res is  tensor(0.1802, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.4330587387084961
distance x is tensor(179.1847, device='cuda:3')
benign distance is  tensor(179.1847, device='cuda:3')
norm1 res is  tensor(0.1827, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(162.6017, device='cuda:3')
compute distance is  tensor(162.6017, device='cuda:3')
compute norm is  tensor(50.2936, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.9866, device='cuda:3')
compute distance is  tensor(164.9866, device='cuda:3')
compute norm is  tensor(50.3439, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.6691, device='cuda:3')
compute distance is  tensor(177.6691, device='cuda:3')
compute norm is  tensor(50.8025, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.6175, device='cuda:3')
compute distance is  tensor(185.6175, device='cuda:3')
compute norm is  tensor(50.9607, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.1052, device='cuda:3')
compute distance is  tensor(179.1052, device='cuda:3')
compute norm is  tensor(50.6106, device='cuda:3', dtype=torch.float64)
distance x is tensor(186.3752, device='cuda:3')
compute distance is  tensor(186.3752, device='cuda:3')
compute norm is  tensor(51.0499, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.2612, device='cuda:3')
compute distance is  tensor(169.2612, device='cuda:3')
compute norm is  tensor(50.5199, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.7879, device='cuda:3')
compute distance is  tensor(164.7879, device='cuda:3')
compute norm is  tensor(50.3706, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.9792, device='cuda:3')
compute distance is  tensor(173.9792, device='cuda:3')
compute norm is  tensor(50.4537, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.8793, device='cuda:3')
compute distance is  tensor(169.8793, device='cuda:3')
compute norm is  tensor(50.7237, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.8778, device='cuda:3')
compute distance is  tensor(173.8778, device='cuda:3')
compute norm is  tensor(50.5789, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.2439, device='cuda:3')
compute distance is  tensor(166.2439, device='cuda:3')
compute norm is  tensor(50.4167, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(186.3752, device='cuda:3')
distance x is tensor(107569.1172, device='cuda:3')
distance x is tensor(107569.1172, device='cuda:3')
________________________________
test distance is  tensor(107569.1172, device='cuda:3')
test distance1 is  tensor(107569.1172, device='cuda:3')
test similarity is  tensor(0.3961, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130167834781027.89
test entropy is  0.0
________________________________
cal ratio is  0.04079212910904363
distance x is tensor(4387.9790, device='cuda:3')
cal_distance is  tensor(4387.9790, device='cuda:3')
cal ratio is  0.20197047832315554
distance x is tensor(886.2461, device='cuda:3')
cal_distance is  tensor(886.2461, device='cuda:3')
cal ratio is  0.44941028006834055
distance x is tensor(398.2909, device='cuda:3')
cal_distance is  tensor(398.2909, device='cuda:3')
cal ratio is  0.6703783174048942
distance x is tensor(267.0073, device='cuda:3')
cal_distance is  tensor(267.0073, device='cuda:3')
cal ratio is  0.8187637612882588
distance x is tensor(218.6168, device='cuda:3')
cal_distance is  tensor(218.6168, device='cuda:3')
cal ratio is  0.9048537516843991
distance x is tensor(197.8167, device='cuda:3')
cal_distance is  tensor(197.8167, device='cuda:3')
cal ratio is  0.9512368588160194
distance x is tensor(188.1708, device='cuda:3')
cal_distance is  tensor(188.1708, device='cuda:3')
cal ratio is  0.9753130718621872
distance x is tensor(183.5256, device='cuda:3')
cal_distance is  tensor(183.5256, device='cuda:3')
distance x is tensor(183.5256, device='cuda:3')
return_distance is  tensor(183.5256, device='cuda:3')
distance x is tensor(183.5155, device='cuda:3')
distance x is tensor(183.5155, device='cuda:3')
________________________________
test distance is  tensor(183.5155, device='cuda:3')
test distance1 is  tensor(183.5155, device='cuda:3')
test similarity is  tensor(0.9481, device='cuda:3')
test acc is  0.11060000015633195
test loss is 256.26047361329165
test entropy is  0.00631295417243878
________________________________
0
distance x is tensor(183.5155, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0072061822909684084
avg test loss is  255.85772610727403
avg accuracy is  0.4310666668230082
solo acc is  0.11100000015633193
compute similarity  is  tensor(0.9481, device='cuda:3')
compute_distance is  tensor(183.5155, device='cuda:3')
compute_norm is  tensor(54.4450, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.3559, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.403146184456628
avg test loss is  2.275602159342532
avg accuracy is  0.21498333348967033
solo acc is  0.13421666682299857
compute similarity  is  tensor(0.9481, device='cuda:3')
compute_distance is  tensor(180.3559, device='cuda:3')
compute_norm is  tensor(55.4736, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.9215, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7770545942061491
avg test loss is  3.0636164313440384
avg accuracy is  0.15178333348966658
solo acc is  0.1021833334896653
compute similarity  is  tensor(0.9480, device='cuda:3')
compute_distance is  tensor(180.9215, device='cuda:3')
compute_norm is  tensor(55.4648, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.5763, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2831818404228195
avg test loss is  1.8427556711219266
avg accuracy is  0.31650000015633983
solo acc is  0.22210000015633724
compute similarity  is  tensor(0.9488, device='cuda:3')
compute_distance is  tensor(180.5763, device='cuda:3')
compute_norm is  tensor(55.0667, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.8010, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7069389349234892
avg test loss is  2.8473029167159027
avg accuracy is  0.18618333348966892
solo acc is  0.10331666682299863
compute similarity  is  tensor(0.9487, device='cuda:3')
compute_distance is  tensor(180.8010, device='cuda:3')
compute_norm is  tensor(54.9942, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.4189, device='cuda:3')
distance x is tensor(180.4189, device='cuda:3')
________________________________
test distance is  tensor(180.4189, device='cuda:3')
test distance1 is  tensor(180.4189, device='cuda:3')
test similarity is  tensor(0.9493, device='cuda:3')
test acc is  0.19320000015633595
test loss is 1.773813097207531
test entropy is  1.112350661744441
________________________________
0
distance x is tensor(180.4189, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1116931041929006
avg test loss is  1.773542555664648
avg accuracy is  0.2854833334896725
solo acc is  0.19371666682300268
compute similarity  is  tensor(0.9493, device='cuda:3')
compute_distance is  tensor(180.4189, device='cuda:3')
compute_norm is  tensor(54.6209, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.4731, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6773129000084233
avg test loss is  2.5743168460280654
avg accuracy is  0.16925000015633457
solo acc is  0.10371666682299864
compute similarity  is  tensor(0.9492, device='cuda:3')
compute_distance is  tensor(180.4731, device='cuda:3')
compute_norm is  tensor(54.4912, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.6073, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0305333746267533
avg test loss is  1.6066555731586303
avg accuracy is  0.291366666823006
solo acc is  0.21441666682300362
compute similarity  is  tensor(0.9494, device='cuda:3')
compute_distance is  tensor(180.6073, device='cuda:3')
compute_norm is  tensor(54.1562, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.6066, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.634470375298437
avg test loss is  2.408580924402168
avg accuracy is  0.17420000015633486
solo acc is  0.10345000015633196
compute similarity  is  tensor(0.9492, device='cuda:3')
compute_distance is  tensor(180.6066, device='cuda:3')
compute_norm is  tensor(54.0011, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.8146, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9994459002256901
avg test loss is  1.5324107890190093
avg accuracy is  0.30723333348967297
solo acc is  0.2200833334896706
compute similarity  is  tensor(0.9493, device='cuda:3')
compute_distance is  tensor(180.8146, device='cuda:3')
compute_norm is  tensor(53.6788, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(180.8146, device='cuda:3')
distance x is tensor(180.8146, device='cuda:3')
________________________________
test distance is  tensor(180.8146, device='cuda:3')
test distance1 is  tensor(180.8146, device='cuda:3')
test similarity is  tensor(0.9493, device='cuda:3')
test acc is  0.2211166668230039
test loss is 1.531989521182168
test entropy is  0.9991266759219708
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2965497970581055
mal norm is  tensor(867.2502, device='cuda:3')
distance x is tensor(180.8236, device='cuda:3')
mal distance is  tensor(180.8236, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(37.1386, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.7391, device='cuda:3')
user_param_square tensor(156.7676, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(343.9604, device='cuda:3')
score : tensor(3.4027, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.7538, device='cuda:3')
user_param_square tensor(157.1243, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(381.7365, device='cuda:3')
score : tensor(3.7804, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.6149, device='cuda:3')
user_param_square tensor(154.7259, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(331.7404, device='cuda:3')
score : tensor(3.2805, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.6600, device='cuda:3')
user_param_square tensor(164.1646, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(221.8675, device='cuda:3')
score : tensor(2.1817, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.7195, device='cuda:3')
user_param_square tensor(156.8837, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(387.5733, device='cuda:3')
score : tensor(3.8388, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.7189, device='cuda:3')
user_param_square tensor(164.3973, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(87.3951, device='cuda:3')
score : tensor(0.8370, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.2456, device='cuda:3')
user_param_square tensor(161.3793, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(142.2770, device='cuda:3')
score : tensor(1.3858, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.2828, device='cuda:3')
user_param_square tensor(163.2142, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(94.6999, device='cuda:3')
score : tensor(0.9101, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.2502, device='cuda:3')
user_param_square tensor(179.4672, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(-288.9134, device='cuda:3')
score : tensor(-2.9261, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0045, device='cuda:3')
user_param_square tensor(169.4353, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(395.8583, device='cuda:3')
score : tensor(3.9216, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(831.4118, device='cuda:3')
user_param_square tensor(175.7199, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(428.6204, device='cuda:3')
score : tensor(4.2493, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.0954, device='cuda:3')
user_param_square tensor(173.2384, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(384.7808, device='cuda:3')
score : tensor(3.8109, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(801.7190, device='cuda:3')
user_param_square tensor(172.5536, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(281.5655, device='cuda:3')
score : tensor(2.7787, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(798.1738, device='cuda:3')
user_param_square tensor(172.1716, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(324.2521, device='cuda:3')
score : tensor(3.2056, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(772.8094, device='cuda:3')
user_param_square tensor(169.4139, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(315.4375, device='cuda:3')
score : tensor(3.1174, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(826.9493, device='cuda:3')
user_param_square tensor(175.2477, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(292.7934, device='cuda:3')
score : tensor(2.8910, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.6471, device='cuda:3')
user_param_square tensor(173.4047, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(460.2841, device='cuda:3')
score : tensor(4.5659, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.0611, device='cuda:3')
user_param_square tensor(179.6545, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(433.9818, device='cuda:3')
score : tensor(4.3029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(847.9651, device='cuda:3')
user_param_square tensor(177.4606, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(356.4059, device='cuda:3')
score : tensor(3.5271, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(877.3640, device='cuda:3')
user_param_square tensor(180.5106, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(449.2031, device='cuda:3')
score : tensor(4.4551, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(900.3597, device='cuda:3')
user_param_square tensor(182.8609, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(454.5866, device='cuda:3')
score : tensor(4.5089, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.6985, device='cuda:3')
user_param_square tensor(178.8918, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(425.2245, device='cuda:3')
score : tensor(4.2153, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.3876, device='cuda:3')
user_param_square tensor(182.6606, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(343.6025, device='cuda:3')
score : tensor(3.3991, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(885.7711, device='cuda:3')
user_param_square tensor(181.3734, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(386.5477, device='cuda:3')
score : tensor(3.8285, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(868.9900, device='cuda:3')
user_param_square tensor(179.6471, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(329.0599, device='cuda:3')
score : tensor(3.2537, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(798.2308, device='cuda:3')
user_param_square tensor(172.1778, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(403.0706, device='cuda:3')
score : tensor(3.9938, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.3379, device='cuda:3')
user_param_square tensor(169.0330, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(353.4372, device='cuda:3')
score : tensor(3.4974, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(741.7615, device='cuda:3')
user_param_square tensor(165.9759, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(377.3174, device='cuda:3')
score : tensor(3.7362, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(799.9677, device='cuda:3')
user_param_square tensor(172.3650, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(417.9442, device='cuda:3')
score : tensor(4.1425, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.8112, device='cuda:3')
user_param_square tensor(166.6514, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(382.8537, device='cuda:3')
score : tensor(3.7916, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(760.3525, device='cuda:3')
user_param_square tensor(168.0430, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(356.2439, device='cuda:3')
score : tensor(3.5255, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(766.8104, device='cuda:3')
user_param_square tensor(168.7551, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(354.6727, device='cuda:3')
score : tensor(3.5098, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(812.8014, device='cuda:3')
user_param_square tensor(173.7421, device='cuda:3')
global_param_square tensor(37.1386, device='cuda:3')
part1 is  tensor(356.0580, device='cuda:3')
score : tensor(3.5236, device='cuda:3')
accept
len accept list 32
len all weights is 32
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.28% 

Test Accuracy: 88.56% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7557161450386047
distance x is tensor(110.0368, device='cuda:3')
benign distance is  tensor(110.0368, device='cuda:3')
norm1 res is  tensor(0.1204, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.27984920144081116
distance x is tensor(122.9248, device='cuda:3')
benign distance is  tensor(122.9248, device='cuda:3')
norm1 res is  tensor(0.1327, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3382315933704376
distance x is tensor(117.3467, device='cuda:3')
benign distance is  tensor(117.3467, device='cuda:3')
norm1 res is  tensor(0.1263, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.672497570514679
distance x is tensor(118.3989, device='cuda:3')
benign distance is  tensor(118.3989, device='cuda:3')
norm1 res is  tensor(0.1237, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5811656713485718
distance x is tensor(108.3824, device='cuda:3')
benign distance is  tensor(108.3824, device='cuda:3')
norm1 res is  tensor(0.1134, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4781608581542969
distance x is tensor(128.1823, device='cuda:3')
benign distance is  tensor(128.1823, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.30522453784942627
distance x is tensor(113.8127, device='cuda:3')
benign distance is  tensor(113.8127, device='cuda:3')
norm1 res is  tensor(0.1171, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.7018622159957886
distance x is tensor(129.4353, device='cuda:3')
benign distance is  tensor(129.4353, device='cuda:3')
norm1 res is  tensor(0.1370, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.13413050770759583
distance x is tensor(133.0817, device='cuda:3')
benign distance is  tensor(133.0817, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3488938808441162
distance x is tensor(131.2197, device='cuda:3')
benign distance is  tensor(131.2197, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.3955833911895752
distance x is tensor(125.9712, device='cuda:3')
benign distance is  tensor(125.9712, device='cuda:3')
norm1 res is  tensor(0.1340, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.351376473903656
distance x is tensor(141.3952, device='cuda:3')
benign distance is  tensor(141.3952, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.6634486317634583
distance x is tensor(130.0376, device='cuda:3')
benign distance is  tensor(130.0376, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.21863003075122833
distance x is tensor(138.2766, device='cuda:3')
benign distance is  tensor(138.2766, device='cuda:3')
norm1 res is  tensor(0.1482, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.5479689836502075
distance x is tensor(127.9010, device='cuda:3')
benign distance is  tensor(127.9010, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3834632933139801
distance x is tensor(131.7566, device='cuda:3')
benign distance is  tensor(131.7566, device='cuda:3')
norm1 res is  tensor(0.1421, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.37393486499786377
distance x is tensor(138.9922, device='cuda:3')
benign distance is  tensor(138.9922, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.6642724275588989
distance x is tensor(119.3209, device='cuda:3')
benign distance is  tensor(119.3209, device='cuda:3')
norm1 res is  tensor(0.1244, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.5999225378036499
distance x is tensor(132.2870, device='cuda:3')
benign distance is  tensor(132.2870, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.44837743043899536
distance x is tensor(130.1378, device='cuda:3')
benign distance is  tensor(130.1378, device='cuda:3')
norm1 res is  tensor(0.1392, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  1.1237238645553589
distance x is tensor(132.2000, device='cuda:3')
benign distance is  tensor(132.2000, device='cuda:3')
norm1 res is  tensor(0.1399, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.876691460609436
distance x is tensor(134.2854, device='cuda:3')
benign distance is  tensor(134.2854, device='cuda:3')
norm1 res is  tensor(0.1446, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.15279577672481537
distance x is tensor(129.2639, device='cuda:3')
benign distance is  tensor(129.2639, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.10608261823654175
distance x is tensor(136.4368, device='cuda:3')
benign distance is  tensor(136.4368, device='cuda:3')
norm1 res is  tensor(0.1489, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.5671205520629883
distance x is tensor(134.6693, device='cuda:3')
benign distance is  tensor(134.6693, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.07784582674503326
distance x is tensor(130.0459, device='cuda:3')
benign distance is  tensor(130.0459, device='cuda:3')
norm1 res is  tensor(0.1385, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.4984590411186218
distance x is tensor(133.1551, device='cuda:3')
benign distance is  tensor(133.1551, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.3052888810634613
distance x is tensor(136.8004, device='cuda:3')
benign distance is  tensor(136.8004, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.31890127062797546
distance x is tensor(138.7898, device='cuda:3')
benign distance is  tensor(138.7898, device='cuda:3')
norm1 res is  tensor(0.1475, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.28076615929603577
distance x is tensor(138.2748, device='cuda:3')
benign distance is  tensor(138.2748, device='cuda:3')
norm1 res is  tensor(0.1450, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.4941945970058441
distance x is tensor(129.8572, device='cuda:3')
benign distance is  tensor(129.8572, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.45022106170654297
distance x is tensor(130.2726, device='cuda:3')
benign distance is  tensor(130.2726, device='cuda:3')
norm1 res is  tensor(0.1381, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(127.3790, device='cuda:3')
compute distance is  tensor(127.3790, device='cuda:3')
compute norm is  tensor(48.5023, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.4797, device='cuda:3')
compute distance is  tensor(111.4797, device='cuda:3')
compute norm is  tensor(48.2255, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2210, device='cuda:3')
compute distance is  tensor(128.2210, device='cuda:3')
compute norm is  tensor(48.4958, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1989, device='cuda:3')
compute distance is  tensor(129.1989, device='cuda:3')
compute norm is  tensor(48.5638, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6289, device='cuda:3')
compute distance is  tensor(130.6289, device='cuda:3')
compute norm is  tensor(48.5368, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7621, device='cuda:3')
compute distance is  tensor(126.7621, device='cuda:3')
compute norm is  tensor(48.5685, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.3047, device='cuda:3')
compute distance is  tensor(124.3047, device='cuda:3')
compute norm is  tensor(48.6352, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4845, device='cuda:3')
compute distance is  tensor(137.4845, device='cuda:3')
compute norm is  tensor(48.7995, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2396, device='cuda:3')
compute distance is  tensor(135.2396, device='cuda:3')
compute norm is  tensor(48.6056, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.5758, device='cuda:3')
compute distance is  tensor(123.5758, device='cuda:3')
compute norm is  tensor(48.6051, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3181, device='cuda:3')
compute distance is  tensor(138.3181, device='cuda:3')
compute norm is  tensor(48.8424, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9455, device='cuda:3')
compute distance is  tensor(128.9455, device='cuda:3')
compute norm is  tensor(48.4290, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.3181, device='cuda:3')
distance x is tensor(107627.7500, device='cuda:3')
distance x is tensor(107627.7500, device='cuda:3')
________________________________
test distance is  tensor(107627.7500, device='cuda:3')
test distance1 is  tensor(107627.7500, device='cuda:3')
test similarity is  tensor(0.2503, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130075199364997.73
test entropy is  0.0
________________________________
cal ratio is  0.035132052904032984
distance x is tensor(3781.1890, device='cuda:3')
cal_distance is  tensor(3781.1890, device='cuda:3')
cal ratio is  0.18743533421648775
distance x is tensor(708.7325, device='cuda:3')
cal_distance is  tensor(708.7325, device='cuda:3')
cal ratio is  0.43293678032815386
distance x is tensor(306.8392, device='cuda:3')
cal_distance is  tensor(306.8392, device='cuda:3')
cal ratio is  0.657976232462135
distance x is tensor(201.8947, device='cuda:3')
cal_distance is  tensor(201.8947, device='cuda:3')
cal ratio is  0.8111538178304976
distance x is tensor(163.7686, device='cuda:3')
cal_distance is  tensor(163.7686, device='cuda:3')
cal ratio is  0.9006381044619088
distance x is tensor(147.4967, device='cuda:3')
cal_distance is  tensor(147.4967, device='cuda:3')
cal ratio is  0.9490179454882434
distance x is tensor(139.9773, device='cuda:3')
cal_distance is  tensor(139.9773, device='cuda:3')
cal ratio is  0.9741746092756163
distance x is tensor(136.3625, device='cuda:3')
cal_distance is  tensor(136.3625, device='cuda:3')
distance x is tensor(136.3625, device='cuda:3')
return_distance is  tensor(136.3625, device='cuda:3')
distance x is tensor(136.3524, device='cuda:3')
distance x is tensor(136.3524, device='cuda:3')
________________________________
test distance is  tensor(136.3524, device='cuda:3')
test distance1 is  tensor(136.3524, device='cuda:3')
test similarity is  tensor(0.9590, device='cuda:3')
test acc is  0.1331000001563319
test loss is 95.66930277972841
test entropy is  0.013030116639566838
________________________________
0
distance x is tensor(136.3524, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.012776835856688153
avg test loss is  95.56627391497972
avg accuracy is  0.7885833334896594
solo acc is  0.1324000001563319
compute similarity  is  tensor(0.9590, device='cuda:3')
compute_distance is  tensor(136.3524, device='cuda:3')
compute_norm is  tensor(50.3267, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(130.2597, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9661396758388608
avg test loss is  1.4629417455780989
avg accuracy is  0.7870333334896593
solo acc is  0.27861666682300573
compute similarity  is  tensor(0.9608, device='cuda:3')
compute_distance is  tensor(130.2597, device='cuda:3')
compute_norm is  tensor(50.2966, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(130.2597, device='cuda:3')
distance x is tensor(130.2597, device='cuda:3')
________________________________
test distance is  tensor(130.2597, device='cuda:3')
test distance1 is  tensor(130.2597, device='cuda:3')
test similarity is  tensor(0.9608, device='cuda:3')
test acc is  0.2775166668230056
test loss is 1.4607483918732926
test entropy is  0.9692920953480165
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.5123331546783447
mal norm is  tensor(674.1665, device='cuda:3')
distance x is tensor(130.2691, device='cuda:3')
mal distance is  tensor(130.2691, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(19.0579, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.8615, device='cuda:3')
user_param_square tensor(94.7293, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-9.2047, device='cuda:3')
score : tensor(-0.1109, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.3376, device='cuda:3')
user_param_square tensor(99.8685, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-13.0839, device='cuda:3')
score : tensor(-0.1497, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.2128, device='cuda:3')
user_param_square tensor(96.4589, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(46.6438, device='cuda:3')
score : tensor(0.4476, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.6326, device='cuda:3')
user_param_square tensor(96.5004, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(24.7561, device='cuda:3')
score : tensor(0.2287, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(449.3214, device='cuda:3')
user_param_square tensor(92.5372, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-40.6428, device='cuda:3')
score : tensor(-0.4253, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.2795, device='cuda:3')
user_param_square tensor(100.2439, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-35.2107, device='cuda:3')
score : tensor(-0.3710, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.7014, device='cuda:3')
user_param_square tensor(94.2088, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(15.7711, device='cuda:3')
score : tensor(0.1389, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.5050, device='cuda:3')
user_param_square tensor(101.6809, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-12.8779, device='cuda:3')
score : tensor(-0.1476, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.1665, device='cuda:3')
user_param_square tensor(113.3499, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-5.0336, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.3391, device='cuda:3')
user_param_square tensor(105.3478, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(21.2942, device='cuda:3')
score : tensor(0.1941, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.3751, device='cuda:3')
user_param_square tensor(110.3000, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-12.1059, device='cuda:3')
score : tensor(-0.1399, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(559.0477, device='cuda:3')
user_param_square tensor(103.2196, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(44.5181, device='cuda:3')
score : tensor(0.4263, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.1577, device='cuda:3')
user_param_square tensor(105.1503, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(6.6779, device='cuda:3')
score : tensor(0.0479, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.9724, device='cuda:3')
user_param_square tensor(105.4955, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(16.8153, device='cuda:3')
score : tensor(0.1493, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(540.2601, device='cuda:3')
user_param_square tensor(101.4703, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-38.8912, device='cuda:3')
score : tensor(-0.4078, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.5081, device='cuda:3')
user_param_square tensor(107.6003, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(30.0119, device='cuda:3')
score : tensor(0.2813, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.9490, device='cuda:3')
user_param_square tensor(105.7640, device='cuda:3')
global_param_square tensor(19.0579, device='cuda:3')
part1 is  tensor(-1.8526, device='cuda:3')
score : tensor(-0.0374, device='cuda:3')
len accept list 8
len all weights is 8
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 89.64% 

Test Accuracy: 88.65% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
 benign loss is  0.48871079087257385
distance x is tensor(118.2364, device='cuda:3')
benign distance is  tensor(118.2364, device='cuda:3')
norm1 res is  tensor(0.1266, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.2420155555009842
distance x is tensor(120.3628, device='cuda:3')
benign distance is  tensor(120.3628, device='cuda:3')
norm1 res is  tensor(0.1323, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.36664023995399475
distance x is tensor(115.3870, device='cuda:3')
benign distance is  tensor(115.3870, device='cuda:3')
norm1 res is  tensor(0.1284, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4472673535346985
distance x is tensor(114.0337, device='cuda:3')
benign distance is  tensor(114.0337, device='cuda:3')
norm1 res is  tensor(0.1235, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3295486271381378
distance x is tensor(114.5640, device='cuda:3')
benign distance is  tensor(114.5640, device='cuda:3')
norm1 res is  tensor(0.1263, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3373788595199585
distance x is tensor(133.4383, device='cuda:3')
benign distance is  tensor(133.4383, device='cuda:3')
norm1 res is  tensor(0.1440, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.29762277007102966
distance x is tensor(111.6330, device='cuda:3')
benign distance is  tensor(111.6330, device='cuda:3')
norm1 res is  tensor(0.1206, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3351176381111145
distance x is tensor(120.5258, device='cuda:3')
benign distance is  tensor(120.5258, device='cuda:3')
norm1 res is  tensor(0.1319, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.5918911099433899
distance x is tensor(131.1769, device='cuda:3')
benign distance is  tensor(131.1769, device='cuda:3')
norm1 res is  tensor(0.1385, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.40152329206466675
distance x is tensor(137.3715, device='cuda:3')
benign distance is  tensor(137.3715, device='cuda:3')
norm1 res is  tensor(0.1508, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.8348675966262817
distance x is tensor(125.3251, device='cuda:3')
benign distance is  tensor(125.3251, device='cuda:3')
norm1 res is  tensor(0.1365, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.22557303309440613
distance x is tensor(124.4898, device='cuda:3')
benign distance is  tensor(124.4898, device='cuda:3')
norm1 res is  tensor(0.1372, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.2993277609348297
distance x is tensor(128.2473, device='cuda:3')
benign distance is  tensor(128.2473, device='cuda:3')
norm1 res is  tensor(0.1380, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.2940259575843811
distance x is tensor(132.1847, device='cuda:3')
benign distance is  tensor(132.1847, device='cuda:3')
norm1 res is  tensor(0.1412, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.3851095139980316
distance x is tensor(131.0041, device='cuda:3')
benign distance is  tensor(131.0041, device='cuda:3')
norm1 res is  tensor(0.1372, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.26924705505371094
distance x is tensor(134.8414, device='cuda:3')
benign distance is  tensor(134.8414, device='cuda:3')
norm1 res is  tensor(0.1443, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(119.6995, device='cuda:3')
compute distance is  tensor(119.6995, device='cuda:3')
compute norm is  tensor(48.3255, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.2560, device='cuda:3')
compute distance is  tensor(114.2560, device='cuda:3')
compute norm is  tensor(48.1758, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.0566, device='cuda:3')
compute distance is  tensor(120.0566, device='cuda:3')
compute norm is  tensor(48.6173, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.0679, device='cuda:3')
compute distance is  tensor(119.0679, device='cuda:3')
compute norm is  tensor(48.3500, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1039, device='cuda:3')
compute distance is  tensor(128.1039, device='cuda:3')
compute norm is  tensor(48.5551, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.9176, device='cuda:3')
compute distance is  tensor(122.9176, device='cuda:3')
compute norm is  tensor(48.5701, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0661, device='cuda:3')
compute distance is  tensor(118.0661, device='cuda:3')
compute norm is  tensor(48.5027, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.9326, device='cuda:3')
compute distance is  tensor(134.9326, device='cuda:3')
compute norm is  tensor(48.7118, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8197, device='cuda:3')
compute distance is  tensor(132.8197, device='cuda:3')
compute norm is  tensor(48.6616, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0336, device='cuda:3')
compute distance is  tensor(127.0336, device='cuda:3')
compute norm is  tensor(48.6456, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.7296, device='cuda:3')
compute distance is  tensor(139.7296, device='cuda:3')
compute norm is  tensor(48.8149, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.8307, device='cuda:3')
compute distance is  tensor(114.8307, device='cuda:3')
compute norm is  tensor(48.3507, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.7296, device='cuda:3')
distance x is tensor(107640.5078, device='cuda:3')
distance x is tensor(107640.5078, device='cuda:3')
________________________________
test distance is  tensor(107640.5078, device='cuda:3')
test distance1 is  tensor(107640.5078, device='cuda:3')
test similarity is  tensor(0.2096, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130119092801073.12
test entropy is  0.0
________________________________
cal ratio is  0.035308755272823865
distance x is tensor(3800.6577, device='cuda:3')
cal_distance is  tensor(3800.6577, device='cuda:3')
cal ratio is  0.1879061120247029
distance x is tensor(714.1710, device='cuda:3')
cal_distance is  tensor(714.1710, device='cuda:3')
cal ratio is  0.43348012478077913
distance x is tensor(309.5818, device='cuda:3')
cal_distance is  tensor(309.5818, device='cuda:3')
cal ratio is  0.6583890511186841
distance x is tensor(203.8270, device='cuda:3')
cal_distance is  tensor(203.8270, device='cuda:3')
cal ratio is  0.8114082938465489
distance x is tensor(165.3879, device='cuda:3')
cal_distance is  tensor(165.3879, device='cuda:3')
cal ratio is  0.9007793866259846
distance x is tensor(148.9785, device='cuda:3')
cal_distance is  tensor(148.9785, device='cuda:3')
cal ratio is  0.9490924070065602
distance x is tensor(141.3946, device='cuda:3')
cal_distance is  tensor(141.3946, device='cuda:3')
cal ratio is  0.9742128624879659
distance x is tensor(137.7486, device='cuda:3')
cal_distance is  tensor(137.7486, device='cuda:3')
distance x is tensor(137.7486, device='cuda:3')
return_distance is  tensor(137.7486, device='cuda:3')
distance x is tensor(137.7385, device='cuda:3')
distance x is tensor(137.7385, device='cuda:3')
________________________________
test distance is  tensor(137.7385, device='cuda:3')
test distance1 is  tensor(137.7385, device='cuda:3')
test similarity is  tensor(0.9564, device='cuda:3')
test acc is  0.11803333348966526
test loss is 130.4507083282796
test entropy is  0.007752146395166741
________________________________
0
distance x is tensor(137.7385, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.007399515395256187
avg test loss is  130.60627430995135
avg accuracy is  0.736966666822995
solo acc is  0.11810000015633192
compute similarity  is  tensor(0.9564, device='cuda:3')
compute_distance is  tensor(137.7385, device='cuda:3')
compute_norm is  tensor(50.1527, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(133.2336, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0419317246881374
avg test loss is  1.5542704687952233
avg accuracy is  0.7856833334896595
solo acc is  0.26120000015633854
compute similarity  is  tensor(0.9578, device='cuda:3')
compute_distance is  tensor(133.2336, device='cuda:3')
compute_norm is  tensor(50.2854, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(134.6559, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6236849406253554
avg test loss is  2.4024177799855213
avg accuracy is  0.7539833334896611
solo acc is  0.11195000015633194
compute similarity  is  tensor(0.9574, device='cuda:3')
compute_distance is  tensor(134.6559, device='cuda:3')
compute_norm is  tensor(50.0929, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(134.6483, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9642569482453597
avg test loss is  1.434614592650806
avg accuracy is  0.8070000001563251
solo acc is  0.2726333334896722
compute similarity  is  tensor(0.9576, device='cuda:3')
compute_distance is  tensor(134.6483, device='cuda:3')
compute_norm is  tensor(49.8273, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.3187, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9183791887277225
avg test loss is  1.4970461444051535
avg accuracy is  0.8076333334896585
solo acc is  0.23111666682300436
compute similarity  is  tensor(0.9574, device='cuda:3')
compute_distance is  tensor(135.3187, device='cuda:3')
compute_norm is  tensor(49.5986, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.9771, device='cuda:3')
distance x is tensor(135.9771, device='cuda:3')
________________________________
test distance is  tensor(135.9771, device='cuda:3')
test distance1 is  tensor(135.9771, device='cuda:3')
test similarity is  tensor(0.9572, device='cuda:3')
test acc is  0.22908333348967092
test loss is 1.4783463084113115
test entropy is  0.8886086089905899
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2545130252838135
mal norm is  tensor(669.7191, device='cuda:3')
distance x is tensor(135.9857, device='cuda:3')
mal distance is  tensor(135.9857, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(12.1760, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.9906, device='cuda:3')
user_param_square tensor(78.1029, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-2.6953, device='cuda:3')
score : tensor(-0.0389, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.0705, device='cuda:3')
user_param_square tensor(79.4997, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(4.3278, device='cuda:3')
score : tensor(0.0313, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(486.9899, device='cuda:3')
user_param_square tensor(77.0038, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-4.3349, device='cuda:3')
score : tensor(-0.0553, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(484.5147, device='cuda:3')
user_param_square tensor(76.8079, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-8.5918, device='cuda:3')
score : tensor(-0.0979, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(487.7242, device='cuda:3')
user_param_square tensor(77.0618, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-35.2626, device='cuda:3')
score : tensor(-0.3646, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.2764, device='cuda:3')
user_param_square tensor(83.4018, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-31.3141, device='cuda:3')
score : tensor(-0.3251, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(466.8853, device='cuda:3')
user_param_square tensor(75.3976, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-14.9072, device='cuda:3')
score : tensor(-0.1610, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.9735, device='cuda:3')
user_param_square tensor(79.1853, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-3.1897, device='cuda:3')
score : tensor(-0.0439, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7191, device='cuda:3')
user_param_square tensor(90.3022, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(10.2060, device='cuda:3')
score : tensor(0.0901, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.6768, device='cuda:3')
user_param_square tensor(84.0127, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-2.3102, device='cuda:3')
score : tensor(-0.0351, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(564.5898, device='cuda:3')
user_param_square tensor(82.9122, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-36.4713, device='cuda:3')
score : tensor(-0.3767, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.0345, device='cuda:3')
user_param_square tensor(81.3889, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-11.5753, device='cuda:3')
score : tensor(-0.1277, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.1125, device='cuda:3')
user_param_square tensor(85.4808, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-13.4935, device='cuda:3')
score : tensor(-0.1469, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.1984, device='cuda:3')
user_param_square tensor(82.6628, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-19.7227, device='cuda:3')
score : tensor(-0.2092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.3708, device='cuda:3')
user_param_square tensor(85.4279, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(7.6262, device='cuda:3')
score : tensor(0.0643, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.4470, device='cuda:3')
user_param_square tensor(82.3122, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(3.3857, device='cuda:3')
score : tensor(0.0219, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.4979, device='cuda:3')
user_param_square tensor(83.8547, device='cuda:3')
global_param_square tensor(12.1760, device='cuda:3')
part1 is  tensor(-14.2845, device='cuda:3')
score : tensor(-0.1548, device='cuda:3')
len accept list 15
len all weights is 15
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 80.91% 

Test Accuracy: 80.29% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6113741993904114
distance x is tensor(141.6778, device='cuda:3')
benign distance is  tensor(141.6778, device='cuda:3')
norm1 res is  tensor(0.1487, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8852113485336304
distance x is tensor(151.0759, device='cuda:3')
benign distance is  tensor(151.0759, device='cuda:3')
norm1 res is  tensor(0.1564, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.5943177938461304
distance x is tensor(148.3650, device='cuda:3')
benign distance is  tensor(148.3650, device='cuda:3')
norm1 res is  tensor(0.1563, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6567670702934265
distance x is tensor(165.0001, device='cuda:3')
benign distance is  tensor(165.0001, device='cuda:3')
norm1 res is  tensor(0.1737, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.36781197786331177
distance x is tensor(146.5300, device='cuda:3')
benign distance is  tensor(146.5300, device='cuda:3')
norm1 res is  tensor(0.1504, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.42027363181114197
distance x is tensor(174.3023, device='cuda:3')
benign distance is  tensor(174.3023, device='cuda:3')
norm1 res is  tensor(0.1858, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.10307937860488892
distance x is tensor(155.2961, device='cuda:3')
benign distance is  tensor(155.2961, device='cuda:3')
norm1 res is  tensor(0.1583, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.36464300751686096
distance x is tensor(160.1415, device='cuda:3')
benign distance is  tensor(160.1415, device='cuda:3')
norm1 res is  tensor(0.1673, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.5368973612785339
distance x is tensor(166.3280, device='cuda:3')
benign distance is  tensor(166.3280, device='cuda:3')
norm1 res is  tensor(0.1758, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.7745941281318665
distance x is tensor(155.2911, device='cuda:3')
benign distance is  tensor(155.2911, device='cuda:3')
norm1 res is  tensor(0.1616, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.4992896020412445
distance x is tensor(148.8074, device='cuda:3')
benign distance is  tensor(148.8074, device='cuda:3')
norm1 res is  tensor(0.1559, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.3474203944206238
distance x is tensor(154.3631, device='cuda:3')
benign distance is  tensor(154.3631, device='cuda:3')
norm1 res is  tensor(0.1624, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.5586234331130981
distance x is tensor(148.4755, device='cuda:3')
benign distance is  tensor(148.4755, device='cuda:3')
norm1 res is  tensor(0.1566, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.335307240486145
distance x is tensor(164.0107, device='cuda:3')
benign distance is  tensor(164.0107, device='cuda:3')
norm1 res is  tensor(0.1719, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.31551969051361084
distance x is tensor(149.5548, device='cuda:3')
benign distance is  tensor(149.5548, device='cuda:3')
norm1 res is  tensor(0.1568, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.35121697187423706
distance x is tensor(153.7152, device='cuda:3')
benign distance is  tensor(153.7152, device='cuda:3')
norm1 res is  tensor(0.1605, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(151.5322, device='cuda:3')
compute distance is  tensor(151.5322, device='cuda:3')
compute norm is  tensor(50.4651, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.0674, device='cuda:3')
compute distance is  tensor(148.0674, device='cuda:3')
compute norm is  tensor(50.3400, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.0996, device='cuda:3')
compute distance is  tensor(165.0996, device='cuda:3')
compute norm is  tensor(50.6956, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.4839, device='cuda:3')
compute distance is  tensor(148.4839, device='cuda:3')
compute norm is  tensor(50.3835, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.4542, device='cuda:3')
compute distance is  tensor(166.4542, device='cuda:3')
compute norm is  tensor(51.0593, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.7581, device='cuda:3')
compute distance is  tensor(167.7581, device='cuda:3')
compute norm is  tensor(50.8847, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.0746, device='cuda:3')
compute distance is  tensor(158.0746, device='cuda:3')
compute norm is  tensor(50.4939, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.1621, device='cuda:3')
compute distance is  tensor(158.1621, device='cuda:3')
compute norm is  tensor(50.6184, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.3091, device='cuda:3')
compute distance is  tensor(168.3091, device='cuda:3')
compute norm is  tensor(50.9053, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.4028, device='cuda:3')
compute distance is  tensor(165.4028, device='cuda:3')
compute norm is  tensor(50.6571, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.4340, device='cuda:3')
compute distance is  tensor(157.4340, device='cuda:3')
compute norm is  tensor(50.6722, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.1955, device='cuda:3')
compute distance is  tensor(176.1955, device='cuda:3')
compute norm is  tensor(51.0880, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(176.1955, device='cuda:3')
distance x is tensor(107581.1250, device='cuda:3')
distance x is tensor(107581.1250, device='cuda:3')
________________________________
test distance is  tensor(107581.1250, device='cuda:3')
test distance1 is  tensor(107581.1250, device='cuda:3')
test similarity is  tensor(0.3733, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130135913677184.27
test entropy is  0.0
________________________________
cal ratio is  0.03966025268511402
distance x is tensor(4266.6992, device='cuda:3')
cal_distance is  tensor(4266.6992, device='cuda:3')
cal ratio is  0.19914870724639755
distance x is tensor(849.7117, device='cuda:3')
cal_distance is  tensor(849.7117, device='cuda:3')
cal ratio is  0.44625974088209996
distance x is tensor(379.1950, device='cuda:3')
cal_distance is  tensor(379.1950, device='cuda:3')
cal ratio is  0.6680242227107172
distance x is tensor(253.3131, device='cuda:3')
cal_distance is  tensor(253.3131, device='cuda:3')
cal ratio is  0.817324823850626
distance x is tensor(207.0400, device='cuda:3')
cal_distance is  tensor(207.0400, device='cuda:3')
cal ratio is  0.904058178556091
distance x is tensor(187.1767, device='cuda:3')
cal_distance is  tensor(187.1767, device='cuda:3')
cal ratio is  0.9508183735955861
distance x is tensor(177.9713, device='cuda:3')
cal_distance is  tensor(177.9713, device='cuda:3')
cal ratio is  0.9750984950566779
distance x is tensor(173.5397, device='cuda:3')
cal_distance is  tensor(173.5397, device='cuda:3')
distance x is tensor(173.5397, device='cuda:3')
return_distance is  tensor(173.5397, device='cuda:3')
distance x is tensor(173.5296, device='cuda:3')
distance x is tensor(173.5296, device='cuda:3')
________________________________
test distance is  tensor(173.5296, device='cuda:3')
test distance1 is  tensor(173.5296, device='cuda:3')
test similarity is  tensor(0.9511, device='cuda:3')
test acc is  0.12605000015633192
test loss is 142.15217525262568
test entropy is  0.014541509379900713
________________________________
0
distance x is tensor(173.5296, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.014803171899707281
avg test loss is  141.71699214032463
avg accuracy is  0.5938166668230048
solo acc is  0.12573333348966523
compute similarity  is  tensor(0.9511, device='cuda:3')
compute_distance is  tensor(173.5296, device='cuda:3')
compute_norm is  tensor(54.0845, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(162.1694, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.036996374506432
avg test loss is  1.543321935479829
avg accuracy is  0.36333333348967395
solo acc is  0.25526666682300503
compute similarity  is  tensor(0.9548, device='cuda:3')
compute_distance is  tensor(162.1694, device='cuda:3')
compute_norm is  tensor(54.4681, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.2948, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6099945515839021
avg test loss is  2.419565286971867
avg accuracy is  0.2178500001563371
solo acc is  0.10780000015633195
compute similarity  is  tensor(0.9548, device='cuda:3')
compute_distance is  tensor(162.2948, device='cuda:3')
compute_norm is  tensor(54.2893, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.9439, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9961137872642037
avg test loss is  1.4810682471627112
avg accuracy is  0.38326666682300753
solo acc is  0.2368500001563378
compute similarity  is  tensor(0.9551, device='cuda:3')
compute_distance is  tensor(161.9439, device='cuda:3')
compute_norm is  tensor(53.9879, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(161.9439, device='cuda:3')
distance x is tensor(161.9439, device='cuda:3')
________________________________
test distance is  tensor(161.9439, device='cuda:3')
test distance1 is  tensor(161.9439, device='cuda:3')
test similarity is  tensor(0.9551, device='cuda:3')
test acc is  0.2360333334896711
test loss is 1.4830409841242629
test entropy is  0.9970888154847282
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3976752758026123
mal norm is  tensor(836.7889, device='cuda:3')
distance x is tensor(161.9535, device='cuda:3')
mal distance is  tensor(161.9535, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(33.3016, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.3566, device='cuda:3')
user_param_square tensor(139.8567, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(257.3782, device='cuda:3')
score : tensor(2.5407, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.4619, device='cuda:3')
user_param_square tensor(143.5122, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(115.5657, device='cuda:3')
score : tensor(1.1226, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.6456, device='cuda:3')
user_param_square tensor(143.5335, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(196.5240, device='cuda:3')
score : tensor(1.9321, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.1403, device='cuda:3')
user_param_square tensor(150.8299, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(38.1841, device='cuda:3')
score : tensor(0.3487, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.6926, device='cuda:3')
user_param_square tensor(140.7274, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(167.7774, device='cuda:3')
score : tensor(1.6447, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4402, device='cuda:3')
user_param_square tensor(155.7505, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(42.2549, device='cuda:3')
score : tensor(0.3894, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.2714, device='cuda:3')
user_param_square tensor(144.0692, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(160.6391, device='cuda:3')
score : tensor(1.5733, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.1400, device='cuda:3')
user_param_square tensor(148.1567, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-24.1583, device='cuda:3')
score : tensor(-0.2747, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.7889, device='cuda:3')
user_param_square tensor(166.9323, device='cuda:3')
global_param_square tensor(33.3016, device='cuda:3')
part1 is  tensor(-226.2421, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
len accept list 7
len all weights is 7
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 88.69% 

Test Accuracy: 87.84% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
 benign loss is  0.756058394908905
distance x is tensor(115.6393, device='cuda:3')
benign distance is  tensor(115.6393, device='cuda:3')
norm1 res is  tensor(0.1278, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.33963778614997864
distance x is tensor(128.8906, device='cuda:3')
benign distance is  tensor(128.8906, device='cuda:3')
norm1 res is  tensor(0.1377, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.15920710563659668
distance x is tensor(136.2735, device='cuda:3')
benign distance is  tensor(136.2735, device='cuda:3')
norm1 res is  tensor(0.1446, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6741216778755188
distance x is tensor(126.3359, device='cuda:3')
benign distance is  tensor(126.3359, device='cuda:3')
norm1 res is  tensor(0.1346, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4293043613433838
distance x is tensor(141.1828, device='cuda:3')
benign distance is  tensor(141.1828, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.42449527978897095
distance x is tensor(128.6741, device='cuda:3')
benign distance is  tensor(128.6741, device='cuda:3')
norm1 res is  tensor(0.1370, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.17528553307056427
distance x is tensor(138.7290, device='cuda:3')
benign distance is  tensor(138.7290, device='cuda:3')
norm1 res is  tensor(0.1447, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5497643947601318
distance x is tensor(123.5557, device='cuda:3')
benign distance is  tensor(123.5557, device='cuda:3')
norm1 res is  tensor(0.1335, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(142.6237, device='cuda:3')
compute distance is  tensor(142.6237, device='cuda:3')
compute norm is  tensor(51.0514, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4602, device='cuda:3')
compute distance is  tensor(136.4602, device='cuda:3')
compute norm is  tensor(50.8374, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.3281, device='cuda:3')
compute distance is  tensor(136.3281, device='cuda:3')
compute norm is  tensor(51.0719, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.9714, device='cuda:3')
compute distance is  tensor(141.9714, device='cuda:3')
compute norm is  tensor(51.1079, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2048, device='cuda:3')
compute distance is  tensor(132.2048, device='cuda:3')
compute norm is  tensor(50.8684, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5284, device='cuda:3')
compute distance is  tensor(139.5284, device='cuda:3')
compute norm is  tensor(51.1085, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0063, device='cuda:3')
compute distance is  tensor(127.0063, device='cuda:3')
compute norm is  tensor(50.7898, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7239, device='cuda:3')
compute distance is  tensor(132.7239, device='cuda:3')
compute norm is  tensor(50.9061, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9403, device='cuda:3')
compute distance is  tensor(135.9403, device='cuda:3')
compute norm is  tensor(51.1042, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8691, device='cuda:3')
compute distance is  tensor(133.8691, device='cuda:3')
compute norm is  tensor(51.0034, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.8104, device='cuda:3')
compute distance is  tensor(145.8104, device='cuda:3')
compute norm is  tensor(51.1741, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5555, device='cuda:3')
compute distance is  tensor(144.5555, device='cuda:3')
compute norm is  tensor(51.1574, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.8104, device='cuda:3')
distance x is tensor(107603.1016, device='cuda:3')
distance x is tensor(107603.1016, device='cuda:3')
________________________________
test distance is  tensor(107603.1016, device='cuda:3')
test distance1 is  tensor(107603.1016, device='cuda:3')
test similarity is  tensor(0.3344, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130101403525172.4
test entropy is  0.0
________________________________
cal ratio is  0.03607513103289374
distance x is tensor(3881.8013, device='cuda:3')
cal_distance is  tensor(3881.8013, device='cuda:3')
cal ratio is  0.18993441737244543
distance x is tensor(737.2917, device='cuda:3')
cal_distance is  tensor(737.2917, device='cuda:3')
cal ratio is  0.4358134580331128
distance x is tensor(321.3245, device='cuda:3')
cal_distance is  tensor(321.3245, device='cuda:3')
cal ratio is  0.6601587410964465
distance x is tensor(212.1269, device='cuda:3')
cal_distance is  tensor(212.1269, device='cuda:3')
cal ratio is  0.8124982542165927
distance x is tensor(172.3537, device='cuda:3')
cal_distance is  tensor(172.3537, device='cuda:3')
cal ratio is  0.9013843041874678
distance x is tensor(155.3574, device='cuda:3')
cal_distance is  tensor(155.3574, device='cuda:3')
cal ratio is  0.949411117112818
distance x is tensor(147.4983, device='cuda:3')
cal_distance is  tensor(147.4983, device='cuda:3')
cal ratio is  0.974376435318551
distance x is tensor(143.7190, device='cuda:3')
cal_distance is  tensor(143.7190, device='cuda:3')
distance x is tensor(143.7190, device='cuda:3')
return_distance is  tensor(143.7190, device='cuda:3')
distance x is tensor(143.7090, device='cuda:3')
distance x is tensor(143.7090, device='cuda:3')
________________________________
test distance is  tensor(143.7090, device='cuda:3')
test distance1 is  tensor(143.7090, device='cuda:3')
test similarity is  tensor(0.9633, device='cuda:3')
test acc is  0.242800000156338
test loss is 50.322576848174464
test entropy is  0.03926899041166342
________________________________
0
distance x is tensor(143.7090, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.039234380348464416
avg test loss is  50.31692855851228
avg accuracy is  0.8590666668229896
solo acc is  0.242050000156338
compute similarity  is  tensor(0.9633, device='cuda:3')
compute_distance is  tensor(143.7090, device='cuda:3')
compute_norm is  tensor(53.4627, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.2679, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9160934522716221
avg test loss is  1.3498889402921266
avg accuracy is  0.8056666668229918
solo acc is  0.31451666682300644
compute similarity  is  tensor(0.9646, device='cuda:3')
compute_distance is  tensor(136.2679, device='cuda:3')
compute_norm is  tensor(53.2036, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.0299, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8697385113122367
avg test loss is  1.449134429126406
avg accuracy is  0.8018833334896586
solo acc is  0.2462166668230048
compute similarity  is  tensor(0.9644, device='cuda:3')
compute_distance is  tensor(137.0299, device='cuda:3')
compute_norm is  tensor(52.9401, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.5249, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8690602147757117
avg test loss is  1.4208385938012016
avg accuracy is  0.8017000001563254
solo acc is  0.24720000015633817
compute similarity  is  tensor(0.9642, device='cuda:3')
compute_distance is  tensor(137.5249, device='cuda:3')
compute_norm is  tensor(52.6784, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.0824, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8609895643267804
avg test loss is  1.4107655343978898
avg accuracy is  0.8045166668229918
solo acc is  0.24221666682300472
compute similarity  is  tensor(0.9640, device='cuda:3')
compute_distance is  tensor(138.0824, device='cuda:3')
compute_norm is  tensor(52.4202, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.6205, device='cuda:3')
distance x is tensor(138.6205, device='cuda:3')
________________________________
test distance is  tensor(138.6205, device='cuda:3')
test distance1 is  tensor(138.6205, device='cuda:3')
test similarity is  tensor(0.9639, device='cuda:3')
test acc is  0.24186666682300467
test loss is 1.392765821043108
test entropy is  0.8541525932771565
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1221143007278442
mal norm is  tensor(690.1738, device='cuda:3')
distance x is tensor(138.6294, device='cuda:3')
mal distance is  tensor(138.6294, device='cuda:3')
len current grad  20
len all grad 52
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(17.9371, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(494.6999, device='cuda:3')
user_param_square tensor(94.1992, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-9.7765, device='cuda:3')
score : tensor(-0.1155, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.3143, device='cuda:3')
user_param_square tensor(98.6284, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(0.6224, device='cuda:3')
score : tensor(-0.0115, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.2766, device='cuda:3')
user_param_square tensor(100.7838, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(3.8741, device='cuda:3')
score : tensor(0.0210, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(525.2422, device='cuda:3')
user_param_square tensor(97.0635, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-27.0676, device='cuda:3')
score : tensor(-0.2884, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.9399, device='cuda:3')
user_param_square tensor(101.5518, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-5.0907, device='cuda:3')
score : tensor(-0.0686, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(540.2374, device='cuda:3')
user_param_square tensor(98.4393, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-38.9102, device='cuda:3')
score : tensor(-0.4068, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.1127, device='cuda:3')
user_param_square tensor(100.5018, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(23.6256, device='cuda:3')
score : tensor(0.2185, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.2816, device='cuda:3')
user_param_square tensor(97.4360, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-25.8451, device='cuda:3')
score : tensor(-0.2762, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.1738, device='cuda:3')
user_param_square tensor(111.2642, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-36.9583, device='cuda:3')
score : tensor(-0.3873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9942, device='cuda:3')
user_param_square tensor(113.2472, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-12.5525, device='cuda:3')
score : tensor(-0.1433, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.6926, device='cuda:3')
user_param_square tensor(114.7185, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-18.2026, device='cuda:3')
score : tensor(-0.1998, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.6007, device='cuda:3')
user_param_square tensor(113.7692, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(9.3598, device='cuda:3')
score : tensor(0.0759, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.0437, device='cuda:3')
user_param_square tensor(117.6023, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-16.4661, device='cuda:3')
score : tensor(-0.1824, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.7924, device='cuda:3')
user_param_square tensor(112.3566, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-6.4755, device='cuda:3')
score : tensor(-0.0825, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.6606, device='cuda:3')
user_param_square tensor(113.3000, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-41.5019, device='cuda:3')
score : tensor(-0.4328, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.4113, device='cuda:3')
user_param_square tensor(115.3981, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-21.3579, device='cuda:3')
score : tensor(-0.2313, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.8261, device='cuda:3')
user_param_square tensor(115.8181, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-22.2562, device='cuda:3')
score : tensor(-0.2403, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.9388, device='cuda:3')
user_param_square tensor(111.1646, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(17.3101, device='cuda:3')
score : tensor(0.1554, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.8116, device='cuda:3')
user_param_square tensor(104.7575, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-42.2041, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0668, device='cuda:3')
user_param_square tensor(109.8766, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-7.7410, device='cuda:3')
score : tensor(-0.0951, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.1026, device='cuda:3')
user_param_square tensor(109.0603, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-5.3933, device='cuda:3')
score : tensor(-0.0717, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.6524, device='cuda:3')
user_param_square tensor(109.4338, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-51.6738, device='cuda:3')
score : tensor(-0.5345, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.8834, device='cuda:3')
user_param_square tensor(110.8370, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-21.1074, device='cuda:3')
score : tensor(-0.2288, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.5708, device='cuda:3')
user_param_square tensor(109.0988, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(20.0195, device='cuda:3')
score : tensor(0.1825, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.8890, device='cuda:3')
user_param_square tensor(110.9183, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(5.3171, device='cuda:3')
score : tensor(0.0354, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.7095, device='cuda:3')
user_param_square tensor(112.2701, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-16.1774, device='cuda:3')
score : tensor(-0.1795, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.8526, device='cuda:3')
user_param_square tensor(114.4962, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-13.4590, device='cuda:3')
score : tensor(-0.1523, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.9962, device='cuda:3')
user_param_square tensor(111.4110, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(7.8659, device='cuda:3')
score : tensor(0.0609, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.6191, device='cuda:3')
user_param_square tensor(111.6220, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-3.3934, device='cuda:3')
score : tensor(-0.0517, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.5874, device='cuda:3')
user_param_square tensor(111.8602, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-4.1359, device='cuda:3')
score : tensor(-0.0591, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1724, device='cuda:3')
user_param_square tensor(112.3869, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-0.5651, device='cuda:3')
score : tensor(-0.0234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.5776, device='cuda:3')
user_param_square tensor(111.9396, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(4.8049, device='cuda:3')
score : tensor(0.0303, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.3421, device='cuda:3')
user_param_square tensor(113.2748, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(22.0510, device='cuda:3')
score : tensor(0.2028, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.0228, device='cuda:3')
user_param_square tensor(110.4430, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-10.6844, device='cuda:3')
score : tensor(-0.1246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.7065, device='cuda:3')
user_param_square tensor(106.2785, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-26.5539, device='cuda:3')
score : tensor(-0.2833, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.0323, device='cuda:3')
user_param_square tensor(104.3475, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-10.9461, device='cuda:3')
score : tensor(-0.1272, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.3601, device='cuda:3')
user_param_square tensor(106.5022, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-14.9909, device='cuda:3')
score : tensor(-0.1676, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.6910, device='cuda:3')
user_param_square tensor(105.0891, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-24.1699, device='cuda:3')
score : tensor(-0.2594, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.4246, device='cuda:3')
user_param_square tensor(109.9058, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-2.8459, device='cuda:3')
score : tensor(-0.0462, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.4019, device='cuda:3')
user_param_square tensor(104.8936, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(36.8307, device='cuda:3')
score : tensor(0.3506, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7536, device='cuda:3')
user_param_square tensor(106.1136, device='cuda:3')
global_param_square tensor(17.9371, device='cuda:3')
part1 is  tensor(-27.4224, device='cuda:3')
score : tensor(-0.2920, device='cuda:3')
len accept list 10
len all weights is 10
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.42% 

Test Accuracy: 88.46% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8413387537002563
distance x is tensor(122.3535, device='cuda:3')
benign distance is  tensor(122.3535, device='cuda:3')
norm1 res is  tensor(0.1332, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5132867097854614
distance x is tensor(122.8324, device='cuda:3')
benign distance is  tensor(122.8324, device='cuda:3')
norm1 res is  tensor(0.1333, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.46528610587120056
distance x is tensor(113.0854, device='cuda:3')
benign distance is  tensor(113.0854, device='cuda:3')
norm1 res is  tensor(0.1243, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.639110267162323
distance x is tensor(122.3725, device='cuda:3')
benign distance is  tensor(122.3725, device='cuda:3')
norm1 res is  tensor(0.1308, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.8017672300338745
distance x is tensor(124.5714, device='cuda:3')
benign distance is  tensor(124.5714, device='cuda:3')
norm1 res is  tensor(0.1339, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7766411900520325
distance x is tensor(142.9342, device='cuda:3')
benign distance is  tensor(142.9342, device='cuda:3')
norm1 res is  tensor(0.1531, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  1.0732743740081787
distance x is tensor(101.4393, device='cuda:3')
benign distance is  tensor(101.4393, device='cuda:3')
norm1 res is  tensor(0.1089, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.34980612993240356
distance x is tensor(125.0376, device='cuda:3')
benign distance is  tensor(125.0376, device='cuda:3')
norm1 res is  tensor(0.1357, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.25622329115867615
distance x is tensor(134.9821, device='cuda:3')
benign distance is  tensor(134.9821, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.49670785665512085
distance x is tensor(129.4911, device='cuda:3')
benign distance is  tensor(129.4911, device='cuda:3')
norm1 res is  tensor(0.1394, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.5631839036941528
distance x is tensor(127.9474, device='cuda:3')
benign distance is  tensor(127.9474, device='cuda:3')
norm1 res is  tensor(0.1341, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.889894962310791
distance x is tensor(141.1241, device='cuda:3')
benign distance is  tensor(141.1241, device='cuda:3')
norm1 res is  tensor(0.1494, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.13536985218524933
distance x is tensor(125.5154, device='cuda:3')
benign distance is  tensor(125.5154, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.0491853766143322
distance x is tensor(131.8616, device='cuda:3')
benign distance is  tensor(131.8616, device='cuda:3')
norm1 res is  tensor(0.1426, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.24145054817199707
distance x is tensor(126.8157, device='cuda:3')
benign distance is  tensor(126.8157, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  1.0165914297103882
distance x is tensor(132.7202, device='cuda:3')
benign distance is  tensor(132.7202, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.5112398862838745
distance x is tensor(129.0762, device='cuda:3')
benign distance is  tensor(129.0762, device='cuda:3')
norm1 res is  tensor(0.1362, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.4742617607116699
distance x is tensor(141.1017, device='cuda:3')
benign distance is  tensor(141.1017, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.2523180842399597
distance x is tensor(133.1861, device='cuda:3')
benign distance is  tensor(133.1861, device='cuda:3')
norm1 res is  tensor(0.1451, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.05881311744451523
distance x is tensor(125.2257, device='cuda:3')
benign distance is  tensor(125.2257, device='cuda:3')
norm1 res is  tensor(0.1342, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.13541223108768463
distance x is tensor(125.2975, device='cuda:3')
benign distance is  tensor(125.2975, device='cuda:3')
norm1 res is  tensor(0.1331, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.9693659543991089
distance x is tensor(122.2286, device='cuda:3')
benign distance is  tensor(122.2286, device='cuda:3')
norm1 res is  tensor(0.1298, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.11495263874530792
distance x is tensor(128.5929, device='cuda:3')
benign distance is  tensor(128.5929, device='cuda:3')
norm1 res is  tensor(0.1403, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.432521253824234
distance x is tensor(136.6987, device='cuda:3')
benign distance is  tensor(136.6987, device='cuda:3')
norm1 res is  tensor(0.1422, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.3544526696205139
distance x is tensor(134.1012, device='cuda:3')
benign distance is  tensor(134.1012, device='cuda:3')
norm1 res is  tensor(0.1415, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.2909943461418152
distance x is tensor(124.7974, device='cuda:3')
benign distance is  tensor(124.7974, device='cuda:3')
norm1 res is  tensor(0.1318, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.5447412729263306
distance x is tensor(151.5901, device='cuda:3')
benign distance is  tensor(151.5901, device='cuda:3')
norm1 res is  tensor(0.1604, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.5010536909103394
distance x is tensor(131.0748, device='cuda:3')
benign distance is  tensor(131.0748, device='cuda:3')
norm1 res is  tensor(0.1402, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.5484328866004944
distance x is tensor(135.0035, device='cuda:3')
benign distance is  tensor(135.0035, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.24888089299201965
distance x is tensor(137.9880, device='cuda:3')
benign distance is  tensor(137.9880, device='cuda:3')
norm1 res is  tensor(0.1494, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.4223577380180359
distance x is tensor(125.5788, device='cuda:3')
benign distance is  tensor(125.5788, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.17699536681175232
distance x is tensor(119.4259, device='cuda:3')
benign distance is  tensor(119.4259, device='cuda:3')
norm1 res is  tensor(0.1294, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.15148791670799255
distance x is tensor(125.2447, device='cuda:3')
benign distance is  tensor(125.2447, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.7085081338882446
distance x is tensor(121.2007, device='cuda:3')
benign distance is  tensor(121.2007, device='cuda:3')
norm1 res is  tensor(0.1280, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.2721773684024811
distance x is tensor(122.7832, device='cuda:3')
benign distance is  tensor(122.7832, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.48056334257125854
distance x is tensor(134.9075, device='cuda:3')
benign distance is  tensor(134.9075, device='cuda:3')
norm1 res is  tensor(0.1470, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.27357909083366394
distance x is tensor(121.9985, device='cuda:3')
benign distance is  tensor(121.9985, device='cuda:3')
norm1 res is  tensor(0.1316, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.7273553609848022
distance x is tensor(125.4925, device='cuda:3')
benign distance is  tensor(125.4925, device='cuda:3')
norm1 res is  tensor(0.1316, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.38312017917633057
distance x is tensor(132.8381, device='cuda:3')
benign distance is  tensor(132.8381, device='cuda:3')
norm1 res is  tensor(0.1414, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.06114929914474487
distance x is tensor(147.0741, device='cuda:3')
benign distance is  tensor(147.0741, device='cuda:3')
norm1 res is  tensor(0.1622, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(120.0160, device='cuda:3')
compute distance is  tensor(120.0160, device='cuda:3')
compute norm is  tensor(49.5394, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5663, device='cuda:3')
compute distance is  tensor(119.5663, device='cuda:3')
compute norm is  tensor(49.6697, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.7962, device='cuda:3')
compute distance is  tensor(135.7962, device='cuda:3')
compute norm is  tensor(50.0053, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2533, device='cuda:3')
compute distance is  tensor(138.2533, device='cuda:3')
compute norm is  tensor(50.1380, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.7501, device='cuda:3')
compute distance is  tensor(129.7501, device='cuda:3')
compute norm is  tensor(49.8598, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2305, device='cuda:3')
compute distance is  tensor(126.2305, device='cuda:3')
compute norm is  tensor(49.9462, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.1484, device='cuda:3')
compute distance is  tensor(114.1484, device='cuda:3')
compute norm is  tensor(49.6237, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4766, device='cuda:3')
compute distance is  tensor(129.4766, device='cuda:3')
compute norm is  tensor(49.7727, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1128, device='cuda:3')
compute distance is  tensor(138.1128, device='cuda:3')
compute norm is  tensor(50.1532, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.1638, device='cuda:3')
compute distance is  tensor(130.1638, device='cuda:3')
compute norm is  tensor(49.9378, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.9906, device='cuda:3')
compute distance is  tensor(129.9906, device='cuda:3')
compute norm is  tensor(49.9574, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.2536, device='cuda:3')
compute distance is  tensor(141.2536, device='cuda:3')
compute norm is  tensor(50.2422, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(141.2536, device='cuda:3')
distance x is tensor(107629.9766, device='cuda:3')
distance x is tensor(107629.9766, device='cuda:3')
________________________________
test distance is  tensor(107629.9766, device='cuda:3')
test distance1 is  tensor(107629.9766, device='cuda:3')
test similarity is  tensor(0.2577, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130028482572087.12
test entropy is  0.0
________________________________
cal ratio is  0.03550252179887475
distance x is tensor(3821.1414, device='cuda:3')
cal_distance is  tensor(3821.1414, device='cuda:3')
cal ratio is  0.18842098652030492
distance x is tensor(719.9872, device='cuda:3')
cal_distance is  tensor(719.9872, device='cuda:3')
cal ratio is  0.43407364705316565
distance x is tensor(312.5304, device='cuda:3')
cal_distance is  tensor(312.5304, device='cuda:3')
cal ratio is  0.6588395816128484
distance x is tensor(205.9091, device='cuda:3')
cal_distance is  tensor(205.9091, device='cuda:3')
cal ratio is  0.8116859637221151
distance x is tensor(167.1345, device='cuda:3')
cal_distance is  tensor(167.1345, device='cuda:3')
cal ratio is  0.9009335451174918
distance x is tensor(150.5776, device='cuda:3')
cal_distance is  tensor(150.5776, device='cuda:3')
cal ratio is  0.9491735269205372
distance x is tensor(142.9245, device='cuda:3')
cal_distance is  tensor(142.9245, device='cuda:3')
cal ratio is  0.974254463354923
distance x is tensor(139.2450, device='cuda:3')
cal_distance is  tensor(139.2450, device='cuda:3')
distance x is tensor(139.2450, device='cuda:3')
return_distance is  tensor(139.2450, device='cuda:3')
distance x is tensor(139.2349, device='cuda:3')
distance x is tensor(139.2349, device='cuda:3')
________________________________
test distance is  tensor(139.2349, device='cuda:3')
test distance1 is  tensor(139.2349, device='cuda:3')
test similarity is  tensor(0.9599, device='cuda:3')
test acc is  0.17361666682300156
test loss is 78.49260912571889
test entropy is  0.02185014724378166
________________________________
0
distance x is tensor(139.2349, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.021198915473701792
avg test loss is  78.65915874733345
avg accuracy is  0.8338500001563239
solo acc is  0.1726166668230015
compute similarity  is  tensor(0.9599, device='cuda:3')
compute_distance is  tensor(139.2349, device='cuda:3')
compute_norm is  tensor(51.7845, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(132.6819, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9074934878583147
avg test loss is  1.3471503447113768
avg accuracy is  0.8504166668229899
solo acc is  0.3270166668230067
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(132.6819, device='cuda:3')
compute_norm is  tensor(51.5038, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.5783, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8647752460767465
avg test loss is  1.439079548377218
avg accuracy is  0.8496166668229899
solo acc is  0.26066666682300527
compute similarity  is  tensor(0.9607, device='cuda:3')
compute_distance is  tensor(133.5783, device='cuda:3')
compute_norm is  tensor(51.2387, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.2708, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8680589875813994
avg test loss is  1.4192370866407464
avg accuracy is  0.8498333334896565
solo acc is  0.25490000015633846
compute similarity  is  tensor(0.9605, device='cuda:3')
compute_distance is  tensor(134.2708, device='cuda:3')
compute_norm is  tensor(50.9805, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.9342, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8607798060501562
avg test loss is  1.400121645124228
avg accuracy is  0.8514333334896566
solo acc is  0.2500333334896716
compute similarity  is  tensor(0.9603, device='cuda:3')
compute_distance is  tensor(134.9342, device='cuda:3')
compute_norm is  tensor(50.7298, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.6273, device='cuda:3')
distance x is tensor(135.6273, device='cuda:3')
________________________________
test distance is  tensor(135.6273, device='cuda:3')
test distance1 is  tensor(135.6273, device='cuda:3')
test similarity is  tensor(0.9602, device='cuda:3')
test acc is  0.24833333348967157
test loss is 1.392616726823453
test entropy is  0.8517803014087271
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2304155826568604
mal norm is  tensor(674.6631, device='cuda:3')
distance x is tensor(135.6362, device='cuda:3')
mal distance is  tensor(135.6362, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(16.4577, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.3865, device='cuda:3')
user_param_square tensor(93.2525, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-2.7234, device='cuda:3')
score : tensor(-0.0435, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.0701, device='cuda:3')
user_param_square tensor(93.1363, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-5.8347, device='cuda:3')
score : tensor(-0.0746, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.5949, device='cuda:3')
user_param_square tensor(89.2125, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(11.7477, device='cuda:3')
score : tensor(0.1012, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.2625, device='cuda:3')
user_param_square tensor(92.4439, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-10.5120, device='cuda:3')
score : tensor(-0.1214, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.5111, device='cuda:3')
user_param_square tensor(92.8213, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-50.0473, device='cuda:3')
score : tensor(-0.5167, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.3193, device='cuda:3')
user_param_square tensor(99.8107, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-25.2958, device='cuda:3')
score : tensor(-0.2692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(419.7300, device='cuda:3')
user_param_square tensor(83.1131, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(2.1442, device='cuda:3')
score : tensor(0.0052, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.2563, device='cuda:3')
user_param_square tensor(94.2068, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-9.6033, device='cuda:3')
score : tensor(-0.1123, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6631, device='cuda:3')
user_param_square tensor(105.3727, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(4.2647, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.0237, device='cuda:3')
user_param_square tensor(99.2903, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-18.9374, device='cuda:3')
score : tensor(-0.2056, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.3373, device='cuda:3')
user_param_square tensor(97.6451, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(27.2365, device='cuda:3')
score : tensor(0.2561, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.6636, device='cuda:3')
user_param_square tensor(99.5915, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-26.5821, device='cuda:3')
score : tensor(-0.2821, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.9417, device='cuda:3')
user_param_square tensor(99.4491, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(21.4014, device='cuda:3')
score : tensor(0.1978, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6328, device='cuda:3')
user_param_square tensor(100.1657, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(12.8971, device='cuda:3')
score : tensor(0.1127, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.2719, device='cuda:3')
user_param_square tensor(99.6417, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-12.9752, device='cuda:3')
score : tensor(-0.1460, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.9609, device='cuda:3')
user_param_square tensor(97.0215, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(-14.7693, device='cuda:3')
score : tensor(-0.1640, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.4084, device='cuda:3')
user_param_square tensor(97.8195, device='cuda:3')
global_param_square tensor(16.4577, device='cuda:3')
part1 is  tensor(0.7774, device='cuda:3')
score : tensor(-0.0085, device='cuda:3')
len accept list 17
len all weights is 17
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 86.56% 

Test Accuracy: 85.49% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
 benign loss is  0.435537189245224
distance x is tensor(167.5215, device='cuda:3')
benign distance is  tensor(167.5215, device='cuda:3')
norm1 res is  tensor(0.1751, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.39659589529037476
distance x is tensor(132.0685, device='cuda:3')
benign distance is  tensor(132.0685, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.19114629924297333
distance x is tensor(141.4143, device='cuda:3')
benign distance is  tensor(141.4143, device='cuda:3')
norm1 res is  tensor(0.1501, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  1.0136852264404297
distance x is tensor(140.3537, device='cuda:3')
benign distance is  tensor(140.3537, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.8068326711654663
distance x is tensor(145.5493, device='cuda:3')
benign distance is  tensor(145.5493, device='cuda:3')
norm1 res is  tensor(0.1510, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6651886701583862
distance x is tensor(152.6627, device='cuda:3')
benign distance is  tensor(152.6627, device='cuda:3')
norm1 res is  tensor(0.1590, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.10898150503635406
distance x is tensor(144.4374, device='cuda:3')
benign distance is  tensor(144.4374, device='cuda:3')
norm1 res is  tensor(0.1514, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.19557353854179382
distance x is tensor(149.9692, device='cuda:3')
benign distance is  tensor(149.9692, device='cuda:3')
norm1 res is  tensor(0.1600, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.7176379561424255
distance x is tensor(152.3232, device='cuda:3')
benign distance is  tensor(152.3232, device='cuda:3')
norm1 res is  tensor(0.1599, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.3106103241443634
distance x is tensor(154.9436, device='cuda:3')
benign distance is  tensor(154.9436, device='cuda:3')
norm1 res is  tensor(0.1632, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.3473265767097473
distance x is tensor(147.6897, device='cuda:3')
benign distance is  tensor(147.6897, device='cuda:3')
norm1 res is  tensor(0.1546, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.30314186215400696
distance x is tensor(155.9886, device='cuda:3')
benign distance is  tensor(155.9886, device='cuda:3')
norm1 res is  tensor(0.1631, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  1.009714126586914
distance x is tensor(146.7184, device='cuda:3')
benign distance is  tensor(146.7184, device='cuda:3')
norm1 res is  tensor(0.1525, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.46624869108200073
distance x is tensor(137.8001, device='cuda:3')
benign distance is  tensor(137.8001, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.20538334548473358
distance x is tensor(146.1622, device='cuda:3')
benign distance is  tensor(146.1622, device='cuda:3')
norm1 res is  tensor(0.1499, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.46769624948501587
distance x is tensor(155.2695, device='cuda:3')
benign distance is  tensor(155.2695, device='cuda:3')
norm1 res is  tensor(0.1590, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(140.1174, device='cuda:3')
compute distance is  tensor(140.1174, device='cuda:3')
compute norm is  tensor(51.0703, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9223, device='cuda:3')
compute distance is  tensor(142.9223, device='cuda:3')
compute norm is  tensor(51.1700, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.3746, device='cuda:3')
compute distance is  tensor(148.3746, device='cuda:3')
compute norm is  tensor(51.2983, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.5129, device='cuda:3')
compute distance is  tensor(161.5129, device='cuda:3')
compute norm is  tensor(51.4912, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.3416, device='cuda:3')
compute distance is  tensor(157.3416, device='cuda:3')
compute norm is  tensor(51.5430, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.3856, device='cuda:3')
compute distance is  tensor(141.3856, device='cuda:3')
compute norm is  tensor(51.1622, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.1253, device='cuda:3')
compute distance is  tensor(149.1253, device='cuda:3')
compute norm is  tensor(51.2675, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2377, device='cuda:3')
compute distance is  tensor(138.2377, device='cuda:3')
compute norm is  tensor(51.1337, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3018, device='cuda:3')
compute distance is  tensor(146.3018, device='cuda:3')
compute norm is  tensor(51.3599, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.5096, device='cuda:3')
compute distance is  tensor(152.5096, device='cuda:3')
compute norm is  tensor(51.3932, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.0043, device='cuda:3')
compute distance is  tensor(152.0043, device='cuda:3')
compute norm is  tensor(51.4047, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6341, device='cuda:3')
compute distance is  tensor(139.6341, device='cuda:3')
compute norm is  tensor(51.1437, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(161.5129, device='cuda:3')
distance x is tensor(107572.0859, device='cuda:3')
distance x is tensor(107572.0859, device='cuda:3')
________________________________
test distance is  tensor(107572.0859, device='cuda:3')
test distance1 is  tensor(107572.0859, device='cuda:3')
test similarity is  tensor(0.3983, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130120141573820.86
test entropy is  0.0
________________________________
cal ratio is  0.037973434162736214
distance x is tensor(4084.8875, device='cuda:3')
cal_distance is  tensor(4084.8875, device='cuda:3')
cal ratio is  0.19486759364164513
distance x is tensor(796.0162, device='cuda:3')
cal_distance is  tensor(796.0162, device='cuda:3')
cal ratio is  0.4414369858700014
distance x is tensor(351.3939, device='cuda:3')
cal_distance is  tensor(351.3939, device='cuda:3')
cal ratio is  0.6644045354086192
distance x is tensor(233.4694, device='cuda:3')
cal_distance is  tensor(233.4694, device='cuda:3')
cal ratio is  0.8151071942371695
distance x is tensor(190.3035, device='cuda:3')
cal_distance is  tensor(190.3035, device='cuda:3')
cal ratio is  0.9028306293482854
distance x is tensor(171.8123, device='cuda:3')
cal_distance is  tensor(171.8123, device='cuda:3')
cal ratio is  0.9501726030229417
distance x is tensor(163.2516, device='cuda:3')
cal_distance is  tensor(163.2516, device='cuda:3')
cal ratio is  0.9747672479189042
distance x is tensor(159.1325, device='cuda:3')
cal_distance is  tensor(159.1325, device='cuda:3')
distance x is tensor(159.1325, device='cuda:3')
return_distance is  tensor(159.1325, device='cuda:3')
distance x is tensor(159.1224, device='cuda:3')
distance x is tensor(159.1224, device='cuda:3')
________________________________
test distance is  tensor(159.1224, device='cuda:3')
test distance1 is  tensor(159.1224, device='cuda:3')
test similarity is  tensor(0.9606, device='cuda:3')
test acc is  0.10003333348966531
test loss is 286.82716540436246
test entropy is  2.1559091112434798e-05
________________________________
0
distance x is tensor(159.1224, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.490552758298082e-05
avg test loss is  286.39554931055
avg accuracy is  0.2828000001563391
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.9606, device='cuda:3')
compute_distance is  tensor(159.1224, device='cuda:3')
compute_norm is  tensor(54.5069, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.0121, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1895375887849438
avg test loss is  1.7227077238849486
avg accuracy is  0.4506000001563416
solo acc is  0.24360000015633798
compute similarity  is  tensor(0.9608, device='cuda:3')
compute_distance is  tensor(159.0121, device='cuda:3')
compute_norm is  tensor(55.3989, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.6804, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6792879987245938
avg test loss is  2.645944173656293
avg accuracy is  0.29008333348967263
solo acc is  0.10776666682299862
compute similarity  is  tensor(0.9607, device='cuda:3')
compute_distance is  tensor(159.6804, device='cuda:3')
compute_norm is  tensor(55.2894, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.5327, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0118882232891726
avg test loss is  1.5589355141369265
avg accuracy is  0.4342333334896748
solo acc is  0.2407166668230047
compute similarity  is  tensor(0.9614, device='cuda:3')
compute_distance is  tensor(159.5327, device='cuda:3')
compute_norm is  tensor(54.9968, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.6718, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6148537293171832
avg test loss is  2.4218682229900157
avg accuracy is  0.278150000156339
solo acc is  0.1050333334896653
compute similarity  is  tensor(0.9613, device='cuda:3')
compute_distance is  tensor(159.6718, device='cuda:3')
compute_norm is  tensor(54.8241, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.3310, device='cuda:3')
distance x is tensor(159.3310, device='cuda:3')
________________________________
test distance is  tensor(159.3310, device='cuda:3')
test distance1 is  tensor(159.3310, device='cuda:3')
test similarity is  tensor(0.9616, device='cuda:3')
test acc is  0.24430000015633804
test loss is 1.4645850493201316
test entropy is  0.9688016234049156
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3024684190750122
mal norm is  tensor(773.0890, device='cuda:3')
distance x is tensor(159.3398, device='cuda:3')
mal distance is  tensor(159.3398, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(21.2057, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.9358, device='cuda:3')
user_param_square tensor(120.3418, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(34.3181, device='cuda:3')
score : tensor(0.3222, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.5311, device='cuda:3')
user_param_square tensor(107.9500, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(121.4319, device='cuda:3')
score : tensor(1.1933, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.4788, device='cuda:3')
user_param_square tensor(110.6610, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(108.5229, device='cuda:3')
score : tensor(1.0642, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.6661, device='cuda:3')
user_param_square tensor(110.8704, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(125.5391, device='cuda:3')
score : tensor(1.2344, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.3416, device='cuda:3')
user_param_square tensor(111.1259, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(127.2163, device='cuda:3')
score : tensor(1.2512, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.3444, device='cuda:3')
user_param_square tensor(115.1559, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(111.1891, device='cuda:3')
score : tensor(1.0909, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.4207, device='cuda:3')
user_param_square tensor(111.3241, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(115.1253, device='cuda:3')
score : tensor(1.1302, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.9235, device='cuda:3')
user_param_square tensor(114.7481, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(12.1056, device='cuda:3')
score : tensor(0.1001, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.0890, device='cuda:3')
user_param_square tensor(128.0387, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(-151.6798, device='cuda:3')
score : tensor(-1.5378, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.8865, device='cuda:3')
user_param_square tensor(121.7390, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(144.2625, device='cuda:3')
score : tensor(1.4216, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8019, device='cuda:3')
user_param_square tensor(119.3568, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(156.0470, device='cuda:3')
score : tensor(1.5395, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.5938, device='cuda:3')
user_param_square tensor(118.8932, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(115.4102, device='cuda:3')
score : tensor(1.1331, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.7761, device='cuda:3')
user_param_square tensor(123.6308, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(199.7956, device='cuda:3')
score : tensor(1.9769, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.9011, device='cuda:3')
user_param_square tensor(118.6529, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(142.5720, device='cuda:3')
score : tensor(1.4047, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.3547, device='cuda:3')
user_param_square tensor(121.6927, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(150.8342, device='cuda:3')
score : tensor(1.4873, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.8313, device='cuda:3')
user_param_square tensor(120.5087, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(127.9983, device='cuda:3')
score : tensor(1.2590, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.0917, device='cuda:3')
user_param_square tensor(122.0179, device='cuda:3')
global_param_square tensor(21.2057, device='cuda:3')
part1 is  tensor(106.0255, device='cuda:3')
score : tensor(1.0392, device='cuda:3')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.55% 

Test Accuracy: 88.46% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5556851625442505
distance x is tensor(110.5299, device='cuda:3')
benign distance is  tensor(110.5299, device='cuda:3')
norm1 res is  tensor(0.1225, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.45346927642822266
distance x is tensor(136.4814, device='cuda:3')
benign distance is  tensor(136.4814, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.49746084213256836
distance x is tensor(127.0168, device='cuda:3')
benign distance is  tensor(127.0168, device='cuda:3')
norm1 res is  tensor(0.1343, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3581579327583313
distance x is tensor(109.6901, device='cuda:3')
benign distance is  tensor(109.6901, device='cuda:3')
norm1 res is  tensor(0.1188, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.8107759356498718
distance x is tensor(104.0540, device='cuda:3')
benign distance is  tensor(104.0540, device='cuda:3')
norm1 res is  tensor(0.1120, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5784364938735962
distance x is tensor(133.5039, device='cuda:3')
benign distance is  tensor(133.5039, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.38708943128585815
distance x is tensor(125.2903, device='cuda:3')
benign distance is  tensor(125.2903, device='cuda:3')
norm1 res is  tensor(0.1296, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.7634031176567078
distance x is tensor(130.1566, device='cuda:3')
benign distance is  tensor(130.1566, device='cuda:3')
norm1 res is  tensor(0.1419, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.810896098613739
distance x is tensor(138.2346, device='cuda:3')
benign distance is  tensor(138.2346, device='cuda:3')
norm1 res is  tensor(0.1503, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3030721843242645
distance x is tensor(140.3967, device='cuda:3')
benign distance is  tensor(140.3967, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.7990896105766296
distance x is tensor(135.9183, device='cuda:3')
benign distance is  tensor(135.9183, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.09585301578044891
distance x is tensor(132.6122, device='cuda:3')
benign distance is  tensor(132.6122, device='cuda:3')
norm1 res is  tensor(0.1399, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.7841753959655762
distance x is tensor(125.7513, device='cuda:3')
benign distance is  tensor(125.7513, device='cuda:3')
norm1 res is  tensor(0.1360, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.4129254221916199
distance x is tensor(126.0449, device='cuda:3')
benign distance is  tensor(126.0449, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.7202299237251282
distance x is tensor(123.1004, device='cuda:3')
benign distance is  tensor(123.1004, device='cuda:3')
norm1 res is  tensor(0.1304, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.2268344908952713
distance x is tensor(134.1466, device='cuda:3')
benign distance is  tensor(134.1466, device='cuda:3')
norm1 res is  tensor(0.1429, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(121.2196, device='cuda:3')
compute distance is  tensor(121.2196, device='cuda:3')
compute norm is  tensor(50.6568, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1261, device='cuda:3')
compute distance is  tensor(126.1261, device='cuda:3')
compute norm is  tensor(50.8427, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5060, device='cuda:3')
compute distance is  tensor(129.5060, device='cuda:3')
compute norm is  tensor(50.9915, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5846, device='cuda:3')
compute distance is  tensor(134.5846, device='cuda:3')
compute norm is  tensor(50.9302, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5597, device='cuda:3')
compute distance is  tensor(128.5597, device='cuda:3')
compute norm is  tensor(50.9492, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1751, device='cuda:3')
compute distance is  tensor(131.1751, device='cuda:3')
compute norm is  tensor(51.1046, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8360, device='cuda:3')
compute distance is  tensor(127.8360, device='cuda:3')
compute norm is  tensor(50.9863, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.0129, device='cuda:3')
compute distance is  tensor(131.0129, device='cuda:3')
compute norm is  tensor(50.9603, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6623, device='cuda:3')
compute distance is  tensor(129.6623, device='cuda:3')
compute norm is  tensor(50.9809, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9008, device='cuda:3')
compute distance is  tensor(130.9008, device='cuda:3')
compute norm is  tensor(50.9593, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3880, device='cuda:3')
compute distance is  tensor(133.3880, device='cuda:3')
compute norm is  tensor(51.1340, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7008, device='cuda:3')
compute distance is  tensor(121.7008, device='cuda:3')
compute norm is  tensor(50.9070, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(134.5846, device='cuda:3')
distance x is tensor(107607.9375, device='cuda:3')
distance x is tensor(107607.9375, device='cuda:3')
________________________________
test distance is  tensor(107607.9375, device='cuda:3')
test distance1 is  tensor(107607.9375, device='cuda:3')
test similarity is  tensor(0.3188, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129960791692512.89
test entropy is  0.0
________________________________
cal ratio is  0.03465784662390648
distance x is tensor(3729.4651, device='cuda:3')
cal_distance is  tensor(3729.4651, device='cuda:3')
cal ratio is  0.18616603536807938
distance x is tensor(694.3038, device='cuda:3')
cal_distance is  tensor(694.3038, device='cuda:3')
cal ratio is  0.43146834755878266
distance x is tensor(299.5731, device='cuda:3')
cal_distance is  tensor(299.5731, device='cuda:3')
cal ratio is  0.6568592847383347
distance x is tensor(196.7791, device='cuda:3')
cal_distance is  tensor(196.7791, device='cuda:3')
cal ratio is  0.8104650656427199
distance x is tensor(159.4835, device='cuda:3')
cal_distance is  tensor(159.4835, device='cuda:3')
cal ratio is  0.9002555844272248
distance x is tensor(143.5764, device='cuda:3')
cal_distance is  tensor(143.5764, device='cuda:3')
cal ratio is  0.9488162759266384
distance x is tensor(136.2279, device='cuda:3')
cal_distance is  tensor(136.2279, device='cuda:3')
cal ratio is  0.9740711241638021
distance x is tensor(132.6958, device='cuda:3')
cal_distance is  tensor(132.6958, device='cuda:3')
distance x is tensor(132.6958, device='cuda:3')
return_distance is  tensor(132.6958, device='cuda:3')
distance x is tensor(132.6857, device='cuda:3')
distance x is tensor(132.6857, device='cuda:3')
________________________________
test distance is  tensor(132.6857, device='cuda:3')
test distance1 is  tensor(132.6857, device='cuda:3')
test similarity is  tensor(0.9674, device='cuda:3')
test acc is  0.13465000015633188
test loss is 82.39480918607732
test entropy is  0.012425759809633253
________________________________
0
distance x is tensor(132.6857, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.012287436712083473
avg test loss is  82.11125239634565
avg accuracy is  0.8214333334896577
solo acc is  0.13596666682299857
compute similarity  is  tensor(0.9674, device='cuda:3')
compute_distance is  tensor(132.6857, device='cuda:3')
compute_norm is  tensor(53.1092, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(127.7118, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9287088573741507
avg test loss is  1.378945057453123
avg accuracy is  0.825216666822991
solo acc is  0.2965833334896728
compute similarity  is  tensor(0.9686, device='cuda:3')
compute_distance is  tensor(127.7118, device='cuda:3')
compute_norm is  tensor(52.9893, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.1866, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8833680537972115
avg test loss is  1.4362883236108304
avg accuracy is  0.8261500001563243
solo acc is  0.24868333348967148
compute similarity  is  tensor(0.9684, device='cuda:3')
compute_distance is  tensor(128.1866, device='cuda:3')
compute_norm is  tensor(52.7236, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.6171, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8722602988738241
avg test loss is  1.4289168161369845
avg accuracy is  0.8291833334896576
solo acc is  0.2402500001563379
compute similarity  is  tensor(0.9683, device='cuda:3')
compute_distance is  tensor(128.6171, device='cuda:3')
compute_norm is  tensor(52.4631, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.0472, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8610522879212141
avg test loss is  1.4105952448173882
avg accuracy is  0.8322500001563241
solo acc is  0.2423166668230047
compute similarity  is  tensor(0.9682, device='cuda:3')
compute_distance is  tensor(129.0472, device='cuda:3')
compute_norm is  tensor(52.2057, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.5272, device='cuda:3')
distance x is tensor(129.5272, device='cuda:3')
________________________________
test distance is  tensor(129.5272, device='cuda:3')
test distance1 is  tensor(129.5272, device='cuda:3')
test similarity is  tensor(0.9681, device='cuda:3')
test acc is  0.25233333348967163
test loss is 1.3771447344883672
test entropy is  0.8628788121473561
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1733109951019287
mal norm is  tensor(636.5365, device='cuda:3')
distance x is tensor(129.5362, device='cuda:3')
mal distance is  tensor(129.5362, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(20.6842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(474.8551, device='cuda:3')
user_param_square tensor(99.1060, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-9.0994, device='cuda:3')
score : tensor(-0.1115, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.8100, device='cuda:3')
user_param_square tensor(109.1337, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-1.4742, device='cuda:3')
score : tensor(-0.0352, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.4738, device='cuda:3')
user_param_square tensor(104.5517, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-36.4430, device='cuda:3')
score : tensor(-0.3849, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(468.0768, device='cuda:3')
user_param_square tensor(98.3961, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-13.9726, device='cuda:3')
score : tensor(-0.1602, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(443.2485, device='cuda:3')
user_param_square tensor(95.7509, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-80.1865, device='cuda:3')
score : tensor(-0.8223, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.3402, device='cuda:3')
user_param_square tensor(107.9455, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-36.2333, device='cuda:3')
score : tensor(-0.3828, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.6406, device='cuda:3')
user_param_square tensor(103.0740, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-7.9453, device='cuda:3')
score : tensor(-0.0999, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.9456, device='cuda:3')
user_param_square tensor(106.7514, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-14.8141, device='cuda:3')
score : tensor(-0.1686, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5365, device='cuda:3')
user_param_square tensor(114.7443, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(29.9592, device='cuda:3')
score : tensor(0.2791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.2271, device='cuda:3')
user_param_square tensor(109.5515, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(26.5297, device='cuda:3')
score : tensor(0.2448, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.1880, device='cuda:3')
user_param_square tensor(114.8030, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-46.7901, device='cuda:3')
score : tensor(-0.4884, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7101, device='cuda:3')
user_param_square tensor(112.8515, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(15.2964, device='cuda:3')
score : tensor(0.1325, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.6450, device='cuda:3')
user_param_square tensor(109.1181, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(20.6271, device='cuda:3')
score : tensor(0.1858, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.6857, device='cuda:3')
user_param_square tensor(108.7422, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(12.1640, device='cuda:3')
score : tensor(0.1012, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.9504, device='cuda:3')
user_param_square tensor(106.7519, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-13.5790, device='cuda:3')
score : tensor(-0.1563, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.6331, device='cuda:3')
user_param_square tensor(110.5295, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(41.9936, device='cuda:3')
score : tensor(0.3995, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.5463, device='cuda:3')
user_param_square tensor(111.8238, device='cuda:3')
global_param_square tensor(20.6842, device='cuda:3')
part1 is  tensor(-4.3771, device='cuda:3')
score : tensor(-0.0643, device='cuda:3')
len accept list 17
len all weights is 17
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 85.96% 

Test Accuracy: 84.88% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2453567087650299
distance x is tensor(150.6655, device='cuda:3')
benign distance is  tensor(150.6655, device='cuda:3')
norm1 res is  tensor(0.1571, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7029008269309998
distance x is tensor(147.8497, device='cuda:3')
benign distance is  tensor(147.8497, device='cuda:3')
norm1 res is  tensor(0.1548, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2480834424495697
distance x is tensor(144.5555, device='cuda:3')
benign distance is  tensor(144.5555, device='cuda:3')
norm1 res is  tensor(0.1482, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.9580527544021606
distance x is tensor(133.6055, device='cuda:3')
benign distance is  tensor(133.6055, device='cuda:3')
norm1 res is  tensor(0.1397, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3759825825691223
distance x is tensor(147.6750, device='cuda:3')
benign distance is  tensor(147.6750, device='cuda:3')
norm1 res is  tensor(0.1506, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.48167911171913147
distance x is tensor(153.8386, device='cuda:3')
benign distance is  tensor(153.8386, device='cuda:3')
norm1 res is  tensor(0.1600, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.3705884516239166
distance x is tensor(142.5390, device='cuda:3')
benign distance is  tensor(142.5390, device='cuda:3')
norm1 res is  tensor(0.1446, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3606930375099182
distance x is tensor(152.1677, device='cuda:3')
benign distance is  tensor(152.1677, device='cuda:3')
norm1 res is  tensor(0.1580, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.5665619969367981
distance x is tensor(148.8066, device='cuda:3')
benign distance is  tensor(148.8066, device='cuda:3')
norm1 res is  tensor(0.1526, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.3857434391975403
distance x is tensor(163.7844, device='cuda:3')
benign distance is  tensor(163.7844, device='cuda:3')
norm1 res is  tensor(0.1706, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.22206047177314758
distance x is tensor(154.4741, device='cuda:3')
benign distance is  tensor(154.4741, device='cuda:3')
norm1 res is  tensor(0.1592, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.3702555298805237
distance x is tensor(155.7709, device='cuda:3')
benign distance is  tensor(155.7709, device='cuda:3')
norm1 res is  tensor(0.1610, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.49261730909347534
distance x is tensor(145.3727, device='cuda:3')
benign distance is  tensor(145.3727, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5853347182273865
distance x is tensor(142.6797, device='cuda:3')
benign distance is  tensor(142.6797, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.3924318253993988
distance x is tensor(160.3938, device='cuda:3')
benign distance is  tensor(160.3938, device='cuda:3')
norm1 res is  tensor(0.1655, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.17237628996372223
distance x is tensor(154.3815, device='cuda:3')
benign distance is  tensor(154.3815, device='cuda:3')
norm1 res is  tensor(0.1595, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(136.7449, device='cuda:3')
compute distance is  tensor(136.7449, device='cuda:3')
compute norm is  tensor(52.0639, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7832, device='cuda:3')
compute distance is  tensor(132.7832, device='cuda:3')
compute norm is  tensor(51.9891, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.2616, device='cuda:3')
compute distance is  tensor(158.2616, device='cuda:3')
compute norm is  tensor(52.8339, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.8907, device='cuda:3')
compute distance is  tensor(145.8907, device='cuda:3')
compute norm is  tensor(52.3360, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.1375, device='cuda:3')
compute distance is  tensor(149.1375, device='cuda:3')
compute norm is  tensor(52.5397, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.4577, device='cuda:3')
compute distance is  tensor(156.4577, device='cuda:3')
compute norm is  tensor(52.6319, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.5983, device='cuda:3')
compute distance is  tensor(153.5983, device='cuda:3')
compute norm is  tensor(52.5220, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.2910, device='cuda:3')
compute distance is  tensor(161.2910, device='cuda:3')
compute norm is  tensor(52.7256, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.6835, device='cuda:3')
compute distance is  tensor(158.6835, device='cuda:3')
compute norm is  tensor(52.4764, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.5632, device='cuda:3')
compute distance is  tensor(157.5632, device='cuda:3')
compute norm is  tensor(52.7261, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.1832, device='cuda:3')
compute distance is  tensor(155.1832, device='cuda:3')
compute norm is  tensor(52.6399, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.7065, device='cuda:3')
compute distance is  tensor(154.7065, device='cuda:3')
compute norm is  tensor(52.5129, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(161.2910, device='cuda:3')
distance x is tensor(107558.1719, device='cuda:3')
distance x is tensor(107558.1719, device='cuda:3')
________________________________
test distance is  tensor(107558.1719, device='cuda:3')
test distance1 is  tensor(107558.1719, device='cuda:3')
test similarity is  tensor(0.4310, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130017618922288.58
test entropy is  0.0
________________________________
cal ratio is  0.03794979583391768
distance x is tensor(4081.8167, device='cuda:3')
cal_distance is  tensor(4081.8167, device='cuda:3')
cal ratio is  0.19480693194341486
distance x is tensor(795.1701, device='cuda:3')
cal_distance is  tensor(795.1701, device='cuda:3')
cal ratio is  0.4413682840409463
distance x is tensor(350.9657, device='cuda:3')
cal_distance is  tensor(350.9657, device='cuda:3')
cal ratio is  0.6643528381143053
distance x is tensor(233.1668, device='cuda:3')
cal_distance is  tensor(233.1668, device='cuda:3')
cal ratio is  0.815075450034676
distance x is tensor(190.0494, device='cuda:3')
cal_distance is  tensor(190.0494, device='cuda:3')
cal ratio is  0.9028130975960945
distance x is tensor(171.5796, device='cuda:3')
cal_distance is  tensor(171.5796, device='cuda:3')
cal ratio is  0.9501633853076717
distance x is tensor(163.0289, device='cuda:3')
cal_distance is  tensor(163.0289, device='cuda:3')
cal ratio is  0.9747624910913725
distance x is tensor(158.9146, device='cuda:3')
cal_distance is  tensor(158.9146, device='cuda:3')
distance x is tensor(158.9146, device='cuda:3')
return_distance is  tensor(158.9146, device='cuda:3')
distance x is tensor(158.9045, device='cuda:3')
distance x is tensor(158.9045, device='cuda:3')
________________________________
test distance is  tensor(158.9045, device='cuda:3')
test distance1 is  tensor(158.9045, device='cuda:3')
test similarity is  tensor(0.9645, device='cuda:3')
test acc is  0.1007333334896653
test loss is 246.19896935501586
test entropy is  0.0006066017137208845
________________________________
0
distance x is tensor(158.9045, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0005153900755578971
avg test loss is  245.93436843449118
avg accuracy is  0.37763333348967415
solo acc is  0.1008833334896653
compute similarity  is  tensor(0.9645, device='cuda:3')
compute_distance is  tensor(158.9045, device='cuda:3')
compute_norm is  tensor(55.9455, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(326.2452, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3036131837220588
avg test loss is  2.2385950088500977
avg accuracy is  0.13473333348966524
solo acc is  0.1318000001563319
compute similarity  is  tensor(0.9043, device='cuda:3')
compute_distance is  tensor(326.2452, device='cuda:3')
compute_norm is  tensor(64.2361, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(325.4397, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7428586349558475
avg test loss is  2.9511694521792156
avg accuracy is  0.11830000015633194
solo acc is  0.10120000015633197
compute similarity  is  tensor(0.9042, device='cuda:3')
compute_distance is  tensor(325.4397, device='cuda:3')
compute_norm is  tensor(64.0988, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(325.4820, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.1675526596335715
avg test loss is  1.9699115037663912
avg accuracy is  0.16073333348966737
solo acc is  0.16316666682300093
compute similarity  is  tensor(0.9040, device='cuda:3')
compute_distance is  tensor(325.4820, device='cuda:3')
compute_norm is  tensor(63.6189, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(324.4670, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6861786715257396
avg test loss is  2.7167964657740806
avg accuracy is  0.1344500001563319
solo acc is  0.10330000015633196
compute similarity  is  tensor(0.9039, device='cuda:3')
compute_distance is  tensor(324.4670, device='cuda:3')
compute_norm is  tensor(63.4303, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(324.0666, device='cuda:3')
distance x is tensor(324.0666, device='cuda:3')
________________________________
test distance is  tensor(324.0666, device='cuda:3')
test distance1 is  tensor(324.0666, device='cuda:3')
test similarity is  tensor(0.9038, device='cuda:3')
test acc is  0.17050000015633474
test loss is 1.8096202042565417
test entropy is  1.1303974848185012
________________________________
cal ratio is  0.6913755762138856
distance x is tensor(224.0548, device='cuda:3')
cal_distance is  tensor(224.0548, device='cuda:3')
cal ratio is  0.8314841702543517
distance x is tensor(186.2984, device='cuda:3')
cal_distance is  tensor(186.2984, device='cuda:3')
cal ratio is  0.9118567873055665
distance x is tensor(169.8776, device='cuda:3')
cal_distance is  tensor(169.8776, device='cuda:3')
cal ratio is  0.9549114707536656
distance x is tensor(162.2181, device='cuda:3')
cal_distance is  tensor(162.2181, device='cuda:3')
cal ratio is  0.9771954556181864
distance x is tensor(158.5189, device='cuda:3')
cal_distance is  tensor(158.5189, device='cuda:3')
distance x is tensor(158.5189, device='cuda:3')
return_distance is  tensor(158.5189, device='cuda:3')
distance x is tensor(158.5152, device='cuda:3')
distance x is tensor(158.5152, device='cuda:3')
________________________________
test distance is  tensor(158.5152, device='cuda:3')
test distance1 is  tensor(158.5152, device='cuda:3')
test similarity is  tensor(0.9713, device='cuda:3')
test acc is  0.18561666682300232
test loss is 2.4964424450514415
test entropy is  1.1004378639940005
________________________________
0
distance x is tensor(158.5152, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1018475932734353
avg test loss is  2.492095481358103
avg accuracy is  0.36355000015634065
solo acc is  0.18591666682300229
compute similarity  is  tensor(0.9713, device='cuda:3')
compute_distance is  tensor(158.5152, device='cuda:3')
compute_norm is  tensor(54.8513, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.5996, device='cuda:3')
exit early
distance x is tensor(159.5996, device='cuda:3')
distance x is tensor(159.5996, device='cuda:3')
________________________________
test distance is  tensor(159.5996, device='cuda:3')
test distance1 is  tensor(159.5996, device='cuda:3')
test similarity is  tensor(0.9711, device='cuda:3')
test acc is  0.10631666682299862
test loss is 2.4963281279179586
test entropy is  0.6609759621782851
________________________________
2
distance x is tensor(159.5996, device='cuda:3')
test distance 2 is  tensor(159.5996, device='cuda:3')
distance x is tensor(159.5996, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6608940706070043
avg test loss is  2.5047144419603002
avg accuracy is  0.26506666682300534
solo acc is  0.10630000015633195
compute similarity  is  tensor(0.9711, device='cuda:3')
compute_distance is  tensor(159.5996, device='cuda:3')
compute_norm is  tensor(54.6793, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.4762, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9577075771685603
avg test loss is  1.4625999205656397
avg accuracy is  0.4566500001563417
solo acc is  0.2649666668230054
compute similarity  is  tensor(0.9711, device='cuda:3')
compute_distance is  tensor(159.4762, device='cuda:3')
compute_norm is  tensor(54.3580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(159.4797, device='cuda:3')
________________________________
test distance is  tensor(159.4797, device='cuda:3')
test similarity is  tensor(0.9711, device='cuda:3')
test acc is  0.4575166668230084
test loss is 1.46369424875357
test entropy is  0.9578880552035659
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2585567235946655
mal norm is  tensor(611.6114, device='cuda:3')
distance x is tensor(159.4797, device='cuda:3')
mal distance is  tensor(159.4797, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(24.6142, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.8762, device='cuda:3')
user_param_square tensor(123.2231, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(204.9066, device='cuda:3')
score : tensor(2.0247, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9195, device='cuda:3')
user_param_square tensor(122.8272, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(145.0699, device='cuda:3')
score : tensor(1.4263, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.4561, device='cuda:3')
user_param_square tensor(120.2488, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(200.6666, device='cuda:3')
score : tensor(1.9823, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.1716, device='cuda:3')
user_param_square tensor(116.0526, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(179.5148, device='cuda:3')
score : tensor(1.7707, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.0884, device='cuda:3')
user_param_square tensor(120.1087, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(58.2075, device='cuda:3')
score : tensor(0.5577, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.3116, device='cuda:3')
user_param_square tensor(123.5657, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(106.2970, device='cuda:3')
score : tensor(1.0386, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.5789, device='cuda:3')
user_param_square tensor(118.0927, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(188.7357, device='cuda:3')
score : tensor(1.8629, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.8243, device='cuda:3')
user_param_square tensor(123.3177, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(134.3961, device='cuda:3')
score : tensor(1.3195, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6114, device='cuda:3')
user_param_square tensor(122.6961, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(-552.7513, device='cuda:3')
score : tensor(-5.5519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.5063, device='cuda:3')
user_param_square tensor(136.9981, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(152.3882, device='cuda:3')
score : tensor(1.4995, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.3068, device='cuda:3')
user_param_square tensor(134.3494, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(151.5828, device='cuda:3')
score : tensor(1.4914, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.9417, device='cuda:3')
user_param_square tensor(142.4966, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(176.5943, device='cuda:3')
score : tensor(1.7415, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.5801, device='cuda:3')
user_param_square tensor(136.4648, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(236.8519, device='cuda:3')
score : tensor(2.3441, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(775.4728, device='cuda:3')
user_param_square tensor(138.1581, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(96.6267, device='cuda:3')
score : tensor(0.9419, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(788.2508, device='cuda:3')
user_param_square tensor(139.2917, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(143.7995, device='cuda:3')
score : tensor(1.4136, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(748.4331, device='cuda:3')
user_param_square tensor(135.7280, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(159.0683, device='cuda:3')
score : tensor(1.5663, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(724.0729, device='cuda:3')
user_param_square tensor(133.5009, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(163.2804, device='cuda:3')
score : tensor(1.6084, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.6774, device='cuda:3')
user_param_square tensor(131.2327, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(126.2111, device='cuda:3')
score : tensor(1.2377, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.9183, device='cuda:3')
user_param_square tensor(130.6915, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(134.6348, device='cuda:3')
score : tensor(1.3219, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6638, device='cuda:3')
user_param_square tensor(128.8655, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(110.1045, device='cuda:3')
score : tensor(1.0766, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.7973, device='cuda:3')
user_param_square tensor(127.9198, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(192.5225, device='cuda:3')
score : tensor(1.9008, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.3892, device='cuda:3')
user_param_square tensor(126.0387, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(121.8847, device='cuda:3')
score : tensor(1.1944, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2902, device='cuda:3')
user_param_square tensor(125.8335, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(243.4311, device='cuda:3')
score : tensor(2.4099, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.3087, device='cuda:3')
user_param_square tensor(124.6562, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(181.0832, device='cuda:3')
score : tensor(1.7864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.4870, device='cuda:3')
user_param_square tensor(129.2301, device='cuda:3')
global_param_square tensor(24.6142, device='cuda:3')
part1 is  tensor(184.5533, device='cuda:3')
score : tensor(1.8211, device='cuda:3')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.45% 

Test Accuracy: 88.61% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
 benign loss is  0.48841649293899536
distance x is tensor(112.1438, device='cuda:3')
benign distance is  tensor(112.1438, device='cuda:3')
norm1 res is  tensor(0.1215, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7407105565071106
distance x is tensor(127.8789, device='cuda:3')
benign distance is  tensor(127.8789, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.25322118401527405
distance x is tensor(117.2052, device='cuda:3')
benign distance is  tensor(117.2052, device='cuda:3')
norm1 res is  tensor(0.1261, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5266600847244263
distance x is tensor(114.0437, device='cuda:3')
benign distance is  tensor(114.0437, device='cuda:3')
norm1 res is  tensor(0.1228, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.28766125440597534
distance x is tensor(123.9613, device='cuda:3')
benign distance is  tensor(123.9613, device='cuda:3')
norm1 res is  tensor(0.1315, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6198219656944275
distance x is tensor(130.1172, device='cuda:3')
benign distance is  tensor(130.1172, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.43853145837783813
distance x is tensor(103.6034, device='cuda:3')
benign distance is  tensor(103.6034, device='cuda:3')
norm1 res is  tensor(0.1095, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5264126062393188
distance x is tensor(131.1539, device='cuda:3')
benign distance is  tensor(131.1539, device='cuda:3')
norm1 res is  tensor(0.1425, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.18292996287345886
distance x is tensor(141.7154, device='cuda:3')
benign distance is  tensor(141.7154, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.1524994671344757
distance x is tensor(118.5342, device='cuda:3')
benign distance is  tensor(118.5342, device='cuda:3')
norm1 res is  tensor(0.1285, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.7862628698348999
distance x is tensor(120.6783, device='cuda:3')
benign distance is  tensor(120.6783, device='cuda:3')
norm1 res is  tensor(0.1278, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.3421396017074585
distance x is tensor(140.2672, device='cuda:3')
benign distance is  tensor(140.2672, device='cuda:3')
norm1 res is  tensor(0.1489, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  1.1534078121185303
distance x is tensor(123.1733, device='cuda:3')
benign distance is  tensor(123.1733, device='cuda:3')
norm1 res is  tensor(0.1367, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.276832640171051
distance x is tensor(128.5052, device='cuda:3')
benign distance is  tensor(128.5052, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.8241633176803589
distance x is tensor(120.9390, device='cuda:3')
benign distance is  tensor(120.9390, device='cuda:3')
norm1 res is  tensor(0.1319, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.43388351798057556
distance x is tensor(128.5268, device='cuda:3')
benign distance is  tensor(128.5268, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.20653752982616425
distance x is tensor(144.8872, device='cuda:3')
benign distance is  tensor(144.8872, device='cuda:3')
norm1 res is  tensor(0.1514, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.505977988243103
distance x is tensor(114.9536, device='cuda:3')
benign distance is  tensor(114.9536, device='cuda:3')
norm1 res is  tensor(0.1197, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.7845581769943237
distance x is tensor(140.5813, device='cuda:3')
benign distance is  tensor(140.5813, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.33217692375183105
distance x is tensor(139.9515, device='cuda:3')
benign distance is  tensor(139.9515, device='cuda:3')
norm1 res is  tensor(0.1533, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.7119042277336121
distance x is tensor(124.9895, device='cuda:3')
benign distance is  tensor(124.9895, device='cuda:3')
norm1 res is  tensor(0.1346, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.40408939123153687
distance x is tensor(133.3148, device='cuda:3')
benign distance is  tensor(133.3148, device='cuda:3')
norm1 res is  tensor(0.1431, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.1777397096157074
distance x is tensor(133.6599, device='cuda:3')
benign distance is  tensor(133.6599, device='cuda:3')
norm1 res is  tensor(0.1443, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.13848528265953064
distance x is tensor(122.9028, device='cuda:3')
benign distance is  tensor(122.9028, device='cuda:3')
norm1 res is  tensor(0.1333, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(123.1904, device='cuda:3')
compute distance is  tensor(123.1904, device='cuda:3')
compute norm is  tensor(51.4640, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.4683, device='cuda:3')
compute distance is  tensor(124.4683, device='cuda:3')
compute norm is  tensor(51.5425, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.0466, device='cuda:3')
compute distance is  tensor(145.0466, device='cuda:3')
compute norm is  tensor(52.0559, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7322, device='cuda:3')
compute distance is  tensor(132.7322, device='cuda:3')
compute norm is  tensor(51.7020, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9011, device='cuda:3')
compute distance is  tensor(124.9011, device='cuda:3')
compute norm is  tensor(51.3733, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.3042, device='cuda:3')
compute distance is  tensor(135.3042, device='cuda:3')
compute norm is  tensor(51.9426, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.1793, device='cuda:3')
compute distance is  tensor(121.1793, device='cuda:3')
compute norm is  tensor(51.5002, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7163, device='cuda:3')
compute distance is  tensor(131.7163, device='cuda:3')
compute norm is  tensor(51.6902, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.4804, device='cuda:3')
compute distance is  tensor(141.4804, device='cuda:3')
compute norm is  tensor(51.9006, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7802, device='cuda:3')
compute distance is  tensor(131.7802, device='cuda:3')
compute norm is  tensor(51.8562, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6048, device='cuda:3')
compute distance is  tensor(130.6048, device='cuda:3')
compute norm is  tensor(51.6485, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0945, device='cuda:3')
compute distance is  tensor(123.0945, device='cuda:3')
compute norm is  tensor(51.5823, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.0466, device='cuda:3')
distance x is tensor(107603.1250, device='cuda:3')
distance x is tensor(107603.1250, device='cuda:3')
________________________________
test distance is  tensor(107603.1250, device='cuda:3')
test distance1 is  tensor(107603.1250, device='cuda:3')
test similarity is  tensor(0.3349, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130080618870805.83
test entropy is  0.0
________________________________
cal ratio is  0.035980515960471464
distance x is tensor(3871.6216, device='cuda:3')
cal_distance is  tensor(3871.6216, device='cuda:3')
cal ratio is  0.18968517398272225
distance x is tensor(734.3933, device='cuda:3')
cal_distance is  tensor(734.3933, device='cuda:3')
cal ratio is  0.43552739776716376
distance x is tensor(319.8512, device='cuda:3')
cal_distance is  tensor(319.8512, device='cuda:3')
cal ratio is  0.6599420749557391
distance x is tensor(211.0851, device='cuda:3')
cal_distance is  tensor(211.0851, device='cuda:3')
cal ratio is  0.8123648021015067
distance x is tensor(171.4790, device='cuda:3')
cal_distance is  tensor(171.4790, device='cuda:3')
cal ratio is  0.9013103153823122
distance x is tensor(154.5563, device='cuda:3')
cal_distance is  tensor(154.5563, device='cuda:3')
cal ratio is  0.9493720153023348
distance x is tensor(146.7317, device='cuda:3')
cal_distance is  tensor(146.7317, device='cuda:3')
cal ratio is  0.9743564602236255
distance x is tensor(142.9691, device='cuda:3')
cal_distance is  tensor(142.9691, device='cuda:3')
distance x is tensor(142.9691, device='cuda:3')
return_distance is  tensor(142.9691, device='cuda:3')
distance x is tensor(142.9590, device='cuda:3')
distance x is tensor(142.9590, device='cuda:3')
________________________________
test distance is  tensor(142.9590, device='cuda:3')
test distance1 is  tensor(142.9590, device='cuda:3')
test similarity is  tensor(0.9646, device='cuda:3')
test acc is  0.13246666682299857
test loss is 102.97624156927503
test entropy is  0.011851150681048809
________________________________
0
distance x is tensor(142.9590, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.011746944502292259
avg test loss is  103.3031533328709
avg accuracy is  0.8065000001563252
solo acc is  0.13328333348966523
compute similarity  is  tensor(0.9646, device='cuda:3')
compute_distance is  tensor(142.9590, device='cuda:3')
compute_norm is  tensor(54.2361, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.7700, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0005788287755524
avg test loss is  1.472530404260672
avg accuracy is  0.7845000001563261
solo acc is  0.2691666668230055
compute similarity  is  tensor(0.9659, device='cuda:3')
compute_distance is  tensor(138.7700, device='cuda:3')
compute_norm is  tensor(54.3458, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(139.8637, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.610152877088803
avg test loss is  2.3266254827411954
avg accuracy is  0.7445500001563281
solo acc is  0.11025000015633195
compute similarity  is  tensor(0.9656, device='cuda:3')
compute_distance is  tensor(139.8637, device='cuda:3')
compute_norm is  tensor(54.1299, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.3718, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9443135042307473
avg test loss is  1.362001464819349
avg accuracy is  0.8005500001563254
solo acc is  0.2855000001563391
compute similarity  is  tensor(0.9658, device='cuda:3')
compute_distance is  tensor(139.3718, device='cuda:3')
compute_norm is  tensor(53.8447, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.7348, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8997608435306468
avg test loss is  1.4509565204953843
avg accuracy is  0.8005500001563254
solo acc is  0.2263833334896708
compute similarity  is  tensor(0.9656, device='cuda:3')
compute_distance is  tensor(139.7348, device='cuda:3')
compute_norm is  tensor(53.5926, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.0484, device='cuda:3')
distance x is tensor(140.0484, device='cuda:3')
________________________________
test distance is  tensor(140.0484, device='cuda:3')
test distance1 is  tensor(140.0484, device='cuda:3')
test similarity is  tensor(0.9655, device='cuda:3')
test acc is  0.22700000015633748
test loss is 1.438415986388477
test entropy is  0.8815606460769547
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.317903757095337
mal norm is  tensor(686.9284, device='cuda:3')
distance x is tensor(140.0575, device='cuda:3')
mal distance is  tensor(140.0575, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(21.7373, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(480.0284, device='cuda:3')
user_param_square tensor(102.1494, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(-17.4707, device='cuda:3')
score : tensor(-0.1962, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.6416, device='cuda:3')
user_param_square tensor(108.6073, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(-76.7587, device='cuda:3')
score : tensor(-0.7891, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(496.2096, device='cuda:3')
user_param_square tensor(103.8568, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(63.2924, device='cuda:3')
score : tensor(0.6114, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.6185, device='cuda:3')
user_param_square tensor(102.4246, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(-26.9483, device='cuda:3')
score : tensor(-0.2910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.3273, device='cuda:3')
user_param_square tensor(105.6330, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(-32.2928, device='cuda:3')
score : tensor(-0.3445, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.5862, device='cuda:3')
user_param_square tensor(109.1010, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(-56.7878, device='cuda:3')
score : tensor(-0.5894, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(426.1113, device='cuda:3')
user_param_square tensor(96.2419, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(20.2500, device='cuda:3')
score : tensor(0.1810, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.1860, device='cuda:3')
user_param_square tensor(109.1607, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(-38.3007, device='cuda:3')
score : tensor(-0.4045, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9284, device='cuda:3')
user_param_square tensor(122.1963, device='cuda:3')
global_param_square tensor(21.7373, device='cuda:3')
part1 is  tensor(40.0654, device='cuda:3')
score : tensor(0.3791, device='cuda:3')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 76.52% 

Test Accuracy: 76.04% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
 benign loss is  0.9790660738945007
distance x is tensor(161.3187, device='cuda:3')
benign distance is  tensor(161.3187, device='cuda:3')
norm1 res is  tensor(0.1677, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8506671786308289
distance x is tensor(168.8652, device='cuda:3')
benign distance is  tensor(168.8652, device='cuda:3')
norm1 res is  tensor(0.1711, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.26433292031288147
distance x is tensor(152.1297, device='cuda:3')
benign distance is  tensor(152.1297, device='cuda:3')
norm1 res is  tensor(0.1552, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7201684713363647
distance x is tensor(159.3198, device='cuda:3')
benign distance is  tensor(159.3198, device='cuda:3')
norm1 res is  tensor(0.1625, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5694929361343384
distance x is tensor(157.5465, device='cuda:3')
benign distance is  tensor(157.5465, device='cuda:3')
norm1 res is  tensor(0.1609, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7465846538543701
distance x is tensor(190.0298, device='cuda:3')
benign distance is  tensor(190.0298, device='cuda:3')
norm1 res is  tensor(0.1951, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.04961111396551132
distance x is tensor(161.2430, device='cuda:3')
benign distance is  tensor(161.2430, device='cuda:3')
norm1 res is  tensor(0.1602, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.33467891812324524
distance x is tensor(179.4729, device='cuda:3')
benign distance is  tensor(179.4729, device='cuda:3')
norm1 res is  tensor(0.1830, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(149.7278, device='cuda:3')
compute distance is  tensor(149.7278, device='cuda:3')
compute norm is  tensor(54.0613, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.4945, device='cuda:3')
compute distance is  tensor(160.4945, device='cuda:3')
compute norm is  tensor(54.2948, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.0807, device='cuda:3')
compute distance is  tensor(162.0807, device='cuda:3')
compute norm is  tensor(54.5672, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.7805, device='cuda:3')
compute distance is  tensor(160.7805, device='cuda:3')
compute norm is  tensor(54.2853, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.1839, device='cuda:3')
compute distance is  tensor(170.1839, device='cuda:3')
compute norm is  tensor(54.5825, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.0413, device='cuda:3')
compute distance is  tensor(169.0413, device='cuda:3')
compute norm is  tensor(54.7302, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.7667, device='cuda:3')
compute distance is  tensor(155.7667, device='cuda:3')
compute norm is  tensor(54.1687, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.7604, device='cuda:3')
compute distance is  tensor(147.7604, device='cuda:3')
compute norm is  tensor(54.1340, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.4299, device='cuda:3')
compute distance is  tensor(166.4299, device='cuda:3')
compute norm is  tensor(54.5582, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.1052, device='cuda:3')
compute distance is  tensor(175.1052, device='cuda:3')
compute norm is  tensor(54.9356, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7051, device='cuda:3')
compute distance is  tensor(158.7051, device='cuda:3')
compute norm is  tensor(54.4343, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.1406, device='cuda:3')
compute distance is  tensor(152.1406, device='cuda:3')
compute norm is  tensor(54.1516, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(175.1052, device='cuda:3')
distance x is tensor(107531.4141, device='cuda:3')
distance x is tensor(107531.4141, device='cuda:3')
________________________________
test distance is  tensor(107531.4141, device='cuda:3')
test distance1 is  tensor(107531.4141, device='cuda:3')
test similarity is  tensor(0.4873, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130130522583537.81
test entropy is  0.0
________________________________
cal ratio is  0.03954649062195485
distance x is tensor(4252.4961, device='cuda:3')
cal_distance is  tensor(4252.4961, device='cuda:3')
cal ratio is  0.19886285362024583
distance x is tensor(845.6675, device='cuda:3')
cal_distance is  tensor(845.6675, device='cuda:3')
cal ratio is  0.4459393694516983
distance x is tensor(377.1192, device='cuda:3')
cal_distance is  tensor(377.1192, device='cuda:3')
cal ratio is  0.6677844350109507
distance x is tensor(251.8360, device='cuda:3')
cal_distance is  tensor(251.8360, device='cuda:3')
cal ratio is  0.8171780447476712
distance x is tensor(205.7958, device='cuda:3')
cal_distance is  tensor(205.7958, device='cuda:3')
cal ratio is  0.9039769679491267
distance x is tensor(186.0352, device='cuda:3')
cal_distance is  tensor(186.0352, device='cuda:3')
cal ratio is  0.9507757171871093
distance x is tensor(176.8780, device='cuda:3')
cal_distance is  tensor(176.8780, device='cuda:3')
cal ratio is  0.9750765974083111
distance x is tensor(172.4697, device='cuda:3')
cal_distance is  tensor(172.4697, device='cuda:3')
distance x is tensor(172.4697, device='cuda:3')
return_distance is  tensor(172.4697, device='cuda:3')
distance x is tensor(172.4596, device='cuda:3')
distance x is tensor(172.4596, device='cuda:3')
________________________________
test distance is  tensor(172.4596, device='cuda:3')
test distance1 is  tensor(172.4596, device='cuda:3')
test similarity is  tensor(0.9658, device='cuda:3')
test acc is  0.12315000015633193
test loss is 155.21157414775922
test entropy is  0.013198457026438569
________________________________
0
distance x is tensor(172.4596, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.013838845574897231
avg test loss is  154.74429662903742
avg accuracy is  0.521866666823009
solo acc is  0.12011666682299861
compute similarity  is  tensor(0.9658, device='cuda:3')
compute_distance is  tensor(172.4596, device='cuda:3')
compute_norm is  tensor(58.7382, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.5696, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.040817631777924
avg test loss is  1.5849403970277132
avg accuracy is  0.31851666682300656
solo acc is  0.2386500001563378
compute similarity  is  tensor(0.9681, device='cuda:3')
compute_distance is  tensor(164.5696, device='cuda:3')
compute_norm is  tensor(59.1464, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.4074, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6261362328585277
avg test loss is  2.403603915975038
avg accuracy is  0.18248333348966878
solo acc is  0.10691666682299862
compute similarity  is  tensor(0.9682, device='cuda:3')
compute_distance is  tensor(164.4074, device='cuda:3')
compute_norm is  tensor(58.9574, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.6397, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9919527160333418
avg test loss is  1.4720529373774904
avg accuracy is  0.33328333348967343
solo acc is  0.2317166668230043
compute similarity  is  tensor(0.9685, device='cuda:3')
compute_distance is  tensor(163.6397, device='cuda:3')
compute_norm is  tensor(58.6526, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(163.6397, device='cuda:3')
distance x is tensor(163.6397, device='cuda:3')
________________________________
test distance is  tensor(163.6397, device='cuda:3')
test distance1 is  tensor(163.6397, device='cuda:3')
test similarity is  tensor(0.9685, device='cuda:3')
test acc is  0.23080000015633756
test loss is 1.4682472303732117
test entropy is  0.9925518746950479
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3810606002807617
mal norm is  tensor(832.2039, device='cuda:3')
distance x is tensor(163.6492, device='cuda:3')
mal distance is  tensor(163.6492, device='cuda:3')
len current grad  20
len all grad 52
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(32.5849, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.3487, device='cuda:3')
user_param_square tensor(146.2430, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(291.7446, device='cuda:3')
score : tensor(2.8851, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.5590, device='cuda:3')
user_param_square tensor(148.2579, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(120.3043, device='cuda:3')
score : tensor(1.1707, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.3174, device='cuda:3')
user_param_square tensor(140.9061, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(53.9272, device='cuda:3')
score : tensor(0.5069, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.0779, device='cuda:3')
user_param_square tensor(144.0801, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(203.8648, device='cuda:3')
score : tensor(2.0063, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.5041, device='cuda:3')
user_param_square tensor(144.4671, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(256.1265, device='cuda:3')
score : tensor(2.5289, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.2805, device='cuda:3')
user_param_square tensor(158.5309, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(289.3180, device='cuda:3')
score : tensor(2.8608, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.9276, device='cuda:3')
user_param_square tensor(142.3566, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(159.0339, device='cuda:3')
score : tensor(1.5580, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.5835, device='cuda:3')
user_param_square tensor(153.1258, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(219.1469, device='cuda:3')
score : tensor(2.1591, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.2039, device='cuda:3')
user_param_square tensor(164.6731, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(-182.3237, device='cuda:3')
score : tensor(-1.8556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(899.1207, device='cuda:3')
user_param_square tensor(171.1657, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(184.6845, device='cuda:3')
score : tensor(1.8145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(873.0757, device='cuda:3')
user_param_square tensor(168.6684, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(314.2940, device='cuda:3')
score : tensor(3.1106, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.7025, device='cuda:3')
user_param_square tensor(171.1259, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(222.2069, device='cuda:3')
score : tensor(2.1897, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.5574, device='cuda:3')
user_param_square tensor(173.2882, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(268.9529, device='cuda:3')
score : tensor(2.6571, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.2568, device='cuda:3')
user_param_square tensor(169.9369, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(244.4813, device='cuda:3')
score : tensor(2.4124, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(887.0123, device='cuda:3')
user_param_square tensor(170.0093, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(203.4837, device='cuda:3')
score : tensor(2.0025, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(912.7092, device='cuda:3')
user_param_square tensor(172.4543, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(205.1731, device='cuda:3')
score : tensor(2.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(976.8789, device='cuda:3')
user_param_square tensor(178.4137, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(163.6412, device='cuda:3')
score : tensor(1.6040, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(741.1741, device='cuda:3')
user_param_square tensor(155.4061, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(230.1549, device='cuda:3')
score : tensor(2.2692, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.6392, device='cuda:3')
user_param_square tensor(157.2264, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(264.2532, device='cuda:3')
score : tensor(2.6101, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(724.2047, device='cuda:3')
user_param_square tensor(153.6167, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(227.2416, device='cuda:3')
score : tensor(2.2400, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.2341, device='cuda:3')
user_param_square tensor(157.1844, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(162.8385, device='cuda:3')
score : tensor(1.5960, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.2348, device='cuda:3')
user_param_square tensor(153.5138, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(209.6774, device='cuda:3')
score : tensor(2.0644, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.7937, device='cuda:3')
user_param_square tensor(147.7333, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(228.7910, device='cuda:3')
score : tensor(2.2555, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.7996, device='cuda:3')
user_param_square tensor(151.5447, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(227.9878, device='cuda:3')
score : tensor(2.2475, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(740.7114, device='cuda:3')
user_param_square tensor(155.3576, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(258.7744, device='cuda:3')
score : tensor(2.5554, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.1777, device='cuda:3')
user_param_square tensor(147.6654, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(223.7389, device='cuda:3')
score : tensor(2.2050, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1779, device='cuda:3')
user_param_square tensor(153.2954, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(103.8994, device='cuda:3')
score : tensor(1.0066, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.2462, device='cuda:3')
user_param_square tensor(150.0805, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(271.4739, device='cuda:3')
score : tensor(2.6824, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.8652, device='cuda:3')
user_param_square tensor(150.4729, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(264.2596, device='cuda:3')
score : tensor(2.6102, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.6379, device='cuda:3')
user_param_square tensor(146.8311, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(191.2204, device='cuda:3')
score : tensor(1.8798, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.2344, device='cuda:3')
user_param_square tensor(144.0979, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(204.8280, device='cuda:3')
score : tensor(2.0159, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.6126, device='cuda:3')
user_param_square tensor(152.3823, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(192.1705, device='cuda:3')
score : tensor(1.8893, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.2642, device='cuda:3')
user_param_square tensor(149.5387, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(212.0316, device='cuda:3')
score : tensor(2.0879, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(784.4352, device='cuda:3')
user_param_square tensor(159.8772, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(159.9844, device='cuda:3')
score : tensor(1.5675, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.0052, device='cuda:3')
user_param_square tensor(152.5312, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(279.8722, device='cuda:3')
score : tensor(2.7663, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(716.5312, device='cuda:3')
user_param_square tensor(152.8007, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(193.6180, device='cuda:3')
score : tensor(1.9038, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(784.0663, device='cuda:3')
user_param_square tensor(159.8396, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(277.1099, device='cuda:3')
score : tensor(2.7387, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.5947, device='cuda:3')
user_param_square tensor(154.6094, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(198.8610, device='cuda:3')
score : tensor(1.9562, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(745.6500, device='cuda:3')
user_param_square tensor(155.8746, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(387.9651, device='cuda:3')
score : tensor(3.8473, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.7435, device='cuda:3')
user_param_square tensor(153.4617, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(331.5989, device='cuda:3')
score : tensor(3.2836, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(752.1877, device='cuda:3')
user_param_square tensor(156.5565, device='cuda:3')
global_param_square tensor(32.5849, device='cuda:3')
part1 is  tensor(262.5357, device='cuda:3')
score : tensor(2.5930, device='cuda:3')
accept
len accept list 40
len all weights is 40
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.28% 

Test Accuracy: 88.33% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2741107940673828
distance x is tensor(114.3252, device='cuda:3')
benign distance is  tensor(114.3252, device='cuda:3')
norm1 res is  tensor(0.1216, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8365516662597656
distance x is tensor(123.4851, device='cuda:3')
benign distance is  tensor(123.4851, device='cuda:3')
norm1 res is  tensor(0.1319, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.17287150025367737
distance x is tensor(121.7569, device='cuda:3')
benign distance is  tensor(121.7569, device='cuda:3')
norm1 res is  tensor(0.1291, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.2471713274717331
distance x is tensor(116.0700, device='cuda:3')
benign distance is  tensor(116.0700, device='cuda:3')
norm1 res is  tensor(0.1218, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.381075918674469
distance x is tensor(124.2044, device='cuda:3')
benign distance is  tensor(124.2044, device='cuda:3')
norm1 res is  tensor(0.1302, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.22290346026420593
distance x is tensor(133.0060, device='cuda:3')
benign distance is  tensor(133.0060, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.09490251541137695
distance x is tensor(105.4603, device='cuda:3')
benign distance is  tensor(105.4603, device='cuda:3')
norm1 res is  tensor(0.1081, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.4408380091190338
distance x is tensor(124.6332, device='cuda:3')
benign distance is  tensor(124.6332, device='cuda:3')
norm1 res is  tensor(0.1346, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.4635630249977112
distance x is tensor(140.9349, device='cuda:3')
benign distance is  tensor(140.9349, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.5519431829452515
distance x is tensor(135.2816, device='cuda:3')
benign distance is  tensor(135.2816, device='cuda:3')
norm1 res is  tensor(0.1451, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.38164442777633667
distance x is tensor(124.9167, device='cuda:3')
benign distance is  tensor(124.9167, device='cuda:3')
norm1 res is  tensor(0.1315, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.20883698761463165
distance x is tensor(139.3682, device='cuda:3')
benign distance is  tensor(139.3682, device='cuda:3')
norm1 res is  tensor(0.1484, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.9062156677246094
distance x is tensor(131.4134, device='cuda:3')
benign distance is  tensor(131.4134, device='cuda:3')
norm1 res is  tensor(0.1414, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.31263789534568787
distance x is tensor(140.0040, device='cuda:3')
benign distance is  tensor(140.0040, device='cuda:3')
norm1 res is  tensor(0.1481, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.7967413067817688
distance x is tensor(114.3466, device='cuda:3')
benign distance is  tensor(114.3466, device='cuda:3')
norm1 res is  tensor(0.1218, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  1.0379432439804077
distance x is tensor(130.6732, device='cuda:3')
benign distance is  tensor(130.6732, device='cuda:3')
norm1 res is  tensor(0.1401, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.29203957319259644
distance x is tensor(138.2216, device='cuda:3')
benign distance is  tensor(138.2216, device='cuda:3')
norm1 res is  tensor(0.1469, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.6514766812324524
distance x is tensor(136.5597, device='cuda:3')
benign distance is  tensor(136.5597, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.6490214467048645
distance x is tensor(125.9082, device='cuda:3')
benign distance is  tensor(125.9082, device='cuda:3')
norm1 res is  tensor(0.1339, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.30268678069114685
distance x is tensor(129.3266, device='cuda:3')
benign distance is  tensor(129.3266, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.4319666922092438
distance x is tensor(129.9839, device='cuda:3')
benign distance is  tensor(129.9839, device='cuda:3')
norm1 res is  tensor(0.1373, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.7953966856002808
distance x is tensor(127.1284, device='cuda:3')
benign distance is  tensor(127.1284, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.13367365300655365
distance x is tensor(131.0553, device='cuda:3')
benign distance is  tensor(131.0553, device='cuda:3')
norm1 res is  tensor(0.1371, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.7825256586074829
distance x is tensor(131.5542, device='cuda:3')
benign distance is  tensor(131.5542, device='cuda:3')
norm1 res is  tensor(0.1360, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.2840629518032074
distance x is tensor(126.2838, device='cuda:3')
benign distance is  tensor(126.2838, device='cuda:3')
norm1 res is  tensor(0.1334, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.06808140873908997
distance x is tensor(129.5924, device='cuda:3')
benign distance is  tensor(129.5924, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.7160691618919373
distance x is tensor(137.4641, device='cuda:3')
benign distance is  tensor(137.4641, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.2916724979877472
distance x is tensor(134.3804, device='cuda:3')
benign distance is  tensor(134.3804, device='cuda:3')
norm1 res is  tensor(0.1464, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.27693459391593933
distance x is tensor(133.4040, device='cuda:3')
benign distance is  tensor(133.4040, device='cuda:3')
norm1 res is  tensor(0.1422, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.4531852602958679
distance x is tensor(124.4280, device='cuda:3')
benign distance is  tensor(124.4280, device='cuda:3')
norm1 res is  tensor(0.1310, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.44860416650772095
distance x is tensor(126.2682, device='cuda:3')
benign distance is  tensor(126.2682, device='cuda:3')
norm1 res is  tensor(0.1329, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.4318188726902008
distance x is tensor(133.7595, device='cuda:3')
benign distance is  tensor(133.7595, device='cuda:3')
norm1 res is  tensor(0.1394, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.6037616729736328
distance x is tensor(131.3941, device='cuda:3')
benign distance is  tensor(131.3941, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.5819768309593201
distance x is tensor(129.6680, device='cuda:3')
benign distance is  tensor(129.6680, device='cuda:3')
norm1 res is  tensor(0.1354, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.1711304485797882
distance x is tensor(133.8240, device='cuda:3')
benign distance is  tensor(133.8240, device='cuda:3')
norm1 res is  tensor(0.1420, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.2429123818874359
distance x is tensor(129.2651, device='cuda:3')
benign distance is  tensor(129.2651, device='cuda:3')
norm1 res is  tensor(0.1415, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.1410965621471405
distance x is tensor(126.6981, device='cuda:3')
benign distance is  tensor(126.6981, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.9149037599563599
distance x is tensor(134.8130, device='cuda:3')
benign distance is  tensor(134.8130, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.8997031450271606
distance x is tensor(135.0990, device='cuda:3')
benign distance is  tensor(135.0990, device='cuda:3')
norm1 res is  tensor(0.1429, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.28305548429489136
distance x is tensor(141.5896, device='cuda:3')
benign distance is  tensor(141.5896, device='cuda:3')
norm1 res is  tensor(0.1503, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(125.7502, device='cuda:3')
compute distance is  tensor(125.7502, device='cuda:3')
compute norm is  tensor(52.5196, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5671, device='cuda:3')
compute distance is  tensor(125.5671, device='cuda:3')
compute norm is  tensor(52.4135, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5148, device='cuda:3')
compute distance is  tensor(139.5148, device='cuda:3')
compute norm is  tensor(52.7805, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1615, device='cuda:3')
compute distance is  tensor(134.1615, device='cuda:3')
compute norm is  tensor(52.5709, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7114, device='cuda:3')
compute distance is  tensor(133.7114, device='cuda:3')
compute norm is  tensor(52.7735, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9191, device='cuda:3')
compute distance is  tensor(135.9191, device='cuda:3')
compute norm is  tensor(52.7416, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.9192, device='cuda:3')
compute distance is  tensor(122.9192, device='cuda:3')
compute norm is  tensor(52.3350, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.2217, device='cuda:3')
compute distance is  tensor(131.2217, device='cuda:3')
compute norm is  tensor(52.4946, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.9314, device='cuda:3')
compute distance is  tensor(147.9314, device='cuda:3')
compute norm is  tensor(52.8508, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7279, device='cuda:3')
compute distance is  tensor(123.7279, device='cuda:3')
compute norm is  tensor(52.4851, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8828, device='cuda:3')
compute distance is  tensor(128.8828, device='cuda:3')
compute norm is  tensor(52.6678, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5310, device='cuda:3')
compute distance is  tensor(127.5310, device='cuda:3')
compute norm is  tensor(52.4901, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.9314, device='cuda:3')
distance x is tensor(107585.4766, device='cuda:3')
distance x is tensor(107585.4766, device='cuda:3')
________________________________
test distance is  tensor(107585.4766, device='cuda:3')
test distance1 is  tensor(107585.4766, device='cuda:3')
test similarity is  tensor(0.3811, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130146799970858.58
test entropy is  0.0
________________________________
cal ratio is  0.03633953862962725
distance x is tensor(3909.6123, device='cuda:3')
cal_distance is  tensor(3909.6123, device='cuda:3')
cal ratio is  0.19062917823589967
distance x is tensor(745.2903, device='cuda:3')
cal_distance is  tensor(745.2903, device='cuda:3')
cal ratio is  0.4366098307208652
distance x is tensor(325.4039, device='cuda:3')
cal_distance is  tensor(325.4039, device='cuda:3')
cal ratio is  0.6607616842732814
distance x is tensor(215.0161, device='cuda:3')
cal_distance is  tensor(215.0161, device='cuda:3')
cal ratio is  0.8128692542900634
distance x is tensor(174.7810, device='cuda:3')
cal_distance is  tensor(174.7810, device='cuda:3')
cal ratio is  0.901590138942239
distance x is tensor(157.5813, device='cuda:3')
cal_distance is  tensor(157.5813, device='cuda:3')
cal ratio is  0.9495194300646698
distance x is tensor(149.6268, device='cuda:3')
cal_distance is  tensor(149.6268, device='cuda:3')
cal ratio is  0.9744320403012109
distance x is tensor(145.8013, device='cuda:3')
cal_distance is  tensor(145.8013, device='cuda:3')
distance x is tensor(145.8013, device='cuda:3')
return_distance is  tensor(145.8013, device='cuda:3')
distance x is tensor(145.7912, device='cuda:3')
distance x is tensor(145.7912, device='cuda:3')
________________________________
test distance is  tensor(145.7912, device='cuda:3')
test distance1 is  tensor(145.7912, device='cuda:3')
test similarity is  tensor(0.9670, device='cuda:3')
test acc is  0.18076666682300205
test loss is 69.66818801375595
test entropy is  0.02479862373779346
________________________________
0
distance x is tensor(145.7912, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.026328130564133915
avg test loss is  69.75961019845406
avg accuracy is  0.8545166668229898
solo acc is  0.1827333334896688
compute similarity  is  tensor(0.9670, device='cuda:3')
compute_distance is  tensor(145.7912, device='cuda:3')
compute_norm is  tensor(55.5350, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.0596, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9277193277502365
avg test loss is  1.3369346269285247
avg accuracy is  0.8104666668229917
solo acc is  0.3101333334896731
compute similarity  is  tensor(0.9683, device='cuda:3')
compute_distance is  tensor(139.0596, device='cuda:3')
compute_norm is  tensor(55.4041, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.4456, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8721509735975692
avg test loss is  1.4299533559061062
avg accuracy is  0.8096666668229916
solo acc is  0.2483833334896715
compute similarity  is  tensor(0.9681, device='cuda:3')
compute_distance is  tensor(139.4456, device='cuda:3')
compute_norm is  tensor(55.1291, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.6803, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.861095161135517
avg test loss is  1.4125677099360077
avg accuracy is  0.8130166668229915
solo acc is  0.24658333348967154
compute similarity  is  tensor(0.9680, device='cuda:3')
compute_distance is  tensor(139.6803, device='cuda:3')
compute_norm is  tensor(54.8566, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.9531, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8541780675906362
avg test loss is  1.390624504480789
avg accuracy is  0.8149166668229915
solo acc is  0.2480666668230048
compute similarity  is  tensor(0.9679, device='cuda:3')
compute_distance is  tensor(139.9531, device='cuda:3')
compute_norm is  tensor(54.5881, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.2119, device='cuda:3')
distance x is tensor(140.2119, device='cuda:3')
________________________________
test distance is  tensor(140.2119, device='cuda:3')
test distance1 is  tensor(140.2119, device='cuda:3')
test similarity is  tensor(0.9678, device='cuda:3')
test acc is  0.24516666682300473
test loss is 1.3723453890794375
test entropy is  0.8569297326017798
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.368699073791504
mal norm is  tensor(696.1537, device='cuda:3')
distance x is tensor(140.2212, device='cuda:3')
mal distance is  tensor(140.2212, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(15.7941, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.9574, device='cuda:3')
user_param_square tensor(86.8843, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(2.4794, device='cuda:3')
score : tensor(0.0092, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.5856, device='cuda:3')
user_param_square tensor(90.7632, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(1.3003, device='cuda:3')
score : tensor(-0.0026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.3270, device='cuda:3')
user_param_square tensor(89.5140, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(18.9992, device='cuda:3')
score : tensor(0.1744, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(479.7665, device='cuda:3')
user_param_square tensor(87.0486, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(20.9697, device='cuda:3')
score : tensor(0.1941, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.9525, device='cuda:3')
user_param_square tensor(89.5691, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(12.6812, device='cuda:3')
score : tensor(0.1112, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.8945, device='cuda:3')
user_param_square tensor(93.9532, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(2.2265, device='cuda:3')
score : tensor(0.0067, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(426.9535, device='cuda:3')
user_param_square tensor(82.1178, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(44.6048, device='cuda:3')
score : tensor(0.4305, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.7573, device='cuda:3')
user_param_square tensor(91.7300, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(26.3260, device='cuda:3')
score : tensor(0.2477, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.1537, device='cuda:3')
user_param_square tensor(104.8575, device='cuda:3')
global_param_square tensor(15.7941, device='cuda:3')
part1 is  tensor(-38.8479, device='cuda:3')
score : tensor(-0.4041, device='cuda:3')
len accept list 7
len all weights is 7
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 89.66% 

Test Accuracy: 88.66% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3119107484817505
distance x is tensor(122.3396, device='cuda:3')
benign distance is  tensor(122.3396, device='cuda:3')
norm1 res is  tensor(0.1334, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4225112795829773
distance x is tensor(132.9112, device='cuda:3')
benign distance is  tensor(132.9112, device='cuda:3')
norm1 res is  tensor(0.1431, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.08273985236883163
distance x is tensor(110.5648, device='cuda:3')
benign distance is  tensor(110.5648, device='cuda:3')
norm1 res is  tensor(0.1192, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3883323073387146
distance x is tensor(115.0378, device='cuda:3')
benign distance is  tensor(115.0378, device='cuda:3')
norm1 res is  tensor(0.1222, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.8987706899642944
distance x is tensor(100.6509, device='cuda:3')
benign distance is  tensor(100.6509, device='cuda:3')
norm1 res is  tensor(0.1111, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.347000241279602
distance x is tensor(133.1111, device='cuda:3')
benign distance is  tensor(133.1111, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.44468507170677185
distance x is tensor(103.8835, device='cuda:3')
benign distance is  tensor(103.8835, device='cuda:3')
norm1 res is  tensor(0.1117, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5157416462898254
distance x is tensor(139.4542, device='cuda:3')
benign distance is  tensor(139.4542, device='cuda:3')
norm1 res is  tensor(0.1457, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(131.1503, device='cuda:3')
compute distance is  tensor(131.1503, device='cuda:3')
compute norm is  tensor(53.0052, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9693, device='cuda:3')
compute distance is  tensor(125.9693, device='cuda:3')
compute norm is  tensor(52.9995, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.4883, device='cuda:3')
compute distance is  tensor(138.4883, device='cuda:3')
compute norm is  tensor(53.3608, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1267, device='cuda:3')
compute distance is  tensor(142.1267, device='cuda:3')
compute norm is  tensor(53.3714, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.0493, device='cuda:3')
compute distance is  tensor(131.0493, device='cuda:3')
compute norm is  tensor(53.2251, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9370, device='cuda:3')
compute distance is  tensor(132.9370, device='cuda:3')
compute norm is  tensor(53.2263, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0310, device='cuda:3')
compute distance is  tensor(123.0310, device='cuda:3')
compute norm is  tensor(53.0188, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.9105, device='cuda:3')
compute distance is  tensor(134.9105, device='cuda:3')
compute norm is  tensor(53.1988, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.7568, device='cuda:3')
compute distance is  tensor(141.7568, device='cuda:3')
compute norm is  tensor(53.2928, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.2248, device='cuda:3')
compute distance is  tensor(144.2248, device='cuda:3')
compute norm is  tensor(53.3971, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7021, device='cuda:3')
compute distance is  tensor(146.7021, device='cuda:3')
compute norm is  tensor(53.5911, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7947, device='cuda:3')
compute distance is  tensor(131.7947, device='cuda:3')
compute norm is  tensor(53.1838, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(146.7021, device='cuda:3')
distance x is tensor(107592.9688, device='cuda:3')
distance x is tensor(107592.9688, device='cuda:3')
________________________________
test distance is  tensor(107592.9688, device='cuda:3')
test distance1 is  tensor(107592.9688, device='cuda:3')
test similarity is  tensor(0.3633, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130022537499418.75
test entropy is  0.0
________________________________
cal ratio is  0.03618697791431191
distance x is tensor(3893.4697, device='cuda:3')
cal_distance is  tensor(3893.4697, device='cuda:3')
cal ratio is  0.19022862852609362
distance x is tensor(740.6536, device='cuda:3')
cal_distance is  tensor(740.6536, device='cuda:3')
cal ratio is  0.4361508324706125
distance x is tensor(323.0395, device='cuda:3')
cal_distance is  tensor(323.0395, device='cuda:3')
cal ratio is  0.6604142780100307
distance x is tensor(213.3416, device='cuda:3')
cal_distance is  tensor(213.3416, device='cuda:3')
cal ratio is  0.812655458616793
distance x is tensor(173.3742, device='cuda:3')
cal_distance is  tensor(173.3742, device='cuda:3')
cal ratio is  0.9014715904666885
distance x is tensor(156.2924, device='cuda:3')
cal_distance is  tensor(156.2924, device='cuda:3')
cal ratio is  0.9494570604360646
distance x is tensor(148.3932, device='cuda:3')
cal_distance is  tensor(148.3932, device='cuda:3')
cal ratio is  0.9744000230283569
distance x is tensor(144.5945, device='cuda:3')
cal_distance is  tensor(144.5945, device='cuda:3')
distance x is tensor(144.5945, device='cuda:3')
return_distance is  tensor(144.5945, device='cuda:3')
distance x is tensor(144.5844, device='cuda:3')
distance x is tensor(144.5844, device='cuda:3')
________________________________
test distance is  tensor(144.5844, device='cuda:3')
test distance1 is  tensor(144.5844, device='cuda:3')
test similarity is  tensor(0.9673, device='cuda:3')
test acc is  0.1351000001563319
test loss is 117.2323999872594
test entropy is  0.010270042521286101
________________________________
0
distance x is tensor(144.5844, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.010137216188638587
avg test loss is  117.78665766278817
avg accuracy is  0.8025500001563253
solo acc is  0.13501666682299857
compute similarity  is  tensor(0.9673, device='cuda:3')
compute_distance is  tensor(144.5844, device='cuda:3')
compute_norm is  tensor(56.0073, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.0141, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0391089801849334
avg test loss is  1.526366366760563
avg accuracy is  0.7768500001563265
solo acc is  0.26380000015633864
compute similarity  is  tensor(0.9679, device='cuda:3')
compute_distance is  tensor(142.0141, device='cuda:3')
compute_norm is  tensor(56.1608, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(143.3790, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.61178370052055
avg test loss is  2.3909971547533453
avg accuracy is  0.7308333334896622
solo acc is  0.11420000015633194
compute similarity  is  tensor(0.9675, device='cuda:3')
compute_distance is  tensor(143.3790, device='cuda:3')
compute_norm is  tensor(55.9595, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.7631, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9608977273710246
avg test loss is  1.4105251863567052
avg accuracy is  0.7937166668229925
solo acc is  0.2719833334896722
compute similarity  is  tensor(0.9678, device='cuda:3')
compute_distance is  tensor(142.7631, device='cuda:3')
compute_norm is  tensor(55.6541, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(142.7631, device='cuda:3')
distance x is tensor(142.7631, device='cuda:3')
________________________________
test distance is  tensor(142.7631, device='cuda:3')
test distance1 is  tensor(142.7631, device='cuda:3')
test similarity is  tensor(0.9678, device='cuda:3')
test acc is  0.26960000015633884
test loss is 1.4130817368340645
test entropy is  0.9601645212310718
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3323400020599365
mal norm is  tensor(710.5748, device='cuda:3')
distance x is tensor(142.7722, device='cuda:3')
mal distance is  tensor(142.7722, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(19.7168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(526.6608, device='cuda:3')
user_param_square tensor(101.9022, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-1.1184, device='cuda:3')
score : tensor(-0.0307, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.4162, device='cuda:3')
user_param_square tensor(104.9294, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(19.3978, device='cuda:3')
score : tensor(0.1745, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.4428, device='cuda:3')
user_param_square tensor(95.7969, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(42.2978, device='cuda:3')
score : tensor(0.4035, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(473.1796, device='cuda:3')
user_param_square tensor(96.5898, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(21.1117, device='cuda:3')
score : tensor(0.1916, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(425.5461, device='cuda:3')
user_param_square tensor(91.5992, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(16.6077, device='cuda:3')
score : tensor(0.1466, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.8908, device='cuda:3')
user_param_square tensor(105.4425, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-6.9889, device='cuda:3')
score : tensor(-0.0894, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(435.8484, device='cuda:3')
user_param_square tensor(92.7013, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-19.2642, device='cuda:3')
score : tensor(-0.2122, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.0992, device='cuda:3')
user_param_square tensor(106.5778, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-16.4531, device='cuda:3')
score : tensor(-0.1840, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5748, device='cuda:3')
user_param_square tensor(118.3649, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(25.5063, device='cuda:3')
score : tensor(0.2355, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.1593, device='cuda:3')
user_param_square tensor(111.9957, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(67.6573, device='cuda:3')
score : tensor(0.6571, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.6774, device='cuda:3')
user_param_square tensor(101.2244, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-8.3249, device='cuda:3')
score : tensor(-0.1028, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.4454, device='cuda:3')
user_param_square tensor(111.3146, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-32.2493, device='cuda:3')
score : tensor(-0.3420, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.8466, device='cuda:3')
user_param_square tensor(110.5504, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(18.1293, device='cuda:3')
score : tensor(0.1618, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.8054, device='cuda:3')
user_param_square tensor(106.1799, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-76.3137, device='cuda:3')
score : tensor(-0.7827, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.7944, device='cuda:3')
user_param_square tensor(108.5661, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-17.2692, device='cuda:3')
score : tensor(-0.1922, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.8786, device='cuda:3')
user_param_square tensor(109.6579, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(21.5270, device='cuda:3')
score : tensor(0.1958, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.3648, device='cuda:3')
user_param_square tensor(105.7668, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(57.0197, device='cuda:3')
score : tensor(0.5507, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.4587, device='cuda:3')
user_param_square tensor(109.1696, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(13.6922, device='cuda:3')
score : tensor(0.1174, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.8160, device='cuda:3')
user_param_square tensor(106.9211, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-29.8589, device='cuda:3')
score : tensor(-0.3181, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.5587, device='cuda:3')
user_param_square tensor(102.8553, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-3.0176, device='cuda:3')
score : tensor(-0.0497, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.0392, device='cuda:3')
user_param_square tensor(108.8603, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-5.8003, device='cuda:3')
score : tensor(-0.0775, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.3518, device='cuda:3')
user_param_square tensor(106.0449, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-42.2393, device='cuda:3')
score : tensor(-0.4419, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.3636, device='cuda:3')
user_param_square tensor(108.2541, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(2.9049, device='cuda:3')
score : tensor(0.0095, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.3979, device='cuda:3')
user_param_square tensor(99.1303, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-15.3115, device='cuda:3')
score : tensor(-0.1726, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.8362, device='cuda:3')
user_param_square tensor(104.7809, device='cuda:3')
global_param_square tensor(19.7168, device='cuda:3')
part1 is  tensor(-30.0838, device='cuda:3')
score : tensor(-0.3204, device='cuda:3')
len accept list 22
len all weights is 22
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 86.23% 

Test Accuracy: 85.39% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6286389827728271
distance x is tensor(142.9791, device='cuda:3')
benign distance is  tensor(142.9791, device='cuda:3')
norm1 res is  tensor(0.1587, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3868896961212158
distance x is tensor(149.0619, device='cuda:3')
benign distance is  tensor(149.0619, device='cuda:3')
norm1 res is  tensor(0.1581, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.23403720557689667
distance x is tensor(140.8382, device='cuda:3')
benign distance is  tensor(140.8382, device='cuda:3')
norm1 res is  tensor(0.1465, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6172071695327759
distance x is tensor(130.3209, device='cuda:3')
benign distance is  tensor(130.3209, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.9689777493476868
distance x is tensor(140.9371, device='cuda:3')
benign distance is  tensor(140.9371, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8717340230941772
distance x is tensor(150.4517, device='cuda:3')
benign distance is  tensor(150.4517, device='cuda:3')
norm1 res is  tensor(0.1564, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.17612604796886444
distance x is tensor(127.4166, device='cuda:3')
benign distance is  tensor(127.4166, device='cuda:3')
norm1 res is  tensor(0.1284, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3936004042625427
distance x is tensor(137.8205, device='cuda:3')
benign distance is  tensor(137.8205, device='cuda:3')
norm1 res is  tensor(0.1431, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.30819886922836304
distance x is tensor(159.6674, device='cuda:3')
benign distance is  tensor(159.6674, device='cuda:3')
norm1 res is  tensor(0.1669, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.7391102910041809
distance x is tensor(145.5363, device='cuda:3')
benign distance is  tensor(145.5363, device='cuda:3')
norm1 res is  tensor(0.1531, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.733176589012146
distance x is tensor(141.1918, device='cuda:3')
benign distance is  tensor(141.1918, device='cuda:3')
norm1 res is  tensor(0.1437, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6309643387794495
distance x is tensor(163.3412, device='cuda:3')
benign distance is  tensor(163.3412, device='cuda:3')
norm1 res is  tensor(0.1663, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.566546618938446
distance x is tensor(150.8602, device='cuda:3')
benign distance is  tensor(150.8602, device='cuda:3')
norm1 res is  tensor(0.1573, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.5863181948661804
distance x is tensor(147.1635, device='cuda:3')
benign distance is  tensor(147.1635, device='cuda:3')
norm1 res is  tensor(0.1519, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.49999532103538513
distance x is tensor(146.1955, device='cuda:3')
benign distance is  tensor(146.1955, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  1.0399165153503418
distance x is tensor(144.0361, device='cuda:3')
benign distance is  tensor(144.0361, device='cuda:3')
norm1 res is  tensor(0.1518, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.05407319217920303
distance x is tensor(154.2074, device='cuda:3')
benign distance is  tensor(154.2074, device='cuda:3')
norm1 res is  tensor(0.1583, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.8259049654006958
distance x is tensor(137.8030, device='cuda:3')
benign distance is  tensor(137.8030, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.7697309255599976
distance x is tensor(148.8055, device='cuda:3')
benign distance is  tensor(148.8055, device='cuda:3')
norm1 res is  tensor(0.1577, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.17147289216518402
distance x is tensor(157.7215, device='cuda:3')
benign distance is  tensor(157.7215, device='cuda:3')
norm1 res is  tensor(0.1584, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.5012355446815491
distance x is tensor(146.2988, device='cuda:3')
benign distance is  tensor(146.2988, device='cuda:3')
norm1 res is  tensor(0.1535, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.5493623614311218
distance x is tensor(145.3899, device='cuda:3')
benign distance is  tensor(145.3899, device='cuda:3')
norm1 res is  tensor(0.1519, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.23159757256507874
distance x is tensor(143.3708, device='cuda:3')
benign distance is  tensor(143.3708, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.4598100781440735
distance x is tensor(149.4648, device='cuda:3')
benign distance is  tensor(149.4648, device='cuda:3')
norm1 res is  tensor(0.1569, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(144.1285, device='cuda:3')
compute distance is  tensor(144.1285, device='cuda:3')
compute norm is  tensor(54.8096, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.2135, device='cuda:3')
compute distance is  tensor(167.2135, device='cuda:3')
compute norm is  tensor(55.3168, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.4597, device='cuda:3')
compute distance is  tensor(169.4597, device='cuda:3')
compute norm is  tensor(55.3677, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9108, device='cuda:3')
compute distance is  tensor(144.9108, device='cuda:3')
compute norm is  tensor(54.9283, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6802, device='cuda:3')
compute distance is  tensor(152.6802, device='cuda:3')
compute norm is  tensor(55.0234, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.1635, device='cuda:3')
compute distance is  tensor(145.1635, device='cuda:3')
compute norm is  tensor(54.8829, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5346, device='cuda:3')
compute distance is  tensor(134.5346, device='cuda:3')
compute norm is  tensor(54.6758, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1441, device='cuda:3')
compute distance is  tensor(139.1441, device='cuda:3')
compute norm is  tensor(54.7104, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.7257, device='cuda:3')
compute distance is  tensor(154.7257, device='cuda:3')
compute norm is  tensor(55.0093, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.0035, device='cuda:3')
compute distance is  tensor(146.0035, device='cuda:3')
compute norm is  tensor(55.0251, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.8813, device='cuda:3')
compute distance is  tensor(141.8813, device='cuda:3')
compute norm is  tensor(54.8849, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.5828, device='cuda:3')
compute distance is  tensor(147.5828, device='cuda:3')
compute norm is  tensor(54.8234, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(169.4597, device='cuda:3')
distance x is tensor(107551.8125, device='cuda:3')
distance x is tensor(107551.8125, device='cuda:3')
________________________________
test distance is  tensor(107551.8125, device='cuda:3')
test distance1 is  tensor(107551.8125, device='cuda:3')
test similarity is  tensor(0.4510, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130134783200467.78
test entropy is  0.0
________________________________
cal ratio is  0.03890007965319648
distance x is tensor(4183.7803, device='cuda:3')
cal_distance is  tensor(4183.7803, device='cuda:3')
cal ratio is  0.19723088290521296
distance x is tensor(825.1746, device='cuda:3')
cal_distance is  tensor(825.1746, device='cuda:3')
cal ratio is  0.44410577957764247
distance x is tensor(366.4676, device='cuda:3')
cal_distance is  tensor(366.4676, device='cuda:3')
cal ratio is  0.6664100856066891
distance x is tensor(244.2194, device='cuda:3')
cal_distance is  tensor(244.2194, device='cuda:3')
cal ratio is  0.8163366118888107
distance x is tensor(199.3662, device='cuda:3')
cal_distance is  tensor(199.3662, device='cuda:3')
cal ratio is  0.9035113779669929
distance x is tensor(180.1301, device='cuda:3')
cal_distance is  tensor(180.1301, device='cuda:3')
cal ratio is  0.9505308799498375
distance x is tensor(171.2195, device='cuda:3')
cal_distance is  tensor(171.2195, device='cuda:3')
cal ratio is  0.9749509846397744
distance x is tensor(166.9307, device='cuda:3')
cal_distance is  tensor(166.9307, device='cuda:3')
distance x is tensor(166.9307, device='cuda:3')
return_distance is  tensor(166.9307, device='cuda:3')
distance x is tensor(166.9207, device='cuda:3')
distance x is tensor(166.9207, device='cuda:3')
________________________________
test distance is  tensor(166.9207, device='cuda:3')
test distance1 is  tensor(166.9207, device='cuda:3')
test similarity is  tensor(0.9660, device='cuda:3')
test acc is  0.23430000015633778
test loss is 62.870629389911315
test entropy is  0.0432186995532169
________________________________
0
distance x is tensor(166.9207, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.045483801413629295
avg test loss is  62.99815559793891
avg accuracy is  0.8278000001563242
solo acc is  0.23105000015633761
compute similarity  is  tensor(0.9660, device='cuda:3')
compute_distance is  tensor(166.9207, device='cuda:3')
compute_norm is  tensor(58.9880, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.6479, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.065618529185049
avg test loss is  1.691884665601035
avg accuracy is  0.4874666668230086
solo acc is  0.22555000015633744
compute similarity  is  tensor(0.9641, device='cuda:3')
compute_distance is  tensor(164.6479, device='cuda:3')
compute_norm is  tensor(59.4468, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.7534, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6303903504665981
avg test loss is  2.520075007796542
avg accuracy is  0.35323333348967384
solo acc is  0.10633333348966528
compute similarity  is  tensor(0.9639, device='cuda:3')
compute_distance is  tensor(164.7534, device='cuda:3')
compute_norm is  tensor(59.2219, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.3504, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9965063117460401
avg test loss is  1.5654439927418349
avg accuracy is  0.5213833334896756
solo acc is  0.2466333334896714
compute similarity  is  tensor(0.9642, device='cuda:3')
compute_distance is  tensor(165.3504, device='cuda:3')
compute_norm is  tensor(58.9135, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(165.3504, device='cuda:3')
distance x is tensor(165.3504, device='cuda:3')
________________________________
test distance is  tensor(165.3504, device='cuda:3')
test distance1 is  tensor(165.3504, device='cuda:3')
test similarity is  tensor(0.9642, device='cuda:3')
test acc is  0.24693333348967142
test loss is 1.563584486177481
test entropy is  0.9957160806732137
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.4365627765655518
mal norm is  tensor(845.2819, device='cuda:3')
distance x is tensor(165.3596, device='cuda:3')
mal distance is  tensor(165.3596, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(23.8974, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7067, device='cuda:3')
user_param_square tensor(120.7079, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(145.8431, device='cuda:3')
score : tensor(1.4347, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.3242, device='cuda:3')
user_param_square tensor(121.6562, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(138.9334, device='cuda:3')
score : tensor(1.3656, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.1077, device='cuda:3')
user_param_square tensor(117.9443, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(155.5940, device='cuda:3')
score : tensor(1.5322, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.9504, device='cuda:3')
user_param_square tensor(112.4301, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(148.8020, device='cuda:3')
score : tensor(1.4643, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.9215, device='cuda:3')
user_param_square tensor(116.8055, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(133.9969, device='cuda:3')
score : tensor(1.3163, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.2307, device='cuda:3')
user_param_square tensor(121.5488, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(121.7491, device='cuda:3')
score : tensor(1.1938, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.3754, device='cuda:3')
user_param_square tensor(109.6784, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(181.3517, device='cuda:3')
score : tensor(1.7898, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.2690, device='cuda:3')
user_param_square tensor(116.3286, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(159.3600, device='cuda:3')
score : tensor(1.5699, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.2819, device='cuda:3')
user_param_square tensor(142.1268, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(-204.7096, device='cuda:3')
score : tensor(-2.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.5391, device='cuda:3')
user_param_square tensor(125.4486, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(125.0751, device='cuda:3')
score : tensor(1.2271, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.0574, device='cuda:3')
user_param_square tensor(124.6382, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(114.2296, device='cuda:3')
score : tensor(1.1186, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.5063, device='cuda:3')
user_param_square tensor(120.8859, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(252.5161, device='cuda:3')
score : tensor(2.5015, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.2884, device='cuda:3')
user_param_square tensor(122.3383, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(295.4298, device='cuda:3')
score : tensor(2.9306, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.2716, device='cuda:3')
user_param_square tensor(121.9453, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(177.9603, device='cuda:3')
score : tensor(1.7559, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.7352, device='cuda:3')
user_param_square tensor(121.5000, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(154.4924, device='cuda:3')
score : tensor(1.5212, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.2507, device='cuda:3')
user_param_square tensor(122.3346, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(136.6572, device='cuda:3')
score : tensor(1.3429, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.5271, device='cuda:3')
user_param_square tensor(121.2827, device='cuda:3')
global_param_square tensor(23.8974, device='cuda:3')
part1 is  tensor(113.8654, device='cuda:3')
score : tensor(1.1150, device='cuda:3')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.28% 

Test Accuracy: 88.63% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
 benign loss is  0.9296496510505676
distance x is tensor(118.0774, device='cuda:3')
benign distance is  tensor(118.0774, device='cuda:3')
norm1 res is  tensor(0.1301, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.6547986268997192
distance x is tensor(122.8821, device='cuda:3')
benign distance is  tensor(122.8821, device='cuda:3')
norm1 res is  tensor(0.1371, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.4862090051174164
distance x is tensor(135.3015, device='cuda:3')
benign distance is  tensor(135.3015, device='cuda:3')
norm1 res is  tensor(0.1448, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.37871164083480835
distance x is tensor(117.5831, device='cuda:3')
benign distance is  tensor(117.5831, device='cuda:3')
norm1 res is  tensor(0.1239, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.539106011390686
distance x is tensor(127.3975, device='cuda:3')
benign distance is  tensor(127.3975, device='cuda:3')
norm1 res is  tensor(0.1342, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.1897900104522705
distance x is tensor(133.9750, device='cuda:3')
benign distance is  tensor(133.9750, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.7741284966468811
distance x is tensor(118.0004, device='cuda:3')
benign distance is  tensor(118.0004, device='cuda:3')
norm1 res is  tensor(0.1211, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.9515674710273743
distance x is tensor(125.9569, device='cuda:3')
benign distance is  tensor(125.9569, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.11871244758367538
distance x is tensor(132.2399, device='cuda:3')
benign distance is  tensor(132.2399, device='cuda:3')
norm1 res is  tensor(0.1400, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.5520593523979187
distance x is tensor(153.1957, device='cuda:3')
benign distance is  tensor(153.1957, device='cuda:3')
norm1 res is  tensor(0.1668, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.29711848497390747
distance x is tensor(140.9878, device='cuda:3')
benign distance is  tensor(140.9878, device='cuda:3')
norm1 res is  tensor(0.1506, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.8931683301925659
distance x is tensor(126.0343, device='cuda:3')
benign distance is  tensor(126.0343, device='cuda:3')
norm1 res is  tensor(0.1355, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.22906632721424103
distance x is tensor(130.6855, device='cuda:3')
benign distance is  tensor(130.6855, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.9787808656692505
distance x is tensor(126.7083, device='cuda:3')
benign distance is  tensor(126.7083, device='cuda:3')
norm1 res is  tensor(0.1372, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.15519604086875916
distance x is tensor(147.4293, device='cuda:3')
benign distance is  tensor(147.4293, device='cuda:3')
norm1 res is  tensor(0.1601, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.2899002432823181
distance x is tensor(130.7971, device='cuda:3')
benign distance is  tensor(130.7971, device='cuda:3')
norm1 res is  tensor(0.1373, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(131.9638, device='cuda:3')
compute distance is  tensor(131.9638, device='cuda:3')
compute norm is  tensor(54.3880, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9084, device='cuda:3')
compute distance is  tensor(132.9084, device='cuda:3')
compute norm is  tensor(54.4413, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.0700, device='cuda:3')
compute distance is  tensor(129.0700, device='cuda:3')
compute norm is  tensor(54.3283, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5243, device='cuda:3')
compute distance is  tensor(126.5243, device='cuda:3')
compute norm is  tensor(54.2216, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.1367, device='cuda:3')
compute distance is  tensor(151.1367, device='cuda:3')
compute norm is  tensor(54.9731, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2539, device='cuda:3')
compute distance is  tensor(138.2539, device='cuda:3')
compute norm is  tensor(54.4782, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5366, device='cuda:3')
compute distance is  tensor(132.5366, device='cuda:3')
compute norm is  tensor(54.3322, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.0238, device='cuda:3')
compute distance is  tensor(135.0238, device='cuda:3')
compute norm is  tensor(54.3616, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1068, device='cuda:3')
compute distance is  tensor(139.1068, device='cuda:3')
compute norm is  tensor(54.3940, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.7517, device='cuda:3')
compute distance is  tensor(124.7517, device='cuda:3')
compute norm is  tensor(54.3364, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.3947, device='cuda:3')
compute distance is  tensor(142.3947, device='cuda:3')
compute norm is  tensor(54.6185, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3829, device='cuda:3')
compute distance is  tensor(134.3829, device='cuda:3')
compute norm is  tensor(54.4782, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.1367, device='cuda:3')
distance x is tensor(107578.8906, device='cuda:3')
distance x is tensor(107578.8906, device='cuda:3')
________________________________
test distance is  tensor(107578.8906, device='cuda:3')
test distance1 is  tensor(107578.8906, device='cuda:3')
test similarity is  tensor(0.4019, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130143422590286.06
test entropy is  0.0
________________________________
cal ratio is  0.03673225515460824
distance x is tensor(3951.6204, device='cuda:3')
cal_distance is  tensor(3951.6204, device='cuda:3')
cal ratio is  0.19165647534861455
distance x is tensor(757.3578, device='cuda:3')
cal_distance is  tensor(757.3578, device='cuda:3')
cal ratio is  0.43778469159387357
distance x is tensor(331.5625, device='cuda:3')
cal_distance is  tensor(331.5625, device='cuda:3')
cal ratio is  0.6616501447565027
distance x is tensor(219.3801, device='cuda:3')
cal_distance is  tensor(219.3801, device='cuda:3')
cal ratio is  0.813415655032566
distance x is tensor(178.4481, device='cuda:3')
cal_distance is  tensor(178.4481, device='cuda:3')
cal ratio is  0.9018932334077183
distance x is tensor(160.9417, device='cuda:3')
cal_distance is  tensor(160.9417, device='cuda:3')
cal ratio is  0.9496790282212697
distance x is tensor(152.8432, device='cuda:3')
cal_distance is  tensor(152.8432, device='cuda:3')
cal ratio is  0.9745139879780744
distance x is tensor(148.9480, device='cuda:3')
cal_distance is  tensor(148.9480, device='cuda:3')
distance x is tensor(148.9480, device='cuda:3')
return_distance is  tensor(148.9480, device='cuda:3')
distance x is tensor(148.9379, device='cuda:3')
distance x is tensor(148.9379, device='cuda:3')
________________________________
test distance is  tensor(148.9379, device='cuda:3')
test distance1 is  tensor(148.9379, device='cuda:3')
test similarity is  tensor(0.9690, device='cuda:3')
test acc is  0.2838666668230059
test loss is 49.3235370131698
test entropy is  0.04480944425269747
________________________________
0
distance x is tensor(148.9379, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.043595884358689094
avg test loss is  49.79518719776861
avg accuracy is  0.8543666668229898
solo acc is  0.28426666682300583
compute similarity  is  tensor(0.9690, device='cuda:3')
compute_distance is  tensor(148.9379, device='cuda:3')
compute_norm is  tensor(57.6353, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.3739, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9031471308868831
avg test loss is  1.31987828924966
avg accuracy is  0.8520333334896565
solo acc is  0.3187500001563399
compute similarity  is  tensor(0.9692, device='cuda:3')
compute_distance is  tensor(143.3739, device='cuda:3')
compute_norm is  tensor(57.2671, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.8898, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8551810624629959
avg test loss is  1.3986530628031506
avg accuracy is  0.8513666668229898
solo acc is  0.2641500001563387
compute similarity  is  tensor(0.9690, device='cuda:3')
compute_distance is  tensor(143.8898, device='cuda:3')
compute_norm is  tensor(56.9772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.2626, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8584434013249778
avg test loss is  1.387506636475195
avg accuracy is  0.8514000001563232
solo acc is  0.2558000001563384
compute similarity  is  tensor(0.9689, device='cuda:3')
compute_distance is  tensor(144.2626, device='cuda:3')
compute_norm is  tensor(56.6951, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.6183, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8534133555665453
avg test loss is  1.3686808148172618
avg accuracy is  0.8534500001563231
solo acc is  0.25556666682300505
compute similarity  is  tensor(0.9687, device='cuda:3')
compute_distance is  tensor(144.6183, device='cuda:3')
compute_norm is  tensor(56.4177, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.9800, device='cuda:3')
distance x is tensor(144.9800, device='cuda:3')
________________________________
test distance is  tensor(144.9800, device='cuda:3')
test distance1 is  tensor(144.9800, device='cuda:3')
test similarity is  tensor(0.9686, device='cuda:3')
test acc is  0.2544666668230051
test loss is 1.3532293240652917
test entropy is  0.8506771847129122
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.347177267074585
mal norm is  tensor(718.1584, device='cuda:3')
distance x is tensor(144.9891, device='cuda:3')
mal distance is  tensor(144.9891, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(21.1493, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.1616, device='cuda:3')
user_param_square tensor(103.5670, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-12.4027, device='cuda:3')
score : tensor(-0.1450, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.7020, device='cuda:3')
user_param_square tensor(105.8435, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-57.4903, device='cuda:3')
score : tensor(-0.5959, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.5337, device='cuda:3')
user_param_square tensor(110.1356, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(52.9819, device='cuda:3')
score : tensor(0.5089, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(492.0138, device='cuda:3')
user_param_square tensor(102.0086, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(37.5021, device='cuda:3')
score : tensor(0.3541, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.2272, device='cuda:3')
user_param_square tensor(105.9957, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-32.6284, device='cuda:3')
score : tensor(-0.3472, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.3126, device='cuda:3')
user_param_square tensor(108.3720, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-40.7361, device='cuda:3')
score : tensor(-0.4283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(476.0725, device='cuda:3')
user_param_square tensor(100.3425, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(17.2688, device='cuda:3')
score : tensor(0.1517, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(540.6132, device='cuda:3')
user_param_square tensor(106.9280, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-44.1858, device='cuda:3')
score : tensor(-0.4628, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.1584, device='cuda:3')
user_param_square tensor(123.2419, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-10.2438, device='cuda:3')
score : tensor(-0.1234, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.9711, device='cuda:3')
user_param_square tensor(117.7852, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(7.7737, device='cuda:3')
score : tensor(0.0568, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.1469, device='cuda:3')
user_param_square tensor(112.7557, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-8.8604, device='cuda:3')
score : tensor(-0.1096, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.8976, device='cuda:3')
user_param_square tensor(109.4966, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-36.0007, device='cuda:3')
score : tensor(-0.3810, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.0411, device='cuda:3')
user_param_square tensor(117.4318, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-22.9970, device='cuda:3')
score : tensor(-0.2509, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.0245, device='cuda:3')
user_param_square tensor(114.4201, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-20.7814, device='cuda:3')
score : tensor(-0.2288, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.8961, device='cuda:3')
user_param_square tensor(112.6384, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-35.4728, device='cuda:3')
score : tensor(-0.3757, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.5792, device='cuda:3')
user_param_square tensor(112.8900, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-7.3689, device='cuda:3')
score : tensor(-0.0946, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.2878, device='cuda:3')
user_param_square tensor(112.1106, device='cuda:3')
global_param_square tensor(21.1493, device='cuda:3')
part1 is  tensor(-39.5062, device='cuda:3')
score : tensor(-0.4160, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.37% 

Test Accuracy: 88.41% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
 benign loss is  1.0424847602844238
distance x is tensor(117.3876, device='cuda:3')
benign distance is  tensor(117.3876, device='cuda:3')
norm1 res is  tensor(0.1299, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.2204488068819046
distance x is tensor(140.1434, device='cuda:3')
benign distance is  tensor(140.1434, device='cuda:3')
norm1 res is  tensor(0.1513, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2817348837852478
distance x is tensor(116.1116, device='cuda:3')
benign distance is  tensor(116.1116, device='cuda:3')
norm1 res is  tensor(0.1259, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.9396985769271851
distance x is tensor(111.1424, device='cuda:3')
benign distance is  tensor(111.1424, device='cuda:3')
norm1 res is  tensor(0.1190, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.46725401282310486
distance x is tensor(131.5764, device='cuda:3')
benign distance is  tensor(131.5764, device='cuda:3')
norm1 res is  tensor(0.1406, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.425117164850235
distance x is tensor(137.0292, device='cuda:3')
benign distance is  tensor(137.0292, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.16274461150169373
distance x is tensor(122.1792, device='cuda:3')
benign distance is  tensor(122.1792, device='cuda:3')
norm1 res is  tensor(0.1253, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.13939319550991058
distance x is tensor(134.2283, device='cuda:3')
benign distance is  tensor(134.2283, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.5129501819610596
distance x is tensor(138.6946, device='cuda:3')
benign distance is  tensor(138.6946, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.44916248321533203
distance x is tensor(135.5538, device='cuda:3')
benign distance is  tensor(135.5538, device='cuda:3')
norm1 res is  tensor(0.1431, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.7707935571670532
distance x is tensor(144.8723, device='cuda:3')
benign distance is  tensor(144.8723, device='cuda:3')
norm1 res is  tensor(0.1525, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.21679000556468964
distance x is tensor(143.2301, device='cuda:3')
benign distance is  tensor(143.2301, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.265058696269989
distance x is tensor(130.1588, device='cuda:3')
benign distance is  tensor(130.1588, device='cuda:3')
norm1 res is  tensor(0.1405, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.2841624915599823
distance x is tensor(140.4593, device='cuda:3')
benign distance is  tensor(140.4593, device='cuda:3')
norm1 res is  tensor(0.1484, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  1.127898931503296
distance x is tensor(137.7911, device='cuda:3')
benign distance is  tensor(137.7911, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.04886709153652191
distance x is tensor(129.9052, device='cuda:3')
benign distance is  tensor(129.9052, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(134.8028, device='cuda:3')
compute distance is  tensor(134.8028, device='cuda:3')
compute norm is  tensor(55.2024, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2880, device='cuda:3')
compute distance is  tensor(129.2880, device='cuda:3')
compute norm is  tensor(55.0455, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6635, device='cuda:3')
compute distance is  tensor(131.6635, device='cuda:3')
compute norm is  tensor(55.2112, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.2967, device='cuda:3')
compute distance is  tensor(144.2967, device='cuda:3')
compute norm is  tensor(55.3008, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.4123, device='cuda:3')
compute distance is  tensor(153.4123, device='cuda:3')
compute norm is  tensor(55.4045, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.7823, device='cuda:3')
compute distance is  tensor(145.7823, device='cuda:3')
compute norm is  tensor(55.4630, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4972, device='cuda:3')
compute distance is  tensor(136.4972, device='cuda:3')
compute norm is  tensor(55.1568, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.8301, device='cuda:3')
compute distance is  tensor(145.8301, device='cuda:3')
compute norm is  tensor(55.3494, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.3288, device='cuda:3')
compute distance is  tensor(151.3288, device='cuda:3')
compute norm is  tensor(55.7465, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7797, device='cuda:3')
compute distance is  tensor(138.7797, device='cuda:3')
compute norm is  tensor(55.3132, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8276, device='cuda:3')
compute distance is  tensor(137.8276, device='cuda:3')
compute norm is  tensor(55.2366, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.0639, device='cuda:3')
compute distance is  tensor(136.0639, device='cuda:3')
compute norm is  tensor(55.3651, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(153.4123, device='cuda:3')
distance x is tensor(107585.2891, device='cuda:3')
distance x is tensor(107585.2891, device='cuda:3')
________________________________
test distance is  tensor(107585.2891, device='cuda:3')
test distance1 is  tensor(107585.2891, device='cuda:3')
test similarity is  tensor(0.3903, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130098832783486.64
test entropy is  0.0
________________________________
cal ratio is  0.03700664763761965
distance x is tensor(3981.3762, device='cuda:3')
cal_distance is  tensor(3981.3762, device='cuda:3')
cal ratio is  0.19237099038993377
distance x is tensor(765.9053, device='cuda:3')
cal_distance is  tensor(765.9053, device='cuda:3')
cal ratio is  0.43860004843853134
distance x is tensor(335.9290, device='cuda:3')
cal_distance is  tensor(335.9290, device='cuda:3')
cal ratio is  0.66226603557596
distance x is tensor(222.4760, device='cuda:3')
cal_distance is  tensor(222.4760, device='cuda:3')
cal ratio is  0.8137942207790752
distance x is tensor(181.0507, device='cuda:3')
cal_distance is  tensor(181.0507, device='cuda:3')
cal ratio is  0.9021030449919778
distance x is tensor(163.3268, device='cuda:3')
cal_distance is  tensor(163.3268, device='cuda:3')
cal ratio is  0.9497896009027924
distance x is tensor(155.1264, device='cuda:3')
cal_distance is  tensor(155.1264, device='cuda:3')
cal ratio is  0.9745707305035166
distance x is tensor(151.1818, device='cuda:3')
cal_distance is  tensor(151.1818, device='cuda:3')
distance x is tensor(151.1818, device='cuda:3')
return_distance is  tensor(151.1818, device='cuda:3')
distance x is tensor(151.1717, device='cuda:3')
distance x is tensor(151.1717, device='cuda:3')
________________________________
test distance is  tensor(151.1717, device='cuda:3')
test distance1 is  tensor(151.1717, device='cuda:3')
test similarity is  tensor(0.9685, device='cuda:3')
test acc is  0.21711666682300368
test loss is 82.23971733711421
test entropy is  0.02815407571926547
________________________________
0
distance x is tensor(151.1717, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.028232360258698463
avg test loss is  82.03308765110431
avg accuracy is  0.8305000001563241
solo acc is  0.2183333334896704
compute similarity  is  tensor(0.9685, device='cuda:3')
compute_distance is  tensor(151.1717, device='cuda:3')
compute_norm is  tensor(58.4521, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.7095, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9020674342412685
avg test loss is  1.3533781207065338
avg accuracy is  0.8521166668229899
solo acc is  0.31943333348967323
compute similarity  is  tensor(0.9684, device='cuda:3')
compute_distance is  tensor(145.7095, device='cuda:3')
compute_norm is  tensor(58.1371, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.4475, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8603341844417393
avg test loss is  1.4313716466492936
avg accuracy is  0.8518000001563232
solo acc is  0.2594166668230052
compute similarity  is  tensor(0.9682, device='cuda:3')
compute_distance is  tensor(146.4475, device='cuda:3')
compute_norm is  tensor(57.8348, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.8893, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8632652049761083
avg test loss is  1.4033415697530898
avg accuracy is  0.8520166668229899
solo acc is  0.2571000001563385
compute similarity  is  tensor(0.9680, device='cuda:3')
compute_distance is  tensor(146.8893, device='cuda:3')
compute_norm is  tensor(57.5405, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.3225, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8537429808807779
avg test loss is  1.3948162134522315
avg accuracy is  0.8548666668229897
solo acc is  0.25080000015633824
compute similarity  is  tensor(0.9679, device='cuda:3')
compute_distance is  tensor(147.3225, device='cuda:3')
compute_norm is  tensor(57.2527, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.7085, device='cuda:3')
distance x is tensor(147.7085, device='cuda:3')
________________________________
test distance is  tensor(147.7085, device='cuda:3')
test distance1 is  tensor(147.7085, device='cuda:3')
test similarity is  tensor(0.9677, device='cuda:3')
test acc is  0.24748333348967147
test loss is 1.3850013602262876
test entropy is  0.846549878623694
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.0099862813949585
mal norm is  tensor(732.4252, device='cuda:3')
distance x is tensor(147.7177, device='cuda:3')
mal distance is  tensor(147.7177, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(16.4555, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.6292, device='cuda:3')
user_param_square tensor(91.3962, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(11.9225, device='cuda:3')
score : tensor(0.1030, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.8109, device='cuda:3')
user_param_square tensor(99.0999, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(19.7825, device='cuda:3')
score : tensor(0.1816, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.0056, device='cuda:3')
user_param_square tensor(90.4348, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(21.8237, device='cuda:3')
score : tensor(0.2020, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(464.3771, device='cuda:3')
user_param_square tensor(87.4159, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-41.1762, device='cuda:3')
score : tensor(-0.4280, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.6224, device='cuda:3')
user_param_square tensor(95.1879, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(19.4690, device='cuda:3')
score : tensor(0.1784, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.6620, device='cuda:3')
user_param_square tensor(97.2436, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-20.3828, device='cuda:3')
score : tensor(-0.2201, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.1535, device='cuda:3')
user_param_square tensor(90.4482, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(61.0061, device='cuda:3')
score : tensor(0.5938, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.6988, device='cuda:3')
user_param_square tensor(96.0549, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(4.1702, device='cuda:3')
score : tensor(0.0254, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.4252, device='cuda:3')
user_param_square tensor(109.7834, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(-21.2604, device='cuda:3')
score : tensor(-0.2289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.5079, device='cuda:3')
user_param_square tensor(99.1578, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(18.9984, device='cuda:3')
score : tensor(0.1737, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.7543, device='cuda:3')
user_param_square tensor(100.4149, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(40.5332, device='cuda:3')
score : tensor(0.3891, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.6562, device='cuda:3')
user_param_square tensor(102.4350, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(0.4749, device='cuda:3')
score : tensor(-0.0115, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.6552, device='cuda:3')
user_param_square tensor(101.7903, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(54.4135, device='cuda:3')
score : tensor(0.5279, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.0457, device='cuda:3')
user_param_square tensor(100.9291, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(13.9009, device='cuda:3')
score : tensor(0.1228, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.5759, device='cuda:3')
user_param_square tensor(98.1627, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(3.6853, device='cuda:3')
score : tensor(0.0206, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.2354, device='cuda:3')
user_param_square tensor(98.7193, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(11.4616, device='cuda:3')
score : tensor(0.0984, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.2539, device='cuda:3')
user_param_square tensor(100.4558, device='cuda:3')
global_param_square tensor(16.4555, device='cuda:3')
part1 is  tensor(10.9701, device='cuda:3')
score : tensor(0.0934, device='cuda:3')
accept
len accept list 13
len all weights is 13
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.45% 

Test Accuracy: 88.78% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3573704957962036
distance x is tensor(121.4571, device='cuda:3')
benign distance is  tensor(121.4571, device='cuda:3')
norm1 res is  tensor(0.1307, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8238543272018433
distance x is tensor(137.9405, device='cuda:3')
benign distance is  tensor(137.9405, device='cuda:3')
norm1 res is  tensor(0.1527, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3969907760620117
distance x is tensor(106.4050, device='cuda:3')
benign distance is  tensor(106.4050, device='cuda:3')
norm1 res is  tensor(0.1166, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.43000245094299316
distance x is tensor(126.8693, device='cuda:3')
benign distance is  tensor(126.8693, device='cuda:3')
norm1 res is  tensor(0.1375, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.2594209611415863
distance x is tensor(136.0761, device='cuda:3')
benign distance is  tensor(136.0761, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7504181861877441
distance x is tensor(135.2999, device='cuda:3')
benign distance is  tensor(135.2999, device='cuda:3')
norm1 res is  tensor(0.1447, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.49835166335105896
distance x is tensor(130.7086, device='cuda:3')
benign distance is  tensor(130.7086, device='cuda:3')
norm1 res is  tensor(0.1381, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.4936619699001312
distance x is tensor(121.8944, device='cuda:3')
benign distance is  tensor(121.8944, device='cuda:3')
norm1 res is  tensor(0.1345, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.31077834963798523
distance x is tensor(122.2355, device='cuda:3')
benign distance is  tensor(122.2355, device='cuda:3')
norm1 res is  tensor(0.1322, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.3780815899372101
distance x is tensor(154.0271, device='cuda:3')
benign distance is  tensor(154.0271, device='cuda:3')
norm1 res is  tensor(0.1667, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.2596796154975891
distance x is tensor(136.4385, device='cuda:3')
benign distance is  tensor(136.4385, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.2773906886577606
distance x is tensor(125.9070, device='cuda:3')
benign distance is  tensor(125.9070, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.379705011844635
distance x is tensor(128.9611, device='cuda:3')
benign distance is  tensor(128.9611, device='cuda:3')
norm1 res is  tensor(0.1399, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.3855679929256439
distance x is tensor(122.3568, device='cuda:3')
benign distance is  tensor(122.3568, device='cuda:3')
norm1 res is  tensor(0.1285, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.433290958404541
distance x is tensor(124.7068, device='cuda:3')
benign distance is  tensor(124.7068, device='cuda:3')
norm1 res is  tensor(0.1296, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.20015272498130798
distance x is tensor(121.1927, device='cuda:3')
benign distance is  tensor(121.1927, device='cuda:3')
norm1 res is  tensor(0.1278, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(126.5242, device='cuda:3')
compute distance is  tensor(126.5242, device='cuda:3')
compute norm is  tensor(54.3028, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9321, device='cuda:3')
compute distance is  tensor(123.9321, device='cuda:3')
compute norm is  tensor(54.3008, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.9688, device='cuda:3')
compute distance is  tensor(129.9688, device='cuda:3')
compute norm is  tensor(54.4977, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1328, device='cuda:3')
compute distance is  tensor(143.1328, device='cuda:3')
compute norm is  tensor(54.7053, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.3867, device='cuda:3')
compute distance is  tensor(124.3867, device='cuda:3')
compute norm is  tensor(54.3477, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6776, device='cuda:3')
compute distance is  tensor(134.6776, device='cuda:3')
compute norm is  tensor(54.6500, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5625, device='cuda:3')
compute distance is  tensor(132.5625, device='cuda:3')
compute norm is  tensor(54.4478, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8850, device='cuda:3')
compute distance is  tensor(132.8850, device='cuda:3')
compute norm is  tensor(54.4455, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.4065, device='cuda:3')
compute distance is  tensor(144.4065, device='cuda:3')
compute norm is  tensor(54.6548, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9334, device='cuda:3')
compute distance is  tensor(116.9334, device='cuda:3')
compute norm is  tensor(54.3030, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7103, device='cuda:3')
compute distance is  tensor(123.7103, device='cuda:3')
compute norm is  tensor(54.3647, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9330, device='cuda:3')
compute distance is  tensor(127.9330, device='cuda:3')
compute norm is  tensor(54.5485, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.4065, device='cuda:3')
distance x is tensor(107593.5938, device='cuda:3')
distance x is tensor(107593.5938, device='cuda:3')
________________________________
test distance is  tensor(107593.5938, device='cuda:3')
test distance1 is  tensor(107593.5938, device='cuda:3')
test similarity is  tensor(0.3705, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130101060701186.19
test entropy is  0.0
________________________________
cal ratio is  0.03590262898210528
distance x is tensor(3862.8984, device='cuda:3')
cal_distance is  tensor(3862.8984, device='cuda:3')
cal ratio is  0.1894797540689297
distance x is tensor(731.9451, device='cuda:3')
cal_distance is  tensor(731.9451, device='cuda:3')
cal ratio is  0.43529153639189344
distance x is tensor(318.6124, device='cuda:3')
cal_distance is  tensor(318.6124, device='cuda:3')
cal ratio is  0.6597632983964513
distance x is tensor(210.2105, device='cuda:3')
cal_distance is  tensor(210.2105, device='cuda:3')
cal ratio is  0.8122547968379077
distance x is tensor(170.7454, device='cuda:3')
cal_distance is  tensor(170.7454, device='cuda:3')
cal ratio is  0.9012492779849225
distance x is tensor(153.8847, device='cuda:3')
cal_distance is  tensor(153.8847, device='cuda:3')
cal ratio is  0.9493399367471699
distance x is tensor(146.0891, device='cuda:3')
cal_distance is  tensor(146.0891, device='cuda:3')
cal ratio is  0.9743399217101489
distance x is tensor(142.3406, device='cuda:3')
cal_distance is  tensor(142.3406, device='cuda:3')
distance x is tensor(142.3406, device='cuda:3')
return_distance is  tensor(142.3406, device='cuda:3')
distance x is tensor(142.3305, device='cuda:3')
distance x is tensor(142.3305, device='cuda:3')
________________________________
test distance is  tensor(142.3305, device='cuda:3')
test distance1 is  tensor(142.3305, device='cuda:3')
test similarity is  tensor(0.9699, device='cuda:3')
test acc is  0.22505000015633744
test loss is 60.7968219195856
test entropy is  0.03152283441090682
________________________________
0
distance x is tensor(142.3305, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.03213257049912833
avg test loss is  61.00581024755547
avg accuracy is  0.8585833334896563
solo acc is  0.2253833334896708
compute similarity  is  tensor(0.9699, device='cuda:3')
compute_distance is  tensor(142.3305, device='cuda:3')
compute_norm is  tensor(57.3272, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.4987, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8901039731146684
avg test loss is  1.3368162971569786
avg accuracy is  0.859500000156323
solo acc is  0.3167666668230066
compute similarity  is  tensor(0.9700, device='cuda:3')
compute_distance is  tensor(138.4987, device='cuda:3')
compute_norm is  tensor(56.9403, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.3531, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8657913751947854
avg test loss is  1.408941058080588
avg accuracy is  0.8588166668229896
solo acc is  0.2637166668230053
compute similarity  is  tensor(0.9697, device='cuda:3')
compute_distance is  tensor(139.3531, device='cuda:3')
compute_norm is  tensor(56.6451, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.0003, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8531041600302592
avg test loss is  1.3943174501726114
avg accuracy is  0.8590333334896563
solo acc is  0.25816666682300515
compute similarity  is  tensor(0.9695, device='cuda:3')
compute_distance is  tensor(140.0003, device='cuda:3')
compute_norm is  tensor(56.3580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.5759, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8505970212315191
avg test loss is  1.3704340287617274
avg accuracy is  0.8592833334896564
solo acc is  0.25706666682300505
compute similarity  is  tensor(0.9693, device='cuda:3')
compute_distance is  tensor(140.5759, device='cuda:3')
compute_norm is  tensor(56.0774, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(141.1601, device='cuda:3')
distance x is tensor(141.1601, device='cuda:3')
________________________________
test distance is  tensor(141.1601, device='cuda:3')
test distance1 is  tensor(141.1601, device='cuda:3')
test similarity is  tensor(0.9691, device='cuda:3')
test acc is  0.25491666682300507
test loss is 1.3620258550654087
test entropy is  0.8440168857066108
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2992026805877686
mal norm is  tensor(690.7510, device='cuda:3')
distance x is tensor(141.1687, device='cuda:3')
mal distance is  tensor(141.1687, device='cuda:3')
len current grad  20
len all grad 52
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(13.0745, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.7905, device='cuda:3')
user_param_square tensor(81.8009, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-8.2956, device='cuda:3')
score : tensor(-0.0958, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.2780, device='cuda:3')
user_param_square tensor(88.4430, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-18.0763, device='cuda:3')
score : tensor(-0.1936, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(453.2061, device='cuda:3')
user_param_square tensor(76.9768, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-8.7630, device='cuda:3')
score : tensor(-0.1005, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.5852, device='cuda:3')
user_param_square tensor(83.6027, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-6.7831, device='cuda:3')
score : tensor(-0.0807, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.1531, device='cuda:3')
user_param_square tensor(86.0357, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(5.9425, device='cuda:3')
score : tensor(0.0466, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.9150, device='cuda:3')
user_param_square tensor(86.1695, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-45.1581, device='cuda:3')
score : tensor(-0.4645, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.8168, device='cuda:3')
user_param_square tensor(83.2290, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(0.0542, device='cuda:3')
score : tensor(-0.0123, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.9324, device='cuda:3')
user_param_square tensor(82.8445, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-26.2720, device='cuda:3')
score : tensor(-0.2756, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7510, device='cuda:3')
user_param_square tensor(95.0326, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-13.4652, device='cuda:3')
score : tensor(-0.1475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.6761, device='cuda:3')
user_param_square tensor(86.1514, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-11.1328, device='cuda:3')
score : tensor(-0.1242, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.5714, device='cuda:3')
user_param_square tensor(85.9915, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-23.6745, device='cuda:3')
score : tensor(-0.2496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.9333, device='cuda:3')
user_param_square tensor(87.5258, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(10.3755, device='cuda:3')
score : tensor(0.0909, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.4565, device='cuda:3')
user_param_square tensor(87.1157, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(10.5464, device='cuda:3')
score : tensor(0.0926, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(564.0201, device='cuda:3')
user_param_square tensor(85.8735, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-3.5841, device='cuda:3')
score : tensor(-0.0487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.6094, device='cuda:3')
user_param_square tensor(87.2771, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-36.7222, device='cuda:3')
score : tensor(-0.3801, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.0131, device='cuda:3')
user_param_square tensor(87.5317, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-8.1849, device='cuda:3')
score : tensor(-0.0947, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8766, device='cuda:3')
user_param_square tensor(89.9526, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-4.2818, device='cuda:3')
score : tensor(-0.0557, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.2011, device='cuda:3')
user_param_square tensor(92.6254, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(0.0966, device='cuda:3')
score : tensor(-0.0119, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.8701, device='cuda:3')
user_param_square tensor(88.3388, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-28.3788, device='cuda:3')
score : tensor(-0.2967, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.3796, device='cuda:3')
user_param_square tensor(91.4305, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-5.2739, device='cuda:3')
score : tensor(-0.0656, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.6967, device='cuda:3')
user_param_square tensor(92.0943, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-23.8052, device='cuda:3')
score : tensor(-0.2509, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9954, device='cuda:3')
user_param_square tensor(91.1882, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-23.4695, device='cuda:3')
score : tensor(-0.2476, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.1719, device='cuda:3')
user_param_square tensor(90.7698, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(22.6521, device='cuda:3')
score : tensor(0.2136, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.0580, device='cuda:3')
user_param_square tensor(90.4730, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-9.7432, device='cuda:3')
score : tensor(-0.1103, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.1256, device='cuda:3')
user_param_square tensor(92.3374, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-14.3843, device='cuda:3')
score : tensor(-0.1567, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.5153, device='cuda:3')
user_param_square tensor(87.0451, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-11.1609, device='cuda:3')
score : tensor(-0.1245, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.5246, device='cuda:3')
user_param_square tensor(93.8401, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-16.5764, device='cuda:3')
score : tensor(-0.1786, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.1891, device='cuda:3')
user_param_square tensor(89.4653, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(16.3095, device='cuda:3')
score : tensor(0.1502, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.4320, device='cuda:3')
user_param_square tensor(85.6762, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-29.9065, device='cuda:3')
score : tensor(-0.3119, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.9415, device='cuda:3')
user_param_square tensor(87.6756, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-7.6314, device='cuda:3')
score : tensor(-0.0892, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.8207, device='cuda:3')
user_param_square tensor(85.6296, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-34.0095, device='cuda:3')
score : tensor(-0.3530, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0467, device='cuda:3')
user_param_square tensor(91.9060, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(1.3312, device='cuda:3')
score : tensor(0.0004, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.9147, device='cuda:3')
user_param_square tensor(86.6235, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-2.1896, device='cuda:3')
score : tensor(-0.0348, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.2715, device='cuda:3')
user_param_square tensor(89.3982, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-9.0032, device='cuda:3')
score : tensor(-0.1029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.8085, device='cuda:3')
user_param_square tensor(87.2171, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-23.4410, device='cuda:3')
score : tensor(-0.2473, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.0986, device='cuda:3')
user_param_square tensor(89.6776, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(6.9536, device='cuda:3')
score : tensor(0.0567, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9780, device='cuda:3')
user_param_square tensor(88.4208, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-16.6392, device='cuda:3')
score : tensor(-0.1793, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.1869, device='cuda:3')
user_param_square tensor(86.1901, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-21.2358, device='cuda:3')
score : tensor(-0.2252, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.4144, device='cuda:3')
user_param_square tensor(88.6745, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-22.3230, device='cuda:3')
score : tensor(-0.2361, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.7790, device='cuda:3')
user_param_square tensor(88.1840, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-11.3866, device='cuda:3')
score : tensor(-0.1267, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.4547, device='cuda:3')
user_param_square tensor(85.8304, device='cuda:3')
global_param_square tensor(13.0745, device='cuda:3')
part1 is  tensor(-2.2782, device='cuda:3')
score : tensor(-0.0357, device='cuda:3')
len accept list 7
len all weights is 7
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.13% 

Test Accuracy: 88.50% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
 benign loss is  0.19596916437149048
distance x is tensor(126.1918, device='cuda:3')
benign distance is  tensor(126.1918, device='cuda:3')
norm1 res is  tensor(0.1349, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5877891778945923
distance x is tensor(113.4401, device='cuda:3')
benign distance is  tensor(113.4401, device='cuda:3')
norm1 res is  tensor(0.1230, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.08463361859321594
distance x is tensor(115.6288, device='cuda:3')
benign distance is  tensor(115.6288, device='cuda:3')
norm1 res is  tensor(0.1231, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.144258052110672
distance x is tensor(130.8549, device='cuda:3')
benign distance is  tensor(130.8549, device='cuda:3')
norm1 res is  tensor(0.1375, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.8160020112991333
distance x is tensor(122.0923, device='cuda:3')
benign distance is  tensor(122.0923, device='cuda:3')
norm1 res is  tensor(0.1296, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.288124144077301
distance x is tensor(127.0023, device='cuda:3')
benign distance is  tensor(127.0023, device='cuda:3')
norm1 res is  tensor(0.1360, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.06483376026153564
distance x is tensor(113.5271, device='cuda:3')
benign distance is  tensor(113.5271, device='cuda:3')
norm1 res is  tensor(0.1178, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.6367868185043335
distance x is tensor(124.9065, device='cuda:3')
benign distance is  tensor(124.9065, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.37227877974510193
distance x is tensor(128.7676, device='cuda:3')
benign distance is  tensor(128.7676, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.33074888586997986
distance x is tensor(136.8266, device='cuda:3')
benign distance is  tensor(136.8266, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.3754228949546814
distance x is tensor(128.9502, device='cuda:3')
benign distance is  tensor(128.9502, device='cuda:3')
norm1 res is  tensor(0.1368, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5009033679962158
distance x is tensor(135.0105, device='cuda:3')
benign distance is  tensor(135.0105, device='cuda:3')
norm1 res is  tensor(0.1473, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.49601396918296814
distance x is tensor(133.6725, device='cuda:3')
benign distance is  tensor(133.6725, device='cuda:3')
norm1 res is  tensor(0.1447, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.40532732009887695
distance x is tensor(132.2068, device='cuda:3')
benign distance is  tensor(132.2068, device='cuda:3')
norm1 res is  tensor(0.1414, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.1358107179403305
distance x is tensor(120.8344, device='cuda:3')
benign distance is  tensor(120.8344, device='cuda:3')
norm1 res is  tensor(0.1305, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3082600235939026
distance x is tensor(121.6609, device='cuda:3')
benign distance is  tensor(121.6609, device='cuda:3')
norm1 res is  tensor(0.1315, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.3131173551082611
distance x is tensor(128.3126, device='cuda:3')
benign distance is  tensor(128.3126, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.5434271693229675
distance x is tensor(138.6394, device='cuda:3')
benign distance is  tensor(138.6394, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.1255306601524353
distance x is tensor(113.5932, device='cuda:3')
benign distance is  tensor(113.5932, device='cuda:3')
norm1 res is  tensor(0.1225, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.3775922954082489
distance x is tensor(128.6700, device='cuda:3')
benign distance is  tensor(128.6700, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.1082986369729042
distance x is tensor(133.3709, device='cuda:3')
benign distance is  tensor(133.3709, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.4436034560203552
distance x is tensor(125.2345, device='cuda:3')
benign distance is  tensor(125.2345, device='cuda:3')
norm1 res is  tensor(0.1326, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.2787606120109558
distance x is tensor(133.4288, device='cuda:3')
benign distance is  tensor(133.4288, device='cuda:3')
norm1 res is  tensor(0.1402, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.2353038340806961
distance x is tensor(125.4960, device='cuda:3')
benign distance is  tensor(125.4960, device='cuda:3')
norm1 res is  tensor(0.1319, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.20914272964000702
distance x is tensor(131.3470, device='cuda:3')
benign distance is  tensor(131.3470, device='cuda:3')
norm1 res is  tensor(0.1413, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  1.0610584020614624
distance x is tensor(123.2034, device='cuda:3')
benign distance is  tensor(123.2034, device='cuda:3')
norm1 res is  tensor(0.1316, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.32516148686408997
distance x is tensor(143.9105, device='cuda:3')
benign distance is  tensor(143.9105, device='cuda:3')
norm1 res is  tensor(0.1532, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.5513103604316711
distance x is tensor(135.3905, device='cuda:3')
benign distance is  tensor(135.3905, device='cuda:3')
norm1 res is  tensor(0.1399, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.3355649411678314
distance x is tensor(129.6818, device='cuda:3')
benign distance is  tensor(129.6818, device='cuda:3')
norm1 res is  tensor(0.1370, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  1.0583570003509521
distance x is tensor(137.0463, device='cuda:3')
benign distance is  tensor(137.0463, device='cuda:3')
norm1 res is  tensor(0.1490, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.2595490515232086
distance x is tensor(132.8033, device='cuda:3')
benign distance is  tensor(132.8033, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.45824018120765686
distance x is tensor(131.7003, device='cuda:3')
benign distance is  tensor(131.7003, device='cuda:3')
norm1 res is  tensor(0.1420, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.036362174898386
distance x is tensor(133.7542, device='cuda:3')
benign distance is  tensor(133.7542, device='cuda:3')
norm1 res is  tensor(0.1421, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.33540162444114685
distance x is tensor(131.0138, device='cuda:3')
benign distance is  tensor(131.0138, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.25561389327049255
distance x is tensor(113.0820, device='cuda:3')
benign distance is  tensor(113.0820, device='cuda:3')
norm1 res is  tensor(0.1224, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.3093031346797943
distance x is tensor(130.8797, device='cuda:3')
benign distance is  tensor(130.8797, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.23660142719745636
distance x is tensor(122.8885, device='cuda:3')
benign distance is  tensor(122.8885, device='cuda:3')
norm1 res is  tensor(0.1317, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.5872436761856079
distance x is tensor(129.1133, device='cuda:3')
benign distance is  tensor(129.1133, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.3467574715614319
distance x is tensor(128.5727, device='cuda:3')
benign distance is  tensor(128.5727, device='cuda:3')
norm1 res is  tensor(0.1379, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.3276292085647583
distance x is tensor(131.3875, device='cuda:3')
benign distance is  tensor(131.3875, device='cuda:3')
norm1 res is  tensor(0.1439, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(136.9965, device='cuda:3')
compute distance is  tensor(136.9965, device='cuda:3')
compute norm is  tensor(54.7399, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.4546, device='cuda:3')
compute distance is  tensor(115.4546, device='cuda:3')
compute norm is  tensor(54.3891, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3645, device='cuda:3')
compute distance is  tensor(138.3645, device='cuda:3')
compute norm is  tensor(54.8337, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0887, device='cuda:3')
compute distance is  tensor(123.0887, device='cuda:3')
compute norm is  tensor(54.4063, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7302, device='cuda:3')
compute distance is  tensor(120.7302, device='cuda:3')
compute norm is  tensor(54.4110, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6045, device='cuda:3')
compute distance is  tensor(131.6045, device='cuda:3')
compute norm is  tensor(54.7248, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.6888, device='cuda:3')
compute distance is  tensor(120.6888, device='cuda:3')
compute norm is  tensor(54.5079, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9556, device='cuda:3')
compute distance is  tensor(132.9556, device='cuda:3')
compute norm is  tensor(54.5932, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.4593, device='cuda:3')
compute distance is  tensor(125.4593, device='cuda:3')
compute norm is  tensor(54.5946, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.4020, device='cuda:3')
compute distance is  tensor(135.4020, device='cuda:3')
compute norm is  tensor(54.8329, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7697, device='cuda:3')
compute distance is  tensor(138.7697, device='cuda:3')
compute norm is  tensor(54.8558, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4021, device='cuda:3')
compute distance is  tensor(126.4021, device='cuda:3')
compute norm is  tensor(54.6633, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.7697, device='cuda:3')
distance x is tensor(107594.0781, device='cuda:3')
distance x is tensor(107594.0781, device='cuda:3')
________________________________
test distance is  tensor(107594.0781, device='cuda:3')
test distance1 is  tensor(107594.0781, device='cuda:3')
test similarity is  tensor(0.3719, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130081047101195.47
test entropy is  0.0
________________________________
cal ratio is  0.03519485452496373
distance x is tensor(3786.7629, device='cuda:3')
cal_distance is  tensor(3786.7629, device='cuda:3')
cal ratio is  0.1876027853968039
distance x is tensor(710.4114, device='cuda:3')
cal_distance is  tensor(710.4114, device='cuda:3')
cal ratio is  0.4331301301594557
distance x is tensor(307.7034, device='cuda:3')
cal_distance is  tensor(307.7034, device='cuda:3')
cal ratio is  0.6581231817490256
distance x is tensor(202.5085, device='cuda:3')
cal_distance is  tensor(202.5085, device='cuda:3')
cal ratio is  0.8112444265112427
distance x is tensor(164.2849, device='cuda:3')
cal_distance is  tensor(164.2849, device='cuda:3')
cal ratio is  0.9006883787929502
distance x is tensor(147.9700, device='cuda:3')
cal_distance is  tensor(147.9700, device='cuda:3')
cal ratio is  0.9490444555441894
distance x is tensor(140.4303, device='cuda:3')
cal_distance is  tensor(140.4303, device='cuda:3')
cal ratio is  0.9741882125485761
distance x is tensor(136.8057, device='cuda:3')
cal_distance is  tensor(136.8057, device='cuda:3')
distance x is tensor(136.8057, device='cuda:3')
return_distance is  tensor(136.8057, device='cuda:3')
distance x is tensor(136.7956, device='cuda:3')
distance x is tensor(136.7956, device='cuda:3')
________________________________
test distance is  tensor(136.7956, device='cuda:3')
test distance1 is  tensor(136.7956, device='cuda:3')
test similarity is  tensor(0.9722, device='cuda:3')
test acc is  0.2757166668230056
test loss is 45.624065470339644
test entropy is  0.04185023987745203
________________________________
0
distance x is tensor(136.7956, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.042049650503729566
avg test loss is  45.716642172351825
avg accuracy is  0.8612000001563227
solo acc is  0.27583333348967226
compute similarity  is  tensor(0.9722, device='cuda:3')
compute_distance is  tensor(136.7956, device='cuda:3')
compute_norm is  tensor(57.2691, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(133.8407, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9029777521517739
avg test loss is  1.2883038395630526
avg accuracy is  0.8661500001563226
solo acc is  0.3448500001563403
compute similarity  is  tensor(0.9717, device='cuda:3')
compute_distance is  tensor(133.8407, device='cuda:3')
compute_norm is  tensor(56.7580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.8590, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8619539334829937
avg test loss is  1.3965695523249824
avg accuracy is  0.8644166668229895
solo acc is  0.2662666668230054
compute similarity  is  tensor(0.9714, device='cuda:3')
compute_distance is  tensor(134.8590, device='cuda:3')
compute_norm is  tensor(56.4614, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.5350, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8570022098164061
avg test loss is  1.3623846369003183
avg accuracy is  0.8669500001563226
solo acc is  0.2711500001563389
compute similarity  is  tensor(0.9712, device='cuda:3')
compute_distance is  tensor(135.5350, device='cuda:3')
compute_norm is  tensor(56.1744, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.2243, device='cuda:3')
exit early
distance x is tensor(136.2243, device='cuda:3')
distance x is tensor(136.2243, device='cuda:3')
________________________________
test distance is  tensor(136.2243, device='cuda:3')
test distance1 is  tensor(136.2243, device='cuda:3')
test similarity is  tensor(0.9710, device='cuda:3')
test acc is  0.2593833334896718
test loss is 1.3623791227716882
test entropy is  0.8429044875890207
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2601995468139648
mal norm is  tensor(672.2961, device='cuda:3')
distance x is tensor(136.2329, device='cuda:3')
mal distance is  tensor(136.2329, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(14.0936, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.9668, device='cuda:3')
user_param_square tensor(86.9122, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(7.8734, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(484.8910, device='cuda:3')
user_param_square tensor(82.6673, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(4.1111, device='cuda:3')
score : tensor(0.0272, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.5336, device='cuda:3')
user_param_square tensor(82.5515, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(7.1113, device='cuda:3')
score : tensor(0.0572, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.2856, device='cuda:3')
user_param_square tensor(87.3423, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(30.9469, device='cuda:3')
score : tensor(0.2956, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.9294, device='cuda:3')
user_param_square tensor(84.6084, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-19.8002, device='cuda:3')
score : tensor(-0.2119, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.2825, device='cuda:3')
user_param_square tensor(86.5315, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-8.6472, device='cuda:3')
score : tensor(-0.1004, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(466.6288, device='cuda:3')
user_param_square tensor(81.0956, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(13.2196, device='cuda:3')
score : tensor(0.1183, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.4871, device='cuda:3')
user_param_square tensor(86.6296, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-15.9199, device='cuda:3')
score : tensor(-0.1731, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.2961, device='cuda:3')
user_param_square tensor(97.3401, device='cuda:3')
global_param_square tensor(14.0936, device='cuda:3')
part1 is  tensor(-22.5759, device='cuda:3')
score : tensor(-0.2397, device='cuda:3')
len accept list 5
len all weights is 5
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 89.05% 

Test Accuracy: 88.75% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4363991618156433
distance x is tensor(98.7293, device='cuda:3')
benign distance is  tensor(98.7293, device='cuda:3')
norm1 res is  tensor(0.1088, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.29539868235588074
distance x is tensor(138.0085, device='cuda:3')
benign distance is  tensor(138.0085, device='cuda:3')
norm1 res is  tensor(0.1522, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.07558288425207138
distance x is tensor(122.1407, device='cuda:3')
benign distance is  tensor(122.1407, device='cuda:3')
norm1 res is  tensor(0.1320, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3387089669704437
distance x is tensor(128.0803, device='cuda:3')
benign distance is  tensor(128.0803, device='cuda:3')
norm1 res is  tensor(0.1469, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.36196446418762207
distance x is tensor(127.8805, device='cuda:3')
benign distance is  tensor(127.8805, device='cuda:3')
norm1 res is  tensor(0.1405, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.45844435691833496
distance x is tensor(135.0972, device='cuda:3')
benign distance is  tensor(135.0972, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.7599125504493713
distance x is tensor(112.9816, device='cuda:3')
benign distance is  tensor(112.9816, device='cuda:3')
norm1 res is  tensor(0.1191, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.16803374886512756
distance x is tensor(129.8264, device='cuda:3')
benign distance is  tensor(129.8264, device='cuda:3')
norm1 res is  tensor(0.1422, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(123.3423, device='cuda:3')
compute distance is  tensor(123.3423, device='cuda:3')
compute norm is  tensor(55.0130, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.9659, device='cuda:3')
compute distance is  tensor(137.9659, device='cuda:3')
compute norm is  tensor(55.3248, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.0715, device='cuda:3')
compute distance is  tensor(128.0715, device='cuda:3')
compute norm is  tensor(55.2083, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2137, device='cuda:3')
compute distance is  tensor(139.2137, device='cuda:3')
compute norm is  tensor(55.3393, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.8047, device='cuda:3')
compute distance is  tensor(129.8047, device='cuda:3')
compute norm is  tensor(55.1421, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4823, device='cuda:3')
compute distance is  tensor(132.4823, device='cuda:3')
compute norm is  tensor(55.2871, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.1331, device='cuda:3')
compute distance is  tensor(120.1331, device='cuda:3')
compute norm is  tensor(55.1051, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.7399, device='cuda:3')
compute distance is  tensor(139.7399, device='cuda:3')
compute norm is  tensor(55.3687, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.2190, device='cuda:3')
compute distance is  tensor(141.2190, device='cuda:3')
compute norm is  tensor(55.4155, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8530, device='cuda:3')
compute distance is  tensor(131.8530, device='cuda:3')
compute norm is  tensor(55.2583, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.8651, device='cuda:3')
compute distance is  tensor(134.8651, device='cuda:3')
compute norm is  tensor(55.3547, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.8001, device='cuda:3')
compute distance is  tensor(130.8001, device='cuda:3')
compute norm is  tensor(55.2570, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(141.2190, device='cuda:3')
distance x is tensor(107599.4766, device='cuda:3')
distance x is tensor(107599.4766, device='cuda:3')
________________________________
test distance is  tensor(107599.4766, device='cuda:3')
test distance1 is  tensor(107599.4766, device='cuda:3')
test similarity is  tensor(0.3588, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130089202187519.45
test entropy is  0.0
________________________________
cal ratio is  0.03550320989692043
distance x is tensor(3820.1323, device='cuda:3')
cal_distance is  tensor(3820.1323, device='cuda:3')
cal ratio is  0.18842281886932863
distance x is tensor(719.8041, device='cuda:3')
cal_distance is  tensor(719.8041, device='cuda:3')
cal ratio is  0.43407575707894946
distance x is tensor(312.4524, device='cuda:3')
cal_distance is  tensor(312.4524, device='cuda:3')
cal ratio is  0.6588412758984716
distance x is tensor(205.8582, device='cuda:3')
cal_distance is  tensor(205.8582, device='cuda:3')
cal ratio is  0.8116869510740716
distance x is tensor(167.0934, device='cuda:3')
cal_distance is  tensor(167.0934, device='cuda:3')
cal ratio is  0.9009341169671549
distance x is tensor(150.5407, device='cuda:3')
cal_distance is  tensor(150.5407, device='cuda:3')
cal ratio is  0.949173888778227
distance x is tensor(142.8895, device='cuda:3')
cal_distance is  tensor(142.8895, device='cuda:3')
cal ratio is  0.9742547277615319
distance x is tensor(139.2109, device='cuda:3')
cal_distance is  tensor(139.2109, device='cuda:3')
distance x is tensor(139.2109, device='cuda:3')
return_distance is  tensor(139.2109, device='cuda:3')
distance x is tensor(139.2009, device='cuda:3')
distance x is tensor(139.2009, device='cuda:3')
________________________________
test distance is  tensor(139.2009, device='cuda:3')
test distance1 is  tensor(139.2009, device='cuda:3')
test similarity is  tensor(0.9713, device='cuda:3')
test acc is  0.29693333348967277
test loss is 47.676210749123904
test entropy is  0.039242327305252976
________________________________
0
distance x is tensor(139.2009, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.03892992445250858
avg test loss is  47.67029859058893
avg accuracy is  0.8582333334896564
solo acc is  0.29638333348967283
compute similarity  is  tensor(0.9713, device='cuda:3')
compute_distance is  tensor(139.2009, device='cuda:3')
compute_norm is  tensor(57.8855, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.0681, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8945493243777676
avg test loss is  1.3227409442096376
avg accuracy is  0.8640500001563227
solo acc is  0.3299833334896735
compute similarity  is  tensor(0.9707, device='cuda:3')
compute_distance is  tensor(137.0681, device='cuda:3')
compute_norm is  tensor(57.3377, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.1718, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8523546705749243
avg test loss is  1.4225126708240143
avg accuracy is  0.8623833334896561
solo acc is  0.2584000001563385
compute similarity  is  tensor(0.9703, device='cuda:3')
compute_distance is  tensor(138.1718, device='cuda:3')
compute_norm is  tensor(57.0358, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.9268, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8513005645925811
avg test loss is  1.3926965229546846
avg accuracy is  0.864183333489656
solo acc is  0.25923333348967187
compute similarity  is  tensor(0.9701, device='cuda:3')
compute_distance is  tensor(138.9268, device='cuda:3')
compute_norm is  tensor(56.7450, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.6412, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8507531109267968
avg test loss is  1.3727774334106364
avg accuracy is  0.8652500001563227
solo acc is  0.25601666682300506
compute similarity  is  tensor(0.9698, device='cuda:3')
compute_distance is  tensor(139.6412, device='cuda:3')
compute_norm is  tensor(56.4610, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.3231, device='cuda:3')
distance x is tensor(140.3231, device='cuda:3')
________________________________
test distance is  tensor(140.3231, device='cuda:3')
test distance1 is  tensor(140.3231, device='cuda:3')
test similarity is  tensor(0.9696, device='cuda:3')
test acc is  0.24690000015633817
test loss is 1.3728114723650886
test entropy is  0.8389071354479678
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2574012279510498
mal norm is  tensor(682.5971, device='cuda:3')
distance x is tensor(140.3316, device='cuda:3')
mal distance is  tensor(140.3316, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(13.4595, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(429.9767, device='cuda:3')
user_param_square tensor(76.0740, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-14.8770, device='cuda:3')
score : tensor(-0.1620, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.8049, device='cuda:3')
user_param_square tensor(89.8502, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-15.4237, device='cuda:3')
score : tensor(-0.1675, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.3800, device='cuda:3')
user_param_square tensor(82.9633, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(2.8182, device='cuda:3')
score : tensor(0.0149, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.3759, device='cuda:3')
user_param_square tensor(85.2039, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-23.9619, device='cuda:3')
score : tensor(-0.2529, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.4888, device='cuda:3')
user_param_square tensor(85.4495, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-8.0930, device='cuda:3')
score : tensor(-0.0942, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.7503, device='cuda:3')
user_param_square tensor(88.0301, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-25.2161, device='cuda:3')
score : tensor(-0.2654, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.7670, device='cuda:3')
user_param_square tensor(79.6007, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(15.5574, device='cuda:3')
score : tensor(0.1423, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.1671, device='cuda:3')
user_param_square tensor(86.5978, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-8.7077, device='cuda:3')
score : tensor(-0.1003, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5971, device='cuda:3')
user_param_square tensor(95.8509, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-20.5700, device='cuda:3')
score : tensor(-0.2190, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.6114, device='cuda:3')
user_param_square tensor(87.9430, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(1.6438, device='cuda:3')
score : tensor(0.0032, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.2438, device='cuda:3')
user_param_square tensor(89.0557, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-9.5547, device='cuda:3')
score : tensor(-0.1088, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.4130, device='cuda:3')
user_param_square tensor(87.6211, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(2.4648, device='cuda:3')
score : tensor(0.0114, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.4975, device='cuda:3')
user_param_square tensor(89.8272, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-13.9578, device='cuda:3')
score : tensor(-0.1528, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.9846, device='cuda:3')
user_param_square tensor(88.8090, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(14.4973, device='cuda:3')
score : tensor(0.1317, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.3436, device='cuda:3')
user_param_square tensor(87.9990, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-10.1058, device='cuda:3')
score : tensor(-0.1143, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.8648, device='cuda:3')
user_param_square tensor(85.2426, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(-0.3067, device='cuda:3')
score : tensor(-0.0163, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.5891, device='cuda:3')
user_param_square tensor(85.6147, device='cuda:3')
global_param_square tensor(13.4595, device='cuda:3')
part1 is  tensor(4.4963, device='cuda:3')
score : tensor(0.0317, device='cuda:3')
accept
len accept list 6
len all weights is 6
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 89.19% 

Test Accuracy: 88.55% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6209778189659119
distance x is tensor(134.8786, device='cuda:3')
benign distance is  tensor(134.8786, device='cuda:3')
norm1 res is  tensor(0.1490, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.31146711111068726
distance x is tensor(128.5618, device='cuda:3')
benign distance is  tensor(128.5618, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.05467543751001358
distance x is tensor(106.8763, device='cuda:3')
benign distance is  tensor(106.8763, device='cuda:3')
norm1 res is  tensor(0.1148, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.30824536085128784
distance x is tensor(129.1236, device='cuda:3')
benign distance is  tensor(129.1236, device='cuda:3')
norm1 res is  tensor(0.1401, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.28133732080459595
distance x is tensor(128.7212, device='cuda:3')
benign distance is  tensor(128.7212, device='cuda:3')
norm1 res is  tensor(0.1414, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7372411489486694
distance x is tensor(131.7437, device='cuda:3')
benign distance is  tensor(131.7437, device='cuda:3')
norm1 res is  tensor(0.1407, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5417100787162781
distance x is tensor(116.0362, device='cuda:3')
benign distance is  tensor(116.0362, device='cuda:3')
norm1 res is  tensor(0.1218, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.6333147287368774
distance x is tensor(122.5339, device='cuda:3')
benign distance is  tensor(122.5339, device='cuda:3')
norm1 res is  tensor(0.1357, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.35434824228286743
distance x is tensor(140.0715, device='cuda:3')
benign distance is  tensor(140.0715, device='cuda:3')
norm1 res is  tensor(0.1516, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.38534942269325256
distance x is tensor(138.5989, device='cuda:3')
benign distance is  tensor(138.5989, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.17843559384346008
distance x is tensor(116.5524, device='cuda:3')
benign distance is  tensor(116.5524, device='cuda:3')
norm1 res is  tensor(0.1252, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.4148644804954529
distance x is tensor(139.5581, device='cuda:3')
benign distance is  tensor(139.5581, device='cuda:3')
norm1 res is  tensor(0.1506, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.5223870277404785
distance x is tensor(121.9112, device='cuda:3')
benign distance is  tensor(121.9112, device='cuda:3')
norm1 res is  tensor(0.1332, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.3136591911315918
distance x is tensor(144.4540, device='cuda:3')
benign distance is  tensor(144.4540, device='cuda:3')
norm1 res is  tensor(0.1538, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.1634344458580017
distance x is tensor(135.2497, device='cuda:3')
benign distance is  tensor(135.2497, device='cuda:3')
norm1 res is  tensor(0.1490, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.6220306158065796
distance x is tensor(125.9885, device='cuda:3')
benign distance is  tensor(125.9885, device='cuda:3')
norm1 res is  tensor(0.1362, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(120.1694, device='cuda:3')
compute distance is  tensor(120.1694, device='cuda:3')
compute norm is  tensor(55.1294, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6312, device='cuda:3')
compute distance is  tensor(129.6312, device='cuda:3')
compute norm is  tensor(55.3721, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5808, device='cuda:3')
compute distance is  tensor(135.5808, device='cuda:3')
compute norm is  tensor(55.4826, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9028, device='cuda:3')
compute distance is  tensor(130.9028, device='cuda:3')
compute norm is  tensor(55.3237, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2271, device='cuda:3')
compute distance is  tensor(129.2271, device='cuda:3')
compute norm is  tensor(55.4274, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.0373, device='cuda:3')
compute distance is  tensor(147.0373, device='cuda:3')
compute norm is  tensor(55.7503, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6840, device='cuda:3')
compute distance is  tensor(133.6840, device='cuda:3')
compute norm is  tensor(55.3682, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7579, device='cuda:3')
compute distance is  tensor(131.7579, device='cuda:3')
compute norm is  tensor(55.3654, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.2421, device='cuda:3')
compute distance is  tensor(142.2421, device='cuda:3')
compute norm is  tensor(55.4798, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.8995, device='cuda:3')
compute distance is  tensor(125.8995, device='cuda:3')
compute norm is  tensor(55.4178, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6500, device='cuda:3')
compute distance is  tensor(130.6500, device='cuda:3')
compute norm is  tensor(55.3749, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7403, device='cuda:3')
compute distance is  tensor(121.7403, device='cuda:3')
compute norm is  tensor(55.2661, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.0373, device='cuda:3')
distance x is tensor(107601.2656, device='cuda:3')
distance x is tensor(107601.2656, device='cuda:3')
________________________________
test distance is  tensor(107601.2656, device='cuda:3')
test distance1 is  tensor(107601.2656, device='cuda:3')
test similarity is  tensor(0.3544, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130204111101690.0
test entropy is  0.0
________________________________
cal ratio is  0.036226902039423456
distance x is tensor(3898.0662, device='cuda:3')
cal_distance is  tensor(3898.0662, device='cuda:3')
cal ratio is  0.1903335279324649
distance x is tensor(741.9367, device='cuda:3')
cal_distance is  tensor(741.9367, device='cuda:3')
cal ratio is  0.43627112187185546
distance x is tensor(323.6884, device='cuda:3')
cal_distance is  tensor(323.6884, device='cuda:3')
cal ratio is  0.6605053067564479
distance x is tensor(213.7996, device='cuda:3')
cal_distance is  tensor(213.7996, device='cuda:3')
cal ratio is  0.8127114925373642
distance x is tensor(173.7584, device='cuda:3')
cal_distance is  tensor(173.7584, device='cuda:3')
cal ratio is  0.9015026418956101
distance x is tensor(156.6442, device='cuda:3')
cal_distance is  tensor(156.6442, device='cuda:3')
cal ratio is  0.9494733088876415
distance x is tensor(148.7297, device='cuda:3')
cal_distance is  tensor(148.7297, device='cuda:3')
cal ratio is  0.9744083358709535
distance x is tensor(144.9236, device='cuda:3')
cal_distance is  tensor(144.9236, device='cuda:3')
distance x is tensor(144.9236, device='cuda:3')
return_distance is  tensor(144.9236, device='cuda:3')
distance x is tensor(144.9135, device='cuda:3')
distance x is tensor(144.9135, device='cuda:3')
________________________________
test distance is  tensor(144.9135, device='cuda:3')
test distance1 is  tensor(144.9135, device='cuda:3')
test similarity is  tensor(0.9692, device='cuda:3')
test acc is  0.18710000015633566
test loss is 88.79691926350218
test entropy is  0.018392151752291603
________________________________
0
distance x is tensor(144.9135, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.018110373989334697
avg test loss is  89.01442820990263
avg accuracy is  0.8287833334896575
solo acc is  0.18808333348966905
compute similarity  is  tensor(0.9692, device='cuda:3')
compute_distance is  tensor(144.9135, device='cuda:3')
compute_norm is  tensor(58.2542, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.4539, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.961849009367957
avg test loss is  1.4350575751333094
avg accuracy is  0.8114666668229916
solo acc is  0.2963000001563394
compute similarity  is  tensor(0.9692, device='cuda:3')
compute_distance is  tensor(144.4539, device='cuda:3')
compute_norm is  tensor(58.2977, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.2133, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9057347798652486
avg test loss is  1.4973487038093845
avg accuracy is  0.8125833334896582
solo acc is  0.2459166668230048
compute similarity  is  tensor(0.9689, device='cuda:3')
compute_distance is  tensor(145.2133, device='cuda:3')
compute_norm is  tensor(58.0145, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.8282, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8914415198348479
avg test loss is  1.4774589835961998
avg accuracy is  0.8170500001563247
solo acc is  0.23591666682300444
compute similarity  is  tensor(0.9687, device='cuda:3')
compute_distance is  tensor(145.8282, device='cuda:3')
compute_norm is  tensor(57.7322, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.3382, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8842285215727556
avg test loss is  1.4473570125189417
avg accuracy is  0.8181333334896579
solo acc is  0.23781666682300454
compute similarity  is  tensor(0.9686, device='cuda:3')
compute_distance is  tensor(146.3382, device='cuda:3')
compute_norm is  tensor(57.4511, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.7710, device='cuda:3')
distance x is tensor(146.7710, device='cuda:3')
________________________________
test distance is  tensor(146.7710, device='cuda:3')
test distance1 is  tensor(146.7710, device='cuda:3')
test similarity is  tensor(0.9684, device='cuda:3')
test acc is  0.23388333348967105
test loss is 1.4344084972003375
test entropy is  0.8715498259962241
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3075209856033325
mal norm is  tensor(708.3772, device='cuda:3')
distance x is tensor(146.7794, device='cuda:3')
mal distance is  tensor(146.7794, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(20.3371, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.3796, device='cuda:3')
user_param_square tensor(108.0798, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(-30.1441, device='cuda:3')
score : tensor(-0.3216, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.0566, device='cuda:3')
user_param_square tensor(106.4375, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(-13.9604, device='cuda:3')
score : tensor(-0.1597, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(452.2545, device='cuda:3')
user_param_square tensor(95.9039, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(56.0931, device='cuda:3')
score : tensor(0.5408, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.2831, device='cuda:3')
user_param_square tensor(105.1134, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2982, device='cuda:3')
score : tensor(0.1428, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.5801, device='cuda:3')
user_param_square tensor(105.2388, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(12.2226, device='cuda:3')
score : tensor(0.1021, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.9611, device='cuda:3')
user_param_square tensor(106.3327, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(-60.0176, device='cuda:3')
score : tensor(-0.6203, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(480.3080, device='cuda:3')
user_param_square tensor(98.8336, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(-41.0693, device='cuda:3')
score : tensor(-0.4308, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.5292, device='cuda:3')
user_param_square tensor(104.2631, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(-28.3613, device='cuda:3')
score : tensor(-0.3037, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.3772, device='cuda:3')
user_param_square tensor(120.0265, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(16.2226, device='cuda:3')
score : tensor(0.1421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.3880, device='cuda:3')
user_param_square tensor(108.2685, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(4.2149, device='cuda:3')
score : tensor(0.0220, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7808, device='cuda:3')
user_param_square tensor(112.3606, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(-50.6965, device='cuda:3')
score : tensor(-0.5271, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.0836, device='cuda:3')
user_param_square tensor(103.0421, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(18.8874, device='cuda:3')
score : tensor(0.1687, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.3143, device='cuda:3')
user_param_square tensor(108.5430, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(36.2228, device='cuda:3')
score : tensor(0.3421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.5566, device='cuda:3')
user_param_square tensor(109.3125, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(61.1099, device='cuda:3')
score : tensor(0.5910, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.1422, device='cuda:3')
user_param_square tensor(105.6786, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(-31.9132, device='cuda:3')
score : tensor(-0.3393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.5042, device='cuda:3')
user_param_square tensor(109.0281, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(-3.9923, device='cuda:3')
score : tensor(-0.0601, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.0851, device='cuda:3')
user_param_square tensor(105.9614, device='cuda:3')
global_param_square tensor(20.3371, device='cuda:3')
part1 is  tensor(3.0773, device='cuda:3')
score : tensor(0.0106, device='cuda:3')
accept
len accept list 20
len all weights is 20
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 85.85% 

Test Accuracy: 85.04% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1769544929265976
distance x is tensor(148.7099, device='cuda:3')
benign distance is  tensor(148.7099, device='cuda:3')
norm1 res is  tensor(0.1590, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8099579811096191
distance x is tensor(147.7341, device='cuda:3')
benign distance is  tensor(147.7341, device='cuda:3')
norm1 res is  tensor(0.1553, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.22530122101306915
distance x is tensor(140.0990, device='cuda:3')
benign distance is  tensor(140.0990, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4568091034889221
distance x is tensor(138.9535, device='cuda:3')
benign distance is  tensor(138.9535, device='cuda:3')
norm1 res is  tensor(0.1413, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.42593008279800415
distance x is tensor(152.0265, device='cuda:3')
benign distance is  tensor(152.0265, device='cuda:3')
norm1 res is  tensor(0.1577, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8909549713134766
distance x is tensor(140.7085, device='cuda:3')
benign distance is  tensor(140.7085, device='cuda:3')
norm1 res is  tensor(0.1485, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.23931542038917542
distance x is tensor(145.3031, device='cuda:3')
benign distance is  tensor(145.3031, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.27860918641090393
distance x is tensor(152.3327, device='cuda:3')
benign distance is  tensor(152.3327, device='cuda:3')
norm1 res is  tensor(0.1643, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.43721309304237366
distance x is tensor(139.7760, device='cuda:3')
benign distance is  tensor(139.7760, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.4849260747432709
distance x is tensor(157.6261, device='cuda:3')
benign distance is  tensor(157.6261, device='cuda:3')
norm1 res is  tensor(0.1675, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.8226684331893921
distance x is tensor(139.2008, device='cuda:3')
benign distance is  tensor(139.2008, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.37734025716781616
distance x is tensor(151.4931, device='cuda:3')
benign distance is  tensor(151.4931, device='cuda:3')
norm1 res is  tensor(0.1598, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.4570353925228119
distance x is tensor(150.0000, device='cuda:3')
benign distance is  tensor(150.0000, device='cuda:3')
norm1 res is  tensor(0.1583, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.36304977536201477
distance x is tensor(142.6574, device='cuda:3')
benign distance is  tensor(142.6574, device='cuda:3')
norm1 res is  tensor(0.1492, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.6353681087493896
distance x is tensor(146.7278, device='cuda:3')
benign distance is  tensor(146.7278, device='cuda:3')
norm1 res is  tensor(0.1535, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.27196067571640015
distance x is tensor(136.6098, device='cuda:3')
benign distance is  tensor(136.6098, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(137.5027, device='cuda:3')
compute distance is  tensor(137.5027, device='cuda:3')
compute norm is  tensor(56.8814, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9933, device='cuda:3')
compute distance is  tensor(132.9933, device='cuda:3')
compute norm is  tensor(56.7766, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.9334, device='cuda:3')
compute distance is  tensor(148.9334, device='cuda:3')
compute norm is  tensor(57.0890, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.3095, device='cuda:3')
compute distance is  tensor(141.3095, device='cuda:3')
compute norm is  tensor(56.8044, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.2118, device='cuda:3')
compute distance is  tensor(157.2118, device='cuda:3')
compute norm is  tensor(57.3173, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.1918, device='cuda:3')
compute distance is  tensor(151.1918, device='cuda:3')
compute norm is  tensor(57.1484, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.1806, device='cuda:3')
compute distance is  tensor(145.1806, device='cuda:3')
compute norm is  tensor(56.8777, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2486, device='cuda:3')
compute distance is  tensor(135.2486, device='cuda:3')
compute norm is  tensor(56.6205, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7555, device='cuda:3')
compute distance is  tensor(146.7555, device='cuda:3')
compute norm is  tensor(56.9291, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.9260, device='cuda:3')
compute distance is  tensor(149.9260, device='cuda:3')
compute norm is  tensor(57.0343, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3152, device='cuda:3')
compute distance is  tensor(146.3152, device='cuda:3')
compute norm is  tensor(57.0174, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7012, device='cuda:3')
compute distance is  tensor(133.7012, device='cuda:3')
compute norm is  tensor(56.7804, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.2118, device='cuda:3')
distance x is tensor(107551.0859, device='cuda:3')
distance x is tensor(107551.0859, device='cuda:3')
________________________________
test distance is  tensor(107551.0859, device='cuda:3')
test distance1 is  tensor(107551.0859, device='cuda:3')
test similarity is  tensor(0.4569, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130070599152533.02
test entropy is  0.0
________________________________
cal ratio is  0.037468066289885096
distance x is tensor(4029.7363, device='cuda:3')
cal_distance is  tensor(4029.7363, device='cuda:3')
cal ratio is  0.19356657564856602
distance x is tensor(780.0263, device='cuda:3')
cal_distance is  tensor(780.0263, device='cuda:3')
cal ratio is  0.4399608664693354
distance x is tensor(343.1839, device='cuda:3')
cal_distance is  tensor(343.1839, device='cuda:3')
cal ratio is  0.6632927165933026
distance x is tensor(227.6331, device='cuda:3')
cal_distance is  tensor(227.6331, device='cuda:3')
cal ratio is  0.8144247726518569
distance x is tensor(185.3910, device='cuda:3')
cal_distance is  tensor(185.3910, device='cuda:3')
cal ratio is  0.902452559135647
distance x is tensor(167.3071, device='cuda:3')
cal_distance is  tensor(167.3071, device='cuda:3')
cal ratio is  0.9499735889402551
distance x is tensor(158.9376, device='cuda:3')
cal_distance is  tensor(158.9376, device='cuda:3')
cal ratio is  0.9746650884754026
distance x is tensor(154.9110, device='cuda:3')
cal_distance is  tensor(154.9110, device='cuda:3')
distance x is tensor(154.9110, device='cuda:3')
return_distance is  tensor(154.9110, device='cuda:3')
distance x is tensor(154.9009, device='cuda:3')
distance x is tensor(154.9009, device='cuda:3')
________________________________
test distance is  tensor(154.9009, device='cuda:3')
test distance1 is  tensor(154.9009, device='cuda:3')
test similarity is  tensor(0.9723, device='cuda:3')
test acc is  0.1905666668230025
test loss is 46.79081466406393
test entropy is  0.03858970408104479
________________________________
0
distance x is tensor(154.9009, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.03938364540481183
avg test loss is  46.64275139887958
avg accuracy is  0.8205666668229911
solo acc is  0.18943333348966923
compute similarity  is  tensor(0.9723, device='cuda:3')
compute_distance is  tensor(154.9009, device='cuda:3')
compute_norm is  tensor(60.6354, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.2495, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8886513183238918
avg test loss is  1.343660258725762
avg accuracy is  0.7306833334896623
solo acc is  0.3048500001563397
compute similarity  is  tensor(0.9734, device='cuda:3')
compute_distance is  tensor(145.2495, device='cuda:3')
compute_norm is  tensor(60.2848, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(145.2495, device='cuda:3')
distance x is tensor(145.2495, device='cuda:3')
________________________________
test distance is  tensor(145.2495, device='cuda:3')
test distance1 is  tensor(145.2495, device='cuda:3')
test similarity is  tensor(0.9734, device='cuda:3')
test acc is  0.3031500001563396
test loss is 1.3463381085314476
test entropy is  0.8908713307462013
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.0935722589492798
mal norm is  tensor(765.6315, device='cuda:3')
distance x is tensor(145.2585, device='cuda:3')
mal distance is  tensor(145.2585, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(26.4976, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7896, device='cuda:3')
user_param_square tensor(128.6680, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(180.6641, device='cuda:3')
score : tensor(1.7803, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.5089, device='cuda:3')
user_param_square tensor(127.6050, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(212.7819, device='cuda:3')
score : tensor(2.1015, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.1774, device='cuda:3')
user_param_square tensor(123.0238, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(323.6732, device='cuda:3')
score : tensor(3.2104, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.8109, device='cuda:3')
user_param_square tensor(121.6847, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(157.2165, device='cuda:3')
score : tensor(1.5459, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.4710, device='cuda:3')
user_param_square tensor(128.7381, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(272.1696, device='cuda:3')
score : tensor(2.6954, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.9057, device='cuda:3')
user_param_square tensor(124.9184, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(183.2763, device='cuda:3')
score : tensor(1.8065, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.5416, device='cuda:3')
user_param_square tensor(124.1349, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(166.7362, device='cuda:3')
score : tensor(1.6411, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.8225, device='cuda:3')
user_param_square tensor(130.5116, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(126.0757, device='cuda:3')
score : tensor(1.2345, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6315, device='cuda:3')
user_param_square tensor(142.4339, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(-88.5711, device='cuda:3')
score : tensor(-0.9120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.4398, device='cuda:3')
user_param_square tensor(132.8875, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(204.6266, device='cuda:3')
score : tensor(2.0200, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.0333, device='cuda:3')
user_param_square tensor(142.0988, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(101.7213, device='cuda:3')
score : tensor(0.9909, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.1431, device='cuda:3')
user_param_square tensor(138.1379, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(160.4231, device='cuda:3')
score : tensor(1.5779, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.3658, device='cuda:3')
user_param_square tensor(133.3777, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(187.4194, device='cuda:3')
score : tensor(1.8479, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.5484, device='cuda:3')
user_param_square tensor(135.1717, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(181.6526, device='cuda:3')
score : tensor(1.7902, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.2251, device='cuda:3')
user_param_square tensor(131.7646, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(163.1680, device='cuda:3')
score : tensor(1.6054, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.5254, device='cuda:3')
user_param_square tensor(132.0960, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(197.1848, device='cuda:3')
score : tensor(1.9456, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.4265, device='cuda:3')
user_param_square tensor(131.2812, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(189.1989, device='cuda:3')
score : tensor(1.8657, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.6718, device='cuda:3')
user_param_square tensor(133.0102, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(197.4005, device='cuda:3')
score : tensor(1.9477, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.0320, device='cuda:3')
user_param_square tensor(129.3091, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(221.6890, device='cuda:3')
score : tensor(2.1906, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.2794, device='cuda:3')
user_param_square tensor(135.9274, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(142.0740, device='cuda:3')
score : tensor(1.3944, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.7573, device='cuda:3')
user_param_square tensor(132.3197, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(177.8270, device='cuda:3')
score : tensor(1.7520, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.1997, device='cuda:3')
user_param_square tensor(130.8540, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(195.9548, device='cuda:3')
score : tensor(1.9333, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.3251, device='cuda:3')
user_param_square tensor(135.7368, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(185.9144, device='cuda:3')
score : tensor(1.8328, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.5759, device='cuda:3')
user_param_square tensor(133.2992, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(146.4893, device='cuda:3')
score : tensor(1.4386, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.1271, device='cuda:3')
user_param_square tensor(132.8563, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(170.9577, device='cuda:3')
score : tensor(1.6833, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.4025, device='cuda:3')
user_param_square tensor(137.0072, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(140.9612, device='cuda:3')
score : tensor(1.3833, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.6912, device='cuda:3')
user_param_square tensor(134.3008, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(202.5539, device='cuda:3')
score : tensor(1.9992, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.9321, device='cuda:3')
user_param_square tensor(127.2331, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(177.8382, device='cuda:3')
score : tensor(1.7521, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.4911, device='cuda:3')
user_param_square tensor(136.5315, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(211.5504, device='cuda:3')
score : tensor(2.0892, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.7112, device='cuda:3')
user_param_square tensor(130.7032, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(211.1386, device='cuda:3')
score : tensor(2.0851, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.1708, device='cuda:3')
user_param_square tensor(137.3712, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(205.5909, device='cuda:3')
score : tensor(2.0296, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.0140, device='cuda:3')
user_param_square tensor(134.0364, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(179.9449, device='cuda:3')
score : tensor(1.7732, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.9788, device='cuda:3')
user_param_square tensor(130.9328, device='cuda:3')
global_param_square tensor(26.4976, device='cuda:3')
part1 is  tensor(188.0058, device='cuda:3')
score : tensor(1.8538, device='cuda:3')
accept
len accept list 32
len all weights is 32
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.41% 

Test Accuracy: 88.81% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5458018183708191
distance x is tensor(104.2794, device='cuda:3')
benign distance is  tensor(104.2794, device='cuda:3')
norm1 res is  tensor(0.1152, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.0959231853485107
distance x is tensor(135.2997, device='cuda:3')
benign distance is  tensor(135.2997, device='cuda:3')
norm1 res is  tensor(0.1544, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.286242812871933
distance x is tensor(117.1434, device='cuda:3')
benign distance is  tensor(117.1434, device='cuda:3')
norm1 res is  tensor(0.1273, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4210258424282074
distance x is tensor(108.5766, device='cuda:3')
benign distance is  tensor(108.5766, device='cuda:3')
norm1 res is  tensor(0.1164, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.469158411026001
distance x is tensor(112.1700, device='cuda:3')
benign distance is  tensor(112.1700, device='cuda:3')
norm1 res is  tensor(0.1190, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5945965051651001
distance x is tensor(129.5805, device='cuda:3')
benign distance is  tensor(129.5805, device='cuda:3')
norm1 res is  tensor(0.1368, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.6083776354789734
distance x is tensor(107.5959, device='cuda:3')
benign distance is  tensor(107.5959, device='cuda:3')
norm1 res is  tensor(0.1142, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5903938412666321
distance x is tensor(121.0578, device='cuda:3')
benign distance is  tensor(121.0578, device='cuda:3')
norm1 res is  tensor(0.1314, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.20576195418834686
distance x is tensor(143.3001, device='cuda:3')
benign distance is  tensor(143.3001, device='cuda:3')
norm1 res is  tensor(0.1543, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.49645861983299255
distance x is tensor(128.2697, device='cuda:3')
benign distance is  tensor(128.2697, device='cuda:3')
norm1 res is  tensor(0.1398, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.598588228225708
distance x is tensor(122.3627, device='cuda:3')
benign distance is  tensor(122.3627, device='cuda:3')
norm1 res is  tensor(0.1329, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6444878578186035
distance x is tensor(123.6026, device='cuda:3')
benign distance is  tensor(123.6026, device='cuda:3')
norm1 res is  tensor(0.1332, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.28236132860183716
distance x is tensor(114.4603, device='cuda:3')
benign distance is  tensor(114.4603, device='cuda:3')
norm1 res is  tensor(0.1257, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.43779173493385315
distance x is tensor(131.3130, device='cuda:3')
benign distance is  tensor(131.3130, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.6522265672683716
distance x is tensor(122.5656, device='cuda:3')
benign distance is  tensor(122.5656, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.5766655206680298
distance x is tensor(120.3994, device='cuda:3')
benign distance is  tensor(120.3994, device='cuda:3')
norm1 res is  tensor(0.1281, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.25343212485313416
distance x is tensor(126.6442, device='cuda:3')
benign distance is  tensor(126.6442, device='cuda:3')
norm1 res is  tensor(0.1370, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.21859505772590637
distance x is tensor(120.1365, device='cuda:3')
benign distance is  tensor(120.1365, device='cuda:3')
norm1 res is  tensor(0.1283, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.3656070828437805
distance x is tensor(130.3636, device='cuda:3')
benign distance is  tensor(130.3636, device='cuda:3')
norm1 res is  tensor(0.1409, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.4211854338645935
distance x is tensor(143.2665, device='cuda:3')
benign distance is  tensor(143.2665, device='cuda:3')
norm1 res is  tensor(0.1488, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.7246770262718201
distance x is tensor(127.5033, device='cuda:3')
benign distance is  tensor(127.5033, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.23545894026756287
distance x is tensor(125.4697, device='cuda:3')
benign distance is  tensor(125.4697, device='cuda:3')
norm1 res is  tensor(0.1392, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.9292253255844116
distance x is tensor(145.7863, device='cuda:3')
benign distance is  tensor(145.7863, device='cuda:3')
norm1 res is  tensor(0.1591, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.43114298582077026
distance x is tensor(121.6621, device='cuda:3')
benign distance is  tensor(121.6621, device='cuda:3')
norm1 res is  tensor(0.1328, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.2262718230485916
distance x is tensor(132.5242, device='cuda:3')
benign distance is  tensor(132.5242, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.21587395668029785
distance x is tensor(129.2521, device='cuda:3')
benign distance is  tensor(129.2521, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.2706602215766907
distance x is tensor(126.1614, device='cuda:3')
benign distance is  tensor(126.1614, device='cuda:3')
norm1 res is  tensor(0.1370, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.06523048877716064
distance x is tensor(129.8440, device='cuda:3')
benign distance is  tensor(129.8440, device='cuda:3')
norm1 res is  tensor(0.1409, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.8945385813713074
distance x is tensor(124.5391, device='cuda:3')
benign distance is  tensor(124.5391, device='cuda:3')
norm1 res is  tensor(0.1340, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.5471302270889282
distance x is tensor(115.2245, device='cuda:3')
benign distance is  tensor(115.2245, device='cuda:3')
norm1 res is  tensor(0.1221, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.8490403294563293
distance x is tensor(135.6892, device='cuda:3')
benign distance is  tensor(135.6892, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.3984128534793854
distance x is tensor(124.8370, device='cuda:3')
benign distance is  tensor(124.8370, device='cuda:3')
norm1 res is  tensor(0.1318, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(127.6200, device='cuda:3')
compute distance is  tensor(127.6200, device='cuda:3')
compute norm is  tensor(55.7404, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9589, device='cuda:3')
compute distance is  tensor(119.9589, device='cuda:3')
compute norm is  tensor(55.7518, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1669, device='cuda:3')
compute distance is  tensor(138.1669, device='cuda:3')
compute norm is  tensor(56.0680, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8466, device='cuda:3')
compute distance is  tensor(131.8466, device='cuda:3')
compute norm is  tensor(55.8676, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7715, device='cuda:3')
compute distance is  tensor(130.7715, device='cuda:3')
compute norm is  tensor(56.0603, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0247, device='cuda:3')
compute distance is  tensor(134.0247, device='cuda:3')
compute norm is  tensor(56.0745, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1711, device='cuda:3')
compute distance is  tensor(122.1711, device='cuda:3')
compute norm is  tensor(55.7750, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8933, device='cuda:3')
compute distance is  tensor(127.8933, device='cuda:3')
compute norm is  tensor(55.9957, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.2026, device='cuda:3')
compute distance is  tensor(143.2026, device='cuda:3')
compute norm is  tensor(56.2843, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.3769, device='cuda:3')
compute distance is  tensor(122.3769, device='cuda:3')
compute norm is  tensor(55.9171, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.3928, device='cuda:3')
compute distance is  tensor(130.3928, device='cuda:3')
compute norm is  tensor(55.8926, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6684, device='cuda:3')
compute distance is  tensor(129.6684, device='cuda:3')
compute norm is  tensor(56.0708, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(143.2026, device='cuda:3')
distance x is tensor(107586.9453, device='cuda:3')
distance x is tensor(107586.9453, device='cuda:3')
________________________________
test distance is  tensor(107586.9453, device='cuda:3')
test distance1 is  tensor(107586.9453, device='cuda:3')
test similarity is  tensor(0.3892, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130131180320161.03
test entropy is  0.0
________________________________
cal ratio is  0.035753762575935294
distance x is tensor(3846.6440, device='cuda:3')
cal_distance is  tensor(3846.6440, device='cuda:3')
cal ratio is  0.1890865046536746
distance x is tensor(727.3525, device='cuda:3')
cal_distance is  tensor(727.3525, device='cuda:3')
cal ratio is  0.43483958837564896
distance x is tensor(316.2845, device='cuda:3')
cal_distance is  tensor(316.2845, device='cuda:3')
cal ratio is  0.6594206615746235
distance x is tensor(208.5663, device='cuda:3')
cal_distance is  tensor(208.5663, device='cuda:3')
cal ratio is  0.8120438353939698
distance x is tensor(169.3659, device='cuda:3')
cal_distance is  tensor(169.3659, device='cuda:3')
cal ratio is  0.9011321775029114
distance x is tensor(152.6216, device='cuda:3')
cal_distance is  tensor(152.6216, device='cuda:3')
cal ratio is  0.9492782789613896
distance x is tensor(144.8806, device='cuda:3')
cal_distance is  tensor(144.8806, device='cuda:3')
cal ratio is  0.9743082245560336
distance x is tensor(141.1585, device='cuda:3')
cal_distance is  tensor(141.1585, device='cuda:3')
distance x is tensor(141.1585, device='cuda:3')
return_distance is  tensor(141.1585, device='cuda:3')
distance x is tensor(141.1484, device='cuda:3')
distance x is tensor(141.1484, device='cuda:3')
________________________________
test distance is  tensor(141.1484, device='cuda:3')
test distance1 is  tensor(141.1484, device='cuda:3')
test similarity is  tensor(0.9726, device='cuda:3')
test acc is  0.2846333334896725
test loss is 40.05427043931062
test entropy is  0.04783863535990863
________________________________
0
distance x is tensor(141.1484, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.04852075402467037
avg test loss is  40.01424304051186
avg accuracy is  0.8802833334896554
solo acc is  0.28218333348967256
compute similarity  is  tensor(0.9726, device='cuda:3')
compute_distance is  tensor(141.1484, device='cuda:3')
compute_norm is  tensor(58.8760, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.2023, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9037285997415148
avg test loss is  1.3029219403322825
avg accuracy is  0.8534333334896564
solo acc is  0.33441666682300686
compute similarity  is  tensor(0.9727, device='cuda:3')
compute_distance is  tensor(137.2023, device='cuda:3')
compute_norm is  tensor(58.4731, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.2147, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8580517726285117
avg test loss is  1.4062524549742497
avg accuracy is  0.8489166668229899
solo acc is  0.2623500001563386
compute similarity  is  tensor(0.9725, device='cuda:3')
compute_distance is  tensor(138.2147, device='cuda:3')
compute_norm is  tensor(58.1726, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.8831, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8511412748014495
avg test loss is  1.3881600510591128
avg accuracy is  0.8504666668229899
solo acc is  0.2566166668230051
compute similarity  is  tensor(0.9723, device='cuda:3')
compute_distance is  tensor(138.8831, device='cuda:3')
compute_norm is  tensor(57.8810, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.5133, device='cuda:3')
exit early
distance x is tensor(139.5133, device='cuda:3')
distance x is tensor(139.5133, device='cuda:3')
________________________________
test distance is  tensor(139.5133, device='cuda:3')
test distance1 is  tensor(139.5133, device='cuda:3')
test similarity is  tensor(0.9721, device='cuda:3')
test acc is  0.2469166668230048
test loss is 1.384717929210744
test entropy is  0.8473820181162373
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1865804195404053
mal norm is  tensor(688.7935, device='cuda:3')
distance x is tensor(139.5221, device='cuda:3')
mal distance is  tensor(139.5221, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(16.0138, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.5449, device='cuda:3')
user_param_square tensor(85.3169, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-10.5180, device='cuda:3')
score : tensor(-0.1210, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.0921, device='cuda:3')
user_param_square tensor(94.8747, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-21.5908, device='cuda:3')
score : tensor(-0.2317, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.8201, device='cuda:3')
user_param_square tensor(89.3756, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(6.1482, device='cuda:3')
score : tensor(0.0457, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(453.6455, device='cuda:3')
user_param_square tensor(85.2325, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-25.9307, device='cuda:3')
score : tensor(-0.2751, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.3416, device='cuda:3')
user_param_square tensor(86.7868, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-6.9666, device='cuda:3')
score : tensor(-0.0855, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.9958, device='cuda:3')
user_param_square tensor(93.2492, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-53.7510, device='cuda:3')
score : tensor(-0.5533, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(451.6967, device='cuda:3')
user_param_square tensor(85.0492, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-24.7074, device='cuda:3')
score : tensor(-0.2629, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.0174, device='cuda:3')
user_param_square tensor(90.7268, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-21.1794, device='cuda:3')
score : tensor(-0.2276, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7935, device='cuda:3')
user_param_square tensor(105.0247, device='cuda:3')
global_param_square tensor(16.0138, device='cuda:3')
part1 is  tensor(-2.0648, device='cuda:3')
score : tensor(-0.0365, device='cuda:3')
len accept list 1
len all weights is 1
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 88.06% 

Test Accuracy: 87.19% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
 benign loss is  0.46921271085739136
distance x is tensor(134.1709, device='cuda:3')
benign distance is  tensor(134.1709, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.498577356338501
distance x is tensor(136.5577, device='cuda:3')
benign distance is  tensor(136.5577, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.40604472160339355
distance x is tensor(85.3614, device='cuda:3')
benign distance is  tensor(85.3614, device='cuda:3')
norm1 res is  tensor(0.0896, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.33676496148109436
distance x is tensor(123.0455, device='cuda:3')
benign distance is  tensor(123.0455, device='cuda:3')
norm1 res is  tensor(0.1344, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.8088191747665405
distance x is tensor(126.5435, device='cuda:3')
benign distance is  tensor(126.5435, device='cuda:3')
norm1 res is  tensor(0.1341, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.40171775221824646
distance x is tensor(157.8838, device='cuda:3')
benign distance is  tensor(157.8838, device='cuda:3')
norm1 res is  tensor(0.1698, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.23687033355236053
distance x is tensor(151.5649, device='cuda:3')
benign distance is  tensor(151.5649, device='cuda:3')
norm1 res is  tensor(0.1598, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.23862464725971222
distance x is tensor(129.1366, device='cuda:3')
benign distance is  tensor(129.1366, device='cuda:3')
norm1 res is  tensor(0.1400, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(136.3220, device='cuda:3')
compute distance is  tensor(136.3220, device='cuda:3')
compute norm is  tensor(56.8952, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.2018, device='cuda:3')
compute distance is  tensor(136.2018, device='cuda:3')
compute norm is  tensor(56.8661, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.5726, device='cuda:3')
compute distance is  tensor(143.5726, device='cuda:3')
compute norm is  tensor(57.1499, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.8345, device='cuda:3')
compute distance is  tensor(149.8345, device='cuda:3')
compute norm is  tensor(57.1161, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.4615, device='cuda:3')
compute distance is  tensor(140.4615, device='cuda:3')
compute norm is  tensor(57.0303, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.1485, device='cuda:3')
compute distance is  tensor(146.1485, device='cuda:3')
compute norm is  tensor(57.1043, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.8076, device='cuda:3')
compute distance is  tensor(138.8076, device='cuda:3')
compute norm is  tensor(56.9979, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1209, device='cuda:3')
compute distance is  tensor(134.1209, device='cuda:3')
compute norm is  tensor(56.9709, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.3137, device='cuda:3')
compute distance is  tensor(159.3137, device='cuda:3')
compute norm is  tensor(57.4326, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.7428, device='cuda:3')
compute distance is  tensor(145.7428, device='cuda:3')
compute norm is  tensor(57.1876, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.5866, device='cuda:3')
compute distance is  tensor(145.5866, device='cuda:3')
compute norm is  tensor(57.1434, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.5104, device='cuda:3')
compute distance is  tensor(151.5104, device='cuda:3')
compute norm is  tensor(57.2080, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(159.3137, device='cuda:3')
distance x is tensor(107595.0078, device='cuda:3')
distance x is tensor(107595.0078, device='cuda:3')
________________________________
test distance is  tensor(107595.0078, device='cuda:3')
test distance1 is  tensor(107595.0078, device='cuda:3')
test similarity is  tensor(0.3721, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130057318412087.12
test entropy is  0.0
________________________________
cal ratio is  0.03771000791917458
distance x is tensor(4057.4146, device='cuda:3')
cal_distance is  tensor(4057.4146, device='cuda:3')
cal ratio is  0.19419050314707859
distance x is tensor(787.9153, device='cuda:3')
cal_distance is  tensor(787.9153, device='cuda:3')
cal ratio is  0.44066940772378255
distance x is tensor(347.2130, device='cuda:3')
cal_distance is  tensor(347.2130, device='cuda:3')
cal ratio is  0.663826653926836
distance x is tensor(230.4910, device='cuda:3')
cal_distance is  tensor(230.4910, device='cuda:3')
cal ratio is  0.8147524948737405
distance x is tensor(187.7941, device='cuda:3')
cal_distance is  tensor(187.7941, device='cuda:3')
cal ratio is  0.9026341464608468
distance x is tensor(169.5098, device='cuda:3')
cal_distance is  tensor(169.5098, device='cuda:3')
cal ratio is  0.9500692148969474
distance x is tensor(161.0463, device='cuda:3')
cal_distance is  tensor(161.0463, device='cuda:3')
cal ratio is  0.9747141580583877
distance x is tensor(156.9743, device='cuda:3')
cal_distance is  tensor(156.9743, device='cuda:3')
distance x is tensor(156.9743, device='cuda:3')
return_distance is  tensor(156.9743, device='cuda:3')
distance x is tensor(156.9641, device='cuda:3')
distance x is tensor(156.9641, device='cuda:3')
________________________________
test distance is  tensor(156.9641, device='cuda:3')
test distance1 is  tensor(156.9641, device='cuda:3')
test similarity is  tensor(0.9675, device='cuda:3')
test acc is  0.1685666668230013
test loss is 131.17065293854995
test entropy is  0.022525473020573422
________________________________
0
distance x is tensor(156.9641, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.022779163513075698
avg test loss is  131.03059931350415
avg accuracy is  0.7291333334896621
solo acc is  0.16743333348966782
compute similarity  is  tensor(0.9675, device='cuda:3')
compute_distance is  tensor(156.9641, device='cuda:3')
compute_norm is  tensor(60.3839, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.5464, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.914547104952432
avg test loss is  1.4105781570299347
avg accuracy is  0.8147166668229914
solo acc is  0.31611666682300643
compute similarity  is  tensor(0.9666, device='cuda:3')
compute_distance is  tensor(152.5464, device='cuda:3')
compute_norm is  tensor(60.4629, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(153.4403, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.886182734389295
avg test loss is  1.4716163592806248
avg accuracy is  0.8130166668229915
solo acc is  0.25756666682300505
compute similarity  is  tensor(0.9663, device='cuda:3')
compute_distance is  tensor(153.4403, device='cuda:3')
compute_norm is  tensor(60.1401, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(154.0485, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8684832213529899
avg test loss is  1.460134554519328
avg accuracy is  0.8154000001563246
solo acc is  0.25035000015633824
compute similarity  is  tensor(0.9661, device='cuda:3')
compute_distance is  tensor(154.0485, device='cuda:3')
compute_norm is  tensor(59.8295, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(154.5857, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8571310328013861
avg test loss is  1.440626102088611
avg accuracy is  0.8179166668229914
solo acc is  0.24581666682300474
compute similarity  is  tensor(0.9660, device='cuda:3')
compute_distance is  tensor(154.5857, device='cuda:3')
compute_norm is  tensor(59.5263, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(155.1231, device='cuda:3')
distance x is tensor(155.1231, device='cuda:3')
________________________________
test distance is  tensor(155.1231, device='cuda:3')
test distance1 is  tensor(155.1231, device='cuda:3')
test similarity is  tensor(0.9658, device='cuda:3')
test acc is  0.2434666668230047
test loss is 1.4118608181664685
test entropy is  0.8652993789486794
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1413885354995728
mal norm is  tensor(773.2164, device='cuda:3')
distance x is tensor(155.1320, device='cuda:3')
mal distance is  tensor(155.1320, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(21.7592, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.9257, device='cuda:3')
user_param_square tensor(112.0420, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-6.5662, device='cuda:3')
score : tensor(-0.0872, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.9103, device='cuda:3')
user_param_square tensor(112.5250, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(21.3125, device='cuda:3')
score : tensor(0.1916, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(350.8458, device='cuda:3')
user_param_square tensor(87.3734, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(18.0565, device='cuda:3')
score : tensor(0.1590, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.0464, device='cuda:3')
user_param_square tensor(107.4948, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(26.8908, device='cuda:3')
score : tensor(0.2473, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.3309, device='cuda:3')
user_param_square tensor(107.2196, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-26.2282, device='cuda:3')
score : tensor(-0.2838, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.4194, device='cuda:3')
user_param_square tensor(120.0570, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-23.3533, device='cuda:3')
score : tensor(-0.2551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.6141, device='cuda:3')
user_param_square tensor(116.5808, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(56.2756, device='cuda:3')
score : tensor(0.5412, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.1229, device='cuda:3')
user_param_square tensor(109.6072, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(5.5130, device='cuda:3')
score : tensor(0.0336, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.2164, device='cuda:3')
user_param_square tensor(129.7094, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(-8.4911, device='cuda:3')
score : tensor(-0.1065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.7897, device='cuda:3')
user_param_square tensor(123.9249, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(98.0938, device='cuda:3')
score : tensor(0.9594, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.0306, device='cuda:3')
user_param_square tensor(122.6224, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(97.0782, device='cuda:3')
score : tensor(0.9492, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.2933, device='cuda:3')
user_param_square tensor(119.2272, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(91.7777, device='cuda:3')
score : tensor(0.8962, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.1747, device='cuda:3')
user_param_square tensor(124.5716, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(65.5033, device='cuda:3')
score : tensor(0.6335, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.8987, device='cuda:3')
user_param_square tensor(121.7201, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(72.9013, device='cuda:3')
score : tensor(0.7075, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.9424, device='cuda:3')
user_param_square tensor(121.9026, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(11.9110, device='cuda:3')
score : tensor(0.0976, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.2664, device='cuda:3')
user_param_square tensor(122.5546, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(45.0437, device='cuda:3')
score : tensor(0.4289, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.4780, device='cuda:3')
user_param_square tensor(123.8097, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(93.7808, device='cuda:3')
score : tensor(0.9162, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.1632, device='cuda:3')
user_param_square tensor(125.9602, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(70.8007, device='cuda:3')
score : tensor(0.6864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.7973, device='cuda:3')
user_param_square tensor(130.5939, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(35.8275, device='cuda:3')
score : tensor(0.3367, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.8378, device='cuda:3')
user_param_square tensor(125.2391, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(43.6772, device='cuda:3')
score : tensor(0.4152, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(760.0605, device='cuda:3')
user_param_square tensor(128.6012, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(56.1664, device='cuda:3')
score : tensor(0.5401, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(759.6534, device='cuda:3')
user_param_square tensor(128.5668, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(61.4332, device='cuda:3')
score : tensor(0.5928, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.0167, device='cuda:3')
user_param_square tensor(126.0339, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(69.2613, device='cuda:3')
score : tensor(0.6711, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.6833, device='cuda:3')
user_param_square tensor(126.8656, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(56.2917, device='cuda:3')
score : tensor(0.5414, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8780, device='cuda:3')
user_param_square tensor(125.8492, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(59.0630, device='cuda:3')
score : tensor(0.5691, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.7122, device='cuda:3')
user_param_square tensor(125.4018, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(79.8756, device='cuda:3')
score : tensor(0.7772, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.5074, device='cuda:3')
user_param_square tensor(121.1475, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(29.1647, device='cuda:3')
score : tensor(0.2701, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.0704, device='cuda:3')
user_param_square tensor(119.2068, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(98.4096, device='cuda:3')
score : tensor(0.9625, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.0192, device='cuda:3')
user_param_square tensor(119.0195, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(54.1659, device='cuda:3')
score : tensor(0.5201, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.9557, device='cuda:3')
user_param_square tensor(117.2639, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(82.7133, device='cuda:3')
score : tensor(0.8056, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.5339, device='cuda:3')
user_param_square tensor(121.5980, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(35.2158, device='cuda:3')
score : tensor(0.3306, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.1571, device='cuda:3')
user_param_square tensor(120.3049, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(38.2416, device='cuda:3')
score : tensor(0.3609, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.3370, device='cuda:3')
user_param_square tensor(118.1311, device='cuda:3')
global_param_square tensor(21.7592, device='cuda:3')
part1 is  tensor(41.9151, device='cuda:3')
score : tensor(0.3976, device='cuda:3')
accept
len accept list 29
len all weights is 29
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.59% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3647141456604004
distance x is tensor(115.5528, device='cuda:3')
benign distance is  tensor(115.5528, device='cuda:3')
norm1 res is  tensor(0.1270, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.349971204996109
distance x is tensor(133.3531, device='cuda:3')
benign distance is  tensor(133.3531, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.12959229946136475
distance x is tensor(96.7121, device='cuda:3')
benign distance is  tensor(96.7121, device='cuda:3')
norm1 res is  tensor(0.1068, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5551868677139282
distance x is tensor(108.4055, device='cuda:3')
benign distance is  tensor(108.4055, device='cuda:3')
norm1 res is  tensor(0.1203, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7177749872207642
distance x is tensor(107.4071, device='cuda:3')
benign distance is  tensor(107.4071, device='cuda:3')
norm1 res is  tensor(0.1155, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.0777885913848877
distance x is tensor(131.8655, device='cuda:3')
benign distance is  tensor(131.8655, device='cuda:3')
norm1 res is  tensor(0.1419, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.496343195438385
distance x is tensor(130.8821, device='cuda:3')
benign distance is  tensor(130.8821, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.1514357328414917
distance x is tensor(121.9685, device='cuda:3')
benign distance is  tensor(121.9685, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.15082694590091705
distance x is tensor(130.6443, device='cuda:3')
benign distance is  tensor(130.6443, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3278176784515381
distance x is tensor(141.1890, device='cuda:3')
benign distance is  tensor(141.1890, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.3877072334289551
distance x is tensor(117.6818, device='cuda:3')
benign distance is  tensor(117.6818, device='cuda:3')
norm1 res is  tensor(0.1251, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.9136565923690796
distance x is tensor(141.6953, device='cuda:3')
benign distance is  tensor(141.6953, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.5231439471244812
distance x is tensor(127.3057, device='cuda:3')
benign distance is  tensor(127.3057, device='cuda:3')
norm1 res is  tensor(0.1412, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.34190526604652405
distance x is tensor(132.9175, device='cuda:3')
benign distance is  tensor(132.9175, device='cuda:3')
norm1 res is  tensor(0.1451, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.26734986901283264
distance x is tensor(117.6222, device='cuda:3')
benign distance is  tensor(117.6222, device='cuda:3')
norm1 res is  tensor(0.1288, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.2277449667453766
distance x is tensor(126.9328, device='cuda:3')
benign distance is  tensor(126.9328, device='cuda:3')
norm1 res is  tensor(0.1373, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.1259332299232483
distance x is tensor(125.7166, device='cuda:3')
benign distance is  tensor(125.7166, device='cuda:3')
norm1 res is  tensor(0.1360, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.7098745107650757
distance x is tensor(135.8397, device='cuda:3')
benign distance is  tensor(135.8397, device='cuda:3')
norm1 res is  tensor(0.1490, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.3001444339752197
distance x is tensor(123.0396, device='cuda:3')
benign distance is  tensor(123.0396, device='cuda:3')
norm1 res is  tensor(0.1324, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.42300233244895935
distance x is tensor(119.8850, device='cuda:3')
benign distance is  tensor(119.8850, device='cuda:3')
norm1 res is  tensor(0.1306, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.43997126817703247
distance x is tensor(122.6750, device='cuda:3')
benign distance is  tensor(122.6750, device='cuda:3')
norm1 res is  tensor(0.1362, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.6529106497764587
distance x is tensor(135.4927, device='cuda:3')
benign distance is  tensor(135.4927, device='cuda:3')
norm1 res is  tensor(0.1467, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.3695717453956604
distance x is tensor(129.8628, device='cuda:3')
benign distance is  tensor(129.8628, device='cuda:3')
norm1 res is  tensor(0.1385, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.4058837294578552
distance x is tensor(126.0468, device='cuda:3')
benign distance is  tensor(126.0468, device='cuda:3')
norm1 res is  tensor(0.1349, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.5320377945899963
distance x is tensor(122.0962, device='cuda:3')
benign distance is  tensor(122.0962, device='cuda:3')
norm1 res is  tensor(0.1333, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.4627165198326111
distance x is tensor(132.7499, device='cuda:3')
benign distance is  tensor(132.7499, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.08111335337162018
distance x is tensor(126.0094, device='cuda:3')
benign distance is  tensor(126.0094, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.11607193946838379
distance x is tensor(128.3148, device='cuda:3')
benign distance is  tensor(128.3148, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.4247407019138336
distance x is tensor(127.0733, device='cuda:3')
benign distance is  tensor(127.0733, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.3511848747730255
distance x is tensor(127.7697, device='cuda:3')
benign distance is  tensor(127.7697, device='cuda:3')
norm1 res is  tensor(0.1347, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.9305989146232605
distance x is tensor(141.3298, device='cuda:3')
benign distance is  tensor(141.3298, device='cuda:3')
norm1 res is  tensor(0.1531, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.3393913507461548
distance x is tensor(125.0523, device='cuda:3')
benign distance is  tensor(125.0523, device='cuda:3')
norm1 res is  tensor(0.1385, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(129.7004, device='cuda:3')
compute distance is  tensor(129.7004, device='cuda:3')
compute norm is  tensor(56.4046, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.1455, device='cuda:3')
compute distance is  tensor(119.1455, device='cuda:3')
compute norm is  tensor(56.2695, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5630, device='cuda:3')
compute distance is  tensor(127.5630, device='cuda:3')
compute norm is  tensor(56.4892, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8602, device='cuda:3')
compute distance is  tensor(124.8602, device='cuda:3')
compute norm is  tensor(56.4278, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.0417, device='cuda:3')
compute distance is  tensor(125.0417, device='cuda:3')
compute norm is  tensor(56.3373, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7671, device='cuda:3')
compute distance is  tensor(132.7671, device='cuda:3')
compute norm is  tensor(56.6548, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.6020, device='cuda:3')
compute distance is  tensor(124.6020, device='cuda:3')
compute norm is  tensor(56.3303, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5329, device='cuda:3')
compute distance is  tensor(125.5329, device='cuda:3')
compute norm is  tensor(56.4387, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1894, device='cuda:3')
compute distance is  tensor(137.1894, device='cuda:3')
compute norm is  tensor(56.4656, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.0824, device='cuda:3')
compute distance is  tensor(128.0824, device='cuda:3')
compute norm is  tensor(56.4826, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2466, device='cuda:3')
compute distance is  tensor(130.2466, device='cuda:3')
compute norm is  tensor(56.4953, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5432, device='cuda:3')
compute distance is  tensor(136.5432, device='cuda:3')
compute norm is  tensor(56.5526, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.1894, device='cuda:3')
distance x is tensor(107591.2109, device='cuda:3')
distance x is tensor(107591.2109, device='cuda:3')
________________________________
test distance is  tensor(107591.2109, device='cuda:3')
test distance1 is  tensor(107591.2109, device='cuda:3')
test similarity is  tensor(0.3823, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130085810569565.34
test entropy is  0.0
________________________________
cal ratio is  0.03499434982454867
distance x is tensor(3765.0901, device='cuda:3')
cal_distance is  tensor(3765.0901, device='cuda:3')
cal ratio is  0.18706762464850177
distance x is tensor(704.3306, device='cuda:3')
cal_distance is  tensor(704.3306, device='cuda:3')
cal ratio is  0.4325118873318657
distance x is tensor(304.6342, device='cuda:3')
cal_distance is  tensor(304.6342, device='cuda:3')
cal ratio is  0.6576532288507088
distance x is tensor(200.3454, device='cuda:3')
cal_distance is  tensor(200.3454, device='cuda:3')
cal ratio is  0.8109547466288983
distance x is tensor(162.4721, device='cuda:3')
cal_distance is  tensor(162.4721, device='cuda:3')
cal ratio is  0.9005274719837858
distance x is tensor(146.3110, device='cuda:3')
cal_distance is  tensor(146.3110, device='cuda:3')
cal ratio is  0.9489597052108167
distance x is tensor(138.8436, device='cuda:3')
cal_distance is  tensor(138.8436, device='cuda:3')
cal ratio is  0.9741446696537129
distance x is tensor(135.2538, device='cuda:3')
cal_distance is  tensor(135.2538, device='cuda:3')
distance x is tensor(135.2538, device='cuda:3')
return_distance is  tensor(135.2538, device='cuda:3')
distance x is tensor(135.2437, device='cuda:3')
distance x is tensor(135.2437, device='cuda:3')
________________________________
test distance is  tensor(135.2437, device='cuda:3')
test distance1 is  tensor(135.2437, device='cuda:3')
test similarity is  tensor(0.9748, device='cuda:3')
test acc is  0.35013333348967385
test loss is 29.733127120207115
test entropy is  0.05838543097716945
________________________________
0
distance x is tensor(135.2437, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.05666996984740596
avg test loss is  29.975193292093174
avg accuracy is  0.8779000001563221
solo acc is  0.3480833334896738
compute similarity  is  tensor(0.9748, device='cuda:3')
compute_distance is  tensor(135.2437, device='cuda:3')
compute_norm is  tensor(59.1281, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(133.0770, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8869593018280671
avg test loss is  1.3202989918590864
avg accuracy is  0.8650000001563226
solo acc is  0.3300000001563401
compute similarity  is  tensor(0.9742, device='cuda:3')
compute_distance is  tensor(133.0770, device='cuda:3')
compute_norm is  tensor(58.6073, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.2037, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8467639610330179
avg test loss is  1.4088031880891145
avg accuracy is  0.8648333334896561
solo acc is  0.2651000001563387
compute similarity  is  tensor(0.9738, device='cuda:3')
compute_distance is  tensor(134.2037, device='cuda:3')
compute_norm is  tensor(58.3004, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.9777, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8574645707348009
avg test loss is  1.3758169558129585
avg accuracy is  0.8659666668229893
solo acc is  0.25798333348967184
compute similarity  is  tensor(0.9736, device='cuda:3')
compute_distance is  tensor(134.9777, device='cuda:3')
compute_norm is  tensor(58.0039, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.6847, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8486962806441383
avg test loss is  1.360959129801183
avg accuracy is  0.8671333334896559
solo acc is  0.25650000015633845
compute similarity  is  tensor(0.9734, device='cuda:3')
compute_distance is  tensor(135.6847, device='cuda:3')
compute_norm is  tensor(57.7137, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.4040, device='cuda:3')
distance x is tensor(136.4040, device='cuda:3')
________________________________
test distance is  tensor(136.4040, device='cuda:3')
test distance1 is  tensor(136.4040, device='cuda:3')
test similarity is  tensor(0.9732, device='cuda:3')
test acc is  0.2491166668230049
test loss is 1.3621592583305546
test entropy is  0.834054590478889
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1464436054229736
mal norm is  tensor(662.2410, device='cuda:3')
distance x is tensor(136.4126, device='cuda:3')
mal distance is  tensor(136.4126, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(15.5212, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.0954, device='cuda:3')
user_param_square tensor(88.0145, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(11.7166, device='cuda:3')
score : tensor(0.1018, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.7943, device='cuda:3')
user_param_square tensor(94.5358, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-22.1646, device='cuda:3')
score : tensor(-0.2370, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(417.2623, device='cuda:3')
user_param_square tensor(80.4761, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(13.4675, device='cuda:3')
score : tensor(0.1194, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(462.6191, device='cuda:3')
user_param_square tensor(84.7372, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-12.0906, device='cuda:3')
score : tensor(-0.1362, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(451.7796, device='cuda:3')
user_param_square tensor(83.7386, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-44.2062, device='cuda:3')
score : tensor(-0.4574, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.9545, device='cuda:3')
user_param_square tensor(92.3902, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-41.9551, device='cuda:3')
score : tensor(-0.4349, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.3895, device='cuda:3')
user_param_square tensor(91.2436, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(3.6825, device='cuda:3')
score : tensor(0.0215, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.1324, device='cuda:3')
user_param_square tensor(90.0229, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-24.3551, device='cuda:3')
score : tensor(-0.2589, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2410, device='cuda:3')
user_param_square tensor(101.3843, device='cuda:3')
global_param_square tensor(15.5212, device='cuda:3')
part1 is  tensor(-14.5109, device='cuda:3')
score : tensor(-0.1604, device='cuda:3')
len accept list 3
len all weights is 3
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 89.22% 

Test Accuracy: 88.46% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
 benign loss is  0.35857242345809937
distance x is tensor(116.5721, device='cuda:3')
benign distance is  tensor(116.5721, device='cuda:3')
norm1 res is  tensor(0.1300, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5216612219810486
distance x is tensor(151.3952, device='cuda:3')
benign distance is  tensor(151.3952, device='cuda:3')
norm1 res is  tensor(0.1633, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.08393500745296478
distance x is tensor(102.1188, device='cuda:3')
benign distance is  tensor(102.1188, device='cuda:3')
norm1 res is  tensor(0.1117, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6831833124160767
distance x is tensor(121.3961, device='cuda:3')
benign distance is  tensor(121.3961, device='cuda:3')
norm1 res is  tensor(0.1301, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.09998588263988495
distance x is tensor(119.1240, device='cuda:3')
benign distance is  tensor(119.1240, device='cuda:3')
norm1 res is  tensor(0.1263, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6230384707450867
distance x is tensor(138.3227, device='cuda:3')
benign distance is  tensor(138.3227, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5919626951217651
distance x is tensor(101.5228, device='cuda:3')
benign distance is  tensor(101.5228, device='cuda:3')
norm1 res is  tensor(0.1096, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.8650514483451843
distance x is tensor(149.4943, device='cuda:3')
benign distance is  tensor(149.4943, device='cuda:3')
norm1 res is  tensor(0.1640, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(127.1389, device='cuda:3')
compute distance is  tensor(127.1389, device='cuda:3')
compute norm is  tensor(57.0110, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3439, device='cuda:3')
compute distance is  tensor(132.3439, device='cuda:3')
compute norm is  tensor(57.0285, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4243, device='cuda:3')
compute distance is  tensor(131.4243, device='cuda:3')
compute norm is  tensor(56.9936, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2671, device='cuda:3')
compute distance is  tensor(128.2671, device='cuda:3')
compute norm is  tensor(56.8913, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.3678, device='cuda:3')
compute distance is  tensor(151.3678, device='cuda:3')
compute norm is  tensor(57.4325, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.2735, device='cuda:3')
compute distance is  tensor(142.2735, device='cuda:3')
compute norm is  tensor(57.2829, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.5605, device='cuda:3')
compute distance is  tensor(131.5605, device='cuda:3')
compute norm is  tensor(57.1507, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.4116, device='cuda:3')
compute distance is  tensor(151.4116, device='cuda:3')
compute norm is  tensor(57.4268, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.5313, device='cuda:3')
compute distance is  tensor(140.5313, device='cuda:3')
compute norm is  tensor(57.2207, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5827, device='cuda:3')
compute distance is  tensor(139.5827, device='cuda:3')
compute norm is  tensor(57.3245, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5236, device='cuda:3')
compute distance is  tensor(144.5236, device='cuda:3')
compute norm is  tensor(57.4052, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.4586, device='cuda:3')
compute distance is  tensor(128.4586, device='cuda:3')
compute norm is  tensor(56.9599, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.4116, device='cuda:3')
distance x is tensor(107596.3203, device='cuda:3')
distance x is tensor(107596.3203, device='cuda:3')
________________________________
test distance is  tensor(107596.3203, device='cuda:3')
test distance1 is  tensor(107596.3203, device='cuda:3')
test similarity is  tensor(0.3693, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130130551907893.5
test entropy is  0.0
________________________________
cal ratio is  0.03676266524875672
distance x is tensor(3955.5332, device='cuda:3')
cal_distance is  tensor(3955.5332, device='cuda:3')
cal ratio is  0.19173578695722862
distance x is tensor(758.4213, device='cuda:3')
cal_distance is  tensor(758.4213, device='cuda:3')
cal ratio is  0.43787528188267855
distance x is tensor(332.0968, device='cuda:3')
cal_distance is  tensor(332.0968, device='cuda:3')
cal ratio is  0.6617186197958573
distance x is tensor(219.7563, device='cuda:3')
cal_distance is  tensor(219.7563, device='cuda:3')
cal ratio is  0.8134577383219523
distance x is tensor(178.7634, device='cuda:3')
cal_distance is  tensor(178.7634, device='cuda:3')
cal ratio is  0.9019165270597093
distance x is tensor(161.2302, device='cuda:3')
cal_distance is  tensor(161.2302, device='cuda:3')
cal ratio is  0.9496914151717607
distance x is tensor(153.1192, device='cuda:3')
cal_distance is  tensor(153.1192, device='cuda:3')
cal ratio is  0.9745202145449366
distance x is tensor(149.2179, device='cuda:3')
cal_distance is  tensor(149.2179, device='cuda:3')
distance x is tensor(149.2179, device='cuda:3')
return_distance is  tensor(149.2179, device='cuda:3')
distance x is tensor(149.2078, device='cuda:3')
distance x is tensor(149.2078, device='cuda:3')
________________________________
test distance is  tensor(149.2078, device='cuda:3')
test distance1 is  tensor(149.2078, device='cuda:3')
test similarity is  tensor(0.9701, device='cuda:3')
test acc is  0.2741166668230055
test loss is 59.11498842463056
test entropy is  0.03767678563469159
________________________________
0
distance x is tensor(149.2078, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.036450073330490385
avg test loss is  59.44030701936181
avg accuracy is  0.8539333334896566
solo acc is  0.27583333348967226
compute similarity  is  tensor(0.9701, device='cuda:3')
compute_distance is  tensor(149.2078, device='cuda:3')
compute_norm is  tensor(60.2210, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.6172, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8879920070740714
avg test loss is  1.3573832532236063
avg accuracy is  0.8495333334896567
solo acc is  0.32385000015633997
compute similarity  is  tensor(0.9698, device='cuda:3')
compute_distance is  tensor(145.6172, device='cuda:3')
compute_norm is  tensor(59.6935, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.7774, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.859555943052906
avg test loss is  1.4240215179254252
avg accuracy is  0.8512333334896566
solo acc is  0.26653333348967206
compute similarity  is  tensor(0.9694, device='cuda:3')
compute_distance is  tensor(146.7774, device='cuda:3')
compute_norm is  tensor(59.3725, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.5258, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8491304675653291
avg test loss is  1.406614798091368
avg accuracy is  0.8516000001563232
solo acc is  0.25806666682300516
compute similarity  is  tensor(0.9692, device='cuda:3')
compute_distance is  tensor(147.5258, device='cuda:3')
compute_norm is  tensor(59.0654, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.2610, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8454160882211698
avg test loss is  1.3871312661211628
avg accuracy is  0.8516500001563232
solo acc is  0.25495000015633845
compute similarity  is  tensor(0.9689, device='cuda:3')
compute_distance is  tensor(148.2610, device='cuda:3')
compute_norm is  tensor(58.7643, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.9230, device='cuda:3')
distance x is tensor(148.9230, device='cuda:3')
________________________________
test distance is  tensor(148.9230, device='cuda:3')
test distance1 is  tensor(148.9230, device='cuda:3')
test similarity is  tensor(0.9687, device='cuda:3')
test acc is  0.2500333334896716
test loss is 1.3731532564549558
test entropy is  0.8405564874728352
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.1215382814407349
mal norm is  tensor(728.7763, device='cuda:3')
distance x is tensor(148.9316, device='cuda:3')
mal distance is  tensor(148.9316, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(17.9687, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(510.8473, device='cuda:3')
user_param_square tensor(95.8083, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-33.8724, device='cuda:3')
score : tensor(-0.3565, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.4103, device='cuda:3')
user_param_square tensor(107.1884, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-18.1139, device='cuda:3')
score : tensor(-0.1989, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(437.0970, device='cuda:3')
user_param_square tensor(88.6231, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(5.7177, device='cuda:3')
score : tensor(0.0394, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(510.7478, device='cuda:3')
user_param_square tensor(95.7990, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-26.1191, device='cuda:3')
score : tensor(-0.2790, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.3486, device='cuda:3')
user_param_square tensor(94.9134, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-11.5310, device='cuda:3')
score : tensor(-0.1331, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.8643, device='cuda:3')
user_param_square tensor(102.7771, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-13.7465, device='cuda:3')
score : tensor(-0.1552, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(431.4873, device='cuda:3')
user_param_square tensor(88.0525, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-5.3161, device='cuda:3')
score : tensor(-0.0709, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.2496, device='cuda:3')
user_param_square tensor(107.6767, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-10.0873, device='cuda:3')
score : tensor(-0.1186, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.7763, device='cuda:3')
user_param_square tensor(114.4340, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(12.3503, device='cuda:3')
score : tensor(0.1057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.0427, device='cuda:3')
user_param_square tensor(103.6630, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(14.0393, device='cuda:3')
score : tensor(0.1226, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.0372, device='cuda:3')
user_param_square tensor(101.8262, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-15.6860, device='cuda:3')
score : tensor(-0.1746, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.8341, device='cuda:3')
user_param_square tensor(105.2791, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-9.2103, device='cuda:3')
score : tensor(-0.1099, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.1151, device='cuda:3')
user_param_square tensor(107.8322, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-30.2802, device='cuda:3')
score : tensor(-0.3206, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.2665, device='cuda:3')
user_param_square tensor(103.1612, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-39.5389, device='cuda:3')
score : tensor(-0.4132, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.7769, device='cuda:3')
user_param_square tensor(104.1588, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(2.0540, device='cuda:3')
score : tensor(0.0028, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.7921, device='cuda:3')
user_param_square tensor(110.2771, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(15.5360, device='cuda:3')
score : tensor(0.1376, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.3246, device='cuda:3')
user_param_square tensor(102.9919, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-21.0532, device='cuda:3')
score : tensor(-0.2283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9160, device='cuda:3')
user_param_square tensor(103.6521, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(43.5572, device='cuda:3')
score : tensor(0.4178, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.5007, device='cuda:3')
user_param_square tensor(106.4389, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-31.4345, device='cuda:3')
score : tensor(-0.3321, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.9013, device='cuda:3')
user_param_square tensor(98.6775, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-44.9541, device='cuda:3')
score : tensor(-0.4673, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.7969, device='cuda:3')
user_param_square tensor(106.4640, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-51.3277, device='cuda:3')
score : tensor(-0.5310, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.5255, device='cuda:3')
user_param_square tensor(103.0095, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-28.1250, device='cuda:3')
score : tensor(-0.2990, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.2736, device='cuda:3')
user_param_square tensor(104.3740, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(6.5254, device='cuda:3')
score : tensor(0.0475, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.6690, device='cuda:3')
user_param_square tensor(99.9231, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(-7.3553, device='cuda:3')
score : tensor(-0.0913, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.6268, device='cuda:3')
user_param_square tensor(102.6689, device='cuda:3')
global_param_square tensor(17.9687, device='cuda:3')
part1 is  tensor(3.9810, device='cuda:3')
score : tensor(0.0220, device='cuda:3')
accept
len accept list 19
len all weights is 19
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 87.61% 

Test Accuracy: 86.77% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
 benign loss is  0.41006046533584595
distance x is tensor(125.7524, device='cuda:3')
benign distance is  tensor(125.7524, device='cuda:3')
norm1 res is  tensor(0.1355, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5271943211555481
distance x is tensor(141.8249, device='cuda:3')
benign distance is  tensor(141.8249, device='cuda:3')
norm1 res is  tensor(0.1500, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.49522075057029724
distance x is tensor(131.4238, device='cuda:3')
benign distance is  tensor(131.4238, device='cuda:3')
norm1 res is  tensor(0.1380, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.23003363609313965
distance x is tensor(136.0277, device='cuda:3')
benign distance is  tensor(136.0277, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6494415402412415
distance x is tensor(137.5984, device='cuda:3')
benign distance is  tensor(137.5984, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4788002371788025
distance x is tensor(151.5435, device='cuda:3')
benign distance is  tensor(151.5435, device='cuda:3')
norm1 res is  tensor(0.1594, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.4365406632423401
distance x is tensor(133.7135, device='cuda:3')
benign distance is  tensor(133.7135, device='cuda:3')
norm1 res is  tensor(0.1397, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.25464528799057007
distance x is tensor(153.3613, device='cuda:3')
benign distance is  tensor(153.3613, device='cuda:3')
norm1 res is  tensor(0.1619, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3516998291015625
distance x is tensor(150.1471, device='cuda:3')
benign distance is  tensor(150.1471, device='cuda:3')
norm1 res is  tensor(0.1609, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.6183192133903503
distance x is tensor(151.2831, device='cuda:3')
benign distance is  tensor(151.2831, device='cuda:3')
norm1 res is  tensor(0.1610, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.6316033601760864
distance x is tensor(131.9455, device='cuda:3')
benign distance is  tensor(131.9455, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  1.0317680835723877
distance x is tensor(156.5346, device='cuda:3')
benign distance is  tensor(156.5346, device='cuda:3')
norm1 res is  tensor(0.1636, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.43641430139541626
distance x is tensor(137.4378, device='cuda:3')
benign distance is  tensor(137.4378, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.18741747736930847
distance x is tensor(156.3823, device='cuda:3')
benign distance is  tensor(156.3823, device='cuda:3')
norm1 res is  tensor(0.1611, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.5843890905380249
distance x is tensor(144.1219, device='cuda:3')
benign distance is  tensor(144.1219, device='cuda:3')
norm1 res is  tensor(0.1543, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.35500621795654297
distance x is tensor(140.5822, device='cuda:3')
benign distance is  tensor(140.5822, device='cuda:3')
norm1 res is  tensor(0.1498, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.15476486086845398
distance x is tensor(177.0448, device='cuda:3')
benign distance is  tensor(177.0448, device='cuda:3')
norm1 res is  tensor(0.1840, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.7198048830032349
distance x is tensor(138.3657, device='cuda:3')
benign distance is  tensor(138.3657, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.22253501415252686
distance x is tensor(156.5215, device='cuda:3')
benign distance is  tensor(156.5215, device='cuda:3')
norm1 res is  tensor(0.1654, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.11787668615579605
distance x is tensor(153.5404, device='cuda:3')
benign distance is  tensor(153.5404, device='cuda:3')
norm1 res is  tensor(0.1548, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.6703940629959106
distance x is tensor(153.1607, device='cuda:3')
benign distance is  tensor(153.1607, device='cuda:3')
norm1 res is  tensor(0.1606, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.12631793320178986
distance x is tensor(156.5473, device='cuda:3')
benign distance is  tensor(156.5473, device='cuda:3')
norm1 res is  tensor(0.1615, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.5780112147331238
distance x is tensor(151.5115, device='cuda:3')
benign distance is  tensor(151.5115, device='cuda:3')
norm1 res is  tensor(0.1594, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.349536269903183
distance x is tensor(153.2278, device='cuda:3')
benign distance is  tensor(153.2278, device='cuda:3')
norm1 res is  tensor(0.1600, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(152.8385, device='cuda:3')
compute distance is  tensor(152.8385, device='cuda:3')
compute norm is  tensor(58.6614, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.3996, device='cuda:3')
compute distance is  tensor(145.3996, device='cuda:3')
compute norm is  tensor(58.2638, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.0580, device='cuda:3')
compute distance is  tensor(149.0580, device='cuda:3')
compute norm is  tensor(58.6435, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.8444, device='cuda:3')
compute distance is  tensor(151.8444, device='cuda:3')
compute norm is  tensor(58.4348, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.6878, device='cuda:3')
compute distance is  tensor(161.6878, device='cuda:3')
compute norm is  tensor(58.8700, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.1183, device='cuda:3')
compute distance is  tensor(159.1183, device='cuda:3')
compute norm is  tensor(58.7083, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5337, device='cuda:3')
compute distance is  tensor(148.5337, device='cuda:3')
compute norm is  tensor(58.6492, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.2973, device='cuda:3')
compute distance is  tensor(145.2973, device='cuda:3')
compute norm is  tensor(58.3965, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.0015, device='cuda:3')
compute distance is  tensor(153.0015, device='cuda:3')
compute norm is  tensor(58.5509, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.2135, device='cuda:3')
compute distance is  tensor(151.2135, device='cuda:3')
compute norm is  tensor(58.7256, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.3669, device='cuda:3')
compute distance is  tensor(136.3669, device='cuda:3')
compute norm is  tensor(58.3631, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9676, device='cuda:3')
compute distance is  tensor(135.9676, device='cuda:3')
compute norm is  tensor(58.3970, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(161.6878, device='cuda:3')
distance x is tensor(107536.5078, device='cuda:3')
distance x is tensor(107536.5078, device='cuda:3')
________________________________
test distance is  tensor(107536.5078, device='cuda:3')
test distance1 is  tensor(107536.5078, device='cuda:3')
test similarity is  tensor(0.4817, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130037944787764.95
test entropy is  0.0
________________________________
cal ratio is  0.03800027965607251
distance x is tensor(4086.4231, device='cuda:3')
cal_distance is  tensor(4086.4231, device='cuda:3')
cal ratio is  0.19493646818586913
distance x is tensor(796.5968, device='cuda:3')
cal_distance is  tensor(796.5968, device='cuda:3')
cal ratio is  0.4415150122136908
distance x is tensor(351.7123, device='cuda:3')
cal_distance is  tensor(351.7123, device='cuda:3')
cal ratio is  0.6644632500399034
distance x is tensor(233.7016, device='cuda:3')
cal_distance is  tensor(233.7016, device='cuda:3')
cal ratio is  0.8151431858916286
distance x is tensor(190.5012, device='cuda:3')
cal_distance is  tensor(190.5012, device='cuda:3')
cal ratio is  0.9028505384117297
distance x is tensor(171.9946, device='cuda:3')
cal_distance is  tensor(171.9946, device='cuda:3')
cal ratio is  0.9501831460516901
distance x is tensor(163.4266, device='cuda:3')
cal_distance is  tensor(163.4266, device='cuda:3')
cal ratio is  0.9747726507072044
distance x is tensor(159.3040, device='cuda:3')
cal_distance is  tensor(159.3040, device='cuda:3')
distance x is tensor(159.3040, device='cuda:3')
return_distance is  tensor(159.3040, device='cuda:3')
distance x is tensor(159.2938, device='cuda:3')
distance x is tensor(159.2938, device='cuda:3')
________________________________
test distance is  tensor(159.2938, device='cuda:3')
test distance1 is  tensor(159.2938, device='cuda:3')
test similarity is  tensor(0.9738, device='cuda:3')
test acc is  0.10023333348966532
test loss is 237.93645334142104
test entropy is  8.197736266465237e-05
________________________________
0
distance x is tensor(159.2938, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00013136604359064688
avg test loss is  238.10940037709057
avg accuracy is  0.5047500001563422
solo acc is  0.10026666682299865
compute similarity  is  tensor(0.9738, device='cuda:3')
compute_distance is  tensor(159.2938, device='cuda:3')
compute_norm is  tensor(62.5411, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1962.9905, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5471046328036262
avg test loss is  2.883117177847352
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2329, device='cuda:3')
compute_distance is  tensor(1962.9905, device='cuda:3')
compute_norm is  tensor(223.5361, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1953.9933, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8374387604722591
avg test loss is  3.638880107702731
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2330, device='cuda:3')
compute_distance is  tensor(1953.9933, device='cuda:3')
compute_norm is  tensor(222.6484, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1944.9299, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5548568611968554
avg test loss is  2.868220605575708
avg accuracy is  0.09998333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2328, device='cuda:3')
compute_distance is  tensor(1944.9299, device='cuda:3')
compute_norm is  tensor(221.4103, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1936.0874, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8399569054783534
avg test loss is  3.625580853744865
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2329, device='cuda:3')
compute_distance is  tensor(1936.0874, device='cuda:3')
compute_norm is  tensor(220.6150, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1927.0439, device='cuda:3')
distance x is tensor(1927.0439, device='cuda:3')
________________________________
test distance is  tensor(1927.0439, device='cuda:3')
test distance1 is  tensor(1927.0439, device='cuda:3')
test similarity is  tensor(0.2327, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.861424365531661
test entropy is  1.559136326379105
________________________________
cal ratio is  0.28386963954132644
distance x is tensor(547.0296, device='cuda:3')
cal_distance is  tensor(547.0296, device='cuda:3')
cal ratio is  0.5327940036997583
distance x is tensor(291.4542, device='cuda:3')
cal_distance is  tensor(291.4542, device='cuda:3')
cal ratio is  0.7299272779436037
distance x is tensor(212.7404, device='cuda:3')
cal_distance is  tensor(212.7404, device='cuda:3')
cal ratio is  0.8543577222325858
distance x is tensor(181.7564, device='cuda:3')
cal_distance is  tensor(181.7564, device='cuda:3')
cal ratio is  0.924314677570256
distance x is tensor(168.0002, device='cuda:3')
cal_distance is  tensor(168.0002, device='cuda:3')
cal ratio is  0.9614127674250758
distance x is tensor(161.5175, device='cuda:3')
cal_distance is  tensor(161.5175, device='cuda:3')
distance x is tensor(161.5175, device='cuda:3')
return_distance is  tensor(161.5175, device='cuda:3')
distance x is tensor(161.5171, device='cuda:3')
distance x is tensor(161.5171, device='cuda:3')
________________________________
test distance is  tensor(161.5171, device='cuda:3')
test distance1 is  tensor(161.5171, device='cuda:3')
test similarity is  tensor(0.9465, device='cuda:3')
test acc is  0.10531666682299863
test loss is 779.7567762362678
test entropy is  0.10015982222304727
________________________________
0
distance x is tensor(161.5171, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.10096655345434676
avg test loss is  780.8143080200977
avg accuracy is  0.1424500001563325
solo acc is  0.10496666682299864
compute similarity  is  tensor(0.9465, device='cuda:3')
compute_distance is  tensor(161.5171, device='cuda:3')
compute_norm is  tensor(60.8008, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(267.0945, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1218723068867664
avg test loss is  1.8196098746013032
avg accuracy is  0.3919666668230077
solo acc is  0.20511666682300325
compute similarity  is  tensor(0.9251, device='cuda:3')
compute_distance is  tensor(267.0945, device='cuda:3')
compute_norm is  tensor(62.4926, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(267.2279, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6900271793672526
avg test loss is  2.569766936017506
avg accuracy is  0.26340000015633874
solo acc is  0.10595000015633195
compute similarity  is  tensor(0.9250, device='cuda:3')
compute_distance is  tensor(267.2279, device='cuda:3')
compute_norm is  tensor(62.2503, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(268.9212, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0657037927397788
avg test loss is  1.6459568891443932
avg accuracy is  0.41201666682300797
solo acc is  0.22586666682300405
compute similarity  is  tensor(0.9249, device='cuda:3')
compute_distance is  tensor(268.9212, device='cuda:3')
compute_norm is  tensor(61.9508, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(269.0574, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6376871694125601
avg test loss is  2.3867030117049146
avg accuracy is  0.27963333348967245
solo acc is  0.10740000015633196
compute similarity  is  tensor(0.9247, device='cuda:3')
compute_distance is  tensor(269.0574, device='cuda:3')
compute_norm is  tensor(61.7050, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(270.4920, device='cuda:3')
distance x is tensor(270.4920, device='cuda:3')
________________________________
test distance is  tensor(270.4920, device='cuda:3')
test distance1 is  tensor(270.4920, device='cuda:3')
test similarity is  tensor(0.9246, device='cuda:3')
test acc is  0.23663333348967117
test loss is 1.5143965771203356
test entropy is  1.0288041315988692
________________________________
cal ratio is  0.757683029267972
distance x is tensor(204.9442, device='cuda:3')
cal_distance is  tensor(204.9442, device='cuda:3')
cal ratio is  0.8704562569993461
distance x is tensor(178.3947, device='cuda:3')
cal_distance is  tensor(178.3947, device='cuda:3')
cal ratio is  0.9329830097928873
distance x is tensor(166.4391, device='cuda:3')
cal_distance is  tensor(166.4391, device='cuda:3')
cal ratio is  0.9659107548254644
distance x is tensor(160.7653, device='cuda:3')
cal_distance is  tensor(160.7653, device='cuda:3')
distance x is tensor(160.7653, device='cuda:3')
return_distance is  tensor(160.7653, device='cuda:3')
distance x is tensor(160.7687, device='cuda:3')
distance x is tensor(160.7687, device='cuda:3')
________________________________
test distance is  tensor(160.7687, device='cuda:3')
test distance1 is  tensor(160.7687, device='cuda:3')
test similarity is  tensor(0.9721, device='cuda:3')
test acc is  0.39316666682300766
test loss is 1.3457586043424952
test entropy is  1.2457721254973015
________________________________
0
distance x is tensor(160.7687, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2424824569525241
avg test loss is  1.35199070834656
avg accuracy is  0.5662000001563404
solo acc is  0.3919666668230077
compute similarity  is  tensor(0.9721, device='cuda:3')
compute_distance is  tensor(160.7687, device='cuda:3')
compute_norm is  tensor(58.1384, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.5612, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6326773125352636
avg test loss is  2.354212398595139
avg accuracy is  0.3824333334896742
solo acc is  0.10811666682299861
compute similarity  is  tensor(0.9718, device='cuda:3')
compute_distance is  tensor(162.5612, device='cuda:3')
compute_norm is  tensor(57.9136, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.9832, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9570252594154781
avg test loss is  1.4034237481637803
avg accuracy is  0.5801000001563392
solo acc is  0.27800000015633897
compute similarity  is  tensor(0.9717, device='cuda:3')
compute_distance is  tensor(164.9832, device='cuda:3')
compute_norm is  tensor(57.6386, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(164.9797, device='cuda:3')
________________________________
test distance is  tensor(164.9797, device='cuda:3')
test similarity is  tensor(0.9717, device='cuda:3')
test acc is  0.5794000001563393
test loss is 1.3998114487001383
test entropy is  0.9562641352986985
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.2210415601730347
mal norm is  tensor(635.9944, device='cuda:3')
distance x is tensor(164.9797, device='cuda:3')
mal distance is  tensor(164.9797, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(14.7029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.1299, device='cuda:3')
user_param_square tensor(88.2030, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(45.3364, device='cuda:3')
score : tensor(0.4389, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.5247, device='cuda:3')
user_param_square tensor(92.8636, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(69.6042, device='cuda:3')
score : tensor(0.6815, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.3726, device='cuda:3')
user_param_square tensor(88.8046, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(77.2583, device='cuda:3')
score : tensor(0.7581, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.5596, device='cuda:3')
user_param_square tensor(90.6227, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(49.6468, device='cuda:3')
score : tensor(0.4820, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(554.6196, device='cuda:3')
user_param_square tensor(90.3025, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(95.5837, device='cuda:3')
score : tensor(0.9413, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.1030, device='cuda:3')
user_param_square tensor(95.9456, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(71.9343, device='cuda:3')
score : tensor(0.7048, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.7343, device='cuda:3')
user_param_square tensor(89.2474, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(74.3448, device='cuda:3')
score : tensor(0.7289, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.5552, device='cuda:3')
user_param_square tensor(97.0466, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(45.0229, device='cuda:3')
score : tensor(0.4357, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9944, device='cuda:3')
user_param_square tensor(96.7005, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(-154.5912, device='cuda:3')
score : tensor(-1.5604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.3558, device='cuda:3')
user_param_square tensor(102.4130, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(44.4186, device='cuda:3')
score : tensor(0.4297, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.9305, device='cuda:3')
user_param_square tensor(101.1545, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(71.1252, device='cuda:3')
score : tensor(0.6967, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.9424, device='cuda:3')
user_param_square tensor(99.9858, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(76.4850, device='cuda:3')
score : tensor(0.7503, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.6486, device='cuda:3')
user_param_square tensor(100.9157, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(41.5114, device='cuda:3')
score : tensor(0.4006, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.7434, device='cuda:3')
user_param_square tensor(98.9363, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(38.6401, device='cuda:3')
score : tensor(0.3719, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.5150, device='cuda:3')
user_param_square tensor(96.2831, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(80.4013, device='cuda:3')
score : tensor(0.7895, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.5792, device='cuda:3')
user_param_square tensor(100.7648, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(41.3236, device='cuda:3')
score : tensor(0.3987, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.2881, device='cuda:3')
user_param_square tensor(98.7537, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(59.0178, device='cuda:3')
score : tensor(0.5757, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.1595, device='cuda:3')
user_param_square tensor(99.1898, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(56.0626, device='cuda:3')
score : tensor(0.5461, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.9113, device='cuda:3')
user_param_square tensor(102.5963, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(40.2575, device='cuda:3')
score : tensor(0.3881, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.1031, device='cuda:3')
user_param_square tensor(98.5909, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(62.2677, device='cuda:3')
score : tensor(0.6082, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.0422, device='cuda:3')
user_param_square tensor(98.0630, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(104.1875, device='cuda:3')
score : tensor(1.0274, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2740, device='cuda:3')
user_param_square tensor(98.6781, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(64.1239, device='cuda:3')
score : tensor(0.6267, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.6629, device='cuda:3')
user_param_square tensor(100.9167, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(71.3665, device='cuda:3')
score : tensor(0.6992, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.2238, device='cuda:3')
user_param_square tensor(100.5928, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(103.5541, device='cuda:3')
score : tensor(1.0210, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.7751, device='cuda:3')
user_param_square tensor(99.0129, device='cuda:3')
global_param_square tensor(14.7029, device='cuda:3')
part1 is  tensor(73.3708, device='cuda:3')
score : tensor(0.7192, device='cuda:3')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.63% 

Test Accuracy: 88.90% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
 benign loss is  0.18377692997455597
distance x is tensor(108.6386, device='cuda:3')
benign distance is  tensor(108.6386, device='cuda:3')
norm1 res is  tensor(0.1211, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.38617387413978577
distance x is tensor(125.5733, device='cuda:3')
benign distance is  tensor(125.5733, device='cuda:3')
norm1 res is  tensor(0.1381, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.42550867795944214
distance x is tensor(106.7847, device='cuda:3')
benign distance is  tensor(106.7847, device='cuda:3')
norm1 res is  tensor(0.1140, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.08554546535015106
distance x is tensor(115.8717, device='cuda:3')
benign distance is  tensor(115.8717, device='cuda:3')
norm1 res is  tensor(0.1275, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.23267300426959991
distance x is tensor(120.0628, device='cuda:3')
benign distance is  tensor(120.0628, device='cuda:3')
norm1 res is  tensor(0.1265, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.30694934725761414
distance x is tensor(129.6363, device='cuda:3')
benign distance is  tensor(129.6363, device='cuda:3')
norm1 res is  tensor(0.1376, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2521361708641052
distance x is tensor(123.4276, device='cuda:3')
benign distance is  tensor(123.4276, device='cuda:3')
norm1 res is  tensor(0.1341, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.240657240152359
distance x is tensor(129.7077, device='cuda:3')
benign distance is  tensor(129.7077, device='cuda:3')
norm1 res is  tensor(0.1394, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.3291306495666504
distance x is tensor(137.1248, device='cuda:3')
benign distance is  tensor(137.1248, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.7941954731941223
distance x is tensor(140.9261, device='cuda:3')
benign distance is  tensor(140.9261, device='cuda:3')
norm1 res is  tensor(0.1519, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.4552084505558014
distance x is tensor(140.1597, device='cuda:3')
benign distance is  tensor(140.1597, device='cuda:3')
norm1 res is  tensor(0.1549, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.13369108736515045
distance x is tensor(125.8190, device='cuda:3')
benign distance is  tensor(125.8190, device='cuda:3')
norm1 res is  tensor(0.1401, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.11105795204639435
distance x is tensor(124.7940, device='cuda:3')
benign distance is  tensor(124.7940, device='cuda:3')
norm1 res is  tensor(0.1320, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.3699004650115967
distance x is tensor(121.2587, device='cuda:3')
benign distance is  tensor(121.2587, device='cuda:3')
norm1 res is  tensor(0.1335, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.3788260221481323
distance x is tensor(132.4561, device='cuda:3')
benign distance is  tensor(132.4561, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.30612513422966003
distance x is tensor(125.8800, device='cuda:3')
benign distance is  tensor(125.8800, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.295087069272995
distance x is tensor(120.4229, device='cuda:3')
benign distance is  tensor(120.4229, device='cuda:3')
norm1 res is  tensor(0.1324, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.06662429869174957
distance x is tensor(130.2572, device='cuda:3')
benign distance is  tensor(130.2572, device='cuda:3')
norm1 res is  tensor(0.1415, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.07632065564393997
distance x is tensor(125.1940, device='cuda:3')
benign distance is  tensor(125.1940, device='cuda:3')
norm1 res is  tensor(0.1368, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.18592531979084015
distance x is tensor(132.3675, device='cuda:3')
benign distance is  tensor(132.3675, device='cuda:3')
norm1 res is  tensor(0.1426, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.7643190622329712
distance x is tensor(137.5791, device='cuda:3')
benign distance is  tensor(137.5791, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.4632844030857086
distance x is tensor(138.7637, device='cuda:3')
benign distance is  tensor(138.7637, device='cuda:3')
norm1 res is  tensor(0.1459, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.32047539949417114
distance x is tensor(131.1804, device='cuda:3')
benign distance is  tensor(131.1804, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.32912391424179077
distance x is tensor(127.7454, device='cuda:3')
benign distance is  tensor(127.7454, device='cuda:3')
norm1 res is  tensor(0.1332, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(125.1485, device='cuda:3')
compute distance is  tensor(125.1485, device='cuda:3')
compute norm is  tensor(57.3324, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4151, device='cuda:3')
compute distance is  tensor(137.4151, device='cuda:3')
compute norm is  tensor(57.7437, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6767, device='cuda:3')
compute distance is  tensor(138.6767, device='cuda:3')
compute norm is  tensor(57.7282, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2650, device='cuda:3')
compute distance is  tensor(134.2650, device='cuda:3')
compute norm is  tensor(57.6747, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2792, device='cuda:3')
compute distance is  tensor(126.2792, device='cuda:3')
compute norm is  tensor(57.3869, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2330, device='cuda:3')
compute distance is  tensor(133.2330, device='cuda:3')
compute norm is  tensor(57.6397, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.4331, device='cuda:3')
compute distance is  tensor(118.4331, device='cuda:3')
compute norm is  tensor(57.4334, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.1508, device='cuda:3')
compute distance is  tensor(120.1508, device='cuda:3')
compute norm is  tensor(57.3954, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.7979, device='cuda:3')
compute distance is  tensor(141.7979, device='cuda:3')
compute norm is  tensor(57.8192, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3902, device='cuda:3')
compute distance is  tensor(137.3902, device='cuda:3')
compute norm is  tensor(57.7747, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.0061, device='cuda:3')
compute distance is  tensor(138.0061, device='cuda:3')
compute norm is  tensor(57.8410, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.2684, device='cuda:3')
compute distance is  tensor(121.2684, device='cuda:3')
compute norm is  tensor(57.4283, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(141.7979, device='cuda:3')
distance x is tensor(107573.5078, device='cuda:3')
distance x is tensor(107573.5078, device='cuda:3')
________________________________
test distance is  tensor(107573.5078, device='cuda:3')
test distance1 is  tensor(107573.5078, device='cuda:3')
test similarity is  tensor(0.4184, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130173747953733.88
test entropy is  0.0
________________________________
cal ratio is  0.035580198953765435
distance x is tensor(3827.4922, device='cuda:3')
cal_distance is  tensor(3827.4922, device='cuda:3')
cal ratio is  0.18862700940620328
distance x is tensor(721.9726, device='cuda:3')
cal_distance is  tensor(721.9726, device='cuda:3')
cal ratio is  0.4343108618059387
distance x is tensor(313.5634, device='cuda:3')
cal_distance is  tensor(313.5634, device='cuda:3')
cal ratio is  0.6590196293941362
distance x is tensor(206.6462, device='cuda:3')
cal_distance is  tensor(206.6462, device='cuda:3')
cal ratio is  0.8117968569966553
distance x is tensor(167.7557, device='cuda:3')
cal_distance is  tensor(167.7557, device='cuda:3')
cal ratio is  0.9009951439476824
distance x is tensor(151.1476, device='cuda:3')
cal_distance is  tensor(151.1476, device='cuda:3')
cal ratio is  0.9492059729450074
distance x is tensor(143.4704, device='cuda:3')
cal_distance is  tensor(143.4704, device='cuda:3')
cal ratio is  0.9742712089651778
distance x is tensor(139.7792, device='cuda:3')
cal_distance is  tensor(139.7792, device='cuda:3')
distance x is tensor(139.7792, device='cuda:3')
return_distance is  tensor(139.7792, device='cuda:3')
distance x is tensor(139.7691, device='cuda:3')
distance x is tensor(139.7691, device='cuda:3')
________________________________
test distance is  tensor(139.7691, device='cuda:3')
test distance1 is  tensor(139.7691, device='cuda:3')
test similarity is  tensor(0.9757, device='cuda:3')
test acc is  0.21185000015633698
test loss is 54.21025159872417
test entropy is  0.03014480542392283
________________________________
0
distance x is tensor(139.7691, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.031235069019977114
avg test loss is  54.03343722866034
avg accuracy is  0.8672666668229891
solo acc is  0.21153333348967024
compute similarity  is  tensor(0.9757, device='cuda:3')
compute_distance is  tensor(139.7691, device='cuda:3')
compute_norm is  tensor(60.6205, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(135.7543, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.902311795937227
avg test loss is  1.3115371822802497
avg accuracy is  0.8463000001563235
solo acc is  0.3313166668230068
compute similarity  is  tensor(0.9761, device='cuda:3')
compute_distance is  tensor(135.7543, device='cuda:3')
compute_norm is  tensor(60.3213, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.4852, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8538896106580681
avg test loss is  1.4096415687217387
avg accuracy is  0.8436166668229903
solo acc is  0.2557166668230051
compute similarity  is  tensor(0.9759, device='cuda:3')
compute_distance is  tensor(136.4852, device='cuda:3')
compute_norm is  tensor(60.0109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.9518, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8517881296972222
avg test loss is  1.3850749426050735
avg accuracy is  0.8459833334896567
solo acc is  0.2586833334896718
compute similarity  is  tensor(0.9757, device='cuda:3')
compute_distance is  tensor(136.9518, device='cuda:3')
compute_norm is  tensor(59.7081, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.4014, device='cuda:3')
exit early
distance x is tensor(137.4014, device='cuda:3')
distance x is tensor(137.4014, device='cuda:3')
________________________________
test distance is  tensor(137.4014, device='cuda:3')
test distance1 is  tensor(137.4014, device='cuda:3')
test similarity is  tensor(0.9756, device='cuda:3')
test acc is  0.2454666668230048
test loss is 1.3856142435246692
test entropy is  0.8412308088624909
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2931188344955444
mal norm is  tensor(677.1366, device='cuda:3')
distance x is tensor(137.4104, device='cuda:3')
mal distance is  tensor(137.4104, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(13.3298, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(472.4029, device='cuda:3')
user_param_square tensor(79.3540, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(17.5015, device='cuda:3')
score : tensor(0.1619, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.6555, device='cuda:3')
user_param_square tensor(84.9716, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(0.4683, device='cuda:3')
score : tensor(-0.0084, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(444.8491, device='cuda:3')
user_param_square tensor(77.0050, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(23.1100, device='cuda:3')
score : tensor(0.2180, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.8635, device='cuda:3')
user_param_square tensor(81.4643, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(28.9688, device='cuda:3')
score : tensor(0.2766, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.5641, device='cuda:3')
user_param_square tensor(81.4398, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(13.1214, device='cuda:3')
score : tensor(0.1181, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.7863, device='cuda:3')
user_param_square tensor(85.2950, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-5.5880, device='cuda:3')
score : tensor(-0.0690, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(509.5771, device='cuda:3')
user_param_square tensor(82.4171, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(19.0301, device='cuda:3')
score : tensor(0.1772, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.0169, device='cuda:3')
user_param_square tensor(85.6250, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-0.2707, device='cuda:3')
score : tensor(-0.0158, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.1366, device='cuda:3')
user_param_square tensor(95.0059, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-19.2124, device='cuda:3')
score : tensor(-0.2053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.1344, device='cuda:3')
user_param_square tensor(93.1639, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(2.0320, device='cuda:3')
score : tensor(0.0072, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.7478, device='cuda:3')
user_param_square tensor(92.0566, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(1.4737, device='cuda:3')
score : tensor(0.0016, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.3814, device='cuda:3')
user_param_square tensor(87.0427, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-1.7118, device='cuda:3')
score : tensor(-0.0302, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.8232, device='cuda:3')
user_param_square tensor(93.1416, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-8.9556, device='cuda:3')
score : tensor(-0.1027, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.0079, device='cuda:3')
user_param_square tensor(88.2311, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(2.4736, device='cuda:3')
score : tensor(0.0116, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.4582, device='cuda:3')
user_param_square tensor(93.1155, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(2.2683, device='cuda:3')
score : tensor(0.0096, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.3815, device='cuda:3')
user_param_square tensor(91.0837, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-7.1857, device='cuda:3')
score : tensor(-0.0850, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.8586, device='cuda:3')
user_param_square tensor(89.7923, device='cuda:3')
global_param_square tensor(13.3298, device='cuda:3')
part1 is  tensor(-3.0765, device='cuda:3')
score : tensor(-0.0439, device='cuda:3')
len accept list 9
len all weights is 9
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 89.47% 

Test Accuracy: 88.78% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
 benign loss is  0.9390779733657837
distance x is tensor(104.8912, device='cuda:3')
benign distance is  tensor(104.8912, device='cuda:3')
norm1 res is  tensor(0.1147, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.37912020087242126
distance x is tensor(118.7253, device='cuda:3')
benign distance is  tensor(118.7253, device='cuda:3')
norm1 res is  tensor(0.1309, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.36343005299568176
distance x is tensor(109.9194, device='cuda:3')
benign distance is  tensor(109.9194, device='cuda:3')
norm1 res is  tensor(0.1169, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5790314674377441
distance x is tensor(120.5044, device='cuda:3')
benign distance is  tensor(120.5044, device='cuda:3')
norm1 res is  tensor(0.1283, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5514319539070129
distance x is tensor(123.3500, device='cuda:3')
benign distance is  tensor(123.3500, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7015419006347656
distance x is tensor(147.2332, device='cuda:3')
benign distance is  tensor(147.2332, device='cuda:3')
norm1 res is  tensor(0.1590, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.19630947709083557
distance x is tensor(92.2477, device='cuda:3')
benign distance is  tensor(92.2477, device='cuda:3')
norm1 res is  tensor(0.0973, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.6422185897827148
distance x is tensor(133.8354, device='cuda:3')
benign distance is  tensor(133.8354, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3398289084434509
distance x is tensor(127.9632, device='cuda:3')
benign distance is  tensor(127.9632, device='cuda:3')
norm1 res is  tensor(0.1381, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.6882381439208984
distance x is tensor(124.4563, device='cuda:3')
benign distance is  tensor(124.4563, device='cuda:3')
norm1 res is  tensor(0.1340, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.37429410219192505
distance x is tensor(110.1124, device='cuda:3')
benign distance is  tensor(110.1124, device='cuda:3')
norm1 res is  tensor(0.1198, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.8040745854377747
distance x is tensor(135.5573, device='cuda:3')
benign distance is  tensor(135.5573, device='cuda:3')
norm1 res is  tensor(0.1513, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.6506444215774536
distance x is tensor(133.3929, device='cuda:3')
benign distance is  tensor(133.3929, device='cuda:3')
norm1 res is  tensor(0.1448, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.15651874244213104
distance x is tensor(135.1714, device='cuda:3')
benign distance is  tensor(135.1714, device='cuda:3')
norm1 res is  tensor(0.1465, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.22125402092933655
distance x is tensor(132.1305, device='cuda:3')
benign distance is  tensor(132.1305, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.8368433117866516
distance x is tensor(122.7656, device='cuda:3')
benign distance is  tensor(122.7656, device='cuda:3')
norm1 res is  tensor(0.1325, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(128.1050, device='cuda:3')
compute distance is  tensor(128.1050, device='cuda:3')
compute norm is  tensor(58.2613, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6354, device='cuda:3')
compute distance is  tensor(131.6354, device='cuda:3')
compute norm is  tensor(58.3155, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.3713, device='cuda:3')
compute distance is  tensor(136.3713, device='cuda:3')
compute norm is  tensor(58.5821, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1017, device='cuda:3')
compute distance is  tensor(131.1017, device='cuda:3')
compute norm is  tensor(58.3605, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1200, device='cuda:3')
compute distance is  tensor(131.1200, device='cuda:3')
compute norm is  tensor(58.2677, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.5990, device='cuda:3')
compute distance is  tensor(152.5990, device='cuda:3')
compute norm is  tensor(58.8557, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.7245, device='cuda:3')
compute distance is  tensor(129.7245, device='cuda:3')
compute norm is  tensor(58.3354, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7849, device='cuda:3')
compute distance is  tensor(132.7849, device='cuda:3')
compute norm is  tensor(58.3173, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.2040, device='cuda:3')
compute distance is  tensor(142.2040, device='cuda:3')
compute norm is  tensor(58.4533, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6324, device='cuda:3')
compute distance is  tensor(134.6324, device='cuda:3')
compute norm is  tensor(58.6517, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2527, device='cuda:3')
compute distance is  tensor(138.2527, device='cuda:3')
compute norm is  tensor(58.5581, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.8101, device='cuda:3')
compute distance is  tensor(134.8101, device='cuda:3')
compute norm is  tensor(58.3884, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(152.5990, device='cuda:3')
distance x is tensor(107572.7031, device='cuda:3')
distance x is tensor(107572.7031, device='cuda:3')
________________________________
test distance is  tensor(107572.7031, device='cuda:3')
test distance1 is  tensor(107572.7031, device='cuda:3')
test similarity is  tensor(0.4239, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130133168151964.66
test entropy is  0.0
________________________________
cal ratio is  0.03691057952591126
distance x is tensor(3970.5757, device='cuda:3')
cal_distance is  tensor(3970.5757, device='cuda:3')
cal ratio is  0.19212113697738786
distance x is tensor(762.8356, device='cuda:3')
cal_distance is  tensor(762.8356, device='cuda:3')
cal ratio is  0.4383150721740642
distance x is tensor(334.3652, device='cuda:3')
cal_distance is  tensor(334.3652, device='cuda:3')
cal ratio is  0.6620508588831417
distance x is tensor(221.3685, device='cuda:3')
cal_distance is  tensor(221.3685, device='cuda:3')
cal ratio is  0.8136620013534834
distance x is tensor(180.1201, device='cuda:3')
cal_distance is  tensor(180.1201, device='cuda:3')
cal ratio is  0.9020297180273784
distance x is tensor(162.4741, device='cuda:3')
cal_distance is  tensor(162.4741, device='cuda:3')
cal ratio is  0.9497510269949738
distance x is tensor(154.3103, device='cuda:3')
cal_distance is  tensor(154.3103, device='cuda:3')
cal ratio is  0.9745508474997535
distance x is tensor(150.3833, device='cuda:3')
cal_distance is  tensor(150.3833, device='cuda:3')
distance x is tensor(150.3833, device='cuda:3')
return_distance is  tensor(150.3833, device='cuda:3')
distance x is tensor(150.3732, device='cuda:3')
distance x is tensor(150.3732, device='cuda:3')
________________________________
test distance is  tensor(150.3732, device='cuda:3')
test distance1 is  tensor(150.3732, device='cuda:3')
test similarity is  tensor(0.9735, device='cuda:3')
test acc is  0.1503500001563332
test loss is 95.16258796903371
test entropy is  0.011397468390777592
________________________________
0
distance x is tensor(150.3732, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.011888863836570729
avg test loss is  95.09574545268565
avg accuracy is  0.8406166668229904
solo acc is  0.14968333348966648
compute similarity  is  tensor(0.9735, device='cuda:3')
compute_distance is  tensor(150.3732, device='cuda:3')
compute_norm is  tensor(61.9094, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.3167, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9559087766640222
avg test loss is  1.4084469490468121
avg accuracy is  0.8144166668229915
solo acc is  0.30106666682300615
compute similarity  is  tensor(0.9740, device='cuda:3')
compute_distance is  tensor(147.3167, device='cuda:3')
compute_norm is  tensor(61.8604, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.6786, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9048094909582565
avg test loss is  1.4842547438800462
avg accuracy is  0.8114333334896583
solo acc is  0.23781666682300448
compute similarity  is  tensor(0.9738, device='cuda:3')
compute_distance is  tensor(147.6786, device='cuda:3')
compute_norm is  tensor(61.5620, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.8084, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8855096433462619
avg test loss is  1.453804674687416
avg accuracy is  0.8150166668229913
solo acc is  0.23806666682300454
compute similarity  is  tensor(0.9737, device='cuda:3')
compute_distance is  tensor(147.8084, device='cuda:3')
compute_norm is  tensor(61.2617, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.8926, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8679511434615039
avg test loss is  1.436346049374863
avg accuracy is  0.8185333334896578
solo acc is  0.23766666682300452
compute similarity  is  tensor(0.9736, device='cuda:3')
compute_distance is  tensor(147.8926, device='cuda:3')
compute_norm is  tensor(60.9644, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.0910, device='cuda:3')
distance x is tensor(148.0910, device='cuda:3')
________________________________
test distance is  tensor(148.0910, device='cuda:3')
test distance1 is  tensor(148.0910, device='cuda:3')
test similarity is  tensor(0.9735, device='cuda:3')
test acc is  0.232433333489671
test loss is 1.428607909155807
test entropy is  0.8570462749329711
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.180772066116333
mal norm is  tensor(721.4026, device='cuda:3')
distance x is tensor(148.1001, device='cuda:3')
mal distance is  tensor(148.1001, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(20.1013, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.9467, device='cuda:3')
user_param_square tensor(95.6295, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(10.9476, device='cuda:3')
score : tensor(0.0896, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.6649, device='cuda:3')
user_param_square tensor(101.1178, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(-59.9918, device='cuda:3')
score : tensor(-0.6198, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(462.9293, device='cuda:3')
user_param_square tensor(96.4648, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(-1.8732, device='cuda:3')
score : tensor(-0.0386, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.9714, device='cuda:3')
user_param_square tensor(100.9493, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(-25.3164, device='cuda:3')
score : tensor(-0.2731, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.5026, device='cuda:3')
user_param_square tensor(102.2876, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(-16.7672, device='cuda:3')
score : tensor(-0.1876, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.5451, device='cuda:3')
user_param_square tensor(111.7758, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(-48.1923, device='cuda:3')
score : tensor(-0.5018, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(379.5355, device='cuda:3')
user_param_square tensor(87.3450, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(48.9778, device='cuda:3')
score : tensor(0.4699, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.9626, device='cuda:3')
user_param_square tensor(107.4122, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(27.2007, device='cuda:3')
score : tensor(0.2521, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4026, device='cuda:3')
user_param_square tensor(120.4205, device='cuda:3')
global_param_square tensor(20.1013, device='cuda:3')
part1 is  tensor(9.2687, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
len accept list 15
len all weights is 15
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 81.79% 

Test Accuracy: 81.46% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
 benign loss is  1.0615930557250977
distance x is tensor(155.0675, device='cuda:3')
benign distance is  tensor(155.0675, device='cuda:3')
norm1 res is  tensor(0.1642, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.9193569421768188
distance x is tensor(148.1969, device='cuda:3')
benign distance is  tensor(148.1969, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.44145911931991577
distance x is tensor(160.4557, device='cuda:3')
benign distance is  tensor(160.4557, device='cuda:3')
norm1 res is  tensor(0.1668, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5491116642951965
distance x is tensor(149.6155, device='cuda:3')
benign distance is  tensor(149.6155, device='cuda:3')
norm1 res is  tensor(0.1567, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.2458612620830536
distance x is tensor(144.9256, device='cuda:3')
benign distance is  tensor(144.9256, device='cuda:3')
norm1 res is  tensor(0.1505, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8952741622924805
distance x is tensor(165.8676, device='cuda:3')
benign distance is  tensor(165.8676, device='cuda:3')
norm1 res is  tensor(0.1696, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.4452721178531647
distance x is tensor(154.3167, device='cuda:3')
benign distance is  tensor(154.3167, device='cuda:3')
norm1 res is  tensor(0.1563, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.7537370920181274
distance x is tensor(196.8244, device='cuda:3')
benign distance is  tensor(196.8244, device='cuda:3')
norm1 res is  tensor(0.1939, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(155.6526, device='cuda:3')
compute distance is  tensor(155.6526, device='cuda:3')
compute norm is  tensor(61.2617, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.8312, device='cuda:3')
compute distance is  tensor(143.8312, device='cuda:3')
compute norm is  tensor(60.7674, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.0346, device='cuda:3')
compute distance is  tensor(172.0346, device='cuda:3')
compute norm is  tensor(61.6353, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.1462, device='cuda:3')
compute distance is  tensor(170.1462, device='cuda:3')
compute norm is  tensor(61.4012, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7148, device='cuda:3')
compute distance is  tensor(158.7148, device='cuda:3')
compute norm is  tensor(61.0022, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.7878, device='cuda:3')
compute distance is  tensor(153.7878, device='cuda:3')
compute norm is  tensor(61.0892, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.7511, device='cuda:3')
compute distance is  tensor(154.7511, device='cuda:3')
compute norm is  tensor(61.0753, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.2856, device='cuda:3')
compute distance is  tensor(167.2856, device='cuda:3')
compute norm is  tensor(61.4640, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.9816, device='cuda:3')
compute distance is  tensor(169.9816, device='cuda:3')
compute norm is  tensor(61.2076, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.1000, device='cuda:3')
compute distance is  tensor(164.1000, device='cuda:3')
compute norm is  tensor(61.1801, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.4594, device='cuda:3')
compute distance is  tensor(166.4594, device='cuda:3')
compute norm is  tensor(61.3371, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.2646, device='cuda:3')
compute distance is  tensor(165.2646, device='cuda:3')
compute norm is  tensor(61.5062, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(172.0346, device='cuda:3')
distance x is tensor(107498.8750, device='cuda:3')
distance x is tensor(107498.8750, device='cuda:3')
________________________________
test distance is  tensor(107498.8750, device='cuda:3')
test distance1 is  tensor(107498.8750, device='cuda:3')
test similarity is  tensor(0.5449, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130148943644754.97
test entropy is  0.0
________________________________
cal ratio is  0.039204149200457075
distance x is tensor(4214.4082, device='cuda:3')
cal_distance is  tensor(4214.4082, device='cuda:3')
cal ratio is  0.19800022370333029
distance x is tensor(834.4578, device='cuda:3')
cal_distance is  tensor(834.4578, device='cuda:3')
cal ratio is  0.4449710982023838
distance x is tensor(371.3124, device='cuda:3')
cal_distance is  tensor(371.3124, device='cuda:3')
cal ratio is  0.6670590410856805
distance x is tensor(247.6889, device='cuda:3')
cal_distance is  tensor(247.6889, device='cuda:3')
cal ratio is  0.8167340797575142
distance x is tensor(202.2969, device='cuda:3')
cal_distance is  tensor(202.2969, device='cuda:3')
cal ratio is  0.9037313287370661
distance x is tensor(182.8226, device='cuda:3')
cal_distance is  tensor(182.8226, device='cuda:3')
cal ratio is  0.9506465321546952
distance x is tensor(173.7999, device='cuda:3')
cal_distance is  tensor(173.7999, device='cuda:3')
cal ratio is  0.9750103437535259
distance x is tensor(169.4568, device='cuda:3')
cal_distance is  tensor(169.4568, device='cuda:3')
distance x is tensor(169.4568, device='cuda:3')
return_distance is  tensor(169.4568, device='cuda:3')
distance x is tensor(169.4468, device='cuda:3')
distance x is tensor(169.4468, device='cuda:3')
________________________________
test distance is  tensor(169.4468, device='cuda:3')
test distance1 is  tensor(169.4468, device='cuda:3')
test similarity is  tensor(0.9766, device='cuda:3')
test acc is  0.11865000015633194
test loss is 140.24530826397796
test entropy is  0.008701467551328609
________________________________
0
distance x is tensor(169.4468, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00887565675101827
avg test loss is  140.22664258424152
avg accuracy is  0.5947666668230047
solo acc is  0.11853333348966527
compute similarity  is  tensor(0.9766, device='cuda:3')
compute_distance is  tensor(169.4468, device='cuda:3')
compute_norm is  tensor(65.9306, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.5230, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0776794386952162
avg test loss is  1.5909951650765912
avg accuracy is  0.4056000001563412
solo acc is  0.23895000015633786
compute similarity  is  tensor(0.9776, device='cuda:3')
compute_distance is  tensor(163.5230, device='cuda:3')
compute_norm is  tensor(66.1816, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.6183, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6351342721661525
avg test loss is  2.4671505959049216
avg accuracy is  0.24965000015633823
solo acc is  0.10960000015633195
compute similarity  is  tensor(0.9776, device='cuda:3')
compute_distance is  tensor(163.6183, device='cuda:3')
compute_norm is  tensor(65.9551, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(162.9904, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9902754987099531
avg test loss is  1.4974655167126198
avg accuracy is  0.38866666682300766
solo acc is  0.22863333348967083
compute similarity  is  tensor(0.9779, device='cuda:3')
compute_distance is  tensor(162.9904, device='cuda:3')
compute_norm is  tensor(65.6392, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(162.9904, device='cuda:3')
distance x is tensor(162.9904, device='cuda:3')
________________________________
test distance is  tensor(162.9904, device='cuda:3')
test distance1 is  tensor(162.9904, device='cuda:3')
test similarity is  tensor(0.9779, device='cuda:3')
test acc is  0.22856666682300422
test loss is 1.493882101227734
test entropy is  0.9894428710693489
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.5310615301132202
mal norm is  tensor(820.6491, device='cuda:3')
distance x is tensor(162.9996, device='cuda:3')
mal distance is  tensor(162.9996, device='cuda:3')
len current grad  20
len all grad 52
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(26.9983, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.3619, device='cuda:3')
user_param_square tensor(131.5891, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(191.8967, device='cuda:3')
score : tensor(1.8922, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.6664, device='cuda:3')
user_param_square tensor(128.6116, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(223.5594, device='cuda:3')
score : tensor(2.2088, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.2063, device='cuda:3')
user_param_square tensor(133.2046, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(209.4989, device='cuda:3')
score : tensor(2.0682, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.9053, device='cuda:3')
user_param_square tensor(129.5777, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(132.3379, device='cuda:3')
score : tensor(1.2966, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.0563, device='cuda:3')
user_param_square tensor(125.6803, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(121.2935, device='cuda:3')
score : tensor(1.1861, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.6086, device='cuda:3')
user_param_square tensor(134.4556, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(243.9314, device='cuda:3')
score : tensor(2.4125, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.5833, device='cuda:3')
user_param_square tensor(129.2312, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(254.7890, device='cuda:3')
score : tensor(2.5211, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(759.3965, device='cuda:3')
user_param_square tensor(143.1867, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(171.7795, device='cuda:3')
score : tensor(1.6910, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6491, device='cuda:3')
user_param_square tensor(148.8494, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(-226.8733, device='cuda:3')
score : tensor(-2.2955, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(846.8672, device='cuda:3')
user_param_square tensor(151.2084, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(234.5243, device='cuda:3')
score : tensor(2.3184, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(863.4390, device='cuda:3')
user_param_square tensor(152.6807, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(180.9707, device='cuda:3')
score : tensor(1.7829, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.6436, device='cuda:3')
user_param_square tensor(152.9638, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(213.0403, device='cuda:3')
score : tensor(2.1036, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(870.6994, device='cuda:3')
user_param_square tensor(153.3213, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(203.6129, device='cuda:3')
score : tensor(2.0093, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(870.7574, device='cuda:3')
user_param_square tensor(153.3264, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(186.3256, device='cuda:3')
score : tensor(1.8365, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(854.8908, device='cuda:3')
user_param_square tensor(151.9230, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(191.2796, device='cuda:3')
score : tensor(1.8860, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(910.4850, device='cuda:3')
user_param_square tensor(156.7851, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(171.1391, device='cuda:3')
score : tensor(1.6846, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.7908, device='cuda:3')
user_param_square tensor(152.3578, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(210.9442, device='cuda:3')
score : tensor(2.0826, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(814.2890, device='cuda:3')
user_param_square tensor(148.2715, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(93.5008, device='cuda:3')
score : tensor(0.9082, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.9827, device='cuda:3')
user_param_square tensor(134.7939, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(241.2971, device='cuda:3')
score : tensor(2.3862, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(740.3550, device='cuda:3')
user_param_square tensor(141.3801, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(197.1147, device='cuda:3')
score : tensor(1.9443, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.4700, device='cuda:3')
user_param_square tensor(138.4973, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(174.6021, device='cuda:3')
score : tensor(1.7192, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.1978, device='cuda:3')
user_param_square tensor(140.5030, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(169.5074, device='cuda:3')
score : tensor(1.6683, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.2614, device='cuda:3')
user_param_square tensor(140.8929, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(146.2062, device='cuda:3')
score : tensor(1.4353, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.9867, device='cuda:3')
user_param_square tensor(140.0015, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(160.4271, device='cuda:3')
score : tensor(1.5775, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.3941, device='cuda:3')
user_param_square tensor(140.0408, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(183.5146, device='cuda:3')
score : tensor(1.8083, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(791.3466, device='cuda:3')
user_param_square tensor(146.1678, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(198.3736, device='cuda:3')
score : tensor(1.9569, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(814.8242, device='cuda:3')
user_param_square tensor(148.3202, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(176.4632, device='cuda:3')
score : tensor(1.7378, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(821.2641, device='cuda:3')
user_param_square tensor(148.9051, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(213.6173, device='cuda:3')
score : tensor(2.1094, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.4020, device='cuda:3')
user_param_square tensor(144.3141, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(212.4335, device='cuda:3')
score : tensor(2.0975, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6390, device='cuda:3')
user_param_square tensor(141.9788, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(105.7198, device='cuda:3')
score : tensor(1.0304, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(748.5451, device='cuda:3')
user_param_square tensor(142.1599, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(179.0324, device='cuda:3')
score : tensor(1.7635, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(778.4904, device='cuda:3')
user_param_square tensor(144.9756, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(198.9845, device='cuda:3')
score : tensor(1.9630, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(760.1179, device='cuda:3')
user_param_square tensor(143.2547, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(179.7164, device='cuda:3')
score : tensor(1.7704, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.2942, device='cuda:3')
user_param_square tensor(140.7043, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(143.3727, device='cuda:3')
score : tensor(1.4069, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(716.4051, device='cuda:3')
user_param_square tensor(139.0745, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(246.9216, device='cuda:3')
score : tensor(2.4424, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.7328, device='cuda:3')
user_param_square tensor(135.3685, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(242.6058, device='cuda:3')
score : tensor(2.3993, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.1218, device='cuda:3')
user_param_square tensor(143.0664, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(178.4305, device='cuda:3')
score : tensor(1.7575, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.1010, device='cuda:3')
user_param_square tensor(142.8756, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(202.7059, device='cuda:3')
score : tensor(2.0003, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(752.8041, device='cuda:3')
user_param_square tensor(142.5638, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(186.9582, device='cuda:3')
score : tensor(1.8428, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.9581, device='cuda:3')
user_param_square tensor(142.2941, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(161.5305, device='cuda:3')
score : tensor(1.5885, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9479, device='cuda:3')
user_param_square tensor(138.9330, device='cuda:3')
global_param_square tensor(26.9983, device='cuda:3')
part1 is  tensor(166.1487, device='cuda:3')
score : tensor(1.6347, device='cuda:3')
accept
len accept list 40
len all weights is 40
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.66% 

Test Accuracy: 88.84% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5823869109153748
distance x is tensor(106.2360, device='cuda:3')
benign distance is  tensor(106.2360, device='cuda:3')
norm1 res is  tensor(0.1166, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5696433782577515
distance x is tensor(135.1391, device='cuda:3')
benign distance is  tensor(135.1391, device='cuda:3')
norm1 res is  tensor(0.1442, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.25139886140823364
distance x is tensor(101.3131, device='cuda:3')
benign distance is  tensor(101.3131, device='cuda:3')
norm1 res is  tensor(0.1159, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5651049613952637
distance x is tensor(124.0490, device='cuda:3')
benign distance is  tensor(124.0490, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7966408729553223
distance x is tensor(100.9215, device='cuda:3')
benign distance is  tensor(100.9215, device='cuda:3')
norm1 res is  tensor(0.1094, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7702469229698181
distance x is tensor(130.2798, device='cuda:3')
benign distance is  tensor(130.2798, device='cuda:3')
norm1 res is  tensor(0.1386, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.7027161717414856
distance x is tensor(107.1516, device='cuda:3')
benign distance is  tensor(107.1516, device='cuda:3')
norm1 res is  tensor(0.1136, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.6051879525184631
distance x is tensor(125.3322, device='cuda:3')
benign distance is  tensor(125.3322, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.6849005222320557
distance x is tensor(129.8766, device='cuda:3')
benign distance is  tensor(129.8766, device='cuda:3')
norm1 res is  tensor(0.1385, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.7824355363845825
distance x is tensor(139.6250, device='cuda:3')
benign distance is  tensor(139.6250, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  1.3246705532073975
distance x is tensor(129.2031, device='cuda:3')
benign distance is  tensor(129.2031, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6791852116584778
distance x is tensor(127.3016, device='cuda:3')
benign distance is  tensor(127.3016, device='cuda:3')
norm1 res is  tensor(0.1377, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.49918627738952637
distance x is tensor(132.0662, device='cuda:3')
benign distance is  tensor(132.0662, device='cuda:3')
norm1 res is  tensor(0.1428, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.2644191086292267
distance x is tensor(131.4097, device='cuda:3')
benign distance is  tensor(131.4097, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.3094627857208252
distance x is tensor(129.4873, device='cuda:3')
benign distance is  tensor(129.4873, device='cuda:3')
norm1 res is  tensor(0.1390, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.513614296913147
distance x is tensor(133.9965, device='cuda:3')
benign distance is  tensor(133.9965, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.37845659255981445
distance x is tensor(124.3430, device='cuda:3')
benign distance is  tensor(124.3430, device='cuda:3')
norm1 res is  tensor(0.1360, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.2882041335105896
distance x is tensor(142.6431, device='cuda:3')
benign distance is  tensor(142.6431, device='cuda:3')
norm1 res is  tensor(0.1541, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.06011877581477165
distance x is tensor(132.2434, device='cuda:3')
benign distance is  tensor(132.2434, device='cuda:3')
norm1 res is  tensor(0.1409, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.3985723853111267
distance x is tensor(141.8354, device='cuda:3')
benign distance is  tensor(141.8354, device='cuda:3')
norm1 res is  tensor(0.1539, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.3684662878513336
distance x is tensor(134.2676, device='cuda:3')
benign distance is  tensor(134.2676, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5899564027786255
distance x is tensor(119.4465, device='cuda:3')
benign distance is  tensor(119.4465, device='cuda:3')
norm1 res is  tensor(0.1280, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.5115100741386414
distance x is tensor(125.1927, device='cuda:3')
benign distance is  tensor(125.1927, device='cuda:3')
norm1 res is  tensor(0.1337, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.9101179242134094
distance x is tensor(140.4950, device='cuda:3')
benign distance is  tensor(140.4950, device='cuda:3')
norm1 res is  tensor(0.1449, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.5151441693305969
distance x is tensor(132.5068, device='cuda:3')
benign distance is  tensor(132.5068, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.5946477651596069
distance x is tensor(126.6749, device='cuda:3')
benign distance is  tensor(126.6749, device='cuda:3')
norm1 res is  tensor(0.1327, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.4111899733543396
distance x is tensor(148.1389, device='cuda:3')
benign distance is  tensor(148.1389, device='cuda:3')
norm1 res is  tensor(0.1600, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.2331743687391281
distance x is tensor(134.1113, device='cuda:3')
benign distance is  tensor(134.1113, device='cuda:3')
norm1 res is  tensor(0.1401, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.43983420729637146
distance x is tensor(125.9891, device='cuda:3')
benign distance is  tensor(125.9891, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.37306347489356995
distance x is tensor(130.4056, device='cuda:3')
benign distance is  tensor(130.4056, device='cuda:3')
norm1 res is  tensor(0.1406, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.16135691106319427
distance x is tensor(130.9118, device='cuda:3')
benign distance is  tensor(130.9118, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.42384427785873413
distance x is tensor(127.1801, device='cuda:3')
benign distance is  tensor(127.1801, device='cuda:3')
norm1 res is  tensor(0.1377, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.14581835269927979
distance x is tensor(131.5770, device='cuda:3')
benign distance is  tensor(131.5770, device='cuda:3')
norm1 res is  tensor(0.1412, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.27305835485458374
distance x is tensor(127.1709, device='cuda:3')
benign distance is  tensor(127.1709, device='cuda:3')
norm1 res is  tensor(0.1353, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.40403231978416443
distance x is tensor(115.6501, device='cuda:3')
benign distance is  tensor(115.6501, device='cuda:3')
norm1 res is  tensor(0.1276, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.20643694698810577
distance x is tensor(125.1830, device='cuda:3')
benign distance is  tensor(125.1830, device='cuda:3')
norm1 res is  tensor(0.1356, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.4177313446998596
distance x is tensor(128.7962, device='cuda:3')
benign distance is  tensor(128.7962, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.1455964297056198
distance x is tensor(135.7828, device='cuda:3')
benign distance is  tensor(135.7828, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.40758657455444336
distance x is tensor(134.3738, device='cuda:3')
benign distance is  tensor(134.3738, device='cuda:3')
norm1 res is  tensor(0.1447, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.3738800883293152
distance x is tensor(129.9748, device='cuda:3')
benign distance is  tensor(129.9748, device='cuda:3')
norm1 res is  tensor(0.1426, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(135.0111, device='cuda:3')
compute distance is  tensor(135.0111, device='cuda:3')
compute norm is  tensor(59.1093, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3408, device='cuda:3')
compute distance is  tensor(125.3408, device='cuda:3')
compute norm is  tensor(58.9601, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4825, device='cuda:3')
compute distance is  tensor(126.4825, device='cuda:3')
compute norm is  tensor(59.0315, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.4035, device='cuda:3')
compute distance is  tensor(119.4035, device='cuda:3')
compute norm is  tensor(58.9855, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.9589, device='cuda:3')
compute distance is  tensor(140.9589, device='cuda:3')
compute norm is  tensor(59.3395, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7169, device='cuda:3')
compute distance is  tensor(128.7169, device='cuda:3')
compute norm is  tensor(59.1927, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5985, device='cuda:3')
compute distance is  tensor(124.5985, device='cuda:3')
compute norm is  tensor(58.9866, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.8980, device='cuda:3')
compute distance is  tensor(155.8980, device='cuda:3')
compute norm is  tensor(59.6455, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6955, device='cuda:3')
compute distance is  tensor(133.6955, device='cuda:3')
compute norm is  tensor(59.1267, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.4684, device='cuda:3')
compute distance is  tensor(127.4684, device='cuda:3')
compute norm is  tensor(59.1755, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2606, device='cuda:3')
compute distance is  tensor(133.2606, device='cuda:3')
compute norm is  tensor(59.2175, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.2303, device='cuda:3')
compute distance is  tensor(124.2303, device='cuda:3')
compute norm is  tensor(59.0488, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(155.8980, device='cuda:3')
distance x is tensor(107555.4844, device='cuda:3')
distance x is tensor(107555.4844, device='cuda:3')
________________________________
test distance is  tensor(107555.4844, device='cuda:3')
test distance1 is  tensor(107555.4844, device='cuda:3')
test similarity is  tensor(0.4566, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130056567157687.95
test entropy is  0.0
________________________________
cal ratio is  0.03731041136301522
distance x is tensor(4012.9443, device='cuda:3')
cal_distance is  tensor(4012.9443, device='cuda:3')
cal ratio is  0.19315891081185868
distance x is tensor(775.1401, device='cuda:3')
cal_distance is  tensor(775.1401, device='cuda:3')
cal ratio is  0.43949730878007076
distance x is tensor(340.6748, device='cuda:3')
cal_distance is  tensor(340.6748, device='cuda:3')
cal ratio is  0.6629431611498469
distance x is tensor(225.8498, device='cuda:3')
cal_distance is  tensor(225.8498, device='cuda:3')
cal ratio is  0.8142100847566823
distance x is tensor(183.8901, device='cuda:3')
cal_distance is  tensor(183.8901, device='cuda:3')
cal ratio is  0.902333616442566
distance x is tensor(165.9307, device='cuda:3')
cal_distance is  tensor(165.9307, device='cuda:3')
cal ratio is  0.9499110080797986
distance x is tensor(157.6197, device='cuda:3')
cal_distance is  tensor(157.6197, device='cuda:3')
cal ratio is  0.9746329907570047
distance x is tensor(153.6215, device='cuda:3')
cal_distance is  tensor(153.6215, device='cuda:3')
distance x is tensor(153.6215, device='cuda:3')
return_distance is  tensor(153.6215, device='cuda:3')
distance x is tensor(153.6113, device='cuda:3')
distance x is tensor(153.6113, device='cuda:3')
________________________________
test distance is  tensor(153.6113, device='cuda:3')
test distance1 is  tensor(153.6113, device='cuda:3')
test similarity is  tensor(0.9748, device='cuda:3')
test acc is  0.1773666668230018
test loss is 71.0506813317728
test entropy is  0.02116387568331042
________________________________
0
distance x is tensor(153.6113, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.02094074367417196
avg test loss is  70.99033494392184
avg accuracy is  0.8652833334896559
solo acc is  0.1774000001563351
compute similarity  is  tensor(0.9748, device='cuda:3')
compute_distance is  tensor(153.6113, device='cuda:3')
compute_norm is  tensor(63.0101, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.6714, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9140143416710754
avg test loss is  1.3208431961185643
avg accuracy is  0.8286166668229907
solo acc is  0.32200000015633995
compute similarity  is  tensor(0.9755, device='cuda:3')
compute_distance is  tensor(147.6714, device='cuda:3')
compute_norm is  tensor(62.7392, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.0731, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8648784492951213
avg test loss is  1.4180163567000106
avg accuracy is  0.8287333334896574
solo acc is  0.25168333348967165
compute similarity  is  tensor(0.9754, device='cuda:3')
compute_distance is  tensor(148.0731, device='cuda:3')
compute_norm is  tensor(62.4244, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.2731, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8583311031876343
avg test loss is  1.3931867044363448
avg accuracy is  0.8277833334896575
solo acc is  0.25381666682300497
compute similarity  is  tensor(0.9752, device='cuda:3')
compute_distance is  tensor(148.2731, device='cuda:3')
compute_norm is  tensor(62.1121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.4344, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8523734577937421
avg test loss is  1.371131364470606
avg accuracy is  0.8283666668229909
solo acc is  0.252916666823005
compute similarity  is  tensor(0.9751, device='cuda:3')
compute_distance is  tensor(148.4344, device='cuda:3')
compute_norm is  tensor(61.8047, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.6259, device='cuda:3')
distance x is tensor(148.6259, device='cuda:3')
________________________________
test distance is  tensor(148.6259, device='cuda:3')
test distance1 is  tensor(148.6259, device='cuda:3')
test similarity is  tensor(0.9749, device='cuda:3')
test acc is  0.24218333348967136
test loss is 1.3647689790105515
test entropy is  0.8425112165876035
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2387824058532715
mal norm is  tensor(731.5209, device='cuda:3')
distance x is tensor(148.6350, device='cuda:3')
mal distance is  tensor(148.6350, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(15.7658, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.8334, device='cuda:3')
user_param_square tensor(84.6808, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-3.5907, device='cuda:3')
score : tensor(-0.0515, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.5486, device='cuda:3')
user_param_square tensor(94.4264, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-0.4933, device='cuda:3')
score : tensor(-0.0205, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(430.2622, device='cuda:3')
user_param_square tensor(82.3617, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(14.1830, device='cuda:3')
score : tensor(0.1263, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.6713, device='cuda:3')
user_param_square tensor(91.3822, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-6.0323, device='cuda:3')
score : tensor(-0.0759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(427.0296, device='cuda:3')
user_param_square tensor(82.0517, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-27.0144, device='cuda:3')
score : tensor(-0.2857, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.3173, device='cuda:3')
user_param_square tensor(92.9768, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-32.5452, device='cuda:3')
score : tensor(-0.3410, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(445.3799, device='cuda:3')
user_param_square tensor(83.7961, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(5.6521, device='cuda:3')
score : tensor(0.0410, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.0646, device='cuda:3')
user_param_square tensor(91.5885, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(1.2757, device='cuda:3')
score : tensor(-0.0028, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5209, device='cuda:3')
user_param_square tensor(107.3920, device='cuda:3')
global_param_square tensor(15.7658, device='cuda:3')
part1 is  tensor(-17.1069, device='cuda:3')
score : tensor(-0.1866, device='cuda:3')
len accept list 2
len all weights is 2
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 88.84% 

Test Accuracy: 88.13% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
 benign loss is  0.9489347338676453
distance x is tensor(127.9245, device='cuda:3')
benign distance is  tensor(127.9245, device='cuda:3')
norm1 res is  tensor(0.1406, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.6339343786239624
distance x is tensor(146.7771, device='cuda:3')
benign distance is  tensor(146.7771, device='cuda:3')
norm1 res is  tensor(0.1558, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.43877163529396057
distance x is tensor(112.9372, device='cuda:3')
benign distance is  tensor(112.9372, device='cuda:3')
norm1 res is  tensor(0.1224, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.280752032995224
distance x is tensor(120.6566, device='cuda:3')
benign distance is  tensor(120.6566, device='cuda:3')
norm1 res is  tensor(0.1309, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.20455798506736755
distance x is tensor(134.0705, device='cuda:3')
benign distance is  tensor(134.0705, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.2882249355316162
distance x is tensor(146.4249, device='cuda:3')
benign distance is  tensor(146.4249, device='cuda:3')
norm1 res is  tensor(0.1580, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.6938648223876953
distance x is tensor(132.6760, device='cuda:3')
benign distance is  tensor(132.6760, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5085028409957886
distance x is tensor(135.8880, device='cuda:3')
benign distance is  tensor(135.8880, device='cuda:3')
norm1 res is  tensor(0.1465, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(146.8905, device='cuda:3')
compute distance is  tensor(146.8905, device='cuda:3')
compute norm is  tensor(60.0220, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.4567, device='cuda:3')
compute distance is  tensor(147.4567, device='cuda:3')
compute norm is  tensor(59.9217, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3575, device='cuda:3')
compute distance is  tensor(140.3575, device='cuda:3')
compute norm is  tensor(59.7873, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.7689, device='cuda:3')
compute distance is  tensor(154.7689, device='cuda:3')
compute norm is  tensor(60.2121, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.6332, device='cuda:3')
compute distance is  tensor(155.6332, device='cuda:3')
compute norm is  tensor(60.2426, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.1568, device='cuda:3')
compute distance is  tensor(154.1568, device='cuda:3')
compute norm is  tensor(60.1930, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.4688, device='cuda:3')
compute distance is  tensor(146.4688, device='cuda:3')
compute norm is  tensor(59.9162, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.0335, device='cuda:3')
compute distance is  tensor(164.0335, device='cuda:3')
compute norm is  tensor(60.1674, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.2066, device='cuda:3')
compute distance is  tensor(162.2066, device='cuda:3')
compute norm is  tensor(60.2033, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.0029, device='cuda:3')
compute distance is  tensor(148.0029, device='cuda:3')
compute norm is  tensor(59.8996, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.2230, device='cuda:3')
compute distance is  tensor(155.2230, device='cuda:3')
compute norm is  tensor(60.3027, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.0796, device='cuda:3')
compute distance is  tensor(145.0796, device='cuda:3')
compute norm is  tensor(60.1475, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(164.0335, device='cuda:3')
distance x is tensor(107559.4844, device='cuda:3')
distance x is tensor(107559.4844, device='cuda:3')
________________________________
test distance is  tensor(107559.4844, device='cuda:3')
test distance1 is  tensor(107559.4844, device='cuda:3')
test similarity is  tensor(0.4449, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130145026477826.73
test entropy is  0.0
________________________________
cal ratio is  0.038270839467690165
distance x is tensor(4116.3975, device='cuda:3')
cal_distance is  tensor(4116.3975, device='cuda:3')
cal ratio is  0.1956292019642615
distance x is tensor(805.2916, device='cuda:3')
cal_distance is  tensor(805.2916, device='cuda:3')
cal ratio is  0.4422988057926714
distance x is tensor(356.1823, device='cuda:3')
cal_distance is  tensor(356.1823, device='cuda:3')
cal ratio is  0.6650528441313329
distance x is tensor(236.8818, device='cuda:3')
cal_distance is  tensor(236.8818, device='cuda:3')
cal ratio is  0.8155048050431896
distance x is tensor(193.1792, device='cuda:3')
cal_distance is  tensor(193.1792, device='cuda:3')
cal ratio is  0.9030508727041202
distance x is tensor(174.4511, device='cuda:3')
cal_distance is  tensor(174.4511, device='cuda:3')
cal ratio is  0.9502885397863823
distance x is tensor(165.7791, device='cuda:3')
cal_distance is  tensor(165.7791, device='cuda:3')
cal ratio is  0.9748267063045617
distance x is tensor(161.6061, device='cuda:3')
cal_distance is  tensor(161.6061, device='cuda:3')
distance x is tensor(161.6061, device='cuda:3')
return_distance is  tensor(161.6061, device='cuda:3')
distance x is tensor(161.5960, device='cuda:3')
distance x is tensor(161.5960, device='cuda:3')
________________________________
test distance is  tensor(161.5960, device='cuda:3')
test distance1 is  tensor(161.5960, device='cuda:3')
test similarity is  tensor(0.9725, device='cuda:3')
test acc is  0.13431666682299856
test loss is 181.16128422914028
test entropy is  0.008527826933404809
________________________________
0
distance x is tensor(161.5960, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.008771136597366287
avg test loss is  181.3326772108261
avg accuracy is  0.7580000001563275
solo acc is  0.1353000001563319
compute similarity  is  tensor(0.9725, device='cuda:3')
compute_distance is  tensor(161.5960, device='cuda:3')
compute_norm is  tensor(64.0044, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(510.2779, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4548173485788456
avg test loss is  2.631169433786925
avg accuracy is  0.28303333348967236
solo acc is  0.10456666682299863
compute similarity  is  tensor(0.7544, device='cuda:3')
compute_distance is  tensor(510.2779, device='cuda:3')
compute_norm is  tensor(90.2634, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(508.3837, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8110893605106166
avg test loss is  3.3843815176725895
avg accuracy is  0.250416666823005
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.7544, device='cuda:3')
compute_distance is  tensor(508.3837, device='cuda:3')
compute_norm is  tensor(90.0284, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(506.7783, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.386050128479248
avg test loss is  2.4719805747969574
avg accuracy is  0.3046833334896729
solo acc is  0.1139166668229986
compute similarity  is  tensor(0.7542, device='cuda:3')
compute_distance is  tensor(506.7783, device='cuda:3')
compute_norm is  tensor(89.3995, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(505.0519, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7924156040906398
avg test loss is  3.2021882808538895
avg accuracy is  0.26861666682300545
solo acc is  0.10041666682299864
compute similarity  is  tensor(0.7541, device='cuda:3')
compute_distance is  tensor(505.0519, device='cuda:3')
compute_norm is  tensor(89.1457, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(503.5095, device='cuda:3')
distance x is tensor(503.5095, device='cuda:3')
________________________________
test distance is  tensor(503.5095, device='cuda:3')
test distance1 is  tensor(503.5095, device='cuda:3')
test similarity is  tensor(0.7539, device='cuda:3')
test acc is  0.11193333348966529
test loss is 2.386836616215167
test entropy is  1.3519042045322818
________________________________
cal ratio is  0.5593562647702867
distance x is tensor(281.6436, device='cuda:3')
cal_distance is  tensor(281.6436, device='cuda:3')
cal ratio is  0.7478979934142914
distance x is tensor(210.6411, device='cuda:3')
cal_distance is  tensor(210.6411, device='cuda:3')
cal ratio is  0.8648101965262978
distance x is tensor(182.1648, device='cuda:3')
cal_distance is  tensor(182.1648, device='cuda:3')
cal ratio is  0.9299511978460427
distance x is tensor(169.4044, device='cuda:3')
cal_distance is  tensor(169.4044, device='cuda:3')
cal ratio is  0.9643394690128428
distance x is tensor(163.3635, device='cuda:3')
cal_distance is  tensor(163.3635, device='cuda:3')
distance x is tensor(163.3635, device='cuda:3')
return_distance is  tensor(163.3635, device='cuda:3')
distance x is tensor(163.3603, device='cuda:3')
distance x is tensor(163.3603, device='cuda:3')
________________________________
test distance is  tensor(163.3603, device='cuda:3')
test distance1 is  tensor(163.3603, device='cuda:3')
test similarity is  tensor(0.9581, device='cuda:3')
test acc is  0.5082833334896754
test loss is 1.9251341034354432
test entropy is  0.9023784009505437
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.5000000005
mal loss is 2.6552913188934326
mal norm is  tensor(844.6329, device='cuda:3')
distance x is tensor(163.3635, device='cuda:3')
mal distance is  tensor(163.3635, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(25.7977, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.6081, device='cuda:3')
user_param_square tensor(118.4223, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-51.7886, device='cuda:3')
score : tensor(-0.5435, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.0601, device='cuda:3')
user_param_square tensor(126.3738, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-41.9048, device='cuda:3')
score : tensor(-0.4446, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(480.4067, device='cuda:3')
user_param_square tensor(111.3256, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(27.4847, device='cuda:3')
score : tensor(0.2492, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.0909, device='cuda:3')
user_param_square tensor(115.7210, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-77.4305, device='cuda:3')
score : tensor(-0.7999, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.7252, device='cuda:3')
user_param_square tensor(121.1272, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-20.0603, device='cuda:3')
score : tensor(-0.2262, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.6255, device='cuda:3')
user_param_square tensor(126.2273, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-11.0789, device='cuda:3')
score : tensor(-0.1364, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.7396, device='cuda:3')
user_param_square tensor(118.3277, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(5.0251, device='cuda:3')
score : tensor(0.0247, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.2592, device='cuda:3')
user_param_square tensor(122.1383, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-53.4715, device='cuda:3')
score : tensor(-0.5603, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.6329, device='cuda:3')
user_param_square tensor(147.6130, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(69.7900, device='cuda:3')
score : tensor(0.6723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.2645, device='cuda:3')
user_param_square tensor(125.7808, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(49.2258, device='cuda:3')
score : tensor(0.4667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.3231, device='cuda:3')
user_param_square tensor(128.8265, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(81.3034, device='cuda:3')
score : tensor(0.7874, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.4421, device='cuda:3')
user_param_square tensor(126.7185, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-12.3877, device='cuda:3')
score : tensor(-0.1495, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.9392, device='cuda:3')
user_param_square tensor(129.0881, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(27.8877, device='cuda:3')
score : tensor(0.2533, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7958, device='cuda:3')
user_param_square tensor(130.4654, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-39.4359, device='cuda:3')
score : tensor(-0.4200, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0880, device='cuda:3')
user_param_square tensor(130.2964, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(62.9501, device='cuda:3')
score : tensor(0.6039, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9102, device='cuda:3')
user_param_square tensor(128.4843, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-11.3777, device='cuda:3')
score : tensor(-0.1394, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2918, device='cuda:3')
user_param_square tensor(126.1931, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(32.4379, device='cuda:3')
score : tensor(0.2988, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.3314, device='cuda:3')
user_param_square tensor(124.6546, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-0.3907, device='cuda:3')
score : tensor(-0.0295, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.2972, device='cuda:3')
user_param_square tensor(128.3223, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-80.5320, device='cuda:3')
score : tensor(-0.8309, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.7292, device='cuda:3')
user_param_square tensor(123.7613, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-47.5029, device='cuda:3')
score : tensor(-0.5006, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.6829, device='cuda:3')
user_param_square tensor(123.6522, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(9.6760, device='cuda:3')
score : tensor(0.0712, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2834, device='cuda:3')
user_param_square tensor(126.1923, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-31.3269, device='cuda:3')
score : tensor(-0.3389, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.0529, device='cuda:3')
user_param_square tensor(124.5222, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(6.4647, device='cuda:3')
score : tensor(0.0390, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.3646, device='cuda:3')
user_param_square tensor(124.3472, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(65.1696, device='cuda:3')
score : tensor(0.6261, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.9404, device='cuda:3')
user_param_square tensor(127.7827, device='cuda:3')
global_param_square tensor(25.7977, device='cuda:3')
part1 is  tensor(-8.3992, device='cuda:3')
score : tensor(-0.1096, device='cuda:3')
len accept list 22
len all weights is 22
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 81.80% 

Test Accuracy: 81.12% 


 | Global Training Round : 51 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7004259824752808
distance x is tensor(226.8935, device='cuda:3')
benign distance is  tensor(226.8935, device='cuda:3')
norm1 res is  tensor(0.2336, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.1630520820617676
distance x is tensor(382.6228, device='cuda:3')
benign distance is  tensor(382.6228, device='cuda:3')
norm1 res is  tensor(0.4417, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.19942592084407806
distance x is tensor(285.9996, device='cuda:3')
benign distance is  tensor(285.9996, device='cuda:3')
norm1 res is  tensor(0.2812, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.755389928817749
distance x is tensor(369.2899, device='cuda:3')
benign distance is  tensor(369.2899, device='cuda:3')
norm1 res is  tensor(0.4613, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.807148277759552
distance x is tensor(269.7372, device='cuda:3')
benign distance is  tensor(269.7372, device='cuda:3')
norm1 res is  tensor(0.2713, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.1492687463760376
distance x is tensor(212.5467, device='cuda:3')
benign distance is  tensor(212.5467, device='cuda:3')
norm1 res is  tensor(0.2158, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.30870136618614197
distance x is tensor(238.7984, device='cuda:3')
benign distance is  tensor(238.7984, device='cuda:3')
norm1 res is  tensor(0.2392, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  1.0219959020614624
distance x is tensor(229.5199, device='cuda:3')
benign distance is  tensor(229.5199, device='cuda:3')
norm1 res is  tensor(0.2324, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.21797409653663635
distance x is tensor(223.7888, device='cuda:3')
benign distance is  tensor(223.7888, device='cuda:3')
norm1 res is  tensor(0.2240, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.16877028346061707
distance x is tensor(218.1550, device='cuda:3')
benign distance is  tensor(218.1550, device='cuda:3')
norm1 res is  tensor(0.2225, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.5110999345779419
distance x is tensor(258.4528, device='cuda:3')
benign distance is  tensor(258.4528, device='cuda:3')
norm1 res is  tensor(0.2631, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  1.1047405004501343
distance x is tensor(540.7734, device='cuda:3')
benign distance is  tensor(540.7734, device='cuda:3')
norm1 res is  tensor(0.7889, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.5917435884475708
distance x is tensor(261.9626, device='cuda:3')
benign distance is  tensor(261.9626, device='cuda:3')
norm1 res is  tensor(0.2712, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  1.651402235031128
distance x is tensor(316.7759, device='cuda:3')
benign distance is  tensor(316.7759, device='cuda:3')
norm1 res is  tensor(0.4545, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.2784141004085541
distance x is tensor(209.0851, device='cuda:3')
benign distance is  tensor(209.0851, device='cuda:3')
norm1 res is  tensor(0.2196, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.16394616663455963
distance x is tensor(216.9909, device='cuda:3')
benign distance is  tensor(216.9909, device='cuda:3')
norm1 res is  tensor(0.2219, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.5836523771286011
distance x is tensor(279.7087, device='cuda:3')
benign distance is  tensor(279.7087, device='cuda:3')
norm1 res is  tensor(0.2999, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.14445875585079193
distance x is tensor(361.7780, device='cuda:3')
benign distance is  tensor(361.7780, device='cuda:3')
norm1 res is  tensor(0.4262, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.8016034960746765
distance x is tensor(271.3034, device='cuda:3')
benign distance is  tensor(271.3034, device='cuda:3')
norm1 res is  tensor(0.2791, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.17725881934165955
distance x is tensor(238.3560, device='cuda:3')
benign distance is  tensor(238.3560, device='cuda:3')
norm1 res is  tensor(0.2535, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  2.2734835147857666
distance x is tensor(461.0594, device='cuda:3')
benign distance is  tensor(461.0594, device='cuda:3')
norm1 res is  tensor(0.5101, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.9847462773323059
distance x is tensor(269.2741, device='cuda:3')
benign distance is  tensor(269.2741, device='cuda:3')
norm1 res is  tensor(0.2717, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.20848269760608673
distance x is tensor(237.5437, device='cuda:3')
benign distance is  tensor(237.5437, device='cuda:3')
norm1 res is  tensor(0.2373, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.8808997869491577
distance x is tensor(242.6841, device='cuda:3')
benign distance is  tensor(242.6841, device='cuda:3')
norm1 res is  tensor(0.2461, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(190.1606, device='cuda:3')
compute distance is  tensor(190.1606, device='cuda:3')
compute norm is  tensor(61.4703, device='cuda:3', dtype=torch.float64)
distance x is tensor(220.0237, device='cuda:3')
compute distance is  tensor(220.0237, device='cuda:3')
compute norm is  tensor(62.1011, device='cuda:3', dtype=torch.float64)
distance x is tensor(418.5225, device='cuda:3')
compute distance is  tensor(418.5225, device='cuda:3')
compute norm is  tensor(74.2564, device='cuda:3', dtype=torch.float64)
distance x is tensor(226.3586, device='cuda:3')
compute distance is  tensor(226.3586, device='cuda:3')
compute norm is  tensor(62.2424, device='cuda:3', dtype=torch.float64)
distance x is tensor(244.8173, device='cuda:3')
compute distance is  tensor(244.8173, device='cuda:3')
compute norm is  tensor(63.2815, device='cuda:3', dtype=torch.float64)
distance x is tensor(203.2000, device='cuda:3')
compute distance is  tensor(203.2000, device='cuda:3')
compute norm is  tensor(61.8758, device='cuda:3', dtype=torch.float64)
distance x is tensor(701.0435, device='cuda:3')
compute distance is  tensor(701.0435, device='cuda:3')
compute norm is  tensor(89.8926, device='cuda:3', dtype=torch.float64)
distance x is tensor(227.3330, device='cuda:3')
compute distance is  tensor(227.3330, device='cuda:3')
compute norm is  tensor(62.2748, device='cuda:3', dtype=torch.float64)
distance x is tensor(211.6208, device='cuda:3')
compute distance is  tensor(211.6208, device='cuda:3')
compute norm is  tensor(62.1460, device='cuda:3', dtype=torch.float64)
distance x is tensor(223.5354, device='cuda:3')
compute distance is  tensor(223.5354, device='cuda:3')
compute norm is  tensor(62.5730, device='cuda:3', dtype=torch.float64)
distance x is tensor(257.4714, device='cuda:3')
compute distance is  tensor(257.4714, device='cuda:3')
compute norm is  tensor(63.1059, device='cuda:3', dtype=torch.float64)
distance x is tensor(279.6591, device='cuda:3')
compute distance is  tensor(279.6591, device='cuda:3')
compute norm is  tensor(64.2324, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(701.0435, device='cuda:3')
distance x is tensor(107568.9766, device='cuda:3')
distance x is tensor(107568.9766, device='cuda:3')
________________________________
test distance is  tensor(107568.9766, device='cuda:3')
test distance1 is  tensor(107568.9766, device='cuda:3')
test similarity is  tensor(0.4517, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130193006847296.95
test entropy is  0.0
________________________________
cal ratio is  0.07911430665834307
distance x is tensor(8510.2500, device='cuda:3')
cal_distance is  tensor(8510.2500, device='cuda:3')
cal ratio is  0.2812725798178956
distance x is tensor(2393.7036, device='cuda:3')
cal_distance is  tensor(2393.7036, device='cuda:3')
cal ratio is  0.5303509529909901
distance x is tensor(1269.5054, device='cuda:3')
cal_distance is  tensor(1269.5054, device='cuda:3')
cal ratio is  0.7282513009906676
distance x is tensor(924.5202, device='cuda:3')
cal_distance is  tensor(924.5202, device='cuda:3')
cal ratio is  0.853375836005555
distance x is tensor(788.9641, device='cuda:3')
cal_distance is  tensor(788.9641, device='cuda:3')
cal ratio is  0.9237829346005731
distance x is tensor(728.8318, device='cuda:3')
cal_distance is  tensor(728.8318, device='cuda:3')
cal ratio is  0.9611360663715702
distance x is tensor(700.5068, device='cuda:3')
cal_distance is  tensor(700.5068, device='cuda:3')
distance x is tensor(700.5068, device='cuda:3')
return_distance is  tensor(700.5068, device='cuda:3')
distance x is tensor(700.4967, device='cuda:3')
distance x is tensor(700.4967, device='cuda:3')
________________________________
test distance is  tensor(700.4967, device='cuda:3')
test distance1 is  tensor(700.4967, device='cuda:3')
test similarity is  tensor(0.8067, device='cuda:3')
test acc is  0.10000000015633198
test loss is 394871.50229877396
test entropy is  0.0
________________________________
0
distance x is tensor(700.4967, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  394421.54480943497
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8067, device='cuda:3')
compute_distance is  tensor(700.4967, device='cuda:3')
compute_norm is  tensor(93.8223, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(22167.3145, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5537451434491285
avg test loss is  2.8794136726017445
avg accuracy is  0.10046666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0329, device='cuda:3')
compute_distance is  tensor(22167.3145, device='cuda:3')
compute_norm is  tensor(1831.2878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22064.0469, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8515357551798384
avg test loss is  3.6327624437905577
avg accuracy is  0.10075000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0329, device='cuda:3')
compute_distance is  tensor(22064.0469, device='cuda:3')
compute_norm is  tensor(1822.9532, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21960.6953, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5587317256022617
avg test loss is  2.867081799995162
avg accuracy is  0.10041666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0329, device='cuda:3')
compute_distance is  tensor(21960.6953, device='cuda:3')
compute_norm is  tensor(1814.1425, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21858.2969, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8543000132925729
avg test loss is  3.615535588406805
avg accuracy is  0.10058333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0329, device='cuda:3')
compute_distance is  tensor(21858.2969, device='cuda:3')
compute_norm is  tensor(1805.9158, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21755.9004, device='cuda:3')
distance x is tensor(21755.9004, device='cuda:3')
________________________________
test distance is  tensor(21755.9004, device='cuda:3')
test distance1 is  tensor(21755.9004, device='cuda:3')
test similarity is  tensor(0.0329, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8655350874227756
test entropy is  1.5576909612745111
________________________________
cal ratio is  0.17591789628471338
distance x is tensor(3827.2488, device='cuda:3')
cal_distance is  tensor(3827.2488, device='cuda:3')
cal ratio is  0.4194258547973767
distance x is tensor(1605.2456, device='cuda:3')
cal_distance is  tensor(1605.2456, device='cuda:3')
cal ratio is  0.6476312566151998
distance x is tensor(1039.6061, device='cuda:3')
cal_distance is  tensor(1039.6061, device='cuda:3')
cal ratio is  0.8047558427695147
distance x is tensor(836.6286, device='cuda:3')
cal_distance is  tensor(836.6286, device='cuda:3')
cal ratio is  0.8970821005663188
distance x is tensor(750.5242, device='cuda:3')
cal_distance is  tensor(750.5242, device='cuda:3')
cal ratio is  0.9471443815746647
distance x is tensor(710.8547, device='cuda:3')
cal_distance is  tensor(710.8547, device='cuda:3')
cal ratio is  0.9732135258725401
distance x is tensor(691.8132, device='cuda:3')
cal_distance is  tensor(691.8132, device='cuda:3')
distance x is tensor(691.8132, device='cuda:3')
return_distance is  tensor(691.8132, device='cuda:3')
distance x is tensor(691.8192, device='cuda:3')
distance x is tensor(691.8192, device='cuda:3')
________________________________
test distance is  tensor(691.8192, device='cuda:3')
test distance1 is  tensor(691.8192, device='cuda:3')
test similarity is  tensor(0.6170, device='cuda:3')
test acc is  0.1040833334896653
test loss is 653.8307950928776
test entropy is  0.14026857402596646
________________________________
0
distance x is tensor(691.8192, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.13898184091281662
avg test loss is  653.8739235884091
avg accuracy is  0.10720000015633198
solo acc is  0.10383333348966531
compute similarity  is  tensor(0.6170, device='cuda:3')
compute_distance is  tensor(691.8192, device='cuda:3')
compute_norm is  tensor(97.6132, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2526.9573, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5244649329673507
avg test loss is  2.70505378749579
avg accuracy is  0.11890000015633193
solo acc is  0.11091666682299862
compute similarity  is  tensor(0.2556, device='cuda:3')
compute_distance is  tensor(2526.9573, device='cuda:3')
compute_norm is  tensor(182.8262, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2516.4412, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.829633283335517
avg test loss is  3.48299295688743
avg accuracy is  0.10926666682299863
solo acc is  0.10121666682299864
compute similarity  is  tensor(0.2557, device='cuda:3')
compute_distance is  tensor(2516.4412, device='cuda:3')
compute_norm is  tensor(182.2012, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2507.9705, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.451921725832323
avg test loss is  2.5068444743085263
avg accuracy is  0.12068333348966526
solo acc is  0.12495000015633191
compute similarity  is  tensor(0.2554, device='cuda:3')
compute_distance is  tensor(2507.9705, device='cuda:3')
compute_norm is  tensor(181.1934, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2497.7661, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8074128098452269
avg test loss is  3.258458501748693
avg accuracy is  0.11008333348966527
solo acc is  0.10315000015633197
compute similarity  is  tensor(0.2555, device='cuda:3')
compute_distance is  tensor(2497.7661, device='cuda:3')
compute_norm is  tensor(180.5906, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2489.5396, device='cuda:3')
distance x is tensor(2489.5396, device='cuda:3')
________________________________
test distance is  tensor(2489.5396, device='cuda:3')
test distance1 is  tensor(2489.5396, device='cuda:3')
test similarity is  tensor(0.2551, device='cuda:3')
test acc is  0.15376666682300014
test loss is 2.2839229523754323
test entropy is  1.3650160532262026
________________________________
cal ratio is  0.52004272043596
distance x is tensor(1294.6631, device='cuda:3')
cal_distance is  tensor(1294.6631, device='cuda:3')
cal ratio is  0.721140947328581
distance x is tensor(933.6338, device='cuda:3')
cal_distance is  tensor(933.6338, device='cuda:3')
cal ratio is  0.8492005348954288
distance x is tensor(792.8419, device='cuda:3')
cal_distance is  tensor(792.8419, device='cuda:3')
cal ratio is  0.9215210559460556
distance x is tensor(730.6203, device='cuda:3')
cal_distance is  tensor(730.6203, device='cuda:3')
cal ratio is  0.9599589958473973
distance x is tensor(701.3654, device='cuda:3')
cal_distance is  tensor(701.3654, device='cuda:3')
cal ratio is  0.9797750274399285
distance x is tensor(687.1802, device='cuda:3')
cal_distance is  tensor(687.1802, device='cuda:3')
distance x is tensor(687.1802, device='cuda:3')
return_distance is  tensor(687.1802, device='cuda:3')
distance x is tensor(687.1856, device='cuda:3')
distance x is tensor(687.1856, device='cuda:3')
________________________________
test distance is  tensor(687.1856, device='cuda:3')
test distance1 is  tensor(687.1856, device='cuda:3')
test similarity is  tensor(0.7272, device='cuda:3')
test acc is  0.14868333348966647
test loss is 2.453456364206668
test entropy is  1.9681272230931182
________________________________
0
distance x is tensor(687.1856, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9679024881645562
avg test loss is  2.4529857864257876
avg accuracy is  0.30058333348967287
solo acc is  0.14900000015633313
compute similarity  is  tensor(0.7272, device='cuda:3')
compute_distance is  tensor(687.1856, device='cuda:3')
compute_norm is  tensor(81.6331, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(686.4828, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8325895546341756
avg test loss is  3.3745316325474395
avg accuracy is  0.22018333348967056
solo acc is  0.10161666682299864
compute similarity  is  tensor(0.7270, device='cuda:3')
compute_distance is  tensor(686.4828, device='cuda:3')
compute_norm is  tensor(81.6029, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(687.3289, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3711023237913655
avg test loss is  2.259528178014735
avg accuracy is  0.3117166668230064
solo acc is  0.15598333348966695
compute similarity  is  tensor(0.7269, device='cuda:3')
compute_distance is  tensor(687.3289, device='cuda:3')
compute_norm is  tensor(81.0722, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(686.0707, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7661482254579377
avg test loss is  3.0774570850929472
avg accuracy is  0.2528833334896717
solo acc is  0.10345000015633196
compute similarity  is  tensor(0.7268, device='cuda:3')
compute_distance is  tensor(686.0707, device='cuda:3')
compute_norm is  tensor(80.9291, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(685.9578, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2445494555461127
avg test loss is  2.0235680916161933
avg accuracy is  0.348566666823007
solo acc is  0.18806666682300238
compute similarity  is  tensor(0.7267, device='cuda:3')
compute_distance is  tensor(685.9578, device='cuda:3')
compute_norm is  tensor(80.4238, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(684.5132, device='cuda:3')
________________________________
test distance is  tensor(684.5132, device='cuda:3')
test similarity is  tensor(0.7265, device='cuda:3')
test acc is  0.2833666668230058
test loss is 2.846318630267308
test entropy is  0.7255096345313831
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.827726125717163
mal norm is  tensor(2470.8103, device='cuda:3')
distance x is tensor(684.5132, device='cuda:3')
mal distance is  tensor(684.5132, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(41.5019, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5968, device='cuda:3')
user_param_square tensor(195.8891, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(729.1857, device='cuda:3')
score : tensor(7.2506, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1766.4543, device='cuda:3')
user_param_square tensor(270.7604, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(-164.5240, device='cuda:3')
score : tensor(-1.6865, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1121.7352, device='cuda:3')
user_param_square tensor(215.7641, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(843.7620, device='cuda:3')
score : tensor(8.3963, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1832.0829, device='cuda:3')
user_param_square tensor(275.7443, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(-323.0941, device='cuda:3')
score : tensor(-3.2722, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1075.7799, device='cuda:3')
user_param_square tensor(211.2981, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(-51.7437, device='cuda:3')
score : tensor(-0.5587, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.5448, device='cuda:3')
user_param_square tensor(188.2119, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(456.2500, device='cuda:3')
score : tensor(4.5212, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(952.3610, device='cuda:3')
user_param_square tensor(198.8084, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(389.3089, device='cuda:3')
score : tensor(3.8518, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.9601, device='cuda:3')
user_param_square tensor(195.9276, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(462.8795, device='cuda:3')
score : tensor(4.5875, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2470.8103, device='cuda:3')
user_param_square tensor(320.2238, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(631.5627, device='cuda:3')
score : tensor(6.2743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.0408, device='cuda:3')
user_param_square tensor(167.0059, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(108.2049, device='cuda:3')
score : tensor(1.0407, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.6663, device='cuda:3')
user_param_square tensor(174.6140, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(102.4368, device='cuda:3')
score : tensor(0.9831, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0582, device='cuda:3')
user_param_square tensor(169.2298, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(147.3758, device='cuda:3')
score : tensor(1.4325, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.1784, device='cuda:3')
user_param_square tensor(173.9606, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(162.1228, device='cuda:3')
score : tensor(1.5799, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8847, device='cuda:3')
user_param_square tensor(169.9427, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(181.6944, device='cuda:3')
score : tensor(1.7756, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.1869, device='cuda:3')
user_param_square tensor(163.8886, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(118.2254, device='cuda:3')
score : tensor(1.1410, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.8778, device='cuda:3')
user_param_square tensor(166.2384, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(188.2871, device='cuda:3')
score : tensor(1.8416, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.3276, device='cuda:3')
user_param_square tensor(170.8491, device='cuda:3')
global_param_square tensor(41.5019, device='cuda:3')
part1 is  tensor(65.5744, device='cuda:3')
score : tensor(0.6144, device='cuda:3')
accept
len accept list 25
len all weights is 25
 
Avg Training Stats after 51 global rounds:
Train Accuracy: 48.75% 

Test Accuracy: 49.13% 


 | Global Training Round : 52 | 

current submit client idx and staleness is  0 1
 benign loss is  1.0232566595077515
distance x is tensor(246.6185, device='cuda:3')
benign distance is  tensor(246.6185, device='cuda:3')
norm1 res is  tensor(0.2639, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.0733407735824585
distance x is tensor(218.9120, device='cuda:3')
benign distance is  tensor(218.9120, device='cuda:3')
norm1 res is  tensor(0.2412, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.6930752396583557
distance x is tensor(263.3291, device='cuda:3')
benign distance is  tensor(263.3291, device='cuda:3')
norm1 res is  tensor(0.2764, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  1.2593430280685425
distance x is tensor(234.6436, device='cuda:3')
benign distance is  tensor(234.6436, device='cuda:3')
norm1 res is  tensor(0.2604, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7500266432762146
distance x is tensor(252.1954, device='cuda:3')
benign distance is  tensor(252.1954, device='cuda:3')
norm1 res is  tensor(0.2670, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.38464754819869995
distance x is tensor(257.2445, device='cuda:3')
benign distance is  tensor(257.2445, device='cuda:3')
norm1 res is  tensor(0.2732, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2933701276779175
distance x is tensor(267.4371, device='cuda:3')
benign distance is  tensor(267.4371, device='cuda:3')
norm1 res is  tensor(0.2813, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5070277452468872
distance x is tensor(236.8275, device='cuda:3')
benign distance is  tensor(236.8275, device='cuda:3')
norm1 res is  tensor(0.2552, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.6882542371749878
distance x is tensor(230.2602, device='cuda:3')
benign distance is  tensor(230.2602, device='cuda:3')
norm1 res is  tensor(0.2543, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.7266973257064819
distance x is tensor(226.2564, device='cuda:3')
benign distance is  tensor(226.2564, device='cuda:3')
norm1 res is  tensor(0.2459, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.6946070194244385
distance x is tensor(223.3867, device='cuda:3')
benign distance is  tensor(223.3867, device='cuda:3')
norm1 res is  tensor(0.2567, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.5973637104034424
distance x is tensor(232.0318, device='cuda:3')
benign distance is  tensor(232.0318, device='cuda:3')
norm1 res is  tensor(0.2509, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.936076819896698
distance x is tensor(232.1668, device='cuda:3')
benign distance is  tensor(232.1668, device='cuda:3')
norm1 res is  tensor(0.2522, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.6109548807144165
distance x is tensor(231.8488, device='cuda:3')
benign distance is  tensor(231.8488, device='cuda:3')
norm1 res is  tensor(0.2525, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  1.059009075164795
distance x is tensor(216.3799, device='cuda:3')
benign distance is  tensor(216.3799, device='cuda:3')
norm1 res is  tensor(0.2345, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.7713302373886108
distance x is tensor(224.6514, device='cuda:3')
benign distance is  tensor(224.6514, device='cuda:3')
norm1 res is  tensor(0.2441, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(238.6079, device='cuda:3')
compute distance is  tensor(238.6079, device='cuda:3')
compute norm is  tensor(66.4568, device='cuda:3', dtype=torch.float64)
distance x is tensor(243.3898, device='cuda:3')
compute distance is  tensor(243.3898, device='cuda:3')
compute norm is  tensor(66.6019, device='cuda:3', dtype=torch.float64)
distance x is tensor(242.2963, device='cuda:3')
compute distance is  tensor(242.2963, device='cuda:3')
compute norm is  tensor(66.6069, device='cuda:3', dtype=torch.float64)
distance x is tensor(227.8296, device='cuda:3')
compute distance is  tensor(227.8296, device='cuda:3')
compute norm is  tensor(66.0209, device='cuda:3', dtype=torch.float64)
distance x is tensor(276.3670, device='cuda:3')
compute distance is  tensor(276.3670, device='cuda:3')
compute norm is  tensor(67.1485, device='cuda:3', dtype=torch.float64)
distance x is tensor(262.1544, device='cuda:3')
compute distance is  tensor(262.1544, device='cuda:3')
compute norm is  tensor(67.1449, device='cuda:3', dtype=torch.float64)
distance x is tensor(213.1010, device='cuda:3')
compute distance is  tensor(213.1010, device='cuda:3')
compute norm is  tensor(65.8615, device='cuda:3', dtype=torch.float64)
distance x is tensor(229.8663, device='cuda:3')
compute distance is  tensor(229.8663, device='cuda:3')
compute norm is  tensor(66.0740, device='cuda:3', dtype=torch.float64)
distance x is tensor(239.8067, device='cuda:3')
compute distance is  tensor(239.8067, device='cuda:3')
compute norm is  tensor(66.4473, device='cuda:3', dtype=torch.float64)
distance x is tensor(230.9445, device='cuda:3')
compute distance is  tensor(230.9445, device='cuda:3')
compute norm is  tensor(66.2020, device='cuda:3', dtype=torch.float64)
distance x is tensor(241.9163, device='cuda:3')
compute distance is  tensor(241.9163, device='cuda:3')
compute norm is  tensor(66.9498, device='cuda:3', dtype=torch.float64)
distance x is tensor(241.9890, device='cuda:3')
compute distance is  tensor(241.9890, device='cuda:3')
compute norm is  tensor(66.7521, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(276.3670, device='cuda:3')
distance x is tensor(107642.9766, device='cuda:3')
distance x is tensor(107642.9766, device='cuda:3')
________________________________
test distance is  tensor(107642.9766, device='cuda:3')
test distance1 is  tensor(107642.9766, device='cuda:3')
test similarity is  tensor(0.3727, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130028745516492.69
test entropy is  0.0
________________________________
cal ratio is  0.04965652556384923
distance x is tensor(5345.1802, device='cuda:3')
cal_distance is  tensor(5345.1802, device='cuda:3')
cal ratio is  0.22283735431241727
distance x is tensor(1191.1097, device='cuda:3')
cal_distance is  tensor(1191.1097, device='cuda:3')
cal ratio is  0.47205573985374216
distance x is tensor(562.2729, device='cuda:3')
cal_distance is  tensor(562.2729, device='cuda:3')
cal ratio is  0.6870614802771897
distance x is tensor(386.3177, device='cuda:3')
cal_distance is  tensor(386.3177, device='cuda:3')
cal ratio is  0.8288899673459018
distance x is tensor(320.2157, device='cuda:3')
cal_distance is  tensor(320.2157, device='cuda:3')
cal ratio is  0.9104327238545119
distance x is tensor(291.5353, device='cuda:3')
cal_distance is  tensor(291.5353, device='cuda:3')
cal ratio is  0.9541652257664114
distance x is tensor(278.1731, device='cuda:3')
cal_distance is  tensor(278.1731, device='cuda:3')
cal ratio is  0.9768134673734553
distance x is tensor(271.7233, device='cuda:3')
cal_distance is  tensor(271.7233, device='cuda:3')
distance x is tensor(271.7233, device='cuda:3')
return_distance is  tensor(271.7233, device='cuda:3')
distance x is tensor(271.7132, device='cuda:3')
distance x is tensor(271.7132, device='cuda:3')
________________________________
test distance is  tensor(271.7132, device='cuda:3')
test distance1 is  tensor(271.7132, device='cuda:3')
test similarity is  tensor(0.9341, device='cuda:3')
test acc is  0.10070000015633197
test loss is 1580.796541193655
test entropy is  0.0017680728381170637
________________________________
0
distance x is tensor(271.7132, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0017308154411967147
avg test loss is  1583.4693796121235
avg accuracy is  0.20805000015633668
solo acc is  0.10136666682299865
compute similarity  is  tensor(0.9341, device='cuda:3')
compute_distance is  tensor(271.7132, device='cuda:3')
compute_norm is  tensor(72.6233, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(10221.7129, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5470340353593643
avg test loss is  2.8806008720702962
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1474, device='cuda:3')
compute_distance is  tensor(10221.7129, device='cuda:3')
compute_norm is  tensor(896.0268, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(10174.1865, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8413655283227404
avg test loss is  3.6320933428908715
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1474, device='cuda:3')
compute_distance is  tensor(10174.1865, device='cuda:3')
compute_norm is  tensor(892.0499, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(10126.4980, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.556422358001473
avg test loss is  2.8677606801234328
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1474, device='cuda:3')
compute_distance is  tensor(10126.4980, device='cuda:3')
compute_norm is  tensor(887.6152, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(10079.4775, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8459841396762873
avg test loss is  3.6175138792757795
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1474, device='cuda:3')
compute_distance is  tensor(10079.4775, device='cuda:3')
compute_norm is  tensor(883.7002, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(10032.3164, device='cuda:3')
distance x is tensor(10032.3164, device='cuda:3')
________________________________
test distance is  tensor(10032.3164, device='cuda:3')
test distance1 is  tensor(10032.3164, device='cuda:3')
test similarity is  tensor(0.1474, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.860980068442664
test entropy is  1.5604529412570538
________________________________
cal ratio is  0.16265542764391686
distance x is tensor(1631.8087, device='cuda:3')
cal_distance is  tensor(1631.8087, device='cuda:3')
cal ratio is  0.4033058774789535
distance x is tensor(658.1171, device='cuda:3')
cal_distance is  tensor(658.1171, device='cuda:3')
cal ratio is  0.6350641079140734
distance x is tensor(417.9460, device='cuda:3')
cal_distance is  tensor(417.9460, device='cuda:3')
cal ratio is  0.7969095909389984
distance x is tensor(333.0649, device='cuda:3')
cal_distance is  tensor(333.0649, device='cuda:3')
cal ratio is  0.892698344368765
distance x is tensor(297.3263, device='cuda:3')
cal_distance is  tensor(297.3263, device='cuda:3')
cal ratio is  0.9448274657137965
distance x is tensor(280.9220, device='cuda:3')
cal_distance is  tensor(280.9220, device='cuda:3')
cal ratio is  0.9720225180506737
distance x is tensor(273.0625, device='cuda:3')
cal_distance is  tensor(273.0625, device='cuda:3')
distance x is tensor(273.0625, device='cuda:3')
return_distance is  tensor(273.0625, device='cuda:3')
distance x is tensor(273.0656, device='cuda:3')
distance x is tensor(273.0656, device='cuda:3')
________________________________
test distance is  tensor(273.0656, device='cuda:3')
test distance1 is  tensor(273.0656, device='cuda:3')
test similarity is  tensor(0.8657, device='cuda:3')
test acc is  0.08881666682299869
test loss is 3.0785895097992824
test entropy is  1.7968443971452936
________________________________
0
distance x is tensor(273.0656, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7976812166191622
avg test loss is  3.073615200229799
avg accuracy is  0.07310000015633208
solo acc is  0.08921666682299868
compute similarity  is  tensor(0.8657, device='cuda:3')
compute_distance is  tensor(273.0656, device='cuda:3')
compute_norm is  tensor(77.0530, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(274.6303, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7997159624277655
avg test loss is  3.2965793408818844
avg accuracy is  0.08186666682299873
solo acc is  0.10185000015633197
compute similarity  is  tensor(0.8658, device='cuda:3')
compute_distance is  tensor(274.6303, device='cuda:3')
compute_norm is  tensor(76.9430, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(277.0416, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.2868052457949755
avg test loss is  2.2820660447769328
avg accuracy is  0.09000000015633201
solo acc is  0.13266666682299857
compute similarity  is  tensor(0.8655, device='cuda:3')
compute_distance is  tensor(277.0416, device='cuda:3')
compute_norm is  tensor(76.4127, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(277.2220, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7708382007918124
avg test loss is  2.979958071891687
avg accuracy is  0.08981666682299869
solo acc is  0.1017333334896653
compute similarity  is  tensor(0.8655, device='cuda:3')
compute_distance is  tensor(277.2220, device='cuda:3')
compute_norm is  tensor(76.2348, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(278.5345, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3178735688042793
avg test loss is  2.229841587894253
avg accuracy is  0.09236666682299867
solo acc is  0.12021666682299859
compute similarity  is  tensor(0.8652, device='cuda:3')
compute_distance is  tensor(278.5345, device='cuda:3')
compute_norm is  tensor(75.7442, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(278.8051, device='cuda:3')
distance x is tensor(278.8051, device='cuda:3')
________________________________
test distance is  tensor(278.8051, device='cuda:3')
test distance1 is  tensor(278.8051, device='cuda:3')
test similarity is  tensor(0.8652, device='cuda:3')
test acc is  0.10100000015633197
test loss is 2.8988673097289195
test entropy is  0.7576249024507079
________________________________
cal ratio is  0.9757056507423362
distance x is tensor(272.0273, device='cuda:3')
cal_distance is  tensor(272.0273, device='cuda:3')
distance x is tensor(272.0273, device='cuda:3')
return_distance is  tensor(272.0273, device='cuda:3')
distance x is tensor(272.0317, device='cuda:3')
distance x is tensor(272.0317, device='cuda:3')
________________________________
test distance is  tensor(272.0317, device='cuda:3')
test distance1 is  tensor(272.0317, device='cuda:3')
test similarity is  tensor(0.8703, device='cuda:3')
test acc is  0.10120000015633197
test loss is 2.872157907689304
test entropy is  0.7764542089469397
________________________________
0
distance x is tensor(272.0317, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7768781837751108
avg test loss is  2.8722805524431565
avg accuracy is  0.09610000015633197
solo acc is  0.1008833334896653
compute similarity  is  tensor(0.8703, device='cuda:3')
compute_distance is  tensor(272.0317, device='cuda:3')
compute_norm is  tensor(75.1712, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(273.3407, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2370828739615645
avg test loss is  2.1411474123438285
avg accuracy is  0.09823333348966531
solo acc is  0.12666666682299857
compute similarity  is  tensor(0.8700, device='cuda:3')
compute_distance is  tensor(273.3407, device='cuda:3')
compute_norm is  tensor(74.6965, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(273.7512, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7403060199736532
avg test loss is  2.8459020108302266
avg accuracy is  0.10070000015633197
solo acc is  0.10101666682299863
compute similarity  is  tensor(0.8699, device='cuda:3')
compute_distance is  tensor(273.7512, device='cuda:3')
compute_norm is  tensor(74.5113, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(275.0896, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2156753869199042
avg test loss is  2.112208381390521
avg accuracy is  0.10200000015633197
solo acc is  0.12568333348966523
compute similarity  is  tensor(0.8697, device='cuda:3')
compute_distance is  tensor(275.0896, device='cuda:3')
compute_norm is  tensor(74.0537, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(275.6009, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7241469859949815
avg test loss is  2.8125000393975266
avg accuracy is  0.10808333348966528
solo acc is  0.10071666682299864
compute similarity  is  tensor(0.8696, device='cuda:3')
compute_distance is  tensor(275.6009, device='cuda:3')
compute_norm is  tensor(73.8527, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(277.8458, device='cuda:3')
________________________________
test distance is  tensor(277.8458, device='cuda:3')
test similarity is  tensor(0.8693, device='cuda:3')
test acc is  0.10418333348966528
test loss is 1.8364382001128532
test entropy is  1.0929441197848777
________________________________
final entropy
distance x is tensor(277.8502, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0924554446231582
avg test loss is  1.8401108192228306
avg accuracy is  0.10416666682299862
solo acc is  0.18015000015633528
compute similarity  is  tensor(0.8693, device='cuda:3')
compute_distance is  tensor(277.8502, device='cuda:3')
compute_norm is  tensor(73.4187, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.0511868000030518
mal norm is  tensor(1643.9819, device='cuda:3')
distance x is tensor(278.7524, device='cuda:3')
mal distance is  tensor(278.7524, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(90.2968, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1045.9694, device='cuda:3')
user_param_square tensor(307.3234, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(1880.2791, device='cuda:3')
score : tensor(18.7127, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(956.6328, device='cuda:3')
user_param_square tensor(293.9062, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(2873.8123, device='cuda:3')
score : tensor(28.6480, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1097.6527, device='cuda:3')
user_param_square tensor(314.8246, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(2901.4614, device='cuda:3')
score : tensor(28.9245, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1029.3314, device='cuda:3')
user_param_square tensor(304.8694, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(6180.9468, device='cuda:3')
score : tensor(61.7194, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1053.9343, device='cuda:3')
user_param_square tensor(308.4913, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(3254.7617, device='cuda:3')
score : tensor(32.4575, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1083.1471, device='cuda:3')
user_param_square tensor(312.7375, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(6116.9492, device='cuda:3')
score : tensor(61.0794, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1117.7506, device='cuda:3')
user_param_square tensor(317.6937, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(3801.2471, device='cuda:3')
score : tensor(37.9224, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1012.7786, device='cuda:3')
user_param_square tensor(302.4081, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(8157.4238, device='cuda:3')
score : tensor(81.4841, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1643.9819, device='cuda:3')
user_param_square tensor(385.2873, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-597.5782, device='cuda:3')
score : tensor(-6.0659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1110.9159, device='cuda:3')
user_param_square tensor(316.7209, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(149.0531, device='cuda:3')
score : tensor(1.4004, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1093.8590, device='cuda:3')
user_param_square tensor(314.2801, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(266.5839, device='cuda:3')
score : tensor(2.5757, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1145.3821, device='cuda:3')
user_param_square tensor(321.5966, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(198.3039, device='cuda:3')
score : tensor(1.8929, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1112.3433, device='cuda:3')
user_param_square tensor(316.9243, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(22.7976, device='cuda:3')
score : tensor(0.1379, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1099.3112, device='cuda:3')
user_param_square tensor(315.0623, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(175.5748, device='cuda:3')
score : tensor(1.6657, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1110.0563, device='cuda:3')
user_param_square tensor(316.5984, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(-4.3244, device='cuda:3')
score : tensor(-0.1333, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1118.7362, device='cuda:3')
user_param_square tensor(317.8337, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(220.3024, device='cuda:3')
score : tensor(2.1129, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1108.9622, device='cuda:3')
user_param_square tensor(316.4423, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(136.0168, device='cuda:3')
score : tensor(1.2701, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1226.6638, device='cuda:3')
user_param_square tensor(332.8120, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(548.5065, device='cuda:3')
score : tensor(5.3950, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1215.8538, device='cuda:3')
user_param_square tensor(331.3423, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(380.1677, device='cuda:3')
score : tensor(3.7116, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1350.2698, device='cuda:3')
user_param_square tensor(349.1777, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(126.4851, device='cuda:3')
score : tensor(1.1748, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(3222.3271, device='cuda:3')
user_param_square tensor(539.4125, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(378.7746, device='cuda:3')
score : tensor(3.6976, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1337.8116, device='cuda:3')
user_param_square tensor(347.5631, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(559.1901, device='cuda:3')
score : tensor(5.5018, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1938.9738, device='cuda:3')
user_param_square tensor(418.4294, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(413.0731, device='cuda:3')
score : tensor(4.0406, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1211.9550, device='cuda:3')
user_param_square tensor(330.8106, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(130.8167, device='cuda:3')
score : tensor(1.2181, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1225.6144, device='cuda:3')
user_param_square tensor(332.6696, device='cuda:3')
global_param_square tensor(90.2968, device='cuda:3')
part1 is  tensor(842.5854, device='cuda:3')
score : tensor(8.3358, device='cuda:3')
accept
len accept list 23
len all weights is 23
 
Avg Training Stats after 52 global rounds:
Train Accuracy: 85.01% 

Test Accuracy: 84.17% 


 | Global Training Round : 53 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8116976618766785
distance x is tensor(154.4326, device='cuda:3')
benign distance is  tensor(154.4326, device='cuda:3')
norm1 res is  tensor(0.1664, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.6898773312568665
distance x is tensor(162.9096, device='cuda:3')
benign distance is  tensor(162.9096, device='cuda:3')
norm1 res is  tensor(0.1806, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.1686534881591797
distance x is tensor(154.8530, device='cuda:3')
benign distance is  tensor(154.8530, device='cuda:3')
norm1 res is  tensor(0.1617, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.34192901849746704
distance x is tensor(148.2669, device='cuda:3')
benign distance is  tensor(148.2669, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.2653697729110718
distance x is tensor(140.5068, device='cuda:3')
benign distance is  tensor(140.5068, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5571259260177612
distance x is tensor(166.3982, device='cuda:3')
benign distance is  tensor(166.3982, device='cuda:3')
norm1 res is  tensor(0.1747, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.1862371265888214
distance x is tensor(152.5612, device='cuda:3')
benign distance is  tensor(152.5612, device='cuda:3')
norm1 res is  tensor(0.1642, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  1.0955710411071777
distance x is tensor(167.7386, device='cuda:3')
benign distance is  tensor(167.7386, device='cuda:3')
norm1 res is  tensor(0.1749, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.754665732383728
distance x is tensor(154.0225, device='cuda:3')
benign distance is  tensor(154.0225, device='cuda:3')
norm1 res is  tensor(0.1641, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3158970773220062
distance x is tensor(146.7657, device='cuda:3')
benign distance is  tensor(146.7657, device='cuda:3')
norm1 res is  tensor(0.1569, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.7991517782211304
distance x is tensor(159.1784, device='cuda:3')
benign distance is  tensor(159.1784, device='cuda:3')
norm1 res is  tensor(0.1662, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6465483903884888
distance x is tensor(144.1474, device='cuda:3')
benign distance is  tensor(144.1474, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.42886704206466675
distance x is tensor(140.5999, device='cuda:3')
benign distance is  tensor(140.5999, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.5954052805900574
distance x is tensor(147.4922, device='cuda:3')
benign distance is  tensor(147.4922, device='cuda:3')
norm1 res is  tensor(0.1567, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4369727671146393
distance x is tensor(136.1727, device='cuda:3')
benign distance is  tensor(136.1727, device='cuda:3')
norm1 res is  tensor(0.1499, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4342319369316101
distance x is tensor(149.8506, device='cuda:3')
benign distance is  tensor(149.8506, device='cuda:3')
norm1 res is  tensor(0.1630, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.4016769826412201
distance x is tensor(150.2517, device='cuda:3')
benign distance is  tensor(150.2517, device='cuda:3')
norm1 res is  tensor(0.1591, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.3338502049446106
distance x is tensor(136.1132, device='cuda:3')
benign distance is  tensor(136.1132, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.36715230345726013
distance x is tensor(161.9201, device='cuda:3')
benign distance is  tensor(161.9201, device='cuda:3')
norm1 res is  tensor(0.1745, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.662952721118927
distance x is tensor(151.7929, device='cuda:3')
benign distance is  tensor(151.7929, device='cuda:3')
norm1 res is  tensor(0.1601, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.24290890991687775
distance x is tensor(152.7241, device='cuda:3')
benign distance is  tensor(152.7241, device='cuda:3')
norm1 res is  tensor(0.1628, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.27441778779029846
distance x is tensor(152.4238, device='cuda:3')
benign distance is  tensor(152.4238, device='cuda:3')
norm1 res is  tensor(0.1653, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.15455502271652222
distance x is tensor(159.9506, device='cuda:3')
benign distance is  tensor(159.9506, device='cuda:3')
norm1 res is  tensor(0.1722, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.4012524485588074
distance x is tensor(142.2195, device='cuda:3')
benign distance is  tensor(142.2195, device='cuda:3')
norm1 res is  tensor(0.1522, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(142.8985, device='cuda:3')
compute distance is  tensor(142.8985, device='cuda:3')
compute norm is  tensor(62.2309, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4833, device='cuda:3')
compute distance is  tensor(137.4833, device='cuda:3')
compute norm is  tensor(62.1192, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.8173, device='cuda:3')
compute distance is  tensor(144.8173, device='cuda:3')
compute norm is  tensor(62.2697, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.7099, device='cuda:3')
compute distance is  tensor(165.7099, device='cuda:3')
compute norm is  tensor(62.7251, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.9972, device='cuda:3')
compute distance is  tensor(153.9972, device='cuda:3')
compute norm is  tensor(62.4818, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.7436, device='cuda:3')
compute distance is  tensor(149.7436, device='cuda:3')
compute norm is  tensor(62.2921, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.2822, device='cuda:3')
compute distance is  tensor(143.2822, device='cuda:3')
compute norm is  tensor(62.1947, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.3583, device='cuda:3')
compute distance is  tensor(150.3583, device='cuda:3')
compute norm is  tensor(62.5152, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.4294, device='cuda:3')
compute distance is  tensor(153.4294, device='cuda:3')
compute norm is  tensor(62.4526, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.9716, device='cuda:3')
compute distance is  tensor(155.9716, device='cuda:3')
compute norm is  tensor(62.4156, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.2554, device='cuda:3')
compute distance is  tensor(143.2554, device='cuda:3')
compute norm is  tensor(62.3387, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4616, device='cuda:3')
compute distance is  tensor(145.4616, device='cuda:3')
compute norm is  tensor(62.2759, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(165.7099, device='cuda:3')
distance x is tensor(107623.6875, device='cuda:3')
distance x is tensor(107623.6875, device='cuda:3')
________________________________
test distance is  tensor(107623.6875, device='cuda:3')
test distance1 is  tensor(107623.6875, device='cuda:3')
test similarity is  tensor(0.3907, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130036364000197.05
test entropy is  0.0
________________________________
cal ratio is  0.03845442535440773
distance x is tensor(4138.6128, device='cuda:3')
cal_distance is  tensor(4138.6128, device='cuda:3')
cal ratio is  0.19609786916107128
distance x is tensor(811.5773, device='cuda:3')
cal_distance is  tensor(811.5773, device='cuda:3')
cal ratio is  0.4428282557318002
distance x is tensor(359.3922, device='cuda:3')
cal_distance is  tensor(359.3922, device='cuda:3')
cal ratio is  0.6654507780637613
distance x is tensor(239.1595, device='cuda:3')
cal_distance is  tensor(239.1595, device='cuda:3')
cal ratio is  0.815748766121032
distance x is tensor(195.0950, device='cuda:3')
cal_distance is  tensor(195.0950, device='cuda:3')
cal ratio is  0.9031859464705277
distance x is tensor(176.2076, device='cuda:3')
cal_distance is  tensor(176.2076, device='cuda:3')
cal ratio is  0.9503595286345162
distance x is tensor(167.4608, device='cuda:3')
cal_distance is  tensor(167.4608, device='cuda:3')
cal ratio is  0.9748631135998759
distance x is tensor(163.2515, device='cuda:3')
cal_distance is  tensor(163.2515, device='cuda:3')
distance x is tensor(163.2515, device='cuda:3')
return_distance is  tensor(163.2515, device='cuda:3')
distance x is tensor(163.2413, device='cuda:3')
distance x is tensor(163.2413, device='cuda:3')
________________________________
test distance is  tensor(163.2413, device='cuda:3')
test distance1 is  tensor(163.2413, device='cuda:3')
test similarity is  tensor(0.9706, device='cuda:3')
test acc is  0.1777333334896684
test loss is 124.51959514821262
test entropy is  0.039764465829198646
________________________________
0
distance x is tensor(163.2413, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.039878638370011224
avg test loss is  124.60215586843267
avg accuracy is  0.779116666822993
solo acc is  0.17975000015633527
compute similarity  is  tensor(0.9706, device='cuda:3')
compute_distance is  tensor(163.2413, device='cuda:3')
compute_norm is  tensor(65.5363, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.5543, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0245171634118948
avg test loss is  1.4581472817768675
avg accuracy is  0.5763500001563396
solo acc is  0.2973833334896727
compute similarity  is  tensor(0.9704, device='cuda:3')
compute_distance is  tensor(168.5543, device='cuda:3')
compute_norm is  tensor(65.6297, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.8442, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6337481383194548
avg test loss is  2.3315421327599077
avg accuracy is  0.4677166668230085
solo acc is  0.11745000015633193
compute similarity  is  tensor(0.9701, device='cuda:3')
compute_distance is  tensor(169.8442, device='cuda:3')
compute_norm is  tensor(65.3636, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.8069, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.926947988808028
avg test loss is  1.3766118026237244
avg accuracy is  0.5790666668230059
solo acc is  0.28435000015633916
compute similarity  is  tensor(0.9700, device='cuda:3')
compute_distance is  tensor(170.8069, device='cuda:3')
compute_norm is  tensor(65.0238, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(170.8069, device='cuda:3')
distance x is tensor(170.8069, device='cuda:3')
________________________________
test distance is  tensor(170.8069, device='cuda:3')
test distance1 is  tensor(170.8069, device='cuda:3')
test similarity is  tensor(0.9700, device='cuda:3')
test acc is  0.28270000015633917
test loss is 1.3765553649046274
test entropy is  0.9258843507212616
________________________________
cal ratio is  0.9652673123281007
distance x is tensor(164.8839, device='cuda:3')
cal_distance is  tensor(164.8839, device='cuda:3')
distance x is tensor(164.8839, device='cuda:3')
return_distance is  tensor(164.8839, device='cuda:3')
distance x is tensor(164.8741, device='cuda:3')
distance x is tensor(164.8741, device='cuda:3')
________________________________
test distance is  tensor(164.8741, device='cuda:3')
test distance1 is  tensor(164.8741, device='cuda:3')
test similarity is  tensor(0.9718, device='cuda:3')
test acc is  0.30588333348967295
test loss is 1.3249778961703214
test entropy is  1.0136850553153673
________________________________
0
distance x is tensor(164.8741, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0132379048287488
avg test loss is  1.326036268841229
avg accuracy is  0.6019833334896707
solo acc is  0.3003000001563395
compute similarity  is  tensor(0.9718, device='cuda:3')
compute_distance is  tensor(164.8741, device='cuda:3')
compute_norm is  tensor(64.8264, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.1045, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.5918985317066026
avg test loss is  2.21567463544386
avg accuracy is  0.5142166668230088
solo acc is  0.11150000015633194
compute similarity  is  tensor(0.9714, device='cuda:3')
compute_distance is  tensor(166.1045, device='cuda:3')
compute_norm is  tensor(64.5522, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(166.8754, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9027444583012351
avg test loss is  1.3066948145818609
avg accuracy is  0.6205333334896692
solo acc is  0.29425000015633934
compute similarity  is  tensor(0.9713, device='cuda:3')
compute_distance is  tensor(166.8754, device='cuda:3')
compute_norm is  tensor(64.2139, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(166.8754, device='cuda:3')
distance x is tensor(166.8754, device='cuda:3')
________________________________
test distance is  tensor(166.8754, device='cuda:3')
test distance1 is  tensor(166.8754, device='cuda:3')
test similarity is  tensor(0.9713, device='cuda:3')
test acc is  0.29233333348967266
test loss is 1.3129137005887306
test entropy is  0.9029197931162584
________________________________
cal ratio is  0.9765715531074511
distance x is tensor(162.9755, device='cuda:3')
cal_distance is  tensor(162.9755, device='cuda:3')
distance x is tensor(162.9755, device='cuda:3')
return_distance is  tensor(162.9755, device='cuda:3')
distance x is tensor(162.9657, device='cuda:3')
distance x is tensor(162.9657, device='cuda:3')
________________________________
test distance is  tensor(162.9657, device='cuda:3')
test distance1 is  tensor(162.9657, device='cuda:3')
test similarity is  tensor(0.9725, device='cuda:3')
test acc is  0.3167666668230066
test loss is 1.2662385805710545
test entropy is  0.9585801810979335
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2915215492248535
mal norm is  tensor(754.9585, device='cuda:3')
distance x is tensor(162.9755, device='cuda:3')
mal distance is  tensor(162.9755, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(20.4626, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.4886, device='cuda:3')
user_param_square tensor(115.6377, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(125.2854, device='cuda:3')
score : tensor(1.2326, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.4327, device='cuda:3')
user_param_square tensor(120.2308, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(86.0012, device='cuda:3')
score : tensor(0.8397, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.2875, device='cuda:3')
user_param_square tensor(114.1953, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(151.7753, device='cuda:3')
score : tensor(1.4975, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.2245, device='cuda:3')
user_param_square tensor(110.7325, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(118.0977, device='cuda:3')
score : tensor(1.1607, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.2162, device='cuda:3')
user_param_square tensor(109.8970, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(159.9996, device='cuda:3')
score : tensor(1.5797, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.6291, device='cuda:3')
user_param_square tensor(118.8784, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(80.8113, device='cuda:3')
score : tensor(0.7878, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.0830, device='cuda:3')
user_param_square tensor(114.3560, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(145.8344, device='cuda:3')
score : tensor(1.4381, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.0482, device='cuda:3')
user_param_square tensor(118.9144, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(0.9205, device='cuda:3')
score : tensor(-0.0111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.9585, device='cuda:3')
user_param_square tensor(124.2917, device='cuda:3')
global_param_square tensor(20.4626, device='cuda:3')
part1 is  tensor(-34.0283, device='cuda:3')
score : tensor(-0.3605, device='cuda:3')
len accept list 7
len all weights is 7
 
Avg Training Stats after 53 global rounds:
Train Accuracy: 88.28% 

Test Accuracy: 87.62% 


 | Global Training Round : 54 | 

current submit client idx and staleness is  0 1
 benign loss is  0.599916934967041
distance x is tensor(120.5416, device='cuda:3')
benign distance is  tensor(120.5416, device='cuda:3')
norm1 res is  tensor(0.1356, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.0707619190216064
distance x is tensor(117.2872, device='cuda:3')
benign distance is  tensor(117.2872, device='cuda:3')
norm1 res is  tensor(0.1329, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.5003954172134399
distance x is tensor(110.9312, device='cuda:3')
benign distance is  tensor(110.9312, device='cuda:3')
norm1 res is  tensor(0.1225, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.9076207876205444
distance x is tensor(119.2667, device='cuda:3')
benign distance is  tensor(119.2667, device='cuda:3')
norm1 res is  tensor(0.1376, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  1.2294763326644897
distance x is tensor(107.6644, device='cuda:3')
benign distance is  tensor(107.6644, device='cuda:3')
norm1 res is  tensor(0.1227, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6408535242080688
distance x is tensor(123.7744, device='cuda:3')
benign distance is  tensor(123.7744, device='cuda:3')
norm1 res is  tensor(0.1416, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.44018688797950745
distance x is tensor(115.3060, device='cuda:3')
benign distance is  tensor(115.3060, device='cuda:3')
norm1 res is  tensor(0.1234, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.4461640417575836
distance x is tensor(122.7856, device='cuda:3')
benign distance is  tensor(122.7856, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(127.6522, device='cuda:3')
compute distance is  tensor(127.6522, device='cuda:3')
compute norm is  tensor(62.4883, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.8876, device='cuda:3')
compute distance is  tensor(118.8876, device='cuda:3')
compute norm is  tensor(62.5068, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9310, device='cuda:3')
compute distance is  tensor(135.9310, device='cuda:3')
compute norm is  tensor(62.8228, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.5076, device='cuda:3')
compute distance is  tensor(131.5076, device='cuda:3')
compute norm is  tensor(62.6772, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9459, device='cuda:3')
compute distance is  tensor(131.9459, device='cuda:3')
compute norm is  tensor(62.6319, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4444, device='cuda:3')
compute distance is  tensor(134.4444, device='cuda:3')
compute norm is  tensor(62.8463, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8509, device='cuda:3')
compute distance is  tensor(124.8509, device='cuda:3')
compute norm is  tensor(62.5793, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.3689, device='cuda:3')
compute distance is  tensor(122.3689, device='cuda:3')
compute norm is  tensor(62.7233, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7235, device='cuda:3')
compute distance is  tensor(133.7235, device='cuda:3')
compute norm is  tensor(62.6907, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1197, device='cuda:3')
compute distance is  tensor(129.1197, device='cuda:3')
compute norm is  tensor(62.7478, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0081, device='cuda:3')
compute distance is  tensor(127.0081, device='cuda:3')
compute norm is  tensor(62.5864, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.9516, device='cuda:3')
compute distance is  tensor(117.9516, device='cuda:3')
compute norm is  tensor(62.5424, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(135.9310, device='cuda:3')
distance x is tensor(107620.6484, device='cuda:3')
distance x is tensor(107620.6484, device='cuda:3')
________________________________
test distance is  tensor(107620.6484, device='cuda:3')
test distance1 is  tensor(107620.6484, device='cuda:3')
test similarity is  tensor(0.3815, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130040517130261.83
test entropy is  0.0
________________________________
cal ratio is  0.03482872132607579
distance x is tensor(3748.2949, device='cuda:3')
cal_distance is  tensor(3748.2949, device='cuda:3')
cal ratio is  0.18662441035526944
distance x is tensor(699.5275, device='cuda:3')
cal_distance is  tensor(699.5275, device='cuda:3')
cal ratio is  0.4319991948754371
distance x is tensor(302.1982, device='cuda:3')
cal_distance is  tensor(302.1982, device='cuda:3')
cal ratio is  0.657263268099601
distance x is tensor(198.6255, device='cuda:3')
cal_distance is  tensor(198.6255, device='cuda:3')
cal ratio is  0.8107141797018852
distance x is tensor(161.0295, device='cuda:3')
cal_distance is  tensor(161.0295, device='cuda:3')
cal ratio is  0.9003939702896564
distance x is tensor(144.9906, device='cuda:3')
cal_distance is  tensor(144.9906, device='cuda:3')
cal ratio is  0.9488891244238333
distance x is tensor(137.5802, device='cuda:3')
cal_distance is  tensor(137.5802, device='cuda:3')
cal ratio is  0.9741084999528568
distance x is tensor(134.0182, device='cuda:3')
cal_distance is  tensor(134.0182, device='cuda:3')
distance x is tensor(134.0182, device='cuda:3')
return_distance is  tensor(134.0182, device='cuda:3')
distance x is tensor(134.0080, device='cuda:3')
distance x is tensor(134.0080, device='cuda:3')
________________________________
test distance is  tensor(134.0080, device='cuda:3')
test distance1 is  tensor(134.0080, device='cuda:3')
test similarity is  tensor(0.9792, device='cuda:3')
test acc is  0.5586333334896745
test loss is 6.603752372361449
test entropy is  0.09749640987268579
________________________________
0
distance x is tensor(134.0080, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.09784207987124478
avg test loss is  6.659901202868805
avg accuracy is  0.8792500001563222
solo acc is  0.557116666823008
compute similarity  is  tensor(0.9792, device='cuda:3')
compute_distance is  tensor(134.0080, device='cuda:3')
compute_norm is  tensor(65.1968, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.4654, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9008964000226084
avg test loss is  1.3229367565879944
avg accuracy is  0.8602500001563228
solo acc is  0.3478000001563405
compute similarity  is  tensor(0.9779, device='cuda:3')
compute_distance is  tensor(137.4654, device='cuda:3')
compute_norm is  tensor(64.4453, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.1369, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.865516368196463
avg test loss is  1.3980729371499914
avg accuracy is  0.8593666668229897
solo acc is  0.2811666668230058
compute similarity  is  tensor(0.9775, device='cuda:3')
compute_distance is  tensor(139.1369, device='cuda:3')
compute_norm is  tensor(64.1024, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.4429, device='cuda:3')
exit early
distance x is tensor(140.4429, device='cuda:3')
distance x is tensor(140.4429, device='cuda:3')
________________________________
test distance is  tensor(140.4429, device='cuda:3')
test distance1 is  tensor(140.4429, device='cuda:3')
test similarity is  tensor(0.9772, device='cuda:3')
test acc is  0.26571666682300543
test loss is 1.3926280233016146
test entropy is  0.8493464985000554
________________________________
cal ratio is  0.9641296935692414
distance x is tensor(135.4136, device='cuda:3')
cal_distance is  tensor(135.4136, device='cuda:3')
distance x is tensor(135.4136, device='cuda:3')
return_distance is  tensor(135.4136, device='cuda:3')
distance x is tensor(135.4050, device='cuda:3')
distance x is tensor(135.4050, device='cuda:3')
________________________________
test distance is  tensor(135.4050, device='cuda:3')
test distance1 is  tensor(135.4050, device='cuda:3')
test similarity is  tensor(0.9787, device='cuda:3')
test acc is  0.3464000001563404
test loss is 1.2395543851959172
test entropy is  0.9140623053635107
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2326390743255615
mal norm is  tensor(652.4561, device='cuda:3')
distance x is tensor(135.4136, device='cuda:3')
mal distance is  tensor(135.4136, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(22.0994, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.7527, device='cuda:3')
user_param_square tensor(108.6076, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-22.8570, device='cuda:3')
score : tensor(-0.2505, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(525.0764, device='cuda:3')
user_param_square tensor(107.7213, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-44.9984, device='cuda:3')
score : tensor(-0.4719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(475.0796, device='cuda:3')
user_param_square tensor(102.4645, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(51.1201, device='cuda:3')
score : tensor(0.4893, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.6758, device='cuda:3')
user_param_square tensor(108.1920, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(1.4537, device='cuda:3')
score : tensor(-0.0074, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(473.9811, device='cuda:3')
user_param_square tensor(102.3460, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-80.6082, device='cuda:3')
score : tensor(-0.8280, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.5586, device='cuda:3')
user_param_square tensor(109.8022, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-18.2673, device='cuda:3')
score : tensor(-0.2046, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(487.1464, device='cuda:3')
user_param_square tensor(103.7576, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(13.4710, device='cuda:3')
score : tensor(0.1128, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.5456, device='cuda:3')
user_param_square tensor(108.8914, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-6.2734, device='cuda:3')
score : tensor(-0.0846, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4561, device='cuda:3')
user_param_square tensor(120.0787, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-45.3985, device='cuda:3')
score : tensor(-0.4759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.9807, device='cuda:3')
user_param_square tensor(132.2127, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(6.0884, device='cuda:3')
score : tensor(0.0390, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.2108, device='cuda:3')
user_param_square tensor(130.9725, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-37.0042, device='cuda:3')
score : tensor(-0.3919, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.7328, device='cuda:3')
user_param_square tensor(129.4042, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-13.5956, device='cuda:3')
score : tensor(-0.1579, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.1129, device='cuda:3')
user_param_square tensor(130.4570, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-10.6529, device='cuda:3')
score : tensor(-0.1284, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(775.2727, device='cuda:3')
user_param_square tensor(130.8933, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(22.6617, device='cuda:3')
score : tensor(0.2047, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(797.0689, device='cuda:3')
user_param_square tensor(132.7205, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-41.0901, device='cuda:3')
score : tensor(-0.4328, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(791.7361, device='cuda:3')
user_param_square tensor(132.2758, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-50.0450, device='cuda:3')
score : tensor(-0.5223, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.6577, device='cuda:3')
user_param_square tensor(132.1857, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(30.9932, device='cuda:3')
score : tensor(0.2880, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1087.6859, device='cuda:3')
user_param_square tensor(155.0394, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-11.1002, device='cuda:3')
score : tensor(-0.1329, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1045.6653, device='cuda:3')
user_param_square tensor(152.0150, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(20.2733, device='cuda:3')
score : tensor(0.1808, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1086.8832, device='cuda:3')
user_param_square tensor(154.9821, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-12.1625, device='cuda:3')
score : tensor(-0.1435, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1068.7021, device='cuda:3')
user_param_square tensor(153.6804, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(24.1339, device='cuda:3')
score : tensor(0.2194, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1060.3867, device='cuda:3')
user_param_square tensor(153.0814, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(17.8824, device='cuda:3')
score : tensor(0.1569, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1072.7388, device='cuda:3')
user_param_square tensor(153.9704, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(1.4896, device='cuda:3')
score : tensor(-0.0070, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1023.4663, device='cuda:3')
user_param_square tensor(150.3928, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-22.2969, device='cuda:3')
score : tensor(-0.2449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1056.4934, device='cuda:3')
user_param_square tensor(152.8001, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-11.5363, device='cuda:3')
score : tensor(-0.1373, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.4985, device='cuda:3')
user_param_square tensor(119.8984, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(15.1017, device='cuda:3')
score : tensor(0.1291, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.5553, device='cuda:3')
user_param_square tensor(117.5772, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-3.8259, device='cuda:3')
score : tensor(-0.0602, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.5080, device='cuda:3')
user_param_square tensor(120.5427, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-49.5322, device='cuda:3')
score : tensor(-0.5172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.8229, device='cuda:3')
user_param_square tensor(116.4694, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-48.9038, device='cuda:3')
score : tensor(-0.5109, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.7539, device='cuda:3')
user_param_square tensor(114.2598, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-16.4194, device='cuda:3')
score : tensor(-0.1861, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9675, device='cuda:3')
user_param_square tensor(116.4831, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-17.9029, device='cuda:3')
score : tensor(-0.2009, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4071, device='cuda:3')
user_param_square tensor(114.8052, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-32.7269, device='cuda:3')
score : tensor(-0.3492, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.1925, device='cuda:3')
user_param_square tensor(118.5726, device='cuda:3')
global_param_square tensor(22.0994, device='cuda:3')
part1 is  tensor(-52.3941, device='cuda:3')
score : tensor(-0.5458, device='cuda:3')
len accept list 9
len all weights is 9
 
Avg Training Stats after 54 global rounds:
Train Accuracy: 88.26% 

Test Accuracy: 87.15% 


 | Global Training Round : 55 | 

current submit client idx and staleness is  0 1
 benign loss is  1.0711003541946411
distance x is tensor(131.7870, device='cuda:3')
benign distance is  tensor(131.7870, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8694620132446289
distance x is tensor(136.7805, device='cuda:3')
benign distance is  tensor(136.7805, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2384777069091797
distance x is tensor(132.2558, device='cuda:3')
benign distance is  tensor(132.2558, device='cuda:3')
norm1 res is  tensor(0.1406, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5383576154708862
distance x is tensor(134.0758, device='cuda:3')
benign distance is  tensor(134.0758, device='cuda:3')
norm1 res is  tensor(0.1414, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6414753794670105
distance x is tensor(130.4125, device='cuda:3')
benign distance is  tensor(130.4125, device='cuda:3')
norm1 res is  tensor(0.1441, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8566181063652039
distance x is tensor(144.7436, device='cuda:3')
benign distance is  tensor(144.7436, device='cuda:3')
norm1 res is  tensor(0.1568, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.057873308658599854
distance x is tensor(133.8604, device='cuda:3')
benign distance is  tensor(133.8604, device='cuda:3')
norm1 res is  tensor(0.1390, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.22602395713329315
distance x is tensor(127.8731, device='cuda:3')
benign distance is  tensor(127.8731, device='cuda:3')
norm1 res is  tensor(0.1418, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.2613787055015564
distance x is tensor(144.8631, device='cuda:3')
benign distance is  tensor(144.8631, device='cuda:3')
norm1 res is  tensor(0.1593, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.2964833676815033
distance x is tensor(136.1161, device='cuda:3')
benign distance is  tensor(136.1161, device='cuda:3')
norm1 res is  tensor(0.1496, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.41050800681114197
distance x is tensor(128.3768, device='cuda:3')
benign distance is  tensor(128.3768, device='cuda:3')
norm1 res is  tensor(0.1398, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6370724439620972
distance x is tensor(142.6923, device='cuda:3')
benign distance is  tensor(142.6923, device='cuda:3')
norm1 res is  tensor(0.1563, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.21077576279640198
distance x is tensor(122.6183, device='cuda:3')
benign distance is  tensor(122.6183, device='cuda:3')
norm1 res is  tensor(0.1378, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.21379265189170837
distance x is tensor(136.0025, device='cuda:3')
benign distance is  tensor(136.0025, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.6126707792282104
distance x is tensor(132.6816, device='cuda:3')
benign distance is  tensor(132.6816, device='cuda:3')
norm1 res is  tensor(0.1475, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.7851936221122742
distance x is tensor(132.6317, device='cuda:3')
benign distance is  tensor(132.6317, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.37887805700302124
distance x is tensor(120.0203, device='cuda:3')
benign distance is  tensor(120.0203, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.6091347932815552
distance x is tensor(137.5378, device='cuda:3')
benign distance is  tensor(137.5378, device='cuda:3')
norm1 res is  tensor(0.1545, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.5879620313644409
distance x is tensor(131.3877, device='cuda:3')
benign distance is  tensor(131.3877, device='cuda:3')
norm1 res is  tensor(0.1453, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.33008381724357605
distance x is tensor(138.8584, device='cuda:3')
benign distance is  tensor(138.8584, device='cuda:3')
norm1 res is  tensor(0.1541, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.33473119139671326
distance x is tensor(139.6202, device='cuda:3')
benign distance is  tensor(139.6202, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  1.0538827180862427
distance x is tensor(125.3851, device='cuda:3')
benign distance is  tensor(125.3851, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.329336017370224
distance x is tensor(131.9197, device='cuda:3')
benign distance is  tensor(131.9197, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.4951757490634918
distance x is tensor(135.9561, device='cuda:3')
benign distance is  tensor(135.9561, device='cuda:3')
norm1 res is  tensor(0.1508, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.21613983809947968
distance x is tensor(144.8557, device='cuda:3')
benign distance is  tensor(144.8557, device='cuda:3')
norm1 res is  tensor(0.1568, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.35240498185157776
distance x is tensor(124.5482, device='cuda:3')
benign distance is  tensor(124.5482, device='cuda:3')
norm1 res is  tensor(0.1373, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.32010799646377563
distance x is tensor(124.2447, device='cuda:3')
benign distance is  tensor(124.2447, device='cuda:3')
norm1 res is  tensor(0.1406, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.1766950935125351
distance x is tensor(151.4829, device='cuda:3')
benign distance is  tensor(151.4829, device='cuda:3')
norm1 res is  tensor(0.1673, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.13147661089897156
distance x is tensor(128.8544, device='cuda:3')
benign distance is  tensor(128.8544, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.519368588924408
distance x is tensor(137.3175, device='cuda:3')
benign distance is  tensor(137.3175, device='cuda:3')
norm1 res is  tensor(0.1470, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.6358011960983276
distance x is tensor(133.5384, device='cuda:3')
benign distance is  tensor(133.5384, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.3842153251171112
distance x is tensor(136.2711, device='cuda:3')
benign distance is  tensor(136.2711, device='cuda:3')
norm1 res is  tensor(0.1518, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(122.6364, device='cuda:3')
compute distance is  tensor(122.6364, device='cuda:3')
compute norm is  tensor(61.9144, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.8129, device='cuda:3')
compute distance is  tensor(126.8129, device='cuda:3')
compute norm is  tensor(61.9775, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2267, device='cuda:3')
compute distance is  tensor(132.2267, device='cuda:3')
compute norm is  tensor(62.1486, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4169, device='cuda:3')
compute distance is  tensor(134.4169, device='cuda:3')
compute norm is  tensor(62.0084, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.8587, device='cuda:3')
compute distance is  tensor(138.8587, device='cuda:3')
compute norm is  tensor(62.1515, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5636, device='cuda:3')
compute distance is  tensor(137.5636, device='cuda:3')
compute norm is  tensor(62.2323, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2721, device='cuda:3')
compute distance is  tensor(133.2721, device='cuda:3')
compute norm is  tensor(62.1137, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7706, device='cuda:3')
compute distance is  tensor(125.7706, device='cuda:3')
compute norm is  tensor(62.0330, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.8991, device='cuda:3')
compute distance is  tensor(151.8991, device='cuda:3')
compute norm is  tensor(62.4134, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1031, device='cuda:3')
compute distance is  tensor(136.1031, device='cuda:3')
compute norm is  tensor(62.2243, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5054, device='cuda:3')
compute distance is  tensor(144.5054, device='cuda:3')
compute norm is  tensor(62.3784, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.2363, device='cuda:3')
compute distance is  tensor(137.2363, device='cuda:3')
compute norm is  tensor(62.1104, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.8991, device='cuda:3')
distance x is tensor(107616.4453, device='cuda:3')
distance x is tensor(107616.4453, device='cuda:3')
________________________________
test distance is  tensor(107616.4453, device='cuda:3')
test distance1 is  tensor(107616.4453, device='cuda:3')
test similarity is  tensor(0.3903, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130048329571461.19
test entropy is  0.0
________________________________
cal ratio is  0.03681834831035772
distance x is tensor(3962.2651, device='cuda:3')
cal_distance is  tensor(3962.2651, device='cuda:3')
cal ratio is  0.19188095260218221
distance x is tensor(760.2874, device='cuda:3')
cal_distance is  tensor(760.2874, device='cuda:3')
cal ratio is  0.43804095332111403
distance x is tensor(333.0399, device='cuda:3')
cal_distance is  tensor(333.0399, device='cuda:3')
cal ratio is  0.6618437857917622
distance x is tensor(220.4221, device='cuda:3')
cal_distance is  tensor(220.4221, device='cuda:3')
cal ratio is  0.8135345804505825
distance x is tensor(179.3220, device='cuda:3')
cal_distance is  tensor(179.3220, device='cuda:3')
cal ratio is  0.9019591459037812
distance x is tensor(161.7416, device='cuda:3')
cal_distance is  tensor(161.7416, device='cuda:3')
cal ratio is  0.9497138077160231
distance x is tensor(153.6085, device='cuda:3')
cal_distance is  tensor(153.6085, device='cuda:3')
cal ratio is  0.9745317864550346
distance x is tensor(149.6965, device='cuda:3')
cal_distance is  tensor(149.6965, device='cuda:3')
distance x is tensor(149.6965, device='cuda:3')
return_distance is  tensor(149.6965, device='cuda:3')
distance x is tensor(149.6863, device='cuda:3')
distance x is tensor(149.6863, device='cuda:3')
________________________________
test distance is  tensor(149.6863, device='cuda:3')
test distance1 is  tensor(149.6863, device='cuda:3')
test similarity is  tensor(0.9746, device='cuda:3')
test acc is  0.2575166668230051
test loss is 46.49867346749377
test entropy is  0.051223639258817
________________________________
0
distance x is tensor(149.6863, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.05101061411259541
avg test loss is  46.55094459468622
avg accuracy is  0.8660833334896559
solo acc is  0.2575666668230051
compute similarity  is  tensor(0.9746, device='cuda:3')
compute_distance is  tensor(149.6863, device='cuda:3')
compute_norm is  tensor(65.1279, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.4273, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.913956158959281
avg test loss is  1.3365806296690186
avg accuracy is  0.8351333334896571
solo acc is  0.3316833334896735
compute similarity  is  tensor(0.9742, device='cuda:3')
compute_distance is  tensor(152.4273, device='cuda:3')
compute_norm is  tensor(64.6724, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(153.5813, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8661464468629629
avg test loss is  1.419678169781211
avg accuracy is  0.8328166668229906
solo acc is  0.26655000015633873
compute similarity  is  tensor(0.9739, device='cuda:3')
compute_distance is  tensor(153.5813, device='cuda:3')
compute_norm is  tensor(64.3372, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(154.4508, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8679956183123436
avg test loss is  1.3896887021532445
avg accuracy is  0.8322833334896573
solo acc is  0.25758333348967183
compute similarity  is  tensor(0.9736, device='cuda:3')
compute_distance is  tensor(154.4508, device='cuda:3')
compute_norm is  tensor(64.0098, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(155.2292, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8485695371495635
avg test loss is  1.3765129326248982
avg accuracy is  0.8362000001563238
solo acc is  0.2551166668230051
compute similarity  is  tensor(0.9734, device='cuda:3')
compute_distance is  tensor(155.2292, device='cuda:3')
compute_norm is  tensor(63.6899, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(156.0009, device='cuda:3')
distance x is tensor(156.0009, device='cuda:3')
________________________________
test distance is  tensor(156.0009, device='cuda:3')
test distance1 is  tensor(156.0009, device='cuda:3')
test similarity is  tensor(0.9732, device='cuda:3')
test acc is  0.24566666682300486
test loss is 1.3641542566102196
test entropy is  0.8468657407298017
________________________________
cal ratio is  0.9670303843856934
distance x is tensor(150.8665, device='cuda:3')
cal_distance is  tensor(150.8665, device='cuda:3')
distance x is tensor(150.8665, device='cuda:3')
return_distance is  tensor(150.8665, device='cuda:3')
distance x is tensor(150.8574, device='cuda:3')
distance x is tensor(150.8574, device='cuda:3')
________________________________
test distance is  tensor(150.8574, device='cuda:3')
test distance1 is  tensor(150.8574, device='cuda:3')
test similarity is  tensor(0.9748, device='cuda:3')
test acc is  0.31915000015633993
test loss is 1.2365667572153656
test entropy is  0.9148693523173139
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 0.928684413433075
mal norm is  tensor(709.1505, device='cuda:3')
distance x is tensor(150.8665, device='cuda:3')
mal distance is  tensor(150.8665, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(15.3197, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.2368, device='cuda:3')
user_param_square tensor(93.6295, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(12.8648, device='cuda:3')
score : tensor(0.1135, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.1298, device='cuda:3')
user_param_square tensor(94.4354, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-24.0449, device='cuda:3')
score : tensor(-0.2556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.3839, device='cuda:3')
user_param_square tensor(92.2405, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(43.6503, device='cuda:3')
score : tensor(0.4214, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.1159, device='cuda:3')
user_param_square tensor(92.7978, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-11.0050, device='cuda:3')
score : tensor(-0.1252, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.0511, device='cuda:3')
user_param_square tensor(93.5325, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-32.1149, device='cuda:3')
score : tensor(-0.3363, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.7258, device='cuda:3')
user_param_square tensor(97.3585, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-4.4926, device='cuda:3')
score : tensor(-0.0600, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.7260, device='cuda:3')
user_param_square tensor(90.7623, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(23.7135, device='cuda:3')
score : tensor(0.2220, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.7350, device='cuda:3')
user_param_square tensor(92.6838, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-7.6054, device='cuda:3')
score : tensor(-0.0912, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1505, device='cuda:3')
user_param_square tensor(104.2303, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-3.4472, device='cuda:3')
score : tensor(-0.0496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1208.4429, device='cuda:3')
user_param_square tensor(136.0624, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(23.2081, device='cuda:3')
score : tensor(0.2170, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1688.4603, device='cuda:3')
user_param_square tensor(160.8312, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(40.2836, device='cuda:3')
score : tensor(0.3877, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1142.8456, device='cuda:3')
user_param_square tensor(132.3179, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(2.1175, device='cuda:3')
score : tensor(0.0061, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0336, device='cuda:3')
user_param_square tensor(126.0438, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(32.4924, device='cuda:3')
score : tensor(0.3098, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2036.5145, device='cuda:3')
user_param_square tensor(176.6317, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-96.1499, device='cuda:3')
score : tensor(-0.9766, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1108.9648, device='cuda:3')
user_param_square tensor(130.3418, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(-37.6216, device='cuda:3')
score : tensor(-0.3913, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(989.4656, device='cuda:3')
user_param_square tensor(123.1191, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(11.8605, device='cuda:3')
score : tensor(0.1035, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1017.7970, device='cuda:3')
user_param_square tensor(124.8693, device='cuda:3')
global_param_square tensor(15.3197, device='cuda:3')
part1 is  tensor(5.7799, device='cuda:3')
score : tensor(0.0427, device='cuda:3')
accept
len accept list 9
len all weights is 9
 
Avg Training Stats after 55 global rounds:
Train Accuracy: 88.10% 

Test Accuracy: 87.51% 


 | Global Training Round : 56 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5110596418380737
distance x is tensor(342.5116, device='cuda:3')
benign distance is  tensor(342.5116, device='cuda:3')
norm1 res is  tensor(0.3388, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.24128270149230957
distance x is tensor(124.4795, device='cuda:3')
benign distance is  tensor(124.4795, device='cuda:3')
norm1 res is  tensor(0.1354, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.34738075733184814
distance x is tensor(106.2782, device='cuda:3')
benign distance is  tensor(106.2782, device='cuda:3')
norm1 res is  tensor(0.1171, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6253024935722351
distance x is tensor(128.2160, device='cuda:3')
benign distance is  tensor(128.2160, device='cuda:3')
norm1 res is  tensor(0.1375, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.34640276432037354
distance x is tensor(110.8073, device='cuda:3')
benign distance is  tensor(110.8073, device='cuda:3')
norm1 res is  tensor(0.1199, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5835639834403992
distance x is tensor(129.1377, device='cuda:3')
benign distance is  tensor(129.1377, device='cuda:3')
norm1 res is  tensor(0.1407, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.16681024432182312
distance x is tensor(100.8727, device='cuda:3')
benign distance is  tensor(100.8727, device='cuda:3')
norm1 res is  tensor(0.1096, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.4105956554412842
distance x is tensor(130.6612, device='cuda:3')
benign distance is  tensor(130.6612, device='cuda:3')
norm1 res is  tensor(0.1420, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.3002351224422455
distance x is tensor(117.3868, device='cuda:3')
benign distance is  tensor(117.3868, device='cuda:3')
norm1 res is  tensor(0.1310, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.07727057486772537
distance x is tensor(129.6156, device='cuda:3')
benign distance is  tensor(129.6156, device='cuda:3')
norm1 res is  tensor(0.1441, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.4682895541191101
distance x is tensor(119.2407, device='cuda:3')
benign distance is  tensor(119.2407, device='cuda:3')
norm1 res is  tensor(0.1334, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.04702571779489517
distance x is tensor(109.8257, device='cuda:3')
benign distance is  tensor(109.8257, device='cuda:3')
norm1 res is  tensor(0.1233, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.7133493423461914
distance x is tensor(122.5784, device='cuda:3')
benign distance is  tensor(122.5784, device='cuda:3')
norm1 res is  tensor(0.1353, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.46135765314102173
distance x is tensor(111.1053, device='cuda:3')
benign distance is  tensor(111.1053, device='cuda:3')
norm1 res is  tensor(0.1207, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.38926979899406433
distance x is tensor(121.6109, device='cuda:3')
benign distance is  tensor(121.6109, device='cuda:3')
norm1 res is  tensor(0.1320, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.14452406764030457
distance x is tensor(107.7469, device='cuda:3')
benign distance is  tensor(107.7469, device='cuda:3')
norm1 res is  tensor(0.1164, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(124.2346, device='cuda:3')
compute distance is  tensor(124.2346, device='cuda:3')
compute norm is  tensor(62.0448, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.6399, device='cuda:3')
compute distance is  tensor(121.6399, device='cuda:3')
compute norm is  tensor(61.9339, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5271, device='cuda:3')
compute distance is  tensor(125.5271, device='cuda:3')
compute norm is  tensor(62.1411, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7701, device='cuda:3')
compute distance is  tensor(120.7701, device='cuda:3')
compute norm is  tensor(61.9458, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6400, device='cuda:3')
compute distance is  tensor(133.6400, device='cuda:3')
compute norm is  tensor(62.2797, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.9311, device='cuda:3')
compute distance is  tensor(121.9311, device='cuda:3')
compute norm is  tensor(62.0803, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.2488, device='cuda:3')
compute distance is  tensor(117.2488, device='cuda:3')
compute norm is  tensor(61.9493, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.1877, device='cuda:3')
compute distance is  tensor(115.1877, device='cuda:3')
compute norm is  tensor(62.0098, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3228, device='cuda:3')
compute distance is  tensor(125.3228, device='cuda:3')
compute norm is  tensor(62.0681, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1374, device='cuda:3')
compute distance is  tensor(129.1374, device='cuda:3')
compute norm is  tensor(62.2048, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3726, device='cuda:3')
compute distance is  tensor(126.3726, device='cuda:3')
compute norm is  tensor(62.2279, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.3020, device='cuda:3')
compute distance is  tensor(112.3020, device='cuda:3')
compute norm is  tensor(61.9468, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(133.6400, device='cuda:3')
distance x is tensor(107615.2656, device='cuda:3')
distance x is tensor(107615.2656, device='cuda:3')
________________________________
test distance is  tensor(107615.2656, device='cuda:3')
test distance1 is  tensor(107615.2656, device='cuda:3')
test similarity is  tensor(0.3889, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130065287276679.38
test entropy is  0.0
________________________________
cal ratio is  0.03453483488631064
distance x is tensor(3716.4810, device='cuda:3')
cal_distance is  tensor(3716.4810, device='cuda:3')
cal ratio is  0.18583537191682675
distance x is tensor(690.6578, device='cuda:3')
cal_distance is  tensor(690.6578, device='cuda:3')
cal ratio is  0.43108495058299195
distance x is tensor(297.7351, device='cuda:3')
cal_distance is  tensor(297.7351, device='cuda:3')
cal ratio is  0.656567381341828
distance x is tensor(195.4849, device='cuda:3')
cal_distance is  tensor(195.4849, device='cuda:3')
cal ratio is  0.8102847942024823
distance x is tensor(158.3994, device='cuda:3')
cal_distance is  tensor(158.3994, device='cuda:3')
cal ratio is  0.9001554297701875
distance x is tensor(142.5847, device='cuda:3')
cal_distance is  tensor(142.5847, device='cuda:3')
cal ratio is  0.9487634233296619
distance x is tensor(135.2793, device='cuda:3')
cal_distance is  tensor(135.2793, device='cuda:3')
cal ratio is  0.9740440316969026
distance x is tensor(131.7682, device='cuda:3')
cal_distance is  tensor(131.7682, device='cuda:3')
distance x is tensor(131.7682, device='cuda:3')
return_distance is  tensor(131.7682, device='cuda:3')
distance x is tensor(131.7579, device='cuda:3')
distance x is tensor(131.7579, device='cuda:3')
________________________________
test distance is  tensor(131.7579, device='cuda:3')
test distance1 is  tensor(131.7579, device='cuda:3')
test similarity is  tensor(0.9800, device='cuda:3')
test acc is  0.42750000015634143
test loss is 12.843247651037123
test entropy is  0.11708696764796528
________________________________
0
distance x is tensor(131.7579, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.11708944338931838
avg test loss is  12.855489635772543
avg accuracy is  0.8783166668229888
solo acc is  0.4292500001563414
compute similarity  is  tensor(0.9800, device='cuda:3')
compute_distance is  tensor(131.7579, device='cuda:3')
compute_norm is  tensor(64.6396, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(135.7527, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.925019791321968
avg test loss is  1.3761725467659518
avg accuracy is  0.8625166668229894
solo acc is  0.33301666682300685
compute similarity  is  tensor(0.9785, device='cuda:3')
compute_distance is  tensor(135.7527, device='cuda:3')
compute_norm is  tensor(63.9001, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.4002, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8817880165729441
avg test loss is  1.4279254116991689
avg accuracy is  0.8624833334896561
solo acc is  0.27840000015633903
compute similarity  is  tensor(0.9781, device='cuda:3')
compute_distance is  tensor(137.4002, device='cuda:3')
compute_norm is  tensor(63.5576, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.6914, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8706146467214962
avg test loss is  1.3988036008786038
avg accuracy is  0.863183333489656
solo acc is  0.2723166668230056
compute similarity  is  tensor(0.9778, device='cuda:3')
compute_distance is  tensor(138.6914, device='cuda:3')
compute_norm is  tensor(63.2296, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.9416, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8537426236341757
avg test loss is  1.3880968817642756
avg accuracy is  0.864533333489656
solo acc is  0.2625166668230053
compute similarity  is  tensor(0.9775, device='cuda:3')
compute_distance is  tensor(139.9416, device='cuda:3')
compute_norm is  tensor(62.9070, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(141.0113, device='cuda:3')
distance x is tensor(141.0113, device='cuda:3')
________________________________
test distance is  tensor(141.0113, device='cuda:3')
test distance1 is  tensor(141.0113, device='cuda:3')
test similarity is  tensor(0.9772, device='cuda:3')
test acc is  0.26406666682300534
test loss is 1.3578705443248058
test entropy is  0.8466451218895821
________________________________
cal ratio is  0.9540417198819446
distance x is tensor(134.5393, device='cuda:3')
cal_distance is  tensor(134.5393, device='cuda:3')
cal ratio is  0.976719346254515
distance x is tensor(131.4072, device='cuda:3')
cal_distance is  tensor(131.4072, device='cuda:3')
distance x is tensor(131.4072, device='cuda:3')
return_distance is  tensor(131.4072, device='cuda:3')
distance x is tensor(131.3984, device='cuda:3')
distance x is tensor(131.3984, device='cuda:3')
________________________________
test distance is  tensor(131.3984, device='cuda:3')
test distance1 is  tensor(131.3984, device='cuda:3')
test similarity is  tensor(0.9800, device='cuda:3')
test acc is  0.4408333334896749
test loss is 1.089439664250498
test entropy is  0.9222738908043803
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.0071890354156494
mal norm is  tensor(616.4683, device='cuda:3')
distance x is tensor(131.4072, device='cuda:3')
mal distance is  tensor(131.4072, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(9.7887, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1345.2482, device='cuda:3')
user_param_square tensor(114.7527, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-23.4019, device='cuda:3')
score : tensor(-0.2436, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.0971, device='cuda:3')
user_param_square tensor(72.2379, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(1.8354, device='cuda:3')
score : tensor(0.0088, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(453.1635, device='cuda:3')
user_param_square tensor(66.6023, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(26.2845, device='cuda:3')
score : tensor(0.2533, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.9484, device='cuda:3')
user_param_square tensor(72.8351, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(10.7724, device='cuda:3')
score : tensor(0.0981, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(473.2676, device='cuda:3')
user_param_square tensor(68.0636, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(24.5603, device='cuda:3')
score : tensor(0.2360, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.1211, device='cuda:3')
user_param_square tensor(73.5821, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(19.0700, device='cuda:3')
score : tensor(0.1811, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(424.7874, device='cuda:3')
user_param_square tensor(64.4834, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(34.6908, device='cuda:3')
score : tensor(0.3373, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.6158, device='cuda:3')
user_param_square tensor(73.7478, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(11.6626, device='cuda:3')
score : tensor(0.1070, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4683, device='cuda:3')
user_param_square tensor(77.6814, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-24.7321, device='cuda:3')
score : tensor(-0.2569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(707.1311, device='cuda:3')
user_param_square tensor(83.1978, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-1.1663, device='cuda:3')
score : tensor(-0.0213, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.8254, device='cuda:3')
user_param_square tensor(80.9734, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(4.2431, device='cuda:3')
score : tensor(0.0328, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.4200, device='cuda:3')
user_param_square tensor(86.1054, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(3.5589, device='cuda:3')
score : tensor(0.0260, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.8140, device='cuda:3')
user_param_square tensor(83.5900, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-5.6795, device='cuda:3')
score : tensor(-0.0664, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5543, device='cuda:3')
user_param_square tensor(83.9837, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(11.2809, device='cuda:3')
score : tensor(0.1032, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.3162, device='cuda:3')
user_param_square tensor(84.7242, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-26.0630, device='cuda:3')
score : tensor(-0.2702, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.0014, device='cuda:3')
user_param_square tensor(85.9108, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-3.2226, device='cuda:3')
score : tensor(-0.0418, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.0952, device='cuda:3')
user_param_square tensor(81.8314, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(7.5931, device='cuda:3')
score : tensor(0.0663, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.6562, device='cuda:3')
user_param_square tensor(84.1643, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(4.4819, device='cuda:3')
score : tensor(0.0352, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.5069, device='cuda:3')
user_param_square tensor(81.9755, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(14.0284, device='cuda:3')
score : tensor(0.1307, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.0036, device='cuda:3')
user_param_square tensor(80.1337, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-7.5016, device='cuda:3')
score : tensor(-0.0846, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.7440, device='cuda:3')
user_param_square tensor(83.0572, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(17.6692, device='cuda:3')
score : tensor(0.1671, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.1511, device='cuda:3')
user_param_square tensor(79.7754, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(9.3321, device='cuda:3')
score : tensor(0.0837, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.6810, device='cuda:3')
user_param_square tensor(81.5670, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(10.0092, device='cuda:3')
score : tensor(0.0905, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.1805, device='cuda:3')
user_param_square tensor(81.5969, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(6.0696, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.1015, device='cuda:3')
user_param_square tensor(81.8318, device='cuda:3')
global_param_square tensor(9.7887, device='cuda:3')
part1 is  tensor(-5.0266, device='cuda:3')
score : tensor(-0.0599, device='cuda:3')
len accept list 17
len all weights is 17
 
Avg Training Stats after 56 global rounds:
Train Accuracy: 89.41% 

Test Accuracy: 88.47% 


 | Global Training Round : 57 | 

current submit client idx and staleness is  0 1
 benign loss is  0.40878939628601074
distance x is tensor(123.1003, device='cuda:3')
benign distance is  tensor(123.1003, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.578091025352478
distance x is tensor(130.3364, device='cuda:3')
benign distance is  tensor(130.3364, device='cuda:3')
norm1 res is  tensor(0.1451, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2280922681093216
distance x is tensor(92.1277, device='cuda:3')
benign distance is  tensor(92.1277, device='cuda:3')
norm1 res is  tensor(0.1014, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6323903799057007
distance x is tensor(114.1579, device='cuda:3')
benign distance is  tensor(114.1579, device='cuda:3')
norm1 res is  tensor(0.1265, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.36394602060317993
distance x is tensor(94.5828, device='cuda:3')
benign distance is  tensor(94.5828, device='cuda:3')
norm1 res is  tensor(0.1067, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.23082944750785828
distance x is tensor(132.0754, device='cuda:3')
benign distance is  tensor(132.0754, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.7634435892105103
distance x is tensor(106.6508, device='cuda:3')
benign distance is  tensor(106.6508, device='cuda:3')
norm1 res is  tensor(0.1176, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.25518327951431274
distance x is tensor(125.7487, device='cuda:3')
benign distance is  tensor(125.7487, device='cuda:3')
norm1 res is  tensor(0.1418, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.4648546278476715
distance x is tensor(129.8548, device='cuda:3')
benign distance is  tensor(129.8548, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.38441354036331177
distance x is tensor(121.7837, device='cuda:3')
benign distance is  tensor(121.7837, device='cuda:3')
norm1 res is  tensor(0.1340, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.3364706039428711
distance x is tensor(121.1432, device='cuda:3')
benign distance is  tensor(121.1432, device='cuda:3')
norm1 res is  tensor(0.1340, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.2266114056110382
distance x is tensor(115.5917, device='cuda:3')
benign distance is  tensor(115.5917, device='cuda:3')
norm1 res is  tensor(0.1287, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.6639017462730408
distance x is tensor(112.3632, device='cuda:3')
benign distance is  tensor(112.3632, device='cuda:3')
norm1 res is  tensor(0.1290, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.9779993295669556
distance x is tensor(117.8717, device='cuda:3')
benign distance is  tensor(117.8717, device='cuda:3')
norm1 res is  tensor(0.1314, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.6429460644721985
distance x is tensor(112.6731, device='cuda:3')
benign distance is  tensor(112.6731, device='cuda:3')
norm1 res is  tensor(0.1286, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.8347373008728027
distance x is tensor(117.7761, device='cuda:3')
benign distance is  tensor(117.7761, device='cuda:3')
norm1 res is  tensor(0.1317, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.12839071452617645
distance x is tensor(125.9219, device='cuda:3')
benign distance is  tensor(125.9219, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.6095262765884399
distance x is tensor(109.8760, device='cuda:3')
benign distance is  tensor(109.8760, device='cuda:3')
norm1 res is  tensor(0.1235, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.36067596077919006
distance x is tensor(122.7667, device='cuda:3')
benign distance is  tensor(122.7667, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.2498151957988739
distance x is tensor(125.6922, device='cuda:3')
benign distance is  tensor(125.6922, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.7480471134185791
distance x is tensor(114.6503, device='cuda:3')
benign distance is  tensor(114.6503, device='cuda:3')
norm1 res is  tensor(0.1280, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.18662522733211517
distance x is tensor(123.2182, device='cuda:3')
benign distance is  tensor(123.2182, device='cuda:3')
norm1 res is  tensor(0.1362, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.5141187906265259
distance x is tensor(118.3155, device='cuda:3')
benign distance is  tensor(118.3155, device='cuda:3')
norm1 res is  tensor(0.1337, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.4992784857749939
distance x is tensor(119.1645, device='cuda:3')
benign distance is  tensor(119.1645, device='cuda:3')
norm1 res is  tensor(0.1324, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(115.0746, device='cuda:3')
compute distance is  tensor(115.0746, device='cuda:3')
compute norm is  tensor(62.1512, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.9776, device='cuda:3')
compute distance is  tensor(107.9776, device='cuda:3')
compute norm is  tensor(62.0303, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7146, device='cuda:3')
compute distance is  tensor(126.7146, device='cuda:3')
compute norm is  tensor(62.4150, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.2966, device='cuda:3')
compute distance is  tensor(113.2966, device='cuda:3')
compute norm is  tensor(62.0620, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.6892, device='cuda:3')
compute distance is  tensor(120.6892, device='cuda:3')
compute norm is  tensor(62.2830, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.2780, device='cuda:3')
compute distance is  tensor(131.2780, device='cuda:3')
compute norm is  tensor(62.5299, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.6821, device='cuda:3')
compute distance is  tensor(118.6821, device='cuda:3')
compute norm is  tensor(62.2323, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.1311, device='cuda:3')
compute distance is  tensor(119.1311, device='cuda:3')
compute norm is  tensor(62.3120, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2723, device='cuda:3')
compute distance is  tensor(129.2723, device='cuda:3')
compute norm is  tensor(62.3409, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0461, device='cuda:3')
compute distance is  tensor(118.0461, device='cuda:3')
compute norm is  tensor(62.2029, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9958, device='cuda:3')
compute distance is  tensor(130.9958, device='cuda:3')
compute norm is  tensor(62.4653, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.3541, device='cuda:3')
compute distance is  tensor(111.3541, device='cuda:3')
compute norm is  tensor(62.1919, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(131.2780, device='cuda:3')
distance x is tensor(107614.2656, device='cuda:3')
distance x is tensor(107614.2656, device='cuda:3')
________________________________
test distance is  tensor(107614.2656, device='cuda:3')
test distance1 is  tensor(107614.2656, device='cuda:3')
test similarity is  tensor(0.3851, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130051330385810.83
test entropy is  0.0
________________________________
cal ratio is  0.03422843699575472
distance x is tensor(3683.4736, device='cuda:3')
cal_distance is  tensor(3683.4736, device='cuda:3')
cal ratio is  0.18500915899753664
distance x is tensor(681.4805, device='cuda:3')
cal_distance is  tensor(681.4805, device='cuda:3')
cal ratio is  0.43012559517550675
distance x is tensor(293.1251, device='cuda:3')
cal_distance is  tensor(293.1251, device='cuda:3')
cal ratio is  0.655836388899129
distance x is tensor(192.2439, device='cuda:3')
cal_distance is  tensor(192.2439, device='cuda:3')
cal ratio is  0.8098334805755445
distance x is tensor(155.6865, device='cuda:3')
cal_distance is  tensor(155.6865, device='cuda:3')
cal ratio is  0.8999045808860553
distance x is tensor(140.1035, device='cuda:3')
cal_distance is  tensor(140.1035, device='cuda:3')
cal ratio is  0.9486313091263807
distance x is tensor(132.9069, device='cuda:3')
cal_distance is  tensor(132.9069, device='cuda:3')
cal ratio is  0.9739760327503997
distance x is tensor(129.4483, device='cuda:3')
cal_distance is  tensor(129.4483, device='cuda:3')
distance x is tensor(129.4483, device='cuda:3')
return_distance is  tensor(129.4483, device='cuda:3')
distance x is tensor(129.4380, device='cuda:3')
distance x is tensor(129.4380, device='cuda:3')
________________________________
test distance is  tensor(129.4380, device='cuda:3')
test distance1 is  tensor(129.4380, device='cuda:3')
test similarity is  tensor(0.9805, device='cuda:3')
test acc is  0.4335000001563415
test loss is 14.00353703264997
test entropy is  0.08445637148799005
________________________________
0
distance x is tensor(129.4380, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.08437453345584273
avg test loss is  14.068651670586071
avg accuracy is  0.8879000001563218
solo acc is  0.43366666682300814
compute similarity  is  tensor(0.9805, device='cuda:3')
compute_distance is  tensor(129.4380, device='cuda:3')
compute_norm is  tensor(64.8075, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(133.7995, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.910784182581566
avg test loss is  1.3302027168177337
avg accuracy is  0.8734000001563224
solo acc is  0.343416666823007
compute similarity  is  tensor(0.9789, device='cuda:3')
compute_distance is  tensor(133.7995, device='cuda:3')
compute_norm is  tensor(64.0173, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.5768, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8516769333561854
avg test loss is  1.4369274972598436
avg accuracy is  0.874016666822989
solo acc is  0.26993333348967213
compute similarity  is  tensor(0.9785, device='cuda:3')
compute_distance is  tensor(135.5768, device='cuda:3')
compute_norm is  tensor(63.6702, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.8231, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8483641792589159
avg test loss is  1.3983090714350948
avg accuracy is  0.8747333334896555
solo acc is  0.2676166668230054
compute similarity  is  tensor(0.9782, device='cuda:3')
compute_distance is  tensor(136.8231, device='cuda:3')
compute_norm is  tensor(63.3376, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.8878, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.839994211949265
avg test loss is  1.367087932220146
avg accuracy is  0.8775000001563221
solo acc is  0.265933333489672
compute similarity  is  tensor(0.9779, device='cuda:3')
compute_distance is  tensor(137.8878, device='cuda:3')
compute_norm is  tensor(63.0135, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.9806, device='cuda:3')
distance x is tensor(138.9806, device='cuda:3')
________________________________
test distance is  tensor(138.9806, device='cuda:3')
test distance1 is  tensor(138.9806, device='cuda:3')
test similarity is  tensor(0.9777, device='cuda:3')
test acc is  0.26573333348967204
test loss is 1.342232314571897
test entropy is  0.84206430229551
________________________________
cal ratio is  0.9524559021426209
distance x is tensor(132.3811, device='cuda:3')
cal_distance is  tensor(132.3811, device='cuda:3')
cal ratio is  0.9759082159876218
distance x is tensor(129.1919, device='cuda:3')
cal_distance is  tensor(129.1919, device='cuda:3')
distance x is tensor(129.1919, device='cuda:3')
return_distance is  tensor(129.1919, device='cuda:3')
distance x is tensor(129.1835, device='cuda:3')
distance x is tensor(129.1835, device='cuda:3')
________________________________
test distance is  tensor(129.1835, device='cuda:3')
test distance1 is  tensor(129.1835, device='cuda:3')
test similarity is  tensor(0.9805, device='cuda:3')
test acc is  0.4613333334896751
test loss is 1.0567020280147665
test entropy is  0.9254719113617309
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.5500000005000001
mal loss is 0.8683487176895142
mal norm is  tensor(604.6063, device='cuda:3')
distance x is tensor(129.1919, device='cuda:3')
mal distance is  tensor(129.1919, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(19.4338, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.4199, device='cuda:3')
user_param_square tensor(103.1429, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(4.1501, device='cuda:3')
score : tensor(0.0223, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.2579, device='cuda:3')
user_param_square tensor(105.1801, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-45.8020, device='cuda:3')
score : tensor(-0.4773, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(388.7125, device='cuda:3')
user_param_square tensor(86.9147, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(22.7373, device='cuda:3')
score : tensor(0.2081, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.0482, device='cuda:3')
user_param_square tensor(98.6777, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.5745, device='cuda:3')
score : tensor(0.0665, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(421.7109, device='cuda:3')
user_param_square tensor(90.5287, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-4.4375, device='cuda:3')
score : tensor(-0.0636, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.3070, device='cuda:3')
user_param_square tensor(105.1846, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(3.5135, device='cuda:3')
score : tensor(0.0159, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(458.2777, device='cuda:3')
user_param_square tensor(94.3721, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-21.4222, device='cuda:3')
score : tensor(-0.2335, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(554.5932, device='cuda:3')
user_param_square tensor(103.8165, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-27.9686, device='cuda:3')
score : tensor(-0.2989, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6063, device='cuda:3')
user_param_square tensor(108.3965, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(8.3050, device='cuda:3')
score : tensor(0.0638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.0389, device='cuda:3')
user_param_square tensor(105.2522, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-26.4327, device='cuda:3')
score : tensor(-0.2836, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.2560, device='cuda:3')
user_param_square tensor(111.6336, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-57.2934, device='cuda:3')
score : tensor(-0.5922, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.0703, device='cuda:3')
user_param_square tensor(108.5277, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-25.3368, device='cuda:3')
score : tensor(-0.2726, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.8917, device='cuda:3')
user_param_square tensor(111.3403, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-13.6153, device='cuda:3')
score : tensor(-0.1554, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.8049, device='cuda:3')
user_param_square tensor(110.1041, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-2.0794, device='cuda:3')
score : tensor(-0.0400, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.6494, device='cuda:3')
user_param_square tensor(106.3187, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-52.5394, device='cuda:3')
score : tensor(-0.5446, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.8784, device='cuda:3')
user_param_square tensor(108.0619, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-22.3243, device='cuda:3')
score : tensor(-0.2425, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.5334, device='cuda:3')
user_param_square tensor(109.8150, device='cuda:3')
global_param_square tensor(19.4338, device='cuda:3')
part1 is  tensor(-24.1143, device='cuda:3')
score : tensor(-0.2604, device='cuda:3')
len accept list 16
len all weights is 16
 
Avg Training Stats after 57 global rounds:
Train Accuracy: 88.08% 

Test Accuracy: 87.12% 


 | Global Training Round : 58 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6037369966506958
distance x is tensor(121.1130, device='cuda:3')
benign distance is  tensor(121.1130, device='cuda:3')
norm1 res is  tensor(0.1331, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8953986167907715
distance x is tensor(126.4805, device='cuda:3')
benign distance is  tensor(126.4805, device='cuda:3')
norm1 res is  tensor(0.1372, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2000662386417389
distance x is tensor(111.4263, device='cuda:3')
benign distance is  tensor(111.4263, device='cuda:3')
norm1 res is  tensor(0.1234, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.20183101296424866
distance x is tensor(119.0180, device='cuda:3')
benign distance is  tensor(119.0180, device='cuda:3')
norm1 res is  tensor(0.1270, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6649080514907837
distance x is tensor(111.1908, device='cuda:3')
benign distance is  tensor(111.1908, device='cuda:3')
norm1 res is  tensor(0.1197, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.9125062227249146
distance x is tensor(134.6419, device='cuda:3')
benign distance is  tensor(134.6419, device='cuda:3')
norm1 res is  tensor(0.1467, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.1447155922651291
distance x is tensor(109.4531, device='cuda:3')
benign distance is  tensor(109.4531, device='cuda:3')
norm1 res is  tensor(0.1180, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.27185195684432983
distance x is tensor(125.8102, device='cuda:3')
benign distance is  tensor(125.8102, device='cuda:3')
norm1 res is  tensor(0.1354, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.40277987718582153
distance x is tensor(121.2787, device='cuda:3')
benign distance is  tensor(121.2787, device='cuda:3')
norm1 res is  tensor(0.1328, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.24777808785438538
distance x is tensor(127.2406, device='cuda:3')
benign distance is  tensor(127.2406, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.18958120048046112
distance x is tensor(139.7714, device='cuda:3')
benign distance is  tensor(139.7714, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.9350005984306335
distance x is tensor(133.1855, device='cuda:3')
benign distance is  tensor(133.1855, device='cuda:3')
norm1 res is  tensor(0.1425, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.5565816164016724
distance x is tensor(119.6209, device='cuda:3')
benign distance is  tensor(119.6209, device='cuda:3')
norm1 res is  tensor(0.1285, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.7882474660873413
distance x is tensor(117.0049, device='cuda:3')
benign distance is  tensor(117.0049, device='cuda:3')
norm1 res is  tensor(0.1266, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.2854592204093933
distance x is tensor(137.1183, device='cuda:3')
benign distance is  tensor(137.1183, device='cuda:3')
norm1 res is  tensor(0.1450, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.8319622278213501
distance x is tensor(123.9946, device='cuda:3')
benign distance is  tensor(123.9946, device='cuda:3')
norm1 res is  tensor(0.1369, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(125.2079, device='cuda:3')
compute distance is  tensor(125.2079, device='cuda:3')
compute norm is  tensor(63.1990, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.0080, device='cuda:3')
compute distance is  tensor(116.0080, device='cuda:3')
compute norm is  tensor(63.0435, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9393, device='cuda:3')
compute distance is  tensor(128.9393, device='cuda:3')
compute norm is  tensor(63.2963, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.8861, device='cuda:3')
compute distance is  tensor(121.8861, device='cuda:3')
compute norm is  tensor(63.1984, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6074, device='cuda:3')
compute distance is  tensor(133.6074, device='cuda:3')
compute norm is  tensor(63.3449, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.4439, device='cuda:3')
compute distance is  tensor(138.4439, device='cuda:3')
compute norm is  tensor(63.4725, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0102, device='cuda:3')
compute distance is  tensor(126.0102, device='cuda:3')
compute norm is  tensor(63.3172, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.6798, device='cuda:3')
compute distance is  tensor(122.6798, device='cuda:3')
compute norm is  tensor(63.3244, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5993, device='cuda:3')
compute distance is  tensor(128.5993, device='cuda:3')
compute norm is  tensor(63.2722, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3737, device='cuda:3')
compute distance is  tensor(129.3737, device='cuda:3')
compute norm is  tensor(63.3024, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9712, device='cuda:3')
compute distance is  tensor(139.9712, device='cuda:3')
compute norm is  tensor(63.5703, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.6457, device='cuda:3')
compute distance is  tensor(123.6457, device='cuda:3')
compute norm is  tensor(63.2457, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.9712, device='cuda:3')
distance x is tensor(107552.9688, device='cuda:3')
distance x is tensor(107552.9688, device='cuda:3')
________________________________
test distance is  tensor(107552.9688, device='cuda:3')
test distance1 is  tensor(107552.9688, device='cuda:3')
test similarity is  tensor(0.4845, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130165062668034.73
test entropy is  0.0
________________________________
cal ratio is  0.03535364358266712
distance x is tensor(3802.3950, device='cuda:3')
cal_distance is  tensor(3802.3950, device='cuda:3')
cal ratio is  0.18802550371125018
distance x is tensor(714.9513, device='cuda:3')
cal_distance is  tensor(714.9513, device='cuda:3')
cal ratio is  0.43361785537797226
distance x is tensor(310.0186, device='cuda:3')
cal_distance is  tensor(310.0186, device='cuda:3')
cal ratio is  0.6584935301960344
distance x is tensor(204.1470, device='cuda:3')
cal_distance is  tensor(204.1470, device='cuda:3')
cal ratio is  0.8114726675446344
distance x is tensor(165.6607, device='cuda:3')
cal_distance is  tensor(165.6607, device='cuda:3')
cal ratio is  0.9008150691013839
distance x is tensor(149.2302, device='cuda:3')
cal_distance is  tensor(149.2302, device='cuda:3')
cal ratio is  0.949111134561348
distance x is tensor(141.6363, device='cuda:3')
cal_distance is  tensor(141.6363, device='cuda:3')
cal ratio is  0.9742224990050644
distance x is tensor(137.9854, device='cuda:3')
cal_distance is  tensor(137.9854, device='cuda:3')
distance x is tensor(137.9854, device='cuda:3')
return_distance is  tensor(137.9854, device='cuda:3')
distance x is tensor(137.9751, device='cuda:3')
distance x is tensor(137.9751, device='cuda:3')
________________________________
test distance is  tensor(137.9751, device='cuda:3')
test distance1 is  tensor(137.9751, device='cuda:3')
test similarity is  tensor(0.9823, device='cuda:3')
test acc is  0.10041666682299863
test loss is 84.17635788744701
test entropy is  0.0005715548065178245
________________________________
0
distance x is tensor(137.9751, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0006591029163441203
avg test loss is  84.29522022662132
avg accuracy is  0.61038333348967
solo acc is  0.1005833334896653
compute similarity  is  tensor(0.9823, device='cuda:3')
compute_distance is  tensor(137.9751, device='cuda:3')
compute_norm is  tensor(66.6126, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(132.1342, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8909570573489549
avg test loss is  1.3095069239134474
avg accuracy is  0.727150000156329
solo acc is  0.3145500001563398
compute similarity  is  tensor(0.9830, device='cuda:3')
compute_distance is  tensor(132.1342, device='cuda:3')
compute_norm is  tensor(66.3511, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(132.1342, device='cuda:3')
distance x is tensor(132.1342, device='cuda:3')
________________________________
test distance is  tensor(132.1342, device='cuda:3')
test distance1 is  tensor(132.1342, device='cuda:3')
test similarity is  tensor(0.9830, device='cuda:3')
test acc is  0.31433333348967324
test loss is 1.3134505548583928
test entropy is  0.8906705351526549
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.039280652999878
mal norm is  tensor(682.1724, device='cuda:3')
distance x is tensor(132.1437, device='cuda:3')
mal distance is  tensor(132.1437, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(16.6686, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.1364, device='cuda:3')
user_param_square tensor(93.2019, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(47.7883, device='cuda:3')
score : tensor(0.4614, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(538.9075, device='cuda:3')
user_param_square tensor(94.7777, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(41.1209, device='cuda:3')
score : tensor(0.3947, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(480.6077, device='cuda:3')
user_param_square tensor(89.5044, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(74.0308, device='cuda:3')
score : tensor(0.7238, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.0646, device='cuda:3')
user_param_square tensor(91.4806, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(66.3178, device='cuda:3')
score : tensor(0.6467, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(473.7267, device='cuda:3')
user_param_square tensor(88.8614, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(51.3372, device='cuda:3')
score : tensor(0.4969, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.7188, device='cuda:3')
user_param_square tensor(97.4494, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(47.5258, device='cuda:3')
score : tensor(0.4588, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(458.0601, device='cuda:3')
user_param_square tensor(87.3796, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(57.7646, device='cuda:3')
score : tensor(0.5612, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.9272, device='cuda:3')
user_param_square tensor(94.4270, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(52.8982, device='cuda:3')
score : tensor(0.5125, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.1724, device='cuda:3')
user_param_square tensor(106.6341, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(-78.9058, device='cuda:3')
score : tensor(-0.8055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.0718, device='cuda:3')
user_param_square tensor(107.0163, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(57.3880, device='cuda:3')
score : tensor(0.5574, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0384, device='cuda:3')
user_param_square tensor(103.7715, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(27.8986, device='cuda:3')
score : tensor(0.2625, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.3629, device='cuda:3')
user_param_square tensor(103.3147, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(63.9671, device='cuda:3')
score : tensor(0.6232, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.0916, device='cuda:3')
user_param_square tensor(102.5641, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(69.2637, device='cuda:3')
score : tensor(0.6762, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.6835, device='cuda:3')
user_param_square tensor(102.6933, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(42.6210, device='cuda:3')
score : tensor(0.4097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.3972, device='cuda:3')
user_param_square tensor(103.2368, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(59.3211, device='cuda:3')
score : tensor(0.5767, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.9882, device='cuda:3')
user_param_square tensor(102.0669, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(30.3951, device='cuda:3')
score : tensor(0.2875, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.2059, device='cuda:3')
user_param_square tensor(102.8168, device='cuda:3')
global_param_square tensor(16.6686, device='cuda:3')
part1 is  tensor(49.1537, device='cuda:3')
score : tensor(0.4751, device='cuda:3')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 58 global rounds:
Train Accuracy: 89.65% 

Test Accuracy: 88.76% 


 | Global Training Round : 59 | 

current submit client idx and staleness is  0 1
 benign loss is  1.2694114446640015
distance x is tensor(112.7219, device='cuda:3')
benign distance is  tensor(112.7219, device='cuda:3')
norm1 res is  tensor(0.1285, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.611645519733429
distance x is tensor(131.1736, device='cuda:3')
benign distance is  tensor(131.1736, device='cuda:3')
norm1 res is  tensor(0.1469, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3199551999568939
distance x is tensor(109.7839, device='cuda:3')
benign distance is  tensor(109.7839, device='cuda:3')
norm1 res is  tensor(0.1237, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.2464427947998047
distance x is tensor(110.7265, device='cuda:3')
benign distance is  tensor(110.7265, device='cuda:3')
norm1 res is  tensor(0.1215, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.822141170501709
distance x is tensor(107.4054, device='cuda:3')
benign distance is  tensor(107.4054, device='cuda:3')
norm1 res is  tensor(0.1171, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5661157965660095
distance x is tensor(133.1030, device='cuda:3')
benign distance is  tensor(133.1030, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.4040447771549225
distance x is tensor(97.7215, device='cuda:3')
benign distance is  tensor(97.7215, device='cuda:3')
norm1 res is  tensor(0.1046, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.45187655091285706
distance x is tensor(115.7721, device='cuda:3')
benign distance is  tensor(115.7721, device='cuda:3')
norm1 res is  tensor(0.1303, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3325574994087219
distance x is tensor(123.0930, device='cuda:3')
benign distance is  tensor(123.0930, device='cuda:3')
norm1 res is  tensor(0.1344, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3312259614467621
distance x is tensor(126.1590, device='cuda:3')
benign distance is  tensor(126.1590, device='cuda:3')
norm1 res is  tensor(0.1386, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.32256630063056946
distance x is tensor(121.6937, device='cuda:3')
benign distance is  tensor(121.6937, device='cuda:3')
norm1 res is  tensor(0.1337, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5980637669563293
distance x is tensor(126.0544, device='cuda:3')
benign distance is  tensor(126.0544, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.561184287071228
distance x is tensor(119.0716, device='cuda:3')
benign distance is  tensor(119.0716, device='cuda:3')
norm1 res is  tensor(0.1346, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.20573130249977112
distance x is tensor(131.9767, device='cuda:3')
benign distance is  tensor(131.9767, device='cuda:3')
norm1 res is  tensor(0.1433, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.26781073212623596
distance x is tensor(116.3628, device='cuda:3')
benign distance is  tensor(116.3628, device='cuda:3')
norm1 res is  tensor(0.1312, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.48984670639038086
distance x is tensor(117.9445, device='cuda:3')
benign distance is  tensor(117.9445, device='cuda:3')
norm1 res is  tensor(0.1287, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(126.1828, device='cuda:3')
compute distance is  tensor(126.1828, device='cuda:3')
compute norm is  tensor(63.1598, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.7854, device='cuda:3')
compute distance is  tensor(124.7854, device='cuda:3')
compute norm is  tensor(63.0873, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9676, device='cuda:3')
compute distance is  tensor(123.9676, device='cuda:3')
compute norm is  tensor(63.1891, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.9486, device='cuda:3')
compute distance is  tensor(133.9486, device='cuda:3')
compute norm is  tensor(63.3071, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7837, device='cuda:3')
compute distance is  tensor(128.7837, device='cuda:3')
compute norm is  tensor(63.2092, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5848, device='cuda:3')
compute distance is  tensor(136.5848, device='cuda:3')
compute norm is  tensor(63.3728, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8556, device='cuda:3')
compute distance is  tensor(124.8556, device='cuda:3')
compute norm is  tensor(63.1865, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8465, device='cuda:3')
compute distance is  tensor(128.8465, device='cuda:3')
compute norm is  tensor(63.2514, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0452, device='cuda:3')
compute distance is  tensor(127.0452, device='cuda:3')
compute norm is  tensor(63.1971, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7564, device='cuda:3')
compute distance is  tensor(127.7564, device='cuda:3')
compute norm is  tensor(63.3318, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.8766, device='cuda:3')
compute distance is  tensor(138.8766, device='cuda:3')
compute norm is  tensor(63.3252, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.2046, device='cuda:3')
compute distance is  tensor(121.2046, device='cuda:3')
compute norm is  tensor(63.1896, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.8766, device='cuda:3')
distance x is tensor(107580.7344, device='cuda:3')
distance x is tensor(107580.7344, device='cuda:3')
________________________________
test distance is  tensor(107580.7344, device='cuda:3')
test distance1 is  tensor(107580.7344, device='cuda:3')
test similarity is  tensor(0.4374, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130127325584866.53
test entropy is  0.0
________________________________
cal ratio is  0.03521059339339091
distance x is tensor(3787.9875, device='cuda:3')
cal_distance is  tensor(3787.9875, device='cuda:3')
cal ratio is  0.18764470826022375
distance x is tensor(710.7999, device='cuda:3')
cal_distance is  tensor(710.7999, device='cuda:3')
cal ratio is  0.43317853259633493
distance x is tensor(307.9061, device='cuda:3')
cal_distance is  tensor(307.9061, device='cuda:3')
cal ratio is  0.6581599085082002
distance x is tensor(202.6532, device='cuda:3')
cal_distance is  tensor(202.6532, device='cuda:3')
cal ratio is  0.8112670065385958
distance x is tensor(164.4069, device='cuda:3')
cal_distance is  tensor(164.4069, device='cuda:3')
cal ratio is  0.9007009310484282
distance x is tensor(148.0819, device='cuda:3')
cal_distance is  tensor(148.0819, device='cuda:3')
cal ratio is  0.9490510000060322
distance x is tensor(140.5376, device='cuda:3')
cal_distance is  tensor(140.5376, device='cuda:3')
cal ratio is  0.9741915325410013
distance x is tensor(136.9106, device='cuda:3')
cal_distance is  tensor(136.9106, device='cuda:3')
distance x is tensor(136.9106, device='cuda:3')
return_distance is  tensor(136.9106, device='cuda:3')
distance x is tensor(136.9005, device='cuda:3')
distance x is tensor(136.9005, device='cuda:3')
________________________________
test distance is  tensor(136.9005, device='cuda:3')
test distance1 is  tensor(136.9005, device='cuda:3')
test similarity is  tensor(0.9809, device='cuda:3')
test acc is  0.14766666682299961
test loss is 57.28222077538464
test entropy is  0.01679680444049782
________________________________
0
distance x is tensor(136.9005, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.01717938461672935
avg test loss is  57.14120761163707
avg accuracy is  0.8685500001563224
solo acc is  0.14883333348966638
compute similarity  is  tensor(0.9809, device='cuda:3')
compute_distance is  tensor(136.9005, device='cuda:3')
compute_norm is  tensor(66.3455, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.1555, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9418868188664857
avg test loss is  1.3762888890593798
avg accuracy is  0.8183333334896579
solo acc is  0.30073333348967285
compute similarity  is  tensor(0.9808, device='cuda:3')
compute_distance is  tensor(136.1555, device='cuda:3')
compute_norm is  tensor(65.9884, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.9078, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8875493259191005
avg test loss is  1.448479625843227
avg accuracy is  0.8197333334896579
solo acc is  0.24775000015633813
compute similarity  is  tensor(0.9807, device='cuda:3')
compute_distance is  tensor(136.9078, device='cuda:3')
compute_norm is  tensor(65.6571, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.5767, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8600598484722536
avg test loss is  1.4285131828871362
avg accuracy is  0.824016666822991
solo acc is  0.24740000015633815
compute similarity  is  tensor(0.9805, device='cuda:3')
compute_distance is  tensor(137.5767, device='cuda:3')
compute_norm is  tensor(65.3280, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.2435, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.859509925979541
avg test loss is  1.4011172469236703
avg accuracy is  0.8268833334896575
solo acc is  0.2418833334896714
compute similarity  is  tensor(0.9804, device='cuda:3')
compute_distance is  tensor(138.2435, device='cuda:3')
compute_norm is  tensor(65.0026, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.8194, device='cuda:3')
distance x is tensor(138.8194, device='cuda:3')
________________________________
test distance is  tensor(138.8194, device='cuda:3')
test distance1 is  tensor(138.8194, device='cuda:3')
test similarity is  tensor(0.9802, device='cuda:3')
test acc is  0.23773333348967113
test loss is 1.3807613052793148
test entropy is  0.8591282793453762
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.0574109554290771
mal norm is  tensor(659.7230, device='cuda:3')
distance x is tensor(138.8285, device='cuda:3')
mal distance is  tensor(138.8285, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(23.6699, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.4076, device='cuda:3')
user_param_square tensor(108.9416, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-1.2165, device='cuda:3')
score : tensor(-0.0356, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.0131, device='cuda:3')
user_param_square tensor(116.3593, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-1.3236, device='cuda:3')
score : tensor(-0.0367, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.1469, device='cuda:3')
user_param_square tensor(106.9394, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(104.3311, device='cuda:3')
score : tensor(1.0198, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(476.7549, device='cuda:3')
user_param_square tensor(106.2297, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(103.6825, device='cuda:3')
score : tensor(1.0134, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(458.5065, device='cuda:3')
user_param_square tensor(104.1768, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-37.1107, device='cuda:3')
score : tensor(-0.3946, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.5692, device='cuda:3')
user_param_square tensor(116.3142, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(18.3087, device='cuda:3')
score : tensor(0.1596, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(410.2509, device='cuda:3')
user_param_square tensor(98.5424, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(39.8760, device='cuda:3')
score : tensor(0.3753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.7797, device='cuda:3')
user_param_square tensor(109.7395, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(13.8538, device='cuda:3')
score : tensor(0.1151, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.7230, device='cuda:3')
user_param_square tensor(124.9623, device='cuda:3')
global_param_square tensor(23.6699, device='cuda:3')
part1 is  tensor(-17.8731, device='cuda:3')
score : tensor(-0.2022, device='cuda:3')
len accept list 5
len all weights is 5
 
Avg Training Stats after 59 global rounds:
Train Accuracy: 89.45% 

Test Accuracy: 88.36% 


 | Global Training Round : 60 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3608162999153137
distance x is tensor(121.3210, device='cuda:3')
benign distance is  tensor(121.3210, device='cuda:3')
norm1 res is  tensor(0.1318, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5120688676834106
distance x is tensor(138.8719, device='cuda:3')
benign distance is  tensor(138.8719, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.22846460342407227
distance x is tensor(110.2190, device='cuda:3')
benign distance is  tensor(110.2190, device='cuda:3')
norm1 res is  tensor(0.1213, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5701837539672852
distance x is tensor(113.6679, device='cuda:3')
benign distance is  tensor(113.6679, device='cuda:3')
norm1 res is  tensor(0.1291, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.36156201362609863
distance x is tensor(116.3950, device='cuda:3')
benign distance is  tensor(116.3950, device='cuda:3')
norm1 res is  tensor(0.1264, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.9795034527778625
distance x is tensor(133.8760, device='cuda:3')
benign distance is  tensor(133.8760, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.6662446856498718
distance x is tensor(98.6946, device='cuda:3')
benign distance is  tensor(98.6946, device='cuda:3')
norm1 res is  tensor(0.1090, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.38615474104881287
distance x is tensor(123.9324, device='cuda:3')
benign distance is  tensor(123.9324, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(134.1932, device='cuda:3')
compute distance is  tensor(134.1932, device='cuda:3')
compute norm is  tensor(63.5855, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4178, device='cuda:3')
compute distance is  tensor(131.4178, device='cuda:3')
compute norm is  tensor(63.6260, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2283, device='cuda:3')
compute distance is  tensor(134.2283, device='cuda:3')
compute norm is  tensor(63.8689, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1083, device='cuda:3')
compute distance is  tensor(141.1083, device='cuda:3')
compute norm is  tensor(63.7589, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.5085, device='cuda:3')
compute distance is  tensor(141.5085, device='cuda:3')
compute norm is  tensor(63.7971, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5826, device='cuda:3')
compute distance is  tensor(126.5826, device='cuda:3')
compute norm is  tensor(63.7217, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.4014, device='cuda:3')
compute distance is  tensor(123.4014, device='cuda:3')
compute norm is  tensor(63.6346, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.5828, device='cuda:3')
compute distance is  tensor(141.5828, device='cuda:3')
compute norm is  tensor(63.9104, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.8875, device='cuda:3')
compute distance is  tensor(134.8875, device='cuda:3')
compute norm is  tensor(63.6901, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.4727, device='cuda:3')
compute distance is  tensor(128.4727, device='cuda:3')
compute norm is  tensor(63.7662, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.5268, device='cuda:3')
compute distance is  tensor(142.5268, device='cuda:3')
compute norm is  tensor(63.9319, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.0108, device='cuda:3')
compute distance is  tensor(137.0108, device='cuda:3')
compute norm is  tensor(63.8182, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(142.5268, device='cuda:3')
distance x is tensor(107584.5234, device='cuda:3')
distance x is tensor(107584.5234, device='cuda:3')
________________________________
test distance is  tensor(107584.5234, device='cuda:3')
test distance1 is  tensor(107584.5234, device='cuda:3')
test similarity is  tensor(0.4279, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130126262002380.14
test entropy is  0.0
________________________________
cal ratio is  0.03566969979210845
distance x is tensor(3837.5129, device='cuda:3')
cal_distance is  tensor(3837.5129, device='cuda:3')
cal ratio is  0.18886410495881642
distance x is tensor(724.7726, device='cuda:3')
cal_distance is  tensor(724.7726, device='cuda:3')
cal ratio is  0.4345837440318102
distance x is tensor(314.9772, device='cuda:3')
cal_distance is  tensor(314.9772, device='cuda:3')
cal ratio is  0.6592266778227354
distance x is tensor(207.6432, device='cuda:3')
cal_distance is  tensor(207.6432, device='cuda:3')
cal ratio is  0.8119243038468504
distance x is tensor(168.5915, device='cuda:3')
cal_distance is  tensor(168.5915, device='cuda:3')
cal ratio is  0.9010658868669265
distance x is tensor(151.9126, device='cuda:3')
cal_distance is  tensor(151.9126, device='cuda:3')
cal ratio is  0.949243272441064
distance x is tensor(144.2022, device='cuda:3')
cal_distance is  tensor(144.2022, device='cuda:3')
cal ratio is  0.9742903044852784
distance x is tensor(140.4950, device='cuda:3')
cal_distance is  tensor(140.4950, device='cuda:3')
distance x is tensor(140.4950, device='cuda:3')
return_distance is  tensor(140.4950, device='cuda:3')
distance x is tensor(140.4848, device='cuda:3')
distance x is tensor(140.4848, device='cuda:3')
________________________________
test distance is  tensor(140.4848, device='cuda:3')
test distance1 is  tensor(140.4848, device='cuda:3')
test similarity is  tensor(0.9799, device='cuda:3')
test acc is  0.12213333348966525
test loss is 94.91129083369079
test entropy is  0.00551410275239144
________________________________
0
distance x is tensor(140.4848, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.005510406876944091
avg test loss is  94.75754450328314
avg accuracy is  0.8517333334896565
solo acc is  0.12225000015633192
compute similarity  is  tensor(0.9799, device='cuda:3')
compute_distance is  tensor(140.4848, device='cuda:3')
compute_norm is  tensor(66.9601, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(140.5921, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9840796540286749
avg test loss is  1.4460031915066847
avg accuracy is  0.7984500001563254
solo acc is  0.2988833334896729
compute similarity  is  tensor(0.9798, device='cuda:3')
compute_distance is  tensor(140.5921, device='cuda:3')
compute_norm is  tensor(66.7192, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(140.5921, device='cuda:3')
distance x is tensor(140.5921, device='cuda:3')
________________________________
test distance is  tensor(140.5921, device='cuda:3')
test distance1 is  tensor(140.5921, device='cuda:3')
test similarity is  tensor(0.9798, device='cuda:3')
test acc is  0.3010333334896729
test loss is 1.4450288695821376
test entropy is  0.9814209587919687
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.7137720584869385
mal norm is  tensor(706.3051, device='cuda:3')
distance x is tensor(140.6010, device='cuda:3')
mal distance is  tensor(140.6010, device='cuda:3')
len current grad  20
len all grad 60
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(22.5752, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.1273, device='cuda:3')
user_param_square tensor(108.4646, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(45.7169, device='cuda:3')
score : tensor(0.4348, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.5344, device='cuda:3')
user_param_square tensor(116.1442, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-25.0959, device='cuda:3')
score : tensor(-0.2733, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(476.4174, device='cuda:3')
user_param_square tensor(103.7075, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(13.6479, device='cuda:3')
score : tensor(0.1141, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.4288, device='cuda:3')
user_param_square tensor(105.3286, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(17.7353, device='cuda:3')
score : tensor(0.1550, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.4771, device='cuda:3')
user_param_square tensor(106.1876, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-20.7608, device='cuda:3')
score : tensor(-0.2300, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.7933, device='cuda:3')
user_param_square tensor(113.8135, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-16.2294, device='cuda:3')
score : tensor(-0.1847, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(426.0169, device='cuda:3')
user_param_square tensor(98.0685, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(21.4751, device='cuda:3')
score : tensor(0.1924, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.0172, device='cuda:3')
user_param_square tensor(109.6950, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(2.8363, device='cuda:3')
score : tensor(0.0060, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.3051, device='cuda:3')
user_param_square tensor(126.2735, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(4.7574, device='cuda:3')
score : tensor(0.0252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.8612, device='cuda:3')
user_param_square tensor(126.7692, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(51.4423, device='cuda:3')
score : tensor(0.4920, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.7110, device='cuda:3')
user_param_square tensor(120.3610, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(37.2837, device='cuda:3')
score : tensor(0.3505, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.1260, device='cuda:3')
user_param_square tensor(121.1476, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(9.4848, device='cuda:3')
score : tensor(0.0725, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.7103, device='cuda:3')
user_param_square tensor(129.6611, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(13.7091, device='cuda:3')
score : tensor(0.1147, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2853, device='cuda:3')
user_param_square tensor(123.3781, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-7.7247, device='cuda:3')
score : tensor(-0.0996, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.6072, device='cuda:3')
user_param_square tensor(123.3160, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-0.9503, device='cuda:3')
score : tensor(-0.0319, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.5798, device='cuda:3')
user_param_square tensor(123.0386, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-36.8445, device='cuda:3')
score : tensor(-0.3908, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.3771, device='cuda:3')
user_param_square tensor(125.7425, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(30.2552, device='cuda:3')
score : tensor(0.2802, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.2804, device='cuda:3')
user_param_square tensor(117.4725, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(72.7274, device='cuda:3')
score : tensor(0.7049, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.6206, device='cuda:3')
user_param_square tensor(122.3062, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(60.0906, device='cuda:3')
score : tensor(0.5785, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.6597, device='cuda:3')
user_param_square tensor(117.8926, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(17.3987, device='cuda:3')
score : tensor(0.1516, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.2838, device='cuda:3')
user_param_square tensor(114.9475, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(90.1272, device='cuda:3')
score : tensor(0.8789, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.0579, device='cuda:3')
user_param_square tensor(119.2632, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-11.0979, device='cuda:3')
score : tensor(-0.1334, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.3832, device='cuda:3')
user_param_square tensor(114.1690, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(15.3746, device='cuda:3')
score : tensor(0.1314, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.6325, device='cuda:3')
user_param_square tensor(118.0813, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(29.7616, device='cuda:3')
score : tensor(0.2752, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.2345, device='cuda:3')
user_param_square tensor(113.9564, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(57.8977, device='cuda:3')
score : tensor(0.5566, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.1359, device='cuda:3')
user_param_square tensor(116.2998, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(56.7144, device='cuda:3')
score : tensor(0.5448, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.8049, device='cuda:3')
user_param_square tensor(112.7185, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-16.2783, device='cuda:3')
score : tensor(-0.1852, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.3168, device='cuda:3')
user_param_square tensor(116.8981, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(15.7766, device='cuda:3')
score : tensor(0.1354, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.3422, device='cuda:3')
user_param_square tensor(116.4168, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(32.9533, device='cuda:3')
score : tensor(0.3072, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.6747, device='cuda:3')
user_param_square tensor(113.7025, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-27.3741, device='cuda:3')
score : tensor(-0.2961, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.4266, device='cuda:3')
user_param_square tensor(116.7155, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(9.8506, device='cuda:3')
score : tensor(0.0761, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.2147, device='cuda:3')
user_param_square tensor(116.4044, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-10.5269, device='cuda:3')
score : tensor(-0.1276, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.6576, device='cuda:3')
user_param_square tensor(115.4740, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(107.2782, device='cuda:3')
score : tensor(1.0504, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.1393, device='cuda:3')
user_param_square tensor(113.8478, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-15.8110, device='cuda:3')
score : tensor(-0.1805, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.5906, device='cuda:3')
user_param_square tensor(115.4674, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-18.0091, device='cuda:3')
score : tensor(-0.2025, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.6566, device='cuda:3')
user_param_square tensor(118.7509, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(24.1684, device='cuda:3')
score : tensor(0.2193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.9778, device='cuda:3')
user_param_square tensor(116.5753, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(63.4275, device='cuda:3')
score : tensor(0.6119, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.6661, device='cuda:3')
user_param_square tensor(111.6986, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(8.8071, device='cuda:3')
score : tensor(0.0657, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.2879, device='cuda:3')
user_param_square tensor(111.3567, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-3.9769, device='cuda:3')
score : tensor(-0.0621, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.7022, device='cuda:3')
user_param_square tensor(116.9353, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(62.5190, device='cuda:3')
score : tensor(0.6028, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.2858, device='cuda:3')
user_param_square tensor(115.1439, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-9.8951, device='cuda:3')
score : tensor(-0.1213, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.1645, device='cuda:3')
user_param_square tensor(111.7489, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(30.5177, device='cuda:3')
score : tensor(0.2828, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.6047, device='cuda:3')
user_param_square tensor(113.4969, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(7.6519, device='cuda:3')
score : tensor(0.0541, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.8910, device='cuda:3')
user_param_square tensor(112.1247, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(44.4175, device='cuda:3')
score : tensor(0.4218, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.3843, device='cuda:3')
user_param_square tensor(114.2679, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(26.0126, device='cuda:3')
score : tensor(0.2378, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.3546, device='cuda:3')
user_param_square tensor(112.0707, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-4.9377, device='cuda:3')
score : tensor(-0.0718, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.0379, device='cuda:3')
user_param_square tensor(115.6088, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(14.8732, device='cuda:3')
score : tensor(0.1264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.5630, device='cuda:3')
user_param_square tensor(110.7748, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(29.1035, device='cuda:3')
score : tensor(0.2687, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.7980, device='cuda:3')
user_param_square tensor(110.0833, device='cuda:3')
global_param_square tensor(22.5752, device='cuda:3')
part1 is  tensor(-44.8225, device='cuda:3')
score : tensor(-0.4706, device='cuda:3')
len accept list 44
len all weights is 44
 
Avg Training Stats after 60 global rounds:
Train Accuracy: 89.24% 

Test Accuracy: 88.42% 


 | Global Training Round : 61 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4417498707771301
distance x is tensor(117.4185, device='cuda:3')
benign distance is  tensor(117.4185, device='cuda:3')
norm1 res is  tensor(0.1275, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5127164125442505
distance x is tensor(130.2189, device='cuda:3')
benign distance is  tensor(130.2189, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.03959660232067108
distance x is tensor(111.1146, device='cuda:3')
benign distance is  tensor(111.1146, device='cuda:3')
norm1 res is  tensor(0.1243, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4990132451057434
distance x is tensor(106.8289, device='cuda:3')
benign distance is  tensor(106.8289, device='cuda:3')
norm1 res is  tensor(0.1197, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.2555316388607025
distance x is tensor(100.7292, device='cuda:3')
benign distance is  tensor(100.7292, device='cuda:3')
norm1 res is  tensor(0.1098, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.2459714710712433
distance x is tensor(133.3533, device='cuda:3')
benign distance is  tensor(133.3533, device='cuda:3')
norm1 res is  tensor(0.1469, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.315116286277771
distance x is tensor(113.0956, device='cuda:3')
benign distance is  tensor(113.0956, device='cuda:3')
norm1 res is  tensor(0.1206, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.10974889993667603
distance x is tensor(113.3619, device='cuda:3')
benign distance is  tensor(113.3619, device='cuda:3')
norm1 res is  tensor(0.1252, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.8860829472541809
distance x is tensor(131.1800, device='cuda:3')
benign distance is  tensor(131.1800, device='cuda:3')
norm1 res is  tensor(0.1428, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.9095451235771179
distance x is tensor(122.6131, device='cuda:3')
benign distance is  tensor(122.6131, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.27205270528793335
distance x is tensor(122.5478, device='cuda:3')
benign distance is  tensor(122.5478, device='cuda:3')
norm1 res is  tensor(0.1349, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6284939646720886
distance x is tensor(126.4171, device='cuda:3')
benign distance is  tensor(126.4171, device='cuda:3')
norm1 res is  tensor(0.1353, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.32519030570983887
distance x is tensor(121.1637, device='cuda:3')
benign distance is  tensor(121.1637, device='cuda:3')
norm1 res is  tensor(0.1333, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.6493600010871887
distance x is tensor(128.4617, device='cuda:3')
benign distance is  tensor(128.4617, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.0742424950003624
distance x is tensor(124.3323, device='cuda:3')
benign distance is  tensor(124.3323, device='cuda:3')
norm1 res is  tensor(0.1369, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3286316394805908
distance x is tensor(137.0283, device='cuda:3')
benign distance is  tensor(137.0283, device='cuda:3')
norm1 res is  tensor(0.1506, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.08859233558177948
distance x is tensor(123.4198, device='cuda:3')
benign distance is  tensor(123.4198, device='cuda:3')
norm1 res is  tensor(0.1367, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.7487387657165527
distance x is tensor(137.9474, device='cuda:3')
benign distance is  tensor(137.9474, device='cuda:3')
norm1 res is  tensor(0.1518, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.26242953538894653
distance x is tensor(131.5786, device='cuda:3')
benign distance is  tensor(131.5786, device='cuda:3')
norm1 res is  tensor(0.1449, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.6823412179946899
distance x is tensor(119.2144, device='cuda:3')
benign distance is  tensor(119.2144, device='cuda:3')
norm1 res is  tensor(0.1319, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.17310819029808044
distance x is tensor(134.1013, device='cuda:3')
benign distance is  tensor(134.1013, device='cuda:3')
norm1 res is  tensor(0.1471, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.510612964630127
distance x is tensor(117.3419, device='cuda:3')
benign distance is  tensor(117.3419, device='cuda:3')
norm1 res is  tensor(0.1284, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.33569324016571045
distance x is tensor(138.9570, device='cuda:3')
benign distance is  tensor(138.9570, device='cuda:3')
norm1 res is  tensor(0.1497, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.29728245735168457
distance x is tensor(130.2802, device='cuda:3')
benign distance is  tensor(130.2802, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.3166872262954712
distance x is tensor(136.0006, device='cuda:3')
benign distance is  tensor(136.0006, device='cuda:3')
norm1 res is  tensor(0.1482, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.1812593787908554
distance x is tensor(122.8797, device='cuda:3')
benign distance is  tensor(122.8797, device='cuda:3')
norm1 res is  tensor(0.1353, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.2093556672334671
distance x is tensor(126.8494, device='cuda:3')
benign distance is  tensor(126.8494, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.3687846064567566
distance x is tensor(136.5688, device='cuda:3')
benign distance is  tensor(136.5688, device='cuda:3')
norm1 res is  tensor(0.1459, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.8925788998603821
distance x is tensor(126.3952, device='cuda:3')
benign distance is  tensor(126.3952, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.5559608936309814
distance x is tensor(126.9734, device='cuda:3')
benign distance is  tensor(126.9734, device='cuda:3')
norm1 res is  tensor(0.1403, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.3087562620639801
distance x is tensor(127.2089, device='cuda:3')
benign distance is  tensor(127.2089, device='cuda:3')
norm1 res is  tensor(0.1403, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.24391070008277893
distance x is tensor(134.1289, device='cuda:3')
benign distance is  tensor(134.1289, device='cuda:3')
norm1 res is  tensor(0.1487, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.274655282497406
distance x is tensor(128.3206, device='cuda:3')
benign distance is  tensor(128.3206, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.06614402681589127
distance x is tensor(127.9113, device='cuda:3')
benign distance is  tensor(127.9113, device='cuda:3')
norm1 res is  tensor(0.1442, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.08003026247024536
distance x is tensor(126.8899, device='cuda:3')
benign distance is  tensor(126.8899, device='cuda:3')
norm1 res is  tensor(0.1398, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.13187076151371002
distance x is tensor(118.6848, device='cuda:3')
benign distance is  tensor(118.6848, device='cuda:3')
norm1 res is  tensor(0.1289, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.31877395510673523
distance x is tensor(130.9220, device='cuda:3')
benign distance is  tensor(130.9220, device='cuda:3')
norm1 res is  tensor(0.1441, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.4573121964931488
distance x is tensor(119.0317, device='cuda:3')
benign distance is  tensor(119.0317, device='cuda:3')
norm1 res is  tensor(0.1323, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.2651178240776062
distance x is tensor(120.6415, device='cuda:3')
benign distance is  tensor(120.6415, device='cuda:3')
norm1 res is  tensor(0.1346, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.5995548963546753
distance x is tensor(119.6172, device='cuda:3')
benign distance is  tensor(119.6172, device='cuda:3')
norm1 res is  tensor(0.1290, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.3577820360660553
distance x is tensor(146.1190, device='cuda:3')
benign distance is  tensor(146.1190, device='cuda:3')
norm1 res is  tensor(0.1589, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.09064232558012009
distance x is tensor(135.1689, device='cuda:3')
benign distance is  tensor(135.1689, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.06729148328304291
distance x is tensor(120.9773, device='cuda:3')
benign distance is  tensor(120.9773, device='cuda:3')
norm1 res is  tensor(0.1360, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.16996484994888306
distance x is tensor(133.4428, device='cuda:3')
benign distance is  tensor(133.4428, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.6582835912704468
distance x is tensor(122.5910, device='cuda:3')
benign distance is  tensor(122.5910, device='cuda:3')
norm1 res is  tensor(0.1350, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.4731527268886566
distance x is tensor(125.8565, device='cuda:3')
benign distance is  tensor(125.8565, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.3006123900413513
distance x is tensor(126.3082, device='cuda:3')
benign distance is  tensor(126.3082, device='cuda:3')
norm1 res is  tensor(0.1397, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.17516040802001953
distance x is tensor(124.6467, device='cuda:3')
benign distance is  tensor(124.6467, device='cuda:3')
norm1 res is  tensor(0.1405, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(124.6191, device='cuda:3')
compute distance is  tensor(124.6191, device='cuda:3')
compute norm is  tensor(64.0077, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1188, device='cuda:3')
compute distance is  tensor(122.1188, device='cuda:3')
compute norm is  tensor(63.9396, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.7148, device='cuda:3')
compute distance is  tensor(129.7148, device='cuda:3')
compute norm is  tensor(64.1301, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1606, device='cuda:3')
compute distance is  tensor(135.1606, device='cuda:3')
compute norm is  tensor(64.0289, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6123, device='cuda:3')
compute distance is  tensor(129.6123, device='cuda:3')
compute norm is  tensor(64.1529, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6444, device='cuda:3')
compute distance is  tensor(127.6444, device='cuda:3')
compute norm is  tensor(64.0854, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.4447, device='cuda:3')
compute distance is  tensor(121.4447, device='cuda:3')
compute norm is  tensor(63.9568, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.4340, device='cuda:3')
compute distance is  tensor(127.4340, device='cuda:3')
compute norm is  tensor(64.0628, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1470, device='cuda:3')
compute distance is  tensor(135.1470, device='cuda:3')
compute norm is  tensor(64.0645, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.0684, device='cuda:3')
compute distance is  tensor(131.0684, device='cuda:3')
compute norm is  tensor(64.1441, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6079, device='cuda:3')
compute distance is  tensor(130.6079, device='cuda:3')
compute norm is  tensor(64.2312, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8507, device='cuda:3')
compute distance is  tensor(120.8507, device='cuda:3')
compute norm is  tensor(64.0328, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(135.1606, device='cuda:3')
distance x is tensor(107568.8750, device='cuda:3')
distance x is tensor(107568.8750, device='cuda:3')
________________________________
test distance is  tensor(107568.8750, device='cuda:3')
test distance1 is  tensor(107568.8750, device='cuda:3')
test similarity is  tensor(0.4567, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130084830935760.52
test entropy is  0.0
________________________________
cal ratio is  0.03473823496684521
distance x is tensor(3736.7585, device='cuda:3')
cal_distance is  tensor(3736.7585, device='cuda:3')
cal ratio is  0.1863818167415898
distance x is tensor(696.4680, device='cuda:3')
cal_distance is  tensor(696.4680, device='cuda:3')
cal ratio is  0.43171831444363845
distance x is tensor(300.6809, device='cuda:3')
cal_distance is  tensor(300.6809, device='cuda:3')
cal ratio is  0.6570495677122733
distance x is tensor(197.5640, device='cuda:3')
cal_distance is  tensor(197.5640, device='cuda:3')
cal ratio is  0.8105823406356417
distance x is tensor(160.1429, device='cuda:3')
cal_distance is  tensor(160.1429, device='cuda:3')
cal ratio is  0.900320726666242
distance x is tensor(144.1805, device='cuda:3')
cal_distance is  tensor(144.1805, device='cuda:3')
cal ratio is  0.9488505742388275
distance x is tensor(136.8060, device='cuda:3')
cal_distance is  tensor(136.8060, device='cuda:3')
cal ratio is  0.9740886956646386
distance x is tensor(133.2613, device='cuda:3')
cal_distance is  tensor(133.2613, device='cuda:3')
distance x is tensor(133.2613, device='cuda:3')
return_distance is  tensor(133.2613, device='cuda:3')
distance x is tensor(133.2511, device='cuda:3')
distance x is tensor(133.2511, device='cuda:3')
________________________________
test distance is  tensor(133.2511, device='cuda:3')
test distance1 is  tensor(133.2511, device='cuda:3')
test similarity is  tensor(0.9828, device='cuda:3')
test acc is  0.5062166668230088
test loss is 9.880054083460175
test entropy is  0.10851019173701688
________________________________
0
distance x is tensor(133.2511, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.1105392083589202
avg test loss is  9.91638161124451
avg accuracy is  0.8871833334896551
solo acc is  0.5052833334896755
compute similarity  is  tensor(0.9828, device='cuda:3')
compute_distance is  tensor(133.2511, device='cuda:3')
compute_norm is  tensor(67.1905, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(132.7663, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9037885064128112
avg test loss is  1.3385993243534682
avg accuracy is  0.8124666668229915
solo acc is  0.32063333348967327
compute similarity  is  tensor(0.9825, device='cuda:3')
compute_distance is  tensor(132.7663, device='cuda:3')
compute_norm is  tensor(66.6280, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.8164, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8545516352536582
avg test loss is  1.4251132803176767
avg accuracy is  0.8038166668229918
solo acc is  0.2552833334896718
compute similarity  is  tensor(0.9822, device='cuda:3')
compute_distance is  tensor(133.8164, device='cuda:3')
compute_norm is  tensor(66.2841, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.5383, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.851994216251475
avg test loss is  1.3976228930421475
avg accuracy is  0.8043000001563253
solo acc is  0.2504333334896717
compute similarity  is  tensor(0.9820, device='cuda:3')
compute_distance is  tensor(134.5383, device='cuda:3')
compute_norm is  tensor(65.9488, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.1566, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8539118080505176
avg test loss is  1.3818917066049474
avg accuracy is  0.8080666668229917
solo acc is  0.24491666682300478
compute similarity  is  tensor(0.9819, device='cuda:3')
compute_distance is  tensor(135.1566, device='cuda:3')
compute_norm is  tensor(65.6209, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.8021, device='cuda:3')
distance x is tensor(135.8021, device='cuda:3')
________________________________
test distance is  tensor(135.8021, device='cuda:3')
test distance1 is  tensor(135.8021, device='cuda:3')
test similarity is  tensor(0.9817, device='cuda:3')
test acc is  0.24645000015633817
test loss is 1.3659241684972605
test entropy is  0.8420126412087666
________________________________
cal ratio is  0.9776823993299364
distance x is tensor(132.7800, device='cuda:3')
cal_distance is  tensor(132.7800, device='cuda:3')
distance x is tensor(132.7800, device='cuda:3')
return_distance is  tensor(132.7800, device='cuda:3')
distance x is tensor(132.7712, device='cuda:3')
distance x is tensor(132.7712, device='cuda:3')
________________________________
test distance is  tensor(132.7712, device='cuda:3')
test distance1 is  tensor(132.7712, device='cuda:3')
test similarity is  tensor(0.9825, device='cuda:3')
test acc is  0.28201666682300586
test loss is 1.294060530057594
test entropy is  0.8756741180475841
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.0315468311309814
mal norm is  tensor(631.2225, device='cuda:3')
distance x is tensor(132.7800, device='cuda:3')
mal distance is  tensor(132.7800, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(14.5732, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.1781, device='cuda:3')
user_param_square tensor(85.5473, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(10.4340, device='cuda:3')
score : tensor(0.0900, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.9179, device='cuda:3')
user_param_square tensor(90.6537, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(45.9822, device='cuda:3')
score : tensor(0.4454, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(479.3435, device='cuda:3')
user_param_square tensor(83.5797, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(46.8918, device='cuda:3')
score : tensor(0.4545, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(459.2385, device='cuda:3')
user_param_square tensor(81.8082, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(28.5641, device='cuda:3')
score : tensor(0.2713, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(432.3687, device='cuda:3')
user_param_square tensor(79.3788, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(36.6172, device='cuda:3')
score : tensor(0.3518, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.1368, device='cuda:3')
user_param_square tensor(91.5510, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(21.7143, device='cuda:3')
score : tensor(0.2028, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(476.4420, device='cuda:3')
user_param_square tensor(83.3264, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(29.2454, device='cuda:3')
score : tensor(0.2781, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(495.2819, device='cuda:3')
user_param_square tensor(84.9579, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(18.4899, device='cuda:3')
score : tensor(0.1705, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2225, device='cuda:3')
user_param_square tensor(95.9111, device='cuda:3')
global_param_square tensor(14.5732, device='cuda:3')
part1 is  tensor(-61.3950, device='cuda:3')
score : tensor(-0.6283, device='cuda:3')
len accept list 8
len all weights is 8
 
Avg Training Stats after 61 global rounds:
Train Accuracy: 89.57% 

Test Accuracy: 88.66% 


 | Global Training Round : 62 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4553627371788025
distance x is tensor(105.1021, device='cuda:3')
benign distance is  tensor(105.1021, device='cuda:3')
norm1 res is  tensor(0.1176, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3153443932533264
distance x is tensor(130.0718, device='cuda:3')
benign distance is  tensor(130.0718, device='cuda:3')
norm1 res is  tensor(0.1451, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2599795460700989
distance x is tensor(146.1481, device='cuda:3')
benign distance is  tensor(146.1481, device='cuda:3')
norm1 res is  tensor(0.1606, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.36399298906326294
distance x is tensor(104.6625, device='cuda:3')
benign distance is  tensor(104.6625, device='cuda:3')
norm1 res is  tensor(0.1150, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.43543878197669983
distance x is tensor(112.3902, device='cuda:3')
benign distance is  tensor(112.3902, device='cuda:3')
norm1 res is  tensor(0.1244, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.9660776257514954
distance x is tensor(130.2578, device='cuda:3')
benign distance is  tensor(130.2578, device='cuda:3')
norm1 res is  tensor(0.1463, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.9986349940299988
distance x is tensor(101.5263, device='cuda:3')
benign distance is  tensor(101.5263, device='cuda:3')
norm1 res is  tensor(0.1096, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.1835288107395172
distance x is tensor(118.9860, device='cuda:3')
benign distance is  tensor(118.9860, device='cuda:3')
norm1 res is  tensor(0.1368, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(128.9598, device='cuda:3')
compute distance is  tensor(128.9598, device='cuda:3')
compute norm is  tensor(64.4837, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8772, device='cuda:3')
compute distance is  tensor(132.8772, device='cuda:3')
compute norm is  tensor(64.6133, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9927, device='cuda:3')
compute distance is  tensor(135.9927, device='cuda:3')
compute norm is  tensor(64.6690, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7367, device='cuda:3')
compute distance is  tensor(130.7367, device='cuda:3')
compute norm is  tensor(64.4514, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5761, device='cuda:3')
compute distance is  tensor(132.5761, device='cuda:3')
compute norm is  tensor(64.5481, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5202, device='cuda:3')
compute distance is  tensor(139.5202, device='cuda:3')
compute norm is  tensor(64.6782, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8411, device='cuda:3')
compute distance is  tensor(133.8411, device='cuda:3')
compute norm is  tensor(64.4659, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2915, device='cuda:3')
compute distance is  tensor(133.2915, device='cuda:3')
compute norm is  tensor(64.6782, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7944, device='cuda:3')
compute distance is  tensor(132.7944, device='cuda:3')
compute norm is  tensor(64.5510, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7102, device='cuda:3')
compute distance is  tensor(128.7102, device='cuda:3')
compute norm is  tensor(64.5494, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1448, device='cuda:3')
compute distance is  tensor(131.1448, device='cuda:3')
compute norm is  tensor(64.6490, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3469, device='cuda:3')
compute distance is  tensor(134.3469, device='cuda:3')
compute norm is  tensor(64.6461, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.5202, device='cuda:3')
distance x is tensor(107574.8828, device='cuda:3')
distance x is tensor(107574.8828, device='cuda:3')
________________________________
test distance is  tensor(107574.8828, device='cuda:3')
test distance1 is  tensor(107574.8828, device='cuda:3')
test similarity is  tensor(0.4467, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130103606867291.16
test entropy is  0.0
________________________________
cal ratio is  0.03529304750786793
distance x is tensor(3796.6511, device='cuda:3')
cal_distance is  tensor(3796.6511, device='cuda:3')
cal ratio is  0.18786429510595937
distance x is tensor(713.2592, device='cuda:3')
cal_distance is  tensor(713.2592, device='cuda:3')
cal ratio is  0.4334319376227601
distance x is tensor(309.1522, device='cuda:3')
cal_distance is  tensor(309.1522, device='cuda:3')
cal ratio is  0.6583523806178578
distance x is tensor(203.5328, device='cuda:3')
cal_distance is  tensor(203.5328, device='cuda:3')
cal ratio is  0.811385753026715
distance x is tensor(165.1446, device='cuda:3')
cal_distance is  tensor(165.1446, device='cuda:3')
cal ratio is  0.900766835463791
distance x is tensor(148.7573, device='cuda:3')
cal_distance is  tensor(148.7573, device='cuda:3')
cal ratio is  0.9490857421998394
distance x is tensor(141.1837, device='cuda:3')
cal_distance is  tensor(141.1837, device='cuda:3')
cal ratio is  0.9742094250487406
distance x is tensor(137.5426, device='cuda:3')
cal_distance is  tensor(137.5426, device='cuda:3')
distance x is tensor(137.5426, device='cuda:3')
return_distance is  tensor(137.5426, device='cuda:3')
distance x is tensor(137.5325, device='cuda:3')
distance x is tensor(137.5325, device='cuda:3')
________________________________
test distance is  tensor(137.5325, device='cuda:3')
test distance1 is  tensor(137.5325, device='cuda:3')
test similarity is  tensor(0.9818, device='cuda:3')
test acc is  0.29120000015633934
test loss is 31.340512049986103
test entropy is  0.048562949003059984
________________________________
0
distance x is tensor(137.5325, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.04991729298521127
avg test loss is  31.353702534998913
avg accuracy is  0.8833500001563219
solo acc is  0.29383333348967283
compute similarity  is  tensor(0.9818, device='cuda:3')
compute_distance is  tensor(137.5325, device='cuda:3')
compute_norm is  tensor(67.7906, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.4483, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9101753076002288
avg test loss is  1.4031383760575293
avg accuracy is  0.8189000001563246
solo acc is  0.307083333489673
compute similarity  is  tensor(0.9814, device='cuda:3')
compute_distance is  tensor(137.4483, device='cuda:3')
compute_norm is  tensor(67.3062, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.5954, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8760532128022932
avg test loss is  1.462980152193163
avg accuracy is  0.811550000156325
solo acc is  0.2509500001563383
compute similarity  is  tensor(0.9812, device='cuda:3')
compute_distance is  tensor(138.5954, device='cuda:3')
compute_norm is  tensor(66.9590, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.4596, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8663820101381111
avg test loss is  1.4409407203131392
avg accuracy is  0.8137833334896581
solo acc is  0.24451666682300474
compute similarity  is  tensor(0.9810, device='cuda:3')
compute_distance is  tensor(139.4596, device='cuda:3')
compute_norm is  tensor(66.6214, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.2206, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.862478948414707
avg test loss is  1.4103326970326113
avg accuracy is  0.8176666668229914
solo acc is  0.243050000156338
compute similarity  is  tensor(0.9808, device='cuda:3')
compute_distance is  tensor(140.2206, device='cuda:3')
compute_norm is  tensor(66.2878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.9679, device='cuda:3')
distance x is tensor(140.9679, device='cuda:3')
________________________________
test distance is  tensor(140.9679, device='cuda:3')
test distance1 is  tensor(140.9679, device='cuda:3')
test similarity is  tensor(0.9806, device='cuda:3')
test acc is  0.24913333348967157
test loss is 1.3851192981195348
test entropy is  0.8457020087155707
________________________________
cal ratio is  0.9749548304683022
distance x is tensor(137.4460, device='cuda:3')
cal_distance is  tensor(137.4460, device='cuda:3')
distance x is tensor(137.4460, device='cuda:3')
return_distance is  tensor(137.4460, device='cuda:3')
distance x is tensor(137.4372, device='cuda:3')
distance x is tensor(137.4372, device='cuda:3')
________________________________
test distance is  tensor(137.4372, device='cuda:3')
test distance1 is  tensor(137.4372, device='cuda:3')
test similarity is  tensor(0.9815, device='cuda:3')
test acc is  0.28885000015633927
test loss is 1.306407195037362
test entropy is  0.8831250462323618
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2136595249176025
mal norm is  tensor(651.2477, device='cuda:3')
distance x is tensor(137.4460, device='cuda:3')
mal distance is  tensor(137.4460, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(21.5939, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(464.4770, device='cuda:3')
user_param_square tensor(100.1492, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-6.9788, device='cuda:3')
score : tensor(-0.0912, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.5182, device='cuda:3')
user_param_square tensor(111.3826, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-10.9832, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.2695, device='cuda:3')
user_param_square tensor(117.2157, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(40.8897, device='cuda:3')
score : tensor(0.3875, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(452.6465, device='cuda:3')
user_param_square tensor(98.8655, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-33.1889, device='cuda:3')
score : tensor(-0.3533, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.6541, device='cuda:3')
user_param_square tensor(103.0374, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(24.6584, device='cuda:3')
score : tensor(0.2252, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.4652, device='cuda:3')
user_param_square tensor(110.5992, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-77.9185, device='cuda:3')
score : tensor(-0.8006, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(430.3111, device='cuda:3')
user_param_square tensor(96.3954, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-4.5131, device='cuda:3')
score : tensor(-0.0665, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.6363, device='cuda:3')
user_param_square tensor(107.2459, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-17.5180, device='cuda:3')
score : tensor(-0.1966, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2477, device='cuda:3')
user_param_square tensor(118.5873, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-11.6021, device='cuda:3')
score : tensor(-0.1374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.2374, device='cuda:3')
user_param_square tensor(111.3553, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-42.7407, device='cuda:3')
score : tensor(-0.4488, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.5244, device='cuda:3')
user_param_square tensor(108.1370, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-46.3351, device='cuda:3')
score : tensor(-0.4847, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2989, device='cuda:3')
user_param_square tensor(108.7120, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(0.6383, device='cuda:3')
score : tensor(-0.0150, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(551.8843, device='cuda:3')
user_param_square tensor(109.1665, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-53.1057, device='cuda:3')
score : tensor(-0.5525, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.0890, device='cuda:3')
user_param_square tensor(107.6932, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-41.3550, device='cuda:3')
score : tensor(-0.4349, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.1396, device='cuda:3')
user_param_square tensor(110.2740, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-23.3344, device='cuda:3')
score : tensor(-0.2547, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.5730, device='cuda:3')
user_param_square tensor(109.5307, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(13.1455, device='cuda:3')
score : tensor(0.1101, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.2015, device='cuda:3')
user_param_square tensor(114.6011, device='cuda:3')
global_param_square tensor(21.5939, device='cuda:3')
part1 is  tensor(-16.2531, device='cuda:3')
score : tensor(-0.1839, device='cuda:3')
len accept list 3
len all weights is 3
 
Avg Training Stats after 62 global rounds:
Train Accuracy: 89.48% 

Test Accuracy: 88.65% 


 | Global Training Round : 63 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5817152261734009
distance x is tensor(120.1608, device='cuda:3')
benign distance is  tensor(120.1608, device='cuda:3')
norm1 res is  tensor(0.1313, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.1853406429290771
distance x is tensor(139.9197, device='cuda:3')
benign distance is  tensor(139.9197, device='cuda:3')
norm1 res is  tensor(0.1513, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.21901848912239075
distance x is tensor(118.9295, device='cuda:3')
benign distance is  tensor(118.9295, device='cuda:3')
norm1 res is  tensor(0.1308, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.48907405138015747
distance x is tensor(125.7303, device='cuda:3')
benign distance is  tensor(125.7303, device='cuda:3')
norm1 res is  tensor(0.1386, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7811790704727173
distance x is tensor(114.4770, device='cuda:3')
benign distance is  tensor(114.4770, device='cuda:3')
norm1 res is  tensor(0.1256, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5071215629577637
distance x is tensor(143.2501, device='cuda:3')
benign distance is  tensor(143.2501, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.08737433701753616
distance x is tensor(112.0108, device='cuda:3')
benign distance is  tensor(112.0108, device='cuda:3')
norm1 res is  tensor(0.1160, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2594255805015564
distance x is tensor(120.6130, device='cuda:3')
benign distance is  tensor(120.6130, device='cuda:3')
norm1 res is  tensor(0.1339, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3198733329772949
distance x is tensor(138.0382, device='cuda:3')
benign distance is  tensor(138.0382, device='cuda:3')
norm1 res is  tensor(0.1524, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.20361480116844177
distance x is tensor(130.4099, device='cuda:3')
benign distance is  tensor(130.4099, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.4887814521789551
distance x is tensor(121.4248, device='cuda:3')
benign distance is  tensor(121.4248, device='cuda:3')
norm1 res is  tensor(0.1311, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.9879409074783325
distance x is tensor(130.8597, device='cuda:3')
benign distance is  tensor(130.8597, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.3328966796398163
distance x is tensor(129.9000, device='cuda:3')
benign distance is  tensor(129.9000, device='cuda:3')
norm1 res is  tensor(0.1429, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.21115610003471375
distance x is tensor(139.2102, device='cuda:3')
benign distance is  tensor(139.2102, device='cuda:3')
norm1 res is  tensor(0.1483, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.2048056572675705
distance x is tensor(125.9891, device='cuda:3')
benign distance is  tensor(125.9891, device='cuda:3')
norm1 res is  tensor(0.1392, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4309190809726715
distance x is tensor(139.0138, device='cuda:3')
benign distance is  tensor(139.0138, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(143.7083, device='cuda:3')
compute distance is  tensor(143.7083, device='cuda:3')
compute norm is  tensor(65.2876, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9073, device='cuda:3')
compute distance is  tensor(130.9073, device='cuda:3')
compute norm is  tensor(65.0030, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.9626, device='cuda:3')
compute distance is  tensor(145.9626, device='cuda:3')
compute norm is  tensor(65.2466, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5888, device='cuda:3')
compute distance is  tensor(130.5888, device='cuda:3')
compute norm is  tensor(64.9801, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1152, device='cuda:3')
compute distance is  tensor(131.1152, device='cuda:3')
compute norm is  tensor(64.8964, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1467, device='cuda:3')
compute distance is  tensor(142.1467, device='cuda:3')
compute norm is  tensor(65.1403, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.8594, device='cuda:3')
compute distance is  tensor(121.8594, device='cuda:3')
compute norm is  tensor(64.8197, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.5583, device='cuda:3')
compute distance is  tensor(143.5583, device='cuda:3')
compute norm is  tensor(65.3093, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7243, device='cuda:3')
compute distance is  tensor(136.7243, device='cuda:3')
compute norm is  tensor(65.0187, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6098, device='cuda:3')
compute distance is  tensor(133.6098, device='cuda:3')
compute norm is  tensor(65.1999, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5266, device='cuda:3')
compute distance is  tensor(135.5266, device='cuda:3')
compute norm is  tensor(65.1427, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4816, device='cuda:3')
compute distance is  tensor(145.4816, device='cuda:3')
compute norm is  tensor(65.1881, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.9626, device='cuda:3')
distance x is tensor(107580.1953, device='cuda:3')
distance x is tensor(107580.1953, device='cuda:3')
________________________________
test distance is  tensor(107580.1953, device='cuda:3')
test distance1 is  tensor(107580.1953, device='cuda:3')
test similarity is  tensor(0.4374, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130235126700909.72
test entropy is  0.0
________________________________
cal ratio is  0.036097791713681895
distance x is tensor(3883.4131, device='cuda:3')
cal_distance is  tensor(3883.4131, device='cuda:3')
cal ratio is  0.18999405493972027
distance x is tensor(737.8294, device='cuda:3')
cal_distance is  tensor(737.8294, device='cuda:3')
cal ratio is  0.43588188625389956
distance x is tensor(321.6093, device='cuda:3')
cal_distance is  tensor(321.6093, device='cuda:3')
cal ratio is  0.6602105717176163
distance x is tensor(212.3316, device='cuda:3')
cal_distance is  tensor(212.3316, device='cuda:3')
cal ratio is  0.8125300991058562
distance x is tensor(172.5268, device='cuda:3')
cal_distance is  tensor(172.5268, device='cuda:3')
cal ratio is  0.9014020224935129
distance x is tensor(155.5165, device='cuda:3')
cal_distance is  tensor(155.5165, device='cuda:3')
cal ratio is  0.9494203722786696
distance x is tensor(147.6508, device='cuda:3')
cal_distance is  tensor(147.6508, device='cuda:3')
cal ratio is  0.9743811646560713
distance x is tensor(143.8683, device='cuda:3')
cal_distance is  tensor(143.8683, device='cuda:3')
distance x is tensor(143.8683, device='cuda:3')
return_distance is  tensor(143.8683, device='cuda:3')
distance x is tensor(143.8581, device='cuda:3')
distance x is tensor(143.8581, device='cuda:3')
________________________________
test distance is  tensor(143.8581, device='cuda:3')
test distance1 is  tensor(143.8581, device='cuda:3')
test similarity is  tensor(0.9802, device='cuda:3')
test acc is  0.18703333348966902
test loss is 57.16456785385034
test entropy is  0.02374557136008002
________________________________
0
distance x is tensor(143.8581, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.023777178061061888
avg test loss is  57.19711384234398
avg accuracy is  0.864233333489656
solo acc is  0.18745000015633564
compute similarity  is  tensor(0.9802, device='cuda:3')
compute_distance is  tensor(143.8581, device='cuda:3')
compute_norm is  tensor(68.4952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.3663, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9290042912909217
avg test loss is  1.3790790136816151
avg accuracy is  0.820716666822991
solo acc is  0.32415000015634
compute similarity  is  tensor(0.9798, device='cuda:3')
compute_distance is  tensor(144.3663, device='cuda:3')
compute_norm is  tensor(67.9801, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.5661, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8658011026982305
avg test loss is  1.48311567154012
avg accuracy is  0.8160500001563247
solo acc is  0.2539833334896717
compute similarity  is  tensor(0.9795, device='cuda:3')
compute_distance is  tensor(145.5661, device='cuda:3')
compute_norm is  tensor(67.6266, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.4946, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8629166098800041
avg test loss is  1.4329847749362368
avg accuracy is  0.8173666668229912
solo acc is  0.25268333348967165
compute similarity  is  tensor(0.9793, device='cuda:3')
compute_distance is  tensor(146.4946, device='cuda:3')
compute_norm is  tensor(67.2797, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.2715, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8545118297722294
avg test loss is  1.4049126676150732
avg accuracy is  0.8197833334896578
solo acc is  0.2506500001563383
compute similarity  is  tensor(0.9791, device='cuda:3')
compute_distance is  tensor(147.2715, device='cuda:3')
compute_norm is  tensor(66.9389, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.0223, device='cuda:3')
distance x is tensor(148.0223, device='cuda:3')
________________________________
test distance is  tensor(148.0223, device='cuda:3')
test distance1 is  tensor(148.0223, device='cuda:3')
test similarity is  tensor(0.9789, device='cuda:3')
test acc is  0.24335000015633815
test loss is 1.3884084443293654
test entropy is  0.8569657205899895
________________________________
cal ratio is  0.973157851265542
distance x is tensor(144.0576, device='cuda:3')
cal_distance is  tensor(144.0576, device='cuda:3')
distance x is tensor(144.0576, device='cuda:3')
return_distance is  tensor(144.0576, device='cuda:3')
distance x is tensor(144.0489, device='cuda:3')
distance x is tensor(144.0489, device='cuda:3')
________________________________
test distance is  tensor(144.0489, device='cuda:3')
test distance1 is  tensor(144.0489, device='cuda:3')
test similarity is  tensor(0.9799, device='cuda:3')
test acc is  0.2884500001563392
test loss is 1.3018734669888705
test entropy is  0.8981867125039416
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.0503751039505005
mal norm is  tensor(682.6036, device='cuda:3')
distance x is tensor(144.0576, device='cuda:3')
mal distance is  tensor(144.0576, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(10.8221, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.1661, device='cuda:3')
user_param_square tensor(74.5945, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(24.4841, device='cuda:3')
score : tensor(0.2342, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.3510, device='cuda:3')
user_param_square tensor(80.4698, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-4.8393, device='cuda:3')
score : tensor(-0.0590, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.6641, device='cuda:3')
user_param_square tensor(74.0483, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(9.0198, device='cuda:3')
score : tensor(0.0796, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.9319, device='cuda:3')
user_param_square tensor(76.7938, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-5.4019, device='cuda:3')
score : tensor(-0.0646, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(485.1191, device='cuda:3')
user_param_square tensor(72.4568, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-16.6754, device='cuda:3')
score : tensor(-0.1774, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.5859, device='cuda:3')
user_param_square tensor(80.4184, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(9.2125, device='cuda:3')
score : tensor(0.0815, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(460.1897, device='cuda:3')
user_param_square tensor(70.5705, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-2.3519, device='cuda:3')
score : tensor(-0.0341, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(526.1952, device='cuda:3')
user_param_square tensor(75.4620, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(2.0435, device='cuda:3')
score : tensor(0.0098, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6036, device='cuda:3')
user_param_square tensor(85.9487, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-1.2569, device='cuda:3')
score : tensor(-0.0232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.5730, device='cuda:3')
user_param_square tensor(81.0876, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(4.1723, device='cuda:3')
score : tensor(0.0311, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.8049, device='cuda:3')
user_param_square tensor(84.1804, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-9.1821, device='cuda:3')
score : tensor(-0.1024, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.9702, device='cuda:3')
user_param_square tensor(82.5686, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-5.5766, device='cuda:3')
score : tensor(-0.0664, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.0368, device='cuda:3')
user_param_square tensor(79.8411, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-8.1279, device='cuda:3')
score : tensor(-0.0919, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.1632, device='cuda:3')
user_param_square tensor(83.2989, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(1.6052, device='cuda:3')
score : tensor(0.0054, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.1278, device='cuda:3')
user_param_square tensor(78.8928, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(-10.8279, device='cuda:3')
score : tensor(-0.1189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.0245, device='cuda:3')
user_param_square tensor(83.6788, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(8.3370, device='cuda:3')
score : tensor(0.0727, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.5807, device='cuda:3')
user_param_square tensor(81.2214, device='cuda:3')
global_param_square tensor(10.8221, device='cuda:3')
part1 is  tensor(7.5871, device='cuda:3')
score : tensor(0.0652, device='cuda:3')
accept
len accept list 8
len all weights is 8
 
Avg Training Stats after 63 global rounds:
Train Accuracy: 89.63% 

Test Accuracy: 88.87% 


 | Global Training Round : 64 | 

current submit client idx and staleness is  0 1
 benign loss is  1.1121995449066162
distance x is tensor(135.3799, device='cuda:3')
benign distance is  tensor(135.3799, device='cuda:3')
norm1 res is  tensor(0.1522, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4500117301940918
distance x is tensor(137.4917, device='cuda:3')
benign distance is  tensor(137.4917, device='cuda:3')
norm1 res is  tensor(0.1539, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.5596004724502563
distance x is tensor(105.7934, device='cuda:3')
benign distance is  tensor(105.7934, device='cuda:3')
norm1 res is  tensor(0.1197, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7815178632736206
distance x is tensor(110.1545, device='cuda:3')
benign distance is  tensor(110.1545, device='cuda:3')
norm1 res is  tensor(0.1200, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.23381206393241882
distance x is tensor(106.2479, device='cuda:3')
benign distance is  tensor(106.2479, device='cuda:3')
norm1 res is  tensor(0.1172, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.552029013633728
distance x is tensor(127.7322, device='cuda:3')
benign distance is  tensor(127.7322, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.12867075204849243
distance x is tensor(122.0557, device='cuda:3')
benign distance is  tensor(122.0557, device='cuda:3')
norm1 res is  tensor(0.1289, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5342925786972046
distance x is tensor(121.9225, device='cuda:3')
benign distance is  tensor(121.9225, device='cuda:3')
norm1 res is  tensor(0.1342, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.17799070477485657
distance x is tensor(122.6571, device='cuda:3')
benign distance is  tensor(122.6571, device='cuda:3')
norm1 res is  tensor(0.1349, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.620934009552002
distance x is tensor(137.9981, device='cuda:3')
benign distance is  tensor(137.9981, device='cuda:3')
norm1 res is  tensor(0.1537, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.36372432112693787
distance x is tensor(126.6854, device='cuda:3')
benign distance is  tensor(126.6854, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.1687607765197754
distance x is tensor(139.2747, device='cuda:3')
benign distance is  tensor(139.2747, device='cuda:3')
norm1 res is  tensor(0.1510, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.3507305383682251
distance x is tensor(117.5251, device='cuda:3')
benign distance is  tensor(117.5251, device='cuda:3')
norm1 res is  tensor(0.1280, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.35355958342552185
distance x is tensor(124.1083, device='cuda:3')
benign distance is  tensor(124.1083, device='cuda:3')
norm1 res is  tensor(0.1364, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.20238466560840607
distance x is tensor(119.5638, device='cuda:3')
benign distance is  tensor(119.5638, device='cuda:3')
norm1 res is  tensor(0.1318, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.2523227035999298
distance x is tensor(119.5720, device='cuda:3')
benign distance is  tensor(119.5720, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(124.1901, device='cuda:3')
compute distance is  tensor(124.1901, device='cuda:3')
compute norm is  tensor(64.8711, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.4213, device='cuda:3')
compute distance is  tensor(114.4213, device='cuda:3')
compute norm is  tensor(64.7091, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0227, device='cuda:3')
compute distance is  tensor(123.0227, device='cuda:3')
compute norm is  tensor(64.8914, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0070, device='cuda:3')
compute distance is  tensor(127.0070, device='cuda:3')
compute norm is  tensor(64.8882, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.3196, device='cuda:3')
compute distance is  tensor(128.3196, device='cuda:3')
compute norm is  tensor(64.9646, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9117, device='cuda:3')
compute distance is  tensor(136.9117, device='cuda:3')
compute norm is  tensor(65.1995, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.8225, device='cuda:3')
compute distance is  tensor(121.8225, device='cuda:3')
compute norm is  tensor(64.9344, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.9928, device='cuda:3')
compute distance is  tensor(129.9928, device='cuda:3')
compute norm is  tensor(65.0263, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.5036, device='cuda:3')
compute distance is  tensor(143.5036, device='cuda:3')
compute norm is  tensor(65.1764, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.4531, device='cuda:3')
compute distance is  tensor(121.4531, device='cuda:3')
compute norm is  tensor(65.0215, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1304, device='cuda:3')
compute distance is  tensor(143.1304, device='cuda:3')
compute norm is  tensor(65.2194, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.9077, device='cuda:3')
compute distance is  tensor(129.9077, device='cuda:3')
compute norm is  tensor(65.1095, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(143.5036, device='cuda:3')
distance x is tensor(107582.4609, device='cuda:3')
distance x is tensor(107582.4609, device='cuda:3')
________________________________
test distance is  tensor(107582.4609, device='cuda:3')
test distance1 is  tensor(107582.4609, device='cuda:3')
test similarity is  tensor(0.4361, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130010122779903.45
test entropy is  0.0
________________________________
cal ratio is  0.03579206143851001
distance x is tensor(3850.6035, device='cuda:3')
cal_distance is  tensor(3850.6035, device='cuda:3')
cal ratio is  0.18918776343872032
distance x is tensor(728.4911, device='cuda:3')
cal_distance is  tensor(728.4911, device='cuda:3')
cal ratio is  0.4349559795712014
distance x is tensor(316.8645, device='cuda:3')
cal_distance is  tensor(316.8645, device='cuda:3')
cal ratio is  0.659508919725334
distance x is tensor(208.9767, device='cuda:3')
cal_distance is  tensor(208.9767, device='cuda:3')
cal ratio is  0.812098219772429
distance x is tensor(169.7106, device='cuda:3')
cal_distance is  tensor(169.7106, device='cuda:3')
cal ratio is  0.9011622877863549
distance x is tensor(152.9373, device='cuda:3')
cal_distance is  tensor(152.9373, device='cuda:3')
cal ratio is  0.9492941083593852
distance x is tensor(145.1827, device='cuda:3')
cal_distance is  tensor(145.1827, device='cuda:3')
cal ratio is  0.9743163325453202
distance x is tensor(141.4540, device='cuda:3')
cal_distance is  tensor(141.4540, device='cuda:3')
distance x is tensor(141.4540, device='cuda:3')
return_distance is  tensor(141.4540, device='cuda:3')
distance x is tensor(141.4438, device='cuda:3')
distance x is tensor(141.4438, device='cuda:3')
________________________________
test distance is  tensor(141.4438, device='cuda:3')
test distance1 is  tensor(141.4438, device='cuda:3')
test similarity is  tensor(0.9807, device='cuda:3')
test acc is  0.19428333348966945
test loss is 52.2505548473106
test entropy is  0.028280500034152226
________________________________
0
distance x is tensor(141.4438, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.028069630918776685
avg test loss is  52.412095730746984
avg accuracy is  0.8755500001563222
solo acc is  0.1916666668230026
compute similarity  is  tensor(0.9807, device='cuda:3')
compute_distance is  tensor(141.4438, device='cuda:3')
compute_norm is  tensor(68.3164, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.3456, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9403417294086424
avg test loss is  1.400993010001396
avg accuracy is  0.8211500001563244
solo acc is  0.3051666668230063
compute similarity  is  tensor(0.9805, device='cuda:3')
compute_distance is  tensor(141.3456, device='cuda:3')
compute_norm is  tensor(67.8963, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.3455, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8770852968382683
avg test loss is  1.4753210299304809
avg accuracy is  0.8199333334896578
solo acc is  0.252816666823005
compute similarity  is  tensor(0.9803, device='cuda:3')
compute_distance is  tensor(142.3455, device='cuda:3')
compute_norm is  tensor(67.5517, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.1085, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.886332887576333
avg test loss is  1.434687398898322
avg accuracy is  0.823516666822991
solo acc is  0.24961666682300487
compute similarity  is  tensor(0.9801, device='cuda:3')
compute_distance is  tensor(143.1085, device='cuda:3')
compute_norm is  tensor(67.2134, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.7949, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8779909790578936
avg test loss is  1.4158677846383947
avg accuracy is  0.8237500001563242
solo acc is  0.2441500001563381
compute similarity  is  tensor(0.9800, device='cuda:3')
compute_distance is  tensor(143.7949, device='cuda:3')
compute_norm is  tensor(66.8817, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.4562, device='cuda:3')
distance x is tensor(144.4562, device='cuda:3')
________________________________
test distance is  tensor(144.4562, device='cuda:3')
test distance1 is  tensor(144.4562, device='cuda:3')
test similarity is  tensor(0.9798, device='cuda:3')
test acc is  0.24113333348967128
test loss is 1.3994938935806502
test entropy is  0.8730900121777296
________________________________
cal ratio is  0.9767632432224856
distance x is tensor(141.1084, device='cuda:3')
cal_distance is  tensor(141.1084, device='cuda:3')
distance x is tensor(141.1084, device='cuda:3')
return_distance is  tensor(141.1084, device='cuda:3')
distance x is tensor(141.0994, device='cuda:3')
distance x is tensor(141.0994, device='cuda:3')
________________________________
test distance is  tensor(141.0994, device='cuda:3')
test distance1 is  tensor(141.0994, device='cuda:3')
test similarity is  tensor(0.9807, device='cuda:3')
test acc is  0.27693333348967236
test loss is 1.3289783672610325
test entropy is  0.9096899166671452
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.218756914138794
mal norm is  tensor(669.3119, device='cuda:3')
distance x is tensor(141.1084, device='cuda:3')
mal distance is  tensor(141.1084, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(15.2370, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.9196, device='cuda:3')
user_param_square tensor(94.8884, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-24.0245, device='cuda:3')
score : tensor(-0.2553, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.4597, device='cuda:3')
user_param_square tensor(95.5717, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(10.9127, device='cuda:3')
score : tensor(0.0941, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(457.3532, device='cuda:3')
user_param_square tensor(83.4786, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-26.1972, device='cuda:3')
score : tensor(-0.2770, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.5514, device='cuda:3')
user_param_square tensor(84.7644, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-23.1558, device='cuda:3')
score : tensor(-0.2466, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(451.1699, device='cuda:3')
user_param_square tensor(82.9123, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(15.0150, device='cuda:3')
score : tensor(0.1351, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.5323, device='cuda:3')
user_param_square tensor(91.5884, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-39.5369, device='cuda:3')
score : tensor(-0.4104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(509.2757, device='cuda:3')
user_param_square tensor(88.0898, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(1.8522, device='cuda:3')
score : tensor(0.0035, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.8718, device='cuda:3')
user_param_square tensor(89.8534, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-31.7511, device='cuda:3')
score : tensor(-0.3325, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.3119, device='cuda:3')
user_param_square tensor(100.9865, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-33.4531, device='cuda:3')
score : tensor(-0.3496, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.9858, device='cuda:3')
user_param_square tensor(97.2725, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-3.2773, device='cuda:3')
score : tensor(-0.0478, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.9156, device='cuda:3')
user_param_square tensor(92.9412, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(0.4347, device='cuda:3')
score : tensor(-0.0107, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.4553, device='cuda:3')
user_param_square tensor(95.4916, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-2.8991, device='cuda:3')
score : tensor(-0.0440, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.0660, device='cuda:3')
user_param_square tensor(96.6502, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-5.6793, device='cuda:3')
score : tensor(-0.0718, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.0068, device='cuda:3')
user_param_square tensor(94.5738, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-20.5931, device='cuda:3')
score : tensor(-0.2210, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.5137, device='cuda:3')
user_param_square tensor(94.6951, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-3.2188, device='cuda:3')
score : tensor(-0.0472, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.9879, device='cuda:3')
user_param_square tensor(95.0543, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-8.6529, device='cuda:3')
score : tensor(-0.1016, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.3706, device='cuda:3')
user_param_square tensor(96.9889, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(4.6199, device='cuda:3')
score : tensor(0.0312, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.6188, device='cuda:3')
user_param_square tensor(97.5566, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-7.5535, device='cuda:3')
score : tensor(-0.0906, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.2256, device='cuda:3')
user_param_square tensor(94.9932, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-22.7167, device='cuda:3')
score : tensor(-0.2422, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.0037, device='cuda:3')
user_param_square tensor(90.7923, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-24.4943, device='cuda:3')
score : tensor(-0.2600, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.6932, device='cuda:3')
user_param_square tensor(94.1447, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-47.1051, device='cuda:3')
score : tensor(-0.4861, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.6979, device='cuda:3')
user_param_square tensor(94.3876, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-9.7581, device='cuda:3')
score : tensor(-0.1126, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.9671, device='cuda:3')
user_param_square tensor(96.0890, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-9.3865, device='cuda:3')
score : tensor(-0.1089, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4687, device='cuda:3')
user_param_square tensor(94.4498, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-12.3645, device='cuda:3')
score : tensor(-0.1387, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.4573, device='cuda:3')
user_param_square tensor(97.4658, device='cuda:3')
global_param_square tensor(15.2370, device='cuda:3')
part1 is  tensor(-12.4675, device='cuda:3')
score : tensor(-0.1397, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 64 global rounds:
Train Accuracy: 89.43% 

Test Accuracy: 88.64% 


 | Global Training Round : 65 | 

current submit client idx and staleness is  0 1
 benign loss is  0.21861031651496887
distance x is tensor(111.2490, device='cuda:3')
benign distance is  tensor(111.2490, device='cuda:3')
norm1 res is  tensor(0.1270, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.1019036769866943
distance x is tensor(119.1441, device='cuda:3')
benign distance is  tensor(119.1441, device='cuda:3')
norm1 res is  tensor(0.1314, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.07932301610708237
distance x is tensor(104.7936, device='cuda:3')
benign distance is  tensor(104.7936, device='cuda:3')
norm1 res is  tensor(0.1158, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6996670961380005
distance x is tensor(117.2176, device='cuda:3')
benign distance is  tensor(117.2176, device='cuda:3')
norm1 res is  tensor(0.1275, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4313552975654602
distance x is tensor(105.0665, device='cuda:3')
benign distance is  tensor(105.0665, device='cuda:3')
norm1 res is  tensor(0.1190, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6712616086006165
distance x is tensor(126.9973, device='cuda:3')
benign distance is  tensor(126.9973, device='cuda:3')
norm1 res is  tensor(0.1412, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5503664612770081
distance x is tensor(84.3001, device='cuda:3')
benign distance is  tensor(84.3001, device='cuda:3')
norm1 res is  tensor(0.0905, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3923170566558838
distance x is tensor(122.9903, device='cuda:3')
benign distance is  tensor(122.9903, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.2696552276611328
distance x is tensor(131.3731, device='cuda:3')
benign distance is  tensor(131.3731, device='cuda:3')
norm1 res is  tensor(0.1457, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.7011653184890747
distance x is tensor(123.5521, device='cuda:3')
benign distance is  tensor(123.5521, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.48996502161026
distance x is tensor(119.7567, device='cuda:3')
benign distance is  tensor(119.7567, device='cuda:3')
norm1 res is  tensor(0.1324, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6377007365226746
distance x is tensor(147.2897, device='cuda:3')
benign distance is  tensor(147.2897, device='cuda:3')
norm1 res is  tensor(0.1607, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.6225589513778687
distance x is tensor(126.7436, device='cuda:3')
benign distance is  tensor(126.7436, device='cuda:3')
norm1 res is  tensor(0.1415, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.13137289881706238
distance x is tensor(135.7014, device='cuda:3')
benign distance is  tensor(135.7014, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.1052064523100853
distance x is tensor(123.5676, device='cuda:3')
benign distance is  tensor(123.5676, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.2999502420425415
distance x is tensor(124.2669, device='cuda:3')
benign distance is  tensor(124.2669, device='cuda:3')
norm1 res is  tensor(0.1372, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.11595182120800018
distance x is tensor(133.1066, device='cuda:3')
benign distance is  tensor(133.1066, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  1.8128639459609985
distance x is tensor(130.5381, device='cuda:3')
benign distance is  tensor(130.5381, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.22107365727424622
distance x is tensor(129.9890, device='cuda:3')
benign distance is  tensor(129.9890, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.4249492585659027
distance x is tensor(136.7904, device='cuda:3')
benign distance is  tensor(136.7904, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.6763489246368408
distance x is tensor(135.0961, device='cuda:3')
benign distance is  tensor(135.0961, device='cuda:3')
norm1 res is  tensor(0.1489, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.43986010551452637
distance x is tensor(126.4714, device='cuda:3')
benign distance is  tensor(126.4714, device='cuda:3')
norm1 res is  tensor(0.1421, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.725519061088562
distance x is tensor(127.8817, device='cuda:3')
benign distance is  tensor(127.8817, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.15124106407165527
distance x is tensor(124.8289, device='cuda:3')
benign distance is  tensor(124.8289, device='cuda:3')
norm1 res is  tensor(0.1369, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(129.1202, device='cuda:3')
compute distance is  tensor(129.1202, device='cuda:3')
compute norm is  tensor(65.2283, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4613, device='cuda:3')
compute distance is  tensor(136.4613, device='cuda:3')
compute norm is  tensor(65.3283, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.0893, device='cuda:3')
compute distance is  tensor(135.0893, device='cuda:3')
compute norm is  tensor(65.3738, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9824, device='cuda:3')
compute distance is  tensor(128.9824, device='cuda:3')
compute norm is  tensor(65.2197, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.5587, device='cuda:3')
compute distance is  tensor(146.5587, device='cuda:3')
compute norm is  tensor(65.3762, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.5055, device='cuda:3')
compute distance is  tensor(140.5055, device='cuda:3')
compute norm is  tensor(65.4562, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5651, device='cuda:3')
compute distance is  tensor(119.5651, device='cuda:3')
compute norm is  tensor(65.1177, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9620, device='cuda:3')
compute distance is  tensor(116.9620, device='cuda:3')
compute norm is  tensor(64.9962, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.0344, device='cuda:3')
compute distance is  tensor(156.0344, device='cuda:3')
compute norm is  tensor(65.6355, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6103, device='cuda:3')
compute distance is  tensor(139.6103, device='cuda:3')
compute norm is  tensor(65.5513, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0534, device='cuda:3')
compute distance is  tensor(139.0534, device='cuda:3')
compute norm is  tensor(65.4860, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9381, device='cuda:3')
compute distance is  tensor(126.9381, device='cuda:3')
compute norm is  tensor(65.2210, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(156.0344, device='cuda:3')
distance x is tensor(107584.9609, device='cuda:3')
distance x is tensor(107584.9609, device='cuda:3')
________________________________
test distance is  tensor(107584.9609, device='cuda:3')
test distance1 is  tensor(107584.9609, device='cuda:3')
test similarity is  tensor(0.4311, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130116945111734.31
test entropy is  0.0
________________________________
cal ratio is  0.03732161405840432
distance x is tensor(4015.2502, device='cuda:3')
cal_distance is  tensor(4015.2502, device='cuda:3')
cal ratio is  0.19318788695103803
distance x is tensor(775.7018, device='cuda:3')
cal_distance is  tensor(775.7018, device='cuda:3')
cal ratio is  0.4395302769459986
distance x is tensor(340.9473, device='cuda:3')
cal_distance is  tensor(340.9473, device='cuda:3')
cal ratio is  0.6629679859452764
distance x is tensor(226.0389, device='cuda:3')
cal_distance is  tensor(226.0389, device='cuda:3')
cal ratio is  0.8142253762873952
distance x is tensor(184.0475, device='cuda:3')
cal_distance is  tensor(184.0475, device='cuda:3')
cal ratio is  0.9023420222410364
distance x is tensor(166.0743, device='cuda:3')
cal_distance is  tensor(166.0743, device='cuda:3')
cal ratio is  0.9499154675168227
distance x is tensor(157.7569, device='cuda:3')
cal_distance is  tensor(157.7569, device='cuda:3')
cal ratio is  0.9746351932874715
distance x is tensor(153.7555, device='cuda:3')
cal_distance is  tensor(153.7555, device='cuda:3')
distance x is tensor(153.7555, device='cuda:3')
return_distance is  tensor(153.7555, device='cuda:3')
distance x is tensor(153.7453, device='cuda:3')
distance x is tensor(153.7453, device='cuda:3')
________________________________
test distance is  tensor(153.7453, device='cuda:3')
test distance1 is  tensor(153.7453, device='cuda:3')
test similarity is  tensor(0.9777, device='cuda:3')
test acc is  0.13248333348966523
test loss is 91.869666890549
test entropy is  0.01019502731485492
________________________________
0
distance x is tensor(153.7453, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.010530009918499353
avg test loss is  91.91715471475109
avg accuracy is  0.8661000001563226
solo acc is  0.13348333348966523
compute similarity  is  tensor(0.9777, device='cuda:3')
compute_distance is  tensor(153.7453, device='cuda:3')
compute_norm is  tensor(69.0058, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.5355, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9675366772390378
avg test loss is  1.4620054964063518
avg accuracy is  0.7954833334896589
solo acc is  0.2912500001563393
compute similarity  is  tensor(0.9776, device='cuda:3')
compute_distance is  tensor(153.5355, device='cuda:3')
compute_norm is  tensor(68.7139, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(153.5355, device='cuda:3')
distance x is tensor(153.5355, device='cuda:3')
________________________________
test distance is  tensor(153.5355, device='cuda:3')
test distance1 is  tensor(153.5355, device='cuda:3')
test similarity is  tensor(0.9776, device='cuda:3')
test acc is  0.2930666668230061
test loss is 1.4554500910264851
test entropy is  0.9695552295204927
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.4780573844909668
mal norm is  tensor(771.3855, device='cuda:3')
distance x is tensor(153.5444, device='cuda:3')
mal distance is  tensor(153.5444, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(12.3465, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.7651, device='cuda:3')
user_param_square tensor(78.5514, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(16.0880, device='cuda:3')
score : tensor(0.1487, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.2722, device='cuda:3')
user_param_square tensor(79.6834, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-9.5748, device='cuda:3')
score : tensor(-0.1079, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(450.3734, device='cuda:3')
user_param_square tensor(74.5689, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(8.6998, device='cuda:3')
score : tensor(0.0749, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(504.1190, device='cuda:3')
user_param_square tensor(78.8929, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-26.0049, device='cuda:3')
score : tensor(-0.2722, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(461.6595, device='cuda:3')
user_param_square tensor(75.4974, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(3.4000, device='cuda:3')
score : tensor(0.0219, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.0514, device='cuda:3')
user_param_square tensor(82.1836, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-20.7420, device='cuda:3')
score : tensor(-0.2196, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(351.2032, device='cuda:3')
user_param_square tensor(65.8492, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(9.4315, device='cuda:3')
score : tensor(0.0822, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.5812, device='cuda:3')
user_param_square tensor(81.9978, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(2.9864, device='cuda:3')
score : tensor(0.0177, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.3855, device='cuda:3')
user_param_square tensor(97.5903, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-18.3048, device='cuda:3')
score : tensor(-0.1952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.2766, device='cuda:3')
user_param_square tensor(86.6606, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(14.8449, device='cuda:3')
score : tensor(0.1363, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.5541, device='cuda:3')
user_param_square tensor(88.3032, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(24.3952, device='cuda:3')
score : tensor(0.2318, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.1276, device='cuda:3')
user_param_square tensor(86.7924, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-5.6253, device='cuda:3')
score : tensor(-0.0684, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.8879, device='cuda:3')
user_param_square tensor(84.2486, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(10.6512, device='cuda:3')
score : tensor(0.0944, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.1826, device='cuda:3')
user_param_square tensor(88.3471, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(0.5588, device='cuda:3')
score : tensor(-0.0066, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.1664, device='cuda:3')
user_param_square tensor(84.7803, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-2.6328, device='cuda:3')
score : tensor(-0.0385, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8339, device='cuda:3')
user_param_square tensor(85.6977, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(-5.0399, device='cuda:3')
score : tensor(-0.0625, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.3304, device='cuda:3')
user_param_square tensor(84.5735, device='cuda:3')
global_param_square tensor(12.3465, device='cuda:3')
part1 is  tensor(6.0839, device='cuda:3')
score : tensor(0.0487, device='cuda:3')
accept
len accept list 9
len all weights is 9
 
Avg Training Stats after 65 global rounds:
Train Accuracy: 89.77% 

Test Accuracy: 89.04% 


 | Global Training Round : 66 | 

current submit client idx and staleness is  0 1
 benign loss is  0.26736652851104736
distance x is tensor(117.7667, device='cuda:3')
benign distance is  tensor(117.7667, device='cuda:3')
norm1 res is  tensor(0.1312, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.2190200388431549
distance x is tensor(116.1705, device='cuda:3')
benign distance is  tensor(116.1705, device='cuda:3')
norm1 res is  tensor(0.1306, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.530171275138855
distance x is tensor(100.4220, device='cuda:3')
benign distance is  tensor(100.4220, device='cuda:3')
norm1 res is  tensor(0.1117, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3566487431526184
distance x is tensor(128.1987, device='cuda:3')
benign distance is  tensor(128.1987, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4036591649055481
distance x is tensor(102.6756, device='cuda:3')
benign distance is  tensor(102.6756, device='cuda:3')
norm1 res is  tensor(0.1103, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.47789278626441956
distance x is tensor(135.9301, device='cuda:3')
benign distance is  tensor(135.9301, device='cuda:3')
norm1 res is  tensor(0.1492, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.3982704281806946
distance x is tensor(85.2282, device='cuda:3')
benign distance is  tensor(85.2282, device='cuda:3')
norm1 res is  tensor(0.0916, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2775864005088806
distance x is tensor(114.0967, device='cuda:3')
benign distance is  tensor(114.0967, device='cuda:3')
norm1 res is  tensor(0.1306, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.23228506743907928
distance x is tensor(119.2693, device='cuda:3')
benign distance is  tensor(119.2693, device='cuda:3')
norm1 res is  tensor(0.1314, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.0376187302172184
distance x is tensor(126.4678, device='cuda:3')
benign distance is  tensor(126.4678, device='cuda:3')
norm1 res is  tensor(0.1401, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.8837054967880249
distance x is tensor(120.9608, device='cuda:3')
benign distance is  tensor(120.9608, device='cuda:3')
norm1 res is  tensor(0.1353, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.24050672352313995
distance x is tensor(127.1484, device='cuda:3')
benign distance is  tensor(127.1484, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.29971805214881897
distance x is tensor(129.5148, device='cuda:3')
benign distance is  tensor(129.5148, device='cuda:3')
norm1 res is  tensor(0.1415, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.34160906076431274
distance x is tensor(130.3613, device='cuda:3')
benign distance is  tensor(130.3613, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.5089435577392578
distance x is tensor(132.4974, device='cuda:3')
benign distance is  tensor(132.4974, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.13074877858161926
distance x is tensor(126.0342, device='cuda:3')
benign distance is  tensor(126.0342, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(129.4804, device='cuda:3')
compute distance is  tensor(129.4804, device='cuda:3')
compute norm is  tensor(65.0085, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3073, device='cuda:3')
compute distance is  tensor(131.3073, device='cuda:3')
compute norm is  tensor(65.0085, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7474, device='cuda:3')
compute distance is  tensor(127.7474, device='cuda:3')
compute norm is  tensor(65.1205, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5969, device='cuda:3')
compute distance is  tensor(135.5969, device='cuda:3')
compute norm is  tensor(65.1342, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9494, device='cuda:3')
compute distance is  tensor(136.9494, device='cuda:3')
compute norm is  tensor(65.2639, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3322, device='cuda:3')
compute distance is  tensor(129.3322, device='cuda:3')
compute norm is  tensor(65.1478, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.6449, device='cuda:3')
compute distance is  tensor(118.6449, device='cuda:3')
compute norm is  tensor(65.0039, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3416, device='cuda:3')
compute distance is  tensor(134.3416, device='cuda:3')
compute norm is  tensor(65.1013, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.1034, device='cuda:3')
compute distance is  tensor(145.1034, device='cuda:3')
compute norm is  tensor(65.2701, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2800, device='cuda:3')
compute distance is  tensor(130.2800, device='cuda:3')
compute norm is  tensor(65.1545, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.0469, device='cuda:3')
compute distance is  tensor(138.0469, device='cuda:3')
compute norm is  tensor(65.2420, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.7296, device='cuda:3')
compute distance is  tensor(122.7296, device='cuda:3')
compute norm is  tensor(65.0536, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.1034, device='cuda:3')
distance x is tensor(107583.3516, device='cuda:3')
distance x is tensor(107583.3516, device='cuda:3')
________________________________
test distance is  tensor(107583.3516, device='cuda:3')
test distance1 is  tensor(107583.3516, device='cuda:3')
test similarity is  tensor(0.4337, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130081514323409.06
test entropy is  0.0
________________________________
cal ratio is  0.03599087293399144
distance x is tensor(3872.0239, device='cuda:3')
cal_distance is  tensor(3872.0239, device='cuda:3')
cal ratio is  0.1897124742064666
distance x is tensor(734.5754, device='cuda:3')
cal_distance is  tensor(734.5754, device='cuda:3')
cal ratio is  0.43555872787290556
distance x is tensor(319.9536, device='cuda:3')
cal_distance is  tensor(319.9536, device='cuda:3')
cal ratio is  0.6599657549336528
distance x is tensor(211.1602, device='cuda:3')
cal_distance is  tensor(211.1602, device='cuda:3')
cal ratio is  0.8123793884842039
distance x is tensor(171.5431, device='cuda:3')
cal_distance is  tensor(171.5431, device='cuda:3')
cal ratio is  0.9013183814096863
distance x is tensor(154.6155, device='cuda:3')
cal_distance is  tensor(154.6155, device='cuda:3')
cal ratio is  0.9493763265292837
distance x is tensor(146.7886, device='cuda:3')
cal_distance is  tensor(146.7886, device='cuda:3')
cal ratio is  0.9743585458776832
distance x is tensor(143.0248, device='cuda:3')
cal_distance is  tensor(143.0248, device='cuda:3')
distance x is tensor(143.0248, device='cuda:3')
return_distance is  tensor(143.0248, device='cuda:3')
distance x is tensor(143.0146, device='cuda:3')
distance x is tensor(143.0146, device='cuda:3')
________________________________
test distance is  tensor(143.0146, device='cuda:3')
test distance1 is  tensor(143.0146, device='cuda:3')
test similarity is  tensor(0.9803, device='cuda:3')
test acc is  0.23898333348967132
test loss is 46.081456885917355
test entropy is  0.032127382065910946
________________________________
0
distance x is tensor(143.0146, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.03158690297696516
avg test loss is  46.27049064839573
avg accuracy is  0.8791166668229888
solo acc is  0.24021666682300472
compute similarity  is  tensor(0.9803, device='cuda:3')
compute_distance is  tensor(143.0146, device='cuda:3')
compute_norm is  tensor(68.5084, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.1504, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9480180860455356
avg test loss is  1.3859925972881602
avg accuracy is  0.8282166668229909
solo acc is  0.31733333348967324
compute similarity  is  tensor(0.9800, device='cuda:3')
compute_distance is  tensor(143.1504, device='cuda:3')
compute_norm is  tensor(68.0647, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.2117, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8914161554531757
avg test loss is  1.4686651620020998
avg accuracy is  0.8274833334896574
solo acc is  0.255116666823005
compute similarity  is  tensor(0.9798, device='cuda:3')
compute_distance is  tensor(144.2117, device='cuda:3')
compute_norm is  tensor(67.7158, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.0182, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8787150554565478
avg test loss is  1.4491799049285938
avg accuracy is  0.8274833334896575
solo acc is  0.2456666668230048
compute similarity  is  tensor(0.9796, device='cuda:3')
compute_distance is  tensor(145.0182, device='cuda:3')
compute_norm is  tensor(67.3745, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.7297, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.873906868035351
avg test loss is  1.4308507719527939
avg accuracy is  0.829950000156324
solo acc is  0.24151666682300463
compute similarity  is  tensor(0.9794, device='cuda:3')
compute_distance is  tensor(145.7297, device='cuda:3')
compute_norm is  tensor(67.0393, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.4151, device='cuda:3')
distance x is tensor(146.4151, device='cuda:3')
________________________________
test distance is  tensor(146.4151, device='cuda:3')
test distance1 is  tensor(146.4151, device='cuda:3')
test similarity is  tensor(0.9793, device='cuda:3')
test acc is  0.23633333348967103
test loss is 1.4216811903504167
test entropy is  0.8543497304291104
________________________________
cal ratio is  0.9756003917276292
distance x is tensor(142.8513, device='cuda:3')
cal_distance is  tensor(142.8513, device='cuda:3')
distance x is tensor(142.8513, device='cuda:3')
return_distance is  tensor(142.8513, device='cuda:3')
distance x is tensor(142.8425, device='cuda:3')
distance x is tensor(142.8425, device='cuda:3')
________________________________
test distance is  tensor(142.8425, device='cuda:3')
test distance1 is  tensor(142.8425, device='cuda:3')
test similarity is  tensor(0.9802, device='cuda:3')
test acc is  0.27906666682300574
test loss is 1.3396744431336043
test entropy is  0.8916094137280226
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2641273736953735
mal norm is  tensor(677.9791, device='cuda:3')
distance x is tensor(142.8513, device='cuda:3')
mal distance is  tensor(142.8513, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(11.9257, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.3381, device='cuda:3')
user_param_square tensor(78.6986, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-2.0589, device='cuda:3')
score : tensor(-0.0323, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.4219, device='cuda:3')
user_param_square tensor(77.7138, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(0.6336, device='cuda:3')
score : tensor(-0.0054, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(432.2102, device='cuda:3')
user_param_square tensor(71.7942, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-7.0505, device='cuda:3')
score : tensor(-0.0822, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.3059, device='cuda:3')
user_param_square tensor(79.9739, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(5.2504, device='cuda:3')
score : tensor(0.0408, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(433.3057, device='cuda:3')
user_param_square tensor(71.8852, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-5.9026, device='cuda:3')
score : tensor(-0.0708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.9899, device='cuda:3')
user_param_square tensor(83.5250, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-9.7565, device='cuda:3')
score : tensor(-0.1093, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(352.9351, device='cuda:3')
user_param_square tensor(64.8768, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(0.3967, device='cuda:3')
score : tensor(-0.0078, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(509.9917, device='cuda:3')
user_param_square tensor(77.9873, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-21.5833, device='cuda:3')
score : tensor(-0.2276, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9791, device='cuda:3')
user_param_square tensor(89.9187, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-1.2914, device='cuda:3')
score : tensor(-0.0246, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.8773, device='cuda:3')
user_param_square tensor(88.7102, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-5.9641, device='cuda:3')
score : tensor(-0.0714, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.8528, device='cuda:3')
user_param_square tensor(85.6303, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-22.9680, device='cuda:3')
score : tensor(-0.2414, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.5236, device='cuda:3')
user_param_square tensor(82.7744, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-10.8115, device='cuda:3')
score : tensor(-0.1198, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.2053, device='cuda:3')
user_param_square tensor(85.5155, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-3.2850, device='cuda:3')
score : tensor(-0.0446, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.5804, device='cuda:3')
user_param_square tensor(82.5621, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(1.2423, device='cuda:3')
score : tensor(0.0007, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.4429, device='cuda:3')
user_param_square tensor(82.9125, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-8.7400, device='cuda:3')
score : tensor(-0.0991, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.5577, device='cuda:3')
user_param_square tensor(83.7793, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-14.4606, device='cuda:3')
score : tensor(-0.1563, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.5076, device='cuda:3')
user_param_square tensor(83.7757, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-8.6140, device='cuda:3')
score : tensor(-0.0979, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.2795, device='cuda:3')
user_param_square tensor(82.7568, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(9.2691, device='cuda:3')
score : tensor(0.0810, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.0158, device='cuda:3')
user_param_square tensor(87.3650, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-13.8899, device='cuda:3')
score : tensor(-0.1506, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.5807, device='cuda:3')
user_param_square tensor(83.4957, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(1.7354, device='cuda:3')
score : tensor(0.0056, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.4040, device='cuda:3')
user_param_square tensor(86.5688, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(0.8691, device='cuda:3')
score : tensor(-0.0030, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.1971, device='cuda:3')
user_param_square tensor(80.9294, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-6.7032, device='cuda:3')
score : tensor(-0.0788, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.7415, device='cuda:3')
user_param_square tensor(82.6459, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-15.2094, device='cuda:3')
score : tensor(-0.1638, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.9097, device='cuda:3')
user_param_square tensor(81.9335, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-2.3999, device='cuda:3')
score : tensor(-0.0357, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.8235, device='cuda:3')
user_param_square tensor(81.8544, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-27.5770, device='cuda:3')
score : tensor(-0.2875, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.1451, device='cuda:3')
user_param_square tensor(83.7499, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-0.7131, device='cuda:3')
score : tensor(-0.0189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(559.0233, device='cuda:3')
user_param_square tensor(81.6502, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-16.8174, device='cuda:3')
score : tensor(-0.1799, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.9929, device='cuda:3')
user_param_square tensor(80.0996, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-23.0500, device='cuda:3')
score : tensor(-0.2422, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.9095, device='cuda:3')
user_param_square tensor(87.9021, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-19.9378, device='cuda:3')
score : tensor(-0.2111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.0285, device='cuda:3')
user_param_square tensor(82.8827, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-16.6479, device='cuda:3')
score : tensor(-0.1782, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.4540, device='cuda:3')
user_param_square tensor(83.6294, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(-19.2604, device='cuda:3')
score : tensor(-0.2043, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.2860, device='cuda:3')
user_param_square tensor(82.5408, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(4.3382, device='cuda:3')
score : tensor(0.0317, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(559.6094, device='cuda:3')
user_param_square tensor(81.6930, device='cuda:3')
global_param_square tensor(11.9257, device='cuda:3')
part1 is  tensor(5.8045, device='cuda:3')
score : tensor(0.0463, device='cuda:3')
accept
len accept list 6
len all weights is 6
 
Avg Training Stats after 66 global rounds:
Train Accuracy: 89.70% 

Test Accuracy: 88.93% 


 | Global Training Round : 67 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6969114542007446
distance x is tensor(95.4151, device='cuda:3')
benign distance is  tensor(95.4151, device='cuda:3')
norm1 res is  tensor(0.1094, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7038683891296387
distance x is tensor(123.2059, device='cuda:3')
benign distance is  tensor(123.2059, device='cuda:3')
norm1 res is  tensor(0.1323, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.20463411509990692
distance x is tensor(103.6174, device='cuda:3')
benign distance is  tensor(103.6174, device='cuda:3')
norm1 res is  tensor(0.1132, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  1.0103328227996826
distance x is tensor(94.4600, device='cuda:3')
benign distance is  tensor(94.4600, device='cuda:3')
norm1 res is  tensor(0.1036, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.25302520394325256
distance x is tensor(92.2482, device='cuda:3')
benign distance is  tensor(92.2482, device='cuda:3')
norm1 res is  tensor(0.1005, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.128434181213379
distance x is tensor(135.9708, device='cuda:3')
benign distance is  tensor(135.9708, device='cuda:3')
norm1 res is  tensor(0.1492, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.7284649610519409
distance x is tensor(97.5402, device='cuda:3')
benign distance is  tensor(97.5402, device='cuda:3')
norm1 res is  tensor(0.1040, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.1811305582523346
distance x is tensor(109.8399, device='cuda:3')
benign distance is  tensor(109.8399, device='cuda:3')
norm1 res is  tensor(0.1226, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.2973366677761078
distance x is tensor(132.9866, device='cuda:3')
benign distance is  tensor(132.9866, device='cuda:3')
norm1 res is  tensor(0.1467, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.27730894088745117
distance x is tensor(123.0218, device='cuda:3')
benign distance is  tensor(123.0218, device='cuda:3')
norm1 res is  tensor(0.1360, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.17490947246551514
distance x is tensor(110.3252, device='cuda:3')
benign distance is  tensor(110.3252, device='cuda:3')
norm1 res is  tensor(0.1210, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.1821395307779312
distance x is tensor(138.4902, device='cuda:3')
benign distance is  tensor(138.4902, device='cuda:3')
norm1 res is  tensor(0.1524, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.26527759432792664
distance x is tensor(113.2553, device='cuda:3')
benign distance is  tensor(113.2553, device='cuda:3')
norm1 res is  tensor(0.1284, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.10199060291051865
distance x is tensor(126.3361, device='cuda:3')
benign distance is  tensor(126.3361, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.1723785400390625
distance x is tensor(121.7407, device='cuda:3')
benign distance is  tensor(121.7407, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.23355934023857117
distance x is tensor(124.0905, device='cuda:3')
benign distance is  tensor(124.0905, device='cuda:3')
norm1 res is  tensor(0.1349, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.5017153024673462
distance x is tensor(113.0566, device='cuda:3')
benign distance is  tensor(113.0566, device='cuda:3')
norm1 res is  tensor(0.1276, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.5307767391204834
distance x is tensor(136.9112, device='cuda:3')
benign distance is  tensor(136.9112, device='cuda:3')
norm1 res is  tensor(0.1487, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.3209332525730133
distance x is tensor(127.3859, device='cuda:3')
benign distance is  tensor(127.3859, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.2777552902698517
distance x is tensor(134.4127, device='cuda:3')
benign distance is  tensor(134.4127, device='cuda:3')
norm1 res is  tensor(0.1453, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.3296182155609131
distance x is tensor(130.2069, device='cuda:3')
benign distance is  tensor(130.2069, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.42947274446487427
distance x is tensor(126.1785, device='cuda:3')
benign distance is  tensor(126.1785, device='cuda:3')
norm1 res is  tensor(0.1355, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.31136173009872437
distance x is tensor(130.7375, device='cuda:3')
benign distance is  tensor(130.7375, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.40558767318725586
distance x is tensor(124.6912, device='cuda:3')
benign distance is  tensor(124.6912, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.4679088592529297
distance x is tensor(136.6997, device='cuda:3')
benign distance is  tensor(136.6997, device='cuda:3')
norm1 res is  tensor(0.1498, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.19073748588562012
distance x is tensor(132.8156, device='cuda:3')
benign distance is  tensor(132.8156, device='cuda:3')
norm1 res is  tensor(0.1467, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.07961679250001907
distance x is tensor(122.4856, device='cuda:3')
benign distance is  tensor(122.4856, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.222570538520813
distance x is tensor(129.0964, device='cuda:3')
benign distance is  tensor(129.0964, device='cuda:3')
norm1 res is  tensor(0.1429, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.19876687228679657
distance x is tensor(115.2500, device='cuda:3')
benign distance is  tensor(115.2500, device='cuda:3')
norm1 res is  tensor(0.1262, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.2948358654975891
distance x is tensor(134.9162, device='cuda:3')
benign distance is  tensor(134.9162, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.38423484563827515
distance x is tensor(123.3104, device='cuda:3')
benign distance is  tensor(123.3104, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.21699199080467224
distance x is tensor(134.1129, device='cuda:3')
benign distance is  tensor(134.1129, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(131.9360, device='cuda:3')
compute distance is  tensor(131.9360, device='cuda:3')
compute norm is  tensor(65.4067, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.7148, device='cuda:3')
compute distance is  tensor(117.7148, device='cuda:3')
compute norm is  tensor(65.0156, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.2432, device='cuda:3')
compute distance is  tensor(127.2432, device='cuda:3')
compute norm is  tensor(65.3423, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.1854, device='cuda:3')
compute distance is  tensor(121.1854, device='cuda:3')
compute norm is  tensor(65.1047, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1346, device='cuda:3')
compute distance is  tensor(134.1346, device='cuda:3')
compute norm is  tensor(65.4209, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1465, device='cuda:3')
compute distance is  tensor(136.1465, device='cuda:3')
compute norm is  tensor(65.4363, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.3081, device='cuda:3')
compute distance is  tensor(122.3081, device='cuda:3')
compute norm is  tensor(65.2566, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7068, device='cuda:3')
compute distance is  tensor(121.7068, device='cuda:3')
compute norm is  tensor(65.2937, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4564, device='cuda:3')
compute distance is  tensor(137.4564, device='cuda:3')
compute norm is  tensor(65.3058, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7996, device='cuda:3')
compute distance is  tensor(130.7996, device='cuda:3')
compute norm is  tensor(65.3932, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8483, device='cuda:3')
compute distance is  tensor(131.8483, device='cuda:3')
compute norm is  tensor(65.4293, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3231, device='cuda:3')
compute distance is  tensor(127.3231, device='cuda:3')
compute norm is  tensor(65.3510, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.4564, device='cuda:3')
distance x is tensor(107585.3984, device='cuda:3')
distance x is tensor(107585.3984, device='cuda:3')
________________________________
test distance is  tensor(107585.3984, device='cuda:3')
test distance1 is  tensor(107585.3984, device='cuda:3')
test similarity is  tensor(0.4298, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130052243429450.23
test entropy is  0.0
________________________________
cal ratio is  0.035029336231657306
distance x is tensor(3768.6506, device='cuda:3')
cal_distance is  tensor(3768.6506, device='cuda:3')
cal ratio is  0.18716111560031318
distance x is tensor(705.3490, device='cuda:3')
cal_distance is  tensor(705.3490, device='cuda:3')
cal ratio is  0.43261994016301186
distance x is tensor(305.1509, device='cuda:3')
cal_distance is  tensor(305.1509, device='cuda:3')
cal ratio is  0.6577353925840945
distance x is tensor(200.7103, device='cuda:3')
cal_distance is  tensor(200.7103, device='cuda:3')
cal ratio is  0.8110053572001534
distance x is tensor(162.7781, device='cuda:3')
cal_distance is  tensor(162.7781, device='cuda:3')
cal ratio is  0.9005556319562131
distance x is tensor(146.5913, device='cuda:3')
cal_distance is  tensor(146.5913, device='cuda:3')
cal ratio is  0.9489744239612631
distance x is tensor(139.1116, device='cuda:3')
cal_distance is  tensor(139.1116, device='cuda:3')
cal ratio is  0.97415230889885
distance x is tensor(135.5161, device='cuda:3')
cal_distance is  tensor(135.5161, device='cuda:3')
distance x is tensor(135.5161, device='cuda:3')
return_distance is  tensor(135.5161, device='cuda:3')
distance x is tensor(135.5058, device='cuda:3')
distance x is tensor(135.5058, device='cuda:3')
________________________________
test distance is  tensor(135.5058, device='cuda:3')
test distance1 is  tensor(135.5058, device='cuda:3')
test similarity is  tensor(0.9821, device='cuda:3')
test acc is  0.2706166668230055
test loss is 39.436523699811275
test entropy is  0.04082202205500468
________________________________
0
distance x is tensor(135.5058, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.039963827767063864
avg test loss is  39.420077899371634
avg accuracy is  0.8767166668229888
solo acc is  0.27081666682300554
compute similarity  is  tensor(0.9821, device='cuda:3')
compute_distance is  tensor(135.5058, device='cuda:3')
compute_norm is  tensor(68.3991, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.6340, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9012558587959835
avg test loss is  1.3567392913136147
avg accuracy is  0.8477333334896566
solo acc is  0.3289500001563401
compute similarity  is  tensor(0.9814, device='cuda:3')
compute_distance is  tensor(136.6340, device='cuda:3')
compute_norm is  tensor(67.8092, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.0459, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8716445097536929
avg test loss is  1.4362144895962305
avg accuracy is  0.84636666682299
solo acc is  0.2610333334896719
compute similarity  is  tensor(0.9811, device='cuda:3')
compute_distance is  tensor(138.0459, device='cuda:3')
compute_norm is  tensor(67.4495, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.0560, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8659535458347182
avg test loss is  1.4081457276334133
avg accuracy is  0.84726666682299
solo acc is  0.25518333348967176
compute similarity  is  tensor(0.9809, device='cuda:3')
compute_distance is  tensor(139.0560, device='cuda:3')
compute_norm is  tensor(67.1048, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.9521, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8568653907221772
avg test loss is  1.3978697168293284
avg accuracy is  0.8504333334896566
solo acc is  0.2473500001563382
compute similarity  is  tensor(0.9807, device='cuda:3')
compute_distance is  tensor(139.9521, device='cuda:3')
compute_norm is  tensor(66.7672, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.8104, device='cuda:3')
distance x is tensor(140.8104, device='cuda:3')
________________________________
test distance is  tensor(140.8104, device='cuda:3')
test distance1 is  tensor(140.8104, device='cuda:3')
test similarity is  tensor(0.9805, device='cuda:3')
test acc is  0.24113333348967128
test loss is 1.3858424579538007
test entropy is  0.8455092092312729
________________________________
cal ratio is  0.9682582468006177
distance x is tensor(136.3493, device='cuda:3')
cal_distance is  tensor(136.3493, device='cuda:3')
distance x is tensor(136.3493, device='cuda:3')
return_distance is  tensor(136.3493, device='cuda:3')
distance x is tensor(136.3407, device='cuda:3')
distance x is tensor(136.3407, device='cuda:3')
________________________________
test distance is  tensor(136.3407, device='cuda:3')
test distance1 is  tensor(136.3407, device='cuda:3')
test similarity is  tensor(0.9816, device='cuda:3')
test acc is  0.30188333348967294
test loss is 1.2750145092701861
test entropy is  0.8962496583268587
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 0.9719579815864563
mal norm is  tensor(643.2577, device='cuda:3')
distance x is tensor(136.3493, device='cuda:3')
mal distance is  tensor(136.3493, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(11.3841, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(418.8671, device='cuda:3')
user_param_square tensor(69.0538, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-19.7099, device='cuda:3')
score : tensor(-0.2083, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.8140, device='cuda:3')
user_param_square tensor(77.2214, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(6.5538, device='cuda:3')
score : tensor(0.0544, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(446.4478, device='cuda:3')
user_param_square tensor(71.2910, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(7.8842, device='cuda:3')
score : tensor(0.0677, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(406.9349, device='cuda:3')
user_param_square tensor(68.0631, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-6.5438, device='cuda:3')
score : tensor(-0.0766, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(397.6888, device='cuda:3')
user_param_square tensor(67.2854, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.2112, device='cuda:3')
score : tensor(-0.1533, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.8948, device='cuda:3')
user_param_square tensor(81.7390, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-10.6111, device='cuda:3')
score : tensor(-0.1173, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(407.1413, device='cuda:3')
user_param_square tensor(68.0804, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-10.4945, device='cuda:3')
score : tensor(-0.1161, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.0444, device='cuda:3')
user_param_square tensor(74.1554, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(3.1437, device='cuda:3')
score : tensor(0.0203, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.2577, device='cuda:3')
user_param_square tensor(85.5740, device='cuda:3')
global_param_square tensor(11.3841, device='cuda:3')
part1 is  tensor(-14.8576, device='cuda:3')
score : tensor(-0.1598, device='cuda:3')
len accept list 3
len all weights is 3
 
Avg Training Stats after 67 global rounds:
Train Accuracy: 89.92% 

Test Accuracy: 88.98% 


 | Global Training Round : 68 | 

current submit client idx and staleness is  0 1
 benign loss is  0.16273315250873566
distance x is tensor(129.5446, device='cuda:3')
benign distance is  tensor(129.5446, device='cuda:3')
norm1 res is  tensor(0.1419, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7424251437187195
distance x is tensor(123.3296, device='cuda:3')
benign distance is  tensor(123.3296, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2139539271593094
distance x is tensor(111.4308, device='cuda:3')
benign distance is  tensor(111.4308, device='cuda:3')
norm1 res is  tensor(0.1202, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4281834661960602
distance x is tensor(131.5342, device='cuda:3')
benign distance is  tensor(131.5342, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5096367001533508
distance x is tensor(120.2861, device='cuda:3')
benign distance is  tensor(120.2861, device='cuda:3')
norm1 res is  tensor(0.1308, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4300341010093689
distance x is tensor(139.9795, device='cuda:3')
benign distance is  tensor(139.9795, device='cuda:3')
norm1 res is  tensor(0.1555, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.06399080902338028
distance x is tensor(141.4622, device='cuda:3')
benign distance is  tensor(141.4622, device='cuda:3')
norm1 res is  tensor(0.1515, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.22835023701190948
distance x is tensor(113.8948, device='cuda:3')
benign distance is  tensor(113.8948, device='cuda:3')
norm1 res is  tensor(0.1292, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(131.9686, device='cuda:3')
compute distance is  tensor(131.9686, device='cuda:3')
compute norm is  tensor(65.7310, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0630, device='cuda:3')
compute distance is  tensor(144.0630, device='cuda:3')
compute norm is  tensor(65.9345, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3241, device='cuda:3')
compute distance is  tensor(137.3241, device='cuda:3')
compute norm is  tensor(65.8639, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.6348, device='cuda:3')
compute distance is  tensor(124.6348, device='cuda:3')
compute norm is  tensor(65.6574, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3154, device='cuda:3')
compute distance is  tensor(137.3154, device='cuda:3')
compute norm is  tensor(65.8983, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.2683, device='cuda:3')
compute distance is  tensor(146.2683, device='cuda:3')
compute norm is  tensor(66.1497, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8264, device='cuda:3')
compute distance is  tensor(132.8264, device='cuda:3')
compute norm is  tensor(65.7909, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4183, device='cuda:3')
compute distance is  tensor(134.4183, device='cuda:3')
compute norm is  tensor(65.7702, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.4547, device='cuda:3')
compute distance is  tensor(146.4547, device='cuda:3')
compute norm is  tensor(66.0817, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8964, device='cuda:3')
compute distance is  tensor(137.8964, device='cuda:3')
compute norm is  tensor(66.0104, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4327, device='cuda:3')
compute distance is  tensor(145.4327, device='cuda:3')
compute norm is  tensor(66.0125, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1517, device='cuda:3')
compute distance is  tensor(136.1517, device='cuda:3')
compute norm is  tensor(65.8791, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(146.4547, device='cuda:3')
distance x is tensor(107588.9453, device='cuda:3')
distance x is tensor(107588.9453, device='cuda:3')
________________________________
test distance is  tensor(107588.9453, device='cuda:3')
test distance1 is  tensor(107588.9453, device='cuda:3')
test similarity is  tensor(0.4222, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130042013835002.0
test entropy is  0.0
________________________________
cal ratio is  0.03615712571371517
distance x is tensor(3890.1135, device='cuda:3')
cal_distance is  tensor(3890.1135, device='cuda:3')
cal ratio is  0.19015011826113298
distance x is tensor(739.7095, device='cuda:3')
cal_distance is  tensor(739.7095, device='cuda:3')
cal ratio is  0.4360608685028143
distance x is tensor(322.5612, device='cuda:3')
cal_distance is  tensor(322.5612, device='cuda:3')
cal ratio is  0.6603461228298654
distance x is tensor(213.0038, device='cuda:3')
cal_distance is  tensor(213.0038, device='cuda:3')
cal ratio is  0.8126134394463121
distance x is tensor(173.0907, device='cuda:3')
cal_distance is  tensor(173.0907, device='cuda:3')
cal ratio is  0.9014482535661278
distance x is tensor(156.0328, device='cuda:3')
cal_distance is  tensor(156.0328, device='cuda:3')
cal ratio is  0.9494448211590554
distance x is tensor(148.1448, device='cuda:3')
cal_distance is  tensor(148.1448, device='cuda:3')
cal ratio is  0.9743937075704981
distance x is tensor(144.3515, device='cuda:3')
cal_distance is  tensor(144.3515, device='cuda:3')
distance x is tensor(144.3515, device='cuda:3')
return_distance is  tensor(144.3515, device='cuda:3')
distance x is tensor(144.3414, device='cuda:3')
distance x is tensor(144.3414, device='cuda:3')
________________________________
test distance is  tensor(144.3414, device='cuda:3')
test distance1 is  tensor(144.3414, device='cuda:3')
test similarity is  tensor(0.9800, device='cuda:3')
test acc is  0.180566666823002
test loss is 79.04637790997145
test entropy is  0.021851753875294436
________________________________
0
distance x is tensor(144.3414, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.021854743508171282
avg test loss is  78.92050921230683
avg accuracy is  0.8591166668229895
solo acc is  0.17763333348966856
compute similarity  is  tensor(0.9800, device='cuda:3')
compute_distance is  tensor(144.3414, device='cuda:3')
compute_norm is  tensor(69.1784, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.9478, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.960156426628007
avg test loss is  1.4297907274923345
avg accuracy is  0.7998666668229921
solo acc is  0.30436666682300634
compute similarity  is  tensor(0.9795, device='cuda:3')
compute_distance is  tensor(145.9478, device='cuda:3')
compute_norm is  tensor(68.8076, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(145.9478, device='cuda:3')
distance x is tensor(145.9478, device='cuda:3')
________________________________
test distance is  tensor(145.9478, device='cuda:3')
test distance1 is  tensor(145.9478, device='cuda:3')
test similarity is  tensor(0.9795, device='cuda:3')
test acc is  0.30565000015633964
test loss is 1.4374970249784018
test entropy is  0.9592759817012592
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.360883116722107
mal norm is  tensor(728.4985, device='cuda:3')
distance x is tensor(145.9564, device='cuda:3')
mal distance is  tensor(145.9564, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(18.1132, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.3148, device='cuda:3')
user_param_square tensor(100.7428, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.1557, device='cuda:3')
score : tensor(-0.0595, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.7653, device='cuda:3')
user_param_square tensor(99.2439, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-21.0929, device='cuda:3')
score : tensor(-0.2288, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.6104, device='cuda:3')
user_param_square tensor(92.3270, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(26.9990, device='cuda:3')
score : tensor(0.2521, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.5250, device='cuda:3')
user_param_square tensor(101.5674, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-1.5420, device='cuda:3')
score : tensor(-0.0333, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.8482, device='cuda:3')
user_param_square tensor(96.4751, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(4.0303, device='cuda:3')
score : tensor(0.0224, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.0907, device='cuda:3')
user_param_square tensor(105.4664, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-42.5631, device='cuda:3')
score : tensor(-0.4435, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.7638, device='cuda:3')
user_param_square tensor(103.6188, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-7.4538, device='cuda:3')
score : tensor(-0.0925, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.2572, device='cuda:3')
user_param_square tensor(95.6652, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(2.5811, device='cuda:3')
score : tensor(0.0079, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4985, device='cuda:3')
user_param_square tensor(114.8715, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-4.8994, device='cuda:3')
score : tensor(-0.0669, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.2872, device='cuda:3')
user_param_square tensor(107.8605, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-1.9051, device='cuda:3')
score : tensor(-0.0370, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3556, device='cuda:3')
user_param_square tensor(106.5144, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-78.9183, device='cuda:3')
score : tensor(-0.8071, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.7951, device='cuda:3')
user_param_square tensor(107.4827, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-28.0293, device='cuda:3')
score : tensor(-0.2982, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.4232, device='cuda:3')
user_param_square tensor(107.7880, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-0.0618, device='cuda:3')
score : tensor(-0.0185, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2025, device='cuda:3')
user_param_square tensor(108.6065, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-25.8844, device='cuda:3')
score : tensor(-0.2768, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.1205, device='cuda:3')
user_param_square tensor(106.1537, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(8.6034, device='cuda:3')
score : tensor(0.0681, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.6926, device='cuda:3')
user_param_square tensor(107.1365, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-50.2700, device='cuda:3')
score : tensor(-0.5206, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.6799, device='cuda:3')
user_param_square tensor(106.1161, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(22.4093, device='cuda:3')
score : tensor(0.2062, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.2048, device='cuda:3')
user_param_square tensor(106.0756, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-20.4236, device='cuda:3')
score : tensor(-0.2221, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.7275, device='cuda:3')
user_param_square tensor(101.9414, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(0.0546, device='cuda:3')
score : tensor(-0.0174, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.0034, device='cuda:3')
user_param_square tensor(97.4238, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-34.5962, device='cuda:3')
score : tensor(-0.3639, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.0319, device='cuda:3')
user_param_square tensor(107.2496, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-60.3083, device='cuda:3')
score : tensor(-0.6210, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.0106, device='cuda:3')
user_param_square tensor(99.6305, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-19.0405, device='cuda:3')
score : tensor(-0.2083, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.4436, device='cuda:3')
user_param_square tensor(102.7129, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(-7.6475, device='cuda:3')
score : tensor(-0.0944, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4605, device='cuda:3')
user_param_square tensor(102.9785, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(3.7894, device='cuda:3')
score : tensor(0.0200, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.9344, device='cuda:3')
user_param_square tensor(101.8710, device='cuda:3')
global_param_square tensor(18.1132, device='cuda:3')
part1 is  tensor(8.4418, device='cuda:3')
score : tensor(0.0665, device='cuda:3')
accept
len accept list 7
len all weights is 7
 
Avg Training Stats after 68 global rounds:
Train Accuracy: 89.71% 

Test Accuracy: 89.07% 


 | Global Training Round : 69 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3820405602455139
distance x is tensor(125.6480, device='cuda:3')
benign distance is  tensor(125.6480, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.6155704259872437
distance x is tensor(103.4595, device='cuda:3')
benign distance is  tensor(103.4595, device='cuda:3')
norm1 res is  tensor(0.1142, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.18570849299430847
distance x is tensor(83.1563, device='cuda:3')
benign distance is  tensor(83.1563, device='cuda:3')
norm1 res is  tensor(0.0927, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.40550416707992554
distance x is tensor(125.7221, device='cuda:3')
benign distance is  tensor(125.7221, device='cuda:3')
norm1 res is  tensor(0.1352, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3097052574157715
distance x is tensor(101.7810, device='cuda:3')
benign distance is  tensor(101.7810, device='cuda:3')
norm1 res is  tensor(0.1069, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7461992502212524
distance x is tensor(132.1022, device='cuda:3')
benign distance is  tensor(132.1022, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5827686190605164
distance x is tensor(111.6777, device='cuda:3')
benign distance is  tensor(111.6777, device='cuda:3')
norm1 res is  tensor(0.1209, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.15244896709918976
distance x is tensor(123.3355, device='cuda:3')
benign distance is  tensor(123.3355, device='cuda:3')
norm1 res is  tensor(0.1375, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.4073679447174072
distance x is tensor(142.1000, device='cuda:3')
benign distance is  tensor(142.1000, device='cuda:3')
norm1 res is  tensor(0.1555, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.2917878329753876
distance x is tensor(137.5348, device='cuda:3')
benign distance is  tensor(137.5348, device='cuda:3')
norm1 res is  tensor(0.1505, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.46829095482826233
distance x is tensor(138.8550, device='cuda:3')
benign distance is  tensor(138.8550, device='cuda:3')
norm1 res is  tensor(0.1569, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.4265096187591553
distance x is tensor(132.3383, device='cuda:3')
benign distance is  tensor(132.3383, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.3540811836719513
distance x is tensor(146.5227, device='cuda:3')
benign distance is  tensor(146.5227, device='cuda:3')
norm1 res is  tensor(0.1650, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.09340954571962357
distance x is tensor(137.3559, device='cuda:3')
benign distance is  tensor(137.3559, device='cuda:3')
norm1 res is  tensor(0.1505, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.7064696550369263
distance x is tensor(116.9111, device='cuda:3')
benign distance is  tensor(116.9111, device='cuda:3')
norm1 res is  tensor(0.1289, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3760935664176941
distance x is tensor(136.6980, device='cuda:3')
benign distance is  tensor(136.6980, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.20744943618774414
distance x is tensor(144.5652, device='cuda:3')
benign distance is  tensor(144.5652, device='cuda:3')
norm1 res is  tensor(0.1582, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.7734299302101135
distance x is tensor(125.8378, device='cuda:3')
benign distance is  tensor(125.8378, device='cuda:3')
norm1 res is  tensor(0.1352, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.10387905687093735
distance x is tensor(131.5191, device='cuda:3')
benign distance is  tensor(131.5191, device='cuda:3')
norm1 res is  tensor(0.1448, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.21865299344062805
distance x is tensor(138.1947, device='cuda:3')
benign distance is  tensor(138.1947, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.3572222590446472
distance x is tensor(128.0777, device='cuda:3')
benign distance is  tensor(128.0777, device='cuda:3')
norm1 res is  tensor(0.1407, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.42290282249450684
distance x is tensor(131.8721, device='cuda:3')
benign distance is  tensor(131.8721, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.2634247839450836
distance x is tensor(136.4222, device='cuda:3')
benign distance is  tensor(136.4222, device='cuda:3')
norm1 res is  tensor(0.1532, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.18300171196460724
distance x is tensor(122.1731, device='cuda:3')
benign distance is  tensor(122.1731, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(135.6568, device='cuda:3')
compute distance is  tensor(135.6568, device='cuda:3')
compute norm is  tensor(65.9181, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7424, device='cuda:3')
compute distance is  tensor(127.7424, device='cuda:3')
compute norm is  tensor(65.8540, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1944, device='cuda:3')
compute distance is  tensor(129.1944, device='cuda:3')
compute norm is  tensor(65.8957, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9270, device='cuda:3')
compute distance is  tensor(135.9270, device='cuda:3')
compute norm is  tensor(65.9778, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9373, device='cuda:3')
compute distance is  tensor(132.9373, device='cuda:3')
compute norm is  tensor(65.8722, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.6794, device='cuda:3')
compute distance is  tensor(143.6794, device='cuda:3')
compute norm is  tensor(66.1727, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.2394, device='cuda:3')
compute distance is  tensor(136.2394, device='cuda:3')
compute norm is  tensor(66.0545, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7288, device='cuda:3')
compute distance is  tensor(125.7288, device='cuda:3')
compute norm is  tensor(65.7901, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0382, device='cuda:3')
compute distance is  tensor(134.0382, device='cuda:3')
compute norm is  tensor(65.9533, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.2087, device='cuda:3')
compute distance is  tensor(115.2087, device='cuda:3')
compute norm is  tensor(65.8139, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6143, device='cuda:3')
compute distance is  tensor(139.6143, device='cuda:3')
compute norm is  tensor(66.1286, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.0079, device='cuda:3')
compute distance is  tensor(131.0079, device='cuda:3')
compute norm is  tensor(65.9397, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(143.6794, device='cuda:3')
distance x is tensor(107591.6406, device='cuda:3')
distance x is tensor(107591.6406, device='cuda:3')
________________________________
test distance is  tensor(107591.6406, device='cuda:3')
test distance1 is  tensor(107591.6406, device='cuda:3')
test similarity is  tensor(0.4192, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130191814842197.7
test entropy is  0.0
________________________________
cal ratio is  0.0358124458796698
distance x is tensor(3853.1255, device='cuda:3')
cal_distance is  tensor(3853.1255, device='cuda:3')
cal ratio is  0.18924163379548029
distance x is tensor(729.1759, device='cuda:3')
cal_distance is  tensor(729.1759, device='cuda:3')
cal ratio is  0.4350178809437157
distance x is tensor(317.2074, device='cuda:3')
cal_distance is  tensor(317.2074, device='cuda:3')
cal ratio is  0.6595558542751614
distance x is tensor(209.2177, device='cuda:3')
cal_distance is  tensor(209.2177, device='cuda:3')
cal ratio is  0.8121270846609774
distance x is tensor(169.9124, device='cuda:3')
cal_distance is  tensor(169.9124, device='cuda:3')
cal ratio is  0.9011783271363457
distance x is tensor(153.1219, device='cuda:3')
cal_distance is  tensor(153.1219, device='cuda:3')
cal ratio is  0.9493025204463407
distance x is tensor(145.3593, device='cuda:3')
cal_distance is  tensor(145.3593, device='cuda:3')
cal ratio is  0.9743206802799003
distance x is tensor(141.6266, device='cuda:3')
cal_distance is  tensor(141.6266, device='cuda:3')
distance x is tensor(141.6266, device='cuda:3')
return_distance is  tensor(141.6266, device='cuda:3')
distance x is tensor(141.6165, device='cuda:3')
distance x is tensor(141.6165, device='cuda:3')
________________________________
test distance is  tensor(141.6165, device='cuda:3')
test distance1 is  tensor(141.6165, device='cuda:3')
test similarity is  tensor(0.9806, device='cuda:3')
test acc is  0.21671666682300375
test loss is 58.9550237594637
test entropy is  0.028778093964104596
________________________________
0
distance x is tensor(141.6165, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.028585503669599926
avg test loss is  58.85659547655313
avg accuracy is  0.8770833334896555
solo acc is  0.21490000015633695
compute similarity  is  tensor(0.9806, device='cuda:3')
compute_distance is  tensor(141.6165, device='cuda:3')
compute_norm is  tensor(69.1649, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.9090, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9309937237803616
avg test loss is  1.4116481967063854
avg accuracy is  0.832500000156324
solo acc is  0.3151500001563398
compute similarity  is  tensor(0.9803, device='cuda:3')
compute_distance is  tensor(141.9090, device='cuda:3')
compute_norm is  tensor(68.6788, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.1308, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8833516770715653
avg test loss is  1.481052392327201
avg accuracy is  0.8272333334896576
solo acc is  0.2547833334896717
compute similarity  is  tensor(0.9800, device='cuda:3')
compute_distance is  tensor(143.1308, device='cuda:3')
compute_norm is  tensor(68.3208, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.0942, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8618129446689509
avg test loss is  1.4633360890183114
avg accuracy is  0.8307000001563241
solo acc is  0.25058333348967154
compute similarity  is  tensor(0.9798, device='cuda:3')
compute_distance is  tensor(144.0942, device='cuda:3')
compute_norm is  tensor(67.9716, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.9916, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.861046692074489
avg test loss is  1.4215589273713036
avg accuracy is  0.8317833334896573
solo acc is  0.2486333334896715
compute similarity  is  tensor(0.9796, device='cuda:3')
compute_distance is  tensor(144.9916, device='cuda:3')
compute_norm is  tensor(67.6249, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.8296, device='cuda:3')
distance x is tensor(145.8296, device='cuda:3')
________________________________
test distance is  tensor(145.8296, device='cuda:3')
test distance1 is  tensor(145.8296, device='cuda:3')
test similarity is  tensor(0.9794, device='cuda:3')
test acc is  0.2397666668230046
test loss is 1.4098679530086802
test entropy is  0.8543722152964138
________________________________
cal ratio is  0.9727481199455671
distance x is tensor(141.8640, device='cuda:3')
cal_distance is  tensor(141.8640, device='cuda:3')
distance x is tensor(141.8640, device='cuda:3')
return_distance is  tensor(141.8640, device='cuda:3')
distance x is tensor(141.8553, device='cuda:3')
distance x is tensor(141.8553, device='cuda:3')
________________________________
test distance is  tensor(141.8553, device='cuda:3')
test distance1 is  tensor(141.8553, device='cuda:3')
test similarity is  tensor(0.9804, device='cuda:3')
test acc is  0.28225000015633905
test loss is 1.3251041313097167
test entropy is  0.8945145171080062
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.5000000005
mal loss is 1.0028207302093506
mal norm is  tensor(671.8060, device='cuda:3')
distance x is tensor(141.8640, device='cuda:3')
mal distance is  tensor(141.8640, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(14.2733, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.1398, device='cuda:3')
user_param_square tensor(88.7742, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-3.9269, device='cuda:3')
score : tensor(-0.0533, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(448.1022, device='cuda:3')
user_param_square tensor(79.9744, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(14.9996, device='cuda:3')
score : tensor(0.1359, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(357.7536, device='cuda:3')
user_param_square tensor(71.4586, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(22.4252, device='cuda:3')
score : tensor(0.2102, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.3607, device='cuda:3')
user_param_square tensor(87.3332, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-12.1294, device='cuda:3')
score : tensor(-0.1354, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(422.2189, device='cuda:3')
user_param_square tensor(77.6303, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-28.2456, device='cuda:3')
score : tensor(-0.2965, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.4789, device='cuda:3')
user_param_square tensor(89.8401, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-7.6586, device='cuda:3')
score : tensor(-0.0907, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(474.7626, device='cuda:3')
user_param_square tensor(82.3191, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-9.0633, device='cuda:3')
score : tensor(-0.1047, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.5620, device='cuda:3')
user_param_square tensor(87.7572, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(3.4513, device='cuda:3')
score : tensor(0.0204, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.8060, device='cuda:3')
user_param_square tensor(97.9229, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-37.1311, device='cuda:3')
score : tensor(-0.3854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.8625, device='cuda:3')
user_param_square tensor(88.4297, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(22.1305, device='cuda:3')
score : tensor(0.2072, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.7948, device='cuda:3')
user_param_square tensor(94.2833, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-30.3041, device='cuda:3')
score : tensor(-0.3171, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.3874, device='cuda:3')
user_param_square tensor(91.2516, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(13.3937, device='cuda:3')
score : tensor(0.1199, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.1276, device='cuda:3')
user_param_square tensor(93.0898, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(12.9299, device='cuda:3')
score : tensor(0.1152, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.6990, device='cuda:3')
user_param_square tensor(92.5186, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(9.9377, device='cuda:3')
score : tensor(0.0853, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.3826, device='cuda:3')
user_param_square tensor(89.9912, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(25.3017, device='cuda:3')
score : tensor(0.2389, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.0585, device='cuda:3')
user_param_square tensor(92.8542, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-0.6180, device='cuda:3')
score : tensor(-0.0203, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.8517, device='cuda:3')
user_param_square tensor(90.4239, device='cuda:3')
global_param_square tensor(14.2733, device='cuda:3')
part1 is  tensor(-14.3270, device='cuda:3')
score : tensor(-0.1573, device='cuda:3')
len accept list 8
len all weights is 8
 
Avg Training Stats after 69 global rounds:
Train Accuracy: 89.81% 

Test Accuracy: 88.97% 


 | Global Training Round : 70 | 

current submit client idx and staleness is  0 1
 benign loss is  0.33392125368118286
distance x is tensor(114.9582, device='cuda:3')
benign distance is  tensor(114.9582, device='cuda:3')
norm1 res is  tensor(0.1285, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4986269474029541
distance x is tensor(120.6719, device='cuda:3')
benign distance is  tensor(120.6719, device='cuda:3')
norm1 res is  tensor(0.1386, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.28628605604171753
distance x is tensor(92.4549, device='cuda:3')
benign distance is  tensor(92.4549, device='cuda:3')
norm1 res is  tensor(0.1024, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.26580196619033813
distance x is tensor(108.7393, device='cuda:3')
benign distance is  tensor(108.7393, device='cuda:3')
norm1 res is  tensor(0.1194, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7375524640083313
distance x is tensor(99.8041, device='cuda:3')
benign distance is  tensor(99.8041, device='cuda:3')
norm1 res is  tensor(0.1072, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4813729226589203
distance x is tensor(136.6039, device='cuda:3')
benign distance is  tensor(136.6039, device='cuda:3')
norm1 res is  tensor(0.1501, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.30787914991378784
distance x is tensor(111.3129, device='cuda:3')
benign distance is  tensor(111.3129, device='cuda:3')
norm1 res is  tensor(0.1230, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5266623497009277
distance x is tensor(109.3556, device='cuda:3')
benign distance is  tensor(109.3556, device='cuda:3')
norm1 res is  tensor(0.1213, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.1440691351890564
distance x is tensor(125.5471, device='cuda:3')
benign distance is  tensor(125.5471, device='cuda:3')
norm1 res is  tensor(0.1398, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.69520503282547
distance x is tensor(151.3660, device='cuda:3')
benign distance is  tensor(151.3660, device='cuda:3')
norm1 res is  tensor(0.1636, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.5305758118629456
distance x is tensor(136.0140, device='cuda:3')
benign distance is  tensor(136.0140, device='cuda:3')
norm1 res is  tensor(0.1488, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.09768305718898773
distance x is tensor(128.3963, device='cuda:3')
benign distance is  tensor(128.3963, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.5638889074325562
distance x is tensor(119.5296, device='cuda:3')
benign distance is  tensor(119.5296, device='cuda:3')
norm1 res is  tensor(0.1319, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.25918588042259216
distance x is tensor(134.1556, device='cuda:3')
benign distance is  tensor(134.1556, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.821886420249939
distance x is tensor(135.9593, device='cuda:3')
benign distance is  tensor(135.9593, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.7824314832687378
distance x is tensor(129.5965, device='cuda:3')
benign distance is  tensor(129.5965, device='cuda:3')
norm1 res is  tensor(0.1415, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(127.7551, device='cuda:3')
compute distance is  tensor(127.7551, device='cuda:3')
compute norm is  tensor(65.9119, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.8234, device='cuda:3')
compute distance is  tensor(126.8234, device='cuda:3')
compute norm is  tensor(65.7962, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2709, device='cuda:3')
compute distance is  tensor(128.2709, device='cuda:3')
compute norm is  tensor(65.9602, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2290, device='cuda:3')
compute distance is  tensor(132.2290, device='cuda:3')
compute norm is  tensor(65.8754, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.1009, device='cuda:3')
compute distance is  tensor(130.1009, device='cuda:3')
compute norm is  tensor(65.8635, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.6726, device='cuda:3')
compute distance is  tensor(141.6726, device='cuda:3')
compute norm is  tensor(66.1468, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3069, device='cuda:3')
compute distance is  tensor(126.3069, device='cuda:3')
compute norm is  tensor(65.8981, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1528, device='cuda:3')
compute distance is  tensor(136.1528, device='cuda:3')
compute norm is  tensor(66.0268, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7957, device='cuda:3')
compute distance is  tensor(136.7957, device='cuda:3')
compute norm is  tensor(66.0293, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7905, device='cuda:3')
compute distance is  tensor(138.7905, device='cuda:3')
compute norm is  tensor(66.1234, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.5094, device='cuda:3')
compute distance is  tensor(138.5094, device='cuda:3')
compute norm is  tensor(66.0106, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1544, device='cuda:3')
compute distance is  tensor(126.1544, device='cuda:3')
compute norm is  tensor(65.9029, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(141.6726, device='cuda:3')
distance x is tensor(107591.8984, device='cuda:3')
distance x is tensor(107591.8984, device='cuda:3')
________________________________
test distance is  tensor(107591.8984, device='cuda:3')
test distance1 is  tensor(107591.8984, device='cuda:3')
test similarity is  tensor(0.4182, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130200589397710.33
test entropy is  0.0
________________________________
cal ratio is  0.035561432631430495
distance x is tensor(3826.1279, device='cuda:3')
cal_distance is  tensor(3826.1279, device='cuda:3')
cal ratio is  0.18857725128548575
distance x is tensor(721.5247, device='cuda:3')
cal_distance is  tensor(721.5247, device='cuda:3')
cal ratio is  0.43425360527721635
distance x is tensor(313.3276, device='cuda:3')
cal_distance is  tensor(313.3276, device='cuda:3')
cal ratio is  0.6589761748377492
distance x is tensor(206.4772, device='cuda:3')
cal_distance is  tensor(206.4772, device='cuda:3')
cal ratio is  0.8117699901279956
distance x is tensor(167.6129, device='cuda:3')
cal_distance is  tensor(167.6129, device='cuda:3')
cal ratio is  0.9009802449777741
distance x is tensor(151.0165, device='cuda:3')
cal_distance is  tensor(151.0165, device='cuda:3')
cal ratio is  0.9491981630832205
distance x is tensor(143.3448, device='cuda:3')
cal_distance is  tensor(143.3448, device='cuda:3')
cal ratio is  0.9742671254130728
distance x is tensor(139.6563, device='cuda:3')
cal_distance is  tensor(139.6563, device='cuda:3')
distance x is tensor(139.6563, device='cuda:3')
return_distance is  tensor(139.6563, device='cuda:3')
distance x is tensor(139.6461, device='cuda:3')
distance x is tensor(139.6461, device='cuda:3')
________________________________
test distance is  tensor(139.6461, device='cuda:3')
test distance1 is  tensor(139.6461, device='cuda:3')
test similarity is  tensor(0.9811, device='cuda:3')
test acc is  0.2909333334896727
test loss is 38.21215770493692
test entropy is  0.04203996167238702
________________________________
0
distance x is tensor(139.6461, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.041840095188655356
avg test loss is  38.233475111694986
avg accuracy is  0.8795166668229887
solo acc is  0.29026666682300595
compute similarity  is  tensor(0.9811, device='cuda:3')
compute_distance is  tensor(139.6461, device='cuda:3')
compute_norm is  tensor(69.1211, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(140.5918, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.901648844737234
avg test loss is  1.3867567613053677
avg accuracy is  0.8471000001563234
solo acc is  0.31716666682300665
compute similarity  is  tensor(0.9803, device='cuda:3')
compute_distance is  tensor(140.5918, device='cuda:3')
compute_norm is  tensor(68.4756, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.0572, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8613982411589958
avg test loss is  1.4542760334289404
avg accuracy is  0.8472833334896567
solo acc is  0.2606666668230052
compute similarity  is  tensor(0.9800, device='cuda:3')
compute_distance is  tensor(142.0572, device='cuda:3')
compute_norm is  tensor(68.1091, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.1587, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8624110764531947
avg test loss is  1.415309060102841
avg accuracy is  0.8486833334896565
solo acc is  0.2579333334896718
compute similarity  is  tensor(0.9797, device='cuda:3')
compute_distance is  tensor(143.1587, device='cuda:3')
compute_norm is  tensor(67.7559, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.1616, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8544952799516446
avg test loss is  1.393841452245265
avg accuracy is  0.8526166668229898
solo acc is  0.25300000015633833
compute similarity  is  tensor(0.9795, device='cuda:3')
compute_distance is  tensor(144.1616, device='cuda:3')
compute_norm is  tensor(67.4123, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.0588, device='cuda:3')
distance x is tensor(145.0588, device='cuda:3')
________________________________
test distance is  tensor(145.0588, device='cuda:3')
test distance1 is  tensor(145.0588, device='cuda:3')
test similarity is  tensor(0.9793, device='cuda:3')
test acc is  0.250966666823005
test loss is 1.37274723444412
test entropy is  0.8507848457613988
________________________________
cal ratio is  0.9684941400248265
distance x is tensor(140.4969, device='cuda:3')
cal_distance is  tensor(140.4969, device='cuda:3')
distance x is tensor(140.4969, device='cuda:3')
return_distance is  tensor(140.4969, device='cuda:3')
distance x is tensor(140.4885, device='cuda:3')
distance x is tensor(140.4885, device='cuda:3')
________________________________
test distance is  tensor(140.4885, device='cuda:3')
test distance1 is  tensor(140.4885, device='cuda:3')
test similarity is  tensor(0.9805, device='cuda:3')
test acc is  0.3159000001563399
test loss is 1.2595930964961997
test entropy is  0.8993825056532553
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.145167350769043
mal norm is  tensor(664.9146, device='cuda:3')
distance x is tensor(140.4969, device='cuda:3')
mal distance is  tensor(140.4969, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(19.7124, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.8880, device='cuda:3')
user_param_square tensor(100.0584, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(12.1772, device='cuda:3')
score : tensor(0.1023, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.5184, device='cuda:3')
user_param_square tensor(102.1669, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-30.2469, device='cuda:3')
score : tensor(-0.3220, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(400.5055, device='cuda:3')
user_param_square tensor(88.8534, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(5.6812, device='cuda:3')
score : tensor(0.0373, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.0613, device='cuda:3')
user_param_square tensor(96.3626, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(4.8647, device='cuda:3')
score : tensor(0.0291, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(424.1723, device='cuda:3')
user_param_square tensor(91.4410, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-66.0785, device='cuda:3')
score : tensor(-0.6803, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.7886, device='cuda:3')
user_param_square tensor(108.0073, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-30.4936, device='cuda:3')
score : tensor(-0.3244, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.9302, device='cuda:3')
user_param_square tensor(97.0626, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(6.8837, device='cuda:3')
score : tensor(0.0493, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.0150, device='cuda:3')
user_param_square tensor(96.9696, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(19.9068, device='cuda:3')
score : tensor(0.1796, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.9146, device='cuda:3')
user_param_square tensor(114.4861, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-16.5300, device='cuda:3')
score : tensor(-0.1848, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.6390, device='cuda:3')
user_param_square tensor(106.8928, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(32.1482, device='cuda:3')
score : tensor(0.3020, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.9665, device='cuda:3')
user_param_square tensor(109.6536, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(44.5908, device='cuda:3')
score : tensor(0.4264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.0326, device='cuda:3')
user_param_square tensor(107.3890, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-13.4968, device='cuda:3')
score : tensor(-0.1545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.4120, device='cuda:3')
user_param_square tensor(109.1532, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(65.5416, device='cuda:3')
score : tensor(0.6359, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.5272, device='cuda:3')
user_param_square tensor(109.7040, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-6.6125, device='cuda:3')
score : tensor(-0.0856, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.0703, device='cuda:3')
user_param_square tensor(108.6697, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(2.7324, device='cuda:3')
score : tensor(0.0078, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.4766, device='cuda:3')
user_param_square tensor(110.1477, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-20.6945, device='cuda:3')
score : tensor(-0.2265, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.5892, device='cuda:3')
user_param_square tensor(108.9884, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(28.5651, device='cuda:3')
score : tensor(0.2661, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.2538, device='cuda:3')
user_param_square tensor(111.0192, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(12.6193, device='cuda:3')
score : tensor(0.1067, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.0591, device='cuda:3')
user_param_square tensor(110.2892, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(15.4152, device='cuda:3')
score : tensor(0.1346, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.8374, device='cuda:3')
user_param_square tensor(111.2483, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-6.8789, device='cuda:3')
score : tensor(-0.0883, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.2984, device='cuda:3')
user_param_square tensor(107.3216, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-39.4416, device='cuda:3')
score : tensor(-0.4139, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.5856, device='cuda:3')
user_param_square tensor(114.5438, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-18.6979, device='cuda:3')
score : tensor(-0.2065, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.4907, device='cuda:3')
user_param_square tensor(109.6108, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(5.0814, device='cuda:3')
score : tensor(0.0313, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.9941, device='cuda:3')
user_param_square tensor(103.3635, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-21.2090, device='cuda:3')
score : tensor(-0.2316, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7612, device='cuda:3')
user_param_square tensor(110.6196, device='cuda:3')
global_param_square tensor(19.7124, device='cuda:3')
part1 is  tensor(-37.3476, device='cuda:3')
score : tensor(-0.3930, device='cuda:3')
len accept list 13
len all weights is 13
 
Avg Training Stats after 70 global rounds:
Train Accuracy: 89.96% 

Test Accuracy: 89.27% 


 | Global Training Round : 71 | 

current submit client idx and staleness is  0 1
 benign loss is  0.24898681044578552
distance x is tensor(105.7336, device='cuda:3')
benign distance is  tensor(105.7336, device='cuda:3')
norm1 res is  tensor(0.1178, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5553039312362671
distance x is tensor(120.4551, device='cuda:3')
benign distance is  tensor(120.4551, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2026941329240799
distance x is tensor(96.0044, device='cuda:3')
benign distance is  tensor(96.0044, device='cuda:3')
norm1 res is  tensor(0.1058, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.42894697189331055
distance x is tensor(107.5347, device='cuda:3')
benign distance is  tensor(107.5347, device='cuda:3')
norm1 res is  tensor(0.1180, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.47894638776779175
distance x is tensor(97.2050, device='cuda:3')
benign distance is  tensor(97.2050, device='cuda:3')
norm1 res is  tensor(0.1063, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.2283415049314499
distance x is tensor(125.1138, device='cuda:3')
benign distance is  tensor(125.1138, device='cuda:3')
norm1 res is  tensor(0.1367, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.30390435457229614
distance x is tensor(98.4483, device='cuda:3')
benign distance is  tensor(98.4483, device='cuda:3')
norm1 res is  tensor(0.1062, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.24247948825359344
distance x is tensor(110.0810, device='cuda:3')
benign distance is  tensor(110.0810, device='cuda:3')
norm1 res is  tensor(0.1233, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.2752986550331116
distance x is tensor(125.7570, device='cuda:3')
benign distance is  tensor(125.7570, device='cuda:3')
norm1 res is  tensor(0.1386, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.5422083139419556
distance x is tensor(121.5150, device='cuda:3')
benign distance is  tensor(121.5150, device='cuda:3')
norm1 res is  tensor(0.1356, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.1052999347448349
distance x is tensor(126.1998, device='cuda:3')
benign distance is  tensor(126.1998, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.2148270308971405
distance x is tensor(144.0732, device='cuda:3')
benign distance is  tensor(144.0732, device='cuda:3')
norm1 res is  tensor(0.1592, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.8148161172866821
distance x is tensor(138.1196, device='cuda:3')
benign distance is  tensor(138.1196, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.5079957842826843
distance x is tensor(135.4266, device='cuda:3')
benign distance is  tensor(135.4266, device='cuda:3')
norm1 res is  tensor(0.1494, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.16268345713615417
distance x is tensor(116.6915, device='cuda:3')
benign distance is  tensor(116.6915, device='cuda:3')
norm1 res is  tensor(0.1299, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.8105698823928833
distance x is tensor(133.9048, device='cuda:3')
benign distance is  tensor(133.9048, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.42936578392982483
distance x is tensor(123.9716, device='cuda:3')
benign distance is  tensor(123.9716, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.04892857372760773
distance x is tensor(139.1770, device='cuda:3')
benign distance is  tensor(139.1770, device='cuda:3')
norm1 res is  tensor(0.1538, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.4036238193511963
distance x is tensor(139.7283, device='cuda:3')
benign distance is  tensor(139.7283, device='cuda:3')
norm1 res is  tensor(0.1513, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.43990689516067505
distance x is tensor(123.8541, device='cuda:3')
benign distance is  tensor(123.8541, device='cuda:3')
norm1 res is  tensor(0.1356, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  1.1541712284088135
distance x is tensor(124.6700, device='cuda:3')
benign distance is  tensor(124.6700, device='cuda:3')
norm1 res is  tensor(0.1354, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.7860640287399292
distance x is tensor(121.3787, device='cuda:3')
benign distance is  tensor(121.3787, device='cuda:3')
norm1 res is  tensor(0.1319, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.3796258568763733
distance x is tensor(131.6679, device='cuda:3')
benign distance is  tensor(131.6679, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.2690204679965973
distance x is tensor(128.1538, device='cuda:3')
benign distance is  tensor(128.1538, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(123.0611, device='cuda:3')
compute distance is  tensor(123.0611, device='cuda:3')
compute norm is  tensor(65.8540, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.3763, device='cuda:3')
compute distance is  tensor(124.3763, device='cuda:3')
compute norm is  tensor(65.8804, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.4239, device='cuda:3')
compute distance is  tensor(143.4239, device='cuda:3')
compute norm is  tensor(66.2814, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1457, device='cuda:3')
compute distance is  tensor(128.1457, device='cuda:3')
compute norm is  tensor(65.9807, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1089, device='cuda:3')
compute distance is  tensor(125.1089, device='cuda:3')
compute norm is  tensor(65.9397, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.9389, device='cuda:3')
compute distance is  tensor(133.9389, device='cuda:3')
compute norm is  tensor(66.0994, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.2078, device='cuda:3')
compute distance is  tensor(124.2078, device='cuda:3')
compute norm is  tensor(65.9381, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.2839, device='cuda:3')
compute distance is  tensor(141.2839, device='cuda:3')
compute norm is  tensor(66.0529, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.8751, device='cuda:3')
compute distance is  tensor(150.8751, device='cuda:3')
compute norm is  tensor(66.2604, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.9418, device='cuda:3')
compute distance is  tensor(153.9418, device='cuda:3')
compute norm is  tensor(66.4020, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1493, device='cuda:3')
compute distance is  tensor(131.1493, device='cuda:3')
compute norm is  tensor(65.9736, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.5738, device='cuda:3')
compute distance is  tensor(140.5738, device='cuda:3')
compute norm is  tensor(66.1913, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(153.9418, device='cuda:3')
distance x is tensor(107591.8359, device='cuda:3')
distance x is tensor(107591.8359, device='cuda:3')
________________________________
test distance is  tensor(107591.8359, device='cuda:3')
test distance1 is  tensor(107591.8359, device='cuda:3')
test similarity is  tensor(0.4172, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130080540028622.33
test entropy is  0.0
________________________________
cal ratio is  0.03706933172117343
distance x is tensor(3988.3630, device='cuda:3')
cal_distance is  tensor(3988.3630, device='cuda:3')
cal ratio is  0.19253384235771717
distance x is tensor(767.8990, device='cuda:3')
cal_distance is  tensor(767.8990, device='cuda:3')
cal ratio is  0.43878560286531454
distance x is tensor(336.9459, device='cuda:3')
cal_distance is  tensor(336.9459, device='cuda:3')
cal ratio is  0.6624061351624314
distance x is tensor(223.1967, device='cuda:3')
cal_distance is  tensor(223.1967, device='cuda:3')
cal ratio is  0.8138802099135852
distance x is tensor(181.6564, device='cuda:3')
cal_distance is  tensor(181.6564, device='cuda:3')
cal ratio is  0.9021506995639161
distance x is tensor(163.8819, device='cuda:3')
cal_distance is  tensor(163.8819, device='cuda:3')
cal ratio is  0.9498147032372616
distance x is tensor(155.6577, device='cuda:3')
cal_distance is  tensor(155.6577, device='cuda:3')
cal ratio is  0.9745835940328191
distance x is tensor(151.7016, device='cuda:3')
cal_distance is  tensor(151.7016, device='cuda:3')
distance x is tensor(151.7016, device='cuda:3')
return_distance is  tensor(151.7016, device='cuda:3')
distance x is tensor(151.6914, device='cuda:3')
distance x is tensor(151.6914, device='cuda:3')
________________________________
test distance is  tensor(151.6914, device='cuda:3')
test distance1 is  tensor(151.6914, device='cuda:3')
test similarity is  tensor(0.9781, device='cuda:3')
test acc is  0.186883333489669
test loss is 71.48736222923945
test entropy is  0.020925829830438097
________________________________
0
distance x is tensor(151.6914, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.02087892739379848
avg test loss is  71.2776208889764
avg accuracy is  0.8774666668229888
solo acc is  0.1869000001563357
compute similarity  is  tensor(0.9781, device='cuda:3')
compute_distance is  tensor(151.6914, device='cuda:3')
compute_norm is  tensor(69.5897, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.8201, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9829110130191103
avg test loss is  1.445307782146214
avg accuracy is  0.7926000001563258
solo acc is  0.2987500001563395
compute similarity  is  tensor(0.9779, device='cuda:3')
compute_distance is  tensor(151.8201, device='cuda:3')
compute_norm is  tensor(69.2485, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(151.8201, device='cuda:3')
distance x is tensor(151.8201, device='cuda:3')
________________________________
test distance is  tensor(151.8201, device='cuda:3')
test distance1 is  tensor(151.8201, device='cuda:3')
test similarity is  tensor(0.9779, device='cuda:3')
test acc is  0.2990833334896728
test loss is 1.448235687162322
test entropy is  0.9839340004839623
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.375877022743225
mal norm is  tensor(762.4435, device='cuda:3')
distance x is tensor(151.8288, device='cuda:3')
mal distance is  tensor(151.8288, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(8.0740, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(467.1516, device='cuda:3')
user_param_square tensor(61.4150, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(20.2920, device='cuda:3')
score : tensor(0.1950, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.4319, device='cuda:3')
user_param_square tensor(65.3191, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(16.2467, device='cuda:3')
score : tensor(0.1546, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(413.5889, device='cuda:3')
user_param_square tensor(57.7870, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(8.9119, device='cuda:3')
score : tensor(0.0812, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(459.4267, device='cuda:3')
user_param_square tensor(60.9051, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(2.6973, device='cuda:3')
score : tensor(0.0191, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(419.7621, device='cuda:3')
user_param_square tensor(58.2166, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-11.0190, device='cuda:3')
score : tensor(-0.1181, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.2269, device='cuda:3')
user_param_square tensor(66.2271, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-0.2961, device='cuda:3')
score : tensor(-0.0108, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(419.5108, device='cuda:3')
user_param_square tensor(58.1992, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-2.6632, device='cuda:3')
score : tensor(-0.0345, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(486.5743, device='cuda:3')
user_param_square tensor(62.6787, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-7.8232, device='cuda:3')
score : tensor(-0.0861, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.4435, device='cuda:3')
user_param_square tensor(78.4602, device='cuda:3')
global_param_square tensor(8.0740, device='cuda:3')
part1 is  tensor(-1.4003, device='cuda:3')
score : tensor(-0.0219, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 71 global rounds:
Train Accuracy: 89.59% 

Test Accuracy: 89.03% 


 | Global Training Round : 72 | 

current submit client idx and staleness is  0 1
 benign loss is  0.44011563062667847
distance x is tensor(121.9744, device='cuda:3')
benign distance is  tensor(121.9744, device='cuda:3')
norm1 res is  tensor(0.1371, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4080653190612793
distance x is tensor(114.2032, device='cuda:3')
benign distance is  tensor(114.2032, device='cuda:3')
norm1 res is  tensor(0.1276, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.11162613332271576
distance x is tensor(84.6726, device='cuda:3')
benign distance is  tensor(84.6726, device='cuda:3')
norm1 res is  tensor(0.0934, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.44457778334617615
distance x is tensor(129.9096, device='cuda:3')
benign distance is  tensor(129.9096, device='cuda:3')
norm1 res is  tensor(0.1451, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.2572050094604492
distance x is tensor(104.9153, device='cuda:3')
benign distance is  tensor(104.9153, device='cuda:3')
norm1 res is  tensor(0.1122, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6215161085128784
distance x is tensor(134.6726, device='cuda:3')
benign distance is  tensor(134.6726, device='cuda:3')
norm1 res is  tensor(0.1499, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.40445414185523987
distance x is tensor(117.8641, device='cuda:3')
benign distance is  tensor(117.8641, device='cuda:3')
norm1 res is  tensor(0.1280, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.11851350963115692
distance x is tensor(124.0865, device='cuda:3')
benign distance is  tensor(124.0865, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(134.2524, device='cuda:3')
compute distance is  tensor(134.2524, device='cuda:3')
compute norm is  tensor(66.3095, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6350, device='cuda:3')
compute distance is  tensor(134.6350, device='cuda:3')
compute norm is  tensor(66.3684, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1895, device='cuda:3')
compute distance is  tensor(143.1895, device='cuda:3')
compute norm is  tensor(66.5336, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1777, device='cuda:3')
compute distance is  tensor(137.1777, device='cuda:3')
compute norm is  tensor(66.3347, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.9298, device='cuda:3')
compute distance is  tensor(141.9298, device='cuda:3')
compute norm is  tensor(66.5541, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.6563, device='cuda:3')
compute distance is  tensor(149.6563, device='cuda:3')
compute norm is  tensor(66.4928, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4504, device='cuda:3')
compute distance is  tensor(134.4504, device='cuda:3')
compute norm is  tensor(66.4613, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6598, device='cuda:3')
compute distance is  tensor(131.6598, device='cuda:3')
compute norm is  tensor(66.4289, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.8189, device='cuda:3')
compute distance is  tensor(146.8189, device='cuda:3')
compute norm is  tensor(66.5202, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.5084, device='cuda:3')
compute distance is  tensor(141.5084, device='cuda:3')
compute norm is  tensor(66.7295, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.4539, device='cuda:3')
compute distance is  tensor(142.4539, device='cuda:3')
compute norm is  tensor(66.4926, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2668, device='cuda:3')
compute distance is  tensor(135.2668, device='cuda:3')
compute norm is  tensor(66.4600, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.6563, device='cuda:3')
distance x is tensor(107593.0938, device='cuda:3')
distance x is tensor(107593.0938, device='cuda:3')
________________________________
test distance is  tensor(107593.0938, device='cuda:3')
test distance1 is  tensor(107593.0938, device='cuda:3')
test similarity is  tensor(0.4117, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130159061647464.8
test entropy is  0.0
________________________________
cal ratio is  0.03654949267556392
distance x is tensor(3932.4790, device='cuda:3')
cal_distance is  tensor(3932.4790, device='cuda:3')
cal ratio is  0.19117907260351458
distance x is tensor(751.8118, device='cuda:3')
cal_distance is  tensor(751.8118, device='cuda:3')
cal ratio is  0.43723910282132084
distance x is tensor(328.7244, device='cuda:3')
cal_distance is  tensor(328.7244, device='cuda:3')
cal ratio is  0.661237652254106
distance x is tensor(217.3667, device='cuda:3')
cal_distance is  tensor(217.3667, device='cuda:3')
cal ratio is  0.8131619832060444
distance x is tensor(176.7553, device='cuda:3')
cal_distance is  tensor(176.7553, device='cuda:3')
cal ratio is  0.9017525066428672
distance x is tensor(159.3900, device='cuda:3')
cal_distance is  tensor(159.3900, device='cuda:3')
cal ratio is  0.9496049141129821
distance x is tensor(151.3578, device='cuda:3')
cal_distance is  tensor(151.3578, device='cuda:3')
cal ratio is  0.9744759228175107
distance x is tensor(147.4947, device='cuda:3')
cal_distance is  tensor(147.4947, device='cuda:3')
distance x is tensor(147.4947, device='cuda:3')
return_distance is  tensor(147.4947, device='cuda:3')
distance x is tensor(147.4845, device='cuda:3')
distance x is tensor(147.4845, device='cuda:3')
________________________________
test distance is  tensor(147.4845, device='cuda:3')
test distance1 is  tensor(147.4845, device='cuda:3')
test similarity is  tensor(0.9792, device='cuda:3')
test acc is  0.16330000015633417
test loss is 79.40285101526581
test entropy is  0.016199033457224166
________________________________
0
distance x is tensor(147.4845, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.015634072191721842
avg test loss is  79.28073207960962
avg accuracy is  0.869216666822989
solo acc is  0.1616500001563341
compute similarity  is  tensor(0.9792, device='cuda:3')
compute_distance is  tensor(147.4845, device='cuda:3')
compute_norm is  tensor(69.8284, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(148.5938, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9791681613368012
avg test loss is  1.4638601840177834
avg accuracy is  0.8011000001563253
solo acc is  0.2996000001563395
compute similarity  is  tensor(0.9789, device='cuda:3')
compute_distance is  tensor(148.5938, device='cuda:3')
compute_norm is  tensor(69.4601, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(149.7162, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9211116635850244
avg test loss is  1.5225374030151855
avg accuracy is  0.7997000001563253
solo acc is  0.24973333348967158
compute similarity  is  tensor(0.9787, device='cuda:3')
compute_distance is  tensor(149.7162, device='cuda:3')
compute_norm is  tensor(69.1100, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(149.7162, device='cuda:3')
distance x is tensor(149.7162, device='cuda:3')
________________________________
test distance is  tensor(149.7162, device='cuda:3')
test distance1 is  tensor(149.7162, device='cuda:3')
test similarity is  tensor(0.9787, device='cuda:3')
test acc is  0.2501333334896716
test loss is 1.525719672377938
test entropy is  0.9216305630039304
________________________________
cal ratio is  0.9798037725927276
distance x is tensor(146.7011, device='cuda:3')
cal_distance is  tensor(146.7011, device='cuda:3')
distance x is tensor(146.7011, device='cuda:3')
return_distance is  tensor(146.7011, device='cuda:3')
distance x is tensor(146.6924, device='cuda:3')
distance x is tensor(146.6924, device='cuda:3')
________________________________
test distance is  tensor(146.6924, device='cuda:3')
test distance1 is  tensor(146.6924, device='cuda:3')
test similarity is  tensor(0.9794, device='cuda:3')
test acc is  0.2694166668230055
test loss is 1.473407450515324
test entropy is  0.9502599260319017
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3810758590698242
mal norm is  tensor(721.1131, device='cuda:3')
distance x is tensor(146.7011, device='cuda:3')
mal distance is  tensor(146.7011, device='cuda:3')
len current grad  20
len all grad 52
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(13.7469, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.8243, device='cuda:3')
user_param_square tensor(86.1448, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-9.9287, device='cuda:3')
score : tensor(-0.1128, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.2426, device='cuda:3')
user_param_square tensor(82.7606, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-9.0969, device='cuda:3')
score : tensor(-0.1045, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(370.1009, device='cuda:3')
user_param_square tensor(71.3285, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(22.9014, device='cuda:3')
score : tensor(0.2155, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.6556, device='cuda:3')
user_param_square tensor(88.7258, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-7.0431, device='cuda:3')
score : tensor(-0.0840, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(438.7979, device='cuda:3')
user_param_square tensor(77.6668, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-6.1780, device='cuda:3')
score : tensor(-0.0753, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.5739, device='cuda:3')
user_param_square tensor(90.4078, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(0.4856, device='cuda:3')
score : tensor(-0.0087, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.5791, device='cuda:3')
user_param_square tensor(83.2026, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(9.2617, device='cuda:3')
score : tensor(0.0791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.9402, device='cuda:3')
user_param_square tensor(85.8344, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(1.6397, device='cuda:3')
score : tensor(0.0028, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.1131, device='cuda:3')
user_param_square tensor(99.5646, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-39.0862, device='cuda:3')
score : tensor(-0.4044, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.2496, device='cuda:3')
user_param_square tensor(93.5961, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-21.5643, device='cuda:3')
score : tensor(-0.2292, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.2135, device='cuda:3')
user_param_square tensor(92.7821, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-7.9025, device='cuda:3')
score : tensor(-0.0926, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0918, device='cuda:3')
user_param_square tensor(90.9776, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-7.9866, device='cuda:3')
score : tensor(-0.0934, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.6488, device='cuda:3')
user_param_square tensor(92.0708, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(4.1836, device='cuda:3')
score : tensor(0.0283, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.5884, device='cuda:3')
user_param_square tensor(88.5655, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-6.0324, device='cuda:3')
score : tensor(-0.0739, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.9570, device='cuda:3')
user_param_square tensor(93.1328, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-26.2706, device='cuda:3')
score : tensor(-0.2763, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.1650, device='cuda:3')
user_param_square tensor(89.9192, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-12.4876, device='cuda:3')
score : tensor(-0.1384, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.5949, device='cuda:3')
user_param_square tensor(93.4009, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(17.1531, device='cuda:3')
score : tensor(0.1580, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.4414, device='cuda:3')
user_param_square tensor(95.3561, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(14.6598, device='cuda:3')
score : tensor(0.1331, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.2120, device='cuda:3')
user_param_square tensor(89.2322, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-23.6644, device='cuda:3')
score : tensor(-0.2502, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.9840, device='cuda:3')
user_param_square tensor(92.2450, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-10.9327, device='cuda:3')
score : tensor(-0.1229, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.4971, device='cuda:3')
user_param_square tensor(93.5408, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-20.1196, device='cuda:3')
score : tensor(-0.2147, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.6786, device='cuda:3')
user_param_square tensor(91.0974, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-18.6894, device='cuda:3')
score : tensor(-0.2004, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.3096, device='cuda:3')
user_param_square tensor(94.9131, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(11.1984, device='cuda:3')
score : tensor(0.0984, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.9701, device='cuda:3')
user_param_square tensor(94.4529, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-25.1219, device='cuda:3')
score : tensor(-0.2648, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.1982, device='cuda:3')
user_param_square tensor(90.7587, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-15.4577, device='cuda:3')
score : tensor(-0.1681, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.3407, device='cuda:3')
user_param_square tensor(91.4485, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-16.1563, device='cuda:3')
score : tensor(-0.1751, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.7360, device='cuda:3')
user_param_square tensor(97.3037, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-1.2970, device='cuda:3')
score : tensor(-0.0265, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.7343, device='cuda:3')
user_param_square tensor(93.9980, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(2.2354, device='cuda:3')
score : tensor(0.0088, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.1645, device='cuda:3')
user_param_square tensor(91.8852, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(4.9273, device='cuda:3')
score : tensor(0.0357, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.4031, device='cuda:3')
user_param_square tensor(89.0928, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(2.7496, device='cuda:3')
score : tensor(0.0139, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.0541, device='cuda:3')
user_param_square tensor(92.6220, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-2.6124, device='cuda:3')
score : tensor(-0.0397, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.3144, device='cuda:3')
user_param_square tensor(93.0115, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-7.2730, device='cuda:3')
score : tensor(-0.0863, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.6964, device='cuda:3')
user_param_square tensor(91.4000, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-23.3319, device='cuda:3')
score : tensor(-0.2469, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.1071, device='cuda:3')
user_param_square tensor(89.1471, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(10.5408, device='cuda:3')
score : tensor(0.0919, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.8891, device='cuda:3')
user_param_square tensor(87.9659, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-27.1857, device='cuda:3')
score : tensor(-0.2854, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.1693, device='cuda:3')
user_param_square tensor(88.9976, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(19.0733, device='cuda:3')
score : tensor(0.1772, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.9252, device='cuda:3')
user_param_square tensor(95.1746, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-16.9840, device='cuda:3')
score : tensor(-0.1834, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.5839, device='cuda:3')
user_param_square tensor(92.5128, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-2.7536, device='cuda:3')
score : tensor(-0.0411, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.9171, device='cuda:3')
user_param_square tensor(92.2400, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-21.5940, device='cuda:3')
score : tensor(-0.2295, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.8337, device='cuda:3')
user_param_square tensor(86.3050, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-13.6275, device='cuda:3')
score : tensor(-0.1498, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.5702, device='cuda:3')
user_param_square tensor(91.3905, device='cuda:3')
global_param_square tensor(13.7469, device='cuda:3')
part1 is  tensor(-22.0703, device='cuda:3')
score : tensor(-0.2343, device='cuda:3')
len accept list 12
len all weights is 12
 
Avg Training Stats after 72 global rounds:
Train Accuracy: 89.98% 

Test Accuracy: 89.14% 


 | Global Training Round : 73 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6530763506889343
distance x is tensor(134.1137, device='cuda:3')
benign distance is  tensor(134.1137, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.07945765554904938
distance x is tensor(118.3959, device='cuda:3')
benign distance is  tensor(118.3959, device='cuda:3')
norm1 res is  tensor(0.1307, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3082852363586426
distance x is tensor(89.4586, device='cuda:3')
benign distance is  tensor(89.4586, device='cuda:3')
norm1 res is  tensor(0.1008, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.38190993666648865
distance x is tensor(110.6640, device='cuda:3')
benign distance is  tensor(110.6640, device='cuda:3')
norm1 res is  tensor(0.1196, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.640026867389679
distance x is tensor(130.5927, device='cuda:3')
benign distance is  tensor(130.5927, device='cuda:3')
norm1 res is  tensor(0.1465, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.08587884157896042
distance x is tensor(136.0509, device='cuda:3')
benign distance is  tensor(136.0509, device='cuda:3')
norm1 res is  tensor(0.1489, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.3905096650123596
distance x is tensor(88.7056, device='cuda:3')
benign distance is  tensor(88.7056, device='cuda:3')
norm1 res is  tensor(0.0952, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.1643468141555786
distance x is tensor(109.5018, device='cuda:3')
benign distance is  tensor(109.5018, device='cuda:3')
norm1 res is  tensor(0.1231, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.170328751206398
distance x is tensor(132.7334, device='cuda:3')
benign distance is  tensor(132.7334, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.45418691635131836
distance x is tensor(128.2039, device='cuda:3')
benign distance is  tensor(128.2039, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.38412585854530334
distance x is tensor(113.7470, device='cuda:3')
benign distance is  tensor(113.7470, device='cuda:3')
norm1 res is  tensor(0.1246, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.2989796996116638
distance x is tensor(149.1192, device='cuda:3')
benign distance is  tensor(149.1192, device='cuda:3')
norm1 res is  tensor(0.1652, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.339238703250885
distance x is tensor(123.5809, device='cuda:3')
benign distance is  tensor(123.5809, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.19381697475910187
distance x is tensor(134.5541, device='cuda:3')
benign distance is  tensor(134.5541, device='cuda:3')
norm1 res is  tensor(0.1470, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4156073033809662
distance x is tensor(117.9866, device='cuda:3')
benign distance is  tensor(117.9866, device='cuda:3')
norm1 res is  tensor(0.1309, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.44516411423683167
distance x is tensor(132.8492, device='cuda:3')
benign distance is  tensor(132.8492, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.18788084387779236
distance x is tensor(138.7773, device='cuda:3')
benign distance is  tensor(138.7773, device='cuda:3')
norm1 res is  tensor(0.1578, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.19054622948169708
distance x is tensor(138.8037, device='cuda:3')
benign distance is  tensor(138.8037, device='cuda:3')
norm1 res is  tensor(0.1537, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.4142679274082184
distance x is tensor(142.8347, device='cuda:3')
benign distance is  tensor(142.8347, device='cuda:3')
norm1 res is  tensor(0.1577, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.20326904952526093
distance x is tensor(134.1490, device='cuda:3')
benign distance is  tensor(134.1490, device='cuda:3')
norm1 res is  tensor(0.1483, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.6125594973564148
distance x is tensor(126.6783, device='cuda:3')
benign distance is  tensor(126.6783, device='cuda:3')
norm1 res is  tensor(0.1394, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.27207431197166443
distance x is tensor(135.2531, device='cuda:3')
benign distance is  tensor(135.2531, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.49729031324386597
distance x is tensor(144.0670, device='cuda:3')
benign distance is  tensor(144.0670, device='cuda:3')
norm1 res is  tensor(0.1592, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.19132137298583984
distance x is tensor(127.3171, device='cuda:3')
benign distance is  tensor(127.3171, device='cuda:3')
norm1 res is  tensor(0.1349, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.25428611040115356
distance x is tensor(140.9672, device='cuda:3')
benign distance is  tensor(140.9672, device='cuda:3')
norm1 res is  tensor(0.1568, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.5377448797225952
distance x is tensor(127.4508, device='cuda:3')
benign distance is  tensor(127.4508, device='cuda:3')
norm1 res is  tensor(0.1392, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.3442437946796417
distance x is tensor(144.3748, device='cuda:3')
benign distance is  tensor(144.3748, device='cuda:3')
norm1 res is  tensor(0.1604, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.2534492015838623
distance x is tensor(139.2106, device='cuda:3')
benign distance is  tensor(139.2106, device='cuda:3')
norm1 res is  tensor(0.1481, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.45861053466796875
distance x is tensor(129.2521, device='cuda:3')
benign distance is  tensor(129.2521, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.6836193799972534
distance x is tensor(133.0306, device='cuda:3')
benign distance is  tensor(133.0306, device='cuda:3')
norm1 res is  tensor(0.1491, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.4135870933532715
distance x is tensor(122.3518, device='cuda:3')
benign distance is  tensor(122.3518, device='cuda:3')
norm1 res is  tensor(0.1373, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.3454846739768982
distance x is tensor(124.4529, device='cuda:3')
benign distance is  tensor(124.4529, device='cuda:3')
norm1 res is  tensor(0.1394, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.24115189909934998
distance x is tensor(128.0105, device='cuda:3')
benign distance is  tensor(128.0105, device='cuda:3')
norm1 res is  tensor(0.1405, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.19138450920581818
distance x is tensor(127.7159, device='cuda:3')
benign distance is  tensor(127.7159, device='cuda:3')
norm1 res is  tensor(0.1418, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.08596034348011017
distance x is tensor(119.4243, device='cuda:3')
benign distance is  tensor(119.4243, device='cuda:3')
norm1 res is  tensor(0.1344, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.17508511245250702
distance x is tensor(130.5209, device='cuda:3')
benign distance is  tensor(130.5209, device='cuda:3')
norm1 res is  tensor(0.1488, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.3604414463043213
distance x is tensor(120.8903, device='cuda:3')
benign distance is  tensor(120.8903, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.521072268486023
distance x is tensor(151.1580, device='cuda:3')
benign distance is  tensor(151.1580, device='cuda:3')
norm1 res is  tensor(0.1593, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.9000245928764343
distance x is tensor(137.5608, device='cuda:3')
benign distance is  tensor(137.5608, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.5606260299682617
distance x is tensor(151.9415, device='cuda:3')
benign distance is  tensor(151.9415, device='cuda:3')
norm1 res is  tensor(0.1708, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(118.2400, device='cuda:3')
compute distance is  tensor(118.2400, device='cuda:3')
compute norm is  tensor(66.1280, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1248, device='cuda:3')
compute distance is  tensor(132.1248, device='cuda:3')
compute norm is  tensor(66.3183, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.0022, device='cuda:3')
compute distance is  tensor(136.0022, device='cuda:3')
compute norm is  tensor(66.3499, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.6207, device='cuda:3')
compute distance is  tensor(124.6207, device='cuda:3')
compute norm is  tensor(66.2625, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6907, device='cuda:3')
compute distance is  tensor(138.6907, device='cuda:3')
compute norm is  tensor(66.4346, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3477, device='cuda:3')
compute distance is  tensor(140.3477, device='cuda:3')
compute norm is  tensor(66.5467, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5918, device='cuda:3')
compute distance is  tensor(130.5918, device='cuda:3')
compute norm is  tensor(66.3225, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2505, device='cuda:3')
compute distance is  tensor(130.2505, device='cuda:3')
compute norm is  tensor(66.3205, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.5127, device='cuda:3')
compute distance is  tensor(147.5127, device='cuda:3')
compute norm is  tensor(66.6452, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7265, device='cuda:3')
compute distance is  tensor(136.7265, device='cuda:3')
compute norm is  tensor(66.4999, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3087, device='cuda:3')
compute distance is  tensor(137.3087, device='cuda:3')
compute norm is  tensor(66.4280, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0172, device='cuda:3')
compute distance is  tensor(127.0172, device='cuda:3')
compute norm is  tensor(66.3014, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.5127, device='cuda:3')
distance x is tensor(107594.6250, device='cuda:3')
distance x is tensor(107594.6250, device='cuda:3')
________________________________
test distance is  tensor(107594.6250, device='cuda:3')
test distance1 is  tensor(107594.6250, device='cuda:3')
test similarity is  tensor(0.4112, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130061409861736.8
test entropy is  0.0
________________________________
cal ratio is  0.036286533320059704
distance x is tensor(3904.2415, device='cuda:3')
cal_distance is  tensor(3904.2415, device='cuda:3')
cal ratio is  0.19049011136500513
distance x is tensor(743.7236, device='cuda:3')
cal_distance is  tensor(743.7236, device='cuda:3')
cal ratio is  0.43645050192554
distance x is tensor(324.6014, device='cuda:3')
cal_distance is  tensor(324.6014, device='cuda:3')
cal ratio is  0.660641100668335
distance x is tensor(214.4468, device='cuda:3')
cal_distance is  tensor(214.4468, device='cuda:3')
cal ratio is  0.8127949903509539
distance x is tensor(174.3022, device='cuda:3')
cal_distance is  tensor(174.3022, device='cuda:3')
cal ratio is  0.9015489630517544
distance x is tensor(157.1425, device='cuda:3')
cal_distance is  tensor(157.1425, device='cuda:3')
cal ratio is  0.9494977262604313
distance x is tensor(149.2067, device='cuda:3')
cal_distance is  tensor(149.2067, device='cuda:3')
cal ratio is  0.974420907809126
distance x is tensor(145.3903, device='cuda:3')
cal_distance is  tensor(145.3903, device='cuda:3')
distance x is tensor(145.3903, device='cuda:3')
return_distance is  tensor(145.3903, device='cuda:3')
distance x is tensor(145.3801, device='cuda:3')
distance x is tensor(145.3801, device='cuda:3')
________________________________
test distance is  tensor(145.3801, device='cuda:3')
test distance1 is  tensor(145.3801, device='cuda:3')
test similarity is  tensor(0.9796, device='cuda:3')
test acc is  0.18428333348966885
test loss is 66.38289404017077
test entropy is  0.020759592129434557
________________________________
0
distance x is tensor(145.3801, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.02099292077386934
avg test loss is  66.52136496846865
avg accuracy is  0.8765166668229889
solo acc is  0.18291666682300212
compute similarity  is  tensor(0.9796, device='cuda:3')
compute_distance is  tensor(145.3801, device='cuda:3')
compute_norm is  tensor(69.6520, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.0021, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9662861419893277
avg test loss is  1.426774512348907
avg accuracy is  0.8111500001563248
solo acc is  0.3082833334896731
compute similarity  is  tensor(0.9792, device='cuda:3')
compute_distance is  tensor(147.0021, device='cuda:3')
compute_norm is  tensor(69.2586, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.1076, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9114941361743504
avg test loss is  1.5141242611636994
avg accuracy is  0.8081833334896584
solo acc is  0.24766666682300484
compute similarity  is  tensor(0.9790, device='cuda:3')
compute_distance is  tensor(148.1076, device='cuda:3')
compute_norm is  tensor(68.9072, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.7470, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8987762612193378
avg test loss is  1.4741915347479553
avg accuracy is  0.8119166668229916
solo acc is  0.24948333348967155
compute similarity  is  tensor(0.9788, device='cuda:3')
compute_distance is  tensor(148.7470, device='cuda:3')
compute_norm is  tensor(68.5641, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(149.4054, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8888871537596941
avg test loss is  1.463105390956407
avg accuracy is  0.8147500001563248
solo acc is  0.23686666682300442
compute similarity  is  tensor(0.9787, device='cuda:3')
compute_distance is  tensor(149.4054, device='cuda:3')
compute_norm is  tensor(68.2255, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(150.0949, device='cuda:3')
distance x is tensor(150.0949, device='cuda:3')
________________________________
test distance is  tensor(150.0949, device='cuda:3')
test distance1 is  tensor(150.0949, device='cuda:3')
test similarity is  tensor(0.9785, device='cuda:3')
test acc is  0.24043333348967125
test loss is 1.4385140676742423
test entropy is  0.8777892421811883
________________________________
cal ratio is  0.9715334151421583
distance x is tensor(145.8309, device='cuda:3')
cal_distance is  tensor(145.8309, device='cuda:3')
distance x is tensor(145.8309, device='cuda:3')
return_distance is  tensor(145.8309, device='cuda:3')
distance x is tensor(145.8221, device='cuda:3')
distance x is tensor(145.8221, device='cuda:3')
________________________________
test distance is  tensor(145.8221, device='cuda:3')
test distance1 is  tensor(145.8221, device='cuda:3')
test similarity is  tensor(0.9796, device='cuda:3')
test acc is  0.28055000015633913
test loss is 1.3564667190824236
test entropy is  0.9248178466550832
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2996976375579834
mal norm is  tensor(689.0257, device='cuda:3')
distance x is tensor(145.8309, device='cuda:3')
mal distance is  tensor(145.8309, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(8.5209, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.8879, device='cuda:3')
user_param_square tensor(71.0771, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(0.3740, device='cuda:3')
score : tensor(-0.0046, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.2245, device='cuda:3')
user_param_square tensor(66.3870, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(4.5055, device='cuda:3')
score : tensor(0.0367, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(386.4485, device='cuda:3')
user_param_square tensor(57.3838, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(3.5522, device='cuda:3')
score : tensor(0.0272, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.8729, device='cuda:3')
user_param_square tensor(63.4098, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-4.3292, device='cuda:3')
score : tensor(-0.0516, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.1368, device='cuda:3')
user_param_square tensor(68.8390, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-8.1963, device='cuda:3')
score : tensor(-0.0903, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.8823, device='cuda:3')
user_param_square tensor(70.5956, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(2.8954, device='cuda:3')
score : tensor(0.0206, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(372.5897, device='cuda:3')
user_param_square tensor(56.3455, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(8.2638, device='cuda:3')
score : tensor(0.0743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(487.3404, device='cuda:3')
user_param_square tensor(64.4406, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-2.3427, device='cuda:3')
score : tensor(-0.0317, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0257, device='cuda:3')
user_param_square tensor(76.6234, device='cuda:3')
global_param_square tensor(8.5209, device='cuda:3')
part1 is  tensor(-12.8177, device='cuda:3')
score : tensor(-0.1365, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 73 global rounds:
Train Accuracy: 89.73% 

Test Accuracy: 89.06% 


 | Global Training Round : 74 | 

current submit client idx and staleness is  0 1
 benign loss is  0.14751875400543213
distance x is tensor(125.9424, device='cuda:3')
benign distance is  tensor(125.9424, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3465344309806824
distance x is tensor(103.2149, device='cuda:3')
benign distance is  tensor(103.2149, device='cuda:3')
norm1 res is  tensor(0.1142, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.14822077751159668
distance x is tensor(88.1753, device='cuda:3')
benign distance is  tensor(88.1753, device='cuda:3')
norm1 res is  tensor(0.0984, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.46961742639541626
distance x is tensor(121.9003, device='cuda:3')
benign distance is  tensor(121.9003, device='cuda:3')
norm1 res is  tensor(0.1342, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5590295791625977
distance x is tensor(130.5826, device='cuda:3')
benign distance is  tensor(130.5826, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7771779298782349
distance x is tensor(120.3529, device='cuda:3')
benign distance is  tensor(120.3529, device='cuda:3')
norm1 res is  tensor(0.1327, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.46105727553367615
distance x is tensor(100.7276, device='cuda:3')
benign distance is  tensor(100.7276, device='cuda:3')
norm1 res is  tensor(0.1108, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.10513607412576675
distance x is tensor(123.2428, device='cuda:3')
benign distance is  tensor(123.2428, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(127.7811, device='cuda:3')
compute distance is  tensor(127.7811, device='cuda:3')
compute norm is  tensor(66.6385, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.0794, device='cuda:3')
compute distance is  tensor(138.0794, device='cuda:3')
compute norm is  tensor(66.6975, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.8044, device='cuda:3')
compute distance is  tensor(143.8044, device='cuda:3')
compute norm is  tensor(66.8821, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3926, device='cuda:3')
compute distance is  tensor(137.3926, device='cuda:3')
compute norm is  tensor(66.8103, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.8742, device='cuda:3')
compute distance is  tensor(148.8742, device='cuda:3')
compute norm is  tensor(66.8079, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.6353, device='cuda:3')
compute distance is  tensor(162.6353, device='cuda:3')
compute norm is  tensor(67.3558, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.7796, device='cuda:3')
compute distance is  tensor(135.7796, device='cuda:3')
compute norm is  tensor(66.7171, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5880, device='cuda:3')
compute distance is  tensor(133.5880, device='cuda:3')
compute norm is  tensor(66.7115, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.7767, device='cuda:3')
compute distance is  tensor(148.7767, device='cuda:3')
compute norm is  tensor(66.8358, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1746, device='cuda:3')
compute distance is  tensor(143.1746, device='cuda:3')
compute norm is  tensor(66.8404, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9487, device='cuda:3')
compute distance is  tensor(142.9487, device='cuda:3')
compute norm is  tensor(66.8492, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.5693, device='cuda:3')
compute distance is  tensor(147.5693, device='cuda:3')
compute norm is  tensor(66.9153, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(162.6353, device='cuda:3')
distance x is tensor(107597.9688, device='cuda:3')
distance x is tensor(107597.9688, device='cuda:3')
________________________________
test distance is  tensor(107597.9688, device='cuda:3')
test distance1 is  tensor(107597.9688, device='cuda:3')
test similarity is  tensor(0.4058, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130086903261773.52
test entropy is  0.0
________________________________
cal ratio is  0.03810056390936466
distance x is tensor(4099.5483, device='cuda:3')
cal_distance is  tensor(4099.5483, device='cuda:3')
cal ratio is  0.19519354150139304
distance x is tensor(800.2095, device='cuda:3')
cal_distance is  tensor(800.2095, device='cuda:3')
cal ratio is  0.44180597394078114
distance x is tensor(353.5402, device='cuda:3')
cal_distance is  tensor(353.5402, device='cuda:3')
cal ratio is  0.6646821887616088
distance x is tensor(234.9936, device='cuda:3')
cal_distance is  tensor(234.9936, device='cuda:3')
cal ratio is  0.8152774119694929
distance x is tensor(191.5859, device='cuda:3')
cal_distance is  tensor(191.5859, device='cuda:3')
cal ratio is  0.9029249081956516
distance x is tensor(172.9882, device='cuda:3')
cal_distance is  tensor(172.9882, device='cuda:3')
cal ratio is  0.9502222144840017
distance x is tensor(164.3775, device='cuda:3')
cal_distance is  tensor(164.3775, device='cuda:3')
cal ratio is  0.9747927053605935
distance x is tensor(160.2341, device='cuda:3')
cal_distance is  tensor(160.2341, device='cuda:3')
distance x is tensor(160.2341, device='cuda:3')
return_distance is  tensor(160.2341, device='cuda:3')
distance x is tensor(160.2239, device='cuda:3')
distance x is tensor(160.2239, device='cuda:3')
________________________________
test distance is  tensor(160.2239, device='cuda:3')
test distance1 is  tensor(160.2239, device='cuda:3')
test similarity is  tensor(0.9759, device='cuda:3')
test acc is  0.12343333348966525
test loss is 139.6224259333824
test entropy is  0.005631595107747707
________________________________
0
distance x is tensor(160.2239, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.005126612622199028
avg test loss is  139.15521838060067
avg accuracy is  0.84621666682299
solo acc is  0.12400000015633192
compute similarity  is  tensor(0.9759, device='cuda:3')
compute_distance is  tensor(160.2239, device='cuda:3')
compute_norm is  tensor(70.5540, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.8817, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0315151497372177
avg test loss is  1.5516448876242648
avg accuracy is  0.753483333489661
solo acc is  0.27428333348967227
compute similarity  is  tensor(0.9754, device='cuda:3')
compute_distance is  tensor(160.8817, device='cuda:3')
compute_norm is  tensor(70.4297, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.8596, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6542765571872817
avg test loss is  2.4624735510933884
avg accuracy is  0.6930833334896644
solo acc is  0.11465000015633194
compute similarity  is  tensor(0.9750, device='cuda:3')
compute_distance is  tensor(162.8596, device='cuda:3')
compute_norm is  tensor(70.1244, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.5053, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9974412311241825
avg test loss is  1.455834015854386
avg accuracy is  0.751183333489661
solo acc is  0.26700000015633873
compute similarity  is  tensor(0.9749, device='cuda:3')
compute_distance is  tensor(163.5053, device='cuda:3')
compute_norm is  tensor(69.7663, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(163.5053, device='cuda:3')
distance x is tensor(163.5053, device='cuda:3')
________________________________
test distance is  tensor(163.5053, device='cuda:3')
test distance1 is  tensor(163.5053, device='cuda:3')
test similarity is  tensor(0.9749, device='cuda:3')
test acc is  0.2667666668230053
test loss is 1.4536144256845975
test entropy is  0.9957184564075998
________________________________
cal ratio is  0.9773892489788847
distance x is tensor(159.8169, device='cuda:3')
cal_distance is  tensor(159.8169, device='cuda:3')
distance x is tensor(159.8169, device='cuda:3')
return_distance is  tensor(159.8169, device='cuda:3')
distance x is tensor(159.8082, device='cuda:3')
distance x is tensor(159.8082, device='cuda:3')
________________________________
test distance is  tensor(159.8082, device='cuda:3')
test distance1 is  tensor(159.8082, device='cuda:3')
test similarity is  tensor(0.9759, device='cuda:3')
test acc is  0.27921666682300567
test loss is 1.4255212634357053
test entropy is  1.027070429787707
________________________________
0
distance x is tensor(159.8082, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0265009630082258
avg test loss is  1.4266409483799802
avg accuracy is  0.7635166668229938
solo acc is  0.2791666668230057
compute similarity  is  tensor(0.9759, device='cuda:3')
compute_distance is  tensor(159.8082, device='cuda:3')
compute_norm is  tensor(69.6431, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.3451, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6071784893142135
avg test loss is  2.341211209037919
avg accuracy is  0.7109666668229966
solo acc is  0.11195000015633194
compute similarity  is  tensor(0.9756, device='cuda:3')
compute_distance is  tensor(161.3451, device='cuda:3')
compute_norm is  tensor(69.3486, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.6858, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9487667661358807
avg test loss is  1.4192549249510775
avg accuracy is  0.7698333334896602
solo acc is  0.2663666668230054
compute similarity  is  tensor(0.9756, device='cuda:3')
compute_distance is  tensor(161.6858, device='cuda:3')
compute_norm is  tensor(68.9933, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(161.6858, device='cuda:3')
distance x is tensor(161.6858, device='cuda:3')
________________________________
test distance is  tensor(161.6858, device='cuda:3')
test distance1 is  tensor(161.6858, device='cuda:3')
test similarity is  tensor(0.9756, device='cuda:3')
test acc is  0.265033333489672
test loss is 1.4178392846447063
test entropy is  0.9496515423123008
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.303600788116455
mal norm is  tensor(769.2413, device='cuda:3')
distance x is tensor(161.6945, device='cuda:3')
mal distance is  tensor(161.6945, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(18.5953, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.8414, device='cuda:3')
user_param_square tensor(100.5630, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-13.4126, device='cuda:3')
score : tensor(-0.1525, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(449.0874, device='cuda:3')
user_param_square tensor(91.3834, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-56.9646, device='cuda:3')
score : tensor(-0.5880, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(388.3542, device='cuda:3')
user_param_square tensor(84.9799, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(32.7542, device='cuda:3')
score : tensor(0.3091, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.9858, device='cuda:3')
user_param_square tensor(98.7102, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(60.4667, device='cuda:3')
score : tensor(0.5863, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.3708, device='cuda:3')
user_param_square tensor(102.1708, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-27.6056, device='cuda:3')
score : tensor(-0.2945, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.2271, device='cuda:3')
user_param_square tensor(99.1088, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-18.3265, device='cuda:3')
score : tensor(-0.2017, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(433.0002, device='cuda:3')
user_param_square tensor(89.7318, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(18.3331, device='cuda:3')
score : tensor(0.1649, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.8028, device='cuda:3')
user_param_square tensor(99.9101, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(20.4290, device='cuda:3')
score : tensor(0.1859, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2413, device='cuda:3')
user_param_square tensor(119.6006, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-10.4203, device='cuda:3')
score : tensor(-0.1226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.5964, device='cuda:3')
user_param_square tensor(106.1191, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-6.4683, device='cuda:3')
score : tensor(-0.0831, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.0851, device='cuda:3')
user_param_square tensor(104.3957, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-21.6099, device='cuda:3')
score : tensor(-0.2345, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.3463, device='cuda:3')
user_param_square tensor(99.0262, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-31.3249, device='cuda:3')
score : tensor(-0.3316, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.8329, device='cuda:3')
user_param_square tensor(111.4387, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-26.6504, device='cuda:3')
score : tensor(-0.2849, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.9074, device='cuda:3')
user_param_square tensor(103.1252, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-3.8422, device='cuda:3')
score : tensor(-0.0568, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.5416, device='cuda:3')
user_param_square tensor(106.9000, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(1.0315, device='cuda:3')
score : tensor(-0.0081, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.4191, device='cuda:3')
user_param_square tensor(101.3530, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(-8.2168, device='cuda:3')
score : tensor(-0.1006, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.9819, device='cuda:3')
user_param_square tensor(106.6771, device='cuda:3')
global_param_square tensor(18.5953, device='cuda:3')
part1 is  tensor(1.0522, device='cuda:3')
score : tensor(-0.0079, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 74 global rounds:
Train Accuracy: 89.54% 

Test Accuracy: 88.77% 


 | Global Training Round : 75 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2076772004365921
distance x is tensor(124.1005, device='cuda:3')
benign distance is  tensor(124.1005, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.10106484591960907
distance x is tensor(120.5252, device='cuda:3')
benign distance is  tensor(120.5252, device='cuda:3')
norm1 res is  tensor(0.1328, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.1336929053068161
distance x is tensor(98.9918, device='cuda:3')
benign distance is  tensor(98.9918, device='cuda:3')
norm1 res is  tensor(0.1071, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.45991402864456177
distance x is tensor(105.9180, device='cuda:3')
benign distance is  tensor(105.9180, device='cuda:3')
norm1 res is  tensor(0.1165, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.1593369096517563
distance x is tensor(123.3534, device='cuda:3')
benign distance is  tensor(123.3534, device='cuda:3')
norm1 res is  tensor(0.1356, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.1146076917648315
distance x is tensor(120.9246, device='cuda:3')
benign distance is  tensor(120.9246, device='cuda:3')
norm1 res is  tensor(0.1335, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.1335904598236084
distance x is tensor(131.3923, device='cuda:3')
benign distance is  tensor(131.3923, device='cuda:3')
norm1 res is  tensor(0.1399, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5586543083190918
distance x is tensor(124.4992, device='cuda:3')
benign distance is  tensor(124.4992, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.307972252368927
distance x is tensor(149.7986, device='cuda:3')
benign distance is  tensor(149.7986, device='cuda:3')
norm1 res is  tensor(0.1650, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3057730793952942
distance x is tensor(152.8063, device='cuda:3')
benign distance is  tensor(152.8063, device='cuda:3')
norm1 res is  tensor(0.1672, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.3481793999671936
distance x is tensor(138.0728, device='cuda:3')
benign distance is  tensor(138.0728, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5125046968460083
distance x is tensor(156.2227, device='cuda:3')
benign distance is  tensor(156.2227, device='cuda:3')
norm1 res is  tensor(0.1753, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.3714562952518463
distance x is tensor(143.7591, device='cuda:3')
benign distance is  tensor(143.7591, device='cuda:3')
norm1 res is  tensor(0.1620, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.13293111324310303
distance x is tensor(151.5551, device='cuda:3')
benign distance is  tensor(151.5551, device='cuda:3')
norm1 res is  tensor(0.1626, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.19420404732227325
distance x is tensor(136.7750, device='cuda:3')
benign distance is  tensor(136.7750, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4977390766143799
distance x is tensor(140.5185, device='cuda:3')
benign distance is  tensor(140.5185, device='cuda:3')
norm1 res is  tensor(0.1552, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(132.1875, device='cuda:3')
compute distance is  tensor(132.1875, device='cuda:3')
compute norm is  tensor(66.9900, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3117, device='cuda:3')
compute distance is  tensor(137.3117, device='cuda:3')
compute norm is  tensor(67.1362, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5147, device='cuda:3')
compute distance is  tensor(137.5147, device='cuda:3')
compute norm is  tensor(67.2451, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.0370, device='cuda:3')
compute distance is  tensor(162.0370, device='cuda:3')
compute norm is  tensor(67.4091, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.3720, device='cuda:3')
compute distance is  tensor(158.3720, device='cuda:3')
compute norm is  tensor(67.3852, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.7639, device='cuda:3')
compute distance is  tensor(161.7639, device='cuda:3')
compute norm is  tensor(67.6417, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.9106, device='cuda:3')
compute distance is  tensor(143.9106, device='cuda:3')
compute norm is  tensor(67.2039, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6831, device='cuda:3')
compute distance is  tensor(146.6831, device='cuda:3')
compute norm is  tensor(67.1268, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.5226, device='cuda:3')
compute distance is  tensor(153.5226, device='cuda:3')
compute norm is  tensor(67.4163, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7364, device='cuda:3')
compute distance is  tensor(136.7364, device='cuda:3')
compute norm is  tensor(67.2985, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4440, device='cuda:3')
compute distance is  tensor(145.4440, device='cuda:3')
compute norm is  tensor(67.3584, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.0389, device='cuda:3')
compute distance is  tensor(151.0389, device='cuda:3')
compute norm is  tensor(67.4855, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(162.0370, device='cuda:3')
distance x is tensor(107600.0859, device='cuda:3')
distance x is tensor(107600.0859, device='cuda:3')
________________________________
test distance is  tensor(107600.0859, device='cuda:3')
test distance1 is  tensor(107600.0859, device='cuda:3')
test similarity is  tensor(0.4002, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130082798370676.27
test entropy is  0.0
________________________________
cal ratio is  0.03803005211065376
distance x is tensor(4092.0430, device='cuda:3')
cal_distance is  tensor(4092.0430, device='cuda:3')
cal ratio is  0.19501281302259899
distance x is tensor(798.0048, device='cuda:3')
cal_distance is  tensor(798.0048, device='cuda:3')
cal ratio is  0.44160143452456485
distance x is tensor(352.4029, device='cuda:3')
cal_distance is  tensor(352.4029, device='cuda:3')
cal ratio is  0.6645283125420718
distance x is tensor(234.1834, device='cuda:3')
cal_distance is  tensor(234.1834, device='cuda:3')
cal ratio is  0.815183073322374
distance x is tensor(190.9033, device='cuda:3')
cal_distance is  tensor(190.9033, device='cuda:3')
cal ratio is  0.9028726344219528
distance x is tensor(172.3619, device='cuda:3')
cal_distance is  tensor(172.3619, device='cuda:3')
cal ratio is  0.9501947432481995
distance x is tensor(163.7776, device='cuda:3')
cal_distance is  tensor(163.7776, device='cuda:3')
cal ratio is  0.9747785819946597
distance x is tensor(159.6470, device='cuda:3')
cal_distance is  tensor(159.6470, device='cuda:3')
distance x is tensor(159.6470, device='cuda:3')
return_distance is  tensor(159.6470, device='cuda:3')
distance x is tensor(159.6369, device='cuda:3')
distance x is tensor(159.6369, device='cuda:3')
________________________________
test distance is  tensor(159.6369, device='cuda:3')
test distance1 is  tensor(159.6369, device='cuda:3')
test similarity is  tensor(0.9761, device='cuda:3')
test acc is  0.12426666682299857
test loss is 146.44728503196734
test entropy is  0.005532563155382716
________________________________
0
distance x is tensor(159.6369, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.005499185139012039
avg test loss is  146.4956192878772
avg accuracy is  0.8525333334896564
solo acc is  0.12358333348966524
compute similarity  is  tensor(0.9761, device='cuda:3')
compute_distance is  tensor(159.6369, device='cuda:3')
compute_norm is  tensor(70.9279, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.3838, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0418801985696944
avg test loss is  1.583770873958368
avg accuracy is  0.7575333334896608
solo acc is  0.2696500001563388
compute similarity  is  tensor(0.9756, device='cuda:3')
compute_distance is  tensor(160.3838, device='cuda:3')
compute_norm is  tensor(70.8454, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.3793, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6392850005931692
avg test loss is  2.466680092216809
avg accuracy is  0.6975000001563307
solo acc is  0.1173666668229986
compute similarity  is  tensor(0.9752, device='cuda:3')
compute_distance is  tensor(162.3793, device='cuda:3')
compute_norm is  tensor(70.5359, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.1658, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9801745621253178
avg test loss is  1.4553447916055284
avg accuracy is  0.754883333489661
solo acc is  0.27548333348967224
compute similarity  is  tensor(0.9751, device='cuda:3')
compute_distance is  tensor(163.1658, device='cuda:3')
compute_norm is  tensor(70.1678, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(163.1658, device='cuda:3')
distance x is tensor(163.1658, device='cuda:3')
________________________________
test distance is  tensor(163.1658, device='cuda:3')
test distance1 is  tensor(163.1658, device='cuda:3')
test similarity is  tensor(0.9751, device='cuda:3')
test acc is  0.2769500001563389
test loss is 1.4559203379952323
test entropy is  0.9793925250389937
________________________________
cal ratio is  0.9766043784233422
distance x is tensor(159.3569, device='cuda:3')
cal_distance is  tensor(159.3569, device='cuda:3')
distance x is tensor(159.3569, device='cuda:3')
return_distance is  tensor(159.3569, device='cuda:3')
distance x is tensor(159.3483, device='cuda:3')
distance x is tensor(159.3483, device='cuda:3')
________________________________
test distance is  tensor(159.3483, device='cuda:3')
test distance1 is  tensor(159.3483, device='cuda:3')
test similarity is  tensor(0.9761, device='cuda:3')
test acc is  0.292816666823006
test loss is 1.42381577222332
test entropy is  1.0052446621313278
________________________________
0
distance x is tensor(159.3483, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0058450060866788
avg test loss is  1.4210104839379853
avg accuracy is  0.7654500001563271
solo acc is  0.2903833334896726
compute similarity  is  tensor(0.9761, device='cuda:3')
compute_distance is  tensor(159.3483, device='cuda:3')
compute_norm is  tensor(70.0413, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.9501, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6088216794706357
avg test loss is  2.317034245681153
avg accuracy is  0.7110166668229967
solo acc is  0.1142666668229986
compute similarity  is  tensor(0.9758, device='cuda:3')
compute_distance is  tensor(160.9501, device='cuda:3')
compute_norm is  tensor(69.7421, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.5607, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9575123624888056
avg test loss is  1.4353400027828176
avg accuracy is  0.7660833334896603
solo acc is  0.25916666682300527
compute similarity  is  tensor(0.9757, device='cuda:3')
compute_distance is  tensor(161.5607, device='cuda:3')
compute_norm is  tensor(69.3817, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(161.5607, device='cuda:3')
distance x is tensor(161.5607, device='cuda:3')
________________________________
test distance is  tensor(161.5607, device='cuda:3')
test distance1 is  tensor(161.5607, device='cuda:3')
test similarity is  tensor(0.9757, device='cuda:3')
test acc is  0.25893333348967185
test loss is 1.4394993137703267
test entropy is  0.9559880321595207
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.357975721359253
mal norm is  tensor(767.4021, device='cuda:3')
distance x is tensor(161.5693, device='cuda:3')
mal distance is  tensor(161.5693, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(17.3986, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.3242, device='cuda:3')
user_param_square tensor(97.8513, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(22.0511, device='cuda:3')
score : tensor(0.2033, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.0104, device='cuda:3')
user_param_square tensor(95.4832, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(28.1263, device='cuda:3')
score : tensor(0.2641, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(414.1599, device='cuda:3')
user_param_square tensor(84.8870, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(21.0801, device='cuda:3')
score : tensor(0.1936, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(459.9099, device='cuda:3')
user_param_square tensor(89.4527, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-11.6918, device='cuda:3')
score : tensor(-0.1341, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.2708, device='cuda:3')
user_param_square tensor(96.8636, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(6.4595, device='cuda:3')
score : tensor(0.0474, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.7854, device='cuda:3')
user_param_square tensor(95.2803, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-17.7450, device='cuda:3')
score : tensor(-0.1946, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.4702, device='cuda:3')
user_param_square tensor(97.0609, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(1.9720, device='cuda:3')
score : tensor(0.0025, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.3131, device='cuda:3')
user_param_square tensor(97.8503, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-13.4591, device='cuda:3')
score : tensor(-0.1518, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4021, device='cuda:3')
user_param_square tensor(115.5496, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-22.1811, device='cuda:3')
score : tensor(-0.2390, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.0972, device='cuda:3')
user_param_square tensor(103.7855, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(39.6022, device='cuda:3')
score : tensor(0.3788, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.9764, device='cuda:3')
user_param_square tensor(109.2476, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(39.1173, device='cuda:3')
score : tensor(0.3740, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.1008, device='cuda:3')
user_param_square tensor(107.8954, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-14.0799, device='cuda:3')
score : tensor(-0.1580, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.5153, device='cuda:3')
user_param_square tensor(103.9043, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(34.9677, device='cuda:3')
score : tensor(0.3325, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.0170, device='cuda:3')
user_param_square tensor(102.8525, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-12.3209, device='cuda:3')
score : tensor(-0.1404, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.4625, device='cuda:3')
user_param_square tensor(102.2116, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-33.1487, device='cuda:3')
score : tensor(-0.3487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.0867, device='cuda:3')
user_param_square tensor(105.6126, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-0.4511, device='cuda:3')
score : tensor(-0.0217, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.8367, device='cuda:3')
user_param_square tensor(104.7649, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-1.0135, device='cuda:3')
score : tensor(-0.0273, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.4077, device='cuda:3')
user_param_square tensor(108.4829, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(12.7668, device='cuda:3')
score : tensor(0.1105, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.8253, device='cuda:3')
user_param_square tensor(106.8197, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(19.3368, device='cuda:3')
score : tensor(0.1762, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.3986, device='cuda:3')
user_param_square tensor(107.7581, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(27.0851, device='cuda:3')
score : tensor(0.2537, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.8462, device='cuda:3')
user_param_square tensor(105.6751, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(50.5657, device='cuda:3')
score : tensor(0.4885, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.7498, device='cuda:3')
user_param_square tensor(102.9145, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-3.7072, device='cuda:3')
score : tensor(-0.0543, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.5483, device='cuda:3')
user_param_square tensor(105.1554, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(-1.9237, device='cuda:3')
score : tensor(-0.0364, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2260, device='cuda:3')
user_param_square tensor(108.3078, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(10.0120, device='cuda:3')
score : tensor(0.0829, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.6988, device='cuda:3')
user_param_square tensor(101.7198, device='cuda:3')
global_param_square tensor(17.3986, device='cuda:3')
part1 is  tensor(9.4805, device='cuda:3')
score : tensor(0.0776, device='cuda:3')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 75 global rounds:
Train Accuracy: 89.84% 

Test Accuracy: 89.18% 


 | Global Training Round : 76 | 

current submit client idx and staleness is  0 1
 benign loss is  0.11374344676733017
distance x is tensor(96.4434, device='cuda:3')
benign distance is  tensor(96.4434, device='cuda:3')
norm1 res is  tensor(0.1126, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7738032937049866
distance x is tensor(107.7646, device='cuda:3')
benign distance is  tensor(107.7646, device='cuda:3')
norm1 res is  tensor(0.1223, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.02766876481473446
distance x is tensor(91.0885, device='cuda:3')
benign distance is  tensor(91.0885, device='cuda:3')
norm1 res is  tensor(0.0999, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5339276194572449
distance x is tensor(106.4166, device='cuda:3')
benign distance is  tensor(106.4166, device='cuda:3')
norm1 res is  tensor(0.1181, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.22976461052894592
distance x is tensor(105.9360, device='cuda:3')
benign distance is  tensor(105.9360, device='cuda:3')
norm1 res is  tensor(0.1181, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7540403604507446
distance x is tensor(130.8191, device='cuda:3')
benign distance is  tensor(130.8191, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.4454936981201172
distance x is tensor(86.7029, device='cuda:3')
benign distance is  tensor(86.7029, device='cuda:3')
norm1 res is  tensor(0.0939, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3334576189517975
distance x is tensor(112.9896, device='cuda:3')
benign distance is  tensor(112.9896, device='cuda:3')
norm1 res is  tensor(0.1258, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.10391737520694733
distance x is tensor(119.8647, device='cuda:3')
benign distance is  tensor(119.8647, device='cuda:3')
norm1 res is  tensor(0.1331, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.2992266118526459
distance x is tensor(145.0334, device='cuda:3')
benign distance is  tensor(145.0334, device='cuda:3')
norm1 res is  tensor(0.1615, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.4348714351654053
distance x is tensor(122.6861, device='cuda:3')
benign distance is  tensor(122.6861, device='cuda:3')
norm1 res is  tensor(0.1358, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.5025797486305237
distance x is tensor(129.3038, device='cuda:3')
benign distance is  tensor(129.3038, device='cuda:3')
norm1 res is  tensor(0.1470, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.8899981379508972
distance x is tensor(131.4890, device='cuda:3')
benign distance is  tensor(131.4890, device='cuda:3')
norm1 res is  tensor(0.1453, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.6059914827346802
distance x is tensor(117.4651, device='cuda:3')
benign distance is  tensor(117.4651, device='cuda:3')
norm1 res is  tensor(0.1298, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.24198421835899353
distance x is tensor(141.0663, device='cuda:3')
benign distance is  tensor(141.0663, device='cuda:3')
norm1 res is  tensor(0.1568, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.38907137513160706
distance x is tensor(133.5816, device='cuda:3')
benign distance is  tensor(133.5816, device='cuda:3')
norm1 res is  tensor(0.1464, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.3263079524040222
distance x is tensor(125.4665, device='cuda:3')
benign distance is  tensor(125.4665, device='cuda:3')
norm1 res is  tensor(0.1379, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.06866700947284698
distance x is tensor(134.2437, device='cuda:3')
benign distance is  tensor(134.2437, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.1625707447528839
distance x is tensor(144.9713, device='cuda:3')
benign distance is  tensor(144.9713, device='cuda:3')
norm1 res is  tensor(0.1582, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.5064072012901306
distance x is tensor(123.7963, device='cuda:3')
benign distance is  tensor(123.7963, device='cuda:3')
norm1 res is  tensor(0.1379, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.261821448802948
distance x is tensor(128.2021, device='cuda:3')
benign distance is  tensor(128.2021, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.2044081687927246
distance x is tensor(129.9875, device='cuda:3')
benign distance is  tensor(129.9875, device='cuda:3')
norm1 res is  tensor(0.1405, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.4592531621456146
distance x is tensor(126.2547, device='cuda:3')
benign distance is  tensor(126.2547, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.23540034890174866
distance x is tensor(119.3698, device='cuda:3')
benign distance is  tensor(119.3698, device='cuda:3')
norm1 res is  tensor(0.1304, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(132.0923, device='cuda:3')
compute distance is  tensor(132.0923, device='cuda:3')
compute norm is  tensor(66.9279, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.3828, device='cuda:3')
compute distance is  tensor(128.3828, device='cuda:3')
compute norm is  tensor(66.7604, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.5067, device='cuda:3')
compute distance is  tensor(138.5067, device='cuda:3')
compute norm is  tensor(67.1268, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9001, device='cuda:3')
compute distance is  tensor(126.9001, device='cuda:3')
compute norm is  tensor(66.8430, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9048, device='cuda:3')
compute distance is  tensor(130.9048, device='cuda:3')
compute norm is  tensor(66.8944, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.7026, device='cuda:3')
compute distance is  tensor(141.7026, device='cuda:3')
compute norm is  tensor(67.0542, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0256, device='cuda:3')
compute distance is  tensor(127.0256, device='cuda:3')
compute norm is  tensor(66.8541, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.4988, device='cuda:3')
compute distance is  tensor(140.4988, device='cuda:3')
compute norm is  tensor(67.0841, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.5891, device='cuda:3')
compute distance is  tensor(147.5891, device='cuda:3')
compute norm is  tensor(67.1525, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0163, device='cuda:3')
compute distance is  tensor(139.0163, device='cuda:3')
compute norm is  tensor(67.0866, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.0198, device='cuda:3')
compute distance is  tensor(137.0198, device='cuda:3')
compute norm is  tensor(67.0109, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.9684, device='cuda:3')
compute distance is  tensor(143.9684, device='cuda:3')
compute norm is  tensor(67.1616, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.5891, device='cuda:3')
distance x is tensor(107602.5078, device='cuda:3')
distance x is tensor(107602.5078, device='cuda:3')
________________________________
test distance is  tensor(107602.5078, device='cuda:3')
test distance1 is  tensor(107602.5078, device='cuda:3')
test similarity is  tensor(0.4001, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130144203177984.0
test entropy is  0.0
________________________________
cal ratio is  0.036294600488411634
distance x is tensor(3905.3960, device='cuda:3')
cal_distance is  tensor(3905.3960, device='cuda:3')
cal ratio is  0.19051126801573814
distance x is tensor(744.0261, device='cuda:3')
cal_distance is  tensor(744.0261, device='cuda:3')
cal ratio is  0.43647476561923654
distance x is tensor(324.7515, device='cuda:3')
cal_distance is  tensor(324.7515, device='cuda:3')
cal ratio is  0.6606594268089463
distance x is tensor(214.5519, device='cuda:3')
cal_distance is  tensor(214.5519, device='cuda:3')
cal ratio is  0.812806258905452
distance x is tensor(174.3901, device='cuda:3')
cal_distance is  tensor(174.3901, device='cuda:3')
cal ratio is  0.9015551855891345
distance x is tensor(157.2228, device='cuda:3')
cal_distance is  tensor(157.2228, device='cuda:3')
cal ratio is  0.9495010722959308
distance x is tensor(149.2835, device='cuda:3')
cal_distance is  tensor(149.2835, device='cuda:3')
cal ratio is  0.974422640843957
distance x is tensor(145.4653, device='cuda:3')
cal_distance is  tensor(145.4653, device='cuda:3')
distance x is tensor(145.4653, device='cuda:3')
return_distance is  tensor(145.4653, device='cuda:3')
distance x is tensor(145.4551, device='cuda:3')
distance x is tensor(145.4551, device='cuda:3')
________________________________
test distance is  tensor(145.4551, device='cuda:3')
test distance1 is  tensor(145.4551, device='cuda:3')
test similarity is  tensor(0.9796, device='cuda:3')
test acc is  0.20185000015633647
test loss is 61.36688060801166
test entropy is  0.02325449976443337
________________________________
0
distance x is tensor(145.4551, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.022372704668011636
avg test loss is  61.216800775100936
avg accuracy is  0.8779500001563222
solo acc is  0.2029333334896698
compute similarity  is  tensor(0.9796, device='cuda:3')
compute_distance is  tensor(145.4551, device='cuda:3')
compute_norm is  tensor(70.1632, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(146.6317, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9658683973716012
avg test loss is  1.4403247497737535
avg accuracy is  0.8252833334896575
solo acc is  0.30221666682300624
compute similarity  is  tensor(0.9792, device='cuda:3')
compute_distance is  tensor(146.6317, device='cuda:3')
compute_norm is  tensor(69.7310, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.6708, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9121245613484494
avg test loss is  1.4921100118012824
avg accuracy is  0.8252500001563243
solo acc is  0.25906666682300517
compute similarity  is  tensor(0.9790, device='cuda:3')
compute_distance is  tensor(147.6708, device='cuda:3')
compute_norm is  tensor(69.3748, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.4784, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.887747170510831
avg test loss is  1.4848581766014668
avg accuracy is  0.829800000156324
solo acc is  0.24503333348967143
compute similarity  is  tensor(0.9788, device='cuda:3')
compute_distance is  tensor(148.4784, device='cuda:3')
compute_norm is  tensor(69.0258, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(149.2690, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8765296664700579
avg test loss is  1.4434511826744973
avg accuracy is  0.8330833334896572
solo acc is  0.251416666823005
compute similarity  is  tensor(0.9786, device='cuda:3')
compute_distance is  tensor(149.2690, device='cuda:3')
compute_norm is  tensor(68.6794, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(150.0758, device='cuda:3')
distance x is tensor(150.0758, device='cuda:3')
________________________________
test distance is  tensor(150.0758, device='cuda:3')
test distance1 is  tensor(150.0758, device='cuda:3')
test similarity is  tensor(0.9785, device='cuda:3')
test acc is  0.2494166668230049
test loss is 1.4154487310696258
test entropy is  0.8672755933773797
________________________________
cal ratio is  0.9718470336471955
distance x is tensor(145.8593, device='cuda:3')
cal_distance is  tensor(145.8593, device='cuda:3')
distance x is tensor(145.8593, device='cuda:3')
return_distance is  tensor(145.8593, device='cuda:3')
distance x is tensor(145.8506, device='cuda:3')
distance x is tensor(145.8506, device='cuda:3')
________________________________
test distance is  tensor(145.8506, device='cuda:3')
test distance1 is  tensor(145.8506, device='cuda:3')
test similarity is  tensor(0.9795, device='cuda:3')
test acc is  0.29041666682300593
test loss is 1.3378734224513649
test entropy is  0.9078446680675946
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2339231967926025
mal norm is  tensor(689.3947, device='cuda:3')
distance x is tensor(145.8593, device='cuda:3')
mal distance is  tensor(145.8593, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(9.6846, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(440.7538, device='cuda:3')
user_param_square tensor(65.3340, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-4.9423, device='cuda:3')
score : tensor(-0.0589, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(475.4816, device='cuda:3')
user_param_square tensor(67.8591, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-13.7935, device='cuda:3')
score : tensor(-0.1474, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(392.5998, device='cuda:3')
user_param_square tensor(61.6618, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(9.2713, device='cuda:3')
score : tensor(0.0832, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.6530, device='cuda:3')
user_param_square tensor(67.5136, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-1.8617, device='cuda:3')
score : tensor(-0.0281, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(457.0940, device='cuda:3')
user_param_square tensor(66.5340, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-15.5471, device='cuda:3')
score : tensor(-0.1650, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.4708, device='cuda:3')
user_param_square tensor(73.8715, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-5.6929, device='cuda:3')
score : tensor(-0.0664, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(365.0796, device='cuda:3')
user_param_square tensor(59.4614, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-4.9760, device='cuda:3')
score : tensor(-0.0592, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.4876, device='cuda:3')
user_param_square tensor(68.8513, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-1.9712, device='cuda:3')
score : tensor(-0.0292, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3947, device='cuda:3')
user_param_square tensor(81.7100, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.9696, device='cuda:3')
score : tensor(-0.1092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.8942, device='cuda:3')
user_param_square tensor(78.6603, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-8.3453, device='cuda:3')
score : tensor(-0.0929, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.9778, device='cuda:3')
user_param_square tensor(74.4270, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-21.8604, device='cuda:3')
score : tensor(-0.2281, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.0285, device='cuda:3')
user_param_square tensor(79.2206, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-5.7002, device='cuda:3')
score : tensor(-0.0665, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.0633, device='cuda:3')
user_param_square tensor(76.6126, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-15.0993, device='cuda:3')
score : tensor(-0.1605, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.9706, device='cuda:3')
user_param_square tensor(75.2676, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(0.4972, device='cuda:3')
score : tensor(-0.0045, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.6227, device='cuda:3')
user_param_square tensor(76.7111, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-5.7640, device='cuda:3')
score : tensor(-0.0671, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.4453, device='cuda:3')
user_param_square tensor(73.8042, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-8.3686, device='cuda:3')
score : tensor(-0.0932, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.5165, device='cuda:3')
user_param_square tensor(74.3319, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(1.5279, device='cuda:3')
score : tensor(0.0058, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.7777, device='cuda:3')
user_param_square tensor(80.4187, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-0.2794, device='cuda:3')
score : tensor(-0.0123, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2576, device='cuda:3')
user_param_square tensor(80.6280, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-9.0203, device='cuda:3')
score : tensor(-0.0997, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.4993, device='cuda:3')
user_param_square tensor(76.8924, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(5.5607, device='cuda:3')
score : tensor(0.0461, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.9783, device='cuda:3')
user_param_square tensor(82.6283, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-10.0688, device='cuda:3')
score : tensor(-0.1102, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.2573, device='cuda:3')
user_param_square tensor(79.4787, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-3.8713, device='cuda:3')
score : tensor(-0.0482, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.3435, device='cuda:3')
user_param_square tensor(79.6057, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(2.2314, device='cuda:3')
score : tensor(0.0128, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.0907, device='cuda:3')
user_param_square tensor(77.3690, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-2.7923, device='cuda:3')
score : tensor(-0.0374, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.2603, device='cuda:3')
user_param_square tensor(77.6296, device='cuda:3')
global_param_square tensor(9.6846, device='cuda:3')
part1 is  tensor(-17.2110, device='cuda:3')
score : tensor(-0.1816, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 76 global rounds:
Train Accuracy: 89.63% 

Test Accuracy: 89.08% 


 | Global Training Round : 77 | 

current submit client idx and staleness is  0 1
 benign loss is  0.19217075407505035
distance x is tensor(110.1939, device='cuda:3')
benign distance is  tensor(110.1939, device='cuda:3')
norm1 res is  tensor(0.1235, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.055235881358385086
distance x is tensor(116.4977, device='cuda:3')
benign distance is  tensor(116.4977, device='cuda:3')
norm1 res is  tensor(0.1330, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.11175505816936493
distance x is tensor(71.8203, device='cuda:3')
benign distance is  tensor(71.8203, device='cuda:3')
norm1 res is  tensor(0.0811, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.36874669790267944
distance x is tensor(112.7301, device='cuda:3')
benign distance is  tensor(112.7301, device='cuda:3')
norm1 res is  tensor(0.1229, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5674234628677368
distance x is tensor(104.5394, device='cuda:3')
benign distance is  tensor(104.5394, device='cuda:3')
norm1 res is  tensor(0.1152, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4318372309207916
distance x is tensor(127.7776, device='cuda:3')
benign distance is  tensor(127.7776, device='cuda:3')
norm1 res is  tensor(0.1412, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.3509131073951721
distance x is tensor(92.7126, device='cuda:3')
benign distance is  tensor(92.7126, device='cuda:3')
norm1 res is  tensor(0.1023, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3521841764450073
distance x is tensor(104.4967, device='cuda:3')
benign distance is  tensor(104.4967, device='cuda:3')
norm1 res is  tensor(0.1195, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.15564653277397156
distance x is tensor(138.8448, device='cuda:3')
benign distance is  tensor(138.8448, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.4266137480735779
distance x is tensor(125.0605, device='cuda:3')
benign distance is  tensor(125.0605, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.44364652037620544
distance x is tensor(117.0229, device='cuda:3')
benign distance is  tensor(117.0229, device='cuda:3')
norm1 res is  tensor(0.1302, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.3555727005004883
distance x is tensor(131.2306, device='cuda:3')
benign distance is  tensor(131.2306, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.7008911371231079
distance x is tensor(134.5182, device='cuda:3')
benign distance is  tensor(134.5182, device='cuda:3')
norm1 res is  tensor(0.1513, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.2084428369998932
distance x is tensor(133.5660, device='cuda:3')
benign distance is  tensor(133.5660, device='cuda:3')
norm1 res is  tensor(0.1463, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.5246725678443909
distance x is tensor(124.2186, device='cuda:3')
benign distance is  tensor(124.2186, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4280094504356384
distance x is tensor(121.5340, device='cuda:3')
benign distance is  tensor(121.5340, device='cuda:3')
norm1 res is  tensor(0.1370, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.7904709577560425
distance x is tensor(142.9683, device='cuda:3')
benign distance is  tensor(142.9683, device='cuda:3')
norm1 res is  tensor(0.1548, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.3580222725868225
distance x is tensor(123.6062, device='cuda:3')
benign distance is  tensor(123.6062, device='cuda:3')
norm1 res is  tensor(0.1370, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  1.1018247604370117
distance x is tensor(134.1198, device='cuda:3')
benign distance is  tensor(134.1198, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.21427154541015625
distance x is tensor(150.1818, device='cuda:3')
benign distance is  tensor(150.1818, device='cuda:3')
norm1 res is  tensor(0.1610, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.32794713973999023
distance x is tensor(132.1686, device='cuda:3')
benign distance is  tensor(132.1686, device='cuda:3')
norm1 res is  tensor(0.1453, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.2624974846839905
distance x is tensor(134.2108, device='cuda:3')
benign distance is  tensor(134.2108, device='cuda:3')
norm1 res is  tensor(0.1494, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.36367708444595337
distance x is tensor(152.3059, device='cuda:3')
benign distance is  tensor(152.3059, device='cuda:3')
norm1 res is  tensor(0.1689, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.2354917973279953
distance x is tensor(119.2931, device='cuda:3')
benign distance is  tensor(119.2931, device='cuda:3')
norm1 res is  tensor(0.1365, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(130.8375, device='cuda:3')
compute distance is  tensor(130.8375, device='cuda:3')
compute norm is  tensor(67.2253, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.8960, device='cuda:3')
compute distance is  tensor(135.8960, device='cuda:3')
compute norm is  tensor(67.1889, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3300, device='cuda:3')
compute distance is  tensor(139.3300, device='cuda:3')
compute norm is  tensor(67.3977, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3743, device='cuda:3')
compute distance is  tensor(138.3743, device='cuda:3')
compute norm is  tensor(67.2651, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.3090, device='cuda:3')
compute distance is  tensor(124.3090, device='cuda:3')
compute norm is  tensor(67.0704, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.8573, device='cuda:3')
compute distance is  tensor(139.8573, device='cuda:3')
compute norm is  tensor(67.4126, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3237, device='cuda:3')
compute distance is  tensor(129.3237, device='cuda:3')
compute norm is  tensor(67.2181, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.6163, device='cuda:3')
compute distance is  tensor(142.6163, device='cuda:3')
compute norm is  tensor(67.4600, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.5579, device='cuda:3')
compute distance is  tensor(146.5579, device='cuda:3')
compute norm is  tensor(67.3953, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.0070, device='cuda:3')
compute distance is  tensor(143.0070, device='cuda:3')
compute norm is  tensor(67.5570, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.6562, device='cuda:3')
compute distance is  tensor(142.6562, device='cuda:3')
compute norm is  tensor(67.3532, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.7863, device='cuda:3')
compute distance is  tensor(129.7863, device='cuda:3')
compute norm is  tensor(67.1717, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(146.5579, device='cuda:3')
distance x is tensor(107604.3672, device='cuda:3')
distance x is tensor(107604.3672, device='cuda:3')
________________________________
test distance is  tensor(107604.3672, device='cuda:3')
test distance1 is  tensor(107604.3672, device='cuda:3')
test similarity is  tensor(0.3963, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129991305737039.14
test entropy is  0.0
________________________________
cal ratio is  0.036167269818061946
distance x is tensor(3891.7617, device='cuda:3')
cal_distance is  tensor(3891.7617, device='cuda:3')
cal ratio is  0.19017680616945895
distance x is tensor(740.1269, device='cuda:3')
cal_distance is  tensor(740.1269, device='cuda:3')
cal ratio is  0.4360914711327159
distance x is tensor(322.7659, device='cuda:3')
cal_distance is  tensor(322.7659, device='cuda:3')
cal ratio is  0.660369246536311
distance x is tensor(213.1464, device='cuda:3')
cal_distance is  tensor(213.1464, device='cuda:3')
cal ratio is  0.81262773959231
distance x is tensor(173.2097, device='cuda:3')
cal_distance is  tensor(173.2097, device='cuda:3')
cal ratio is  0.9014561596041881
distance x is tensor(156.1414, device='cuda:3')
cal_distance is  tensor(156.1414, device='cuda:3')
cal ratio is  0.9494489210329671
distance x is tensor(148.2486, device='cuda:3')
cal_distance is  tensor(148.2486, device='cuda:3')
cal ratio is  0.9743957637705741
distance x is tensor(144.4529, device='cuda:3')
cal_distance is  tensor(144.4529, device='cuda:3')
distance x is tensor(144.4529, device='cuda:3')
return_distance is  tensor(144.4529, device='cuda:3')
distance x is tensor(144.4427, device='cuda:3')
distance x is tensor(144.4427, device='cuda:3')
________________________________
test distance is  tensor(144.4427, device='cuda:3')
test distance1 is  tensor(144.4427, device='cuda:3')
test similarity is  tensor(0.9799, device='cuda:3')
test acc is  0.26341666682300524
test loss is 51.140758254126446
test entropy is  0.039703129288573655
________________________________
0
distance x is tensor(144.4427, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0385039974424019
avg test loss is  51.12477385514835
avg accuracy is  0.8749000001563223
solo acc is  0.26383333348967203
compute similarity  is  tensor(0.9799, device='cuda:3')
compute_distance is  tensor(144.4427, device='cuda:3')
compute_norm is  tensor(70.4462, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.5069, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9170083545926792
avg test loss is  1.3705378135384272
avg accuracy is  0.8628333334896561
solo acc is  0.33351666682300685
compute similarity  is  tensor(0.9791, device='cuda:3')
compute_distance is  tensor(144.5069, device='cuda:3')
compute_norm is  tensor(69.7212, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.1126, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8767948244680474
avg test loss is  1.441595624758999
avg accuracy is  0.8626166668229893
solo acc is  0.2724666668230055
compute similarity  is  tensor(0.9788, device='cuda:3')
compute_distance is  tensor(146.1126, device='cuda:3')
compute_norm is  tensor(69.3394, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.3627, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8641531689207691
avg test loss is  1.4357402524205922
avg accuracy is  0.8637666668229893
solo acc is  0.25403333348967166
compute similarity  is  tensor(0.9785, device='cuda:3')
compute_distance is  tensor(147.3627, device='cuda:3')
compute_norm is  tensor(68.9754, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.3790, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8484505782884829
avg test loss is  1.4186834080387025
avg accuracy is  0.8654500001563226
solo acc is  0.25038333348967157
compute similarity  is  tensor(0.9783, device='cuda:3')
compute_distance is  tensor(148.3790, device='cuda:3')
compute_norm is  tensor(68.6216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(149.3993, device='cuda:3')
distance x is tensor(149.3993, device='cuda:3')
________________________________
test distance is  tensor(149.3993, device='cuda:3')
test distance1 is  tensor(149.3993, device='cuda:3')
test similarity is  tensor(0.9781, device='cuda:3')
test acc is  0.2564000001563385
test loss is 1.3801720798142683
test entropy is  0.8512119855453719
________________________________
cal ratio is  0.9706361256862654
distance x is tensor(145.0206, device='cuda:3')
cal_distance is  tensor(145.0206, device='cuda:3')
distance x is tensor(145.0206, device='cuda:3')
return_distance is  tensor(145.0206, device='cuda:3')
distance x is tensor(145.0122, device='cuda:3')
distance x is tensor(145.0122, device='cuda:3')
________________________________
test distance is  tensor(145.0122, device='cuda:3')
test distance1 is  tensor(145.0122, device='cuda:3')
test similarity is  tensor(0.9793, device='cuda:3')
test acc is  0.3180833334896732
test loss is 1.272415677367497
test entropy is  0.8919222489603038
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.122240424156189
mal norm is  tensor(690.0447, device='cuda:3')
distance x is tensor(145.0206, device='cuda:3')
mal distance is  tensor(145.0206, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(11.4152, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.1640, device='cuda:3')
user_param_square tensor(74.6492, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-5.4818, device='cuda:3')
score : tensor(-0.0660, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.6624, device='cuda:3')
user_param_square tensor(77.1680, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-4.1572, device='cuda:3')
score : tensor(-0.0528, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(315.5830, device='cuda:3')
user_param_square tensor(60.0205, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(2.0221, device='cuda:3')
score : tensor(0.0090, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(485.6374, device='cuda:3')
user_param_square tensor(74.4558, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-21.7046, device='cuda:3')
score : tensor(-0.2283, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(453.2495, device='cuda:3')
user_param_square tensor(71.9302, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(6.7644, device='cuda:3')
score : tensor(0.0564, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.3667, device='cuda:3')
user_param_square tensor(79.4065, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-9.6657, device='cuda:3')
score : tensor(-0.1079, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(398.6915, device='cuda:3')
user_param_square tensor(67.4623, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(4.3041, device='cuda:3')
score : tensor(0.0318, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(472.5649, device='cuda:3')
user_param_square tensor(73.4469, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-18.4692, device='cuda:3')
score : tensor(-0.1959, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0447, device='cuda:3')
user_param_square tensor(88.7526, device='cuda:3')
global_param_square tensor(11.4152, device='cuda:3')
part1 is  tensor(-14.5410, device='cuda:3')
score : tensor(-0.1566, device='cuda:3')
len accept list 3
len all weights is 3
 
Avg Training Stats after 77 global rounds:
Train Accuracy: 89.79% 

Test Accuracy: 89.33% 


 | Global Training Round : 78 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3535451292991638
distance x is tensor(124.2643, device='cuda:3')
benign distance is  tensor(124.2643, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.21122105419635773
distance x is tensor(127.2090, device='cuda:3')
benign distance is  tensor(127.2090, device='cuda:3')
norm1 res is  tensor(0.1398, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.29158616065979004
distance x is tensor(111.9386, device='cuda:3')
benign distance is  tensor(111.9386, device='cuda:3')
norm1 res is  tensor(0.1237, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7908892631530762
distance x is tensor(125.7965, device='cuda:3')
benign distance is  tensor(125.7965, device='cuda:3')
norm1 res is  tensor(0.1390, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.27671703696250916
distance x is tensor(114.9511, device='cuda:3')
benign distance is  tensor(114.9511, device='cuda:3')
norm1 res is  tensor(0.1280, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.12825635075569153
distance x is tensor(135.9082, device='cuda:3')
benign distance is  tensor(135.9082, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.18533682823181152
distance x is tensor(110.7029, device='cuda:3')
benign distance is  tensor(110.7029, device='cuda:3')
norm1 res is  tensor(0.1148, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.25785523653030396
distance x is tensor(137.6865, device='cuda:3')
benign distance is  tensor(137.6865, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(148.6916, device='cuda:3')
compute distance is  tensor(148.6916, device='cuda:3')
compute norm is  tensor(67.6738, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.0878, device='cuda:3')
compute distance is  tensor(137.0878, device='cuda:3')
compute norm is  tensor(67.6102, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6163, device='cuda:3')
compute distance is  tensor(146.6163, device='cuda:3')
compute norm is  tensor(67.6986, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.7142, device='cuda:3')
compute distance is  tensor(151.7142, device='cuda:3')
compute norm is  tensor(67.8297, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.7652, device='cuda:3')
compute distance is  tensor(156.7652, device='cuda:3')
compute norm is  tensor(67.6928, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.9569, device='cuda:3')
compute distance is  tensor(158.9569, device='cuda:3')
compute norm is  tensor(68.0803, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6621, device='cuda:3')
compute distance is  tensor(137.6621, device='cuda:3')
compute norm is  tensor(67.5962, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.3612, device='cuda:3')
compute distance is  tensor(155.3612, device='cuda:3')
compute norm is  tensor(67.7887, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.4052, device='cuda:3')
compute distance is  tensor(171.4052, device='cuda:3')
compute norm is  tensor(68.1053, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5646, device='cuda:3')
compute distance is  tensor(139.5646, device='cuda:3')
compute norm is  tensor(67.6555, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.7213, device='cuda:3')
compute distance is  tensor(145.7213, device='cuda:3')
compute norm is  tensor(67.8378, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.5089, device='cuda:3')
compute distance is  tensor(149.5089, device='cuda:3')
compute norm is  tensor(67.6224, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(171.4052, device='cuda:3')
distance x is tensor(107603.5938, device='cuda:3')
distance x is tensor(107603.5938, device='cuda:3')
________________________________
test distance is  tensor(107603.5938, device='cuda:3')
test distance1 is  tensor(107603.5938, device='cuda:3')
test similarity is  tensor(0.3936, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130093826769874.16
test entropy is  0.0
________________________________
cal ratio is  0.03911332304113771
distance x is tensor(4208.7407, device='cuda:3')
cal_distance is  tensor(4208.7407, device='cuda:3')
cal ratio is  0.1977707343055209
distance x is tensor(832.3696, device='cuda:3')
cal_distance is  tensor(832.3696, device='cuda:3')
cal ratio is  0.4447131661469379
distance x is tensor(370.1686, device='cuda:3')
cal_distance is  tensor(370.1686, device='cuda:3')
cal ratio is  0.6668656268171657
distance x is tensor(246.8544, device='cuda:3')
cal_distance is  tensor(246.8544, device='cuda:3')
cal ratio is  0.8166155151401449
distance x is tensor(201.5861, device='cuda:3')
cal_distance is  tensor(201.5861, device='cuda:3')
cal ratio is  0.903665735542639
distance x is tensor(182.1669, device='cuda:3')
cal_distance is  tensor(182.1669, device='cuda:3')
cal ratio is  0.9506120577676697
distance x is tensor(173.1704, device='cuda:3')
cal_distance is  tensor(173.1704, device='cuda:3')
cal ratio is  0.9749926127251733
distance x is tensor(168.8400, device='cuda:3')
cal_distance is  tensor(168.8400, device='cuda:3')
distance x is tensor(168.8400, device='cuda:3')
return_distance is  tensor(168.8400, device='cuda:3')
distance x is tensor(168.8298, device='cuda:3')
distance x is tensor(168.8298, device='cuda:3')
________________________________
test distance is  tensor(168.8298, device='cuda:3')
test distance1 is  tensor(168.8298, device='cuda:3')
test similarity is  tensor(0.9737, device='cuda:3')
test acc is  0.11823333348966528
test loss is 215.2401181934739
test entropy is  0.0036610807975578047
________________________________
0
distance x is tensor(168.8298, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.003539351481804068
avg test loss is  216.19460033099534
avg accuracy is  0.8142833334896581
solo acc is  0.11803333348966526
compute similarity  is  tensor(0.9737, device='cuda:3')
compute_distance is  tensor(168.8298, device='cuda:3')
compute_norm is  tensor(71.6756, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(178.2410, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1005096872096884
avg test loss is  1.695757161452572
avg accuracy is  0.6864666668229982
solo acc is  0.24510000015633804
compute similarity  is  tensor(0.9713, device='cuda:3')
compute_distance is  tensor(178.2410, device='cuda:3')
compute_norm is  tensor(72.0446, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(179.6681, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6575007237223928
avg test loss is  2.6004516709842154
avg accuracy is  0.6156500001563363
solo acc is  0.11445000015633194
compute similarity  is  tensor(0.9710, device='cuda:3')
compute_distance is  tensor(179.6681, device='cuda:3')
compute_norm is  tensor(71.7357, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.3119, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0032644354458302
avg test loss is  1.5316411972300077
avg accuracy is  0.6930166668229977
solo acc is  0.25785000015633847
compute similarity  is  tensor(0.9709, device='cuda:3')
compute_distance is  tensor(180.3119, device='cuda:3')
compute_norm is  tensor(71.3611, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(181.3829, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6251342786845367
avg test loss is  2.4075681490938803
avg accuracy is  0.6217166668230025
solo acc is  0.11270000015633194
compute similarity  is  tensor(0.9706, device='cuda:3')
compute_distance is  tensor(181.3829, device='cuda:3')
compute_norm is  tensor(71.0580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(181.9306, device='cuda:3')
distance x is tensor(181.9306, device='cuda:3')
________________________________
test distance is  tensor(181.9306, device='cuda:3')
test distance1 is  tensor(181.9306, device='cuda:3')
test similarity is  tensor(0.9706, device='cuda:3')
test acc is  0.25020000015633825
test loss is 1.4799250571458324
test entropy is  0.9864743775142027
________________________________
cal ratio is  0.951229366524845
distance x is tensor(173.0657, device='cuda:3')
cal_distance is  tensor(173.0657, device='cuda:3')
cal ratio is  0.9752872758345695
distance x is tensor(168.7889, device='cuda:3')
cal_distance is  tensor(168.7889, device='cuda:3')
distance x is tensor(168.7889, device='cuda:3')
return_distance is  tensor(168.7889, device='cuda:3')
distance x is tensor(168.7807, device='cuda:3')
distance x is tensor(168.7807, device='cuda:3')
________________________________
test distance is  tensor(168.7807, device='cuda:3')
test distance1 is  tensor(168.7807, device='cuda:3')
test similarity is  tensor(0.9743, device='cuda:3')
test acc is  0.29395000015633943
test loss is 1.4054972423927616
test entropy is  1.0617057490450488
________________________________
0
distance x is tensor(168.7807, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0610660332987811
avg test loss is  1.4025465848603482
avg accuracy is  0.732183333489662
solo acc is  0.2950500001563394
compute similarity  is  tensor(0.9743, device='cuda:3')
compute_distance is  tensor(168.7807, device='cuda:3')
compute_norm is  tensor(70.2664, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.3727, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6002634373872773
avg test loss is  2.3355349181557514
avg accuracy is  0.6654833334896662
solo acc is  0.1116166668229986
compute similarity  is  tensor(0.9739, device='cuda:3')
compute_distance is  tensor(170.3727, device='cuda:3')
compute_norm is  tensor(69.9754, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(171.1404, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9519044188166986
avg test loss is  1.4060461666029909
avg accuracy is  0.7363000001563286
solo acc is  0.26990000015633875
compute similarity  is  tensor(0.9738, device='cuda:3')
compute_distance is  tensor(171.1404, device='cuda:3')
compute_norm is  tensor(69.6168, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(171.1404, device='cuda:3')
distance x is tensor(171.1404, device='cuda:3')
________________________________
test distance is  tensor(171.1404, device='cuda:3')
test distance1 is  tensor(171.1404, device='cuda:3')
test similarity is  tensor(0.9738, device='cuda:3')
test acc is  0.26911666682300545
test loss is 1.4103417955736108
test entropy is  0.9523862211434826
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2828038930892944
mal norm is  tensor(785.0065, device='cuda:3')
distance x is tensor(171.1485, device='cuda:3')
mal distance is  tensor(171.1485, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(13.8656, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.6755, device='cuda:3')
user_param_square tensor(86.9833, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(12.3211, device='cuda:3')
score : tensor(0.1095, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(551.6614, device='cuda:3')
user_param_square tensor(87.4591, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-11.4347, device='cuda:3')
score : tensor(-0.1280, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.9666, device='cuda:3')
user_param_square tensor(82.4237, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-7.0796, device='cuda:3')
score : tensor(-0.0845, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.9846, device='cuda:3')
user_param_square tensor(86.5286, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-18.2519, device='cuda:3')
score : tensor(-0.1962, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(504.7420, device='cuda:3')
user_param_square tensor(83.6572, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-46.0764, device='cuda:3')
score : tensor(-0.4744, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.0236, device='cuda:3')
user_param_square tensor(90.8314, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(12.0984, device='cuda:3')
score : tensor(0.1073, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(451.1786, device='cuda:3')
user_param_square tensor(79.0939, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-5.7474, device='cuda:3')
score : tensor(-0.0711, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.1721, device='cuda:3')
user_param_square tensor(90.7664, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-4.7381, device='cuda:3')
score : tensor(-0.0610, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.0065, device='cuda:3')
user_param_square tensor(104.3291, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-23.5007, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.0469, device='cuda:3')
user_param_square tensor(94.1316, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(14.2739, device='cuda:3')
score : tensor(0.1291, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.0358, device='cuda:3')
user_param_square tensor(94.2044, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-12.3811, device='cuda:3')
score : tensor(-0.1375, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7172, device='cuda:3')
user_param_square tensor(92.4724, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(27.6854, device='cuda:3')
score : tensor(0.2632, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.5479, device='cuda:3')
user_param_square tensor(95.7744, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(26.7850, device='cuda:3')
score : tensor(0.2542, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.2220, device='cuda:3')
user_param_square tensor(92.3602, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-1.5977, device='cuda:3')
score : tensor(-0.0296, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.6619, device='cuda:3')
user_param_square tensor(98.8460, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-13.9937, device='cuda:3')
score : tensor(-0.1536, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.0397, device='cuda:3')
user_param_square tensor(96.7461, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(4.0027, device='cuda:3')
score : tensor(0.0264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.3256, device='cuda:3')
user_param_square tensor(101.7262, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(0.0318, device='cuda:3')
score : tensor(-0.0133, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.1522, device='cuda:3')
user_param_square tensor(91.6768, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(13.8048, device='cuda:3')
score : tensor(0.1244, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.5898, device='cuda:3')
user_param_square tensor(98.4896, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-10.3601, device='cuda:3')
score : tensor(-0.1173, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.4475, device='cuda:3')
user_param_square tensor(91.7748, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(4.4709, device='cuda:3')
score : tensor(0.0310, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.9359, device='cuda:3')
user_param_square tensor(94.4175, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-10.3133, device='cuda:3')
score : tensor(-0.1168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.8981, device='cuda:3')
user_param_square tensor(94.0469, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-11.3846, device='cuda:3')
score : tensor(-0.1275, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.5526, device='cuda:3')
user_param_square tensor(89.9516, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-6.1979, device='cuda:3')
score : tensor(-0.0756, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.1528, device='cuda:3')
user_param_square tensor(97.3258, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-7.6640, device='cuda:3')
score : tensor(-0.0903, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2960, device='cuda:3')
user_param_square tensor(95.0294, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(5.4937, device='cuda:3')
score : tensor(0.0413, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.1584, device='cuda:3')
user_param_square tensor(93.3262, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-0.5965, device='cuda:3')
score : tensor(-0.0196, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.2140, device='cuda:3')
user_param_square tensor(89.6939, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-15.4135, device='cuda:3')
score : tensor(-0.1678, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.9925, device='cuda:3')
user_param_square tensor(87.1678, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(9.8422, device='cuda:3')
score : tensor(0.0848, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.4154, device='cuda:3')
user_param_square tensor(90.6321, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-10.2781, device='cuda:3')
score : tensor(-0.1164, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.0363, device='cuda:3')
user_param_square tensor(92.6461, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-5.7803, device='cuda:3')
score : tensor(-0.0715, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.1717, device='cuda:3')
user_param_square tensor(91.3753, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(10.5928, device='cuda:3')
score : tensor(0.0923, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.6345, device='cuda:3')
user_param_square tensor(89.2616, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-16.7553, device='cuda:3')
score : tensor(-0.1812, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.2615, device='cuda:3')
user_param_square tensor(88.3739, device='cuda:3')
global_param_square tensor(13.8656, device='cuda:3')
part1 is  tensor(-16.1062, device='cuda:3')
score : tensor(-0.1747, device='cuda:3')
len accept list 11
len all weights is 11
 
Avg Training Stats after 78 global rounds:
Train Accuracy: 90.23% 

Test Accuracy: 89.33% 


 | Global Training Round : 79 | 

current submit client idx and staleness is  0 1
 benign loss is  0.45194754004478455
distance x is tensor(113.8676, device='cuda:3')
benign distance is  tensor(113.8676, device='cuda:3')
norm1 res is  tensor(0.1308, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.1506805419921875
distance x is tensor(113.5049, device='cuda:3')
benign distance is  tensor(113.5049, device='cuda:3')
norm1 res is  tensor(0.1304, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.07058390229940414
distance x is tensor(114.8812, device='cuda:3')
benign distance is  tensor(114.8812, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5510163307189941
distance x is tensor(119.5365, device='cuda:3')
benign distance is  tensor(119.5365, device='cuda:3')
norm1 res is  tensor(0.1336, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6527416110038757
distance x is tensor(111.7556, device='cuda:3')
benign distance is  tensor(111.7556, device='cuda:3')
norm1 res is  tensor(0.1224, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5283538103103638
distance x is tensor(121.4168, device='cuda:3')
benign distance is  tensor(121.4168, device='cuda:3')
norm1 res is  tensor(0.1328, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5627204179763794
distance x is tensor(107.5027, device='cuda:3')
benign distance is  tensor(107.5027, device='cuda:3')
norm1 res is  tensor(0.1166, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.24089697003364563
distance x is tensor(103.8898, device='cuda:3')
benign distance is  tensor(103.8898, device='cuda:3')
norm1 res is  tensor(0.1180, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.6201356649398804
distance x is tensor(140.4890, device='cuda:3')
benign distance is  tensor(140.4890, device='cuda:3')
norm1 res is  tensor(0.1558, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.10616032034158707
distance x is tensor(140.2562, device='cuda:3')
benign distance is  tensor(140.2562, device='cuda:3')
norm1 res is  tensor(0.1556, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.17988915741443634
distance x is tensor(106.9159, device='cuda:3')
benign distance is  tensor(106.9159, device='cuda:3')
norm1 res is  tensor(0.1168, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.40048184990882874
distance x is tensor(142.7253, device='cuda:3')
benign distance is  tensor(142.7253, device='cuda:3')
norm1 res is  tensor(0.1619, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.3136615753173828
distance x is tensor(133.3928, device='cuda:3')
benign distance is  tensor(133.3928, device='cuda:3')
norm1 res is  tensor(0.1498, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.4285961985588074
distance x is tensor(134.3389, device='cuda:3')
benign distance is  tensor(134.3389, device='cuda:3')
norm1 res is  tensor(0.1469, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.11388611793518066
distance x is tensor(123.0644, device='cuda:3')
benign distance is  tensor(123.0644, device='cuda:3')
norm1 res is  tensor(0.1373, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3602977395057678
distance x is tensor(131.5481, device='cuda:3')
benign distance is  tensor(131.5481, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.3506115674972534
distance x is tensor(121.1811, device='cuda:3')
benign distance is  tensor(121.1811, device='cuda:3')
norm1 res is  tensor(0.1343, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.4363049566745758
distance x is tensor(145.0689, device='cuda:3')
benign distance is  tensor(145.0689, device='cuda:3')
norm1 res is  tensor(0.1588, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.1888417899608612
distance x is tensor(116.1942, device='cuda:3')
benign distance is  tensor(116.1942, device='cuda:3')
norm1 res is  tensor(0.1283, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.10709451138973236
distance x is tensor(126.2187, device='cuda:3')
benign distance is  tensor(126.2187, device='cuda:3')
norm1 res is  tensor(0.1431, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.25646573305130005
distance x is tensor(122.1794, device='cuda:3')
benign distance is  tensor(122.1794, device='cuda:3')
norm1 res is  tensor(0.1364, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5149014592170715
distance x is tensor(122.9068, device='cuda:3')
benign distance is  tensor(122.9068, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.25495654344558716
distance x is tensor(131.1513, device='cuda:3')
benign distance is  tensor(131.1513, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.204721137881279
distance x is tensor(127.8061, device='cuda:3')
benign distance is  tensor(127.8061, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.11869536340236664
distance x is tensor(129.9529, device='cuda:3')
benign distance is  tensor(129.9529, device='cuda:3')
norm1 res is  tensor(0.1432, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.2210887223482132
distance x is tensor(135.7142, device='cuda:3')
benign distance is  tensor(135.7142, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.15971164405345917
distance x is tensor(138.7267, device='cuda:3')
benign distance is  tensor(138.7267, device='cuda:3')
norm1 res is  tensor(0.1570, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.154038205742836
distance x is tensor(130.1282, device='cuda:3')
benign distance is  tensor(130.1282, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.3818419277667999
distance x is tensor(127.6588, device='cuda:3')
benign distance is  tensor(127.6588, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.4268321394920349
distance x is tensor(148.5527, device='cuda:3')
benign distance is  tensor(148.5527, device='cuda:3')
norm1 res is  tensor(0.1623, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.5722154378890991
distance x is tensor(135.2168, device='cuda:3')
benign distance is  tensor(135.2168, device='cuda:3')
norm1 res is  tensor(0.1508, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.19623702764511108
distance x is tensor(131.8670, device='cuda:3')
benign distance is  tensor(131.8670, device='cuda:3')
norm1 res is  tensor(0.1488, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(138.8182, device='cuda:3')
compute distance is  tensor(138.8182, device='cuda:3')
compute norm is  tensor(67.3030, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.8953, device='cuda:3')
compute distance is  tensor(138.8953, device='cuda:3')
compute norm is  tensor(67.2891, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0890, device='cuda:3')
compute distance is  tensor(134.0890, device='cuda:3')
compute norm is  tensor(67.2069, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8041, device='cuda:3')
compute distance is  tensor(128.8041, device='cuda:3')
compute norm is  tensor(67.1176, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.5503, device='cuda:3')
compute distance is  tensor(118.5503, device='cuda:3')
compute norm is  tensor(66.9740, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.3677, device='cuda:3')
compute distance is  tensor(147.3677, device='cuda:3')
compute norm is  tensor(67.5380, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4847, device='cuda:3')
compute distance is  tensor(126.4847, device='cuda:3')
compute norm is  tensor(67.2050, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3904, device='cuda:3')
compute distance is  tensor(139.3904, device='cuda:3')
compute norm is  tensor(67.3319, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.4419, device='cuda:3')
compute distance is  tensor(146.4419, device='cuda:3')
compute norm is  tensor(67.3925, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3511, device='cuda:3')
compute distance is  tensor(140.3511, device='cuda:3')
compute norm is  tensor(67.4681, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0372, device='cuda:3')
compute distance is  tensor(133.0372, device='cuda:3')
compute norm is  tensor(67.3320, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.4105, device='cuda:3')
compute distance is  tensor(135.4105, device='cuda:3')
compute norm is  tensor(67.3898, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.3677, device='cuda:3')
distance x is tensor(107604.4844, device='cuda:3')
distance x is tensor(107604.4844, device='cuda:3')
________________________________
test distance is  tensor(107604.4844, device='cuda:3')
test distance1 is  tensor(107604.4844, device='cuda:3')
test similarity is  tensor(0.3956, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130059124457926.14
test entropy is  0.0
________________________________
cal ratio is  0.036267035007595844
distance x is tensor(3902.5010, device='cuda:3')
cal_distance is  tensor(3902.5010, device='cuda:3')
cal ratio is  0.1904389237731553
distance x is tensor(743.1923, device='cuda:3')
cal_distance is  tensor(743.1923, device='cuda:3')
cal ratio is  0.436391870027505
distance x is tensor(324.3259, device='cuda:3')
cal_distance is  tensor(324.3259, device='cuda:3')
cal ratio is  0.6605967129089095
distance x is tensor(214.2504, device='cuda:3')
cal_distance is  tensor(214.2504, device='cuda:3')
cal ratio is  0.8127676634574936
distance x is tensor(174.1367, device='cuda:3')
cal_distance is  tensor(174.1367, device='cuda:3')
cal ratio is  0.9015338192481699
distance x is tensor(156.9907, device='cuda:3')
cal_distance is  tensor(156.9907, device='cuda:3')
cal ratio is  0.9494897077850317
distance x is tensor(149.0613, device='cuda:3')
cal_distance is  tensor(149.0613, device='cuda:3')
cal ratio is  0.9744167661371302
distance x is tensor(145.2480, device='cuda:3')
cal_distance is  tensor(145.2480, device='cuda:3')
distance x is tensor(145.2480, device='cuda:3')
return_distance is  tensor(145.2480, device='cuda:3')
distance x is tensor(145.2377, device='cuda:3')
distance x is tensor(145.2377, device='cuda:3')
________________________________
test distance is  tensor(145.2377, device='cuda:3')
test distance1 is  tensor(145.2377, device='cuda:3')
test similarity is  tensor(0.9796, device='cuda:3')
test acc is  0.17373333348966818
test loss is 73.02661878264534
test entropy is  0.017556583090170094
________________________________
0
distance x is tensor(145.2377, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.01796403179318036
avg test loss is  73.22147554426051
avg accuracy is  0.8734000001563222
solo acc is  0.175100000156335
compute similarity  is  tensor(0.9796, device='cuda:3')
compute_distance is  tensor(145.2377, device='cuda:3')
compute_norm is  tensor(70.4383, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(146.0389, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9455421258137424
avg test loss is  1.4295053006743572
avg accuracy is  0.8430500001563235
solo acc is  0.3134333334896731
compute similarity  is  tensor(0.9792, device='cuda:3')
compute_distance is  tensor(146.0389, device='cuda:3')
compute_norm is  tensor(69.9022, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.5474, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.884938262990797
avg test loss is  1.5054824709383918
avg accuracy is  0.8426666668229903
solo acc is  0.25800000015633845
compute similarity  is  tensor(0.9789, device='cuda:3')
compute_distance is  tensor(147.5474, device='cuda:3')
compute_norm is  tensor(69.5340, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.5755, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8847729778493137
avg test loss is  1.464325694514236
avg accuracy is  0.8439333334896568
solo acc is  0.25588333348967174
compute similarity  is  tensor(0.9786, device='cuda:3')
compute_distance is  tensor(148.5755, device='cuda:3')
compute_norm is  tensor(69.1777, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(149.5246, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8686862388399365
avg test loss is  1.448933112850067
avg accuracy is  0.8461833334896567
solo acc is  0.24750000015633816
compute similarity  is  tensor(0.9784, device='cuda:3')
compute_distance is  tensor(149.5246, device='cuda:3')
compute_norm is  tensor(68.8275, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(150.4044, device='cuda:3')
distance x is tensor(150.4044, device='cuda:3')
________________________________
test distance is  tensor(150.4044, device='cuda:3')
test distance1 is  tensor(150.4044, device='cuda:3')
test similarity is  tensor(0.9782, device='cuda:3')
test acc is  0.24180000015633796
test loss is 1.4338430007383514
test entropy is  0.8573764089836495
________________________________
cal ratio is  0.9700563062346365
distance x is tensor(145.9092, device='cuda:3')
cal_distance is  tensor(145.9092, device='cuda:3')
distance x is tensor(145.9092, device='cuda:3')
return_distance is  tensor(145.9092, device='cuda:3')
distance x is tensor(145.9006, device='cuda:3')
distance x is tensor(145.9006, device='cuda:3')
________________________________
test distance is  tensor(145.9006, device='cuda:3')
test distance1 is  tensor(145.9006, device='cuda:3')
test similarity is  tensor(0.9794, device='cuda:3')
test acc is  0.29153333348967264
test loss is 1.3281310132063273
test entropy is  0.9029323347468874
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2171176671981812
mal norm is  tensor(690.4291, device='cuda:3')
distance x is tensor(145.9092, device='cuda:3')
mal distance is  tensor(145.9092, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(15.7060, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.9547, device='cuda:3')
user_param_square tensor(88.7901, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(14.1652, device='cuda:3')
score : tensor(0.1261, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.6666, device='cuda:3')
user_param_square tensor(89.2058, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-5.5135, device='cuda:3')
score : tensor(-0.0706, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.3449, device='cuda:3')
user_param_square tensor(89.1775, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(1.9291, device='cuda:3')
score : tensor(0.0038, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.0898, device='cuda:3')
user_param_square tensor(91.0723, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-34.1248, device='cuda:3')
score : tensor(-0.3568, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(487.9449, device='cuda:3')
user_param_square tensor(87.5422, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-42.5540, device='cuda:3')
score : tensor(-0.4410, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.1874, device='cuda:3')
user_param_square tensor(90.6485, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-33.8931, device='cuda:3')
score : tensor(-0.3544, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.9462, device='cuda:3')
user_param_square tensor(84.5303, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-11.5722, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(462.5323, device='cuda:3')
user_param_square tensor(85.2321, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-36.3796, device='cuda:3')
score : tensor(-0.3793, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4291, device='cuda:3')
user_param_square tensor(104.1338, device='cuda:3')
global_param_square tensor(15.7060, device='cuda:3')
part1 is  tensor(-8.7987, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
len accept list 2
len all weights is 2
 
Avg Training Stats after 79 global rounds:
Train Accuracy: 89.73% 

Test Accuracy: 88.85% 


 | Global Training Round : 80 | 

current submit client idx and staleness is  0 1
 benign loss is  1.296789526939392
distance x is tensor(100.7196, device='cuda:3')
benign distance is  tensor(100.7196, device='cuda:3')
norm1 res is  tensor(0.1112, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.14001569151878357
distance x is tensor(133.6865, device='cuda:3')
benign distance is  tensor(133.6865, device='cuda:3')
norm1 res is  tensor(0.1510, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.47311297059059143
distance x is tensor(97.3051, device='cuda:3')
benign distance is  tensor(97.3051, device='cuda:3')
norm1 res is  tensor(0.1095, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.46851786971092224
distance x is tensor(123.7173, device='cuda:3')
benign distance is  tensor(123.7173, device='cuda:3')
norm1 res is  tensor(0.1364, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7368208169937134
distance x is tensor(121.2074, device='cuda:3')
benign distance is  tensor(121.2074, device='cuda:3')
norm1 res is  tensor(0.1324, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.43949827551841736
distance x is tensor(149.5477, device='cuda:3')
benign distance is  tensor(149.5477, device='cuda:3')
norm1 res is  tensor(0.1657, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.4898819327354431
distance x is tensor(120.7127, device='cuda:3')
benign distance is  tensor(120.7127, device='cuda:3')
norm1 res is  tensor(0.1267, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.41348323225975037
distance x is tensor(132.8768, device='cuda:3')
benign distance is  tensor(132.8768, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(138.1560, device='cuda:3')
compute distance is  tensor(138.1560, device='cuda:3')
compute norm is  tensor(67.9875, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.8406, device='cuda:3')
compute distance is  tensor(141.8406, device='cuda:3')
compute norm is  tensor(67.7998, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6037, device='cuda:3')
compute distance is  tensor(152.6037, device='cuda:3')
compute norm is  tensor(68.1753, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.4831, device='cuda:3')
compute distance is  tensor(150.4831, device='cuda:3')
compute norm is  tensor(67.9875, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8131, device='cuda:3')
compute distance is  tensor(137.8131, device='cuda:3')
compute norm is  tensor(67.9965, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.7940, device='cuda:3')
compute distance is  tensor(162.7940, device='cuda:3')
compute norm is  tensor(68.3588, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2448, device='cuda:3')
compute distance is  tensor(139.2448, device='cuda:3')
compute norm is  tensor(67.9153, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.7172, device='cuda:3')
compute distance is  tensor(152.7172, device='cuda:3')
compute norm is  tensor(68.0048, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.8887, device='cuda:3')
compute distance is  tensor(171.8887, device='cuda:3')
compute norm is  tensor(68.3682, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.0694, device='cuda:3')
compute distance is  tensor(150.0694, device='cuda:3')
compute norm is  tensor(67.9064, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.8808, device='cuda:3')
compute distance is  tensor(138.8808, device='cuda:3')
compute norm is  tensor(67.8490, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.7322, device='cuda:3')
compute distance is  tensor(142.7322, device='cuda:3')
compute norm is  tensor(67.9248, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(171.8887, device='cuda:3')
distance x is tensor(107607.4609, device='cuda:3')
distance x is tensor(107607.4609, device='cuda:3')
________________________________
test distance is  tensor(107607.4609, device='cuda:3')
test distance1 is  tensor(107607.4609, device='cuda:3')
test similarity is  tensor(0.3881, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130159576500516.58
test entropy is  0.0
________________________________
cal ratio is  0.03916773953524815
distance x is tensor(4214.7471, device='cuda:3')
cal_distance is  tensor(4214.7471, device='cuda:3')
cal ratio is  0.19790827367495767
distance x is tensor(834.1373, device='cuda:3')
cal_distance is  tensor(834.1373, device='cuda:3')
cal ratio is  0.44486776639492276
distance x is tensor(371.0836, device='cuda:3')
cal_distance is  tensor(371.0836, device='cuda:3')
cal ratio is  0.6669815018743215
distance x is tensor(247.5076, device='cuda:3')
cal_distance is  tensor(247.5076, device='cuda:3')
cal ratio is  0.8166865928921033
distance x is tensor(202.1371, device='cuda:3')
cal_distance is  tensor(202.1371, device='cuda:3')
cal ratio is  0.9037050413553993
distance x is tensor(182.6728, device='cuda:3')
cal_distance is  tensor(182.6728, device='cuda:3')
cal ratio is  0.9506326823328558
distance x is tensor(173.6550, device='cuda:3')
cal_distance is  tensor(173.6550, device='cuda:3')
cal ratio is  0.9750032396384972
distance x is tensor(169.3143, device='cuda:3')
cal_distance is  tensor(169.3143, device='cuda:3')
distance x is tensor(169.3143, device='cuda:3')
return_distance is  tensor(169.3143, device='cuda:3')
distance x is tensor(169.3041, device='cuda:3')
distance x is tensor(169.3041, device='cuda:3')
________________________________
test distance is  tensor(169.3041, device='cuda:3')
test distance1 is  tensor(169.3041, device='cuda:3')
test similarity is  tensor(0.9735, device='cuda:3')
test acc is  0.11871666682299858
test loss is 173.50113300575632
test entropy is  0.005040901940286381
________________________________
0
distance x is tensor(169.3041, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.005446729207444699
avg test loss is  173.36846583840182
avg accuracy is  0.8118000001563249
solo acc is  0.11888333348966526
compute similarity  is  tensor(0.9735, device='cuda:3')
compute_distance is  tensor(169.3041, device='cuda:3')
compute_norm is  tensor(71.8980, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(172.0445, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0903662375168506
avg test loss is  1.6745989898374594
avg accuracy is  0.7526000001563277
solo acc is  0.2598833334896718
compute similarity  is  tensor(0.9726, device='cuda:3')
compute_distance is  tensor(172.0445, device='cuda:3')
compute_norm is  tensor(71.9385, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(174.1402, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6651017984220469
avg test loss is  2.55924920804465
avg accuracy is  0.6978500001563307
solo acc is  0.11678333348966527
compute similarity  is  tensor(0.9722, device='cuda:3')
compute_distance is  tensor(174.1402, device='cuda:3')
compute_norm is  tensor(71.6205, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(174.8004, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.999161280739282
avg test loss is  1.5039077504103118
avg accuracy is  0.7736833334896601
solo acc is  0.2721833334896722
compute similarity  is  tensor(0.9721, device='cuda:3')
compute_distance is  tensor(174.8004, device='cuda:3')
compute_norm is  tensor(71.2453, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(174.8004, device='cuda:3')
distance x is tensor(174.8004, device='cuda:3')
________________________________
test distance is  tensor(174.8004, device='cuda:3')
test distance1 is  tensor(174.8004, device='cuda:3')
test similarity is  tensor(0.9721, device='cuda:3')
test acc is  0.27266666682300555
test loss is 1.508427963836361
test entropy is  0.9999994444313334
________________________________
cal ratio is  0.9718036214737068
distance x is tensor(169.8801, device='cuda:3')
cal_distance is  tensor(169.8801, device='cuda:3')
distance x is tensor(169.8801, device='cuda:3')
return_distance is  tensor(169.8801, device='cuda:3')
distance x is tensor(169.8715, device='cuda:3')
distance x is tensor(169.8715, device='cuda:3')
________________________________
test distance is  tensor(169.8715, device='cuda:3')
test distance1 is  tensor(169.8715, device='cuda:3')
test similarity is  tensor(0.9734, device='cuda:3')
test acc is  0.29736666682300605
test loss is 1.4535767894818077
test entropy is  1.0292416274039222
________________________________
0
distance x is tensor(169.8715, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0275989045847709
avg test loss is  1.4586814043364291
avg accuracy is  0.7822500001563263
solo acc is  0.2947500001563394
compute similarity  is  tensor(0.9734, device='cuda:3')
compute_distance is  tensor(169.8715, device='cuda:3')
compute_norm is  tensor(71.0778, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.6001, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6239372144884138
avg test loss is  2.386934019609301
avg accuracy is  0.7349833334896619
solo acc is  0.11428333348966527
compute similarity  is  tensor(0.9731, device='cuda:3')
compute_distance is  tensor(171.6001, device='cuda:3')
compute_norm is  tensor(70.7737, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(172.1581, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9676079221371648
avg test loss is  1.4561794241354156
avg accuracy is  0.7799166668229929
solo acc is  0.25996666682300523
compute similarity  is  tensor(0.9730, device='cuda:3')
compute_distance is  tensor(172.1581, device='cuda:3')
compute_norm is  tensor(70.4101, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(172.1581, device='cuda:3')
distance x is tensor(172.1581, device='cuda:3')
________________________________
test distance is  tensor(172.1581, device='cuda:3')
test distance1 is  tensor(172.1581, device='cuda:3')
test similarity is  tensor(0.9730, device='cuda:3')
test acc is  0.2621333334896719
test loss is 1.4551874350891438
test entropy is  0.9665162309781828
________________________________
cal ratio is  0.9792328597617039
distance x is tensor(168.5913, device='cuda:3')
cal_distance is  tensor(168.5913, device='cuda:3')
distance x is tensor(168.5913, device='cuda:3')
return_distance is  tensor(168.5913, device='cuda:3')
distance x is tensor(168.5828, device='cuda:3')
distance x is tensor(168.5828, device='cuda:3')
________________________________
test distance is  tensor(168.5828, device='cuda:3')
test distance1 is  tensor(168.5828, device='cuda:3')
test similarity is  tensor(0.9740, device='cuda:3')
test acc is  0.2779000001563391
test loss is 1.4192036141210527
test entropy is  0.9872684741198127
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.1415351629257202
mal norm is  tensor(800.9527, device='cuda:3')
distance x is tensor(168.5913, device='cuda:3')
mal distance is  tensor(168.5913, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(20.2754, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(439.9052, device='cuda:3')
user_param_square tensor(94.4418, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-38.3625, device='cuda:3')
score : tensor(-0.4037, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.6048, device='cuda:3')
user_param_square tensor(110.2598, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(2.8083, device='cuda:3')
score : tensor(0.0080, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(417.6677, device='cuda:3')
user_param_square tensor(92.0238, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(36.7204, device='cuda:3')
score : tensor(0.3471, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.3423, device='cuda:3')
user_param_square tensor(104.8628, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-25.2182, device='cuda:3')
score : tensor(-0.2723, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.6984, device='cuda:3')
user_param_square tensor(102.8477, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-28.2735, device='cuda:3')
score : tensor(-0.3028, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.2940, device='cuda:3')
user_param_square tensor(114.8259, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(11.6283, device='cuda:3')
score : tensor(0.0962, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.9163, device='cuda:3')
user_param_square tensor(100.8789, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-19.7872, device='cuda:3')
score : tensor(-0.2179, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.9168, device='cuda:3')
user_param_square tensor(108.1537, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-13.4484, device='cuda:3')
score : tensor(-0.1546, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.9527, device='cuda:3')
user_param_square tensor(127.4349, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-9.4014, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.2352, device='cuda:3')
user_param_square tensor(114.2897, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(95.3265, device='cuda:3')
score : tensor(0.9332, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.5286, device='cuda:3')
user_param_square tensor(117.2057, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(67.1825, device='cuda:3')
score : tensor(0.6517, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.9071, device='cuda:3')
user_param_square tensor(119.6351, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(7.4170, device='cuda:3')
score : tensor(0.0541, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.4107, device='cuda:3')
user_param_square tensor(113.5935, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(69.9084, device='cuda:3')
score : tensor(0.6790, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.2983, device='cuda:3')
user_param_square tensor(115.0908, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(35.6772, device='cuda:3')
score : tensor(0.3367, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.3402, device='cuda:3')
user_param_square tensor(114.4762, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(2.4775, device='cuda:3')
score : tensor(0.0047, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.2230, device='cuda:3')
user_param_square tensor(113.5768, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(5.4925, device='cuda:3')
score : tensor(0.0349, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.2798, device='cuda:3')
user_param_square tensor(111.6010, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(15.7638, device='cuda:3')
score : tensor(0.1376, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.0213, device='cuda:3')
user_param_square tensor(118.7090, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(36.4024, device='cuda:3')
score : tensor(0.3439, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.6097, device='cuda:3')
user_param_square tensor(113.0746, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(12.1099, device='cuda:3')
score : tensor(0.1010, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.5259, device='cuda:3')
user_param_square tensor(116.2501, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-6.1946, device='cuda:3')
score : tensor(-0.0820, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(716.4992, device='cuda:3')
user_param_square tensor(120.5293, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-11.7887, device='cuda:3')
score : tensor(-0.1380, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.0862, device='cuda:3')
user_param_square tensor(115.7747, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(27.1664, device='cuda:3')
score : tensor(0.2516, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.9402, device='cuda:3')
user_param_square tensor(116.8081, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(3.5757, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.6569, device='cuda:3')
user_param_square tensor(122.7097, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-8.8302, device='cuda:3')
score : tensor(-0.1084, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.5665, device='cuda:3')
user_param_square tensor(113.5181, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(19.3750, device='cuda:3')
score : tensor(0.1737, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.8884, device='cuda:3')
user_param_square tensor(116.1072, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(18.7703, device='cuda:3')
score : tensor(0.1676, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2437, device='cuda:3')
user_param_square tensor(116.3998, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(34.7797, device='cuda:3')
score : tensor(0.3277, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2645, device='cuda:3')
user_param_square tensor(105.3376, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-0.0913, device='cuda:3')
score : tensor(-0.0210, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.5629, device='cuda:3')
user_param_square tensor(117.8985, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-39.3663, device='cuda:3')
score : tensor(-0.4137, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.3071, device='cuda:3')
user_param_square tensor(115.3555, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(-1.0101, device='cuda:3')
score : tensor(-0.0302, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.0278, device='cuda:3')
user_param_square tensor(114.5371, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(5.4626, device='cuda:3')
score : tensor(0.0346, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.5699, device='cuda:3')
user_param_square tensor(111.2634, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(39.8243, device='cuda:3')
score : tensor(0.3782, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.2086, device='cuda:3')
user_param_square tensor(114.3760, device='cuda:3')
global_param_square tensor(20.2754, device='cuda:3')
part1 is  tensor(15.9181, device='cuda:3')
score : tensor(0.1391, device='cuda:3')
accept
len accept list 21
len all weights is 21
 
Avg Training Stats after 80 global rounds:
Train Accuracy: 90.03% 

Test Accuracy: 89.13% 


 | Global Training Round : 81 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1887567788362503
distance x is tensor(94.4914, device='cuda:3')
benign distance is  tensor(94.4914, device='cuda:3')
norm1 res is  tensor(0.1103, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.1544378399848938
distance x is tensor(114.2691, device='cuda:3')
benign distance is  tensor(114.2691, device='cuda:3')
norm1 res is  tensor(0.1251, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.08109444379806519
distance x is tensor(79.2670, device='cuda:3')
benign distance is  tensor(79.2670, device='cuda:3')
norm1 res is  tensor(0.0891, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3226467967033386
distance x is tensor(107.0694, device='cuda:3')
benign distance is  tensor(107.0694, device='cuda:3')
norm1 res is  tensor(0.1177, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.1751488745212555
distance x is tensor(118.3900, device='cuda:3')
benign distance is  tensor(118.3900, device='cuda:3')
norm1 res is  tensor(0.1304, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8807801008224487
distance x is tensor(135.7022, device='cuda:3')
benign distance is  tensor(135.7022, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.48893433809280396
distance x is tensor(93.8762, device='cuda:3')
benign distance is  tensor(93.8762, device='cuda:3')
norm1 res is  tensor(0.1019, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.1712682843208313
distance x is tensor(115.7610, device='cuda:3')
benign distance is  tensor(115.7610, device='cuda:3')
norm1 res is  tensor(0.1269, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3261684477329254
distance x is tensor(121.5945, device='cuda:3')
benign distance is  tensor(121.5945, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.36275631189346313
distance x is tensor(126.6824, device='cuda:3')
benign distance is  tensor(126.6824, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.254838764667511
distance x is tensor(116.5648, device='cuda:3')
benign distance is  tensor(116.5648, device='cuda:3')
norm1 res is  tensor(0.1303, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.04382700473070145
distance x is tensor(124.9626, device='cuda:3')
benign distance is  tensor(124.9626, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.42105478048324585
distance x is tensor(128.8081, device='cuda:3')
benign distance is  tensor(128.8081, device='cuda:3')
norm1 res is  tensor(0.1441, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.04668820649385452
distance x is tensor(132.0216, device='cuda:3')
benign distance is  tensor(132.0216, device='cuda:3')
norm1 res is  tensor(0.1451, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.32447654008865356
distance x is tensor(115.0167, device='cuda:3')
benign distance is  tensor(115.0167, device='cuda:3')
norm1 res is  tensor(0.1298, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4047820568084717
distance x is tensor(120.1756, device='cuda:3')
benign distance is  tensor(120.1756, device='cuda:3')
norm1 res is  tensor(0.1315, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.29300788044929504
distance x is tensor(133.3575, device='cuda:3')
benign distance is  tensor(133.3575, device='cuda:3')
norm1 res is  tensor(0.1443, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.34559139609336853
distance x is tensor(116.3966, device='cuda:3')
benign distance is  tensor(116.3966, device='cuda:3')
norm1 res is  tensor(0.1276, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.10257592052221298
distance x is tensor(133.2512, device='cuda:3')
benign distance is  tensor(133.2512, device='cuda:3')
norm1 res is  tensor(0.1515, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.21438148617744446
distance x is tensor(127.3635, device='cuda:3')
benign distance is  tensor(127.3635, device='cuda:3')
norm1 res is  tensor(0.1380, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.3504261076450348
distance x is tensor(123.0965, device='cuda:3')
benign distance is  tensor(123.0965, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.3718709349632263
distance x is tensor(130.7801, device='cuda:3')
benign distance is  tensor(130.7801, device='cuda:3')
norm1 res is  tensor(0.1470, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.18769536912441254
distance x is tensor(129.2369, device='cuda:3')
benign distance is  tensor(129.2369, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.386897474527359
distance x is tensor(119.7999, device='cuda:3')
benign distance is  tensor(119.7999, device='cuda:3')
norm1 res is  tensor(0.1330, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.35530200600624084
distance x is tensor(132.7212, device='cuda:3')
benign distance is  tensor(132.7212, device='cuda:3')
norm1 res is  tensor(0.1493, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.0952199324965477
distance x is tensor(122.4408, device='cuda:3')
benign distance is  tensor(122.4408, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.7121254205703735
distance x is tensor(128.4799, device='cuda:3')
benign distance is  tensor(128.4799, device='cuda:3')
norm1 res is  tensor(0.1463, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.29676634073257446
distance x is tensor(117.9993, device='cuda:3')
benign distance is  tensor(117.9993, device='cuda:3')
norm1 res is  tensor(0.1290, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.20256733894348145
distance x is tensor(121.6854, device='cuda:3')
benign distance is  tensor(121.6854, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.20917029678821564
distance x is tensor(118.1797, device='cuda:3')
benign distance is  tensor(118.1797, device='cuda:3')
norm1 res is  tensor(0.1319, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.19800642132759094
distance x is tensor(136.7423, device='cuda:3')
benign distance is  tensor(136.7423, device='cuda:3')
norm1 res is  tensor(0.1487, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.3595764636993408
distance x is tensor(129.8231, device='cuda:3')
benign distance is  tensor(129.8231, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(134.3466, device='cuda:3')
compute distance is  tensor(134.3466, device='cuda:3')
compute norm is  tensor(67.4600, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9249, device='cuda:3')
compute distance is  tensor(127.9249, device='cuda:3')
compute norm is  tensor(67.3854, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5436, device='cuda:3')
compute distance is  tensor(135.5436, device='cuda:3')
compute norm is  tensor(67.6069, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3893, device='cuda:3')
compute distance is  tensor(133.3893, device='cuda:3')
compute norm is  tensor(67.5373, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9280, device='cuda:3')
compute distance is  tensor(142.9280, device='cuda:3')
compute norm is  tensor(67.7392, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6558, device='cuda:3')
compute distance is  tensor(125.6558, device='cuda:3')
compute norm is  tensor(67.4620, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.3280, device='cuda:3')
compute distance is  tensor(121.3280, device='cuda:3')
compute norm is  tensor(67.3637, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.0971, device='cuda:3')
compute distance is  tensor(128.0971, device='cuda:3')
compute norm is  tensor(67.5160, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.7164, device='cuda:3')
compute distance is  tensor(145.7164, device='cuda:3')
compute norm is  tensor(67.6530, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.5736, device='cuda:3')
compute distance is  tensor(131.5736, device='cuda:3')
compute norm is  tensor(67.5371, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5974, device='cuda:3')
compute distance is  tensor(134.5974, device='cuda:3')
compute norm is  tensor(67.5129, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.8175, device='cuda:3')
compute distance is  tensor(126.8175, device='cuda:3')
compute norm is  tensor(67.4826, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.7164, device='cuda:3')
distance x is tensor(107608.4375, device='cuda:3')
distance x is tensor(107608.4375, device='cuda:3')
________________________________
test distance is  tensor(107608.4375, device='cuda:3')
test distance1 is  tensor(107608.4375, device='cuda:3')
test similarity is  tensor(0.3896, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130075442500483.55
test entropy is  0.0
________________________________
cal ratio is  0.036062609503792996
distance x is tensor(3880.6462, device='cuda:3')
cal_distance is  tensor(3880.6462, device='cuda:3')
cal ratio is  0.1899014499992063
distance x is tensor(736.9445, device='cuda:3')
cal_distance is  tensor(736.9445, device='cuda:3')
cal ratio is  0.4357756274569456
distance x is tensor(321.1454, device='cuda:3')
cal_distance is  tensor(321.1454, device='cuda:3')
cal ratio is  0.6601299951332211
distance x is tensor(211.9995, device='cuda:3')
cal_distance is  tensor(211.9995, device='cuda:3')
cal ratio is  0.8124804642162701
distance x is tensor(172.2464, device='cuda:3')
cal_distance is  tensor(172.2464, device='cuda:3')
cal ratio is  0.9013744922875093
distance x is tensor(155.2590, device='cuda:3')
cal_distance is  tensor(155.2590, device='cuda:3')
cal ratio is  0.949405841326438
distance x is tensor(147.4041, device='cuda:3')
cal_distance is  tensor(147.4041, device='cuda:3')
cal ratio is  0.9743737034547413
distance x is tensor(143.6268, device='cuda:3')
cal_distance is  tensor(143.6268, device='cuda:3')
distance x is tensor(143.6268, device='cuda:3')
return_distance is  tensor(143.6268, device='cuda:3')
distance x is tensor(143.6165, device='cuda:3')
distance x is tensor(143.6165, device='cuda:3')
________________________________
test distance is  tensor(143.6165, device='cuda:3')
test distance1 is  tensor(143.6165, device='cuda:3')
test similarity is  tensor(0.9800, device='cuda:3')
test acc is  0.2142166668230037
test loss is 53.06235398005829
test entropy is  0.0270973381193316
________________________________
0
distance x is tensor(143.6165, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.027138477815091107
avg test loss is  53.18021268376918
avg accuracy is  0.8835333334896552
solo acc is  0.21573333348967036
compute similarity  is  tensor(0.9800, device='cuda:3')
compute_distance is  tensor(143.6165, device='cuda:3')
compute_norm is  tensor(70.6278, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.8618, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9554337176051475
avg test loss is  1.415075736005169
avg accuracy is  0.8405000001563238
solo acc is  0.31906666682300655
compute similarity  is  tensor(0.9795, device='cuda:3')
compute_distance is  tensor(144.8618, device='cuda:3')
compute_norm is  tensor(70.0972, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.1729, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8953189249994404
avg test loss is  1.4940001268122496
avg accuracy is  0.8415000001563238
solo acc is  0.2627666668230053
compute similarity  is  tensor(0.9792, device='cuda:3')
compute_distance is  tensor(146.1729, device='cuda:3')
compute_norm is  tensor(69.7299, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.1922, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8882048004217493
avg test loss is  1.452957288034435
avg accuracy is  0.8438833334896568
solo acc is  0.2584833334896718
compute similarity  is  tensor(0.9790, device='cuda:3')
compute_distance is  tensor(147.1922, device='cuda:3')
compute_norm is  tensor(69.3714, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.1895, device='cuda:3')
exit early
distance x is tensor(148.1895, device='cuda:3')
distance x is tensor(148.1895, device='cuda:3')
________________________________
test distance is  tensor(148.1895, device='cuda:3')
test distance1 is  tensor(148.1895, device='cuda:3')
test similarity is  tensor(0.9788, device='cuda:3')
test acc is  0.24851666682300483
test loss is 1.4455634942695277
test entropy is  0.866638351160326
________________________________
cal ratio is  0.9717880998257119
distance x is tensor(144.0173, device='cuda:3')
cal_distance is  tensor(144.0173, device='cuda:3')
distance x is tensor(144.0173, device='cuda:3')
return_distance is  tensor(144.0173, device='cuda:3')
distance x is tensor(144.0087, device='cuda:3')
distance x is tensor(144.0087, device='cuda:3')
________________________________
test distance is  tensor(144.0087, device='cuda:3')
test distance1 is  tensor(144.0087, device='cuda:3')
test similarity is  tensor(0.9799, device='cuda:3')
test acc is  0.2947833334896728
test loss is 1.3542093064612164
test entropy is  0.9077770296952872
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.33792245388031
mal norm is  tensor(689.2577, device='cuda:3')
distance x is tensor(144.0173, device='cuda:3')
mal distance is  tensor(144.0173, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(10.3274, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(431.9531, device='cuda:3')
user_param_square tensor(66.7904, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(-0.8948, device='cuda:3')
score : tensor(-0.0191, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(496.7175, device='cuda:3')
user_param_square tensor(71.6226, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(-6.7063, device='cuda:3')
score : tensor(-0.0772, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(351.8210, device='cuda:3')
user_param_square tensor(60.2777, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(14.3805, device='cuda:3')
score : tensor(0.1337, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(467.7709, device='cuda:3')
user_param_square tensor(69.5044, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(16.5959, device='cuda:3')
score : tensor(0.1558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.1826, device='cuda:3')
user_param_square tensor(72.2304, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(-7.6314, device='cuda:3')
score : tensor(-0.0864, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.5261, device='cuda:3')
user_param_square tensor(78.8830, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(-8.5801, device='cuda:3')
score : tensor(-0.0959, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(404.5649, device='cuda:3')
user_param_square tensor(64.6383, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(3.8512, device='cuda:3')
score : tensor(0.0284, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.7936, device='cuda:3')
user_param_square tensor(72.1310, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(-7.8862, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2577, device='cuda:3')
user_param_square tensor(84.3697, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(8.5437, device='cuda:3')
score : tensor(0.0753, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.9655, device='cuda:3')
user_param_square tensor(75.6375, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(-1.4890, device='cuda:3')
score : tensor(-0.0250, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.1957, device='cuda:3')
user_param_square tensor(81.3115, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(-30.2903, device='cuda:3')
score : tensor(-0.3130, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.8187, device='cuda:3')
user_param_square tensor(74.1101, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(10.1240, device='cuda:3')
score : tensor(0.0911, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.3326, device='cuda:3')
user_param_square tensor(76.4771, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(5.2070, device='cuda:3')
score : tensor(0.0419, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.4839, device='cuda:3')
user_param_square tensor(75.6046, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(5.6342, device='cuda:3')
score : tensor(0.0462, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(554.3988, device='cuda:3')
user_param_square tensor(75.6670, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(-18.9309, device='cuda:3')
score : tensor(-0.1994, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.3149, device='cuda:3')
user_param_square tensor(77.7482, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(3.1783, device='cuda:3')
score : tensor(0.0217, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.5453, device='cuda:3')
user_param_square tensor(77.0296, device='cuda:3')
global_param_square tensor(10.3274, device='cuda:3')
part1 is  tensor(15.0296, device='cuda:3')
score : tensor(0.1402, device='cuda:3')
accept
len accept list 20
len all weights is 20
 
Avg Training Stats after 81 global rounds:
Train Accuracy: 87.33% 

Test Accuracy: 86.57% 


 | Global Training Round : 82 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4495132565498352
distance x is tensor(117.4064, device='cuda:3')
benign distance is  tensor(117.4064, device='cuda:3')
norm1 res is  tensor(0.1295, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.29052814841270447
distance x is tensor(132.7767, device='cuda:3')
benign distance is  tensor(132.7767, device='cuda:3')
norm1 res is  tensor(0.1459, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.36916598677635193
distance x is tensor(131.7183, device='cuda:3')
benign distance is  tensor(131.7183, device='cuda:3')
norm1 res is  tensor(0.1433, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.23489022254943848
distance x is tensor(115.4578, device='cuda:3')
benign distance is  tensor(115.4578, device='cuda:3')
norm1 res is  tensor(0.1234, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.38285237550735474
distance x is tensor(109.3661, device='cuda:3')
benign distance is  tensor(109.3661, device='cuda:3')
norm1 res is  tensor(0.1185, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5040439367294312
distance x is tensor(135.0270, device='cuda:3')
benign distance is  tensor(135.0270, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.3530430793762207
distance x is tensor(101.6348, device='cuda:3')
benign distance is  tensor(101.6348, device='cuda:3')
norm1 res is  tensor(0.1078, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.1754334717988968
distance x is tensor(125.8287, device='cuda:3')
benign distance is  tensor(125.8287, device='cuda:3')
norm1 res is  tensor(0.1347, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.4512445032596588
distance x is tensor(139.5390, device='cuda:3')
benign distance is  tensor(139.5390, device='cuda:3')
norm1 res is  tensor(0.1535, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.36407122015953064
distance x is tensor(150.9635, device='cuda:3')
benign distance is  tensor(150.9635, device='cuda:3')
norm1 res is  tensor(0.1656, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.36881694197654724
distance x is tensor(139.3549, device='cuda:3')
benign distance is  tensor(139.3549, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.07913071662187576
distance x is tensor(150.4277, device='cuda:3')
benign distance is  tensor(150.4277, device='cuda:3')
norm1 res is  tensor(0.1701, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.35342326760292053
distance x is tensor(133.1160, device='cuda:3')
benign distance is  tensor(133.1160, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.26565390825271606
distance x is tensor(141.5142, device='cuda:3')
benign distance is  tensor(141.5142, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.17091533541679382
distance x is tensor(156.0993, device='cuda:3')
benign distance is  tensor(156.0993, device='cuda:3')
norm1 res is  tensor(0.1693, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.39445555210113525
distance x is tensor(137.6407, device='cuda:3')
benign distance is  tensor(137.6407, device='cuda:3')
norm1 res is  tensor(0.1491, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(133.4285, device='cuda:3')
compute distance is  tensor(133.4285, device='cuda:3')
compute norm is  tensor(68.6469, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.3870, device='cuda:3')
compute distance is  tensor(145.3870, device='cuda:3')
compute norm is  tensor(68.6984, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.4637, device='cuda:3')
compute distance is  tensor(161.4637, device='cuda:3')
compute norm is  tensor(69.0776, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.3520, device='cuda:3')
compute distance is  tensor(143.3520, device='cuda:3')
compute norm is  tensor(68.7946, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2560, device='cuda:3')
compute distance is  tensor(135.2560, device='cuda:3')
compute norm is  tensor(68.5853, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.1514, device='cuda:3')
compute distance is  tensor(151.1514, device='cuda:3')
compute norm is  tensor(68.9344, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5918, device='cuda:3')
compute distance is  tensor(148.5918, device='cuda:3')
compute norm is  tensor(68.7462, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.1627, device='cuda:3')
compute distance is  tensor(146.1627, device='cuda:3')
compute norm is  tensor(68.7559, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.7965, device='cuda:3')
compute distance is  tensor(155.7965, device='cuda:3')
compute norm is  tensor(68.9731, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3018, device='cuda:3')
compute distance is  tensor(134.3018, device='cuda:3')
compute norm is  tensor(68.6531, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.0030, device='cuda:3')
compute distance is  tensor(155.0030, device='cuda:3')
compute norm is  tensor(68.9669, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5454, device='cuda:3')
compute distance is  tensor(136.5454, device='cuda:3')
compute norm is  tensor(68.7310, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(161.4637, device='cuda:3')
distance x is tensor(107553.2656, device='cuda:3')
distance x is tensor(107553.2656, device='cuda:3')
________________________________
test distance is  tensor(107553.2656, device='cuda:3')
test distance1 is  tensor(107553.2656, device='cuda:3')
test similarity is  tensor(0.4724, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130096714713625.11
test entropy is  0.0
________________________________
cal ratio is  0.03797096970161775
distance x is tensor(4083.9072, device='cuda:3')
cal_distance is  tensor(4083.9072, device='cuda:3')
cal ratio is  0.1948612776996731
distance x is tensor(795.7996, device='cuda:3')
cal_distance is  tensor(795.7996, device='cuda:3')
cal ratio is  0.4414297887281718
distance x is tensor(351.2925, device='cuda:3')
cal_distance is  tensor(351.2925, device='cuda:3')
cal ratio is  0.6643991289216049
distance x is tensor(233.4002, device='cuda:3')
cal_distance is  tensor(233.4002, device='cuda:3')
cal ratio is  0.8151037530006278
distance x is tensor(190.2463, device='cuda:3')
cal_distance is  tensor(190.2463, device='cuda:3')
cal ratio is  0.9028286954827419
distance x is tensor(171.7603, device='cuda:3')
cal_distance is  tensor(171.7603, device='cuda:3')
cal ratio is  0.9501715788367721
distance x is tensor(163.2020, device='cuda:3')
cal_distance is  tensor(163.2020, device='cuda:3')
cal ratio is  0.9747667193836582
distance x is tensor(159.0841, device='cuda:3')
cal_distance is  tensor(159.0841, device='cuda:3')
distance x is tensor(159.0841, device='cuda:3')
return_distance is  tensor(159.0841, device='cuda:3')
distance x is tensor(159.0738, device='cuda:3')
distance x is tensor(159.0738, device='cuda:3')
________________________________
test distance is  tensor(159.0738, device='cuda:3')
test distance1 is  tensor(159.0738, device='cuda:3')
test similarity is  tensor(0.9801, device='cuda:3')
test acc is  0.1025333334896653
test loss is 117.42059265982621
test entropy is  0.0017687655180710455
________________________________
0
distance x is tensor(159.0738, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0017563564965788335
avg test loss is  117.43044540470343
avg accuracy is  0.7644166668229938
solo acc is  0.10255000015633196
compute similarity  is  tensor(0.9801, device='cuda:3')
compute_distance is  tensor(159.0738, device='cuda:3')
compute_norm is  tensor(72.8881, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.6789, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.984246540806695
avg test loss is  1.4387247986885021
avg accuracy is  0.6299500001563352
solo acc is  0.2743666668230056
compute similarity  is  tensor(0.9808, device='cuda:3')
compute_distance is  tensor(153.6789, device='cuda:3')
compute_norm is  tensor(72.6971, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(153.6789, device='cuda:3')
distance x is tensor(153.6789, device='cuda:3')
________________________________
test distance is  tensor(153.6789, device='cuda:3')
test distance1 is  tensor(153.6789, device='cuda:3')
test similarity is  tensor(0.9808, device='cuda:3')
test acc is  0.2727000001563389
test loss is 1.442224507265762
test entropy is  0.9848867768544887
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.5912882089614868
mal norm is  tensor(787.5794, device='cuda:3')
distance x is tensor(153.6878, device='cuda:3')
mal distance is  tensor(153.6878, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(18.7161, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.6967, device='cuda:3')
user_param_square tensor(97.5747, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(155.2528, device='cuda:3')
score : tensor(1.5340, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.3663, device='cuda:3')
user_param_square tensor(103.9522, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(139.6938, device='cuda:3')
score : tensor(1.3784, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(559.1260, device='cuda:3')
user_param_square tensor(102.2970, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(119.3633, device='cuda:3')
score : tensor(1.1751, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(481.9682, device='cuda:3')
user_param_square tensor(94.9767, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(143.8919, device='cuda:3')
score : tensor(1.4204, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(469.2669, device='cuda:3')
user_param_square tensor(93.7169, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(104.0476, device='cuda:3')
score : tensor(1.0220, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.4897, device='cuda:3')
user_param_square tensor(103.6929, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(97.8049, device='cuda:3')
score : tensor(0.9595, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(429.3371, device='cuda:3')
user_param_square tensor(89.6411, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(174.0646, device='cuda:3')
score : tensor(1.7221, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.5181, device='cuda:3')
user_param_square tensor(99.7394, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(69.5960, device='cuda:3')
score : tensor(0.6774, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.5794, device='cuda:3')
user_param_square tensor(121.4102, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(-151.7948, device='cuda:3')
score : tensor(-1.5365, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.0715, device='cuda:3')
user_param_square tensor(109.7078, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(120.7418, device='cuda:3')
score : tensor(1.1889, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.3253, device='cuda:3')
user_param_square tensor(110.3248, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(78.8194, device='cuda:3')
score : tensor(0.7697, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.9710, device='cuda:3')
user_param_square tensor(107.8062, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(105.3324, device='cuda:3')
score : tensor(1.0348, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.9434, device='cuda:3')
user_param_square tensor(110.9691, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(110.9020, device='cuda:3')
score : tensor(1.0905, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.9594, device='cuda:3')
user_param_square tensor(111.3913, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(86.4718, device='cuda:3')
score : tensor(0.8462, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.9636, device='cuda:3')
user_param_square tensor(112.3120, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(126.6102, device='cuda:3')
score : tensor(1.2476, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.8627, device='cuda:3')
user_param_square tensor(107.3618, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(90.1743, device='cuda:3')
score : tensor(0.8832, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.5084, device='cuda:3')
user_param_square tensor(108.0262, device='cuda:3')
global_param_square tensor(18.7161, device='cuda:3')
part1 is  tensor(91.3312, device='cuda:3')
score : tensor(0.8948, device='cuda:3')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 82 global rounds:
Train Accuracy: 90.16% 

Test Accuracy: 89.26% 


 | Global Training Round : 83 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2926250100135803
distance x is tensor(106.3993, device='cuda:3')
benign distance is  tensor(106.3993, device='cuda:3')
norm1 res is  tensor(0.1222, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3835117220878601
distance x is tensor(136.9762, device='cuda:3')
benign distance is  tensor(136.9762, device='cuda:3')
norm1 res is  tensor(0.1500, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.06919895857572556
distance x is tensor(116.3187, device='cuda:3')
benign distance is  tensor(116.3187, device='cuda:3')
norm1 res is  tensor(0.1274, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6949913501739502
distance x is tensor(102.9175, device='cuda:3')
benign distance is  tensor(102.9175, device='cuda:3')
norm1 res is  tensor(0.1129, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.2370913326740265
distance x is tensor(111.9088, device='cuda:3')
benign distance is  tensor(111.9088, device='cuda:3')
norm1 res is  tensor(0.1273, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8182421922683716
distance x is tensor(133.6747, device='cuda:3')
benign distance is  tensor(133.6747, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.09244826436042786
distance x is tensor(104.1850, device='cuda:3')
benign distance is  tensor(104.1850, device='cuda:3')
norm1 res is  tensor(0.1161, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3808837831020355
distance x is tensor(114.1347, device='cuda:3')
benign distance is  tensor(114.1347, device='cuda:3')
norm1 res is  tensor(0.1301, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3843477964401245
distance x is tensor(135.7374, device='cuda:3')
benign distance is  tensor(135.7374, device='cuda:3')
norm1 res is  tensor(0.1473, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.5575157403945923
distance x is tensor(135.4443, device='cuda:3')
benign distance is  tensor(135.4443, device='cuda:3')
norm1 res is  tensor(0.1443, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.393724262714386
distance x is tensor(121.2749, device='cuda:3')
benign distance is  tensor(121.2749, device='cuda:3')
norm1 res is  tensor(0.1295, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.19944904744625092
distance x is tensor(138.3298, device='cuda:3')
benign distance is  tensor(138.3298, device='cuda:3')
norm1 res is  tensor(0.1500, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.5132449269294739
distance x is tensor(164.3113, device='cuda:3')
benign distance is  tensor(164.3113, device='cuda:3')
norm1 res is  tensor(0.1776, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.6904544830322266
distance x is tensor(131.9240, device='cuda:3')
benign distance is  tensor(131.9240, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.20505015552043915
distance x is tensor(109.9649, device='cuda:3')
benign distance is  tensor(109.9649, device='cuda:3')
norm1 res is  tensor(0.1223, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.13731856644153595
distance x is tensor(119.7228, device='cuda:3')
benign distance is  tensor(119.7228, device='cuda:3')
norm1 res is  tensor(0.1348, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(137.3778, device='cuda:3')
compute distance is  tensor(137.3778, device='cuda:3')
compute norm is  tensor(68.5253, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3055, device='cuda:3')
compute distance is  tensor(126.3055, device='cuda:3')
compute norm is  tensor(68.2911, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3929, device='cuda:3')
compute distance is  tensor(138.3929, device='cuda:3')
compute norm is  tensor(68.6115, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7013, device='cuda:3')
compute distance is  tensor(126.7013, device='cuda:3')
compute norm is  tensor(68.2773, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0258, device='cuda:3')
compute distance is  tensor(139.0258, device='cuda:3')
compute norm is  tensor(68.5910, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.9494, device='cuda:3')
compute distance is  tensor(138.9494, device='cuda:3')
compute norm is  tensor(68.5410, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6701, device='cuda:3')
compute distance is  tensor(132.6701, device='cuda:3')
compute norm is  tensor(68.4521, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9096, device='cuda:3')
compute distance is  tensor(144.9096, device='cuda:3')
compute norm is  tensor(68.6215, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.1776, device='cuda:3')
compute distance is  tensor(147.1776, device='cuda:3')
compute norm is  tensor(68.6473, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8702, device='cuda:3')
compute distance is  tensor(133.8702, device='cuda:3')
compute norm is  tensor(68.5218, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0926, device='cuda:3')
compute distance is  tensor(134.0926, device='cuda:3')
compute norm is  tensor(68.5167, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8280, device='cuda:3')
compute distance is  tensor(137.8280, device='cuda:3')
compute norm is  tensor(68.6469, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.1776, device='cuda:3')
distance x is tensor(107581.3594, device='cuda:3')
distance x is tensor(107581.3594, device='cuda:3')
________________________________
test distance is  tensor(107581.3594, device='cuda:3')
test distance1 is  tensor(107581.3594, device='cuda:3')
test similarity is  tensor(0.4327, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130127689747038.97
test entropy is  0.0
________________________________
cal ratio is  0.036247527748825
distance x is tensor(3899.5642, device='cuda:3')
cal_distance is  tensor(3899.5642, device='cuda:3')
cal ratio is  0.19038769423100024
distance x is tensor(742.4330, device='cuda:3')
cal_distance is  tensor(742.4330, device='cuda:3')
cal ratio is  0.4363331974523591
distance x is tensor(323.9511, device='cuda:3')
cal_distance is  tensor(323.9511, device='cuda:3')
cal ratio is  0.6605522138401257
distance x is tensor(213.9884, device='cuda:3')
cal_distance is  tensor(213.9884, device='cuda:3')
cal ratio is  0.8127403004283713
distance x is tensor(173.9179, device='cuda:3')
cal_distance is  tensor(173.9179, device='cuda:3')
cal ratio is  0.9015186434413818
distance x is tensor(156.7908, device='cuda:3')
cal_distance is  tensor(156.7908, device='cuda:3')
cal ratio is  0.9494817796769895
distance x is tensor(148.8703, device='cuda:3')
cal_distance is  tensor(148.8703, device='cuda:3')
cal ratio is  0.9744126538212775
distance x is tensor(145.0612, device='cuda:3')
cal_distance is  tensor(145.0612, device='cuda:3')
distance x is tensor(145.0612, device='cuda:3')
return_distance is  tensor(145.0612, device='cuda:3')
distance x is tensor(145.0510, device='cuda:3')
distance x is tensor(145.0510, device='cuda:3')
________________________________
test distance is  tensor(145.0510, device='cuda:3')
test distance1 is  tensor(145.0510, device='cuda:3')
test similarity is  tensor(0.9816, device='cuda:3')
test acc is  0.18510000015633557
test loss is 61.730297165893035
test entropy is  0.022799172024564336
________________________________
0
distance x is tensor(145.0510, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.02286312832463481
avg test loss is  61.354037433290785
avg accuracy is  0.880950000156322
solo acc is  0.18603333348966897
compute similarity  is  tensor(0.9816, device='cuda:3')
compute_distance is  tensor(145.0510, device='cuda:3')
compute_norm is  tensor(71.9445, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.1105, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9527582699683175
avg test loss is  1.4060717006482042
avg accuracy is  0.805900000156325
solo acc is  0.30476666682300624
compute similarity  is  tensor(0.9816, device='cuda:3')
compute_distance is  tensor(144.1105, device='cuda:3')
compute_norm is  tensor(71.5261, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.8658, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8946360017953396
avg test loss is  1.4880403789884247
avg accuracy is  0.8065166668229917
solo acc is  0.24520000015633817
compute similarity  is  tensor(0.9814, device='cuda:3')
compute_distance is  tensor(144.8658, device='cuda:3')
compute_norm is  tensor(71.1621, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.5016, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.883615731049194
avg test loss is  1.4614774591124642
avg accuracy is  0.8086833334896583
solo acc is  0.24473333348967138
compute similarity  is  tensor(0.9813, device='cuda:3')
compute_distance is  tensor(145.5016, device='cuda:3')
compute_norm is  tensor(70.8047, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.0736, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8718287954960805
avg test loss is  1.441122546887347
avg accuracy is  0.8133500001563247
solo acc is  0.2393166668230046
compute similarity  is  tensor(0.9812, device='cuda:3')
compute_distance is  tensor(146.0736, device='cuda:3')
compute_norm is  tensor(70.4540, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.7311, device='cuda:3')
distance x is tensor(146.7311, device='cuda:3')
________________________________
test distance is  tensor(146.7311, device='cuda:3')
test distance1 is  tensor(146.7311, device='cuda:3')
test similarity is  tensor(0.9810, device='cuda:3')
test acc is  0.24305000015633807
test loss is 1.414691992660067
test entropy is  0.8665702870405559
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.141458511352539
mal norm is  tensor(698.7471, device='cuda:3')
distance x is tensor(146.7399, device='cuda:3')
mal distance is  tensor(146.7399, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(12.5093, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(480.3278, device='cuda:3')
user_param_square tensor(77.5150, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(-5.3475, device='cuda:3')
score : tensor(-0.0658, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.8524, device='cuda:3')
user_param_square tensor(86.1899, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(-7.2801, device='cuda:3')
score : tensor(-0.0851, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.2080, device='cuda:3')
user_param_square tensor(78.9446, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(24.8813, device='cuda:3')
score : tensor(0.2365, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(438.7106, device='cuda:3')
user_param_square tensor(74.0809, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(-15.3605, device='cuda:3')
score : tensor(-0.1659, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(490.1636, device='cuda:3')
user_param_square tensor(78.3046, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(-20.9548, device='cuda:3')
score : tensor(-0.2219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.6310, device='cuda:3')
user_param_square tensor(84.9309, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(-18.4166, device='cuda:3')
score : tensor(-0.1965, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(437.7381, device='cuda:3')
user_param_square tensor(73.9987, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(1.0766, device='cuda:3')
score : tensor(-0.0015, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.2575, device='cuda:3')
user_param_square tensor(79.9718, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(-4.0245, device='cuda:3')
score : tensor(-0.0526, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7471, device='cuda:3')
user_param_square tensor(93.4926, device='cuda:3')
global_param_square tensor(12.5093, device='cuda:3')
part1 is  tensor(17.3935, device='cuda:3')
score : tensor(0.1616, device='cuda:3')
accept
len accept list 13
len all weights is 13
 
Avg Training Stats after 83 global rounds:
Train Accuracy: 72.48% 

Test Accuracy: 71.05% 


 | Global Training Round : 84 | 

current submit client idx and staleness is  0 1
 benign loss is  1.0147101879119873
distance x is tensor(206.4672, device='cuda:3')
benign distance is  tensor(206.4672, device='cuda:3')
norm1 res is  tensor(0.2102, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.6304551362991333
distance x is tensor(176.5647, device='cuda:3')
benign distance is  tensor(176.5647, device='cuda:3')
norm1 res is  tensor(0.1883, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.46178382635116577
distance x is tensor(175.0040, device='cuda:3')
benign distance is  tensor(175.0040, device='cuda:3')
norm1 res is  tensor(0.1790, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6029440760612488
distance x is tensor(177.1832, device='cuda:3')
benign distance is  tensor(177.1832, device='cuda:3')
norm1 res is  tensor(0.1790, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4010099470615387
distance x is tensor(165.1023, device='cuda:3')
benign distance is  tensor(165.1023, device='cuda:3')
norm1 res is  tensor(0.1703, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8330435752868652
distance x is tensor(174.0087, device='cuda:3')
benign distance is  tensor(174.0087, device='cuda:3')
norm1 res is  tensor(0.1822, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2030823975801468
distance x is tensor(136.5910, device='cuda:3')
benign distance is  tensor(136.5910, device='cuda:3')
norm1 res is  tensor(0.1406, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2961658835411072
distance x is tensor(183.6144, device='cuda:3')
benign distance is  tensor(183.6144, device='cuda:3')
norm1 res is  tensor(0.1897, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(169.1783, device='cuda:3')
compute distance is  tensor(169.1783, device='cuda:3')
compute norm is  tensor(70.8757, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.1540, device='cuda:3')
compute distance is  tensor(159.1540, device='cuda:3')
compute norm is  tensor(70.7260, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.3658, device='cuda:3')
compute distance is  tensor(178.3658, device='cuda:3')
compute norm is  tensor(71.0763, device='cuda:3', dtype=torch.float64)
distance x is tensor(174.4933, device='cuda:3')
compute distance is  tensor(174.4933, device='cuda:3')
compute norm is  tensor(71.1219, device='cuda:3', dtype=torch.float64)
distance x is tensor(189.8088, device='cuda:3')
compute distance is  tensor(189.8088, device='cuda:3')
compute norm is  tensor(71.3041, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.5707, device='cuda:3')
compute distance is  tensor(163.5707, device='cuda:3')
compute norm is  tensor(70.8615, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.8881, device='cuda:3')
compute distance is  tensor(152.8881, device='cuda:3')
compute norm is  tensor(70.7387, device='cuda:3', dtype=torch.float64)
distance x is tensor(186.1517, device='cuda:3')
compute distance is  tensor(186.1517, device='cuda:3')
compute norm is  tensor(71.1812, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.3714, device='cuda:3')
compute distance is  tensor(170.3714, device='cuda:3')
compute norm is  tensor(71.1801, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.5780, device='cuda:3')
compute distance is  tensor(183.5780, device='cuda:3')
compute norm is  tensor(71.1922, device='cuda:3', dtype=torch.float64)
distance x is tensor(174.8030, device='cuda:3')
compute distance is  tensor(174.8030, device='cuda:3')
compute norm is  tensor(71.0009, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.6001, device='cuda:3')
compute distance is  tensor(154.6001, device='cuda:3')
compute norm is  tensor(70.8318, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(189.8088, device='cuda:3')
distance x is tensor(107495.4375, device='cuda:3')
distance x is tensor(107495.4375, device='cuda:3')
________________________________
test distance is  tensor(107495.4375, device='cuda:3')
test distance1 is  tensor(107495.4375, device='cuda:3')
test similarity is  tensor(0.5499, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129989574732575.11
test entropy is  0.0
________________________________
cal ratio is  0.041180278561853946
distance x is tensor(4426.6978, device='cuda:3')
cal_distance is  tensor(4426.6978, device='cuda:3')
cal ratio is  0.2029291163226287
distance x is tensor(898.3099, device='cuda:3')
cal_distance is  tensor(898.3099, device='cuda:3')
cal ratio is  0.45047552495328086
distance x is tensor(404.6694, device='cuda:3')
cal_distance is  tensor(404.6694, device='cuda:3')
cal ratio is  0.6711724107003296
distance x is tensor(271.6047, device='cuda:3')
cal_distance is  tensor(271.6047, device='cuda:3')
cal ratio is  0.8192485169323653
distance x is tensor(222.5126, device='cuda:3')
cal_distance is  tensor(222.5126, device='cuda:3')
cal ratio is  0.9051216965988983
distance x is tensor(201.4015, device='cuda:3')
cal_distance is  tensor(201.4015, device='cuda:3')
cal ratio is  0.951377666806463
distance x is tensor(191.6091, device='cuda:3')
cal_distance is  tensor(191.6091, device='cuda:3')
cal ratio is  0.9753852325522604
distance x is tensor(186.8929, device='cuda:3')
cal_distance is  tensor(186.8929, device='cuda:3')
distance x is tensor(186.8929, device='cuda:3')
return_distance is  tensor(186.8929, device='cuda:3')
distance x is tensor(186.8826, device='cuda:3')
distance x is tensor(186.8826, device='cuda:3')
________________________________
test distance is  tensor(186.8826, device='cuda:3')
test distance1 is  tensor(186.8826, device='cuda:3')
test similarity is  tensor(0.9791, device='cuda:3')
test acc is  0.10030000015633199
test loss is 298.52697944234427
test entropy is  0.0002634181849570427
________________________________
0
distance x is tensor(186.8826, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0002273744487434817
avg test loss is  298.7168014949319
avg accuracy is  0.1881333334896691
solo acc is  0.10035000015633197
compute similarity  is  tensor(0.9791, device='cuda:3')
compute_distance is  tensor(186.8826, device='cuda:3')
compute_norm is  tensor(76.6022, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(195.2642, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0910983832278993
avg test loss is  1.6906303219449546
avg accuracy is  0.2514333334896716
solo acc is  0.2184500001563372
compute similarity  is  tensor(0.9776, device='cuda:3')
compute_distance is  tensor(195.2642, device='cuda:3')
compute_norm is  tensor(77.2605, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(195.4879, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6630845831147135
avg test loss is  2.548539326389207
avg accuracy is  0.16490000015633435
solo acc is  0.10763333348966529
compute similarity  is  tensor(0.9775, device='cuda:3')
compute_distance is  tensor(195.4879, device='cuda:3')
compute_norm is  tensor(76.9589, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(195.9972, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0418534623280262
avg test loss is  1.5695115964549946
avg accuracy is  0.251466666823005
solo acc is  0.23055000015633764
compute similarity  is  tensor(0.9775, device='cuda:3')
compute_distance is  tensor(195.9972, device='cuda:3')
compute_norm is  tensor(76.5947, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(195.9379, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6298851790204485
avg test loss is  2.4451945391036807
avg accuracy is  0.1620500001563341
solo acc is  0.10636666682299863
compute similarity  is  tensor(0.9775, device='cuda:3')
compute_distance is  tensor(195.9379, device='cuda:3')
compute_norm is  tensor(76.2853, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(196.3030, device='cuda:3')
distance x is tensor(196.3030, device='cuda:3')
________________________________
test distance is  tensor(196.3030, device='cuda:3')
test distance1 is  tensor(196.3030, device='cuda:3')
test similarity is  tensor(0.9774, device='cuda:3')
test acc is  0.23110000015633766
test loss is 1.5382235737751797
test entropy is  1.0008971123044679
________________________________
cal ratio is  0.9636532473949875
distance x is tensor(189.1764, device='cuda:3')
cal_distance is  tensor(189.1764, device='cuda:3')
distance x is tensor(189.1764, device='cuda:3')
return_distance is  tensor(189.1764, device='cuda:3')
distance x is tensor(189.1679, device='cuda:3')
distance x is tensor(189.1679, device='cuda:3')
________________________________
test distance is  tensor(189.1679, device='cuda:3')
test distance1 is  tensor(189.1679, device='cuda:3')
test similarity is  tensor(0.9788, device='cuda:3')
test acc is  0.22453333348967072
test loss is 1.5378327589553555
test entropy is  1.0193775365474635
________________________________
0
distance x is tensor(189.1679, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0177792938533368
avg test loss is  1.5397579636909307
avg accuracy is  0.2562000001563385
solo acc is  0.2254500001563375
compute similarity  is  tensor(0.9788, device='cuda:3')
compute_distance is  tensor(189.1679, device='cuda:3')
compute_norm is  tensor(75.6294, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.1980, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6228838580757824
avg test loss is  2.38512902663969
avg accuracy is  0.16055000015633403
solo acc is  0.10496666682299861
compute similarity  is  tensor(0.9787, device='cuda:3')
compute_distance is  tensor(189.1980, device='cuda:3')
compute_norm is  tensor(75.3234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.6629, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9838061303472214
avg test loss is  1.4919822298641652
avg accuracy is  0.2624333334896719
solo acc is  0.23688333348967117
compute similarity  is  tensor(0.9787, device='cuda:3')
compute_distance is  tensor(189.6629, device='cuda:3')
compute_norm is  tensor(74.9643, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(189.6629, device='cuda:3')
distance x is tensor(189.6629, device='cuda:3')
________________________________
test distance is  tensor(189.6629, device='cuda:3')
test distance1 is  tensor(189.6629, device='cuda:3')
test similarity is  tensor(0.9787, device='cuda:3')
test acc is  0.23516666682300444
test loss is 1.4938145234132372
test entropy is  0.9843934165008033
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3472524881362915
mal norm is  tensor(869.3391, device='cuda:3')
distance x is tensor(189.6714, device='cuda:3')
mal distance is  tensor(189.6714, device='cuda:3')
len current grad  20
len all grad 52
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(33.2726, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(835.4795, device='cuda:3')
user_param_square tensor(166.7291, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(300.0128, device='cuda:3')
score : tensor(2.9671, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.9020, device='cuda:3')
user_param_square tensor(156.7967, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(372.3745, device='cuda:3')
score : tensor(3.6907, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.3486, device='cuda:3')
user_param_square tensor(153.8455, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(250.2627, device='cuda:3')
score : tensor(2.4696, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.0692, device='cuda:3')
user_param_square tensor(153.2736, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(294.4271, device='cuda:3')
score : tensor(2.9112, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.4565, device='cuda:3')
user_param_square tensor(149.2467, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(307.8156, device='cuda:3')
score : tensor(3.0451, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.1849, device='cuda:3')
user_param_square tensor(153.7196, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(245.6152, device='cuda:3')
score : tensor(2.4231, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.9451, device='cuda:3')
user_param_square tensor(136.1287, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(298.0789, device='cuda:3')
score : tensor(2.9477, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.1478, device='cuda:3')
user_param_square tensor(157.6692, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(283.3860, device='cuda:3')
score : tensor(2.8008, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.3391, device='cuda:3')
user_param_square tensor(170.0741, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(-236.9804, device='cuda:3')
score : tensor(-2.4029, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.9771, device='cuda:3')
user_param_square tensor(173.6210, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(239.6788, device='cuda:3')
score : tensor(2.3637, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(919.9216, device='cuda:3')
user_param_square tensor(174.9520, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(247.4363, device='cuda:3')
score : tensor(2.4413, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(944.9145, device='cuda:3')
user_param_square tensor(177.3127, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(235.4427, device='cuda:3')
score : tensor(2.3214, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.4202, device='cuda:3')
user_param_square tensor(174.5235, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(288.6505, device='cuda:3')
score : tensor(2.8534, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(895.9760, device='cuda:3')
user_param_square tensor(172.6600, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(253.7440, device='cuda:3')
score : tensor(2.5044, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.5511, device='cuda:3')
user_param_square tensor(178.4944, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(225.6189, device='cuda:3')
score : tensor(2.2231, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.4468, device='cuda:3')
user_param_square tensor(175.5714, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(278.2705, device='cuda:3')
score : tensor(2.7496, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.4292, device='cuda:3')
user_param_square tensor(175.1903, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(221.5339, device='cuda:3')
score : tensor(2.1823, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(907.4696, device='cuda:3')
user_param_square tensor(173.7639, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(255.6397, device='cuda:3')
score : tensor(2.5233, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.3177, device='cuda:3')
user_param_square tensor(169.7783, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(203.3045, device='cuda:3')
score : tensor(2.0000, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(920.5120, device='cuda:3')
user_param_square tensor(175.0082, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(289.1541, device='cuda:3')
score : tensor(2.8585, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(893.4194, device='cuda:3')
user_param_square tensor(172.4135, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(242.7995, device='cuda:3')
score : tensor(2.3949, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(893.6800, device='cuda:3')
user_param_square tensor(172.4387, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(191.3433, device='cuda:3')
score : tensor(1.8804, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.9313, device='cuda:3')
user_param_square tensor(174.5722, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(249.6917, device='cuda:3')
score : tensor(2.4638, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:3')
user_param_square tensor(174.4283, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(270.7388, device='cuda:3')
score : tensor(2.6743, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(880.2866, device='cuda:3')
user_param_square tensor(171.1416, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(206.1579, device='cuda:3')
score : tensor(2.0285, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.0244, device='cuda:3')
user_param_square tensor(155.9587, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(172.4500, device='cuda:3')
score : tensor(1.6914, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(772.2535, device='cuda:3')
user_param_square tensor(160.2963, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(293.8941, device='cuda:3')
score : tensor(2.9059, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.6345, device='cuda:3')
user_param_square tensor(156.2368, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(358.7663, device='cuda:3')
score : tensor(3.5546, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(779.2551, device='cuda:3')
user_param_square tensor(161.0213, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(311.6305, device='cuda:3')
score : tensor(3.0832, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.6000, device='cuda:3')
user_param_square tensor(152.4607, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(308.5805, device='cuda:3')
score : tensor(3.0527, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.1130, device='cuda:3')
user_param_square tensor(155.3268, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(201.4221, device='cuda:3')
score : tensor(1.9811, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(793.3403, device='cuda:3')
user_param_square tensor(162.4701, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(254.6220, device='cuda:3')
score : tensor(2.5131, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8723, device='cuda:3')
user_param_square tensor(154.9793, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(241.7847, device='cuda:3')
score : tensor(2.3848, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(795.3433, device='cuda:3')
user_param_square tensor(162.6750, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(240.8126, device='cuda:3')
score : tensor(2.3751, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.5855, device='cuda:3')
user_param_square tensor(162.1877, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(246.7780, device='cuda:3')
score : tensor(2.4347, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.2075, device='cuda:3')
user_param_square tensor(157.5700, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(242.7090, device='cuda:3')
score : tensor(2.3940, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(804.0452, device='cuda:3')
user_param_square tensor(163.5625, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(319.9936, device='cuda:3')
score : tensor(3.1669, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(902.1194, device='cuda:3')
user_param_square tensor(173.2509, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(237.8690, device='cuda:3')
score : tensor(2.3456, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(788.4962, device='cuda:3')
user_param_square tensor(161.9733, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(280.0917, device='cuda:3')
score : tensor(2.7678, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(724.2461, device='cuda:3')
user_param_square tensor(155.2339, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(201.7082, device='cuda:3')
score : tensor(1.9840, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.9866, device='cuda:3')
user_param_square tensor(157.7577, device='cuda:3')
global_param_square tensor(33.2726, device='cuda:3')
part1 is  tensor(270.3706, device='cuda:3')
score : tensor(2.6706, device='cuda:3')
accept
len accept list 40
len all weights is 40
 
Avg Training Stats after 84 global rounds:
Train Accuracy: 89.94% 

Test Accuracy: 89.16% 


 | Global Training Round : 85 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8820368647575378
distance x is tensor(119.8269, device='cuda:3')
benign distance is  tensor(119.8269, device='cuda:3')
norm1 res is  tensor(0.1313, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.20759403705596924
distance x is tensor(118.7099, device='cuda:3')
benign distance is  tensor(118.7099, device='cuda:3')
norm1 res is  tensor(0.1339, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.10366801917552948
distance x is tensor(83.9278, device='cuda:3')
benign distance is  tensor(83.9278, device='cuda:3')
norm1 res is  tensor(0.0934, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.2855837941169739
distance x is tensor(114.3566, device='cuda:3')
benign distance is  tensor(114.3566, device='cuda:3')
norm1 res is  tensor(0.1263, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6616695523262024
distance x is tensor(125.7488, device='cuda:3')
benign distance is  tensor(125.7488, device='cuda:3')
norm1 res is  tensor(0.1342, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.43679600954055786
distance x is tensor(120.7164, device='cuda:3')
benign distance is  tensor(120.7164, device='cuda:3')
norm1 res is  tensor(0.1330, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2571813762187958
distance x is tensor(105.5479, device='cuda:3')
benign distance is  tensor(105.5479, device='cuda:3')
norm1 res is  tensor(0.1111, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.9373836517333984
distance x is tensor(119.8613, device='cuda:3')
benign distance is  tensor(119.8613, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.35575249791145325
distance x is tensor(123.9147, device='cuda:3')
benign distance is  tensor(123.9147, device='cuda:3')
norm1 res is  tensor(0.1375, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.09858643263578415
distance x is tensor(130.7405, device='cuda:3')
benign distance is  tensor(130.7405, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.4930235743522644
distance x is tensor(106.0769, device='cuda:3')
benign distance is  tensor(106.0769, device='cuda:3')
norm1 res is  tensor(0.1147, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6108484268188477
distance x is tensor(134.8729, device='cuda:3')
benign distance is  tensor(134.8729, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.25556206703186035
distance x is tensor(135.7762, device='cuda:3')
benign distance is  tensor(135.7762, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.13850137591362
distance x is tensor(125.3876, device='cuda:3')
benign distance is  tensor(125.3876, device='cuda:3')
norm1 res is  tensor(0.1381, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.08934120833873749
distance x is tensor(118.5429, device='cuda:3')
benign distance is  tensor(118.5429, device='cuda:3')
norm1 res is  tensor(0.1307, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.33184313774108887
distance x is tensor(117.4429, device='cuda:3')
benign distance is  tensor(117.4429, device='cuda:3')
norm1 res is  tensor(0.1303, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.09154678881168365
distance x is tensor(126.4887, device='cuda:3')
benign distance is  tensor(126.4887, device='cuda:3')
norm1 res is  tensor(0.1342, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.2865901589393616
distance x is tensor(135.1801, device='cuda:3')
benign distance is  tensor(135.1801, device='cuda:3')
norm1 res is  tensor(0.1499, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.1577577292919159
distance x is tensor(114.7891, device='cuda:3')
benign distance is  tensor(114.7891, device='cuda:3')
norm1 res is  tensor(0.1256, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.4094931483268738
distance x is tensor(115.5514, device='cuda:3')
benign distance is  tensor(115.5514, device='cuda:3')
norm1 res is  tensor(0.1278, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.20248281955718994
distance x is tensor(121.3850, device='cuda:3')
benign distance is  tensor(121.3850, device='cuda:3')
norm1 res is  tensor(0.1362, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5299381613731384
distance x is tensor(130.6694, device='cuda:3')
benign distance is  tensor(130.6694, device='cuda:3')
norm1 res is  tensor(0.1402, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.15867318212985992
distance x is tensor(129.9074, device='cuda:3')
benign distance is  tensor(129.9074, device='cuda:3')
norm1 res is  tensor(0.1416, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.4379936754703522
distance x is tensor(117.7526, device='cuda:3')
benign distance is  tensor(117.7526, device='cuda:3')
norm1 res is  tensor(0.1315, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.3302726745605469
distance x is tensor(124.0993, device='cuda:3')
benign distance is  tensor(124.0993, device='cuda:3')
norm1 res is  tensor(0.1360, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.36721259355545044
distance x is tensor(127.7873, device='cuda:3')
benign distance is  tensor(127.7873, device='cuda:3')
norm1 res is  tensor(0.1380, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.51506507396698
distance x is tensor(137.0938, device='cuda:3')
benign distance is  tensor(137.0938, device='cuda:3')
norm1 res is  tensor(0.1519, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.37112975120544434
distance x is tensor(134.6894, device='cuda:3')
benign distance is  tensor(134.6894, device='cuda:3')
norm1 res is  tensor(0.1431, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.6680898666381836
distance x is tensor(137.9774, device='cuda:3')
benign distance is  tensor(137.9774, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.3559808135032654
distance x is tensor(131.4482, device='cuda:3')
benign distance is  tensor(131.4482, device='cuda:3')
norm1 res is  tensor(0.1464, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.35059791803359985
distance x is tensor(129.7543, device='cuda:3')
benign distance is  tensor(129.7543, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.33776336908340454
distance x is tensor(129.9663, device='cuda:3')
benign distance is  tensor(129.9663, device='cuda:3')
norm1 res is  tensor(0.1426, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.2611539661884308
distance x is tensor(122.1456, device='cuda:3')
benign distance is  tensor(122.1456, device='cuda:3')
norm1 res is  tensor(0.1329, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.39265283942222595
distance x is tensor(136.4587, device='cuda:3')
benign distance is  tensor(136.4587, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.10495959222316742
distance x is tensor(121.8582, device='cuda:3')
benign distance is  tensor(121.8582, device='cuda:3')
norm1 res is  tensor(0.1370, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.24019944667816162
distance x is tensor(128.0832, device='cuda:3')
benign distance is  tensor(128.0832, device='cuda:3')
norm1 res is  tensor(0.1425, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.29267406463623047
distance x is tensor(126.6001, device='cuda:3')
benign distance is  tensor(126.6001, device='cuda:3')
norm1 res is  tensor(0.1376, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.5473778247833252
distance x is tensor(130.6988, device='cuda:3')
benign distance is  tensor(130.6988, device='cuda:3')
norm1 res is  tensor(0.1368, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.4268997609615326
distance x is tensor(128.5403, device='cuda:3')
benign distance is  tensor(128.5403, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.20864538848400116
distance x is tensor(139.0777, device='cuda:3')
benign distance is  tensor(139.0777, device='cuda:3')
norm1 res is  tensor(0.1538, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(122.7628, device='cuda:3')
compute distance is  tensor(122.7628, device='cuda:3')
compute norm is  tensor(68.8889, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2837, device='cuda:3')
compute distance is  tensor(130.2837, device='cuda:3')
compute norm is  tensor(68.9651, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2578, device='cuda:3')
compute distance is  tensor(134.2578, device='cuda:3')
compute norm is  tensor(69.1190, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.2716, device='cuda:3')
compute distance is  tensor(121.2716, device='cuda:3')
compute norm is  tensor(68.8324, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3272, device='cuda:3')
compute distance is  tensor(129.3272, device='cuda:3')
compute norm is  tensor(68.9970, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3633, device='cuda:3')
compute distance is  tensor(134.3633, device='cuda:3')
compute norm is  tensor(69.1716, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6625, device='cuda:3')
compute distance is  tensor(126.6625, device='cuda:3')
compute norm is  tensor(69.0550, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4384, device='cuda:3')
compute distance is  tensor(137.4384, device='cuda:3')
compute norm is  tensor(69.2597, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.4123, device='cuda:3')
compute distance is  tensor(144.4123, device='cuda:3')
compute norm is  tensor(69.2011, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0866, device='cuda:3')
compute distance is  tensor(127.0866, device='cuda:3')
compute norm is  tensor(69.0821, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.6022, device='cuda:3')
compute distance is  tensor(143.6022, device='cuda:3')
compute norm is  tensor(69.3241, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.3861, device='cuda:3')
compute distance is  tensor(128.3861, device='cuda:3')
compute norm is  tensor(68.9830, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.4123, device='cuda:3')
distance x is tensor(107565.2969, device='cuda:3')
distance x is tensor(107565.2969, device='cuda:3')
________________________________
test distance is  tensor(107565.2969, device='cuda:3')
test distance1 is  tensor(107565.2969, device='cuda:3')
test similarity is  tensor(0.4614, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130159405786083.61
test entropy is  0.0
________________________________
cal ratio is  0.0359080705032047
distance x is tensor(3862.4675, device='cuda:3')
cal_distance is  tensor(3862.4675, device='cuda:3')
cal ratio is  0.1894941227746647
distance x is tensor(731.9191, device='cuda:3')
cal_distance is  tensor(731.9191, device='cuda:3')
cal ratio is  0.4353079745761909
distance x is tensor(318.6131, device='cuda:3')
cal_distance is  tensor(318.6131, device='cuda:3')
cal ratio is  0.6597757056614056
distance x is tensor(210.2150, device='cuda:3')
cal_distance is  tensor(210.2150, device='cuda:3')
cal ratio is  0.8122623729503121
distance x is tensor(170.7507, device='cuda:3')
cal_distance is  tensor(170.7507, device='cuda:3')
cal ratio is  0.9012535018297327
distance x is tensor(153.8902, device='cuda:3')
cal_distance is  tensor(153.8902, device='cuda:3')
cal ratio is  0.9493421075106597
distance x is tensor(146.0947, device='cuda:3')
cal_distance is  tensor(146.0947, device='cuda:3')
cal ratio is  0.9743409498674829
distance x is tensor(142.3462, device='cuda:3')
cal_distance is  tensor(142.3462, device='cuda:3')
distance x is tensor(142.3462, device='cuda:3')
return_distance is  tensor(142.3462, device='cuda:3')
distance x is tensor(142.3359, device='cuda:3')
distance x is tensor(142.3359, device='cuda:3')
________________________________
test distance is  tensor(142.3359, device='cuda:3')
test distance1 is  tensor(142.3359, device='cuda:3')
test similarity is  tensor(0.9835, device='cuda:3')
test acc is  0.23336666682300444
test loss is 39.437585068155705
test entropy is  0.038657073893622225
________________________________
0
distance x is tensor(142.3359, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.03844183994055505
avg test loss is  39.83795742490398
avg accuracy is  0.8842833334896553
solo acc is  0.23131666682300436
compute similarity  is  tensor(0.9835, device='cuda:3')
compute_distance is  tensor(142.3359, device='cuda:3')
compute_norm is  tensor(72.6046, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(140.6730, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9183032350626581
avg test loss is  1.3773234151700922
avg accuracy is  0.8165333334896581
solo acc is  0.307333333489673
compute similarity  is  tensor(0.9834, device='cuda:3')
compute_distance is  tensor(140.6730, device='cuda:3')
compute_norm is  tensor(72.1279, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(141.4872, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8675670049337945
avg test loss is  1.4590555320162255
avg accuracy is  0.8102333334896582
solo acc is  0.2486500001563382
compute similarity  is  tensor(0.9832, device='cuda:3')
compute_distance is  tensor(141.4872, device='cuda:3')
compute_norm is  tensor(71.7598, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.0366, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8723654930652586
avg test loss is  1.422385147258417
avg accuracy is  0.8124666668229915
solo acc is  0.24758333348967146
compute similarity  is  tensor(0.9831, device='cuda:3')
compute_distance is  tensor(142.0366, device='cuda:3')
compute_norm is  tensor(71.3999, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.5863, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.859381450455326
avg test loss is  1.4062840435296489
avg accuracy is  0.816133333489658
solo acc is  0.24421666682300472
compute similarity  is  tensor(0.9830, device='cuda:3')
compute_distance is  tensor(142.5863, device='cuda:3')
compute_norm is  tensor(71.0461, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.1190, device='cuda:3')
distance x is tensor(143.1190, device='cuda:3')
________________________________
test distance is  tensor(143.1190, device='cuda:3')
test distance1 is  tensor(143.1190, device='cuda:3')
test similarity is  tensor(0.9828, device='cuda:3')
test acc is  0.242200000156338
test loss is 1.3945459877250037
test entropy is  0.8454766668109243
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.1532896757125854
mal norm is  tensor(683.0923, device='cuda:3')
distance x is tensor(143.1280, device='cuda:3')
mal distance is  tensor(143.1280, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(13.3085, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.2050, device='cuda:3')
user_param_square tensor(82.6439, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(-11.3531, device='cuda:3')
score : tensor(-0.1266, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.2232, device='cuda:3')
user_param_square tensor(83.5263, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(-9.0892, device='cuda:3')
score : tensor(-0.1040, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(368.4427, device='cuda:3')
user_param_square tensor(70.0245, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(22.6366, device='cuda:3')
score : tensor(0.2133, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.7362, device='cuda:3')
user_param_square tensor(80.6497, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(2.6195, device='cuda:3')
score : tensor(0.0131, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.1842, device='cuda:3')
user_param_square tensor(82.6422, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(-33.5619, device='cuda:3')
score : tensor(-0.3487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.5717, device='cuda:3')
user_param_square tensor(83.1549, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(-6.3970, device='cuda:3')
score : tensor(-0.0771, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(439.7570, device='cuda:3')
user_param_square tensor(76.5018, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(-6.2343, device='cuda:3')
score : tensor(-0.0755, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.8094, device='cuda:3')
user_param_square tensor(83.5730, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(-9.5982, device='cuda:3')
score : tensor(-0.1091, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0923, device='cuda:3')
user_param_square tensor(95.3465, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(12.7642, device='cuda:3')
score : tensor(0.1145, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.9715, device='cuda:3')
user_param_square tensor(94.4264, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(16.7492, device='cuda:3')
score : tensor(0.1544, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.2712, device='cuda:3')
user_param_square tensor(92.3097, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(31.1066, device='cuda:3')
score : tensor(0.2980, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.6822, device='cuda:3')
user_param_square tensor(93.6985, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(3.1456, device='cuda:3')
score : tensor(0.0183, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.4009, device='cuda:3')
user_param_square tensor(89.9829, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(49.2266, device='cuda:3')
score : tensor(0.4792, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.8214, device='cuda:3')
user_param_square tensor(91.5533, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(-1.3475, device='cuda:3')
score : tensor(-0.0266, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.0089, device='cuda:3')
user_param_square tensor(90.1018, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(0.9943, device='cuda:3')
score : tensor(-0.0032, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9792, device='cuda:3')
user_param_square tensor(94.9890, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(-0.1341, device='cuda:3')
score : tensor(-0.0144, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.9852, device='cuda:3')
user_param_square tensor(93.3643, device='cuda:3')
global_param_square tensor(13.3085, device='cuda:3')
part1 is  tensor(10.6864, device='cuda:3')
score : tensor(0.0938, device='cuda:3')
accept
len accept list 19
len all weights is 19
 
Avg Training Stats after 85 global rounds:
Train Accuracy: 86.76% 

Test Accuracy: 85.77% 


 | Global Training Round : 86 | 

current submit client idx and staleness is  0 1
 benign loss is  0.29033002257347107
distance x is tensor(143.4515, device='cuda:3')
benign distance is  tensor(143.4515, device='cuda:3')
norm1 res is  tensor(0.1525, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.45884162187576294
distance x is tensor(142.8784, device='cuda:3')
benign distance is  tensor(142.8784, device='cuda:3')
norm1 res is  tensor(0.1500, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.10772082954645157
distance x is tensor(121.7957, device='cuda:3')
benign distance is  tensor(121.7957, device='cuda:3')
norm1 res is  tensor(0.1281, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3055034875869751
distance x is tensor(140.3556, device='cuda:3')
benign distance is  tensor(140.3556, device='cuda:3')
norm1 res is  tensor(0.1492, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4312419891357422
distance x is tensor(131.2533, device='cuda:3')
benign distance is  tensor(131.2533, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4225614070892334
distance x is tensor(143.1875, device='cuda:3')
benign distance is  tensor(143.1875, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.25369447469711304
distance x is tensor(129.4181, device='cuda:3')
benign distance is  tensor(129.4181, device='cuda:3')
norm1 res is  tensor(0.1328, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.176576167345047
distance x is tensor(130.5389, device='cuda:3')
benign distance is  tensor(130.5389, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.4167238175868988
distance x is tensor(148.4809, device='cuda:3')
benign distance is  tensor(148.4809, device='cuda:3')
norm1 res is  tensor(0.1563, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.16385546326637268
distance x is tensor(186.9883, device='cuda:3')
benign distance is  tensor(186.9883, device='cuda:3')
norm1 res is  tensor(0.1950, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.18471220135688782
distance x is tensor(153.8165, device='cuda:3')
benign distance is  tensor(153.8165, device='cuda:3')
norm1 res is  tensor(0.1623, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.20373424887657166
distance x is tensor(147.9274, device='cuda:3')
benign distance is  tensor(147.9274, device='cuda:3')
norm1 res is  tensor(0.1556, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.12305941432714462
distance x is tensor(150.3819, device='cuda:3')
benign distance is  tensor(150.3819, device='cuda:3')
norm1 res is  tensor(0.1607, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.44608384370803833
distance x is tensor(152.1313, device='cuda:3')
benign distance is  tensor(152.1313, device='cuda:3')
norm1 res is  tensor(0.1575, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.23541061580181122
distance x is tensor(149.8206, device='cuda:3')
benign distance is  tensor(149.8206, device='cuda:3')
norm1 res is  tensor(0.1620, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.27050963044166565
distance x is tensor(158.8730, device='cuda:3')
benign distance is  tensor(158.8730, device='cuda:3')
norm1 res is  tensor(0.1681, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(138.3636, device='cuda:3')
compute distance is  tensor(138.3636, device='cuda:3')
compute norm is  tensor(70.0586, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.9793, device='cuda:3')
compute distance is  tensor(155.9793, device='cuda:3')
compute norm is  tensor(70.3404, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1275, device='cuda:3')
compute distance is  tensor(141.1275, device='cuda:3')
compute norm is  tensor(70.1844, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.0707, device='cuda:3')
compute distance is  tensor(157.0707, device='cuda:3')
compute norm is  tensor(70.4427, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4336, device='cuda:3')
compute distance is  tensor(145.4336, device='cuda:3')
compute norm is  tensor(70.1945, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.3042, device='cuda:3')
compute distance is  tensor(149.3042, device='cuda:3')
compute norm is  tensor(70.3475, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.4672, device='cuda:3')
compute distance is  tensor(140.4672, device='cuda:3')
compute norm is  tensor(70.1151, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.2351, device='cuda:3')
compute distance is  tensor(155.2351, device='cuda:3')
compute norm is  tensor(70.3246, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.9758, device='cuda:3')
compute distance is  tensor(153.9758, device='cuda:3')
compute norm is  tensor(70.2139, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0245, device='cuda:3')
compute distance is  tensor(142.0245, device='cuda:3')
compute norm is  tensor(70.3245, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.4547, device='cuda:3')
compute distance is  tensor(154.4547, device='cuda:3')
compute norm is  tensor(70.3025, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.2620, device='cuda:3')
compute distance is  tensor(150.2620, device='cuda:3')
compute norm is  tensor(70.3422, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.0707, device='cuda:3')
distance x is tensor(107515.9375, device='cuda:3')
distance x is tensor(107515.9375, device='cuda:3')
________________________________
test distance is  tensor(107515.9375, device='cuda:3')
test distance1 is  tensor(107515.9375, device='cuda:3')
test similarity is  tensor(0.5265, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130094737586686.9
test entropy is  0.0
________________________________
cal ratio is  0.037457362590885335
distance x is tensor(4027.2688, device='cuda:3')
cal_distance is  tensor(4027.2688, device='cuda:3')
cal ratio is  0.19353891326109518
distance x is tensor(779.4374, device='cuda:3')
cal_distance is  tensor(779.4374, device='cuda:3')
cal ratio is  0.4399294107069805
distance x is tensor(342.9003, device='cuda:3')
cal_distance is  tensor(342.9003, device='cuda:3')
cal ratio is  0.6632689827816916
distance x is tensor(227.4369, device='cuda:3')
cal_distance is  tensor(227.4369, device='cuda:3')
cal ratio is  0.8144101877580971
distance x is tensor(185.2279, device='cuda:3')
cal_distance is  tensor(185.2279, device='cuda:3')
cal ratio is  0.902444408096788
distance x is tensor(167.1584, device='cuda:3')
cal_distance is  tensor(167.1584, device='cuda:3')
cal ratio is  0.9499693105534036
distance x is tensor(158.7956, device='cuda:3')
cal_distance is  tensor(158.7956, device='cuda:3')
cal ratio is  0.9746628566462868
distance x is tensor(154.7723, device='cuda:3')
cal_distance is  tensor(154.7723, device='cuda:3')
distance x is tensor(154.7723, device='cuda:3')
return_distance is  tensor(154.7723, device='cuda:3')
distance x is tensor(154.7620, device='cuda:3')
distance x is tensor(154.7620, device='cuda:3')
________________________________
test distance is  tensor(154.7620, device='cuda:3')
test distance1 is  tensor(154.7620, device='cuda:3')
test similarity is  tensor(0.9838, device='cuda:3')
test acc is  0.10141666682299863
test loss is 116.49625072194569
test entropy is  0.001363812683821676
________________________________
0
distance x is tensor(154.7620, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0014322113106827504
avg test loss is  116.75028194598298
avg accuracy is  0.6932333334896643
solo acc is  0.1015333334896653
compute similarity  is  tensor(0.9838, device='cuda:3')
compute_distance is  tensor(154.7620, device='cuda:3')
compute_norm is  tensor(74.5153, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(149.2590, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9759232702412839
avg test loss is  1.4226239729029284
avg accuracy is  0.587383333489672
solo acc is  0.27046666682300546
compute similarity  is  tensor(0.9845, device='cuda:3')
compute_distance is  tensor(149.2590, device='cuda:3')
compute_norm is  tensor(74.3800, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(149.2590, device='cuda:3')
distance x is tensor(149.2590, device='cuda:3')
________________________________
test distance is  tensor(149.2590, device='cuda:3')
test distance1 is  tensor(149.2590, device='cuda:3')
test similarity is  tensor(0.9845, device='cuda:3')
test acc is  0.27001666682300557
test loss is 1.4251622438176608
test entropy is  0.9754531347929541
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3512310981750488
mal norm is  tensor(764.9445, device='cuda:3')
distance x is tensor(149.2681, device='cuda:3')
mal distance is  tensor(149.2681, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(20.4312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.7384, device='cuda:3')
user_param_square tensor(110.6950, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(119.9099, device='cuda:3')
score : tensor(1.1789, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.7625, device='cuda:3')
user_param_square tensor(109.8635, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(120.6935, device='cuda:3')
score : tensor(1.1867, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.4025, device='cuda:3')
user_param_square tensor(101.9180, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(138.9709, device='cuda:3')
score : tensor(1.3695, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.7100, device='cuda:3')
user_param_square tensor(108.2663, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(94.6016, device='cuda:3')
score : tensor(0.9258, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.2107, device='cuda:3')
user_param_square tensor(105.2522, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(195.9278, device='cuda:3')
score : tensor(1.9390, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.8405, device='cuda:3')
user_param_square tensor(110.3347, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(126.2342, device='cuda:3')
score : tensor(1.2421, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.9547, device='cuda:3')
user_param_square tensor(103.4651, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(99.3555, device='cuda:3')
score : tensor(0.9733, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.8626, device='cuda:3')
user_param_square tensor(106.8562, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(107.4638, device='cuda:3')
score : tensor(1.0544, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9445, device='cuda:3')
user_param_square tensor(125.0150, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(-112.0619, device='cuda:3')
score : tensor(-1.1409, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5188, device='cuda:3')
user_param_square tensor(113.2297, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(82.4171, device='cuda:3')
score : tensor(0.8039, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.9944, device='cuda:3')
user_param_square tensor(115.3283, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(130.7139, device='cuda:3')
score : tensor(1.2869, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.3802, device='cuda:3')
user_param_square tensor(106.2346, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(96.0625, device='cuda:3')
score : tensor(0.9404, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.7209, device='cuda:3')
user_param_square tensor(116.1866, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(93.2299, device='cuda:3')
score : tensor(0.9121, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.2752, device='cuda:3')
user_param_square tensor(116.7615, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(74.1877, device='cuda:3')
score : tensor(0.7216, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.6567, device='cuda:3')
user_param_square tensor(113.6024, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(83.5117, device='cuda:3')
score : tensor(0.8149, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.9119, device='cuda:3')
user_param_square tensor(110.9875, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(111.5903, device='cuda:3')
score : tensor(1.0957, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.3450, device='cuda:3')
user_param_square tensor(110.8432, device='cuda:3')
global_param_square tensor(20.4312, device='cuda:3')
part1 is  tensor(102.1708, device='cuda:3')
score : tensor(1.0015, device='cuda:3')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 86 global rounds:
Train Accuracy: 89.91% 

Test Accuracy: 89.17% 


 | Global Training Round : 87 | 

current submit client idx and staleness is  0 1
 benign loss is  0.203820139169693
distance x is tensor(111.2680, device='cuda:3')
benign distance is  tensor(111.2680, device='cuda:3')
norm1 res is  tensor(0.1225, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.13217394053936005
distance x is tensor(132.8863, device='cuda:3')
benign distance is  tensor(132.8863, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.33789345622062683
distance x is tensor(98.1796, device='cuda:3')
benign distance is  tensor(98.1796, device='cuda:3')
norm1 res is  tensor(0.1122, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4814770817756653
distance x is tensor(135.1708, device='cuda:3')
benign distance is  tensor(135.1708, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.319350928068161
distance x is tensor(106.9418, device='cuda:3')
benign distance is  tensor(106.9418, device='cuda:3')
norm1 res is  tensor(0.1172, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8542479276657104
distance x is tensor(186.7765, device='cuda:3')
benign distance is  tensor(186.7765, device='cuda:3')
norm1 res is  tensor(0.1973, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.9317831993103027
distance x is tensor(125.5087, device='cuda:3')
benign distance is  tensor(125.5087, device='cuda:3')
norm1 res is  tensor(0.1311, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2187671959400177
distance x is tensor(119.4628, device='cuda:3')
benign distance is  tensor(119.4628, device='cuda:3')
norm1 res is  tensor(0.1321, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.1555687040090561
distance x is tensor(145.3017, device='cuda:3')
benign distance is  tensor(145.3017, device='cuda:3')
norm1 res is  tensor(0.1562, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3234740197658539
distance x is tensor(145.3739, device='cuda:3')
benign distance is  tensor(145.3739, device='cuda:3')
norm1 res is  tensor(0.1586, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.5596950054168701
distance x is tensor(127.2386, device='cuda:3')
benign distance is  tensor(127.2386, device='cuda:3')
norm1 res is  tensor(0.1377, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.7556416392326355
distance x is tensor(131.0274, device='cuda:3')
benign distance is  tensor(131.0274, device='cuda:3')
norm1 res is  tensor(0.1426, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.5051926970481873
distance x is tensor(136.0661, device='cuda:3')
benign distance is  tensor(136.0661, device='cuda:3')
norm1 res is  tensor(0.1523, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.11025844514369965
distance x is tensor(143.7247, device='cuda:3')
benign distance is  tensor(143.7247, device='cuda:3')
norm1 res is  tensor(0.1573, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.7666900753974915
distance x is tensor(126.6005, device='cuda:3')
benign distance is  tensor(126.6005, device='cuda:3')
norm1 res is  tensor(0.1432, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.7353472709655762
distance x is tensor(164.8849, device='cuda:3')
benign distance is  tensor(164.8849, device='cuda:3')
norm1 res is  tensor(0.1734, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(137.1726, device='cuda:3')
compute distance is  tensor(137.1726, device='cuda:3')
compute norm is  tensor(69.9923, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8407, device='cuda:3')
compute distance is  tensor(137.8407, device='cuda:3')
compute norm is  tensor(70.1187, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.6233, device='cuda:3')
compute distance is  tensor(135.6233, device='cuda:3')
compute norm is  tensor(70.0170, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.9428, device='cuda:3')
compute distance is  tensor(134.9428, device='cuda:3')
compute norm is  tensor(70.0794, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2480, device='cuda:3')
compute distance is  tensor(129.2480, device='cuda:3')
compute norm is  tensor(70.0141, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.1946, device='cuda:3')
compute distance is  tensor(152.1946, device='cuda:3')
compute norm is  tensor(70.3110, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7551, device='cuda:3')
compute distance is  tensor(127.7551, device='cuda:3')
compute norm is  tensor(69.9905, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9523, device='cuda:3')
compute distance is  tensor(123.9523, device='cuda:3')
compute norm is  tensor(69.8680, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.4618, device='cuda:3')
compute distance is  tensor(149.4618, device='cuda:3')
compute norm is  tensor(70.3380, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3845, device='cuda:3')
compute distance is  tensor(140.3845, device='cuda:3')
compute norm is  tensor(70.0925, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.2748, device='cuda:3')
compute distance is  tensor(145.2748, device='cuda:3')
compute norm is  tensor(70.3157, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3205, device='cuda:3')
compute distance is  tensor(137.3205, device='cuda:3')
compute norm is  tensor(70.0469, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(152.1946, device='cuda:3')
distance x is tensor(107545.7109, device='cuda:3')
distance x is tensor(107545.7109, device='cuda:3')
________________________________
test distance is  tensor(107545.7109, device='cuda:3')
test distance1 is  tensor(107545.7109, device='cuda:3')
test similarity is  tensor(0.4899, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130164158683734.25
test entropy is  0.0
________________________________
cal ratio is  0.03686626315860314
distance x is tensor(3964.8137, device='cuda:3')
cal_distance is  tensor(3964.8137, device='cuda:3')
cal ratio is  0.19200576410963785
distance x is tensor(761.2712, device='cuda:3')
cal_distance is  tensor(761.2712, device='cuda:3')
cal ratio is  0.4381834557781508
distance x is tensor(333.5793, device='cuda:3')
cal_distance is  tensor(333.5793, device='cuda:3')
cal ratio is  0.6619513732984227
distance x is tensor(220.8150, device='cuda:3')
cal_distance is  tensor(220.8150, device='cuda:3')
cal ratio is  0.813600791151957
distance x is tensor(179.6562, device='cuda:3')
cal_distance is  tensor(179.6562, device='cuda:3')
cal ratio is  0.9019958288657726
distance x is tensor(162.0497, device='cuda:3')
cal_distance is  tensor(162.0497, device='cuda:3')
cal ratio is  0.9497330654845632
distance x is tensor(153.9042, device='cuda:3')
cal_distance is  tensor(153.9042, device='cuda:3')
cal ratio is  0.9745416547774263
distance x is tensor(149.9862, device='cuda:3')
cal_distance is  tensor(149.9862, device='cuda:3')
distance x is tensor(149.9862, device='cuda:3')
return_distance is  tensor(149.9862, device='cuda:3')
distance x is tensor(149.9760, device='cuda:3')
distance x is tensor(149.9760, device='cuda:3')
________________________________
test distance is  tensor(149.9760, device='cuda:3')
test distance1 is  tensor(149.9760, device='cuda:3')
test similarity is  tensor(0.9834, device='cuda:3')
test acc is  0.14750000015633297
test loss is 78.9841909672914
test entropy is  0.013144957788457973
________________________________
0
distance x is tensor(149.9760, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.013310373655921977
avg test loss is  79.3583055386411
avg accuracy is  0.8705333334896557
solo acc is  0.1475333334896663
compute similarity  is  tensor(0.9834, device='cuda:3')
compute_distance is  tensor(149.9760, device='cuda:3')
compute_norm is  tensor(74.1303, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(148.1090, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9926289339690829
avg test loss is  1.4716125870310168
avg accuracy is  0.7742166668229933
solo acc is  0.2791833334896724
compute similarity  is  tensor(0.9834, device='cuda:3')
compute_distance is  tensor(148.1090, device='cuda:3')
compute_norm is  tensor(73.8897, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(148.1090, device='cuda:3')
distance x is tensor(148.1090, device='cuda:3')
________________________________
test distance is  tensor(148.1090, device='cuda:3')
test distance1 is  tensor(148.1090, device='cuda:3')
test similarity is  tensor(0.9834, device='cuda:3')
test acc is  0.28190000015633904
test loss is 1.470847551883665
test entropy is  0.9925834703038751
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.449892282485962
mal norm is  tensor(750.3028, device='cuda:3')
distance x is tensor(148.1180, device='cuda:3')
mal distance is  tensor(148.1180, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(20.3222, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.5872, device='cuda:3')
user_param_square tensor(99.1340, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(20.2865, device='cuda:3')
score : tensor(0.1827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.5008, device='cuda:3')
user_param_square tensor(106.9170, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(31.1097, device='cuda:3')
score : tensor(0.2910, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(431.6443, device='cuda:3')
user_param_square tensor(93.6587, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(5.5743, device='cuda:3')
score : tensor(0.0356, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.7213, device='cuda:3')
user_param_square tensor(105.3102, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(-27.5903, device='cuda:3')
score : tensor(-0.2960, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(460.1868, device='cuda:3')
user_param_square tensor(96.7057, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(13.6904, device='cuda:3')
score : tensor(0.1168, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.1519, device='cuda:3')
user_param_square tensor(124.9421, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(12.0991, device='cuda:3')
score : tensor(0.1009, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.5269, device='cuda:3')
user_param_square tensor(101.5581, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(9.8931, device='cuda:3')
score : tensor(0.0788, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.7780, device='cuda:3')
user_param_square tensor(103.0727, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(-5.0297, device='cuda:3')
score : tensor(-0.0704, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.3028, device='cuda:3')
user_param_square tensor(123.4819, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(15.4469, device='cuda:3')
score : tensor(0.1343, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.5142, device='cuda:3')
user_param_square tensor(107.2030, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(34.1717, device='cuda:3')
score : tensor(0.3216, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.0698, device='cuda:3')
user_param_square tensor(112.0737, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(-1.1724, device='cuda:3')
score : tensor(-0.0318, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.3672, device='cuda:3')
user_param_square tensor(103.9160, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(47.5457, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.8718, device='cuda:3')
user_param_square tensor(104.2581, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(45.7181, device='cuda:3')
score : tensor(0.4371, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.0322, device='cuda:3')
user_param_square tensor(106.7773, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(43.9142, device='cuda:3')
score : tensor(0.4190, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.8254, device='cuda:3')
user_param_square tensor(109.2043, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(-10.4615, device='cuda:3')
score : tensor(-0.1247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.2783, device='cuda:3')
user_param_square tensor(109.8030, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(19.1357, device='cuda:3')
score : tensor(0.1712, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(540.5768, device='cuda:3')
user_param_square tensor(104.8127, device='cuda:3')
global_param_square tensor(20.3222, device='cuda:3')
part1 is  tensor(-24.6755, device='cuda:3')
score : tensor(-0.2669, device='cuda:3')
len accept list 23
len all weights is 23
 
Avg Training Stats after 87 global rounds:
Train Accuracy: 86.79% 

Test Accuracy: 86.00% 


 | Global Training Round : 88 | 

current submit client idx and staleness is  0 1
 benign loss is  0.24048402905464172
distance x is tensor(142.5076, device='cuda:3')
benign distance is  tensor(142.5076, device='cuda:3')
norm1 res is  tensor(0.1565, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.0906529575586319
distance x is tensor(142.3616, device='cuda:3')
benign distance is  tensor(142.3616, device='cuda:3')
norm1 res is  tensor(0.1535, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.574666440486908
distance x is tensor(113.5262, device='cuda:3')
benign distance is  tensor(113.5262, device='cuda:3')
norm1 res is  tensor(0.1209, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6873732805252075
distance x is tensor(136.8201, device='cuda:3')
benign distance is  tensor(136.8201, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6634129881858826
distance x is tensor(140.4895, device='cuda:3')
benign distance is  tensor(140.4895, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.315138041973114
distance x is tensor(140.6772, device='cuda:3')
benign distance is  tensor(140.6772, device='cuda:3')
norm1 res is  tensor(0.1499, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.6143479347229004
distance x is tensor(152.8188, device='cuda:3')
benign distance is  tensor(152.8188, device='cuda:3')
norm1 res is  tensor(0.1567, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.06445321440696716
distance x is tensor(147.1133, device='cuda:3')
benign distance is  tensor(147.1133, device='cuda:3')
norm1 res is  tensor(0.1614, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.11502567678689957
distance x is tensor(140.2229, device='cuda:3')
benign distance is  tensor(140.2229, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.7014781832695007
distance x is tensor(159.9217, device='cuda:3')
benign distance is  tensor(159.9217, device='cuda:3')
norm1 res is  tensor(0.1725, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  1.0204188823699951
distance x is tensor(168.3011, device='cuda:3')
benign distance is  tensor(168.3011, device='cuda:3')
norm1 res is  tensor(0.1806, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.3502872586250305
distance x is tensor(154.3758, device='cuda:3')
benign distance is  tensor(154.3758, device='cuda:3')
norm1 res is  tensor(0.1629, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.27042356133461
distance x is tensor(145.2646, device='cuda:3')
benign distance is  tensor(145.2646, device='cuda:3')
norm1 res is  tensor(0.1543, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.9335629343986511
distance x is tensor(136.7498, device='cuda:3')
benign distance is  tensor(136.7498, device='cuda:3')
norm1 res is  tensor(0.1463, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.5224300026893616
distance x is tensor(155.3829, device='cuda:3')
benign distance is  tensor(155.3829, device='cuda:3')
norm1 res is  tensor(0.1672, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  1.2462419271469116
distance x is tensor(160.9637, device='cuda:3')
benign distance is  tensor(160.9637, device='cuda:3')
norm1 res is  tensor(0.1677, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(133.9572, device='cuda:3')
compute distance is  tensor(133.9572, device='cuda:3')
compute norm is  tensor(71.9601, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7105, device='cuda:3')
compute distance is  tensor(158.7105, device='cuda:3')
compute norm is  tensor(72.2079, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.8459, device='cuda:3')
compute distance is  tensor(153.8459, device='cuda:3')
compute norm is  tensor(72.2627, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.7599, device='cuda:3')
compute distance is  tensor(149.7599, device='cuda:3')
compute norm is  tensor(72.1022, device='cuda:3', dtype=torch.float64)
distance x is tensor(194.4512, device='cuda:3')
compute distance is  tensor(194.4512, device='cuda:3')
compute norm is  tensor(73.0172, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.4668, device='cuda:3')
compute distance is  tensor(154.4668, device='cuda:3')
compute norm is  tensor(72.2587, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.9496, device='cuda:3')
compute distance is  tensor(143.9496, device='cuda:3')
compute norm is  tensor(72.0466, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.7829, device='cuda:3')
compute distance is  tensor(168.7829, device='cuda:3')
compute norm is  tensor(72.4656, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.1586, device='cuda:3')
compute distance is  tensor(176.1586, device='cuda:3')
compute norm is  tensor(72.6956, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.9158, device='cuda:3')
compute distance is  tensor(145.9158, device='cuda:3')
compute norm is  tensor(72.0668, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.4380, device='cuda:3')
compute distance is  tensor(154.4380, device='cuda:3')
compute norm is  tensor(72.1437, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0701, device='cuda:3')
compute distance is  tensor(144.0701, device='cuda:3')
compute norm is  tensor(72.1175, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(194.4512, device='cuda:3')
distance x is tensor(107502.9141, device='cuda:3')
distance x is tensor(107502.9141, device='cuda:3')
________________________________
test distance is  tensor(107502.9141, device='cuda:3')
test distance1 is  tensor(107502.9141, device='cuda:3')
test similarity is  tensor(0.5453, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130018975515811.75
test entropy is  0.0
________________________________
cal ratio is  0.041679377975337946
distance x is tensor(4480.6602, device='cuda:3')
cal_distance is  tensor(4480.6602, device='cuda:3')
cal ratio is  0.2041551493336664
distance x is tensor(914.7539, device='cuda:3')
cal_distance is  tensor(914.7539, device='cuda:3')
cal ratio is  0.45183430890792126
distance x is tensor(413.3200, device='cuda:3')
cal_distance is  tensor(413.3200, device='cuda:3')
cal ratio is  0.6721839129690514
distance x is tensor(277.8288, device='cuda:3')
cal_distance is  tensor(277.8288, device='cuda:3')
cal ratio is  0.8198656925255289
distance x is tensor(227.7832, device='cuda:3')
cal_distance is  tensor(227.7832, device='cuda:3')
cal ratio is  0.9054626170914238
distance x is tensor(206.2496, device='cuda:3')
cal_distance is  tensor(206.2496, device='cuda:3')
cal ratio is  0.9515568359031037
distance x is tensor(196.2585, device='cuda:3')
cal_distance is  tensor(196.2585, device='cuda:3')
cal ratio is  0.9754770470381979
distance x is tensor(191.4458, device='cuda:3')
cal_distance is  tensor(191.4458, device='cuda:3')
distance x is tensor(191.4458, device='cuda:3')
return_distance is  tensor(191.4458, device='cuda:3')
distance x is tensor(191.4356, device='cuda:3')
distance x is tensor(191.4356, device='cuda:3')
________________________________
test distance is  tensor(191.4356, device='cuda:3')
test distance1 is  tensor(191.4356, device='cuda:3')
test similarity is  tensor(0.9788, device='cuda:3')
test acc is  0.22080000015633724
test loss is 76.39441002152368
test entropy is  0.041299035549282964
________________________________
0
distance x is tensor(191.4356, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.04058480735839422
avg test loss is  76.82366752217827
avg accuracy is  0.8558666668229896
solo acc is  0.221866666823004
compute similarity  is  tensor(0.9788, device='cuda:3')
compute_distance is  tensor(191.4356, device='cuda:3')
compute_norm is  tensor(78.2090, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.8536, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9207528765394744
avg test loss is  1.426806470732699
avg accuracy is  0.6649666668229994
solo acc is  0.29278333348967267
compute similarity  is  tensor(0.9796, device='cuda:3')
compute_distance is  tensor(180.8536, device='cuda:3')
compute_norm is  tensor(77.9186, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(180.8536, device='cuda:3')
distance x is tensor(180.8536, device='cuda:3')
________________________________
test distance is  tensor(180.8536, device='cuda:3')
test distance1 is  tensor(180.8536, device='cuda:3')
test similarity is  tensor(0.9796, device='cuda:3')
test acc is  0.2926500001563393
test loss is 1.425691261982867
test entropy is  0.9207486774621487
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2613948583602905
mal norm is  tensor(948.6863, device='cuda:3')
distance x is tensor(180.8634, device='cuda:3')
mal distance is  tensor(180.8634, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(20.5115, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.2906, device='cuda:3')
user_param_square tensor(111.5165, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(121.1469, device='cuda:3')
score : tensor(1.1912, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8879, device='cuda:3')
user_param_square tensor(110.4629, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(118.1612, device='cuda:3')
score : tensor(1.1613, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.8411, device='cuda:3')
user_param_square tensor(98.2734, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(136.1660, device='cuda:3')
score : tensor(1.3413, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.8003, device='cuda:3')
user_param_square tensor(108.4874, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(74.2984, device='cuda:3')
score : tensor(0.7227, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.0154, device='cuda:3')
user_param_square tensor(108.8851, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(115.3082, device='cuda:3')
score : tensor(1.1328, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.4181, device='cuda:3')
user_param_square tensor(110.1403, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(136.8334, device='cuda:3')
score : tensor(1.3480, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.1309, device='cuda:3')
user_param_square tensor(111.2255, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(74.6291, device='cuda:3')
score : tensor(0.7260, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.9598, device='cuda:3')
user_param_square tensor(114.3919, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(105.6358, device='cuda:3')
score : tensor(1.0360, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.6863, device='cuda:3')
user_param_square tensor(139.4955, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(-89.6936, device='cuda:3')
score : tensor(-0.9172, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.4598, device='cuda:3')
user_param_square tensor(119.2640, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(39.5038, device='cuda:3')
score : tensor(0.3747, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.0123, device='cuda:3')
user_param_square tensor(119.8261, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(79.8063, device='cuda:3')
score : tensor(0.7778, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.0775, device='cuda:3')
user_param_square tensor(123.7889, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(23.5644, device='cuda:3')
score : tensor(0.2153, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.6767, device='cuda:3')
user_param_square tensor(121.4131, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(120.3214, device='cuda:3')
score : tensor(1.1829, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8795, device='cuda:3')
user_param_square tensor(122.7741, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(53.7472, device='cuda:3')
score : tensor(0.5172, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.6114, device='cuda:3')
user_param_square tensor(122.2494, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(79.2843, device='cuda:3')
score : tensor(0.7725, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.6325, device='cuda:3')
user_param_square tensor(121.5782, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(101.4830, device='cuda:3')
score : tensor(0.9945, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.2496, device='cuda:3')
user_param_square tensor(121.2925, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(55.5460, device='cuda:3')
score : tensor(0.5351, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.9353, device='cuda:3')
user_param_square tensor(119.2189, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(127.1417, device='cuda:3')
score : tensor(1.2511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.9852, device='cuda:3')
user_param_square tensor(119.8238, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(69.5695, device='cuda:3')
score : tensor(0.6754, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.5847, device='cuda:3')
user_param_square tensor(113.8189, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(53.2149, device='cuda:3')
score : tensor(0.5118, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.4803, device='cuda:3')
user_param_square tensor(114.2592, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(117.9520, device='cuda:3')
score : tensor(1.1592, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.3549, device='cuda:3')
user_param_square tensor(117.3478, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(80.8628, device='cuda:3')
score : tensor(0.7883, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.8042, device='cuda:3')
user_param_square tensor(119.8939, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(90.1040, device='cuda:3')
score : tensor(0.8807, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.8839, device='cuda:3')
user_param_square tensor(114.4747, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(99.3690, device='cuda:3')
score : tensor(0.9734, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(759.7692, device='cuda:3')
user_param_square tensor(124.8359, device='cuda:3')
global_param_square tensor(20.5115, device='cuda:3')
part1 is  tensor(29.3059, device='cuda:3')
score : tensor(0.2727, device='cuda:3')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 88 global rounds:
Train Accuracy: 89.98% 

Test Accuracy: 89.31% 


 | Global Training Round : 89 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4638948440551758
distance x is tensor(110.4000, device='cuda:3')
benign distance is  tensor(110.4000, device='cuda:3')
norm1 res is  tensor(0.1267, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3258974552154541
distance x is tensor(122.3548, device='cuda:3')
benign distance is  tensor(122.3548, device='cuda:3')
norm1 res is  tensor(0.1343, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.22057196497917175
distance x is tensor(133.7092, device='cuda:3')
benign distance is  tensor(133.7092, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.25923770666122437
distance x is tensor(109.1395, device='cuda:3')
benign distance is  tensor(109.1395, device='cuda:3')
norm1 res is  tensor(0.1204, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.17970335483551025
distance x is tensor(99.0046, device='cuda:3')
benign distance is  tensor(99.0046, device='cuda:3')
norm1 res is  tensor(0.1098, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3933461606502533
distance x is tensor(121.1434, device='cuda:3')
benign distance is  tensor(121.1434, device='cuda:3')
norm1 res is  tensor(0.1320, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.31327465176582336
distance x is tensor(97.2810, device='cuda:3')
benign distance is  tensor(97.2810, device='cuda:3')
norm1 res is  tensor(0.1036, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3225378394126892
distance x is tensor(120.2371, device='cuda:3')
benign distance is  tensor(120.2371, device='cuda:3')
norm1 res is  tensor(0.1331, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.19230452179908752
distance x is tensor(130.5337, device='cuda:3')
benign distance is  tensor(130.5337, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3533172011375427
distance x is tensor(143.2849, device='cuda:3')
benign distance is  tensor(143.2849, device='cuda:3')
norm1 res is  tensor(0.1576, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.7350595593452454
distance x is tensor(122.5491, device='cuda:3')
benign distance is  tensor(122.5491, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.401090145111084
distance x is tensor(128.8349, device='cuda:3')
benign distance is  tensor(128.8349, device='cuda:3')
norm1 res is  tensor(0.1420, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.6518286466598511
distance x is tensor(117.0974, device='cuda:3')
benign distance is  tensor(117.0974, device='cuda:3')
norm1 res is  tensor(0.1300, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.273814857006073
distance x is tensor(134.6425, device='cuda:3')
benign distance is  tensor(134.6425, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.28807955980300903
distance x is tensor(127.6112, device='cuda:3')
benign distance is  tensor(127.6112, device='cuda:3')
norm1 res is  tensor(0.1394, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.45054903626441956
distance x is tensor(137.8885, device='cuda:3')
benign distance is  tensor(137.8885, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.23218712210655212
distance x is tensor(135.0688, device='cuda:3')
benign distance is  tensor(135.0688, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.42058420181274414
distance x is tensor(129.7064, device='cuda:3')
benign distance is  tensor(129.7064, device='cuda:3')
norm1 res is  tensor(0.1413, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.4266083240509033
distance x is tensor(141.9976, device='cuda:3')
benign distance is  tensor(141.9976, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.298393189907074
distance x is tensor(133.4520, device='cuda:3')
benign distance is  tensor(133.4520, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.8534132242202759
distance x is tensor(139.1396, device='cuda:3')
benign distance is  tensor(139.1396, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.3221592307090759
distance x is tensor(139.7068, device='cuda:3')
benign distance is  tensor(139.7068, device='cuda:3')
norm1 res is  tensor(0.1553, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.762703537940979
distance x is tensor(136.4165, device='cuda:3')
benign distance is  tensor(136.4165, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.5200263261795044
distance x is tensor(134.0995, device='cuda:3')
benign distance is  tensor(134.0995, device='cuda:3')
norm1 res is  tensor(0.1465, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(126.5381, device='cuda:3')
compute distance is  tensor(126.5381, device='cuda:3')
compute norm is  tensor(70.8849, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.1851, device='cuda:3')
compute distance is  tensor(133.1851, device='cuda:3')
compute norm is  tensor(70.9801, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.2664, device='cuda:3')
compute distance is  tensor(131.2664, device='cuda:3')
compute norm is  tensor(71.0195, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.8744, device='cuda:3')
compute distance is  tensor(126.8744, device='cuda:3')
compute norm is  tensor(70.9123, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.2498, device='cuda:3')
compute distance is  tensor(170.2498, device='cuda:3')
compute norm is  tensor(71.4410, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4858, device='cuda:3')
compute distance is  tensor(132.4858, device='cuda:3')
compute norm is  tensor(71.0872, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2097, device='cuda:3')
compute distance is  tensor(129.2097, device='cuda:3')
compute norm is  tensor(70.8777, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1027, device='cuda:3')
compute distance is  tensor(135.1027, device='cuda:3')
compute norm is  tensor(70.9563, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7323, device='cuda:3')
compute distance is  tensor(146.7323, device='cuda:3')
compute norm is  tensor(71.2829, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8372, device='cuda:3')
compute distance is  tensor(131.8372, device='cuda:3')
compute norm is  tensor(71.0474, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.8434, device='cuda:3')
compute distance is  tensor(154.8434, device='cuda:3')
compute norm is  tensor(71.4366, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6380, device='cuda:3')
compute distance is  tensor(131.6380, device='cuda:3')
compute norm is  tensor(71.0386, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(170.2498, device='cuda:3')
distance x is tensor(107540.7344, device='cuda:3')
distance x is tensor(107540.7344, device='cuda:3')
________________________________
test distance is  tensor(107540.7344, device='cuda:3')
test distance1 is  tensor(107540.7344, device='cuda:3')
test similarity is  tensor(0.4989, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130081904590428.8
test entropy is  0.0
________________________________
cal ratio is  0.03899266562680324
distance x is tensor(4193.3052, device='cuda:3')
cal_distance is  tensor(4193.3052, device='cuda:3')
cal ratio is  0.19746548408760206
distance x is tensor(828.0371, device='cuda:3')
cal_distance is  tensor(828.0371, device='cuda:3')
cal ratio is  0.4443697806747966
distance x is tensor(367.9575, device='cuda:3')
cal_distance is  tensor(367.9575, device='cuda:3')
cal ratio is  0.6666080975126979
distance x is tensor(245.2852, device='cuda:3')
cal_distance is  tensor(245.2852, device='cuda:3')
cal ratio is  0.8164578462495266
distance x is tensor(200.2660, device='cuda:3')
cal_distance is  tensor(200.2660, device='cuda:3')
cal ratio is  0.9035784394841974
distance x is tensor(180.9565, device='cuda:3')
cal_distance is  tensor(180.9565, device='cuda:3')
cal ratio is  0.9505660799365278
distance x is tensor(172.0114, device='cuda:3')
cal_distance is  tensor(172.0114, device='cuda:3')
cal ratio is  0.9749690980660286
distance x is tensor(167.7059, device='cuda:3')
cal_distance is  tensor(167.7059, device='cuda:3')
distance x is tensor(167.7059, device='cuda:3')
return_distance is  tensor(167.7059, device='cuda:3')
distance x is tensor(167.6957, device='cuda:3')
distance x is tensor(167.6957, device='cuda:3')
________________________________
test distance is  tensor(167.6957, device='cuda:3')
test distance1 is  tensor(167.6957, device='cuda:3')
test similarity is  tensor(0.9807, device='cuda:3')
test acc is  0.16805000015633453
test loss is 92.27427599730014
test entropy is  0.016849696888892096
________________________________
0
distance x is tensor(167.6957, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.017442230079586032
avg test loss is  92.2760581888878
avg accuracy is  0.874866666822989
solo acc is  0.169583333489668
compute similarity  is  tensor(0.9807, device='cuda:3')
compute_distance is  tensor(167.6957, device='cuda:3')
compute_norm is  tensor(75.8652, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.7675, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9996817751861076
avg test loss is  1.5398723629237747
avg accuracy is  0.7615333334896606
solo acc is  0.25945000015633857
compute similarity  is  tensor(0.9810, device='cuda:3')
compute_distance is  tensor(164.7675, device='cuda:3')
compute_norm is  tensor(75.6772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(164.7675, device='cuda:3')
distance x is tensor(164.7675, device='cuda:3')
________________________________
test distance is  tensor(164.7675, device='cuda:3')
test distance1 is  tensor(164.7675, device='cuda:3')
test similarity is  tensor(0.9810, device='cuda:3')
test acc is  0.2596833334896718
test loss is 1.5398356653988234
test entropy is  1.0005719378304634
________________________________
0
distance x is tensor(164.7675, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0000969324666045
avg test loss is  1.5422814353696828
avg accuracy is  0.7610666668229938
solo acc is  0.25901666682300517
compute similarity  is  tensor(0.9810, device='cuda:3')
compute_distance is  tensor(164.7675, device='cuda:3')
compute_norm is  tensor(75.6772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.1452, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6193828055027452
avg test loss is  2.3886213974912027
avg accuracy is  0.6874000001563313
solo acc is  0.1152666668229986
compute similarity  is  tensor(0.9808, device='cuda:3')
compute_distance is  tensor(166.1452, device='cuda:3')
compute_norm is  tensor(75.3480, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.9662, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9434166639598448
avg test loss is  1.4045254548729609
avg accuracy is  0.7645166668229937
solo acc is  0.2716500001563389
compute similarity  is  tensor(0.9808, device='cuda:3')
compute_distance is  tensor(165.9662, device='cuda:3')
compute_norm is  tensor(74.9602, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(165.9662, device='cuda:3')
distance x is tensor(165.9662, device='cuda:3')
________________________________
test distance is  tensor(165.9662, device='cuda:3')
test distance1 is  tensor(165.9662, device='cuda:3')
test similarity is  tensor(0.9808, device='cuda:3')
test acc is  0.2756833334896723
test loss is 1.4052103484617366
test entropy is  0.9424025310890507
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2838537693023682
mal norm is  tensor(817.2827, device='cuda:3')
distance x is tensor(165.9754, device='cuda:3')
mal distance is  tensor(165.9754, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(10.5634, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.2939, device='cuda:3')
user_param_square tensor(72.0399, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(-4.1543, device='cuda:3')
score : tensor(-0.0519, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(526.3417, device='cuda:3')
user_param_square tensor(74.5652, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(4.9351, device='cuda:3')
score : tensor(0.0390, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.3782, device='cuda:3')
user_param_square tensor(78.0966, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(21.3023, device='cuda:3')
score : tensor(0.2027, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.6060, device='cuda:3')
user_param_square tensor(70.5817, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(11.3480, device='cuda:3')
score : tensor(0.1031, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(422.4782, device='cuda:3')
user_param_square tensor(66.8043, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(0.4867, device='cuda:3')
score : tensor(-0.0055, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.5204, device='cuda:3')
user_param_square tensor(73.6514, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(-5.3506, device='cuda:3')
score : tensor(-0.0639, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(399.9172, device='cuda:3')
user_param_square tensor(64.9961, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(16.6893, device='cuda:3')
score : tensor(0.1565, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.5124, device='cuda:3')
user_param_square tensor(73.6508, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(4.6212, device='cuda:3')
score : tensor(0.0358, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.2827, device='cuda:3')
user_param_square tensor(92.9155, device='cuda:3')
global_param_square tensor(10.5634, device='cuda:3')
part1 is  tensor(3.7394, device='cuda:3')
score : tensor(0.0270, device='cuda:3')
accept
len accept list 17
len all weights is 17
 
Avg Training Stats after 89 global rounds:
Train Accuracy: 79.39% 

Test Accuracy: 79.00% 


 | Global Training Round : 90 | 

current submit client idx and staleness is  0 1
 benign loss is  0.43884268403053284
distance x is tensor(165.4884, device='cuda:3')
benign distance is  tensor(165.4884, device='cuda:3')
norm1 res is  tensor(0.1710, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4819585382938385
distance x is tensor(174.7245, device='cuda:3')
benign distance is  tensor(174.7245, device='cuda:3')
norm1 res is  tensor(0.1838, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.4311099052429199
distance x is tensor(153.9890, device='cuda:3')
benign distance is  tensor(153.9890, device='cuda:3')
norm1 res is  tensor(0.1570, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.8407820463180542
distance x is tensor(144.8613, device='cuda:3')
benign distance is  tensor(144.8613, device='cuda:3')
norm1 res is  tensor(0.1516, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.21509143710136414
distance x is tensor(192.1138, device='cuda:3')
benign distance is  tensor(192.1138, device='cuda:3')
norm1 res is  tensor(0.1875, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.9986945986747742
distance x is tensor(148.8705, device='cuda:3')
benign distance is  tensor(148.8705, device='cuda:3')
norm1 res is  tensor(0.1571, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.19046363234519958
distance x is tensor(153.1826, device='cuda:3')
benign distance is  tensor(153.1826, device='cuda:3')
norm1 res is  tensor(0.1541, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5605634450912476
distance x is tensor(153.8436, device='cuda:3')
benign distance is  tensor(153.8436, device='cuda:3')
norm1 res is  tensor(0.1625, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(140.1739, device='cuda:3')
compute distance is  tensor(140.1739, device='cuda:3')
compute norm is  tensor(73.7031, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.9908, device='cuda:3')
compute distance is  tensor(165.9908, device='cuda:3')
compute norm is  tensor(74.2877, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.7315, device='cuda:3')
compute distance is  tensor(161.7315, device='cuda:3')
compute norm is  tensor(74.1616, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.0689, device='cuda:3')
compute distance is  tensor(168.0689, device='cuda:3')
compute norm is  tensor(74.1555, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.8328, device='cuda:3')
compute distance is  tensor(163.8328, device='cuda:3')
compute norm is  tensor(74.2371, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.4256, device='cuda:3')
compute distance is  tensor(170.4256, device='cuda:3')
compute norm is  tensor(74.4678, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.6390, device='cuda:3')
compute distance is  tensor(158.6390, device='cuda:3')
compute norm is  tensor(74.1330, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.2639, device='cuda:3')
compute distance is  tensor(164.2639, device='cuda:3')
compute norm is  tensor(74.2661, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.2877, device='cuda:3')
compute distance is  tensor(169.2877, device='cuda:3')
compute norm is  tensor(74.3541, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.6012, device='cuda:3')
compute distance is  tensor(158.6012, device='cuda:3')
compute norm is  tensor(74.1949, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.0794, device='cuda:3')
compute distance is  tensor(160.0794, device='cuda:3')
compute norm is  tensor(74.1664, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.8030, device='cuda:3')
compute distance is  tensor(154.8030, device='cuda:3')
compute norm is  tensor(74.1213, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(170.4256, device='cuda:3')
distance x is tensor(107467.6953, device='cuda:3')
distance x is tensor(107467.6953, device='cuda:3')
________________________________
test distance is  tensor(107467.6953, device='cuda:3')
test distance1 is  tensor(107467.6953, device='cuda:3')
test similarity is  tensor(0.5863, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130146689836842.03
test entropy is  0.0
________________________________
cal ratio is  0.039026044395389425
distance x is tensor(4194.0449, device='cuda:3')
cal_distance is  tensor(4194.0449, device='cuda:3')
cal ratio is  0.19754997047163048
distance x is tensor(828.5375, device='cuda:3')
cal_distance is  tensor(828.5375, device='cuda:3')
cal ratio is  0.44446484063985314
distance x is tensor(368.2587, device='cuda:3')
cal_distance is  tensor(368.2587, device='cuda:3')
cal ratio is  0.6666793691189915
distance x is tensor(245.5121, device='cuda:3')
cal_distance is  tensor(245.5121, device='cuda:3')
cal ratio is  0.8165015955831726
distance x is tensor(200.4620, device='cuda:3')
cal_distance is  tensor(200.4620, device='cuda:3')
cal ratio is  0.9036026082865409
distance x is tensor(181.1385, device='cuda:3')
cal_distance is  tensor(181.1385, device='cuda:3')
cal ratio is  0.9505789069814541
distance x is tensor(172.1867, device='cuda:3')
cal_distance is  tensor(172.1867, device='cuda:3')
cal ratio is  0.9749756152942863
distance x is tensor(167.8779, device='cuda:3')
cal_distance is  tensor(167.8779, device='cuda:3')
distance x is tensor(167.8779, device='cuda:3')
return_distance is  tensor(167.8779, device='cuda:3')
distance x is tensor(167.8678, device='cuda:3')
distance x is tensor(167.8678, device='cuda:3')
________________________________
test distance is  tensor(167.8678, device='cuda:3')
test distance1 is  tensor(167.8678, device='cuda:3')
test similarity is  tensor(0.9855, device='cuda:3')
test acc is  0.30755000015633965
test loss is 29.596136595394565
test entropy is  0.09963260041768236
________________________________
0
distance x is tensor(167.8678, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.10029254086426835
avg test loss is  29.58681634240059
avg accuracy is  0.8164500001563246
solo acc is  0.3086833334896731
compute similarity  is  tensor(0.9855, device='cuda:3')
compute_distance is  tensor(167.8678, device='cuda:3')
compute_norm is  tensor(79.3950, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.6143, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.015719404479842
avg test loss is  1.5201453550029664
avg accuracy is  0.49010000015634203
solo acc is  0.2583500001563385
compute similarity  is  tensor(0.9857, device='cuda:3')
compute_distance is  tensor(159.6143, device='cuda:3')
compute_norm is  tensor(79.2354, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.6482, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6000502982309887
avg test loss is  2.3512933115715158
avg accuracy is  0.32211666682300666
solo acc is  0.11035000015633195
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(159.6482, device='cuda:3')
compute_norm is  tensor(78.8818, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.1321, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9519013382478564
avg test loss is  1.406118887828103
avg accuracy is  0.5145333334896756
solo acc is  0.28815000015633924
compute similarity  is  tensor(0.9857, device='cuda:3')
compute_distance is  tensor(159.1321, device='cuda:3')
compute_norm is  tensor(78.4903, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(159.1321, device='cuda:3')
distance x is tensor(159.1321, device='cuda:3')
________________________________
test distance is  tensor(159.1321, device='cuda:3')
test distance1 is  tensor(159.1321, device='cuda:3')
test similarity is  tensor(0.9857, device='cuda:3')
test acc is  0.28885000015633927
test loss is 1.4046114270112662
test entropy is  0.9532735144405731
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1500662565231323
mal norm is  tensor(811.0615, device='cuda:3')
distance x is tensor(159.1417, device='cuda:3')
mal distance is  tensor(159.1417, device='cuda:3')
len current grad  20
len all grad 52
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(30.6394, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.9398, device='cuda:3')
user_param_square tensor(143.9109, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(357.1943, device='cuda:3')
score : tensor(3.5415, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(724.8072, device='cuda:3')
user_param_square tensor(149.0222, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(260.2361, device='cuda:3')
score : tensor(2.5719, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.4172, device='cuda:3')
user_param_square tensor(137.0938, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(304.0881, device='cuda:3')
score : tensor(3.0104, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.1103, device='cuda:3')
user_param_square tensor(135.0326, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(163.7603, device='cuda:3')
score : tensor(1.6072, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.3832, device='cuda:3')
user_param_square tensor(150.3095, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(205.5541, device='cuda:3')
score : tensor(2.0251, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.7689, device='cuda:3')
user_param_square tensor(137.6905, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(283.3670, device='cuda:3')
score : tensor(2.8032, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.2309, device='cuda:3')
user_param_square tensor(136.5130, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(274.1286, device='cuda:3')
score : tensor(2.7108, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.1660, device='cuda:3')
user_param_square tensor(139.9415, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(222.2726, device='cuda:3')
score : tensor(2.1923, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.0615, device='cuda:3')
user_param_square tensor(157.6401, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(-113.7868, device='cuda:3')
score : tensor(-1.1683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.6583, device='cuda:3')
user_param_square tensor(162.2941, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(233.6974, device='cuda:3')
score : tensor(2.3065, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(891.6106, device='cuda:3')
user_param_square tensor(165.2827, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(146.6046, device='cuda:3')
score : tensor(1.4356, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(865.9726, device='cuda:3')
user_param_square tensor(162.8891, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(177.4412, device='cuda:3')
score : tensor(1.7440, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.1563, device='cuda:3')
user_param_square tensor(164.7764, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(182.1605, device='cuda:3')
score : tensor(1.7912, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(870.6826, device='cuda:3')
user_param_square tensor(163.3314, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(155.1249, device='cuda:3')
score : tensor(1.5208, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.1353, device='cuda:3')
user_param_square tensor(162.9984, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(231.2919, device='cuda:3')
score : tensor(2.2825, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.3495, device='cuda:3')
user_param_square tensor(163.7686, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(201.0564, device='cuda:3')
score : tensor(1.9801, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.4324, device='cuda:3')
user_param_square tensor(167.4762, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(201.1248, device='cuda:3')
score : tensor(1.9808, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(741.1929, device='cuda:3')
user_param_square tensor(150.6973, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(61.3899, device='cuda:3')
score : tensor(0.5835, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(895.6736, device='cuda:3')
user_param_square tensor(165.6589, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(191.1354, device='cuda:3')
score : tensor(1.8809, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(778.0661, device='cuda:3')
user_param_square tensor(154.4003, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(229.9546, device='cuda:3')
score : tensor(2.2691, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.6426, device='cuda:3')
user_param_square tensor(152.4609, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(193.1693, device='cuda:3')
score : tensor(1.9013, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.1293, device='cuda:3')
user_param_square tensor(153.3113, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(227.7590, device='cuda:3')
score : tensor(2.2472, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(752.4629, device='cuda:3')
user_param_square tensor(151.8387, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(284.7900, device='cuda:3')
score : tensor(2.8175, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(778.1487, device='cuda:3')
user_param_square tensor(154.4085, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(124.9334, device='cuda:3')
score : tensor(1.2189, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.4991, device='cuda:3')
user_param_square tensor(156.0222, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(258.5967, device='cuda:3')
score : tensor(2.5555, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.0025, device='cuda:3')
user_param_square tensor(143.1705, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(265.2592, device='cuda:3')
score : tensor(2.6222, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.4728, device='cuda:3')
user_param_square tensor(151.3344, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(217.4072, device='cuda:3')
score : tensor(2.1436, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.3243, device='cuda:3')
user_param_square tensor(153.9291, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(325.6160, device='cuda:3')
score : tensor(3.2257, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.8242, device='cuda:3')
user_param_square tensor(148.0959, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(192.3338, device='cuda:3')
score : tensor(1.8929, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.1378, device='cuda:3')
user_param_square tensor(145.0981, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(250.6681, device='cuda:3')
score : tensor(2.4762, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.5223, device='cuda:3')
user_param_square tensor(140.5267, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(217.2889, device='cuda:3')
score : tensor(2.1424, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.9946, device='cuda:3')
user_param_square tensor(149.6570, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(225.3633, device='cuda:3')
score : tensor(2.2232, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4182, device='cuda:3')
user_param_square tensor(149.3930, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(242.6289, device='cuda:3')
score : tensor(2.3958, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.7192, device='cuda:3')
user_param_square tensor(151.5616, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(218.5385, device='cuda:3')
score : tensor(2.1549, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.7117, device='cuda:3')
user_param_square tensor(155.1570, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(194.5053, device='cuda:3')
score : tensor(1.9146, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.2677, device='cuda:3')
user_param_square tensor(149.1723, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(238.6249, device='cuda:3')
score : tensor(2.3558, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.5917, device='cuda:3')
user_param_square tensor(150.9410, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(159.7735, device='cuda:3')
score : tensor(1.5673, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.3547, device='cuda:3')
user_param_square tensor(146.3823, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(157.1153, device='cuda:3')
score : tensor(1.5407, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.8855, device='cuda:3')
user_param_square tensor(152.2842, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(156.7340, device='cuda:3')
score : tensor(1.5369, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5204, device='cuda:3')
user_param_square tensor(150.1195, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(192.1391, device='cuda:3')
score : tensor(1.8910, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.1198, device='cuda:3')
user_param_square tensor(153.5101, device='cuda:3')
global_param_square tensor(30.6394, device='cuda:3')
part1 is  tensor(224.6282, device='cuda:3')
score : tensor(2.2158, device='cuda:3')
accept
len accept list 40
len all weights is 40
 
Avg Training Stats after 90 global rounds:
Train Accuracy: 89.83% 

Test Accuracy: 89.14% 


 | Global Training Round : 91 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5058685541152954
distance x is tensor(112.9909, device='cuda:3')
benign distance is  tensor(112.9909, device='cuda:3')
norm1 res is  tensor(0.1250, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.11695776134729385
distance x is tensor(117.7770, device='cuda:3')
benign distance is  tensor(117.7770, device='cuda:3')
norm1 res is  tensor(0.1331, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.1757863163948059
distance x is tensor(120.3725, device='cuda:3')
benign distance is  tensor(120.3725, device='cuda:3')
norm1 res is  tensor(0.1298, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.38241055607795715
distance x is tensor(110.4801, device='cuda:3')
benign distance is  tensor(110.4801, device='cuda:3')
norm1 res is  tensor(0.1233, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6968363523483276
distance x is tensor(97.4814, device='cuda:3')
benign distance is  tensor(97.4814, device='cuda:3')
norm1 res is  tensor(0.1073, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.47614341974258423
distance x is tensor(119.6381, device='cuda:3')
benign distance is  tensor(119.6381, device='cuda:3')
norm1 res is  tensor(0.1377, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.31432896852493286
distance x is tensor(150.6444, device='cuda:3')
benign distance is  tensor(150.6444, device='cuda:3')
norm1 res is  tensor(0.1606, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.7631376385688782
distance x is tensor(121.2538, device='cuda:3')
benign distance is  tensor(121.2538, device='cuda:3')
norm1 res is  tensor(0.1353, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.6120492219924927
distance x is tensor(147.4725, device='cuda:3')
benign distance is  tensor(147.4725, device='cuda:3')
norm1 res is  tensor(0.1615, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.5052328109741211
distance x is tensor(157.8596, device='cuda:3')
benign distance is  tensor(157.8596, device='cuda:3')
norm1 res is  tensor(0.1732, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.4330594539642334
distance x is tensor(152.9721, device='cuda:3')
benign distance is  tensor(152.9721, device='cuda:3')
norm1 res is  tensor(0.1643, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.26755276322364807
distance x is tensor(132.4476, device='cuda:3')
benign distance is  tensor(132.4476, device='cuda:3')
norm1 res is  tensor(0.1453, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.48332539200782776
distance x is tensor(136.9449, device='cuda:3')
benign distance is  tensor(136.9449, device='cuda:3')
norm1 res is  tensor(0.1543, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.19001251459121704
distance x is tensor(136.8268, device='cuda:3')
benign distance is  tensor(136.8268, device='cuda:3')
norm1 res is  tensor(0.1485, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.9071625471115112
distance x is tensor(137.3822, device='cuda:3')
benign distance is  tensor(137.3822, device='cuda:3')
norm1 res is  tensor(0.1487, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.6963262557983398
distance x is tensor(123.0047, device='cuda:3')
benign distance is  tensor(123.0047, device='cuda:3')
norm1 res is  tensor(0.1364, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.2118157595396042
distance x is tensor(123.3440, device='cuda:3')
benign distance is  tensor(123.3440, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.8277937173843384
distance x is tensor(129.1648, device='cuda:3')
benign distance is  tensor(129.1648, device='cuda:3')
norm1 res is  tensor(0.1440, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.06780654937028885
distance x is tensor(114.1814, device='cuda:3')
benign distance is  tensor(114.1814, device='cuda:3')
norm1 res is  tensor(0.1227, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.06403591483831406
distance x is tensor(126.8786, device='cuda:3')
benign distance is  tensor(126.8786, device='cuda:3')
norm1 res is  tensor(0.1428, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.1488935947418213
distance x is tensor(128.8526, device='cuda:3')
benign distance is  tensor(128.8526, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.2947724759578705
distance x is tensor(128.3060, device='cuda:3')
benign distance is  tensor(128.3060, device='cuda:3')
norm1 res is  tensor(0.1403, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.5769487619400024
distance x is tensor(141.3193, device='cuda:3')
benign distance is  tensor(141.3193, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.1308020055294037
distance x is tensor(122.9411, device='cuda:3')
benign distance is  tensor(122.9411, device='cuda:3')
norm1 res is  tensor(0.1327, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.46849650144577026
distance x is tensor(117.4827, device='cuda:3')
benign distance is  tensor(117.4827, device='cuda:3')
norm1 res is  tensor(0.1300, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.16817264258861542
distance x is tensor(122.9273, device='cuda:3')
benign distance is  tensor(122.9273, device='cuda:3')
norm1 res is  tensor(0.1375, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.516952395439148
distance x is tensor(141.5140, device='cuda:3')
benign distance is  tensor(141.5140, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.0991852656006813
distance x is tensor(125.9164, device='cuda:3')
benign distance is  tensor(125.9164, device='cuda:3')
norm1 res is  tensor(0.1369, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.18400080502033234
distance x is tensor(128.0863, device='cuda:3')
benign distance is  tensor(128.0863, device='cuda:3')
norm1 res is  tensor(0.1422, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.23069076240062714
distance x is tensor(134.3229, device='cuda:3')
benign distance is  tensor(134.3229, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.6668850183486938
distance x is tensor(126.3724, device='cuda:3')
benign distance is  tensor(126.3724, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.3561598062515259
distance x is tensor(125.6679, device='cuda:3')
benign distance is  tensor(125.6679, device='cuda:3')
norm1 res is  tensor(0.1345, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.2571509778499603
distance x is tensor(134.1147, device='cuda:3')
benign distance is  tensor(134.1147, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.5245758295059204
distance x is tensor(128.5848, device='cuda:3')
benign distance is  tensor(128.5848, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.28213560581207275
distance x is tensor(126.5598, device='cuda:3')
benign distance is  tensor(126.5598, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.16695661842823029
distance x is tensor(138.7503, device='cuda:3')
benign distance is  tensor(138.7503, device='cuda:3')
norm1 res is  tensor(0.1513, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.4735420346260071
distance x is tensor(134.9584, device='cuda:3')
benign distance is  tensor(134.9584, device='cuda:3')
norm1 res is  tensor(0.1467, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.47730308771133423
distance x is tensor(138.4359, device='cuda:3')
benign distance is  tensor(138.4359, device='cuda:3')
norm1 res is  tensor(0.1454, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  1.1402015686035156
distance x is tensor(143.2259, device='cuda:3')
benign distance is  tensor(143.2259, device='cuda:3')
norm1 res is  tensor(0.1577, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.45352545380592346
distance x is tensor(127.8542, device='cuda:3')
benign distance is  tensor(127.8542, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(126.7116, device='cuda:3')
compute distance is  tensor(126.7116, device='cuda:3')
compute norm is  tensor(71.9125, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0334, device='cuda:3')
compute distance is  tensor(132.0334, device='cuda:3')
compute norm is  tensor(72.0402, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5783, device='cuda:3')
compute distance is  tensor(133.5783, device='cuda:3')
compute norm is  tensor(72.1232, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4498, device='cuda:3')
compute distance is  tensor(129.4498, device='cuda:3')
compute norm is  tensor(72.0194, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6129, device='cuda:3')
compute distance is  tensor(137.6129, device='cuda:3')
compute norm is  tensor(72.1094, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6529, device='cuda:3')
compute distance is  tensor(127.6529, device='cuda:3')
compute norm is  tensor(71.8314, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7222, device='cuda:3')
compute distance is  tensor(127.7222, device='cuda:3')
compute norm is  tensor(71.9890, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9265, device='cuda:3')
compute distance is  tensor(126.9265, device='cuda:3')
compute norm is  tensor(71.9369, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1480, device='cuda:3')
compute distance is  tensor(142.1480, device='cuda:3')
compute norm is  tensor(72.1989, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7515, device='cuda:3')
compute distance is  tensor(132.7515, device='cuda:3')
compute norm is  tensor(72.1052, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6025, device='cuda:3')
compute distance is  tensor(138.6025, device='cuda:3')
compute norm is  tensor(72.0314, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7837, device='cuda:3')
compute distance is  tensor(138.7837, device='cuda:3')
compute norm is  tensor(72.1417, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(142.1480, device='cuda:3')
distance x is tensor(107521.8125, device='cuda:3')
distance x is tensor(107521.8125, device='cuda:3')
________________________________
test distance is  tensor(107521.8125, device='cuda:3')
test distance1 is  tensor(107521.8125, device='cuda:3')
test similarity is  tensor(0.5261, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130085881443465.55
test entropy is  0.0
________________________________
cal ratio is  0.03563264846196834
distance x is tensor(3831.2917, device='cuda:3')
cal_distance is  tensor(3831.2917, device='cuda:3')
cal ratio is  0.1887660083905793
distance x is tensor(723.2218, device='cuda:3')
cal_distance is  tensor(723.2218, device='cuda:3')
cal ratio is  0.4344708434924745
distance x is tensor(314.2217, device='cuda:3')
cal_distance is  tensor(314.2217, device='cuda:3')
cal ratio is  0.6591410090015934
distance x is tensor(207.1181, device='cuda:3')
cal_distance is  tensor(207.1181, device='cuda:3')
cal ratio is  0.8118715295284297
distance x is tensor(168.1543, device='cuda:3')
cal_distance is  tensor(168.1543, device='cuda:3')
cal ratio is  0.9010365675074478
distance x is tensor(151.5137, device='cuda:3')
cal_distance is  tensor(151.5137, device='cuda:3')
cal ratio is  0.9492278341855493
distance x is tensor(143.8213, device='cuda:3')
cal_distance is  tensor(143.8213, device='cuda:3')
cal ratio is  0.9742824019231232
distance x is tensor(140.1227, device='cuda:3')
cal_distance is  tensor(140.1227, device='cuda:3')
distance x is tensor(140.1227, device='cuda:3')
return_distance is  tensor(140.1227, device='cuda:3')
distance x is tensor(140.1124, device='cuda:3')
distance x is tensor(140.1124, device='cuda:3')
________________________________
test distance is  tensor(140.1124, device='cuda:3')
test distance1 is  tensor(140.1124, device='cuda:3')
test similarity is  tensor(0.9871, device='cuda:3')
test acc is  0.4522166668230083
test loss is 15.145371266265414
test entropy is  0.07937977246161718
________________________________
0
distance x is tensor(140.1124, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.08021185822737242
avg test loss is  14.990271393424159
avg accuracy is  0.8946666668229881
solo acc is  0.45386666682300836
compute similarity  is  tensor(0.9871, device='cuda:3')
compute_distance is  tensor(140.1124, device='cuda:3')
compute_norm is  tensor(75.9377, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.0160, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8980280807785896
avg test loss is  1.3221964924447318
avg accuracy is  0.8316833334896573
solo acc is  0.3222666668230067
compute similarity  is  tensor(0.9869, device='cuda:3')
compute_distance is  tensor(138.0160, device='cuda:3')
compute_norm is  tensor(75.3573, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.5308, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8540472239573628
avg test loss is  1.420541102443931
avg accuracy is  0.8274333334896575
solo acc is  0.253116666823005
compute similarity  is  tensor(0.9867, device='cuda:3')
compute_distance is  tensor(138.5308, device='cuda:3')
compute_norm is  tensor(74.9778, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.8665, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8544963019997326
avg test loss is  1.3914901809905893
avg accuracy is  0.8290333334896574
solo acc is  0.25005000015633827
compute similarity  is  tensor(0.9866, device='cuda:3')
compute_distance is  tensor(138.8665, device='cuda:3')
compute_norm is  tensor(74.6036, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.2527, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8464650986418287
avg test loss is  1.3689092780227092
avg accuracy is  0.8307333334896574
solo acc is  0.24790000015633817
compute similarity  is  tensor(0.9865, device='cuda:3')
compute_distance is  tensor(139.2527, device='cuda:3')
compute_norm is  tensor(74.2334, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.6284, device='cuda:3')
distance x is tensor(139.6284, device='cuda:3')
________________________________
test distance is  tensor(139.6284, device='cuda:3')
test distance1 is  tensor(139.6284, device='cuda:3')
test similarity is  tensor(0.9863, device='cuda:3')
test acc is  0.24560000015633818
test loss is 1.3603288103014166
test entropy is  0.8379175607710759
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1471048593521118
mal norm is  tensor(667.9675, device='cuda:3')
distance x is tensor(139.6372, device='cuda:3')
mal distance is  tensor(139.6372, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(15.8587, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.5757, device='cuda:3')
user_param_square tensor(88.0237, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(-11.3138, device='cuda:3')
score : tensor(-0.1288, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.1451, device='cuda:3')
user_param_square tensor(89.2377, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(-10.7640, device='cuda:3')
score : tensor(-0.1233, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.5997, device='cuda:3')
user_param_square tensor(90.0739, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(12.8242, device='cuda:3')
score : tensor(0.1126, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.1689, device='cuda:3')
user_param_square tensor(86.9901, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(-35.3016, device='cuda:3')
score : tensor(-0.3687, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(422.7177, device='cuda:3')
user_param_square tensor(81.8764, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(-33.0828, device='cuda:3')
score : tensor(-0.3465, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.0135, device='cuda:3')
user_param_square tensor(91.5074, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(1.2888, device='cuda:3')
score : tensor(-0.0028, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.5233, device='cuda:3')
user_param_square tensor(99.1203, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(1.7917, device='cuda:3')
score : tensor(0.0023, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.9172, device='cuda:3')
user_param_square tensor(91.8451, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(-24.9122, device='cuda:3')
score : tensor(-0.2648, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9675, device='cuda:3')
user_param_square tensor(102.9228, device='cuda:3')
global_param_square tensor(15.8587, device='cuda:3')
part1 is  tensor(6.6767, device='cuda:3')
score : tensor(0.0511, device='cuda:3')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 91 global rounds:
Train Accuracy: 82.10% 

Test Accuracy: 80.55% 


 | Global Training Round : 92 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6845542192459106
distance x is tensor(148.1582, device='cuda:3')
benign distance is  tensor(148.1582, device='cuda:3')
norm1 res is  tensor(0.1540, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.42237868905067444
distance x is tensor(170.1923, device='cuda:3')
benign distance is  tensor(170.1923, device='cuda:3')
norm1 res is  tensor(0.1734, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3863442540168762
distance x is tensor(148.5318, device='cuda:3')
benign distance is  tensor(148.5318, device='cuda:3')
norm1 res is  tensor(0.1530, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.353259414434433
distance x is tensor(148.6921, device='cuda:3')
benign distance is  tensor(148.6921, device='cuda:3')
norm1 res is  tensor(0.1544, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.27726396918296814
distance x is tensor(157.6487, device='cuda:3')
benign distance is  tensor(157.6487, device='cuda:3')
norm1 res is  tensor(0.1666, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.20557399094104767
distance x is tensor(161.9396, device='cuda:3')
benign distance is  tensor(161.9396, device='cuda:3')
norm1 res is  tensor(0.1680, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.31954795122146606
distance x is tensor(146.5104, device='cuda:3')
benign distance is  tensor(146.5104, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.0659184530377388
distance x is tensor(153.9797, device='cuda:3')
benign distance is  tensor(153.9797, device='cuda:3')
norm1 res is  tensor(0.1624, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(226.0531, device='cuda:3')
compute distance is  tensor(226.0531, device='cuda:3')
compute norm is  tensor(76.4068, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.2342, device='cuda:3')
compute distance is  tensor(152.2342, device='cuda:3')
compute norm is  tensor(74.4055, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.2833, device='cuda:3')
compute distance is  tensor(158.2833, device='cuda:3')
compute norm is  tensor(74.5877, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.0776, device='cuda:3')
compute distance is  tensor(165.0776, device='cuda:3')
compute norm is  tensor(74.6616, device='cuda:3', dtype=torch.float64)
distance x is tensor(181.2168, device='cuda:3')
compute distance is  tensor(181.2168, device='cuda:3')
compute norm is  tensor(74.9349, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.3052, device='cuda:3')
compute distance is  tensor(158.3052, device='cuda:3')
compute norm is  tensor(74.6015, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.3323, device='cuda:3')
compute distance is  tensor(158.3323, device='cuda:3')
compute norm is  tensor(74.5044, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.6001, device='cuda:3')
compute distance is  tensor(155.6001, device='cuda:3')
compute norm is  tensor(74.6035, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.2409, device='cuda:3')
compute distance is  tensor(171.2409, device='cuda:3')
compute norm is  tensor(74.7499, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.6058, device='cuda:3')
compute distance is  tensor(153.6058, device='cuda:3')
compute norm is  tensor(74.5903, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.9051, device='cuda:3')
compute distance is  tensor(158.9051, device='cuda:3')
compute norm is  tensor(74.6035, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.0736, device='cuda:3')
compute distance is  tensor(166.0736, device='cuda:3')
compute norm is  tensor(74.7085, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(226.0531, device='cuda:3')
distance x is tensor(107442.3984, device='cuda:3')
distance x is tensor(107442.3984, device='cuda:3')
________________________________
test distance is  tensor(107442.3984, device='cuda:3')
test distance1 is  tensor(107442.3984, device='cuda:3')
test similarity is  tensor(0.6140, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130157955969906.08
test entropy is  0.0
________________________________
cal ratio is  0.044951424606270794
distance x is tensor(4829.6943, device='cuda:3')
cal_distance is  tensor(4829.6943, device='cuda:3')
cal ratio is  0.21201738951772003
distance x is tensor(1023.9832, device='cuda:3')
cal_distance is  tensor(1023.9832, device='cuda:3')
cal ratio is  0.46045256149033303
distance x is tensor(471.4985, device='cuda:3')
cal_distance is  tensor(471.4985, device='cuda:3')
cal ratio is  0.6785645355622033
distance x is tensor(319.9438, device='cuda:3')
cal_distance is  tensor(319.9438, device='cuda:3')
cal ratio is  0.8237482136314831
distance x is tensor(263.5540, device='cuda:3')
cal_distance is  tensor(263.5540, device='cuda:3')
cal ratio is  0.9076041949175211
distance x is tensor(239.2032, device='cuda:3')
cal_distance is  tensor(239.2032, device='cuda:3')
cal ratio is  0.9526816477494157
distance x is tensor(227.8848, device='cuda:3')
cal_distance is  tensor(227.8848, device='cuda:3')
cal ratio is  0.9760535876843125
distance x is tensor(222.4279, device='cuda:3')
cal_distance is  tensor(222.4279, device='cuda:3')
distance x is tensor(222.4279, device='cuda:3')
return_distance is  tensor(222.4279, device='cuda:3')
distance x is tensor(222.4176, device='cuda:3')
distance x is tensor(222.4176, device='cuda:3')
________________________________
test distance is  tensor(222.4176, device='cuda:3')
test distance1 is  tensor(222.4176, device='cuda:3')
test similarity is  tensor(0.9787, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1158.4630277263584
test entropy is  0.0
________________________________
0
distance x is tensor(222.4176, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.021301321462987e-36
avg test loss is  1158.889519534894
avg accuracy is  0.10431666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9787, device='cuda:3')
compute_distance is  tensor(222.4176, device='cuda:3')
compute_norm is  tensor(82.5243, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(184358.5312, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5361766730036055
avg test loss is  2.8943221843573075
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0178, device='cuda:3')
compute_distance is  tensor(184358.5312, device='cuda:3')
compute_norm is  tensor(21144.2012, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(183496.3906, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8290442819915601
avg test loss is  3.656805977638342
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0178, device='cuda:3')
compute_distance is  tensor(183496.3906, device='cuda:3')
compute_norm is  tensor(21045.3829, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182638.0156, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5507155105249206
avg test loss is  2.872427098786653
avg accuracy is  0.09998333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0179, device='cuda:3')
compute_distance is  tensor(182638.0156, device='cuda:3')
compute_norm is  tensor(20946.7266, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(181783.8906, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8395278774090668
avg test loss is  3.6300431253559298
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0178, device='cuda:3')
compute_distance is  tensor(181783.8906, device='cuda:3')
compute_norm is  tensor(20848.8787, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180933.5000, device='cuda:3')
distance x is tensor(180933.5000, device='cuda:3')
________________________________
test distance is  tensor(180933.5000, device='cuda:3')
test distance1 is  tensor(180933.5000, device='cuda:3')
test similarity is  tensor(-0.0179, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8650407519167675
test entropy is  1.557638095767259
________________________________
cal ratio is  0.03463951663744766
distance x is tensor(6267.4468, device='cuda:3')
cal_distance is  tensor(6267.4468, device='cuda:3')
cal ratio is  0.18611697454808224
distance x is tensor(1166.4764, device='cuda:3')
cal_distance is  tensor(1166.4764, device='cuda:3')
cal ratio is  0.43141310220434903
distance x is tensor(503.2319, device='cuda:3')
cal_distance is  tensor(503.2319, device='cuda:3')
cal ratio is  0.6568213086820285
distance x is tensor(330.5327, device='cuda:3')
cal_distance is  tensor(330.5327, device='cuda:3')
cal ratio is  0.8104460302506912
distance x is tensor(267.8785, device='cuda:3')
cal_distance is  tensor(267.8785, device='cuda:3')
cal ratio is  0.90024843089267
distance x is tensor(241.1570, device='cuda:3')
cal_distance is  tensor(241.1570, device='cuda:3')
cal ratio is  0.9488146167859919
distance x is tensor(228.8132, device='cuda:3')
cal_distance is  tensor(228.8132, device='cuda:3')
cal ratio is  0.9740713886201775
distance x is tensor(222.8803, device='cuda:3')
cal_distance is  tensor(222.8803, device='cuda:3')
distance x is tensor(222.8803, device='cuda:3')
return_distance is  tensor(222.8803, device='cuda:3')
distance x is tensor(222.8849, device='cuda:3')
distance x is tensor(222.8849, device='cuda:3')
________________________________
test distance is  tensor(222.8849, device='cuda:3')
test distance1 is  tensor(222.8849, device='cuda:3')
test similarity is  tensor(0.8370, device='cuda:3')
test acc is  0.5068833334896755
test loss is 1.1952579361416384
test entropy is  0.8525860204752574
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.5000000005
mal loss is 1.4108754396438599
mal norm is  tensor(2324.8447, device='cuda:3')
distance x is tensor(222.8803, device='cuda:3')
mal distance is  tensor(222.8803, device='cuda:3')
len current grad  20
len all grad 36
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(24.1205, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.3920, device='cuda:3')
user_param_square tensor(121.1393, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(195.8385, device='cuda:3')
score : tensor(1.9345, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.2422, device='cuda:3')
user_param_square tensor(128.6566, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(158.1120, device='cuda:3')
score : tensor(1.5572, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.2890, device='cuda:3')
user_param_square tensor(120.5302, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(182.3170, device='cuda:3')
score : tensor(1.7992, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.5978, device='cuda:3')
user_param_square tensor(119.8588, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(196.8282, device='cuda:3')
score : tensor(1.9444, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.7925, device='cuda:3')
user_param_square tensor(124.5170, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(264.2211, device='cuda:3')
score : tensor(2.6183, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.7706, device='cuda:3')
user_param_square tensor(126.2463, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(168.9699, device='cuda:3')
score : tensor(1.6658, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.9177, device='cuda:3')
user_param_square tensor(118.9822, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(155.8343, device='cuda:3')
score : tensor(1.5344, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.3012, device='cuda:3')
user_param_square tensor(123.5943, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(186.1177, device='cuda:3')
score : tensor(1.8373, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(2324.8447, device='cuda:3')
user_param_square tensor(236.8047, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(-62.5071, device='cuda:3')
score : tensor(-0.6490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.1454, device='cuda:3')
user_param_square tensor(143.1148, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(118.5612, device='cuda:3')
score : tensor(1.1617, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(838.3503, device='cuda:3')
user_param_square tensor(142.2021, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(113.4993, device='cuda:3')
score : tensor(1.1111, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(881.5237, device='cuda:3')
user_param_square tensor(145.8177, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(181.8806, device='cuda:3')
score : tensor(1.7949, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(837.7686, device='cuda:3')
user_param_square tensor(142.1528, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(203.3808, device='cuda:3')
score : tensor(2.0099, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(871.7678, device='cuda:3')
user_param_square tensor(145.0086, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(138.8676, device='cuda:3')
score : tensor(1.3648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(880.4497, device='cuda:3')
user_param_square tensor(145.7289, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(141.0177, device='cuda:3')
score : tensor(1.3863, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(855.1009, device='cuda:3')
user_param_square tensor(143.6158, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(141.1144, device='cuda:3')
score : tensor(1.3872, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.4624, device='cuda:3')
user_param_square tensor(143.4781, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(116.2328, device='cuda:3')
score : tensor(1.1384, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.6755, device='cuda:3')
user_param_square tensor(139.7491, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(159.4000, device='cuda:3')
score : tensor(1.5701, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(852.1120, device='cuda:3')
user_param_square tensor(143.3645, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(190.1404, device='cuda:3')
score : tensor(1.8775, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.8417, device='cuda:3')
user_param_square tensor(140.8807, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(99.1168, device='cuda:3')
score : tensor(0.9672, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(752.8224, device='cuda:3')
user_param_square tensor(134.7534, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(132.0003, device='cuda:3')
score : tensor(1.2961, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(772.3303, device='cuda:3')
user_param_square tensor(136.4881, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(148.0119, device='cuda:3')
score : tensor(1.4562, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.9568, device='cuda:3')
user_param_square tensor(135.8351, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(200.3186, device='cuda:3')
score : tensor(1.9793, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.0685, device='cuda:3')
user_param_square tensor(135.5784, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(148.6677, device='cuda:3')
score : tensor(1.4628, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.1436, device='cuda:3')
user_param_square tensor(131.9791, device='cuda:3')
global_param_square tensor(24.1205, device='cuda:3')
part1 is  tensor(212.5112, device='cuda:3')
score : tensor(2.1012, device='cuda:3')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 92 global rounds:
Train Accuracy: 89.68% 

Test Accuracy: 89.29% 


 | Global Training Round : 93 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3951330780982971
distance x is tensor(138.0469, device='cuda:3')
benign distance is  tensor(138.0469, device='cuda:3')
norm1 res is  tensor(0.1515, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.45051154494285583
distance x is tensor(117.7791, device='cuda:3')
benign distance is  tensor(117.7791, device='cuda:3')
norm1 res is  tensor(0.1317, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.08991149812936783
distance x is tensor(103.0440, device='cuda:3')
benign distance is  tensor(103.0440, device='cuda:3')
norm1 res is  tensor(0.1119, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7275806665420532
distance x is tensor(105.6921, device='cuda:3')
benign distance is  tensor(105.6921, device='cuda:3')
norm1 res is  tensor(0.1138, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3185266852378845
distance x is tensor(108.7256, device='cuda:3')
benign distance is  tensor(108.7256, device='cuda:3')
norm1 res is  tensor(0.1141, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7130029797554016
distance x is tensor(133.7560, device='cuda:3')
benign distance is  tensor(133.7560, device='cuda:3')
norm1 res is  tensor(0.1470, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.40588632225990295
distance x is tensor(113.6479, device='cuda:3')
benign distance is  tensor(113.6479, device='cuda:3')
norm1 res is  tensor(0.1213, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.6642346382141113
distance x is tensor(142.1574, device='cuda:3')
benign distance is  tensor(142.1574, device='cuda:3')
norm1 res is  tensor(0.1546, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.4654681086540222
distance x is tensor(127.5460, device='cuda:3')
benign distance is  tensor(127.5460, device='cuda:3')
norm1 res is  tensor(0.1386, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3827734887599945
distance x is tensor(126.5399, device='cuda:3')
benign distance is  tensor(126.5399, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.6537327170372009
distance x is tensor(112.7331, device='cuda:3')
benign distance is  tensor(112.7331, device='cuda:3')
norm1 res is  tensor(0.1209, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5067130327224731
distance x is tensor(136.4565, device='cuda:3')
benign distance is  tensor(136.4565, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.19449174404144287
distance x is tensor(139.8367, device='cuda:3')
benign distance is  tensor(139.8367, device='cuda:3')
norm1 res is  tensor(0.1546, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.4527483582496643
distance x is tensor(132.1672, device='cuda:3')
benign distance is  tensor(132.1672, device='cuda:3')
norm1 res is  tensor(0.1431, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4126870632171631
distance x is tensor(127.0320, device='cuda:3')
benign distance is  tensor(127.0320, device='cuda:3')
norm1 res is  tensor(0.1406, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4853289723396301
distance x is tensor(124.1171, device='cuda:3')
benign distance is  tensor(124.1171, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.6821168661117554
distance x is tensor(125.5191, device='cuda:3')
benign distance is  tensor(125.5191, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.26616063714027405
distance x is tensor(120.5457, device='cuda:3')
benign distance is  tensor(120.5457, device='cuda:3')
norm1 res is  tensor(0.1317, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.5029882192611694
distance x is tensor(139.4114, device='cuda:3')
benign distance is  tensor(139.4114, device='cuda:3')
norm1 res is  tensor(0.1516, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.4578917622566223
distance x is tensor(133.3768, device='cuda:3')
benign distance is  tensor(133.3768, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.2524137496948242
distance x is tensor(141.4781, device='cuda:3')
benign distance is  tensor(141.4781, device='cuda:3')
norm1 res is  tensor(0.1498, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.5015451312065125
distance x is tensor(131.5687, device='cuda:3')
benign distance is  tensor(131.5687, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.2606167197227478
distance x is tensor(138.4528, device='cuda:3')
benign distance is  tensor(138.4528, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.22865307331085205
distance x is tensor(129.8177, device='cuda:3')
benign distance is  tensor(129.8177, device='cuda:3')
norm1 res is  tensor(0.1403, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(130.9592, device='cuda:3')
compute distance is  tensor(130.9592, device='cuda:3')
compute norm is  tensor(73.1539, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3891, device='cuda:3')
compute distance is  tensor(126.3891, device='cuda:3')
compute norm is  tensor(72.9708, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3897, device='cuda:3')
compute distance is  tensor(140.3897, device='cuda:3')
compute norm is  tensor(73.2822, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.2579, device='cuda:3')
compute distance is  tensor(143.2579, device='cuda:3')
compute norm is  tensor(73.2928, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.9914, device='cuda:3')
compute distance is  tensor(129.9914, device='cuda:3')
compute norm is  tensor(73.1153, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.7638, device='cuda:3')
compute distance is  tensor(155.7638, device='cuda:3')
compute norm is  tensor(73.6858, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6635, device='cuda:3')
compute distance is  tensor(127.6635, device='cuda:3')
compute norm is  tensor(72.9602, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.7749, device='cuda:3')
compute distance is  tensor(135.7749, device='cuda:3')
compute norm is  tensor(73.1372, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7966, device='cuda:3')
compute distance is  tensor(144.7966, device='cuda:3')
compute norm is  tensor(73.2717, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.4922, device='cuda:3')
compute distance is  tensor(141.4922, device='cuda:3')
compute norm is  tensor(73.2138, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.6786, device='cuda:3')
compute distance is  tensor(144.6786, device='cuda:3')
compute norm is  tensor(73.3019, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9930, device='cuda:3')
compute distance is  tensor(139.9930, device='cuda:3')
compute norm is  tensor(73.3670, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(155.7638, device='cuda:3')
distance x is tensor(107502.3281, device='cuda:3')
distance x is tensor(107502.3281, device='cuda:3')
________________________________
test distance is  tensor(107502.3281, device='cuda:3')
test distance1 is  tensor(107502.3281, device='cuda:3')
test similarity is  tensor(0.5500, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130023481566598.83
test entropy is  0.0
________________________________
cal ratio is  0.03730356794444887
distance x is tensor(4010.2258, device='cuda:3')
cal_distance is  tensor(4010.2258, device='cuda:3')
cal ratio is  0.19314118405077493
distance x is tensor(774.5439, device='cuda:3')
cal_distance is  tensor(774.5439, device='cuda:3')
cal ratio is  0.43947715220909284
distance x is tensor(340.3972, device='cuda:3')
cal_distance is  tensor(340.3972, device='cuda:3')
cal ratio is  0.6629279635989535
distance x is tensor(225.6606, device='cuda:3')
cal_distance is  tensor(225.6606, device='cuda:3')
cal ratio is  0.8142006987783534
distance x is tensor(183.7340, device='cuda:3')
cal_distance is  tensor(183.7340, device='cuda:3')
cal ratio is  0.9023283191633072
distance x is tensor(165.7888, device='cuda:3')
cal_distance is  tensor(165.7888, device='cuda:3')
cal ratio is  0.9499082359867723
distance x is tensor(157.4845, device='cuda:3')
cal_distance is  tensor(157.4845, device='cuda:3')
cal ratio is  0.9746315517677449
distance x is tensor(153.4895, device='cuda:3')
cal_distance is  tensor(153.4895, device='cuda:3')
distance x is tensor(153.4895, device='cuda:3')
return_distance is  tensor(153.4895, device='cuda:3')
distance x is tensor(153.4792, device='cuda:3')
distance x is tensor(153.4792, device='cuda:3')
________________________________
test distance is  tensor(153.4792, device='cuda:3')
test distance1 is  tensor(153.4792, device='cuda:3')
test similarity is  tensor(0.9861, device='cuda:3')
test acc is  0.15593333348966695
test loss is 66.80205475699418
test entropy is  0.01626470649549766
________________________________
0
distance x is tensor(153.4792, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.016321047746588806
avg test loss is  66.4138509266412
avg accuracy is  0.8805333334896553
solo acc is  0.15483333348966696
compute similarity  is  tensor(0.9861, device='cuda:3')
compute_distance is  tensor(153.4792, device='cuda:3')
compute_norm is  tensor(77.7486, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(150.8134, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9859060240325643
avg test loss is  1.4376354992770946
avg accuracy is  0.7548333334896608
solo acc is  0.28816666682300596
compute similarity  is  tensor(0.9863, device='cuda:3')
compute_distance is  tensor(150.8134, device='cuda:3')
compute_norm is  tensor(77.5445, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(150.8134, device='cuda:3')
distance x is tensor(150.8134, device='cuda:3')
________________________________
test distance is  tensor(150.8134, device='cuda:3')
test distance1 is  tensor(150.8134, device='cuda:3')
test similarity is  tensor(0.9863, device='cuda:3')
test acc is  0.2850166668230059
test loss is 1.441421139214847
test entropy is  0.9865278479005737
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4636443853378296
mal norm is  tensor(764.8473, device='cuda:3')
distance x is tensor(150.8226, device='cuda:3')
mal distance is  tensor(150.8226, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(17.3860, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.5097, device='cuda:3')
user_param_square tensor(101.6668, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-11.9691, device='cuda:3')
score : tensor(-0.1369, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.0266, device='cuda:3')
user_param_square tensor(93.8890, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-29.2497, device='cuda:3')
score : tensor(-0.3097, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(440.0946, device='cuda:3')
user_param_square tensor(87.4727, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-17.2202, device='cuda:3')
score : tensor(-0.1894, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(448.0981, device='cuda:3')
user_param_square tensor(88.2645, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(21.6678, device='cuda:3')
score : tensor(0.1995, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(450.2533, device='cuda:3')
user_param_square tensor(88.4765, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-14.1894, device='cuda:3')
score : tensor(-0.1591, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.6809, device='cuda:3')
user_param_square tensor(99.7829, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-27.8670, device='cuda:3')
score : tensor(-0.2959, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(473.8150, device='cuda:3')
user_param_square tensor(90.7620, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-19.8786, device='cuda:3')
score : tensor(-0.2160, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.7026, device='cuda:3')
user_param_square tensor(102.2800, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(4.3809, device='cuda:3')
score : tensor(0.0266, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8473, device='cuda:3')
user_param_square tensor(115.3153, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(47.2499, device='cuda:3')
score : tensor(0.4553, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.7588, device='cuda:3')
user_param_square tensor(98.7388, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(10.4468, device='cuda:3')
score : tensor(0.0873, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.1696, device='cuda:3')
user_param_square tensor(101.8086, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-57.2792, device='cuda:3')
score : tensor(-0.5900, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.5919, device='cuda:3')
user_param_square tensor(94.8622, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(41.3157, device='cuda:3')
score : tensor(0.3960, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.0109, device='cuda:3')
user_param_square tensor(100.1594, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(13.1362, device='cuda:3')
score : tensor(0.1142, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.0109, device='cuda:3')
user_param_square tensor(101.1955, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-3.1773, device='cuda:3')
score : tensor(-0.0490, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.6888, device='cuda:3')
user_param_square tensor(100.8235, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-10.4850, device='cuda:3')
score : tensor(-0.1220, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.1016, device='cuda:3')
user_param_square tensor(104.7488, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(-22.7673, device='cuda:3')
score : tensor(-0.2449, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(554.5415, device='cuda:3')
user_param_square tensor(98.1898, device='cuda:3')
global_param_square tensor(17.3860, device='cuda:3')
part1 is  tensor(19.8601, device='cuda:3')
score : tensor(0.1814, device='cuda:3')
accept
len accept list 18
len all weights is 18
 
Avg Training Stats after 93 global rounds:
Train Accuracy: 81.97% 

Test Accuracy: 81.16% 


 | Global Training Round : 94 | 

current submit client idx and staleness is  0 1
 benign loss is  1.3047096729278564
distance x is tensor(160.9887, device='cuda:3')
benign distance is  tensor(160.9887, device='cuda:3')
norm1 res is  tensor(0.1662, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.561400294303894
distance x is tensor(168.1048, device='cuda:3')
benign distance is  tensor(168.1048, device='cuda:3')
norm1 res is  tensor(0.1744, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.22830036282539368
distance x is tensor(157.9085, device='cuda:3')
benign distance is  tensor(157.9085, device='cuda:3')
norm1 res is  tensor(0.1671, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  1.0979734659194946
distance x is tensor(140.8675, device='cuda:3')
benign distance is  tensor(140.8675, device='cuda:3')
norm1 res is  tensor(0.1491, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.926297664642334
distance x is tensor(161.3372, device='cuda:3')
benign distance is  tensor(161.3372, device='cuda:3')
norm1 res is  tensor(0.1632, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7565668225288391
distance x is tensor(173.5488, device='cuda:3')
benign distance is  tensor(173.5488, device='cuda:3')
norm1 res is  tensor(0.1804, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.0360526517033577
distance x is tensor(146.0657, device='cuda:3')
benign distance is  tensor(146.0657, device='cuda:3')
norm1 res is  tensor(0.1510, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.4249398708343506
distance x is tensor(182.9890, device='cuda:3')
benign distance is  tensor(182.9890, device='cuda:3')
norm1 res is  tensor(0.1873, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.19542790949344635
distance x is tensor(159.2621, device='cuda:3')
benign distance is  tensor(159.2621, device='cuda:3')
norm1 res is  tensor(0.1674, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.4566968083381653
distance x is tensor(182.0940, device='cuda:3')
benign distance is  tensor(182.0940, device='cuda:3')
norm1 res is  tensor(0.1891, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.5724395513534546
distance x is tensor(159.9173, device='cuda:3')
benign distance is  tensor(159.9173, device='cuda:3')
norm1 res is  tensor(0.1669, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.15567538142204285
distance x is tensor(166.0051, device='cuda:3')
benign distance is  tensor(166.0051, device='cuda:3')
norm1 res is  tensor(0.1715, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.08371345698833466
distance x is tensor(148.1842, device='cuda:3')
benign distance is  tensor(148.1842, device='cuda:3')
norm1 res is  tensor(0.1587, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5748990178108215
distance x is tensor(146.2961, device='cuda:3')
benign distance is  tensor(146.2961, device='cuda:3')
norm1 res is  tensor(0.1535, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.24362114071846008
distance x is tensor(163.4359, device='cuda:3')
benign distance is  tensor(163.4359, device='cuda:3')
norm1 res is  tensor(0.1708, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.14818009734153748
distance x is tensor(156.6498, device='cuda:3')
benign distance is  tensor(156.6498, device='cuda:3')
norm1 res is  tensor(0.1650, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(138.3085, device='cuda:3')
compute distance is  tensor(138.3085, device='cuda:3')
compute norm is  tensor(75.8967, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.2759, device='cuda:3')
compute distance is  tensor(149.2759, device='cuda:3')
compute norm is  tensor(75.9945, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.1689, device='cuda:3')
compute distance is  tensor(167.1689, device='cuda:3')
compute norm is  tensor(76.4087, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.0233, device='cuda:3')
compute distance is  tensor(143.0233, device='cuda:3')
compute norm is  tensor(75.8272, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.8465, device='cuda:3')
compute distance is  tensor(170.8465, device='cuda:3')
compute norm is  tensor(76.3697, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.2114, device='cuda:3')
compute distance is  tensor(162.2114, device='cuda:3')
compute norm is  tensor(76.2696, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.3446, device='cuda:3')
compute distance is  tensor(150.3446, device='cuda:3')
compute norm is  tensor(76.0384, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.9252, device='cuda:3')
compute distance is  tensor(151.9252, device='cuda:3')
compute norm is  tensor(76.1014, device='cuda:3', dtype=torch.float64)
distance x is tensor(365.6512, device='cuda:3')
compute distance is  tensor(365.6512, device='cuda:3')
compute norm is  tensor(83.7919, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.5760, device='cuda:3')
compute distance is  tensor(160.5760, device='cuda:3')
compute norm is  tensor(76.1867, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.1660, device='cuda:3')
compute distance is  tensor(173.1660, device='cuda:3')
compute norm is  tensor(76.4614, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.1723, device='cuda:3')
compute distance is  tensor(185.1723, device='cuda:3')
compute norm is  tensor(76.6537, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(365.6512, device='cuda:3')
distance x is tensor(107442.9453, device='cuda:3')
distance x is tensor(107442.9453, device='cuda:3')
________________________________
test distance is  tensor(107442.9453, device='cuda:3')
test distance1 is  tensor(107442.9453, device='cuda:3')
test similarity is  tensor(0.6139, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130110568267217.06
test entropy is  0.0
________________________________
cal ratio is  0.05717032136758313
distance x is tensor(6142.5527, device='cuda:3')
cal_distance is  tensor(6142.5527, device='cuda:3')
cal ratio is  0.23910305984656424
distance x is tensor(1468.7073, device='cuda:3')
cal_distance is  tensor(1468.7073, device='cuda:3')
cal ratio is  0.4889809702413237
distance x is tensor(718.1725, device='cuda:3')
cal_distance is  tensor(718.1725, device='cuda:3')
cal ratio is  0.6992704876901186
distance x is tensor(502.1983, device='cuda:3')
cal_distance is  tensor(502.1983, device='cuda:3')
cal ratio is  0.8362227238424847
distance x is tensor(419.9505, device='cuda:3')
cal_distance is  tensor(419.9505, device='cuda:3')
cal ratio is  0.9144512469611749
distance x is tensor(384.0247, device='cuda:3')
cal_distance is  tensor(384.0247, device='cuda:3')
cal ratio is  0.9562688204465303
distance x is tensor(367.2310, device='cuda:3')
cal_distance is  tensor(367.2310, device='cuda:3')
cal ratio is  0.9778897357792479
distance x is tensor(359.1116, device='cuda:3')
cal_distance is  tensor(359.1116, device='cuda:3')
distance x is tensor(359.1116, device='cuda:3')
return_distance is  tensor(359.1116, device='cuda:3')
distance x is tensor(359.1014, device='cuda:3')
distance x is tensor(359.1014, device='cuda:3')
________________________________
test distance is  tensor(359.1014, device='cuda:3')
test distance1 is  tensor(359.1014, device='cuda:3')
test similarity is  tensor(0.9572, device='cuda:3')
test acc is  0.10035000015633198
test loss is 3604.4736250041647
test entropy is  9.031058680043219e-05
________________________________
0
distance x is tensor(359.1014, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.664940727295984e-05
avg test loss is  3619.857204282716
avg accuracy is  0.30850000015633966
solo acc is  0.10025000015633197
compute similarity  is  tensor(0.9572, device='cuda:3')
compute_distance is  tensor(359.1014, device='cuda:3')
compute_norm is  tensor(91.2462, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(293481.3438, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5270930875593156
avg test loss is  2.904953747924203
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0956, device='cuda:3')
compute_distance is  tensor(293481.3438, device='cuda:3')
compute_norm is  tensor(19909.7563, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(292109.7188, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8547592921806043
avg test loss is  3.629044996904158
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0956, device='cuda:3')
compute_distance is  tensor(292109.7188, device='cuda:3')
compute_norm is  tensor(19816.6660, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(290744.6562, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.544877386677748
avg test loss is  2.879351911768476
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0956, device='cuda:3')
compute_distance is  tensor(290744.6562, device='cuda:3')
compute_norm is  tensor(19723.8100, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(289385.8750, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8617288855982742
avg test loss is  3.6134980332368474
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0956, device='cuda:3')
compute_distance is  tensor(289385.8750, device='cuda:3')
compute_norm is  tensor(19631.6208, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(288033.5312, device='cuda:3')
distance x is tensor(288033.5312, device='cuda:3')
________________________________
test distance is  tensor(288033.5312, device='cuda:3')
test distance1 is  tensor(288033.5312, device='cuda:3')
test similarity is  tensor(-0.0956, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8710003404983326
test entropy is  1.5499564346982473
________________________________
cal ratio is  0.03491709206977186
distance x is tensor(10057.2920, device='cuda:3')
cal_distance is  tensor(10057.2920, device='cuda:3')
cal ratio is  0.1868611652976865
distance x is tensor(1879.3152, device='cuda:3')
cal_distance is  tensor(1879.3152, device='cuda:3')
cal ratio is  0.43227466201505377
distance x is tensor(812.3790, device='cuda:3')
cal_distance is  tensor(812.3790, device='cuda:3')
cal ratio is  0.6574765072277055
distance x is tensor(534.1195, device='cuda:3')
cal_distance is  tensor(534.1195, device='cuda:3')
cal ratio is  0.81084970373099
distance x is tensor(433.0904, device='cuda:3')
cal_distance is  tensor(433.0904, device='cuda:3')
cal ratio is  0.9004722301118698
distance x is tensor(389.9856, device='cuda:3')
cal_distance is  tensor(389.9856, device='cuda:3')
cal ratio is  0.9489324085631904
distance x is tensor(370.0700, device='cuda:3')
cal_distance is  tensor(370.0700, device='cuda:3')
cal ratio is  0.9741316534172721
distance x is tensor(360.4968, device='cuda:3')
cal_distance is  tensor(360.4968, device='cuda:3')
distance x is tensor(360.4968, device='cuda:3')
return_distance is  tensor(360.4968, device='cuda:3')
distance x is tensor(360.5023, device='cuda:3')
distance x is tensor(360.5023, device='cuda:3')
________________________________
test distance is  tensor(360.5023, device='cuda:3')
test distance1 is  tensor(360.5023, device='cuda:3')
test similarity is  tensor(0.9361, device='cuda:3')
test acc is  0.17483333348966837
test loss is 4.53357709089576
test entropy is  0.8160646719210691
________________________________
0
distance x is tensor(360.5023, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8179781548122862
avg test loss is  4.525777228097163
avg accuracy is  0.14135000015633237
solo acc is  0.1729333334896682
compute similarity  is  tensor(0.9361, device='cuda:3')
compute_distance is  tensor(360.5023, device='cuda:3')
compute_norm is  tensor(81.3593, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(366.9114, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0913814067967664
avg test loss is  1.7500348767237877
avg accuracy is  0.1678166668230011
solo acc is  0.20868333348967008
compute similarity  is  tensor(0.9360, device='cuda:3')
compute_distance is  tensor(366.9114, device='cuda:3')
compute_norm is  tensor(80.9076, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(367.8342, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6012874042936988
avg test loss is  2.43263557114835
avg accuracy is  0.14355000015633262
solo acc is  0.11355000015633193
compute similarity  is  tensor(0.9359, device='cuda:3')
compute_distance is  tensor(367.8342, device='cuda:3')
compute_norm is  tensor(80.5594, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(369.0790, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9791382106382456
avg test loss is  1.5195412202430432
avg accuracy is  0.17255000015633487
solo acc is  0.24328333348967135
compute similarity  is  tensor(0.9359, device='cuda:3')
compute_distance is  tensor(369.0790, device='cuda:3')
compute_norm is  tensor(80.1468, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(369.0790, device='cuda:3')
distance x is tensor(369.0790, device='cuda:3')
________________________________
test distance is  tensor(369.0790, device='cuda:3')
test distance1 is  tensor(369.0790, device='cuda:3')
test similarity is  tensor(0.9359, device='cuda:3')
test acc is  0.24165000015633797
test loss is 1.523137193625924
test entropy is  0.97528093888053
________________________________
cal ratio is  0.9754384912884339
distance x is tensor(360.0064, device='cuda:3')
cal_distance is  tensor(360.0064, device='cuda:3')
distance x is tensor(360.0064, device='cuda:3')
return_distance is  tensor(360.0064, device='cuda:3')
distance x is tensor(360.0140, device='cuda:3')
distance x is tensor(360.0140, device='cuda:3')
________________________________
test distance is  tensor(360.0140, device='cuda:3')
test distance1 is  tensor(360.0140, device='cuda:3')
test similarity is  tensor(0.9388, device='cuda:3')
test acc is  0.2728666668230055
test loss is 1.4990104549983416
test entropy is  0.934896986558239
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3565311431884766
mal norm is  tensor(1300.2250, device='cuda:3')
distance x is tensor(360.0064, device='cuda:3')
mal distance is  tensor(360.0064, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(30.2698, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.2257, device='cuda:3')
user_param_square tensor(140.8315, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(153.7576, device='cuda:3')
score : tensor(1.5075, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.7699, device='cuda:3')
user_param_square tensor(144.6010, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(154.1399, device='cuda:3')
score : tensor(1.5113, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.2545, device='cuda:3')
user_param_square tensor(140.2963, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(159.4896, device='cuda:3')
score : tensor(1.5648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.4844, device='cuda:3')
user_param_square tensor(133.5798, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(156.2552, device='cuda:3')
score : tensor(1.5325, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.5418, device='cuda:3')
user_param_square tensor(139.7870, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(174.0702, device='cuda:3')
score : tensor(1.7106, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.5645, device='cuda:3')
user_param_square tensor(146.5549, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(87.0331, device='cuda:3')
score : tensor(0.8403, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.0823, device='cuda:3')
user_param_square tensor(134.3252, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(235.5807, device='cuda:3')
score : tensor(2.3257, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.4772, device='cuda:3')
user_param_square tensor(149.6122, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(98.9074, device='cuda:3')
score : tensor(0.9590, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1300.2250, device='cuda:3')
user_param_square tensor(198.3873, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(-805.1483, device='cuda:3')
score : tensor(-8.0816, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.2601, device='cuda:3')
user_param_square tensor(144.2331, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(233.0767, device='cuda:3')
score : tensor(2.3007, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.0140, device='cuda:3')
user_param_square tensor(142.6243, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(240.5433, device='cuda:3')
score : tensor(2.3754, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.6702, device='cuda:3')
user_param_square tensor(137.9482, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(225.6131, device='cuda:3')
score : tensor(2.2261, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.6580, device='cuda:3')
user_param_square tensor(146.8741, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(228.1693, device='cuda:3')
score : tensor(2.2516, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(740.9850, device='cuda:3')
user_param_square tensor(149.7646, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(119.6327, device='cuda:3')
score : tensor(1.1663, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.4769, device='cuda:3')
user_param_square tensor(145.8211, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(218.5035, device='cuda:3')
score : tensor(2.1550, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.6183, device='cuda:3')
user_param_square tensor(144.0607, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(86.5500, device='cuda:3')
score : tensor(0.8354, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6768, device='cuda:3')
user_param_square tensor(142.9066, device='cuda:3')
global_param_square tensor(30.2698, device='cuda:3')
part1 is  tensor(175.9061, device='cuda:3')
score : tensor(1.7290, device='cuda:3')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 94 global rounds:
Train Accuracy: 89.51% 

Test Accuracy: 88.94% 


 | Global Training Round : 95 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6457157135009766
distance x is tensor(131.1898, device='cuda:3')
benign distance is  tensor(131.1898, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4056550860404968
distance x is tensor(121.9392, device='cuda:3')
benign distance is  tensor(121.9392, device='cuda:3')
norm1 res is  tensor(0.1326, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.251029908657074
distance x is tensor(131.4424, device='cuda:3')
benign distance is  tensor(131.4424, device='cuda:3')
norm1 res is  tensor(0.1409, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3828631043434143
distance x is tensor(124.1930, device='cuda:3')
benign distance is  tensor(124.1930, device='cuda:3')
norm1 res is  tensor(0.1317, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.8948431015014648
distance x is tensor(113.3025, device='cuda:3')
benign distance is  tensor(113.3025, device='cuda:3')
norm1 res is  tensor(0.1194, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.1414717733860016
distance x is tensor(141.2700, device='cuda:3')
benign distance is  tensor(141.2700, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.30834415555000305
distance x is tensor(125.4526, device='cuda:3')
benign distance is  tensor(125.4526, device='cuda:3')
norm1 res is  tensor(0.1356, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.8501108884811401
distance x is tensor(126.6815, device='cuda:3')
benign distance is  tensor(126.6815, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3416074812412262
distance x is tensor(128.6024, device='cuda:3')
benign distance is  tensor(128.6024, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.23965272307395935
distance x is tensor(132.4913, device='cuda:3')
benign distance is  tensor(132.4913, device='cuda:3')
norm1 res is  tensor(0.1403, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.5548785328865051
distance x is tensor(136.4284, device='cuda:3')
benign distance is  tensor(136.4284, device='cuda:3')
norm1 res is  tensor(0.1494, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.3807133436203003
distance x is tensor(127.6592, device='cuda:3')
benign distance is  tensor(127.6592, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  1.2542178630828857
distance x is tensor(152.4627, device='cuda:3')
benign distance is  tensor(152.4627, device='cuda:3')
norm1 res is  tensor(0.1623, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.18514613807201385
distance x is tensor(152.2484, device='cuda:3')
benign distance is  tensor(152.2484, device='cuda:3')
norm1 res is  tensor(0.1625, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.19531330466270447
distance x is tensor(131.8447, device='cuda:3')
benign distance is  tensor(131.8447, device='cuda:3')
norm1 res is  tensor(0.1432, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.9844676852226257
distance x is tensor(132.2748, device='cuda:3')
benign distance is  tensor(132.2748, device='cuda:3')
norm1 res is  tensor(0.1419, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(149.0474, device='cuda:3')
compute distance is  tensor(149.0474, device='cuda:3')
compute norm is  tensor(75.4551, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5119, device='cuda:3')
compute distance is  tensor(133.5119, device='cuda:3')
compute norm is  tensor(75.2730, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.3887, device='cuda:3')
compute distance is  tensor(135.3887, device='cuda:3')
compute norm is  tensor(75.2784, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.0224, device='cuda:3')
compute distance is  tensor(152.0224, device='cuda:3')
compute norm is  tensor(75.6426, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.0917, device='cuda:3')
compute distance is  tensor(149.0917, device='cuda:3')
compute norm is  tensor(75.6030, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0496, device='cuda:3')
compute distance is  tensor(144.0496, device='cuda:3')
compute norm is  tensor(75.4222, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3714, device='cuda:3')
compute distance is  tensor(129.3714, device='cuda:3')
compute norm is  tensor(75.1069, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.8600, device='cuda:3')
compute distance is  tensor(145.8600, device='cuda:3')
compute norm is  tensor(75.3744, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.2711, device='cuda:3')
compute distance is  tensor(151.2711, device='cuda:3')
compute norm is  tensor(75.4271, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6526, device='cuda:3')
compute distance is  tensor(139.6526, device='cuda:3')
compute norm is  tensor(75.3695, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3360, device='cuda:3')
compute distance is  tensor(138.3360, device='cuda:3')
compute norm is  tensor(75.3183, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.1787, device='cuda:3')
compute distance is  tensor(144.1787, device='cuda:3')
compute norm is  tensor(75.4131, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(152.0224, device='cuda:3')
distance x is tensor(107481.7578, device='cuda:3')
distance x is tensor(107481.7578, device='cuda:3')
________________________________
test distance is  tensor(107481.7578, device='cuda:3')
test distance1 is  tensor(107481.7578, device='cuda:3')
test similarity is  tensor(0.5756, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130015729678986.64
test entropy is  0.0
________________________________
cal ratio is  0.03685635997807013
distance x is tensor(3961.3926, device='cuda:3')
cal_distance is  tensor(3961.3926, device='cuda:3')
cal ratio is  0.1919799547654457
distance x is tensor(760.5121, device='cuda:3')
cal_distance is  tensor(760.5121, device='cuda:3')
cal ratio is  0.438153979129401
distance x is tensor(333.2243, device='cuda:3')
cal_distance is  tensor(333.2243, device='cuda:3')
cal ratio is  0.6619291480521421
distance x is tensor(220.5726, device='cuda:3')
cal_distance is  tensor(220.5726, device='cuda:3')
cal ratio is  0.8135871061724508
distance x is tensor(179.4559, device='cuda:3')
cal_distance is  tensor(179.4559, device='cuda:3')
cal ratio is  0.9019882766132006
distance x is tensor(161.8677, device='cuda:3')
cal_distance is  tensor(161.8677, device='cuda:3')
cal ratio is  0.9497291175231467
distance x is tensor(153.7307, device='cuda:3')
cal_distance is  tensor(153.7307, device='cuda:3')
cal ratio is  0.9745396869949257
distance x is tensor(149.8168, device='cuda:3')
cal_distance is  tensor(149.8168, device='cuda:3')
distance x is tensor(149.8168, device='cuda:3')
return_distance is  tensor(149.8168, device='cuda:3')
distance x is tensor(149.8066, device='cuda:3')
distance x is tensor(149.8066, device='cuda:3')
________________________________
test distance is  tensor(149.8066, device='cuda:3')
test distance1 is  tensor(149.8066, device='cuda:3')
test similarity is  tensor(0.9882, device='cuda:3')
test acc is  0.44303333348967494
test loss is 19.204115271822477
test entropy is  0.07699969630819489
________________________________
0
distance x is tensor(149.8066, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.07622757357513425
avg test loss is  19.203585913440566
avg accuracy is  0.8909500001563215
solo acc is  0.4424166668230082
compute similarity  is  tensor(0.9882, device='cuda:3')
compute_distance is  tensor(149.8066, device='cuda:3')
compute_norm is  tensor(79.9541, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(146.6749, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9036402017322939
avg test loss is  1.3379940236809411
avg accuracy is  0.8163333334896579
solo acc is  0.30805000015633965
compute similarity  is  tensor(0.9881, device='cuda:3')
compute_distance is  tensor(146.6749, device='cuda:3')
compute_norm is  tensor(79.3816, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.8385, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8638194866780279
avg test loss is  1.415538644739814
avg accuracy is  0.8121000001563248
solo acc is  0.25313333348967176
compute similarity  is  tensor(0.9880, device='cuda:3')
compute_distance is  tensor(146.8385, device='cuda:3')
compute_norm is  tensor(78.9828, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.8551, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8590294342559538
avg test loss is  1.388952963514877
avg accuracy is  0.8089666668229916
solo acc is  0.25363333348967165
compute similarity  is  tensor(0.9879, device='cuda:3')
compute_distance is  tensor(146.8551, device='cuda:3')
compute_norm is  tensor(78.5914, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.9086, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8473064665601198
avg test loss is  1.3799108274455771
avg accuracy is  0.8140666668229913
solo acc is  0.24718333348967153
compute similarity  is  tensor(0.9878, device='cuda:3')
compute_distance is  tensor(146.9086, device='cuda:3')
compute_norm is  tensor(78.2035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.0046, device='cuda:3')
distance x is tensor(147.0046, device='cuda:3')
________________________________
test distance is  tensor(147.0046, device='cuda:3')
test distance1 is  tensor(147.0046, device='cuda:3')
test similarity is  tensor(0.9877, device='cuda:3')
test acc is  0.2453500001563381
test loss is 1.3601141645710098
test entropy is  0.8494455621186604
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.0734591484069824
mal norm is  tensor(706.5101, device='cuda:3')
distance x is tensor(147.0134, device='cuda:3')
mal distance is  tensor(147.0134, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(14.7806, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.3808, device='cuda:3')
user_param_square tensor(90.3578, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(-16.3000, device='cuda:3')
score : tensor(-0.1776, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.0657, device='cuda:3')
user_param_square tensor(88.0115, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(9.0428, device='cuda:3')
score : tensor(0.0758, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.7231, device='cuda:3')
user_param_square tensor(88.7354, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(2.1826, device='cuda:3')
score : tensor(0.0072, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(516.6929, device='cuda:3')
user_param_square tensor(87.3902, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(-11.8225, device='cuda:3')
score : tensor(-0.1328, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.7242, device='cuda:3')
user_param_square tensor(83.4122, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(-28.9312, device='cuda:3')
score : tensor(-0.3039, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.2926, device='cuda:3')
user_param_square tensor(94.1165, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(-9.7463, device='cuda:3')
score : tensor(-0.1120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.2208, device='cuda:3')
user_param_square tensor(87.7723, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(28.4328, device='cuda:3')
score : tensor(0.2697, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(538.3615, device='cuda:3')
user_param_square tensor(89.2038, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(-17.9955, device='cuda:3')
score : tensor(-0.1945, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5101, device='cuda:3')
user_param_square tensor(102.1893, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(17.3472, device='cuda:3')
score : tensor(0.1589, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.3873, device='cuda:3')
user_param_square tensor(96.3740, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(23.5534, device='cuda:3')
score : tensor(0.2210, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.0353, device='cuda:3')
user_param_square tensor(98.5464, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(25.9456, device='cuda:3')
score : tensor(0.2449, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4551, device='cuda:3')
user_param_square tensor(103.2645, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(-10.8705, device='cuda:3')
score : tensor(-0.1233, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.4590, device='cuda:3')
user_param_square tensor(98.2778, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(19.7624, device='cuda:3')
score : tensor(0.1830, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.6971, device='cuda:3')
user_param_square tensor(99.9361, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(20.9514, device='cuda:3')
score : tensor(0.1949, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.6617, device='cuda:3')
user_param_square tensor(100.1551, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(29.9260, device='cuda:3')
score : tensor(0.2847, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3173, device='cuda:3')
user_param_square tensor(99.2400, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(-9.3882, device='cuda:3')
score : tensor(-0.1085, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.2965, device='cuda:3')
user_param_square tensor(97.8888, device='cuda:3')
global_param_square tensor(14.7806, device='cuda:3')
part1 is  tensor(27.9913, device='cuda:3')
score : tensor(0.2653, device='cuda:3')
accept
len accept list 21
len all weights is 21
 
Avg Training Stats after 95 global rounds:
Train Accuracy: 87.84% 

Test Accuracy: 86.87% 


 | Global Training Round : 96 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2592635750770569
distance x is tensor(137.0630, device='cuda:3')
benign distance is  tensor(137.0630, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5221984386444092
distance x is tensor(146.2550, device='cuda:3')
benign distance is  tensor(146.2550, device='cuda:3')
norm1 res is  tensor(0.1593, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.30131208896636963
distance x is tensor(161.3508, device='cuda:3')
benign distance is  tensor(161.3508, device='cuda:3')
norm1 res is  tensor(0.1628, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.544171154499054
distance x is tensor(143.2313, device='cuda:3')
benign distance is  tensor(143.2313, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.38539937138557434
distance x is tensor(175.1038, device='cuda:3')
benign distance is  tensor(175.1038, device='cuda:3')
norm1 res is  tensor(0.1769, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3368050456047058
distance x is tensor(163.7345, device='cuda:3')
benign distance is  tensor(163.7345, device='cuda:3')
norm1 res is  tensor(0.1692, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2488926649093628
distance x is tensor(123.9330, device='cuda:3')
benign distance is  tensor(123.9330, device='cuda:3')
norm1 res is  tensor(0.1294, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.6733155250549316
distance x is tensor(156.8625, device='cuda:3')
benign distance is  tensor(156.8625, device='cuda:3')
norm1 res is  tensor(0.1653, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.5577864646911621
distance x is tensor(151.9926, device='cuda:3')
benign distance is  tensor(151.9926, device='cuda:3')
norm1 res is  tensor(0.1589, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.0656982809305191
distance x is tensor(202.1255, device='cuda:3')
benign distance is  tensor(202.1255, device='cuda:3')
norm1 res is  tensor(0.2079, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.47227588295936584
distance x is tensor(148.6692, device='cuda:3')
benign distance is  tensor(148.6692, device='cuda:3')
norm1 res is  tensor(0.1572, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.3693176209926605
distance x is tensor(150.1374, device='cuda:3')
benign distance is  tensor(150.1374, device='cuda:3')
norm1 res is  tensor(0.1598, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.16204571723937988
distance x is tensor(149.6025, device='cuda:3')
benign distance is  tensor(149.6025, device='cuda:3')
norm1 res is  tensor(0.1563, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.5176804661750793
distance x is tensor(155.3916, device='cuda:3')
benign distance is  tensor(155.3916, device='cuda:3')
norm1 res is  tensor(0.1557, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.3817058205604553
distance x is tensor(140.8125, device='cuda:3')
benign distance is  tensor(140.8125, device='cuda:3')
norm1 res is  tensor(0.1492, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.28594860434532166
distance x is tensor(143.9101, device='cuda:3')
benign distance is  tensor(143.9101, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(146.3065, device='cuda:3')
compute distance is  tensor(146.3065, device='cuda:3')
compute norm is  tensor(76.4032, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.4226, device='cuda:3')
compute distance is  tensor(175.4226, device='cuda:3')
compute norm is  tensor(76.8172, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.1458, device='cuda:3')
compute distance is  tensor(156.1458, device='cuda:3')
compute norm is  tensor(76.5661, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1299, device='cuda:3')
compute distance is  tensor(141.1299, device='cuda:3')
compute norm is  tensor(76.2514, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.5148, device='cuda:3')
compute distance is  tensor(167.5148, device='cuda:3')
compute norm is  tensor(76.6921, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.5587, device='cuda:3')
compute distance is  tensor(155.5587, device='cuda:3')
compute norm is  tensor(76.5880, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.1383, device='cuda:3')
compute distance is  tensor(146.1383, device='cuda:3')
compute norm is  tensor(76.5003, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9093, device='cuda:3')
compute distance is  tensor(132.9093, device='cuda:3')
compute norm is  tensor(76.2216, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.2265, device='cuda:3')
compute distance is  tensor(168.2265, device='cuda:3')
compute norm is  tensor(76.5714, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6164, device='cuda:3')
compute distance is  tensor(146.6164, device='cuda:3')
compute norm is  tensor(76.3456, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.2571, device='cuda:3')
compute distance is  tensor(156.2571, device='cuda:3')
compute norm is  tensor(76.5818, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.3174, device='cuda:3')
compute distance is  tensor(135.3174, device='cuda:3')
compute norm is  tensor(76.2957, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(175.4226, device='cuda:3')
distance x is tensor(107436.5703, device='cuda:3')
distance x is tensor(107436.5703, device='cuda:3')
________________________________
test distance is  tensor(107436.5703, device='cuda:3')
test distance1 is  tensor(107436.5703, device='cuda:3')
test similarity is  tensor(0.6206, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130056434200934.08
test entropy is  0.0
________________________________
cal ratio is  0.039599779682522276
distance x is tensor(4254.4697, device='cuda:3')
cal_distance is  tensor(4254.4697, device='cuda:3')
cal ratio is  0.1989968154816561
distance x is tensor(846.6301, device='cuda:3')
cal_distance is  tensor(846.6301, device='cuda:3')
cal ratio is  0.44608948649090985
distance x is tensor(377.6756, device='cuda:3')
cal_distance is  tensor(377.6756, device='cuda:3')
cal ratio is  0.6678967866201729
distance x is tensor(252.2500, device='cuda:3')
cal_distance is  tensor(252.2500, device='cuda:3')
cal ratio is  0.8172467971061008
distance x is tensor(206.1515, device='cuda:3')
cal_distance is  tensor(206.1515, device='cuda:3')
cal ratio is  0.9040149937848422
distance x is tensor(186.3645, device='cuda:3')
cal_distance is  tensor(186.3645, device='cuda:3')
cal ratio is  0.9507957662384825
distance x is tensor(177.1948, device='cuda:3')
cal_distance is  tensor(177.1948, device='cuda:3')
cal ratio is  0.9750868711651616
distance x is tensor(172.7805, device='cuda:3')
cal_distance is  tensor(172.7805, device='cuda:3')
distance x is tensor(172.7805, device='cuda:3')
return_distance is  tensor(172.7805, device='cuda:3')
distance x is tensor(172.7703, device='cuda:3')
distance x is tensor(172.7703, device='cuda:3')
________________________________
test distance is  tensor(172.7703, device='cuda:3')
test distance1 is  tensor(172.7703, device='cuda:3')
test similarity is  tensor(0.9870, device='cuda:3')
test acc is  0.10025000015633198
test loss is 216.74912517360534
test entropy is  9.279819569809427e-05
________________________________
0
distance x is tensor(172.7703, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0001957990493415712
avg test loss is  216.4289815776638
avg accuracy is  0.7161500001563297
solo acc is  0.10026666682299865
compute similarity  is  tensor(0.9870, device='cuda:3')
compute_distance is  tensor(172.7703, device='cuda:3')
compute_norm is  tensor(82.2621, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.5367, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0613946207423708
avg test loss is  1.593994068184387
avg accuracy is  0.4803333334896752
solo acc is  0.23176666682300429
compute similarity  is  tensor(0.9860, device='cuda:3')
compute_distance is  tensor(177.5367, device='cuda:3')
compute_norm is  tensor(82.8526, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(177.4230, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.638408100172909
avg test loss is  2.51270399126671
avg accuracy is  0.3069000001563396
solo acc is  0.10676666682299862
compute similarity  is  tensor(0.9860, device='cuda:3')
compute_distance is  tensor(177.4230, device='cuda:3')
compute_norm is  tensor(82.5133, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.5707, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9870476017374474
avg test loss is  1.4423806033154796
avg accuracy is  0.4915666668230087
solo acc is  0.26858333348967217
compute similarity  is  tensor(0.9861, device='cuda:3')
compute_distance is  tensor(176.5707, device='cuda:3')
compute_norm is  tensor(82.1333, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(176.5707, device='cuda:3')
distance x is tensor(176.5707, device='cuda:3')
________________________________
test distance is  tensor(176.5707, device='cuda:3')
test distance1 is  tensor(176.5707, device='cuda:3')
test similarity is  tensor(0.9861, device='cuda:3')
test acc is  0.2690833334896721
test loss is 1.443691291661659
test entropy is  0.986510297319274
________________________________
cal ratio is  0.9768087205105286
distance x is tensor(172.4848, device='cuda:3')
cal_distance is  tensor(172.4848, device='cuda:3')
distance x is tensor(172.4848, device='cuda:3')
return_distance is  tensor(172.4848, device='cuda:3')
distance x is tensor(172.4757, device='cuda:3')
distance x is tensor(172.4757, device='cuda:3')
________________________________
test distance is  tensor(172.4757, device='cuda:3')
test distance1 is  tensor(172.4757, device='cuda:3')
test similarity is  tensor(0.9866, device='cuda:3')
test acc is  0.27565000015633895
test loss is 1.429506837559153
test entropy is  1.000723946513906
________________________________
0
distance x is tensor(172.4757, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0005172306159411
avg test loss is  1.4275801983723508
avg accuracy is  0.5044666668230088
solo acc is  0.2734500001563389
compute similarity  is  tensor(0.9866, device='cuda:3')
compute_distance is  tensor(172.4757, device='cuda:3')
compute_norm is  tensor(81.9399, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(172.3767, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.630926078252955
avg test loss is  2.3968484012811166
avg accuracy is  0.30501666682300627
solo acc is  0.10515000015633195
compute similarity  is  tensor(0.9866, device='cuda:3')
compute_distance is  tensor(172.3767, device='cuda:3')
compute_norm is  tensor(81.5995, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(171.7918, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9637851843447574
avg test loss is  1.403063969063098
avg accuracy is  0.4888333334896753
solo acc is  0.2654166668230053
compute similarity  is  tensor(0.9866, device='cuda:3')
compute_distance is  tensor(171.7918, device='cuda:3')
compute_norm is  tensor(81.2170, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(171.7918, device='cuda:3')
distance x is tensor(171.7918, device='cuda:3')
________________________________
test distance is  tensor(171.7918, device='cuda:3')
test distance1 is  tensor(171.7918, device='cuda:3')
test similarity is  tensor(0.9866, device='cuda:3')
test acc is  0.26303333348967184
test loss is 1.4072166650788362
test entropy is  0.9629595257453064
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4314301013946533
mal norm is  tensor(815.0968, device='cuda:3')
distance x is tensor(171.8009, device='cuda:3')
mal distance is  tensor(171.8009, device='cuda:3')
len current grad  20
len all grad 52
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(22.8641, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.3955, device='cuda:3')
user_param_square tensor(115.6916, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(57.5636, device='cuda:3')
score : tensor(0.5530, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.3258, device='cuda:3')
user_param_square tensor(117.3526, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(97.7906, device='cuda:3')
score : tensor(0.9552, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.2056, device='cuda:3')
user_param_square tensor(121.4580, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(124.4171, device='cuda:3')
score : tensor(1.2215, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.0269, device='cuda:3')
user_param_square tensor(112.9548, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(151.2135, device='cuda:3')
score : tensor(1.4895, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.6984, device='cuda:3')
user_param_square tensor(124.8456, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(84.8987, device='cuda:3')
score : tensor(0.8263, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.1457, device='cuda:3')
user_param_square tensor(123.7832, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(89.5757, device='cuda:3')
score : tensor(0.8731, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.0877, device='cuda:3')
user_param_square tensor(108.0997, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(146.9901, device='cuda:3')
score : tensor(1.4472, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.1435, device='cuda:3')
user_param_square tensor(121.5462, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-3.4608, device='cuda:3')
score : tensor(-0.0573, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0968, device='cuda:3')
user_param_square tensor(136.5154, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(-279.8471, device='cuda:3')
score : tensor(-2.8211, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(814.7132, device='cuda:3')
user_param_square tensor(136.4832, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(126.9243, device='cuda:3')
score : tensor(1.2466, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(802.5601, device='cuda:3')
user_param_square tensor(135.4615, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(125.7595, device='cuda:3')
score : tensor(1.2349, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.4619, device='cuda:3')
user_param_square tensor(135.9586, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(170.1332, device='cuda:3')
score : tensor(1.6787, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(838.9748, device='cuda:3')
user_param_square tensor(138.5005, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(118.9355, device='cuda:3')
score : tensor(1.1667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(827.8417, device='cuda:3')
user_param_square tensor(137.5785, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(127.1614, device='cuda:3')
score : tensor(1.2490, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(816.1227, device='cuda:3')
user_param_square tensor(136.6013, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(94.2522, device='cuda:3')
score : tensor(0.9199, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(852.0374, device='cuda:3')
user_param_square tensor(139.5746, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(76.2563, device='cuda:3')
score : tensor(0.7399, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.6181, device='cuda:3')
user_param_square tensor(136.9770, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(144.0235, device='cuda:3')
score : tensor(1.4176, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.2745, device='cuda:3')
user_param_square tensor(126.9861, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(76.2229, device='cuda:3')
score : tensor(0.7396, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.8499, device='cuda:3')
user_param_square tensor(125.4076, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(120.7600, device='cuda:3')
score : tensor(1.1849, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.2750, device='cuda:3')
user_param_square tensor(131.5842, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(97.4015, device='cuda:3')
score : tensor(0.9514, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.5767, device='cuda:3')
user_param_square tensor(128.8008, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(130.5967, device='cuda:3')
score : tensor(1.2833, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.8972, device='cuda:3')
user_param_square tensor(131.0289, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(108.3248, device='cuda:3')
score : tensor(1.0606, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.5363, device='cuda:3')
user_param_square tensor(129.0632, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(162.1847, device='cuda:3')
score : tensor(1.5992, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.3602, device='cuda:3')
user_param_square tensor(131.6785, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(109.3998, device='cuda:3')
score : tensor(1.0713, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.4819, device='cuda:3')
user_param_square tensor(128.3478, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(161.0778, device='cuda:3')
score : tensor(1.5881, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.6013, device='cuda:3')
user_param_square tensor(124.2860, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(86.8759, device='cuda:3')
score : tensor(0.8461, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(752.9596, device='cuda:3')
user_param_square tensor(131.2087, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(49.1244, device='cuda:3')
score : tensor(0.4686, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.7358, device='cuda:3')
user_param_square tensor(123.5604, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(82.7878, device='cuda:3')
score : tensor(0.8052, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.4305, device='cuda:3')
user_param_square tensor(124.6377, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(190.3269, device='cuda:3')
score : tensor(1.8806, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.3847, device='cuda:3')
user_param_square tensor(120.3402, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(120.0043, device='cuda:3')
score : tensor(1.1774, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.9014, device='cuda:3')
user_param_square tensor(118.8602, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(80.2752, device='cuda:3')
score : tensor(0.7801, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.0796, device='cuda:3')
user_param_square tensor(124.6972, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(148.0230, device='cuda:3')
score : tensor(1.4576, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.3111, device='cuda:3')
user_param_square tensor(122.4054, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(97.1220, device='cuda:3')
score : tensor(0.9486, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.6656, device='cuda:3')
user_param_square tensor(118.4521, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(115.3385, device='cuda:3')
score : tensor(1.1307, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.0792, device='cuda:3')
user_param_square tensor(120.1210, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(173.6109, device='cuda:3')
score : tensor(1.7134, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.8525, device='cuda:3')
user_param_square tensor(122.1756, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(86.8731, device='cuda:3')
score : tensor(0.8461, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7871, device='cuda:3')
user_param_square tensor(119.1374, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(126.1898, device='cuda:3')
score : tensor(1.2392, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.8052, device='cuda:3')
user_param_square tensor(125.6767, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(31.4719, device='cuda:3')
score : tensor(0.2921, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.2968, device='cuda:3')
user_param_square tensor(127.7062, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(118.8658, device='cuda:3')
score : tensor(1.1660, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.4940, device='cuda:3')
user_param_square tensor(121.0137, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(86.1732, device='cuda:3')
score : tensor(0.8391, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.0018, device='cuda:3')
user_param_square tensor(120.0184, device='cuda:3')
global_param_square tensor(22.8641, device='cuda:3')
part1 is  tensor(84.6614, device='cuda:3')
score : tensor(0.8239, device='cuda:3')
accept
len accept list 39
len all weights is 39
 
Avg Training Stats after 96 global rounds:
Train Accuracy: 89.83% 

Test Accuracy: 89.07% 


 | Global Training Round : 97 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6162623167037964
distance x is tensor(115.9473, device='cuda:3')
benign distance is  tensor(115.9473, device='cuda:3')
norm1 res is  tensor(0.1291, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.0633201599121094
distance x is tensor(131.4492, device='cuda:3')
benign distance is  tensor(131.4492, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.24149155616760254
distance x is tensor(112.6102, device='cuda:3')
benign distance is  tensor(112.6102, device='cuda:3')
norm1 res is  tensor(0.1224, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3361697494983673
distance x is tensor(108.7440, device='cuda:3')
benign distance is  tensor(108.7440, device='cuda:3')
norm1 res is  tensor(0.1156, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.42290157079696655
distance x is tensor(115.1624, device='cuda:3')
benign distance is  tensor(115.1624, device='cuda:3')
norm1 res is  tensor(0.1240, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.9852740168571472
distance x is tensor(111.6945, device='cuda:3')
benign distance is  tensor(111.6945, device='cuda:3')
norm1 res is  tensor(0.1210, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  1.6579058170318604
distance x is tensor(244.6330, device='cuda:3')
benign distance is  tensor(244.6330, device='cuda:3')
norm1 res is  tensor(0.2378, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2634846568107605
distance x is tensor(121.6550, device='cuda:3')
benign distance is  tensor(121.6550, device='cuda:3')
norm1 res is  tensor(0.1325, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.07409457862377167
distance x is tensor(122.5004, device='cuda:3')
benign distance is  tensor(122.5004, device='cuda:3')
norm1 res is  tensor(0.1316, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.5523934960365295
distance x is tensor(133.2280, device='cuda:3')
benign distance is  tensor(133.2280, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.6967758536338806
distance x is tensor(116.4266, device='cuda:3')
benign distance is  tensor(116.4266, device='cuda:3')
norm1 res is  tensor(0.1257, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.7041303515434265
distance x is tensor(149.9943, device='cuda:3')
benign distance is  tensor(149.9943, device='cuda:3')
norm1 res is  tensor(0.1590, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.825517475605011
distance x is tensor(124.7555, device='cuda:3')
benign distance is  tensor(124.7555, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.26375073194503784
distance x is tensor(132.7003, device='cuda:3')
benign distance is  tensor(132.7003, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.26997336745262146
distance x is tensor(128.2212, device='cuda:3')
benign distance is  tensor(128.2212, device='cuda:3')
norm1 res is  tensor(0.1402, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.7830067873001099
distance x is tensor(127.0710, device='cuda:3')
benign distance is  tensor(127.0710, device='cuda:3')
norm1 res is  tensor(0.1379, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.4515322744846344
distance x is tensor(121.8664, device='cuda:3')
benign distance is  tensor(121.8664, device='cuda:3')
norm1 res is  tensor(0.1312, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.5330923199653625
distance x is tensor(133.7680, device='cuda:3')
benign distance is  tensor(133.7680, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.7282012104988098
distance x is tensor(123.7144, device='cuda:3')
benign distance is  tensor(123.7144, device='cuda:3')
norm1 res is  tensor(0.1409, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.12212364375591278
distance x is tensor(137.7985, device='cuda:3')
benign distance is  tensor(137.7985, device='cuda:3')
norm1 res is  tensor(0.1522, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.3519746661186218
distance x is tensor(140.6102, device='cuda:3')
benign distance is  tensor(140.6102, device='cuda:3')
norm1 res is  tensor(0.1476, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.7485392689704895
distance x is tensor(127.3114, device='cuda:3')
benign distance is  tensor(127.3114, device='cuda:3')
norm1 res is  tensor(0.1367, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.3493642807006836
distance x is tensor(143.2798, device='cuda:3')
benign distance is  tensor(143.2798, device='cuda:3')
norm1 res is  tensor(0.1541, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.6202279925346375
distance x is tensor(121.6400, device='cuda:3')
benign distance is  tensor(121.6400, device='cuda:3')
norm1 res is  tensor(0.1339, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.21939842402935028
distance x is tensor(146.1455, device='cuda:3')
benign distance is  tensor(146.1455, device='cuda:3')
norm1 res is  tensor(0.1561, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.4401852488517761
distance x is tensor(119.4977, device='cuda:3')
benign distance is  tensor(119.4977, device='cuda:3')
norm1 res is  tensor(0.1285, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.09214163571596146
distance x is tensor(144.2872, device='cuda:3')
benign distance is  tensor(144.2872, device='cuda:3')
norm1 res is  tensor(0.1562, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.12016099691390991
distance x is tensor(138.0841, device='cuda:3')
benign distance is  tensor(138.0841, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.28659576177597046
distance x is tensor(127.6772, device='cuda:3')
benign distance is  tensor(127.6772, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.7794744968414307
distance x is tensor(128.5754, device='cuda:3')
benign distance is  tensor(128.5754, device='cuda:3')
norm1 res is  tensor(0.1405, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.8569842576980591
distance x is tensor(138.2390, device='cuda:3')
benign distance is  tensor(138.2390, device='cuda:3')
norm1 res is  tensor(0.1523, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.20253315567970276
distance x is tensor(138.3900, device='cuda:3')
benign distance is  tensor(138.3900, device='cuda:3')
norm1 res is  tensor(0.1514, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.44604381918907166
distance x is tensor(127.7053, device='cuda:3')
benign distance is  tensor(127.7053, device='cuda:3')
norm1 res is  tensor(0.1353, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.5039143562316895
distance x is tensor(147.8964, device='cuda:3')
benign distance is  tensor(147.8964, device='cuda:3')
norm1 res is  tensor(0.1524, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.31866076588630676
distance x is tensor(121.7981, device='cuda:3')
benign distance is  tensor(121.7981, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.3145841360092163
distance x is tensor(151.5101, device='cuda:3')
benign distance is  tensor(151.5101, device='cuda:3')
norm1 res is  tensor(0.1645, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.42185765504837036
distance x is tensor(123.4176, device='cuda:3')
benign distance is  tensor(123.4176, device='cuda:3')
norm1 res is  tensor(0.1392, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.2197732925415039
distance x is tensor(137.0908, device='cuda:3')
benign distance is  tensor(137.0908, device='cuda:3')
norm1 res is  tensor(0.1448, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.47119981050491333
distance x is tensor(135.4530, device='cuda:3')
benign distance is  tensor(135.4530, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.36260125041007996
distance x is tensor(136.3683, device='cuda:3')
benign distance is  tensor(136.3683, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(120.2032, device='cuda:3')
compute distance is  tensor(120.2032, device='cuda:3')
compute norm is  tensor(74.9823, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3241, device='cuda:3')
compute distance is  tensor(146.3241, device='cuda:3')
compute norm is  tensor(75.3509, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.8536, device='cuda:3')
compute distance is  tensor(123.8536, device='cuda:3')
compute norm is  tensor(75.0630, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9421, device='cuda:3')
compute distance is  tensor(126.9421, device='cuda:3')
compute norm is  tensor(75.0794, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7215, device='cuda:3')
compute distance is  tensor(132.7215, device='cuda:3')
compute norm is  tensor(75.3569, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.6649, device='cuda:3')
compute distance is  tensor(142.6649, device='cuda:3')
compute norm is  tensor(75.4425, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9778, device='cuda:3')
compute distance is  tensor(119.9778, device='cuda:3')
compute norm is  tensor(74.9083, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7963, device='cuda:3')
compute distance is  tensor(130.7963, device='cuda:3')
compute norm is  tensor(75.1194, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.5316, device='cuda:3')
compute distance is  tensor(152.5316, device='cuda:3')
compute norm is  tensor(75.4483, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5973, device='cuda:3')
compute distance is  tensor(134.5973, device='cuda:3')
compute norm is  tensor(75.1427, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.3358, device='cuda:3')
compute distance is  tensor(130.3358, device='cuda:3')
compute norm is  tensor(75.1129, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1306, device='cuda:3')
compute distance is  tensor(129.1306, device='cuda:3')
compute norm is  tensor(74.9771, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(152.5316, device='cuda:3')
distance x is tensor(107482.2031, device='cuda:3')
distance x is tensor(107482.2031, device='cuda:3')
________________________________
test distance is  tensor(107482.2031, device='cuda:3')
test distance1 is  tensor(107482.2031, device='cuda:3')
test similarity is  tensor(0.5755, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130069199766377.34
test entropy is  0.0
________________________________
cal ratio is  0.03691795612481204
distance x is tensor(3968.0286, device='cuda:3')
cal_distance is  tensor(3968.0286, device='cuda:3')
cal ratio is  0.19214032646736726
distance x is tensor(762.4224, device='cuda:3')
cal_distance is  tensor(762.4224, device='cuda:3')
cal ratio is  0.43833696358716134
distance x is tensor(334.2008, device='cuda:3')
cal_distance is  tensor(334.2008, device='cuda:3')
cal ratio is  0.6620673302818428
distance x is tensor(221.2652, device='cuda:3')
cal_distance is  tensor(221.2652, device='cuda:3')
cal ratio is  0.8136720267234803
distance x is tensor(180.0382, device='cuda:3')
cal_distance is  tensor(180.0382, device='cuda:3')
cal ratio is  0.902035334366565
distance x is tensor(162.4014, device='cuda:3')
cal_distance is  tensor(162.4014, device='cuda:3')
cal ratio is  0.9497538598196307
distance x is tensor(154.2416, device='cuda:3')
cal_distance is  tensor(154.2416, device='cuda:3')
cal ratio is  0.974552315977716
distance x is tensor(150.3167, device='cuda:3')
cal_distance is  tensor(150.3167, device='cuda:3')
distance x is tensor(150.3167, device='cuda:3')
return_distance is  tensor(150.3167, device='cuda:3')
distance x is tensor(150.3064, device='cuda:3')
distance x is tensor(150.3064, device='cuda:3')
________________________________
test distance is  tensor(150.3064, device='cuda:3')
test distance1 is  tensor(150.3064, device='cuda:3')
test similarity is  tensor(0.9881, device='cuda:3')
test acc is  0.21733333348967046
test loss is 46.91024690396242
test entropy is  0.030690798487726236
________________________________
0
distance x is tensor(150.3064, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.030909136372324484
avg test loss is  46.73006045132049
avg accuracy is  0.8871666668229884
solo acc is  0.21633333348967043
compute similarity  is  tensor(0.9881, device='cuda:3')
compute_distance is  tensor(150.3064, device='cuda:3')
compute_norm is  tensor(79.8704, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(146.6699, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9226835038362027
avg test loss is  1.338947339606946
avg accuracy is  0.8053833334896585
solo acc is  0.3135000001563398
compute similarity  is  tensor(0.9883, device='cuda:3')
compute_distance is  tensor(146.6699, device='cuda:3')
compute_norm is  tensor(79.4705, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.7224, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8804038250878421
avg test loss is  1.432999856182253
avg accuracy is  0.7980833334896589
solo acc is  0.2467666668230048
compute similarity  is  tensor(0.9882, device='cuda:3')
compute_distance is  tensor(146.7224, device='cuda:3')
compute_norm is  tensor(79.0769, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(146.7224, device='cuda:3')
distance x is tensor(146.7224, device='cuda:3')
________________________________
test distance is  tensor(146.7224, device='cuda:3')
test distance1 is  tensor(146.7224, device='cuda:3')
test similarity is  tensor(0.9882, device='cuda:3')
test acc is  0.24615000015633817
test loss is 1.4325232052091341
test entropy is  0.8799368521806273
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2819520235061646
mal norm is  tensor(735.5936, device='cuda:3')
distance x is tensor(146.7316, device='cuda:3')
mal distance is  tensor(146.7316, device='cuda:3')
len current grad  20
len all grad 20
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(20.6915, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.1614, device='cuda:3')
user_param_square tensor(101.6288, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(5.9628, device='cuda:3')
score : tensor(0.0391, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.6826, device='cuda:3')
user_param_square tensor(106.5508, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-42.9986, device='cuda:3')
score : tensor(-0.4505, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.3760, device='cuda:3')
user_param_square tensor(98.7597, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(25.3240, device='cuda:3')
score : tensor(0.2327, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.2497, device='cuda:3')
user_param_square tensor(96.9490, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(28.1674, device='cuda:3')
score : tensor(0.2612, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(479.7220, device='cuda:3')
user_param_square tensor(99.6302, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-33.6974, device='cuda:3')
score : tensor(-0.3575, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(478.4102, device='cuda:3')
user_param_square tensor(99.4939, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-30.2354, device='cuda:3')
score : tensor(-0.3228, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(934.9652, device='cuda:3')
user_param_square tensor(139.0894, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(79.2581, device='cuda:3')
score : tensor(0.7721, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.8329, device='cuda:3')
user_param_square tensor(103.7118, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(16.8961, device='cuda:3')
score : tensor(0.1485, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.5936, device='cuda:3')
user_param_square tensor(123.3716, device='cuda:3')
global_param_square tensor(20.6915, device='cuda:3')
part1 is  tensor(-7.0460, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
len accept list 5
len all weights is 5
 
Avg Training Stats after 97 global rounds:
Train Accuracy: 89.29% 

Test Accuracy: 88.59% 


 | Global Training Round : 98 | 

current submit client idx and staleness is  0 1
 benign loss is  0.360280841588974
distance x is tensor(115.6400, device='cuda:3')
benign distance is  tensor(115.6400, device='cuda:3')
norm1 res is  tensor(0.1275, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.21636156737804413
distance x is tensor(135.6297, device='cuda:3')
benign distance is  tensor(135.6297, device='cuda:3')
norm1 res is  tensor(0.1449, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.1296917200088501
distance x is tensor(200.1250, device='cuda:3')
benign distance is  tensor(200.1250, device='cuda:3')
norm1 res is  tensor(0.2211, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.794018566608429
distance x is tensor(136.4509, device='cuda:3')
benign distance is  tensor(136.4509, device='cuda:3')
norm1 res is  tensor(0.1463, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3664831519126892
distance x is tensor(136.3674, device='cuda:3')
benign distance is  tensor(136.3674, device='cuda:3')
norm1 res is  tensor(0.1464, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.580564558506012
distance x is tensor(138.2620, device='cuda:3')
benign distance is  tensor(138.2620, device='cuda:3')
norm1 res is  tensor(0.1514, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.21871986985206604
distance x is tensor(110.9782, device='cuda:3')
benign distance is  tensor(110.9782, device='cuda:3')
norm1 res is  tensor(0.1223, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.20257365703582764
distance x is tensor(152.1527, device='cuda:3')
benign distance is  tensor(152.1527, device='cuda:3')
norm1 res is  tensor(0.1636, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(128.4419, device='cuda:3')
compute distance is  tensor(128.4419, device='cuda:3')
compute norm is  tensor(75.6610, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.0739, device='cuda:3')
compute distance is  tensor(147.0739, device='cuda:3')
compute norm is  tensor(75.8709, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2113, device='cuda:3')
compute distance is  tensor(132.2113, device='cuda:3')
compute norm is  tensor(75.7736, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4357, device='cuda:3')
compute distance is  tensor(137.4357, device='cuda:3')
compute norm is  tensor(75.7989, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2902, device='cuda:3')
compute distance is  tensor(138.2902, device='cuda:3')
compute norm is  tensor(75.9078, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.5015, device='cuda:3')
compute distance is  tensor(145.5015, device='cuda:3')
compute norm is  tensor(75.9773, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.2603, device='cuda:3')
compute distance is  tensor(148.2603, device='cuda:3')
compute norm is  tensor(76.0513, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5869, device='cuda:3')
compute distance is  tensor(132.5869, device='cuda:3')
compute norm is  tensor(75.7117, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.9924, device='cuda:3')
compute distance is  tensor(160.9924, device='cuda:3')
compute norm is  tensor(76.1905, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1755, device='cuda:3')
compute distance is  tensor(136.1755, device='cuda:3')
compute norm is  tensor(75.9119, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8120, device='cuda:3')
compute distance is  tensor(133.8120, device='cuda:3')
compute norm is  tensor(75.7276, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7144, device='cuda:3')
compute distance is  tensor(133.7144, device='cuda:3')
compute norm is  tensor(75.8676, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(160.9924, device='cuda:3')
distance x is tensor(107492.7656, device='cuda:3')
distance x is tensor(107492.7656, device='cuda:3')
________________________________
test distance is  tensor(107492.7656, device='cuda:3')
test distance1 is  tensor(107492.7656, device='cuda:3')
test similarity is  tensor(0.5631, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130113393707789.64
test entropy is  0.0
________________________________
cal ratio is  0.037926178147646414
distance x is tensor(4076.7949, device='cuda:3')
cal_distance is  tensor(4076.7949, device='cuda:3')
cal ratio is  0.19474632483535506
distance x is tensor(793.9449, device='cuda:3')
cal_distance is  tensor(793.9449, device='cuda:3')
cal ratio is  0.44129957151634197
distance x is tensor(350.3704, device='cuda:3')
cal_distance is  tensor(350.3704, device='cuda:3')
cal ratio is  0.6643011152537464
distance x is tensor(232.7531, device='cuda:3')
cal_distance is  tensor(232.7531, device='cuda:3')
cal ratio is  0.8150437748304502
distance x is tensor(189.7049, device='cuda:3')
cal_distance is  tensor(189.7049, device='cuda:3')
cal ratio is  0.9027955020956229
distance x is tensor(171.2653, device='cuda:3')
cal_distance is  tensor(171.2653, device='cuda:3')
cal ratio is  0.9501540470082069
distance x is tensor(162.7287, device='cuda:3')
cal_distance is  tensor(162.7287, device='cuda:3')
cal ratio is  0.9747577342406275
distance x is tensor(158.6211, device='cuda:3')
cal_distance is  tensor(158.6211, device='cuda:3')
distance x is tensor(158.6211, device='cuda:3')
return_distance is  tensor(158.6211, device='cuda:3')
distance x is tensor(158.6110, device='cuda:3')
distance x is tensor(158.6110, device='cuda:3')
________________________________
test distance is  tensor(158.6110, device='cuda:3')
test distance1 is  tensor(158.6110, device='cuda:3')
test similarity is  tensor(0.9867, device='cuda:3')
test acc is  0.12661666682299857
test loss is 90.91696446790878
test entropy is  0.007012344624608571
________________________________
0
distance x is tensor(158.6110, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.007137260986318226
avg test loss is  91.24316328573329
avg accuracy is  0.8674333334896558
solo acc is  0.12676666682299859
compute similarity  is  tensor(0.9867, device='cuda:3')
compute_distance is  tensor(158.6110, device='cuda:3')
compute_norm is  tensor(80.8273, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.3036, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9954372879538709
avg test loss is  1.4321341815152402
avg accuracy is  0.7820500001563263
solo acc is  0.3024166668230063
compute similarity  is  tensor(0.9867, device='cuda:3')
compute_distance is  tensor(157.3036, device='cuda:3')
compute_norm is  tensor(80.6340, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(157.3036, device='cuda:3')
distance x is tensor(157.3036, device='cuda:3')
________________________________
test distance is  tensor(157.3036, device='cuda:3')
test distance1 is  tensor(157.3036, device='cuda:3')
test similarity is  tensor(0.9867, device='cuda:3')
test acc is  0.3020166668230062
test loss is 1.435279059003411
test entropy is  0.9933724917455523
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.338085412979126
mal norm is  tensor(794.8362, device='cuda:3')
distance x is tensor(157.3129, device='cuda:3')
mal distance is  tensor(157.3129, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(11.5161, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.8955, device='cuda:3')
user_param_square tensor(75.8737, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-2.9369, device='cuda:3')
score : tensor(-0.0407, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.8751, device='cuda:3')
user_param_square tensor(81.2944, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-9.8983, device='cuda:3')
score : tensor(-0.1103, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.9640, device='cuda:3')
user_param_square tensor(100.3800, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-2.2302, device='cuda:3')
score : tensor(-0.0336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.5465, device='cuda:3')
user_param_square tensor(81.6951, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-11.6566, device='cuda:3')
score : tensor(-0.1279, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.2458, device='cuda:3')
user_param_square tensor(81.6034, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(2.9222, device='cuda:3')
score : tensor(0.0179, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.2627, device='cuda:3')
user_param_square tensor(82.4469, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(5.6569, device='cuda:3')
score : tensor(0.0453, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(476.4724, device='cuda:3')
user_param_square tensor(74.0749, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(3.0557, device='cuda:3')
score : tensor(0.0192, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.0403, device='cuda:3')
user_param_square tensor(85.9201, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(4.0235, device='cuda:3')
score : tensor(0.0289, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.8362, device='cuda:3')
user_param_square tensor(95.6733, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-25.1084, device='cuda:3')
score : tensor(-0.2624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.4727, device='cuda:3')
user_param_square tensor(80.1242, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-3.6999, device='cuda:3')
score : tensor(-0.0483, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3832, device='cuda:3')
user_param_square tensor(84.2514, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-21.4925, device='cuda:3')
score : tensor(-0.2262, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(538.0576, device='cuda:3')
user_param_square tensor(78.7166, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-2.0344, device='cuda:3')
score : tensor(-0.0317, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.3478, device='cuda:3')
user_param_square tensor(87.0061, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-20.3985, device='cuda:3')
score : tensor(-0.2153, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.1635, device='cuda:3')
user_param_square tensor(81.8793, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-26.9860, device='cuda:3')
score : tensor(-0.2812, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.3873, device='cuda:3')
user_param_square tensor(83.5655, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(13.4722, device='cuda:3')
score : tensor(0.1234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.0339, device='cuda:3')
user_param_square tensor(82.2911, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-21.6566, device='cuda:3')
score : tensor(-0.2279, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.3588, device='cuda:3')
user_param_square tensor(81.7523, device='cuda:3')
global_param_square tensor(11.5161, device='cuda:3')
part1 is  tensor(-13.8877, device='cuda:3')
score : tensor(-0.1502, device='cuda:3')
len accept list 5
len all weights is 5
 
Avg Training Stats after 98 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 88.80% 


 | Global Training Round : 99 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5859201550483704
distance x is tensor(131.2804, device='cuda:3')
benign distance is  tensor(131.2804, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.09051584452390671
distance x is tensor(132.5475, device='cuda:3')
benign distance is  tensor(132.5475, device='cuda:3')
norm1 res is  tensor(0.1442, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2714891731739044
distance x is tensor(110.9103, device='cuda:3')
benign distance is  tensor(110.9103, device='cuda:3')
norm1 res is  tensor(0.1191, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6613441705703735
distance x is tensor(127.8299, device='cuda:3')
benign distance is  tensor(127.8299, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.14467276632785797
distance x is tensor(86.4307, device='cuda:3')
benign distance is  tensor(86.4307, device='cuda:3')
norm1 res is  tensor(0.0937, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5071808099746704
distance x is tensor(118.6380, device='cuda:3')
benign distance is  tensor(118.6380, device='cuda:3')
norm1 res is  tensor(0.1302, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.16100940108299255
distance x is tensor(128.5794, device='cuda:3')
benign distance is  tensor(128.5794, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.11107635498046875
distance x is tensor(108.1563, device='cuda:3')
benign distance is  tensor(108.1563, device='cuda:3')
norm1 res is  tensor(0.1208, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.2414993941783905
distance x is tensor(146.9716, device='cuda:3')
benign distance is  tensor(146.9716, device='cuda:3')
norm1 res is  tensor(0.1593, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3518907129764557
distance x is tensor(143.4676, device='cuda:3')
benign distance is  tensor(143.4676, device='cuda:3')
norm1 res is  tensor(0.1548, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.27921900153160095
distance x is tensor(126.2229, device='cuda:3')
benign distance is  tensor(126.2229, device='cuda:3')
norm1 res is  tensor(0.1345, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.8481124639511108
distance x is tensor(171.9740, device='cuda:3')
benign distance is  tensor(171.9740, device='cuda:3')
norm1 res is  tensor(0.1826, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.3758930563926697
distance x is tensor(127.3375, device='cuda:3')
benign distance is  tensor(127.3375, device='cuda:3')
norm1 res is  tensor(0.1399, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.26654914021492004
distance x is tensor(141.9754, device='cuda:3')
benign distance is  tensor(141.9754, device='cuda:3')
norm1 res is  tensor(0.1547, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.6588507890701294
distance x is tensor(121.5447, device='cuda:3')
benign distance is  tensor(121.5447, device='cuda:3')
norm1 res is  tensor(0.1364, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.27656659483909607
distance x is tensor(141.1102, device='cuda:3')
benign distance is  tensor(141.1102, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(136.6251, device='cuda:3')
compute distance is  tensor(136.6251, device='cuda:3')
compute norm is  tensor(76.3341, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4263, device='cuda:3')
compute distance is  tensor(129.4263, device='cuda:3')
compute norm is  tensor(76.0670, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.7531, device='cuda:3')
compute distance is  tensor(140.7531, device='cuda:3')
compute norm is  tensor(76.3464, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9060, device='cuda:3')
compute distance is  tensor(136.9060, device='cuda:3')
compute norm is  tensor(76.2787, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2632, device='cuda:3')
compute distance is  tensor(134.2632, device='cuda:3')
compute norm is  tensor(76.1232, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.4080, device='cuda:3')
compute distance is  tensor(151.4080, device='cuda:3')
compute norm is  tensor(76.5363, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5695, device='cuda:3')
compute distance is  tensor(124.5695, device='cuda:3')
compute norm is  tensor(76.1643, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5555, device='cuda:3')
compute distance is  tensor(130.5555, device='cuda:3')
compute norm is  tensor(76.1331, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9048, device='cuda:3')
compute distance is  tensor(142.9048, device='cuda:3')
compute norm is  tensor(76.3367, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6693, device='cuda:3')
compute distance is  tensor(134.6693, device='cuda:3')
compute norm is  tensor(76.1619, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.9536, device='cuda:3')
compute distance is  tensor(141.9536, device='cuda:3')
compute norm is  tensor(76.3134, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0216, device='cuda:3')
compute distance is  tensor(139.0216, device='cuda:3')
compute norm is  tensor(76.2952, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.4080, device='cuda:3')
distance x is tensor(107498.4141, device='cuda:3')
distance x is tensor(107498.4141, device='cuda:3')
________________________________
test distance is  tensor(107498.4141, device='cuda:3')
test distance1 is  tensor(107498.4141, device='cuda:3')
test similarity is  tensor(0.5557, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130011132730745.72
test entropy is  0.0
________________________________
cal ratio is  0.03677896589562545
distance x is tensor(3953.6858, device='cuda:3')
cal_distance is  tensor(3953.6858, device='cuda:3')
cal ratio is  0.19177829880500402
distance x is tensor(758.2352, device='cuda:3')
cal_distance is  tensor(758.2352, device='cuda:3')
cal ratio is  0.4379238134392906
distance x is tensor(332.0522, device='cuda:3')
cal_distance is  tensor(332.0522, device='cuda:3')
cal ratio is  0.6617552335155329
distance x is tensor(219.7390, device='cuda:3')
cal_distance is  tensor(219.7390, device='cuda:3')
cal ratio is  0.8134802569137156
distance x is tensor(178.7543, device='cuda:3')
cal_distance is  tensor(178.7543, device='cuda:3')
cal ratio is  0.9019289352854118
distance x is tensor(161.2242, device='cuda:3')
cal_distance is  tensor(161.2242, device='cuda:3')
cal ratio is  0.949697925037179
distance x is tensor(153.1145, device='cuda:3')
cal_distance is  tensor(153.1145, device='cuda:3')
cal ratio is  0.9745235921471096
distance x is tensor(149.2138, device='cuda:3')
cal_distance is  tensor(149.2138, device='cuda:3')
distance x is tensor(149.2138, device='cuda:3')
return_distance is  tensor(149.2138, device='cuda:3')
distance x is tensor(149.2036, device='cuda:3')
distance x is tensor(149.2036, device='cuda:3')
________________________________
test distance is  tensor(149.2036, device='cuda:3')
test distance1 is  tensor(149.2036, device='cuda:3')
test similarity is  tensor(0.9880, device='cuda:3')
test acc is  0.1325000001563319
test loss is 79.29300620154277
test entropy is  0.01005755829687646
________________________________
0
distance x is tensor(149.2036, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.010262896325783115
avg test loss is  79.37623208621417
avg accuracy is  0.8747833334896555
solo acc is  0.13253333348966523
compute similarity  is  tensor(0.9880, device='cuda:3')
compute_distance is  tensor(149.2036, device='cuda:3')
compute_norm is  tensor(80.7405, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(149.5172, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9865006402230212
avg test loss is  1.4766294510125606
avg accuracy is  0.7805666668229929
solo acc is  0.27558333348967223
compute similarity  is  tensor(0.9878, device='cuda:3')
compute_distance is  tensor(149.5172, device='cuda:3')
compute_norm is  tensor(80.4514, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(149.5172, device='cuda:3')
distance x is tensor(149.5172, device='cuda:3')
________________________________
test distance is  tensor(149.5172, device='cuda:3')
test distance1 is  tensor(149.5172, device='cuda:3')
test similarity is  tensor(0.9878, device='cuda:3')
test acc is  0.2736333334896722
test loss is 1.477210075107973
test entropy is  0.9874828358067632
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.3441680669784546
mal norm is  tensor(749.3928, device='cuda:3')
distance x is tensor(149.5262, device='cuda:3')
mal distance is  tensor(149.5262, device='cuda:3')
len current grad  20
len all grad 28
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(12.8874, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.1209, device='cuda:3')
user_param_square tensor(85.6418, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(10.9920, device='cuda:3')
score : tensor(0.0972, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.4230, device='cuda:3')
user_param_square tensor(85.1363, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(7.2607, device='cuda:3')
score : tensor(0.0599, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(467.7144, device='cuda:3')
user_param_square tensor(77.6379, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(7.5774, device='cuda:3')
score : tensor(0.0631, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.5874, device='cuda:3')
user_param_square tensor(83.0028, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(17.6850, device='cuda:3')
score : tensor(0.1642, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(368.3160, device='cuda:3')
user_param_square tensor(68.8960, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-6.0363, device='cuda:3')
score : tensor(-0.0731, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.4276, device='cuda:3')
user_param_square tensor(80.9465, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-9.7808, device='cuda:3')
score : tensor(-0.1105, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.5737, device='cuda:3')
user_param_square tensor(84.0816, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(36.3789, device='cuda:3')
score : tensor(0.3511, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.6756, device='cuda:3')
user_param_square tensor(77.9660, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(8.9972, device='cuda:3')
score : tensor(0.0773, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.3928, device='cuda:3')
user_param_square tensor(98.2739, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-11.8522, device='cuda:3')
score : tensor(-0.1312, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.5590, device='cuda:3')
user_param_square tensor(86.4236, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-7.7876, device='cuda:3')
score : tensor(-0.0906, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.0885, device='cuda:3')
user_param_square tensor(90.2552, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-14.1458, device='cuda:3')
score : tensor(-0.1541, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.0753, device='cuda:3')
user_param_square tensor(87.7199, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-23.6168, device='cuda:3')
score : tensor(-0.2489, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.6797, device='cuda:3')
user_param_square tensor(91.1497, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(15.9112, device='cuda:3')
score : tensor(0.1464, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.9323, device='cuda:3')
user_param_square tensor(89.8864, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-17.3605, device='cuda:3')
score : tensor(-0.1863, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.9281, device='cuda:3')
user_param_square tensor(87.5620, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-16.6635, device='cuda:3')
score : tensor(-0.1793, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.4189, device='cuda:3')
user_param_square tensor(92.4650, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(12.3154, device='cuda:3')
score : tensor(0.1105, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.6970, device='cuda:3')
user_param_square tensor(87.1762, device='cuda:3')
global_param_square tensor(12.8874, device='cuda:3')
part1 is  tensor(-23.0397, device='cuda:3')
score : tensor(-0.2431, device='cuda:3')
len accept list 8
len all weights is 8
 
Avg Training Stats after 99 global rounds:
Train Accuracy: 89.57% 

Test Accuracy: 89.04% 


 | Global Training Round : 100 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7651875615119934
distance x is tensor(125.8905, device='cuda:3')
benign distance is  tensor(125.8905, device='cuda:3')
norm1 res is  tensor(0.1397, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.145429790019989
distance x is tensor(145.0332, device='cuda:3')
benign distance is  tensor(145.0332, device='cuda:3')
norm1 res is  tensor(0.1542, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2465987652540207
distance x is tensor(112.8233, device='cuda:3')
benign distance is  tensor(112.8233, device='cuda:3')
norm1 res is  tensor(0.1239, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.38890019059181213
distance x is tensor(117.2225, device='cuda:3')
benign distance is  tensor(117.2225, device='cuda:3')
norm1 res is  tensor(0.1284, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.30048030614852905
distance x is tensor(110.2451, device='cuda:3')
benign distance is  tensor(110.2451, device='cuda:3')
norm1 res is  tensor(0.1191, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8456646203994751
distance x is tensor(152.0600, device='cuda:3')
benign distance is  tensor(152.0600, device='cuda:3')
norm1 res is  tensor(0.1645, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.7358098030090332
distance x is tensor(151.0145, device='cuda:3')
benign distance is  tensor(151.0145, device='cuda:3')
norm1 res is  tensor(0.1628, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.43166112899780273
distance x is tensor(101.0960, device='cuda:3')
benign distance is  tensor(101.0960, device='cuda:3')
norm1 res is  tensor(0.1126, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.10005897283554077
distance x is tensor(134.8858, device='cuda:3')
benign distance is  tensor(134.8858, device='cuda:3')
norm1 res is  tensor(0.1473, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.5883194804191589
distance x is tensor(155.7049, device='cuda:3')
benign distance is  tensor(155.7049, device='cuda:3')
norm1 res is  tensor(0.1698, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.14291435480117798
distance x is tensor(175.5815, device='cuda:3')
benign distance is  tensor(175.5815, device='cuda:3')
norm1 res is  tensor(0.1878, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.28741827607154846
distance x is tensor(132.3531, device='cuda:3')
benign distance is  tensor(132.3531, device='cuda:3')
norm1 res is  tensor(0.1498, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.245961993932724
distance x is tensor(126.5174, device='cuda:3')
benign distance is  tensor(126.5174, device='cuda:3')
norm1 res is  tensor(0.1360, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.14653201401233673
distance x is tensor(138.1485, device='cuda:3')
benign distance is  tensor(138.1485, device='cuda:3')
norm1 res is  tensor(0.1482, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.14614836871623993
distance x is tensor(155.1519, device='cuda:3')
benign distance is  tensor(155.1519, device='cuda:3')
norm1 res is  tensor(0.1657, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.09850648790597916
distance x is tensor(144.6785, device='cuda:3')
benign distance is  tensor(144.6785, device='cuda:3')
norm1 res is  tensor(0.1586, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance x is tensor(146.2628, device='cuda:3')
compute distance is  tensor(146.2628, device='cuda:3')
compute norm is  tensor(76.5038, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.4750, device='cuda:3')
compute distance is  tensor(144.4750, device='cuda:3')
compute norm is  tensor(76.3592, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.4330, device='cuda:3')
compute distance is  tensor(141.4330, device='cuda:3')
compute norm is  tensor(76.5435, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.2218, device='cuda:3')
compute distance is  tensor(137.2218, device='cuda:3')
compute norm is  tensor(76.3582, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.1362, device='cuda:3')
compute distance is  tensor(149.1362, device='cuda:3')
compute norm is  tensor(76.5168, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.2651, device='cuda:3')
compute distance is  tensor(144.2651, device='cuda:3')
compute norm is  tensor(76.5502, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6144, device='cuda:3')
compute distance is  tensor(128.6144, device='cuda:3')
compute norm is  tensor(76.3320, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.8010, device='cuda:3')
compute distance is  tensor(142.8010, device='cuda:3')
compute norm is  tensor(76.5315, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.4770, device='cuda:3')
compute distance is  tensor(164.4770, device='cuda:3')
compute norm is  tensor(76.7807, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.0125, device='cuda:3')
compute distance is  tensor(141.0125, device='cuda:3')
compute norm is  tensor(76.5416, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.9608, device='cuda:3')
compute distance is  tensor(151.9608, device='cuda:3')
compute norm is  tensor(76.6335, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.9027, device='cuda:3')
compute distance is  tensor(133.9027, device='cuda:3')
compute norm is  tensor(76.3954, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(164.4770, device='cuda:3')
distance x is tensor(107500.7266, device='cuda:3')
distance x is tensor(107500.7266, device='cuda:3')
________________________________
test distance is  tensor(107500.7266, device='cuda:3')
test distance1 is  tensor(107500.7266, device='cuda:3')
test similarity is  tensor(0.5522, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130085562014573.72
test entropy is  0.0
________________________________
cal ratio is  0.038333018168294285
distance x is tensor(4120.8325, device='cuda:3')
cal_distance is  tensor(4120.8325, device='cuda:3')
cal ratio is  0.19578807384703634
distance x is tensor(806.8140, device='cuda:3')
cal_distance is  tensor(806.8140, device='cuda:3')
cal ratio is  0.44247832967207035
distance x is tensor(357.0005, device='cuda:3')
cal_distance is  tensor(357.0005, device='cuda:3')
cal ratio is  0.6651877957499043
distance x is tensor(237.4741, device='cuda:3')
cal_distance is  tensor(237.4741, device='cuda:3')
cal ratio is  0.8155875606640385
distance x is tensor(193.6819, device='cuda:3')
cal_distance is  tensor(193.6819, device='cuda:3')
cal ratio is  0.9030966707426124
distance x is tensor(174.9140, device='cuda:3')
cal_distance is  tensor(174.9140, device='cuda:3')
cal ratio is  0.950312574788636
distance x is tensor(166.2232, device='cuda:3')
cal_distance is  tensor(166.2232, device='cuda:3')
cal ratio is  0.9748390673209886
distance x is tensor(162.0410, device='cuda:3')
cal_distance is  tensor(162.0410, device='cuda:3')
distance x is tensor(162.0410, device='cuda:3')
return_distance is  tensor(162.0410, device='cuda:3')
distance x is tensor(162.0308, device='cuda:3')
distance x is tensor(162.0308, device='cuda:3')
________________________________
test distance is  tensor(162.0308, device='cuda:3')
test distance1 is  tensor(162.0308, device='cuda:3')
test similarity is  tensor(0.9861, device='cuda:3')
test acc is  0.15433333348966688
test loss is 84.60645064006228
test entropy is  0.013492707420674783
________________________________
0
distance x is tensor(162.0308, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.013517130432487739
avg test loss is  84.6291823193971
avg accuracy is  0.879550000156322
solo acc is  0.1539333334896669
compute similarity  is  tensor(0.9861, device='cuda:3')
compute_distance is  tensor(162.0308, device='cuda:3')
compute_norm is  tensor(81.4942, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.2852, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0152558364085298
avg test loss is  1.5133511654095355
avg accuracy is  0.745150000156328
solo acc is  0.26661666682300544
compute similarity  is  tensor(0.9857, device='cuda:3')
compute_distance is  tensor(163.2852, device='cuda:3')
compute_norm is  tensor(81.3157, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.5250, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6136248003381656
avg test loss is  2.3478675107203566
avg accuracy is  0.6813500001563317
solo acc is  0.11776666682299859
compute similarity  is  tensor(0.9855, device='cuda:3')
compute_distance is  tensor(164.5250, device='cuda:3')
compute_norm is  tensor(80.9512, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.2054, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9613987873358004
avg test loss is  1.4036705211789877
avg accuracy is  0.7494500001563278
solo acc is  0.2773666668230057
compute similarity  is  tensor(0.9855, device='cuda:3')
compute_distance is  tensor(164.2054, device='cuda:3')
compute_norm is  tensor(80.5332, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(164.2054, device='cuda:3')
distance x is tensor(164.2054, device='cuda:3')
________________________________
test distance is  tensor(164.2054, device='cuda:3')
test distance1 is  tensor(164.2054, device='cuda:3')
test similarity is  tensor(0.9855, device='cuda:3')
test acc is  0.276150000156339
test loss is 1.4044835381924725
test entropy is  0.9589153749983448
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1507660150527954
mal norm is  tensor(796.0940, device='cuda:3')
distance x is tensor(164.2145, device='cuda:3')
mal distance is  tensor(164.2145, device='cuda:3')
len current grad  20
len all grad 44
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
grad,shape is torch.Size([215370])
global_param_square norm is    tensor(11.5998, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.2152, device='cuda:3')
user_param_square tensor(80.1075, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-2.0811, device='cuda:3')
score : tensor(-0.0322, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.4227, device='cuda:3')
user_param_square tensor(83.9405, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(1.4155, device='cuda:3')
score : tensor(0.0028, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.3068, device='cuda:3')
user_param_square tensor(75.3385, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-1.4620, device='cuda:3')
score : tensor(-0.0260, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.9433, device='cuda:3')
user_param_square tensor(76.6085, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-5.2819, device='cuda:3')
score : tensor(-0.0642, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.0541, device='cuda:3')
user_param_square tensor(73.8414, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-13.1585, device='cuda:3')
score : tensor(-0.1430, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.6580, device='cuda:3')
user_param_square tensor(85.9368, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-6.9490, device='cuda:3')
score : tensor(-0.0809, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.6866, device='cuda:3')
user_param_square tensor(85.8036, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-10.4805, device='cuda:3')
score : tensor(-0.1162, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(435.8787, device='cuda:3')
user_param_square tensor(71.1064, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-2.4525, device='cuda:3')
score : tensor(-0.0359, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.0940, device='cuda:3')
user_param_square tensor(96.0966, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0692, device='cuda:3')
score : tensor(0.0193, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.7581, device='cuda:3')
user_param_square tensor(91.0554, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-4.5938, device='cuda:3')
score : tensor(-0.0573, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.9020, device='cuda:3')
user_param_square tensor(100.7409, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-9.2067, device='cuda:3')
score : tensor(-0.1035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.2657, device='cuda:3')
user_param_square tensor(90.3204, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-19.3477, device='cuda:3')
score : tensor(-0.2049, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.0334, device='cuda:3')
user_param_square tensor(90.8178, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(37.9703, device='cuda:3')
score : tensor(0.3683, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.9940, device='cuda:3')
user_param_square tensor(90.6875, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(8.7915, device='cuda:3')
score : tensor(0.0765, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6320, device='cuda:3')
user_param_square tensor(90.8560, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-8.2108, device='cuda:3')
score : tensor(-0.0935, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0029, device='cuda:3')
user_param_square tensor(89.4647, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(2.1187, device='cuda:3')
score : tensor(0.0098, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.0196, device='cuda:3')
user_param_square tensor(89.1410, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(6.5583, device='cuda:3')
score : tensor(0.0542, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.5385, device='cuda:3')
user_param_square tensor(87.5337, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(18.4117, device='cuda:3')
score : tensor(0.1727, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.4193, device='cuda:3')
user_param_square tensor(81.2008, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-4.7989, device='cuda:3')
score : tensor(-0.0594, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.5266, device='cuda:3')
user_param_square tensor(87.7314, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-3.3409, device='cuda:3')
score : tensor(-0.0448, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.7614, device='cuda:3')
user_param_square tensor(86.0786, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(8.5049, device='cuda:3')
score : tensor(0.0736, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.2131, device='cuda:3')
user_param_square tensor(83.3713, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(3.0099, device='cuda:3')
score : tensor(0.0187, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.0701, device='cuda:3')
user_param_square tensor(83.9852, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-14.6735, device='cuda:3')
score : tensor(-0.1581, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0309, device='cuda:3')
user_param_square tensor(86.5671, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-18.1682, device='cuda:3')
score : tensor(-0.1931, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.7063, device='cuda:3')
user_param_square tensor(87.0132, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(4.0698, device='cuda:3')
score : tensor(0.0293, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9099, device='cuda:3')
user_param_square tensor(86.1560, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(7.3921, device='cuda:3')
score : tensor(0.0625, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.0667, device='cuda:3')
user_param_square tensor(85.2870, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-17.0405, device='cuda:3')
score : tensor(-0.1818, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.2830, device='cuda:3')
user_param_square tensor(79.8223, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-6.9623, device='cuda:3')
score : tensor(-0.0810, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.7432, device='cuda:3')
user_param_square tensor(92.2567, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(9.7435, device='cuda:3')
score : tensor(0.0860, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(564.7415, device='cuda:3')
user_param_square tensor(80.9377, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-10.1098, device='cuda:3')
score : tensor(-0.1125, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.0446, device='cuda:3')
user_param_square tensor(84.3281, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(1.3924, device='cuda:3')
score : tensor(0.0025, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.1564, device='cuda:3')
user_param_square tensor(79.5948, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(9.4799, device='cuda:3')
score : tensor(0.0834, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.1422, device='cuda:3')
user_param_square tensor(84.6779, device='cuda:3')
global_param_square tensor(11.5998, device='cuda:3')
part1 is  tensor(-10.4492, device='cuda:3')
score : tensor(-0.1159, device='cuda:3')
len accept list 25
len all weights is 25
 
Avg Training Stats after 100 global rounds:
Train Accuracy: 84.52% 

Test Accuracy: 83.70% 

 
 Results after 100 global rounds of training:
|---- Avg testing Accuracy across each device's data: 84.52%
|----0th round Training Accuracy : 85.42%
|----1th round Training Accuracy : 89.38%
|----2th round Training Accuracy : 86.06%
|----3th round Training Accuracy : 89.54%
|----4th round Training Accuracy : 89.41%
|----5th round Training Accuracy : 88.18%
|----6th round Training Accuracy : 89.35%
|----7th round Training Accuracy : 89.81%
|----8th round Training Accuracy : 89.57%
|----9th round Training Accuracy : 86.91%
|----10th round Training Accuracy : 89.46%
|----11th round Training Accuracy : 88.53%
|----12th round Training Accuracy : 89.48%
|----13th round Training Accuracy : 89.69%
|----14th round Training Accuracy : 87.63%
|----15th round Training Accuracy : 89.61%
|----16th round Training Accuracy : 81.40%
|----17th round Training Accuracy : 89.52%
|----18th round Training Accuracy : 71.86%
|----19th round Training Accuracy : 89.28%
|----20th round Training Accuracy : 89.64%
|----21th round Training Accuracy : 80.91%
|----22th round Training Accuracy : 88.69%
|----23th round Training Accuracy : 89.42%
|----24th round Training Accuracy : 86.56%
|----25th round Training Accuracy : 89.55%
|----26th round Training Accuracy : 85.96%
|----27th round Training Accuracy : 89.45%
|----28th round Training Accuracy : 76.52%
|----29th round Training Accuracy : 89.28%
|----30th round Training Accuracy : 89.66%
|----31th round Training Accuracy : 86.23%
|----32th round Training Accuracy : 89.28%
|----33th round Training Accuracy : 89.37%
|----34th round Training Accuracy : 89.45%
|----35th round Training Accuracy : 89.13%
|----36th round Training Accuracy : 89.05%
|----37th round Training Accuracy : 89.19%
|----38th round Training Accuracy : 85.85%
|----39th round Training Accuracy : 89.41%
|----40th round Training Accuracy : 88.06%
|----41th round Training Accuracy : 89.58%
|----42th round Training Accuracy : 89.22%
|----43th round Training Accuracy : 87.61%
|----44th round Training Accuracy : 89.63%
|----45th round Training Accuracy : 89.47%
|----46th round Training Accuracy : 81.79%
|----47th round Training Accuracy : 89.66%
|----48th round Training Accuracy : 88.84%
|----49th round Training Accuracy : 81.80%
|----50th round Training Accuracy : 48.75%
|----51th round Training Accuracy : 85.01%
|----52th round Training Accuracy : 88.28%
|----53th round Training Accuracy : 88.26%
|----54th round Training Accuracy : 88.10%
|----55th round Training Accuracy : 89.41%
|----56th round Training Accuracy : 88.08%
|----57th round Training Accuracy : 89.65%
|----58th round Training Accuracy : 89.45%
|----59th round Training Accuracy : 89.24%
|----60th round Training Accuracy : 89.57%
|----61th round Training Accuracy : 89.48%
|----62th round Training Accuracy : 89.63%
|----63th round Training Accuracy : 89.43%
|----64th round Training Accuracy : 89.77%
|----65th round Training Accuracy : 89.70%
|----66th round Training Accuracy : 89.92%
|----67th round Training Accuracy : 89.71%
|----68th round Training Accuracy : 89.81%
|----69th round Training Accuracy : 89.96%
|----70th round Training Accuracy : 89.59%
|----71th round Training Accuracy : 89.98%
|----72th round Training Accuracy : 89.73%
|----73th round Training Accuracy : 89.54%
|----74th round Training Accuracy : 89.84%
|----75th round Training Accuracy : 89.63%
|----76th round Training Accuracy : 89.79%
|----77th round Training Accuracy : 90.23%
|----78th round Training Accuracy : 89.73%
|----79th round Training Accuracy : 90.03%
|----80th round Training Accuracy : 87.33%
|----81th round Training Accuracy : 90.16%
|----82th round Training Accuracy : 72.48%
|----83th round Training Accuracy : 89.94%
|----84th round Training Accuracy : 86.76%
|----85th round Training Accuracy : 89.91%
|----86th round Training Accuracy : 86.79%
|----87th round Training Accuracy : 89.98%
|----88th round Training Accuracy : 79.39%
|----89th round Training Accuracy : 89.83%
|----90th round Training Accuracy : 82.10%
|----91th round Training Accuracy : 89.68%
|----92th round Training Accuracy : 81.97%
|----93th round Training Accuracy : 89.51%
|----94th round Training Accuracy : 87.84%
|----95th round Training Accuracy : 89.83%
|----96th round Training Accuracy : 89.29%
|----97th round Training Accuracy : 89.78%
|----98th round Training Accuracy : 89.57%
|----99th round Training Accuracy : 84.52%
|----Final Test Accuracy: 83.70%
|----0th round Final Test Accuracy : 84.37%
|----1th round Final Test Accuracy : 88.55%
|----2th round Final Test Accuracy : 84.76%
|----3th round Final Test Accuracy : 88.73%
|----4th round Final Test Accuracy : 88.81%
|----5th round Final Test Accuracy : 87.30%
|----6th round Final Test Accuracy : 88.49%
|----7th round Final Test Accuracy : 88.96%
|----8th round Final Test Accuracy : 88.78%
|----9th round Final Test Accuracy : 86.05%
|----10th round Final Test Accuracy : 88.47%
|----11th round Final Test Accuracy : 87.82%
|----12th round Final Test Accuracy : 88.60%
|----13th round Final Test Accuracy : 88.81%
|----14th round Final Test Accuracy : 86.83%
|----15th round Final Test Accuracy : 88.85%
|----16th round Final Test Accuracy : 80.49%
|----17th round Final Test Accuracy : 88.61%
|----18th round Final Test Accuracy : 71.07%
|----19th round Final Test Accuracy : 88.56%
|----20th round Final Test Accuracy : 88.65%
|----21th round Final Test Accuracy : 80.29%
|----22th round Final Test Accuracy : 87.84%
|----23th round Final Test Accuracy : 88.46%
|----24th round Final Test Accuracy : 85.49%
|----25th round Final Test Accuracy : 88.46%
|----26th round Final Test Accuracy : 84.88%
|----27th round Final Test Accuracy : 88.61%
|----28th round Final Test Accuracy : 76.04%
|----29th round Final Test Accuracy : 88.33%
|----30th round Final Test Accuracy : 88.66%
|----31th round Final Test Accuracy : 85.39%
|----32th round Final Test Accuracy : 88.63%
|----33th round Final Test Accuracy : 88.41%
|----34th round Final Test Accuracy : 88.78%
|----35th round Final Test Accuracy : 88.50%
|----36th round Final Test Accuracy : 88.75%
|----37th round Final Test Accuracy : 88.55%
|----38th round Final Test Accuracy : 85.04%
|----39th round Final Test Accuracy : 88.81%
|----40th round Final Test Accuracy : 87.19%
|----41th round Final Test Accuracy : 88.59%
|----42th round Final Test Accuracy : 88.46%
|----43th round Final Test Accuracy : 86.77%
|----44th round Final Test Accuracy : 88.90%
|----45th round Final Test Accuracy : 88.78%
|----46th round Final Test Accuracy : 81.46%
|----47th round Final Test Accuracy : 88.84%
|----48th round Final Test Accuracy : 88.13%
|----49th round Final Test Accuracy : 81.12%
|----50th round Final Test Accuracy : 49.13%
|----51th round Final Test Accuracy : 84.17%
|----52th round Final Test Accuracy : 87.62%
|----53th round Final Test Accuracy : 87.15%
|----54th round Final Test Accuracy : 87.51%
|----55th round Final Test Accuracy : 88.47%
|----56th round Final Test Accuracy : 87.12%
|----57th round Final Test Accuracy : 88.76%
|----58th round Final Test Accuracy : 88.36%
|----59th round Final Test Accuracy : 88.42%
|----60th round Final Test Accuracy : 88.66%
|----61th round Final Test Accuracy : 88.65%
|----62th round Final Test Accuracy : 88.87%
|----63th round Final Test Accuracy : 88.64%
|----64th round Final Test Accuracy : 89.04%
|----65th round Final Test Accuracy : 88.93%
|----66th round Final Test Accuracy : 88.98%
|----67th round Final Test Accuracy : 89.07%
|----68th round Final Test Accuracy : 88.97%
|----69th round Final Test Accuracy : 89.27%
|----70th round Final Test Accuracy : 89.03%
|----71th round Final Test Accuracy : 89.14%
|----72th round Final Test Accuracy : 89.06%
|----73th round Final Test Accuracy : 88.77%
|----74th round Final Test Accuracy : 89.18%
|----75th round Final Test Accuracy : 89.08%
|----76th round Final Test Accuracy : 89.33%
|----77th round Final Test Accuracy : 89.33%
|----78th round Final Test Accuracy : 88.85%
|----79th round Final Test Accuracy : 89.13%
|----80th round Final Test Accuracy : 86.57%
|----81th round Final Test Accuracy : 89.26%
|----82th round Final Test Accuracy : 71.05%
|----83th round Final Test Accuracy : 89.16%
|----84th round Final Test Accuracy : 85.77%
|----85th round Final Test Accuracy : 89.17%
|----86th round Final Test Accuracy : 86.00%
|----87th round Final Test Accuracy : 89.31%
|----88th round Final Test Accuracy : 79.00%
|----89th round Final Test Accuracy : 89.14%
|----90th round Final Test Accuracy : 80.55%
|----91th round Final Test Accuracy : 89.29%
|----92th round Final Test Accuracy : 81.16%
|----93th round Final Test Accuracy : 88.94%
|----94th round Final Test Accuracy : 86.87%
|----95th round Final Test Accuracy : 89.07%
|----96th round Final Test Accuracy : 88.59%
|----97th round Final Test Accuracy : 88.80%
|----98th round Final Test Accuracy : 89.04%
|----99th round Final Test Accuracy : 83.70%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 100

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 22912.6386
