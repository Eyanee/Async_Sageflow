
Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
Files already downloaded and verified
Files already downloaded and verified
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
Files already downloaded and verified
Files already downloaded and verified
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13474.4193, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.4193, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.16475819051265717
current submit client idx and staleness is  1 1
distance 2 is tensor(13578.2759, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13578.2759, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13284634053707123
current submit client idx and staleness is  2 1
distance 2 is tensor(13478.6341, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.6341, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.17426930367946625
current submit client idx and staleness is  3 1
distance 2 is tensor(13492.3909, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.3909, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12164616584777832
current submit client idx and staleness is  4 1
distance 2 is tensor(13456.4855, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.4855, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.15467455983161926
current submit client idx and staleness is  5 1
distance 2 is tensor(13475.2612, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.2612, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.16139554977416992
current submit client idx and staleness is  6 1
distance 2 is tensor(13467.7950, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.7950, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12370935827493668
current submit client idx and staleness is  7 1
distance 2 is tensor(13468.1496, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.1496, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.14221590757369995
current submit client idx and staleness is  8 2
distance 2 is tensor(13502.5830, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.5830, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.17333117127418518
current submit client idx and staleness is  9 2
distance 2 is tensor(13482.2595, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.2595, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1378619223833084
current submit client idx and staleness is  10 2
distance 2 is tensor(13505.6760, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.6760, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1292412281036377
current submit client idx and staleness is  11 2
distance 2 is tensor(13496.5066, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.5066, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.14991286396980286
current submit client idx and staleness is  12 2
distance 2 is tensor(13488.0220, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.0220, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1669621765613556
current submit client idx and staleness is  13 2
distance 2 is tensor(13482.9663, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.9663, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.14707496762275696
current submit client idx and staleness is  14 2
distance 2 is tensor(13483.2126, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.2126, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12584498524665833
current submit client idx and staleness is  15 2
distance 2 is tensor(13490.2942, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.2942, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09615594148635864
current submit client idx and staleness is  16 3
distance 2 is tensor(13739.5276, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13739.5276, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.346859872341156
current submit client idx and staleness is  17 3
distance 2 is tensor(13542.4606, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13542.4606, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13187828660011292
current submit client idx and staleness is  18 3
distance 2 is tensor(13523.5285, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13523.5285, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11358145624399185
current submit client idx and staleness is  19 3
distance 2 is tensor(13659.1165, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13659.1165, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3747848868370056
current submit client idx and staleness is  20 3
distance 2 is tensor(13500.4807, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.4807, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3214960992336273
current submit client idx and staleness is  21 3
distance 2 is tensor(13688.5794, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13688.5794, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07096598297357559
current submit client idx and staleness is  22 3
distance 2 is tensor(13583.7401, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13583.7401, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.17338284850120544
current submit client idx and staleness is  23 3
distance 2 is tensor(13549.3597, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13549.3597, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.21955767273902893
current submit client idx and staleness is  24 4
distance 2 is tensor(13804.3542, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13804.3542, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.23420922458171844
current submit client idx and staleness is  25 4
distance 2 is tensor(13810.6616, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13810.6616, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.26624900102615356
current submit client idx and staleness is  26 4
distance 2 is tensor(13792.4620, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13792.4620, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.49146685004234314
current submit client idx and staleness is  27 4
distance 2 is tensor(13909.7535, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13909.7535, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.18767575919628143
current submit client idx and staleness is  28 4
distance 2 is tensor(13725.5035, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13725.5035, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13583430647850037
current submit client idx and staleness is  29 4
distance 2 is tensor(13810.9472, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13810.9472, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3021514415740967
current submit client idx and staleness is  30 4
distance 2 is tensor(13675.8327, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13675.8327, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07074616849422455
current submit client idx and staleness is  31 4
distance 2 is tensor(13806.5506, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13806.5506, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.277739018201828
current submit client idx and staleness is  32 5
distance 2 is tensor(13869.9564, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13869.9564, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.10615427792072296
current submit client idx and staleness is  33 5
distance 2 is tensor(13858.8334, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13858.8334, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6310574412345886
current submit client idx and staleness is  34 5
distance 2 is tensor(13944.3720, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13944.3720, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.42698702216148376
current submit client idx and staleness is  35 5
distance 2 is tensor(13833.0424, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13833.0424, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3654143512248993
current submit client idx and staleness is  36 5
distance 2 is tensor(13850.8295, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13850.8295, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.602590024471283
current submit client idx and staleness is  37 5
distance 2 is tensor(13830.6580, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13830.6580, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4899976849555969
current submit client idx and staleness is  38 5
distance 2 is tensor(13893.8187, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13893.8187, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2269420176744461
current submit client idx and staleness is  39 5
distance 2 is tensor(13840.7012, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13840.7012, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3138931691646576
current submit client idx and staleness is  40 6
distance 2 is tensor(13867.7891, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13867.7891, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4855256974697113
current submit client idx and staleness is  41 6
distance 2 is tensor(13829.1231, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13829.1231, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.33698663115501404
current submit client idx and staleness is  42 6
distance 2 is tensor(13887.9740, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13887.9740, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11346001923084259
current submit client idx and staleness is  43 6
distance 2 is tensor(13917.3545, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13917.3545, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4560103416442871
current submit client idx and staleness is  44 6
distance 2 is tensor(13877.4985, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13877.4985, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3144227862358093
current submit client idx and staleness is  45 6
distance 2 is tensor(13918.0213, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13918.0213, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.14035505056381226
current submit client idx and staleness is  46 6
distance 2 is tensor(13812.5980, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13812.5980, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3325081169605255
current submit client idx and staleness is  47 6
distance 2 is tensor(13879.0935, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13879.0935, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4511154294013977
current submit client idx and staleness is  48 1
distance 2 is tensor(13504.0566, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.0566, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13483.3465, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.3465, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13468.0734, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.0734, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13456.9199, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.9199, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13495.8333, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.8333, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13473.6676, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.6676, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13490.0217, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.0217, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13505.4473, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.4473, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13483.6985, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.6985, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13478.3956, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.3956, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13470.0915, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.0915, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13531.2546, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13531.2546, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
benign_acc is 0.9500000005
benign_loss is 0.1370861828327179
benign_entropy is 0.042831312865018845
benign_acc is 0.9500000005
benign_loss is 0.1766234189271927
benign_entropy is 0.03741852566599846
benign_acc is 0.9500000005
benign_loss is 0.08533413708209991
benign_entropy is 0.06323571503162384
benign_acc is 0.9500000005
benign_loss is 0.15608930587768555
benign_entropy is 0.0727386623620987
benign_acc is 0.9500000005
benign_loss is 0.13795217871665955
benign_entropy is 0.10299964249134064
sync_acc is 0.9500000005
sync_loss is 0.1397857815027237
sync_entropy is 0.04638006538152695
curent length is  8
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 76.48% 

Test Accuracy: 76.88% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13487.1650, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13487.1650, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1370885670185089
current submit client idx and staleness is  1 1
distance 2 is tensor(13483.7944, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.7944, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.18105864524841309
current submit client idx and staleness is  2 1
distance 2 is tensor(13475.0414, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.0414, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0990980714559555
current submit client idx and staleness is  3 1
distance 2 is tensor(13456.2355, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.2355, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1216328889131546
current submit client idx and staleness is  4 1
distance 2 is tensor(13451.8121, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13451.8121, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.10895975679159164
current submit client idx and staleness is  5 1
distance 2 is tensor(13462.3968, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.3968, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13868305087089539
current submit client idx and staleness is  6 1
distance 2 is tensor(13478.3686, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.3686, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1342650204896927
current submit client idx and staleness is  7 1
distance 2 is tensor(13481.1506, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.1506, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09756729006767273
current submit client idx and staleness is  48 1
distance 2 is tensor(13462.0609, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.0609, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13475.7696, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.7696, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13472.0335, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.0335, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13474.7325, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.7325, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13637.8384, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13637.8384, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13501.7068, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.7068, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13477.2815, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.2815, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13459.8487, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.8487, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13474.3540, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.3540, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13459.4392, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.4392, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13469.7186, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.7186, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13484.1446, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.1446, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
sync_acc is 0.9500000005
sync_loss is 0.12055313587188721
sync_entropy is 0.047693487256765366
curent length is  8
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 76.63% 

Test Accuracy: 76.49% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13458.5287, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.5287, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.14851626753807068
current submit client idx and staleness is  1 1
distance 2 is tensor(13505.5241, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.5241, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03576747328042984
current submit client idx and staleness is  2 1
distance 2 is tensor(13451.2021, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13451.2021, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09444525837898254
current submit client idx and staleness is  3 1
distance 2 is tensor(13439.2346, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13439.2346, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09812715649604797
current submit client idx and staleness is  4 1
distance 2 is tensor(13447.7618, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13447.7618, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.10451233386993408
current submit client idx and staleness is  5 1
distance 2 is tensor(13449.7376, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13449.7376, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.10579223930835724
current submit client idx and staleness is  6 1
distance 2 is tensor(13448.4462, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13448.4462, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08652131259441376
current submit client idx and staleness is  7 1
distance 2 is tensor(13442.6845, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13442.6845, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09023407846689224
current submit client idx and staleness is  8 2
distance 2 is tensor(13510.3881, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13510.3881, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12263301759958267
current submit client idx and staleness is  9 2
distance 2 is tensor(13459.4855, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.4855, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12125352770090103
current submit client idx and staleness is  10 2
distance 2 is tensor(13462.3046, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.3046, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07746350765228271
current submit client idx and staleness is  11 2
distance 2 is tensor(13476.5413, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.5413, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11720993369817734
current submit client idx and staleness is  12 2
distance 2 is tensor(13458.0478, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.0478, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13178947567939758
current submit client idx and staleness is  13 2
distance 2 is tensor(13520.2780, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13520.2780, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2794229984283447
current submit client idx and staleness is  14 2
distance 2 is tensor(13798.6843, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13798.6843, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.7460319399833679
current submit client idx and staleness is  15 2
distance 2 is tensor(13465.6559, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.6559, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11631466448307037
current submit client idx and staleness is  48 1
distance 2 is tensor(13456.5972, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.5972, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13462.8656, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.8656, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13459.8931, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.8931, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13463.5509, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.5509, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13678.4537, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13678.4537, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13466.9510, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.9510, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13443.9380, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13443.9380, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13471.4579, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.4579, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13498.7811, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.7811, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13451.0395, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13451.0395, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13453.3392, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.3392, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13449.6828, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13449.6828, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
benign_acc is 0.9500000005
benign_loss is 0.13489104807376862
benign_entropy is 0.047298725694417953
sync_acc is 0.9500000005
sync_loss is 0.08458695560693741
sync_entropy is 0.05337229371070862
curent length is  8
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 76.66% 

Test Accuracy: 76.50% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13464.6098, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.6098, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.011634251102805138
current submit client idx and staleness is  1 1
distance 2 is tensor(13465.4779, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.4779, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09246028959751129
current submit client idx and staleness is  2 1
distance 2 is tensor(13456.2187, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.2187, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11031050980091095
current submit client idx and staleness is  3 1
distance 2 is tensor(13455.4348, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13455.4348, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1433769315481186
current submit client idx and staleness is  4 1
distance 2 is tensor(13462.1262, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.1262, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.10876548290252686
current submit client idx and staleness is  5 1
distance 2 is tensor(13446.9756, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13446.9756, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11601203680038452
current submit client idx and staleness is  6 1
distance 2 is tensor(13457.4624, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.4624, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13289812207221985
current submit client idx and staleness is  7 1
distance 2 is tensor(13451.2180, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13451.2180, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.062346696853637695
current submit client idx and staleness is  16 3
distance 2 is tensor(13497.8969, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.8969, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.18907174468040466
current submit client idx and staleness is  17 3
distance 2 is tensor(13847.9618, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13847.9618, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.23891977965831757
current submit client idx and staleness is  18 3
distance 2 is tensor(13497.3029, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.3029, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.18930955231189728
current submit client idx and staleness is  19 3
distance 2 is tensor(13476.5467, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.5467, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.18998658657073975
current submit client idx and staleness is  20 3
distance 2 is tensor(13572.9918, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13572.9918, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.39342623949050903
current submit client idx and staleness is  21 3
distance 2 is tensor(13459.8845, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.8845, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2004932463169098
current submit client idx and staleness is  22 3
distance 2 is tensor(13466.5335, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.5335, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07959668338298798
current submit client idx and staleness is  23 3
distance 2 is tensor(13486.6471, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.6471, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3078038990497589
current submit client idx and staleness is  48 1
distance 2 is tensor(13456.8826, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.8826, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13473.2868, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.2868, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13478.9599, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.9599, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13625.9723, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13625.9723, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13691.8830, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13691.8830, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13451.9420, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13451.9420, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13449.0316, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13449.0316, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13462.7701, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.7701, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13449.2637, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13449.2637, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13447.6377, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13447.6377, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13457.5997, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.5997, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13450.5322, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13450.5322, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
benign_acc is 0.9500000005
benign_loss is 0.17279189825057983
benign_entropy is 0.03485678881406784
sync_acc is 0.9500000005
sync_loss is 0.06351806223392487
sync_entropy is 0.05572020635008812
curent length is  8
the length of epoch_weights is  2
alpha 1 is [0, 2]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 76.67% 

Test Accuracy: 76.51% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13445.4445, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13445.4445, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11487291753292084
current submit client idx and staleness is  1 1
distance 2 is tensor(13460.5379, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.5379, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06757045537233353
current submit client idx and staleness is  2 1
distance 2 is tensor(13466.4350, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.4350, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.044129978865385056
current submit client idx and staleness is  3 1
distance 2 is tensor(13457.2385, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.2385, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0847989097237587
current submit client idx and staleness is  4 1
distance 2 is tensor(13443.6327, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13443.6327, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08326008915901184
current submit client idx and staleness is  5 1
distance 2 is tensor(13446.9274, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13446.9274, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08895386010408401
current submit client idx and staleness is  6 1
distance 2 is tensor(13495.7350, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.7350, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.016235176473855972
current submit client idx and staleness is  7 1
distance 2 is tensor(13460.4870, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.4870, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03978169709444046
current submit client idx and staleness is  8 2
distance 2 is tensor(13698.5203, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13698.5203, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2919589877128601
current submit client idx and staleness is  9 2
distance 2 is tensor(13465.3306, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.3306, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07911577820777893
current submit client idx and staleness is  10 2
distance 2 is tensor(13471.5190, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.5190, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06763105094432831
current submit client idx and staleness is  11 2
distance 2 is tensor(13659.3703, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13659.3703, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2550773024559021
current submit client idx and staleness is  12 2
distance 2 is tensor(13445.3875, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13445.3875, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07473853975534439
current submit client idx and staleness is  13 2
distance 2 is tensor(13469.3182, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.3182, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.045108720660209656
current submit client idx and staleness is  14 2
distance 2 is tensor(13455.7808, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13455.7808, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07183707505464554
current submit client idx and staleness is  15 2
distance 2 is tensor(13533.6834, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13533.6834, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11850502341985703
current submit client idx and staleness is  24 4
distance 2 is tensor(13893.5357, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13893.5357, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3196677267551422
current submit client idx and staleness is  25 4
distance 2 is tensor(13988.2104, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13988.2104, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2635778784751892
current submit client idx and staleness is  26 4
distance 2 is tensor(13906.9827, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13906.9827, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.48323503136634827
current submit client idx and staleness is  27 4
distance 2 is tensor(13803.3582, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13803.3582, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6422929167747498
current submit client idx and staleness is  28 4
distance 2 is tensor(13888.1906, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13888.1906, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.35461488366127014
current submit client idx and staleness is  29 4
distance 2 is tensor(13950.4803, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13950.4803, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4388402998447418
current submit client idx and staleness is  30 4
distance 2 is tensor(13880.7501, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13880.7501, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.601030707359314
current submit client idx and staleness is  31 4
distance 2 is tensor(13962.8651, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13962.8651, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3804621696472168
current submit client idx and staleness is  48 1
distance 2 is tensor(13456.5847, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.5847, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13789.1455, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13789.1455, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13660.5418, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13660.5418, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13462.4645, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.4645, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13467.6781, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.6781, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13501.9778, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.9778, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13464.3170, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.3170, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13461.8139, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.8139, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13463.1762, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.1762, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13455.4677, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13455.4677, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13456.6874, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.6874, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13453.8833, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.8833, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
benign_acc is 0.9500000005
benign_loss is 0.08436059206724167
benign_entropy is 0.055916693061590195
benign_acc is 0.9500000005
benign_loss is 0.13172148168087006
benign_entropy is 0.07925710827112198
sync_acc is 1.0000000005
sync_loss is 0.048954568803310394
sync_entropy is 0.05662132427096367
curent length is  8
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 76.50% 

Test Accuracy: 76.87% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13462.9191, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.9191, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06280983984470367
current submit client idx and staleness is  1 1
distance 2 is tensor(13463.0400, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.0400, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08718766272068024
current submit client idx and staleness is  2 1
distance 2 is tensor(13452.5746, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13452.5746, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08408475667238235
current submit client idx and staleness is  3 1
distance 2 is tensor(13459.5675, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.5675, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1172298789024353
current submit client idx and staleness is  4 1
distance 2 is tensor(13588.3735, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13588.3735, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03030027076601982
current submit client idx and staleness is  5 1
distance 2 is tensor(13459.5886, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.5886, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08438755571842194
current submit client idx and staleness is  6 1
distance 2 is tensor(13456.1234, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.1234, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05615009739995003
current submit client idx and staleness is  7 1
distance 2 is tensor(13458.8534, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.8534, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04741501435637474
current submit client idx and staleness is  32 5
distance 2 is tensor(13864.5584, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13864.5584, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03356805816292763
current submit client idx and staleness is  33 5
distance 2 is tensor(13913.8069, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13913.8069, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.39474359154701233
current submit client idx and staleness is  34 5
distance 2 is tensor(13967.6237, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13967.6237, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.44828397035598755
current submit client idx and staleness is  35 5
distance 2 is tensor(13983.5944, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13983.5944, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.7776480913162231
current submit client idx and staleness is  36 5
distance 2 is tensor(13971.2849, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13971.2849, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.47279611229896545
current submit client idx and staleness is  37 5
distance 2 is tensor(13986.2435, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13986.2435, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2662505507469177
current submit client idx and staleness is  38 5
distance 2 is tensor(13861.1650, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13861.1650, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.25571802258491516
current submit client idx and staleness is  39 5
distance 2 is tensor(13913.7725, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13913.7725, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.36725831031799316
current submit client idx and staleness is  48 1
distance 2 is tensor(13467.3396, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.3396, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13467.8861, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.8861, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13987.8646, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13987.8646, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13461.6609, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.6609, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13475.4223, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.4223, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13481.6782, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.6782, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13492.2480, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.2480, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13672.7477, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13672.7477, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13472.2957, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.2957, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13467.9184, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.9184, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13457.1442, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.1442, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13570.5443, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13570.5443, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
benign_acc is 0.9500000005
benign_loss is 0.10445044189691544
benign_entropy is 0.07702131569385529
sync_acc is 0.9500000005
sync_loss is 0.049497250467538834
sync_entropy is 0.04923444613814354
curent length is  8
the length of epoch_weights is  3
alpha 1 is [0, 3, 4]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 76.71% 

Test Accuracy: 76.52% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13547.9181, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13547.9181, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.14943647384643555
current submit client idx and staleness is  1 1
distance 2 is tensor(13453.5638, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.5638, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07218395918607712
current submit client idx and staleness is  2 1
distance 2 is tensor(13473.5191, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.5191, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.060116805136203766
current submit client idx and staleness is  3 1
distance 2 is tensor(13446.9129, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13446.9129, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06567233055830002
current submit client idx and staleness is  4 1
distance 2 is tensor(13442.0902, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13442.0902, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07250514626502991
current submit client idx and staleness is  5 1
distance 2 is tensor(13451.2668, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13451.2668, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08210450410842896
current submit client idx and staleness is  6 1
distance 2 is tensor(13468.0103, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.0103, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06641365587711334
current submit client idx and staleness is  7 1
distance 2 is tensor(13492.4826, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.4826, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04199804365634918
current submit client idx and staleness is  8 2
distance 2 is tensor(13501.9893, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.9893, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.046186599880456924
current submit client idx and staleness is  9 2
distance 2 is tensor(13471.7855, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.7855, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.055067867040634155
current submit client idx and staleness is  10 2
distance 2 is tensor(13488.7564, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.7564, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0684037059545517
current submit client idx and staleness is  11 2
distance 2 is tensor(13482.4240, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.4240, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12659330666065216
current submit client idx and staleness is  12 2
distance 2 is tensor(13622.4695, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13622.4695, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.21153219044208527
current submit client idx and staleness is  13 2
distance 2 is tensor(13487.9401, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13487.9401, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09952112287282944
current submit client idx and staleness is  14 2
distance 2 is tensor(13474.4717, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.4717, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07379475235939026
current submit client idx and staleness is  15 2
distance 2 is tensor(13482.8890, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.8890, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0058181630447506905
current submit client idx and staleness is  16 3
distance 2 is tensor(13515.0300, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13515.0300, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1030924916267395
current submit client idx and staleness is  17 3
distance 2 is tensor(13617.3317, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13617.3317, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03405727818608284
current submit client idx and staleness is  18 3
distance 2 is tensor(13751.0564, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13751.0564, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.37436366081237793
current submit client idx and staleness is  19 3
distance 2 is tensor(13766.0985, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13766.0985, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2809596359729767
current submit client idx and staleness is  20 3
distance 2 is tensor(13760.6951, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13760.6951, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.39899706840515137
current submit client idx and staleness is  21 3
distance 2 is tensor(13869.2347, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13869.2347, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4336525797843933
current submit client idx and staleness is  22 3
distance 2 is tensor(13559.0874, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13559.0874, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2811720669269562
current submit client idx and staleness is  23 3
distance 2 is tensor(13667.4673, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13667.4673, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2668846547603607
current submit client idx and staleness is  40 6
distance 2 is tensor(13890.7051, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13890.7051, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.435138076543808
current submit client idx and staleness is  41 6
distance 2 is tensor(13922.1133, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13922.1133, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5662070512771606
current submit client idx and staleness is  42 6
distance 2 is tensor(13954.2859, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13954.2859, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05691128224134445
current submit client idx and staleness is  43 6
distance 2 is tensor(13949.4615, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13949.4615, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.7210031747817993
current submit client idx and staleness is  44 6
distance 2 is tensor(13946.0326, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13946.0326, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5768069624900818
current submit client idx and staleness is  45 6
distance 2 is tensor(13969.2033, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13969.2033, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06556707620620728
current submit client idx and staleness is  46 6
distance 2 is tensor(13931.6039, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13931.6039, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4417714476585388
current submit client idx and staleness is  47 6
distance 2 is tensor(13867.9860, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13867.9860, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5971419215202332
current submit client idx and staleness is  48 1
distance 2 is tensor(13494.6940, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.6940, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13477.8967, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.8967, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13469.1244, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.1244, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13472.5069, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.5069, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13461.8183, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.8183, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13481.2686, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.2686, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13472.5786, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.5786, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13703.7563, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13703.7563, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13657.3910, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13657.3910, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13471.9682, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.9682, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13476.6641, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.6641, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13472.7412, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.7412, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(22996.6801, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(22996.6801, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830239.0422, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23008.5345, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23008.5345, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830238.6649, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23003.7806, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23003.7806, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830238.2829, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23009.7385, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23009.7385, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830237.1441, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23156.6958, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23156.6958, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830286.7252, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23029.1329, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23029.1329, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830239.5787, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23008.8772, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23008.8772, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830233.8795, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22992.4167, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(22992.4167, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830236.1814, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23005.5495, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23005.5495, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830238.4484, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22995.2260, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(22995.2260, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830238.6568, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23000.6550, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23000.6550, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830243.8689, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23015.6086, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23015.6086, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830234.6086, device='cuda:3', dtype=torch.float64)
batch acc is 0.03382000015639939
mal_rand_acc is 5e-10
mal_rand loss is 453914.25
len of model dicts is  12
distance 2 is tensor(22996.6801, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(22996.6801, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830239.0422, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23008.5345, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23008.5345, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830238.6649, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23003.7806, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23003.7806, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830238.2829, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23009.7385, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23009.7385, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830237.1441, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23156.6958, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23156.6958, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830286.7252, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23029.1329, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23029.1329, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830239.5787, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23008.8772, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23008.8772, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830233.8795, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22992.4167, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(22992.4167, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830236.1814, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23005.5495, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23005.5495, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830238.4484, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22995.2260, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(22995.2260, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830238.6568, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23000.6550, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23000.6550, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830243.8689, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23015.6086, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(23015.6086, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(830234.6086, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(23156.6958, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.0001, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0014508907143619644
distance 2 is tensor(15328300.8714, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(15328300.8714, device='cuda:3', dtype=torch.float64)
cal ratio is  0.03809056044856309
distance 2 is tensor(583863.5705, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(583863.5705, device='cuda:3', dtype=torch.float64)
cal ratio is  0.19516803138548422
distance 2 is tensor(113951.4819, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(113951.4819, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4417783025711914
distance 2 is tensor(50341.3104, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50341.3104, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6646639324655349
distance 2 is tensor(33460.1042, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33460.1042, device='cuda:3', dtype=torch.float64)
cal ratio is  0.815268619898382
distance 2 is tensor(27279.0029, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(27279.0029, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9029217711781297
distance 2 is tensor(24630.8209, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(24630.8209, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9502216634684143
distance 2 is tensor(23404.7470, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(23404.7470, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9747929850829096
distance 2 is tensor(22814.7878, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(22814.7878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22814.7878, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(22814.7878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22814.7878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22814.6315, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(22814.7878, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(22814.6315, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9982, device='cuda:3')
test acc is  0.9432800001563928
test loss is 0.2622175041055239
test entropy is  0.06098274307851287
________________________________
2
distance 2 is tensor(22814.6315, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(22814.6315, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22814.6315, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.06098274307851287
avg test loss is  0.2622175041055239
avg accuracy is  0.9432800001563928
solo acc is  0.9432800001563928
compute similarity  is  tensor(0.9982, device='cuda:3')
compute_distance is  tensor(22814.6315, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(853113.5176, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16573.0899, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.9281694669552776
avg test loss is  2.087225438383839
avg accuracy is  0.9045000001563944
solo acc is  0.10996000015639869
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16573.0899, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(849827.8086, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 2 is tensor(32113.6439, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  1.073359341496397
avg test loss is  0.8967238878045241
avg accuracy is  0.9348200001563931
solo acc is  0.6309400001564088
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(32113.6439, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(857588.8934, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47805.3667, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.8432019006108384
avg test loss is  2.006195620502657
avg accuracy is  0.9176600001563938
solo acc is  0.09322000015639875
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47805.3667, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(865408.6156, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 2 is tensor(63373.6930, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  1.0242495031460472
avg test loss is  0.8714690953874222
avg accuracy is  0.9372200001563931
solo acc is  0.6362600001564088
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63373.6930, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(873178.8237, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(79060.0266, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(79060.0266, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(79060.0266, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(79060.0266, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.08778000015639878
test loss is 1.9800904931314767
test entropy is  0.7976771842335801
________________________________
cal ratio is  0.5303784783243894
distance 2 is tensor(41931.7646, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41931.7646, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7282706395549589
distance 2 is tensor(30537.6618, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(30537.6618, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8533878991213522
distance 2 is tensor(26060.5208, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(26060.5208, device='cuda:3', dtype=torch.float64)
cal ratio is  0.923789083417333
distance 2 is tensor(24074.3845, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(24074.3845, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9611402712687136
distance 2 is tensor(23138.8953, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(23138.8953, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23138.8953, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(23138.8953, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23138.8953, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23131.7078, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(23138.8953, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(23131.7078, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9409600001563929
test loss is 0.20862863907058155
test entropy is  0.13226570841401358
________________________________
2
distance 2 is tensor(23131.7078, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(23131.7078, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(23131.7078, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.13226570841401358
avg test loss is  0.20862863907058155
avg accuracy is  0.9440400001563928
solo acc is  0.9409600001563929
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(23131.7078, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(853203.4842, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(39382.0496, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.8426126721874833
avg test loss is  2.0575636174062937
avg accuracy is  0.9182800001563938
solo acc is  0.09514000015639874
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(39382.0496, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(861203.6793, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 2 is tensor(54943.2392, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  1.0266312949950127
avg test loss is  0.8768802955937203
avg accuracy is  0.9379200001563929
solo acc is  0.6319800001564089
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(54943.2392, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(868972.9773, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(70637.7739, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7941537574886361
avg test loss is  2.000631708623198
avg accuracy is  0.9262200001563935
solo acc is  0.08684000015639878
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(70637.7739, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(876793.8578, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 2 is tensor(86210.7582, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.9928960349706127
avg test loss is  0.8534272493761214
avg accuracy is  0.9397600001563929
solo acc is  0.6420200001564089
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(86210.7582, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(884566.7690, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(101899.2899, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(101899.2899, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(101899.2899, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(101899.2899, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.08204000015639881
test loss is 1.9551363428840247
test entropy is  0.7666465320703014
________________________________
cal ratio is  0.46717413722187284
distance 2 is tensor(47604.7823, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47604.7823, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6835008818846329
distance 2 is tensor(32537.8607, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32537.8607, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8267417566717907
distance 2 is tensor(26900.3470, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(26900.3470, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9092544391668563
distance 2 is tensor(24459.3139, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(24459.3139, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9535472893609584
distance 2 is tensor(23323.1473, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(23323.1473, device='cuda:3', dtype=torch.float64)
cal ratio is  0.97649672931509
distance 2 is tensor(22774.9900, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(22774.9900, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22774.9900, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(22774.9900, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22774.9900, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22743.1150, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(22774.9900, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(22743.1150, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9431200001563927
test loss is 0.21579170154551724
test entropy is  0.09542779033512944
________________________________
2
distance 2 is tensor(22743.1150, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(22743.1150, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(22743.1150, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.09542779033512944
avg test loss is  0.21579170154551724
avg accuracy is  0.9441200001563927
solo acc is  0.9431200001563927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(22743.1150, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(853020.4233, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(39068.7738, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.8437992078264046
avg test loss is  2.063867679489848
avg accuracy is  0.9188200001563938
solo acc is  0.09366000015639875
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(39068.7738, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(861046.8908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 2 is tensor(54625.4080, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  1.0260158007407127
avg test loss is  0.8762934154561718
avg accuracy is  0.937800000156393
solo acc is  0.6310200001564089
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(54625.4080, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(868813.9513, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(70322.0532, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7919996555351541
avg test loss is  1.9947362940024842
avg accuracy is  0.9269200001563935
solo acc is  0.0859600001563988
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(70322.0532, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(876635.4995, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(85959.6384, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.7739818089301019
avg test loss is  1.9813398179190849
avg accuracy is  0.9288600001563934
solo acc is  0.08050000015639881
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(85959.6384, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(884433.9900, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(101592.8081, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(101592.8081, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9304200001563934
test loss is 1.9606447085700072
test entropy is  0.758548566599941
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.767701506614685
mal norm is  tensor(1126614.7500, device='cuda:3')
distance 2 is tensor(101592.8081, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(101592.8081, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.036272723227739334
benign_entropy is 0.05333041027188301
benign_acc is 0.9500000005
benign_loss is 0.14386223256587982
benign_entropy is 0.05698475241661072
benign_acc is 0.9500000005
benign_loss is 0.12638461589813232
benign_entropy is 0.07767125219106674
sync_acc is 0.9500000005
sync_loss is 0.11880713701248169
sync_entropy is 0.056442707777023315
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 73.03% 

Test Accuracy: 72.42% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13557.2698, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13557.2698, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0765148252248764
current submit client idx and staleness is  1 1
distance 2 is tensor(13557.5398, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13557.5398, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08484283834695816
current submit client idx and staleness is  2 1
distance 2 is tensor(13561.4571, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13561.4571, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07344617694616318
current submit client idx and staleness is  3 1
distance 2 is tensor(13578.0582, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13578.0582, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07173516601324081
current submit client idx and staleness is  4 1
distance 2 is tensor(13547.5910, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13547.5910, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09255940467119217
current submit client idx and staleness is  5 1
distance 2 is tensor(13552.7166, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13552.7166, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07242081314325333
current submit client idx and staleness is  6 1
distance 2 is tensor(13583.5966, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13583.5966, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05314377695322037
current submit client idx and staleness is  7 1
distance 2 is tensor(13577.8020, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13577.8020, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02009698748588562
current submit client idx and staleness is  48 1
distance 2 is tensor(13582.7625, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13582.7625, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13586.0495, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13586.0495, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13586.1371, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13586.1371, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13579.0911, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13579.0911, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13595.5676, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13595.5676, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13596.0696, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13596.0696, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13572.3780, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13572.3780, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13578.3614, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13578.3614, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13604.2166, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13604.2166, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13581.9125, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13581.9125, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13621.3949, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13621.3949, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13577.7829, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13577.7829, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(47688.1867, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47688.1867, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834696.1319, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47680.6051, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47680.6051, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834696.1337, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47677.6578, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47677.6578, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834688.0521, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47688.1447, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47688.1447, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834692.2516, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47731.2393, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47731.2393, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834756.3548, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47694.9840, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47694.9840, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834696.5955, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47670.5006, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47670.5006, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834692.5216, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47694.0051, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47694.0051, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834691.5871, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47707.9457, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47707.9457, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834690.4554, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47665.0585, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47665.0585, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834692.7850, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47675.7565, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47675.7565, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834695.3717, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47672.7530, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47672.7530, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(834692.0689, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(47731.2393, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.0001, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0020830436042844724
distance 2 is tensor(22006779.5405, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(22006779.5405, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04564037296613843
distance 2 is tensor(1004397.5530, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1004397.5530, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21363608375346071
distance 2 is tensor(214575.5252, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(214575.5252, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4622078733174924
distance 2 is tensor(99178.4988, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(99178.4988, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6798587100225999
distance 2 is tensor(67427.3638, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(67427.3638, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8245354662942204
distance 2 is tensor(55596.2557, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55596.2557, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9080393296481316
distance 2 is tensor(50483.5877, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50483.5877, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9529109679878269
distance 2 is tensor(48106.3624, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48106.3624, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9761716077985209
distance 2 is tensor(46960.0660, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46960.0660, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46960.0660, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(46960.0660, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46960.0660, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46960.0660, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(46960.0660, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(46960.0660, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9926, device='cuda:3')
test acc is  0.9431800001563928
test loss is 0.2236355222583584
test entropy is  0.08748644227555016
________________________________
2
distance 2 is tensor(46960.0660, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(46960.0660, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46960.0660, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.08748644227555016
avg test loss is  0.2236355222583584
avg accuracy is  0.9431600001563928
solo acc is  0.9431800001563928
compute similarity  is  tensor(0.9926, device='cuda:3')
compute_distance is  tensor(46960.0660, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(881923.0313, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16338.5719, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.83933841549527
avg test loss is  2.0600948108126746
avg accuracy is  0.8853600001563953
solo acc is  0.09204000015639875
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16338.5719, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(866483.5331, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 2 is tensor(31891.1592, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  1.0213917125673855
avg test loss is  0.8749810186645869
avg accuracy is  0.9272800001563933
solo acc is  0.6310200001564089
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31891.1592, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(874250.2929, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47588.7681, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7886076139672028
avg test loss is  1.9839953045406
avg accuracy is  0.9006600001563946
solo acc is  0.0853600001563988
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47588.7681, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(882073.1283, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63225.1779, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.7705585492388977
avg test loss is  1.965829119810363
avg accuracy is  0.9043200001563944
solo acc is  0.0803800001563988
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63225.1779, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(889871.4916, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78858.0159, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78858.0159, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78858.0159, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78858.0159, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.07694000015639883
test loss is 1.9415392746096072
test entropy is  0.7559545627792778
________________________________
cal ratio is  0.7624379556526326
distance 2 is tensor(60124.3525, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(60124.3525, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8731768737979317
distance 2 is tensor(52499.1633, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52499.1633, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9344396110821462
distance 2 is tensor(49057.3183, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(49057.3183, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9666639641754259
distance 2 is tensor(47421.9535, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47421.9535, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47421.9535, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(47421.9535, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47421.9535, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47395.7035, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(47421.9535, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(47395.7035, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.8619800001563961
test loss is 0.4586828355403507
test entropy is  0.6131543925656077
________________________________
2
distance 2 is tensor(47395.7035, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(47395.7035, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47395.7035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.6131543925656077
avg test loss is  0.4586828355403507
avg accuracy is  0.9353600001563931
solo acc is  0.8619800001563961
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47395.7035, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(882019.6527, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63278.1224, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7656178927177664
avg test loss is  1.9512744445325163
avg accuracy is  0.911220000156394
solo acc is  0.0826000001563988
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63278.1224, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(889897.2158, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78917.0671, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7518807688485021
avg test loss is  1.926861690743195
avg accuracy is  0.9137800001563939
solo acc is  0.07648000015639883
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(78917.0671, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(897696.7028, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(94551.4520, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7391696772764406
avg test loss is  1.9004112969883873
avg accuracy is  0.9162200001563939
solo acc is  0.07298000015639886
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(94551.4520, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(905494.3648, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(110186.4739, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.726919924511629
avg test loss is  1.8791215262754495
avg accuracy is  0.9180200001563938
solo acc is  0.06978000015639887
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(110186.4739, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(913292.2580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(125822.5428, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(125822.5428, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(125822.5428, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(125822.5428, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.0661800001563989
test loss is 1.8604620280473128
test entropy is  0.7153344014873895
________________________________
cal ratio is  0.6035985700433273
distance 2 is tensor(75946.2347, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(75946.2347, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7769164330256983
distance 2 is tensor(59003.8138, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59003.8138, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8814291099984367
distance 2 is tensor(52007.6358, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52007.6358, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9388449512531528
distance 2 is tensor(48827.0555, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48827.0555, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9689406221300504
distance 2 is tensor(47310.4894, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47310.4894, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47310.4894, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(47310.4894, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47310.4894, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47274.0832, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(47310.4894, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(47274.0832, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9335800001563932
test loss is 0.23021206570208033
test entropy is  0.22800627249814664
________________________________
2
distance 2 is tensor(47274.0832, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(47274.0832, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47274.0832, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.22800627249814664
avg test loss is  0.23021206570208033
avg accuracy is  0.9403600001563929
solo acc is  0.9335800001563932
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47274.0832, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(881984.6139, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63321.0473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7722174643403124
avg test loss is  1.9417112167838895
avg accuracy is  0.9128600001563939
solo acc is  0.0824600001563988
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63321.0473, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(889917.7188, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78954.6980, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7508048844306975
avg test loss is  1.9079677180560959
avg accuracy is  0.9163400001563939
solo acc is  0.07544000015639883
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(78954.6980, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(897714.4109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(94585.9998, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.735013618798512
avg test loss is  1.8776377832798092
avg accuracy is  0.9184400001563938
solo acc is  0.07136000015639886
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(94585.9998, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(905510.4467, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(110219.8232, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.7177158888343655
avg test loss is  1.8620153206693546
avg accuracy is  0.9206200001563937
solo acc is  0.0663600001563989
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(110219.8232, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(913307.6909, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(125855.9010, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(125855.9010, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9226000001563937
test loss is 1.8503404983779048
test entropy is  0.7013417102796647
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.5969048738479614
mal norm is  tensor(1400251.5000, device='cuda:3')
distance 2 is tensor(125855.9010, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(125855.9010, device='cuda:3', dtype=torch.float64)
sync_acc is 0.9500000005
sync_loss is 0.10574792325496674
sync_entropy is 0.057727962732315063
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [4, 6]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 75.67% 

Test Accuracy: 75.02% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13526.0278, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13526.0278, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.056875117123126984
current submit client idx and staleness is  1 1
distance 2 is tensor(13507.2035, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13507.2035, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06918423622846603
current submit client idx and staleness is  2 1
distance 2 is tensor(13525.3858, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13525.3858, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.056236326694488525
current submit client idx and staleness is  3 1
distance 2 is tensor(13539.6572, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13539.6572, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04574918746948242
current submit client idx and staleness is  4 1
distance 2 is tensor(13547.9397, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13547.9397, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0807659700512886
current submit client idx and staleness is  5 1
distance 2 is tensor(13521.2693, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13521.2693, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07102875411510468
current submit client idx and staleness is  6 1
distance 2 is tensor(13542.5862, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13542.5862, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02762848697602749
current submit client idx and staleness is  7 1
distance 2 is tensor(13515.3384, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13515.3384, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05957447737455368
current submit client idx and staleness is  8 2
distance 2 is tensor(13555.5579, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13555.5579, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.058340586721897125
current submit client idx and staleness is  9 2
distance 2 is tensor(13544.7265, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13544.7265, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05584098771214485
current submit client idx and staleness is  10 2
distance 2 is tensor(13541.3906, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13541.3906, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07269676774740219
current submit client idx and staleness is  11 2
distance 2 is tensor(13581.2654, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13581.2654, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03097221627831459
current submit client idx and staleness is  12 2
distance 2 is tensor(13514.4521, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13514.4521, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05806468054652214
current submit client idx and staleness is  13 2
distance 2 is tensor(13556.5565, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13556.5565, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.050674088299274445
current submit client idx and staleness is  14 2
distance 2 is tensor(13551.6634, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13551.6634, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.037857964634895325
current submit client idx and staleness is  15 2
distance 2 is tensor(13560.9568, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13560.9568, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0241648331284523
current submit client idx and staleness is  24 4
distance 2 is tensor(13671.2319, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13671.2319, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.21774177253246307
current submit client idx and staleness is  25 4
distance 2 is tensor(13780.3649, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13780.3649, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.19653922319412231
current submit client idx and staleness is  26 4
distance 2 is tensor(13817.9326, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13817.9326, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4390374720096588
current submit client idx and staleness is  27 4
distance 2 is tensor(13686.4274, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13686.4274, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.222234845161438
current submit client idx and staleness is  28 4
distance 2 is tensor(13737.5907, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13737.5907, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.25495973229408264
current submit client idx and staleness is  29 4
distance 2 is tensor(13709.2790, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13709.2790, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1509060114622116
current submit client idx and staleness is  30 4
distance 2 is tensor(13748.5971, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13748.5971, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3061409890651703
current submit client idx and staleness is  31 4
distance 2 is tensor(13616.5770, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13616.5770, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.39484038949012756
current submit client idx and staleness is  48 1
distance 2 is tensor(13553.1152, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13553.1152, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13558.1305, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13558.1305, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13541.2447, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13541.2447, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13537.7285, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13537.7285, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13532.6940, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13532.6940, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13591.6636, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13591.6636, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13535.0697, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13535.0697, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13546.2091, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13546.2091, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13568.6007, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13568.6007, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13515.2361, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13515.2361, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13546.0009, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13546.0009, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13609.1840, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13609.1840, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(51398.0222, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51398.0222, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838590.2203, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51415.7748, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51415.7748, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838596.3233, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51426.1099, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51426.1099, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838595.0941, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51415.9716, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51415.9716, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838640.5152, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51433.0387, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51433.0387, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838659.6894, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51397.8182, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51397.8182, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838596.5593, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51400.0797, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51400.0797, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838595.6035, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51405.5909, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51405.5909, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838591.8112, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51396.5527, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51396.5527, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838596.0111, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51377.0663, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51377.0663, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838590.8316, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51395.5347, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51395.5347, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838596.5740, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51397.7983, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51397.7983, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(838592.6291, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(51433.0387, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(9.7113e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0021623095143458227
distance 2 is tensor(22844228.1856, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(22844228.1856, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04650063920201161
distance 2 is tensor(1062271.2066, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1062271.2066, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21564006925733356
distance 2 is tensor(229068.2443, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(229068.2443, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4643706084244001
distance 2 is tensor(106372.5710, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(106372.5710, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6814474008811827
distance 2 is tensor(72487.3608, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(72487.3608, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8254979967621698
distance 2 is tensor(59838.1968, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59838.1968, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9085690082981105
distance 2 is tensor(54367.1477, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54367.1477, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9531887172836697
distance 2 is tensor(51822.1611, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51822.1611, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9763137540547515
distance 2 is tensor(50594.6921, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50594.6921, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50594.6921, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(50594.6921, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50594.6921, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50634.5358, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(50594.6921, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(50634.5358, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9915, device='cuda:3')
test acc is  0.9433400001563927
test loss is 0.22733472483015268
test entropy is  0.08104450474350292
________________________________
2
distance 2 is tensor(50634.5358, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(50634.5358, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50634.5358, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.08104450474350292
avg test loss is  0.22733472483015268
avg accuracy is  0.9433400001563927
solo acc is  0.9433400001563927
compute similarity  is  tensor(0.9915, device='cuda:3')
compute_distance is  tensor(50634.5358, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(889480.1527, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16349.7184, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.8409348337546639
avg test loss is  2.0468700579974963
avg accuracy is  0.8978800001563947
solo acc is  0.08928000015639877
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16349.7184, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(872242.2909, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 2 is tensor(31896.2835, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  1.014580011977564
avg test loss is  0.8669142097310947
avg accuracy is  0.9305800001563932
solo acc is  0.6355600001564089
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31896.2835, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(880006.2520, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47595.9192, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.787077011354744
avg test loss is  1.952552717817409
avg accuracy is  0.911500000156394
solo acc is  0.0838000001563988
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47595.9192, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(887829.6789, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63229.1512, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.767387443186377
avg test loss is  1.9279747641909764
avg accuracy is  0.9149400001563938
solo acc is  0.07862000015639882
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63229.1512, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(895626.6252, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78859.6178, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78859.6178, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78859.6178, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78859.6178, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.07544000015639883
test loss is 1.8969810812369636
test entropy is  0.7529876397546295
________________________________
cal ratio is  0.7914433487084175
distance 2 is tensor(62412.9266, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62412.9266, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8896309711523539
distance 2 is tensor(55524.4707, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55524.4707, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9432025237373624
distance 2 is tensor(52370.8674, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52370.8674, device='cuda:3', dtype=torch.float64)
cal ratio is  0.971185710606579
distance 2 is tensor(50861.8548, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50861.8548, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50861.8548, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(50861.8548, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50861.8548, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50851.2298, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(50861.8548, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(50851.2298, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.8578400001563964
test loss is 0.47644536345816024
test entropy is  0.6470095562126935
________________________________
2
distance 2 is tensor(50851.2298, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(50851.2298, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50851.2298, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.6470095562126935
avg test loss is  0.47644536345816024
avg accuracy is  0.9368200001563931
solo acc is  0.8578400001563964
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(50851.2298, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(889493.5517, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(66718.5814, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7592370331744709
avg test loss is  1.9012794851342125
avg accuracy is  0.9204000001563937
solo acc is  0.07916000015639882
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(66718.5814, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(897367.0014, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(82353.1797, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7432575032229314
avg test loss is  1.876293434206482
avg accuracy is  0.9226600001563936
solo acc is  0.07380000015639886
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(82353.1797, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(905164.7565, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(97985.9431, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7259988458565129
avg test loss is  1.8585771648475276
avg accuracy is  0.9245600001563935
solo acc is  0.06866000015639888
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(97985.9431, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(912961.9074, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(113620.4496, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.7084517107747704
avg test loss is  1.84799516368705
avg accuracy is  0.9265800001563935
solo acc is  0.06414000015639891
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(113620.4496, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(920759.8818, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(129256.9020, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(129256.9020, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(129256.9020, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(129256.9020, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.06012000015639895
test loss is 1.8447035514485195
test entropy is  0.6906886212051372
________________________________
cal ratio is  0.6181876097395433
distance 2 is tensor(79904.9949, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(79904.9949, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7862491763474834
distance 2 is tensor(62825.2244, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62825.2244, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8867070132666597
distance 2 is tensor(55707.4889, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55707.4889, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9416518768731974
distance 2 is tensor(52457.0635, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52457.0635, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9703874694483433
distance 2 is tensor(50903.7002, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50903.7002, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50903.7002, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(50903.7002, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50903.7002, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50898.7002, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(50903.7002, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(50898.7002, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9359000001563931
test loss is 0.22153708638618594
test entropy is  0.21185391480603333
________________________________
2
distance 2 is tensor(50898.7002, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(50898.7002, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50898.7002, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.21185391480603333
avg test loss is  0.22153708638618594
avg accuracy is  0.9417800001563927
solo acc is  0.9359000001563931
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(50898.7002, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(889547.9984, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(66957.9040, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7618581472760271
avg test loss is  1.8945259589063541
avg accuracy is  0.9216600001563936
solo acc is  0.07926000015639882
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(66957.9040, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(897485.9360, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(82587.2007, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7356107879782576
avg test loss is  1.8637280185204332
avg accuracy is  0.9243000001563935
solo acc is  0.07044000015639887
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(82587.2007, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(905280.8735, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(98217.4773, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7107827991933164
avg test loss is  1.8531800529840963
avg accuracy is  0.9266800001563935
solo acc is  0.0644800001563989
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(98217.4773, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(913076.7722, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(113851.0870, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(113851.0870, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(113851.0870, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9283600001563934
test loss is 1.8538273524140458
test entropy is  0.6868921426860878
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.5667492151260376
mal norm is  tensor(1265650.6250, device='cuda:3')
distance 2 is tensor(113851.0870, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(113851.0870, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.040217116475105286
benign_entropy is 0.05587131530046463
benign_acc is 0.9500000005
benign_loss is 0.12314554303884506
benign_entropy is 0.06957005709409714
sync_acc is 0.9500000005
sync_loss is 0.09791343659162521
sync_entropy is 0.054183926433324814
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [6]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 75.42% 

Test Accuracy: 74.67% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13527.5584, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13527.5584, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0757436752319336
current submit client idx and staleness is  1 1
distance 2 is tensor(13544.3544, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13544.3544, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06865668296813965
current submit client idx and staleness is  2 1
distance 2 is tensor(13531.6430, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13531.6430, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02553955838084221
current submit client idx and staleness is  3 1
distance 2 is tensor(13532.9839, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13532.9839, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05086154863238335
current submit client idx and staleness is  4 1
distance 2 is tensor(13516.5877, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13516.5877, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08105555176734924
current submit client idx and staleness is  5 1
distance 2 is tensor(13554.0244, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13554.0244, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.026881953701376915
current submit client idx and staleness is  6 1
distance 2 is tensor(13613.3577, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13613.3577, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2728675305843353
current submit client idx and staleness is  7 1
distance 2 is tensor(13532.1497, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13532.1497, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03762730211019516
current submit client idx and staleness is  16 3
distance 2 is tensor(13594.5446, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13594.5446, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.27987486124038696
current submit client idx and staleness is  17 3
distance 2 is tensor(13590.5948, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13590.5948, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07325135916471481
current submit client idx and staleness is  18 3
distance 2 is tensor(13597.1613, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13597.1613, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.15857547521591187
current submit client idx and staleness is  19 3
distance 2 is tensor(13596.7582, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13596.7582, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09191522747278214
current submit client idx and staleness is  20 3
distance 2 is tensor(13616.1175, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13616.1175, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1199539303779602
current submit client idx and staleness is  21 3
distance 2 is tensor(13637.3660, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13637.3660, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008661577478051186
current submit client idx and staleness is  22 3
distance 2 is tensor(13606.2323, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13606.2323, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06654699891805649
current submit client idx and staleness is  23 3
distance 2 is tensor(13622.8695, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13622.8695, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.19517134130001068
current submit client idx and staleness is  48 1
distance 2 is tensor(13568.6686, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13568.6686, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13565.6671, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13565.6671, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13583.9042, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13583.9042, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13563.2563, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13563.2563, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13548.4171, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13548.4171, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13567.2711, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13567.2711, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13557.8452, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13557.8452, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13559.6640, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13559.6640, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13565.0411, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13565.0411, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13541.6462, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13541.6462, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13548.0169, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13548.0169, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13574.1894, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13574.1894, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(63070.5820, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63070.5820, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842017.5445, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63172.1205, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63172.1205, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842110.9321, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63064.8774, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63064.8774, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842079.9630, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63035.9942, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63035.9942, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842015.8913, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63078.1845, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63078.1845, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842017.6913, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63100.5953, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63100.5953, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842014.5300, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63068.0743, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63068.0743, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842017.2077, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63063.6965, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63063.6965, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842012.3706, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63071.6079, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63071.6079, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842019.7447, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63064.8781, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63064.8781, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842018.0188, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63067.4596, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63067.4596, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842017.2236, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63059.9988, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(63059.9988, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(842014.4732, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(63172.1205, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(9.1767e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.002396398919155497
distance 2 is tensor(25317364.2105, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(25317364.2105, device='cuda:3', dtype=torch.float64)
cal ratio is  0.048953027812436975
distance 2 is tensor(1239361.6102, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1239361.6102, device='cuda:3', dtype=torch.float64)
cal ratio is  0.22125331356855882
distance 2 is tensor(274212.8119, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(274212.8119, device='cuda:3', dtype=torch.float64)
cal ratio is  0.47037575910154045
distance 2 is tensor(128983.0003, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(128983.0003, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6858396133724938
distance 2 is tensor(88461.5899, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(88461.5899, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8281546278971907
distance 2 is tensor(73259.9047, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(73259.9047, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9100298306826874
distance 2 is tensor(66668.7101, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(66668.7101, device='cuda:3', dtype=torch.float64)
cal ratio is  0.953954755170676
distance 2 is tensor(63598.9417, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63598.9417, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9767060075500703
distance 2 is tensor(62117.4720, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62117.4720, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(62117.4720, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(62117.4720, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(62117.4720, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(62157.3158, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(62117.4720, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(62157.3158, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9876, device='cuda:3')
test acc is  0.9436400001563928
test loss is 0.2232995732117842
test entropy is  0.08545364520233839
________________________________
2
distance 2 is tensor(62157.3158, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(62157.3158, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(62157.3158, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.08545364520233839
avg test loss is  0.2232995732117842
avg accuracy is  0.9435800001563928
solo acc is  0.9436400001563928
compute similarity  is  tensor(0.9876, device='cuda:3')
compute_distance is  tensor(62157.3158, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(904472.1735, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16308.0383, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.8205007620327308
avg test loss is  2.0071440788791004
avg accuracy is  0.9011400001563945
solo acc is  0.08744000015639879
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16308.0383, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(881460.8540, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 2 is tensor(31854.6915, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.9915499302279919
avg test loss is  0.8410125243694276
avg accuracy is  0.9309400001563932
solo acc is  0.651500000156409
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31854.6915, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(889224.9610, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47549.1778, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7730284170878817
avg test loss is  1.8913875963072033
avg accuracy is  0.914240000156394
solo acc is  0.08046000015639881
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47549.1778, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(897046.5937, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63177.1556, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.7512899066328698
avg test loss is  1.865074195977672
avg accuracy is  0.9169400001563938
solo acc is  0.07422000015639885
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63177.1556, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(904841.6710, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78806.7491, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78806.7491, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78806.7491, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78806.7491, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.06782000015639889
test loss is 1.8560630147109556
test entropy is  0.7276554435415341
________________________________
cal ratio is  0.8774191260204501
distance 2 is tensor(69146.5326, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(69146.5326, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9367066424701616
distance 2 is tensor(64769.9905, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(64769.9905, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9678362550428552
distance 2 is tensor(62686.8000, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62686.8000, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(62686.8000, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(62686.8000, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(62686.8000, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(62674.4563, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(62686.8000, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(62674.4563, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.6261400001564088
test loss is 0.8619098230777189
test entropy is  0.8567514026256473
________________________________
grad,shape is torch.Size([11183582])
mal_acc is 0.8500000005
mal loss is 0.6573723554611206
mal norm is  tensor(695158.2500, device='cuda:3')
distance 2 is tensor(62686.8000, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(62686.8000, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.04071984440088272
benign_entropy is 0.05383288860321045
sync_acc is 0.9500000005
sync_loss is 0.11124370992183685
sync_entropy is 0.05727124214172363
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [5, 8]
alphas 3 is [1.  0.2 0.5]
alphas is  [0.58823529 0.11764706 0.29411765]
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 75.28% 

Test Accuracy: 74.64% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13552.8443, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13552.8443, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04613198712468147
current submit client idx and staleness is  1 1
distance 2 is tensor(13566.1879, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13566.1879, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05663606524467468
current submit client idx and staleness is  2 1
distance 2 is tensor(13555.3155, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13555.3155, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04934736341238022
current submit client idx and staleness is  3 1
distance 2 is tensor(13549.6281, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13549.6281, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.022799596190452576
current submit client idx and staleness is  4 1
distance 2 is tensor(13522.4044, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13522.4044, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00341198337264359
current submit client idx and staleness is  5 1
distance 2 is tensor(13539.8387, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13539.8387, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06020811200141907
current submit client idx and staleness is  6 1
distance 2 is tensor(13596.4958, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13596.4958, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.049533214420080185
current submit client idx and staleness is  7 1
distance 2 is tensor(13549.8951, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13549.8951, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.026786740869283676
current submit client idx and staleness is  8 2
distance 2 is tensor(13562.0731, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13562.0731, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.034795574843883514
current submit client idx and staleness is  9 2
distance 2 is tensor(13580.8639, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13580.8639, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.036061353981494904
current submit client idx and staleness is  10 2
distance 2 is tensor(13566.0338, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13566.0338, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05343031883239746
current submit client idx and staleness is  11 2
distance 2 is tensor(13587.5000, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13587.5000, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009704881347715855
current submit client idx and staleness is  12 2
distance 2 is tensor(13584.3870, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13584.3870, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07316242158412933
current submit client idx and staleness is  13 2
distance 2 is tensor(13601.2916, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13601.2916, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.21135249733924866
current submit client idx and staleness is  14 2
distance 2 is tensor(13549.7191, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13549.7191, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.037992097437381744
current submit client idx and staleness is  15 2
distance 2 is tensor(13581.5094, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13581.5094, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.025502953678369522
current submit client idx and staleness is  32 5
distance 2 is tensor(13840.5852, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13840.5852, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3144604563713074
current submit client idx and staleness is  33 5
distance 2 is tensor(13831.5934, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13831.5934, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.18387660384178162
current submit client idx and staleness is  34 5
distance 2 is tensor(13817.8343, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13817.8343, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3056580424308777
current submit client idx and staleness is  35 5
distance 2 is tensor(13824.7355, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13824.7355, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11816458404064178
current submit client idx and staleness is  36 5
distance 2 is tensor(13812.5509, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13812.5509, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6423905491828918
current submit client idx and staleness is  37 5
distance 2 is tensor(13807.7779, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13807.7779, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03166763111948967
current submit client idx and staleness is  38 5
distance 2 is tensor(13841.4750, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13841.4750, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.014674397185444832
current submit client idx and staleness is  39 5
distance 2 is tensor(13791.1261, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13791.1261, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3782820999622345
current submit client idx and staleness is  48 1
distance 2 is tensor(13601.0373, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13601.0373, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13583.9921, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13583.9921, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13557.8486, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13557.8486, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13580.1343, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13580.1343, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13575.2823, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13575.2823, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13581.5112, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13581.5112, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13598.7376, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13598.7376, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13564.9912, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13564.9912, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13630.2919, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13630.2919, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13578.6226, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13578.6226, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13563.9442, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13563.9442, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13543.5297, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13543.5297, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(64234.0372, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64234.0372, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845620.3318, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64232.6654, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64232.6654, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845619.6561, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64535.5521, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64535.5521, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845790.4146, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64215.3430, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64215.3430, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845618.1670, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64232.7527, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64232.7527, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845621.5113, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64237.6175, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64237.6175, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845619.0821, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64215.7841, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64215.7841, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845632.3928, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64273.0540, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64273.0540, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845682.0200, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64232.6255, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64232.6255, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845620.8579, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64221.7312, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64221.7312, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845620.0425, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64215.2217, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64215.2217, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845623.6555, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64305.7735, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64305.7735, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(845629.6610, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(64535.5521, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(9.0927e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0024221204162889042
distance 2 is tensor(25589126.5061, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(25589126.5061, device='cuda:3', dtype=torch.float64)
cal ratio is  0.049215041976576876
distance 2 is tensor(1259369.9093, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1259369.9093, device='cuda:3', dtype=torch.float64)
cal ratio is  0.2218446370478006
distance 2 is tensor(279384.4855, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(279384.4855, device='cuda:3', dtype=torch.float64)
cal ratio is  0.47100383984557787
distance 2 is tensor(131591.1146, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(131591.1146, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6862973274998393
distance 2 is tensor(90310.6258, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(90310.6258, device='cuda:3', dtype=torch.float64)
cal ratio is  0.828430661952209
distance 2 is tensor(74816.1429, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(74816.1429, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9101813518156201
distance 2 is tensor(68096.2883, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68096.2883, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9540340393969602
distance 2 is tensor(64966.1889, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(64966.1889, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9767465706236997
distance 2 is tensor(63455.5088, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63455.5088, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63455.5088, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(63455.5088, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63455.5088, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63495.1963, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(63455.5088, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(63495.1963, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9872, device='cuda:3')
test acc is  0.9439400001563928
test loss is 0.21837556124408788
test entropy is  0.08882653317533319
________________________________
2
distance 2 is tensor(63495.1963, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(63495.1963, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63495.1963, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.08882653317533319
avg test loss is  0.21837556124408788
avg accuracy is  0.9439200001563928
solo acc is  0.9439400001563928
compute similarity  is  tensor(0.9872, device='cuda:3')
compute_distance is  tensor(63495.1963, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(909320.3287, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16300.0356, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.8129469442855367
avg test loss is  1.982346458660672
avg accuracy is  0.9019200001563944
solo acc is  0.08662000015639879
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16300.0356, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(885637.3532, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31923.3172, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7803105450499698
avg test loss is  1.924728843714575
avg accuracy is  0.9088200001563941
solo acc is  0.08046000015639881
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31923.3172, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(893430.4554, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47544.7986, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7544788291387241
avg test loss is  1.8925585156816351
avg accuracy is  0.9129800001563939
solo acc is  0.07400000015639885
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47544.7986, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(901223.2675, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63170.4891, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.7334610387644804
avg test loss is  1.869586580397223
avg accuracy is  0.9157200001563938
solo acc is  0.06910000015639887
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63170.4891, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(909017.9572, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78799.2409, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78799.2409, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78799.2409, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78799.2409, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.06456000015639889
test loss is 1.8559511529515162
test entropy is  0.713168413056742
________________________________
cal ratio is  0.8868794127883486
distance 2 is tensor(69885.3671, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(69885.3671, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9417431398346614
distance 2 is tensor(65814.0583, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(65814.0583, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9704345604763697
distance 2 is tensor(63868.2732, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63868.2732, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63868.2732, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(63868.2732, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63868.2732, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63838.1170, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(63868.2732, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(63838.1170, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.5687800001564084
test loss is 0.9321101274331818
test entropy is  0.8601981047779093
________________________________
grad,shape is torch.Size([11183582])
mal_acc is 0.8000000005000001
mal loss is 0.7081397771835327
mal norm is  tensor(708326., device='cuda:3')
distance 2 is tensor(63868.2732, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(63868.2732, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.0393395721912384
benign_entropy is 0.0494842492043972
benign_acc is 0.9500000005
benign_loss is 0.0517834834754467
benign_entropy is 0.06801501661539078
sync_acc is 0.9500000005
sync_loss is 0.05803252384066582
sync_entropy is 0.06266014277935028
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 74.95% 

Test Accuracy: 74.23% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13562.7225, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13562.7225, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01632780022919178
current submit client idx and staleness is  1 1
distance 2 is tensor(13576.3511, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13576.3511, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010762272402644157
current submit client idx and staleness is  2 1
distance 2 is tensor(13587.7309, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13587.7309, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07193107903003693
current submit client idx and staleness is  3 1
distance 2 is tensor(13562.3014, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13562.3014, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.023750565946102142
current submit client idx and staleness is  4 1
distance 2 is tensor(13562.1044, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13562.1044, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008642095141112804
current submit client idx and staleness is  5 1
distance 2 is tensor(13588.7835, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13588.7835, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008086515590548515
current submit client idx and staleness is  6 1
distance 2 is tensor(13575.5003, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13575.5003, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002899737097322941
current submit client idx and staleness is  7 1
distance 2 is tensor(13563.8678, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13563.8678, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.023996971547603607
current submit client idx and staleness is  48 1
distance 2 is tensor(13619.6701, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13619.6701, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13619.1392, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13619.1392, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13588.3594, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13588.3594, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13589.2850, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13589.2850, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13639.6696, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13639.6696, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13601.8048, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13601.8048, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13570.3925, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13570.3925, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13580.9941, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13580.9941, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13616.3664, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13616.3664, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13535.2422, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13535.2422, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13601.8948, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13601.8948, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13583.3411, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13583.3411, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(82872.5469, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82872.5469, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848400.2482, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82866.1243, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82866.1243, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848398.0780, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82856.9730, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82856.9730, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848403.0113, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82852.6634, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82852.6634, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848400.0400, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82853.0503, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82853.0503, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848402.1183, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82872.9924, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82872.9924, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848399.0505, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82846.4669, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82846.4669, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848398.9010, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82905.6192, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82905.6192, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848472.7707, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82935.0767, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82935.0767, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848466.5669, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82864.8675, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82864.8675, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848403.0194, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82868.5603, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82868.5603, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848401.8822, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(82863.6818, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(82863.6818, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(848400.2566, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(82935.0767, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.4699e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0027457743506118302
distance 2 is tensor(29008518.5772, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(29008518.5772, device='cuda:3', dtype=torch.float64)
cal ratio is  0.05240013738183268
distance 2 is tensor(1520050.4885, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1520050.4885, device='cuda:3', dtype=torch.float64)
cal ratio is  0.22891075315045334
distance 2 is tensor(347955.9448, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(347955.9448, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4784461569408173
distance 2 is tensor(166478.2312, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(166478.2312, device='cuda:3', dtype=torch.float64)
cal ratio is  0.691697927520286
distance 2 is tensor(115152.6773, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(115152.6773, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8316836830657136
distance 2 is tensor(95770.5795, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(95770.5795, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9119670417505465
distance 2 is tensor(87339.6669, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(87339.6669, device='cuda:3', dtype=torch.float64)
cal ratio is  0.954969354732447
distance 2 is tensor(83406.7344, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(83406.7344, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9772251649360555
distance 2 is tensor(81507.1725, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(81507.1725, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(81507.1725, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(81507.1725, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(81507.1725, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(81546.5475, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(81507.1725, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(81546.5475, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9796, device='cuda:3')
test acc is  0.9433600001563928
test loss is 0.22094392755811396
test entropy is  0.09198565287706073
________________________________
2
distance 2 is tensor(81546.5475, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(81546.5475, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(81546.5475, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.09198565287706073
avg test loss is  0.22094392755811396
avg accuracy is  0.9433400001563927
solo acc is  0.9433600001563928
compute similarity  is  tensor(0.9796, device='cuda:3')
compute_distance is  tensor(81546.5475, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(930409.2410, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16241.8051, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7845148449511175
avg test loss is  1.9268172598250992
avg accuracy is  0.9007600001563946
solo acc is  0.0822000001563988
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16241.8051, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(897686.2991, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31864.7448, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7547639801983943
avg test loss is  1.8876098068169012
avg accuracy is  0.9058800001563942
solo acc is  0.07392000015639885
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(31864.7448, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(905480.4221, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47487.5507, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7322645935865925
avg test loss is  1.8590664288881795
avg accuracy is  0.9091000001563941
solo acc is  0.06880000015639888
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47487.5507, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(913274.6061, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63114.7511, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(63114.7511, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63114.7511, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(63114.7511, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(63114.7511, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.06280000015639892
test loss is 1.863500593568358
test entropy is  0.7032879196164553
________________________________
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.5621659755706787
mal norm is  tensor(699066.6250, device='cuda:3')
distance 2 is tensor(63114.7511, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(63114.7511, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.02774081565439701
sync_entropy is 0.05290026590228081
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [6, 8, 9, 10]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 76.96% 

Test Accuracy: 76.50% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13494.5029, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.5029, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03231963887810707
current submit client idx and staleness is  1 1
distance 2 is tensor(13508.9872, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13508.9872, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.012548575177788734
current submit client idx and staleness is  2 1
distance 2 is tensor(13570.3099, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13570.3099, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03145374730229378
current submit client idx and staleness is  3 1
distance 2 is tensor(13513.5418, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13513.5418, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07374846935272217
current submit client idx and staleness is  4 1
distance 2 is tensor(13482.2254, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.2254, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03575018793344498
current submit client idx and staleness is  5 1
distance 2 is tensor(13506.5395, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13506.5395, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03153407201170921
current submit client idx and staleness is  6 1
distance 2 is tensor(13535.5690, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13535.5690, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.012488541193306446
current submit client idx and staleness is  7 1
distance 2 is tensor(13538.5553, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13538.5553, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03116738237440586
current submit client idx and staleness is  8 2
distance 2 is tensor(13544.4677, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13544.4677, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007605723105370998
current submit client idx and staleness is  9 2
distance 2 is tensor(13520.9735, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13520.9735, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007535326294600964
current submit client idx and staleness is  10 2
distance 2 is tensor(13512.6846, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13512.6846, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.018348554149270058
current submit client idx and staleness is  11 2
distance 2 is tensor(13597.5182, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13597.5182, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.25512853264808655
current submit client idx and staleness is  12 2
distance 2 is tensor(13694.1928, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13694.1928, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13976392149925232
current submit client idx and staleness is  13 2
distance 2 is tensor(13726.7707, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13726.7707, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.35512876510620117
current submit client idx and staleness is  14 2
distance 2 is tensor(13510.3328, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13510.3328, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.015627939254045486
current submit client idx and staleness is  15 2
distance 2 is tensor(13521.6493, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13521.6493, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04215214401483536
current submit client idx and staleness is  16 3
distance 2 is tensor(13559.0286, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13559.0286, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.025537904351949692
current submit client idx and staleness is  17 3
distance 2 is tensor(13523.8694, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13523.8694, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13818325102329254
current submit client idx and staleness is  18 3
distance 2 is tensor(13755.6035, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13755.6035, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04328837990760803
current submit client idx and staleness is  19 3
distance 2 is tensor(13578.8815, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13578.8815, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06673450767993927
current submit client idx and staleness is  20 3
distance 2 is tensor(13539.0287, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13539.0287, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.022253399714827538
current submit client idx and staleness is  21 3
distance 2 is tensor(13536.8136, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13536.8136, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.062303610146045685
current submit client idx and staleness is  22 3
distance 2 is tensor(13534.5569, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13534.5569, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.019948817789554596
current submit client idx and staleness is  23 3
distance 2 is tensor(13557.1286, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13557.1286, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.011078144423663616
current submit client idx and staleness is  24 4
distance 2 is tensor(13852.2686, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13852.2686, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.43735256791114807
current submit client idx and staleness is  25 4
distance 2 is tensor(13569.1233, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13569.1233, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.22302846610546112
current submit client idx and staleness is  26 4
distance 2 is tensor(13853.4687, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13853.4687, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5805949568748474
current submit client idx and staleness is  27 4
distance 2 is tensor(13782.8963, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13782.8963, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.29415184259414673
current submit client idx and staleness is  28 4
distance 2 is tensor(13826.1943, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13826.1943, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.054062891751527786
current submit client idx and staleness is  29 4
distance 2 is tensor(13570.9303, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13570.9303, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03134234994649887
current submit client idx and staleness is  30 4
distance 2 is tensor(13787.1872, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13787.1872, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.27027109265327454
current submit client idx and staleness is  31 4
distance 2 is tensor(13915.4947, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13915.4947, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3810441195964813
current submit client idx and staleness is  40 6
distance 2 is tensor(13796.8061, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13796.8061, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3978270888328552
current submit client idx and staleness is  41 6
distance 2 is tensor(13799.6404, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13799.6404, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.22643911838531494
current submit client idx and staleness is  42 6
distance 2 is tensor(13784.2054, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13784.2054, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.40922990441322327
current submit client idx and staleness is  43 6
distance 2 is tensor(13861.5666, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13861.5666, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5671206712722778
current submit client idx and staleness is  44 6
distance 2 is tensor(13810.9463, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13810.9463, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.36186105012893677
current submit client idx and staleness is  45 6
distance 2 is tensor(13812.0073, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13812.0073, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11709082126617432
current submit client idx and staleness is  46 6
distance 2 is tensor(13894.6256, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13894.6256, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.10562751442193985
current submit client idx and staleness is  47 6
distance 2 is tensor(13823.2121, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13823.2121, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4334804117679596
current submit client idx and staleness is  48 1
distance 2 is tensor(13556.9267, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13556.9267, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13521.9780, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13521.9780, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13561.8750, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13561.8750, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13534.9414, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13534.9414, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13515.1265, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13515.1265, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13544.7461, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13544.7461, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13616.5055, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13616.5055, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13522.2465, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13522.2465, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13530.1274, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13530.1274, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13528.3198, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13528.3198, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13505.1029, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.1029, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13514.9345, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13514.9345, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(42207.4912, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42207.4912, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865096.5829, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42209.4167, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42209.4167, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865094.8936, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42211.3389, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42211.3389, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865096.0259, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42197.1881, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42197.1881, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865106.2814, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42219.3341, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42219.3341, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865096.9708, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42222.7821, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42222.7821, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865100.0900, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42194.4616, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42194.4616, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865097.1683, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42201.1534, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42201.1534, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865095.6739, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42226.8966, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42226.8966, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865095.0673, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42204.8691, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42204.8691, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865096.3811, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42243.3196, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42243.3196, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865100.6686, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42198.2406, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42198.2406, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(865093.9800, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(42243.3196, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(9.1345e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0019596336251356938
distance 2 is tensor(20703095.4605, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(20703095.4605, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04426775040694087
distance 2 is tensor(916479.5012, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(916479.5012, device='cuda:3', dtype=torch.float64)
cal ratio is  0.2103990221871002
distance 2 is tensor(192826.4234, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(192826.4234, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45869269311101046
distance 2 is tensor(88448.0406, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(88448.0406, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6772686713690648
distance 2 is tensor(59903.0827, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59903.0827, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8229633769011955
distance 2 is tensor(49298.0970, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(49298.0970, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9071727941113149
distance 2 is tensor(44721.9212, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44721.9212, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9524558841106806
distance 2 is tensor(42595.6717, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42595.6717, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9759382939037314
distance 2 is tensor(41570.7583, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41570.7583, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41570.7583, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(41570.7583, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41570.7583, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41610.4458, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(41570.7583, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(41610.4458, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9945, device='cuda:3')
test acc is  0.9454600001563926
test loss is 0.2228697070644548
test entropy is  0.07535717202275467
________________________________
2
distance 2 is tensor(41610.4458, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(41610.4458, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41610.4458, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.07535717202275467
avg test loss is  0.2228697070644548
avg accuracy is  0.9454600001563926
solo acc is  0.9454600001563926
compute similarity  is  tensor(0.9945, device='cuda:3')
compute_distance is  tensor(41610.4458, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(906896.9797, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16357.5228, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.8105089624062218
avg test loss is  1.953585635518174
avg accuracy is  0.913620000156394
solo acc is  0.08700000015639878
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16357.5228, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(894174.1979, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31976.8655, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7762577699121002
avg test loss is  1.8998203853816937
avg accuracy is  0.9184000001563938
solo acc is  0.07860000015639881
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31976.8655, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(901965.5970, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47597.9027, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.7485405892667258
avg test loss is  1.8737968150002267
avg accuracy is  0.9215400001563937
solo acc is  0.07180000015639887
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47597.9027, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(909758.4276, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63222.4246, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.7280231455860235
avg test loss is  1.850002933341219
avg accuracy is  0.9239400001563935
solo acc is  0.06754000015639887
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63222.4246, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(917552.7737, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78850.6529, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78850.6529, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78850.6529, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78850.6529, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.06250000015639892
test loss is 1.8469611897188074
test entropy is  0.7043127038747149
________________________________
cal ratio is  0.7173026710820116
distance 2 is tensor(56559.7822, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(56559.7822, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8469372430053973
distance 2 is tensor(47902.5475, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47902.5475, device='cuda:3', dtype=torch.float64)
cal ratio is  0.920292302915486
distance 2 is tensor(44084.4164, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44084.4164, device='cuda:3', dtype=torch.float64)
cal ratio is  0.959317897798127
distance 2 is tensor(42290.8951, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42290.8951, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9794486146831903
distance 2 is tensor(41421.7198, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41421.7198, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41421.7198, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(41421.7198, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41421.7198, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41402.8136, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(41421.7198, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(41402.8136, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9214200001563937
test loss is 0.2867241480513988
test entropy is  0.391152840021931
________________________________
2
distance 2 is tensor(41402.8136, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(41402.8136, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41402.8136, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.391152840021931
avg test loss is  0.2867241480513988
avg accuracy is  0.9420600001563928
solo acc is  0.9214200001563937
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(41402.8136, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(906724.5688, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(57361.0436, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7257107315618364
avg test loss is  1.8716274903863288
avg accuracy is  0.9267600001563935
solo acc is  0.06916000015639888
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(57361.0436, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(914629.9676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(72991.2789, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(72991.2789, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(72991.2789, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(72991.2789, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(72991.2789, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.060700000156398946
test loss is 1.8741308715947145
test entropy is  0.6945493095518683
________________________________
cal ratio is  0.7455376978678063
distance 2 is tensor(54417.8075, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54417.8075, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8634447932390799
distance 2 is tensor(46986.8103, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46986.8103, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9292169278228662
distance 2 is tensor(43660.9108, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43660.9108, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9639593033977097
distance 2 is tensor(42087.3767, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42087.3767, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42087.3767, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(42087.3767, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42087.3767, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42067.0642, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(42087.3767, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(42067.0642, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9152000001563938
test loss is 0.308635634067647
test entropy is  0.42963926856170226
________________________________
2
distance 2 is tensor(42067.0642, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(42067.0642, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42067.0642, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.42963926856170226
avg test loss is  0.308635634067647
avg accuracy is  0.9417600001563928
solo acc is  0.9152000001563938
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(42067.0642, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(907050.0260, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(57990.9245, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7139827580860508
avg test loss is  1.884169195466639
avg accuracy is  0.9285200001563934
solo acc is  0.0656600001563989
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(57990.9245, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(914943.7173, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(73620.5103, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6884255765191735
avg test loss is  1.8688441566799
avg accuracy is  0.9303600001563933
solo acc is  0.059480000156398954
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(73620.5103, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(922739.8616, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(89252.8591, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6717634047846051
avg test loss is  1.8487687010289457
avg accuracy is  0.9319000001563932
solo acc is  0.05526000015639901
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(89252.8591, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(930537.2844, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(104887.5965, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6574344255430314
avg test loss is  1.8312793209424714
avg accuracy is  0.9331400001563932
solo acc is  0.05224000015639905
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(104887.5965, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(938335.8439, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(120524.8732, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(120524.8732, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.934300000156393
test loss is 1.8060941110791453
test entropy is  0.6481141509759761
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.5030579566955566
mal norm is  tensor(1340333.2500, device='cuda:3')
distance 2 is tensor(120524.8732, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(120524.8732, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.03178742900490761
benign_entropy is 0.05142277106642723
benign_acc is 1.0000000005
benign_loss is 0.024011531844735146
benign_entropy is 0.04489554837346077
benign_acc is 0.9500000005
benign_loss is 0.1049720048904419
benign_entropy is 0.06496574729681015
benign_acc is 0.9500000005
benign_loss is 0.10227898508310318
benign_entropy is 0.11302478611469269
sync_acc is 0.9500000005
sync_loss is 0.0483686737716198
sync_entropy is 0.05767783150076866
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 76.34% 

Test Accuracy: 75.29% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13528.4810, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13528.4810, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02621723711490631
current submit client idx and staleness is  1 1
distance 2 is tensor(13539.3058, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13539.3058, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.017047060653567314
current submit client idx and staleness is  2 1
distance 2 is tensor(13538.6382, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13538.6382, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009195288643240929
current submit client idx and staleness is  3 1
distance 2 is tensor(13551.2594, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13551.2594, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010274712927639484
current submit client idx and staleness is  4 1
distance 2 is tensor(13514.4193, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13514.4193, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.015835251659154892
current submit client idx and staleness is  5 1
distance 2 is tensor(13537.3489, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13537.3489, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0066411844454705715
current submit client idx and staleness is  6 1
distance 2 is tensor(13529.7302, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13529.7302, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01241489127278328
current submit client idx and staleness is  7 1
distance 2 is tensor(13526.0319, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13526.0319, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005633070133626461
current submit client idx and staleness is  48 1
distance 2 is tensor(13553.8328, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13553.8328, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13571.5044, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13571.5044, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13557.1300, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13557.1300, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13562.9092, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13562.9092, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13577.3627, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13577.3627, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13559.9432, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13559.9432, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13571.4729, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13571.4729, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13564.3720, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13564.3720, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13621.3732, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13621.3732, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13558.9369, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13558.9369, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13549.7645, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13549.7645, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13583.4199, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13583.4199, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(61702.8707, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61702.8707, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870871.8491, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61709.6230, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61709.6230, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870867.7438, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61685.1956, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61685.1956, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870869.9227, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61683.0766, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61683.0766, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870867.8290, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61685.0972, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61685.0972, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870874.7819, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61740.5302, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61740.5302, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870884.8614, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61676.4407, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61676.4407, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870876.5814, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61717.1200, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61717.1200, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870915.0270, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61714.3573, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61714.3573, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870867.9137, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61667.4993, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61667.4993, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870877.3489, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61693.2151, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61693.2151, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870873.4191, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61744.2987, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(61744.2987, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(870873.5592, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(61744.2987, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.6140e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.002369155995151362
distance 2 is tensor(25029684.6113, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(25029684.6113, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04867397538898692
distance 2 is tensor(1218294.1693, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1218294.1693, device='cuda:3', dtype=torch.float64)
cal ratio is  0.220621800197951
distance 2 is tensor(268782.2033, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(268782.2033, device='cuda:3', dtype=torch.float64)
cal ratio is  0.46970399275727037
distance 2 is tensor(126248.1428, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(126248.1428, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6853493540599579
distance 2 is tensor(86524.1121, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(86524.1121, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8278581548778821
distance 2 is tensor(71629.6706, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(71629.6706, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9098672428838535
distance 2 is tensor(65173.5459, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(65173.5459, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9538692129795023
distance 2 is tensor(62167.0693, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62167.0693, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9766620432293865
distance 2 is tensor(60716.2312, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(60716.2312, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(60716.2312, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(60716.2312, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(60716.2312, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(60755.6062, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(60716.2312, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(60755.6062, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9888, device='cuda:3')
test acc is  0.9449200001563927
test loss is 0.2236815798499793
test entropy is  0.07768300871955483
________________________________
2
distance 2 is tensor(60755.6062, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(60755.6062, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(60755.6062, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.07768300871955483
avg test loss is  0.2236815798499793
avg accuracy is  0.9449200001563927
solo acc is  0.9449200001563927
compute similarity  is  tensor(0.9888, device='cuda:3')
compute_distance is  tensor(60755.6062, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(931957.0161, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16269.6355, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7741213512542607
avg test loss is  1.9045634940457161
avg accuracy is  0.9135200001563939
solo acc is  0.07832000015639883
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16269.6355, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(909634.1230, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31886.5390, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7380999681894737
avg test loss is  1.8673472511189064
avg accuracy is  0.9171000001563938
solo acc is  0.06960000015639888
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31886.5390, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(917425.5759, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47507.0169, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6903982014607286
avg test loss is  1.8982909244039785
avg accuracy is  0.9200000001563936
solo acc is  0.05910000015639896
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47507.0169, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(925218.7464, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63133.1840, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6772040105841654
avg test loss is  1.8626118567593568
avg accuracy is  0.9222600001563936
solo acc is  0.056280000156398995
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63133.1840, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(933014.1766, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78764.0839, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78764.0839, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78764.0839, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78764.0839, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.05342000015639902
test loss is 1.8337204736821793
test entropy is  0.6655658008649831
________________________________
cal ratio is  0.8676816116920151
distance 2 is tensor(68342.1212, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68342.1212, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9314944669639081
distance 2 is tensor(63660.2764, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63660.2764, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9651398480487822
distance 2 is tensor(61441.0686, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(61441.0686, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61441.0686, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(61441.0686, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61441.0686, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(61431.2249, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(61441.0686, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(61431.2249, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.6730000001564075
test loss is 0.7764258737606771
test entropy is  0.799608157037774
________________________________
grad,shape is torch.Size([11183582])
mal_acc is 0.8500000005
mal loss is 0.5475960969924927
mal norm is  tensor(681706.3125, device='cuda:3')
distance 2 is tensor(61441.0686, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(61441.0686, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.03584031015634537
sync_entropy is 0.05489988997578621
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [12]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 76.60% 

Test Accuracy: 75.89% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13497.7624, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.7624, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.012611860409379005
current submit client idx and staleness is  1 1
distance 2 is tensor(13491.8569, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.8569, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010721391066908836
current submit client idx and staleness is  2 1
distance 2 is tensor(13502.8068, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.8068, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00686084246262908
current submit client idx and staleness is  3 1
distance 2 is tensor(13515.3500, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13515.3500, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009774180129170418
current submit client idx and staleness is  4 1
distance 2 is tensor(13502.7173, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.7173, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.011898675002157688
current submit client idx and staleness is  5 1
distance 2 is tensor(13474.3609, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.3609, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0201121773570776
current submit client idx and staleness is  6 1
distance 2 is tensor(13486.5386, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.5386, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007324446924030781
current submit client idx and staleness is  7 1
distance 2 is tensor(13479.4810, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.4810, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009251892566680908
current submit client idx and staleness is  8 2
distance 2 is tensor(13507.5813, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13507.5813, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.015511426143348217
current submit client idx and staleness is  9 2
distance 2 is tensor(13526.4154, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13526.4154, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02333083376288414
current submit client idx and staleness is  10 2
distance 2 is tensor(13729.7687, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13729.7687, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09715119749307632
current submit client idx and staleness is  11 2
distance 2 is tensor(13748.2080, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13748.2080, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.29859504103660583
current submit client idx and staleness is  12 2
distance 2 is tensor(13546.5743, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13546.5743, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0173695869743824
current submit client idx and staleness is  13 2
distance 2 is tensor(13580.2014, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13580.2014, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12932023406028748
current submit client idx and staleness is  14 2
distance 2 is tensor(13531.3170, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13531.3170, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.011311249807476997
current submit client idx and staleness is  15 2
distance 2 is tensor(13520.0507, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13520.0507, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0125248609110713
current submit client idx and staleness is  48 1
distance 2 is tensor(13525.6887, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13525.6887, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13520.5453, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13520.5453, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13571.3195, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13571.3195, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13536.1582, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13536.1582, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13508.6221, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13508.6221, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13521.3422, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13521.3422, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13506.8786, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13506.8786, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13506.0993, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13506.0993, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13517.4353, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13517.4353, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13523.9626, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13523.9626, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13526.6210, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13526.6210, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13525.6579, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13525.6579, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(51757.4093, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51757.4093, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880093.4410, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51753.7290, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51753.7290, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880094.7143, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51778.8058, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51778.8058, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880097.2226, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51751.1132, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51751.1132, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880091.8438, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51746.1315, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51746.1315, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880098.6799, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51767.9967, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51767.9967, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880099.2020, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51752.3052, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51752.3052, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880097.1600, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51752.8365, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51752.8365, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880095.4454, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51759.9716, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51759.9716, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880096.0640, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51738.0819, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51738.0819, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880098.2754, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51750.4179, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51750.4179, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880100.4882, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51762.8319, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(51762.8319, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(880093.3340, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(51778.8058, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.6768e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.00216955699524792
distance 2 is tensor(22920976.2029, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(22920976.2029, device='cuda:3', dtype=torch.float64)
cal ratio is  0.046578503959811154
distance 2 is tensor(1067624.7563, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1067624.7563, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21582053894347436
distance 2 is tensor(230415.4083, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(230415.4083, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4645648335899926
distance 2 is tensor(107042.9750, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(107042.9750, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6815896784899844
distance 2 is tensor(72959.4217, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(72959.4217, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8255842497081349
distance 2 is tensor(60234.1277, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(60234.1277, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9086168324728194
distance 2 is tensor(54729.7996, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54729.7996, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9532134500015557
distance 2 is tensor(52169.2107, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52169.2107, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9763262303984994
distance 2 is tensor(50934.1824, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50934.1824, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50934.1824, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(50934.1824, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50934.1824, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50973.5574, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(50934.1824, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(50973.5574, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9922, device='cuda:3')
test acc is  0.9449400001563927
test loss is 0.23791838692230396
test entropy is  0.06769392111539946
________________________________
2
distance 2 is tensor(50973.5574, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(50973.5574, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50973.5574, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.06769392111539946
avg test loss is  0.23791838692230396
avg accuracy is  0.9449800001563926
solo acc is  0.9449400001563927
compute similarity  is  tensor(0.9922, device='cuda:3')
compute_distance is  tensor(50973.5574, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(931348.3748, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16310.9591, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7705384848825158
avg test loss is  1.8995275476094706
avg accuracy is  0.9145400001563938
solo acc is  0.07800000015639882
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16310.9591, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(913930.0979, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31928.6124, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7327168484020721
avg test loss is  1.87033532495084
avg accuracy is  0.9184400001563938
solo acc is  0.06842000015639889
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31928.6124, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(921722.1645, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47549.2611, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6827781123425954
avg test loss is  1.909740888249234
avg accuracy is  0.9209000001563936
solo acc is  0.05812000015639896
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47549.2611, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(929515.6882, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63175.8623, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6774289749772348
avg test loss is  1.8549834241342666
avg accuracy is  0.9236000001563935
solo acc is  0.05654000015639899
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63175.8623, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(937311.5754, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78806.9963, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78806.9963, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78806.9963, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78806.9963, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.05340000015639902
test loss is 1.826676158191603
test entropy is  0.6661660687240494
________________________________
cal ratio is  0.7943642728614736
distance 2 is tensor(62601.4507, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62601.4507, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8912712380082266
distance 2 is tensor(55794.9445, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55794.9445, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9440710183836256
distance 2 is tensor(52674.3251, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52674.3251, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9716337697016393
distance 2 is tensor(51180.1832, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51180.1832, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51180.1832, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(51180.1832, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51180.1832, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51180.1832, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(51180.1832, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(51180.1832, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.8734000001563957
test loss is 0.43388581182569497
test entropy is  0.5869536340389105
________________________________
2
distance 2 is tensor(51180.1832, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(51180.1832, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51180.1832, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.5869536340389105
avg test loss is  0.43388581182569497
avg accuracy is  0.939780000156393
solo acc is  0.8734000001563957
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(51180.1832, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(931365.3195, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(67035.8505, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.679922712276049
avg test loss is  1.8321147265336704
avg accuracy is  0.9280600001563933
solo acc is  0.05692000015639898
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(67035.8505, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(939237.8715, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(82670.4382, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6588961113901699
avg test loss is  1.8224695023063504
avg accuracy is  0.9295200001563934
solo acc is  0.05270000015639903
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(82670.4382, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(947036.7929, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(98306.1783, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6494078120917005
avg test loss is  1.7928766137193841
avg accuracy is  0.9308600001563933
solo acc is  0.05100000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(98306.1783, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(954836.4802, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(113943.4102, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(113943.4102, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(113943.4102, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(113943.4102, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(113943.4102, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04770000015639912
test loss is 1.794741643359289
test entropy is  0.6312316590562805
________________________________
cal ratio is  0.6606287713727681
distance 2 is tensor(75274.3427, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(75274.3427, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8127904731427147
distance 2 is tensor(61182.2418, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(61182.2418, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9015491274834067
distance 2 is tensor(55158.8175, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55158.8175, device='cuda:3', dtype=torch.float64)
cal ratio is  0.949499230654875
distance 2 is tensor(52373.2645, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52373.2645, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9744224203387976
distance 2 is tensor(51033.7479, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51033.7479, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51033.7479, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(51033.7479, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(51033.7479, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50999.2166, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(51033.7479, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(50999.2166, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9365800001563931
test loss is 0.22363467094705194
test entropy is  0.23026484136691178
________________________________
2
distance 2 is tensor(50999.2166, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(50999.2166, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(50999.2166, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.23026484136691178
avg test loss is  0.22363467094705194
avg accuracy is  0.9434800001563928
solo acc is  0.9365800001563931
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(50999.2166, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(931297.9928, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(66995.3955, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6584758950621271
avg test loss is  1.9065754306895653
avg accuracy is  0.9286400001563934
solo acc is  0.05146000015639905
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(66995.3955, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(939217.7657, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(82625.5543, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6562894777873592
avg test loss is  1.827312241124985
avg accuracy is  0.9305000001563933
solo acc is  0.050160000156399084
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(82625.5543, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(947014.3591, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(98259.8039, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6448753531784048
avg test loss is  1.791443041218516
avg accuracy is  0.9320400001563932
solo acc is  0.050180000156399084
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(98259.8039, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(954813.1961, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(113897.1309, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6183669804916967
avg test loss is  1.812378304693705
avg accuracy is  0.9332400001563932
solo acc is  0.04502000015639918
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(113897.1309, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(962613.6027, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(129536.4900, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(129536.4900, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.934300000156393
test loss is 1.7969337768871765
test entropy is  0.6092318927159395
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.456933856010437
mal norm is  tensor(1441397.7500, device='cuda:3')
distance 2 is tensor(129536.4900, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(129536.4900, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.028612026944756508
benign_entropy is 0.04977065324783325
sync_acc is 1.0000000005
sync_loss is 0.021129248663783073
sync_entropy is 0.04592306539416313
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [10, 12]
alphas 3 is [1.         0.2        0.33333333]
alphas is  [0.65217391 0.13043478 0.2173913 ]
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 77.03% 

Test Accuracy: 76.16% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13498.7312, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.7312, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.011375801637768745
current submit client idx and staleness is  1 1
distance 2 is tensor(13487.7070, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13487.7070, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.011526025831699371
current submit client idx and staleness is  2 1
distance 2 is tensor(13489.5949, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.5949, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007864927873015404
current submit client idx and staleness is  3 1
distance 2 is tensor(13519.1464, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13519.1464, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001019307761453092
current submit client idx and staleness is  4 1
distance 2 is tensor(13489.1574, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.1574, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010399074293673038
current submit client idx and staleness is  5 1
distance 2 is tensor(13539.8081, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13539.8081, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010915319435298443
current submit client idx and staleness is  6 1
distance 2 is tensor(13602.6718, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13602.6718, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.16281117498874664
current submit client idx and staleness is  7 1
distance 2 is tensor(13504.2627, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.2627, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00714671378955245
current submit client idx and staleness is  16 3
distance 2 is tensor(13647.5386, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13647.5386, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5262047648429871
current submit client idx and staleness is  17 3
distance 2 is tensor(13704.2649, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13704.2649, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.15807411074638367
current submit client idx and staleness is  18 3
distance 2 is tensor(13654.7444, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13654.7444, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.038268715143203735
current submit client idx and staleness is  19 3
distance 2 is tensor(13608.8899, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13608.8899, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02502022683620453
current submit client idx and staleness is  20 3
distance 2 is tensor(13550.4502, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13550.4502, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.20397083461284637
current submit client idx and staleness is  21 3
distance 2 is tensor(13556.4563, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13556.4563, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03435627371072769
current submit client idx and staleness is  22 3
distance 2 is tensor(13700.0559, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13700.0559, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0878404825925827
current submit client idx and staleness is  23 3
distance 2 is tensor(13585.9900, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13585.9900, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.18757519125938416
current submit client idx and staleness is  32 5
distance 2 is tensor(13842.3558, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13842.3558, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0320771299302578
current submit client idx and staleness is  33 5
distance 2 is tensor(13844.8969, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13844.8969, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.22699427604675293
current submit client idx and staleness is  34 5
distance 2 is tensor(13863.3868, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13863.3868, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5985939502716064
current submit client idx and staleness is  35 5
distance 2 is tensor(13895.7534, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13895.7534, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.7314279079437256
current submit client idx and staleness is  36 5
distance 2 is tensor(13873.1420, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13873.1420, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.8298546075820923
current submit client idx and staleness is  37 5
distance 2 is tensor(13862.7823, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13862.7823, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.35968613624572754
current submit client idx and staleness is  38 5
distance 2 is tensor(13765.2624, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13765.2624, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.37900567054748535
current submit client idx and staleness is  39 5
distance 2 is tensor(13826.2185, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13826.2185, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2575322985649109
current submit client idx and staleness is  48 1
distance 2 is tensor(13531.2619, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13531.2619, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13544.5496, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13544.5496, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13547.0438, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13547.0438, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13508.5443, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13508.5443, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13520.7031, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13520.7031, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13571.5773, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13571.5773, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13629.9401, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13629.9401, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13513.0495, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13513.0495, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13515.2021, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13515.2021, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13620.3118, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13620.3118, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13538.5328, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13538.5328, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13503.1701, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13503.1701, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(49222.2699, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49222.2699, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884273.1450, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49208.2676, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49208.2676, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884274.7225, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49183.6337, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49183.6337, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884274.8867, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49198.3656, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49198.3656, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884273.2880, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49198.9094, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49198.9094, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884277.0901, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49206.7956, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49206.7956, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884271.6219, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49249.9112, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49249.9112, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884300.5671, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49190.8056, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49190.8056, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884274.7146, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49251.8275, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49251.8275, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884273.0671, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49198.7501, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49198.7501, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884273.3042, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49187.7005, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49187.7005, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884273.9222, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(49173.6598, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(49173.6598, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(884284.3440, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(49251.8275, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.9590e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0021159534281509273
distance 2 is tensor(22354677.6245, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(22354677.6245, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04599949300172045
distance 2 is tensor(1028303.8036, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1028303.8036, device='cuda:3', dtype=torch.float64)
cal ratio is  0.2144749274223142
distance 2 is tensor(220545.4296, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(220545.4296, device='cuda:3', dtype=torch.float64)
cal ratio is  0.46311433011002245
distance 2 is tensor(102137.6711, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(102137.6711, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6805252991435842
distance 2 is tensor(69507.2582, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(69507.2582, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8249396384314716
distance 2 is tensor(57339.2477, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(57339.2477, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9082622321221229
distance 2 is tensor(52079.1165, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52079.1165, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9530275313454648
distance 2 is tensor(49632.8562, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(49632.8562, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9762310501008624
distance 2 is tensor(48453.1447, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48453.1447, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48453.1447, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(48453.1447, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48453.1447, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48492.6760, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(48453.1447, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(48492.6760, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9930, device='cuda:3')
test acc is  0.9462800001563927
test loss is 0.22731492484708632
test entropy is  0.06902419874722095
________________________________
2
distance 2 is tensor(48492.6760, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(48492.6760, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48492.6760, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.06902419874722095
avg test loss is  0.22731492484708632
avg accuracy is  0.9462800001563927
solo acc is  0.9462800001563927
compute similarity  is  tensor(0.9930, device='cuda:3')
compute_distance is  tensor(48492.6760, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(933011.8261, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16329.5074, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7648328160081068
avg test loss is  1.9274683698363926
avg accuracy is  0.9193200001563938
solo acc is  0.07614000015639884
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16329.5074, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(916836.3349, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31944.8213, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7254439467359381
avg test loss is  1.8925247424093963
avg accuracy is  0.9236800001563936
solo acc is  0.0665000001563989
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31944.8213, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(924626.8862, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47563.2045, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6824409103454532
avg test loss is  1.9104321239244602
avg accuracy is  0.9261000001563935
solo acc is  0.05726000015639898
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47563.2045, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(932419.0552, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63187.8679, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6756008826100918
avg test loss is  1.8557398508271903
avg accuracy is  0.9285000001563933
solo acc is  0.05592000015639899
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(63187.8679, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(940213.8365, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78817.7364, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78817.7364, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78817.7364, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78817.7364, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.05380000015639902
test loss is 1.8176377825724803
test entropy is  0.6672612704584361
________________________________
cal ratio is  0.7746852224488219
distance 2 is tensor(61058.9137, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(61058.9137, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8801622018199806
distance 2 is tensor(53741.7579, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(53741.7579, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9381695144318272
distance 2 is tensor(50418.8721, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50418.8721, device='cuda:3', dtype=torch.float64)
cal ratio is  0.968591575745957
distance 2 is tensor(48835.3446, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48835.3446, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48835.3446, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(48835.3446, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48835.3446, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48807.5321, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(48835.3446, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(48807.5321, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9030000001563944
test loss is 0.3572237050861044
test entropy is  0.5103674962392548
________________________________
2
distance 2 is tensor(48807.5321, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(48807.5321, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48807.5321, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.5103674962392548
avg test loss is  0.3572237050861044
avg accuracy is  0.9420200001563928
solo acc is  0.9030000001563944
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(48807.5321, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(933083.8280, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(64687.8254, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.661738427322539
avg test loss is  1.8850378930721137
avg accuracy is  0.9315600001563932
solo acc is  0.053120000156399026
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(64687.8254, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(940962.6812, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(80320.5535, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6551500354581477
avg test loss is  1.8309564694114353
avg accuracy is  0.9331200001563932
solo acc is  0.05230000015639904
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(80320.5535, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(948760.5375, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(95955.1145, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6489357276036002
avg test loss is  1.7908722384811362
avg accuracy is  0.934300000156393
solo acc is  0.05152000015639906
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(95955.1145, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(956559.4929, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(111592.2095, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6276174955965613
avg test loss is  1.7980135264603987
avg accuracy is  0.9356000001563931
solo acc is  0.04720000015639913
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(111592.2095, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(964359.6952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(127231.0532, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(127231.0532, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(127231.0532, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(127231.0532, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.045040000156399175
test loss is 1.7908601777632829
test entropy is  0.6151375121930066
________________________________
cal ratio is  0.6097343884563059
distance 2 is tensor(77577.1186, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(77577.1186, device='cuda:3', dtype=torch.float64)
cal ratio is  0.780855058763641
distance 2 is tensor(60576.5471, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(60576.5471, device='cuda:3', dtype=torch.float64)
cal ratio is  0.883659586168662
distance 2 is tensor(53529.0923, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(53529.0923, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9400312929972087
distance 2 is tensor(50318.9519, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50318.9519, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9695527829356281
distance 2 is tensor(48786.8217, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48786.8217, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48786.8217, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(48786.8217, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48786.8217, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48761.9780, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(48786.8217, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(48761.9780, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9419600001563928
test loss is 0.20223482629246153
test entropy is  0.17412927412354123
________________________________
2
distance 2 is tensor(48761.9780, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(48761.9780, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(48761.9780, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.17412927412354123
avg test loss is  0.20223482629246153
avg accuracy is  0.9454200001563926
solo acc is  0.9419600001563928
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(48761.9780, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(933089.8596, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(64812.2484, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6598919415108079
avg test loss is  1.9226064117973114
avg accuracy is  0.9315200001563932
solo acc is  0.05098000015639906
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(64812.2484, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(941025.0430, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(80437.8085, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6599557224441978
avg test loss is  1.8222367566869693
avg accuracy is  0.9336000001563932
solo acc is  0.050880000156399055
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(80437.8085, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(948819.1728, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(96070.6087, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(96070.6087, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(96070.6087, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9352600001563931
test loss is 1.825455962544512
test entropy is  0.6319526663750333
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.4728344678878784
mal norm is  tensor(1067098.1250, device='cuda:3')
distance 2 is tensor(96070.6087, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(96070.6087, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.029783448204398155
benign_entropy is 0.055903322994709015
benign_acc is 0.9500000005
benign_loss is 0.09147559106349945
benign_entropy is 0.09734880924224854
sync_acc is 1.0000000005
sync_loss is 0.01153273694217205
sync_entropy is 0.032851625233888626
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [12, 14]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 77.01% 

Test Accuracy: 76.44% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13495.8879, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.8879, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009253811091184616
current submit client idx and staleness is  1 1
distance 2 is tensor(13495.4905, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.4905, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.019038118422031403
current submit client idx and staleness is  2 1
distance 2 is tensor(13485.4433, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.4433, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.012026449665427208
current submit client idx and staleness is  3 1
distance 2 is tensor(13546.8719, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13546.8719, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13687127828598022
current submit client idx and staleness is  4 1
distance 2 is tensor(13485.8855, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.8855, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003383758245036006
current submit client idx and staleness is  5 1
distance 2 is tensor(13504.6087, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.6087, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07368168979883194
current submit client idx and staleness is  6 1
distance 2 is tensor(13502.9279, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.9279, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007753419224172831
current submit client idx and staleness is  7 1
distance 2 is tensor(13486.9332, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.9332, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005322764627635479
current submit client idx and staleness is  8 2
distance 2 is tensor(13700.2412, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13700.2412, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.17704640328884125
current submit client idx and staleness is  9 2
distance 2 is tensor(13543.9698, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13543.9698, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.39847034215927124
current submit client idx and staleness is  10 2
distance 2 is tensor(13483.2872, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.2872, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07097356021404266
current submit client idx and staleness is  11 2
distance 2 is tensor(13518.5221, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13518.5221, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003777641337364912
current submit client idx and staleness is  12 2
distance 2 is tensor(13501.7108, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.7108, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03489453345537186
current submit client idx and staleness is  13 2
distance 2 is tensor(13496.9225, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.9225, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00022712508507538587
current submit client idx and staleness is  14 2
distance 2 is tensor(13521.2661, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13521.2661, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005389141384512186
current submit client idx and staleness is  15 2
distance 2 is tensor(13521.7269, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13521.7269, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005741056054830551
current submit client idx and staleness is  24 4
distance 2 is tensor(13869.7697, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13869.7697, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5574004054069519
current submit client idx and staleness is  25 4
distance 2 is tensor(13901.7740, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13901.7740, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.43947744369506836
current submit client idx and staleness is  26 4
distance 2 is tensor(13791.0461, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13791.0461, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6151403188705444
current submit client idx and staleness is  27 4
distance 2 is tensor(13798.0729, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13798.0729, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4347684383392334
current submit client idx and staleness is  28 4
distance 2 is tensor(13823.6389, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13823.6389, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5912967920303345
current submit client idx and staleness is  29 4
distance 2 is tensor(13852.9293, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13852.9293, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5401525497436523
current submit client idx and staleness is  30 4
distance 2 is tensor(13736.6354, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13736.6354, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2627962529659271
current submit client idx and staleness is  31 4
distance 2 is tensor(13778.8956, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13778.8956, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.15505631268024445
current submit client idx and staleness is  48 1
distance 2 is tensor(13510.1969, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13510.1969, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13512.7468, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13512.7468, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13506.6000, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13506.6000, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13507.4060, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13507.4060, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13562.9754, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13562.9754, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13542.9165, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13542.9165, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13480.8218, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13480.8218, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13493.4562, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13493.4562, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13508.4860, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13508.4860, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13501.0644, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.0644, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13495.9794, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.9794, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13780.8495, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13780.8495, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(34693.1822, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34693.1822, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896336.8266, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34754.8305, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34754.8305, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896378.8882, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34668.1443, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34668.1443, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896335.1877, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34697.4562, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34697.4562, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896363.6476, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34715.8871, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34715.8871, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896334.6421, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34682.8479, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34682.8479, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896338.2308, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34653.4452, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34653.4452, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896338.4739, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34659.2886, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34659.2886, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896332.4560, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34695.0045, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34695.0045, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896335.0537, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34675.8491, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34675.8491, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896364.5320, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34678.1362, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34678.1362, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896336.8669, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34665.3851, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34665.3851, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(896336.9691, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(34754.8305, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.8531e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0017774701603108212
distance 2 is tensor(18778677.4528, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(18778677.4528, device='cuda:3', dtype=torch.float64)
cal ratio is  0.042160054311138825
distance 2 is tensor(791710.0161, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(791710.0161, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20532914240120276
distance 2 is tensor(162561.1120, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(162561.1120, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45313262526099873
distance 2 is tensor(73661.7480, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(73661.7480, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6731512440248997
distance 2 is tensor(49585.4408, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(49585.4408, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8204584152511848
distance 2 is tensor(40682.7202, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40682.7202, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9057923974113959
distance 2 is tensor(36850.1295, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(36850.1295, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9517308645673681
distance 2 is tensor(35071.4206, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35071.4206, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9755667366420544
distance 2 is tensor(34214.5184, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34214.5184, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34214.5184, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(34214.5184, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34214.5184, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34254.2059, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(34214.5184, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(34254.2059, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9965, device='cuda:3')
test acc is  0.9459800001563926
test loss is 0.23359060632538342
test entropy is  0.06561852910000916
________________________________
2
distance 2 is tensor(34254.2059, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(34254.2059, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34254.2059, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.06561852910000916
avg test loss is  0.23359060632538342
avg accuracy is  0.9459800001563926
solo acc is  0.9459800001563926
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(34254.2059, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(930708.8406, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16332.1473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7621107683004931
avg test loss is  1.9222927880104241
avg accuracy is  0.9200200001563938
solo acc is  0.07502000015639884
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16332.1473, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(921652.9780, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31947.5298, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.7226413104235364
avg test loss is  1.8904624985307075
avg accuracy is  0.9242000001563935
solo acc is  0.0650000001563989
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31947.5298, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(929443.4844, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47566.0976, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6832420514977496
avg test loss is  1.8968662018971065
avg accuracy is  0.9267800001563935
solo acc is  0.05772000015639897
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47566.0976, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(937235.7696, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63191.3924, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6735879712549927
avg test loss is  1.8505763710307344
avg accuracy is  0.9286200001563933
solo acc is  0.055260000156399
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63191.3924, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(945030.8313, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78821.8991, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78821.8991, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78821.8991, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78821.8991, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.05276000015639903
test loss is 1.821569232684572
test entropy is  0.6611825778813618
________________________________
cal ratio is  0.6507440648967043
distance 2 is tensor(51292.9144, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51292.9144, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8066868454096324
distance 2 is tensor(41377.3055, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41377.3055, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8981576227293475
distance 2 is tensor(37163.3254, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37163.3254, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9477119984329754
distance 2 is tensor(35220.1326, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35220.1326, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9735049624041978
distance 2 is tensor(34286.9840, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34286.9840, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34286.9840, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(34286.9840, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34286.9840, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34247.9215, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(34286.9840, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(34247.9215, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9368000001563931
test loss is 0.22404926578106973
test entropy is  0.2404957313347808
________________________________
2
distance 2 is tensor(34247.9215, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(34247.9215, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34247.9215, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.2404957313347808
avg test loss is  0.22404926578106973
avg accuracy is  0.9445800001563927
solo acc is  0.9368000001563931
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(34247.9215, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(930658.1986, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(50263.2548, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6670778356397243
avg test loss is  1.9329959199861493
avg accuracy is  0.9301800001563933
solo acc is  0.05420000015639902
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(50263.2548, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(938582.2730, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(65891.1009, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6689456867439972
avg test loss is  1.8379596634898954
avg accuracy is  0.9324600001563932
solo acc is  0.05416000015639902
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(65891.1009, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(946377.9608, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(81523.1625, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6577873444923049
avg test loss is  1.8021399711099122
avg accuracy is  0.9339000001563932
solo acc is  0.05288000015639903
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(81523.1625, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(954175.7909, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(97158.0924, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6430826580814083
avg test loss is  1.7860165904549992
avg accuracy is  0.9351200001563931
solo acc is  0.05028000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(97158.0924, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(961975.0421, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(112795.4381, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(112795.4381, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(112795.4381, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(112795.4381, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04484000015639918
test loss is 1.8145462721205123
test entropy is  0.6157004898771301
________________________________
cal ratio is  0.5439862159863236
distance 2 is tensor(61359.1070, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(61359.1070, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7375545517592258
distance 2 is tensor(45255.7314, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45255.7314, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8588095573656499
distance 2 is tensor(38865.9849, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(38865.9849, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9267206155790633
distance 2 is tensor(36017.9088, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(36017.9088, device='cuda:3', dtype=torch.float64)
cal ratio is  0.962663300834922
distance 2 is tensor(34673.1454, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34673.1454, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34673.1454, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(34673.1454, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34673.1454, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34635.3329, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(34673.1454, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(34635.3329, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9435800001563928
test loss is 0.20001483904501505
test entropy is  0.13099412647935818
________________________________
2
distance 2 is tensor(34635.3329, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(34635.3329, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34635.3329, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.13099412647935818
avg test loss is  0.20001483904501505
avg accuracy is  0.9458800001563926
solo acc is  0.9435800001563928
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(34635.3329, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(930867.5703, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(50748.3317, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6601107724944649
avg test loss is  1.9742539034170263
avg accuracy is  0.9296400001563934
solo acc is  0.05268000015639904
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(50748.3317, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(938824.1927, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(66370.4679, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6661079809488848
avg test loss is  1.8446574439782926
avg accuracy is  0.9327600001563933
solo acc is  0.052560000156399035
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(66370.4679, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(946617.0751, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(82000.3683, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6499883620940206
avg test loss is  1.8127635522266787
avg accuracy is  0.934420000156393
solo acc is  0.05078000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(82000.3683, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(954413.7391, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(97634.6323, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(97634.6323, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(97634.6323, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9360000001563931
test loss is 1.8090584986959881
test entropy is  0.6293018011333388
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.465299367904663
mal norm is  tensor(1084539.1250, device='cuda:3')
distance 2 is tensor(97634.6323, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(97634.6323, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.0005384102114476264
benign_entropy is 0.003482938976958394
benign_acc is 0.9500000005
benign_loss is 0.1319420337677002
benign_entropy is 0.09913205355405807
sync_acc is 1.0000000005
sync_loss is 0.02348400093615055
sync_entropy is 0.04511265084147453
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 76.60% 

Test Accuracy: 75.77% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13489.9881, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.9881, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008231068029999733
current submit client idx and staleness is  1 1
distance 2 is tensor(13496.1564, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.1564, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006958015263080597
current submit client idx and staleness is  2 1
distance 2 is tensor(13503.3034, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13503.3034, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008896938525140285
current submit client idx and staleness is  3 1
distance 2 is tensor(13498.9569, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.9569, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003531017806380987
current submit client idx and staleness is  4 1
distance 2 is tensor(13571.8570, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13571.8570, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0013434430584311485
current submit client idx and staleness is  5 1
distance 2 is tensor(13509.7812, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13509.7812, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003836236894130707
current submit client idx and staleness is  6 1
distance 2 is tensor(13489.0517, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.0517, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0020106497686356306
current submit client idx and staleness is  7 1
distance 2 is tensor(13496.6621, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.6621, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00802177656441927
current submit client idx and staleness is  48 1
distance 2 is tensor(13512.8377, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13512.8377, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13502.7282, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.7282, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13522.2237, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13522.2237, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13513.4127, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13513.4127, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13751.8075, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13751.8075, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13558.1566, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13558.1566, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13498.8666, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.8666, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13494.0370, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.0370, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13512.5129, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13512.5129, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13890.6080, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13890.6080, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13521.1187, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13521.1187, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13521.6025, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13521.6025, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(64872.7272, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64872.7272, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892807.1337, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64843.5425, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64843.5425, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892809.5087, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64882.3700, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64882.3700, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892812.0182, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64854.3712, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64854.3712, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892810.9431, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64837.7818, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64837.7818, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892808.8286, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64866.3993, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64866.3993, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892810.7805, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64997.1855, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64997.1855, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892876.7775, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64841.0549, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64841.0549, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892804.9008, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64850.3459, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64850.3459, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892810.0072, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64848.7561, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64848.7561, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892809.9310, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64836.0661, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64836.0661, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892815.2989, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64833.7692, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(64833.7692, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(892808.7772, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(64997.1855, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.7017e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0024307569284693817
distance 2 is tensor(25680601.2796, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(25680601.2796, device='cuda:3', dtype=torch.float64)
cal ratio is  0.049302706111575514
distance 2 is tensor(1266123.0586, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1266123.0586, device='cuda:3', dtype=torch.float64)
cal ratio is  0.2220421338180287
distance 2 is tensor(281132.6438, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(281132.6438, device='cuda:3', dtype=torch.float64)
cal ratio is  0.47121348774179617
distance 2 is tensor(132473.5240, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(132473.5240, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6864498377838685
distance 2 is tensor(90936.4963, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(90936.4963, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8285223774448034
distance 2 is tensor(75342.9829, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(75342.9829, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9102316786989058
distance 2 is tensor(68579.5106, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68579.5106, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9540610385011105
distance 2 is tensor(65429.0796, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(65429.0796, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9767601786959786
distance 2 is tensor(63908.5381, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63908.5381, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63908.5381, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(63908.5381, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63908.5381, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63947.6006, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(63908.5381, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(63947.6006, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9883, device='cuda:3')
test acc is  0.9458200001563927
test loss is 0.2399351318848453
test entropy is  0.06347010376975726
________________________________
2
distance 2 is tensor(63947.6006, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(63947.6006, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63947.6006, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.06347010376975726
avg test loss is  0.2399351318848453
avg accuracy is  0.9457800001563926
solo acc is  0.9458200001563927
compute similarity  is  tensor(0.9883, device='cuda:3')
compute_distance is  tensor(63947.6006, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(957078.6665, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16295.1117, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7388599226846719
avg test loss is  1.8995598042407609
avg accuracy is  0.9186400001563938
solo acc is  0.06888000015639888
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16295.1117, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(933168.4082, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31907.2564, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6719583726447561
avg test loss is  1.9439972495788809
avg accuracy is  0.9221000001563937
solo acc is  0.05508000015639901
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31907.2564, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(940958.2397, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47528.1562, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6712966056735924
avg test loss is  1.8592558951329088
avg accuracy is  0.9255400001563935
solo acc is  0.05482000015639901
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47528.1562, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(948751.9642, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63156.0311, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6606924860068905
avg test loss is  1.8185584343912657
avg accuracy is  0.9275400001563934
solo acc is  0.05292000015639903
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63156.0311, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(956548.5628, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78788.1957, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78788.1957, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78788.1957, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78788.1957, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.051800000156399045
test loss is 1.7875000983857743
test entropy is  0.65097405088832
________________________________
cal ratio is  0.8901081424105455
distance 2 is tensor(70129.9434, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(70129.9434, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9434559053673126
distance 2 is tensor(66164.5761, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(66164.5761, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9713160927671576
distance 2 is tensor(64266.7878, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(64266.7878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64266.7878, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(64266.7878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64266.7878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(64232.4128, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(64266.7878, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(64232.4128, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.5955000001564087
test loss is 0.8645624504293627
test entropy is  0.799727838819899
________________________________
grad,shape is torch.Size([11183582])
mal_acc is 0.8500000005
mal loss is 0.6031513214111328
mal norm is  tensor(712846.0625, device='cuda:3')
distance 2 is tensor(64266.7878, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(64266.7878, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.01029228512197733
sync_entropy is 0.029560327529907227
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [12, 15, 16]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 77.25% 

Test Accuracy: 76.41% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13479.4905, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.4905, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0018230292480438948
current submit client idx and staleness is  1 1
distance 2 is tensor(13489.3256, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.3256, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0031734027434140444
current submit client idx and staleness is  2 1
distance 2 is tensor(13457.4821, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.4821, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0078103006817400455
current submit client idx and staleness is  3 1
distance 2 is tensor(13552.4773, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13552.4773, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.15525852143764496
current submit client idx and staleness is  4 1
distance 2 is tensor(13465.9146, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.9146, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007211058400571346
current submit client idx and staleness is  5 1
distance 2 is tensor(13463.4089, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.4089, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009663637727499008
current submit client idx and staleness is  6 1
distance 2 is tensor(13471.2228, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.2228, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0032362346537411213
current submit client idx and staleness is  7 1
distance 2 is tensor(13467.2527, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.2527, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0023619902785867453
current submit client idx and staleness is  8 2
distance 2 is tensor(13486.5487, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.5487, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007439871318638325
current submit client idx and staleness is  9 2
distance 2 is tensor(13505.9738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.9738, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005590151064097881
current submit client idx and staleness is  10 2
distance 2 is tensor(13572.5715, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13572.5715, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0018499776488170028
current submit client idx and staleness is  11 2
distance 2 is tensor(13523.4601, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13523.4601, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026650228537619114
current submit client idx and staleness is  12 2
distance 2 is tensor(13484.7075, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.7075, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005446594208478928
current submit client idx and staleness is  13 2
distance 2 is tensor(13480.2152, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13480.2152, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0070726992562413216
current submit client idx and staleness is  14 2
distance 2 is tensor(13514.9506, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13514.9506, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.014782330021262169
current submit client idx and staleness is  15 2
distance 2 is tensor(13494.3847, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.3847, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005043549928814173
current submit client idx and staleness is  16 3
distance 2 is tensor(13589.7965, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13589.7965, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07706481963396072
current submit client idx and staleness is  17 3
distance 2 is tensor(13491.8406, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.8406, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.000757451867684722
current submit client idx and staleness is  18 3
distance 2 is tensor(13492.3538, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.3538, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008211711421608925
current submit client idx and staleness is  19 3
distance 2 is tensor(13676.6295, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13676.6295, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3796907961368561
current submit client idx and staleness is  20 3
distance 2 is tensor(13510.1497, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13510.1497, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008189878426492214
current submit client idx and staleness is  21 3
distance 2 is tensor(13653.5490, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13653.5490, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07573406398296356
current submit client idx and staleness is  22 3
distance 2 is tensor(13759.1456, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13759.1456, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13165131211280823
current submit client idx and staleness is  23 3
distance 2 is tensor(13522.8768, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13522.8768, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.014395137317478657
current submit client idx and staleness is  40 6
distance 2 is tensor(13924.1872, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13924.1872, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.44074827432632446
current submit client idx and staleness is  41 6
distance 2 is tensor(13804.0607, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13804.0607, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2912520170211792
current submit client idx and staleness is  42 6
distance 2 is tensor(13846.3631, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13846.3631, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.047967132180929184
current submit client idx and staleness is  43 6
distance 2 is tensor(13858.8333, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13858.8333, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5137006044387817
current submit client idx and staleness is  44 6
distance 2 is tensor(13829.4018, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13829.4018, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2563566267490387
current submit client idx and staleness is  45 6
distance 2 is tensor(13890.8980, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13890.8980, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6655766367912292
current submit client idx and staleness is  46 6
distance 2 is tensor(13773.8706, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13773.8706, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.17980778217315674
current submit client idx and staleness is  47 6
distance 2 is tensor(13839.1335, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13839.1335, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.8957847356796265
current submit client idx and staleness is  48 1
distance 2 is tensor(13496.1411, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.1411, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13500.4745, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.4745, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13784.7730, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13784.7730, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13476.8303, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.8303, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13493.0593, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13493.0593, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13533.5535, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13533.5535, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13492.4444, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.4444, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13501.8946, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.8946, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13504.4109, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.4109, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13533.2846, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13533.2846, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13476.4596, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.4596, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13509.4272, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13509.4272, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(32175.9704, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32175.9704, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908286.8604, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32188.4446, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32188.4446, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908284.4467, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32175.1060, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32175.1060, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908286.0280, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32180.5429, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32180.5429, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908284.4917, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32193.8097, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32193.8097, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908296.9966, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32177.4659, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32177.4659, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908287.7817, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32190.0802, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32190.0802, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908286.5092, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32182.5127, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32182.5127, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908284.4286, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32354.9453, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32354.9453, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908356.9029, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32178.9184, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32178.9184, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908286.4332, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32169.7931, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32169.7931, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908290.0417, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32203.7939, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32203.7939, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(908285.4718, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(32354.9453, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.9556e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0017150019787300162
distance 2 is tensor(18118748.6692, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(18118748.6692, device='cuda:3', dtype=torch.float64)
cal ratio is  0.041412582141625805
distance 2 is tensor(750344.1352, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(750344.1352, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20350082046420798
distance 2 is tensor(152695.5877, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(152695.5877, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4511107398645592
distance 2 is tensor(68882.5549, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68882.5549, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6716480946922422
distance 2 is tensor(46264.7812, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46264.7812, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8195418855334223
distance 2 is tensor(37915.8533, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37915.8533, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9052863948113193
distance 2 is tensor(34324.7345, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34324.7345, device='cuda:3', dtype=torch.float64)
cal ratio is  0.951465000190453
distance 2 is tensor(32658.7992, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32658.7992, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9754304405814365
distance 2 is tensor(31856.3940, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(31856.3940, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31856.3940, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(31856.3940, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31856.3940, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31896.0815, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(31856.3940, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(31896.0815, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9970, device='cuda:3')
test acc is  0.9472600001563927
test loss is 0.23033706057660655
test entropy is  0.06287228089460717
________________________________
2
distance 2 is tensor(31896.0815, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(31896.0815, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31896.0815, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.06287228089460717
avg test loss is  0.23033706057660655
avg accuracy is  0.9472400001563926
solo acc is  0.9472600001563927
compute similarity  is  tensor(0.9970, device='cuda:3')
compute_distance is  tensor(31896.0815, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(940240.1900, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16337.6694, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7552610001600611
avg test loss is  1.901928085500322
avg accuracy is  0.9248600001563935
solo acc is  0.07234000015639887
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16337.6694, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(932363.5060, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31949.0599, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6972117834841199
avg test loss is  1.9126708698089776
avg accuracy is  0.9287800001563934
solo acc is  0.059120000156398955
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31949.0599, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(940152.5327, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47566.9729, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6915973783149134
avg test loss is  1.8354458325659222
avg accuracy is  0.9313200001563933
solo acc is  0.05846000015639896
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47566.9729, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(947944.6130, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63192.7199, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(63192.7199, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63192.7199, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(63192.7199, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(63192.7199, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.05328000015639902
test loss is 1.832621889346091
test entropy is  0.6649159260875429
________________________________
cal ratio is  0.701233873362127
distance 2 is tensor(44312.8277, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44312.8277, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8373975359656985
distance 2 is tensor(37107.5288, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37107.5288, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9150933386659333
distance 2 is tensor(33956.8008, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33956.8008, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9566058391460953
distance 2 is tensor(32483.3018, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32483.3018, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9780618680138549
distance 2 is tensor(31770.7155, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(31770.7155, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31770.7155, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(31770.7155, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31770.7155, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31738.2155, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(31770.7155, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(31738.2155, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9327200001563932
test loss is 0.244344590355635
test entropy is  0.3124769301060825
________________________________
2
distance 2 is tensor(31738.2155, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(31738.2155, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31738.2155, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.3124769301060825
avg test loss is  0.244344590355635
avg accuracy is  0.9457000001563927
solo acc is  0.9327200001563932
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(31738.2155, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(940107.2155, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47706.1772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.686305325583119
avg test loss is  1.846589940130863
avg accuracy is  0.9341400001563931
solo acc is  0.057620000156398975
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47706.1772, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(948014.8898, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63334.6120, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.651876551797018
avg test loss is  1.8535814562721935
avg accuracy is  0.9356800001563931
solo acc is  0.04980000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63334.6120, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(955811.1173, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78966.4216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6385116652988106
avg test loss is  1.8265866794244712
avg accuracy is  0.9370200001563931
solo acc is  0.04886000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(78966.4216, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(963609.0436, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(94601.6318, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6229849044243088
avg test loss is  1.816255533786686
avg accuracy is  0.9382600001563929
solo acc is  0.04614000015639916
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(94601.6318, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(971408.6215, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(110238.8850, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(110238.8850, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(110238.8850, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(110238.8850, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04486000015639918
test loss is 1.8008430275465825
test entropy is  0.6128973841972059
________________________________
cal ratio is  0.5309199009018271
distance 2 is tensor(58527.9468, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58527.9468, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7286429483070357
distance 2 is tensor(42645.9033, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42645.9033, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8536065748883347
distance 2 is tensor(36402.8467, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(36402.8467, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9239080203781498
distance 2 is tensor(33632.8872, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33632.8872, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9612012684976148
distance 2 is tensor(32327.9809, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32327.9809, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32327.9809, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(32327.9809, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32327.9809, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32307.3559, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(32327.9809, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(32307.3559, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9460000001563926
test loss is 0.19364738683907023
test entropy is  0.11927136000426834
________________________________
2
distance 2 is tensor(32307.3559, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(32307.3559, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32307.3559, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.11927136000426834
avg test loss is  0.19364738683907023
avg accuracy is  0.9477600001563926
solo acc is  0.9460000001563926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(32307.3559, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(940417.9798, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(48434.7335, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.659197235122666
avg test loss is  1.9506651385665854
avg accuracy is  0.9335600001563932
solo acc is  0.051560000156399055
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(48434.7335, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(948378.4550, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(64055.5908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6536614923830837
avg test loss is  1.8534385583284871
avg accuracy is  0.9356600001563931
solo acc is  0.05084000015639906
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(64055.5908, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(956170.9428, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(79685.1687, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6421043946005195
avg test loss is  1.8120517819128987
avg accuracy is  0.9375600001563931
solo acc is  0.04930000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(79685.1687, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(963967.6624, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(95319.2973, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(95319.2973, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(95319.2973, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9387000001563929
test loss is 1.8106647748166642
test entropy is  0.6212922854115591
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.4623711109161377
mal norm is  tensor(1058603.6250, device='cuda:3')
distance 2 is tensor(95319.2973, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(95319.2973, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.0033173207193613052
benign_entropy is 0.014357964508235455
benign_acc is 1.0000000005
benign_loss is 0.003963302355259657
benign_entropy is 0.017047764733433723
benign_acc is 1.0000000005
benign_loss is 0.044845592230558395
benign_entropy is 0.08601133525371552
sync_acc is 1.0000000005
sync_loss is 0.00835209246724844
sync_entropy is 0.026855871081352234
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 77.11% 

Test Accuracy: 76.06% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13472.5429, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.5429, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0023088601883500814
current submit client idx and staleness is  1 1
distance 2 is tensor(13484.8284, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.8284, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002959719393402338
current submit client idx and staleness is  2 1
distance 2 is tensor(13472.2331, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.2331, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0035372115671634674
current submit client idx and staleness is  3 1
distance 2 is tensor(13472.7389, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.7389, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003127853851765394
current submit client idx and staleness is  4 1
distance 2 is tensor(13483.3375, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.3375, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003528749104589224
current submit client idx and staleness is  5 1
distance 2 is tensor(13496.1009, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.1009, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0029644567985087633
current submit client idx and staleness is  6 1
distance 2 is tensor(13473.9460, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.9460, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0031036960426717997
current submit client idx and staleness is  7 1
distance 2 is tensor(13488.5581, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.5581, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0025564790703356266
current submit client idx and staleness is  48 1
distance 2 is tensor(13492.7376, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.7376, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13497.9837, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.9837, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13487.5807, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13487.5807, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13494.9194, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.9194, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13517.6767, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13517.6767, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13503.6006, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13503.6006, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13491.6699, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.6699, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13525.0937, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13525.0937, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13717.8775, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13717.8775, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13501.4220, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.4220, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13489.2794, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.2794, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13669.6334, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13669.6334, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(43437.1196, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43437.1196, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912583.9753, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43427.9178, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43427.9178, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912581.1940, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43527.8695, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43527.8695, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912638.3132, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43446.5205, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43446.5205, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912591.8177, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43420.6198, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43420.6198, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912583.8877, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43432.8428, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43432.8428, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912582.4293, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43419.7373, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43419.7373, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912584.6445, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43413.6828, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43413.6828, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912587.7816, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43428.1146, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43428.1146, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912585.2144, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43433.5877, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43433.5877, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912581.0911, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43434.9841, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43434.9841, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912589.2106, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43449.3513, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43449.3513, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(912601.5791, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(43527.8695, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.5466e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0019891960492283947
distance 2 is tensor(21015608.8347, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(21015608.8347, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04460040405635232
distance 2 is tensor(937304.5987, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(937304.5987, device='cuda:3', dtype=torch.float64)
cal ratio is  0.2111880827211691
distance 2 is tensor(197947.4886, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(197947.4886, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45955212991796496
distance 2 is tensor(90967.1544, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(90967.1544, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6779028764125604
distance 2 is tensor(61666.8284, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(61666.8284, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8233490241253731
distance 2 is tensor(50773.3029, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50773.3029, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9073859984788833
distance 2 is tensor(46071.0418, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46071.0418, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9525675109977404
distance 2 is tensor(43885.8093, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43885.8093, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9759952984553394
distance 2 is tensor(42832.3582, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42832.3582, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42832.3582, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(42832.3582, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42832.3582, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42871.7332, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(42832.3582, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(42871.7332, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9948, device='cuda:3')
test acc is  0.9469800001563926
test loss is 0.24076922559091718
test entropy is  0.0587655026167917
________________________________
2
distance 2 is tensor(42871.7332, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(42871.7332, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42871.7332, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.0587655026167917
avg test loss is  0.24076922559091718
avg accuracy is  0.9469800001563926
solo acc is  0.9469800001563926
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(42871.7332, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(955635.7913, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16310.0734, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7351658428873857
avg test loss is  1.8973965198182694
avg accuracy is  0.9245400001563935
solo acc is  0.06746000015639889
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16310.0734, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(942266.1606, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31920.3419, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6904043738951768
avg test loss is  1.881596310974082
avg accuracy is  0.9283400001563934
solo acc is  0.05766000015639897
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31920.3419, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(950055.2653, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47540.4576, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.664541595579718
avg test loss is  1.8614414521800282
avg accuracy is  0.9305200001563934
solo acc is  0.05322000015639902
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47540.4576, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(957848.7922, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63167.7043, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6556597528097879
avg test loss is  1.8154663783510019
avg accuracy is  0.9325800001563932
solo acc is  0.051800000156399045
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63167.7043, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(965645.2402, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78799.2392, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78799.2392, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78799.2392, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78799.2392, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.05002000015639908
test loss is 1.7904164580737842
test entropy is  0.6439905989429225
________________________________
cal ratio is  0.7283644979001964
distance 2 is tensor(57394.5054, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(57394.5054, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8534432001541272
distance 2 is tensor(48982.9874, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48982.9874, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9238195463558864
distance 2 is tensor(45251.4662, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45251.4662, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9611550535644928
distance 2 is tensor(43493.6128, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43493.6128, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43493.6128, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(43493.6128, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43493.6128, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43472.8315, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(43493.6128, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(43472.8315, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9270000001563934
test loss is 0.2671628702774911
test entropy is  0.3566365427030322
________________________________
2
distance 2 is tensor(43472.8315, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(43472.8315, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43472.8315, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.3566365427030322
avg test loss is  0.2671628702774911
avg accuracy is  0.9451000001563926
solo acc is  0.9270000001563934
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(43472.8315, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(955869.2561, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(59394.6959, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6640248476239421
avg test loss is  1.8198335501544005
avg accuracy is  0.9346600001563931
solo acc is  0.051660000156399044
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(59394.6959, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(963763.8568, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(75026.5600, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6440671810789791
avg test loss is  1.7972068225636202
avg accuracy is  0.936200000156393
solo acc is  0.05010000015639908
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(75026.5600, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(971561.9348, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(90661.5560, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6191872936075605
avg test loss is  1.8101043676781228
avg accuracy is  0.9374200001563929
solo acc is  0.04538000015639916
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(90661.5560, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(979361.7258, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(106298.9742, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6080811023712158
avg test loss is  1.7979753550970952
avg accuracy is  0.9382000001563929
solo acc is  0.043980000156399204
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(106298.9742, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(987162.7790, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(121938.3369, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(121938.3369, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(121938.3369, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(121938.3369, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04394000015639919
test loss is 1.771547091434069
test entropy is  0.6056124215083354
________________________________
cal ratio is  0.5855171869198774
distance 2 is tensor(71397.0469, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(71397.0469, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7651906539741045
distance 2 is tensor(54632.3474, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54632.3474, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8747518119260129
distance 2 is tensor(47789.6805, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47789.6805, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9352823048437287
distance 2 is tensor(44696.8095, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44696.8095, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9671003026840548
distance 2 is tensor(43226.2277, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43226.2277, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43226.2277, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(43226.2277, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43226.2277, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43219.1965, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(43226.2277, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(43219.1965, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9451200001563926
test loss is 0.19472495811488813
test entropy is  0.1365193141924451
________________________________
2
distance 2 is tensor(43219.1965, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(43219.1965, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43219.1965, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.1365193141924451
avg test loss is  0.19472495811488813
avg accuracy is  0.9478000001563927
solo acc is  0.9451200001563926
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(43219.1965, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(955766.1823, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(59281.0870, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.638527231867356
avg test loss is  1.9331635445585031
avg accuracy is  0.9337200001563932
solo acc is  0.04816000015639912
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(59281.0870, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(963707.6147, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(74906.8900, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.641262114429108
avg test loss is  1.818394620247814
avg accuracy is  0.9362400001563931
solo acc is  0.04792000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(74906.8900, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(971502.5458, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(90539.0520, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(90539.0520, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(90539.0520, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.937660000156393
test loss is 1.82192576221188
test entropy is  0.615462575765217
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.4668852090835571
mal norm is  tensor(1005386.0625, device='cuda:3')
distance 2 is tensor(90539.0520, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(90539.0520, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.005284733138978481
sync_entropy is 0.0200693067163229
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [15, 16, 18]
alphas 3 is [1.   0.2  0.25 0.5 ]
alphas is  [0.51282051 0.1025641  0.12820513 0.25641026]
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 77.32% 

Test Accuracy: 76.45% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13511.6502, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13511.6502, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01301931869238615
current submit client idx and staleness is  1 1
distance 2 is tensor(13484.3722, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.3722, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.012022565118968487
current submit client idx and staleness is  2 1
distance 2 is tensor(13490.5608, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.5608, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006821123417466879
current submit client idx and staleness is  3 1
distance 2 is tensor(13477.7818, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.7818, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007539371959865093
current submit client idx and staleness is  4 1
distance 2 is tensor(13465.9738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.9738, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002621905179694295
current submit client idx and staleness is  5 1
distance 2 is tensor(13478.9507, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.9507, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008242329582571983
current submit client idx and staleness is  6 1
distance 2 is tensor(13482.8139, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.8139, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005956602282822132
current submit client idx and staleness is  7 1
distance 2 is tensor(13493.4170, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13493.4170, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008316164836287498
current submit client idx and staleness is  8 2
distance 2 is tensor(13532.9706, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13532.9706, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.042405590415000916
current submit client idx and staleness is  9 2
distance 2 is tensor(13509.4466, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13509.4466, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003557412652298808
current submit client idx and staleness is  10 2
distance 2 is tensor(13506.4830, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13506.4830, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008139299228787422
current submit client idx and staleness is  11 2
distance 2 is tensor(13517.2340, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13517.2340, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006630352232605219
current submit client idx and staleness is  12 2
distance 2 is tensor(13505.1352, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.1352, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.027859637513756752
current submit client idx and staleness is  13 2
distance 2 is tensor(13499.3992, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13499.3992, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010175126604735851
current submit client idx and staleness is  14 2
distance 2 is tensor(13504.4657, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.4657, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.014381902292370796
current submit client idx and staleness is  15 2
distance 2 is tensor(13529.2860, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13529.2860, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004414430353790522
current submit client idx and staleness is  24 4
distance 2 is tensor(13687.8344, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13687.8344, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.052781082689762115
current submit client idx and staleness is  25 4
distance 2 is tensor(13661.3431, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13661.3431, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.33725446462631226
current submit client idx and staleness is  26 4
distance 2 is tensor(13778.4988, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13778.4988, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5348049998283386
current submit client idx and staleness is  27 4
distance 2 is tensor(13805.4149, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13805.4149, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3274916112422943
current submit client idx and staleness is  28 4
distance 2 is tensor(13670.5383, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13670.5383, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06563663482666016
current submit client idx and staleness is  29 4
distance 2 is tensor(13900.3687, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13900.3687, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.43544667959213257
current submit client idx and staleness is  30 4
distance 2 is tensor(13785.0581, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13785.0581, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.390641987323761
current submit client idx and staleness is  31 4
distance 2 is tensor(13519.3875, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13519.3875, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0054037123918533325
current submit client idx and staleness is  32 5
distance 2 is tensor(13824.4615, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13824.4615, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.051083553582429886
current submit client idx and staleness is  33 5
distance 2 is tensor(13954.0232, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13954.0232, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4918575882911682
current submit client idx and staleness is  34 5
distance 2 is tensor(13894.6654, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13894.6654, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5613774061203003
current submit client idx and staleness is  35 5
distance 2 is tensor(13901.4881, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13901.4881, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.35652226209640503
current submit client idx and staleness is  36 5
distance 2 is tensor(13835.1348, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13835.1348, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06561917066574097
current submit client idx and staleness is  37 5
distance 2 is tensor(13880.5065, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13880.5065, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4163288176059723
current submit client idx and staleness is  38 5
distance 2 is tensor(13822.9916, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13822.9916, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01463255099952221
current submit client idx and staleness is  39 5
distance 2 is tensor(13933.8204, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13933.8204, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03662119060754776
current submit client idx and staleness is  48 1
distance 2 is tensor(13518.9112, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13518.9112, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13506.7517, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13506.7517, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13576.4802, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13576.4802, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13513.7926, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13513.7926, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13603.0623, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13603.0623, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13531.6819, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13531.6819, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13496.7996, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.7996, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13505.4749, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.4749, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13548.8299, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13548.8299, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13494.3192, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.3192, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13500.5252, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.5252, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13528.6945, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13528.6945, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(37888.1942, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37888.1942, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915483.4923, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37909.3094, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37909.3094, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915505.2906, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37900.1226, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37900.1226, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915488.6576, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37866.5317, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37866.5317, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915483.7272, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37878.6819, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37878.6819, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915484.4571, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37922.7785, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37922.7785, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915496.1852, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38007.7909, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38007.7909, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915551.2487, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37868.8965, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37868.8965, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915482.8588, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37873.1170, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37873.1170, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915487.4858, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37993.5604, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37993.5604, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915550.7433, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37888.7803, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37888.7803, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915497.3282, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37858.8503, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37858.8503, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(915481.7556, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(38007.7909, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.8412e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0018587894213777185
distance 2 is tensor(19637879.8406, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(19637879.8406, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04311367969057296
distance 2 is tensor(846661.2255, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(846661.2255, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20763834305970322
distance 2 is tensor(175799.2674, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(175799.2674, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45567359122088297
distance 2 is tensor(80107.0419, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(80107.0419, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6750361679572069
distance 2 is tensor(54075.1938, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54075.1938, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8216055184336387
distance 2 is tensor(44428.4605, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44428.4605, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9064247546994757
distance 2 is tensor(40271.1143, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40271.1143, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9520627350241251
distance 2 is tensor(38340.6577, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(38340.6577, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9757366333432086
distance 2 is tensor(37410.3982, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37410.3982, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37410.3982, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(37410.3982, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37410.3982, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37449.7732, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(37410.3982, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(37449.7732, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9960, device='cuda:3')
test acc is  0.9475400001563926
test loss is 0.22458667283404105
test entropy is  0.06517799629096199
________________________________
2
distance 2 is tensor(37449.7732, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(37449.7732, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37449.7732, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.06517799629096199
avg test loss is  0.22458667283404105
avg accuracy is  0.9475600001563926
solo acc is  0.9475400001563926
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(37449.7732, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(953058.6900, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16334.1719, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7444038928469734
avg test loss is  1.915861432509654
avg accuracy is  0.9280800001563934
solo acc is  0.06846000015639889
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16334.1719, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(942403.1180, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31942.5597, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6825487159402169
avg test loss is  1.933579495648289
avg accuracy is  0.9309400001563932
solo acc is  0.056040000156399
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31942.5597, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(950190.5647, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47559.3922, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6842983396309416
avg test loss is  1.8341438992858847
avg accuracy is  0.9333000001563933
solo acc is  0.05640000015639898
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47559.3922, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(957981.9662, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63184.5604, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6629766240296766
avg test loss is  1.8168696889182185
avg accuracy is  0.935300000156393
solo acc is  0.05282000015639903
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63184.5604, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(965777.0218, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78814.8535, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78814.8535, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78814.8535, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78814.8535, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04976000015639907
test loss is 1.8018565034622427
test entropy is  0.6464661501557626
________________________________
cal ratio is  0.680547360201555
distance 2 is tensor(53637.2213, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(53637.2213, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8249530916887738
distance 2 is tensor(44248.1164, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44248.1164, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9082700554450217
distance 2 is tensor(40189.2358, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40189.2358, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9530320716486801
distance 2 is tensor(38301.6771, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(38301.6771, device='cuda:3', dtype=torch.float64)
cal ratio is  0.976233023182443
distance 2 is tensor(37391.3010, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37391.3010, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37391.3010, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(37391.3010, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37391.3010, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37390.6760, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(37391.3010, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(37390.6760, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.938900000156393
test loss is 0.21993391461613232
test entropy is  0.25960358567631153
________________________________
2
distance 2 is tensor(37390.6760, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(37390.6760, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37390.6760, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.25960358567631153
avg test loss is  0.21993391461613232
avg accuracy is  0.9466000001563927
solo acc is  0.938900000156393
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(37390.6760, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(952972.2322, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(53375.5870, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6488260889754576
avg test loss is  1.9093991408262716
avg accuracy is  0.9365000001563931
solo acc is  0.04898000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(53375.5870, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(960884.6095, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(69002.8712, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6438854808545174
avg test loss is  1.8353407375343012
avg accuracy is  0.9382800001563929
solo acc is  0.049460000156399085
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(69002.8712, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(968680.0535, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(84635.2480, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(84635.2480, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(84635.2480, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(84635.2480, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(84635.2480, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.04522000015639917
test loss is 1.8313042387328184
test entropy is  0.6222145711369527
________________________________
cal ratio is  0.6567298469486129
distance 2 is tensor(55582.4988, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55582.4988, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8103886622227066
distance 2 is tensor(45043.3956, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45043.3956, device='cuda:3', dtype=torch.float64)
cal ratio is  0.900216210249215
distance 2 is tensor(40548.7228, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40548.7228, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9487980863371541
distance 2 is tensor(38472.5146, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(38472.5146, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9740631262888398
distance 2 is tensor(37474.7125, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37474.7125, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37474.7125, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(37474.7125, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37474.7125, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37441.2750, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(37474.7125, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(37441.2750, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9419800001563928
test loss is 0.20317059092085493
test entropy is  0.20400133567964635
________________________________
2
distance 2 is tensor(37441.2750, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(37441.2750, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37441.2750, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.20400133567964635
avg test loss is  0.20317059092085493
avg accuracy is  0.9470000001563925
solo acc is  0.9419800001563928
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(37441.2750, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(953001.7622, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(53450.9177, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6363131779691448
avg test loss is  1.9457248969151235
avg accuracy is  0.937200000156393
solo acc is  0.04764000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(53450.9177, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(960921.9303, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(69077.2295, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6304505991813777
avg test loss is  1.8633382009423298
avg accuracy is  0.9391600001563929
solo acc is  0.046780000156399125
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(69077.2295, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(968716.9307, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(84709.7247, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6217456799181525
avg test loss is  1.8225364339016283
avg accuracy is  0.940240000156393
solo acc is  0.045020000156399176
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(84709.7247, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(976515.1861, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(100345.9176, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6203239832616523
avg test loss is  1.7794920405768373
avg accuracy is  0.9410200001563928
solo acc is  0.045860000156399156
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(100345.9176, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(984315.2868, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(115984.6051, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(115984.6051, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9416800001563927
test loss is 1.778629470054451
test entropy is  0.607409822704542
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4375783205032349
mal norm is  tensor(1289798.6250, device='cuda:3')
distance 2 is tensor(115984.6051, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(115984.6051, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.00797596201300621
benign_entropy is 0.026910562068223953
benign_acc is 0.9500000005
benign_loss is 0.06810134649276733
benign_entropy is 0.0601235032081604
benign_acc is 0.9500000005
benign_loss is 0.06216507405042648
benign_entropy is 0.08779944479465485
sync_acc is 1.0000000005
sync_loss is 0.013106562197208405
sync_entropy is 0.03543392941355705
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [18]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 77.34% 

Test Accuracy: 76.22% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13482.6053, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.6053, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002565514063462615
current submit client idx and staleness is  1 1
distance 2 is tensor(13469.3738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.3738, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00455842912197113
current submit client idx and staleness is  2 1
distance 2 is tensor(13468.7941, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.7941, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0035980273969471455
current submit client idx and staleness is  3 1
distance 2 is tensor(13473.1614, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.1614, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002958765486255288
current submit client idx and staleness is  4 1
distance 2 is tensor(13470.0222, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.0222, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0007310648215934634
current submit client idx and staleness is  5 1
distance 2 is tensor(13475.9908, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.9908, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0030416010413318872
current submit client idx and staleness is  6 1
distance 2 is tensor(13484.3429, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.3429, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005135014187544584
current submit client idx and staleness is  7 1
distance 2 is tensor(13460.7579, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.7579, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0025012914557009935
current submit client idx and staleness is  16 3
distance 2 is tensor(13889.7778, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13889.7778, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3443766236305237
current submit client idx and staleness is  17 3
distance 2 is tensor(13468.4816, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.4816, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.015494255349040031
current submit client idx and staleness is  18 3
distance 2 is tensor(13510.2390, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13510.2390, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003522242186591029
current submit client idx and staleness is  19 3
distance 2 is tensor(13563.6547, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13563.6547, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004855799488723278
current submit client idx and staleness is  20 3
distance 2 is tensor(13495.5287, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.5287, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02613002434372902
current submit client idx and staleness is  21 3
distance 2 is tensor(13794.1081, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13794.1081, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.27019134163856506
current submit client idx and staleness is  22 3
distance 2 is tensor(13504.4943, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.4943, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0034956566523760557
current submit client idx and staleness is  23 3
distance 2 is tensor(13778.0969, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13778.0969, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.39688724279403687
current submit client idx and staleness is  48 1
distance 2 is tensor(13512.6573, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13512.6573, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13495.9289, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.9289, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13478.8635, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.8635, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13513.2356, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13513.2356, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13505.9701, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.9701, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13548.2472, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13548.2472, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13482.9802, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.9802, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13506.4051, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13506.4051, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13646.8588, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13646.8588, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13500.1261, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.1261, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13515.3428, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13515.3428, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13505.4351, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.4351, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(43827.4717, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43827.4717, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920304.6458, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43824.3037, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43824.3037, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920299.5386, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43823.8430, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43823.8430, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920304.9037, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43820.5589, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43820.5589, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920304.3257, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43875.4532, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43875.4532, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920303.9304, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43854.6639, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43854.6639, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920302.2742, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43788.6671, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43788.6671, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920306.1920, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43801.0181, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43801.0181, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920306.4363, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43822.4963, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43822.4963, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920303.4763, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43814.2952, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43814.2952, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920305.7857, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43809.0482, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43809.0482, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920304.9838, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44136.0611, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44136.0611, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(920411.8922, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(44136.0611, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.5926e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.002003043323814742
distance 2 is tensor(21161935.9766, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(21161935.9766, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04475537122136426
distance 2 is tensor(947110.2150, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(947110.2150, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21155466257697267
distance 2 is tensor(200365.6494, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(200365.6494, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4599506401744795
distance 2 is tensor(92158.3633, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(92158.3633, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6781964076996336
distance 2 is tensor(62501.5059, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62501.5059, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8235265800834115
distance 2 is tensor(51471.6875, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51471.6875, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9074833348322872
distance 2 is tensor(46709.6265, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46709.6265, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9526199325938106
distance 2 is tensor(44496.5583, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44496.5583, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9760220998329827
distance 2 is tensor(43429.6451, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43429.6451, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43429.6451, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(43429.6451, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43429.6451, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43468.8639, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(43429.6451, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(43468.8639, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9947, device='cuda:3')
test acc is  0.9474000001563926
test loss is 0.24120307946615815
test entropy is  0.0568754627316347
________________________________
2
distance 2 is tensor(43468.8639, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(43468.8639, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43468.8639, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.0568754627316347
avg test loss is  0.24120307946615815
avg accuracy is  0.9474000001563926
solo acc is  0.9474000001563926
compute similarity  is  tensor(0.9947, device='cuda:3')
compute_distance is  tensor(43468.8639, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(963850.6474, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16320.3480, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7247078427878182
avg test loss is  1.9154573064630904
avg accuracy is  0.9275200001563934
solo acc is  0.06382000015639892
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16320.3480, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(950184.3155, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31928.8645, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6651859176738183
avg test loss is  1.9344793995627967
avg accuracy is  0.9308200001563932
solo acc is  0.05296000015639904
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31928.8645, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(957972.5398, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47548.0796, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6698367063651609
avg test loss is  1.8319050169661832
avg accuracy is  0.9332400001563932
solo acc is  0.05392000015639902
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47548.0796, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(965765.5937, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63174.8712, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6561007216153547
avg test loss is  1.7996041863165853
avg accuracy is  0.935180000156393
solo acc is  0.05198000015639904
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63174.8712, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(973561.8161, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78805.8124, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78805.8124, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78805.8124, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78805.8124, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04904000015639909
test loss is 1.7865687270298638
test entropy is  0.6389195541744037
________________________________
cal ratio is  0.733404780545231
distance 2 is tensor(57796.6107, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(57796.6107, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8563901752059927
distance 2 is tensor(49496.4035, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(49496.4035, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9254139458099729
distance 2 is tensor(45804.7435, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45804.7435, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9619835241687263
distance 2 is tensor(44063.4421, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44063.4421, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44063.4421, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44063.4421, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44063.4421, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44041.0983, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44063.4421, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44041.0983, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9300200001563934
test loss is 0.25854849027912785
test entropy is  0.3456711333311732
________________________________
2
distance 2 is tensor(44041.0983, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44041.0983, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44041.0983, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.3456711333311732
avg test loss is  0.25854849027912785
avg accuracy is  0.9456600001563926
solo acc is  0.9300200001563934
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(44041.0983, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(964066.3761, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(59961.3644, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6476445739226573
avg test loss is  1.8442154162375213
avg accuracy is  0.9372200001563931
solo acc is  0.049440000156399086
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(59961.3644, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(971959.6004, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(75593.2873, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6334950511565294
avg test loss is  1.806039076022175
avg accuracy is  0.938660000156393
solo acc is  0.04754000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(75593.2873, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(979757.7507, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(91228.4694, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6187096747672162
avg test loss is  1.795108769098511
avg accuracy is  0.9397000001563929
solo acc is  0.04554000015639916
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(91228.4694, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(987557.7041, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(106865.9654, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6093407358278704
avg test loss is  1.781300708003666
avg accuracy is  0.9404800001563929
solo acc is  0.04432000015639919
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(106865.9654, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(995358.8924, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(122505.0737, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(122505.0737, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(122505.0737, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(122505.0737, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.0436200001563992
test loss is 1.7654593064047186
test entropy is  0.6036487065084145
________________________________
cal ratio is  0.58822817681977
distance 2 is tensor(72060.9672, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(72060.9672, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7669601836887621
distance 2 is tensor(55267.9380, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55267.9380, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8757622704570048
distance 2 is tensor(48401.6529, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48401.6529, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9358209542588285
distance 2 is tensor(45295.3341, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45295.3341, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9673778251129325
distance 2 is tensor(43817.6384, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43817.6384, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43817.6384, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(43817.6384, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43817.6384, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43783.5759, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(43817.6384, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(43783.5759, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9456600001563926
test loss is 0.19219016764358238
test entropy is  0.12972638792956195
________________________________
2
distance 2 is tensor(43783.5759, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(43783.5759, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43783.5759, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.12972638792956195
avg test loss is  0.19219016764358238
avg accuracy is  0.9477000001563927
solo acc is  0.9456600001563926
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(43783.5759, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(963962.5840, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(59848.4410, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.639928675292398
avg test loss is  1.9196738132735347
avg accuracy is  0.9364800001563931
solo acc is  0.04870000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(59848.4410, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(971903.7559, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(75473.4237, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6190123729541174
avg test loss is  1.8631895323238714
avg accuracy is  0.938680000156393
solo acc is  0.044520000156399175
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(75473.4237, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(979698.3473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(91105.8922, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6294205432657696
avg test loss is  1.7693096044118448
avg accuracy is  0.940020000156393
solo acc is  0.04652000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(91105.8922, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(987496.9078, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(106742.3845, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6153308150103635
avg test loss is  1.7632728429401623
avg accuracy is  0.9408600001563929
solo acc is  0.04492000015639918
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(106742.3845, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(995297.5576, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(122381.6125, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(122381.6125, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9413800001563928
test loss is 1.7520276202875025
test entropy is  0.6074659605236614
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4073563814163208
mal norm is  tensor(1361350.6250, device='cuda:3')
distance 2 is tensor(122381.6125, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(122381.6125, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.010057182982563972
benign_entropy is 0.029029009863734245
sync_acc is 1.0000000005
sync_loss is 0.004001782275736332
sync_entropy is 0.016689445823431015
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [20]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 77.39% 

Test Accuracy: 76.50% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13474.4090, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.4090, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004866901319473982
current submit client idx and staleness is  1 1
distance 2 is tensor(13656.5045, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13656.5045, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.027682673186063766
current submit client idx and staleness is  2 1
distance 2 is tensor(13445.9349, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13445.9349, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026156173553317785
current submit client idx and staleness is  3 1
distance 2 is tensor(13556.0827, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13556.0827, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11825186014175415
current submit client idx and staleness is  4 1
distance 2 is tensor(13456.5194, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.5194, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003577777650207281
current submit client idx and staleness is  5 1
distance 2 is tensor(13465.1247, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.1247, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002062062732875347
current submit client idx and staleness is  6 1
distance 2 is tensor(13456.2222, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.2222, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0020936185028403997
current submit client idx and staleness is  7 1
distance 2 is tensor(13457.1073, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.1073, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005336805712431669
current submit client idx and staleness is  8 2
distance 2 is tensor(13490.3485, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.3485, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0020108323078602552
current submit client idx and staleness is  9 2
distance 2 is tensor(13464.9825, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.9825, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002931836526840925
current submit client idx and staleness is  10 2
distance 2 is tensor(13470.1643, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.1643, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005532725714147091
current submit client idx and staleness is  11 2
distance 2 is tensor(13453.5636, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.5636, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0077185905538499355
current submit client idx and staleness is  12 2
distance 2 is tensor(13464.1673, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.1673, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0017236387357115746
current submit client idx and staleness is  13 2
distance 2 is tensor(13461.4936, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.4936, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01588524878025055
current submit client idx and staleness is  14 2
distance 2 is tensor(13464.2947, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.2947, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0045415861532092094
current submit client idx and staleness is  15 2
distance 2 is tensor(13474.0817, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.0817, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0022132708691060543
current submit client idx and staleness is  48 1
distance 2 is tensor(13505.4402, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.4402, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13543.8935, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13543.8935, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13473.5541, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.5541, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13687.1808, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13687.1808, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13474.7712, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.7712, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13486.9632, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.9632, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13652.2501, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13652.2501, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13564.9841, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13564.9841, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13472.4080, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.4080, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13468.5871, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.5871, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13679.5049, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13679.5049, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13471.1577, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.1577, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(33231.5182, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33231.5182, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931828.2318, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33218.6431, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33218.6431, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931826.1028, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33235.2674, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33235.2674, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931827.0898, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33229.6250, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33229.6250, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931828.0660, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33549.6873, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33549.6873, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931928.8716, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33270.4728, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33270.4728, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931831.4944, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33219.0035, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33219.0035, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931830.6557, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33247.0307, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33247.0307, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931840.0783, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33228.6634, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33228.6634, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931832.4633, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33704.6355, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33704.6355, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931981.2918, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33237.7647, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33237.7647, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931831.5844, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33236.5099, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33236.5099, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931829.1470, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(33704.6355, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.8011e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.001750403270138924
distance 2 is tensor(18492842.5950, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(18492842.5950, device='cuda:3', dtype=torch.float64)
cal ratio is  0.0418378208889674
distance 2 is tensor(773700.2033, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(773700.2033, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20454296044427608
distance 2 is tensor(158254.8704, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(158254.8704, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45226434480444555
distance 2 is tensor(71573.0840, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(71573.0840, device='cuda:3', dtype=torch.float64)
cal ratio is  0.672505789345804
distance 2 is tensor(48133.2554, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48133.2554, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8200649966041138
distance 2 is tensor(39472.3825, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39472.3825, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9055745784673466
distance 2 is tensor(35745.2446, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35745.2446, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9516160452011486
distance 2 is tensor(34015.7774, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34015.7774, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9755076795750447
distance 2 is tensor(33182.6691, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33182.6691, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33182.6691, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(33182.6691, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33182.6691, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33222.0441, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(33182.6691, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(33222.0441, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9970, device='cuda:3')
test acc is  0.9475600001563926
test loss is 0.25754943911984146
test entropy is  0.0513107338678324
________________________________
2
distance 2 is tensor(33222.0441, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(33222.0441, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33222.0441, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.0513107338678324
avg test loss is  0.25754943911984146
avg accuracy is  0.9475400001563926
solo acc is  0.9475600001563926
compute similarity  is  tensor(0.9970, device='cuda:3')
compute_distance is  tensor(33222.0441, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(964974.3656, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16348.7519, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.714248374904818
avg test loss is  1.9293112302070383
avg accuracy is  0.9288000001563934
solo acc is  0.06120000015639895
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16348.7519, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(956439.2158, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31957.4120, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6597534530150616
avg test loss is  1.9368035726230164
avg accuracy is  0.9319200001563932
solo acc is  0.052000000156399044
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31957.4120, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(964227.6727, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47576.6260, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6516218927052929
avg test loss is  1.8678371628836903
avg accuracy is  0.934180000156393
solo acc is  0.05042000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47576.6260, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(972020.9377, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63203.3750, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6538387994327204
avg test loss is  1.7941584097759804
avg accuracy is  0.9360600001563931
solo acc is  0.05158000015639904
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63203.3750, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(979817.3437, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78834.4530, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78834.4530, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78834.4530, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78834.4530, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04818000015639911
test loss is 1.784784445372384
test entropy is  0.63563344698123
________________________________
cal ratio is  0.6407857770034682
distance 2 is tensor(50515.9299, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50515.9299, device='cuda:3', dtype=torch.float64)
cal ratio is  0.800491485609455
distance 2 is tensor(40437.5188, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40437.5188, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8947024831991148
distance 2 is tensor(36179.5280, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(36179.5280, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9458874090849051
distance 2 is tensor(34221.6849, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34221.6849, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9725684991152206
distance 2 is tensor(33282.8723, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33282.8723, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33282.8723, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(33282.8723, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33282.8723, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33244.7473, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(33282.8723, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(33244.7473, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9422200001563927
test loss is 0.20303434304669118
test entropy is  0.1775048294383318
________________________________
2
distance 2 is tensor(33244.7473, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(33244.7473, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33244.7473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.1775048294383318
avg test loss is  0.20303434304669118
avg accuracy is  0.9472800001563927
solo acc is  0.9422200001563927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(33244.7473, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(964940.6429, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(49279.7010, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6392797553325857
avg test loss is  1.9105178387573614
avg accuracy is  0.9367800001563931
solo acc is  0.047280000156399125
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(49279.7010, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(972871.8304, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(64906.8122, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6363072384653798
avg test loss is  1.8301101842194871
avg accuracy is  0.9385400001563929
solo acc is  0.0482800001563991
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(64906.8122, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(980667.9296, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(80539.3249, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6169535676612878
avg test loss is  1.8202487271460122
avg accuracy is  0.9396000001563929
solo acc is  0.04422000015639918
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(80539.3249, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(988466.8500, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(96175.0195, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6171042912299066
avg test loss is  1.7753895167499552
avg accuracy is  0.9404800001563929
solo acc is  0.045780000156399166
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(96175.0195, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(996267.3870, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(111813.4906, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(111813.4906, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(111813.4906, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(111813.4906, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.0435200001563992
test loss is 1.7715133965167853
test entropy is  0.6058518957070378
________________________________
cal ratio is  0.5380514302301527
distance 2 is tensor(60161.4553, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(60161.4553, device='cuda:3', dtype=torch.float64)
cal ratio is  0.733519605769864
distance 2 is tensor(44129.6327, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44129.6327, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8564573415052381
distance 2 is tensor(37795.1111, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37795.1111, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9254502561999577
distance 2 is tensor(34977.5498, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34977.5498, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9620025003462076
distance 2 is tensor(33648.5322, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33648.5322, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33648.5322, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(33648.5322, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33648.5322, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33636.6572, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(33648.5322, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(33636.6572, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9468800001563926
test loss is 0.19813919710570022
test entropy is  0.09830537026919559
________________________________
2
distance 2 is tensor(33636.6572, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(33636.6572, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33636.6572, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.09830537026919559
avg test loss is  0.19813919710570022
avg accuracy is  0.9482800001563927
solo acc is  0.9468800001563926
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(33636.6572, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(965152.3027, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(49765.9863, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6543655211053541
avg test loss is  1.913653286521697
avg accuracy is  0.935960000156393
solo acc is  0.05148000015639906
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(49765.9863, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(973114.5427, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(65387.6805, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6305229195853328
avg test loss is  1.8535437350687773
avg accuracy is  0.9386400001563929
solo acc is  0.04680000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(65387.6805, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(980908.0300, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(81018.0076, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6360564361828978
avg test loss is  1.7688960596118741
avg accuracy is  0.9399400001563929
solo acc is  0.04766000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(81018.0076, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(988705.8652, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(96653.3590, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(96653.3590, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(96653.3590, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9408200001563929
test loss is 1.766281972608298
test entropy is  0.6197790583914808
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.41786789894104
mal norm is  tensor(1073364.6250, device='cuda:3')
distance 2 is tensor(96653.3590, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(96653.3590, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.0031452432740479708
benign_entropy is 0.013889739289879799
sync_acc is 1.0000000005
sync_loss is 0.008210337720811367
sync_entropy is 0.02730478160083294
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 77.28% 

Test Accuracy: 76.11% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13465.3438, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.3438, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0033129299990832806
current submit client idx and staleness is  1 1
distance 2 is tensor(13470.3257, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.3257, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005207003094255924
current submit client idx and staleness is  2 1
distance 2 is tensor(13464.0560, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.0560, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0038104336708784103
current submit client idx and staleness is  3 1
distance 2 is tensor(13468.8279, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.8279, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00395360728725791
current submit client idx and staleness is  4 1
distance 2 is tensor(13454.7472, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13454.7472, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0031369072385132313
current submit client idx and staleness is  5 1
distance 2 is tensor(13471.8861, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.8861, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.014522554352879524
current submit client idx and staleness is  6 1
distance 2 is tensor(13469.6376, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.6376, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001182585023343563
current submit client idx and staleness is  7 1
distance 2 is tensor(13606.0851, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13606.0851, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04920664429664612
current submit client idx and staleness is  48 1
distance 2 is tensor(13480.3860, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13480.3860, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13483.9957, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.9957, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13471.8398, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.8398, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13477.8996, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.8996, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13667.0691, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13667.0691, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13624.3575, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13624.3575, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13473.9281, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.9281, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13485.8977, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.8977, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13832.6461, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13832.6461, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13503.4166, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13503.4166, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13485.6708, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.6708, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13486.8484, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.8484, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(54807.1384, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54807.1384, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931018.7971, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54804.2334, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54804.2334, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931014.9632, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55147.6131, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55147.6131, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931127.1130, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54801.0157, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54801.0157, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931023.6303, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54801.0598, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54801.0598, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931015.2325, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54844.4940, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54844.4940, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931021.0216, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54800.8250, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54800.8250, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931015.2662, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54810.6064, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54810.6064, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931016.2997, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54815.5124, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54815.5124, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931020.4748, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54841.8557, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54841.8557, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931017.9586, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54807.9697, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54807.9697, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931027.9772, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54837.4372, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(54837.4372, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(931029.3421, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(55147.6131, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.7511e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0022390111153462715
distance 2 is tensor(23654983.3640, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(23654983.3640, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04731818875321098
distance 2 is tensor(1119310.9224, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1119310.9224, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21752744808249638
distance 2 is tensor(243480.8943, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(243480.8943, device='cuda:3', dtype=torch.float64)
cal ratio is  0.46639833533140673
distance 2 is tensor(113559.0801, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(113559.0801, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6829336356593271
distance 2 is tensor(77553.3863, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(77553.3863, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8263976108994335
distance 2 is tensor(64089.8888, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(64089.8888, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9090644549975418
distance 2 is tensor(58261.7973, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58261.7973, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9534490639052843
distance 2 is tensor(55549.7077, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55549.7077, device='cuda:3', dtype=torch.float64)
cal ratio is  0.976446710829908
distance 2 is tensor(54241.3569, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54241.3569, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54241.3569, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(54241.3569, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54241.3569, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54280.2632, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(54241.3569, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(54280.2632, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9921, device='cuda:3')
test acc is  0.9476000001563927
test loss is 0.24918783331355612
test entropy is  0.054097604723480505
________________________________
2
distance 2 is tensor(54280.2632, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(54280.2632, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54280.2632, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.054097604723480505
avg test loss is  0.24918783331355612
avg accuracy is  0.9475400001563926
solo acc is  0.9476000001563927
compute similarity  is  tensor(0.9921, device='cuda:3')
compute_distance is  tensor(54280.2632, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(985461.4241, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16310.4974, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.682915306914493
avg test loss is  1.962749702088973
avg accuracy is  0.9271200001563934
solo acc is  0.05564000015639901
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16310.4974, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(966382.9291, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31920.5019, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6439481386748116
avg test loss is  1.9377195572914065
avg accuracy is  0.9304600001563932
solo acc is  0.048720000156399094
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31920.5019, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(974172.2124, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47542.1618, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6629126520870287
avg test loss is  1.7987217759842153
avg accuracy is  0.9331800001563932
solo acc is  0.05264000015639902
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47542.1618, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(981966.5395, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63170.6569, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.643361648406519
avg test loss is  1.78490658626532
avg accuracy is  0.9349400001563931
solo acc is  0.04950000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63170.6569, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(989763.7878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78803.5450, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78803.5450, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78803.5450, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78803.5450, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.046420000156399154
test loss is 1.7794130336293175
test entropy is  0.6263780162081389
________________________________
cal ratio is  0.819816317932323
distance 2 is tensor(64604.4637, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(64604.4637, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9054368654229866
distance 2 is tensor(58495.1982, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58495.1982, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9515449905635261
distance 2 is tensor(55660.8014, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55660.8014, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9754717765785949
distance 2 is tensor(54295.5895, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54295.5895, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54295.5895, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(54295.5895, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54295.5895, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54283.4020, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(54295.5895, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(54283.4020, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.8795400001563954
test loss is 0.4183728455296715
test entropy is  0.5759166452052343
________________________________
2
distance 2 is tensor(54283.4020, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(54283.4020, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54283.4020, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.5759166452052343
avg test loss is  0.4183728455296715
avg accuracy is  0.9444000001563926
solo acc is  0.8795400001563954
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(54283.4020, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(985365.9044, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(70114.4643, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5954970134341199
avg test loss is  1.9085859955119355
avg accuracy is  0.9373800001563931
solo acc is  0.041320000156399236
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(70114.4643, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(993229.1755, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(85750.2972, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.62134736684887
avg test loss is  1.7745218092523267
avg accuracy is  0.9389800001563929
solo acc is  0.04570000015639916
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(85750.2972, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1001029.5780, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(101388.7424, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6097287097779076
avg test loss is  1.7679334013053523
avg accuracy is  0.9399400001563929
solo acc is  0.044380000156399195
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(101388.7424, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1008831.3639, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(117027.8801, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6043959700161844
avg test loss is  1.751942837939543
avg accuracy is  0.9407000001563929
solo acc is  0.04346000015639921
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(117027.8801, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1016633.6217, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(132667.6562, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(132667.6562, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(132667.6562, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(132667.6562, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.042180000156399236
test loss is 1.7445901873166605
test entropy is  0.5981403759983189
________________________________
cal ratio is  0.6318396960757559
distance 2 is tensor(83824.7031, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(83824.7031, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7948833934480842
distance 2 is tensor(66630.8583, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(66630.8583, device='cuda:3', dtype=torch.float64)
cal ratio is  0.891562373839699
distance 2 is tensor(59405.5814, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59405.5814, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9442256857032251
distance 2 is tensor(56092.2498, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(56092.2498, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9717129846181571
distance 2 is tensor(54505.5244, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54505.5244, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54505.5244, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(54505.5244, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54505.5244, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54497.8681, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(54505.5244, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(54497.8681, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9448200001563927
test loss is 0.19367710927077342
test entropy is  0.15306538832909844
________________________________
2
distance 2 is tensor(54497.8681, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(54497.8681, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54497.8681, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.15306538832909844
avg test loss is  0.19367710927077342
avg accuracy is  0.9478400001563926
solo acc is  0.9448200001563927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(54497.8681, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(985507.3344, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(70519.6566, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6627894346518894
avg test loss is  1.8086519758109851
avg accuracy is  0.9361200001563931
solo acc is  0.057340000156399
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(70519.6566, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(993432.2481, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(86149.3527, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6474236772036004
avg test loss is  1.724877361903715
avg accuracy is  0.9395000001563929
solo acc is  0.05000000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(86149.3527, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1001229.3573, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(101785.9508, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6254940040581062
avg test loss is  1.7330609643855668
avg accuracy is  0.9403600001563929
solo acc is  0.04634000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(101785.9508, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1009030.0327, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(117424.6281, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(117424.6281, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(117424.6281, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9409800001563929
test loss is 1.7337670980207145
test entropy is  0.6118192619756054
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.3682987689971924
mal norm is  tensor(1305898.8750, device='cuda:3')
distance 2 is tensor(117424.6281, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(117424.6281, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.006591130048036575
sync_entropy is 0.023977546021342278
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [18, 20, 21, 22]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 77.56% 

Test Accuracy: 76.72% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13473.3242, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.3242, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02266014739871025
current submit client idx and staleness is  1 1
distance 2 is tensor(13463.9885, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.9885, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006395290140062571
current submit client idx and staleness is  2 1
distance 2 is tensor(13459.2423, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.2423, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005033251829445362
current submit client idx and staleness is  3 1
distance 2 is tensor(13547.7656, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13547.7656, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1301129013299942
current submit client idx and staleness is  4 1
distance 2 is tensor(13446.3861, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13446.3861, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005578808020800352
current submit client idx and staleness is  5 1
distance 2 is tensor(13466.9630, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.9630, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004039756488054991
current submit client idx and staleness is  6 1
distance 2 is tensor(13485.4213, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.4213, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002156192669644952
current submit client idx and staleness is  7 1
distance 2 is tensor(13486.0648, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.0648, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003786050947383046
current submit client idx and staleness is  8 2
distance 2 is tensor(13477.5912, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.5912, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0031938974279910326
current submit client idx and staleness is  9 2
distance 2 is tensor(13466.3633, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.3633, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010239160619676113
current submit client idx and staleness is  10 2
distance 2 is tensor(13479.6716, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.6716, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005513518583029509
current submit client idx and staleness is  11 2
distance 2 is tensor(13491.4695, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.4695, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04625437408685684
current submit client idx and staleness is  12 2
distance 2 is tensor(13477.0383, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.0383, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02082052454352379
current submit client idx and staleness is  13 2
distance 2 is tensor(13485.0572, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.0572, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05393826216459274
current submit client idx and staleness is  14 2
distance 2 is tensor(13477.6771, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.6771, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002041722647845745
current submit client idx and staleness is  15 2
distance 2 is tensor(13484.7368, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.7368, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005521559622138739
current submit client idx and staleness is  16 3
distance 2 is tensor(13496.9527, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.9527, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0915822833776474
current submit client idx and staleness is  17 3
distance 2 is tensor(13509.2956, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13509.2956, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009664855897426605
current submit client idx and staleness is  18 3
distance 2 is tensor(13730.5044, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13730.5044, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.27051180601119995
current submit client idx and staleness is  19 3
distance 2 is tensor(13514.2163, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13514.2163, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.013601472601294518
current submit client idx and staleness is  20 3
distance 2 is tensor(13804.6837, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13804.6837, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.34080439805984497
current submit client idx and staleness is  21 3
distance 2 is tensor(13721.5798, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13721.5798, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05675765126943588
current submit client idx and staleness is  22 3
distance 2 is tensor(13748.5496, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13748.5496, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2935276925563812
current submit client idx and staleness is  23 3
distance 2 is tensor(13670.2789, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13670.2789, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.32362911105155945
current submit client idx and staleness is  24 4
distance 2 is tensor(13822.5950, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13822.5950, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3940592408180237
current submit client idx and staleness is  25 4
distance 2 is tensor(13955.3155, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13955.3155, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2235061228275299
current submit client idx and staleness is  26 4
distance 2 is tensor(13848.2657, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13848.2657, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1653733253479004
current submit client idx and staleness is  27 4
distance 2 is tensor(13978.7653, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13978.7653, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.37555497884750366
current submit client idx and staleness is  28 4
distance 2 is tensor(13582.6754, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13582.6754, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04080412536859512
current submit client idx and staleness is  29 4
distance 2 is tensor(13897.0094, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13897.0094, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.45484447479248047
current submit client idx and staleness is  30 4
distance 2 is tensor(13787.5460, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13787.5460, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5484706163406372
current submit client idx and staleness is  31 4
distance 2 is tensor(13913.3906, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13913.3906, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11056892573833466
current submit client idx and staleness is  40 6
distance 2 is tensor(13947.3219, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13947.3219, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6964837908744812
current submit client idx and staleness is  41 6
distance 2 is tensor(13790.4271, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13790.4271, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.31380778551101685
current submit client idx and staleness is  42 6
distance 2 is tensor(13868.4574, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13868.4574, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.26513466238975525
current submit client idx and staleness is  43 6
distance 2 is tensor(13924.2191, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13924.2191, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.24345597624778748
current submit client idx and staleness is  44 6
distance 2 is tensor(13874.1494, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13874.1494, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.36685991287231445
current submit client idx and staleness is  45 6
distance 2 is tensor(13906.3360, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13906.3360, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.21618390083312988
current submit client idx and staleness is  46 6
distance 2 is tensor(13896.0404, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13896.0404, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3820940852165222
current submit client idx and staleness is  47 6
distance 2 is tensor(13881.0550, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13881.0550, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.598512589931488
current submit client idx and staleness is  48 1
distance 2 is tensor(13502.0247, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.0247, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13644.6900, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13644.6900, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13730.1899, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13730.1899, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13472.3511, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.3511, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13790.9123, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13790.9123, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13481.4229, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.4229, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13488.8878, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.8878, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13496.3576, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.3576, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13736.2191, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13736.2191, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13488.3015, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.3015, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13504.7422, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.7422, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13508.5550, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13508.5550, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(32235.1206, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32235.1206, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940927.8877, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32244.3125, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32244.3125, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940927.2186, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32231.9095, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32231.9095, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940930.0637, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32236.6214, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32236.6214, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940930.8079, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32261.4883, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32261.4883, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940926.7314, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32248.4594, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32248.4594, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940931.1707, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32233.9620, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32233.9620, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940925.4398, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32266.6137, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32266.6137, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940919.7397, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32504.4605, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32504.4605, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941016.5551, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32244.3776, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32244.3776, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940930.2957, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32231.9504, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32231.9504, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940932.1210, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32433.8264, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32433.8264, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(940992.0906, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(32504.4605, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.8988e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0017189546789454931
distance 2 is tensor(18160620.8200, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(18160620.8200, device='cuda:3', dtype=torch.float64)
cal ratio is  0.041460278135613586
distance 2 is tensor(752944.3944, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(752944.3944, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20361797049648175
distance 2 is tensor(153313.0876, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(153313.0876, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45124036476888396
distance 2 is tensor(69181.1196, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(69181.1196, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6717439496669195
distance 2 is tensor(46471.9896, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46471.9896, device='cuda:3', dtype=torch.float64)
cal ratio is  0.819599950040846
distance 2 is tensor(38088.4519, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(38088.4519, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9053174596826914
distance 2 is tensor(34482.2146, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34482.2146, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9514806953594833
distance 2 is tensor(32809.1981, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32809.1981, device='cuda:3', dtype=torch.float64)
cal ratio is  0.975438176210222
distance 2 is tensor(32003.3662, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32003.3662, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32003.3662, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(32003.3662, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32003.3662, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32042.5850, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(32003.3662, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(32042.5850, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9972, device='cuda:3')
test acc is  0.9487400001563925
test loss is 0.2342925710274539
test entropy is  0.05592502368946948
________________________________
2
distance 2 is tensor(32042.5850, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(32042.5850, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32042.5850, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05592502368946948
avg test loss is  0.2342925710274539
avg accuracy is  0.9487200001563925
solo acc is  0.9487400001563925
compute similarity  is  tensor(0.9972, device='cuda:3')
compute_distance is  tensor(32042.5850, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(972989.9325, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16331.0056, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7055022380388606
avg test loss is  1.9371025984549461
avg accuracy is  0.9306800001563932
solo acc is  0.05934000015639897
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16331.0056, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(965035.4205, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31937.9731, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6557860414085486
avg test loss is  1.9295131356819817
avg accuracy is  0.9340600001563931
solo acc is  0.05076000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31937.9731, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(972822.8653, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47556.7352, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6642627736644062
avg test loss is  1.8145575700208658
avg accuracy is  0.9362800001563931
solo acc is  0.05232000015639903
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47556.7352, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(980615.6930, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63183.4636, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(63183.4636, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63183.4636, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(63183.4636, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(63183.4636, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04884000015639909
test loss is 1.809811878234834
test entropy is  0.6405577739638746
________________________________
cal ratio is  0.7029037201333362
distance 2 is tensor(44411.8198, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44411.8198, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8383942132031604
distance 2 is tensor(37234.5798, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37234.5798, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9156390964199974
distance 2 is tensor(34093.4709, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34093.4709, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9568898510748951
distance 2 is tensor(32623.6623, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32623.6623, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9782079766844626
distance 2 is tensor(31912.7596, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(31912.7596, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31912.7596, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(31912.7596, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31912.7596, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31895.1033, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(31912.7596, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(31895.1033, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9377600001563929
test loss is 0.22578937424313458
test entropy is  0.27743710683244266
________________________________
2
distance 2 is tensor(31895.1033, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(31895.1033, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31895.1033, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.27743710683244266
avg test loss is  0.22578937424313458
avg accuracy is  0.9476400001563926
solo acc is  0.9377600001563929
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31895.1033, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(972861.7732, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47858.7910, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6300164977912708
avg test loss is  1.9130565995145636
avg accuracy is  0.938460000156393
solo acc is  0.04608000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47858.7910, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(980767.3837, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63487.4341, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6525078118609651
avg test loss is  1.7717927011382548
avg accuracy is  0.9401400001563929
solo acc is  0.05128000015639907
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(63487.4341, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(988564.2208, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(79120.4726, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6278052017511919
avg test loss is  1.7788256018058113
avg accuracy is  0.9410400001563928
solo acc is  0.04700000015639914
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(79120.4726, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(996363.3156, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(94756.6808, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(94756.6808, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(94756.6808, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(94756.6808, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(94756.6808, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04434000015639919
test loss is 1.7825802390837608
test entropy is  0.610704299357846
________________________________
cal ratio is  0.5739745508235355
distance 2 is tensor(54387.9386, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54387.9386, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7576109751115779
distance 2 is tensor(41204.8290, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41204.8290, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8704092514184466
distance 2 is tensor(35865.0442, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35865.0442, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9329575232647688
distance 2 is tensor(33460.6070, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33460.6070, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9658966263444261
distance 2 is tensor(32319.5022, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32319.5022, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32319.5022, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(32319.5022, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32319.5022, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32297.1584, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(32319.5022, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(32297.1584, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9474800001563927
test loss is 0.18862196843198184
test entropy is  0.12374182319497247
________________________________
2
distance 2 is tensor(32297.1584, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(32297.1584, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32297.1584, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.12374182319497247
avg test loss is  0.18862196843198184
avg accuracy is  0.9491200001563925
solo acc is  0.9474800001563927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(32297.1584, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(973083.8268, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(48382.5345, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6681832810649482
avg test loss is  1.866107016115847
avg accuracy is  0.9379400001563929
solo acc is  0.05740000015639899
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(48382.5345, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(981028.9225, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(64006.1620, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6258662300341574
avg test loss is  1.8458772941928385
avg accuracy is  0.940340000156393
solo acc is  0.04576000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(64006.1620, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(988823.2336, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(79638.3117, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6395173738222293
avg test loss is  1.7457306311868341
avg accuracy is  0.9412800001563928
solo acc is  0.04938000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(79638.3117, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(996621.8586, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(95274.2705, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6165339812979369
avg test loss is  1.7623789350090124
avg accuracy is  0.9420200001563928
solo acc is  0.044800000156399185
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(95274.2705, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1004422.4119, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(110912.5269, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(110912.5269, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9427800001563927
test loss is 1.7487033718382305
test entropy is  0.6097279110604235
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.398146390914917
mal norm is  tensor(1233007., device='cuda:3')
distance 2 is tensor(110912.5269, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(110912.5269, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.005387206096202135
benign_entropy is 0.0206143856048584
benign_acc is 1.0000000005
benign_loss is 0.030813876539468765
benign_entropy is 0.05330243334174156
benign_acc is 1.0000000005
benign_loss is 0.03821900859475136
benign_entropy is 0.08576450496912003
benign_acc is 0.9500000005
benign_loss is 0.08001430332660675
benign_entropy is 0.0974126011133194
sync_acc is 1.0000000005
sync_loss is 0.00907563604414463
sync_entropy is 0.02927103079855442
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [20]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 77.55% 

Test Accuracy: 76.37% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13483.7593, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.7593, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0051743886433541775
current submit client idx and staleness is  1 1
distance 2 is tensor(13496.9299, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.9299, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004354729317128658
current submit client idx and staleness is  2 1
distance 2 is tensor(13478.9356, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.9356, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0052848816849291325
current submit client idx and staleness is  3 1
distance 2 is tensor(13492.7091, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.7091, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008273384533822536
current submit client idx and staleness is  4 1
distance 2 is tensor(13485.9929, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.9929, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008765729144215584
current submit client idx and staleness is  5 1
distance 2 is tensor(13486.6961, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.6961, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.013899408280849457
current submit client idx and staleness is  6 1
distance 2 is tensor(13665.1678, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13665.1678, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12573494017124176
current submit client idx and staleness is  7 1
distance 2 is tensor(13498.5273, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.5273, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004829613957554102
current submit client idx and staleness is  32 5
distance 2 is tensor(13900.8115, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13900.8115, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4829465448856354
current submit client idx and staleness is  33 5
distance 2 is tensor(13850.0386, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13850.0386, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3746231198310852
current submit client idx and staleness is  34 5
distance 2 is tensor(13906.9291, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13906.9291, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5469029545783997
current submit client idx and staleness is  35 5
distance 2 is tensor(13903.0072, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13903.0072, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.7008812427520752
current submit client idx and staleness is  36 5
distance 2 is tensor(13926.1019, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13926.1019, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2480783462524414
current submit client idx and staleness is  37 5
distance 2 is tensor(13799.9162, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13799.9162, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3870081603527069
current submit client idx and staleness is  38 5
distance 2 is tensor(13919.3232, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13919.3232, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.168326735496521
current submit client idx and staleness is  39 5
distance 2 is tensor(13864.5553, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13864.5553, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2892226576805115
current submit client idx and staleness is  48 1
distance 2 is tensor(13634.9358, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13634.9358, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13581.4698, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13581.4698, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13500.2240, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.2240, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13730.1960, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13730.1960, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13501.1020, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.1020, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13523.6238, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13523.6238, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13583.2664, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13583.2664, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13763.6304, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13763.6304, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13521.4369, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13521.4369, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13494.4529, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.4529, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13519.1387, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13519.1387, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13501.3951, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.3951, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(45123.0357, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45123.0357, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941056.2613, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45115.2230, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45115.2230, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941056.6896, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45193.4908, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45193.4908, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941102.3609, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45118.1293, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45118.1293, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941057.0149, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45220.3744, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45220.3744, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941111.7250, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45135.6761, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45135.6761, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941055.8992, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45104.4279, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45104.4279, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941058.5266, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45110.2890, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45110.2890, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941053.9866, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45152.7981, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45152.7981, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941052.4120, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45101.6327, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45101.6327, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941058.9991, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45109.7170, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45109.7170, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941056.8170, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45134.6781, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45134.6781, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(941055.5831, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(45220.3744, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.8558e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.002027494823509719
distance 2 is tensor(21420349.3837, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(21420349.3837, device='cuda:3', dtype=torch.float64)
cal ratio is  0.0450277117712692
distance 2 is tensor(964509.2722, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(964509.2722, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21219734662437306
distance 2 is tensor(204666.2629, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(204666.2629, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4606488833743043
distance 2 is tensor(94279.2906, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(94279.2906, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6787111745964335
distance 2 is tensor(63988.3851, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63988.3851, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8238394370286433
distance 2 is tensor(52716.2174, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52716.2174, device='cuda:3', dtype=torch.float64)
cal ratio is  0.907655476416915
distance 2 is tensor(47848.1096, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47848.1096, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9527100807622291
distance 2 is tensor(45585.4204, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45585.4204, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9760682149759595
distance 2 is tensor(44494.5009, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44494.5009, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44494.5009, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44494.5009, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44494.5009, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44533.5634, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44494.5009, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44533.5634, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9947, device='cuda:3')
test acc is  0.9490200001563925
test loss is 0.21561136022743072
test entropy is  0.06530850751907863
________________________________
2
distance 2 is tensor(44533.5634, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44533.5634, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44533.5634, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.06530850751907863
avg test loss is  0.21561136022743072
avg accuracy is  0.9490200001563925
solo acc is  0.9490200001563925
compute similarity  is  tensor(0.9947, device='cuda:3')
compute_distance is  tensor(44533.5634, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(985786.0419, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16303.9698, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.7116657176133617
avg test loss is  1.9095719673139664
avg accuracy is  0.9314800001563932
solo acc is  0.058800000156398975
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16303.9698, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(971574.0987, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31909.3599, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6414743723619319
avg test loss is  1.9549321177060648
avg accuracy is  0.9345600001563931
solo acc is  0.048740000156399094
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31909.3599, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(979360.5229, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47527.8257, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6401691429145501
avg test loss is  1.8608878468308607
avg accuracy is  0.937320000156393
solo acc is  0.04816000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47527.8257, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(987152.8575, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63154.2867, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6502192869515675
avg test loss is  1.7679420426068708
avg accuracy is  0.9388400001563929
solo acc is  0.050820000156399044
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63154.2867, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(994948.8084, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78786.2825, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78786.2825, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78786.2825, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78786.2825, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.046600000156399146
test loss is 1.7774349847413085
test entropy is  0.6262189646053802
________________________________
cal ratio is  0.7424510880188229
distance 2 is tensor(58494.9841, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58494.9841, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8616558458065102
distance 2 is tensor(50402.5313, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50402.5313, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9282543189751233
distance 2 is tensor(46786.4422, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46786.4422, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9634587871702681
distance 2 is tensor(45076.7584, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45076.7584, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45076.7584, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(45076.7584, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45076.7584, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45038.3209, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(45076.7584, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(45038.3209, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9334400001563932
test loss is 0.2546687735354199
test entropy is  0.36574691109111546
________________________________
2
distance 2 is tensor(45038.3209, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(45038.3209, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45038.3209, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.36574691109111546
avg test loss is  0.2546687735354199
avg accuracy is  0.9476800001563926
solo acc is  0.9334400001563932
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(45038.3209, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(985962.2059, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(60942.0909, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6043829480019371
avg test loss is  1.9307019603831688
avg accuracy is  0.939800000156393
solo acc is  0.04334000015639918
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(60942.0909, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(993846.1532, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(76574.0229, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6348711776611445
avg test loss is  1.7622136438594145
avg accuracy is  0.9409400001563928
solo acc is  0.04802000015639913
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(76574.0229, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1001644.3135, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(92209.9580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6222592244291549
avg test loss is  1.7491030440001232
avg accuracy is  0.9416600001563927
solo acc is  0.046480000156399144
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(92209.9580, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1009444.5696, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(107847.0844, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(107847.0844, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(107847.0844, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(107847.0844, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(107847.0844, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04446000015639919
test loss is 1.7464664833015189
test entropy is  0.6110104412373984
________________________________
cal ratio is  0.6345837521463329
distance 2 is tensor(68438.0584, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68438.0584, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7966073561419165
distance 2 is tensor(54518.2960, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54518.2960, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8925283421865132
distance 2 is tensor(48659.0640, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48659.0640, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9447377668768556
distance 2 is tensor(45970.0210, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45970.0210, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9719765815317184
distance 2 is tensor(44681.8319, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44681.8319, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44681.8319, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44681.8319, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44681.8319, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44651.5194, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44681.8319, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44651.5194, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9455800001563927
test loss is 0.18969444862609763
test entropy is  0.177332250110786
________________________________
2
distance 2 is tensor(44651.5194, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44651.5194, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44651.5194, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.177332250110786
avg test loss is  0.18969444862609763
avg accuracy is  0.9489800001563925
solo acc is  0.9455800001563927
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(44651.5194, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(985789.5521, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(60663.7133, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6274759713798532
avg test loss is  1.8966263023483785
avg accuracy is  0.939780000156393
solo acc is  0.04624000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(60663.7133, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(993707.9334, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(76291.7173, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6383504736453981
avg test loss is  1.7651923961956482
avg accuracy is  0.9412600001563928
solo acc is  0.04808000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(76291.7173, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1001503.8550, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(91926.4739, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6276766285109703
avg test loss is  1.7385197315374603
avg accuracy is  0.9419400001563928
solo acc is  0.046960000156399145
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(91926.4739, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1009303.4369, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(107564.6098, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(107564.6098, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(107564.6098, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9428200001563928
test loss is 1.7380860021047275
test entropy is  0.6141980650556057
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.376542091369629
mal norm is  tensor(1195885.1250, device='cuda:3')
distance 2 is tensor(107564.6098, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(107564.6098, device='cuda:3', dtype=torch.float64)
benign_acc is 0.9500000005
benign_loss is 0.12796522676944733
benign_entropy is 0.07689687609672546
sync_acc is 1.0000000005
sync_loss is 0.015515444800257683
sync_entropy is 0.04013830050826073
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [24]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 77.77% 

Test Accuracy: 76.63% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13467.2927, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.2927, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0035150782205164433
current submit client idx and staleness is  1 1
distance 2 is tensor(13458.8028, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.8028, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00865534134209156
current submit client idx and staleness is  2 1
distance 2 is tensor(13471.0357, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.0357, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0038671940565109253
current submit client idx and staleness is  3 1
distance 2 is tensor(13470.4133, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.4133, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004316476173698902
current submit client idx and staleness is  4 1
distance 2 is tensor(13466.1273, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.1273, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003857653122395277
current submit client idx and staleness is  5 1
distance 2 is tensor(13476.8037, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.8037, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003228966612368822
current submit client idx and staleness is  6 1
distance 2 is tensor(13450.1613, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13450.1613, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01049228385090828
current submit client idx and staleness is  7 1
distance 2 is tensor(13450.1864, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13450.1864, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0038500535301864147
current submit client idx and staleness is  8 2
distance 2 is tensor(13495.9333, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.9333, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.018621932715177536
current submit client idx and staleness is  9 2
distance 2 is tensor(13481.8442, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.8442, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0037392117083072662
current submit client idx and staleness is  10 2
distance 2 is tensor(13497.3641, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.3641, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.025239134207367897
current submit client idx and staleness is  11 2
distance 2 is tensor(13479.8306, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.8306, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004121490754187107
current submit client idx and staleness is  12 2
distance 2 is tensor(13488.7657, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.7657, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05077109485864639
current submit client idx and staleness is  13 2
distance 2 is tensor(13478.7879, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.7879, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002790669212117791
current submit client idx and staleness is  14 2
distance 2 is tensor(13489.1456, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.1456, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007206606678664684
current submit client idx and staleness is  15 2
distance 2 is tensor(13496.1949, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.1949, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0016756703844293952
current submit client idx and staleness is  48 1
distance 2 is tensor(13483.4607, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.4607, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13506.5105, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13506.5105, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13796.6469, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13796.6469, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13495.3543, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.3543, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13493.0572, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13493.0572, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13777.0005, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13777.0005, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13490.8877, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.8877, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13711.1602, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13711.1602, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13912.4415, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13912.4415, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13498.2334, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.2334, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13476.7908, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.7908, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13502.5551, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.5551, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(44865.1351, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44865.1351, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948846.7586, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44852.6525, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44852.6525, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948845.4204, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44839.7383, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44839.7383, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948856.5479, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44864.3603, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44864.3603, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948845.1125, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44860.1926, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44860.1926, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948848.5792, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44901.4305, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44901.4305, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948851.3500, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44842.2671, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44842.2671, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948848.3070, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44861.0943, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44861.0943, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948843.7085, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45026.6915, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45026.6915, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948906.2510, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44854.4627, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44854.4627, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948846.3859, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44867.4273, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44867.4273, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948845.4851, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44858.1277, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44858.1277, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(948845.9945, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(45026.6915, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.5749e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.002023146719692704
distance 2 is tensor(21374443.0874, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(21374443.0874, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04497940334060864
distance 2 is tensor(961409.7720, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(961409.7720, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21208347371753616
distance 2 is tensor(203899.0931, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(203899.0931, device='cuda:3', dtype=torch.float64)
cal ratio is  0.46052525011532536
distance 2 is tensor(93900.6956, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(93900.6956, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6786200540938055
distance 2 is tensor(63722.9199, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63722.9199, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8237838246544287
distance 2 is tensor(52493.8464, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52493.8464, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9076259330434793
distance 2 is tensor(47644.7211, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47644.7211, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9526945910539157
distance 2 is tensor(45390.9126, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45390.9126, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9760602734852507
distance 2 is tensor(44304.2878, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44304.2878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44304.2878, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44304.2878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44304.2878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44343.3503, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44304.2878, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44343.3503, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9948, device='cuda:3')
test acc is  0.9491400001563924
test loss is 0.23948949531312538
test entropy is  0.0531964801617212
________________________________
2
distance 2 is tensor(44343.3503, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44343.3503, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44343.3503, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.0531964801617212
avg test loss is  0.23948949531312538
avg accuracy is  0.9491600001563925
solo acc is  0.9491400001563924
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(44343.3503, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(993349.2986, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16305.2779, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.684890556899483
avg test loss is  1.934628478858782
avg accuracy is  0.9321000001563933
solo acc is  0.05404000015639903
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16305.2779, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(979236.9595, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31913.0958, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6334142535543807
avg test loss is  1.939719728954003
avg accuracy is  0.935200000156393
solo acc is  0.04722000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31913.0958, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(987025.2948, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47533.2293, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6494082894624041
avg test loss is  1.8069229901904036
avg accuracy is  0.937880000156393
solo acc is  0.05026000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47533.2293, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(994819.0043, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63161.2901, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6264340718231542
avg test loss is  1.801291030995986
avg accuracy is  0.9393200001563929
solo acc is  0.046280000156399145
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63161.2901, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1002616.3187, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78794.4287, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78794.4287, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78794.4287, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78794.4287, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.044780000156399186
test loss is 1.7851214268628288
test entropy is  0.6152988404340451
________________________________
cal ratio is  0.7408210920069529
distance 2 is tensor(58372.4981, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58372.4981, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8607102089276601
distance 2 is tensor(50241.8759, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50241.8759, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9277440351692297
distance 2 is tensor(46611.5523, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46611.5523, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9631952026003324
distance 2 is tensor(44896.0206, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44896.0206, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44896.0206, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44896.0206, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44896.0206, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44881.4894, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44896.0206, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44881.4894, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9333800001563932
test loss is 0.24998438101299963
test entropy is  0.3407925922814233
________________________________
2
distance 2 is tensor(44881.4894, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44881.4894, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44881.4894, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.3407925922814233
avg test loss is  0.24998438101299963
avg accuracy is  0.9479800001563926
solo acc is  0.9333800001563932
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(44881.4894, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(993546.0785, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(60790.4681, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6217216329501413
avg test loss is  1.8686291551041176
avg accuracy is  0.9402600001563929
solo acc is  0.04696000015639914
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(60790.4681, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1001434.6879, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(76423.4217, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6155439871732536
avg test loss is  1.7938455840205902
avg accuracy is  0.9416200001563928
solo acc is  0.04446000015639919
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(76423.4217, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1009233.8584, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(92059.8572, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6162216311601727
avg test loss is  1.7498991530569619
avg accuracy is  0.9423000001563928
solo acc is  0.04534000015639918
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(92059.8572, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1017034.8263, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(107698.1089, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6077493655559657
avg test loss is  1.7415984179967505
avg accuracy is  0.9429600001563928
solo acc is  0.0437800001563992
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(107698.1089, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1024836.7875, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(123337.7100, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(123337.7100, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(123337.7100, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(123337.7100, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.041780000156399245
test loss is 1.7502479710237449
test entropy is  0.5945913525645995
________________________________
cal ratio is  0.5921246673481028
distance 2 is tensor(73031.2301, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(73031.2301, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7694967436299063
distance 2 is tensor(56197.2334, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(56197.2334, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8772101058026077
distance 2 is tensor(49296.7364, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(49296.7364, device='cuda:3', dtype=torch.float64)
cal ratio is  0.936595377002878
distance 2 is tensor(46171.0823, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46171.0823, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9677787162740384
distance 2 is tensor(44683.3190, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44683.3190, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44683.3190, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44683.3190, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44683.3190, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44663.7877, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44683.3190, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44663.7877, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9480600001563926
test loss is 0.1863928430248052
test entropy is  0.12509063696083816
________________________________
2
distance 2 is tensor(44663.7877, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44663.7877, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44663.7877, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.12509063696083816
avg test loss is  0.1863928430248052
avg accuracy is  0.9496800001563925
solo acc is  0.9480600001563926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(44663.7877, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(993463.3888, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(60716.5547, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.643621364822778
avg test loss is  1.8518933347423974
avg accuracy is  0.9396000001563929
solo acc is  0.04982000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(60716.5547, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1001398.5551, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(76343.5604, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6414101793409308
avg test loss is  1.7440853067066358
avg accuracy is  0.9414800001563928
solo acc is  0.048360000156399116
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(76343.5604, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1009194.6109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(91977.7864, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6264740100220951
avg test loss is  1.7302750490815437
avg accuracy is  0.9424000001563928
solo acc is  0.04660000015639915
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(91977.7864, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1016994.4060, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(107615.9722, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6068660785703708
avg test loss is  1.7461656216160415
avg accuracy is  0.9430200001563928
solo acc is  0.04336000015639921
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(107615.9722, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1024796.2233, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(123255.1570, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(123255.1570, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9437000001563928
test loss is 1.7564783018568288
test entropy is  0.5923628872236633
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.414278268814087
mal norm is  tensor(1371188.6250, device='cuda:3')
distance 2 is tensor(123255.1570, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(123255.1570, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.004399644210934639
benign_entropy is 0.017732327803969383
sync_acc is 1.0000000005
sync_loss is 0.007772676646709442
sync_entropy is 0.026566950604319572
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [24]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 77.59% 

Test Accuracy: 76.49% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13473.6872, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.6872, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006168311927467585
current submit client idx and staleness is  1 1
distance 2 is tensor(13465.1131, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.1131, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009716575033962727
current submit client idx and staleness is  2 1
distance 2 is tensor(13466.6612, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.6612, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004301933571696281
current submit client idx and staleness is  3 1
distance 2 is tensor(13463.4173, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.4173, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0038327709771692753
current submit client idx and staleness is  4 1
distance 2 is tensor(13466.9638, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.9638, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0032926828134804964
current submit client idx and staleness is  5 1
distance 2 is tensor(13459.1612, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.1612, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0037452131509780884
current submit client idx and staleness is  6 1
distance 2 is tensor(13470.9450, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.9450, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005750073119997978
current submit client idx and staleness is  7 1
distance 2 is tensor(13605.9407, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13605.9407, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4435572624206543
current submit client idx and staleness is  16 3
distance 2 is tensor(13694.7547, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13694.7547, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1831633299589157
current submit client idx and staleness is  17 3
distance 2 is tensor(13825.8793, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13825.8793, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.37133732438087463
current submit client idx and staleness is  18 3
distance 2 is tensor(13800.0122, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13800.0122, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11676380783319473
current submit client idx and staleness is  19 3
distance 2 is tensor(13530.4425, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13530.4425, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.10303900390863419
current submit client idx and staleness is  20 3
distance 2 is tensor(13526.8246, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13526.8246, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010661379434168339
current submit client idx and staleness is  21 3
distance 2 is tensor(13507.0964, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13507.0964, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.020015588030219078
current submit client idx and staleness is  22 3
distance 2 is tensor(13538.6490, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13538.6490, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0742969661951065
current submit client idx and staleness is  23 3
distance 2 is tensor(13844.3537, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13844.3537, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5692775845527649
current submit client idx and staleness is  48 1
distance 2 is tensor(13500.8536, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.8536, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13773.4311, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13773.4311, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13490.9587, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.9587, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13482.9329, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.9329, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13511.3946, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13511.3946, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13493.0097, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13493.0097, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13722.2937, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13722.2937, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13482.9699, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.9699, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13610.1262, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13610.1262, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13498.9458, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.9458, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13512.5013, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13512.5013, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13582.3301, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13582.3301, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(45050.5788, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45050.5788, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955100.6631, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45068.4480, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45068.4480, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955127.0535, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45011.5914, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45011.5914, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955099.7915, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45203.8145, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45203.8145, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955155.7450, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45021.2294, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45021.2294, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955103.3620, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45032.6162, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45032.6162, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955100.4611, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45175.2463, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45175.2463, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955164.5424, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45083.9378, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45083.9378, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955135.2289, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45018.2122, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45018.2122, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955099.5598, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45015.9010, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45015.9010, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955099.5381, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45202.9697, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45202.9697, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955171.0408, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45015.6279, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45015.6279, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(955097.7458, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(45203.8145, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.5863e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.002027120856964515
distance 2 is tensor(21416455.6992, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(21416455.6992, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04502355861458026
distance 2 is tensor(964245.0831, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(964245.0831, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21218755147163734
distance 2 is tensor(204600.8288, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(204600.8288, device='cuda:3', dtype=torch.float64)
cal ratio is  0.46063817141650376
distance 2 is tensor(94246.9750, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(94246.9750, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6787032172115155
distance 2 is tensor(63965.8012, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63965.8012, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8238339703433886
distance 2 is tensor(52697.1606, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52697.1606, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9076533397344612
distance 2 is tensor(47830.7123, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47830.7123, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9527088368606231
distance 2 is tensor(45568.7953, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45568.7953, device='cuda:3', dtype=torch.float64)
cal ratio is  0.976067481135153
distance 2 is tensor(44478.2442, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44478.2442, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44478.2442, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44478.2442, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44478.2442, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44517.1505, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44478.2442, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44517.1505, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9949, device='cuda:3')
test acc is  0.9491600001563925
test loss is 0.23624827574286378
test entropy is  0.05385702845710151
________________________________
2
distance 2 is tensor(44517.1505, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44517.1505, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44517.1505, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05385702845710151
avg test loss is  0.23624827574286378
avg accuracy is  0.9491400001563924
solo acc is  0.9491600001563925
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(44517.1505, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(999771.5922, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16296.6731, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6710754339499851
avg test loss is  1.953752459924849
avg accuracy is  0.9315800001563932
solo acc is  0.05168000015639906
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16296.6731, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(985568.3322, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31905.5048, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6281162055252153
avg test loss is  1.9403524449109422
avg accuracy is  0.934760000156393
solo acc is  0.04660000015639914
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31905.5048, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(993357.2011, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47527.7015, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6411668097271639
avg test loss is  1.8141607665039998
avg accuracy is  0.9376200001563929
solo acc is  0.04858000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47527.7015, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1001151.8063, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63156.6042, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.625917734621126
avg test loss is  1.7903296735585499
avg accuracy is  0.9389400001563929
solo acc is  0.046020000156399156
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63156.6042, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1008949.5575, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78790.2991, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78790.2991, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78790.2991, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78790.2991, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04574000015639915
test loss is 1.7598202391658597
test entropy is  0.6207306173908741
________________________________
cal ratio is  0.7422962101989511
distance 2 is tensor(58485.6811, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58485.6811, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8615665747047528
distance 2 is tensor(50389.3500, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50389.3500, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9282057186471996
distance 2 is tensor(46771.6597, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46771.6597, device='cuda:3', dtype=torch.float64)
cal ratio is  0.963434573326141
distance 2 is tensor(45061.4159, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45061.4159, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45061.4159, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(45061.4159, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45061.4159, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45040.4784, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(45061.4159, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(45040.4784, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9326000001563932
test loss is 0.2511105611062873
test entropy is  0.3455011148358245
________________________________
2
distance 2 is tensor(45040.4784, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(45040.4784, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45040.4784, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.3455011148358245
avg test loss is  0.2511105611062873
avg accuracy is  0.9478000001563927
solo acc is  0.9326000001563932
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(45040.4784, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(999960.7078, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(60945.5621, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6153837644383121
avg test loss is  1.8689954017129395
avg accuracy is  0.9399800001563929
solo acc is  0.04560000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(60945.5621, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1007847.7943, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(76579.0351, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6221743960057378
avg test loss is  1.7666416404497287
avg accuracy is  0.9416200001563928
solo acc is  0.04610000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(76579.0351, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1015647.2548, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(92216.4371, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6166454765116772
avg test loss is  1.740413675985068
avg accuracy is  0.9423800001563928
solo acc is  0.045000000156399184
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(92216.4371, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1023448.7638, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(107854.7980, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(107854.7980, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(107854.7980, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(107854.7980, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(107854.7980, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.042840000156399216
test loss is 1.7442937208258587
test entropy is  0.6037433779681735
________________________________
cal ratio is  0.6344448594303446
distance 2 is tensor(68427.8679, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68427.8679, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7965207858957515
distance 2 is tensor(54504.2810, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54504.2810, device='cuda:3', dtype=torch.float64)
cal ratio is  0.89247962546777
distance 2 is tensor(48644.0008, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48644.0008, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9447110047738968
distance 2 is tensor(45954.4514, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45954.4514, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9719632060263024
distance 2 is tensor(44666.0134, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44666.0134, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44666.0134, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44666.0134, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44666.0134, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44654.6071, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44666.0134, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44654.6071, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9461800001563926
test loss is 0.1883125771134806
test entropy is  0.1551631054343165
________________________________
2
distance 2 is tensor(44654.6071, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44654.6071, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44654.6071, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.1551631054343165
avg test loss is  0.1883125771134806
avg accuracy is  0.9491400001563924
solo acc is  0.9461800001563926
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(44654.6071, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(999788.0080, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(60668.6043, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6338510536553
avg test loss is  1.852163403540316
avg accuracy is  0.939800000156393
solo acc is  0.04878000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(60668.6043, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1007710.0099, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(76298.1931, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6384874824672708
avg test loss is  1.7389740192371865
avg accuracy is  0.9418800001563927
solo acc is  0.04854000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(76298.1931, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1015507.4795, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(91933.9019, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.628753405474031
avg test loss is  1.712907517810002
avg accuracy is  0.9425000001563928
solo acc is  0.04730000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(91933.9019, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1023308.1497, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(107572.1462, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6077003524736371
avg test loss is  1.734053642091239
avg accuracy is  0.9431000001563927
solo acc is  0.04338000015639921
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(107572.1462, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1031110.1109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(123212.2822, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(123212.2822, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9438000001563928
test loss is 1.7533704809215673
test entropy is  0.5905232771354563
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4099147319793701
mal norm is  tensor(1370741.1250, device='cuda:3')
distance 2 is tensor(123212.2822, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(123212.2822, device='cuda:3', dtype=torch.float64)
benign_acc is 0.9500000005
benign_loss is 0.0777142345905304
benign_entropy is 0.04918362572789192
sync_acc is 1.0000000005
sync_loss is 0.008618657477200031
sync_entropy is 0.028328437358140945
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [24, 26]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 77.67% 

Test Accuracy: 76.50% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13476.3303, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.3303, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003296602051705122
current submit client idx and staleness is  1 1
distance 2 is tensor(13480.1857, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13480.1857, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0038929462898522615
current submit client idx and staleness is  2 1
distance 2 is tensor(13468.2976, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.2976, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006489114370197058
current submit client idx and staleness is  3 1
distance 2 is tensor(13457.0378, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.0378, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0033015094231814146
current submit client idx and staleness is  4 1
distance 2 is tensor(13470.4847, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.4847, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0028170652221888304
current submit client idx and staleness is  5 1
distance 2 is tensor(13477.3949, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.3949, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00544547475874424
current submit client idx and staleness is  6 1
distance 2 is tensor(13478.8991, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.8991, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004319516476243734
current submit client idx and staleness is  7 1
distance 2 is tensor(13458.7092, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.7092, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026973611675202847
current submit client idx and staleness is  8 2
distance 2 is tensor(13469.4449, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.4449, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.014066236093640327
current submit client idx and staleness is  9 2
distance 2 is tensor(13746.8830, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13746.8830, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.20651011168956757
current submit client idx and staleness is  10 2
distance 2 is tensor(13483.6033, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.6033, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003464188426733017
current submit client idx and staleness is  11 2
distance 2 is tensor(13548.8087, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13548.8087, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0027614054270088673
current submit client idx and staleness is  12 2
distance 2 is tensor(13491.4989, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.4989, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007119516376405954
current submit client idx and staleness is  13 2
distance 2 is tensor(13501.1398, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.1398, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002367564709857106
current submit client idx and staleness is  14 2
distance 2 is tensor(13482.8342, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.8342, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.028670575469732285
current submit client idx and staleness is  15 2
distance 2 is tensor(13782.9897, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13782.9897, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07327903807163239
current submit client idx and staleness is  24 4
distance 2 is tensor(13950.4966, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13950.4966, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.20550808310508728
current submit client idx and staleness is  25 4
distance 2 is tensor(13816.7322, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13816.7322, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.24502646923065186
current submit client idx and staleness is  26 4
distance 2 is tensor(13838.2787, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13838.2787, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.821845531463623
current submit client idx and staleness is  27 4
distance 2 is tensor(14020.1808, device='cuda:3', dtype=torch.float64)
check distance is  tensor(14020.1808, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.38415029644966125
current submit client idx and staleness is  28 4
distance 2 is tensor(13623.2128, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13623.2128, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005046803504228592
current submit client idx and staleness is  29 4
distance 2 is tensor(13819.8398, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13819.8398, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2817094922065735
current submit client idx and staleness is  30 4
distance 2 is tensor(13881.6095, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13881.6095, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.29508134722709656
current submit client idx and staleness is  31 4
distance 2 is tensor(13630.3237, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13630.3237, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.025152239948511124
current submit client idx and staleness is  48 1
distance 2 is tensor(13793.4259, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13793.4259, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13486.1917, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.1917, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13572.7802, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13572.7802, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13500.6108, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.6108, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13787.5032, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13787.5032, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13524.1505, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13524.1505, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13821.9969, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13821.9969, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13519.8263, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13519.8263, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13509.7076, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13509.7076, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13500.9018, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.9018, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13504.3919, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.3919, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13492.6369, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.6369, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(34580.6278, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34580.6278, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965054.4633, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34586.3523, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34586.3523, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965058.1934, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34575.2673, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34575.2673, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965054.7247, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34578.3256, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34578.3256, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965053.8444, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34743.5457, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34743.5457, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965124.8038, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34698.3638, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34698.3638, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965104.1813, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34572.9202, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34572.9202, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965056.6619, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34584.6947, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34584.6947, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965055.0419, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34907.7042, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34907.7042, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965169.7811, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34600.6004, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34600.6004, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965055.3627, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34583.5547, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34583.5547, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965055.5357, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34591.3951, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34591.3951, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(965055.8455, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(34907.7042, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.5579e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0017813634988451867
distance 2 is tensor(18820054.6056, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(18820054.6056, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04220620265774794
distance 2 is tensor(794322.9887, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(794322.9887, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20544148878767438
distance 2 is tensor(163186.9557, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(163186.9557, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4532564564904485
distance 2 is tensor(73965.4856, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(73965.4856, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6732434907516367
distance 2 is tensor(49796.7187, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(49796.7187, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8205146813547048
distance 2 is tensor(40858.9785, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40858.9785, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9058222148611498
distance 2 is tensor(37010.9024, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37010.9024, device='cuda:3', dtype=torch.float64)
cal ratio is  0.951747801766617
distance 2 is tensor(35225.0811, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35225.0811, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9755751262361179
distance 2 is tensor(34364.7327, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34364.7327, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34364.7327, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(34364.7327, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34364.7327, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34403.9515, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(34364.7327, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(34403.9515, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9970, device='cuda:3')
test acc is  0.9498000001563925
test loss is 0.2268685701926125
test entropy is  0.05707370832486821
________________________________
2
distance 2 is tensor(34403.9515, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(34403.9515, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34403.9515, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05707370832486821
avg test loss is  0.2268685701926125
avg accuracy is  0.9498000001563925
solo acc is  0.9498000001563925
compute similarity  is  tensor(0.9970, device='cuda:3')
compute_distance is  tensor(34403.9515, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(999459.2718, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16290.7889, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6691874334269472
avg test loss is  1.957548252914263
avg accuracy is  0.9327400001563932
solo acc is  0.05146000015639905
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16290.7889, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(990308.5204, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31898.4638, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6334088804471828
avg test loss is  1.92533798351922
avg accuracy is  0.935740000156393
solo acc is  0.04828000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31898.4638, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(998096.6984, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47519.4931, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6522344783748812
avg test loss is  1.7793564743093213
avg accuracy is  0.9383200001563929
solo acc is  0.05074000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47519.4931, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1005890.7819, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63147.8438, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6364621352356719
avg test loss is  1.7587057178282677
avg accuracy is  0.9399400001563929
solo acc is  0.04792000015639912
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63147.8438, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1013688.2455, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78781.0181, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78781.0181, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78781.0181, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78781.0181, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.045860000156399156
test loss is 1.7547711697990631
test entropy is  0.6205055649247011
________________________________
cal ratio is  0.6523428774820107
distance 2 is tensor(51392.3042, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51392.3042, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8076769230576979
distance 2 is tensor(41508.4534, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41508.4534, device='cuda:3', dtype=torch.float64)
cal ratio is  0.898707660045153
distance 2 is tensor(37303.9040, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37303.9040, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9480027063593656
distance 2 is tensor(35364.2386, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35364.2386, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9736538000207651
distance 2 is tensor(34432.5191, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34432.5191, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34432.5191, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(34432.5191, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34432.5191, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34431.4254, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(34432.5191, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(34431.4254, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9436400001563928
test loss is 0.19662414528215139
test entropy is  0.19960550016835524
________________________________
2
distance 2 is tensor(34431.4254, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(34431.4254, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34431.4254, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.19960550016835524
avg test loss is  0.19662414528215139
avg accuracy is  0.9489400001563925
solo acc is  0.9436400001563928
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(34431.4254, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(999427.3770, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(50425.5127, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6057965498979744
avg test loss is  1.9277893446595467
avg accuracy is  0.9396400001563929
solo acc is  0.0427400001563992
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(50425.5127, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1007342.1293, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(66054.5597, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6449609126352593
avg test loss is  1.7358662540955312
avg accuracy is  0.9415000001563928
solo acc is  0.04950000015639909
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(66054.5597, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1015139.4574, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(81689.1655, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(81689.1655, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(81689.1655, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(81689.1655, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(81689.1655, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.046660000156399144
test loss is 1.7352272345281927
test entropy is  0.6262841397691565
________________________________
cal ratio is  0.6406258954252054
distance 2 is tensor(52332.1222, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52332.1222, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8003916442473782
distance 2 is tensor(41886.2569, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41886.2569, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8946454215902461
distance 2 is tensor(37473.3493, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37473.3493, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9458569602064889
distance 2 is tensor(35444.4694, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35444.4694, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9725512130513846
distance 2 is tensor(34471.5893, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34471.5893, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34471.5893, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(34471.5893, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34471.5893, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34457.0581, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(34471.5893, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(34457.0581, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9454600001563926
test loss is 0.19041482822569397
test entropy is  0.17158864663861445
________________________________
2
distance 2 is tensor(34457.0581, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(34457.0581, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34457.0581, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.17158864663861445
avg test loss is  0.19041482822569397
avg accuracy is  0.9494600001563925
solo acc is  0.9454600001563926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(34457.0581, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(999442.4743, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(50461.5253, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6293400468118965
avg test loss is  1.8764315916754095
avg accuracy is  0.9400600001563929
solo acc is  0.047440000156399126
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(50461.5253, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1007360.1880, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(66090.0913, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6402657348329149
avg test loss is  1.7467982217174052
avg accuracy is  0.9419400001563928
solo acc is  0.04840000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(66090.0913, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1015157.3470, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(81724.6947, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6346626106049399
avg test loss is  1.711180879484357
avg accuracy is  0.9427600001563928
solo acc is  0.04886000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(81724.6947, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1022957.4957, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(97362.5368, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6164295246915135
avg test loss is  1.723181516313187
avg accuracy is  0.9435000001563928
solo acc is  0.04474000015639918
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(97362.5368, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1030759.2519, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(113001.5870, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(113001.5870, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9438800001563927
test loss is 1.7527432046887819
test entropy is  0.5944178733222015
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4124913215637207
mal norm is  tensor(1256704.1250, device='cuda:3')
distance 2 is tensor(113001.5870, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(113001.5870, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.006743381265550852
benign_entropy is 0.02396593801677227
benign_acc is 1.0000000005
benign_loss is 0.03947547823190689
benign_entropy is 0.06804949045181274
sync_acc is 1.0000000005
sync_loss is 0.006357239093631506
sync_entropy is 0.02330091781914234
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 77.94% 

Test Accuracy: 76.47% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13465.9559, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.9559, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003163969609886408
current submit client idx and staleness is  1 1
distance 2 is tensor(13473.8632, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.8632, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003528054105117917
current submit client idx and staleness is  2 1
distance 2 is tensor(13475.9828, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.9828, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002112111309543252
current submit client idx and staleness is  3 1
distance 2 is tensor(13479.3421, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.3421, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0022361816372722387
current submit client idx and staleness is  4 1
distance 2 is tensor(13458.1395, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.1395, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002025777939707041
current submit client idx and staleness is  5 1
distance 2 is tensor(13476.8703, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.8703, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0023834602907299995
current submit client idx and staleness is  6 1
distance 2 is tensor(13477.3066, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.3066, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0019056808669120073
current submit client idx and staleness is  7 1
distance 2 is tensor(13459.2953, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.2953, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001223400584422052
current submit client idx and staleness is  48 1
distance 2 is tensor(13472.8547, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.8547, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13509.7128, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13509.7128, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13472.2166, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.2166, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13518.7600, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13518.7600, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13490.5682, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.5682, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13500.7245, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.7245, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13473.3667, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.3667, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13726.0359, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13726.0359, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13478.0689, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.0689, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13571.0428, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13571.0428, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13677.7886, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13677.7886, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13465.9230, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.9230, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(57834.9787, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(57834.9787, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963702.5558, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57988.5414, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(57988.5414, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963755.0743, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(58083.0779, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(58083.0779, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963786.7565, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57812.2035, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(57812.2035, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963710.5014, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(58139.5927, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(58139.5927, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963809.7398, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57818.2985, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(57818.2985, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963699.2720, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57831.2064, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(57831.2064, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963714.5962, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57831.4754, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(57831.4754, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963698.8521, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(58083.9715, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(58083.9715, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963780.4323, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57822.5186, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(57822.5186, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963702.2082, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57832.1088, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(57832.1088, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963693.7248, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57842.5844, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(57842.5844, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(963699.8267, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(58139.5927, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.4317e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.002298939145748432
distance 2 is tensor(24288273.2206, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(24288273.2206, device='cuda:3', dtype=torch.float64)
cal ratio is  0.047947254945906626
distance 2 is tensor(1164556.0245, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1164556.0245, device='cuda:3', dtype=torch.float64)
cal ratio is  0.218968616707199
distance 2 is tensor(255001.2493, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(255001.2493, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4679408007890289
distance 2 is tensor(119325.5441, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(119325.5441, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6840618275037122
distance 2 is tensor(81626.0970, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(81626.0970, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8270800638067484
distance 2 is tensor(67511.3865, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(67511.3865, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9094389578658119
distance 2 is tensor(61397.4975, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(61397.4975, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9536449929496027
distance 2 is tensor(58551.3404, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58551.3404, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9765481177498112
distance 2 is tensor(57178.2390, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(57178.2390, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57178.2390, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(57178.2390, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57178.2390, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57216.6765, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(57178.2390, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(57216.6765, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9918, device='cuda:3')
test acc is  0.9499000001563925
test loss is 0.23981645471099175
test entropy is  0.05226482504525024
________________________________
2
distance 2 is tensor(57216.6765, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(57216.6765, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57216.6765, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05226482504525024
avg test loss is  0.23981645471099175
avg accuracy is  0.9499400001563925
solo acc is  0.9499000001563925
compute similarity  is  tensor(0.9918, device='cuda:3')
compute_distance is  tensor(57216.6765, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1021108.3608, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16275.7808, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6606534810169883
avg test loss is  1.9427138626423028
avg accuracy is  0.9322800001563932
solo acc is  0.05116000015639906
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16275.7808, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1000551.6351, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31885.1352, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6400295506657847
avg test loss is  1.8564869705063607
avg accuracy is  0.936320000156393
solo acc is  0.04760000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31885.1352, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1008341.1872, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47508.0330, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6508505510552155
avg test loss is  1.7521797461277993
avg accuracy is  0.9387200001563929
solo acc is  0.051000000156399064
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47508.0330, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1016136.7128, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63138.0151, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.622574297973262
avg test loss is  1.768912719796076
avg accuracy is  0.940020000156393
solo acc is  0.045460000156399165
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63138.0151, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1023935.3772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78772.4254, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78772.4254, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78772.4254, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78772.4254, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.044640000156399184
test loss is 1.7474276173450147
test entropy is  0.6159489262668069
________________________________
cal ratio is  0.841928011670654
distance 2 is tensor(66320.7744, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(66320.7744, device='cuda:3', dtype=torch.float64)
cal ratio is  0.917565917923014
distance 2 is tensor(60853.7386, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(60853.7386, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9578961673078924
distance 2 is tensor(58291.6312, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58291.6312, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9787211277879923
distance 2 is tensor(57051.2065, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(57051.2065, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57051.2065, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(57051.2065, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57051.2065, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57043.5503, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(57051.2065, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(57043.5503, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.8622800001563962
test loss is 0.4601578382999086
test entropy is  0.6255354992950054
________________________________
2
distance 2 is tensor(57043.5503, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(57043.5503, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57043.5503, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.6255354992950054
avg test loss is  0.4601578382999086
avg accuracy is  0.9467200001563927
solo acc is  0.8622800001563962
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(57043.5503, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1020924.6651, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(72843.3198, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6179872240937884
avg test loss is  1.77155263436115
avg accuracy is  0.9415400001563928
solo acc is  0.044900000156399174
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(72843.3198, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1028779.0985, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(88481.4456, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6104196601968896
avg test loss is  1.747066636524542
avg accuracy is  0.9423600001563928
solo acc is  0.0436800001563992
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(88481.4456, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1036580.9809, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(104120.5345, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6029844995197433
avg test loss is  1.7365278661098627
avg accuracy is  0.9431000001563927
solo acc is  0.04276000015639922
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(104120.5345, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1044383.5382, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(119760.3307, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5865020221456543
avg test loss is  1.7554160871774034
avg accuracy is  0.9436400001563928
solo acc is  0.040480000156399264
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(119760.3307, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1052186.4909, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(135399.3492, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(135399.3492, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(135399.3492, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(135399.3492, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.038860000156399295
test loss is 1.7782014580943701
test entropy is  0.5721348924252688
________________________________
cal ratio is  0.6421755694288943
distance 2 is tensor(86950.1999, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(86950.1999, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8013583665740309
distance 2 is tensor(69678.2765, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(69678.2765, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8951861783885687
distance 2 is tensor(62375.0110, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62375.0110, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9461429342621006
distance 2 is tensor(59015.6095, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59015.6095, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9726993361179013
distance 2 is tensor(57404.4152, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(57404.4152, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57404.4152, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(57404.4152, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57404.4152, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57374.1027, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(57404.4152, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(57374.1027, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9472800001563927
test loss is 0.1852430964390154
test entropy is  0.15433500501353417
________________________________
2
distance 2 is tensor(57374.1027, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(57374.1027, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(57374.1027, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.15433500501353417
avg test loss is  0.1852430964390154
avg accuracy is  0.9500200001563925
solo acc is  0.9472800001563927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(57374.1027, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1021124.3240, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(73368.9198, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6216251860799082
avg test loss is  1.8361064079777358
avg accuracy is  0.9407400001563929
solo acc is  0.04698000015639914
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(73368.9198, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1029042.1302, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(88999.8592, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6173043640525749
avg test loss is  1.745935389757766
avg accuracy is  0.9425800001563928
solo acc is  0.04358000015639921
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(88999.8592, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1036840.4549, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(104637.2538, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6094504433214817
avg test loss is  1.7258501941590663
avg accuracy is  0.9433200001563928
solo acc is  0.04342000015639921
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(104637.2538, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1044641.9958, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(120277.0985, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5902708321047561
avg test loss is  1.7479852930359219
avg accuracy is  0.9438600001563928
solo acc is  0.04052000015639927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(120277.0985, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1052444.8265, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(135917.7571, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(135917.7571, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9446800001563926
test loss is 1.7695952588335022
test entropy is  0.5750135448582642
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4612265825271606
mal norm is  tensor(1512949.6250, device='cuda:3')
distance 2 is tensor(135917.7571, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(135917.7571, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.0031676061917096376
sync_entropy is 0.014240999706089497
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [24, 25, 27, 28]
alphas 3 is [1.         0.16666667 0.2        0.33333333 0.5       ]
alphas is  [0.45454545 0.07575758 0.09090909 0.15151515 0.22727273]
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 78.01% 

Test Accuracy: 76.56% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13486.7526, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.7526, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00904516689479351
current submit client idx and staleness is  1 1
distance 2 is tensor(13478.0035, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.0035, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0072356476448476315
current submit client idx and staleness is  2 1
distance 2 is tensor(13683.7860, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13683.7860, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.16647309064865112
current submit client idx and staleness is  3 1
distance 2 is tensor(13504.6686, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.6686, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13278540968894958
current submit client idx and staleness is  4 1
distance 2 is tensor(13497.8294, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.8294, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0002310128475073725
current submit client idx and staleness is  5 1
distance 2 is tensor(13474.2946, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.2946, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009478384628891945
current submit client idx and staleness is  6 1
distance 2 is tensor(13469.6999, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.6999, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007652095519006252
current submit client idx and staleness is  7 1
distance 2 is tensor(13472.0331, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.0331, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004505275283008814
current submit client idx and staleness is  8 2
distance 2 is tensor(13479.3423, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.3423, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006653051823377609
current submit client idx and staleness is  9 2
distance 2 is tensor(13517.5681, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13517.5681, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01617341861128807
current submit client idx and staleness is  10 2
distance 2 is tensor(13931.1229, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13931.1229, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3745667040348053
current submit client idx and staleness is  11 2
distance 2 is tensor(13497.2857, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.2857, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01393754780292511
current submit client idx and staleness is  12 2
distance 2 is tensor(13502.2428, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.2428, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010022217407822609
current submit client idx and staleness is  13 2
distance 2 is tensor(13489.4272, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.4272, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00977439247071743
current submit client idx and staleness is  14 2
distance 2 is tensor(13495.5350, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.5350, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006583188660442829
current submit client idx and staleness is  15 2
distance 2 is tensor(13498.6447, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.6447, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009308239445090294
current submit client idx and staleness is  16 3
distance 2 is tensor(13578.9504, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13578.9504, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06114023178815842
current submit client idx and staleness is  17 3
distance 2 is tensor(13528.7832, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13528.7832, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05422411113977432
current submit client idx and staleness is  18 3
distance 2 is tensor(13522.8152, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13522.8152, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010298984125256538
current submit client idx and staleness is  19 3
distance 2 is tensor(13639.1984, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13639.1984, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06181847304105759
current submit client idx and staleness is  20 3
distance 2 is tensor(13715.1638, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13715.1638, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3910493850708008
current submit client idx and staleness is  21 3
distance 2 is tensor(13669.2447, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13669.2447, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5719999074935913
current submit client idx and staleness is  22 3
distance 2 is tensor(13659.0179, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13659.0179, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04252437502145767
current submit client idx and staleness is  23 3
distance 2 is tensor(13816.9818, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13816.9818, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.47938841581344604
current submit client idx and staleness is  32 5
distance 2 is tensor(13829.3829, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13829.3829, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3164049983024597
current submit client idx and staleness is  33 5
distance 2 is tensor(13982.3762, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13982.3762, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2583213150501251
current submit client idx and staleness is  34 5
distance 2 is tensor(13914.2865, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13914.2865, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5055306553840637
current submit client idx and staleness is  35 5
distance 2 is tensor(13829.6775, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13829.6775, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5297225713729858
current submit client idx and staleness is  36 5
distance 2 is tensor(13950.8410, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13950.8410, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2913859784603119
current submit client idx and staleness is  37 5
distance 2 is tensor(13868.3218, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13868.3218, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3503580093383789
current submit client idx and staleness is  38 5
distance 2 is tensor(13814.7025, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13814.7025, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1127755269408226
current submit client idx and staleness is  39 5
distance 2 is tensor(13850.2828, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13850.2828, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.22101429104804993
current submit client idx and staleness is  40 6
distance 2 is tensor(13849.2419, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13849.2419, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.518598198890686
current submit client idx and staleness is  41 6
distance 2 is tensor(13841.7529, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13841.7529, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.25808364152908325
current submit client idx and staleness is  42 6
distance 2 is tensor(13822.0812, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13822.0812, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.16088497638702393
current submit client idx and staleness is  43 6
distance 2 is tensor(13837.2505, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13837.2505, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.355221688747406
current submit client idx and staleness is  44 6
distance 2 is tensor(13839.5959, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13839.5959, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.39833804965019226
current submit client idx and staleness is  45 6
distance 2 is tensor(13867.2309, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13867.2309, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2694271206855774
current submit client idx and staleness is  46 6
distance 2 is tensor(13833.1242, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13833.1242, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2857884168624878
current submit client idx and staleness is  47 6
distance 2 is tensor(13860.8815, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13860.8815, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4070332646369934
current submit client idx and staleness is  48 1
distance 2 is tensor(13585.6476, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13585.6476, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13687.5357, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13687.5357, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13498.4139, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.4139, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13489.3966, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.3966, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13474.0561, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.0561, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13523.0681, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13523.0681, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13489.6728, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.6728, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13666.4491, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13666.4491, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13523.8302, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13523.8302, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13700.3922, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13700.3922, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13496.7193, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.7193, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13538.5182, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13538.5182, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(41415.5366, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41415.5366, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970295.5996, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41360.9193, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41360.9193, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970282.8398, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41250.0070, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41250.0070, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970241.9803, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41514.1799, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41514.1799, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970335.9292, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41249.4553, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41249.4553, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970240.7687, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41274.5668, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41274.5668, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970240.9040, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41341.9357, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41341.9357, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970270.7863, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41547.0038, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41547.0038, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970339.0809, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41267.6479, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41267.6479, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970243.4734, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41246.2095, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41246.2095, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970243.7700, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41270.4024, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41270.4024, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970241.6322, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41260.3007, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41260.3007, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(970254.0910, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(41547.0038, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.6955e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0019433964726638037
distance 2 is tensor(20531962.2700, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(20531962.2700, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04408397036684629
distance 2 is tensor(905130.3693, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(905130.3693, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20996183618609962
distance 2 is tensor(190042.8850, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(190042.8850, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45821586637923345
distance 2 is tensor(87080.6304, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(87080.6304, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6769165751162611
distance 2 is tensor(58946.2515, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58946.2515, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8227498922400528
distance 2 is tensor(48497.9602, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48497.9602, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9070561955465893
distance 2 is tensor(43990.3204, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43990.3204, device='cuda:3', dtype=torch.float64)
cal ratio is  0.952395573128501
distance 2 is tensor(41896.2316, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41896.2316, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9759070378408046
distance 2 is tensor(40886.8496, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40886.8496, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40886.8496, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40886.8496, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40886.8496, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40925.9121, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40886.8496, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40925.9121, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9958, device='cuda:3')
test acc is  0.9510000001563925
test loss is 0.21176930839515767
test entropy is  0.06156279232151701
________________________________
2
distance 2 is tensor(40925.9121, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40925.9121, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40925.9121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.06156279232151701
avg test loss is  0.21176930839515767
avg accuracy is  0.9510200001563925
solo acc is  0.9510000001563925
compute similarity  is  tensor(0.9958, device='cuda:3')
compute_distance is  tensor(40925.9121, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1011244.8380, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16296.2401, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6721589159020378
avg test loss is  1.9553954659215629
avg accuracy is  0.934860000156393
solo acc is  0.05192000015639905
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16296.2401, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(998831.4391, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31901.1774, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6513895836022808
avg test loss is  1.8840437375980874
avg accuracy is  0.9379600001563929
solo acc is  0.05270000015639904
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31901.1774, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1006617.8360, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47520.7605, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6487655673185577
avg test loss is  1.780991648774013
avg accuracy is  0.9401400001563929
solo acc is  0.04974000015639908
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47520.7605, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1014410.8994, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63148.3507, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6385181668545584
avg test loss is  1.7439843458897621
avg accuracy is  0.9411600001563928
solo acc is  0.0488600001563991
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(63148.3507, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1022207.7805, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78781.6323, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78781.6323, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78781.6323, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78781.6323, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.046040000156399155
test loss is 1.7460478411611084
test entropy is  0.6214282163573653
________________________________
cal ratio is  0.7116778399108419
distance 2 is tensor(56067.0895, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(56067.0895, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8436103992995037
distance 2 is tensor(47298.8399, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47298.8399, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9184820771988923
distance 2 is tensor(43443.1037, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43443.1037, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9583750703675268
distance 2 is tensor(41634.7725, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41634.7725, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9789665040236932
distance 2 is tensor(40759.1125, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40759.1125, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40759.1125, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40759.1125, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40759.1125, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40721.6125, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40759.1125, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40721.6125, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9411400001563928
test loss is 0.21387077562387108
test entropy is  0.2757718514679643
________________________________
2
distance 2 is tensor(40721.6125, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40721.6125, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40721.6125, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.2757718514679643
avg test loss is  0.21387077562387108
avg accuracy is  0.9499000001563925
solo acc is  0.9411400001563928
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(40721.6125, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1011077.6509, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(56661.3112, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.623361716032638
avg test loss is  1.8576295331615926
avg accuracy is  0.9417600001563928
solo acc is  0.047040000156399135
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(56661.3112, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1018972.5129, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(72292.4643, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.636676429177794
avg test loss is  1.729135451109513
avg accuracy is  0.9432400001563928
solo acc is  0.04838000015639912
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(72292.4643, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1026770.5478, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(87928.3408, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6228131584804076
avg test loss is  1.7218974894269958
avg accuracy is  0.9439600001563928
solo acc is  0.046960000156399145
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(87928.3408, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1034571.0700, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(103566.5605, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6060024102401855
avg test loss is  1.7343890554154926
avg accuracy is  0.9445200001563926
solo acc is  0.0433400001563992
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(103566.5605, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1042372.8194, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(119206.2749, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(119206.2749, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(119206.2749, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(119206.2749, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04126000015639925
test loss is 1.7431744314215678
test entropy is  0.5928649175197572
________________________________
cal ratio is  0.57855729267708
distance 2 is tensor(68967.6397, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68967.6397, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7606296468275933
distance 2 is tensor(52458.8333, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52458.8333, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8721408257292403
distance 2 is tensor(45751.4390, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45751.4390, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9338853261097578
distance 2 is tensor(42726.5236, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42726.5236, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9663782603740557
distance 2 is tensor(41289.9987, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41289.9987, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41289.9987, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(41289.9987, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41289.9987, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41289.9987, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(41289.9987, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(41289.9987, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9495400001563925
test loss is 0.17875699029462483
test entropy is  0.13069729694663107
________________________________
2
distance 2 is tensor(41289.9987, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(41289.9987, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41289.9987, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.13069729694663107
avg test loss is  0.17875699029462483
avg accuracy is  0.9513600001563924
solo acc is  0.9495400001563925
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(41289.9987, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1011383.6734, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(57347.6031, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6612337490024469
avg test loss is  1.8046879021408002
avg accuracy is  0.9413400001563927
solo acc is  0.05608000015639902
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(57347.6031, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1019315.4557, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(72973.2749, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6342471336845852
avg test loss is  1.7525157109855691
avg accuracy is  0.9430800001563928
solo acc is  0.04674000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(72973.2749, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1027110.6588, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(88607.3820, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6323334948181192
avg test loss is  1.7040547632500338
avg accuracy is  0.9440000001563927
solo acc is  0.04810000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(88607.3820, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1034910.1628, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(104244.9708, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6130213411262883
avg test loss is  1.7165765736414038
avg accuracy is  0.9448200001563927
solo acc is  0.04416000015639919
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(104244.9708, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1042711.5147, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(119884.2356, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(119884.2356, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9454200001563926
test loss is 1.7423257849100606
test entropy is  0.5929984885941991
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.3980730772018433
mal norm is  tensor(1333621.8750, device='cuda:3')
distance 2 is tensor(119884.2356, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(119884.2356, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.012023244053125381
benign_entropy is 0.033817537128925323
benign_acc is 1.0000000005
benign_loss is 0.016541995108127594
benign_entropy is 0.039711836725473404
benign_acc is 0.9500000005
benign_loss is 0.08338624238967896
benign_entropy is 0.0881771370768547
benign_acc is 0.9500000005
benign_loss is 0.10801806300878525
benign_entropy is 0.09604404121637344
sync_acc is 1.0000000005
sync_loss is 0.0027431349735707045
sync_entropy is 0.013033865951001644
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 77.97% 

Test Accuracy: 76.10% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13474.6223, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.6223, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0017227681819349527
current submit client idx and staleness is  1 1
distance 2 is tensor(13595.4088, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13595.4088, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01637353003025055
current submit client idx and staleness is  2 1
distance 2 is tensor(13754.6027, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13754.6027, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.48171156644821167
current submit client idx and staleness is  3 1
distance 2 is tensor(13485.4119, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.4119, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0009804938454180956
current submit client idx and staleness is  4 1
distance 2 is tensor(13475.8086, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.8086, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001426040194928646
current submit client idx and staleness is  5 1
distance 2 is tensor(13477.0108, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.0108, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0018081283196806908
current submit client idx and staleness is  6 1
distance 2 is tensor(13484.2014, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.2014, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0008865540730766952
current submit client idx and staleness is  7 1
distance 2 is tensor(13458.8488, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.8488, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0007979272631928325
current submit client idx and staleness is  48 1
distance 2 is tensor(13621.1371, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13621.1371, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13665.0224, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13665.0224, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13494.9080, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.9080, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13494.6802, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.6802, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13804.4265, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13804.4265, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13607.7014, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13607.7014, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13649.3517, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13649.3517, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13496.4417, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.4417, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13526.4889, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13526.4889, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13481.4799, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.4799, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13894.8333, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13894.8333, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13723.9522, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13723.9522, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(46936.4752, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(46936.4752, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(977910.5527, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46959.8855, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(46959.8855, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(977923.6489, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47249.4130, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47249.4130, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(978016.0652, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46950.0052, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(46950.0052, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(977912.1382, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46950.1655, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(46950.1655, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(977911.0579, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47230.8537, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47230.8537, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(978018.7000, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46943.1432, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(46943.1432, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(977917.8435, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47165.7091, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47165.7091, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(977994.6040, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47365.9693, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47365.9693, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(978067.8190, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46951.0786, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(46951.0786, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(977911.3259, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46933.5923, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(46933.5923, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(977910.5986, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46955.8373, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(46955.8373, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(977910.2693, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(47365.9693, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.5644e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0020750297945417366
distance 2 is tensor(21922709.3978, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(21922709.3978, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04555249581657313
distance 2 is tensor(998634.0851, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(998634.0851, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21343031129780748
distance 2 is tensor(213138.7716, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(213138.7716, device='cuda:3', dtype=torch.float64)
cal ratio is  0.46198519824719586
distance 2 is tensor(98466.9426, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(98466.9426, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6796949821053712
distance 2 is tensor(66927.5623, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(66927.5623, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8244356948375829
distance 2 is tensor(55177.4857, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55177.4857, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9079842956134866
distance 2 is tensor(50100.2801, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50100.2801, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9528821983085498
distance 2 is tensor(47739.7291, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47739.7291, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9761561958467586
distance 2 is tensor(46601.4655, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46601.4655, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46601.4655, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(46601.4655, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46601.4655, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46640.0592, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(46601.4655, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(46640.0592, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9946, device='cuda:3')
test acc is  0.9495800001563924
test loss is 0.2369986058039031
test entropy is  0.05313189603741724
________________________________
2
distance 2 is tensor(46640.0592, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(46640.0592, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46640.0592, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05313189603741724
avg test loss is  0.2369986058039031
avg accuracy is  0.9495800001563924
solo acc is  0.9495800001563924
compute similarity  is  tensor(0.9946, device='cuda:3')
compute_distance is  tensor(46640.0592, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1024603.6910, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16280.1465, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6581485286698012
avg test loss is  1.9425128266939422
avg accuracy is  0.9344800001563931
solo acc is  0.04822000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16280.1465, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1009332.7922, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31887.6989, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6505427865116188
avg test loss is  1.8237098473722062
avg accuracy is  0.9379800001563929
solo acc is  0.04946000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31887.6989, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1017121.1856, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47509.1215, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6419678939425427
avg test loss is  1.7664232572631153
avg accuracy is  0.9403800001563929
solo acc is  0.0485400001563991
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47509.1215, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1024915.8594, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63138.7275, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6266315595801834
avg test loss is  1.7506023649974247
avg accuracy is  0.9415400001563928
solo acc is  0.04656000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63138.7275, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1032714.2408, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78773.1716, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78773.1716, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78773.1716, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78773.1716, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.044280000156399185
test loss is 1.7509619982346245
test entropy is  0.6120872243362314
________________________________
cal ratio is  0.759923936808969
distance 2 is tensor(59861.5888, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59861.5888, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8717363801060966
distance 2 is tensor(52183.5414, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52183.5414, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9336680900132989
distance 2 is tensor(48722.0662, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48722.0662, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9662654286240795
distance 2 is tensor(47078.4910, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47078.4910, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47078.4910, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(47078.4910, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47078.4910, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47046.4598, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(47078.4910, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(47046.4598, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9325200001563932
test loss is 0.2565830785190434
test entropy is  0.36618309477558525
________________________________
2
distance 2 is tensor(47046.4598, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(47046.4598, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47046.4598, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.36618309477558525
avg test loss is  0.2565830785190434
avg accuracy is  0.9488000001563925
solo acc is  0.9325200001563932
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47046.4598, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1024731.1442, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(62929.6189, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5730916307024334
avg test loss is  1.9454336234980532
avg accuracy is  0.9422200001563927
solo acc is  0.0381600001563993
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(62929.6189, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1032611.0337, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78562.5595, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6278748237492179
avg test loss is  1.7161456806885311
avg accuracy is  0.9437400001563928
solo acc is  0.04748000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(78562.5595, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1040410.6496, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(94199.7711, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6081519723700746
avg test loss is  1.73184000927469
avg accuracy is  0.9444600001563926
solo acc is  0.04326000015639921
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(94199.7711, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1048212.3083, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(109838.3211, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5894074313857062
avg test loss is  1.7541549708837134
avg accuracy is  0.9448800001563926
solo acc is  0.04084000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(109838.3211, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1056014.6035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(125478.4184, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(125478.4184, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(125478.4184, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(125478.4184, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.0391000001563993
test loss is 1.771834079566819
test entropy is  0.5752744148378177
________________________________
cal ratio is  0.6021085197768662
distance 2 is tensor(75551.5628, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(75551.5628, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7759568373396892
distance 2 is tensor(58624.7434, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58624.7434, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8808841849379382
distance 2 is tensor(51641.5964, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51641.5964, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9385544231238386
distance 2 is tensor(48468.4946, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48468.4946, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9687897268518263
distance 2 is tensor(46955.8116, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46955.8116, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46955.8116, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(46955.8116, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46955.8116, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46943.9366, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(46955.8116, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(46943.9366, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9489600001563925
test loss is 0.1833199607366172
test entropy is  0.12627052707249856
________________________________
2
distance 2 is tensor(46943.9366, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(46943.9366, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46943.9366, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.12627052707249856
avg test loss is  0.1833199607366172
avg accuracy is  0.9503800001563925
solo acc is  0.9489600001563925
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(46943.9366, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1024707.4222, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(62973.8585, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6503238223702706
avg test loss is  1.7934344170038656
avg accuracy is  0.9414400001563927
solo acc is  0.05498000015639903
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(62973.8585, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1032634.1622, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78601.3592, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6401243596278188
avg test loss is  1.7027735728437028
avg accuracy is  0.9436400001563928
solo acc is  0.04850000015639912
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(78601.3592, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1040430.8445, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(94236.9478, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(94236.9478, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(94236.9478, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9444200001563926
test loss is 1.7066447615928357
test entropy is  0.6204455786425135
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.3536046743392944
mal norm is  tensor(1046970.8750, device='cuda:3')
distance 2 is tensor(94236.9478, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(94236.9478, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.001996781677007675
sync_entropy is 0.010185929015278816
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [28, 30]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 77.88% 

Test Accuracy: 76.41% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13482.9596, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.9596, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001205069711431861
current submit client idx and staleness is  1 1
distance 2 is tensor(13461.3703, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.3703, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0032965275458991528
current submit client idx and staleness is  2 1
distance 2 is tensor(13457.5494, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.5494, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002847484778612852
current submit client idx and staleness is  3 1
distance 2 is tensor(13465.8965, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.8965, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026047842111438513
current submit client idx and staleness is  4 1
distance 2 is tensor(13453.4883, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.4883, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003395893145352602
current submit client idx and staleness is  5 1
distance 2 is tensor(13466.8636, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.8636, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0010561110684648156
current submit client idx and staleness is  6 1
distance 2 is tensor(13468.3844, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.3844, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004343929700553417
current submit client idx and staleness is  7 1
distance 2 is tensor(13461.8147, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.8147, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002469551283866167
current submit client idx and staleness is  8 2
distance 2 is tensor(13485.1044, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.1044, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0025160189252346754
current submit client idx and staleness is  9 2
distance 2 is tensor(13477.0695, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.0695, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003973687998950481
current submit client idx and staleness is  10 2
distance 2 is tensor(13702.1009, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13702.1009, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.23861035704612732
current submit client idx and staleness is  11 2
distance 2 is tensor(13520.3933, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13520.3933, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007545452564954758
current submit client idx and staleness is  12 2
distance 2 is tensor(13640.1244, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13640.1244, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05118391662836075
current submit client idx and staleness is  13 2
distance 2 is tensor(13472.6707, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.6707, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.17267867922782898
current submit client idx and staleness is  14 2
distance 2 is tensor(13692.2289, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13692.2289, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5992035865783691
current submit client idx and staleness is  15 2
distance 2 is tensor(13494.0563, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.0563, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0014946346636861563
current submit client idx and staleness is  24 4
distance 2 is tensor(13808.3375, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13808.3375, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.21340064704418182
current submit client idx and staleness is  25 4
distance 2 is tensor(13843.9212, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13843.9212, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.7011796236038208
current submit client idx and staleness is  26 4
distance 2 is tensor(13816.5159, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13816.5159, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.462073415517807
current submit client idx and staleness is  27 4
distance 2 is tensor(13951.3277, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13951.3277, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.26959413290023804
current submit client idx and staleness is  28 4
distance 2 is tensor(13510.9879, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13510.9879, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006053269375115633
current submit client idx and staleness is  29 4
distance 2 is tensor(13847.7099, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13847.7099, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3299480676651001
current submit client idx and staleness is  30 4
distance 2 is tensor(13727.6811, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13727.6811, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.27772313356399536
current submit client idx and staleness is  31 4
distance 2 is tensor(13501.2546, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.2546, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0025976200122386217
current submit client idx and staleness is  48 1
distance 2 is tensor(13721.5857, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13721.5857, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13839.4552, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13839.4552, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13500.7392, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.7392, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13482.2200, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.2200, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13820.3832, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13820.3832, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13491.2256, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.2256, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13497.9413, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.9413, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13756.8972, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13756.8972, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13489.0874, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.0874, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13681.6364, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13681.6364, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13485.3401, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.3401, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13710.5242, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13710.5242, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(38635.4378, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38635.4378, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984245.6969, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38894.8466, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38894.8466, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984344.2536, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38627.4103, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38627.4103, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984245.0127, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38613.2165, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38613.2165, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984245.7150, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38643.4301, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38643.4301, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984246.5827, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38625.8837, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38625.8837, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984244.9346, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38844.1599, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38844.1599, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984325.2036, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38612.6551, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38612.6551, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984240.8294, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38731.4618, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38731.4618, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984296.5022, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38624.6409, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38624.6409, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984260.3384, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38643.0308, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38643.0308, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984246.8891, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38702.5974, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(38702.5974, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(984283.5636, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(38894.8466, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.4201e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0018803429422043574
distance 2 is tensor(19865850.6524, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(19865850.6524, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04336292048320844
distance 2 is tensor(861441.3111, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(861441.3111, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20823765277945208
distance 2 is tensor(179384.5370, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(179384.5370, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4563306138093935
distance 2 is tensor(81858.7189, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(81858.7189, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6755222148424644
distance 2 is tensor(55297.3605, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55297.3605, device='cuda:3', dtype=torch.float64)
cal ratio is  0.821901752131417
distance 2 is tensor(45448.9634, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45448.9634, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9065883128104056
distance 2 is tensor(41203.4605, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41203.4605, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9521497574543203
distance 2 is tensor(39231.9160, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39231.9160, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9757809788815639
distance 2 is tensor(38281.7824, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(38281.7824, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38281.7824, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(38281.7824, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38281.7824, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38320.6886, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(38281.7824, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(38320.6886, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9964, device='cuda:3')
test acc is  0.9502400001563925
test loss is 0.22925944307471327
test entropy is  0.054125441345022965
________________________________
2
distance 2 is tensor(38320.6886, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(38320.6886, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38320.6886, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.054125441345022965
avg test loss is  0.22925944307471327
avg accuracy is  0.9502400001563925
solo acc is  0.9502400001563925
compute similarity  is  tensor(0.9964, device='cuda:3')
compute_distance is  tensor(38320.6886, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1022627.8371, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16287.6926, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.670591365193467
avg test loss is  1.9162078984558124
avg accuracy is  0.9360400001563931
solo acc is  0.04972000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16287.6926, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1011517.0122, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31893.8696, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6393838282436362
avg test loss is  1.8817997948288003
avg accuracy is  0.9389600001563929
solo acc is  0.04994000015639908
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31893.8696, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1019304.6909, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47514.8997, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6544534988567957
avg test loss is  1.7434983192502385
avg accuracy is  0.9413600001563928
solo acc is  0.05192000015639905
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47514.8997, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1027099.0764, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63143.0414, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(63143.0414, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63143.0414, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(63143.0414, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(63143.0414, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04834000015639912
test loss is 1.7394880667671828
test entropy is  0.6329682527295769
________________________________
cal ratio is  0.7691470148852935
distance 2 is tensor(48566.2417, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48566.2417, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8770106328533168
distance 2 is tensor(42593.0852, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42593.0852, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9364887354942742
distance 2 is tensor(39887.9556, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39887.9556, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9677233456234786
distance 2 is tensor(38600.5647, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(38600.5647, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38600.5647, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(38600.5647, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38600.5647, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38580.8772, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(38600.5647, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(38580.8772, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9303000001563934
test loss is 0.2684425207193169
test entropy is  0.3950357434466062
________________________________
2
distance 2 is tensor(38580.8772, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(38580.8772, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38580.8772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.3950357434466062
avg test loss is  0.2684425207193169
avg accuracy is  0.9489400001563925
solo acc is  0.9303000001563934
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(38580.8772, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1022686.9766, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(54456.8661, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5872003607585302
avg test loss is  1.9162602243216142
avg accuracy is  0.9428600001563928
solo acc is  0.04018000015639925
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(54456.8661, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1030563.8489, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(70088.6830, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6290591051968772
avg test loss is  1.7341348530386416
avg accuracy is  0.9441800001563926
solo acc is  0.047520000156399136
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(70088.6830, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1038362.9110, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(85725.0561, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(85725.0561, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(85725.0561, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(85725.0561, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(85725.0561, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.045300000156399185
test loss is 1.7296359943002082
test entropy is  0.6157409927576704
________________________________
cal ratio is  0.6601128977238034
distance 2 is tensor(56588.1553, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(56588.1553, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8124737509065801
distance 2 is tensor(45976.3813, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45976.3813, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9013733510817097
distance 2 is tensor(41441.8764, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41441.8764, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9494069397463943
distance 2 is tensor(39345.2028, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39345.2028, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9743751807135501
distance 2 is tensor(38336.9930, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(38336.9930, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38336.9930, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(38336.9930, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38336.9930, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38310.5867, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(38336.9930, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(38310.5867, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9465800001563927
test loss is 0.18749590121242968
test entropy is  0.17152094149776279
________________________________
2
distance 2 is tensor(38310.5867, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(38310.5867, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(38310.5867, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.17152094149776279
avg test loss is  0.18749590121242968
avg accuracy is  0.9505600001563925
solo acc is  0.9465800001563927
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(38310.5867, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1022572.6546, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(54296.6907, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5986813158940172
avg test loss is  1.9064518597424793
avg accuracy is  0.9431000001563927
solo acc is  0.04124000015639924
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(54296.6907, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1030484.3074, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(69925.6482, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6272917776690115
avg test loss is  1.7473138415295144
avg accuracy is  0.9442800001563927
solo acc is  0.04602000015639916
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(69925.6482, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1038281.9275, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(85560.9946, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6242538847200706
avg test loss is  1.7101171249928682
avg accuracy is  0.9450000001563926
solo acc is  0.047180000156399136
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(85560.9946, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1046082.6496, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(101199.2490, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6054062228602217
avg test loss is  1.7266547237820637
avg accuracy is  0.9454000001563926
solo acc is  0.043020000156399216
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(101199.2490, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1053884.7253, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(116838.8133, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(116838.8133, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9459000001563926
test loss is 1.761236099483412
test entropy is  0.5841403935114136
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4464619159698486
mal norm is  tensor(1299634.8750, device='cuda:3')
distance 2 is tensor(116838.8133, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(116838.8133, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.008608553558588028
benign_entropy is 0.027279874309897423
benign_acc is 1.0000000005
benign_loss is 0.031255871057510376
benign_entropy is 0.05748732015490532
sync_acc is 1.0000000005
sync_loss is 0.003342417534440756
sync_entropy is 0.014762368984520435
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [30]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 77.93% 

Test Accuracy: 76.68% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13457.6955, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.6955, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0037005108315497637
current submit client idx and staleness is  1 1
distance 2 is tensor(13488.9507, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.9507, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0027447794564068317
current submit client idx and staleness is  2 1
distance 2 is tensor(13488.4844, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.4844, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0013436812441796064
current submit client idx and staleness is  3 1
distance 2 is tensor(13456.8569, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.8569, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0015320220263674855
current submit client idx and staleness is  4 1
distance 2 is tensor(13462.6457, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.6457, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001978569896891713
current submit client idx and staleness is  5 1
distance 2 is tensor(13464.9601, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.9601, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005293142981827259
current submit client idx and staleness is  6 1
distance 2 is tensor(13463.6532, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.6532, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0016655822983011603
current submit client idx and staleness is  7 1
distance 2 is tensor(13457.2954, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.2954, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0016413027187809348
current submit client idx and staleness is  16 3
distance 2 is tensor(13499.4552, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13499.4552, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.020643873140215874
current submit client idx and staleness is  17 3
distance 2 is tensor(13492.4219, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.4219, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00036972647649236023
current submit client idx and staleness is  18 3
distance 2 is tensor(13493.5011, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13493.5011, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0021746554411947727
current submit client idx and staleness is  19 3
distance 2 is tensor(13501.8424, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.8424, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008933154866099358
current submit client idx and staleness is  20 3
distance 2 is tensor(13483.4251, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.4251, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.011245766654610634
current submit client idx and staleness is  21 3
distance 2 is tensor(13471.9204, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.9204, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02568937838077545
current submit client idx and staleness is  22 3
distance 2 is tensor(13512.7310, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13512.7310, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003878418356180191
current submit client idx and staleness is  23 3
distance 2 is tensor(13973.5104, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13973.5104, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4821929931640625
current submit client idx and staleness is  48 1
distance 2 is tensor(13807.2447, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13807.2447, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13491.9491, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.9491, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13678.7226, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13678.7226, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13492.6131, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.6131, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13812.7628, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13812.7628, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13735.5842, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13735.5842, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13471.5493, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.5493, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13513.0336, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13513.0336, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13706.4706, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13706.4706, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13481.2901, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.2901, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13481.0431, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.0431, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13507.7730, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13507.7730, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(40815.9451, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40815.9451, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(989091.8231, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40480.8674, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40480.8674, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(988984.0280, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40593.2657, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40593.2657, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(989023.1662, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40495.6230, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40495.6230, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(988997.4444, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40810.0480, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40810.0480, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(989087.3574, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40517.8602, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40517.8602, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(988990.6033, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40843.7148, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40843.7148, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(989100.3492, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40508.6820, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40508.6820, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(988980.3964, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40503.3614, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40503.3614, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(988994.7726, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40492.7161, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40492.7161, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(988983.3144, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40494.9901, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40494.9901, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(988990.1228, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40484.0222, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40484.0222, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(988980.1683, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(40843.7148, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.4574e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0019268744429706843
distance 2 is tensor(20357477.3367, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(20357477.3367, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04389617849279002
distance 2 is tensor(893615.5320, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(893615.5320, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20951414009745184
distance 2 is tensor(187225.1590, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(187225.1590, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4577270613029815
distance 2 is tensor(85698.0211, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(85698.0211, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6765552934328036
distance 2 is tensor(57979.4768, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(57979.4768, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8225296220526946
distance 2 is tensor(47689.8283, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47689.8283, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9069342718458604
distance 2 is tensor(43251.5151, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43251.5151, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9523312381769933
distance 2 is tensor(41189.8283, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41189.8283, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9758738988508002
distance 2 is tensor(40196.1066, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40196.1066, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40196.1066, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40196.1066, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40196.1066, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40234.8566, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40196.1066, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40234.8566, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9961, device='cuda:3')
test acc is  0.9503000001563925
test loss is 0.23206821220122006
test entropy is  0.05245820324755717
________________________________
2
distance 2 is tensor(40234.8566, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40234.8566, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40234.8566, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05245820324755717
avg test loss is  0.23206821220122006
avg accuracy is  0.9502800001563925
solo acc is  0.9503000001563925
compute similarity  is  tensor(0.9961, device='cuda:3')
compute_distance is  tensor(40234.8566, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1029258.8039, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16285.9535, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6576723137017711
avg test loss is  1.94419005886673
avg accuracy is  0.936080000156393
solo acc is  0.04800000015639912
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16285.9535, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1017190.5505, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31893.3255, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6223907182207498
avg test loss is  1.9037714204215028
avg accuracy is  0.9392800001563929
solo acc is  0.045340000156399156
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31893.3255, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1024978.7795, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47515.4421, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6605071725747774
avg test loss is  1.7169660239878213
avg accuracy is  0.9412800001563928
solo acc is  0.054400000156399016
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47515.4421, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1032773.7742, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63144.7202, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6340099535024989
avg test loss is  1.728869493964993
avg accuracy is  0.9423200001563928
solo acc is  0.04856000015639912
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63144.7202, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1040572.0606, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78779.4442, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78779.4442, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78779.4442, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78779.4442, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04514000015639917
test loss is 1.7320754285663595
test entropy is  0.6182642698364185
________________________________
cal ratio is  0.7056384494430425
distance 2 is tensor(55589.7599, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55589.7599, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8400232258474852
distance 2 is tensor(46696.7084, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46696.7084, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9165276229120941
distance 2 is tensor(42798.8718, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42798.8718, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9573539481354967
distance 2 is tensor(40973.7390, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40973.7390, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9784438211212787
distance 2 is tensor(40090.5441, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40090.5441, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40090.5441, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40090.5441, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40090.5441, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40075.2316, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40090.5441, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40075.2316, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9429000001563927
test loss is 0.2044857055749125
test entropy is  0.24054532572436516
________________________________
2
distance 2 is tensor(40075.2316, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40075.2316, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40075.2316, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.24054532572436516
avg test loss is  0.2044857055749125
avg accuracy is  0.9502400001563925
solo acc is  0.9429000001563927
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(40075.2316, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1029119.3935, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(56019.2630, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6453125429580279
avg test loss is  1.7908234265454286
avg accuracy is  0.9425400001563928
solo acc is  0.054660000156399026
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(56019.2630, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1037018.0582, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(71650.2094, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.631299477022932
avg test loss is  1.7211706456930742
avg accuracy is  0.9443000001563926
solo acc is  0.047400000156399134
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(71650.2094, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1044816.7607, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(87286.3169, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6203807342768936
avg test loss is  1.7096103545649888
avg accuracy is  0.9449400001563927
solo acc is  0.045800000156399165
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(87286.3169, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1052617.9517, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(102924.5013, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5987192789078368
avg test loss is  1.7378234437969335
avg accuracy is  0.9454200001563926
solo acc is  0.042020000156399236
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(102924.5013, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1060420.1287, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(118563.7369, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(118563.7369, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(118563.7369, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(118563.7369, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.039660000156399276
test loss is 1.7737519340137082
test entropy is  0.5777716220873396
________________________________
cal ratio is  0.5751918895440846
distance 2 is tensor(68196.9521, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68196.9521, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7584137716807892
distance 2 is tensor(51721.4952, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51721.4952, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8708696535387364
distance 2 is tensor(45042.6424, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45042.6424, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9332043682700442
distance 2 is tensor(42034.0408, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42034.0408, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9660244584150575
distance 2 is tensor(40605.9874, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40605.9874, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40605.9874, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40605.9874, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40605.9874, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40566.7687, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40605.9874, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40566.7687, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9503000001563925
test loss is 0.18017865589934776
test entropy is  0.11001694469195802
________________________________
2
distance 2 is tensor(40566.7687, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40566.7687, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40566.7687, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.11001694469195802
avg test loss is  0.18017865589934776
avg accuracy is  0.9510800001563925
solo acc is  0.9503000001563925
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(40566.7687, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1029385.7735, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(56624.4000, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6709707487574623
avg test loss is  1.7613304740632587
avg accuracy is  0.9418800001563927
solo acc is  0.06358000015639893
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(56624.4000, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1037320.4827, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(72251.3324, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.649233829868419
avg test loss is  1.6890969032521748
avg accuracy is  0.9441400001563927
solo acc is  0.051020000156399084
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(72251.3324, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1045117.0935, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(87885.8212, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6166514005807354
avg test loss is  1.7244166353779375
avg accuracy is  0.9451000001563926
solo acc is  0.044600000156399186
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(87885.8212, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1052917.3641, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(103522.9986, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6013577078538173
avg test loss is  1.7331571652151434
avg accuracy is  0.9456000001563927
solo acc is  0.04214000015639924
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(103522.9986, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1060718.9640, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(119162.5067, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(119162.5067, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9463400001563926
test loss is 1.763815121577524
test entropy is  0.5812193156050904
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4541856050491333
mal norm is  tensor(1325573., device='cuda:3')
distance 2 is tensor(119162.5067, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(119162.5067, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.0022777661215513945
benign_entropy is 0.01098992396146059
sync_acc is 1.0000000005
sync_loss is 0.0031636334024369717
sync_entropy is 0.0141310915350914
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [32]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 77.99% 

Test Accuracy: 76.69% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13723.0057, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13723.0057, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03858822584152222
current submit client idx and staleness is  1 1
distance 2 is tensor(13448.5478, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13448.5478, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0036615817807614803
current submit client idx and staleness is  2 1
distance 2 is tensor(13457.6371, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.6371, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004139814991503954
current submit client idx and staleness is  3 1
distance 2 is tensor(13438.2415, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13438.2415, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0017025312408804893
current submit client idx and staleness is  4 1
distance 2 is tensor(13452.5934, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13452.5934, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0032460871152579784
current submit client idx and staleness is  5 1
distance 2 is tensor(13442.2921, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13442.2921, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003100622445344925
current submit client idx and staleness is  6 1
distance 2 is tensor(13438.8595, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13438.8595, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002079013967886567
current submit client idx and staleness is  7 1
distance 2 is tensor(13451.8399, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13451.8399, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00143657554872334
current submit client idx and staleness is  8 2
distance 2 is tensor(13468.9214, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.9214, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0017374837771058083
current submit client idx and staleness is  9 2
distance 2 is tensor(13459.0538, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.0538, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0032334960997104645
current submit client idx and staleness is  10 2
distance 2 is tensor(13458.3126, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.3126, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009043870493769646
current submit client idx and staleness is  11 2
distance 2 is tensor(13453.7128, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.7128, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004837611690163612
current submit client idx and staleness is  12 2
distance 2 is tensor(13453.9023, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.9023, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006057064048945904
current submit client idx and staleness is  13 2
distance 2 is tensor(13825.0009, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13825.0009, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3219800591468811
current submit client idx and staleness is  14 2
distance 2 is tensor(13503.1849, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13503.1849, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0024108397774398327
current submit client idx and staleness is  15 2
distance 2 is tensor(13451.4040, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13451.4040, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001556629897095263
current submit client idx and staleness is  48 1
distance 2 is tensor(13751.1558, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13751.1558, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13453.0794, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.0794, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13457.2478, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.2478, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13643.0057, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13643.0057, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13749.4795, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13749.4795, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13463.1844, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.1844, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13483.7377, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.7377, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13471.8211, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.8211, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13870.8994, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13870.8994, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13455.3564, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13455.3564, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13479.6571, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.6571, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13891.1145, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13891.1145, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(33336.0310, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33336.0310, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999239.6181, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33367.7164, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33367.7164, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999236.7614, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33339.7042, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33339.7042, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999242.0362, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33373.1535, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33373.1535, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999233.9535, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33356.7036, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33356.7036, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999242.4166, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33356.1398, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33356.1398, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999238.0551, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33336.0749, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33336.0749, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999234.2848, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33627.1829, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33627.1829, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999320.8249, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33338.5995, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33338.5995, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999235.3531, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33463.7279, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33463.7279, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999271.1649, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33578.8148, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33578.8148, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999308.0256, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33331.3836, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33331.3836, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(999236.0315, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(33627.1829, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.6762e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.001748379743003084
distance 2 is tensor(18471701.2820, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(18471701.2820, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04181362982215234
distance 2 is tensor(772368.8098, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(772368.8098, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20448382234059728
distance 2 is tensor(157936.8796, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(157936.8796, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45219894194259197
distance 2 is tensor(71418.9609, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(71418.9609, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6724570560670479
distance 2 is tensor(48026.1178, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48026.1178, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8200353561942882
distance 2 is tensor(39383.0538, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39383.0538, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9055587345940952
distance 2 is tensor(35663.6134, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35663.6134, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9516092317505255
distance 2 is tensor(33937.8708, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33937.8708, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9755039283884187
distance 2 is tensor(33106.5483, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33106.5483, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33106.5483, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(33106.5483, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33106.5483, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33145.6108, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(33106.5483, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(33145.6108, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9974, device='cuda:3')
test acc is  0.9500800001563925
test loss is 0.24565928633343187
test entropy is  0.04802596810377439
________________________________
2
distance 2 is tensor(33145.6108, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(33145.6108, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33145.6108, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.04802596810377439
avg test loss is  0.24565928633343187
avg accuracy is  0.9501000001563925
solo acc is  0.9500800001563925
compute similarity  is  tensor(0.9974, device='cuda:3')
compute_distance is  tensor(33145.6108, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1032404.8694, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16302.4474, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6719621228592475
avg test loss is  1.9049305420397493
avg accuracy is  0.9366600001563931
solo acc is  0.05304000015639904
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16302.4474, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1023883.8536, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31910.6843, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.625670730915216
avg test loss is  1.8717501834225472
avg accuracy is  0.9402600001563929
solo acc is  0.045300000156399144
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31910.6843, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1031672.6903, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47533.4285, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6523263618311919
avg test loss is  1.7262359584688836
avg accuracy is  0.9418200001563928
solo acc is  0.05158000015639906
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47533.4285, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1039468.1677, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63163.9976, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6291030952159096
avg test loss is  1.7324170816280042
avg accuracy is  0.9429000001563927
solo acc is  0.04726000015639914
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63163.9976, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1047267.1451, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78798.7591, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78798.7591, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78798.7591, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78798.7591, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.04580000015639916
test loss is 1.7244070437558168
test entropy is  0.6183583445256323
________________________________
cal ratio is  0.6401940436986433
distance 2 is tensor(50446.4298, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50446.4298, device='cuda:3', dtype=torch.float64)
cal ratio is  0.800121795000311
distance 2 is tensor(40363.2874, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40363.2874, device='cuda:3', dtype=torch.float64)
cal ratio is  0.894495280260648
distance 2 is tensor(36104.7044, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(36104.7044, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9457784659246261
distance 2 is tensor(34147.1165, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34147.1165, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9725105030717194
distance 2 is tensor(33208.4135, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33208.4135, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33208.4135, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(33208.4135, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33208.4135, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33189.1948, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(33208.4135, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(33189.1948, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9472800001563927
test loss is 0.18589637573698864
test entropy is  0.15671355073409313
________________________________
2
distance 2 is tensor(33189.1948, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(33189.1948, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33189.1948, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.15671355073409313
avg test loss is  0.18589637573698864
avg accuracy is  0.9506600001563925
solo acc is  0.9472800001563927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(33189.1948, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1032382.6865, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(49203.1995, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6430583830989535
avg test loss is  1.8065377371695341
avg accuracy is  0.9424000001563928
solo acc is  0.052100000156399075
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(49203.1995, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1040302.7747, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(64832.6358, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6410959282951891
avg test loss is  1.7095697032826027
avg accuracy is  0.9442800001563927
solo acc is  0.04944000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(64832.6358, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1048100.8631, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(80467.5842, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6272105953425092
avg test loss is  1.6994631827030036
avg accuracy is  0.9449600001563926
solo acc is  0.047720000156399135
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(80467.5842, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1055901.6063, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(96105.4859, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6034358518050454
avg test loss is  1.7300400458028555
avg accuracy is  0.9457200001563927
solo acc is  0.04258000015639923
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(96105.4859, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1063703.7748, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(111744.6305, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(111744.6305, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(111744.6305, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(111744.6305, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.040460000156399265
test loss is 1.7590572372117006
test entropy is  0.5838048932954784
________________________________
cal ratio is  0.5375984234953505
distance 2 is tensor(60073.7691, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(60073.7691, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7332108412416604
distance 2 is tensor(44046.6812, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44046.6812, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8562778751232386
distance 2 is tensor(37716.1388, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37716.1388, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9253535718844835
distance 2 is tensor(34900.7139, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34900.7139, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9619536862665428
distance 2 is tensor(33572.8227, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33572.8227, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33572.8227, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(33572.8227, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33572.8227, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33547.6665, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(33572.8227, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(33547.6665, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9505400001563925
test loss is 0.1861611366886205
test entropy is  0.08962436095046837
________________________________
2
distance 2 is tensor(33547.6665, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(33547.6665, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33547.6665, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.08962436095046837
avg test loss is  0.1861611366886205
avg accuracy is  0.9510600001563925
solo acc is  0.9505400001563925
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(33547.6665, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1032577.8889, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(49649.1380, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6832689499611135
avg test loss is  1.7481755777393155
avg accuracy is  0.9415200001563928
solo acc is  0.07066000015639888
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(49649.1380, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1040525.3746, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(65274.4668, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6511148936913141
avg test loss is  1.6942529172238792
avg accuracy is  0.9442400001563926
solo acc is  0.051800000156399066
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(65274.4668, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1048321.5149, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(80907.6885, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6331241815672506
avg test loss is  1.6891757248307737
avg accuracy is  0.9450200001563926
solo acc is  0.04856000015639911
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(80907.6885, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1056121.3129, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(96544.8450, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6043819143339191
avg test loss is  1.7290295216128648
avg accuracy is  0.9455800001563927
solo acc is  0.04256000015639922
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(96544.8450, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1063923.1009, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(112183.9419, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(112183.9419, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9462200001563926
test loss is 1.745238132793885
test entropy is  0.5885280232752681
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4088362455368042
mal norm is  tensor(1247316.7500, device='cuda:3')
distance 2 is tensor(112183.9419, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(112183.9419, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.00296976650133729
benign_entropy is 0.013279804959893227
sync_acc is 1.0000000005
sync_loss is 0.005201195366680622
sync_entropy is 0.020221393555402756
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [30]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 77.91% 

Test Accuracy: 76.40% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13476.4797, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.4797, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004643310327082872
current submit client idx and staleness is  1 1
distance 2 is tensor(13481.5550, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.5550, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0024780803360044956
current submit client idx and staleness is  2 1
distance 2 is tensor(13499.2439, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13499.2439, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007369407452642918
current submit client idx and staleness is  3 1
distance 2 is tensor(13515.5180, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13515.5180, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.023501405492424965
current submit client idx and staleness is  4 1
distance 2 is tensor(13466.6338, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.6338, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005817866884171963
current submit client idx and staleness is  5 1
distance 2 is tensor(13504.5218, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.5218, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0020739277824759483
current submit client idx and staleness is  6 1
distance 2 is tensor(13478.7459, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.7459, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008024895563721657
current submit client idx and staleness is  7 1
distance 2 is tensor(13499.5781, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13499.5781, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02049184776842594
current submit client idx and staleness is  32 5
distance 2 is tensor(13780.1336, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13780.1336, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.02019232138991356
current submit client idx and staleness is  33 5
distance 2 is tensor(13840.5219, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13840.5219, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3058948814868927
current submit client idx and staleness is  34 5
distance 2 is tensor(13857.1431, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13857.1431, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.41873764991760254
current submit client idx and staleness is  35 5
distance 2 is tensor(13881.1077, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13881.1077, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.44135013222694397
current submit client idx and staleness is  36 5
distance 2 is tensor(13847.2201, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13847.2201, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  1.0622402429580688
current submit client idx and staleness is  37 5
distance 2 is tensor(13851.3567, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13851.3567, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.18748867511749268
current submit client idx and staleness is  38 5
distance 2 is tensor(13862.3971, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13862.3971, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4181608259677887
current submit client idx and staleness is  39 5
distance 2 is tensor(13819.2098, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13819.2098, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.011961848475039005
current submit client idx and staleness is  48 1
distance 2 is tensor(13756.4048, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13756.4048, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13482.5769, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.5769, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13864.5900, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13864.5900, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13523.7681, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13523.7681, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13525.0703, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13525.0703, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13497.8789, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.8789, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13786.9974, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13786.9974, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13563.7148, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13563.7148, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13527.4018, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13527.4018, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13541.5092, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13541.5092, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13504.2253, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.2253, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13529.0068, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13529.0068, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(47311.5795, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47311.5795, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997552.4319, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47417.4889, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47417.4889, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997583.5405, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47227.2948, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47227.2948, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997502.9748, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47218.7227, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47218.7227, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997506.0095, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47205.9449, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47205.9449, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997516.0556, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47254.7751, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47254.7751, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997507.6010, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47219.5023, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47219.5023, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997509.7467, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47394.1093, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47394.1093, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997568.6555, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47257.3735, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47257.3735, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997506.9253, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47432.6104, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47432.6104, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997590.5027, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47223.2567, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47223.2567, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997506.1287, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47264.3078, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47264.3078, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(997501.2366, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(47432.6104, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.5254e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0020764851248561912
distance 2 is tensor(21938168.7861, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(21938168.7861, device='cuda:3', dtype=torch.float64)
cal ratio is  0.045568465294591694
distance 2 is tensor(999688.6010, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(999688.6010, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21346772362308414
distance 2 is tensor(213401.2012, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(213401.2012, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4620257270037574
distance 2 is tensor(98596.7854, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(98596.7854, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6797249494115379
distance 2 is tensor(67018.7035, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(67018.7035, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8244542821831411
distance 2 is tensor(55253.9066, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55253.9066, device='cuda:3', dtype=torch.float64)
cal ratio is  0.907994241645475
distance 2 is tensor(50170.2312, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50170.2312, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9528872980683184
distance 2 is tensor(47806.6491, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47806.6491, device='cuda:3', dtype=torch.float64)
cal ratio is  0.976158717094748
distance 2 is tensor(46666.9155, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46666.9155, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46666.9155, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(46666.9155, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46666.9155, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46705.3530, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(46666.9155, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(46705.3530, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9948, device='cuda:3')
test acc is  0.9506000001563925
test loss is 0.21255844966144463
test entropy is  0.060066625634577514
________________________________
2
distance 2 is tensor(46705.3530, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(46705.3530, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46705.3530, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.060066625634577514
avg test loss is  0.21255844966144463
avg accuracy is  0.9505800001563924
solo acc is  0.9506000001563925
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(46705.3530, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1044381.4920, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16262.7258, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6643440209691177
avg test loss is  1.9215166262348595
avg accuracy is  0.9368000001563931
solo acc is  0.049980000156399085
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16262.7258, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1029068.0182, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31868.1098, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.62484139966233
avg test loss is  1.8736364094497602
avg accuracy is  0.9402800001563929
solo acc is  0.044820000156399156
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31868.1098, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1036855.0841, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47490.1521, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6502721340150175
avg test loss is  1.729950046752725
avg accuracy is  0.9419800001563928
solo acc is  0.05050000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47490.1521, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1044649.7752, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63119.0303, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6311418013194637
avg test loss is  1.7246882112129875
avg accuracy is  0.9430400001563928
solo acc is  0.04786000015639913
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(63119.0303, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1052447.7093, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78753.8193, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78753.8193, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78753.8193, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78753.8193, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.046200000156399156
test loss is 1.7122978092459462
test entropy is  0.6220611860151486
________________________________
cal ratio is  0.7605517613186866
distance 2 is tensor(59896.3178, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59896.3178, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8720964660013156
distance 2 is tensor(52235.4277, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52235.4277, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9338605109825171
distance 2 is tensor(48780.6277, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48780.6277, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9663643425525993
distance 2 is tensor(47139.8185, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47139.8185, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47139.8185, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(47139.8185, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47139.8185, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47115.4435, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(47139.8185, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(47115.4435, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9358400001563931
test loss is 0.2458840737409909
test entropy is  0.364081888952676
________________________________
2
distance 2 is tensor(47115.4435, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(47115.4435, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47115.4435, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.364081888952676
avg test loss is  0.2458840737409909
avg accuracy is  0.9497400001563925
solo acc is  0.9358400001563931
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(47115.4435, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1044509.4953, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(62992.3287, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5877611958767142
avg test loss is  1.8706954051466549
avg accuracy is  0.9437400001563928
solo acc is  0.03958000015639928
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(62992.3287, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1052385.4999, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78625.3820, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.619578886481807
avg test loss is  1.7271461308459797
avg accuracy is  0.9450000001563926
solo acc is  0.04596000015639917
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(78625.3820, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1060184.9304, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(94262.8509, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(94262.8509, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(94262.8509, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(94262.8509, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(94262.8509, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.04320000015639921
test loss is 1.725269992638122
test entropy is  0.6066733685219684
________________________________
cal ratio is  0.6951752530148823
distance 2 is tensor(65529.2460, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(65529.2460, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8337714182789668
distance 2 is tensor(54636.4242, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54636.4242, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9131107481200006
distance 2 is tensor(49889.1016, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(49889.1016, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9555683291617517
distance 2 is tensor(47672.4267, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47672.4267, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9775319456751475
distance 2 is tensor(46601.2726, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46601.2726, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46601.2726, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(46601.2726, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46601.2726, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46568.1476, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(46601.2726, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(46568.1476, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9458200001563927
test loss is 0.19190396307526952
test entropy is  0.21527959642183903
________________________________
2
distance 2 is tensor(46568.1476, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(46568.1476, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46568.1476, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.21527959642183903
avg test loss is  0.19190396307526952
avg accuracy is  0.9507400001563925
solo acc is  0.9458200001563927
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(46568.1476, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1044249.4057, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(62509.9334, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5884488902966994
avg test loss is  1.9143340029679905
avg accuracy is  0.9440200001563926
solo acc is  0.039780000156399264
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(62509.9334, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1052145.2472, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78139.0418, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.629978089991128
avg test loss is  1.7042199899168575
avg accuracy is  0.9453800001563927
solo acc is  0.04750000015639914
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(78139.0418, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1059942.8093, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(93776.8772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6086734340852483
avg test loss is  1.720553402553129
avg accuracy is  0.9459400001563927
solo acc is  0.04346000015639921
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(93776.8772, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1067744.3870, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(109416.6028, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5937591382609609
avg test loss is  1.7330537782910536
avg accuracy is  0.9465600001563926
solo acc is  0.04096000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(109416.6028, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1075547.0099, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(125057.6133, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(125057.6133, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9470400001563927
test loss is 1.7526339652288296
test entropy is  0.5785247007065721
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4368385076522827
mal norm is  tensor(1391754.8750, device='cuda:3')
distance 2 is tensor(125057.6133, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(125057.6133, device='cuda:3', dtype=torch.float64)
benign_acc is 0.9500000005
benign_loss is 0.03948710113763809
benign_entropy is 0.04912383109331131
sync_acc is 1.0000000005
sync_loss is 0.00956808216869831
sync_entropy is 0.03024008683860302
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [30, 32, 33, 34]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 78.16% 

Test Accuracy: 76.82% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13460.3163, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.3163, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.027407163754105568
current submit client idx and staleness is  1 1
distance 2 is tensor(13463.8502, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.8502, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006378785707056522
current submit client idx and staleness is  2 1
distance 2 is tensor(13479.3721, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.3721, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004180151969194412
current submit client idx and staleness is  3 1
distance 2 is tensor(13456.4061, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.4061, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008258539251983166
current submit client idx and staleness is  4 1
distance 2 is tensor(13456.9486, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.9486, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006521586328744888
current submit client idx and staleness is  5 1
distance 2 is tensor(13473.7177, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.7177, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005935297813266516
current submit client idx and staleness is  6 1
distance 2 is tensor(13455.3002, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13455.3002, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005064452067017555
current submit client idx and staleness is  7 1
distance 2 is tensor(13465.8134, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.8134, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004199577495455742
current submit client idx and staleness is  8 2
distance 2 is tensor(13468.5833, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.5833, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.010536436922848225
current submit client idx and staleness is  9 2
distance 2 is tensor(13473.9312, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.9312, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004202160518616438
current submit client idx and staleness is  10 2
distance 2 is tensor(13479.2214, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.2214, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0020708434749394655
current submit client idx and staleness is  11 2
distance 2 is tensor(13492.6249, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.6249, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004958492238074541
current submit client idx and staleness is  12 2
distance 2 is tensor(13485.8154, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.8154, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00646998081356287
current submit client idx and staleness is  13 2
distance 2 is tensor(13481.7228, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13481.7228, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00909685529768467
current submit client idx and staleness is  14 2
distance 2 is tensor(13498.7724, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.7724, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0017538173124194145
current submit client idx and staleness is  15 2
distance 2 is tensor(13605.1228, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13605.1228, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03735349327325821
current submit client idx and staleness is  16 3
distance 2 is tensor(13475.2460, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.2460, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01381189189851284
current submit client idx and staleness is  17 3
distance 2 is tensor(13502.7352, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.7352, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03676176816225052
current submit client idx and staleness is  18 3
distance 2 is tensor(13504.8226, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.8226, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002424307633191347
current submit client idx and staleness is  19 3
distance 2 is tensor(13500.3675, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.3675, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003171125892549753
current submit client idx and staleness is  20 3
distance 2 is tensor(13731.8751, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13731.8751, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.32832998037338257
current submit client idx and staleness is  21 3
distance 2 is tensor(13593.8338, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13593.8338, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12752452492713928
current submit client idx and staleness is  22 3
distance 2 is tensor(13489.0079, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.0079, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0018945999909192324
current submit client idx and staleness is  23 3
distance 2 is tensor(13885.2557, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13885.2557, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2582240700721741
current submit client idx and staleness is  24 4
distance 2 is tensor(13869.4178, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13869.4178, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.19471101462841034
current submit client idx and staleness is  25 4
distance 2 is tensor(13886.8857, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13886.8857, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.053343601524829865
current submit client idx and staleness is  26 4
distance 2 is tensor(13832.3552, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13832.3552, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07431099563837051
current submit client idx and staleness is  27 4
distance 2 is tensor(13888.6166, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13888.6166, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6706275939941406
current submit client idx and staleness is  28 4
distance 2 is tensor(13800.0178, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13800.0178, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.20215857028961182
current submit client idx and staleness is  29 4
distance 2 is tensor(13887.6256, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13887.6256, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.28063884377479553
current submit client idx and staleness is  30 4
distance 2 is tensor(13694.1476, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13694.1476, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3889097571372986
current submit client idx and staleness is  31 4
distance 2 is tensor(13800.0286, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13800.0286, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.044343251734972
current submit client idx and staleness is  40 6
distance 2 is tensor(13860.2437, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13860.2437, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6430643200874329
current submit client idx and staleness is  41 6
distance 2 is tensor(13837.8554, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13837.8554, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.16850066184997559
current submit client idx and staleness is  42 6
distance 2 is tensor(13921.2870, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13921.2870, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.24219314754009247
current submit client idx and staleness is  43 6
distance 2 is tensor(13797.7738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13797.7738, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.7194535136222839
current submit client idx and staleness is  44 6
distance 2 is tensor(13849.9073, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13849.9073, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.49898090958595276
current submit client idx and staleness is  45 6
distance 2 is tensor(13940.0640, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13940.0640, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.178707093000412
current submit client idx and staleness is  46 6
distance 2 is tensor(13906.4191, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13906.4191, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.34901583194732666
current submit client idx and staleness is  47 6
distance 2 is tensor(13826.9667, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13826.9667, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4194709360599518
current submit client idx and staleness is  48 1
distance 2 is tensor(13500.9700, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.9700, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13745.0808, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13745.0808, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13513.9771, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13513.9771, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13488.9404, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.9404, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13491.3712, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.3712, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13778.3068, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13778.3068, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13474.2111, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.2111, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13499.5134, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13499.5134, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13517.1481, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13517.1481, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13496.2910, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13496.2910, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13485.4613, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.4613, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13485.2853, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.2853, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(29749.3451, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29749.3451, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008072.1376, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29792.3453, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29792.3453, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008079.3179, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29612.8287, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29612.8287, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008014.1251, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29612.6245, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29612.6245, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008014.8739, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29930.2806, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29930.2806, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008126.3413, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29733.4324, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29733.4324, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008066.3664, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29777.5862, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29777.5862, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008078.2829, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29613.9009, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29613.9009, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008016.1563, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29641.9706, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29641.9706, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008018.9878, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29597.8514, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29597.8514, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008018.3356, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(30022.5731, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(30022.5731, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008152.5423, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29851.5232, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29851.5232, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1008091.4859, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(30022.5731, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.5888e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0016520157967093464
distance 2 is tensor(17453634.7358, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(17453634.7358, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04064499645225174
distance 2 is tensor(709402.8728, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(709402.8728, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20160604967373713
distance 2 is tensor(143019.9700, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(143019.9700, device='cuda:3', dtype=torch.float64)
cal ratio is  0.44900553025119483
distance 2 is tensor(64216.7546, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(64216.7546, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6700787641254831
distance 2 is tensor(43030.3269, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43030.3269, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8185829762070881
distance 2 is tensor(35223.8361, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35223.8361, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9047564870437069
distance 2 is tensor(31868.9409, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(31868.9409, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9511876791136645
distance 2 is tensor(30313.3904, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(30313.3904, device='cuda:3', dtype=torch.float64)
cal ratio is  0.975287762766614
distance 2 is tensor(29564.3014, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(29564.3014, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29564.3014, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(29564.3014, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29564.3014, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29603.3639, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(29564.3014, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(29603.3639, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9979, device='cuda:3')
test acc is  0.9515800001563924
test loss is 0.2214504703844
test entropy is  0.05290508477377248
________________________________
2
distance 2 is tensor(29603.3639, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(29603.3639, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29603.3639, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05290508477377248
avg test loss is  0.2214504703844
avg accuracy is  0.9515800001563924
solo acc is  0.9515800001563924
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(29603.3639, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1037542.0543, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16285.3546, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6608890772170728
avg test loss is  1.9248101924691359
avg accuracy is  0.9393000001563929
solo acc is  0.049220000156399095
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16285.3546, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1030785.0737, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31891.2648, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6152578945202596
avg test loss is  1.8973490132395263
avg accuracy is  0.9423800001563928
solo acc is  0.043580000156399186
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31891.2648, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1038572.6491, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47513.2060, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6554040947686071
avg test loss is  1.7128587067889436
avg accuracy is  0.9439800001563928
solo acc is  0.05222000015639905
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47513.2060, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1046367.6143, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63142.9672, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.62325383513175
avg test loss is  1.7419253631930827
avg accuracy is  0.9450600001563927
solo acc is  0.045740000156399174
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63142.9672, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1054166.1400, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78777.3687, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78777.3687, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78777.3687, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78777.3687, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.045800000156399165
test loss is 1.7141923494351186
test entropy is  0.6197696728703311
________________________________
cal ratio is  0.6049915323222814
distance 2 is tensor(47659.5966, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47659.5966, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7778123783839583
distance 2 is tensor(37070.2026, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37070.2026, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8819369765618557
distance 2 is tensor(32693.5598, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32693.5598, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9391153216526844
distance 2 is tensor(30702.9602, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(30702.9602, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9690806164324502
distance 2 is tensor(29753.6455, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(29753.6455, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29753.6455, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(29753.6455, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29753.6455, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29753.1767, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(29753.6455, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(29753.1767, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9496800001563925
test loss is 0.17720775564273825
test entropy is  0.14253516470694252
________________________________
2
distance 2 is tensor(29753.1767, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(29753.1767, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29753.1767, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.14253516470694252
avg test loss is  0.17720775564273825
avg accuracy is  0.9520800001563924
solo acc is  0.9496800001563925
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(29753.1767, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1037582.6378, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(45786.2579, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.60621464949892
avg test loss is  1.896191160849598
avg accuracy is  0.9445400001563926
solo acc is  0.04224000015639921
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(45786.2579, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1045507.3816, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(61413.3887, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6371543733665096
avg test loss is  1.7248737226666697
avg accuracy is  0.9458600001563926
solo acc is  0.04810000015639912
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(61413.3887, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1053304.2915, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(77047.3425, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6292278502145996
avg test loss is  1.6968089938163757
avg accuracy is  0.9467400001563926
solo acc is  0.04772000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(77047.3425, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1061104.4692, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(92684.3215, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6045587942423418
avg test loss is  1.7274809083365419
avg accuracy is  0.9473800001563927
solo acc is  0.04292000015639921
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(92684.3215, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1068906.1167, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(108322.4701, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(108322.4701, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(108322.4701, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(108322.4701, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.03990000015639928
test loss is 1.765618211320599
test entropy is  0.5813413460160155
________________________________
cal ratio is  0.5159299671031511
distance 2 is tensor(55886.7699, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55886.7699, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7182828991603023
distance 2 is tensor(40142.4843, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40142.4843, device='cuda:3', dtype=torch.float64)
cal ratio is  0.847516004611871
distance 2 is tensor(34021.4086, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34021.4086, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9206061794653757
distance 2 is tensor(31320.2919, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(31320.2919, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9594826609526677
distance 2 is tensor(30051.2026, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(30051.2026, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9795330707766237
distance 2 is tensor(29436.2193, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(29436.2193, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29436.2193, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(29436.2193, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29436.2193, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29403.7193, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(29436.2193, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(29403.7193, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9521400001563923
test loss is 0.17876531499693446
test entropy is  0.09150856099022395
________________________________
2
distance 2 is tensor(29403.7193, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(29403.7193, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29403.7193, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.09150856099022395
avg test loss is  0.17876531499693446
avg accuracy is  0.9521200001563923
solo acc is  0.9521400001563923
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(29403.7193, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1037422.4379, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(45511.4547, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6898460338640091
avg test loss is  1.7422358745809101
avg accuracy is  0.9438000001563928
solo acc is  0.07340000015639886
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(45511.4547, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1045370.4236, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(61134.7032, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6555740405683932
avg test loss is  1.6864889851006706
avg accuracy is  0.9457600001563926
solo acc is  0.05288000015639904
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(61134.7032, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1053165.4583, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(76767.7066, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6396612324525633
avg test loss is  1.6741382270822744
avg accuracy is  0.9467200001563927
solo acc is  0.049920000156399094
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(76767.7066, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1060965.0605, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(92403.9739, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.603735283665035
avg test loss is  1.7304415556475938
avg accuracy is  0.9474400001563926
solo acc is  0.042400000156399234
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(92403.9739, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1068766.3449, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(108042.9320, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(108042.9320, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9480200001563927
test loss is 1.7410319770693474
test entropy is  0.5899619923528198
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4095722436904907
mal norm is  tensor(1201252.3750, device='cuda:3')
distance 2 is tensor(108042.9320, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(108042.9320, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.0038845669478178024
benign_entropy is 0.015904689207673073
benign_acc is 1.0000000005
benign_loss is 0.0078575499355793
benign_entropy is 0.02627384476363659
benign_acc is 0.9500000005
benign_loss is 0.05294986441731453
benign_entropy is 0.0813167542219162
benign_acc is 0.9500000005
benign_loss is 0.10614713281393051
benign_entropy is 0.11962218582630157
sync_acc is 1.0000000005
sync_loss is 0.011308114975690842
sync_entropy is 0.03336402401328087
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 78.23% 

Test Accuracy: 76.45% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13453.9208, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.9208, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004633575677871704
current submit client idx and staleness is  1 1
distance 2 is tensor(13472.0367, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.0367, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026639183051884174
current submit client idx and staleness is  2 1
distance 2 is tensor(13476.4690, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.4690, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005206645932048559
current submit client idx and staleness is  3 1
distance 2 is tensor(13469.6866, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.6866, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006161198951303959
current submit client idx and staleness is  4 1
distance 2 is tensor(13454.1930, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13454.1930, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004158187657594681
current submit client idx and staleness is  5 1
distance 2 is tensor(13497.0542, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.0542, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004093417432159185
current submit client idx and staleness is  6 1
distance 2 is tensor(13475.6630, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.6630, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0038623586297035217
current submit client idx and staleness is  7 1
distance 2 is tensor(13464.6472, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.6472, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0031795669347047806
current submit client idx and staleness is  48 1
distance 2 is tensor(13477.0931, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.0931, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13763.2708, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13763.2708, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13489.5647, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.5647, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13592.6954, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13592.6954, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13503.1175, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13503.1175, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13830.0056, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13830.0056, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13815.6023, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13815.6023, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13749.3050, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13749.3050, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13807.7945, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13807.7945, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13480.5117, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13480.5117, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13518.3779, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13518.3779, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13612.3864, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13612.3864, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(47542.9329, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47542.9329, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010274.9737, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47660.1448, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47660.1448, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010315.5943, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47301.7958, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47301.7958, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010197.5367, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47287.2436, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47287.2436, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010195.3298, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47643.8195, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47643.8195, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010318.8043, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47296.9942, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47296.9942, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010199.2332, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47302.8868, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47302.8868, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010201.5968, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47577.2424, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47577.2424, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010288.0681, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47294.8423, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47294.8423, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010199.3813, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47504.0093, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47504.0093, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010269.2798, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47290.5720, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47290.5720, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010200.3070, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(47534.8450, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(47534.8450, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1010276.3603, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(47660.1448, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.3273e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0020814571066258346
distance 2 is tensor(21990749.6422, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(21990749.6422, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04562298928058953
distance 2 is tensor(1003283.8166, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1003283.8166, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21359537818312874
distance 2 is tensor(214296.7936, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(214296.7936, device='cuda:3', dtype=torch.float64)
cal ratio is  0.46216379223842435
distance 2 is tensor(99040.1810, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(99040.1810, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6798264254017489
distance 2 is tensor(67330.0884, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(67330.0884, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8245161417132186
distance 2 is tensor(55514.8151, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55514.8151, device='cuda:3', dtype=torch.float64)
cal ratio is  0.90802813638132
distance 2 is tensor(50409.0303, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50409.0303, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9529049502193748
distance 2 is tensor(48034.9393, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48034.9393, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9761692689293213
distance 2 is tensor(46890.2683, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46890.2683, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46890.2683, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(46890.2683, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46890.2683, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46928.7058, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(46890.2683, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(46928.7058, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9949, device='cuda:3')
test acc is  0.9514400001563925
test loss is 0.22526849228131568
test entropy is  0.05105545947282358
________________________________
2
distance 2 is tensor(46928.7058, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(46928.7058, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(46928.7058, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05105545947282358
avg test loss is  0.22526849228131568
avg accuracy is  0.9514000001563925
solo acc is  0.9514400001563925
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(46928.7058, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1057212.9313, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16247.6592, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6966225708384648
avg test loss is  1.8172426603334335
avg accuracy is  0.936980000156393
solo acc is  0.06982000015639889
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16247.6592, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1041784.4835, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31858.0345, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(31858.0345, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31858.0345, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(31858.0345, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(31858.0345, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04606000015639914
test loss is 1.815449886004943
test entropy is  0.6298498458722058
________________________________
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.4446842670440674
mal norm is  tensor(349454.7188, device='cuda:3')
distance 2 is tensor(31858.0345, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(31858.0345, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.008891923353075981
sync_entropy is 0.028806110844016075
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [36]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 78.23% 

Test Accuracy: 76.56% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13461.9724, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.9724, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0022197572980076075
current submit client idx and staleness is  1 1
distance 2 is tensor(13460.6558, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.6558, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009570159949362278
current submit client idx and staleness is  2 1
distance 2 is tensor(13449.5660, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13449.5660, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026615846436470747
current submit client idx and staleness is  3 1
distance 2 is tensor(13448.7717, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13448.7717, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026254330296069384
current submit client idx and staleness is  4 1
distance 2 is tensor(13448.8025, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13448.8025, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002402175683528185
current submit client idx and staleness is  5 1
distance 2 is tensor(13459.5831, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.5831, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005254550836980343
current submit client idx and staleness is  6 1
distance 2 is tensor(13461.4546, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.4546, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0031031861435621977
current submit client idx and staleness is  7 1
distance 2 is tensor(13458.5692, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.5692, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0013065027305856347
current submit client idx and staleness is  8 2
distance 2 is tensor(13791.3109, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13791.3109, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.11875736713409424
current submit client idx and staleness is  9 2
distance 2 is tensor(13478.4028, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.4028, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004620490595698357
current submit client idx and staleness is  10 2
distance 2 is tensor(13784.0160, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13784.0160, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07029925286769867
current submit client idx and staleness is  11 2
distance 2 is tensor(13472.3793, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.3793, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0012676987098529935
current submit client idx and staleness is  12 2
distance 2 is tensor(13567.5183, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13567.5183, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006620812229812145
current submit client idx and staleness is  13 2
distance 2 is tensor(13463.0082, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.0082, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004919023253023624
current submit client idx and staleness is  14 2
distance 2 is tensor(13464.1822, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.1822, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006192888133227825
current submit client idx and staleness is  15 2
distance 2 is tensor(13486.1539, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.1539, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0016342398012056947
current submit client idx and staleness is  48 1
distance 2 is tensor(13490.5873, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.5873, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13468.6831, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.6831, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13477.8536, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.8536, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13677.8232, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13677.8232, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13562.7472, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13562.7472, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13493.6478, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13493.6478, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13501.1278, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.1278, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13505.5312, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13505.5312, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13765.1891, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13765.1891, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13471.5018, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.5018, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13461.8995, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.8995, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13846.9287, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13846.9287, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(43198.5949, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43198.5949, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015983.2411, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42862.2288, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42862.2288, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015888.3284, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43067.3614, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43067.3614, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015939.7037, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42837.8513, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42837.8513, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015869.5987, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43203.6876, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43203.6876, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015988.5984, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43124.9500, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43124.9500, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015962.4165, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42821.4381, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42821.4381, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015874.5164, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42891.9007, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42891.9007, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015890.7147, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(43095.7974, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(43095.7974, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015951.6686, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42829.1258, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42829.1258, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015873.2048, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42828.8416, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42828.8416, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015874.0598, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42867.7260, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(42867.7260, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1015883.4795, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(43203.6876, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.4832e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0019817554107536012
distance 2 is tensor(20937408.7455, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(20937408.7455, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04451691068881694
distance 2 is tensor(932068.6844, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(932068.6844, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21099031747728625
distance 2 is tensor(196657.5038, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(196657.5038, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4593367813221999
distance 2 is tensor(90332.0631, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(90332.0631, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6777437469646881
distance 2 is tensor(61222.0607, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(61222.0607, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8232514647399778
distance 2 is tensor(50401.2252, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50401.2252, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9073313927259767
distance 2 is tensor(45730.6324, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45730.6324, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9525392511533598
distance 2 is tensor(43560.1487, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43560.1487, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9759819982475446
distance 2 is tensor(42513.9593, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42513.9593, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42513.9593, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(42513.9593, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42513.9593, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42552.3968, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(42513.9593, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(42552.3968, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9958, device='cuda:3')
test acc is  0.9513800001563925
test loss is 0.23681317839474683
test entropy is  0.04771699234867073
________________________________
2
distance 2 is tensor(42552.3968, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(42552.3968, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42552.3968, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.04771699234867073
avg test loss is  0.23681317839474683
avg accuracy is  0.9514000001563925
solo acc is  0.9513800001563925
compute similarity  is  tensor(0.9958, device='cuda:3')
compute_distance is  tensor(42552.3968, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1058479.7994, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16269.0309, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6869305895874872
avg test loss is  1.8300118618609045
avg accuracy is  0.936960000156393
solo acc is  0.06394000015639893
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16269.0309, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1045245.0268, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31881.1067, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6398067661106129
avg test loss is  1.7933436895880248
avg accuracy is  0.9415400001563928
solo acc is  0.04754000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31881.1067, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1053036.0523, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47506.4404, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6486861996181176
avg test loss is  1.7034820405113729
avg accuracy is  0.9429800001563928
solo acc is  0.052380000156399056
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47506.4404, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1060833.0242, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63138.1246, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(63138.1246, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(63138.1246, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(63138.1246, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(63138.1246, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.048360000156399116
test loss is 1.6988902886200439
test entropy is  0.6316738708702194
________________________________
cal ratio is  0.8106635480422341
distance 2 is tensor(51183.7473, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51183.7473, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9003688155625731
distance 2 is tensor(46084.2918, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46084.2918, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9488772304596155
distance 2 is tensor(43728.4144, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43728.4144, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9741024131498519
distance 2 is tensor(42595.9213, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42595.9213, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42595.9213, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(42595.9213, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42595.9213, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42577.0151, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(42595.9213, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(42577.0151, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9118600001563939
test loss is 0.3372792350819044
test entropy is  0.506955906977434
________________________________
2
distance 2 is tensor(42577.0151, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(42577.0151, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42577.0151, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.506955906977434
avg test loss is  0.3372792350819044
avg accuracy is  0.9502000001563925
solo acc is  0.9118600001563939
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(42577.0151, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1058411.2503, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(58409.3043, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5933769400162465
avg test loss is  1.8283081362619424
avg accuracy is  0.9448800001563926
solo acc is  0.04042000015639925
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(58409.3043, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1066274.6216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(74045.1888, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6151460993777761
avg test loss is  1.7207777207464818
avg accuracy is  0.9460600001563927
solo acc is  0.04452000015639919
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(74045.1888, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1074075.9106, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(89682.9789, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6003185580758488
avg test loss is  1.7287300401331518
avg accuracy is  0.9467400001563926
solo acc is  0.042660000156399216
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(89682.9789, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1081878.1037, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(105321.6221, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5825282460283441
avg test loss is  1.7541775511353828
avg accuracy is  0.9472400001563926
solo acc is  0.04034000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(105321.6221, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1089680.7174, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(120961.5715, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(120961.5715, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(120961.5715, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(120961.5715, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.039660000156399276
test loss is 1.7469481450822346
test entropy is  0.5773912288648698
________________________________
cal ratio is  0.5856832096419221
distance 2 is tensor(70845.1428, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(70845.1428, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7652995252842805
distance 2 is tensor(54217.7632, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54217.7632, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8748139216918271
distance 2 is tensor(47430.4145, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47430.4145, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9353152683387284
distance 2 is tensor(44362.3440, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44362.3440, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9671174992990144
distance 2 is tensor(42903.5268, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42903.5268, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42903.5268, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(42903.5268, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42903.5268, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42893.3705, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(42903.5268, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(42893.3705, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9515800001563923
test loss is 0.1765380912024797
test entropy is  0.10915740864480014
________________________________
2
distance 2 is tensor(42893.3705, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(42893.3705, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(42893.3705, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.10915740864480014
avg test loss is  0.1765380912024797
avg accuracy is  0.9523200001563923
solo acc is  0.9515800001563923
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(42893.3705, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1058608.6281, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(58936.9797, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6239040400975805
avg test loss is  1.82136072008811
avg accuracy is  0.9432800001563928
solo acc is  0.04788000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(58936.9797, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1066538.4849, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(74567.2929, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6284391824394235
avg test loss is  1.7037673723667175
avg accuracy is  0.9456000001563927
solo acc is  0.04582000015639917
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(74567.2929, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1074336.8765, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(90203.4580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6054013033809564
avg test loss is  1.721554351127361
avg accuracy is  0.9467000001563927
solo acc is  0.04272000015639922
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(90203.4580, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1082138.1911, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(105841.4934, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.592701761580794
avg test loss is  1.7279836081177986
avg accuracy is  0.9473600001563927
solo acc is  0.04116000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(105841.4934, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1089940.5042, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(121481.6947, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(121481.6947, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9478200001563927
test loss is 1.7768330740196931
test entropy is  0.5694284990163105
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4736512899398804
mal norm is  tensor(1351510.8750, device='cuda:3')
distance 2 is tensor(121481.6947, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(121481.6947, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.0028504077345132828
benign_entropy is 0.013033916242420673
sync_acc is 1.0000000005
sync_loss is 0.004205801989883184
sync_entropy is 0.017380012199282646
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [36]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 78.29% 

Test Accuracy: 76.54% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13455.8144, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13455.8144, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002091184491291642
current submit client idx and staleness is  1 1
distance 2 is tensor(13450.0205, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13450.0205, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004415723029524088
current submit client idx and staleness is  2 1
distance 2 is tensor(13454.7429, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13454.7429, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0024527492932975292
current submit client idx and staleness is  3 1
distance 2 is tensor(13444.5847, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13444.5847, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026992771308869123
current submit client idx and staleness is  4 1
distance 2 is tensor(13443.8843, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13443.8843, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0025971203576773405
current submit client idx and staleness is  5 1
distance 2 is tensor(13449.7895, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13449.7895, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002745394827798009
current submit client idx and staleness is  6 1
distance 2 is tensor(13447.1681, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13447.1681, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004226548131555319
current submit client idx and staleness is  7 1
distance 2 is tensor(13446.7203, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13446.7203, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.009068455547094345
current submit client idx and staleness is  16 3
distance 2 is tensor(13541.0493, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13541.0493, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04457981139421463
current submit client idx and staleness is  17 3
distance 2 is tensor(13472.1778, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.1778, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001560111646540463
current submit client idx and staleness is  18 3
distance 2 is tensor(13479.6778, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.6778, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008302690461277962
current submit client idx and staleness is  19 3
distance 2 is tensor(13500.3324, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.3324, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.016817647963762283
current submit client idx and staleness is  20 3
distance 2 is tensor(13888.9679, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13888.9679, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6203315854072571
current submit client idx and staleness is  21 3
distance 2 is tensor(13763.2495, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13763.2495, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03590748459100723
current submit client idx and staleness is  22 3
distance 2 is tensor(13830.4605, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13830.4605, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.30990198254585266
current submit client idx and staleness is  23 3
distance 2 is tensor(13951.0468, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13951.0468, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5678302049636841
current submit client idx and staleness is  48 1
distance 2 is tensor(13458.1978, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.1978, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13740.7088, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13740.7088, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13482.8426, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.8426, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13472.1863, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.1863, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13877.5442, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13877.5442, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13488.4888, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.4888, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13672.0132, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13672.0132, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13466.1989, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.1989, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13476.9814, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.9814, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13844.8503, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13844.8503, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13747.8156, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13747.8156, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13767.4338, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13767.4338, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(40848.5296, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40848.5296, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022652.8689, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40536.1699, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40536.1699, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022570.7086, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40540.1905, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40540.1905, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022569.9020, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40740.0128, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40740.0128, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022621.5988, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40846.8186, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40846.8186, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022655.0614, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40547.3132, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40547.3132, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022573.3133, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40575.1502, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40575.1502, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022580.3631, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40553.2547, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40553.2547, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022567.8927, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40967.5963, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40967.5963, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022700.2289, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40537.8345, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40537.8345, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022573.3336, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40564.1183, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40564.1183, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022573.5712, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40988.4427, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40988.4427, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1022708.8457, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(40988.4427, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.5559e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.001930279171598835
distance 2 is tensor(20393579.2489, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(20393579.2489, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04393494198139919
distance 2 is tensor(895990.6087, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(895990.6087, device='cuda:3', dtype=torch.float64)
cal ratio is  0.2096066494492646
distance 2 is tensor(187805.5688, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(187805.5688, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45782821281559277
distance 2 is tensor(85982.6558, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(85982.6558, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6766301675637305
distance 2 is tensor(58178.4779, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58178.4779, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8225751916559149
distance 2 is tensor(47856.2232, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47856.2232, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9069588313481934
distance 2 is tensor(43403.6266, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43403.6266, device='cuda:3', dtype=torch.float64)
cal ratio is  0.95234383684704
distance 2 is tensor(41335.2509, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41335.2509, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9758801750820935
distance 2 is tensor(40338.2870, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40338.2870, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40338.2870, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40338.2870, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40338.2870, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40376.7245, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40338.2870, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40376.7245, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9963, device='cuda:3')
test acc is  0.9516600001563923
test loss is 0.24032217221614785
test entropy is  0.04629580215055226
________________________________
2
distance 2 is tensor(40376.7245, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40376.7245, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40376.7245, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.04629580215055226
avg test loss is  0.24032217221614785
avg accuracy is  0.9516600001563923
solo acc is  0.9516600001563923
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(40376.7245, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1062946.1718, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16275.6018, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6789443725362763
avg test loss is  1.8351916353720839
avg accuracy is  0.9379600001563929
solo acc is  0.06044000015639897
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16275.6018, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1050799.4408, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31888.7172, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6051900402816666
avg test loss is  1.8748393868241469
avg accuracy is  0.9420600001563928
solo acc is  0.041980000156399216
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31888.7172, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1058590.9837, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47513.4834, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6371499515326736
avg test loss is  1.7232753853968648
avg accuracy is  0.9436200001563928
solo acc is  0.04868000015639911
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(47513.4834, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1066387.8705, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63145.8585, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6347877658008004
avg test loss is  1.6843246445631432
avg accuracy is  0.9448200001563927
solo acc is  0.049160000156399104
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63145.8585, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1074188.0895, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78781.4292, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78781.4292, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78781.4292, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78781.4292, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.0434200001563992
test loss is 1.7169320270838335
test entropy is  0.6089550656507082
________________________________
cal ratio is  0.7068786375882906
distance 2 is tensor(55688.9625, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55688.9625, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8407603477576575
distance 2 is tensor(46821.0438, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46821.0438, device='cuda:3', dtype=torch.float64)
cal ratio is  0.916930120298569
distance 2 is tensor(42931.6140, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42931.6140, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9575648081572493
distance 2 is tensor(41109.7435, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41109.7435, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9785531088668866
distance 2 is tensor(40228.1013, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40228.1013, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40228.1013, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40228.1013, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40228.1013, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40197.3201, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40228.1013, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40197.3201, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9449800001563926
test loss is 0.19909638258249826
test entropy is  0.23205589585939942
________________________________
2
distance 2 is tensor(40197.3201, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40197.3201, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40197.3201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.23205589585939942
avg test loss is  0.19909638258249826
avg accuracy is  0.9516600001563923
solo acc is  0.9449800001563926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(40197.3201, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1062796.4242, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(56143.4845, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5668193445638623
avg test loss is  1.9412810691177387
avg accuracy is  0.9444600001563926
solo acc is  0.03728000015639933
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(56143.4845, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1070695.0693, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(71774.2935, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6223748040473674
avg test loss is  1.7059427601906954
avg accuracy is  0.9462000001563926
solo acc is  0.04614000015639917
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(71774.2935, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1078494.3615, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(87411.3971, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6008630166273288
avg test loss is  1.7262126086922862
avg accuracy is  0.9468800001563926
solo acc is  0.04230000015639924
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(87411.3971, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1086296.3408, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(103049.9599, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5881642206474338
avg test loss is  1.7354008235285043
avg accuracy is  0.9475600001563926
solo acc is  0.040960000156399265
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(103049.9599, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1094099.0590, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(118690.4477, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(118690.4477, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(118690.4477, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(118690.4477, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.03932000015639929
test loss is 1.7564626569333284
test entropy is  0.5735075279422428
________________________________
cal ratio is  0.5759024163704073
distance 2 is tensor(68354.0583, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68354.0583, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7588826651192685
distance 2 is tensor(51872.7290, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51872.7290, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8711385574941706
distance 2 is tensor(45188.3498, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45188.3498, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9333478760111115
distance 2 is tensor(42176.4528, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42176.4528, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9660992812890006
distance 2 is tensor(40746.5990, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40746.5990, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40746.5990, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40746.5990, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40746.5990, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40729.5678, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40746.5990, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40729.5678, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9517800001563923
test loss is 0.1768075833839955
test entropy is  0.10143334127943535
________________________________
2
distance 2 is tensor(40729.5678, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40729.5678, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40729.5678, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.10143334127943535
avg test loss is  0.1768075833839955
avg accuracy is  0.9526000001563923
solo acc is  0.9517800001563923
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(40729.5678, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1063083.6513, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(56786.5800, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6146674408479724
avg test loss is  1.8396868071592678
avg accuracy is  0.9439400001563928
solo acc is  0.04582000015639916
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(56786.5800, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1071016.6435, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(72416.6095, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6124547791602971
avg test loss is  1.7441382478265202
avg accuracy is  0.9460600001563927
solo acc is  0.042840000156399216
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(72416.6095, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1078815.0585, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(88051.9774, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.60575793988412
avg test loss is  1.7177629761988549
avg accuracy is  0.9469600001563926
solo acc is  0.04292000015639922
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(88051.9774, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1086616.1869, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(103690.6180, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5902672350559088
avg test loss is  1.7326153464939282
avg accuracy is  0.9475400001563926
solo acc is  0.04082000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(103690.6180, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1094418.8712, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(119330.5655, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(119330.5655, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9479600001563926
test loss is 1.7692965974893107
test entropy is  0.570760151461872
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.468226671218872
mal norm is  tensor(1327363.3750, device='cuda:3')
distance 2 is tensor(119330.5655, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(119330.5655, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.01636236160993576
benign_entropy is 0.04003846272826195
sync_acc is 1.0000000005
sync_loss is 0.005077253095805645
sync_entropy is 0.019810965284705162
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [35, 36, 38]
alphas 3 is [1.   0.2  0.25 0.5 ]
alphas is  [0.51282051 0.1025641  0.12820513 0.25641026]
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 78.17% 

Test Accuracy: 76.60% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13497.3380, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13497.3380, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004701864439994097
current submit client idx and staleness is  1 1
distance 2 is tensor(13469.1277, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.1277, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005331032909452915
current submit client idx and staleness is  2 1
distance 2 is tensor(13495.9601, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.9601, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001563227386213839
current submit client idx and staleness is  3 1
distance 2 is tensor(13522.2213, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13522.2213, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.18566131591796875
current submit client idx and staleness is  4 1
distance 2 is tensor(13520.6942, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13520.6942, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.018396183848381042
current submit client idx and staleness is  5 1
distance 2 is tensor(13570.7887, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13570.7887, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.06408434361219406
current submit client idx and staleness is  6 1
distance 2 is tensor(13469.4740, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.4740, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0024167776573449373
current submit client idx and staleness is  7 1
distance 2 is tensor(13465.6466, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.6466, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0031592529267072678
current submit client idx and staleness is  8 2
distance 2 is tensor(13504.4211, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.4211, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0017319507896900177
current submit client idx and staleness is  9 2
distance 2 is tensor(13501.3808, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13501.3808, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002095949137583375
current submit client idx and staleness is  10 2
distance 2 is tensor(13494.9550, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.9550, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0038450309075415134
current submit client idx and staleness is  11 2
distance 2 is tensor(13511.1353, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13511.1353, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0011345659149810672
current submit client idx and staleness is  12 2
distance 2 is tensor(13563.1172, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13563.1172, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03049277886748314
current submit client idx and staleness is  13 2
distance 2 is tensor(13488.3870, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.3870, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0022194785997271538
current submit client idx and staleness is  14 2
distance 2 is tensor(13498.7491, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.7491, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005737796891480684
current submit client idx and staleness is  15 2
distance 2 is tensor(13502.9001, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.9001, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002945760264992714
current submit client idx and staleness is  24 4
distance 2 is tensor(13826.3189, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13826.3189, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.25345245003700256
current submit client idx and staleness is  25 4
distance 2 is tensor(13830.9679, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13830.9679, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.23840808868408203
current submit client idx and staleness is  26 4
distance 2 is tensor(13872.2933, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13872.2933, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4725838601589203
current submit client idx and staleness is  27 4
distance 2 is tensor(13719.5409, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13719.5409, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5483992695808411
current submit client idx and staleness is  28 4
distance 2 is tensor(13818.3846, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13818.3846, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.29397696256637573
current submit client idx and staleness is  29 4
distance 2 is tensor(13881.6149, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13881.6149, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.1506665050983429
current submit client idx and staleness is  30 4
distance 2 is tensor(13808.7168, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13808.7168, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.19584904611110687
current submit client idx and staleness is  31 4
distance 2 is tensor(13534.9654, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13534.9654, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0014495725044980645
current submit client idx and staleness is  32 5
distance 2 is tensor(13899.1865, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13899.1865, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.31993982195854187
current submit client idx and staleness is  33 5
distance 2 is tensor(13857.2315, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13857.2315, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5517561435699463
current submit client idx and staleness is  34 5
distance 2 is tensor(13871.7363, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13871.7363, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2769109606742859
current submit client idx and staleness is  35 5
distance 2 is tensor(13782.2808, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13782.2808, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.150734543800354
current submit client idx and staleness is  36 5
distance 2 is tensor(13892.3674, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13892.3674, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4925760328769684
current submit client idx and staleness is  37 5
distance 2 is tensor(13801.0517, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13801.0517, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6101762056350708
current submit client idx and staleness is  38 5
distance 2 is tensor(13833.6258, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13833.6258, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03893414884805679
current submit client idx and staleness is  39 5
distance 2 is tensor(13812.7506, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13812.7506, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07328355312347412
current submit client idx and staleness is  48 1
distance 2 is tensor(13491.6724, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.6724, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13520.8585, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13520.8585, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13525.4729, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13525.4729, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13493.5013, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13493.5013, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13484.6598, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.6598, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13599.5639, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13599.5639, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13835.6337, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13835.6337, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13525.1907, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13525.1907, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13517.5563, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13517.5563, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13512.9763, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13512.9763, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13511.1096, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13511.1096, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13509.1712, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13509.1712, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(34964.9669, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34964.9669, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027855.8883, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34683.2203, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34683.2203, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027757.5763, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35074.0396, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35074.0396, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027891.6210, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34725.2854, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34725.2854, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027753.2412, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34727.9246, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34727.9246, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027752.1407, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34700.9574, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34700.9574, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027757.8110, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34994.0152, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34994.0152, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027852.8037, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34766.1151, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34766.1151, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027786.7101, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34729.9874, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34729.9874, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027754.4686, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34742.3506, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34742.3506, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027751.5201, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34704.5823, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34704.5823, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027758.5383, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34728.1023, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(34728.1023, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1027747.2887, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(35074.0396, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.3043e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0017855919448013118
distance 2 is tensor(18864952.4188, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(18864952.4188, device='cuda:3', dtype=torch.float64)
cal ratio is  0.0422562654779181
distance 2 is tensor(797162.3840, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(797162.3840, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20556329517163538
distance 2 is tensor(163867.2944, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(163867.2944, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45339092994522656
distance 2 is tensor(74295.9816, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(74295.9816, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6733429336939041
distance 2 is tensor(50026.6028, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50026.6028, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8205753442020121
distance 2 is tensor(41050.5928, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41050.5928, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9058561825141537
distance 2 is tensor(37185.9107, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37185.9107, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9517650615966938
distance 2 is tensor(35392.3106, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35392.3106, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9755836452961325
distance 2 is tensor(34528.1915, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34528.1915, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34528.1915, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(34528.1915, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34528.1915, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34566.9415, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(34528.1915, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(34566.9415, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9973, device='cuda:3')
test acc is  0.9516600001563923
test loss is 0.20692773815856658
test entropy is  0.059787006427645874
________________________________
2
distance 2 is tensor(34566.9415, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(34566.9415, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34566.9415, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.059787006427645874
avg test loss is  0.20692773815856658
avg accuracy is  0.9516600001563923
solo acc is  0.9516600001563923
compute similarity  is  tensor(0.9973, device='cuda:3')
compute_distance is  tensor(34566.9415, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1062304.1208, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16249.4121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6417328257999761
avg test loss is  1.9263988184502057
avg accuracy is  0.9395000001563929
solo acc is  0.04424000015639917
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16249.4121, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1053051.9911, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31858.1447, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.604617544185475
avg test loss is  1.8952785123644582
avg accuracy is  0.9422800001563928
solo acc is  0.04144000015639922
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31858.1447, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1060840.6203, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47480.7955, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6438421268597283
avg test loss is  1.7187642755410861
avg accuracy is  0.9438000001563928
solo acc is  0.04998000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47480.7955, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1068635.9435, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63111.8399, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6210083270164402
avg test loss is  1.7284040733066666
avg accuracy is  0.9448000001563926
solo acc is  0.04534000015639918
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63111.8399, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1076435.0363, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78747.2516, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78747.2516, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78747.2516, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78747.2516, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.0436800001563992
test loss is 1.720677884033574
test entropy is  0.6106841026059807
________________________________
cal ratio is  0.6540354174406534
distance 2 is tensor(51503.4583, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51503.4583, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8087248231757532
distance 2 is tensor(41652.1802, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41652.1802, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8992906957661854
distance 2 is tensor(37457.4606, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37457.4606, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9483088503040671
distance 2 is tensor(35521.3027, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35521.3027, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9738106667661982
distance 2 is tensor(34591.0840, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34591.0840, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34591.0840, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(34591.0840, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34591.0840, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34577.9590, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(34591.0840, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(34577.9590, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9479200001563927
test loss is 0.1839175606825296
test entropy is  0.1945241617843928
________________________________
2
distance 2 is tensor(34577.9590, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(34577.9590, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34577.9590, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.1945241617843928
avg test loss is  0.1839175606825296
avg accuracy is  0.9516800001563923
solo acc is  0.9479200001563927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(34577.9590, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1062264.4112, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(50551.3119, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5958544859267256
avg test loss is  1.8804528056203251
avg accuracy is  0.9445200001563926
solo acc is  0.040180000156399255
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(50551.3119, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1070169.3738, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(66181.2257, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6236135401308079
avg test loss is  1.7274987202166292
avg accuracy is  0.9458000001563927
solo acc is  0.046160000156399164
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(66181.2257, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1077967.4054, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(81816.1668, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6049504805251461
avg test loss is  1.732876776581835
avg accuracy is  0.9466600001563926
solo acc is  0.04294000015639921
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(81816.1668, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1085767.9824, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(97454.6509, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5876749943741753
avg test loss is  1.7520186709016181
avg accuracy is  0.9471800001563926
solo acc is  0.04054000015639926
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(97454.6509, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1093570.2139, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(113094.8946, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(113094.8946, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(113094.8946, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(113094.8946, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.03922000015639929
test loss is 1.7584609509733937
test entropy is  0.5768489774383242
________________________________
cal ratio is  0.5457546810332968
distance 2 is tensor(61722.0326, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(61722.0326, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7387523229221068
distance 2 is tensor(45597.2533, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45597.2533, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8595074160083365
distance 2 is tensor(39191.2518, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39191.2518, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9270953475789624
distance 2 is tensor(36334.0715, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(36334.0715, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9628573201044092
distance 2 is tensor(34984.5551, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34984.5551, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34984.5551, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(34984.5551, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34984.5551, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34977.8363, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(34984.5551, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(34977.8363, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9513200001563924
test loss is 0.1729434405258783
test entropy is  0.11349104707608061
________________________________
2
distance 2 is tensor(34977.8363, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(34977.8363, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(34977.8363, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.11349104707608061
avg test loss is  0.1729434405258783
avg accuracy is  0.9524000001563924
solo acc is  0.9513200001563924
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(34977.8363, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1062480.4598, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(51036.4967, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6223162010959957
avg test loss is  1.840471018915591
avg accuracy is  0.9441600001563928
solo acc is  0.044220000156399195
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(51036.4967, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1070411.7405, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(66663.3914, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.620133556482737
avg test loss is  1.7456681141463082
avg accuracy is  0.9458600001563926
solo acc is  0.045200000156399175
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(66663.3914, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1078208.1805, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(82297.1025, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6120125476432883
avg test loss is  1.7176501151850767
avg accuracy is  0.9467200001563927
solo acc is  0.04378000015639921
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(82297.1025, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1086008.1050, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(97935.3801, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5981312511522142
avg test loss is  1.7238837447007904
avg accuracy is  0.9473000001563926
solo acc is  0.041780000156399245
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(97935.3801, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1093810.1645, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(113575.4265, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(113575.4265, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9480200001563927
test loss is 1.7534896760340541
test entropy is  0.5792829390148373
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4551050662994385
mal norm is  tensor(1263408.6250, device='cuda:3')
distance 2 is tensor(113575.4265, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(113575.4265, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.0023205168545246124
benign_entropy is 0.011044031009078026
benign_acc is 0.9500000005
benign_loss is 0.041948381811380386
benign_entropy is 0.04964761063456535
benign_acc is 0.9500000005
benign_loss is 0.09688438475131989
benign_entropy is 0.083284892141819
sync_acc is 1.0000000005
sync_loss is 0.00929848849773407
sync_entropy is 0.02917102538049221
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 78.45% 

Test Accuracy: 76.53% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13500.7762, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.7762, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026229126378893852
current submit client idx and staleness is  1 1
distance 2 is tensor(13662.1566, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13662.1566, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.31160420179367065
current submit client idx and staleness is  2 1
distance 2 is tensor(13525.4643, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13525.4643, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0013516427716240287
current submit client idx and staleness is  3 1
distance 2 is tensor(13469.3965, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.3965, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0028096132446080446
current submit client idx and staleness is  4 1
distance 2 is tensor(13468.6748, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.6748, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0032169376499950886
current submit client idx and staleness is  5 1
distance 2 is tensor(13485.7611, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.7611, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0031933176796883345
current submit client idx and staleness is  6 1
distance 2 is tensor(13470.6894, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.6894, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0028862401377409697
current submit client idx and staleness is  7 1
distance 2 is tensor(13473.0637, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.0637, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00372949312441051
current submit client idx and staleness is  48 1
distance 2 is tensor(13511.8805, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13511.8805, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13547.7824, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13547.7824, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13488.0585, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.0585, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13631.4870, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13631.4870, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13513.9244, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13513.9244, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13573.1513, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13573.1513, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13494.0669, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13494.0669, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13808.2118, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13808.2118, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13546.6526, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13546.6526, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13644.8831, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13644.8831, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13615.8376, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13615.8376, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13524.5892, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13524.5892, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(53245.1004, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53245.1004, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029476.2474, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53469.1452, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53469.1452, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029558.8463, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53257.4340, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53257.4340, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029475.4258, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53237.2436, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53237.2436, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029472.6608, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53238.3113, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53238.3113, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029471.1821, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53508.2714, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53508.2714, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029577.9067, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53218.9637, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53218.9637, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029474.9499, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53241.7078, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53241.7078, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029465.5854, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53268.4197, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53268.4197, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029475.9738, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53243.8172, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53243.8172, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029477.6424, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53239.5908, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53239.5908, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029473.4512, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(53225.9357, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(53225.9357, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1029468.8784, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(53508.2714, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(7.9485e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0022054607503832657
distance 2 is tensor(23300957.0368, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(23300957.0368, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04696233226260553
distance 2 is tensor(1094267.2860, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1094267.2860, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21670794235852917
distance 2 is tensor(237136.3810, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(237136.3810, device='cuda:3', dtype=torch.float64)
cal ratio is  0.46551903359591773
distance 2 is tensor(110391.5789, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(110391.5789, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6822893052568723
distance 2 is tensor(75318.9252, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(75318.9252, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8260084298978504
distance 2 is tensor(62214.0883, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62214.0883, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9088499044858199
distance 2 is tensor(56543.3244, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(56543.3244, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9533357230274541
distance 2 is tensor(53904.7166, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(53904.7166, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9763896177251431
distance 2 is tensor(52632.0546, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52632.0546, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(52632.0546, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(52632.0546, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(52632.0546, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(52670.0234, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(52632.0546, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(52670.0234, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9938, device='cuda:3')
test acc is  0.9516400001563924
test loss is 0.221385227166908
test entropy is  0.05230316272153712
________________________________
2
distance 2 is tensor(52670.0234, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(52670.0234, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(52670.0234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05230316272153712
avg test loss is  0.221385227166908
avg accuracy is  0.9516400001563924
solo acc is  0.9516400001563924
compute similarity  is  tensor(0.9938, device='cuda:3')
compute_distance is  tensor(52670.0234, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1082317.9336, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16222.7216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6583759514876949
avg test loss is  1.8561511853771746
avg accuracy is  0.9393000001563929
solo acc is  0.05082000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16222.7216, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1064012.1928, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31835.2613, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(31835.2613, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31835.2613, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(31835.2613, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(31835.2613, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04186000015639922
test loss is 1.8524205690759528
test entropy is  0.607265763308691
________________________________
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.4959018230438232
mal norm is  tensor(349442.0312, device='cuda:3')
distance 2 is tensor(31835.2613, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(31835.2613, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.006069245748221874
sync_entropy is 0.02232993207871914
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [36, 39, 40]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 78.39% 

Test Accuracy: 76.91% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13455.4860, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13455.4860, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004389788489788771
current submit client idx and staleness is  1 1
distance 2 is tensor(13454.4363, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13454.4363, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003814414609223604
current submit client idx and staleness is  2 1
distance 2 is tensor(13480.4790, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13480.4790, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004196900874376297
current submit client idx and staleness is  3 1
distance 2 is tensor(13451.3530, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13451.3530, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0025553901214152575
current submit client idx and staleness is  4 1
distance 2 is tensor(13454.9679, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13454.9679, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00399792892858386
current submit client idx and staleness is  5 1
distance 2 is tensor(13459.2477, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.2477, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0050332085229456425
current submit client idx and staleness is  6 1
distance 2 is tensor(13463.1493, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.1493, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0022914460860192776
current submit client idx and staleness is  7 1
distance 2 is tensor(13704.7936, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13704.7936, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.023333745077252388
current submit client idx and staleness is  8 2
distance 2 is tensor(13475.3817, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13475.3817, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008807528764009476
current submit client idx and staleness is  9 2
distance 2 is tensor(13456.3016, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.3016, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005571234039962292
current submit client idx and staleness is  10 2
distance 2 is tensor(13476.6727, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.6727, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005403435789048672
current submit client idx and staleness is  11 2
distance 2 is tensor(13484.0160, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.0160, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007855817675590515
current submit client idx and staleness is  12 2
distance 2 is tensor(13469.8274, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.8274, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008206451311707497
current submit client idx and staleness is  13 2
distance 2 is tensor(13486.5773, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.5773, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.029322709888219833
current submit client idx and staleness is  14 2
distance 2 is tensor(13478.3597, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.3597, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026301315519958735
current submit client idx and staleness is  15 2
distance 2 is tensor(13483.6220, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13483.6220, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.006471249274909496
current submit client idx and staleness is  16 3
distance 2 is tensor(13912.5879, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13912.5879, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.17255309224128723
current submit client idx and staleness is  17 3
distance 2 is tensor(13498.1435, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.1435, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05624205991625786
current submit client idx and staleness is  18 3
distance 2 is tensor(13571.7266, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13571.7266, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01003436278551817
current submit client idx and staleness is  19 3
distance 2 is tensor(13518.6283, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13518.6283, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0012689263094216585
current submit client idx and staleness is  20 3
distance 2 is tensor(13894.6107, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13894.6107, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4593903422355652
current submit client idx and staleness is  21 3
distance 2 is tensor(13493.1616, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13493.1616, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005672992207109928
current submit client idx and staleness is  22 3
distance 2 is tensor(13683.6895, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13683.6895, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5179930925369263
current submit client idx and staleness is  23 3
distance 2 is tensor(13904.8662, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13904.8662, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.28491321206092834
current submit client idx and staleness is  40 6
distance 2 is tensor(13856.3062, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13856.3062, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2767544388771057
current submit client idx and staleness is  41 6
distance 2 is tensor(13877.5464, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13877.5464, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.152616947889328
current submit client idx and staleness is  42 6
distance 2 is tensor(13897.7432, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13897.7432, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.22547879815101624
current submit client idx and staleness is  43 6
distance 2 is tensor(13876.6056, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13876.6056, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3529999554157257
current submit client idx and staleness is  44 6
distance 2 is tensor(13850.2247, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13850.2247, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6485780477523804
current submit client idx and staleness is  45 6
distance 2 is tensor(13878.6587, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13878.6587, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08708472549915314
current submit client idx and staleness is  46 6
distance 2 is tensor(13948.1608, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13948.1608, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6831073760986328
current submit client idx and staleness is  47 6
distance 2 is tensor(13821.2823, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13821.2823, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4224012792110443
current submit client idx and staleness is  48 1
distance 2 is tensor(13474.4490, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.4490, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13800.1246, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13800.1246, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13489.1198, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.1198, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13492.6653, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.6653, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13490.8357, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.8357, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13467.9593, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.9593, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13812.2282, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13812.2282, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13803.4768, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13803.4768, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13751.6636, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13751.6636, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13490.0208, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.0208, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13649.4007, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13649.4007, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13489.0500, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.0500, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(29672.9150, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29672.9150, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040486.5764, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29972.7557, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29972.7557, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040576.5067, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29684.3958, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29684.3958, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040483.6501, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29797.7692, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29797.7692, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040524.8012, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29696.2909, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29696.2909, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040481.7940, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(30038.7260, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(30038.7260, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040604.4735, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(30023.1890, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(30023.1890, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040596.1676, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29959.1076, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29959.1076, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040564.2044, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(30015.2037, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(30015.2037, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040589.5382, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29673.7106, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29673.7106, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040482.5782, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29708.2126, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29708.2126, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040485.0582, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29823.3340, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(29823.3340, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1040529.4526, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(30038.7260, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.4819e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0016524550613768237
distance 2 is tensor(17458382.2420, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(17458382.2420, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04065040075636088
distance 2 is tensor(709690.2093, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(709690.2093, device='cuda:3', dtype=torch.float64)
cal ratio is  0.2016194489961957
distance 2 is tensor(143087.3022, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(143087.3022, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4490206174690757
distance 2 is tensor(64249.1085, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(64249.1085, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6700902171129256
distance 2 is tensor(43052.6908, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43052.6908, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8185904628702185
distance 2 is tensor(35242.4917, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35242.4917, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9047602824192058
distance 2 is tensor(31885.9712, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(31885.9712, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9511894088823086
distance 2 is tensor(30329.6512, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(30329.6512, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9752885435759124
distance 2 is tensor(29580.1891, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(29580.1891, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29580.1891, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(29580.1891, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29580.1891, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29619.0953, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(29580.1891, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(29619.0953, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9980, device='cuda:3')
test acc is  0.9527200001563924
test loss is 0.2172235168618127
test entropy is  0.05171850511735446
________________________________
2
distance 2 is tensor(29619.0953, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(29619.0953, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29619.0953, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05171850511735446
avg test loss is  0.2172235168618127
avg accuracy is  0.9527200001563924
solo acc is  0.9527200001563924
compute similarity  is  tensor(0.9980, device='cuda:3')
compute_distance is  tensor(29619.0953, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1070057.5520, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16264.2923, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6535788865955284
avg test loss is  1.8832727567009304
avg accuracy is  0.9412800001563929
solo acc is  0.04790000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16264.2923, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1063282.6479, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31874.7046, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6147753932820562
avg test loss is  1.8469756353846596
avg accuracy is  0.9443000001563928
solo acc is  0.0430600001563992
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31874.7046, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1071072.5401, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47499.1489, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6378678293026927
avg test loss is  1.7153920822436242
avg accuracy is  0.9456000001563927
solo acc is  0.04840000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47499.1489, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1078868.9596, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63130.8936, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6248103375248897
avg test loss is  1.7049589504671219
avg accuracy is  0.9462800001563927
solo acc is  0.04640000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63130.8936, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1086668.6194, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78765.9877, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78765.9877, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78765.9877, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78765.9877, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04234000015639923
test loss is 1.7308637136998384
test entropy is  0.6020971312166175
________________________________
cal ratio is  0.605197978603593
distance 2 is tensor(47669.0863, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47669.0863, device='cuda:3', dtype=torch.float64)
cal ratio is  0.777944145337911
distance 2 is tensor(37083.8990, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37083.8990, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8820112730707907
distance 2 is tensor(32708.3612, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32708.3612, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9391553528515362
distance 2 is tensor(30718.2063, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(30718.2063, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9691006926252353
distance 2 is tensor(29769.0288, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(29769.0288, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29769.0288, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(29769.0288, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29769.0288, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29749.0288, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(29769.0288, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(29749.0288, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9506400001563925
test loss is 0.17357123044052677
test entropy is  0.14167076539333975
________________________________
2
distance 2 is tensor(29749.0288, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(29749.0288, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29749.0288, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.14167076539333975
avg test loss is  0.17357123044052677
avg accuracy is  0.9533400001563923
solo acc is  0.9506400001563925
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(29749.0288, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1070088.6600, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(45773.1922, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5928361710456326
avg test loss is  1.8857435742607507
avg accuracy is  0.9461200001563926
solo acc is  0.039800000156399264
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(45773.1922, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1078009.2397, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(61401.7766, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6190747519207123
avg test loss is  1.7382113215563548
avg accuracy is  0.9472800001563927
solo acc is  0.045140000156399185
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(61401.7766, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1085806.9994, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(77037.1131, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.609738118317731
avg test loss is  1.7192727414238484
avg accuracy is  0.9479800001563926
solo acc is  0.043660000156399204
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(77037.1131, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1093607.9591, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(92674.9521, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5935227425049638
avg test loss is  1.7334269803503286
avg accuracy is  0.9485000001563925
solo acc is  0.04158000015639925
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(92674.9521, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1101410.1523, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(108314.5170, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(108314.5170, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(108314.5170, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(108314.5170, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.03956000015639928
test loss is 1.7552437396610485
test entropy is  0.5771750050508763
________________________________
cal ratio is  0.516087685974524
distance 2 is tensor(55899.7917, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55899.7917, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7183924109746462
distance 2 is tensor(40157.9193, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40157.9193, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8475810325988312
distance 2 is tensor(34037.1357, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34037.1357, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9206410330540942
distance 2 is tensor(31336.0596, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(31336.0596, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9594992471893468
distance 2 is tensor(30066.9061, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(30066.9061, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9795406422509243
distance 2 is tensor(29451.8109, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(29451.8109, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29451.8109, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(29451.8109, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29451.8109, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29441.6546, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(29451.8109, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(29441.6546, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9532200001563923
test loss is 0.17478311836080568
test entropy is  0.09093856474127421
________________________________
2
distance 2 is tensor(29441.6546, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(29441.6546, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(29441.6546, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.09093856474127421
avg test loss is  0.17478311836080568
avg accuracy is  0.9533600001563923
solo acc is  0.9532200001563923
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(29441.6546, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1069949.4361, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(45540.1297, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6578746905259769
avg test loss is  1.7668513663284613
avg accuracy is  0.9452200001563926
solo acc is  0.05858000015639899
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(45540.1297, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1077892.8186, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(61163.8007, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.637797046729061
avg test loss is  1.6993514031095578
avg accuracy is  0.9473000001563926
solo acc is  0.04792000015639913
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(61163.8007, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1085688.3274, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(76797.5660, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(76797.5660, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(76797.5660, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9479000001563926
test loss is 1.701278424019094
test entropy is  0.6178342851302813
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.3503268957138062
mal norm is  tensor(851999.9375, device='cuda:3')
distance 2 is tensor(76797.5660, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(76797.5660, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.006016818806529045
benign_entropy is 0.022058870643377304
benign_acc is 1.0000000005
benign_loss is 0.013654296286404133
benign_entropy is 0.03668707236647606
benign_acc is 1.0000000005
benign_loss is 0.08395789563655853
benign_entropy is 0.13905000686645508
sync_acc is 1.0000000005
sync_loss is 0.009473169222474098
sync_entropy is 0.03009369783103466
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 78.37% 

Test Accuracy: 76.52% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13508.6263, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13508.6263, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008453122340142727
current submit client idx and staleness is  1 1
distance 2 is tensor(13482.4632, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.4632, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0019030265975743532
current submit client idx and staleness is  2 1
distance 2 is tensor(13472.1165, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.1165, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0023703831247985363
current submit client idx and staleness is  3 1
distance 2 is tensor(13603.9847, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13603.9847, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13354989886283875
current submit client idx and staleness is  4 1
distance 2 is tensor(13462.1552, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.1552, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004704678896814585
current submit client idx and staleness is  5 1
distance 2 is tensor(13470.4688, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.4688, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0031317200046032667
current submit client idx and staleness is  6 1
distance 2 is tensor(13454.7238, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13454.7238, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0073460787534713745
current submit client idx and staleness is  7 1
distance 2 is tensor(13455.5015, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13455.5015, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004328568931668997
current submit client idx and staleness is  48 1
distance 2 is tensor(13641.7100, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13641.7100, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13502.4127, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13502.4127, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13605.8282, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13605.8282, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13732.6604, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13732.6604, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13498.3136, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.3136, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13513.2991, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13513.2991, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13579.1527, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13579.1527, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13653.8795, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13653.8795, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13479.4081, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.4081, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13490.5255, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.5255, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13484.6301, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.6301, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13945.4061, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13945.4061, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(40999.9052, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40999.9052, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1043938.2702, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40979.3194, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40979.3194, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1043943.0009, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40985.8104, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40985.8104, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1043938.0756, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41145.4607, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41145.4607, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1044014.4570, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41033.3610, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41033.3610, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1043978.3423, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41005.0350, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41005.0350, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1043941.5259, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41005.7448, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41005.7448, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1043949.3289, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41013.6926, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41013.6926, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1043939.0919, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41233.6440, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41233.6440, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1044029.1097, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40981.8701, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40981.8701, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1043939.9867, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40971.7651, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(40971.7651, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1043941.5678, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41314.1743, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(41314.1743, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1044063.5343, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(41314.1743, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.1392e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.001937929917100288
distance 2 is tensor(20474493.4576, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(20474493.4576, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04402192516633442
distance 2 is tensor(901326.5864, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(901326.5864, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20981402895801834
distance 2 is tensor(189110.8897, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(189110.8897, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4580547016674057
distance 2 is tensor(86623.2070, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(86623.2070, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6767970936398617
distance 2 is tensor(58626.3515, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58626.3515, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8226766679950603
distance 2 is tensor(48230.4767, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(48230.4767, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9070157681377642
distance 2 is tensor(43745.8212, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43745.8212, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9523735545091638
distance 2 is tensor(41662.2890, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41662.2890, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9758971520309644
distance 2 is tensor(40658.1449, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40658.1449, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40658.1449, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40658.1449, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40658.1449, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40696.5824, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40658.1449, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40696.5824, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9964, device='cuda:3')
test acc is  0.9530200001563923
test loss is 0.2186329475360374
test entropy is  0.05129970532298312
________________________________
2
distance 2 is tensor(40696.5824, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40696.5824, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40696.5824, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05129970532298312
avg test loss is  0.2186329475360374
avg accuracy is  0.9530000001563923
solo acc is  0.9530200001563923
compute similarity  is  tensor(0.9964, device='cuda:3')
compute_distance is  tensor(40696.5824, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1084690.0307, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16229.4365, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6585201042539933
avg test loss is  1.850022657295627
avg accuracy is  0.9398200001563929
solo acc is  0.05246000015639905
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16229.4365, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1072369.6017, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31843.0216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.5994929320290875
avg test loss is  1.864974331367961
avg accuracy is  0.9436200001563928
solo acc is  0.04048000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31843.0216, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1080161.5729, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47469.6771, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6415593986925872
avg test loss is  1.689194754261495
avg accuracy is  0.9451800001563926
solo acc is  0.05006000015639909
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47469.6771, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1087959.3198, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63102.3068, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6162898107562833
avg test loss is  1.71326149272187
avg accuracy is  0.9459400001563927
solo acc is  0.04470000015639918
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63102.3068, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1095759.6229, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78738.4809, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78738.4809, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78738.4809, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78738.4809, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.04278000015639922
test loss is 1.7164861421146052
test entropy is  0.6035281679285761
________________________________
cal ratio is  0.7098753540459306
distance 2 is tensor(55894.5556, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55894.5556, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8425406442486749
distance 2 is tensor(47093.4887, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47093.4887, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9178996026154802
distance 2 is tensor(43227.1142, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43227.1142, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9580705541880304
distance 2 is tensor(41414.5794, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41414.5794, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9788113278568552
distance 2 is tensor(40537.0386, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40537.0386, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40537.0386, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(40537.0386, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40537.0386, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40497.8199, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(40537.0386, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(40497.8199, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9459600001563926
test loss is 0.1976038630101401
test entropy is  0.24717494349002533
________________________________
2
distance 2 is tensor(40497.8199, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(40497.8199, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(40497.8199, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.24717494349002533
avg test loss is  0.1976038630101401
avg accuracy is  0.9527800001563923
solo acc is  0.9459600001563926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(40497.8199, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1084534.7622, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(56419.8521, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5887405344897219
avg test loss is  1.8402228913343777
avg accuracy is  0.9464200001563926
solo acc is  0.03986000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(56419.8521, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1092426.2741, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(72052.5799, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6077211933291476
avg test loss is  1.728873682448931
avg accuracy is  0.9472000001563925
solo acc is  0.042760000156399226
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(72052.5799, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1100226.2067, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(87690.1442, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.5933694713713263
avg test loss is  1.7347429727044557
avg accuracy is  0.9477800001563926
solo acc is  0.041040000156399255
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(87690.1442, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1108028.3632, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(103329.6573, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5811623883293108
avg test loss is  1.7426643269446196
avg accuracy is  0.9485200001563925
solo acc is  0.040120000156399264
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(103329.6573, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1115831.4333, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(118969.9922, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(118969.9922, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(118969.9922, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(118969.9922, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.038860000156399295
test loss is 1.7474209710460185
test entropy is  0.5723532549560527
________________________________
cal ratio is  0.577506527931619
distance 2 is tensor(68705.8930, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(68705.8930, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7599388021936735
distance 2 is tensor(52212.3397, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52212.3397, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8717441397789542
distance 2 is tensor(45515.8813, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45515.8813, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9336715731018962
distance 2 is tensor(42496.8859, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42496.8859, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9662668070314632
distance 2 is tensor(41063.2989, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41063.2989, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41063.2989, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(41063.2989, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41063.2989, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41036.7364, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(41063.2989, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(41036.7364, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9521600001563923
test loss is 0.17079490261501334
test entropy is  0.11310537372980162
________________________________
2
distance 2 is tensor(41036.7364, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(41036.7364, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(41036.7364, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.11310537372980162
avg test loss is  0.17079490261501334
avg accuracy is  0.9536200001563924
solo acc is  0.9521600001563923
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(41036.7364, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1084823.7943, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(57063.6019, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6546555971321852
avg test loss is  1.7340294967222092
avg accuracy is  0.9447000001563927
solo acc is  0.06272000015639895
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(57063.6019, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1092748.0439, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(72693.4491, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6195883229565438
avg test loss is  1.70704392932565
avg accuracy is  0.9468400001563926
solo acc is  0.04434000015639919
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(72693.4491, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1100546.4482, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(88329.2590, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.5981883205035153
avg test loss is  1.7253341461386522
avg accuracy is  0.9477000001563927
solo acc is  0.04168000015639925
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(88329.2590, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1108347.6437, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(103968.3540, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5852493332779926
avg test loss is  1.7351769344581058
avg accuracy is  0.9485200001563925
solo acc is  0.04034000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(103968.3540, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1116150.4692, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(119608.5816, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(119608.5816, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9491200001563925
test loss is 1.7516655649065667
test entropy is  0.5719181010713967
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.437792420387268
mal norm is  tensor(1330935.6250, device='cuda:3')
distance 2 is tensor(119608.5816, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(119608.5816, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.006704974919557571
sync_entropy is 0.024130655452609062
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [40, 42]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 78.55% 

Test Accuracy: 76.82% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13462.1532, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.1532, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005907071754336357
current submit client idx and staleness is  1 1
distance 2 is tensor(13460.8374, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.8374, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0025374582037329674
current submit client idx and staleness is  2 1
distance 2 is tensor(13454.3821, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13454.3821, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0026248442009091377
current submit client idx and staleness is  3 1
distance 2 is tensor(13464.8473, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.8473, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002674807794392109
current submit client idx and staleness is  4 1
distance 2 is tensor(13467.0941, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.0941, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0036050896160304546
current submit client idx and staleness is  5 1
distance 2 is tensor(13454.0189, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13454.0189, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00416142400354147
current submit client idx and staleness is  6 1
distance 2 is tensor(13453.1549, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.1549, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.021924816071987152
current submit client idx and staleness is  7 1
distance 2 is tensor(13458.3820, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.3820, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003012928180396557
current submit client idx and staleness is  8 2
distance 2 is tensor(13500.6976, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.6976, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0010940020438283682
current submit client idx and staleness is  9 2
distance 2 is tensor(13757.8676, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13757.8676, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.10036242008209229
current submit client idx and staleness is  10 2
distance 2 is tensor(13845.2018, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13845.2018, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3266048729419708
current submit client idx and staleness is  11 2
distance 2 is tensor(13472.0231, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.0231, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001308782142587006
current submit client idx and staleness is  12 2
distance 2 is tensor(13722.4819, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13722.4819, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12804818153381348
current submit client idx and staleness is  13 2
distance 2 is tensor(13469.7535, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.7535, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003588475752621889
current submit client idx and staleness is  14 2
distance 2 is tensor(13470.1031, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.1031, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003039840841665864
current submit client idx and staleness is  15 2
distance 2 is tensor(13695.3621, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13695.3621, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.12651775777339935
current submit client idx and staleness is  24 4
distance 2 is tensor(13847.5436, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13847.5436, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.23271580040454865
current submit client idx and staleness is  25 4
distance 2 is tensor(13893.6247, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13893.6247, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.23675772547721863
current submit client idx and staleness is  26 4
distance 2 is tensor(13884.6122, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13884.6122, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.41461682319641113
current submit client idx and staleness is  27 4
distance 2 is tensor(13945.7882, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13945.7882, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.6261554956436157
current submit client idx and staleness is  28 4
distance 2 is tensor(13696.6902, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13696.6902, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3540322780609131
current submit client idx and staleness is  29 4
distance 2 is tensor(13871.2663, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13871.2663, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.10907820612192154
current submit client idx and staleness is  30 4
distance 2 is tensor(13845.5077, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13845.5077, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.39951807260513306
current submit client idx and staleness is  31 4
distance 2 is tensor(13478.6674, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.6674, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0018629550468176603
current submit client idx and staleness is  48 1
distance 2 is tensor(13453.7834, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.7834, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13487.8080, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13487.8080, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13638.1654, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13638.1654, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13915.9877, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13915.9877, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13500.0254, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13500.0254, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13735.5128, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13735.5128, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13484.1329, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.1329, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13887.3229, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13887.3229, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13478.3639, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.3639, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13529.4967, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13529.4967, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13489.8947, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.8947, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13640.5258, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13640.5258, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(37275.8556, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37275.8556, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049501.5819, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37530.8762, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37530.8762, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049577.2593, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37302.9782, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37302.9782, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049494.6406, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37295.5523, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37295.5523, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049497.2737, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37667.3784, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37667.3784, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049629.1057, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37309.6567, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37309.6567, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049502.4295, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37464.4190, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37464.4190, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049556.3794, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37286.3628, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37286.3628, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049494.5683, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37298.2282, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37298.2282, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049499.3695, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37637.0195, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37637.0195, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049615.6376, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37535.9466, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37535.9466, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049578.3592, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37559.2603, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(37559.2603, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1049592.5643, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(37667.3784, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.3144e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.001850423234144395
distance 2 is tensor(19549987.3104, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(19549987.3104, device='cuda:3', dtype=torch.float64)
cal ratio is  0.043016545716406805
distance 2 is tensor(840972.9259, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(840972.9259, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20740430458441356
distance 2 is tensor(174421.4716, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(174421.4716, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45541654034534046
distance 2 is tensor(79434.3439, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(79434.3439, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6748459045550937
distance 2 is tensor(53605.8648, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(53605.8648, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8214906400688974
distance 2 is tensor(44036.7670, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44036.7670, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9063606854103792
distance 2 is tensor(39913.1980, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39913.1980, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9520297275003305
distance 2 is tensor(37998.6263, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37998.6263, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9757191402633244
distance 2 is tensor(37076.0244, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37076.0244, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37076.0244, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(37076.0244, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37076.0244, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37114.4619, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(37076.0244, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(37114.4619, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9970, device='cuda:3')
test acc is  0.9530600001563924
test loss is 0.22615199523092613
test entropy is  0.04827737863956536
________________________________
2
distance 2 is tensor(37114.4619, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(37114.4619, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(37114.4619, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.04827737863956536
avg test loss is  0.22615199523092613
avg accuracy is  0.9530400001563923
solo acc is  0.9530600001563924
compute similarity  is  tensor(0.9970, device='cuda:3')
compute_distance is  tensor(37114.4619, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1086612.7726, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16248.2725, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6617276651780014
avg test loss is  1.8384560497520526
avg accuracy is  0.9405800001563929
solo acc is  0.05320000015639904
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16248.2725, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1076087.5334, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31861.8680, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(31861.8680, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(31861.8680, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(31861.8680, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(31861.8680, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.041940000156399225
test loss is 1.8413497069302727
test entropy is  0.6072584423796296
________________________________
grad,shape is torch.Size([11183582])
mal_acc is 0.050000000499999996
mal loss is 1.466935157775879
mal norm is  tensor(349457.6875, device='cuda:3')
distance 2 is tensor(31861.8680, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(31861.8680, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.0036499067209661007
benign_entropy is 0.01571590267121792
benign_acc is 1.0000000005
benign_loss is 0.023448150604963303
benign_entropy is 0.04683458060026169
sync_acc is 1.0000000005
sync_loss is 0.007941888645291328
sync_entropy is 0.02666369453072548
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [40, 42]
alphas 3 is [1.         0.2        0.33333333]
alphas is  [0.65217391 0.13043478 0.2173913 ]
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 78.40% 

Test Accuracy: 76.68% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13470.7665, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.7665, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0060859667137265205
current submit client idx and staleness is  1 1
distance 2 is tensor(13467.2466, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13467.2466, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0076899221166968346
current submit client idx and staleness is  2 1
distance 2 is tensor(13486.0580, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13486.0580, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.007984722033143044
current submit client idx and staleness is  3 1
distance 2 is tensor(13559.4810, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13559.4810, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.03192177787423134
current submit client idx and staleness is  4 1
distance 2 is tensor(13474.7339, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.7339, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005954716820269823
current submit client idx and staleness is  5 1
distance 2 is tensor(13511.6250, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13511.6250, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.018093746155500412
current submit client idx and staleness is  6 1
distance 2 is tensor(13482.7881, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.7881, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.01750982366502285
current submit client idx and staleness is  7 1
distance 2 is tensor(13480.2315, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13480.2315, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0032966628205031157
current submit client idx and staleness is  16 3
distance 2 is tensor(13661.2184, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13661.2184, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3826588988304138
current submit client idx and staleness is  17 3
distance 2 is tensor(13530.8279, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13530.8279, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0036044330336153507
current submit client idx and staleness is  18 3
distance 2 is tensor(13480.9498, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13480.9498, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008882434107363224
current submit client idx and staleness is  19 3
distance 2 is tensor(13498.5887, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13498.5887, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.016767241060733795
current submit client idx and staleness is  20 3
distance 2 is tensor(13666.6416, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13666.6416, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07332964986562729
current submit client idx and staleness is  21 3
distance 2 is tensor(13663.4835, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13663.4835, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13509783148765564
current submit client idx and staleness is  22 3
distance 2 is tensor(13527.0063, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13527.0063, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.001715713762678206
current submit client idx and staleness is  23 3
distance 2 is tensor(13652.9710, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13652.9710, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5717523694038391
current submit client idx and staleness is  32 5
distance 2 is tensor(13894.3776, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13894.3776, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2576492428779602
current submit client idx and staleness is  33 5
distance 2 is tensor(13892.0815, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13892.0815, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.32122087478637695
current submit client idx and staleness is  34 5
distance 2 is tensor(13893.3269, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13893.3269, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.42872777581214905
current submit client idx and staleness is  35 5
distance 2 is tensor(13798.7188, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13798.7188, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2200363427400589
current submit client idx and staleness is  36 5
distance 2 is tensor(13869.6322, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13869.6322, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4214749336242676
current submit client idx and staleness is  37 5
distance 2 is tensor(13844.1727, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13844.1727, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.26340508460998535
current submit client idx and staleness is  38 5
distance 2 is tensor(13914.5635, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13914.5635, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.32086414098739624
current submit client idx and staleness is  39 5
distance 2 is tensor(13762.4781, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13762.4781, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.16628459095954895
current submit client idx and staleness is  48 1
distance 2 is tensor(13515.2648, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13515.2648, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13685.4779, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13685.4779, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13487.8739, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13487.8739, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13611.2416, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13611.2416, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13604.1559, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13604.1559, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13687.5094, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13687.5094, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13687.6427, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13687.6427, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13531.9393, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13531.9393, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13798.6473, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13798.6473, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13559.4151, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13559.4151, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13495.6368, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13495.6368, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13517.1248, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13517.1248, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(35447.6893, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35447.6893, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051756.6231, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35471.2114, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35471.2114, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051742.8155, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35472.9806, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35472.9806, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051742.8148, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35445.2276, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35445.2276, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051742.9948, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35437.1648, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35437.1648, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051745.8455, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35567.2590, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35567.2590, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051789.5592, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35814.4893, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35814.4893, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051867.6417, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35474.9701, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35474.9701, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051744.6167, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35465.7104, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35465.7104, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051743.9781, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35460.6891, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35460.6891, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051741.9803, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35462.7359, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35462.7359, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051750.1549, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35458.6810, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(35458.6810, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1051741.1295, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(35814.4893, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.4357e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0018043372002260404
distance 2 is tensor(19063086.9040, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(19063086.9040, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04247748968874989
distance 2 is tensor(809752.0178, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(809752.0178, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20610068611318122
distance 2 is tensor(166890.4732, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(166890.4732, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45398309780350393
distance 2 is tensor(75765.5269, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(75765.5269, device='cuda:3', dtype=torch.float64)
cal ratio is  0.673782354477795
distance 2 is tensor(51049.3988, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(51049.3988, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8208430794557496
distance 2 is tensor(41903.5994, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(41903.5994, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9060033271110179
distance 2 is tensor(37964.8067, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37964.8067, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9518419920074653
distance 2 is tensor(36136.5731, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(36136.5731, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9756228745873301
distance 2 is tensor(35255.7056, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35255.7056, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35255.7056, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(35255.7056, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35255.7056, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35294.1431, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(35255.7056, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(35294.1431, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9973, device='cuda:3')
test acc is  0.9527400001563924
test loss is 0.20575097925055746
test entropy is  0.05649920680534566
________________________________
2
distance 2 is tensor(35294.1431, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(35294.1431, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35294.1431, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05649920680534566
avg test loss is  0.20575097925055746
avg accuracy is  0.9527400001563924
solo acc is  0.9527400001563924
compute similarity  is  tensor(0.9973, device='cuda:3')
compute_distance is  tensor(35294.1431, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1087036.6851, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16241.8293, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6479129711990161
avg test loss is  1.8830742971671512
avg accuracy is  0.9408200001563929
solo acc is  0.04630000015639916
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16241.8293, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1077416.7573, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31853.1096, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6051432439662001
avg test loss is  1.859831287580378
avg accuracy is  0.9435400001563928
solo acc is  0.04122000015639924
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31853.1096, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1085207.0964, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47478.2779, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.640424899814074
avg test loss is  1.6979905040672674
avg accuracy is  0.9450000001563926
solo acc is  0.0492600001563991
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47478.2779, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1093003.8682, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63110.2906, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6162916572426286
avg test loss is  1.7181190034312666
avg accuracy is  0.9457600001563926
solo acc is  0.044620000156399185
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63110.2906, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1100803.5989, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78745.8879, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78745.8879, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78745.8879, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78745.8879, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04230000015639922
test loss is 1.7285935825399121
test entropy is  0.6002248045047531
________________________________
cal ratio is  0.6609087702194616
distance 2 is tensor(52043.7809, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52043.7809, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8129634806607233
distance 2 is tensor(42309.6382, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(42309.6382, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9016454621288433
distance 2 is tensor(38148.3642, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(38148.3642, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9495492535892532
distance 2 is tensor(36223.7321, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(36223.7321, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9744484296596247
distance 2 is tensor(35298.0957, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35298.0957, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35298.0957, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(35298.0957, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35298.0957, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35262.6269, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(35298.0957, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(35262.6269, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9483600001563927
test loss is 0.1821880464256286
test entropy is  0.1953060766277106
________________________________
2
distance 2 is tensor(35262.6269, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(35262.6269, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35262.6269, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.1953060766277106
avg test loss is  0.1821880464256286
avg accuracy is  0.9526600001563923
solo acc is  0.9483600001563927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(35262.6269, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1086974.3598, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(51231.1107, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6220974425982941
avg test loss is  1.818304143750759
avg accuracy is  0.9446800001563926
solo acc is  0.041860000156399235
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(51231.1107, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1094877.3938, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(66860.0627, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6142110499884467
avg test loss is  1.7285928918272637
avg accuracy is  0.9467000001563927
solo acc is  0.0440200001563992
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(66860.0627, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1102675.5234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(82495.5552, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.5944283007051024
avg test loss is  1.7421083264338695
avg accuracy is  0.9472800001563927
solo acc is  0.04088000015639926
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(82495.5552, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1110476.4753, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(98134.0102, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.575175829136463
avg test loss is  1.771687367840496
avg accuracy is  0.9478000001563927
solo acc is  0.0390200001563993
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(98134.0102, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1118278.8762, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(113774.6016, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(113774.6016, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(113774.6016, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(113774.6016, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.0387800001563993
test loss is 1.7456076440908719
test entropy is  0.5752279354483271
________________________________
cal ratio is  0.5498355238170541
distance 2 is tensor(62557.3426, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(62557.3426, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7415088027684559
distance 2 is tensor(46386.7696, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46386.7696, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8611095239656436
distance 2 is tensor(39944.0755, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39944.0755, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9279600294713107
distance 2 is tensor(37066.5740, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37066.5740, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9633059295597047
distance 2 is tensor(35706.4237, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35706.4237, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35706.4237, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(35706.4237, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35706.4237, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35700.3299, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(35706.4237, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(35700.3299, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9519400001563924
test loss is 0.17045083070886047
test entropy is  0.11070560853894981
________________________________
2
distance 2 is tensor(35700.3299, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(35700.3299, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(35700.3299, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.11070560853894981
avg test loss is  0.17045083070886047
avg accuracy is  0.9531800001563924
solo acc is  0.9519400001563924
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(35700.3299, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1087209.9208, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(51753.8952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6681488953587954
avg test loss is  1.7204626541003547
avg accuracy is  0.9445800001563927
solo acc is  0.06512000015639893
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(51753.8952, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1095138.7773, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(67381.5551, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6383169775118913
avg test loss is  1.6733894608819577
avg accuracy is  0.9467600001563926
solo acc is  0.04900000015639911
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(67381.5551, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1102935.9031, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(83016.6209, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6033637612448324
avg test loss is  1.722238647968263
avg accuracy is  0.9474200001563926
solo acc is  0.04200000015639924
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(83016.6209, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1110736.6372, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(98654.7785, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5846602640417226
avg test loss is  1.7443105272015038
avg accuracy is  0.9479000001563926
solo acc is  0.04004000015639928
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(98654.7785, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1118538.8405, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(114295.0014, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(114295.0014, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9484200001563925
test loss is 1.7492036840799825
test entropy is  0.575013528280246
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4250291585922241
mal norm is  tensor(1271458.5000, device='cuda:3')
distance 2 is tensor(114295.0014, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(114295.0014, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.010051833465695381
benign_entropy is 0.03075968287885189
benign_acc is 1.0000000005
benign_loss is 0.0551924929022789
benign_entropy is 0.09466840326786041
sync_acc is 1.0000000005
sync_loss is 0.012475810945034027
sync_entropy is 0.03575913608074188
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [44]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 78.60% 

Test Accuracy: 76.75% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13461.7490, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.7490, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.005414749030023813
current submit client idx and staleness is  1 1
distance 2 is tensor(13461.9800, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.9800, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00278782332316041
current submit client idx and staleness is  2 1
distance 2 is tensor(13474.7553, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13474.7553, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004019168205559254
current submit client idx and staleness is  3 1
distance 2 is tensor(13463.2495, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.2495, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004268771968781948
current submit client idx and staleness is  4 1
distance 2 is tensor(13463.7899, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.7899, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.008616047911345959
current submit client idx and staleness is  5 1
distance 2 is tensor(13469.6761, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.6761, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003799720201641321
current submit client idx and staleness is  6 1
distance 2 is tensor(13466.7545, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13466.7545, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0030465051531791687
current submit client idx and staleness is  7 1
distance 2 is tensor(13460.8074, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.8074, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004292529076337814
current submit client idx and staleness is  8 2
distance 2 is tensor(13468.8047, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.8047, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0028633777983486652
current submit client idx and staleness is  9 2
distance 2 is tensor(13476.5513, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13476.5513, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0025241372641175985
current submit client idx and staleness is  10 2
distance 2 is tensor(13959.1655, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13959.1655, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.253556489944458
current submit client idx and staleness is  11 2
distance 2 is tensor(13653.2102, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13653.2102, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.41984453797340393
current submit client idx and staleness is  12 2
distance 2 is tensor(13472.7876, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.7876, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00582485506311059
current submit client idx and staleness is  13 2
distance 2 is tensor(13482.6933, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.6933, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0034500043839216232
current submit client idx and staleness is  14 2
distance 2 is tensor(13491.4331, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.4331, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003651475068181753
current submit client idx and staleness is  15 2
distance 2 is tensor(13480.9342, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13480.9342, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003920113202184439
current submit client idx and staleness is  48 1
distance 2 is tensor(13892.4598, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13892.4598, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13820.6229, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13820.6229, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13488.4420, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13488.4420, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13460.2628, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.2628, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13492.0606, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13492.0606, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13523.2245, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13523.2245, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13487.5148, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13487.5148, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13627.6970, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13627.6970, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13885.7644, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13885.7644, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13707.3393, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13707.3393, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13615.9198, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13615.9198, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13816.5316, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13816.5316, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(32974.3669, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32974.3669, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062714.0179, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33047.6843, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33047.6843, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062746.6208, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32950.9132, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32950.9132, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062717.8313, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33133.2545, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33133.2545, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062764.6539, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32978.2518, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32978.2518, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062723.0235, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33058.0508, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33058.0508, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062746.9884, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32957.3123, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32957.3123, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062714.5087, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33313.5470, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33313.5470, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062827.3085, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33004.6843, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33004.6843, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062713.9540, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33147.4386, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33147.4386, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062773.6874, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33114.4319, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33114.4319, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062759.5171, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33002.2688, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33002.2688, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062724.2778, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(33313.5470, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.2284e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0017401967733678917
distance 2 is tensor(18385466.7780, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(18385466.7780, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04171566619905215
distance 2 is tensor(766961.9909, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(766961.9909, device='cuda:3', dtype=torch.float64)
cal ratio is  0.2042441343644542
distance 2 is tensor(156647.4693, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(156647.4693, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4519337989955052
distance 2 is tensor(70794.2885, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(70794.2885, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6722602042545083
distance 2 is tensor(47592.2203, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47592.2203, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8199144315625028
distance 2 is tensor(39021.6023, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39021.6023, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9054906384224136
distance 2 is tensor(35333.7032, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35333.7032, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9515726152633011
distance 2 is tensor(33622.6587, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33622.6587, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9754847571442405
distance 2 is tensor(32798.4281, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32798.4281, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32798.4281, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(32798.4281, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32798.4281, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32836.8656, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(32798.4281, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(32836.8656, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9977, device='cuda:3')
test acc is  0.9525800001563923
test loss is 0.22344125583753377
test entropy is  0.04847694121782318
________________________________
2
distance 2 is tensor(32836.8656, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(32836.8656, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32836.8656, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.04847694121782318
avg test loss is  0.22344125583753377
avg accuracy is  0.9525800001563923
solo acc is  0.9525800001563923
compute similarity  is  tensor(0.9977, device='cuda:3')
compute_distance is  tensor(32836.8656, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1095531.4077, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16230.1624, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6860487461090088
avg test loss is  1.7674010665825262
avg accuracy is  0.9410400001563929
solo acc is  0.06574000015639893
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(16230.1624, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1087139.1551, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31844.6180, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6349372543261179
avg test loss is  1.7516956372029335
avg accuracy is  0.9447800001563926
solo acc is  0.046560000156399134
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31844.6180, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1094931.7940, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47472.0808, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6443331540393098
avg test loss is  1.6675289709244847
avg accuracy is  0.9458800001563926
solo acc is  0.05118000015639907
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(47472.0808, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1102730.0480, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63105.2667, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6074140288335893
avg test loss is  1.7234646877669313
avg accuracy is  0.9465600001563926
solo acc is  0.04280000015639922
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63105.2667, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1110530.7325, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78741.6911, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78741.6911, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78741.6911, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78741.6911, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.04066000015639926
test loss is 1.739591624120922
test entropy is  0.5908220284963812
________________________________
cal ratio is  0.6374324153606796
distance 2 is tensor(50192.5075, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50192.5075, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7983936376588645
distance 2 is tensor(40073.3792, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40073.3792, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8935287504152867
distance 2 is tensor(35806.7037, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35806.7037, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9452666653844054
distance 2 is tensor(33846.9133, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33846.9133, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9722478229625653
distance 2 is tensor(32907.6305, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32907.6305, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32907.6305, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(32907.6305, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32907.6305, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32883.0992, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(32907.6305, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(32883.0992, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9501200001563925
test loss is 0.1741001150568428
test entropy is  0.15593558155676668
________________________________
2
distance 2 is tensor(32883.0992, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(32883.0992, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32883.0992, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.15593558155676668
avg test loss is  0.1741001150568428
avg accuracy is  0.9530600001563924
solo acc is  0.9501200001563925
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(32883.0992, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1095516.8825, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(48867.7145, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.611405352916559
avg test loss is  1.8089750861877676
avg accuracy is  0.9458800001563926
solo acc is  0.045300000156399185
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(48867.7145, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1103427.5553, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(64498.2395, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6137955770696826
avg test loss is  1.7155213633461681
avg accuracy is  0.9475200001563926
solo acc is  0.0441000001563992
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(64498.2395, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1111226.7052, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(80134.4102, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.5946337401943134
avg test loss is  1.7310265642602731
avg accuracy is  0.9482400001563926
solo acc is  0.041020000156399256
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(80134.4102, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1119028.3621, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(95773.0033, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5802932159446389
avg test loss is  1.7457801158470876
avg accuracy is  0.9485800001563925
solo acc is  0.0394400001563993
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(95773.0033, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1126831.1730, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(111413.1716, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(111413.1716, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(111413.1716, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(111413.1716, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.03958000015639928
test loss is 1.7345771876442464
test entropy is  0.5767608023131899
________________________________
cal ratio is  0.5358808593386066
distance 2 is tensor(59704.1829, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59704.1829, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7320388569125439
distance 2 is tensor(43705.7845, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43705.7845, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8555926675088491
distance 2 is tensor(37394.4087, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37394.4087, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9249817813562016
distance 2 is tensor(34589.1956, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34589.1956, device='cuda:3', dtype=torch.float64)
cal ratio is  0.961759052281723
distance 2 is tensor(33266.4533, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33266.4533, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33266.4533, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(33266.4533, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33266.4533, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33251.1408, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(33266.4533, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(33251.1408, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9530000001563923
test loss is 0.17249272050246087
test entropy is  0.09164655482982431
________________________________
2
distance 2 is tensor(33251.1408, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(33251.1408, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33251.1408, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.09164655482982431
avg test loss is  0.17249272050246087
avg accuracy is  0.9535400001563924
solo acc is  0.9530000001563923
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(33251.1408, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1095715.1787, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(49311.8817, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.650985233619085
avg test loss is  1.7467961346401888
avg accuracy is  0.9443200001563926
solo acc is  0.060760000156398965
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(49311.8817, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1103649.3241, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(64939.9276, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6325720729272993
avg test loss is  1.673412789774063
avg accuracy is  0.9474600001563926
solo acc is  0.04754000015639915
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(64939.9276, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1111447.2648, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(80574.7921, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.597323194908364
avg test loss is  1.7271514111162756
avg accuracy is  0.9481800001563926
solo acc is  0.041340000156399256
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(80574.7921, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1119248.2940, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(96213.1125, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5790434540690058
avg test loss is  1.7533310423116855
avg accuracy is  0.9485600001563925
solo acc is  0.03922000015639929
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(96213.1125, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1127050.9638, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(111852.8900, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(111852.8900, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9492000001563925
test loss is 1.7389830376790918
test entropy is  0.5748367477637117
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.4018235206604004
mal norm is  tensor(1244179.7500, device='cuda:3')
distance 2 is tensor(111852.8900, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(111852.8900, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.00523427315056324
benign_entropy is 0.020131990313529968
sync_acc is 1.0000000005
sync_loss is 0.006658362690359354
sync_entropy is 0.024050366133451462
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 78.37% 

Test Accuracy: 76.47% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13464.0028, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.0028, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0027020869310945272
current submit client idx and staleness is  1 1
distance 2 is tensor(13453.5252, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.5252, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003807490225881338
current submit client idx and staleness is  2 1
distance 2 is tensor(13473.0643, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.0643, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0009419581037946045
current submit client idx and staleness is  3 1
distance 2 is tensor(13460.6073, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.6073, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.00291584269143641
current submit client idx and staleness is  4 1
distance 2 is tensor(13453.7573, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13453.7573, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002006624359637499
current submit client idx and staleness is  5 1
distance 2 is tensor(13461.0363, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13461.0363, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002207407960668206
current submit client idx and staleness is  6 1
distance 2 is tensor(13458.9546, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13458.9546, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0021427306346595287
current submit client idx and staleness is  7 1
distance 2 is tensor(13462.2085, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13462.2085, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002607873175293207
current submit client idx and staleness is  48 1
distance 2 is tensor(13489.1195, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13489.1195, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13490.2869, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13490.2869, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13841.0289, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13841.0289, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13477.9371, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.9371, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13485.5706, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.5706, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13837.7881, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13837.7881, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13769.4154, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13769.4154, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13874.6659, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13874.6659, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13719.7186, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13719.7186, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13482.4115, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13482.4115, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13717.9287, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13717.9287, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13676.2101, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13676.2101, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(55205.3405, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55205.3405, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1061986.1881, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55541.9955, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55541.9955, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062074.7147, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55214.7452, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55214.7452, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1061981.9812, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55226.3242, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55226.3242, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1061988.4359, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55218.5598, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55218.5598, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1061977.7184, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55199.0628, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55199.0628, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1061985.9601, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55560.4912, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55560.4912, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062085.7680, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55547.6779, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55547.6779, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062086.1748, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55500.6787, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55500.6787, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062075.0621, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55210.3759, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55210.3759, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1061976.3542, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55395.9497, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55395.9497, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1062045.5957, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(55213.7214, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(55213.7214, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1061976.8783, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(55560.4912, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.1349e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.002247349057896328
distance 2 is tensor(23743662.1394, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(23743662.1394, device='cuda:3', dtype=torch.float64)
cal ratio is  0.047406212838898204
distance 2 is tensor(1125597.1215, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(1125597.1215, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21772967637182455
distance 2 is tensor(245075.8917, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(245075.8917, device='cuda:3', dtype=torch.float64)
cal ratio is  0.46661513161186313
distance 2 is tensor(114356.0875, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(114356.0875, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6830924258548962
distance 2 is tensor(78115.8001, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(78115.8001, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8264939355569743
distance 2 is tensor(64562.2036, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(64562.2036, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9091173399888461
distance 2 is tensor(58694.5622, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58694.5622, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9534769098318338
distance 2 is tensor(55963.8697, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(55963.8697, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9764617720188907
distance 2 is tensor(54646.6336, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54646.6336, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54646.6336, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(54646.6336, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54646.6336, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54684.2899, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(54646.6336, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(54684.2899, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9938, device='cuda:3')
test acc is  0.9530800001563924
test loss is 0.22543677699390233
test entropy is  0.04757084169492359
________________________________
2
distance 2 is tensor(54684.2899, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(54684.2899, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54684.2899, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.04757084169492359
avg test loss is  0.22543677699390233
avg accuracy is  0.9530600001563924
solo acc is  0.9530800001563924
compute similarity  is  tensor(0.9938, device='cuda:3')
compute_distance is  tensor(54684.2899, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1116823.6039, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16217.0087, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6760327084290098
avg test loss is  1.7583184504447995
avg accuracy is  0.939800000156393
solo acc is  0.06346000015639895
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(16217.0087, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1097504.9115, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31835.8103, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6190044067018782
avg test loss is  1.7714413861789362
avg accuracy is  0.9436600001563927
solo acc is  0.044120000156399185
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31835.8103, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1105299.7579, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47463.4775, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6210705411556127
avg test loss is  1.7089035762545397
avg accuracy is  0.9452800001563927
solo acc is  0.045700000156399176
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(47463.4775, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1113098.3332, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63097.8971, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.6052422302458292
avg test loss is  1.715192463086999
avg accuracy is  0.9462200001563926
solo acc is  0.04272000015639922
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63097.8971, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1120899.6859, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78735.1395, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78735.1395, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78735.1395, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78735.1395, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.04050000015639926
test loss is 1.7297286383636163
test entropy is  0.5900509866607159
________________________________
cal ratio is  0.8232368709760791
distance 2 is tensor(64817.6948, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(64817.6948, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9073238421114743
distance 2 is tensor(58810.6899, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58810.6899, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9525350760257448
distance 2 is tensor(56019.2054, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(56019.2054, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9759793793075731
distance 2 is tensor(54673.5948, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54673.5948, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54673.5948, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(54673.5948, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54673.5948, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54639.3760, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(54673.5948, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(54639.3760, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9012200001563944
test loss is 0.3658966973538289
test entropy is  0.5378943964495988
________________________________
2
distance 2 is tensor(54639.3760, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(54639.3760, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54639.3760, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.5378943964495988
avg test loss is  0.3658966973538289
avg accuracy is  0.9516000001563923
solo acc is  0.9012200001563944
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(54639.3760, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1116712.3514, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(70446.1878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6059961739327292
avg test loss is  1.7161925613422833
avg accuracy is  0.9475400001563926
solo acc is  0.04294000015639922
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(70446.1878, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1124567.8025, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(86085.9366, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.5822829489055497
avg test loss is  1.7476217667465015
avg accuracy is  0.9479400001563927
solo acc is  0.039880000156399274
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(86085.9366, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1132370.9332, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(101726.8565, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.5721203891746224
avg test loss is  1.7530438910664805
avg accuracy is  0.9483200001563926
solo acc is  0.038880000156399294
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(101726.8565, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1140174.7793, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(117367.2069, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.5708460342472471
avg test loss is  1.7356163854794124
avg accuracy is  0.9491000001563925
solo acc is  0.038880000156399294
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(117367.2069, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1147978.4856, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(133010.0548, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(133010.0548, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(133010.0548, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(133010.0548, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.03822000015639931
test loss is 1.7356764800713191
test entropy is  0.5650593102206964
________________________________
cal ratio is  0.633383692721882
distance 2 is tensor(84246.3759, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(84246.3759, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7958541772133239
distance 2 is tensor(67047.8226, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(67047.8226, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8921066459046881
distance 2 is tensor(59813.8503, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59813.8503, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9445136406410628
distance 2 is tensor(56494.9388, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(56494.9388, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9718614208066841
distance 2 is tensor(54905.3132, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(54905.3132, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54905.3132, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(54905.3132, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54905.3132, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54875.3132, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(54905.3132, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(54875.3132, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9521400001563923
test loss is 0.1682020531115158
test entropy is  0.13412914698338493
________________________________
2
distance 2 is tensor(54875.3132, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(54875.3132, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(54875.3132, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.13412914698338493
avg test loss is  0.1682020531115158
avg accuracy is  0.9537200001563924
solo acc is  0.9521400001563923
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(54875.3132, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1116862.5627, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(70857.3864, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5761235404731063
avg test loss is  1.8496398559921539
avg accuracy is  0.9465600001563926
solo acc is  0.03988000015639927
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(70857.3864, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1124772.9163, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(86489.3717, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.5954078330332057
avg test loss is  1.725783729187363
avg accuracy is  0.9480000001563926
solo acc is  0.04074000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(86489.3717, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1132572.5612, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(102128.2543, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.5814524162608339
avg test loss is  1.7327308249290643
avg accuracy is  0.9486600001563925
solo acc is  0.0394800001563993
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(102128.2543, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1140375.4132, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(117768.1441, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.570146402358399
avg test loss is  1.7423802483112305
avg accuracy is  0.9492400001563925
solo acc is  0.038660000156399296
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(117768.1441, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1148178.7940, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(133410.0450, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(133410.0450, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9498800001563925
test loss is 1.727684140357825
test entropy is  0.5684318560773455
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.401024341583252
mal norm is  tensor(1485220.5000, device='cuda:3')
distance 2 is tensor(133410.0450, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(133410.0450, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.003024226287379861
sync_entropy is 0.013758711516857147
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [42, 44, 45, 46]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 78.56% 

Test Accuracy: 76.98% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13506.8169, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13506.8169, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05498499423265457
current submit client idx and staleness is  1 1
distance 2 is tensor(13469.8766, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13469.8766, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0016527194529771805
current submit client idx and staleness is  2 1
distance 2 is tensor(13456.9588, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13456.9588, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003288669977337122
current submit client idx and staleness is  3 1
distance 2 is tensor(13440.9948, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13440.9948, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.004465860780328512
current submit client idx and staleness is  4 1
distance 2 is tensor(13445.6842, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13445.6842, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0036011941265314817
current submit client idx and staleness is  5 1
distance 2 is tensor(13460.3200, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.3200, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003219196107238531
current submit client idx and staleness is  6 1
distance 2 is tensor(13448.9675, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13448.9675, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0033127623610198498
current submit client idx and staleness is  7 1
distance 2 is tensor(13463.7462, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13463.7462, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0017703559715300798
current submit client idx and staleness is  8 2
distance 2 is tensor(13740.7008, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13740.7008, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05443339794874191
current submit client idx and staleness is  9 2
distance 2 is tensor(13457.4819, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.4819, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0023047986906021833
current submit client idx and staleness is  10 2
distance 2 is tensor(13478.7010, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13478.7010, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.014856572262942791
current submit client idx and staleness is  11 2
distance 2 is tensor(13470.9588, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13470.9588, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0020642855670303106
current submit client idx and staleness is  12 2
distance 2 is tensor(13693.5081, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13693.5081, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.04262537509202957
current submit client idx and staleness is  13 2
distance 2 is tensor(13473.4681, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.4681, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0037462629843503237
current submit client idx and staleness is  14 2
distance 2 is tensor(13472.2407, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.2407, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003600773634389043
current submit client idx and staleness is  15 2
distance 2 is tensor(13484.2548, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13484.2548, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.003788797650486231
current submit client idx and staleness is  16 3
distance 2 is tensor(13803.2279, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13803.2279, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4086484909057617
current submit client idx and staleness is  17 3
distance 2 is tensor(13508.1829, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13508.1829, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.05233494192361832
current submit client idx and staleness is  18 3
distance 2 is tensor(13479.8867, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.8867, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0019310098141431808
current submit client idx and staleness is  19 3
distance 2 is tensor(13758.7723, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13758.7723, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.09831926971673965
current submit client idx and staleness is  20 3
distance 2 is tensor(13793.7281, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13793.7281, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.2429395467042923
current submit client idx and staleness is  21 3
distance 2 is tensor(13586.0706, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13586.0706, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.14132823050022125
current submit client idx and staleness is  22 3
distance 2 is tensor(13923.8662, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13923.8662, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.15856556594371796
current submit client idx and staleness is  23 3
distance 2 is tensor(14032.3755, device='cuda:3', dtype=torch.float64)
check distance is  tensor(14032.3755, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4464516043663025
current submit client idx and staleness is  24 4
distance 2 is tensor(13782.1779, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13782.1779, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.5864322781562805
current submit client idx and staleness is  25 4
distance 2 is tensor(13746.6518, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13746.6518, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4242953360080719
current submit client idx and staleness is  26 4
distance 2 is tensor(13943.7285, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13943.7285, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3044146001338959
current submit client idx and staleness is  27 4
distance 2 is tensor(13938.3227, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13938.3227, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.518390953540802
current submit client idx and staleness is  28 4
distance 2 is tensor(13821.4444, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13821.4444, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.199128195643425
current submit client idx and staleness is  29 4
distance 2 is tensor(13975.6179, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13975.6179, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.29334643483161926
current submit client idx and staleness is  30 4
distance 2 is tensor(13862.2239, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13862.2239, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.3902899920940399
current submit client idx and staleness is  31 4
distance 2 is tensor(13764.4549, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13764.4549, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.08707951009273529
current submit client idx and staleness is  40 6
distance 2 is tensor(13904.1962, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13904.1962, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.40282416343688965
current submit client idx and staleness is  41 6
distance 2 is tensor(13843.4751, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13843.4751, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.413480669260025
current submit client idx and staleness is  42 6
distance 2 is tensor(13906.4762, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13906.4762, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4385767877101898
current submit client idx and staleness is  43 6
distance 2 is tensor(13933.8688, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13933.8688, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.7899919748306274
current submit client idx and staleness is  44 6
distance 2 is tensor(13830.2832, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13830.2832, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.4955390989780426
current submit client idx and staleness is  45 6
distance 2 is tensor(13892.7599, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13892.7599, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.31839561462402344
current submit client idx and staleness is  46 6
distance 2 is tensor(13870.6913, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13870.6913, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.13177178800106049
current submit client idx and staleness is  47 6
distance 2 is tensor(13879.8151, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13879.8151, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.41586166620254517
current submit client idx and staleness is  48 1
distance 2 is tensor(13468.4738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13468.4738, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13626.6387, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13626.6387, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13836.2965, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13836.2965, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13635.2831, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13635.2831, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13485.3872, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13485.3872, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13477.4632, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.4632, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13705.5894, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13705.5894, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13504.7861, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13504.7861, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13477.9392, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13477.9392, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13507.3130, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13507.3130, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13471.9849, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.9849, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13503.3993, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13503.3993, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(33085.5523, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33085.5523, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071131.9054, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32929.6228, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32929.6228, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071072.0865, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33064.3502, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33064.3502, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071123.9465, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33188.7450, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33188.7450, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071158.0289, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32923.0921, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32923.0921, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071074.9858, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32936.5830, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32936.5830, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071073.1842, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33003.6968, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33003.6968, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071090.7992, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33117.9469, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33117.9469, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071136.7969, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32930.9895, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32930.9895, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071086.7457, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32913.9718, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32913.9718, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071070.5611, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32911.9904, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(32911.9904, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071075.3975, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33407.6562, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(33407.6562, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1071232.6497, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(33407.6562, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.3291e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.0017426516500262208
distance 2 is tensor(18411432.7207, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(18411432.7207, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04174507896182665
distance 2 is tensor(768586.6251, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(768586.6251, device='cuda:3', dtype=torch.float64)
cal ratio is  0.20431613671301996
distance 2 is tensor(157034.6924, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(157034.6924, device='cuda:3', dtype=torch.float64)
cal ratio is  0.45201336430309175
distance 2 is tensor(70981.7984, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(70981.7984, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6723193025407728
distance 2 is tensor(47722.3639, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47722.3639, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8199513882204722
distance 2 is tensor(39130.0727, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(39130.0727, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9055110455661981
distance 2 is tensor(35432.7187, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35432.7187, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9515833648107096
distance 2 is tensor(33717.2621, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33717.2621, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9754902393802579
distance 2 is tensor(32890.8976, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32890.8976, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32890.8976, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(32890.8976, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32890.8976, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32929.3351, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(32890.8976, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(32929.3351, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9977, device='cuda:3')
test acc is  0.9538400001563924
test loss is 0.211681680217081
test entropy is  0.05018349904540207
________________________________
2
distance 2 is tensor(32929.3351, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(32929.3351, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32929.3351, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.05018349904540207
avg test loss is  0.211681680217081
avg accuracy is  0.9538400001563924
solo acc is  0.9538400001563924
compute similarity  is  tensor(0.9977, device='cuda:3')
compute_distance is  tensor(32929.3351, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1103916.0760, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16244.9332, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.676824114130586
avg test loss is  1.7887478175065707
avg accuracy is  0.9433400001563927
solo acc is  0.060380000156398966
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16244.9332, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1095478.1831, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31858.7631, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6035779073186542
avg test loss is  1.8319550327327856
avg accuracy is  0.9461800001563926
solo acc is  0.04086000015639924
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31858.7631, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1103270.3349, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47485.1449, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.6395696900842135
avg test loss is  1.6763216383621822
avg accuracy is  0.9474000001563926
solo acc is  0.04972000015639909
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(47485.1449, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1111067.9693, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63118.0073, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.609733179859493
avg test loss is  1.711992331173109
avg accuracy is  0.9480000001563926
solo acc is  0.04326000015639922
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(63118.0073, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1118868.4614, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78754.2941, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78754.2941, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78754.2941, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78754.2941, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.041440000156399245
test loss is 1.7232229208092555
test entropy is  0.5949236879034725
________________________________
cal ratio is  0.6382810604292185
distance 2 is tensor(50267.4517, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50267.4517, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7989243260514478
distance 2 is tensor(40159.9283, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(40159.9283, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8938252419083198
distance 2 is tensor(35896.0329, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(35896.0329, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9454223218715622
distance 2 is tensor(33936.8741, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33936.8741, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9723288249210953
distance 2 is tensor(32997.7565, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(32997.7565, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32997.7565, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(32997.7565, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32997.7565, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32969.0065, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(32997.7565, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(32969.0065, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9513200001563924
test loss is 0.17068875283586418
test entropy is  0.16053052792978256
________________________________
2
distance 2 is tensor(32969.0065, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(32969.0065, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(32969.0065, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.16053052792978256
avg test loss is  0.17068875283586418
avg accuracy is  0.9541600001563924
solo acc is  0.9513200001563924
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(32969.0065, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1103894.8718, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(48959.5146, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5965754734280774
avg test loss is  1.8509401371107077
avg accuracy is  0.9477600001563926
solo acc is  0.03912000015639927
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(48959.5146, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1111804.8448, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(64589.3781, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6161226260540126
avg test loss is  1.7043593879550925
avg accuracy is  0.9487600001563925
solo acc is  0.044680000156399204
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(64589.3781, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1119603.6634, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(80226.0921, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.5921992396226015
avg test loss is  1.732957982346225
avg accuracy is  0.9494000001563925
solo acc is  0.04072000015639926
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(80226.0921, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1127405.5006, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(95864.5368, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.580072676396126
avg test loss is  1.741328823596925
avg accuracy is  0.9497400001563925
solo acc is  0.03952000015639929
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(95864.5368, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1135208.2017, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(111504.8483, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(111504.8483, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(111504.8483, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(111504.8483, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.038840000156399296
test loss is 1.747193948387185
test entropy is  0.5705391744442303
________________________________
cal ratio is  0.5364165936181198
distance 2 is tensor(59813.0973, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(59813.0973, device='cuda:3', dtype=torch.float64)
cal ratio is  0.7324043809218227
distance 2 is tensor(43807.4278, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(43807.4278, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8558057544513583
distance 2 is tensor(37490.7024, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(37490.7024, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9250970396842867
distance 2 is tensor(34682.5359, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(34682.5359, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9618196754584141
distance 2 is tensor(33358.4030, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(33358.4030, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33358.4030, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(33358.4030, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33358.4030, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33334.9655, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(33358.4030, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(33334.9655, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9539000001563923
test loss is 0.16723242992638845
test entropy is  0.09526239597069486
________________________________
2
distance 2 is tensor(33334.9655, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(33334.9655, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(33334.9655, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.09526239597069486
avg test loss is  0.16723242992638845
avg accuracy is  0.9543200001563923
solo acc is  0.9539000001563923
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(33334.9655, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1104093.0773, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(49403.6349, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6440386657824602
avg test loss is  1.748425476386419
avg accuracy is  0.9473600001563927
solo acc is  0.05496000015639903
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(49403.6349, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1112026.6847, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(65031.5144, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.6199001719808335
avg test loss is  1.7034633731293252
avg accuracy is  0.9487600001563925
solo acc is  0.04462000015639919
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(65031.5144, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1119824.4294, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(80666.2051, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.5952935476437249
avg test loss is  1.7276864378043757
avg accuracy is  0.9494000001563925
solo acc is  0.04134000015639925
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(80666.2051, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1127625.2858, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(96304.8578, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(96304.8578, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(96304.8578, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9498600001563925
test loss is 1.7265326999642354
test entropy is  0.5862273704594053
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.3720624446868896
mal norm is  tensor(1070223., device='cuda:3')
distance 2 is tensor(96304.8578, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(96304.8578, device='cuda:3', dtype=torch.float64)
benign_acc is 1.0000000005
benign_loss is 0.005277208052575588
benign_entropy is 0.020247390493750572
benign_acc is 1.0000000005
benign_loss is 0.021816298365592957
benign_entropy is 0.04655741527676582
benign_acc is 0.9500000005
benign_loss is 0.1606326550245285
benign_entropy is 0.07094120234251022
benign_acc is 0.9500000005
benign_loss is 0.14017713069915771
benign_entropy is 0.10514626652002335
sync_acc is 1.0000000005
sync_loss is 0.005025793798267841
sync_entropy is 0.020003603771328926
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 78.58% 

Test Accuracy: 76.77% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(13472.0872, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.0872, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0016729083145037293
current submit client idx and staleness is  1 1
distance 2 is tensor(13457.0027, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.0027, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0017912837211042643
current submit client idx and staleness is  2 1
distance 2 is tensor(13448.1877, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13448.1877, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0021383599378168583
current submit client idx and staleness is  3 1
distance 2 is tensor(13509.5266, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13509.5266, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.07162580639123917
current submit client idx and staleness is  4 1
distance 2 is tensor(13460.3142, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13460.3142, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0036707972176373005
current submit client idx and staleness is  5 1
distance 2 is tensor(13457.1960, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13457.1960, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002620121231302619
current submit client idx and staleness is  6 1
distance 2 is tensor(13465.2859, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13465.2859, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.0013825008645653725
current submit client idx and staleness is  7 1
distance 2 is tensor(13459.9397, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13459.9397, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
 benign loss is  0.002198407193645835
current submit client idx and staleness is  48 1
distance 2 is tensor(13472.5858, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13472.5858, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  49 1
distance 2 is tensor(13836.7410, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13836.7410, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  50 1
distance 2 is tensor(13664.4800, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13664.4800, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  51 1
distance 2 is tensor(13464.4760, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13464.4760, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  52 1
distance 2 is tensor(13471.3242, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13471.3242, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  53 1
distance 2 is tensor(13547.4653, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13547.4653, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  54 1
distance 2 is tensor(13473.9561, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13473.9561, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  55 1
distance 2 is tensor(13701.5243, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13701.5243, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  56 1
distance 2 is tensor(13915.0794, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13915.0794, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  57 1
distance 2 is tensor(13693.9377, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13693.9377, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  58 1
distance 2 is tensor(13479.7518, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13479.7518, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
current submit client idx and staleness is  59 1
distance 2 is tensor(13491.0877, device='cuda:3', dtype=torch.float64)
check distance is  tensor(13491.0877, device='cuda:3', dtype=torch.float64)
grad,shape is torch.Size([11183582])
len of model dicts is  12
distance 2 is tensor(44583.0883, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44583.0883, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074799.5361, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44611.0899, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44611.0899, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074791.7839, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44771.4737, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44771.4737, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074849.2376, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45049.6401, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45049.6401, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074933.1465, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44625.3467, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44625.3467, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074788.7598, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44869.6979, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44869.6979, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074879.1507, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44610.4434, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44610.4434, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074788.3193, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(45020.7343, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(45020.7343, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074927.0114, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44604.7708, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44604.7708, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074792.1805, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44658.9481, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44658.9481, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074814.9060, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44615.8227, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44615.8227, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074792.1380, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44772.3020, device='cuda:3', dtype=torch.float64)
compute distance is  tensor(44772.3020, device='cuda:3', dtype=torch.float64)
compute norm is  tensor(1074839.3453, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(45049.6401, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(1.0565e+10, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(8.1390e-05, device='cuda:3')
test acc is  0.03090000015639952
test loss is 436975.1129315857
test entropy is  0.0
________________________________
cal ratio is  0.00202363810035001
distance 2 is tensor(21380142.8575, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(21380142.8575, device='cuda:3', dtype=torch.float64)
cal ratio is  0.04498486661099876
distance 2 is tensor(961782.8000, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(961782.8000, device='cuda:3', dtype=torch.float64)
cal ratio is  0.21209636983439342
distance 2 is tensor(203990.6040, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(203990.6040, device='cuda:3', dtype=torch.float64)
cal ratio is  0.4605392575983262
distance 2 is tensor(93945.6527, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(93945.6527, device='cuda:3', dtype=torch.float64)
cal ratio is  0.6786305309774499
distance 2 is tensor(63754.3372, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63754.3372, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8237906736789253
distance 2 is tensor(52520.2551, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52520.2551, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9076289193009786
distance 2 is tensor(47668.9628, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47668.9628, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9526950031098266
distance 2 is tensor(45413.9301, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45413.9301, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9760615268102618
distance 2 is tensor(44326.8386, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44326.8386, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44326.8386, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44326.8386, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44326.8386, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44364.8074, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44326.8386, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44364.8074, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(0.9959, device='cuda:3')
test acc is  0.9538000001563923
test loss is 0.22093314441047338
test entropy is  0.046880435223629835
________________________________
2
distance 2 is tensor(44364.8074, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44364.8074, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44364.8074, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.046880435223629835
avg test loss is  0.22093314441047338
avg accuracy is  0.9537800001563923
solo acc is  0.9538000001563923
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(44364.8074, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1119184.6502, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(16223.5512, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6645598272838251
avg test loss is  1.7860068910567046
avg accuracy is  0.9425800001563928
solo acc is  0.056100000156399016
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16223.5512, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1105025.5689, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(31838.3238, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.636669101693746
avg test loss is  1.7213054422832206
avg accuracy is  0.9462800001563927
solo acc is  0.047520000156399136
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(31838.3238, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1112818.6977, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(47467.2881, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  3
avg test entropy is  0.634989684309496
avg test loss is  1.6724224663756388
avg accuracy is  0.9473400001563926
solo acc is  0.04852000015639911
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(47467.2881, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1120617.8095, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(63101.5750, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  4
avg test entropy is  0.604957534910163
avg test loss is  1.7139205034736478
avg accuracy is  0.9483000001563926
solo acc is  0.04264000015639923
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(63101.5750, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1128419.0801, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(78738.1582, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(78738.1582, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(78738.1582, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(78738.1582, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.039600000156399286
test loss is 1.7467059198852695
test entropy is  0.5831750483082994
________________________________
cal ratio is  0.7412745885252936
distance 2 is tensor(58366.5428, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(58366.5428, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8609734390478879
distance 2 is tensor(50252.1158, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(50252.1158, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9278858723158191
distance 2 is tensor(46628.1626, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(46628.1626, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9632690069130307
distance 2 is tensor(44915.4304, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44915.4304, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44915.4304, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44915.4304, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44915.4304, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44889.8054, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44915.4304, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44889.8054, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9437200001563928
test loss is 0.21334116035105322
test entropy is  0.30150542712158257
________________________________
2
distance 2 is tensor(44889.8054, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44889.8054, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44889.8054, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.30150542712158257
avg test loss is  0.21334116035105322
avg accuracy is  0.9535400001563924
solo acc is  0.9437200001563928
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(44889.8054, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1119380.2345, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(60775.2199, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.6011001719614429
avg test loss is  1.755038745110602
avg accuracy is  0.9490200001563925
solo acc is  0.041260000156399246
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(60775.2199, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1127259.7492, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(76411.2531, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.5976280676358191
avg test loss is  1.7175964312175351
avg accuracy is  0.9494800001563924
solo acc is  0.041640000156399244
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(76411.2531, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1135061.2832, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(92049.9745, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(92049.9745, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(92049.9745, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(92049.9745, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(92049.9745, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.04100000015639925
test loss is 1.7224843835891666
test entropy is  0.5862568057406589
________________________________
cal ratio is  0.6855827822913794
distance 2 is tensor(63107.9522, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(63107.9522, device='cuda:3', dtype=torch.float64)
cal ratio is  0.8279987755008986
distance 2 is tensor(52253.2402, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(52253.2402, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9099449634921929
distance 2 is tensor(47547.5401, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(47547.5401, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9539106810312655
distance 2 is tensor(45356.1582, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(45356.1582, device='cuda:3', dtype=torch.float64)
cal ratio is  0.9766829528516222
distance 2 is tensor(44298.5160, device='cuda:3', dtype=torch.float64)
cal_distance is  tensor(44298.5160, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44298.5160, device='cuda:3', dtype=torch.float64)
return_distance is  tensor(44298.5160, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44298.5160, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44274.2972, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(44298.5160, device='cuda:3', dtype=torch.float64)
test distance1 is  tensor(44274.2972, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.9506600001563925
test loss is 0.17421917492985878
test entropy is  0.18077794305713432
________________________________
2
distance 2 is tensor(44274.2972, device='cuda:3', dtype=torch.float64)
test distance 2 is  tensor(44274.2972, device='cuda:3', dtype=torch.float64)
distance 2 is tensor(44274.2972, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  0
avg test entropy is  0.18077794305713432
avg test loss is  0.17421917492985878
avg accuracy is  0.9541200001563923
solo acc is  0.9506600001563925
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(44274.2972, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1119084.0988, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(60217.4710, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  1
avg test entropy is  0.5764765829381431
avg test loss is  1.8540723439677598
avg accuracy is  0.9485000001563927
solo acc is  0.039040000156399295
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(60217.4710, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1126981.3003, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(75849.8252, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
after training  2
avg test entropy is  0.5979154633972651
avg test loss is  1.7228521436376645
avg accuracy is  0.9496400001563925
solo acc is  0.041860000156399235
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(75849.8252, device='cuda:3', dtype=torch.float64)
compute_norm is  tensor(1134781.2859, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 2 is tensor(91488.2514, device='cuda:3', dtype=torch.float64)
exit early
distance 2 is tensor(91488.2514, device='cuda:3', dtype=torch.float64)
________________________________
test distance is  tensor(91488.2514, device='cuda:3', dtype=torch.float64)
test similarity is  tensor(1., device='cuda:3')
test acc is  0.9502200001563925
test loss is 1.725225600440179
test entropy is  0.586106790186804
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([11183582])
mal_acc is 5e-10
mal loss is 1.381601333618164
mal norm is  tensor(1016558.1875, device='cuda:3')
distance 2 is tensor(91488.2514, device='cuda:3', dtype=torch.float64)
mal distance is  tensor(91488.2514, device='cuda:3', dtype=torch.float64)
sync_acc is 1.0000000005
sync_loss is 0.0035809525288641453
sync_entropy is 0.01567355915904045
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [45, 48]
alphas 3 is [1.  0.2 0.5]
alphas is  [0.58823529 0.11764706 0.29411765]
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 78.64% 

Test Accuracy: 77.04% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 78.64%
|----0th round Training Accuracy : 76.48%
|----1th round Training Accuracy : 76.63%
|----2th round Training Accuracy : 76.66%
|----3th round Training Accuracy : 76.67%
|----4th round Training Accuracy : 76.50%
|----5th round Training Accuracy : 76.71%
|----6th round Training Accuracy : 73.03%
|----7th round Training Accuracy : 75.67%
|----8th round Training Accuracy : 75.42%
|----9th round Training Accuracy : 75.28%
|----10th round Training Accuracy : 74.95%
|----11th round Training Accuracy : 76.96%
|----12th round Training Accuracy : 76.34%
|----13th round Training Accuracy : 76.60%
|----14th round Training Accuracy : 77.03%
|----15th round Training Accuracy : 77.01%
|----16th round Training Accuracy : 76.60%
|----17th round Training Accuracy : 77.25%
|----18th round Training Accuracy : 77.11%
|----19th round Training Accuracy : 77.32%
|----20th round Training Accuracy : 77.34%
|----21th round Training Accuracy : 77.39%
|----22th round Training Accuracy : 77.28%
|----23th round Training Accuracy : 77.56%
|----24th round Training Accuracy : 77.55%
|----25th round Training Accuracy : 77.77%
|----26th round Training Accuracy : 77.59%
|----27th round Training Accuracy : 77.67%
|----28th round Training Accuracy : 77.94%
|----29th round Training Accuracy : 78.01%
|----30th round Training Accuracy : 77.97%
|----31th round Training Accuracy : 77.88%
|----32th round Training Accuracy : 77.93%
|----33th round Training Accuracy : 77.99%
|----34th round Training Accuracy : 77.91%
|----35th round Training Accuracy : 78.16%
|----36th round Training Accuracy : 78.23%
|----37th round Training Accuracy : 78.23%
|----38th round Training Accuracy : 78.29%
|----39th round Training Accuracy : 78.17%
|----40th round Training Accuracy : 78.45%
|----41th round Training Accuracy : 78.39%
|----42th round Training Accuracy : 78.37%
|----43th round Training Accuracy : 78.55%
|----44th round Training Accuracy : 78.40%
|----45th round Training Accuracy : 78.60%
|----46th round Training Accuracy : 78.37%
|----47th round Training Accuracy : 78.56%
|----48th round Training Accuracy : 78.58%
|----49th round Training Accuracy : 78.64%
|----Final Test Accuracy: 77.04%
|----0th round Final Test Accuracy : 76.88%
|----1th round Final Test Accuracy : 76.49%
|----2th round Final Test Accuracy : 76.50%
|----3th round Final Test Accuracy : 76.51%
|----4th round Final Test Accuracy : 76.87%
|----5th round Final Test Accuracy : 76.52%
|----6th round Final Test Accuracy : 72.42%
|----7th round Final Test Accuracy : 75.02%
|----8th round Final Test Accuracy : 74.67%
|----9th round Final Test Accuracy : 74.64%
|----10th round Final Test Accuracy : 74.23%
|----11th round Final Test Accuracy : 76.50%
|----12th round Final Test Accuracy : 75.29%
|----13th round Final Test Accuracy : 75.89%
|----14th round Final Test Accuracy : 76.16%
|----15th round Final Test Accuracy : 76.44%
|----16th round Final Test Accuracy : 75.77%
|----17th round Final Test Accuracy : 76.41%
|----18th round Final Test Accuracy : 76.06%
|----19th round Final Test Accuracy : 76.45%
|----20th round Final Test Accuracy : 76.22%
|----21th round Final Test Accuracy : 76.50%
|----22th round Final Test Accuracy : 76.11%
|----23th round Final Test Accuracy : 76.72%
|----24th round Final Test Accuracy : 76.37%
|----25th round Final Test Accuracy : 76.63%
|----26th round Final Test Accuracy : 76.49%
|----27th round Final Test Accuracy : 76.50%
|----28th round Final Test Accuracy : 76.47%
|----29th round Final Test Accuracy : 76.56%
|----30th round Final Test Accuracy : 76.10%
|----31th round Final Test Accuracy : 76.41%
|----32th round Final Test Accuracy : 76.68%
|----33th round Final Test Accuracy : 76.69%
|----34th round Final Test Accuracy : 76.40%
|----35th round Final Test Accuracy : 76.82%
|----36th round Final Test Accuracy : 76.45%
|----37th round Final Test Accuracy : 76.56%
|----38th round Final Test Accuracy : 76.54%
|----39th round Final Test Accuracy : 76.60%
|----40th round Final Test Accuracy : 76.53%
|----41th round Final Test Accuracy : 76.91%
|----42th round Final Test Accuracy : 76.52%
|----43th round Final Test Accuracy : 76.82%
|----44th round Final Test Accuracy : 76.68%
|----45th round Final Test Accuracy : 76.75%
|----46th round Final Test Accuracy : 76.47%
|----47th round Final Test Accuracy : 76.98%
|----48th round Final Test Accuracy : 76.77%
|----49th round Final Test Accuracy : 77.04%

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 51417.4400

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
Files already downloaded and verified
