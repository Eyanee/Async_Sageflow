
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6504571121186018
distance 1 is tensor(69.6531, device='cuda:0')
distance 2 is tensor(5.4931, device='cuda:0')
benign distance is  tensor(5.4931, device='cuda:0')
norm1 res is  tensor(0.0604, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7284806501120329
distance 1 is tensor(80.4301, device='cuda:0')
distance 2 is tensor(6.0049, device='cuda:0')
benign distance is  tensor(6.0049, device='cuda:0')
norm1 res is  tensor(0.1064, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8992656879127026
distance 1 is tensor(102.7963, device='cuda:0')
distance 2 is tensor(7.6329, device='cuda:0')
benign distance is  tensor(7.6329, device='cuda:0')
norm1 res is  tensor(0.1918, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1965866386890411
distance 1 is tensor(152.0014, device='cuda:0')
distance 2 is tensor(11.3413, device='cuda:0')
benign distance is  tensor(11.3413, device='cuda:0')
norm1 res is  tensor(0.1070, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.1216097455471754
distance 1 is tensor(74.2064, device='cuda:0')
distance 2 is tensor(5.7860, device='cuda:0')
benign distance is  tensor(5.7860, device='cuda:0')
norm1 res is  tensor(0.0801, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.863359889946878
distance 1 is tensor(87.5146, device='cuda:0')
distance 2 is tensor(6.3795, device='cuda:0')
benign distance is  tensor(6.3795, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.588274098932743
distance 1 is tensor(103.7359, device='cuda:0')
distance 2 is tensor(7.8002, device='cuda:0')
benign distance is  tensor(7.8002, device='cuda:0')
norm1 res is  tensor(0.1196, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.9591701738536358
distance 1 is tensor(66.5746, device='cuda:0')
distance 2 is tensor(5.0582, device='cuda:0')
benign distance is  tensor(5.0582, device='cuda:0')
norm1 res is  tensor(0.1072, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.2168501168489456
distance 1 is tensor(110.9860, device='cuda:0')
distance 2 is tensor(8.2673, device='cuda:0')
benign distance is  tensor(8.2673, device='cuda:0')
norm1 res is  tensor(0.1240, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9099490381777287
distance 1 is tensor(116.4081, device='cuda:0')
distance 2 is tensor(8.8211, device='cuda:0')
benign distance is  tensor(8.8211, device='cuda:0')
norm1 res is  tensor(0.1355, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0522710792720318
distance 1 is tensor(64.4217, device='cuda:0')
distance 2 is tensor(4.9565, device='cuda:0')
benign distance is  tensor(4.9565, device='cuda:0')
norm1 res is  tensor(0.0830, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0574003159999847
distance 1 is tensor(107.9454, device='cuda:0')
distance 2 is tensor(8.2196, device='cuda:0')
benign distance is  tensor(8.2196, device='cuda:0')
norm1 res is  tensor(0.1133, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.5000431910157204
distance 1 is tensor(178.7291, device='cuda:0')
distance 2 is tensor(12.7298, device='cuda:0')
benign distance is  tensor(12.7298, device='cuda:0')
norm1 res is  tensor(0.1155, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6674452293664217
distance 1 is tensor(56.1648, device='cuda:0')
distance 2 is tensor(4.2714, device='cuda:0')
benign distance is  tensor(4.2714, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.9340007565915585
distance 1 is tensor(136.8228, device='cuda:0')
distance 2 is tensor(10.0752, device='cuda:0')
benign distance is  tensor(10.0752, device='cuda:0')
norm1 res is  tensor(0.1342, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.6575924828648567
distance 1 is tensor(128.4029, device='cuda:0')
distance 2 is tensor(9.5814, device='cuda:0')
benign distance is  tensor(9.5814, device='cuda:0')
norm1 res is  tensor(0.1273, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.206105288118124
distance 1 is tensor(101.2816, device='cuda:0')
distance 2 is tensor(7.4800, device='cuda:0')
benign distance is  tensor(7.4800, device='cuda:0')
norm1 res is  tensor(0.1423, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.800608791410923
distance 1 is tensor(124.1292, device='cuda:0')
distance 2 is tensor(9.1659, device='cuda:0')
benign distance is  tensor(9.1659, device='cuda:0')
norm1 res is  tensor(0.1577, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.121841087937355
distance 1 is tensor(137.7513, device='cuda:0')
distance 2 is tensor(10.0554, device='cuda:0')
benign distance is  tensor(10.0554, device='cuda:0')
norm1 res is  tensor(0.1373, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.8026458472013474
distance 1 is tensor(144.4767, device='cuda:0')
distance 2 is tensor(10.6454, device='cuda:0')
benign distance is  tensor(10.6454, device='cuda:0')
norm1 res is  tensor(0.1293, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.0176715683192015
distance 1 is tensor(103.8429, device='cuda:0')
distance 2 is tensor(7.5834, device='cuda:0')
benign distance is  tensor(7.5834, device='cuda:0')
norm1 res is  tensor(0.1311, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.0678566731512547
distance 1 is tensor(241.4024, device='cuda:0')
distance 2 is tensor(17.3341, device='cuda:0')
benign distance is  tensor(17.3341, device='cuda:0')
norm1 res is  tensor(0.1277, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.3680170774459839
distance 1 is tensor(154.8803, device='cuda:0')
distance 2 is tensor(11.4909, device='cuda:0')
benign distance is  tensor(11.4909, device='cuda:0')
norm1 res is  tensor(0.1011, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.8355348352342844
distance 1 is tensor(118.4485, device='cuda:0')
distance 2 is tensor(8.6522, device='cuda:0')
benign distance is  tensor(8.6522, device='cuda:0')
norm1 res is  tensor(0.1022, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.0960998609662056
distance 1 is tensor(128.8784, device='cuda:0')
distance 2 is tensor(9.6335, device='cuda:0')
benign distance is  tensor(9.6335, device='cuda:0')
norm1 res is  tensor(0.1389, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.8202994484454393
distance 1 is tensor(94.8508, device='cuda:0')
distance 2 is tensor(7.1447, device='cuda:0')
benign distance is  tensor(7.1447, device='cuda:0')
norm1 res is  tensor(0.2679, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.0048398077487946
distance 1 is tensor(161.7346, device='cuda:0')
distance 2 is tensor(12.0581, device='cuda:0')
benign distance is  tensor(12.0581, device='cuda:0')
norm1 res is  tensor(0.1406, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.806605864316225
distance 1 is tensor(131.0517, device='cuda:0')
distance 2 is tensor(9.9447, device='cuda:0')
benign distance is  tensor(9.9447, device='cuda:0')
norm1 res is  tensor(0.1456, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.8040117491036654
distance 1 is tensor(141.5668, device='cuda:0')
distance 2 is tensor(10.3863, device='cuda:0')
benign distance is  tensor(10.3863, device='cuda:0')
norm1 res is  tensor(0.1566, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8859286494553089
distance 1 is tensor(129.6825, device='cuda:0')
distance 2 is tensor(9.7443, device='cuda:0')
benign distance is  tensor(9.7443, device='cuda:0')
norm1 res is  tensor(0.1457, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.4876633994281292
distance 1 is tensor(144.6281, device='cuda:0')
distance 2 is tensor(10.6076, device='cuda:0')
benign distance is  tensor(10.6076, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  1.2196714207530022
distance 1 is tensor(200.4580, device='cuda:0')
distance 2 is tensor(14.4548, device='cuda:0')
benign distance is  tensor(14.4548, device='cuda:0')
norm1 res is  tensor(0.1810, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.6975958170369267
distance 1 is tensor(150.6682, device='cuda:0')
distance 2 is tensor(11.2796, device='cuda:0')
benign distance is  tensor(11.2796, device='cuda:0')
norm1 res is  tensor(0.1855, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.40661258995533
distance 1 is tensor(119.8634, device='cuda:0')
distance 2 is tensor(9.0173, device='cuda:0')
benign distance is  tensor(9.0173, device='cuda:0')
norm1 res is  tensor(0.1684, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.7319083958864212
distance 1 is tensor(183.9593, device='cuda:0')
distance 2 is tensor(13.3139, device='cuda:0')
benign distance is  tensor(13.3139, device='cuda:0')
norm1 res is  tensor(0.1774, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.624454915523529
distance 1 is tensor(142.3567, device='cuda:0')
distance 2 is tensor(10.3977, device='cuda:0')
benign distance is  tensor(10.3977, device='cuda:0')
norm1 res is  tensor(0.1060, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.786002866923809
distance 1 is tensor(131.2182, device='cuda:0')
distance 2 is tensor(9.5585, device='cuda:0')
benign distance is  tensor(9.5585, device='cuda:0')
norm1 res is  tensor(0.1354, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.8196761608123779
distance 1 is tensor(98.9434, device='cuda:0')
distance 2 is tensor(7.4142, device='cuda:0')
benign distance is  tensor(7.4142, device='cuda:0')
norm1 res is  tensor(0.1248, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.9112590327858925
distance 1 is tensor(103.0717, device='cuda:0')
distance 2 is tensor(7.7814, device='cuda:0')
benign distance is  tensor(7.7814, device='cuda:0')
norm1 res is  tensor(0.2094, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6249607130885124
distance 1 is tensor(131.6747, device='cuda:0')
distance 2 is tensor(9.8286, device='cuda:0')
benign distance is  tensor(9.8286, device='cuda:0')
norm1 res is  tensor(0.1573, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.1246833987534046
distance 1 is tensor(128.0219, device='cuda:0')
distance 2 is tensor(9.6328, device='cuda:0')
benign distance is  tensor(9.6328, device='cuda:0')
norm1 res is  tensor(0.1318, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.7239171639084816
distance 1 is tensor(149.7256, device='cuda:0')
distance 2 is tensor(11.2428, device='cuda:0')
benign distance is  tensor(11.2428, device='cuda:0')
norm1 res is  tensor(0.1508, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.4999481923878193
distance 1 is tensor(178.8315, device='cuda:0')
distance 2 is tensor(13.1519, device='cuda:0')
benign distance is  tensor(13.1519, device='cuda:0')
norm1 res is  tensor(0.1231, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  1.005550004541874
distance 1 is tensor(108.5384, device='cuda:0')
distance 2 is tensor(8.3137, device='cuda:0')
benign distance is  tensor(8.3137, device='cuda:0')
norm1 res is  tensor(0.2553, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.8915847614407539
distance 1 is tensor(194.2698, device='cuda:0')
distance 2 is tensor(14.2077, device='cuda:0')
benign distance is  tensor(14.2077, device='cuda:0')
norm1 res is  tensor(0.1845, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.9932466894388199
distance 1 is tensor(150.8532, device='cuda:0')
distance 2 is tensor(10.9978, device='cuda:0')
benign distance is  tensor(10.9978, device='cuda:0')
norm1 res is  tensor(0.1810, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8167518377304077
distance 1 is tensor(109.8555, device='cuda:0')
distance 2 is tensor(8.2239, device='cuda:0')
benign distance is  tensor(8.2239, device='cuda:0')
norm1 res is  tensor(0.1513, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5185633115470409
distance 1 is tensor(157.8906, device='cuda:0')
distance 2 is tensor(11.5032, device='cuda:0')
benign distance is  tensor(11.5032, device='cuda:0')
norm1 res is  tensor(0.1726, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(307.5885, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(347.2952, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(455.0273, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(679.5165, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(326.4306, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(370.6260, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(450.0151, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(288.8124, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4717.1812, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4757.2207, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4744.8354, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4725.5435, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4735.8770, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4755.7354, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4746.6030, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4727.2559, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4735.3042, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4731.4082, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4725.8550, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4782.1470, device='cuda:0')
norm_2 is  tensor(368.8518, device='cuda:0')
norm_2 * lamda is tensor(663.9332, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 84.47% 

Test Accuracy: 87.97% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7699974980205297
distance 1 is tensor(105.3267, device='cuda:0')
distance 2 is tensor(7.8508, device='cuda:0')
benign distance is  tensor(7.8508, device='cuda:0')
norm1 res is  tensor(0.0853, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7954978551715612
distance 1 is tensor(103.6277, device='cuda:0')
distance 2 is tensor(7.6420, device='cuda:0')
benign distance is  tensor(7.6420, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.78814503736794
distance 1 is tensor(113.7991, device='cuda:0')
distance 2 is tensor(8.3686, device='cuda:0')
benign distance is  tensor(8.3686, device='cuda:0')
norm1 res is  tensor(0.2115, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.9432525336742401
distance 1 is tensor(138.9039, device='cuda:0')
distance 2 is tensor(10.1134, device='cuda:0')
benign distance is  tensor(10.1134, device='cuda:0')
norm1 res is  tensor(0.0966, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.102274289354682
distance 1 is tensor(123.9468, device='cuda:0')
distance 2 is tensor(9.0494, device='cuda:0')
benign distance is  tensor(9.0494, device='cuda:0')
norm1 res is  tensor(0.1315, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7746523171663284
distance 1 is tensor(78.0987, device='cuda:0')
distance 2 is tensor(5.7782, device='cuda:0')
benign distance is  tensor(5.7782, device='cuda:0')
norm1 res is  tensor(0.1294, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4265855699777603
distance 1 is tensor(105.0918, device='cuda:0')
distance 2 is tensor(7.8650, device='cuda:0')
benign distance is  tensor(7.8650, device='cuda:0')
norm1 res is  tensor(0.1260, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8983634077012539
distance 1 is tensor(92.8057, device='cuda:0')
distance 2 is tensor(6.8455, device='cuda:0')
benign distance is  tensor(6.8455, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(450.3898, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(454.9695, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(498.3832, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(609.0710, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(539.1293, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(335.2469, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(460.5457, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(400.8529, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4744.2417, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4801.0073, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4757.5571, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4754.6802, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4754.0151, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4778.0884, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4777.3521, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4762.6221, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4768.3105, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4756.5391, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4754.7158, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4841.8135, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(497.9107, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(535.8270, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(287.9503, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(495.9379, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(780.3791, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(257.7424, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(605.5803, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(584.3077, device='cuda:0')
norm_2 is  tensor(405.3903, device='cuda:0')
norm_2 * lamda is tensor(729.7025, device='cuda:0')
satisfying 27
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 83.89% 

Test Accuracy: 87.79% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6573262503370643
distance 1 is tensor(92.8996, device='cuda:0')
distance 2 is tensor(6.9953, device='cuda:0')
benign distance is  tensor(6.9953, device='cuda:0')
norm1 res is  tensor(0.0796, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9349595196545124
distance 1 is tensor(88.2384, device='cuda:0')
distance 2 is tensor(6.5847, device='cuda:0')
benign distance is  tensor(6.5847, device='cuda:0')
norm1 res is  tensor(0.1177, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9510662779211998
distance 1 is tensor(106.0588, device='cuda:0')
distance 2 is tensor(7.8859, device='cuda:0')
benign distance is  tensor(7.8859, device='cuda:0')
norm1 res is  tensor(0.2004, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3021274022758007
distance 1 is tensor(161.7171, device='cuda:0')
distance 2 is tensor(11.7016, device='cuda:0')
benign distance is  tensor(11.7016, device='cuda:0')
norm1 res is  tensor(0.1144, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8057640679180622
distance 1 is tensor(87.9138, device='cuda:0')
distance 2 is tensor(6.5210, device='cuda:0')
benign distance is  tensor(6.5210, device='cuda:0')
norm1 res is  tensor(0.0897, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7593711190856993
distance 1 is tensor(88.3509, device='cuda:0')
distance 2 is tensor(6.6026, device='cuda:0')
benign distance is  tensor(6.6026, device='cuda:0')
norm1 res is  tensor(0.1500, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.5679024457931519
distance 1 is tensor(73.5413, device='cuda:0')
distance 2 is tensor(5.5979, device='cuda:0')
benign distance is  tensor(5.5979, device='cuda:0')
norm1 res is  tensor(0.0843, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.9138241969048977
distance 1 is tensor(68.0259, device='cuda:0')
distance 2 is tensor(5.1248, device='cuda:0')
benign distance is  tensor(5.1248, device='cuda:0')
norm1 res is  tensor(0.1118, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.2258149459958076
distance 1 is tensor(115.8795, device='cuda:0')
distance 2 is tensor(8.5162, device='cuda:0')
benign distance is  tensor(8.5162, device='cuda:0')
norm1 res is  tensor(0.1288, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.652869594283402
distance 1 is tensor(145.6274, device='cuda:0')
distance 2 is tensor(10.6710, device='cuda:0')
benign distance is  tensor(10.6710, device='cuda:0')
norm1 res is  tensor(0.1580, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0896074399352074
distance 1 is tensor(61.2696, device='cuda:0')
distance 2 is tensor(4.9830, device='cuda:0')
benign distance is  tensor(4.9830, device='cuda:0')
norm1 res is  tensor(0.0862, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0282756239175797
distance 1 is tensor(105.0421, device='cuda:0')
distance 2 is tensor(8.0267, device='cuda:0')
benign distance is  tensor(8.0267, device='cuda:0')
norm1 res is  tensor(0.1113, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.2238102555274963
distance 1 is tensor(202.3611, device='cuda:0')
distance 2 is tensor(14.5552, device='cuda:0')
benign distance is  tensor(14.5552, device='cuda:0')
norm1 res is  tensor(0.1315, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7023144289851189
distance 1 is tensor(42.4004, device='cuda:0')
distance 2 is tensor(3.3545, device='cuda:0')
benign distance is  tensor(3.3545, device='cuda:0')
norm1 res is  tensor(0.1152, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.399357009679079
distance 1 is tensor(150.0130, device='cuda:0')
distance 2 is tensor(10.7353, device='cuda:0')
benign distance is  tensor(10.7353, device='cuda:0')
norm1 res is  tensor(0.1458, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.4303866885602474
distance 1 is tensor(133.5375, device='cuda:0')
distance 2 is tensor(9.9198, device='cuda:0')
benign distance is  tensor(9.9198, device='cuda:0')
norm1 res is  tensor(0.1300, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(414.0632, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(385.7923, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(475.8332, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(711.8711, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(370.3568, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(384.8543, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(318.2695, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(298.4448, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4758.8628, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4818.3491, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4773.3179, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4765.7642, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4773.8501, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4800.3325, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4801.2559, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4768.8950, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4799.8008, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4764.1030, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4777.2798, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4841.3516, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(438.4640, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(553.1874, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(596.8950, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(630.8743, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(452.4049, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1041.0854, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(684.7866, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(528.8149, device='cuda:0')
norm_2 is  tensor(352.3710, device='cuda:0')
norm_2 * lamda is tensor(634.2678, device='cuda:0')
satisfying 27
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 82.98% 

Test Accuracy: 87.75% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7243212815374136
distance 1 is tensor(67.1895, device='cuda:0')
distance 2 is tensor(5.2008, device='cuda:0')
benign distance is  tensor(5.2008, device='cuda:0')
norm1 res is  tensor(0.0557, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.826714413240552
distance 1 is tensor(86.8496, device='cuda:0')
distance 2 is tensor(6.4436, device='cuda:0')
benign distance is  tensor(6.4436, device='cuda:0')
norm1 res is  tensor(0.1153, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8212862834334373
distance 1 is tensor(97.8623, device='cuda:0')
distance 2 is tensor(7.4104, device='cuda:0')
benign distance is  tensor(7.4104, device='cuda:0')
norm1 res is  tensor(0.1834, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.2972616516053677
distance 1 is tensor(162.3720, device='cuda:0')
distance 2 is tensor(11.8141, device='cuda:0')
benign distance is  tensor(11.8141, device='cuda:0')
norm1 res is  tensor(0.1135, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9102099407464266
distance 1 is tensor(65.4951, device='cuda:0')
distance 2 is tensor(5.1421, device='cuda:0')
benign distance is  tensor(5.1421, device='cuda:0')
norm1 res is  tensor(0.0700, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7785726767033339
distance 1 is tensor(100.9446, device='cuda:0')
distance 2 is tensor(7.3008, device='cuda:0')
benign distance is  tensor(7.3008, device='cuda:0')
norm1 res is  tensor(0.1668, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.524321023374796
distance 1 is tensor(107.2908, device='cuda:0')
distance 2 is tensor(8.0841, device='cuda:0')
benign distance is  tensor(8.0841, device='cuda:0')
norm1 res is  tensor(0.1271, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8391663078218699
distance 1 is tensor(90.7258, device='cuda:0')
distance 2 is tensor(6.8368, device='cuda:0')
benign distance is  tensor(6.8368, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.354502409696579
distance 1 is tensor(166.3484, device='cuda:0')
distance 2 is tensor(12.7226, device='cuda:0')
benign distance is  tensor(12.7226, device='cuda:0')
norm1 res is  tensor(0.2503, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9172674361616373
distance 1 is tensor(136.9983, device='cuda:0')
distance 2 is tensor(10.2674, device='cuda:0')
benign distance is  tensor(10.2674, device='cuda:0')
norm1 res is  tensor(0.1798, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.1977733094245195
distance 1 is tensor(138.2797, device='cuda:0')
distance 2 is tensor(10.2783, device='cuda:0')
benign distance is  tensor(10.2783, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.0886836312711239
distance 1 is tensor(145.8751, device='cuda:0')
distance 2 is tensor(10.7024, device='cuda:0')
benign distance is  tensor(10.7024, device='cuda:0')
norm1 res is  tensor(0.1317, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.135763943195343
distance 1 is tensor(79.8640, device='cuda:0')
distance 2 is tensor(5.9605, device='cuda:0')
benign distance is  tensor(5.9605, device='cuda:0')
norm1 res is  tensor(0.1004, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.3136854358017445
distance 1 is tensor(246.1769, device='cuda:0')
distance 2 is tensor(17.7812, device='cuda:0')
benign distance is  tensor(17.7812, device='cuda:0')
norm1 res is  tensor(0.1338, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.0599652603268623
distance 1 is tensor(144.5177, device='cuda:0')
distance 2 is tensor(10.7454, device='cuda:0')
benign distance is  tensor(10.7454, device='cuda:0')
norm1 res is  tensor(0.0964, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.9701761230826378
distance 1 is tensor(116.3043, device='cuda:0')
distance 2 is tensor(8.5645, device='cuda:0')
benign distance is  tensor(8.5645, device='cuda:0')
norm1 res is  tensor(0.1020, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(295.1246, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(379.5922, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(432.8743, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(715.8815, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(286.4061, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(424.4689, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(474.9447, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(396.2133, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4758.8481, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4821.1357, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4773.9238, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4811.7769, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4767.4609, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4803.0273, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4804.2280, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4771.7822, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4789.4741, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4775.5659, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4796.6538, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4831.0210, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(568.0208, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(444.6604, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(725.3747, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(584.8936, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(626.7466, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(601.3768, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(638.8902, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(892.7809, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(513.2294, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(661.4848, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(300.6142, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(481.9204, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(888.2718, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(215.7248, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(659.4787, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(596.0478, device='cuda:0')
norm_2 is  tensor(299.2685, device='cuda:0')
norm_2 * lamda is tensor(538.6832, device='cuda:0')
do  not satisfying 35
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 81.76% 

Test Accuracy: 87.25% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
 benign loss is  0.805068027228117
distance 1 is tensor(79.8040, device='cuda:0')
distance 2 is tensor(6.1238, device='cuda:0')
benign distance is  tensor(6.1238, device='cuda:0')
norm1 res is  tensor(0.0660, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8101733829826117
distance 1 is tensor(92.7819, device='cuda:0')
distance 2 is tensor(6.9752, device='cuda:0')
benign distance is  tensor(6.9752, device='cuda:0')
norm1 res is  tensor(0.1290, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9676903951913118
distance 1 is tensor(103.4073, device='cuda:0')
distance 2 is tensor(7.6766, device='cuda:0')
benign distance is  tensor(7.6766, device='cuda:0')
norm1 res is  tensor(0.1948, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1870492324233055
distance 1 is tensor(182.6462, device='cuda:0')
distance 2 is tensor(13.2908, device='cuda:0')
benign distance is  tensor(13.2908, device='cuda:0')
norm1 res is  tensor(0.1260, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8972927182912827
distance 1 is tensor(115.4109, device='cuda:0')
distance 2 is tensor(8.6723, device='cuda:0')
benign distance is  tensor(8.6723, device='cuda:0')
norm1 res is  tensor(0.1236, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7121795942075551
distance 1 is tensor(72.9136, device='cuda:0')
distance 2 is tensor(5.4215, device='cuda:0')
benign distance is  tensor(5.4215, device='cuda:0')
norm1 res is  tensor(0.1224, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.3611589204519987
distance 1 is tensor(70.2921, device='cuda:0')
distance 2 is tensor(5.5021, device='cuda:0')
benign distance is  tensor(5.5021, device='cuda:0')
norm1 res is  tensor(0.0850, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.9685572572052479
distance 1 is tensor(75.8618, device='cuda:0')
distance 2 is tensor(5.5994, device='cuda:0')
benign distance is  tensor(5.5994, device='cuda:0')
norm1 res is  tensor(0.1243, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.5420513823628426
distance 1 is tensor(130.9945, device='cuda:0')
distance 2 is tensor(9.7835, device='cuda:0')
benign distance is  tensor(9.7835, device='cuda:0')
norm1 res is  tensor(0.1489, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0060361176729202
distance 1 is tensor(147.1520, device='cuda:0')
distance 2 is tensor(10.7977, device='cuda:0')
benign distance is  tensor(10.7977, device='cuda:0')
norm1 res is  tensor(0.1603, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.1004894208163023
distance 1 is tensor(75.1701, device='cuda:0')
distance 2 is tensor(5.9262, device='cuda:0')
benign distance is  tensor(5.9262, device='cuda:0')
norm1 res is  tensor(0.1010, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.4177295416593552
distance 1 is tensor(124.2137, device='cuda:0')
distance 2 is tensor(9.3398, device='cuda:0')
benign distance is  tensor(9.3398, device='cuda:0')
norm1 res is  tensor(0.1286, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.6598986834287643
distance 1 is tensor(175.8300, device='cuda:0')
distance 2 is tensor(12.7422, device='cuda:0')
benign distance is  tensor(12.7422, device='cuda:0')
norm1 res is  tensor(0.1159, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7983523923903704
distance 1 is tensor(47.9371, device='cuda:0')
distance 2 is tensor(3.7882, device='cuda:0')
benign distance is  tensor(3.7882, device='cuda:0')
norm1 res is  tensor(0.1306, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.582668237388134
distance 1 is tensor(166.5270, device='cuda:0')
distance 2 is tensor(12.1356, device='cuda:0')
benign distance is  tensor(12.1356, device='cuda:0')
norm1 res is  tensor(0.1620, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.5094991996884346
distance 1 is tensor(140.6208, device='cuda:0')
distance 2 is tensor(10.4476, device='cuda:0')
benign distance is  tensor(10.4476, device='cuda:0')
norm1 res is  tensor(0.1355, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.224439412355423
distance 1 is tensor(151.8685, device='cuda:0')
distance 2 is tensor(11.4549, device='cuda:0')
benign distance is  tensor(11.4549, device='cuda:0')
norm1 res is  tensor(0.1683, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.9241655729711056
distance 1 is tensor(96.2647, device='cuda:0')
distance 2 is tensor(7.2487, device='cuda:0')
benign distance is  tensor(7.2487, device='cuda:0')
norm1 res is  tensor(0.2703, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.2125844415277243
distance 1 is tensor(171.2633, device='cuda:0')
distance 2 is tensor(12.4611, device='cuda:0')
benign distance is  tensor(12.4611, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.3080610949546099
distance 1 is tensor(140.3004, device='cuda:0')
distance 2 is tensor(10.3849, device='cuda:0')
benign distance is  tensor(10.3849, device='cuda:0')
norm1 res is  tensor(0.1528, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.0552912838757038
distance 1 is tensor(160.6129, device='cuda:0')
distance 2 is tensor(11.7674, device='cuda:0')
benign distance is  tensor(11.7674, device='cuda:0')
norm1 res is  tensor(0.1808, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  1.066082799807191
distance 1 is tensor(147.0271, device='cuda:0')
distance 2 is tensor(10.8430, device='cuda:0')
benign distance is  tensor(10.8430, device='cuda:0')
norm1 res is  tensor(0.1546, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5233481545001268
distance 1 is tensor(148.7974, device='cuda:0')
distance 2 is tensor(10.8300, device='cuda:0')
benign distance is  tensor(10.8300, device='cuda:0')
norm1 res is  tensor(0.1655, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  1.0084940697997808
distance 1 is tensor(212.8070, device='cuda:0')
distance 2 is tensor(15.3630, device='cuda:0')
benign distance is  tensor(15.3630, device='cuda:0')
norm1 res is  tensor(0.1877, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(348.3605, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(409.6664, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(453.0780, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(797.4133, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(510.9618, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(309.6288, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(318.1653, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(314.2602, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4773.8286, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4812.7065, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4784.3599, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4789.4150, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4778.9785, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4822.4668, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4808.5752, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4794.5166, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4817.2817, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4785.5288, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4813.8120, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4849.5083, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(683.0456, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(557.2504, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(806.5696, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(627.2048, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(564.7333, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(456.2549, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(475.8220, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(587.7401, device='cuda:0')
norm_2 is  tensor(484.6541, device='cuda:0')
norm_2 * lamda is tensor(872.3773, device='cuda:0')
satisfying 27
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 86.59% 

Test Accuracy: 88.45% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
 benign loss is  0.641161972656846
distance 1 is tensor(76.6667, device='cuda:0')
distance 2 is tensor(5.8617, device='cuda:0')
benign distance is  tensor(5.8617, device='cuda:0')
norm1 res is  tensor(0.0656, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9136017747223377
distance 1 is tensor(87.9556, device='cuda:0')
distance 2 is tensor(6.7301, device='cuda:0')
benign distance is  tensor(6.7301, device='cuda:0')
norm1 res is  tensor(0.1217, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8593312613666058
distance 1 is tensor(114.9272, device='cuda:0')
distance 2 is tensor(8.4228, device='cuda:0')
benign distance is  tensor(8.4228, device='cuda:0')
norm1 res is  tensor(0.2211, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3769317641854286
distance 1 is tensor(152.5405, device='cuda:0')
distance 2 is tensor(11.1401, device='cuda:0')
benign distance is  tensor(11.1401, device='cuda:0')
norm1 res is  tensor(0.1050, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8308334536850452
distance 1 is tensor(76.2239, device='cuda:0')
distance 2 is tensor(5.8197, device='cuda:0')
benign distance is  tensor(5.8197, device='cuda:0')
norm1 res is  tensor(0.0791, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6183016051072627
distance 1 is tensor(75.6690, device='cuda:0')
distance 2 is tensor(5.6398, device='cuda:0')
benign distance is  tensor(5.6398, device='cuda:0')
norm1 res is  tensor(0.1280, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1911994069814682
distance 1 is tensor(92.4926, device='cuda:0')
distance 2 is tensor(6.8496, device='cuda:0')
benign distance is  tensor(6.8496, device='cuda:0')
norm1 res is  tensor(0.1073, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7467653453350067
distance 1 is tensor(63.5210, device='cuda:0')
distance 2 is tensor(4.8836, device='cuda:0')
benign distance is  tensor(4.8836, device='cuda:0')
norm1 res is  tensor(0.1033, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7472882624715567
distance 1 is tensor(151.8911, device='cuda:0')
distance 2 is tensor(11.4189, device='cuda:0')
benign distance is  tensor(11.4189, device='cuda:0')
norm1 res is  tensor(0.1882, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.075781513005495
distance 1 is tensor(113.6415, device='cuda:0')
distance 2 is tensor(8.3922, device='cuda:0')
benign distance is  tensor(8.3922, device='cuda:0')
norm1 res is  tensor(0.1552, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.8541311789304018
distance 1 is tensor(169.0503, device='cuda:0')
distance 2 is tensor(12.2818, device='cuda:0')
benign distance is  tensor(12.2818, device='cuda:0')
norm1 res is  tensor(0.1652, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.405809786170721
distance 1 is tensor(156.7041, device='cuda:0')
distance 2 is tensor(11.4234, device='cuda:0')
benign distance is  tensor(11.4234, device='cuda:0')
norm1 res is  tensor(0.1166, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.6821307642385364
distance 1 is tensor(131.4496, device='cuda:0')
distance 2 is tensor(9.7866, device='cuda:0')
benign distance is  tensor(9.7866, device='cuda:0')
norm1 res is  tensor(0.1383, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.8088016882538795
distance 1 is tensor(98.7995, device='cuda:0')
distance 2 is tensor(7.4002, device='cuda:0')
benign distance is  tensor(7.4002, device='cuda:0')
norm1 res is  tensor(0.1248, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  1.0121307671070099
distance 1 is tensor(103.2427, device='cuda:0')
distance 2 is tensor(7.7656, device='cuda:0')
benign distance is  tensor(7.7656, device='cuda:0')
norm1 res is  tensor(0.2097, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6806126795709133
distance 1 is tensor(144.6312, device='cuda:0')
distance 2 is tensor(10.8336, device='cuda:0')
benign distance is  tensor(10.8336, device='cuda:0')
norm1 res is  tensor(0.1802, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(337.7364, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(392.0196, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(495.6339, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(669.5895, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(325.9224, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(333.4637, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(393.1140, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(276.3983, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4768.1816, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4814.1699, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4781.7871, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4774.9316, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4775.5557, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4802.7515, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4809.2192, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4776.8857, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4800.3359, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4774.4448, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4785.2280, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4823.1099, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(573.9037, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(668.6067, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(775.8771, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(495.4041, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(859.8108, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(665.4363, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(492.2799, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(682.4092, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(759.6821, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(621.8716, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(613.9236, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(639.0189, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(359.8709, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1085.5610, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(655.6280, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(531.4847, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(591.7825, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(653.4323, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(350.1856, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(565.9692, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(781.5042, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(246.4982, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(728.6178, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(625.1857, device='cuda:0')
norm_2 is  tensor(353.4688, device='cuda:0')
norm_2 * lamda is tensor(636.2438, device='cuda:0')
satisfying 43
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 83.74% 

Test Accuracy: 87.89% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8691906705498695
distance 1 is tensor(87.9846, device='cuda:0')
distance 2 is tensor(6.5692, device='cuda:0')
benign distance is  tensor(6.5692, device='cuda:0')
norm1 res is  tensor(0.0731, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7437229119241238
distance 1 is tensor(92.8520, device='cuda:0')
distance 2 is tensor(7.1491, device='cuda:0')
benign distance is  tensor(7.1491, device='cuda:0')
norm1 res is  tensor(0.1293, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.742304066196084
distance 1 is tensor(107.1008, device='cuda:0')
distance 2 is tensor(7.9555, device='cuda:0')
benign distance is  tensor(7.9555, device='cuda:0')
norm1 res is  tensor(0.1996, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.2034654133021832
distance 1 is tensor(143.1646, device='cuda:0')
distance 2 is tensor(10.5110, device='cuda:0')
benign distance is  tensor(10.5110, device='cuda:0')
norm1 res is  tensor(0.0987, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9647923624143004
distance 1 is tensor(63.9231, device='cuda:0')
distance 2 is tensor(4.9859, device='cuda:0')
benign distance is  tensor(4.9859, device='cuda:0')
norm1 res is  tensor(0.0666, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7394263362511992
distance 1 is tensor(86.5646, device='cuda:0')
distance 2 is tensor(6.3267, device='cuda:0')
benign distance is  tensor(6.3267, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2506583947688341
distance 1 is tensor(72.9916, device='cuda:0')
distance 2 is tensor(5.5626, device='cuda:0')
benign distance is  tensor(5.5626, device='cuda:0')
norm1 res is  tensor(0.0825, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6225561392493546
distance 1 is tensor(70.8767, device='cuda:0')
distance 2 is tensor(5.3397, device='cuda:0')
benign distance is  tensor(5.3397, device='cuda:0')
norm1 res is  tensor(0.1116, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.2468453794717789
distance 1 is tensor(104.2073, device='cuda:0')
distance 2 is tensor(7.7311, device='cuda:0')
benign distance is  tensor(7.7311, device='cuda:0')
norm1 res is  tensor(0.1162, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9977696035057306
distance 1 is tensor(142.4117, device='cuda:0')
distance 2 is tensor(10.6497, device='cuda:0')
benign distance is  tensor(10.6497, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.8887849673628807
distance 1 is tensor(54.3641, device='cuda:0')
distance 2 is tensor(4.2722, device='cuda:0')
benign distance is  tensor(4.2722, device='cuda:0')
norm1 res is  tensor(0.0738, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.2392102256417274
distance 1 is tensor(132.7519, device='cuda:0')
distance 2 is tensor(9.7997, device='cuda:0')
benign distance is  tensor(9.7997, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.5130744092166424
distance 1 is tensor(181.5172, device='cuda:0')
distance 2 is tensor(13.2457, device='cuda:0')
benign distance is  tensor(13.2457, device='cuda:0')
norm1 res is  tensor(0.1236, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7125872224569321
distance 1 is tensor(53.2195, device='cuda:0')
distance 2 is tensor(3.9898, device='cuda:0')
benign distance is  tensor(3.9898, device='cuda:0')
norm1 res is  tensor(0.1380, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.6421632543206215
distance 1 is tensor(141.9321, device='cuda:0')
distance 2 is tensor(10.1608, device='cuda:0')
benign distance is  tensor(10.1608, device='cuda:0')
norm1 res is  tensor(0.1372, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.3494766280055046
distance 1 is tensor(134.5504, device='cuda:0')
distance 2 is tensor(10.0216, device='cuda:0')
benign distance is  tensor(10.0216, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.1020614318549633
distance 1 is tensor(111.2264, device='cuda:0')
distance 2 is tensor(8.3556, device='cuda:0')
benign distance is  tensor(8.3556, device='cuda:0')
norm1 res is  tensor(0.1638, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.8093077298253775
distance 1 is tensor(119.1023, device='cuda:0')
distance 2 is tensor(8.9070, device='cuda:0')
benign distance is  tensor(8.9070, device='cuda:0')
norm1 res is  tensor(0.1550, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.1087598148733377
distance 1 is tensor(138.6062, device='cuda:0')
distance 2 is tensor(10.0950, device='cuda:0')
benign distance is  tensor(10.0950, device='cuda:0')
norm1 res is  tensor(0.1365, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.863856315612793
distance 1 is tensor(136.4497, device='cuda:0')
distance 2 is tensor(10.2495, device='cuda:0')
benign distance is  tensor(10.2495, device='cuda:0')
norm1 res is  tensor(0.1247, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.8984817154705524
distance 1 is tensor(74.8361, device='cuda:0')
distance 2 is tensor(5.6300, device='cuda:0')
benign distance is  tensor(5.6300, device='cuda:0')
norm1 res is  tensor(0.1012, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9005026053637266
distance 1 is tensor(233.3819, device='cuda:0')
distance 2 is tensor(16.7893, device='cuda:0')
benign distance is  tensor(16.7893, device='cuda:0')
norm1 res is  tensor(0.1260, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.2091495543718338
distance 1 is tensor(153.7727, device='cuda:0')
distance 2 is tensor(11.3675, device='cuda:0')
benign distance is  tensor(11.3675, device='cuda:0')
norm1 res is  tensor(0.0999, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.1689265575259924
distance 1 is tensor(118.6120, device='cuda:0')
distance 2 is tensor(8.6851, device='cuda:0')
benign distance is  tensor(8.6851, device='cuda:0')
norm1 res is  tensor(0.1041, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.0750277154147625
distance 1 is tensor(128.2348, device='cuda:0')
distance 2 is tensor(9.7598, device='cuda:0')
benign distance is  tensor(9.7598, device='cuda:0')
norm1 res is  tensor(0.1334, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.516370452940464
distance 1 is tensor(165.2966, device='cuda:0')
distance 2 is tensor(12.4747, device='cuda:0')
benign distance is  tensor(12.4747, device='cuda:0')
norm1 res is  tensor(0.1634, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.3299077153205872
distance 1 is tensor(167.1072, device='cuda:0')
distance 2 is tensor(12.3928, device='cuda:0')
benign distance is  tensor(12.3928, device='cuda:0')
norm1 res is  tensor(0.1176, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.905870471149683
distance 1 is tensor(113.6511, device='cuda:0')
distance 2 is tensor(8.7892, device='cuda:0')
benign distance is  tensor(8.7892, device='cuda:0')
norm1 res is  tensor(0.2719, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.8725560791790485
distance 1 is tensor(190.0591, device='cuda:0')
distance 2 is tensor(13.7962, device='cuda:0')
benign distance is  tensor(13.7962, device='cuda:0')
norm1 res is  tensor(0.1835, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.9466803129762411
distance 1 is tensor(169.8739, device='cuda:0')
distance 2 is tensor(12.1975, device='cuda:0')
benign distance is  tensor(12.1975, device='cuda:0')
norm1 res is  tensor(0.2054, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  1.0504858046770096
distance 1 is tensor(119.5537, device='cuda:0')
distance 2 is tensor(8.8900, device='cuda:0')
benign distance is  tensor(8.8900, device='cuda:0')
norm1 res is  tensor(0.1627, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.4831637106835842
distance 1 is tensor(160.8359, device='cuda:0')
distance 2 is tensor(11.7625, device='cuda:0')
benign distance is  tensor(11.7625, device='cuda:0')
norm1 res is  tensor(0.1755, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(376.0625, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(420.1142, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(471.7019, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(629.2727, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(271.1187, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(363.2842, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(310.2166, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(304.7175, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4780.2295, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4835.1846, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4834.3667, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4785.3223, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4787.3062, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4807.6104, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4803.0498, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4787.0029, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4800.5796, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4793.2051, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4793.2490, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4859.6172, device='cuda:0')
norm_2 is  tensor(456.2247, device='cuda:0')
norm_2 * lamda is tensor(821.2044, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 85.34% 

Test Accuracy: 88.20% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6600217018276453
distance 1 is tensor(69.9861, device='cuda:0')
distance 2 is tensor(5.3847, device='cuda:0')
benign distance is  tensor(5.3847, device='cuda:0')
norm1 res is  tensor(0.0591, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8162128739058971
distance 1 is tensor(79.8871, device='cuda:0')
distance 2 is tensor(6.0380, device='cuda:0')
benign distance is  tensor(6.0380, device='cuda:0')
norm1 res is  tensor(0.1098, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7948867622762918
distance 1 is tensor(97.0199, device='cuda:0')
distance 2 is tensor(7.2160, device='cuda:0')
benign distance is  tensor(7.2160, device='cuda:0')
norm1 res is  tensor(0.1854, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1858252100646496
distance 1 is tensor(154.7833, device='cuda:0')
distance 2 is tensor(11.2701, device='cuda:0')
benign distance is  tensor(11.2701, device='cuda:0')
norm1 res is  tensor(0.1098, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8612100873142481
distance 1 is tensor(58.2577, device='cuda:0')
distance 2 is tensor(4.6743, device='cuda:0')
benign distance is  tensor(4.6743, device='cuda:0')
norm1 res is  tensor(0.0648, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7049492001533508
distance 1 is tensor(98.5776, device='cuda:0')
distance 2 is tensor(7.2418, device='cuda:0')
benign distance is  tensor(7.2418, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.6088060066103935
distance 1 is tensor(78.7903, device='cuda:0')
distance 2 is tensor(6.0834, device='cuda:0')
benign distance is  tensor(6.0834, device='cuda:0')
norm1 res is  tensor(0.0946, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8921108320355415
distance 1 is tensor(62.3724, device='cuda:0')
distance 2 is tensor(4.9017, device='cuda:0')
benign distance is  tensor(4.9017, device='cuda:0')
norm1 res is  tensor(0.1058, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(310.3416, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(343.5096, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(426.0553, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(681.9505, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(264.9162, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(416.4950, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(349.0863, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(285.0848, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4800.7417, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4840.0845, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4820.4849, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4813.0195, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4824.6631, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4826.7983, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4841.5596, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4815.7349, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4834.7920, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4819.3496, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4827.2002, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4865.0811, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(687.9705, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(454.5612, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(756.4267, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(611.6314, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(712.4898, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(663.3531, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(659.2667, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(929.4371, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(472.7994, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(641.8917, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(265.0782, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(588.6296, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(817.2614, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(250.1806, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(620.3311, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(599.5017, device='cuda:0')
norm_2 is  tensor(355.1714, device='cuda:0')
norm_2 * lamda is tensor(639.3084, device='cuda:0')
satisfying 35
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 81.52% 

Test Accuracy: 87.24% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7594134826213121
distance 1 is tensor(86.6527, device='cuda:0')
distance 2 is tensor(6.6009, device='cuda:0')
benign distance is  tensor(6.6009, device='cuda:0')
norm1 res is  tensor(0.0732, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8586246650665998
distance 1 is tensor(102.4921, device='cuda:0')
distance 2 is tensor(7.5156, device='cuda:0')
benign distance is  tensor(7.5156, device='cuda:0')
norm1 res is  tensor(0.1393, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8495076708495617
distance 1 is tensor(79.2144, device='cuda:0')
distance 2 is tensor(5.9833, device='cuda:0')
benign distance is  tensor(5.9833, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.5522067174315453
distance 1 is tensor(158.9783, device='cuda:0')
distance 2 is tensor(11.6290, device='cuda:0')
benign distance is  tensor(11.6290, device='cuda:0')
norm1 res is  tensor(0.1120, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0408107750117779
distance 1 is tensor(73.0293, device='cuda:0')
distance 2 is tensor(5.7772, device='cuda:0')
benign distance is  tensor(5.7772, device='cuda:0')
norm1 res is  tensor(0.0808, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7290290743112564
distance 1 is tensor(71.9176, device='cuda:0')
distance 2 is tensor(5.5196, device='cuda:0')
benign distance is  tensor(5.5196, device='cuda:0')
norm1 res is  tensor(0.1220, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4335616454482079
distance 1 is tensor(82.1617, device='cuda:0')
distance 2 is tensor(6.5115, device='cuda:0')
benign distance is  tensor(6.5115, device='cuda:0')
norm1 res is  tensor(0.1068, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8028091434389353
distance 1 is tensor(70.8395, device='cuda:0')
distance 2 is tensor(5.3204, device='cuda:0')
benign distance is  tensor(5.3204, device='cuda:0')
norm1 res is  tensor(0.1161, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.2854874394834042
distance 1 is tensor(103.0963, device='cuda:0')
distance 2 is tensor(7.6581, device='cuda:0')
benign distance is  tensor(7.6581, device='cuda:0')
norm1 res is  tensor(0.1144, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9040893758647144
distance 1 is tensor(120.6179, device='cuda:0')
distance 2 is tensor(8.8467, device='cuda:0')
benign distance is  tensor(8.8467, device='cuda:0')
norm1 res is  tensor(0.1285, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9619200080633163
distance 1 is tensor(49.8284, device='cuda:0')
distance 2 is tensor(3.9772, device='cuda:0')
benign distance is  tensor(3.9772, device='cuda:0')
norm1 res is  tensor(0.0672, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0993130709975958
distance 1 is tensor(115.0424, device='cuda:0')
distance 2 is tensor(8.5227, device='cuda:0')
benign distance is  tensor(8.5227, device='cuda:0')
norm1 res is  tensor(0.1170, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.2138626500964165
distance 1 is tensor(192.3034, device='cuda:0')
distance 2 is tensor(13.8109, device='cuda:0')
benign distance is  tensor(13.8109, device='cuda:0')
norm1 res is  tensor(0.1248, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7005709037184715
distance 1 is tensor(49.9460, device='cuda:0')
distance 2 is tensor(3.8989, device='cuda:0')
benign distance is  tensor(3.8989, device='cuda:0')
norm1 res is  tensor(0.1339, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.3928178921341896
distance 1 is tensor(163.8031, device='cuda:0')
distance 2 is tensor(11.9413, device='cuda:0')
benign distance is  tensor(11.9413, device='cuda:0')
norm1 res is  tensor(0.1705, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.9589836224913597
distance 1 is tensor(138.0102, device='cuda:0')
distance 2 is tensor(10.0561, device='cuda:0')
benign distance is  tensor(10.0561, device='cuda:0')
norm1 res is  tensor(0.1335, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.9047033060342073
distance 1 is tensor(131.6553, device='cuda:0')
distance 2 is tensor(9.7362, device='cuda:0')
benign distance is  tensor(9.7362, device='cuda:0')
norm1 res is  tensor(0.1430, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  1.3547648824751377
distance 1 is tensor(112.5536, device='cuda:0')
distance 2 is tensor(8.4327, device='cuda:0')
benign distance is  tensor(8.4327, device='cuda:0')
norm1 res is  tensor(0.4643, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.0328571945428848
distance 1 is tensor(149.1021, device='cuda:0')
distance 2 is tensor(10.9672, device='cuda:0')
benign distance is  tensor(10.9672, device='cuda:0')
norm1 res is  tensor(0.1280, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.5716615952551365
distance 1 is tensor(146.8048, device='cuda:0')
distance 2 is tensor(10.8535, device='cuda:0')
benign distance is  tensor(10.8535, device='cuda:0')
norm1 res is  tensor(0.1639, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.9869550038129091
distance 1 is tensor(142.4538, device='cuda:0')
distance 2 is tensor(10.6161, device='cuda:0')
benign distance is  tensor(10.6161, device='cuda:0')
norm1 res is  tensor(0.1589, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.874454801902175
distance 1 is tensor(150.5633, device='cuda:0')
distance 2 is tensor(11.2072, device='cuda:0')
benign distance is  tensor(11.2072, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.6994573073461652
distance 1 is tensor(141.3532, device='cuda:0')
distance 2 is tensor(10.3191, device='cuda:0')
benign distance is  tensor(10.3191, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.9386575669050217
distance 1 is tensor(206.5874, device='cuda:0')
distance 2 is tensor(15.2106, device='cuda:0')
benign distance is  tensor(15.2106, device='cuda:0')
norm1 res is  tensor(0.1869, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(381.5458, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(453.9514, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(345.5022, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(706.4940, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(332.1777, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(316.5703, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(377.5183, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(301.0027, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4809.4678, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4861.7192, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4819.1860, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4825.9487, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4820.5776, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4836.0586, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4854.8887, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4820.5425, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4834.5107, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4826.2227, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4835.5093, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4879.4233, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(492.3391, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(539.7618, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(591.3246, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(606.4724, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(334.7336, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1022.7574, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(670.7938, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(532.9655, device='cuda:0')
norm_2 is  tensor(398.8621, device='cuda:0')
norm_2 * lamda is tensor(717.9517, device='cuda:0')
satisfying 27
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 81.57% 

Test Accuracy: 87.18% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6308588348329067
distance 1 is tensor(58.3445, device='cuda:0')
distance 2 is tensor(4.6161, device='cuda:0')
benign distance is  tensor(4.6161, device='cuda:0')
norm1 res is  tensor(0.0489, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8518472444266081
distance 1 is tensor(74.2908, device='cuda:0')
distance 2 is tensor(5.6400, device='cuda:0')
benign distance is  tensor(5.6400, device='cuda:0')
norm1 res is  tensor(0.1034, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.911106264218688
distance 1 is tensor(99.4986, device='cuda:0')
distance 2 is tensor(7.4142, device='cuda:0')
benign distance is  tensor(7.4142, device='cuda:0')
norm1 res is  tensor(0.1905, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1817101053893566
distance 1 is tensor(152.3460, device='cuda:0')
distance 2 is tensor(11.1240, device='cuda:0')
benign distance is  tensor(11.1240, device='cuda:0')
norm1 res is  tensor(0.1063, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8454422289505601
distance 1 is tensor(67.1730, device='cuda:0')
distance 2 is tensor(5.2753, device='cuda:0')
benign distance is  tensor(5.2753, device='cuda:0')
norm1 res is  tensor(0.0740, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.9791475962847471
distance 1 is tensor(73.7272, device='cuda:0')
distance 2 is tensor(5.4545, device='cuda:0')
benign distance is  tensor(5.4545, device='cuda:0')
norm1 res is  tensor(0.1183, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2915189638733864
distance 1 is tensor(56.2543, device='cuda:0')
distance 2 is tensor(4.3210, device='cuda:0')
benign distance is  tensor(4.3210, device='cuda:0')
norm1 res is  tensor(0.0637, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7868006229400635
distance 1 is tensor(68.2908, device='cuda:0')
distance 2 is tensor(5.1548, device='cuda:0')
benign distance is  tensor(5.1548, device='cuda:0')
norm1 res is  tensor(0.1083, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.0275741890072823
distance 1 is tensor(93.9030, device='cuda:0')
distance 2 is tensor(7.2545, device='cuda:0')
benign distance is  tensor(7.2545, device='cuda:0')
norm1 res is  tensor(0.1437, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7291017677634954
distance 1 is tensor(128.9238, device='cuda:0')
distance 2 is tensor(9.3716, device='cuda:0')
benign distance is  tensor(9.3716, device='cuda:0')
norm1 res is  tensor(0.1644, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.9020536728203297
distance 1 is tensor(125.2826, device='cuda:0')
distance 2 is tensor(9.2004, device='cuda:0')
benign distance is  tensor(9.2004, device='cuda:0')
norm1 res is  tensor(0.1270, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9269240442663431
distance 1 is tensor(131.8371, device='cuda:0')
distance 2 is tensor(9.8318, device='cuda:0')
benign distance is  tensor(9.8318, device='cuda:0')
norm1 res is  tensor(0.1205, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.2240496594458818
distance 1 is tensor(88.3505, device='cuda:0')
distance 2 is tensor(6.6046, device='cuda:0')
benign distance is  tensor(6.6046, device='cuda:0')
norm1 res is  tensor(0.1206, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9699523188173771
distance 1 is tensor(239.6677, device='cuda:0')
distance 2 is tensor(17.5134, device='cuda:0')
benign distance is  tensor(17.5134, device='cuda:0')
norm1 res is  tensor(0.1307, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.4693034812808037
distance 1 is tensor(155.7924, device='cuda:0')
distance 2 is tensor(11.3998, device='cuda:0')
benign distance is  tensor(11.3998, device='cuda:0')
norm1 res is  tensor(0.1019, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.7190655339509249
distance 1 is tensor(112.3678, device='cuda:0')
distance 2 is tensor(8.4311, device='cuda:0')
benign distance is  tensor(8.4311, device='cuda:0')
norm1 res is  tensor(0.1006, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(257.7771, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(329.7766, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(435.9058, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(664.1187, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(306.8719, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(310.6411, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(240.1030, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(290.1151, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4812.6758, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4856.6934, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4825.7383, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4849.7773, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4830.3164, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4846.1479, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4864.0962, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4837.7642, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4847.7593, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4834.6396, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4829.8765, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4890.0259, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(701.0009, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(520.8695, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(758.1790, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(701.3766, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(583.5325, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(461.2768, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(483.1005, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(674.5787, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(461.4513, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(538.4635, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(242.3599, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(511.0832, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(841.7393, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(244.2641, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(737.5252, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(607.6475, device='cuda:0')
norm_2 is  tensor(388.5286, device='cuda:0')
norm_2 * lamda is tensor(699.3515, device='cuda:0')
satisfying 35
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 84.17% 

Test Accuracy: 87.98% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7432047259062529
distance 1 is tensor(92.8348, device='cuda:0')
distance 2 is tensor(7.0103, device='cuda:0')
benign distance is  tensor(7.0103, device='cuda:0')
norm1 res is  tensor(0.0774, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9834164995700121
distance 1 is tensor(58.0499, device='cuda:0')
distance 2 is tensor(4.4987, device='cuda:0')
benign distance is  tensor(4.4987, device='cuda:0')
norm1 res is  tensor(0.0785, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7255935985594988
distance 1 is tensor(92.6083, device='cuda:0')
distance 2 is tensor(6.8879, device='cuda:0')
benign distance is  tensor(6.8879, device='cuda:0')
norm1 res is  tensor(0.1746, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3178913742303848
distance 1 is tensor(150.4024, device='cuda:0')
distance 2 is tensor(10.9319, device='cuda:0')
benign distance is  tensor(10.9319, device='cuda:0')
norm1 res is  tensor(0.1037, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9954739827662706
distance 1 is tensor(85.9682, device='cuda:0')
distance 2 is tensor(6.7454, device='cuda:0')
benign distance is  tensor(6.7454, device='cuda:0')
norm1 res is  tensor(0.0911, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8240216965787113
distance 1 is tensor(92.3860, device='cuda:0')
distance 2 is tensor(6.8033, device='cuda:0')
benign distance is  tensor(6.8033, device='cuda:0')
norm1 res is  tensor(0.1631, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.452766528353095
distance 1 is tensor(119.0221, device='cuda:0')
distance 2 is tensor(8.9263, device='cuda:0')
benign distance is  tensor(8.9263, device='cuda:0')
norm1 res is  tensor(0.1398, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6239493321627378
distance 1 is tensor(74.7366, device='cuda:0')
distance 2 is tensor(5.6523, device='cuda:0')
benign distance is  tensor(5.6523, device='cuda:0')
norm1 res is  tensor(0.1197, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.2271737065166235
distance 1 is tensor(125.5173, device='cuda:0')
distance 2 is tensor(9.2282, device='cuda:0')
benign distance is  tensor(9.2282, device='cuda:0')
norm1 res is  tensor(0.1400, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7624909859150648
distance 1 is tensor(162.6992, device='cuda:0')
distance 2 is tensor(11.7753, device='cuda:0')
benign distance is  tensor(11.7753, device='cuda:0')
norm1 res is  tensor(0.1724, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0429200120270252
distance 1 is tensor(74.8868, device='cuda:0')
distance 2 is tensor(5.7449, device='cuda:0')
benign distance is  tensor(5.7449, device='cuda:0')
norm1 res is  tensor(0.1024, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.664317898452282
distance 1 is tensor(115.7706, device='cuda:0')
distance 2 is tensor(8.6739, device='cuda:0')
benign distance is  tensor(8.6739, device='cuda:0')
norm1 res is  tensor(0.1194, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.468120101839304
distance 1 is tensor(189.3737, device='cuda:0')
distance 2 is tensor(13.6816, device='cuda:0')
benign distance is  tensor(13.6816, device='cuda:0')
norm1 res is  tensor(0.1249, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6975926756858826
distance 1 is tensor(69.9136, device='cuda:0')
distance 2 is tensor(5.2043, device='cuda:0')
benign distance is  tensor(5.2043, device='cuda:0')
norm1 res is  tensor(0.1872, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.3225971274077892
distance 1 is tensor(150.7750, device='cuda:0')
distance 2 is tensor(10.9291, device='cuda:0')
benign distance is  tensor(10.9291, device='cuda:0')
norm1 res is  tensor(0.1480, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.8215673454105854
distance 1 is tensor(138.7674, device='cuda:0')
distance 2 is tensor(10.3355, device='cuda:0')
benign distance is  tensor(10.3355, device='cuda:0')
norm1 res is  tensor(0.1365, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7290780413895845
distance 1 is tensor(152.5503, device='cuda:0')
distance 2 is tensor(11.5795, device='cuda:0')
benign distance is  tensor(11.5795, device='cuda:0')
norm1 res is  tensor(0.1874, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.218557946383953
distance 1 is tensor(130.0302, device='cuda:0')
distance 2 is tensor(9.7224, device='cuda:0')
benign distance is  tensor(9.7224, device='cuda:0')
norm1 res is  tensor(0.1803, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.6777180843055248
distance 1 is tensor(178.8095, device='cuda:0')
distance 2 is tensor(13.2361, device='cuda:0')
benign distance is  tensor(13.2361, device='cuda:0')
norm1 res is  tensor(0.1762, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.3181125186383724
distance 1 is tensor(147.4929, device='cuda:0')
distance 2 is tensor(10.7427, device='cuda:0')
benign distance is  tensor(10.7427, device='cuda:0')
norm1 res is  tensor(0.1104, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.7986108530312777
distance 1 is tensor(140.8480, device='cuda:0')
distance 2 is tensor(10.4982, device='cuda:0')
benign distance is  tensor(10.4982, device='cuda:0')
norm1 res is  tensor(0.1522, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.9141683550551534
distance 1 is tensor(104.7958, device='cuda:0')
distance 2 is tensor(7.8288, device='cuda:0')
benign distance is  tensor(7.8288, device='cuda:0')
norm1 res is  tensor(0.1333, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  1.0170208774507046
distance 1 is tensor(111.6252, device='cuda:0')
distance 2 is tensor(8.3717, device='cuda:0')
benign distance is  tensor(8.3717, device='cuda:0')
norm1 res is  tensor(0.2290, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.623199213296175
distance 1 is tensor(146.0900, device='cuda:0')
distance 2 is tensor(10.7645, device='cuda:0')
benign distance is  tensor(10.7645, device='cuda:0')
norm1 res is  tensor(0.1784, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(404.0199, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(252.6129, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(401.4728, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(654.0313, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(377.7281, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(406.1271, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(520.8582, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(323.8355, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4821.8643, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4864.8032, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4836.4297, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4823.7705, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4835.6758, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4846.2520, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4856.5659, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4827.9170, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4840.8477, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4831.0815, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4841.1011, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4890.1895, device='cuda:0')
norm_2 is  tensor(305.0601, device='cuda:0')
norm_2 * lamda is tensor(549.1082, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 87.09% 

Test Accuracy: 88.54% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7575914580374956
distance 1 is tensor(73.2207, device='cuda:0')
distance 2 is tensor(5.6799, device='cuda:0')
benign distance is  tensor(5.6799, device='cuda:0')
norm1 res is  tensor(0.0662, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9050074610859156
distance 1 is tensor(89.5997, device='cuda:0')
distance 2 is tensor(6.5972, device='cuda:0')
benign distance is  tensor(6.5972, device='cuda:0')
norm1 res is  tensor(0.1230, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8474832065403461
distance 1 is tensor(92.5996, device='cuda:0')
distance 2 is tensor(7.0064, device='cuda:0')
benign distance is  tensor(7.0064, device='cuda:0')
norm1 res is  tensor(0.1775, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.41043852083385
distance 1 is tensor(150.6100, device='cuda:0')
distance 2 is tensor(10.9934, device='cuda:0')
benign distance is  tensor(10.9934, device='cuda:0')
norm1 res is  tensor(0.1049, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0222866050899029
distance 1 is tensor(67.8720, device='cuda:0')
distance 2 is tensor(5.3463, device='cuda:0')
benign distance is  tensor(5.3463, device='cuda:0')
norm1 res is  tensor(0.0765, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7247591111809015
distance 1 is tensor(52.2829, device='cuda:0')
distance 2 is tensor(3.9504, device='cuda:0')
benign distance is  tensor(3.9504, device='cuda:0')
norm1 res is  tensor(0.0872, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.3971448466181755
distance 1 is tensor(85.2273, device='cuda:0')
distance 2 is tensor(6.2561, device='cuda:0')
benign distance is  tensor(6.2561, device='cuda:0')
norm1 res is  tensor(0.0946, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.9037770088762045
distance 1 is tensor(79.5986, device='cuda:0')
distance 2 is tensor(6.0404, device='cuda:0')
benign distance is  tensor(6.0404, device='cuda:0')
norm1 res is  tensor(0.1343, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(330.5729, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(394.6509, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(416.6447, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(667.4656, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(309.9940, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(226.6023, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(354.2165, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(355.1731, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4840.1016, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4894.5127, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4856.8896, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4870.1465, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4859.4038, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4887.0210, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4874.2930, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4855.7886, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4871.3130, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4855.0024, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4866.9668, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4919.8340, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(595.4064, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(743.8824, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(748.0405, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(539.7913, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(859.2510, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(758.4081, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(544.6969, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(708.8699, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(591.0320, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(518.9027, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(669.1275, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(668.0042, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(644.0262, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(685.8089, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(627.2961, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(928.9358, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(453.7648, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(582.5673, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(558.4279, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(598.1909, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(410.4109, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1065.9982, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(696.7998, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(518.7648, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(564.7177, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(714.9896, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(349.8486, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(522.9253, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(839.3132, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(312.0567, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(675.3832, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(624.0224, device='cuda:0')
norm_2 is  tensor(304.6216, device='cuda:0')
norm_2 * lamda is tensor(548.3188, device='cuda:0')
do  not satisfying 51
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 85.55% 

Test Accuracy: 88.15% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8541334643959999
distance 1 is tensor(92.7502, device='cuda:0')
distance 2 is tensor(7.1090, device='cuda:0')
benign distance is  tensor(7.1090, device='cuda:0')
norm1 res is  tensor(0.0803, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.0207880940288305
distance 1 is tensor(95.9534, device='cuda:0')
distance 2 is tensor(7.2257, device='cuda:0')
benign distance is  tensor(7.2257, device='cuda:0')
norm1 res is  tensor(0.1330, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7902110833674669
distance 1 is tensor(117.4427, device='cuda:0')
distance 2 is tensor(8.7579, device='cuda:0')
benign distance is  tensor(8.7579, device='cuda:0')
norm1 res is  tensor(0.2217, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3617608547210693
distance 1 is tensor(143.9362, device='cuda:0')
distance 2 is tensor(10.6250, device='cuda:0')
benign distance is  tensor(10.6250, device='cuda:0')
norm1 res is  tensor(0.1000, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0721491761505604
distance 1 is tensor(69.8443, device='cuda:0')
distance 2 is tensor(5.4532, device='cuda:0')
benign distance is  tensor(5.4532, device='cuda:0')
norm1 res is  tensor(0.0755, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7267015697434545
distance 1 is tensor(71.8490, device='cuda:0')
distance 2 is tensor(5.4346, device='cuda:0')
benign distance is  tensor(5.4346, device='cuda:0')
norm1 res is  tensor(0.1212, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.129448737949133
distance 1 is tensor(56.0528, device='cuda:0')
distance 2 is tensor(4.3505, device='cuda:0')
benign distance is  tensor(4.3505, device='cuda:0')
norm1 res is  tensor(0.0659, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6394688207656145
distance 1 is tensor(96.3351, device='cuda:0')
distance 2 is tensor(7.0082, device='cuda:0')
benign distance is  tensor(7.0082, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.8609305769205093
distance 1 is tensor(111.8015, device='cuda:0')
distance 2 is tensor(8.4258, device='cuda:0')
benign distance is  tensor(8.4258, device='cuda:0')
norm1 res is  tensor(0.1268, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7458197455853224
distance 1 is tensor(131.0598, device='cuda:0')
distance 2 is tensor(9.6143, device='cuda:0')
benign distance is  tensor(9.6143, device='cuda:0')
norm1 res is  tensor(0.1414, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.008353779092431
distance 1 is tensor(52.1518, device='cuda:0')
distance 2 is tensor(4.1880, device='cuda:0')
benign distance is  tensor(4.1880, device='cuda:0')
norm1 res is  tensor(0.0732, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3720815666019917
distance 1 is tensor(117.2693, device='cuda:0')
distance 2 is tensor(8.8769, device='cuda:0')
benign distance is  tensor(8.8769, device='cuda:0')
norm1 res is  tensor(0.1228, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.4302673637866974
distance 1 is tensor(192.0143, device='cuda:0')
distance 2 is tensor(13.7478, device='cuda:0')
benign distance is  tensor(13.7478, device='cuda:0')
norm1 res is  tensor(0.1450, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.691598093137145
distance 1 is tensor(43.5517, device='cuda:0')
distance 2 is tensor(3.3670, device='cuda:0')
benign distance is  tensor(3.3670, device='cuda:0')
norm1 res is  tensor(0.1151, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1068596616387367
distance 1 is tensor(141.4995, device='cuda:0')
distance 2 is tensor(10.2105, device='cuda:0')
benign distance is  tensor(10.2105, device='cuda:0')
norm1 res is  tensor(0.1401, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.2862163055688143
distance 1 is tensor(120.1945, device='cuda:0')
distance 2 is tensor(9.0530, device='cuda:0')
benign distance is  tensor(9.0530, device='cuda:0')
norm1 res is  tensor(0.1190, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.0191002935171127
distance 1 is tensor(104.5055, device='cuda:0')
distance 2 is tensor(7.9086, device='cuda:0')
benign distance is  tensor(7.9086, device='cuda:0')
norm1 res is  tensor(0.1550, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.8058893512934446
distance 1 is tensor(124.7407, device='cuda:0')
distance 2 is tensor(9.2445, device='cuda:0')
benign distance is  tensor(9.2445, device='cuda:0')
norm1 res is  tensor(0.1603, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.3732591904699802
distance 1 is tensor(145.9241, device='cuda:0')
distance 2 is tensor(10.6586, device='cuda:0')
benign distance is  tensor(10.6586, device='cuda:0')
norm1 res is  tensor(0.1490, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.0286398474127054
distance 1 is tensor(141.3439, device='cuda:0')
distance 2 is tensor(10.6224, device='cuda:0')
benign distance is  tensor(10.6224, device='cuda:0')
norm1 res is  tensor(0.1311, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9252288267016411
distance 1 is tensor(73.2083, device='cuda:0')
distance 2 is tensor(5.4660, device='cuda:0')
benign distance is  tensor(5.4660, device='cuda:0')
norm1 res is  tensor(0.0936, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9011236149817705
distance 1 is tensor(234.8158, device='cuda:0')
distance 2 is tensor(16.8857, device='cuda:0')
benign distance is  tensor(16.8857, device='cuda:0')
norm1 res is  tensor(0.1267, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.1965461485087872
distance 1 is tensor(163.7320, device='cuda:0')
distance 2 is tensor(12.1020, device='cuda:0')
benign distance is  tensor(12.1020, device='cuda:0')
norm1 res is  tensor(0.1048, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.8226302992552519
distance 1 is tensor(129.6908, device='cuda:0')
distance 2 is tensor(9.6109, device='cuda:0')
benign distance is  tensor(9.6109, device='cuda:0')
norm1 res is  tensor(0.1155, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.152721595019102
distance 1 is tensor(141.4446, device='cuda:0')
distance 2 is tensor(10.4853, device='cuda:0')
benign distance is  tensor(10.4853, device='cuda:0')
norm1 res is  tensor(0.1549, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.9404992014169693
distance 1 is tensor(140.9892, device='cuda:0')
distance 2 is tensor(12.2923, device='cuda:0')
benign distance is  tensor(12.2923, device='cuda:0')
norm1 res is  tensor(0.4567, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.1320907454937696
distance 1 is tensor(145.9752, device='cuda:0')
distance 2 is tensor(10.8961, device='cuda:0')
benign distance is  tensor(10.8961, device='cuda:0')
norm1 res is  tensor(0.1242, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.4358646236360073
distance 1 is tensor(132.8870, device='cuda:0')
distance 2 is tensor(9.9658, device='cuda:0')
benign distance is  tensor(9.9658, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.1870047058910131
distance 1 is tensor(146.4036, device='cuda:0')
distance 2 is tensor(10.8032, device='cuda:0')
benign distance is  tensor(10.8032, device='cuda:0')
norm1 res is  tensor(0.1653, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8563519660383463
distance 1 is tensor(131.5888, device='cuda:0')
distance 2 is tensor(9.8748, device='cuda:0')
benign distance is  tensor(9.8748, device='cuda:0')
norm1 res is  tensor(0.1396, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.45737748965620995
distance 1 is tensor(141.6927, device='cuda:0')
distance 2 is tensor(10.2778, device='cuda:0')
benign distance is  tensor(10.2778, device='cuda:0')
norm1 res is  tensor(0.1566, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  1.0167232025414705
distance 1 is tensor(210.4955, device='cuda:0')
distance 2 is tensor(15.2062, device='cuda:0')
benign distance is  tensor(15.2062, device='cuda:0')
norm1 res is  tensor(0.1867, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.9664353206753731
distance 1 is tensor(136.3438, device='cuda:0')
distance 2 is tensor(10.2486, device='cuda:0')
benign distance is  tensor(10.2486, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.290078081190586
distance 1 is tensor(175.2818, device='cuda:0')
distance 2 is tensor(13.2056, device='cuda:0')
benign distance is  tensor(13.2056, device='cuda:0')
norm1 res is  tensor(0.1739, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.5447476953268051
distance 1 is tensor(174.9276, device='cuda:0')
distance 2 is tensor(13.0035, device='cuda:0')
benign distance is  tensor(13.0035, device='cuda:0')
norm1 res is  tensor(0.1249, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.8488979004323483
distance 1 is tensor(115.0169, device='cuda:0')
distance 2 is tensor(8.9715, device='cuda:0')
benign distance is  tensor(8.9715, device='cuda:0')
norm1 res is  tensor(0.2717, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  1.0065585300326347
distance 1 is tensor(195.4509, device='cuda:0')
distance 2 is tensor(14.4668, device='cuda:0')
benign distance is  tensor(14.4668, device='cuda:0')
norm1 res is  tensor(0.1885, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.9240947477519512
distance 1 is tensor(177.2042, device='cuda:0')
distance 2 is tensor(12.7770, device='cuda:0')
benign distance is  tensor(12.7770, device='cuda:0')
norm1 res is  tensor(0.2091, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8264970723539591
distance 1 is tensor(129.2276, device='cuda:0')
distance 2 is tensor(9.4736, device='cuda:0')
benign distance is  tensor(9.4736, device='cuda:0')
norm1 res is  tensor(0.1748, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.4932552110403776
distance 1 is tensor(163.6316, device='cuda:0')
distance 2 is tensor(11.7824, device='cuda:0')
benign distance is  tensor(11.7824, device='cuda:0')
norm1 res is  tensor(0.1814, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(423.6240, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(424.1779, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(519.4982, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(636.8445, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(302.4150, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(314.0744, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(242.8920, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(405.0325, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4833.9624, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4905.1836, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4857.0137, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4854.8926, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4876.7075, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4873.5498, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4885.6631, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4845.3789, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4879.4360, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4851.9985, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4862.7627, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4910.7632, device='cuda:0')
norm_2 is  tensor(230.9995, device='cuda:0')
norm_2 * lamda is tensor(415.7990, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 83.96% 

Test Accuracy: 87.57% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8463453482836485
distance 1 is tensor(82.3983, device='cuda:0')
distance 2 is tensor(6.3087, device='cuda:0')
benign distance is  tensor(6.3087, device='cuda:0')
norm1 res is  tensor(0.0715, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.0530892964452505
distance 1 is tensor(99.9043, device='cuda:0')
distance 2 is tensor(7.3921, device='cuda:0')
benign distance is  tensor(7.3921, device='cuda:0')
norm1 res is  tensor(0.1339, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7229468710720539
distance 1 is tensor(110.8863, device='cuda:0')
distance 2 is tensor(8.2852, device='cuda:0')
benign distance is  tensor(8.2852, device='cuda:0')
norm1 res is  tensor(0.2090, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.4157290402799845
distance 1 is tensor(192.8780, device='cuda:0')
distance 2 is tensor(13.9094, device='cuda:0')
benign distance is  tensor(13.9094, device='cuda:0')
norm1 res is  tensor(0.1337, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0605184640735388
distance 1 is tensor(78.3069, device='cuda:0')
distance 2 is tensor(6.0004, device='cuda:0')
benign distance is  tensor(6.0004, device='cuda:0')
norm1 res is  tensor(0.0851, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7824163027107716
distance 1 is tensor(55.3929, device='cuda:0')
distance 2 is tensor(4.1769, device='cuda:0')
benign distance is  tensor(4.1769, device='cuda:0')
norm1 res is  tensor(0.0948, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2702396772801876
distance 1 is tensor(63.8620, device='cuda:0')
distance 2 is tensor(5.0926, device='cuda:0')
benign distance is  tensor(5.0926, device='cuda:0')
norm1 res is  tensor(0.0791, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7587433829903603
distance 1 is tensor(65.8942, device='cuda:0')
distance 2 is tensor(5.1095, device='cuda:0')
benign distance is  tensor(5.1095, device='cuda:0')
norm1 res is  tensor(0.1061, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(366.3311, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(433.9156, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(490.7400, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(849.6983, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(351.7544, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(239.7993, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(299.2069, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(291.2111, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4859.5430, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4918.2104, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4879.7026, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4899.0273, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4881.3257, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4895.6943, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4897.7524, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4873.7461, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4885.8057, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4870.1274, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4895.0317, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4936.6489, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(513.9477, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(589.7228, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(269.3836, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(543.6826, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(862.8847, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(226.8195, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(640.8052, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(552.0244, device='cuda:0')
norm_2 is  tensor(538.7401, device='cuda:0')
norm_2 * lamda is tensor(969.7322, device='cuda:0')
satisfying 27
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 81.56% 

Test Accuracy: 87.27% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7449180968105793
distance 1 is tensor(84.3543, device='cuda:0')
distance 2 is tensor(6.3724, device='cuda:0')
benign distance is  tensor(6.3724, device='cuda:0')
norm1 res is  tensor(0.0709, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8527875412255526
distance 1 is tensor(95.0893, device='cuda:0')
distance 2 is tensor(7.0339, device='cuda:0')
benign distance is  tensor(7.0339, device='cuda:0')
norm1 res is  tensor(0.1294, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8730930928140879
distance 1 is tensor(143.3524, device='cuda:0')
distance 2 is tensor(10.5120, device='cuda:0')
benign distance is  tensor(10.5120, device='cuda:0')
norm1 res is  tensor(0.2760, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3945828322321177
distance 1 is tensor(144.8292, device='cuda:0')
distance 2 is tensor(10.5947, device='cuda:0')
benign distance is  tensor(10.5947, device='cuda:0')
norm1 res is  tensor(0.1014, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0263693239539862
distance 1 is tensor(77.7274, device='cuda:0')
distance 2 is tensor(5.8380, device='cuda:0')
benign distance is  tensor(5.8380, device='cuda:0')
norm1 res is  tensor(0.0805, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7682372899726033
distance 1 is tensor(67.0175, device='cuda:0')
distance 2 is tensor(5.0384, device='cuda:0')
benign distance is  tensor(5.0384, device='cuda:0')
norm1 res is  tensor(0.1151, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4041261579841375
distance 1 is tensor(58.6523, device='cuda:0')
distance 2 is tensor(4.6418, device='cuda:0')
benign distance is  tensor(4.6418, device='cuda:0')
norm1 res is  tensor(0.0699, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7838783888146281
distance 1 is tensor(61.2319, device='cuda:0')
distance 2 is tensor(4.6549, device='cuda:0')
benign distance is  tensor(4.6549, device='cuda:0')
norm1 res is  tensor(0.0964, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.7912354320287704
distance 1 is tensor(104.4146, device='cuda:0')
distance 2 is tensor(7.7425, device='cuda:0')
benign distance is  tensor(7.7425, device='cuda:0')
norm1 res is  tensor(0.1161, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0783110074698925
distance 1 is tensor(156.7053, device='cuda:0')
distance 2 is tensor(11.3981, device='cuda:0')
benign distance is  tensor(11.3981, device='cuda:0')
norm1 res is  tensor(0.1672, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9142275582998991
distance 1 is tensor(76.7225, device='cuda:0')
distance 2 is tensor(5.9852, device='cuda:0')
benign distance is  tensor(5.9852, device='cuda:0')
norm1 res is  tensor(0.1075, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.5707731768488884
distance 1 is tensor(132.2890, device='cuda:0')
distance 2 is tensor(9.8304, device='cuda:0')
benign distance is  tensor(9.8304, device='cuda:0')
norm1 res is  tensor(0.1397, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.6886493973433971
distance 1 is tensor(214.7214, device='cuda:0')
distance 2 is tensor(16.1302, device='cuda:0')
benign distance is  tensor(16.1302, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7716806028038263
distance 1 is tensor(44.9305, device='cuda:0')
distance 2 is tensor(3.6540, device='cuda:0')
benign distance is  tensor(3.6540, device='cuda:0')
norm1 res is  tensor(0.1272, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.4021484032273293
distance 1 is tensor(158.1011, device='cuda:0')
distance 2 is tensor(11.2739, device='cuda:0')
benign distance is  tensor(11.2739, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.3264398574829102
distance 1 is tensor(151.4629, device='cuda:0')
distance 2 is tensor(11.2284, device='cuda:0')
benign distance is  tensor(11.2284, device='cuda:0')
norm1 res is  tensor(0.1455, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(364.9873, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(419.2371, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(635.5477, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(638.5961, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(333.3147, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(295.6611, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(265.3239, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(261.8974, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4872.2422, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4923.9580, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4882.0352, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4883.9116, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4886.0796, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4933.0918, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4927.5156, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4882.6396, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4906.2827, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4893.5166, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4904.3315, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4947.0312, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(701.9185, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(596.8929, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(808.0825, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(661.7516, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(632.7438, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(493.4803, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(520.4406, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(661.6768, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(476.6726, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(556.5499, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(632.7806, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(635.0823, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(334.2758, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1035.1228, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(707.4415, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(587.6253, device='cuda:0')
norm_2 is  tensor(351.8473, device='cuda:0')
norm_2 * lamda is tensor(633.3251, device='cuda:0')
satisfying 35
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 83.39% 

Test Accuracy: 87.83% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
 benign loss is  0.71302773617208
distance 1 is tensor(63.8038, device='cuda:0')
distance 2 is tensor(4.9438, device='cuda:0')
benign distance is  tensor(4.9438, device='cuda:0')
norm1 res is  tensor(0.0532, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9433948863297701
distance 1 is tensor(59.8471, device='cuda:0')
distance 2 is tensor(4.6836, device='cuda:0')
benign distance is  tensor(4.6836, device='cuda:0')
norm1 res is  tensor(0.0813, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8628522474318743
distance 1 is tensor(114.2298, device='cuda:0')
distance 2 is tensor(8.4306, device='cuda:0')
benign distance is  tensor(8.4306, device='cuda:0')
norm1 res is  tensor(0.2163, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0612134039402008
distance 1 is tensor(137.6388, device='cuda:0')
distance 2 is tensor(10.0824, device='cuda:0')
benign distance is  tensor(10.0824, device='cuda:0')
norm1 res is  tensor(0.0967, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7724369987845421
distance 1 is tensor(62.5901, device='cuda:0')
distance 2 is tensor(4.8603, device='cuda:0')
benign distance is  tensor(4.8603, device='cuda:0')
norm1 res is  tensor(0.0748, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6289722619112581
distance 1 is tensor(59.4334, device='cuda:0')
distance 2 is tensor(4.5146, device='cuda:0')
benign distance is  tensor(4.5146, device='cuda:0')
norm1 res is  tensor(0.1000, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.162939002737403
distance 1 is tensor(54.6534, device='cuda:0')
distance 2 is tensor(4.3071, device='cuda:0')
benign distance is  tensor(4.3071, device='cuda:0')
norm1 res is  tensor(0.0633, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7310115583240986
distance 1 is tensor(46.5132, device='cuda:0')
distance 2 is tensor(3.7662, device='cuda:0')
benign distance is  tensor(3.7662, device='cuda:0')
norm1 res is  tensor(0.0780, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.4000065550208092
distance 1 is tensor(103.7629, device='cuda:0')
distance 2 is tensor(8.0185, device='cuda:0')
benign distance is  tensor(8.0185, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7405633740127087
distance 1 is tensor(129.2275, device='cuda:0')
distance 2 is tensor(9.4720, device='cuda:0')
benign distance is  tensor(9.4720, device='cuda:0')
norm1 res is  tensor(0.1664, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.9764061979949474
distance 1 is tensor(138.6529, device='cuda:0')
distance 2 is tensor(10.3297, device='cuda:0')
benign distance is  tensor(10.3297, device='cuda:0')
norm1 res is  tensor(0.1422, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.0334362667053938
distance 1 is tensor(144.2066, device='cuda:0')
distance 2 is tensor(10.7234, device='cuda:0')
benign distance is  tensor(10.7234, device='cuda:0')
norm1 res is  tensor(0.1287, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9996762350201607
distance 1 is tensor(79.4968, device='cuda:0')
distance 2 is tensor(5.9172, device='cuda:0')
benign distance is  tensor(5.9172, device='cuda:0')
norm1 res is  tensor(0.1003, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.1753493286669254
distance 1 is tensor(257.9699, device='cuda:0')
distance 2 is tensor(18.6527, device='cuda:0')
benign distance is  tensor(18.6527, device='cuda:0')
norm1 res is  tensor(0.1389, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.1546165570616722
distance 1 is tensor(161.7953, device='cuda:0')
distance 2 is tensor(12.1566, device='cuda:0')
benign distance is  tensor(12.1566, device='cuda:0')
norm1 res is  tensor(0.1061, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.1439580544829369
distance 1 is tensor(131.2546, device='cuda:0')
distance 2 is tensor(9.7547, device='cuda:0')
benign distance is  tensor(9.7547, device='cuda:0')
norm1 res is  tensor(0.1161, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.6862683352082968
distance 1 is tensor(144.8444, device='cuda:0')
distance 2 is tensor(10.9595, device='cuda:0')
benign distance is  tensor(10.9595, device='cuda:0')
norm1 res is  tensor(0.1793, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.266936533153057
distance 1 is tensor(109.5141, device='cuda:0')
distance 2 is tensor(8.1882, device='cuda:0')
benign distance is  tensor(8.1882, device='cuda:0')
norm1 res is  tensor(0.1557, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.7255368009209633
distance 1 is tensor(184.4502, device='cuda:0')
distance 2 is tensor(13.5938, device='cuda:0')
benign distance is  tensor(13.5938, device='cuda:0')
norm1 res is  tensor(0.1793, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.430242881178856
distance 1 is tensor(153.7110, device='cuda:0')
distance 2 is tensor(11.4607, device='cuda:0')
benign distance is  tensor(11.4607, device='cuda:0')
norm1 res is  tensor(0.1164, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.7539175879210234
distance 1 is tensor(125.2803, device='cuda:0')
distance 2 is tensor(9.3278, device='cuda:0')
benign distance is  tensor(9.3278, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.7360607329756021
distance 1 is tensor(102.1003, device='cuda:0')
distance 2 is tensor(7.6719, device='cuda:0')
benign distance is  tensor(7.6719, device='cuda:0')
norm1 res is  tensor(0.1306, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.7295995038002729
distance 1 is tensor(100.9522, device='cuda:0')
distance 2 is tensor(7.5414, device='cuda:0')
benign distance is  tensor(7.5414, device='cuda:0')
norm1 res is  tensor(0.2047, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.7187392599880695
distance 1 is tensor(145.5293, device='cuda:0')
distance 2 is tensor(10.6969, device='cuda:0')
benign distance is  tensor(10.6969, device='cuda:0')
norm1 res is  tensor(0.1736, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(281.5973, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(266.6373, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(501.9520, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(605.9076, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(268.0560, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(257.7194, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(239.8720, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(211.3002, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4866.8799, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4919.2861, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4872.1548, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4875.5576, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4874.8750, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4901.7617, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4898.1953, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4878.1851, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4896.3408, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4887.1636, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4889.3501, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4935.2227, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(621.1943, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(735.3788, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(639.9486, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(594.0035, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(655.8765, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(601.4943, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(616.1622, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(920.0444, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(469.7190, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(687.0305, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(365.6990, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(596.8130, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(996.0486, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(235.8380, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(687.1005, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(666.7813, device='cuda:0')
norm_2 is  tensor(324.7323, device='cuda:0')
norm_2 * lamda is tensor(584.5181, device='cuda:0')
do  not satisfying 35
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 83.92% 

Test Accuracy: 88.06% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5877915341407061
distance 1 is tensor(72.3196, device='cuda:0')
distance 2 is tensor(5.5783, device='cuda:0')
benign distance is  tensor(5.5783, device='cuda:0')
norm1 res is  tensor(0.0611, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6887922342866659
distance 1 is tensor(93.2783, device='cuda:0')
distance 2 is tensor(6.9269, device='cuda:0')
benign distance is  tensor(6.9269, device='cuda:0')
norm1 res is  tensor(0.1307, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7606197111308575
distance 1 is tensor(108.7896, device='cuda:0')
distance 2 is tensor(8.1770, device='cuda:0')
benign distance is  tensor(8.1770, device='cuda:0')
norm1 res is  tensor(0.2079, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1189277898520231
distance 1 is tensor(149.7613, device='cuda:0')
distance 2 is tensor(10.9185, device='cuda:0')
benign distance is  tensor(10.9185, device='cuda:0')
norm1 res is  tensor(0.1049, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7892972072586417
distance 1 is tensor(76.7328, device='cuda:0')
distance 2 is tensor(5.7794, device='cuda:0')
benign distance is  tensor(5.7794, device='cuda:0')
norm1 res is  tensor(0.0802, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8030380373820662
distance 1 is tensor(117.1891, device='cuda:0')
distance 2 is tensor(8.3267, device='cuda:0')
benign distance is  tensor(8.3267, device='cuda:0')
norm1 res is  tensor(0.1975, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2212471086531878
distance 1 is tensor(58.0716, device='cuda:0')
distance 2 is tensor(4.5623, device='cuda:0')
benign distance is  tensor(4.5623, device='cuda:0')
norm1 res is  tensor(0.0725, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.756595497019589
distance 1 is tensor(61.5145, device='cuda:0')
distance 2 is tensor(4.7922, device='cuda:0')
benign distance is  tensor(4.7922, device='cuda:0')
norm1 res is  tensor(0.1042, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.295645259320736
distance 1 is tensor(103.8861, device='cuda:0')
distance 2 is tensor(7.7931, device='cuda:0')
benign distance is  tensor(7.7931, device='cuda:0')
norm1 res is  tensor(0.1186, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0536736827343702
distance 1 is tensor(141.0460, device='cuda:0')
distance 2 is tensor(10.4329, device='cuda:0')
benign distance is  tensor(10.4329, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0177124850451946
distance 1 is tensor(50.5929, device='cuda:0')
distance 2 is tensor(4.0648, device='cuda:0')
benign distance is  tensor(4.0648, device='cuda:0')
norm1 res is  tensor(0.0682, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.163843147456646
distance 1 is tensor(137.0912, device='cuda:0')
distance 2 is tensor(10.0986, device='cuda:0')
benign distance is  tensor(10.0986, device='cuda:0')
norm1 res is  tensor(0.1417, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.3805409856140614
distance 1 is tensor(202.5285, device='cuda:0')
distance 2 is tensor(14.5738, device='cuda:0')
benign distance is  tensor(14.5738, device='cuda:0')
norm1 res is  tensor(0.1329, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7045461041852832
distance 1 is tensor(45.5540, device='cuda:0')
distance 2 is tensor(3.4580, device='cuda:0')
benign distance is  tensor(3.4580, device='cuda:0')
norm1 res is  tensor(0.1161, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.9158607814460993
distance 1 is tensor(155.7460, device='cuda:0')
distance 2 is tensor(11.1232, device='cuda:0')
benign distance is  tensor(11.1232, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.5181402154266834
distance 1 is tensor(149.8988, device='cuda:0')
distance 2 is tensor(11.1705, device='cuda:0')
benign distance is  tensor(11.1705, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.5015397891402245
distance 1 is tensor(167.6718, device='cuda:0')
distance 2 is tensor(12.2922, device='cuda:0')
benign distance is  tensor(12.2922, device='cuda:0')
norm1 res is  tensor(0.1818, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.9161668512970209
distance 1 is tensor(119.2008, device='cuda:0')
distance 2 is tensor(8.8317, device='cuda:0')
benign distance is  tensor(8.8317, device='cuda:0')
norm1 res is  tensor(0.3364, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.1407404206693172
distance 1 is tensor(170.5581, device='cuda:0')
distance 2 is tensor(12.6706, device='cuda:0')
benign distance is  tensor(12.6706, device='cuda:0')
norm1 res is  tensor(0.1491, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.818518228828907
distance 1 is tensor(152.9031, device='cuda:0')
distance 2 is tensor(11.5221, device='cuda:0')
benign distance is  tensor(11.5221, device='cuda:0')
norm1 res is  tensor(0.1732, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.9385838843882084
distance 1 is tensor(153.7980, device='cuda:0')
distance 2 is tensor(11.3419, device='cuda:0')
benign distance is  tensor(11.3419, device='cuda:0')
norm1 res is  tensor(0.1725, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.7840288151055574
distance 1 is tensor(142.2276, device='cuda:0')
distance 2 is tensor(10.6163, device='cuda:0')
benign distance is  tensor(10.6163, device='cuda:0')
norm1 res is  tensor(0.1500, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5589105458930135
distance 1 is tensor(142.9202, device='cuda:0')
distance 2 is tensor(10.3933, device='cuda:0')
benign distance is  tensor(10.3933, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.8420733101665974
distance 1 is tensor(209.0470, device='cuda:0')
distance 2 is tensor(15.2248, device='cuda:0')
benign distance is  tensor(15.2248, device='cuda:0')
norm1 res is  tensor(0.1869, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(319.9604, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(417.4170, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(483.0984, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(660.4330, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(331.9470, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(490.8470, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(268.1302, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(280.1193, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4880.3125, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4945.6782, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4903.6914, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4916.8647, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4902.5107, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4933.5063, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4916.9224, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4893.9438, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4919.9048, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4901.9731, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4908.1748, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4959.6621, device='cuda:0')
norm_2 is  tensor(446.6471, device='cuda:0')
norm_2 * lamda is tensor(803.9647, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 85.92% 

Test Accuracy: 88.07% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6047750301659107
distance 1 is tensor(77.4369, device='cuda:0')
distance 2 is tensor(5.8528, device='cuda:0')
benign distance is  tensor(5.8528, device='cuda:0')
norm1 res is  tensor(0.0645, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7548207193613052
distance 1 is tensor(70.5837, device='cuda:0')
distance 2 is tensor(5.3733, device='cuda:0')
benign distance is  tensor(5.3733, device='cuda:0')
norm1 res is  tensor(0.0958, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6250868421047926
distance 1 is tensor(99.3306, device='cuda:0')
distance 2 is tensor(7.3705, device='cuda:0')
benign distance is  tensor(7.3705, device='cuda:0')
norm1 res is  tensor(0.1955, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.546698436141014
distance 1 is tensor(173.3482, device='cuda:0')
distance 2 is tensor(12.5298, device='cuda:0')
benign distance is  tensor(12.5298, device='cuda:0')
norm1 res is  tensor(0.1185, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.194483794271946
distance 1 is tensor(57.7405, device='cuda:0')
distance 2 is tensor(4.3952, device='cuda:0')
benign distance is  tensor(4.3952, device='cuda:0')
norm1 res is  tensor(0.0598, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6751002026721835
distance 1 is tensor(73.9256, device='cuda:0')
distance 2 is tensor(5.4397, device='cuda:0')
benign distance is  tensor(5.4397, device='cuda:0')
norm1 res is  tensor(0.1252, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.166011743247509
distance 1 is tensor(67.6023, device='cuda:0')
distance 2 is tensor(5.0739, device='cuda:0')
benign distance is  tensor(5.0739, device='cuda:0')
norm1 res is  tensor(0.0759, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6786241391673684
distance 1 is tensor(67.1395, device='cuda:0')
distance 2 is tensor(5.2038, device='cuda:0')
benign distance is  tensor(5.2038, device='cuda:0')
norm1 res is  tensor(0.1077, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(336.3187, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(309.3639, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(437.5463, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(753.4467, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(245.4800, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(315.5273, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(283.2052, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(290.2131, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4908.8936, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4960.1123, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4931.6733, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4949.0024, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4925.3521, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4934.4775, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4955.5684, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4926.2397, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4968.7974, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4924.8232, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4934.5298, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4995.7544, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(621.1536, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(790.6102, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(793.1914, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(543.6750, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(888.4104, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(777.7016, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(587.4207, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(730.8124, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(499.3121, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(588.4324, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(622.5511, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(629.7982, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(368.7523, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1129.0555, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(725.2338, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(606.7464, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(478.7992, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(630.1965, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(251.2378, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(611.6520, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(898.2637, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(226.4531, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(671.3319, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(677.6451, device='cuda:0')
norm_2 is  tensor(353.4769, device='cuda:0')
norm_2 * lamda is tensor(636.2585, device='cuda:0')
do  not satisfying 43
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 84.07% 

Test Accuracy: 87.90% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6541366260498762
distance 1 is tensor(54.6134, device='cuda:0')
distance 2 is tensor(4.2662, device='cuda:0')
benign distance is  tensor(4.2662, device='cuda:0')
norm1 res is  tensor(0.0446, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8051077928394079
distance 1 is tensor(74.1321, device='cuda:0')
distance 2 is tensor(5.6625, device='cuda:0')
benign distance is  tensor(5.6625, device='cuda:0')
norm1 res is  tensor(0.0984, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7601998969912529
distance 1 is tensor(85.5439, device='cuda:0')
distance 2 is tensor(6.4831, device='cuda:0')
benign distance is  tensor(6.4831, device='cuda:0')
norm1 res is  tensor(0.1666, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.178122740238905
distance 1 is tensor(171.8477, device='cuda:0')
distance 2 is tensor(12.3766, device='cuda:0')
benign distance is  tensor(12.3766, device='cuda:0')
norm1 res is  tensor(0.1184, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8354485332965851
distance 1 is tensor(46.8074, device='cuda:0')
distance 2 is tensor(3.7275, device='cuda:0')
benign distance is  tensor(3.7275, device='cuda:0')
norm1 res is  tensor(0.0495, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7660014405846596
distance 1 is tensor(58.8783, device='cuda:0')
distance 2 is tensor(4.5699, device='cuda:0')
benign distance is  tensor(4.5699, device='cuda:0')
norm1 res is  tensor(0.1003, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.3742611445486546
distance 1 is tensor(66.1216, device='cuda:0')
distance 2 is tensor(5.0936, device='cuda:0')
benign distance is  tensor(5.0936, device='cuda:0')
norm1 res is  tensor(0.0768, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7430598586797714
distance 1 is tensor(61.8261, device='cuda:0')
distance 2 is tensor(4.7143, device='cuda:0')
benign distance is  tensor(4.7143, device='cuda:0')
norm1 res is  tensor(0.0994, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.1656999289989471
distance 1 is tensor(98.3760, device='cuda:0')
distance 2 is tensor(7.2312, device='cuda:0')
benign distance is  tensor(7.2312, device='cuda:0')
norm1 res is  tensor(0.1090, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9044829457998276
distance 1 is tensor(162.6628, device='cuda:0')
distance 2 is tensor(11.8802, device='cuda:0')
benign distance is  tensor(11.8802, device='cuda:0')
norm1 res is  tensor(0.1795, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0118920244276524
distance 1 is tensor(49.2684, device='cuda:0')
distance 2 is tensor(3.9325, device='cuda:0')
benign distance is  tensor(3.9325, device='cuda:0')
norm1 res is  tensor(0.0663, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3221953306347132
distance 1 is tensor(107.0102, device='cuda:0')
distance 2 is tensor(8.0303, device='cuda:0')
benign distance is  tensor(8.0303, device='cuda:0')
norm1 res is  tensor(0.1095, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.2015532441437244
distance 1 is tensor(211.8362, device='cuda:0')
distance 2 is tensor(15.2647, device='cuda:0')
benign distance is  tensor(15.2647, device='cuda:0')
norm1 res is  tensor(0.1371, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.5935054654255509
distance 1 is tensor(37.0917, device='cuda:0')
distance 2 is tensor(2.9138, device='cuda:0')
benign distance is  tensor(2.9138, device='cuda:0')
norm1 res is  tensor(0.0985, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.351933192461729
distance 1 is tensor(160.8844, device='cuda:0')
distance 2 is tensor(11.5565, device='cuda:0')
benign distance is  tensor(11.5565, device='cuda:0')
norm1 res is  tensor(0.1577, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.8725009262561798
distance 1 is tensor(152.6252, device='cuda:0')
distance 2 is tensor(11.2455, device='cuda:0')
benign distance is  tensor(11.2455, device='cuda:0')
norm1 res is  tensor(0.1461, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.4541286304593086
distance 1 is tensor(130.1818, device='cuda:0')
distance 2 is tensor(9.7657, device='cuda:0')
benign distance is  tensor(9.7657, device='cuda:0')
norm1 res is  tensor(0.1916, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7408734150230885
distance 1 is tensor(127.0229, device='cuda:0')
distance 2 is tensor(9.3302, device='cuda:0')
benign distance is  tensor(9.3302, device='cuda:0')
norm1 res is  tensor(0.1629, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.0911986585706472
distance 1 is tensor(139.5070, device='cuda:0')
distance 2 is tensor(10.1737, device='cuda:0')
benign distance is  tensor(10.1737, device='cuda:0')
norm1 res is  tensor(0.1392, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.0484078489243984
distance 1 is tensor(154.3337, device='cuda:0')
distance 2 is tensor(11.2759, device='cuda:0')
benign distance is  tensor(11.2759, device='cuda:0')
norm1 res is  tensor(0.1391, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9731756299734116
distance 1 is tensor(80.5739, device='cuda:0')
distance 2 is tensor(6.0410, device='cuda:0')
benign distance is  tensor(6.0410, device='cuda:0')
norm1 res is  tensor(0.1026, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.0208928063511848
distance 1 is tensor(245.1059, device='cuda:0')
distance 2 is tensor(17.7303, device='cuda:0')
benign distance is  tensor(17.7303, device='cuda:0')
norm1 res is  tensor(0.1322, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.0620109252631664
distance 1 is tensor(169.2033, device='cuda:0')
distance 2 is tensor(12.5844, device='cuda:0')
benign distance is  tensor(12.5844, device='cuda:0')
norm1 res is  tensor(0.1116, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.9233322720974684
distance 1 is tensor(137.4817, device='cuda:0')
distance 2 is tensor(10.2288, device='cuda:0')
benign distance is  tensor(10.2288, device='cuda:0')
norm1 res is  tensor(0.1238, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.6041153222322464
distance 1 is tensor(140.2163, device='cuda:0')
distance 2 is tensor(10.4332, device='cuda:0')
benign distance is  tensor(10.4332, device='cuda:0')
norm1 res is  tensor(0.1432, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.298821534961462
distance 1 is tensor(176.8249, device='cuda:0')
distance 2 is tensor(13.2799, device='cuda:0')
benign distance is  tensor(13.2799, device='cuda:0')
norm1 res is  tensor(0.1776, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.216845577582717
distance 1 is tensor(192.1751, device='cuda:0')
distance 2 is tensor(14.0778, device='cuda:0')
benign distance is  tensor(14.0778, device='cuda:0')
norm1 res is  tensor(0.1339, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  1.023647541180253
distance 1 is tensor(130.8717, device='cuda:0')
distance 2 is tensor(9.8980, device='cuda:0')
benign distance is  tensor(9.8980, device='cuda:0')
norm1 res is  tensor(0.3079, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.9909320529550314
distance 1 is tensor(211.3817, device='cuda:0')
distance 2 is tensor(15.3164, device='cuda:0')
benign distance is  tensor(15.3164, device='cuda:0')
norm1 res is  tensor(0.2022, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.8177743125706911
distance 1 is tensor(164.8181, device='cuda:0')
distance 2 is tensor(11.9967, device='cuda:0')
benign distance is  tensor(11.9967, device='cuda:0')
norm1 res is  tensor(0.1990, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.7678267508745193
distance 1 is tensor(131.0199, device='cuda:0')
distance 2 is tensor(9.7234, device='cuda:0')
benign distance is  tensor(9.7234, device='cuda:0')
norm1 res is  tensor(0.1828, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.6346924342215061
distance 1 is tensor(161.8711, device='cuda:0')
distance 2 is tensor(11.8076, device='cuda:0')
benign distance is  tensor(11.8076, device='cuda:0')
norm1 res is  tensor(0.1801, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(236.0679, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(324.2813, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(378.9712, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(753.9976, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(204.6899, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(263.1906, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(283.0275, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(270.4024, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4893.8765, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4953.3594, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4918.4644, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4905.0166, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4912.5688, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4928.6646, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4938.2993, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4905.3237, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4924.5239, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4907.0640, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4908.6592, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4977.8813, device='cuda:0')
norm_2 is  tensor(336.8315, device='cuda:0')
norm_2 * lamda is tensor(606.2966, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 86.55% 

Test Accuracy: 88.45% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6183802848681808
distance 1 is tensor(88.6380, device='cuda:0')
distance 2 is tensor(6.6896, device='cuda:0')
benign distance is  tensor(6.6896, device='cuda:0')
norm1 res is  tensor(0.0731, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.893989184871316
distance 1 is tensor(92.2203, device='cuda:0')
distance 2 is tensor(6.8724, device='cuda:0')
benign distance is  tensor(6.8724, device='cuda:0')
norm1 res is  tensor(0.1241, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6759905125945807
distance 1 is tensor(94.2970, device='cuda:0')
distance 2 is tensor(7.1185, device='cuda:0')
benign distance is  tensor(7.1185, device='cuda:0')
norm1 res is  tensor(0.1823, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.5430525094270706
distance 1 is tensor(165.3361, device='cuda:0')
distance 2 is tensor(12.0854, device='cuda:0')
benign distance is  tensor(12.0854, device='cuda:0')
norm1 res is  tensor(0.1148, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9634430333971977
distance 1 is tensor(66.1111, device='cuda:0')
distance 2 is tensor(5.0449, device='cuda:0')
benign distance is  tensor(5.0449, device='cuda:0')
norm1 res is  tensor(0.0678, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6824314361438155
distance 1 is tensor(44.7988, device='cuda:0')
distance 2 is tensor(3.5924, device='cuda:0')
benign distance is  tensor(3.5924, device='cuda:0')
norm1 res is  tensor(0.0780, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4553297087550163
distance 1 is tensor(61.3904, device='cuda:0')
distance 2 is tensor(4.7043, device='cuda:0')
benign distance is  tensor(4.7043, device='cuda:0')
norm1 res is  tensor(0.0716, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8949649315327406
distance 1 is tensor(72.0244, device='cuda:0')
distance 2 is tensor(5.5034, device='cuda:0')
benign distance is  tensor(5.5034, device='cuda:0')
norm1 res is  tensor(0.1160, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(384.7425, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(407.4272, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(422.0758, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(725.0979, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(281.3424, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(205.8162, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(270.8393, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(316.4283, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4914.1309, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4987.5190, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4927.9673, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4935.4160, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4937.3701, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4960.6626, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4956.8540, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4929.1528, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4945.4980, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4940.8999, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4934.6992, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4988.5610, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(663.9091, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(507.2324, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(824.6072, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(696.2446, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(559.2540, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(476.5162, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(466.8368, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(647.9877, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(734.8773, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(543.5677, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(761.9102, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(693.2980, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(686.0787, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(647.3984, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(627.8358, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(926.5029, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(436.4506, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(729.2505, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(231.3086, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(478.9749, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(921.9487, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(179.8652, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(704.9084, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(660.0680, device='cuda:0')
norm_2 is  tensor(508.8155, device='cuda:0')
norm_2 * lamda is tensor(915.8678, device='cuda:0')
satisfying 43
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 86.27% 

Test Accuracy: 88.43% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7281653583049774
distance 1 is tensor(58.8288, device='cuda:0')
distance 2 is tensor(4.6851, device='cuda:0')
benign distance is  tensor(4.6851, device='cuda:0')
norm1 res is  tensor(0.0519, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7829282507300377
distance 1 is tensor(67.3989, device='cuda:0')
distance 2 is tensor(5.0925, device='cuda:0')
benign distance is  tensor(5.0925, device='cuda:0')
norm1 res is  tensor(0.0871, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6749213468283415
distance 1 is tensor(92.5714, device='cuda:0')
distance 2 is tensor(6.8339, device='cuda:0')
benign distance is  tensor(6.8339, device='cuda:0')
norm1 res is  tensor(0.1724, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.5650289356708527
distance 1 is tensor(167.8737, device='cuda:0')
distance 2 is tensor(12.1255, device='cuda:0')
benign distance is  tensor(12.1255, device='cuda:0')
norm1 res is  tensor(0.1153, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8896595165133476
distance 1 is tensor(41.5549, device='cuda:0')
distance 2 is tensor(3.3991, device='cuda:0')
benign distance is  tensor(3.3991, device='cuda:0')
norm1 res is  tensor(0.0435, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7563442578539252
distance 1 is tensor(50.7480, device='cuda:0')
distance 2 is tensor(3.9568, device='cuda:0')
benign distance is  tensor(3.9568, device='cuda:0')
norm1 res is  tensor(0.0881, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2580388225615025
distance 1 is tensor(65.1485, device='cuda:0')
distance 2 is tensor(4.8984, device='cuda:0')
benign distance is  tensor(4.8984, device='cuda:0')
norm1 res is  tensor(0.0727, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6785477753728628
distance 1 is tensor(60.4246, device='cuda:0')
distance 2 is tensor(4.4978, device='cuda:0')
benign distance is  tensor(4.4978, device='cuda:0')
norm1 res is  tensor(0.0942, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.4981539659202099
distance 1 is tensor(109.8084, device='cuda:0')
distance 2 is tensor(8.3136, device='cuda:0')
benign distance is  tensor(8.3136, device='cuda:0')
norm1 res is  tensor(0.1239, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9126930451020598
distance 1 is tensor(131.4368, device='cuda:0')
distance 2 is tensor(9.6463, device='cuda:0')
benign distance is  tensor(9.6463, device='cuda:0')
norm1 res is  tensor(0.1414, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9463974088430405
distance 1 is tensor(60.4060, device='cuda:0')
distance 2 is tensor(4.8418, device='cuda:0')
benign distance is  tensor(4.8418, device='cuda:0')
norm1 res is  tensor(0.0886, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.4105761125683784
distance 1 is tensor(125.3616, device='cuda:0')
distance 2 is tensor(9.3268, device='cuda:0')
benign distance is  tensor(9.3268, device='cuda:0')
norm1 res is  tensor(0.1295, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.1763709485530853
distance 1 is tensor(210.0178, device='cuda:0')
distance 2 is tensor(15.2375, device='cuda:0')
benign distance is  tensor(15.2375, device='cuda:0')
norm1 res is  tensor(0.1382, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6552367368713021
distance 1 is tensor(48.2225, device='cuda:0')
distance 2 is tensor(3.7796, device='cuda:0')
benign distance is  tensor(3.7796, device='cuda:0')
norm1 res is  tensor(0.1370, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.8536014184355736
distance 1 is tensor(140.8697, device='cuda:0')
distance 2 is tensor(10.2988, device='cuda:0')
benign distance is  tensor(10.2988, device='cuda:0')
norm1 res is  tensor(0.1384, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.132906287908554
distance 1 is tensor(153.2252, device='cuda:0')
distance 2 is tensor(11.3188, device='cuda:0')
benign distance is  tensor(11.3188, device='cuda:0')
norm1 res is  tensor(0.1481, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.175934113562107
distance 1 is tensor(151.7975, device='cuda:0')
distance 2 is tensor(11.1530, device='cuda:0')
benign distance is  tensor(11.1530, device='cuda:0')
norm1 res is  tensor(0.1646, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6497130077332258
distance 1 is tensor(103.9087, device='cuda:0')
distance 2 is tensor(7.7791, device='cuda:0')
benign distance is  tensor(7.7791, device='cuda:0')
norm1 res is  tensor(0.2949, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.2021032515913248
distance 1 is tensor(166.0297, device='cuda:0')
distance 2 is tensor(12.1354, device='cuda:0')
benign distance is  tensor(12.1354, device='cuda:0')
norm1 res is  tensor(0.1421, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.2705207839608192
distance 1 is tensor(132.1810, device='cuda:0')
distance 2 is tensor(10.0853, device='cuda:0')
benign distance is  tensor(10.0853, device='cuda:0')
norm1 res is  tensor(0.1497, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.8327281847596169
distance 1 is tensor(140.7671, device='cuda:0')
distance 2 is tensor(10.4755, device='cuda:0')
benign distance is  tensor(10.4755, device='cuda:0')
norm1 res is  tensor(0.1576, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.9845925290137529
distance 1 is tensor(135.6565, device='cuda:0')
distance 2 is tensor(10.1197, device='cuda:0')
benign distance is  tensor(10.1197, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5406012637540698
distance 1 is tensor(141.0405, device='cuda:0')
distance 2 is tensor(10.2805, device='cuda:0')
benign distance is  tensor(10.2805, device='cuda:0')
norm1 res is  tensor(0.1560, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  1.0387450065463781
distance 1 is tensor(208.4987, device='cuda:0')
distance 2 is tensor(15.2678, device='cuda:0')
benign distance is  tensor(15.2678, device='cuda:0')
norm1 res is  tensor(0.1878, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7543672081083059
distance 1 is tensor(144.3000, device='cuda:0')
distance 2 is tensor(10.9089, device='cuda:0')
benign distance is  tensor(10.9089, device='cuda:0')
norm1 res is  tensor(0.1751, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.1816489025950432
distance 1 is tensor(129.3600, device='cuda:0')
distance 2 is tensor(9.4489, device='cuda:0')
benign distance is  tensor(9.4489, device='cuda:0')
norm1 res is  tensor(0.1763, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.7636212576180696
distance 1 is tensor(179.4036, device='cuda:0')
distance 2 is tensor(13.1723, device='cuda:0')
benign distance is  tensor(13.1723, device='cuda:0')
norm1 res is  tensor(0.1748, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.9851496890187263
distance 1 is tensor(165.7296, device='cuda:0')
distance 2 is tensor(12.3392, device='cuda:0')
benign distance is  tensor(12.3392, device='cuda:0')
norm1 res is  tensor(0.1247, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.6189300548285246
distance 1 is tensor(135.0974, device='cuda:0')
distance 2 is tensor(10.0726, device='cuda:0')
benign distance is  tensor(10.0726, device='cuda:0')
norm1 res is  tensor(0.1426, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.7578304279595613
distance 1 is tensor(95.5723, device='cuda:0')
distance 2 is tensor(7.1172, device='cuda:0')
benign distance is  tensor(7.1172, device='cuda:0')
norm1 res is  tensor(0.1215, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  1.2164445370435715
distance 1 is tensor(119.5289, device='cuda:0')
distance 2 is tensor(8.9241, device='cuda:0')
benign distance is  tensor(8.9241, device='cuda:0')
norm1 res is  tensor(0.2440, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6709105130285025
distance 1 is tensor(135.6927, device='cuda:0')
distance 2 is tensor(10.1899, device='cuda:0')
benign distance is  tensor(10.1899, device='cuda:0')
norm1 res is  tensor(0.1657, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(267.8029, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(285.7978, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(406.4336, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(730.3478, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(177.0423, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(218.9178, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(274.5378, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(254.8080, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4901.3584, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4966.7886, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4912.9448, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4911.9609, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4920.0698, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4935.6377, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4951.2231, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4916.4248, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4930.2715, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4926.3838, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4923.8403, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4976.7949, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(579.2774, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(568.4822, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(602.7051, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(669.5290, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(352.4527, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1069.5371, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(746.9154, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(621.3205, device='cuda:0')
norm_2 is  tensor(303.2878, device='cuda:0')
norm_2 * lamda is tensor(545.9180, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 86.71% 

Test Accuracy: 88.30% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6673053856939077
distance 1 is tensor(68.2937, device='cuda:0')
distance 2 is tensor(5.1909, device='cuda:0')
benign distance is  tensor(5.1909, device='cuda:0')
norm1 res is  tensor(0.0553, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6862831097096205
distance 1 is tensor(61.8547, device='cuda:0')
distance 2 is tensor(4.7279, device='cuda:0')
benign distance is  tensor(4.7279, device='cuda:0')
norm1 res is  tensor(0.0844, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6083748824894428
distance 1 is tensor(119.9860, device='cuda:0')
distance 2 is tensor(8.8974, device='cuda:0')
benign distance is  tensor(8.8974, device='cuda:0')
norm1 res is  tensor(0.2264, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.152739305049181
distance 1 is tensor(175.9116, device='cuda:0')
distance 2 is tensor(12.8545, device='cuda:0')
benign distance is  tensor(12.8545, device='cuda:0')
norm1 res is  tensor(0.1234, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9897884912788868
distance 1 is tensor(62.3279, device='cuda:0')
distance 2 is tensor(4.7744, device='cuda:0')
benign distance is  tensor(4.7744, device='cuda:0')
norm1 res is  tensor(0.0676, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7088328786194324
distance 1 is tensor(54.7206, device='cuda:0')
distance 2 is tensor(4.1696, device='cuda:0')
benign distance is  tensor(4.1696, device='cuda:0')
norm1 res is  tensor(0.0922, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.5279858149588108
distance 1 is tensor(66.2378, device='cuda:0')
distance 2 is tensor(5.0613, device='cuda:0')
benign distance is  tensor(5.0613, device='cuda:0')
norm1 res is  tensor(0.0772, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7899571098387241
distance 1 is tensor(69.7379, device='cuda:0')
distance 2 is tensor(5.3720, device='cuda:0')
benign distance is  tensor(5.3720, device='cuda:0')
norm1 res is  tensor(0.1123, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.9573128391057253
distance 1 is tensor(106.2803, device='cuda:0')
distance 2 is tensor(8.0872, device='cuda:0')
benign distance is  tensor(8.0872, device='cuda:0')
norm1 res is  tensor(0.1569, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7485305154696107
distance 1 is tensor(138.5930, device='cuda:0')
distance 2 is tensor(10.1672, device='cuda:0')
benign distance is  tensor(10.1672, device='cuda:0')
norm1 res is  tensor(0.1783, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.3899600803852081
distance 1 is tensor(162.3984, device='cuda:0')
distance 2 is tensor(11.8810, device='cuda:0')
benign distance is  tensor(11.8810, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.1083179004490376
distance 1 is tensor(156.8260, device='cuda:0')
distance 2 is tensor(11.7842, device='cuda:0')
benign distance is  tensor(11.7842, device='cuda:0')
norm1 res is  tensor(0.1413, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.0233436357229948
distance 1 is tensor(79.8839, device='cuda:0')
distance 2 is tensor(6.0088, device='cuda:0')
benign distance is  tensor(6.0088, device='cuda:0')
norm1 res is  tensor(0.1046, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.0000555384904146
distance 1 is tensor(242.9314, device='cuda:0')
distance 2 is tensor(17.6271, device='cuda:0')
benign distance is  tensor(17.6271, device='cuda:0')
norm1 res is  tensor(0.1322, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.6990604810416698
distance 1 is tensor(187.5271, device='cuda:0')
distance 2 is tensor(13.6896, device='cuda:0')
benign distance is  tensor(13.6896, device='cuda:0')
norm1 res is  tensor(0.1194, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.9076251536607742
distance 1 is tensor(118.2640, device='cuda:0')
distance 2 is tensor(8.7040, device='cuda:0')
benign distance is  tensor(8.7040, device='cuda:0')
norm1 res is  tensor(0.1030, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(290.4048, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(275.4276, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(527.2556, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(785.0905, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(273.0155, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(232.7157, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(290.1158, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(307.4111, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4923.8276, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4981.2075, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4932.1802, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4957.0850, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4947.2090, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4966.5298, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4963.4370, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4940.3096, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4958.0938, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4937.8652, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4945.4062, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4987.0947, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(494.2915, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(584.3613, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(285.0187, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(560.9385, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(929.1450, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(230.8884, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(621.1977, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(672.5416, device='cuda:0')
norm_2 is  tensor(474.1144, device='cuda:0')
norm_2 * lamda is tensor(853.4059, device='cuda:0')
satisfying 27
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 84.98% 

Test Accuracy: 88.05% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
 benign loss is  0.698844226077199
distance 1 is tensor(62.6116, device='cuda:0')
distance 2 is tensor(4.8841, device='cuda:0')
benign distance is  tensor(4.8841, device='cuda:0')
norm1 res is  tensor(0.0517, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8893384020775557
distance 1 is tensor(92.8737, device='cuda:0')
distance 2 is tensor(6.9087, device='cuda:0')
benign distance is  tensor(6.9087, device='cuda:0')
norm1 res is  tensor(0.1233, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7760246321558952
distance 1 is tensor(100.8668, device='cuda:0')
distance 2 is tensor(7.5428, device='cuda:0')
benign distance is  tensor(7.5428, device='cuda:0')
norm1 res is  tensor(0.1920, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  2.0101199857890606
distance 1 is tensor(152.9441, device='cuda:0')
distance 2 is tensor(11.3515, device='cuda:0')
benign distance is  tensor(11.3515, device='cuda:0')
norm1 res is  tensor(0.1101, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9092476516962051
distance 1 is tensor(58.1467, device='cuda:0')
distance 2 is tensor(4.5885, device='cuda:0')
benign distance is  tensor(4.5885, device='cuda:0')
norm1 res is  tensor(0.0608, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7102903025224805
distance 1 is tensor(64.1953, device='cuda:0')
distance 2 is tensor(4.8015, device='cuda:0')
benign distance is  tensor(4.8015, device='cuda:0')
norm1 res is  tensor(0.1081, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.9464377602562308
distance 1 is tensor(58.1011, device='cuda:0')
distance 2 is tensor(4.5656, device='cuda:0')
benign distance is  tensor(4.5656, device='cuda:0')
norm1 res is  tensor(0.0674, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8199208714067936
distance 1 is tensor(56.9690, device='cuda:0')
distance 2 is tensor(4.4775, device='cuda:0')
benign distance is  tensor(4.4775, device='cuda:0')
norm1 res is  tensor(0.0959, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.164886087179184
distance 1 is tensor(107.8339, device='cuda:0')
distance 2 is tensor(7.9226, device='cuda:0')
benign distance is  tensor(7.9226, device='cuda:0')
norm1 res is  tensor(0.1198, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7839661929756403
distance 1 is tensor(141.9562, device='cuda:0')
distance 2 is tensor(10.4306, device='cuda:0')
benign distance is  tensor(10.4306, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9402788300067186
distance 1 is tensor(52.7656, device='cuda:0')
distance 2 is tensor(4.2515, device='cuda:0')
benign distance is  tensor(4.2515, device='cuda:0')
norm1 res is  tensor(0.0736, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.1587873436510563
distance 1 is tensor(109.3581, device='cuda:0')
distance 2 is tensor(8.2198, device='cuda:0')
benign distance is  tensor(8.2198, device='cuda:0')
norm1 res is  tensor(0.1132, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.1853873748332262
distance 1 is tensor(182.5724, device='cuda:0')
distance 2 is tensor(13.1782, device='cuda:0')
benign distance is  tensor(13.1782, device='cuda:0')
norm1 res is  tensor(0.1205, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6727356109768152
distance 1 is tensor(45.6352, device='cuda:0')
distance 2 is tensor(3.7345, device='cuda:0')
benign distance is  tensor(3.7345, device='cuda:0')
norm1 res is  tensor(0.1357, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.6627327166497707
distance 1 is tensor(151.5611, device='cuda:0')
distance 2 is tensor(11.1588, device='cuda:0')
benign distance is  tensor(11.1588, device='cuda:0')
norm1 res is  tensor(0.1525, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.9327664002776146
distance 1 is tensor(150.5807, device='cuda:0')
distance 2 is tensor(11.2010, device='cuda:0')
benign distance is  tensor(11.2010, device='cuda:0')
norm1 res is  tensor(0.1475, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(273.9446, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(405.0242, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(450.3484, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(680.6889, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(248.4567, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(272.0125, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(248.9119, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(247.8335, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4933.4570, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4992.4067, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4948.8228, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4945.2256, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4953.3691, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4979.9688, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4975.6919, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4946.9331, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4979.5664, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4951.4297, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4959.0029, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5006.6050, device='cuda:0')
norm_2 is  tensor(371.7115, device='cuda:0')
norm_2 * lamda is tensor(669.0807, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 87.35% 

Test Accuracy: 88.67% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7763973996043205
distance 1 is tensor(74.6744, device='cuda:0')
distance 2 is tensor(5.7139, device='cuda:0')
benign distance is  tensor(5.7139, device='cuda:0')
norm1 res is  tensor(0.0626, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.0090793557465076
distance 1 is tensor(64.9566, device='cuda:0')
distance 2 is tensor(5.1178, device='cuda:0')
benign distance is  tensor(5.1178, device='cuda:0')
norm1 res is  tensor(0.0909, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7454706020653248
distance 1 is tensor(78.3361, device='cuda:0')
distance 2 is tensor(5.9464, device='cuda:0')
benign distance is  tensor(5.9464, device='cuda:0')
norm1 res is  tensor(0.1498, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0516914762556553
distance 1 is tensor(193.1128, device='cuda:0')
distance 2 is tensor(14.0295, device='cuda:0')
benign distance is  tensor(14.0295, device='cuda:0')
norm1 res is  tensor(0.1331, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8426786363124847
distance 1 is tensor(64.4269, device='cuda:0')
distance 2 is tensor(5.1273, device='cuda:0')
benign distance is  tensor(5.1273, device='cuda:0')
norm1 res is  tensor(0.0695, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.758269986603409
distance 1 is tensor(57.5562, device='cuda:0')
distance 2 is tensor(4.3093, device='cuda:0')
benign distance is  tensor(4.3093, device='cuda:0')
norm1 res is  tensor(0.0959, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.3751072734594345
distance 1 is tensor(67.5752, device='cuda:0')
distance 2 is tensor(5.2026, device='cuda:0')
benign distance is  tensor(5.2026, device='cuda:0')
norm1 res is  tensor(0.0793, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7476560370996594
distance 1 is tensor(54.8246, device='cuda:0')
distance 2 is tensor(4.0908, device='cuda:0')
benign distance is  tensor(4.0908, device='cuda:0')
norm1 res is  tensor(0.0902, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(327.9081, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(293.4689, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(349.6187, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(847.7559, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(284.8168, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(243.1560, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(293.5605, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(234.2801, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4956.3091, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5015.6890, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4987.9307, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4972.5649, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4971.2349, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5004.0239, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4990.3872, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4973.2856, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4992.5454, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4966.8936, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4978.9600, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5023.4785, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(630.8289, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(796.8032, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(847.6116, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(600.7560, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(943.5908, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(737.5051, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(600.7108, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(713.2342, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(671.7524, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(485.8597, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(735.3607, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(606.8056, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(637.6024, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(627.7353, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(619.3771, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(930.5813, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(485.3954, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(626.4157, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(696.3444, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(687.8447, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(376.3822, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1077.7179, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(808.6152, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(536.4690, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(472.0526, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(631.9564, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(257.5396, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(492.6179, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(806.8028, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(231.1483, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(685.9604, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(674.0259, device='cuda:0')
norm_2 is  tensor(321.0965, device='cuda:0')
norm_2 * lamda is tensor(577.9736, device='cuda:0')
do  not satisfying 51
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 84.61% 

Test Accuracy: 88.00% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
 benign loss is  0.630851635709405
distance 1 is tensor(102.2745, device='cuda:0')
distance 2 is tensor(7.6390, device='cuda:0')
benign distance is  tensor(7.6390, device='cuda:0')
norm1 res is  tensor(0.0864, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7050231173634529
distance 1 is tensor(86.8878, device='cuda:0')
distance 2 is tensor(6.3917, device='cuda:0')
benign distance is  tensor(6.3917, device='cuda:0')
norm1 res is  tensor(0.1177, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8093833271414042
distance 1 is tensor(106.6137, device='cuda:0')
distance 2 is tensor(7.8125, device='cuda:0')
benign distance is  tensor(7.8125, device='cuda:0')
norm1 res is  tensor(0.1965, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.6082815676927567
distance 1 is tensor(173.4066, device='cuda:0')
distance 2 is tensor(12.6294, device='cuda:0')
benign distance is  tensor(12.6294, device='cuda:0')
norm1 res is  tensor(0.1234, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8479261789470911
distance 1 is tensor(61.4616, device='cuda:0')
distance 2 is tensor(4.8524, device='cuda:0')
benign distance is  tensor(4.8524, device='cuda:0')
norm1 res is  tensor(0.0665, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.891784998588264
distance 1 is tensor(87.2086, device='cuda:0')
distance 2 is tensor(6.4660, device='cuda:0')
benign distance is  tensor(6.4660, device='cuda:0')
norm1 res is  tensor(0.1555, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.0670062005519867
distance 1 is tensor(66.1886, device='cuda:0')
distance 2 is tensor(5.0714, device='cuda:0')
benign distance is  tensor(5.0714, device='cuda:0')
norm1 res is  tensor(0.0789, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7680861810222268
distance 1 is tensor(55.5093, device='cuda:0')
distance 2 is tensor(4.3840, device='cuda:0')
benign distance is  tensor(4.3840, device='cuda:0')
norm1 res is  tensor(0.0903, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.5346097014844418
distance 1 is tensor(140.8806, device='cuda:0')
distance 2 is tensor(10.4208, device='cuda:0')
benign distance is  tensor(10.4208, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9151414856314659
distance 1 is tensor(139.1809, device='cuda:0')
distance 2 is tensor(10.2436, device='cuda:0')
benign distance is  tensor(10.2436, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9072205927222967
distance 1 is tensor(57.1251, device='cuda:0')
distance 2 is tensor(4.5780, device='cuda:0')
benign distance is  tensor(4.5780, device='cuda:0')
norm1 res is  tensor(0.0823, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.1380798481404781
distance 1 is tensor(117.2722, device='cuda:0')
distance 2 is tensor(8.9650, device='cuda:0')
benign distance is  tensor(8.9650, device='cuda:0')
norm1 res is  tensor(0.1255, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.7107246108353138
distance 1 is tensor(209.9997, device='cuda:0')
distance 2 is tensor(14.8618, device='cuda:0')
benign distance is  tensor(14.8618, device='cuda:0')
norm1 res is  tensor(0.1371, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.8885142859071493
distance 1 is tensor(55.0612, device='cuda:0')
distance 2 is tensor(4.2085, device='cuda:0')
benign distance is  tensor(4.2085, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.2102436199784279
distance 1 is tensor(171.7511, device='cuda:0')
distance 2 is tensor(12.3790, device='cuda:0')
benign distance is  tensor(12.3790, device='cuda:0')
norm1 res is  tensor(0.1736, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  2.249374531209469
distance 1 is tensor(173.8967, device='cuda:0')
distance 2 is tensor(12.7339, device='cuda:0')
benign distance is  tensor(12.7339, device='cuda:0')
norm1 res is  tensor(0.1667, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.4320653416216373
distance 1 is tensor(136.8664, device='cuda:0')
distance 2 is tensor(10.2607, device='cuda:0')
benign distance is  tensor(10.2607, device='cuda:0')
norm1 res is  tensor(0.2055, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.991985771805048
distance 1 is tensor(154.2520, device='cuda:0')
distance 2 is tensor(11.2981, device='cuda:0')
benign distance is  tensor(11.2981, device='cuda:0')
norm1 res is  tensor(0.1978, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.1376832406967878
distance 1 is tensor(140.3935, device='cuda:0')
distance 2 is tensor(10.4184, device='cuda:0')
benign distance is  tensor(10.4184, device='cuda:0')
norm1 res is  tensor(0.1474, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.1485525891184807
distance 1 is tensor(146.2066, device='cuda:0')
distance 2 is tensor(10.9206, device='cuda:0')
benign distance is  tensor(10.9206, device='cuda:0')
norm1 res is  tensor(0.1369, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9745931196957827
distance 1 is tensor(71.8247, device='cuda:0')
distance 2 is tensor(5.4205, device='cuda:0')
benign distance is  tensor(5.4205, device='cuda:0')
norm1 res is  tensor(0.0904, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8438821565359831
distance 1 is tensor(255.9017, device='cuda:0')
distance 2 is tensor(18.5753, device='cuda:0')
benign distance is  tensor(18.5753, device='cuda:0')
norm1 res is  tensor(0.1384, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.2853849343955517
distance 1 is tensor(178.0597, device='cuda:0')
distance 2 is tensor(13.2291, device='cuda:0')
benign distance is  tensor(13.2291, device='cuda:0')
norm1 res is  tensor(0.1172, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.888696763664484
distance 1 is tensor(127.5286, device='cuda:0')
distance 2 is tensor(9.4348, device='cuda:0')
benign distance is  tensor(9.4348, device='cuda:0')
norm1 res is  tensor(0.1124, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.652052752673626
distance 1 is tensor(161.7861, device='cuda:0')
distance 2 is tensor(12.0459, device='cuda:0')
benign distance is  tensor(12.0459, device='cuda:0')
norm1 res is  tensor(0.1824, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  1.9439545050263405
distance 1 is tensor(116.2113, device='cuda:0')
distance 2 is tensor(9.1520, device='cuda:0')
benign distance is  tensor(9.1520, device='cuda:0')
norm1 res is  tensor(0.3432, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.2401522025465965
distance 1 is tensor(173.5999, device='cuda:0')
distance 2 is tensor(12.8657, device='cuda:0')
benign distance is  tensor(12.8657, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.6041285209357738
distance 1 is tensor(135.0121, device='cuda:0')
distance 2 is tensor(10.0112, device='cuda:0')
benign distance is  tensor(10.0112, device='cuda:0')
norm1 res is  tensor(0.1474, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.7310853693634272
distance 1 is tensor(165.4824, device='cuda:0')
distance 2 is tensor(12.2388, device='cuda:0')
benign distance is  tensor(12.2388, device='cuda:0')
norm1 res is  tensor(0.1869, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8174575725570321
distance 1 is tensor(142.3911, device='cuda:0')
distance 2 is tensor(10.5814, device='cuda:0')
benign distance is  tensor(10.5814, device='cuda:0')
norm1 res is  tensor(0.1496, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5881170835345984
distance 1 is tensor(167.1578, device='cuda:0')
distance 2 is tensor(12.1667, device='cuda:0')
benign distance is  tensor(12.1667, device='cuda:0')
norm1 res is  tensor(0.1851, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.905305614694953
distance 1 is tensor(215.9615, device='cuda:0')
distance 2 is tensor(15.6498, device='cuda:0')
benign distance is  tensor(15.6498, device='cuda:0')
norm1 res is  tensor(0.1908, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.512887142598629
distance 1 is tensor(158.9107, device='cuda:0')
distance 2 is tensor(11.8333, device='cuda:0')
benign distance is  tensor(11.8333, device='cuda:0')
norm1 res is  tensor(0.1663, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.3731181118637323
distance 1 is tensor(186.3218, device='cuda:0')
distance 2 is tensor(13.9765, device='cuda:0')
benign distance is  tensor(13.9765, device='cuda:0')
norm1 res is  tensor(0.1879, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.4436147809028625
distance 1 is tensor(190.1822, device='cuda:0')
distance 2 is tensor(13.9334, device='cuda:0')
benign distance is  tensor(13.9334, device='cuda:0')
norm1 res is  tensor(0.1335, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.8506222348660231
distance 1 is tensor(128.2906, device='cuda:0')
distance 2 is tensor(9.7400, device='cuda:0')
benign distance is  tensor(9.7400, device='cuda:0')
norm1 res is  tensor(0.2982, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.8000533189624548
distance 1 is tensor(218.2382, device='cuda:0')
distance 2 is tensor(15.9577, device='cuda:0')
benign distance is  tensor(15.9577, device='cuda:0')
norm1 res is  tensor(0.2088, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.8608294744044542
distance 1 is tensor(178.5073, device='cuda:0')
distance 2 is tensor(13.1487, device='cuda:0')
benign distance is  tensor(13.1487, device='cuda:0')
norm1 res is  tensor(0.2150, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8953656498342752
distance 1 is tensor(137.8844, device='cuda:0')
distance 2 is tensor(10.3280, device='cuda:0')
benign distance is  tensor(10.3280, device='cuda:0')
norm1 res is  tensor(0.1950, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5244298805482686
distance 1 is tensor(176.8372, device='cuda:0')
distance 2 is tensor(12.9217, device='cuda:0')
benign distance is  tensor(12.9217, device='cuda:0')
norm1 res is  tensor(0.1971, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(453.5634, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(375.5204, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(453.4397, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(766.0473, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(274.8299, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(385.1600, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(299.0990, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(246.0508, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4952.1699, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5021.5806, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4971.0059, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4967.7930, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4959.3550, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4989.1406, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4999.3330, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4977.3672, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4994.3130, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4971.2383, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4991.4282, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5039.0894, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(646.5102, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(569.4418, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(795.5287, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(740.8656, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(592.3207, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(442.2676, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(544.4055, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(615.9333, device='cuda:0')
norm_2 is  tensor(301.1102, device='cuda:0')
norm_2 * lamda is tensor(541.9984, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 86.71% 

Test Accuracy: 88.52% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6273069735616446
distance 1 is tensor(81.5137, device='cuda:0')
distance 2 is tensor(6.2721, device='cuda:0')
benign distance is  tensor(6.2721, device='cuda:0')
norm1 res is  tensor(0.0708, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.806488486006856
distance 1 is tensor(61.5614, device='cuda:0')
distance 2 is tensor(4.7407, device='cuda:0')
benign distance is  tensor(4.7407, device='cuda:0')
norm1 res is  tensor(0.0814, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  1.0378228705376387
distance 1 is tensor(106.3460, device='cuda:0')
distance 2 is tensor(7.8920, device='cuda:0')
benign distance is  tensor(7.8920, device='cuda:0')
norm1 res is  tensor(0.2039, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0733261331915855
distance 1 is tensor(166.1165, device='cuda:0')
distance 2 is tensor(12.1873, device='cuda:0')
benign distance is  tensor(12.1873, device='cuda:0')
norm1 res is  tensor(0.1179, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8406090084463358
distance 1 is tensor(50.5466, device='cuda:0')
distance 2 is tensor(3.9799, device='cuda:0')
benign distance is  tensor(3.9799, device='cuda:0')
norm1 res is  tensor(0.0567, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6732448041439056
distance 1 is tensor(80.0634, device='cuda:0')
distance 2 is tensor(6.1648, device='cuda:0')
benign distance is  tensor(6.1648, device='cuda:0')
norm1 res is  tensor(0.1409, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4171470943838358
distance 1 is tensor(72.2505, device='cuda:0')
distance 2 is tensor(5.5865, device='cuda:0')
benign distance is  tensor(5.5865, device='cuda:0')
norm1 res is  tensor(0.0869, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6549262003973126
distance 1 is tensor(54.6911, device='cuda:0')
distance 2 is tensor(4.2604, device='cuda:0')
benign distance is  tensor(4.2604, device='cuda:0')
norm1 res is  tensor(0.0867, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.8714528642594814
distance 1 is tensor(179.1290, device='cuda:0')
distance 2 is tensor(13.4051, device='cuda:0')
benign distance is  tensor(13.4051, device='cuda:0')
norm1 res is  tensor(0.2170, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.1801250856369734
distance 1 is tensor(130.8449, device='cuda:0')
distance 2 is tensor(9.5747, device='cuda:0')
benign distance is  tensor(9.5747, device='cuda:0')
norm1 res is  tensor(0.1797, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.8307441379874945
distance 1 is tensor(190.7161, device='cuda:0')
distance 2 is tensor(14.2127, device='cuda:0')
benign distance is  tensor(14.2127, device='cuda:0')
norm1 res is  tensor(0.1851, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.9967380799353123
distance 1 is tensor(169.1340, device='cuda:0')
distance 2 is tensor(12.3108, device='cuda:0')
benign distance is  tensor(12.3108, device='cuda:0')
norm1 res is  tensor(0.1241, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.7324460223317146
distance 1 is tensor(142.7063, device='cuda:0')
distance 2 is tensor(10.5204, device='cuda:0')
benign distance is  tensor(10.5204, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  1.1383536346256733
distance 1 is tensor(116.0769, device='cuda:0')
distance 2 is tensor(8.5663, device='cuda:0')
benign distance is  tensor(8.5663, device='cuda:0')
norm1 res is  tensor(0.1508, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  1.50496931001544
distance 1 is tensor(113.5572, device='cuda:0')
distance 2 is tensor(8.5544, device='cuda:0')
benign distance is  tensor(8.5544, device='cuda:0')
norm1 res is  tensor(0.2376, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6703465357422829
distance 1 is tensor(146.5567, device='cuda:0')
distance 2 is tensor(10.8871, device='cuda:0')
benign distance is  tensor(10.8871, device='cuda:0')
norm1 res is  tensor(0.1773, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(357.9304, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(266.8976, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(460.8792, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(745.8213, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(222.7883, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(363.7580, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(326.8060, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(234.1370, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4982.1963, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5026.8223, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5006.5454, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4994.3452, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4989.8774, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5013.1128, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5017.4932, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4984.4199, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5005.5537, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4984.9375, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5001.2754, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5049.5229, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(636.4146, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(629.9141, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(280.6536, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(546.8155, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(914.2311, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(252.6245, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(755.2159, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(759.1996, device='cuda:0')
norm_2 is  tensor(382.3458, device='cuda:0')
norm_2 * lamda is tensor(688.2224, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 86.33% 

Test Accuracy: 88.44% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6436129845678806
distance 1 is tensor(67.1743, device='cuda:0')
distance 2 is tensor(5.0304, device='cuda:0')
benign distance is  tensor(5.0304, device='cuda:0')
norm1 res is  tensor(0.0622, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.047170901671052
distance 1 is tensor(62.6732, device='cuda:0')
distance 2 is tensor(4.7597, device='cuda:0')
benign distance is  tensor(4.7597, device='cuda:0')
norm1 res is  tensor(0.0851, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9677723413333297
distance 1 is tensor(72.6915, device='cuda:0')
distance 2 is tensor(5.4304, device='cuda:0')
benign distance is  tensor(5.4304, device='cuda:0')
norm1 res is  tensor(0.1436, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.5056541226804256
distance 1 is tensor(175.7903, device='cuda:0')
distance 2 is tensor(12.8108, device='cuda:0')
benign distance is  tensor(12.8108, device='cuda:0')
norm1 res is  tensor(0.1241, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9617746938019991
distance 1 is tensor(65.3087, device='cuda:0')
distance 2 is tensor(4.9402, device='cuda:0')
benign distance is  tensor(4.9402, device='cuda:0')
norm1 res is  tensor(0.0668, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8031500729266554
distance 1 is tensor(47.0666, device='cuda:0')
distance 2 is tensor(3.6615, device='cuda:0')
benign distance is  tensor(3.6615, device='cuda:0')
norm1 res is  tensor(0.0795, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.9213257702067494
distance 1 is tensor(61.1836, device='cuda:0')
distance 2 is tensor(4.7433, device='cuda:0')
benign distance is  tensor(4.7433, device='cuda:0')
norm1 res is  tensor(0.0751, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8035177616402507
distance 1 is tensor(60.7473, device='cuda:0')
distance 2 is tensor(4.7038, device='cuda:0')
benign distance is  tensor(4.7038, device='cuda:0')
norm1 res is  tensor(0.1005, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.3709734193980694
distance 1 is tensor(106.5330, device='cuda:0')
distance 2 is tensor(8.2166, device='cuda:0')
benign distance is  tensor(8.2166, device='cuda:0')
norm1 res is  tensor(0.1244, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0017242841422558
distance 1 is tensor(155.4001, device='cuda:0')
distance 2 is tensor(11.2581, device='cuda:0')
benign distance is  tensor(11.2581, device='cuda:0')
norm1 res is  tensor(0.1638, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0619226358830929
distance 1 is tensor(66.9795, device='cuda:0')
distance 2 is tensor(5.2709, device='cuda:0')
benign distance is  tensor(5.2709, device='cuda:0')
norm1 res is  tensor(0.0933, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0130546782165766
distance 1 is tensor(118.3639, device='cuda:0')
distance 2 is tensor(8.9414, device='cuda:0')
benign distance is  tensor(8.9414, device='cuda:0')
norm1 res is  tensor(0.1228, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.4417113550007343
distance 1 is tensor(225.8502, device='cuda:0')
distance 2 is tensor(16.4241, device='cuda:0')
benign distance is  tensor(16.4241, device='cuda:0')
norm1 res is  tensor(0.1495, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.8345325067639351
distance 1 is tensor(54.9238, device='cuda:0')
distance 2 is tensor(4.3459, device='cuda:0')
benign distance is  tensor(4.3459, device='cuda:0')
norm1 res is  tensor(0.1600, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.4878034871071577
distance 1 is tensor(159.1868, device='cuda:0')
distance 2 is tensor(11.3734, device='cuda:0')
benign distance is  tensor(11.3734, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.403204932808876
distance 1 is tensor(150.8122, device='cuda:0')
distance 2 is tensor(11.2411, device='cuda:0')
benign distance is  tensor(11.2411, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(276.9758, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(276.5361, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(316.4748, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(779.9095, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(275.4786, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(205.6881, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(270.5616, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(273.0526, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4978.2822, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5044.2129, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5000.3687, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5034.3184, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4992.4844, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5032.7925, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5016.7104, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4994.4077, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5028.6895, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4992.4644, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5001.8486, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5061.7197, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(621.1328, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(684.1881, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(635.9902, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(664.7023, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(324.1518, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1129.2382, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(789.6586, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(577.6960, device='cuda:0')
norm_2 is  tensor(266.5178, device='cuda:0')
norm_2 * lamda is tensor(479.7321, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 86.40% 

Test Accuracy: 88.31% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
 benign loss is  0.801779655739665
distance 1 is tensor(75.4290, device='cuda:0')
distance 2 is tensor(5.7170, device='cuda:0')
benign distance is  tensor(5.7170, device='cuda:0')
norm1 res is  tensor(0.0644, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8992627449333668
distance 1 is tensor(69.1992, device='cuda:0')
distance 2 is tensor(5.2830, device='cuda:0')
benign distance is  tensor(5.2830, device='cuda:0')
norm1 res is  tensor(0.0953, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7635512854903936
distance 1 is tensor(91.0007, device='cuda:0')
distance 2 is tensor(6.6533, device='cuda:0')
benign distance is  tensor(6.6533, device='cuda:0')
norm1 res is  tensor(0.1836, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.302139800041914
distance 1 is tensor(188.5069, device='cuda:0')
distance 2 is tensor(13.5831, device='cuda:0')
benign distance is  tensor(13.5831, device='cuda:0')
norm1 res is  tensor(0.1292, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.2023339606821537
distance 1 is tensor(68.2961, device='cuda:0')
distance 2 is tensor(5.4131, device='cuda:0')
benign distance is  tensor(5.4131, device='cuda:0')
norm1 res is  tensor(0.0757, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7783552543260157
distance 1 is tensor(45.7573, device='cuda:0')
distance 2 is tensor(3.4883, device='cuda:0')
benign distance is  tensor(3.4883, device='cuda:0')
norm1 res is  tensor(0.0790, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4840726219117641
distance 1 is tensor(80.6014, device='cuda:0')
distance 2 is tensor(6.2333, device='cuda:0')
benign distance is  tensor(6.2333, device='cuda:0')
norm1 res is  tensor(0.0991, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.9141589719802141
distance 1 is tensor(72.1666, device='cuda:0')
distance 2 is tensor(5.5018, device='cuda:0')
benign distance is  tensor(5.5018, device='cuda:0')
norm1 res is  tensor(0.1201, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.619646742939949
distance 1 is tensor(158.1223, device='cuda:0')
distance 2 is tensor(11.7622, device='cuda:0')
benign distance is  tensor(11.7622, device='cuda:0')
norm1 res is  tensor(0.2394, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  1.0094928815960884
distance 1 is tensor(138.9493, device='cuda:0')
distance 2 is tensor(10.2808, device='cuda:0')
benign distance is  tensor(10.2808, device='cuda:0')
norm1 res is  tensor(0.1810, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.9706319868564606
distance 1 is tensor(161.6682, device='cuda:0')
distance 2 is tensor(11.7737, device='cuda:0')
benign distance is  tensor(11.7737, device='cuda:0')
norm1 res is  tensor(0.1618, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.251650433987379
distance 1 is tensor(163.8728, device='cuda:0')
distance 2 is tensor(12.1749, device='cuda:0')
benign distance is  tensor(12.1749, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.06155476719141
distance 1 is tensor(99.6522, device='cuda:0')
distance 2 is tensor(7.3533, device='cuda:0')
benign distance is  tensor(7.3533, device='cuda:0')
norm1 res is  tensor(0.1328, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9587829597294331
distance 1 is tensor(261.0981, device='cuda:0')
distance 2 is tensor(18.9536, device='cuda:0')
benign distance is  tensor(18.9536, device='cuda:0')
norm1 res is  tensor(0.1404, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.4117695577442646
distance 1 is tensor(196.6199, device='cuda:0')
distance 2 is tensor(14.5516, device='cuda:0')
benign distance is  tensor(14.5516, device='cuda:0')
norm1 res is  tensor(0.1271, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.25055430829525
distance 1 is tensor(144.3573, device='cuda:0')
distance 2 is tensor(10.7485, device='cuda:0')
benign distance is  tensor(10.7485, device='cuda:0')
norm1 res is  tensor(0.1294, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(337.2905, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(306.3035, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(384.8184, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(822.3148, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(308.5344, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(199.4784, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(367.7673, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(321.7134, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5004.6152, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5052.7280, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5002.5371, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5012.3037, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5010.3115, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5033.7656, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5032.6909, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5015.6660, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5030.8872, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5015.5776, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5021.5449, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5055.5376, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(725.3232, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(552.5477, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(783.4888, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(592.4562, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(745.3721, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(646.7286, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(724.7463, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(949.5933, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(488.2686, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(682.0525, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(313.2760, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(533.6699, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(1005.6824, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(264.8871, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(685.1437, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(665.7774, device='cuda:0')
norm_2 is  tensor(258.2612, device='cuda:0')
norm_2 * lamda is tensor(464.8702, device='cuda:0')
do  not satisfying 35
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 86.14% 

Test Accuracy: 88.37% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7596768159419298
distance 1 is tensor(80.6159, device='cuda:0')
distance 2 is tensor(6.2254, device='cuda:0')
benign distance is  tensor(6.2254, device='cuda:0')
norm1 res is  tensor(0.0718, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.764039633795619
distance 1 is tensor(53.5764, device='cuda:0')
distance 2 is tensor(4.0674, device='cuda:0')
benign distance is  tensor(4.0674, device='cuda:0')
norm1 res is  tensor(0.0766, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.770592225715518
distance 1 is tensor(102.4863, device='cuda:0')
distance 2 is tensor(7.6143, device='cuda:0')
benign distance is  tensor(7.6143, device='cuda:0')
norm1 res is  tensor(0.1896, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.44275626167655
distance 1 is tensor(203.3488, device='cuda:0')
distance 2 is tensor(14.9734, device='cuda:0')
benign distance is  tensor(14.9734, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9603709205985069
distance 1 is tensor(71.8075, device='cuda:0')
distance 2 is tensor(5.5244, device='cuda:0')
benign distance is  tensor(5.5244, device='cuda:0')
norm1 res is  tensor(0.0771, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6538173407316208
distance 1 is tensor(55.1975, device='cuda:0')
distance 2 is tensor(4.0850, device='cuda:0')
benign distance is  tensor(4.0850, device='cuda:0')
norm1 res is  tensor(0.0937, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.5024920105934143
distance 1 is tensor(56.5807, device='cuda:0')
distance 2 is tensor(4.5043, device='cuda:0')
benign distance is  tensor(4.5043, device='cuda:0')
norm1 res is  tensor(0.0680, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7493781466037035
distance 1 is tensor(57.9767, device='cuda:0')
distance 2 is tensor(4.5274, device='cuda:0')
benign distance is  tensor(4.5274, device='cuda:0')
norm1 res is  tensor(0.0943, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.32194185256958
distance 1 is tensor(112.6151, device='cuda:0')
distance 2 is tensor(8.4272, device='cuda:0')
benign distance is  tensor(8.4272, device='cuda:0')
norm1 res is  tensor(0.1286, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7332642236724496
distance 1 is tensor(147.7726, device='cuda:0')
distance 2 is tensor(10.8346, device='cuda:0')
benign distance is  tensor(10.8346, device='cuda:0')
norm1 res is  tensor(0.1579, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0578704588115215
distance 1 is tensor(81.2033, device='cuda:0')
distance 2 is tensor(6.1325, device='cuda:0')
benign distance is  tensor(6.1325, device='cuda:0')
norm1 res is  tensor(0.1066, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3153065145015717
distance 1 is tensor(113.9096, device='cuda:0')
distance 2 is tensor(8.6715, device='cuda:0')
benign distance is  tensor(8.6715, device='cuda:0')
norm1 res is  tensor(0.1213, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.3536378741264343
distance 1 is tensor(220.2426, device='cuda:0')
distance 2 is tensor(15.6723, device='cuda:0')
benign distance is  tensor(15.6723, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6949342293664813
distance 1 is tensor(46.2268, device='cuda:0')
distance 2 is tensor(3.6146, device='cuda:0')
benign distance is  tensor(3.6146, device='cuda:0')
norm1 res is  tensor(0.1264, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1415353007614613
distance 1 is tensor(201.3797, device='cuda:0')
distance 2 is tensor(14.5941, device='cuda:0')
benign distance is  tensor(14.5941, device='cuda:0')
norm1 res is  tensor(0.1982, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.419375453144312
distance 1 is tensor(151.3596, device='cuda:0')
distance 2 is tensor(11.1789, device='cuda:0')
benign distance is  tensor(11.1789, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.5515809617936611
distance 1 is tensor(148.0344, device='cuda:0')
distance 2 is tensor(10.9516, device='cuda:0')
benign distance is  tensor(10.9516, device='cuda:0')
norm1 res is  tensor(0.1637, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.7523806653916836
distance 1 is tensor(109.3563, device='cuda:0')
distance 2 is tensor(8.0562, device='cuda:0')
benign distance is  tensor(8.0562, device='cuda:0')
norm1 res is  tensor(0.3055, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.0515711084008217
distance 1 is tensor(180.6914, device='cuda:0')
distance 2 is tensor(13.2050, device='cuda:0')
benign distance is  tensor(13.2050, device='cuda:0')
norm1 res is  tensor(0.1527, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.5824616439640522
distance 1 is tensor(156.7827, device='cuda:0')
distance 2 is tensor(11.8307, device='cuda:0')
benign distance is  tensor(11.8307, device='cuda:0')
norm1 res is  tensor(0.1733, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.1703394036740065
distance 1 is tensor(192.4185, device='cuda:0')
distance 2 is tensor(14.1650, device='cuda:0')
benign distance is  tensor(14.1650, device='cuda:0')
norm1 res is  tensor(0.2139, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  1.1079665794968605
distance 1 is tensor(231.5089, device='cuda:0')
distance 2 is tensor(17.2449, device='cuda:0')
benign distance is  tensor(17.2449, device='cuda:0')
norm1 res is  tensor(0.2421, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5566582530736923
distance 1 is tensor(177.5787, device='cuda:0')
distance 2 is tensor(12.8870, device='cuda:0')
benign distance is  tensor(12.8870, device='cuda:0')
norm1 res is  tensor(0.1998, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  1.0501848757266998
distance 1 is tensor(242.8811, device='cuda:0')
distance 2 is tensor(17.4393, device='cuda:0')
benign distance is  tensor(17.4393, device='cuda:0')
norm1 res is  tensor(0.2136, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(375.6563, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(234.5396, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(447.6329, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(909.6400, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(316.9321, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(230.2201, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(253.8096, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(255.3580, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5004.8159, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5048.9634, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5028.5811, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5037.1602, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5019.9111, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5045.5200, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5036.3379, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5019.0859, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5041.3921, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5021.4111, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5037.8853, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5092.3809, device='cuda:0')
norm_2 is  tensor(206.7027, device='cuda:0')
norm_2 * lamda is tensor(372.0648, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 85.16% 

Test Accuracy: 87.99% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
 benign loss is  0.758065590634942
distance 1 is tensor(86.2649, device='cuda:0')
distance 2 is tensor(6.6294, device='cuda:0')
benign distance is  tensor(6.6294, device='cuda:0')
norm1 res is  tensor(0.0735, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7848369777202606
distance 1 is tensor(72.4669, device='cuda:0')
distance 2 is tensor(5.4685, device='cuda:0')
benign distance is  tensor(5.4685, device='cuda:0')
norm1 res is  tensor(0.0991, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  1.04748740978539
distance 1 is tensor(89.7257, device='cuda:0')
distance 2 is tensor(6.7422, device='cuda:0')
benign distance is  tensor(6.7422, device='cuda:0')
norm1 res is  tensor(0.1747, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.6628036238253117
distance 1 is tensor(188.1557, device='cuda:0')
distance 2 is tensor(13.7920, device='cuda:0')
benign distance is  tensor(13.7920, device='cuda:0')
norm1 res is  tensor(0.1347, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9144835332408547
distance 1 is tensor(65.1621, device='cuda:0')
distance 2 is tensor(5.0459, device='cuda:0')
benign distance is  tensor(5.0459, device='cuda:0')
norm1 res is  tensor(0.0727, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6927616321481764
distance 1 is tensor(53.2239, device='cuda:0')
distance 2 is tensor(4.0412, device='cuda:0')
benign distance is  tensor(4.0412, device='cuda:0')
norm1 res is  tensor(0.0917, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4021309185773134
distance 1 is tensor(54.9511, device='cuda:0')
distance 2 is tensor(4.2489, device='cuda:0')
benign distance is  tensor(4.2489, device='cuda:0')
norm1 res is  tensor(0.0647, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8735220283269882
distance 1 is tensor(72.4591, device='cuda:0')
distance 2 is tensor(5.3453, device='cuda:0')
benign distance is  tensor(5.3453, device='cuda:0')
norm1 res is  tensor(0.1135, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(388.6936, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(322.1408, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(397.1869, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(842.9997, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(282.5328, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(238.8548, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(243.6941, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(296.3622, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5016.6445, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5077.4492, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5072.9722, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5023.5356, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5047.2388, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5090.0137, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5064.5947, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5044.8428, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5062.0283, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5033.2988, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5052.1377, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5104.6685, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(725.1349, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(851.5204, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(850.7531, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(592.6559, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(975.7443, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(799.1306, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(642.5668, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(794.2276, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(807.8588, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(594.1235, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(851.9359, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(746.5097, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(635.9127, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(548.4781, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(538.6744, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(666.0924, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(716.6187, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(623.6223, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(703.4500, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(730.3193, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(451.3456, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1147.6155, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(860.0287, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(664.4742, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(509.5370, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(651.7120, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(356.4868, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(513.0107, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(963.6180, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
do  not satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(229.1202, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(890.7489, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(669.6384, device='cuda:0')
norm_2 is  tensor(495.1264, device='cuda:0')
norm_2 * lamda is tensor(891.2275, device='cuda:0')
satisfying 51
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 85.41% 

Test Accuracy: 88.10% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7458951771259308
distance 1 is tensor(61.1929, device='cuda:0')
distance 2 is tensor(4.7043, device='cuda:0')
benign distance is  tensor(4.7043, device='cuda:0')
norm1 res is  tensor(0.0501, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8781142793595791
distance 1 is tensor(56.4508, device='cuda:0')
distance 2 is tensor(4.2905, device='cuda:0')
benign distance is  tensor(4.2905, device='cuda:0')
norm1 res is  tensor(0.0742, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.746260778978467
distance 1 is tensor(64.6505, device='cuda:0')
distance 2 is tensor(5.0720, device='cuda:0')
benign distance is  tensor(5.0720, device='cuda:0')
norm1 res is  tensor(0.1190, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.5729761347174644
distance 1 is tensor(158.9227, device='cuda:0')
distance 2 is tensor(11.5945, device='cuda:0')
benign distance is  tensor(11.5945, device='cuda:0')
norm1 res is  tensor(0.1108, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0053639262914658
distance 1 is tensor(34.7185, device='cuda:0')
distance 2 is tensor(2.9108, device='cuda:0')
benign distance is  tensor(2.9108, device='cuda:0')
norm1 res is  tensor(0.0365, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6939608943648636
distance 1 is tensor(50.4383, device='cuda:0')
distance 2 is tensor(3.8144, device='cuda:0')
benign distance is  tensor(3.8144, device='cuda:0')
norm1 res is  tensor(0.0851, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.9876897521317005
distance 1 is tensor(32.3829, device='cuda:0')
distance 2 is tensor(2.6659, device='cuda:0')
benign distance is  tensor(2.6659, device='cuda:0')
norm1 res is  tensor(0.0377, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7578235901892185
distance 1 is tensor(36.8579, device='cuda:0')
distance 2 is tensor(2.9486, device='cuda:0')
benign distance is  tensor(2.9486, device='cuda:0')
norm1 res is  tensor(0.0576, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.1967582497745752
distance 1 is tensor(103.6309, device='cuda:0')
distance 2 is tensor(7.7355, device='cuda:0')
benign distance is  tensor(7.7355, device='cuda:0')
norm1 res is  tensor(0.1154, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7719579357653856
distance 1 is tensor(160.1991, device='cuda:0')
distance 2 is tensor(11.7620, device='cuda:0')
benign distance is  tensor(11.7620, device='cuda:0')
norm1 res is  tensor(0.1731, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.1352574527263641
distance 1 is tensor(65.6271, device='cuda:0')
distance 2 is tensor(5.1466, device='cuda:0')
benign distance is  tensor(5.1466, device='cuda:0')
norm1 res is  tensor(0.0896, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.1437243670225143
distance 1 is tensor(93.7626, device='cuda:0')
distance 2 is tensor(7.0617, device='cuda:0')
benign distance is  tensor(7.0617, device='cuda:0')
norm1 res is  tensor(0.0970, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.221375972032547
distance 1 is tensor(192.8673, device='cuda:0')
distance 2 is tensor(13.9631, device='cuda:0')
benign distance is  tensor(13.9631, device='cuda:0')
norm1 res is  tensor(0.1272, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6177576696500182
distance 1 is tensor(35.0277, device='cuda:0')
distance 2 is tensor(2.7883, device='cuda:0')
benign distance is  tensor(2.7883, device='cuda:0')
norm1 res is  tensor(0.0943, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.0505535304546356
distance 1 is tensor(133.7028, device='cuda:0')
distance 2 is tensor(9.8602, device='cuda:0')
benign distance is  tensor(9.8602, device='cuda:0')
norm1 res is  tensor(0.1364, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.673351526260376
distance 1 is tensor(147.1405, device='cuda:0')
distance 2 is tensor(10.8225, device='cuda:0')
benign distance is  tensor(10.8225, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.3827068954706192
distance 1 is tensor(97.7094, device='cuda:0')
distance 2 is tensor(7.4703, device='cuda:0')
benign distance is  tensor(7.4703, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.8263246044516563
distance 1 is tensor(135.8511, device='cuda:0')
distance 2 is tensor(9.8680, device='cuda:0')
benign distance is  tensor(9.8680, device='cuda:0')
norm1 res is  tensor(0.1713, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.2431729100644588
distance 1 is tensor(134.5100, device='cuda:0')
distance 2 is tensor(10.0074, device='cuda:0')
benign distance is  tensor(10.0074, device='cuda:0')
norm1 res is  tensor(0.1357, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.4531553126871586
distance 1 is tensor(165.1245, device='cuda:0')
distance 2 is tensor(12.2833, device='cuda:0')
benign distance is  tensor(12.2833, device='cuda:0')
norm1 res is  tensor(0.1507, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.1008782479912043
distance 1 is tensor(83.0430, device='cuda:0')
distance 2 is tensor(6.1472, device='cuda:0')
benign distance is  tensor(6.1472, device='cuda:0')
norm1 res is  tensor(0.1036, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8415767252445221
distance 1 is tensor(256.3169, device='cuda:0')
distance 2 is tensor(18.4400, device='cuda:0')
benign distance is  tensor(18.4400, device='cuda:0')
norm1 res is  tensor(0.1383, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.5006763972342014
distance 1 is tensor(158.3160, device='cuda:0')
distance 2 is tensor(11.9852, device='cuda:0')
benign distance is  tensor(11.9852, device='cuda:0')
norm1 res is  tensor(0.1035, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.8952258322387934
distance 1 is tensor(125.8347, device='cuda:0')
distance 2 is tensor(9.4435, device='cuda:0')
benign distance is  tensor(9.4435, device='cuda:0')
norm1 res is  tensor(0.1123, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7611371371895075
distance 1 is tensor(165.6120, device='cuda:0')
distance 2 is tensor(12.4665, device='cuda:0')
benign distance is  tensor(12.4665, device='cuda:0')
norm1 res is  tensor(0.2075, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.9596139583736658
distance 1 is tensor(118.6066, device='cuda:0')
distance 2 is tensor(8.8129, device='cuda:0')
benign distance is  tensor(8.8129, device='cuda:0')
norm1 res is  tensor(0.1655, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.6721598822623491
distance 1 is tensor(176.6786, device='cuda:0')
distance 2 is tensor(13.2499, device='cuda:0')
benign distance is  tensor(13.2499, device='cuda:0')
norm1 res is  tensor(0.1748, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  2.101533219218254
distance 1 is tensor(160.1842, device='cuda:0')
distance 2 is tensor(11.8023, device='cuda:0')
benign distance is  tensor(11.8023, device='cuda:0')
norm1 res is  tensor(0.1188, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.6538104508072138
distance 1 is tensor(161.1907, device='cuda:0')
distance 2 is tensor(12.0323, device='cuda:0')
benign distance is  tensor(12.0323, device='cuda:0')
norm1 res is  tensor(0.1755, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  1.2383105959743261
distance 1 is tensor(111.3202, device='cuda:0')
distance 2 is tensor(8.2544, device='cuda:0')
benign distance is  tensor(8.2544, device='cuda:0')
norm1 res is  tensor(0.1399, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.7439075261354446
distance 1 is tensor(103.1848, device='cuda:0')
distance 2 is tensor(7.6311, device='cuda:0')
benign distance is  tensor(7.6311, device='cuda:0')
norm1 res is  tensor(0.2062, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.7442542035132647
distance 1 is tensor(149.3769, device='cuda:0')
distance 2 is tensor(10.9336, device='cuda:0')
benign distance is  tensor(10.9336, device='cuda:0')
norm1 res is  tensor(0.1794, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.4067163281142712
distance 1 is tensor(135.7446, device='cuda:0')
distance 2 is tensor(10.1184, device='cuda:0')
benign distance is  tensor(10.1184, device='cuda:0')
norm1 res is  tensor(0.1412, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.8240368217229843
distance 1 is tensor(181.8146, device='cuda:0')
distance 2 is tensor(13.8063, device='cuda:0')
benign distance is  tensor(13.8063, device='cuda:0')
norm1 res is  tensor(0.1774, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.6279126964509487
distance 1 is tensor(183.0642, device='cuda:0')
distance 2 is tensor(13.5844, device='cuda:0')
benign distance is  tensor(13.5844, device='cuda:0')
norm1 res is  tensor(0.1288, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.8713599927723408
distance 1 is tensor(118.8195, device='cuda:0')
distance 2 is tensor(9.1226, device='cuda:0')
benign distance is  tensor(9.1226, device='cuda:0')
norm1 res is  tensor(0.2796, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.7298461105674505
distance 1 is tensor(192.2504, device='cuda:0')
distance 2 is tensor(14.1760, device='cuda:0')
benign distance is  tensor(14.1760, device='cuda:0')
norm1 res is  tensor(0.1858, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.8952859435230494
distance 1 is tensor(163.1213, device='cuda:0')
distance 2 is tensor(11.9162, device='cuda:0')
benign distance is  tensor(11.9162, device='cuda:0')
norm1 res is  tensor(0.1979, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.7688682610169053
distance 1 is tensor(126.6941, device='cuda:0')
distance 2 is tensor(9.2638, device='cuda:0')
benign distance is  tensor(9.2638, device='cuda:0')
norm1 res is  tensor(0.1738, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.656846122816205
distance 1 is tensor(183.3338, device='cuda:0')
distance 2 is tensor(13.2931, device='cuda:0')
benign distance is  tensor(13.2931, device='cuda:0')
norm1 res is  tensor(0.1989, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(264.1887, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(241.5377, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(284.5371, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(701.8622, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(151.3632, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(210.0729, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(136.0965, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(157.9975, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4996.3687, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5057.4146, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5029.1421, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5009.6265, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5016.9009, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5030.8916, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5037.1675, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5012.7002, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5038.0942, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5010.5303, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5023.1001, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5066.9482, device='cuda:0')
norm_2 is  tensor(211.0373, device='cuda:0')
norm_2 * lamda is tensor(379.8671, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 86.35% 

Test Accuracy: 88.44% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7259544692933559
distance 1 is tensor(98.4415, device='cuda:0')
distance 2 is tensor(7.3730, device='cuda:0')
benign distance is  tensor(7.3730, device='cuda:0')
norm1 res is  tensor(0.0821, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7568284664303064
distance 1 is tensor(70.4275, device='cuda:0')
distance 2 is tensor(5.3951, device='cuda:0')
benign distance is  tensor(5.3951, device='cuda:0')
norm1 res is  tensor(0.1033, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7621299400925636
distance 1 is tensor(104.0393, device='cuda:0')
distance 2 is tensor(7.7445, device='cuda:0')
benign distance is  tensor(7.7445, device='cuda:0')
norm1 res is  tensor(0.2036, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0879926532506943
distance 1 is tensor(171.9027, device='cuda:0')
distance 2 is tensor(12.5168, device='cuda:0')
benign distance is  tensor(12.5168, device='cuda:0')
norm1 res is  tensor(0.1201, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.970742329955101
distance 1 is tensor(59.2248, device='cuda:0')
distance 2 is tensor(4.5630, device='cuda:0')
benign distance is  tensor(4.5630, device='cuda:0')
norm1 res is  tensor(0.0617, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.764824790880084
distance 1 is tensor(50.6072, device='cuda:0')
distance 2 is tensor(3.7057, device='cuda:0')
benign distance is  tensor(3.7057, device='cuda:0')
norm1 res is  tensor(0.0812, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.0686572957783937
distance 1 is tensor(50.5157, device='cuda:0')
distance 2 is tensor(3.9274, device='cuda:0')
benign distance is  tensor(3.9274, device='cuda:0')
norm1 res is  tensor(0.0564, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7703377734869719
distance 1 is tensor(51.4373, device='cuda:0')
distance 2 is tensor(3.9140, device='cuda:0')
benign distance is  tensor(3.9140, device='cuda:0')
norm1 res is  tensor(0.0816, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(428.2153, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(317.3766, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(452.3598, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(766.3543, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(251.9788, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(206.8836, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(213.6273, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(221.9896, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5019.3262, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5071.8755, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5024.1499, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5031.6118, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5024.9800, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5061.4663, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5051.7598, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5045.4580, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5080.0518, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5028.5400, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5043.8975, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5106.9399, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(647.2544, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(482.4834, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(776.8622, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(690.0685, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(844.5182, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1031.3986, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(778.1503, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(1035.5864, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(458.5950, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(721.8038, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(295.6667, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(421.7753, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(851.5925, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(163.9669, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(600.8418, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(649.7921, device='cuda:0')
norm_2 is  tensor(293.2664, device='cuda:0')
norm_2 * lamda is tensor(527.8795, device='cuda:0')
do  not satisfying 35
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 86.05% 

Test Accuracy: 88.21% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6457854751497507
distance 1 is tensor(58.5755, device='cuda:0')
distance 2 is tensor(4.6822, device='cuda:0')
benign distance is  tensor(4.6822, device='cuda:0')
norm1 res is  tensor(0.0500, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6604809388518333
distance 1 is tensor(56.7925, device='cuda:0')
distance 2 is tensor(4.4089, device='cuda:0')
benign distance is  tensor(4.4089, device='cuda:0')
norm1 res is  tensor(0.0776, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7230359921231866
distance 1 is tensor(60.6764, device='cuda:0')
distance 2 is tensor(4.7107, device='cuda:0')
benign distance is  tensor(4.7107, device='cuda:0')
norm1 res is  tensor(0.1138, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3000106737017632
distance 1 is tensor(173.0591, device='cuda:0')
distance 2 is tensor(12.5455, device='cuda:0')
benign distance is  tensor(12.5455, device='cuda:0')
norm1 res is  tensor(0.1205, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.888496738858521
distance 1 is tensor(48.3527, device='cuda:0')
distance 2 is tensor(3.8774, device='cuda:0')
benign distance is  tensor(3.8774, device='cuda:0')
norm1 res is  tensor(0.0513, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6996380602940917
distance 1 is tensor(44.4056, device='cuda:0')
distance 2 is tensor(3.4956, device='cuda:0')
benign distance is  tensor(3.4956, device='cuda:0')
norm1 res is  tensor(0.0760, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.034318558871746
distance 1 is tensor(40.1907, device='cuda:0')
distance 2 is tensor(3.3488, device='cuda:0')
benign distance is  tensor(3.3488, device='cuda:0')
norm1 res is  tensor(0.0484, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8922605495899916
distance 1 is tensor(66.4345, device='cuda:0')
distance 2 is tensor(5.0164, device='cuda:0')
benign distance is  tensor(5.0164, device='cuda:0')
norm1 res is  tensor(0.1087, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.0547069553285837
distance 1 is tensor(105.7137, device='cuda:0')
distance 2 is tensor(7.9296, device='cuda:0')
benign distance is  tensor(7.9296, device='cuda:0')
norm1 res is  tensor(0.1195, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0378103572875261
distance 1 is tensor(171.7017, device='cuda:0')
distance 2 is tensor(12.6264, device='cuda:0')
benign distance is  tensor(12.6264, device='cuda:0')
norm1 res is  tensor(0.1869, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0653876699507236
distance 1 is tensor(56.3616, device='cuda:0')
distance 2 is tensor(4.4646, device='cuda:0')
benign distance is  tensor(4.4646, device='cuda:0')
norm1 res is  tensor(0.0791, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3462623804807663
distance 1 is tensor(120.8845, device='cuda:0')
distance 2 is tensor(8.9714, device='cuda:0')
benign distance is  tensor(8.9714, device='cuda:0')
norm1 res is  tensor(0.1232, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.0802475847303867
distance 1 is tensor(227.4713, device='cuda:0')
distance 2 is tensor(16.4359, device='cuda:0')
benign distance is  tensor(16.4359, device='cuda:0')
norm1 res is  tensor(0.1492, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7276919987052679
distance 1 is tensor(38.6852, device='cuda:0')
distance 2 is tensor(3.0342, device='cuda:0')
benign distance is  tensor(3.0342, device='cuda:0')
norm1 res is  tensor(0.1015, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1700988747179508
distance 1 is tensor(212.1176, device='cuda:0')
distance 2 is tensor(15.4831, device='cuda:0')
benign distance is  tensor(15.4831, device='cuda:0')
norm1 res is  tensor(0.2105, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.143913872539997
distance 1 is tensor(133.0681, device='cuda:0')
distance 2 is tensor(10.0352, device='cuda:0')
benign distance is  tensor(10.0352, device='cuda:0')
norm1 res is  tensor(0.1308, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.2517025843262672
distance 1 is tensor(170.5447, device='cuda:0')
distance 2 is tensor(12.4955, device='cuda:0')
benign distance is  tensor(12.4955, device='cuda:0')
norm1 res is  tensor(0.1899, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.9156924020498991
distance 1 is tensor(104.2839, device='cuda:0')
distance 2 is tensor(7.8159, device='cuda:0')
benign distance is  tensor(7.8159, device='cuda:0')
norm1 res is  tensor(0.2982, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.0291065908968449
distance 1 is tensor(188.6048, device='cuda:0')
distance 2 is tensor(13.8828, device='cuda:0')
benign distance is  tensor(13.8828, device='cuda:0')
norm1 res is  tensor(0.1629, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.407021189108491
distance 1 is tensor(164.8329, device='cuda:0')
distance 2 is tensor(12.2774, device='cuda:0')
benign distance is  tensor(12.2774, device='cuda:0')
norm1 res is  tensor(0.1859, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.8203724306076765
distance 1 is tensor(170.0512, device='cuda:0')
distance 2 is tensor(12.3796, device='cuda:0')
benign distance is  tensor(12.3796, device='cuda:0')
norm1 res is  tensor(0.1896, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  1.2415000721812248
distance 1 is tensor(225.7157, device='cuda:0')
distance 2 is tensor(18.4877, device='cuda:0')
benign distance is  tensor(18.4877, device='cuda:0')
norm1 res is  tensor(0.2577, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5857238564640284
distance 1 is tensor(173.5925, device='cuda:0')
distance 2 is tensor(12.4666, device='cuda:0')
benign distance is  tensor(12.4666, device='cuda:0')
norm1 res is  tensor(0.1909, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  1.1284328922629356
distance 1 is tensor(213.0978, device='cuda:0')
distance 2 is tensor(15.4555, device='cuda:0')
benign distance is  tensor(15.4555, device='cuda:0')
norm1 res is  tensor(0.1873, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(264.5536, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(254.0115, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(268.6010, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(765.0386, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(212.5728, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(197.3753, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(182.4069, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(283.9842, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5020.1299, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5088.3940, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5047.0205, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5073.1787, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5052.2871, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5051.0435, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5072.2729, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5048.7544, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5059.8306, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5057.2334, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5041.1782, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5098.0513, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(441.1274, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(590.4446, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(589.7247, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(729.0612, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(359.2524, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1124.4221, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(700.3204, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(575.1710, device='cuda:0')
norm_2 is  tensor(227.9105, device='cuda:0')
norm_2 * lamda is tensor(410.2388, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 87.42% 

Test Accuracy: 88.60% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7944973595440388
distance 1 is tensor(154.3706, device='cuda:0')
distance 2 is tensor(11.4192, device='cuda:0')
benign distance is  tensor(11.4192, device='cuda:0')
norm1 res is  tensor(0.1309, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7714931555092335
distance 1 is tensor(97.3793, device='cuda:0')
distance 2 is tensor(7.1717, device='cuda:0')
benign distance is  tensor(7.1717, device='cuda:0')
norm1 res is  tensor(0.1341, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7217529993504286
distance 1 is tensor(63.4775, device='cuda:0')
distance 2 is tensor(4.9827, device='cuda:0')
benign distance is  tensor(4.9827, device='cuda:0')
norm1 res is  tensor(0.1228, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3396117873489857
distance 1 is tensor(202.6107, device='cuda:0')
distance 2 is tensor(14.5759, device='cuda:0')
benign distance is  tensor(14.5759, device='cuda:0')
norm1 res is  tensor(0.1397, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8949144259095192
distance 1 is tensor(50.6138, device='cuda:0')
distance 2 is tensor(4.1137, device='cuda:0')
benign distance is  tensor(4.1137, device='cuda:0')
norm1 res is  tensor(0.0560, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7841090462170541
distance 1 is tensor(72.0396, device='cuda:0')
distance 2 is tensor(5.4200, device='cuda:0')
benign distance is  tensor(5.4200, device='cuda:0')
norm1 res is  tensor(0.1257, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.36186383664608
distance 1 is tensor(53.0326, device='cuda:0')
distance 2 is tensor(4.1969, device='cuda:0')
benign distance is  tensor(4.1969, device='cuda:0')
norm1 res is  tensor(0.0618, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.9218668304383755
distance 1 is tensor(48.9220, device='cuda:0')
distance 2 is tensor(3.8858, device='cuda:0')
benign distance is  tensor(3.8858, device='cuda:0')
norm1 res is  tensor(0.0886, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.5140129625797272
distance 1 is tensor(134.6802, device='cuda:0')
distance 2 is tensor(10.2076, device='cuda:0')
benign distance is  tensor(10.2076, device='cuda:0')
norm1 res is  tensor(0.2016, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9900544006377459
distance 1 is tensor(146.8218, device='cuda:0')
distance 2 is tensor(10.9207, device='cuda:0')
benign distance is  tensor(10.9207, device='cuda:0')
norm1 res is  tensor(0.1919, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.1345640309154987
distance 1 is tensor(167.0698, device='cuda:0')
distance 2 is tensor(12.3947, device='cuda:0')
benign distance is  tensor(12.3947, device='cuda:0')
norm1 res is  tensor(0.1676, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.1958573572337627
distance 1 is tensor(159.5994, device='cuda:0')
distance 2 is tensor(11.8516, device='cuda:0')
benign distance is  tensor(11.8516, device='cuda:0')
norm1 res is  tensor(0.1468, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.271489005535841
distance 1 is tensor(79.1835, device='cuda:0')
distance 2 is tensor(5.8507, device='cuda:0')
benign distance is  tensor(5.8507, device='cuda:0')
norm1 res is  tensor(0.1031, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.0627629570662975
distance 1 is tensor(247.6178, device='cuda:0')
distance 2 is tensor(17.7056, device='cuda:0')
benign distance is  tensor(17.7056, device='cuda:0')
norm1 res is  tensor(0.1316, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.3338873088359833
distance 1 is tensor(186.0764, device='cuda:0')
distance 2 is tensor(13.8013, device='cuda:0')
benign distance is  tensor(13.8013, device='cuda:0')
norm1 res is  tensor(0.1206, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.8174025695770979
distance 1 is tensor(138.8193, device='cuda:0')
distance 2 is tensor(10.3286, device='cuda:0')
benign distance is  tensor(10.3286, device='cuda:0')
norm1 res is  tensor(0.1226, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(675.5216, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(429.7448, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(293.8836, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(884.1835, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(232.4508, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(322.2565, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(234.6211, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(220.4913, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5042.6016, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5105.0635, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5053.6367, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5079.0229, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5047.7104, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5096.6729, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5076.6768, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5051.3374, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5071.5723, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5048.9111, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5053.4326, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5113.8145, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(476.3110, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(772.6733, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(263.7222, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(533.5592, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(1007.4330, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(180.7496, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(945.1948, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(597.4260, device='cuda:0')
norm_2 is  tensor(273.1024, device='cuda:0')
norm_2 * lamda is tensor(491.5844, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 85.09% 

Test Accuracy: 88.02% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7175595741719007
distance 1 is tensor(100.5481, device='cuda:0')
distance 2 is tensor(7.6187, device='cuda:0')
benign distance is  tensor(7.6187, device='cuda:0')
norm1 res is  tensor(0.0834, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6901883604004979
distance 1 is tensor(67.2568, device='cuda:0')
distance 2 is tensor(5.1148, device='cuda:0')
benign distance is  tensor(5.1148, device='cuda:0')
norm1 res is  tensor(0.0950, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8531636940315366
distance 1 is tensor(123.3618, device='cuda:0')
distance 2 is tensor(8.9367, device='cuda:0')
benign distance is  tensor(8.9367, device='cuda:0')
norm1 res is  tensor(0.2329, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.4540558531880379
distance 1 is tensor(192.6687, device='cuda:0')
distance 2 is tensor(14.1999, device='cuda:0')
benign distance is  tensor(14.1999, device='cuda:0')
norm1 res is  tensor(0.1349, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.80856529250741
distance 1 is tensor(63.4438, device='cuda:0')
distance 2 is tensor(4.9023, device='cuda:0')
benign distance is  tensor(4.9023, device='cuda:0')
norm1 res is  tensor(0.0688, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7248223936185241
distance 1 is tensor(82.7826, device='cuda:0')
distance 2 is tensor(6.0113, device='cuda:0')
benign distance is  tensor(6.0113, device='cuda:0')
norm1 res is  tensor(0.1394, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.207533597946167
distance 1 is tensor(64.2640, device='cuda:0')
distance 2 is tensor(4.8730, device='cuda:0')
benign distance is  tensor(4.8730, device='cuda:0')
norm1 res is  tensor(0.0725, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6908825235441327
distance 1 is tensor(47.2710, device='cuda:0')
distance 2 is tensor(3.7311, device='cuda:0')
benign distance is  tensor(3.7311, device='cuda:0')
norm1 res is  tensor(0.0813, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.4936765097081661
distance 1 is tensor(105.0707, device='cuda:0')
distance 2 is tensor(7.8347, device='cuda:0')
benign distance is  tensor(7.8347, device='cuda:0')
norm1 res is  tensor(0.1160, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9924182519316673
distance 1 is tensor(171.1876, device='cuda:0')
distance 2 is tensor(12.6825, device='cuda:0')
benign distance is  tensor(12.6825, device='cuda:0')
norm1 res is  tensor(0.1877, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.2712930589914322
distance 1 is tensor(52.6460, device='cuda:0')
distance 2 is tensor(4.3681, device='cuda:0')
benign distance is  tensor(4.3681, device='cuda:0')
norm1 res is  tensor(0.0738, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.450652476400137
distance 1 is tensor(142.1036, device='cuda:0')
distance 2 is tensor(10.5799, device='cuda:0')
benign distance is  tensor(10.5799, device='cuda:0')
norm1 res is  tensor(0.1459, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.287024363875389
distance 1 is tensor(229.3619, device='cuda:0')
distance 2 is tensor(16.4814, device='cuda:0')
benign distance is  tensor(16.4814, device='cuda:0')
norm1 res is  tensor(0.1476, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7511311424896121
distance 1 is tensor(38.0432, device='cuda:0')
distance 2 is tensor(3.2821, device='cuda:0')
benign distance is  tensor(3.2821, device='cuda:0')
norm1 res is  tensor(0.1129, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.089869912713766
distance 1 is tensor(176.1854, device='cuda:0')
distance 2 is tensor(12.6781, device='cuda:0')
benign distance is  tensor(12.6781, device='cuda:0')
norm1 res is  tensor(0.1692, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.908907100558281
distance 1 is tensor(158.4212, device='cuda:0')
distance 2 is tensor(11.7302, device='cuda:0')
benign distance is  tensor(11.7302, device='cuda:0')
norm1 res is  tensor(0.1535, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(438.3145, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(300.0890, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(529.3868, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(858.2614, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(283.1031, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(353.2649, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(275.3965, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(204.1124, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5055.8774, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5105.4609, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5063.9561, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5080.1704, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5059.1831, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5084.8452, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5082.3232, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5071.9878, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5095.5474, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5062.7427, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5076.9780, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5120.4404, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(765.0315, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(541.8862, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(800.1046, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(710.1517, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(719.4766, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(504.7613, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(463.1445, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(665.6425, device='cuda:0')
norm_2 is  tensor(333.7452, device='cuda:0')
norm_2 * lamda is tensor(600.7414, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 86.18% 

Test Accuracy: 88.14% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7447822093963623
distance 1 is tensor(52.2884, device='cuda:0')
distance 2 is tensor(4.1135, device='cuda:0')
benign distance is  tensor(4.1135, device='cuda:0')
norm1 res is  tensor(0.0437, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8275858862325549
distance 1 is tensor(63.6794, device='cuda:0')
distance 2 is tensor(4.8739, device='cuda:0')
benign distance is  tensor(4.8739, device='cuda:0')
norm1 res is  tensor(0.0900, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8668699953705072
distance 1 is tensor(66.8564, device='cuda:0')
distance 2 is tensor(5.0522, device='cuda:0')
benign distance is  tensor(5.0522, device='cuda:0')
norm1 res is  tensor(0.1325, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3302547708153725
distance 1 is tensor(199.3521, device='cuda:0')
distance 2 is tensor(14.4165, device='cuda:0')
benign distance is  tensor(14.4165, device='cuda:0')
norm1 res is  tensor(0.1381, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8670558044686913
distance 1 is tensor(53.6708, device='cuda:0')
distance 2 is tensor(4.2091, device='cuda:0')
benign distance is  tensor(4.2091, device='cuda:0')
norm1 res is  tensor(0.0574, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7515150853432715
distance 1 is tensor(58.8735, device='cuda:0')
distance 2 is tensor(4.4639, device='cuda:0')
benign distance is  tensor(4.4639, device='cuda:0')
norm1 res is  tensor(0.1010, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.279202800244093
distance 1 is tensor(52.4383, device='cuda:0')
distance 2 is tensor(4.1232, device='cuda:0')
benign distance is  tensor(4.1232, device='cuda:0')
norm1 res is  tensor(0.0611, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8103898745030165
distance 1 is tensor(45.6439, device='cuda:0')
distance 2 is tensor(3.6066, device='cuda:0')
benign distance is  tensor(3.6066, device='cuda:0')
norm1 res is  tensor(0.0753, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7343163397163153
distance 1 is tensor(168.3853, device='cuda:0')
distance 2 is tensor(12.6926, device='cuda:0')
benign distance is  tensor(12.6926, device='cuda:0')
norm1 res is  tensor(0.2101, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.1048165373504162
distance 1 is tensor(144.9458, device='cuda:0')
distance 2 is tensor(10.6336, device='cuda:0')
benign distance is  tensor(10.6336, device='cuda:0')
norm1 res is  tensor(0.1999, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.7805583588778973
distance 1 is tensor(193.5591, device='cuda:0')
distance 2 is tensor(14.3420, device='cuda:0')
benign distance is  tensor(14.3420, device='cuda:0')
norm1 res is  tensor(0.1911, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.9611154310405254
distance 1 is tensor(173.9547, device='cuda:0')
distance 2 is tensor(12.7335, device='cuda:0')
benign distance is  tensor(12.7335, device='cuda:0')
norm1 res is  tensor(0.1308, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.8112669363617897
distance 1 is tensor(126.3668, device='cuda:0')
distance 2 is tensor(9.4449, device='cuda:0')
benign distance is  tensor(9.4449, device='cuda:0')
norm1 res is  tensor(0.1340, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.9774268213659525
distance 1 is tensor(107.5854, device='cuda:0')
distance 2 is tensor(8.0356, device='cuda:0')
benign distance is  tensor(8.0356, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  1.0769897475838661
distance 1 is tensor(116.2226, device='cuda:0')
distance 2 is tensor(8.5615, device='cuda:0')
benign distance is  tensor(8.5615, device='cuda:0')
norm1 res is  tensor(0.2309, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.8321626298129559
distance 1 is tensor(165.8831, device='cuda:0')
distance 2 is tensor(12.2049, device='cuda:0')
benign distance is  tensor(12.2049, device='cuda:0')
norm1 res is  tensor(0.1996, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(231.3677, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(280.1549, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(294.8377, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(880.7135, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(231.8938, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(252.4245, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(230.2853, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(197.5150, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5050.1777, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5100.2847, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5061.5259, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5081.3232, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5061.6665, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5093.6030, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5104.4126, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5065.7227, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5093.6504, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5065.3052, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5066.5991, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5128.7207, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(609.9650, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(804.1797, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(814.3935, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(544.9818, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(863.1763, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(728.4911, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(565.5524, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(793.6434, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(758.4354, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(489.5915, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(832.5776, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(739.0637, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(751.6058, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1092.0493, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(750.2606, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(924.2345, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(615.6133, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(662.1465, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(718.0733, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(711.2999, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(355.9230, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1067.5201, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(809.8041, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(623.5530, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(469.6270, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(772.5701, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(261.7413, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(630.3932, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(990.7599, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(213.2732, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(755.7607, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(696.5632, device='cuda:0')
norm_2 is  tensor(280.2753, device='cuda:0')
norm_2 * lamda is tensor(504.4955, device='cuda:0')
do  not satisfying 51
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 85.85% 

Test Accuracy: 88.40% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7266160873696208
distance 1 is tensor(51.4188, device='cuda:0')
distance 2 is tensor(4.0785, device='cuda:0')
benign distance is  tensor(4.0785, device='cuda:0')
norm1 res is  tensor(0.0447, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8073228113353252
distance 1 is tensor(52.1169, device='cuda:0')
distance 2 is tensor(4.1860, device='cuda:0')
benign distance is  tensor(4.1860, device='cuda:0')
norm1 res is  tensor(0.0718, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7764831203967333
distance 1 is tensor(76.4209, device='cuda:0')
distance 2 is tensor(5.8903, device='cuda:0')
benign distance is  tensor(5.8903, device='cuda:0')
norm1 res is  tensor(0.1488, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.371425922960043
distance 1 is tensor(191.6308, device='cuda:0')
distance 2 is tensor(14.0070, device='cuda:0')
benign distance is  tensor(14.0070, device='cuda:0')
norm1 res is  tensor(0.1341, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8991047404706478
distance 1 is tensor(40.2807, device='cuda:0')
distance 2 is tensor(3.3353, device='cuda:0')
benign distance is  tensor(3.3353, device='cuda:0')
norm1 res is  tensor(0.0447, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7560550142079592
distance 1 is tensor(53.8019, device='cuda:0')
distance 2 is tensor(4.0532, device='cuda:0')
benign distance is  tensor(4.0532, device='cuda:0')
norm1 res is  tensor(0.0894, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.375957891345024
distance 1 is tensor(97.5433, device='cuda:0')
distance 2 is tensor(7.3367, device='cuda:0')
benign distance is  tensor(7.3367, device='cuda:0')
norm1 res is  tensor(0.1141, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  1.1261215284466743
distance 1 is tensor(78.0048, device='cuda:0')
distance 2 is tensor(5.9600, device='cuda:0')
benign distance is  tensor(5.9600, device='cuda:0')
norm1 res is  tensor(0.1289, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.3436981849372387
distance 1 is tensor(132.0477, device='cuda:0')
distance 2 is tensor(9.7487, device='cuda:0')
benign distance is  tensor(9.7487, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7360858898609877
distance 1 is tensor(182.6374, device='cuda:0')
distance 2 is tensor(13.6157, device='cuda:0')
benign distance is  tensor(13.6157, device='cuda:0')
norm1 res is  tensor(0.1974, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.2580572962760925
distance 1 is tensor(75.1473, device='cuda:0')
distance 2 is tensor(5.6997, device='cuda:0')
benign distance is  tensor(5.6997, device='cuda:0')
norm1 res is  tensor(0.1018, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.5366077311336994
distance 1 is tensor(121.3943, device='cuda:0')
distance 2 is tensor(9.1325, device='cuda:0')
benign distance is  tensor(9.1325, device='cuda:0')
norm1 res is  tensor(0.1257, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.1673163622617722
distance 1 is tensor(235.8688, device='cuda:0')
distance 2 is tensor(16.9344, device='cuda:0')
benign distance is  tensor(16.9344, device='cuda:0')
norm1 res is  tensor(0.1518, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7665144819766283
distance 1 is tensor(50.3213, device='cuda:0')
distance 2 is tensor(3.8861, device='cuda:0')
benign distance is  tensor(3.8861, device='cuda:0')
norm1 res is  tensor(0.1364, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.9212644509971142
distance 1 is tensor(173.5592, device='cuda:0')
distance 2 is tensor(12.5142, device='cuda:0')
benign distance is  tensor(12.5142, device='cuda:0')
norm1 res is  tensor(0.1708, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.4631571136415005
distance 1 is tensor(168.2694, device='cuda:0')
distance 2 is tensor(12.4512, device='cuda:0')
benign distance is  tensor(12.4512, device='cuda:0')
norm1 res is  tensor(0.1643, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.327862024307251
distance 1 is tensor(128.0959, device='cuda:0')
distance 2 is tensor(9.7061, device='cuda:0')
benign distance is  tensor(9.7061, device='cuda:0')
norm1 res is  tensor(0.1943, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  1.006862672045827
distance 1 is tensor(156.1770, device='cuda:0')
distance 2 is tensor(11.5357, device='cuda:0')
benign distance is  tensor(11.5357, device='cuda:0')
norm1 res is  tensor(0.2048, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.0260165706276894
distance 1 is tensor(148.8887, device='cuda:0')
distance 2 is tensor(11.0098, device='cuda:0')
benign distance is  tensor(11.0098, device='cuda:0')
norm1 res is  tensor(0.1507, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9685945212841034
distance 1 is tensor(160.9756, device='cuda:0')
distance 2 is tensor(12.0158, device='cuda:0')
benign distance is  tensor(12.0158, device='cuda:0')
norm1 res is  tensor(0.1818, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.1058838050812483
distance 1 is tensor(96.7896, device='cuda:0')
distance 2 is tensor(6.9214, device='cuda:0')
benign distance is  tensor(6.9214, device='cuda:0')
norm1 res is  tensor(0.1175, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9445381201803684
distance 1 is tensor(265.5918, device='cuda:0')
distance 2 is tensor(19.3500, device='cuda:0')
benign distance is  tensor(19.3500, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.4262272380292416
distance 1 is tensor(189.5217, device='cuda:0')
distance 2 is tensor(13.8213, device='cuda:0')
benign distance is  tensor(13.8213, device='cuda:0')
norm1 res is  tensor(0.1213, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.231869202107191
distance 1 is tensor(159.7508, device='cuda:0')
distance 2 is tensor(11.8684, device='cuda:0')
benign distance is  tensor(11.8684, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.140412526205182
distance 1 is tensor(144.7673, device='cuda:0')
distance 2 is tensor(10.8000, device='cuda:0')
benign distance is  tensor(10.8000, device='cuda:0')
norm1 res is  tensor(0.1572, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  1.0072117689996958
distance 1 is tensor(116.9622, device='cuda:0')
distance 2 is tensor(8.6368, device='cuda:0')
benign distance is  tensor(8.6368, device='cuda:0')
norm1 res is  tensor(0.3311, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.338834561407566
distance 1 is tensor(176.9352, device='cuda:0')
distance 2 is tensor(13.2170, device='cuda:0')
benign distance is  tensor(13.2170, device='cuda:0')
norm1 res is  tensor(0.1557, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.595283180475235
distance 1 is tensor(153.8432, device='cuda:0')
distance 2 is tensor(11.4476, device='cuda:0')
benign distance is  tensor(11.4476, device='cuda:0')
norm1 res is  tensor(0.1731, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.97064658254385
distance 1 is tensor(174.4591, device='cuda:0')
distance 2 is tensor(12.8479, device='cuda:0')
benign distance is  tensor(12.8479, device='cuda:0')
norm1 res is  tensor(0.1931, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.9925254955887794
distance 1 is tensor(163.9927, device='cuda:0')
distance 2 is tensor(12.1295, device='cuda:0')
benign distance is  tensor(12.1295, device='cuda:0')
norm1 res is  tensor(0.1792, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.7478986717760563
distance 1 is tensor(163.7257, device='cuda:0')
distance 2 is tensor(11.9989, device='cuda:0')
benign distance is  tensor(11.9989, device='cuda:0')
norm1 res is  tensor(0.1799, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.9570906776934862
distance 1 is tensor(220.7743, device='cuda:0')
distance 2 is tensor(16.3624, device='cuda:0')
benign distance is  tensor(16.3624, device='cuda:0')
norm1 res is  tensor(0.1964, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.3605802357196808
distance 1 is tensor(169.5200, device='cuda:0')
distance 2 is tensor(12.7574, device='cuda:0')
benign distance is  tensor(12.7574, device='cuda:0')
norm1 res is  tensor(0.1782, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  2.0448503121733665
distance 1 is tensor(221.6943, device='cuda:0')
distance 2 is tensor(16.7305, device='cuda:0')
benign distance is  tensor(16.7305, device='cuda:0')
norm1 res is  tensor(0.2257, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.1675139721482992
distance 1 is tensor(190.4003, device='cuda:0')
distance 2 is tensor(14.0197, device='cuda:0')
benign distance is  tensor(14.0197, device='cuda:0')
norm1 res is  tensor(0.1338, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.9527029693126678
distance 1 is tensor(148.5519, device='cuda:0')
distance 2 is tensor(11.1479, device='cuda:0')
benign distance is  tensor(11.1479, device='cuda:0')
norm1 res is  tensor(0.3514, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.721019783988595
distance 1 is tensor(204.8684, device='cuda:0')
distance 2 is tensor(15.1547, device='cuda:0')
benign distance is  tensor(15.1547, device='cuda:0')
norm1 res is  tensor(0.1974, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.8904615752398968
distance 1 is tensor(188.0748, device='cuda:0')
distance 2 is tensor(13.6453, device='cuda:0')
benign distance is  tensor(13.6453, device='cuda:0')
norm1 res is  tensor(0.2245, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  1.1804026700556278
distance 1 is tensor(171.4884, device='cuda:0')
distance 2 is tensor(12.6994, device='cuda:0')
benign distance is  tensor(12.6994, device='cuda:0')
norm1 res is  tensor(0.2388, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.48610317055135965
distance 1 is tensor(195.5367, device='cuda:0')
distance 2 is tensor(14.2608, device='cuda:0')
benign distance is  tensor(14.2608, device='cuda:0')
norm1 res is  tensor(0.2110, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(230.1233, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(233.3000, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(344.3809, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(850.8862, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(184.4331, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(232.3172, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(428.7715, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(349.5757, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5062.0352, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5119.3403, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5082.8296, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5164.5635, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5071.1216, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5110.4961, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5094.9082, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5070.1006, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5091.7729, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5081.3926, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5082.0864, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5124.9619, device='cuda:0')
norm_2 is  tensor(219.2772, device='cuda:0')
norm_2 * lamda is tensor(394.6990, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 87.95% 

Test Accuracy: 88.80% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8475101236253977
distance 1 is tensor(99.4601, device='cuda:0')
distance 2 is tensor(7.4607, device='cuda:0')
benign distance is  tensor(7.4607, device='cuda:0')
norm1 res is  tensor(0.0812, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7878856156021357
distance 1 is tensor(49.2579, device='cuda:0')
distance 2 is tensor(3.8805, device='cuda:0')
benign distance is  tensor(3.8805, device='cuda:0')
norm1 res is  tensor(0.0667, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7865141611546278
distance 1 is tensor(52.4927, device='cuda:0')
distance 2 is tensor(4.1681, device='cuda:0')
benign distance is  tensor(4.1681, device='cuda:0')
norm1 res is  tensor(0.1023, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.6468625031411648
distance 1 is tensor(193.4440, device='cuda:0')
distance 2 is tensor(13.9992, device='cuda:0')
benign distance is  tensor(13.9992, device='cuda:0')
norm1 res is  tensor(0.1342, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7696394622325897
distance 1 is tensor(51.9417, device='cuda:0')
distance 2 is tensor(4.1331, device='cuda:0')
benign distance is  tensor(4.1331, device='cuda:0')
norm1 res is  tensor(0.0560, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6760617012623698
distance 1 is tensor(66.1871, device='cuda:0')
distance 2 is tensor(4.9303, device='cuda:0')
benign distance is  tensor(4.9303, device='cuda:0')
norm1 res is  tensor(0.1059, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.432549325749278
distance 1 is tensor(81.7931, device='cuda:0')
distance 2 is tensor(6.1435, device='cuda:0')
benign distance is  tensor(6.1435, device='cuda:0')
norm1 res is  tensor(0.0922, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8749847672879696
distance 1 is tensor(61.4631, device='cuda:0')
distance 2 is tensor(4.7532, device='cuda:0')
benign distance is  tensor(4.7532, device='cuda:0')
norm1 res is  tensor(0.1011, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(424.6483, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(218.9830, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(243.6522, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(854.1986, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(232.2484, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(277.5815, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(347.6809, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(275.8707, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5075.7769, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5135.9932, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5103.7231, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5091.6377, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5097.2388, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5132.0762, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5112.8955, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5095.2764, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5110.7056, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5103.2070, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5110.8716, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5150.1450, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(585.8673, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(813.9156, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(337.4661, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(540.4921, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(1024.8169, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(236.5656, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(767.9520, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(747.2617, device='cuda:0')
norm_2 is  tensor(434.5461, device='cuda:0')
norm_2 * lamda is tensor(782.1830, device='cuda:0')
satisfying 27
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 87.08% 

Test Accuracy: 88.52% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7261850424110889
distance 1 is tensor(75.0302, device='cuda:0')
distance 2 is tensor(5.6482, device='cuda:0')
benign distance is  tensor(5.6482, device='cuda:0')
norm1 res is  tensor(0.0656, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.874654982239008
distance 1 is tensor(70.3936, device='cuda:0')
distance 2 is tensor(5.3459, device='cuda:0')
benign distance is  tensor(5.3459, device='cuda:0')
norm1 res is  tensor(0.0987, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6686082044616342
distance 1 is tensor(109.5847, device='cuda:0')
distance 2 is tensor(8.2325, device='cuda:0')
benign distance is  tensor(8.2325, device='cuda:0')
norm1 res is  tensor(0.2141, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3051837906241417
distance 1 is tensor(204.8439, device='cuda:0')
distance 2 is tensor(14.6215, device='cuda:0')
benign distance is  tensor(14.6215, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7136931074783206
distance 1 is tensor(31.7503, device='cuda:0')
distance 2 is tensor(2.6555, device='cuda:0')
benign distance is  tensor(2.6555, device='cuda:0')
norm1 res is  tensor(0.0345, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6802141619846225
distance 1 is tensor(56.1944, device='cuda:0')
distance 2 is tensor(4.2951, device='cuda:0')
benign distance is  tensor(4.2951, device='cuda:0')
norm1 res is  tensor(0.1057, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2417677603662014
distance 1 is tensor(54.7170, device='cuda:0')
distance 2 is tensor(4.1474, device='cuda:0')
benign distance is  tensor(4.1474, device='cuda:0')
norm1 res is  tensor(0.0658, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7099182093515992
distance 1 is tensor(33.2673, device='cuda:0')
distance 2 is tensor(2.7753, device='cuda:0')
benign distance is  tensor(2.7753, device='cuda:0')
norm1 res is  tensor(0.0549, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.052737783640623
distance 1 is tensor(76.6515, device='cuda:0')
distance 2 is tensor(5.8268, device='cuda:0')
benign distance is  tensor(5.8268, device='cuda:0')
norm1 res is  tensor(0.0864, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7459652898833156
distance 1 is tensor(163.6977, device='cuda:0')
distance 2 is tensor(11.8853, device='cuda:0')
benign distance is  tensor(11.8853, device='cuda:0')
norm1 res is  tensor(0.1753, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9279656745493412
distance 1 is tensor(57.1125, device='cuda:0')
distance 2 is tensor(4.5017, device='cuda:0')
benign distance is  tensor(4.5017, device='cuda:0')
norm1 res is  tensor(0.0788, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.2438976615667343
distance 1 is tensor(149.7703, device='cuda:0')
distance 2 is tensor(11.1181, device='cuda:0')
benign distance is  tensor(11.1181, device='cuda:0')
norm1 res is  tensor(0.1590, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.1071889325976372
distance 1 is tensor(225.9408, device='cuda:0')
distance 2 is tensor(16.7861, device='cuda:0')
benign distance is  tensor(16.7861, device='cuda:0')
norm1 res is  tensor(0.1520, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.636744162067771
distance 1 is tensor(43.1696, device='cuda:0')
distance 2 is tensor(3.2884, device='cuda:0')
benign distance is  tensor(3.2884, device='cuda:0')
norm1 res is  tensor(0.1421, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1158459037542343
distance 1 is tensor(178.5404, device='cuda:0')
distance 2 is tensor(12.7717, device='cuda:0')
benign distance is  tensor(12.7717, device='cuda:0')
norm1 res is  tensor(0.1748, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  2.079530857503414
distance 1 is tensor(145.3395, device='cuda:0')
distance 2 is tensor(10.8279, device='cuda:0')
benign distance is  tensor(10.8279, device='cuda:0')
norm1 res is  tensor(0.1423, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(334.8490, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(313.4147, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(492.8129, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(885.8281, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(142.5421, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(248.4200, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(226.9293, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(149.8025, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5086.4922, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5144.7100, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5093.1548, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5098.0698, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5107.4907, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5128.1084, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5120.5908, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5119.9966, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5105.7681, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5101.0122, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5093.0488, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5154.2798, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(588.2338, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(698.0018, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(650.8163, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(719.8585, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(407.4681, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1166.6987, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(818.4089, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(718.2413, device='cuda:0')
norm_2 is  tensor(241.0428, device='cuda:0')
norm_2 * lamda is tensor(433.8770, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 87.97% 

Test Accuracy: 88.56% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
 benign loss is  0.794874757528305
distance 1 is tensor(53.4344, device='cuda:0')
distance 2 is tensor(4.2799, device='cuda:0')
benign distance is  tensor(4.2799, device='cuda:0')
norm1 res is  tensor(0.0458, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8983310703188181
distance 1 is tensor(71.9016, device='cuda:0')
distance 2 is tensor(5.4171, device='cuda:0')
benign distance is  tensor(5.4171, device='cuda:0')
norm1 res is  tensor(0.0984, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6362700052559376
distance 1 is tensor(118.6453, device='cuda:0')
distance 2 is tensor(8.7145, device='cuda:0')
benign distance is  tensor(8.7145, device='cuda:0')
norm1 res is  tensor(0.2323, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.5006021298468113
distance 1 is tensor(222.5041, device='cuda:0')
distance 2 is tensor(16.3602, device='cuda:0')
benign distance is  tensor(16.3602, device='cuda:0')
norm1 res is  tensor(0.1540, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9044861346483231
distance 1 is tensor(72.9802, device='cuda:0')
distance 2 is tensor(5.7226, device='cuda:0')
benign distance is  tensor(5.7226, device='cuda:0')
norm1 res is  tensor(0.0820, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7453510565683246
distance 1 is tensor(44.8623, device='cuda:0')
distance 2 is tensor(3.4818, device='cuda:0')
benign distance is  tensor(3.4818, device='cuda:0')
norm1 res is  tensor(0.0823, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4880064073950052
distance 1 is tensor(71.1708, device='cuda:0')
distance 2 is tensor(5.6836, device='cuda:0')
benign distance is  tensor(5.6836, device='cuda:0')
norm1 res is  tensor(0.0936, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7611125502735376
distance 1 is tensor(86.1952, device='cuda:0')
distance 2 is tensor(6.2550, device='cuda:0')
benign distance is  tensor(6.2550, device='cuda:0')
norm1 res is  tensor(0.1323, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.3648189529776573
distance 1 is tensor(129.0930, device='cuda:0')
distance 2 is tensor(9.5914, device='cuda:0')
benign distance is  tensor(9.5914, device='cuda:0')
norm1 res is  tensor(0.1921, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9226878248155117
distance 1 is tensor(164.2548, device='cuda:0')
distance 2 is tensor(12.2163, device='cuda:0')
benign distance is  tensor(12.2163, device='cuda:0')
norm1 res is  tensor(0.2116, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.4286685846745968
distance 1 is tensor(168.1316, device='cuda:0')
distance 2 is tensor(12.3577, device='cuda:0')
benign distance is  tensor(12.3577, device='cuda:0')
norm1 res is  tensor(0.1699, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.8914000298827887
distance 1 is tensor(166.6657, device='cuda:0')
distance 2 is tensor(12.4659, device='cuda:0')
benign distance is  tensor(12.4659, device='cuda:0')
norm1 res is  tensor(0.1544, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.0924467649310827
distance 1 is tensor(85.1823, device='cuda:0')
distance 2 is tensor(6.2485, device='cuda:0')
benign distance is  tensor(6.2485, device='cuda:0')
norm1 res is  tensor(0.1070, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8462857753038406
distance 1 is tensor(257.8337, device='cuda:0')
distance 2 is tensor(18.7611, device='cuda:0')
benign distance is  tensor(18.7611, device='cuda:0')
norm1 res is  tensor(0.1391, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.3385669402778149
distance 1 is tensor(200.9603, device='cuda:0')
distance 2 is tensor(14.6899, device='cuda:0')
benign distance is  tensor(14.6899, device='cuda:0')
norm1 res is  tensor(0.1303, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.9003939218819141
distance 1 is tensor(156.5136, device='cuda:0')
distance 2 is tensor(11.5855, device='cuda:0')
benign distance is  tensor(11.5855, device='cuda:0')
norm1 res is  tensor(0.1399, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(242.9544, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(302.2929, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(511.4292, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(981.0316, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(330.4964, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(199.8235, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(335.3405, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(362.0582, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5092.7949, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5166.9858, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5101.6001, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5101.7505, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5106.4229, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5152.0386, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5148.2993, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5118.5713, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5126.7485, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5102.7881, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5126.2915, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5162.2017, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(776.3810, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(655.0156, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(873.2557, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(771.3863, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(562.2877, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(505.0232, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(529.7059, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(742.8134, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(637.8069, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(533.4195, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(798.2804, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(683.3149, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(770.6365, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(759.8656, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(709.6086, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(972.7083, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(347.5295, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(724.7004, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(269.2390, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(656.4525, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(1023.8781, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(204.3400, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(776.9343, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(646.9341, device='cuda:0')
norm_2 is  tensor(361.7495, device='cuda:0')
norm_2 * lamda is tensor(651.1490, device='cuda:0')
satisfying 43
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 87.66% 

Test Accuracy: 88.59% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
 benign loss is  0.805176105350256
distance 1 is tensor(62.9593, device='cuda:0')
distance 2 is tensor(4.7923, device='cuda:0')
benign distance is  tensor(4.7923, device='cuda:0')
norm1 res is  tensor(0.0510, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7681642826646566
distance 1 is tensor(42.9672, device='cuda:0')
distance 2 is tensor(3.3406, device='cuda:0')
benign distance is  tensor(3.3406, device='cuda:0')
norm1 res is  tensor(0.0599, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9446310419589281
distance 1 is tensor(67.0357, device='cuda:0')
distance 2 is tensor(5.1171, device='cuda:0')
benign distance is  tensor(5.1171, device='cuda:0')
norm1 res is  tensor(0.1354, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.2457982897758484
distance 1 is tensor(156.5745, device='cuda:0')
distance 2 is tensor(11.5551, device='cuda:0')
benign distance is  tensor(11.5551, device='cuda:0')
norm1 res is  tensor(0.1111, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8156008534133434
distance 1 is tensor(34.7425, device='cuda:0')
distance 2 is tensor(2.9065, device='cuda:0')
benign distance is  tensor(2.9065, device='cuda:0')
norm1 res is  tensor(0.0376, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6330923466011882
distance 1 is tensor(55.1464, device='cuda:0')
distance 2 is tensor(4.3017, device='cuda:0')
benign distance is  tensor(4.3017, device='cuda:0')
norm1 res is  tensor(0.0963, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.0946747343987226
distance 1 is tensor(40.5003, device='cuda:0')
distance 2 is tensor(3.3191, device='cuda:0')
benign distance is  tensor(3.3191, device='cuda:0')
norm1 res is  tensor(0.0472, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6956414300948381
distance 1 is tensor(62.4620, device='cuda:0')
distance 2 is tensor(4.6142, device='cuda:0')
benign distance is  tensor(4.6142, device='cuda:0')
norm1 res is  tensor(0.0976, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.3496966399252415
distance 1 is tensor(100.0054, device='cuda:0')
distance 2 is tensor(7.4905, device='cuda:0')
benign distance is  tensor(7.4905, device='cuda:0')
norm1 res is  tensor(0.1121, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0815523378551006
distance 1 is tensor(179.3944, device='cuda:0')
distance 2 is tensor(13.1999, device='cuda:0')
benign distance is  tensor(13.1999, device='cuda:0')
norm1 res is  tensor(0.2076, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.2337758541107178
distance 1 is tensor(63.2590, device='cuda:0')
distance 2 is tensor(5.1347, device='cuda:0')
benign distance is  tensor(5.1347, device='cuda:0')
norm1 res is  tensor(0.0915, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.7273746319115162
distance 1 is tensor(139.6904, device='cuda:0')
distance 2 is tensor(10.3769, device='cuda:0')
benign distance is  tensor(10.3769, device='cuda:0')
norm1 res is  tensor(0.1454, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.0569759588688612
distance 1 is tensor(202.6677, device='cuda:0')
distance 2 is tensor(14.6905, device='cuda:0')
benign distance is  tensor(14.6905, device='cuda:0')
norm1 res is  tensor(0.1336, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7718286961317062
distance 1 is tensor(34.8138, device='cuda:0')
distance 2 is tensor(2.8297, device='cuda:0')
benign distance is  tensor(2.8297, device='cuda:0')
norm1 res is  tensor(0.0947, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.344048224389553
distance 1 is tensor(168.0486, device='cuda:0')
distance 2 is tensor(12.2821, device='cuda:0')
benign distance is  tensor(12.2821, device='cuda:0')
norm1 res is  tensor(0.1662, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.4341008998453617
distance 1 is tensor(169.1388, device='cuda:0')
distance 2 is tensor(12.5197, device='cuda:0')
benign distance is  tensor(12.5197, device='cuda:0')
norm1 res is  tensor(0.1660, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.13241358846426
distance 1 is tensor(155.8778, device='cuda:0')
distance 2 is tensor(11.5051, device='cuda:0')
benign distance is  tensor(11.5051, device='cuda:0')
norm1 res is  tensor(0.1722, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.9274697303771973
distance 1 is tensor(101.4886, device='cuda:0')
distance 2 is tensor(7.5435, device='cuda:0')
benign distance is  tensor(7.5435, device='cuda:0')
norm1 res is  tensor(0.2776, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.152339767664671
distance 1 is tensor(174.5407, device='cuda:0')
distance 2 is tensor(13.1128, device='cuda:0')
benign distance is  tensor(13.1128, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.2489927783608437
distance 1 is tensor(143.9417, device='cuda:0')
distance 2 is tensor(10.9812, device='cuda:0')
benign distance is  tensor(10.9812, device='cuda:0')
norm1 res is  tensor(0.1620, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.2100531654432416
distance 1 is tensor(166.4376, device='cuda:0')
distance 2 is tensor(12.3191, device='cuda:0')
benign distance is  tensor(12.3191, device='cuda:0')
norm1 res is  tensor(0.1874, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  1.2327929679304361
distance 1 is tensor(154.4105, device='cuda:0')
distance 2 is tensor(11.5219, device='cuda:0')
benign distance is  tensor(11.5219, device='cuda:0')
norm1 res is  tensor(0.1613, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5905639454722404
distance 1 is tensor(167.5217, device='cuda:0')
distance 2 is tensor(12.2944, device='cuda:0')
benign distance is  tensor(12.2944, device='cuda:0')
norm1 res is  tensor(0.1882, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.9104694239795208
distance 1 is tensor(230.3470, device='cuda:0')
distance 2 is tensor(16.9522, device='cuda:0')
benign distance is  tensor(16.9522, device='cuda:0')
norm1 res is  tensor(0.2095, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.6264668833464384
distance 1 is tensor(167.0604, device='cuda:0')
distance 2 is tensor(12.7032, device='cuda:0')
benign distance is  tensor(12.7032, device='cuda:0')
norm1 res is  tensor(0.2054, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.031193595379591
distance 1 is tensor(140.7860, device='cuda:0')
distance 2 is tensor(10.8448, device='cuda:0')
benign distance is  tensor(10.8448, device='cuda:0')
norm1 res is  tensor(0.2048, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.6887974832206964
distance 1 is tensor(196.9888, device='cuda:0')
distance 2 is tensor(14.4079, device='cuda:0')
benign distance is  tensor(14.4079, device='cuda:0')
norm1 res is  tensor(0.1918, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.854104034602642
distance 1 is tensor(165.1129, device='cuda:0')
distance 2 is tensor(11.9654, device='cuda:0')
benign distance is  tensor(11.9654, device='cuda:0')
norm1 res is  tensor(0.1241, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.9322331324219704
distance 1 is tensor(148.2301, device='cuda:0')
distance 2 is tensor(11.0877, device='cuda:0')
benign distance is  tensor(11.0877, device='cuda:0')
norm1 res is  tensor(0.1620, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.9240774875506759
distance 1 is tensor(110.4075, device='cuda:0')
distance 2 is tensor(8.1998, device='cuda:0')
benign distance is  tensor(8.1998, device='cuda:0')
norm1 res is  tensor(0.1395, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.9317836202681065
distance 1 is tensor(110.9345, device='cuda:0')
distance 2 is tensor(8.1368, device='cuda:0')
benign distance is  tensor(8.1368, device='cuda:0')
norm1 res is  tensor(0.2217, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6338242860510945
distance 1 is tensor(151.4414, device='cuda:0')
distance 2 is tensor(11.3236, device='cuda:0')
benign distance is  tensor(11.3236, device='cuda:0')
norm1 res is  tensor(0.1853, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(266.9739, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(189.7152, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(297.8306, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(699.2837, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(155.7803, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(248.6605, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(179.2433, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(265.7855, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5090.8486, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5153.2583, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5115.3047, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5132.5762, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5109.2080, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5130.7427, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5131.2197, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5106.2070, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5131.3486, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5100.3149, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5125.9814, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5152.3511, device='cuda:0')
norm_2 is  tensor(196.2642, device='cuda:0')
norm_2 * lamda is tensor(353.2756, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 88.97% 

Test Accuracy: 89.02% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7469367068260908
distance 1 is tensor(100.0054, device='cuda:0')
distance 2 is tensor(7.4819, device='cuda:0')
benign distance is  tensor(7.4819, device='cuda:0')
norm1 res is  tensor(0.0845, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7431663796305656
distance 1 is tensor(53.5344, device='cuda:0')
distance 2 is tensor(4.0949, device='cuda:0')
benign distance is  tensor(4.0949, device='cuda:0')
norm1 res is  tensor(0.0729, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7075365204364061
distance 1 is tensor(93.4483, device='cuda:0')
distance 2 is tensor(7.0311, device='cuda:0')
benign distance is  tensor(7.0311, device='cuda:0')
norm1 res is  tensor(0.1785, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3913673348724842
distance 1 is tensor(193.2744, device='cuda:0')
distance 2 is tensor(14.1677, device='cuda:0')
benign distance is  tensor(14.1677, device='cuda:0')
norm1 res is  tensor(0.1366, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8131318297237158
distance 1 is tensor(124.2410, device='cuda:0')
distance 2 is tensor(9.2344, device='cuda:0')
benign distance is  tensor(9.2344, device='cuda:0')
norm1 res is  tensor(0.1293, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7802688889205456
distance 1 is tensor(41.4927, device='cuda:0')
distance 2 is tensor(3.2094, device='cuda:0')
benign distance is  tensor(3.2094, device='cuda:0')
norm1 res is  tensor(0.0745, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2462835535407066
distance 1 is tensor(43.6523, device='cuda:0')
distance 2 is tensor(3.4844, device='cuda:0')
benign distance is  tensor(3.4844, device='cuda:0')
norm1 res is  tensor(0.0506, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7350890096276999
distance 1 is tensor(73.8035, device='cuda:0')
distance 2 is tensor(5.6041, device='cuda:0')
benign distance is  tensor(5.6041, device='cuda:0')
norm1 res is  tensor(0.1207, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(445.2932, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(233.2947, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(417.9247, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(864.6746, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(529.0922, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(179.4985, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(190.2070, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(329.5979, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5110.0703, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5169.2212, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5107.3682, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5113.7710, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5119.7891, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5145.3052, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5141.5879, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5124.9507, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5151.8892, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5122.5312, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5138.8076, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5182.4463, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(767.3236, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(994.5023, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(845.3323, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(665.8762, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(919.4393, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(827.7242, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(768.3824, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(839.6519, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(573.3408, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(733.2863, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(723.6126, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(743.4778, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(377.9403, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1126.7310, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(877.1562, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(707.1084, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(444.1228, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(807.9655, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(298.2790, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(628.9644, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(901.5803, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(168.4774, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(750.4254, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(757.2432, device='cuda:0')
norm_2 is  tensor(421.3311, device='cuda:0')
norm_2 * lamda is tensor(758.3960, device='cuda:0')
satisfying 43
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 85.15% 

Test Accuracy: 87.91% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6380611434578896
distance 1 is tensor(61.7657, device='cuda:0')
distance 2 is tensor(4.7625, device='cuda:0')
benign distance is  tensor(4.7625, device='cuda:0')
norm1 res is  tensor(0.0515, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7674781307578087
distance 1 is tensor(46.9797, device='cuda:0')
distance 2 is tensor(3.6396, device='cuda:0')
benign distance is  tensor(3.6396, device='cuda:0')
norm1 res is  tensor(0.0668, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8736507054418325
distance 1 is tensor(101.2029, device='cuda:0')
distance 2 is tensor(7.5415, device='cuda:0')
benign distance is  tensor(7.5415, device='cuda:0')
norm1 res is  tensor(0.1945, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.4966173470020294
distance 1 is tensor(222.7774, device='cuda:0')
distance 2 is tensor(16.0233, device='cuda:0')
benign distance is  tensor(16.0233, device='cuda:0')
norm1 res is  tensor(0.1532, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8978570159524679
distance 1 is tensor(53.5581, device='cuda:0')
distance 2 is tensor(4.6082, device='cuda:0')
benign distance is  tensor(4.6082, device='cuda:0')
norm1 res is  tensor(0.0628, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7140656057745218
distance 1 is tensor(51.0552, device='cuda:0')
distance 2 is tensor(3.9712, device='cuda:0')
benign distance is  tensor(3.9712, device='cuda:0')
norm1 res is  tensor(0.0846, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2200675010681152
distance 1 is tensor(45.5972, device='cuda:0')
distance 2 is tensor(3.7118, device='cuda:0')
benign distance is  tensor(3.7118, device='cuda:0')
norm1 res is  tensor(0.0535, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7276646196842194
distance 1 is tensor(48.9459, device='cuda:0')
distance 2 is tensor(3.7640, device='cuda:0')
benign distance is  tensor(3.7640, device='cuda:0')
norm1 res is  tensor(0.0754, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.954218402504921
distance 1 is tensor(104.0145, device='cuda:0')
distance 2 is tensor(7.5861, device='cuda:0')
benign distance is  tensor(7.5861, device='cuda:0')
norm1 res is  tensor(0.1139, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.89891267567873
distance 1 is tensor(149.7947, device='cuda:0')
distance 2 is tensor(11.0807, device='cuda:0')
benign distance is  tensor(11.0807, device='cuda:0')
norm1 res is  tensor(0.1613, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0397412022575736
distance 1 is tensor(53.8031, device='cuda:0')
distance 2 is tensor(4.1810, device='cuda:0')
benign distance is  tensor(4.1810, device='cuda:0')
norm1 res is  tensor(0.0707, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.302245393395424
distance 1 is tensor(93.2455, device='cuda:0')
distance 2 is tensor(7.1040, device='cuda:0')
benign distance is  tensor(7.1040, device='cuda:0')
norm1 res is  tensor(0.0944, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.526043076068163
distance 1 is tensor(222.5003, device='cuda:0')
distance 2 is tensor(16.2475, device='cuda:0')
benign distance is  tensor(16.2475, device='cuda:0')
norm1 res is  tensor(0.1440, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.77492197137326
distance 1 is tensor(40.8785, device='cuda:0')
distance 2 is tensor(3.0644, device='cuda:0')
benign distance is  tensor(3.0644, device='cuda:0')
norm1 res is  tensor(0.1077, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.2309145294129848
distance 1 is tensor(155.4352, device='cuda:0')
distance 2 is tensor(11.1340, device='cuda:0')
benign distance is  tensor(11.1340, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.9751400351524353
distance 1 is tensor(163.1915, device='cuda:0')
distance 2 is tensor(12.1433, device='cuda:0')
benign distance is  tensor(12.1433, device='cuda:0')
norm1 res is  tensor(0.1616, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.3496405705809593
distance 1 is tensor(105.8757, device='cuda:0')
distance 2 is tensor(8.1298, device='cuda:0')
benign distance is  tensor(8.1298, device='cuda:0')
norm1 res is  tensor(0.1580, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  1.1897658631205559
distance 1 is tensor(127.8127, device='cuda:0')
distance 2 is tensor(9.5755, device='cuda:0')
benign distance is  tensor(9.5755, device='cuda:0')
norm1 res is  tensor(0.1649, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.9214825425297022
distance 1 is tensor(157.5653, device='cuda:0')
distance 2 is tensor(11.4907, device='cuda:0')
benign distance is  tensor(11.4907, device='cuda:0')
norm1 res is  tensor(0.1571, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9655579756945372
distance 1 is tensor(190.7273, device='cuda:0')
distance 2 is tensor(14.5156, device='cuda:0')
benign distance is  tensor(14.5156, device='cuda:0')
norm1 res is  tensor(0.1797, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.0294854268431664
distance 1 is tensor(82.2387, device='cuda:0')
distance 2 is tensor(6.0537, device='cuda:0')
benign distance is  tensor(6.0537, device='cuda:0')
norm1 res is  tensor(0.1033, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9844118487089872
distance 1 is tensor(269.8717, device='cuda:0')
distance 2 is tensor(19.4593, device='cuda:0')
benign distance is  tensor(19.4593, device='cuda:0')
norm1 res is  tensor(0.1451, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.2671592347323895
distance 1 is tensor(172.8877, device='cuda:0')
distance 2 is tensor(12.7699, device='cuda:0')
benign distance is  tensor(12.7699, device='cuda:0')
norm1 res is  tensor(0.1135, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.0446636192500591
distance 1 is tensor(143.3639, device='cuda:0')
distance 2 is tensor(10.4719, device='cuda:0')
benign distance is  tensor(10.4719, device='cuda:0')
norm1 res is  tensor(0.1262, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.285129027441144
distance 1 is tensor(141.6217, device='cuda:0')
distance 2 is tensor(10.7805, device='cuda:0')
benign distance is  tensor(10.7805, device='cuda:0')
norm1 res is  tensor(0.1456, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.3042552508413792
distance 1 is tensor(172.3840, device='cuda:0')
distance 2 is tensor(12.8772, device='cuda:0')
benign distance is  tensor(12.8772, device='cuda:0')
norm1 res is  tensor(0.1701, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.5234309807419777
distance 1 is tensor(184.8761, device='cuda:0')
distance 2 is tensor(13.7294, device='cuda:0')
benign distance is  tensor(13.7294, device='cuda:0')
norm1 res is  tensor(0.1312, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  1.0862986110150814
distance 1 is tensor(121.3741, device='cuda:0')
distance 2 is tensor(9.3382, device='cuda:0')
benign distance is  tensor(9.3382, device='cuda:0')
norm1 res is  tensor(0.2825, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.9766090363264084
distance 1 is tensor(215.7495, device='cuda:0')
distance 2 is tensor(15.6256, device='cuda:0')
benign distance is  tensor(15.6256, device='cuda:0')
norm1 res is  tensor(0.2052, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.8655542433261871
distance 1 is tensor(175.3723, device='cuda:0')
distance 2 is tensor(12.7401, device='cuda:0')
benign distance is  tensor(12.7401, device='cuda:0')
norm1 res is  tensor(0.2126, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8818555530160666
distance 1 is tensor(141.7527, device='cuda:0')
distance 2 is tensor(10.5386, device='cuda:0')
benign distance is  tensor(10.5386, device='cuda:0')
norm1 res is  tensor(0.1975, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.7532298788428307
distance 1 is tensor(180.3782, device='cuda:0')
distance 2 is tensor(13.2082, device='cuda:0')
benign distance is  tensor(13.2082, device='cuda:0')
norm1 res is  tensor(0.2018, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(272.7621, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(205.0884, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(436.3074, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(974.9900, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(259.9551, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(219.2906, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(202.8586, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(206.9200, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5098.8633, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5179.9116, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5119.6562, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5122.7266, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5110.8286, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5141.7700, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5142.0234, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5127.3721, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5155.0752, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5117.1953, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5129.6616, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5186.9429, device='cuda:0')
norm_2 is  tensor(281.7554, device='cuda:0')
norm_2 * lamda is tensor(507.1597, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 87.31% 

Test Accuracy: 88.64% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6665649134665728
distance 1 is tensor(51.6787, device='cuda:0')
distance 2 is tensor(4.1545, device='cuda:0')
benign distance is  tensor(4.1545, device='cuda:0')
norm1 res is  tensor(0.0454, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7524799099192023
distance 1 is tensor(46.9357, device='cuda:0')
distance 2 is tensor(3.6835, device='cuda:0')
benign distance is  tensor(3.6835, device='cuda:0')
norm1 res is  tensor(0.0651, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8957218993455172
distance 1 is tensor(98.6585, device='cuda:0')
distance 2 is tensor(7.3301, device='cuda:0')
benign distance is  tensor(7.3301, device='cuda:0')
norm1 res is  tensor(0.1873, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.046891774982214
distance 1 is tensor(213.5464, device='cuda:0')
distance 2 is tensor(15.4009, device='cuda:0')
benign distance is  tensor(15.4009, device='cuda:0')
norm1 res is  tensor(0.1464, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8057456822134554
distance 1 is tensor(49.2291, device='cuda:0')
distance 2 is tensor(3.9695, device='cuda:0')
benign distance is  tensor(3.9695, device='cuda:0')
norm1 res is  tensor(0.0534, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6791819892823696
distance 1 is tensor(85.1353, device='cuda:0')
distance 2 is tensor(6.2276, device='cuda:0')
benign distance is  tensor(6.2276, device='cuda:0')
norm1 res is  tensor(0.1452, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1261633932590485
distance 1 is tensor(55.9854, device='cuda:0')
distance 2 is tensor(4.3362, device='cuda:0')
benign distance is  tensor(4.3362, device='cuda:0')
norm1 res is  tensor(0.0642, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7118615517392755
distance 1 is tensor(41.9792, device='cuda:0')
distance 2 is tensor(3.2980, device='cuda:0')
benign distance is  tensor(3.2980, device='cuda:0')
norm1 res is  tensor(0.0657, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(240.1876, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(210.1395, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(423.5069, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(927.9808, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(221.5190, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(353.2664, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(243.6592, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(178.1825, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5110.6675, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5195.2451, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5139.5771, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5154.1362, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5132.0981, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5148.5522, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5162.2827, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5138.1182, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5149.9155, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5124.1641, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5144.0220, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5180.8237, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(698.3975, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(458.8062, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(785.2002, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(650.2375, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(744.9632, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(696.3364, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(737.5626, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(1028.3645, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(451.2591, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(670.3770, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(243.7393, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(415.3534, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(970.8873, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(189.7978, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(671.8673, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(728.5280, device='cuda:0')
norm_2 is  tensor(438.4210, device='cuda:0')
norm_2 * lamda is tensor(789.1578, device='cuda:0')
satisfying 35
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 86.57% 

Test Accuracy: 88.01% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7175831580534577
distance 1 is tensor(41.5867, device='cuda:0')
distance 2 is tensor(3.3257, device='cuda:0')
benign distance is  tensor(3.3257, device='cuda:0')
norm1 res is  tensor(0.0334, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6965089133009315
distance 1 is tensor(47.6319, device='cuda:0')
distance 2 is tensor(3.7390, device='cuda:0')
benign distance is  tensor(3.7390, device='cuda:0')
norm1 res is  tensor(0.0639, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7876032255589962
distance 1 is tensor(53.5942, device='cuda:0')
distance 2 is tensor(4.2165, device='cuda:0')
benign distance is  tensor(4.2165, device='cuda:0')
norm1 res is  tensor(0.0976, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.185788620263338
distance 1 is tensor(197.0137, device='cuda:0')
distance 2 is tensor(14.1292, device='cuda:0')
benign distance is  tensor(14.1292, device='cuda:0')
norm1 res is  tensor(0.1349, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8589648576453328
distance 1 is tensor(39.4321, device='cuda:0')
distance 2 is tensor(3.3364, device='cuda:0')
benign distance is  tensor(3.3364, device='cuda:0')
norm1 res is  tensor(0.0437, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7007730593904853
distance 1 is tensor(48.4354, device='cuda:0')
distance 2 is tensor(3.7704, device='cuda:0')
benign distance is  tensor(3.7704, device='cuda:0')
norm1 res is  tensor(0.0822, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.615202646702528
distance 1 is tensor(66.7143, device='cuda:0')
distance 2 is tensor(5.0724, device='cuda:0')
benign distance is  tensor(5.0724, device='cuda:0')
norm1 res is  tensor(0.0748, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6942731812596321
distance 1 is tensor(36.9775, device='cuda:0')
distance 2 is tensor(2.9003, device='cuda:0')
benign distance is  tensor(2.9003, device='cuda:0')
norm1 res is  tensor(0.0579, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.1807071566581726
distance 1 is tensor(77.8216, device='cuda:0')
distance 2 is tensor(5.9520, device='cuda:0')
benign distance is  tensor(5.9520, device='cuda:0')
norm1 res is  tensor(0.0859, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8441661261022091
distance 1 is tensor(177.2301, device='cuda:0')
distance 2 is tensor(12.9758, device='cuda:0')
benign distance is  tensor(12.9758, device='cuda:0')
norm1 res is  tensor(0.1908, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.022649273276329
distance 1 is tensor(47.7292, device='cuda:0')
distance 2 is tensor(3.9255, device='cuda:0')
benign distance is  tensor(3.9255, device='cuda:0')
norm1 res is  tensor(0.0669, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.2612878680229187
distance 1 is tensor(127.9191, device='cuda:0')
distance 2 is tensor(9.5436, device='cuda:0')
benign distance is  tensor(9.5436, device='cuda:0')
norm1 res is  tensor(0.1313, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.3782836310565472
distance 1 is tensor(204.8347, device='cuda:0')
distance 2 is tensor(14.8685, device='cuda:0')
benign distance is  tensor(14.8685, device='cuda:0')
norm1 res is  tensor(0.1328, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.8118351390585303
distance 1 is tensor(32.0696, device='cuda:0')
distance 2 is tensor(2.5469, device='cuda:0')
benign distance is  tensor(2.5469, device='cuda:0')
norm1 res is  tensor(0.0831, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1736514158546925
distance 1 is tensor(147.2975, device='cuda:0')
distance 2 is tensor(10.7262, device='cuda:0')
benign distance is  tensor(10.7262, device='cuda:0')
norm1 res is  tensor(0.1440, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.6809520199894905
distance 1 is tensor(143.1503, device='cuda:0')
distance 2 is tensor(10.5296, device='cuda:0')
benign distance is  tensor(10.5296, device='cuda:0')
norm1 res is  tensor(0.1407, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.1177984699606895
distance 1 is tensor(154.4364, device='cuda:0')
distance 2 is tensor(11.5885, device='cuda:0')
benign distance is  tensor(11.5885, device='cuda:0')
norm1 res is  tensor(0.1723, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.8612796552479267
distance 1 is tensor(97.7123, device='cuda:0')
distance 2 is tensor(7.3422, device='cuda:0')
benign distance is  tensor(7.3422, device='cuda:0')
norm1 res is  tensor(0.2761, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.1419961974024773
distance 1 is tensor(155.0734, device='cuda:0')
distance 2 is tensor(11.4473, device='cuda:0')
benign distance is  tensor(11.4473, device='cuda:0')
norm1 res is  tensor(0.1334, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.420264720916748
distance 1 is tensor(163.6012, device='cuda:0')
distance 2 is tensor(12.2960, device='cuda:0')
benign distance is  tensor(12.2960, device='cuda:0')
norm1 res is  tensor(0.1876, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.111306767910719
distance 1 is tensor(141.8344, device='cuda:0')
distance 2 is tensor(10.4356, device='cuda:0')
benign distance is  tensor(10.4356, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.9067812245339155
distance 1 is tensor(133.4911, device='cuda:0')
distance 2 is tensor(10.0574, device='cuda:0')
benign distance is  tensor(10.0574, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5108821839094162
distance 1 is tensor(150.2096, device='cuda:0')
distance 2 is tensor(11.0564, device='cuda:0')
benign distance is  tensor(11.0564, device='cuda:0')
norm1 res is  tensor(0.1729, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.766179570928216
distance 1 is tensor(208.7461, device='cuda:0')
distance 2 is tensor(15.4197, device='cuda:0')
benign distance is  tensor(15.4197, device='cuda:0')
norm1 res is  tensor(0.1866, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(176.9648, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(210.1100, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(233.1383, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(847.9353, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(181.1641, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(207.1133, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(284.0971, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(153.7462, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5110.7202, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5175.6753, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5123.7207, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5124.4946, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5125.1909, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5145.5508, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5150.2026, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5127.1353, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5163.9526, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5129.1768, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5126.2588, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5191.6714, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(751.4406, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(663.6884, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(867.4133, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(730.4658, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(662.1456, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(497.9436, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(492.6740, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(682.1356, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(484.2149, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(572.9947, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(670.2800, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(856.1359, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(355.6477, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1176.5776, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(763.6078, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(636.4289, device='cuda:0')
norm_2 is  tensor(230.8555, device='cuda:0')
norm_2 * lamda is tensor(415.5399, device='cuda:0')
do  not satisfying 35
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 86.51% 

Test Accuracy: 88.32% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7319247610867023
distance 1 is tensor(56.8272, device='cuda:0')
distance 2 is tensor(4.4508, device='cuda:0')
benign distance is  tensor(4.4508, device='cuda:0')
norm1 res is  tensor(0.0476, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7595411259680986
distance 1 is tensor(47.7228, device='cuda:0')
distance 2 is tensor(3.7436, device='cuda:0')
benign distance is  tensor(3.7436, device='cuda:0')
norm1 res is  tensor(0.0697, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.716509897261858
distance 1 is tensor(92.8980, device='cuda:0')
distance 2 is tensor(6.9876, device='cuda:0')
benign distance is  tensor(6.9876, device='cuda:0')
norm1 res is  tensor(0.1880, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0309036411345005
distance 1 is tensor(183.3166, device='cuda:0')
distance 2 is tensor(13.3555, device='cuda:0')
benign distance is  tensor(13.3555, device='cuda:0')
norm1 res is  tensor(0.1284, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0040013743564487
distance 1 is tensor(44.8689, device='cuda:0')
distance 2 is tensor(3.6554, device='cuda:0')
benign distance is  tensor(3.6554, device='cuda:0')
norm1 res is  tensor(0.0495, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6672066105529666
distance 1 is tensor(56.3554, device='cuda:0')
distance 2 is tensor(4.4072, device='cuda:0')
benign distance is  tensor(4.4072, device='cuda:0')
norm1 res is  tensor(0.0975, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.0131126772612333
distance 1 is tensor(40.6854, device='cuda:0')
distance 2 is tensor(3.3116, device='cuda:0')
benign distance is  tensor(3.3116, device='cuda:0')
norm1 res is  tensor(0.0509, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7439836692065
distance 1 is tensor(57.7576, device='cuda:0')
distance 2 is tensor(4.5169, device='cuda:0')
benign distance is  tensor(4.5169, device='cuda:0')
norm1 res is  tensor(0.0981, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.4756019338965416
distance 1 is tensor(140.7409, device='cuda:0')
distance 2 is tensor(10.3661, device='cuda:0')
benign distance is  tensor(10.3661, device='cuda:0')
norm1 res is  tensor(0.2053, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  1.0206308662891388
distance 1 is tensor(141.4995, device='cuda:0')
distance 2 is tensor(10.4314, device='cuda:0')
benign distance is  tensor(10.4314, device='cuda:0')
norm1 res is  tensor(0.1817, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.4620669223368168
distance 1 is tensor(158.4371, device='cuda:0')
distance 2 is tensor(11.6629, device='cuda:0')
benign distance is  tensor(11.6629, device='cuda:0')
norm1 res is  tensor(0.1582, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.1192226186394691
distance 1 is tensor(152.4712, device='cuda:0')
distance 2 is tensor(11.3330, device='cuda:0')
benign distance is  tensor(11.3330, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9467878770083189
distance 1 is tensor(61.8991, device='cuda:0')
distance 2 is tensor(4.8395, device='cuda:0')
benign distance is  tensor(4.8395, device='cuda:0')
norm1 res is  tensor(0.0818, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9474127255380154
distance 1 is tensor(260.8249, device='cuda:0')
distance 2 is tensor(18.9859, device='cuda:0')
benign distance is  tensor(18.9859, device='cuda:0')
norm1 res is  tensor(0.1419, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.0705717913806438
distance 1 is tensor(184.7326, device='cuda:0')
distance 2 is tensor(13.6254, device='cuda:0')
benign distance is  tensor(13.6254, device='cuda:0')
norm1 res is  tensor(0.1187, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.908673994243145
distance 1 is tensor(160.9192, device='cuda:0')
distance 2 is tensor(11.8720, device='cuda:0')
benign distance is  tensor(11.8720, device='cuda:0')
norm1 res is  tensor(0.1400, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  1.035245630890131
distance 1 is tensor(168.3704, device='cuda:0')
distance 2 is tensor(12.6025, device='cuda:0')
benign distance is  tensor(12.6025, device='cuda:0')
norm1 res is  tensor(0.2050, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.0564837362617254
distance 1 is tensor(135.8930, device='cuda:0')
distance 2 is tensor(10.0024, device='cuda:0')
benign distance is  tensor(10.0024, device='cuda:0')
norm1 res is  tensor(0.1840, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.796867985278368
distance 1 is tensor(192.0490, device='cuda:0')
distance 2 is tensor(14.2193, device='cuda:0')
benign distance is  tensor(14.2193, device='cuda:0')
norm1 res is  tensor(0.1891, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.9076049327850342
distance 1 is tensor(184.7997, device='cuda:0')
distance 2 is tensor(13.3414, device='cuda:0')
benign distance is  tensor(13.3414, device='cuda:0')
norm1 res is  tensor(0.1366, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.8109404146671295
distance 1 is tensor(140.3462, device='cuda:0')
distance 2 is tensor(10.4437, device='cuda:0')
benign distance is  tensor(10.4437, device='cuda:0')
norm1 res is  tensor(0.1504, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.6930325105786324
distance 1 is tensor(112.2046, device='cuda:0')
distance 2 is tensor(8.2908, device='cuda:0')
benign distance is  tensor(8.2908, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.9970488380640745
distance 1 is tensor(129.0241, device='cuda:0')
distance 2 is tensor(9.4579, device='cuda:0')
benign distance is  tensor(9.4579, device='cuda:0')
norm1 res is  tensor(0.2568, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.8437917390838265
distance 1 is tensor(164.1641, device='cuda:0')
distance 2 is tensor(12.1687, device='cuda:0')
benign distance is  tensor(12.1687, device='cuda:0')
norm1 res is  tensor(0.1955, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(252.2885, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(217.0284, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(413.5708, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(816.5280, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(205.2935, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(256.4543, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(186.1381, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(257.2051, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5126.0283, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5182.4478, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5140.0176, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5158.9326, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5143.9248, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5169.4873, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5166.0894, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5142.3687, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5164.4194, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5149.1528, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5133.8320, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5203.0610, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(344.2568, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(783.3189, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(226.1552, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(566.8105, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(895.0522, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(149.9253, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(651.3950, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(635.6031, device='cuda:0')
norm_2 is  tensor(195.6232, device='cuda:0')
norm_2 * lamda is tensor(352.1217, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 86.21% 

Test Accuracy: 88.39% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8689930737018585
distance 1 is tensor(69.9653, device='cuda:0')
distance 2 is tensor(5.4420, device='cuda:0')
benign distance is  tensor(5.4420, device='cuda:0')
norm1 res is  tensor(0.0608, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.0077211186289787
distance 1 is tensor(58.4185, device='cuda:0')
distance 2 is tensor(4.4567, device='cuda:0')
benign distance is  tensor(4.4567, device='cuda:0')
norm1 res is  tensor(0.0763, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  1.0181039702147245
distance 1 is tensor(82.0536, device='cuda:0')
distance 2 is tensor(6.0606, device='cuda:0')
benign distance is  tensor(6.0606, device='cuda:0')
norm1 res is  tensor(0.1487, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3180987946689129
distance 1 is tensor(206.5055, device='cuda:0')
distance 2 is tensor(15.0345, device='cuda:0')
benign distance is  tensor(15.0345, device='cuda:0')
norm1 res is  tensor(0.1454, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9176960624754429
distance 1 is tensor(46.3434, device='cuda:0')
distance 2 is tensor(3.6932, device='cuda:0')
benign distance is  tensor(3.6932, device='cuda:0')
norm1 res is  tensor(0.0505, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6858259956352413
distance 1 is tensor(34.6731, device='cuda:0')
distance 2 is tensor(2.7873, device='cuda:0')
benign distance is  tensor(2.7873, device='cuda:0')
norm1 res is  tensor(0.0598, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1562374792993069
distance 1 is tensor(65.6025, device='cuda:0')
distance 2 is tensor(4.9481, device='cuda:0')
benign distance is  tensor(4.9481, device='cuda:0')
norm1 res is  tensor(0.0742, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6228784015402198
distance 1 is tensor(46.1070, device='cuda:0')
distance 2 is tensor(3.6510, device='cuda:0')
benign distance is  tensor(3.6510, device='cuda:0')
norm1 res is  tensor(0.0751, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.102712694555521
distance 1 is tensor(89.7213, device='cuda:0')
distance 2 is tensor(6.7616, device='cuda:0')
benign distance is  tensor(6.7616, device='cuda:0')
norm1 res is  tensor(0.1013, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9700511759147048
distance 1 is tensor(165.7628, device='cuda:0')
distance 2 is tensor(12.1136, device='cuda:0')
benign distance is  tensor(12.1136, device='cuda:0')
norm1 res is  tensor(0.1767, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.936024745926261
distance 1 is tensor(58.1316, device='cuda:0')
distance 2 is tensor(4.4858, device='cuda:0')
benign distance is  tensor(4.4858, device='cuda:0')
norm1 res is  tensor(0.0761, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.4206362552940845
distance 1 is tensor(161.5025, device='cuda:0')
distance 2 is tensor(11.8023, device='cuda:0')
benign distance is  tensor(11.8023, device='cuda:0')
norm1 res is  tensor(0.1663, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.6784746907651424
distance 1 is tensor(258.9289, device='cuda:0')
distance 2 is tensor(19.3011, device='cuda:0')
benign distance is  tensor(19.3011, device='cuda:0')
norm1 res is  tensor(0.1670, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.8592747449874878
distance 1 is tensor(51.0283, device='cuda:0')
distance 2 is tensor(3.9098, device='cuda:0')
benign distance is  tensor(3.9098, device='cuda:0')
norm1 res is  tensor(0.1479, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.2299839742481709
distance 1 is tensor(218.2950, device='cuda:0')
distance 2 is tensor(15.6792, device='cuda:0')
benign distance is  tensor(15.6792, device='cuda:0')
norm1 res is  tensor(0.2105, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.4929544664919376
distance 1 is tensor(142.6250, device='cuda:0')
distance 2 is tensor(10.5360, device='cuda:0')
benign distance is  tensor(10.5360, device='cuda:0')
norm1 res is  tensor(0.1374, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(305.3702, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(251.3960, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(346.7308, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(912.8036, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(199.0253, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(157.8281, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(280.5005, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(205.0513, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5141.5762, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5198.7974, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5144.3691, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5150.8564, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5148.8154, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5182.8291, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5178.4067, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5154.3970, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5176.6309, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5143.3735, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5160.1069, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5211.0088, device='cuda:0')
norm_2 is  tensor(140.8772, device='cuda:0')
norm_2 * lamda is tensor(253.5789, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 85.02% 

Test Accuracy: 88.06% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
 benign loss is  0.889164499938488
distance 1 is tensor(91.3187, device='cuda:0')
distance 2 is tensor(6.7903, device='cuda:0')
benign distance is  tensor(6.7903, device='cuda:0')
norm1 res is  tensor(0.0753, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8107651714235544
distance 1 is tensor(59.1809, device='cuda:0')
distance 2 is tensor(4.5082, device='cuda:0')
benign distance is  tensor(4.5082, device='cuda:0')
norm1 res is  tensor(0.0789, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  1.086862239986658
distance 1 is tensor(116.1527, device='cuda:0')
distance 2 is tensor(8.8551, device='cuda:0')
benign distance is  tensor(8.8551, device='cuda:0')
norm1 res is  tensor(0.2370, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.213751707226038
distance 1 is tensor(191.8731, device='cuda:0')
distance 2 is tensor(14.0668, device='cuda:0')
benign distance is  tensor(14.0668, device='cuda:0')
norm1 res is  tensor(0.1321, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9864718457683921
distance 1 is tensor(35.5603, device='cuda:0')
distance 2 is tensor(2.9351, device='cuda:0')
benign distance is  tensor(2.9351, device='cuda:0')
norm1 res is  tensor(0.0405, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7301139682531357
distance 1 is tensor(43.3682, device='cuda:0')
distance 2 is tensor(3.2708, device='cuda:0')
benign distance is  tensor(3.2708, device='cuda:0')
norm1 res is  tensor(0.0759, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.111032273620367
distance 1 is tensor(34.6341, device='cuda:0')
distance 2 is tensor(2.8939, device='cuda:0')
benign distance is  tensor(2.8939, device='cuda:0')
norm1 res is  tensor(0.0412, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7363299485296011
distance 1 is tensor(50.5909, device='cuda:0')
distance 2 is tensor(3.8354, device='cuda:0')
benign distance is  tensor(3.8354, device='cuda:0')
norm1 res is  tensor(0.0768, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(395.5285, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(259.3135, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(526.2986, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(839.6462, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(165.8701, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(183.9125, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(156.4790, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(209.7020, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5150.5386, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5215.9619, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5167.4941, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5155.7993, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5168.9448, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5192.8516, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5175.5732, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5167.1470, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5199.1470, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5147.9678, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5168.7310, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5229.2734, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(637.7130, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(768.0062, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(833.6869, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(555.9354, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(960.1619, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(772.6521, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(640.5414, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(802.9432, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(700.8367, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(451.7707, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(695.5975, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(753.3058, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(635.5703, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(622.6921, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(678.1430, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(926.4525, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(619.7200, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(627.9119, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(680.7385, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(680.0892, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(294.8438, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1153.4745, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(800.8750, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(715.6304, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(402.2298, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(724.5039, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(259.2567, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(704.4661, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(1127.4237, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(239.2499, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(944.8372, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
do  not satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(629.6105, device='cuda:0')
norm_2 is  tensor(353.1013, device='cuda:0')
norm_2 * lamda is tensor(635.5824, device='cuda:0')
satisfying 51
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 85.03% 

Test Accuracy: 88.19% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7776301261037588
distance 1 is tensor(76.5912, device='cuda:0')
distance 2 is tensor(5.7951, device='cuda:0')
benign distance is  tensor(5.7951, device='cuda:0')
norm1 res is  tensor(0.0642, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7710166424512863
distance 1 is tensor(45.7945, device='cuda:0')
distance 2 is tensor(3.6025, device='cuda:0')
benign distance is  tensor(3.6025, device='cuda:0')
norm1 res is  tensor(0.0632, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8750474508851767
distance 1 is tensor(93.9556, device='cuda:0')
distance 2 is tensor(7.1216, device='cuda:0')
benign distance is  tensor(7.1216, device='cuda:0')
norm1 res is  tensor(0.1731, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.5327591709792614
distance 1 is tensor(217.9893, device='cuda:0')
distance 2 is tensor(16.0368, device='cuda:0')
benign distance is  tensor(16.0368, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7247497942298651
distance 1 is tensor(31.3332, device='cuda:0')
distance 2 is tensor(2.7389, device='cuda:0')
benign distance is  tensor(2.7389, device='cuda:0')
norm1 res is  tensor(0.0352, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7381439064629376
distance 1 is tensor(47.4089, device='cuda:0')
distance 2 is tensor(3.7647, device='cuda:0')
benign distance is  tensor(3.7647, device='cuda:0')
norm1 res is  tensor(0.0832, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.0584791377186775
distance 1 is tensor(34.5303, device='cuda:0')
distance 2 is tensor(2.8899, device='cuda:0')
benign distance is  tensor(2.8899, device='cuda:0')
norm1 res is  tensor(0.0406, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8181932028383017
distance 1 is tensor(37.7780, device='cuda:0')
distance 2 is tensor(3.0299, device='cuda:0')
benign distance is  tensor(3.0299, device='cuda:0')
norm1 res is  tensor(0.0596, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.3183545768260956
distance 1 is tensor(95.5686, device='cuda:0')
distance 2 is tensor(7.0444, device='cuda:0')
benign distance is  tensor(7.0444, device='cuda:0')
norm1 res is  tensor(0.1057, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9701374787837267
distance 1 is tensor(147.2145, device='cuda:0')
distance 2 is tensor(10.7758, device='cuda:0')
benign distance is  tensor(10.7758, device='cuda:0')
norm1 res is  tensor(0.1750, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9734452906996012
distance 1 is tensor(47.2688, device='cuda:0')
distance 2 is tensor(3.7150, device='cuda:0')
benign distance is  tensor(3.7150, device='cuda:0')
norm1 res is  tensor(0.0640, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.9976488202810287
distance 1 is tensor(124.5662, device='cuda:0')
distance 2 is tensor(9.2716, device='cuda:0')
benign distance is  tensor(9.2716, device='cuda:0')
norm1 res is  tensor(0.1301, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.5443728566169739
distance 1 is tensor(229.2546, device='cuda:0')
distance 2 is tensor(16.4736, device='cuda:0')
benign distance is  tensor(16.4736, device='cuda:0')
norm1 res is  tensor(0.1482, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.8059478607028723
distance 1 is tensor(58.2147, device='cuda:0')
distance 2 is tensor(4.3261, device='cuda:0')
benign distance is  tensor(4.3261, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.2383710779249668
distance 1 is tensor(181.2753, device='cuda:0')
distance 2 is tensor(12.9545, device='cuda:0')
benign distance is  tensor(12.9545, device='cuda:0')
norm1 res is  tensor(0.1733, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.231521189212799
distance 1 is tensor(129.4673, device='cuda:0')
distance 2 is tensor(9.5811, device='cuda:0')
benign distance is  tensor(9.5811, device='cuda:0')
norm1 res is  tensor(0.1243, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.2084072977304459
distance 1 is tensor(96.2544, device='cuda:0')
distance 2 is tensor(7.4048, device='cuda:0')
benign distance is  tensor(7.4048, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.770160973072052
distance 1 is tensor(129.0612, device='cuda:0')
distance 2 is tensor(9.4820, device='cuda:0')
benign distance is  tensor(9.4820, device='cuda:0')
norm1 res is  tensor(0.1618, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.7622740752995014
distance 1 is tensor(183.3208, device='cuda:0')
distance 2 is tensor(13.2940, device='cuda:0')
benign distance is  tensor(13.2940, device='cuda:0')
norm1 res is  tensor(0.1847, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9779440332204103
distance 1 is tensor(153.2574, device='cuda:0')
distance 2 is tensor(11.2689, device='cuda:0')
benign distance is  tensor(11.2689, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9103732276707888
distance 1 is tensor(75.2848, device='cuda:0')
distance 2 is tensor(5.5689, device='cuda:0')
benign distance is  tensor(5.5689, device='cuda:0')
norm1 res is  tensor(0.1001, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.0154614988714457
distance 1 is tensor(256.1137, device='cuda:0')
distance 2 is tensor(18.5499, device='cuda:0')
benign distance is  tensor(18.5499, device='cuda:0')
norm1 res is  tensor(0.1372, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.4454641491174698
distance 1 is tensor(188.3962, device='cuda:0')
distance 2 is tensor(13.9726, device='cuda:0')
benign distance is  tensor(13.9726, device='cuda:0')
norm1 res is  tensor(0.1219, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.550447940826416
distance 1 is tensor(146.1445, device='cuda:0')
distance 2 is tensor(10.7416, device='cuda:0')
benign distance is  tensor(10.7416, device='cuda:0')
norm1 res is  tensor(0.1306, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.311959544196725
distance 1 is tensor(164.8502, device='cuda:0')
distance 2 is tensor(12.1131, device='cuda:0')
benign distance is  tensor(12.1131, device='cuda:0')
norm1 res is  tensor(0.1824, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  1.557578183710575
distance 1 is tensor(311.9811, device='cuda:0')
distance 2 is tensor(25.0238, device='cuda:0')
benign distance is  tensor(25.0238, device='cuda:0')
norm1 res is  tensor(0.9376, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.9256226848810911
distance 1 is tensor(163.2009, device='cuda:0')
distance 2 is tensor(12.0248, device='cuda:0')
benign distance is  tensor(12.0248, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.3046199977397919
distance 1 is tensor(151.2795, device='cuda:0')
distance 2 is tensor(11.5348, device='cuda:0')
benign distance is  tensor(11.5348, device='cuda:0')
norm1 res is  tensor(0.1739, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.761811638250947
distance 1 is tensor(156.1666, device='cuda:0')
distance 2 is tensor(11.4001, device='cuda:0')
benign distance is  tensor(11.4001, device='cuda:0')
norm1 res is  tensor(0.1752, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  1.0045150220394135
distance 1 is tensor(162.4267, device='cuda:0')
distance 2 is tensor(12.1480, device='cuda:0')
benign distance is  tensor(12.1480, device='cuda:0')
norm1 res is  tensor(0.1736, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5572466440498829
distance 1 is tensor(154.0509, device='cuda:0')
distance 2 is tensor(11.1736, device='cuda:0')
benign distance is  tensor(11.1736, device='cuda:0')
norm1 res is  tensor(0.1723, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.8474255669862032
distance 1 is tensor(225.7264, device='cuda:0')
distance 2 is tensor(16.4677, device='cuda:0')
benign distance is  tensor(16.4677, device='cuda:0')
norm1 res is  tensor(0.2012, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.8917071260511875
distance 1 is tensor(160.6222, device='cuda:0')
distance 2 is tensor(12.1269, device='cuda:0')
benign distance is  tensor(12.1269, device='cuda:0')
norm1 res is  tensor(0.1723, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.585448544472456
distance 1 is tensor(185.0691, device='cuda:0')
distance 2 is tensor(13.9824, device='cuda:0')
benign distance is  tensor(13.9824, device='cuda:0')
norm1 res is  tensor(0.1867, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.1494343988597393
distance 1 is tensor(211.4174, device='cuda:0')
distance 2 is tensor(15.6018, device='cuda:0')
benign distance is  tensor(15.6018, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  1.1250388287007809
distance 1 is tensor(134.6760, device='cuda:0')
distance 2 is tensor(10.2292, device='cuda:0')
benign distance is  tensor(10.2292, device='cuda:0')
norm1 res is  tensor(0.3154, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.8668753895908594
distance 1 is tensor(208.4312, device='cuda:0')
distance 2 is tensor(15.1357, device='cuda:0')
benign distance is  tensor(15.1357, device='cuda:0')
norm1 res is  tensor(0.1987, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.8164357133209705
distance 1 is tensor(181.5124, device='cuda:0')
distance 2 is tensor(13.3442, device='cuda:0')
benign distance is  tensor(13.3442, device='cuda:0')
norm1 res is  tensor(0.2241, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8878643084317446
distance 1 is tensor(151.7585, device='cuda:0')
distance 2 is tensor(11.1193, device='cuda:0')
benign distance is  tensor(11.1193, device='cuda:0')
norm1 res is  tensor(0.2072, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.6079076174646616
distance 1 is tensor(168.5943, device='cuda:0')
distance 2 is tensor(12.2813, device='cuda:0')
benign distance is  tensor(12.2813, device='cuda:0')
norm1 res is  tensor(0.1837, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(336.0759, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(205.6495, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(405.6163, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(964.7378, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(146.0160, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(213.1023, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(153.9719, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(161.9707, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5138.1064, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5204.7686, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5151.6846, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5152.7925, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5152.7642, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5177.8779, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5190.3672, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5147.8579, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5173.5435, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5154.2583, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5159.7183, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5211.9038, device='cuda:0')
norm_2 is  tensor(194.6792, device='cuda:0')
norm_2 * lamda is tensor(350.4225, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 87.19% 

Test Accuracy: 88.71% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7294970154762268
distance 1 is tensor(63.6963, device='cuda:0')
distance 2 is tensor(4.9084, device='cuda:0')
benign distance is  tensor(4.9084, device='cuda:0')
norm1 res is  tensor(0.0579, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8071097694337368
distance 1 is tensor(62.5442, device='cuda:0')
distance 2 is tensor(4.8366, device='cuda:0')
benign distance is  tensor(4.8366, device='cuda:0')
norm1 res is  tensor(0.0860, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7998266322538257
distance 1 is tensor(74.8337, device='cuda:0')
distance 2 is tensor(5.6732, device='cuda:0')
benign distance is  tensor(5.6732, device='cuda:0')
norm1 res is  tensor(0.1481, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.8022522777318954
distance 1 is tensor(203.9880, device='cuda:0')
distance 2 is tensor(14.8648, device='cuda:0')
benign distance is  tensor(14.8648, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8279223525896668
distance 1 is tensor(72.5921, device='cuda:0')
distance 2 is tensor(5.4809, device='cuda:0')
benign distance is  tensor(5.4809, device='cuda:0')
norm1 res is  tensor(0.0763, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6535929925739765
distance 1 is tensor(65.2503, device='cuda:0')
distance 2 is tensor(4.8034, device='cuda:0')
benign distance is  tensor(4.8034, device='cuda:0')
norm1 res is  tensor(0.1049, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2606172282248735
distance 1 is tensor(38.4638, device='cuda:0')
distance 2 is tensor(3.1864, device='cuda:0')
benign distance is  tensor(3.1864, device='cuda:0')
norm1 res is  tensor(0.0467, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8101651445031166
distance 1 is tensor(32.7091, device='cuda:0')
distance 2 is tensor(2.6739, device='cuda:0')
benign distance is  tensor(2.6739, device='cuda:0')
norm1 res is  tensor(0.0533, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(287.4673, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(282.7220, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(335.3372, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(903.3622, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(316.4393, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(268.8356, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(177.3814, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(145.8979, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5152.8706, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5217.3535, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5167.2910, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5187.6631, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5176.4561, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5200.5767, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5188.6763, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5172.1353, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5183.5635, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5186.2080, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5170.2783, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5227.2900, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(747.3737, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(598.4263, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(856.7728, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(800.2817, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(614.5954, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(516.2993, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(572.5099, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(718.8826, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(417.3913, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(650.8540, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(216.5733, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(554.5114, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(999.3951, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(252.8776, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(780.8522, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(568.4286, device='cuda:0')
norm_2 is  tensor(285.8284, device='cuda:0')
norm_2 * lamda is tensor(514.4911, device='cuda:0')
do  not satisfying 35
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 86.08% 

Test Accuracy: 88.51% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 86.08%
|----0th round Training Accuracy : 84.47%
|----1th round Training Accuracy : 83.89%
|----2th round Training Accuracy : 82.98%
|----3th round Training Accuracy : 81.76%
|----4th round Training Accuracy : 86.59%
|----5th round Training Accuracy : 83.74%
|----6th round Training Accuracy : 85.34%
|----7th round Training Accuracy : 81.52%
|----8th round Training Accuracy : 81.57%
|----9th round Training Accuracy : 84.17%
|----10th round Training Accuracy : 87.09%
|----11th round Training Accuracy : 85.55%
|----12th round Training Accuracy : 83.96%
|----13th round Training Accuracy : 81.56%
|----14th round Training Accuracy : 83.39%
|----15th round Training Accuracy : 83.92%
|----16th round Training Accuracy : 85.92%
|----17th round Training Accuracy : 84.07%
|----18th round Training Accuracy : 86.55%
|----19th round Training Accuracy : 86.27%
|----20th round Training Accuracy : 86.71%
|----21th round Training Accuracy : 84.98%
|----22th round Training Accuracy : 87.35%
|----23th round Training Accuracy : 84.61%
|----24th round Training Accuracy : 86.71%
|----25th round Training Accuracy : 86.33%
|----26th round Training Accuracy : 86.40%
|----27th round Training Accuracy : 86.14%
|----28th round Training Accuracy : 85.16%
|----29th round Training Accuracy : 85.41%
|----30th round Training Accuracy : 86.35%
|----31th round Training Accuracy : 86.05%
|----32th round Training Accuracy : 87.42%
|----33th round Training Accuracy : 85.09%
|----34th round Training Accuracy : 86.18%
|----35th round Training Accuracy : 85.85%
|----36th round Training Accuracy : 87.95%
|----37th round Training Accuracy : 87.08%
|----38th round Training Accuracy : 87.97%
|----39th round Training Accuracy : 87.66%
|----40th round Training Accuracy : 88.97%
|----41th round Training Accuracy : 85.15%
|----42th round Training Accuracy : 87.31%
|----43th round Training Accuracy : 86.57%
|----44th round Training Accuracy : 86.51%
|----45th round Training Accuracy : 86.21%
|----46th round Training Accuracy : 85.02%
|----47th round Training Accuracy : 85.03%
|----48th round Training Accuracy : 87.19%
|----49th round Training Accuracy : 86.08%
|----Final Test Accuracy: 88.51%
|----0th round Final Test Accuracy : 87.97%
|----1th round Final Test Accuracy : 87.79%
|----2th round Final Test Accuracy : 87.75%
|----3th round Final Test Accuracy : 87.25%
|----4th round Final Test Accuracy : 88.45%
|----5th round Final Test Accuracy : 87.89%
|----6th round Final Test Accuracy : 88.20%
|----7th round Final Test Accuracy : 87.24%
|----8th round Final Test Accuracy : 87.18%
|----9th round Final Test Accuracy : 87.98%
|----10th round Final Test Accuracy : 88.54%
|----11th round Final Test Accuracy : 88.15%
|----12th round Final Test Accuracy : 87.57%
|----13th round Final Test Accuracy : 87.27%
|----14th round Final Test Accuracy : 87.83%
|----15th round Final Test Accuracy : 88.06%
|----16th round Final Test Accuracy : 88.07%
|----17th round Final Test Accuracy : 87.90%
|----18th round Final Test Accuracy : 88.45%
|----19th round Final Test Accuracy : 88.43%
|----20th round Final Test Accuracy : 88.30%
|----21th round Final Test Accuracy : 88.05%
|----22th round Final Test Accuracy : 88.67%
|----23th round Final Test Accuracy : 88.00%
|----24th round Final Test Accuracy : 88.52%
|----25th round Final Test Accuracy : 88.44%
|----26th round Final Test Accuracy : 88.31%
|----27th round Final Test Accuracy : 88.37%
|----28th round Final Test Accuracy : 87.99%
|----29th round Final Test Accuracy : 88.10%
|----30th round Final Test Accuracy : 88.44%
|----31th round Final Test Accuracy : 88.21%
|----32th round Final Test Accuracy : 88.60%
|----33th round Final Test Accuracy : 88.02%
|----34th round Final Test Accuracy : 88.14%
|----35th round Final Test Accuracy : 88.40%
|----36th round Final Test Accuracy : 88.80%
|----37th round Final Test Accuracy : 88.52%
|----38th round Final Test Accuracy : 88.56%
|----39th round Final Test Accuracy : 88.59%
|----40th round Final Test Accuracy : 89.02%
|----41th round Final Test Accuracy : 87.91%
|----42th round Final Test Accuracy : 88.64%
|----43th round Final Test Accuracy : 88.01%
|----44th round Final Test Accuracy : 88.32%
|----45th round Final Test Accuracy : 88.39%
|----46th round Final Test Accuracy : 88.06%
|----47th round Final Test Accuracy : 88.19%
|----48th round Final Test Accuracy : 88.71%
|----49th round Final Test Accuracy : 88.51%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!


 Total Run Time: 4175.7190
