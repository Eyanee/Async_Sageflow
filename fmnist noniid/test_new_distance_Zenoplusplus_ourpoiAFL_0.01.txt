
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5606276988983154
distance 1 is tensor(115.8332, device='cuda:0')
distance 2 is tensor(8.7479, device='cuda:0')
benign distance is  tensor(8.7479, device='cuda:0')
norm1 res is  tensor(0.1328, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5723451375961304
distance 1 is tensor(124.0036, device='cuda:0')
distance 2 is tensor(9.3455, device='cuda:0')
benign distance is  tensor(9.3455, device='cuda:0')
norm1 res is  tensor(0.1450, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.3762238025665283
distance 1 is tensor(125.4333, device='cuda:0')
distance 2 is tensor(9.4774, device='cuda:0')
benign distance is  tensor(9.4774, device='cuda:0')
norm1 res is  tensor(0.1416, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.4845369756221771
distance 1 is tensor(111.4840, device='cuda:0')
distance 2 is tensor(8.4006, device='cuda:0')
benign distance is  tensor(8.4006, device='cuda:0')
norm1 res is  tensor(0.1289, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8554657697677612
distance 1 is tensor(108.1995, device='cuda:0')
distance 2 is tensor(8.1808, device='cuda:0')
benign distance is  tensor(8.1808, device='cuda:0')
norm1 res is  tensor(0.1244, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.3851529657840729
distance 1 is tensor(121.7443, device='cuda:0')
distance 2 is tensor(9.2577, device='cuda:0')
benign distance is  tensor(9.2577, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.9106144905090332
distance 1 is tensor(109.0338, device='cuda:0')
distance 2 is tensor(8.2595, device='cuda:0')
benign distance is  tensor(8.2595, device='cuda:0')
norm1 res is  tensor(0.1243, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2503494322299957
distance 1 is tensor(126.4644, device='cuda:0')
distance 2 is tensor(9.6759, device='cuda:0')
benign distance is  tensor(9.6759, device='cuda:0')
norm1 res is  tensor(0.1487, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.14228230714797974
distance 1 is tensor(140.2340, device='cuda:0')
distance 2 is tensor(10.5752, device='cuda:0')
benign distance is  tensor(10.5752, device='cuda:0')
norm1 res is  tensor(0.1609, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.4544864296913147
distance 1 is tensor(132.8028, device='cuda:0')
distance 2 is tensor(10.0815, device='cuda:0')
benign distance is  tensor(10.0815, device='cuda:0')
norm1 res is  tensor(0.1517, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.40071195363998413
distance 1 is tensor(129.9233, device='cuda:0')
distance 2 is tensor(9.7905, device='cuda:0')
benign distance is  tensor(9.7905, device='cuda:0')
norm1 res is  tensor(0.1496, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.2807456851005554
distance 1 is tensor(126.7966, device='cuda:0')
distance 2 is tensor(9.6408, device='cuda:0')
benign distance is  tensor(9.6408, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.44996127486228943
distance 1 is tensor(134.2193, device='cuda:0')
distance 2 is tensor(10.2107, device='cuda:0')
benign distance is  tensor(10.2107, device='cuda:0')
norm1 res is  tensor(0.1536, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.28258565068244934
distance 1 is tensor(141.3703, device='cuda:0')
distance 2 is tensor(10.9347, device='cuda:0')
benign distance is  tensor(10.9347, device='cuda:0')
norm1 res is  tensor(0.1636, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.9414429664611816
distance 1 is tensor(132.8186, device='cuda:0')
distance 2 is tensor(10.1068, device='cuda:0')
benign distance is  tensor(10.1068, device='cuda:0')
norm1 res is  tensor(0.1520, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.5929247140884399
distance 1 is tensor(134.1007, device='cuda:0')
distance 2 is tensor(10.1687, device='cuda:0')
benign distance is  tensor(10.1687, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.2804473340511322
distance 1 is tensor(125.8376, device='cuda:0')
distance 2 is tensor(9.5213, device='cuda:0')
benign distance is  tensor(9.5213, device='cuda:0')
norm1 res is  tensor(0.1439, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.3390118181705475
distance 1 is tensor(149.5398, device='cuda:0')
distance 2 is tensor(11.4836, device='cuda:0')
benign distance is  tensor(11.4836, device='cuda:0')
norm1 res is  tensor(0.1749, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.0803012102842331
distance 1 is tensor(126.5896, device='cuda:0')
distance 2 is tensor(9.7153, device='cuda:0')
benign distance is  tensor(9.7153, device='cuda:0')
norm1 res is  tensor(0.1475, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.4912204146385193
distance 1 is tensor(128.3127, device='cuda:0')
distance 2 is tensor(9.8374, device='cuda:0')
benign distance is  tensor(9.8374, device='cuda:0')
norm1 res is  tensor(0.1519, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.12359883636236191
distance 1 is tensor(126.6300, device='cuda:0')
distance 2 is tensor(9.7330, device='cuda:0')
benign distance is  tensor(9.7330, device='cuda:0')
norm1 res is  tensor(0.1464, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.17189255356788635
distance 1 is tensor(121.5494, device='cuda:0')
distance 2 is tensor(9.2635, device='cuda:0')
benign distance is  tensor(9.2635, device='cuda:0')
norm1 res is  tensor(0.1404, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.36550697684288025
distance 1 is tensor(140.2838, device='cuda:0')
distance 2 is tensor(10.8275, device='cuda:0')
benign distance is  tensor(10.8275, device='cuda:0')
norm1 res is  tensor(0.1608, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.0647659301757812
distance 1 is tensor(131.7938, device='cuda:0')
distance 2 is tensor(9.7800, device='cuda:0')
benign distance is  tensor(9.7800, device='cuda:0')
norm1 res is  tensor(0.1484, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.8202705383300781
distance 1 is tensor(145.0125, device='cuda:0')
distance 2 is tensor(11.1963, device='cuda:0')
benign distance is  tensor(11.1963, device='cuda:0')
norm1 res is  tensor(0.1669, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6675412654876709
distance 1 is tensor(129.1274, device='cuda:0')
distance 2 is tensor(9.7495, device='cuda:0')
benign distance is  tensor(9.7495, device='cuda:0')
norm1 res is  tensor(0.1446, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.4942720830440521
distance 1 is tensor(141.8687, device='cuda:0')
distance 2 is tensor(10.8507, device='cuda:0')
benign distance is  tensor(10.8507, device='cuda:0')
norm1 res is  tensor(0.1647, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.38347047567367554
distance 1 is tensor(139.0664, device='cuda:0')
distance 2 is tensor(10.3997, device='cuda:0')
benign distance is  tensor(10.3997, device='cuda:0')
norm1 res is  tensor(0.1538, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.6125791072845459
distance 1 is tensor(128.8217, device='cuda:0')
distance 2 is tensor(9.7986, device='cuda:0')
benign distance is  tensor(9.7986, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8078409433364868
distance 1 is tensor(136.6689, device='cuda:0')
distance 2 is tensor(10.3450, device='cuda:0')
benign distance is  tensor(10.3450, device='cuda:0')
norm1 res is  tensor(0.1615, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.2991465628147125
distance 1 is tensor(123.2240, device='cuda:0')
distance 2 is tensor(9.4887, device='cuda:0')
benign distance is  tensor(9.4887, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.9843292236328125
distance 1 is tensor(134.6453, device='cuda:0')
distance 2 is tensor(10.3964, device='cuda:0')
benign distance is  tensor(10.3964, device='cuda:0')
norm1 res is  tensor(0.1604, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.5166913866996765
distance 1 is tensor(137.5936, device='cuda:0')
distance 2 is tensor(10.4410, device='cuda:0')
benign distance is  tensor(10.4410, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.13547919690608978
distance 1 is tensor(128.8512, device='cuda:0')
distance 2 is tensor(9.8079, device='cuda:0')
benign distance is  tensor(9.8079, device='cuda:0')
norm1 res is  tensor(0.1488, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.21891900897026062
distance 1 is tensor(136.0907, device='cuda:0')
distance 2 is tensor(10.4200, device='cuda:0')
benign distance is  tensor(10.4200, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.0493779256939888
distance 1 is tensor(128.3628, device='cuda:0')
distance 2 is tensor(9.6283, device='cuda:0')
benign distance is  tensor(9.6283, device='cuda:0')
norm1 res is  tensor(0.1459, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.6119948625564575
distance 1 is tensor(133.7582, device='cuda:0')
distance 2 is tensor(10.2698, device='cuda:0')
benign distance is  tensor(10.2698, device='cuda:0')
norm1 res is  tensor(0.1551, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.3737185001373291
distance 1 is tensor(125.6662, device='cuda:0')
distance 2 is tensor(9.4544, device='cuda:0')
benign distance is  tensor(9.4544, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.2821584939956665
distance 1 is tensor(122.7671, device='cuda:0')
distance 2 is tensor(9.3451, device='cuda:0')
benign distance is  tensor(9.3451, device='cuda:0')
norm1 res is  tensor(0.1430, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.24959436058998108
distance 1 is tensor(123.6179, device='cuda:0')
distance 2 is tensor(9.3527, device='cuda:0')
benign distance is  tensor(9.3527, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.1700238138437271
distance 1 is tensor(121.6769, device='cuda:0')
distance 2 is tensor(9.5542, device='cuda:0')
benign distance is  tensor(9.5542, device='cuda:0')
norm1 res is  tensor(0.1416, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.34585505723953247
distance 1 is tensor(121.8275, device='cuda:0')
distance 2 is tensor(9.1697, device='cuda:0')
benign distance is  tensor(9.1697, device='cuda:0')
norm1 res is  tensor(0.1399, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.10059809684753418
distance 1 is tensor(127.9136, device='cuda:0')
distance 2 is tensor(9.6742, device='cuda:0')
benign distance is  tensor(9.6742, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.2645145058631897
distance 1 is tensor(140.2634, device='cuda:0')
distance 2 is tensor(10.5702, device='cuda:0')
benign distance is  tensor(10.5702, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.34901005029678345
distance 1 is tensor(138.5046, device='cuda:0')
distance 2 is tensor(10.3459, device='cuda:0')
benign distance is  tensor(10.3459, device='cuda:0')
norm1 res is  tensor(0.1599, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.7087798118591309
distance 1 is tensor(130.3553, device='cuda:0')
distance 2 is tensor(9.7735, device='cuda:0')
benign distance is  tensor(9.7735, device='cuda:0')
norm1 res is  tensor(0.1471, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.687595009803772
distance 1 is tensor(136.2336, device='cuda:0')
distance 2 is tensor(10.1873, device='cuda:0')
benign distance is  tensor(10.1873, device='cuda:0')
norm1 res is  tensor(0.1551, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.17862114310264587
distance 1 is tensor(133.0967, device='cuda:0')
distance 2 is tensor(9.8857, device='cuda:0')
benign distance is  tensor(9.8857, device='cuda:0')
norm1 res is  tensor(0.1528, device='cuda:0')
current submit client idx and staleness is  48 1
 benign loss is  0.1697586625814438
distance 1 is tensor(116.0170, device='cuda:0')
distance 2 is tensor(8.8374, device='cuda:0')
benign distance is  tensor(8.8374, device='cuda:0')
norm1 res is  tensor(0.1360, device='cuda:0')
current submit client idx and staleness is  49 1
 benign loss is  0.44306260347366333
distance 1 is tensor(110.4118, device='cuda:0')
distance 2 is tensor(8.3811, device='cuda:0')
benign distance is  tensor(8.3811, device='cuda:0')
norm1 res is  tensor(0.1302, device='cuda:0')
current submit client idx and staleness is  50 1
 benign loss is  0.9452853202819824
distance 1 is tensor(123.4496, device='cuda:0')
distance 2 is tensor(9.3060, device='cuda:0')
benign distance is  tensor(9.3060, device='cuda:0')
norm1 res is  tensor(0.1444, device='cuda:0')
current submit client idx and staleness is  51 1
 benign loss is  0.3762369751930237
distance 1 is tensor(116.9062, device='cuda:0')
distance 2 is tensor(8.8775, device='cuda:0')
benign distance is  tensor(8.8775, device='cuda:0')
norm1 res is  tensor(0.1361, device='cuda:0')
current submit client idx and staleness is  52 1
 benign loss is  0.6410956382751465
distance 1 is tensor(116.6078, device='cuda:0')
distance 2 is tensor(8.8677, device='cuda:0')
benign distance is  tensor(8.8677, device='cuda:0')
norm1 res is  tensor(0.1354, device='cuda:0')
current submit client idx and staleness is  53 1
 benign loss is  0.5623423457145691
distance 1 is tensor(122.5054, device='cuda:0')
distance 2 is tensor(9.2076, device='cuda:0')
benign distance is  tensor(9.2076, device='cuda:0')
norm1 res is  tensor(0.1406, device='cuda:0')
current submit client idx and staleness is  54 1
 benign loss is  0.15602239966392517
distance 1 is tensor(124.3030, device='cuda:0')
distance 2 is tensor(9.5222, device='cuda:0')
benign distance is  tensor(9.5222, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  55 1
 benign loss is  0.4270913600921631
distance 1 is tensor(125.1441, device='cuda:0')
distance 2 is tensor(9.4452, device='cuda:0')
benign distance is  tensor(9.4452, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  56 1
 benign loss is  0.5273751616477966
distance 1 is tensor(124.2105, device='cuda:0')
distance 2 is tensor(9.4088, device='cuda:0')
benign distance is  tensor(9.4088, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  57 1
 benign loss is  0.4333685040473938
distance 1 is tensor(113.7483, device='cuda:0')
distance 2 is tensor(8.6127, device='cuda:0')
benign distance is  tensor(8.6127, device='cuda:0')
norm1 res is  tensor(0.1303, device='cuda:0')
current submit client idx and staleness is  58 1
 benign loss is  0.22650077939033508
distance 1 is tensor(119.1946, device='cuda:0')
distance 2 is tensor(8.9771, device='cuda:0')
benign distance is  tensor(8.9771, device='cuda:0')
norm1 res is  tensor(0.1368, device='cuda:0')
current submit client idx and staleness is  59 1
 benign loss is  0.30056092143058777
distance 1 is tensor(128.4431, device='cuda:0')
distance 2 is tensor(9.5244, device='cuda:0')
benign distance is  tensor(9.5244, device='cuda:0')
norm1 res is  tensor(0.1457, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.10412035137414932
distance 1 is tensor(131.9392, device='cuda:0')
distance 2 is tensor(10.3281, device='cuda:0')
benign distance is  tensor(10.3281, device='cuda:0')
norm1 res is  tensor(0.1571, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.10344962775707245
distance 1 is tensor(126.7800, device='cuda:0')
distance 2 is tensor(10.1737, device='cuda:0')
benign distance is  tensor(10.1737, device='cuda:0')
norm1 res is  tensor(0.1540, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.3121265769004822
distance 1 is tensor(135.8346, device='cuda:0')
distance 2 is tensor(10.6977, device='cuda:0')
benign distance is  tensor(10.6977, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.8219243288040161
distance 1 is tensor(136.1165, device='cuda:0')
distance 2 is tensor(10.7527, device='cuda:0')
benign distance is  tensor(10.7527, device='cuda:0')
norm1 res is  tensor(0.1606, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.4022191762924194
distance 1 is tensor(113.5741, device='cuda:0')
distance 2 is tensor(9.1006, device='cuda:0')
benign distance is  tensor(9.1006, device='cuda:0')
norm1 res is  tensor(0.1330, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6829007863998413
distance 1 is tensor(126.8772, device='cuda:0')
distance 2 is tensor(10.2797, device='cuda:0')
benign distance is  tensor(10.2797, device='cuda:0')
norm1 res is  tensor(0.1567, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.5339356660842896
distance 1 is tensor(132.6224, device='cuda:0')
distance 2 is tensor(10.4691, device='cuda:0')
benign distance is  tensor(10.4691, device='cuda:0')
norm1 res is  tensor(0.1570, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8098943829536438
distance 1 is tensor(134.1871, device='cuda:0')
distance 2 is tensor(10.7619, device='cuda:0')
benign distance is  tensor(10.7619, device='cuda:0')
norm1 res is  tensor(0.1596, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.7234749794006348
distance 1 is tensor(144.0427, device='cuda:0')
distance 2 is tensor(11.1652, device='cuda:0')
benign distance is  tensor(11.1652, device='cuda:0')
norm1 res is  tensor(0.1691, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.3474586009979248
distance 1 is tensor(141.2927, device='cuda:0')
distance 2 is tensor(10.9899, device='cuda:0')
benign distance is  tensor(10.9899, device='cuda:0')
norm1 res is  tensor(0.1635, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6445833444595337
distance 1 is tensor(128.8743, device='cuda:0')
distance 2 is tensor(10.1989, device='cuda:0')
benign distance is  tensor(10.1989, device='cuda:0')
norm1 res is  tensor(0.1527, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.780981719493866
distance 1 is tensor(136.4246, device='cuda:0')
distance 2 is tensor(10.8764, device='cuda:0')
benign distance is  tensor(10.8764, device='cuda:0')
norm1 res is  tensor(0.1606, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.6418257355690002
distance 1 is tensor(124.2893, device='cuda:0')
distance 2 is tensor(9.9860, device='cuda:0')
benign distance is  tensor(9.9860, device='cuda:0')
norm1 res is  tensor(0.1517, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.4447699189186096
distance 1 is tensor(140.8977, device='cuda:0')
distance 2 is tensor(11.1538, device='cuda:0')
benign distance is  tensor(11.1538, device='cuda:0')
norm1 res is  tensor(0.1685, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.5112264752388
distance 1 is tensor(127.7691, device='cuda:0')
distance 2 is tensor(10.1460, device='cuda:0')
benign distance is  tensor(10.1460, device='cuda:0')
norm1 res is  tensor(0.1517, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.42682570219039917
distance 1 is tensor(141.5322, device='cuda:0')
distance 2 is tensor(11.1757, device='cuda:0')
benign distance is  tensor(11.1757, device='cuda:0')
norm1 res is  tensor(0.1669, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.018028754740953445
distance 1 is tensor(132.7565, device='cuda:0')
distance 2 is tensor(10.4086, device='cuda:0')
benign distance is  tensor(10.4086, device='cuda:0')
norm1 res is  tensor(0.1547, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  1.2013342380523682
distance 1 is tensor(144.5142, device='cuda:0')
distance 2 is tensor(11.5046, device='cuda:0')
benign distance is  tensor(11.5046, device='cuda:0')
norm1 res is  tensor(0.1708, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.48345842957496643
distance 1 is tensor(137.0484, device='cuda:0')
distance 2 is tensor(10.9158, device='cuda:0')
benign distance is  tensor(10.9158, device='cuda:0')
norm1 res is  tensor(0.1661, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.3078300654888153
distance 1 is tensor(135.2106, device='cuda:0')
distance 2 is tensor(10.5313, device='cuda:0')
benign distance is  tensor(10.5313, device='cuda:0')
norm1 res is  tensor(0.1581, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.30299967527389526
distance 1 is tensor(134.3434, device='cuda:0')
distance 2 is tensor(10.5769, device='cuda:0')
benign distance is  tensor(10.5769, device='cuda:0')
norm1 res is  tensor(0.1582, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.0515049695968628
distance 1 is tensor(133.0594, device='cuda:0')
distance 2 is tensor(10.4483, device='cuda:0')
benign distance is  tensor(10.4483, device='cuda:0')
norm1 res is  tensor(0.1540, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.12121226638555527
distance 1 is tensor(146.4423, device='cuda:0')
distance 2 is tensor(11.5034, device='cuda:0')
benign distance is  tensor(11.5034, device='cuda:0')
norm1 res is  tensor(0.1729, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.0870683193206787
distance 1 is tensor(131.4776, device='cuda:0')
distance 2 is tensor(10.3376, device='cuda:0')
benign distance is  tensor(10.3376, device='cuda:0')
norm1 res is  tensor(0.1558, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.2351912260055542
distance 1 is tensor(137.9847, device='cuda:0')
distance 2 is tensor(10.8071, device='cuda:0')
benign distance is  tensor(10.8071, device='cuda:0')
norm1 res is  tensor(0.1624, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.8131622076034546
distance 1 is tensor(138.2616, device='cuda:0')
distance 2 is tensor(10.8629, device='cuda:0')
benign distance is  tensor(10.8629, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.46055546402931213
distance 1 is tensor(148.6627, device='cuda:0')
distance 2 is tensor(11.8210, device='cuda:0')
benign distance is  tensor(11.8210, device='cuda:0')
norm1 res is  tensor(0.1753, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.41031795740127563
distance 1 is tensor(134.7271, device='cuda:0')
distance 2 is tensor(10.6575, device='cuda:0')
benign distance is  tensor(10.6575, device='cuda:0')
norm1 res is  tensor(0.1587, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.6599739789962769
distance 1 is tensor(133.5752, device='cuda:0')
distance 2 is tensor(10.4971, device='cuda:0')
benign distance is  tensor(10.4971, device='cuda:0')
norm1 res is  tensor(0.1562, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  1.512196660041809
distance 1 is tensor(137.6833, device='cuda:0')
distance 2 is tensor(10.7665, device='cuda:0')
benign distance is  tensor(10.7665, device='cuda:0')
norm1 res is  tensor(0.1617, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.1507033407688141
distance 1 is tensor(134.5722, device='cuda:0')
distance 2 is tensor(10.6921, device='cuda:0')
benign distance is  tensor(10.6921, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  1.1524008512496948
distance 1 is tensor(134.6668, device='cuda:0')
distance 2 is tensor(10.7730, device='cuda:0')
benign distance is  tensor(10.7730, device='cuda:0')
norm1 res is  tensor(0.1611, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.22137776017189026
distance 1 is tensor(140.9957, device='cuda:0')
distance 2 is tensor(11.2352, device='cuda:0')
benign distance is  tensor(11.2352, device='cuda:0')
norm1 res is  tensor(0.1656, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.09853655844926834
distance 1 is tensor(139.5694, device='cuda:0')
distance 2 is tensor(11.0049, device='cuda:0')
benign distance is  tensor(11.0049, device='cuda:0')
norm1 res is  tensor(0.1663, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.4055604040622711
distance 1 is tensor(143.9927, device='cuda:0')
distance 2 is tensor(11.4084, device='cuda:0')
benign distance is  tensor(11.4084, device='cuda:0')
norm1 res is  tensor(0.1712, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.5812212228775024
distance 1 is tensor(135.9290, device='cuda:0')
distance 2 is tensor(10.7800, device='cuda:0')
benign distance is  tensor(10.7800, device='cuda:0')
norm1 res is  tensor(0.1590, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.7792130708694458
distance 1 is tensor(141.0237, device='cuda:0')
distance 2 is tensor(11.1919, device='cuda:0')
benign distance is  tensor(11.1919, device='cuda:0')
norm1 res is  tensor(0.1654, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.49284425377845764
distance 1 is tensor(133.2366, device='cuda:0')
distance 2 is tensor(10.4127, device='cuda:0')
benign distance is  tensor(10.4127, device='cuda:0')
norm1 res is  tensor(0.1565, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.3524012565612793
distance 1 is tensor(135.8933, device='cuda:0')
distance 2 is tensor(10.8410, device='cuda:0')
benign distance is  tensor(10.8410, device='cuda:0')
norm1 res is  tensor(0.1624, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.26978951692581177
distance 1 is tensor(137.9590, device='cuda:0')
distance 2 is tensor(10.8254, device='cuda:0')
benign distance is  tensor(10.8254, device='cuda:0')
norm1 res is  tensor(0.1631, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.054953545331954956
distance 1 is tensor(134.1274, device='cuda:0')
distance 2 is tensor(10.7578, device='cuda:0')
benign distance is  tensor(10.7578, device='cuda:0')
norm1 res is  tensor(0.1605, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.3244916796684265
distance 1 is tensor(135.7392, device='cuda:0')
distance 2 is tensor(10.7615, device='cuda:0')
benign distance is  tensor(10.7615, device='cuda:0')
norm1 res is  tensor(0.1598, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.1329275220632553
distance 1 is tensor(132.6735, device='cuda:0')
distance 2 is tensor(10.5777, device='cuda:0')
benign distance is  tensor(10.5777, device='cuda:0')
norm1 res is  tensor(0.1548, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.5864517092704773
distance 1 is tensor(133.3157, device='cuda:0')
distance 2 is tensor(10.5178, device='cuda:0')
benign distance is  tensor(10.5178, device='cuda:0')
norm1 res is  tensor(0.1581, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.3225802779197693
distance 1 is tensor(134.1992, device='cuda:0')
distance 2 is tensor(10.5943, device='cuda:0')
benign distance is  tensor(10.5943, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.9756331443786621
distance 1 is tensor(152.8993, device='cuda:0')
distance 2 is tensor(11.8907, device='cuda:0')
benign distance is  tensor(11.8907, device='cuda:0')
norm1 res is  tensor(0.1769, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.5666112899780273
distance 1 is tensor(143.7120, device='cuda:0')
distance 2 is tensor(11.1705, device='cuda:0')
benign distance is  tensor(11.1705, device='cuda:0')
norm1 res is  tensor(0.1675, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.42382121086120605
distance 1 is tensor(129.7646, device='cuda:0')
distance 2 is tensor(10.2583, device='cuda:0')
benign distance is  tensor(10.2583, device='cuda:0')
norm1 res is  tensor(0.1566, device='cuda:0')
current submit client idx and staleness is  48 1
 benign loss is  0.31829169392585754
distance 1 is tensor(136.2596, device='cuda:0')
distance 2 is tensor(10.6865, device='cuda:0')
benign distance is  tensor(10.6865, device='cuda:0')
norm1 res is  tensor(0.1639, device='cuda:0')
current submit client idx and staleness is  49 1
 benign loss is  1.1687843799591064
distance 1 is tensor(121.1417, device='cuda:0')
distance 2 is tensor(9.6786, device='cuda:0')
benign distance is  tensor(9.6786, device='cuda:0')
norm1 res is  tensor(0.1451, device='cuda:0')
current submit client idx and staleness is  50 1
 benign loss is  0.07436021417379379
distance 1 is tensor(137.4377, device='cuda:0')
distance 2 is tensor(10.9646, device='cuda:0')
benign distance is  tensor(10.9646, device='cuda:0')
norm1 res is  tensor(0.1650, device='cuda:0')
current submit client idx and staleness is  51 1
 benign loss is  0.8341514468193054
distance 1 is tensor(131.3128, device='cuda:0')
distance 2 is tensor(10.3188, device='cuda:0')
benign distance is  tensor(10.3188, device='cuda:0')
norm1 res is  tensor(0.1557, device='cuda:0')
current submit client idx and staleness is  52 1
 benign loss is  0.12843184173107147
distance 1 is tensor(133.2505, device='cuda:0')
distance 2 is tensor(10.5285, device='cuda:0')
benign distance is  tensor(10.5285, device='cuda:0')
norm1 res is  tensor(0.1559, device='cuda:0')
current submit client idx and staleness is  53 1
 benign loss is  0.7211337089538574
distance 1 is tensor(144.7444, device='cuda:0')
distance 2 is tensor(11.4620, device='cuda:0')
benign distance is  tensor(11.4620, device='cuda:0')
norm1 res is  tensor(0.1694, device='cuda:0')
current submit client idx and staleness is  54 1
 benign loss is  0.47314557433128357
distance 1 is tensor(143.3044, device='cuda:0')
distance 2 is tensor(11.3549, device='cuda:0')
benign distance is  tensor(11.3549, device='cuda:0')
norm1 res is  tensor(0.1705, device='cuda:0')
current submit client idx and staleness is  55 1
 benign loss is  0.32447272539138794
distance 1 is tensor(144.1423, device='cuda:0')
distance 2 is tensor(11.2247, device='cuda:0')
benign distance is  tensor(11.2247, device='cuda:0')
norm1 res is  tensor(0.1697, device='cuda:0')
current submit client idx and staleness is  56 1
 benign loss is  0.24249529838562012
distance 1 is tensor(127.8725, device='cuda:0')
distance 2 is tensor(10.0290, device='cuda:0')
benign distance is  tensor(10.0290, device='cuda:0')
norm1 res is  tensor(0.1527, device='cuda:0')
current submit client idx and staleness is  57 1
 benign loss is  0.8165733218193054
distance 1 is tensor(132.3721, device='cuda:0')
distance 2 is tensor(10.3020, device='cuda:0')
benign distance is  tensor(10.3020, device='cuda:0')
norm1 res is  tensor(0.1539, device='cuda:0')
current submit client idx and staleness is  58 1
 benign loss is  0.4398880898952484
distance 1 is tensor(140.2393, device='cuda:0')
distance 2 is tensor(10.9901, device='cuda:0')
benign distance is  tensor(10.9901, device='cuda:0')
norm1 res is  tensor(0.1644, device='cuda:0')
current submit client idx and staleness is  59 1
 benign loss is  0.217077374458313
distance 1 is tensor(133.7366, device='cuda:0')
distance 2 is tensor(10.6473, device='cuda:0')
benign distance is  tensor(10.6473, device='cuda:0')
norm1 res is  tensor(0.1607, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.5973, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.8578, device='cuda:0')
c is  tensor(0.0310, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0098, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.0953, device='cuda:0')
c is  tensor(0.0313, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0104, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.1655, device='cuda:0')
c is  tensor(0.0308, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0143, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.7336, device='cuda:0')
c is  tensor(0.0308, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0119, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.7017, device='cuda:0')
c is  tensor(0.0336, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0114, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.2238, device='cuda:0')
c is  tensor(0.0311, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0099, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.3593, device='cuda:0')
c is  tensor(0.0311, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0105, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.0325, device='cuda:0')
c is  tensor(0.0308, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0115, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.0925, device='cuda:0')
c is  tensor(0.0305, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0150, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.4893, device='cuda:0')
c is  tensor(0.0324, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0073, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.4752, device='cuda:0')
c is  tensor(0.0303, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0129, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.5212, device='cuda:0')
c is  tensor(0.0311, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0094, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.5417, device='cuda:0')
c is  tensor(0.0310, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0111, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.4044, device='cuda:0')
c is  tensor(0.0299, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0140, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.0853, device='cuda:0')
c is  tensor(0.0297, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0141, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.3051, device='cuda:0')
c is  tensor(0.0298, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0113, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.6458, device='cuda:0')
c is  tensor(0.0316, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0115, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.3337, device='cuda:0')
c is  tensor(0.0315, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0105, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.2996, device='cuda:0')
c is  tensor(0.0303, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0153, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.9748, device='cuda:0')
c is  tensor(0.0307, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0147, device='cuda:0')
accept
len accept list 20
len all weights is 20
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 91.60% 

Test Accuracy: 89.26% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6824471354484558
distance 1 is tensor(137.2594, device='cuda:0')
distance 2 is tensor(10.4964, device='cuda:0')
benign distance is  tensor(10.4964, device='cuda:0')
norm1 res is  tensor(0.1607, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.20004871487617493
distance 1 is tensor(128.0094, device='cuda:0')
distance 2 is tensor(9.8029, device='cuda:0')
benign distance is  tensor(9.8029, device='cuda:0')
norm1 res is  tensor(0.1540, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.21474245190620422
distance 1 is tensor(125.9072, device='cuda:0')
distance 2 is tensor(9.4575, device='cuda:0')
benign distance is  tensor(9.4575, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.2292516231536865
distance 1 is tensor(123.7479, device='cuda:0')
distance 2 is tensor(9.3256, device='cuda:0')
benign distance is  tensor(9.3256, device='cuda:0')
norm1 res is  tensor(0.1446, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.263659954071045
distance 1 is tensor(114.1426, device='cuda:0')
distance 2 is tensor(8.5624, device='cuda:0')
benign distance is  tensor(8.5624, device='cuda:0')
norm1 res is  tensor(0.1353, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.9603357315063477
distance 1 is tensor(131.3900, device='cuda:0')
distance 2 is tensor(9.9949, device='cuda:0')
benign distance is  tensor(9.9949, device='cuda:0')
norm1 res is  tensor(0.1546, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.27876919507980347
distance 1 is tensor(124.3088, device='cuda:0')
distance 2 is tensor(9.4825, device='cuda:0')
benign distance is  tensor(9.4825, device='cuda:0')
norm1 res is  tensor(0.1453, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.46472516655921936
distance 1 is tensor(141.3000, device='cuda:0')
distance 2 is tensor(10.7105, device='cuda:0')
benign distance is  tensor(10.7105, device='cuda:0')
norm1 res is  tensor(0.1658, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2876, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.1628, device='cuda:0')
c is  tensor(0.0214, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.0557, device='cuda:0')
c is  tensor(0.0218, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.2825, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.8908, device='cuda:0')
c is  tensor(0.0224, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.7523, device='cuda:0')
c is  tensor(0.0236, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0011, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.6540, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.3544, device='cuda:0')
c is  tensor(0.0224, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.9338, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.4673, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.3953e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.6597, device='cuda:0')
c is  tensor(0.0213, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.9992, device='cuda:0')
c is  tensor(0.0220, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.1429, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.3444, device='cuda:0')
c is  tensor(0.0221, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.1109, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.6104, device='cuda:0')
c is  tensor(0.0220, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.9948e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.4297, device='cuda:0')
c is  tensor(0.0212, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 3
len all weights is 3
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 91.13% 

Test Accuracy: 88.79% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.11905211210250854
distance 1 is tensor(131.8770, device='cuda:0')
distance 2 is tensor(9.8889, device='cuda:0')
benign distance is  tensor(9.8889, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6626667380332947
distance 1 is tensor(135.6888, device='cuda:0')
distance 2 is tensor(10.2613, device='cuda:0')
benign distance is  tensor(10.2613, device='cuda:0')
norm1 res is  tensor(0.1538, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.24642285704612732
distance 1 is tensor(115.8588, device='cuda:0')
distance 2 is tensor(8.6656, device='cuda:0')
benign distance is  tensor(8.6656, device='cuda:0')
norm1 res is  tensor(0.1339, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.4642159044742584
distance 1 is tensor(119.6864, device='cuda:0')
distance 2 is tensor(9.0892, device='cuda:0')
benign distance is  tensor(9.0892, device='cuda:0')
norm1 res is  tensor(0.1371, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.484055757522583
distance 1 is tensor(110.0695, device='cuda:0')
distance 2 is tensor(8.3295, device='cuda:0')
benign distance is  tensor(8.3295, device='cuda:0')
norm1 res is  tensor(0.1306, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.3480389416217804
distance 1 is tensor(139.9931, device='cuda:0')
distance 2 is tensor(10.5791, device='cuda:0')
benign distance is  tensor(10.5791, device='cuda:0')
norm1 res is  tensor(0.1628, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.10671521723270416
distance 1 is tensor(128.5820, device='cuda:0')
distance 2 is tensor(9.4948, device='cuda:0')
benign distance is  tensor(9.4948, device='cuda:0')
norm1 res is  tensor(0.1466, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.40258073806762695
distance 1 is tensor(132.2429, device='cuda:0')
distance 2 is tensor(10.0212, device='cuda:0')
benign distance is  tensor(10.0212, device='cuda:0')
norm1 res is  tensor(0.1527, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.2894200384616852
distance 1 is tensor(127.7475, device='cuda:0')
distance 2 is tensor(9.7145, device='cuda:0')
benign distance is  tensor(9.7145, device='cuda:0')
norm1 res is  tensor(0.1503, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7508927583694458
distance 1 is tensor(140.6836, device='cuda:0')
distance 2 is tensor(10.5979, device='cuda:0')
benign distance is  tensor(10.5979, device='cuda:0')
norm1 res is  tensor(0.1631, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.7402229905128479
distance 1 is tensor(142.7272, device='cuda:0')
distance 2 is tensor(10.6004, device='cuda:0')
benign distance is  tensor(10.6004, device='cuda:0')
norm1 res is  tensor(0.1638, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5099016427993774
distance 1 is tensor(134.5990, device='cuda:0')
distance 2 is tensor(10.0780, device='cuda:0')
benign distance is  tensor(10.0780, device='cuda:0')
norm1 res is  tensor(0.1516, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.7611736059188843
distance 1 is tensor(127.7244, device='cuda:0')
distance 2 is tensor(9.7839, device='cuda:0')
benign distance is  tensor(9.7839, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.39119037985801697
distance 1 is tensor(113.0046, device='cuda:0')
distance 2 is tensor(8.6106, device='cuda:0')
benign distance is  tensor(8.6106, device='cuda:0')
norm1 res is  tensor(0.1319, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.14496685564517975
distance 1 is tensor(129.2645, device='cuda:0')
distance 2 is tensor(9.7950, device='cuda:0')
benign distance is  tensor(9.7950, device='cuda:0')
norm1 res is  tensor(0.1518, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.9081481695175171
distance 1 is tensor(145.1422, device='cuda:0')
distance 2 is tensor(10.8800, device='cuda:0')
benign distance is  tensor(10.8800, device='cuda:0')
norm1 res is  tensor(0.1697, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1453, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.3008, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.5511e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.6721, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.5308e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(530.0013, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.1319e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.8516, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(504.4110, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.7350, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.1110, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.5301e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.7605, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.9839, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.4957, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.7111, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.1577, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.4868, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.3017, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.2166, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6142e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.1940, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 5
len all weights is 5
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 91.17% 

Test Accuracy: 89.06% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5181471109390259
distance 1 is tensor(124.4159, device='cuda:0')
distance 2 is tensor(9.4489, device='cuda:0')
benign distance is  tensor(9.4489, device='cuda:0')
norm1 res is  tensor(0.1432, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.45329833030700684
distance 1 is tensor(120.3803, device='cuda:0')
distance 2 is tensor(9.0620, device='cuda:0')
benign distance is  tensor(9.0620, device='cuda:0')
norm1 res is  tensor(0.1397, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.17022117972373962
distance 1 is tensor(110.0406, device='cuda:0')
distance 2 is tensor(8.2431, device='cuda:0')
benign distance is  tensor(8.2431, device='cuda:0')
norm1 res is  tensor(0.1297, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.39682894945144653
distance 1 is tensor(123.8393, device='cuda:0')
distance 2 is tensor(9.3826, device='cuda:0')
benign distance is  tensor(9.3826, device='cuda:0')
norm1 res is  tensor(0.1462, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.164656400680542
distance 1 is tensor(118.5781, device='cuda:0')
distance 2 is tensor(8.8748, device='cuda:0')
benign distance is  tensor(8.8748, device='cuda:0')
norm1 res is  tensor(0.1360, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.9546597599983215
distance 1 is tensor(125.1713, device='cuda:0')
distance 2 is tensor(9.6363, device='cuda:0')
benign distance is  tensor(9.6363, device='cuda:0')
norm1 res is  tensor(0.1500, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.48310384154319763
distance 1 is tensor(132.7876, device='cuda:0')
distance 2 is tensor(9.9567, device='cuda:0')
benign distance is  tensor(9.9567, device='cuda:0')
norm1 res is  tensor(0.1533, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.3014455735683441
distance 1 is tensor(129.3710, device='cuda:0')
distance 2 is tensor(9.8403, device='cuda:0')
benign distance is  tensor(9.8403, device='cuda:0')
norm1 res is  tensor(0.1528, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.16760900616645813
distance 1 is tensor(123.4658, device='cuda:0')
distance 2 is tensor(9.1618, device='cuda:0')
benign distance is  tensor(9.1618, device='cuda:0')
norm1 res is  tensor(0.1409, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  1.1757911443710327
distance 1 is tensor(139.5961, device='cuda:0')
distance 2 is tensor(10.5156, device='cuda:0')
benign distance is  tensor(10.5156, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.20753467082977295
distance 1 is tensor(126.5711, device='cuda:0')
distance 2 is tensor(9.5505, device='cuda:0')
benign distance is  tensor(9.5505, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.47821250557899475
distance 1 is tensor(124.8372, device='cuda:0')
distance 2 is tensor(9.5798, device='cuda:0')
benign distance is  tensor(9.5798, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.6453161835670471
distance 1 is tensor(132.2695, device='cuda:0')
distance 2 is tensor(10.0229, device='cuda:0')
benign distance is  tensor(10.0229, device='cuda:0')
norm1 res is  tensor(0.1524, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.4755024015903473
distance 1 is tensor(124.3173, device='cuda:0')
distance 2 is tensor(9.3813, device='cuda:0')
benign distance is  tensor(9.3813, device='cuda:0')
norm1 res is  tensor(0.1422, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.42245182394981384
distance 1 is tensor(136.8718, device='cuda:0')
distance 2 is tensor(10.3652, device='cuda:0')
benign distance is  tensor(10.3652, device='cuda:0')
norm1 res is  tensor(0.1594, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.6235170364379883
distance 1 is tensor(132.3745, device='cuda:0')
distance 2 is tensor(10.0035, device='cuda:0')
benign distance is  tensor(10.0035, device='cuda:0')
norm1 res is  tensor(0.1534, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 24
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1091, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.1819, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.9224, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.3855e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(504.7922, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.5127e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.6944, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.9274, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.9927, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.3684, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.4058, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1748e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.3686, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.0949e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.2471, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(740.7585, device='cuda:0')
c is  tensor(0.0121, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6416e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.5582, device='cuda:0')
c is  tensor(0.0126, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.8618, device='cuda:0')
c is  tensor(0.0127, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.1086, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.2600e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.7446, device='cuda:0')
c is  tensor(0.0126, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.7393e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.8448, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.0880e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.0264, device='cuda:0')
c is  tensor(0.0131, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.2782e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3434, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.6974e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.9795, device='cuda:0')
c is  tensor(0.0127, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.5788e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.7085, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.3501e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.9335, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3618e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.8733, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7497e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.8525, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.4409e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.0136, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 4
len all weights is 4
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 91.03% 

Test Accuracy: 88.75% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
 benign loss is  0.39336058497428894
distance 1 is tensor(127.0799, device='cuda:0')
distance 2 is tensor(9.4006, device='cuda:0')
benign distance is  tensor(9.4006, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9310756921768188
distance 1 is tensor(134.2994, device='cuda:0')
distance 2 is tensor(10.1277, device='cuda:0')
benign distance is  tensor(10.1277, device='cuda:0')
norm1 res is  tensor(0.1585, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.25467196106910706
distance 1 is tensor(114.0817, device='cuda:0')
distance 2 is tensor(8.5267, device='cuda:0')
benign distance is  tensor(8.5267, device='cuda:0')
norm1 res is  tensor(0.1313, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3655877411365509
distance 1 is tensor(127.2046, device='cuda:0')
distance 2 is tensor(9.5629, device='cuda:0')
benign distance is  tensor(9.5629, device='cuda:0')
norm1 res is  tensor(0.1482, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.164240837097168
distance 1 is tensor(120.0368, device='cuda:0')
distance 2 is tensor(9.0617, device='cuda:0')
benign distance is  tensor(9.0617, device='cuda:0')
norm1 res is  tensor(0.1385, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.40924757719039917
distance 1 is tensor(142.3328, device='cuda:0')
distance 2 is tensor(10.7319, device='cuda:0')
benign distance is  tensor(10.7319, device='cuda:0')
norm1 res is  tensor(0.1629, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.6467572450637817
distance 1 is tensor(135.9571, device='cuda:0')
distance 2 is tensor(10.2759, device='cuda:0')
benign distance is  tensor(10.2759, device='cuda:0')
norm1 res is  tensor(0.1617, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8860650062561035
distance 1 is tensor(120.0896, device='cuda:0')
distance 2 is tensor(9.0733, device='cuda:0')
benign distance is  tensor(9.0733, device='cuda:0')
norm1 res is  tensor(0.1413, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.33863532543182373
distance 1 is tensor(116.3636, device='cuda:0')
distance 2 is tensor(8.7270, device='cuda:0')
benign distance is  tensor(8.7270, device='cuda:0')
norm1 res is  tensor(0.1335, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.46756118535995483
distance 1 is tensor(149.0693, device='cuda:0')
distance 2 is tensor(11.1061, device='cuda:0')
benign distance is  tensor(11.1061, device='cuda:0')
norm1 res is  tensor(0.1675, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9357489347457886
distance 1 is tensor(129.9874, device='cuda:0')
distance 2 is tensor(9.6761, device='cuda:0')
benign distance is  tensor(9.6761, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3361138105392456
distance 1 is tensor(134.0860, device='cuda:0')
distance 2 is tensor(10.1743, device='cuda:0')
benign distance is  tensor(10.1743, device='cuda:0')
norm1 res is  tensor(0.1562, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.48569339513778687
distance 1 is tensor(129.7596, device='cuda:0')
distance 2 is tensor(10.0297, device='cuda:0')
benign distance is  tensor(10.0297, device='cuda:0')
norm1 res is  tensor(0.1520, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.05873851850628853
distance 1 is tensor(129.1315, device='cuda:0')
distance 2 is tensor(9.7863, device='cuda:0')
benign distance is  tensor(9.7863, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.12273506820201874
distance 1 is tensor(141.0713, device='cuda:0')
distance 2 is tensor(10.5724, device='cuda:0')
benign distance is  tensor(10.5724, device='cuda:0')
norm1 res is  tensor(0.1637, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.3887264728546143
distance 1 is tensor(140.7682, device='cuda:0')
distance 2 is tensor(10.6292, device='cuda:0')
benign distance is  tensor(10.6292, device='cuda:0')
norm1 res is  tensor(0.1611, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.2239498794078827
distance 1 is tensor(137.2735, device='cuda:0')
distance 2 is tensor(10.3538, device='cuda:0')
benign distance is  tensor(10.3538, device='cuda:0')
norm1 res is  tensor(0.1598, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.8192987442016602
distance 1 is tensor(138.5902, device='cuda:0')
distance 2 is tensor(10.4197, device='cuda:0')
benign distance is  tensor(10.4197, device='cuda:0')
norm1 res is  tensor(0.1609, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.1272436380386353
distance 1 is tensor(154.7220, device='cuda:0')
distance 2 is tensor(11.6198, device='cuda:0')
benign distance is  tensor(11.6198, device='cuda:0')
norm1 res is  tensor(0.1786, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.47941192984580994
distance 1 is tensor(143.5870, device='cuda:0')
distance 2 is tensor(10.7776, device='cuda:0')
benign distance is  tensor(10.7776, device='cuda:0')
norm1 res is  tensor(0.1641, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.8780879974365234
distance 1 is tensor(147.7771, device='cuda:0')
distance 2 is tensor(11.0991, device='cuda:0')
benign distance is  tensor(11.0991, device='cuda:0')
norm1 res is  tensor(0.1682, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.3442487120628357
distance 1 is tensor(139.0915, device='cuda:0')
distance 2 is tensor(10.4401, device='cuda:0')
benign distance is  tensor(10.4401, device='cuda:0')
norm1 res is  tensor(0.1600, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.6189698576927185
distance 1 is tensor(140.1789, device='cuda:0')
distance 2 is tensor(10.4931, device='cuda:0')
benign distance is  tensor(10.4931, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  1.0302259922027588
distance 1 is tensor(133.1621, device='cuda:0')
distance 2 is tensor(10.2322, device='cuda:0')
benign distance is  tensor(10.2322, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(0.1803, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.5456, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.8838e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.5763, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.3965, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.8546, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.7261, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.8542, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7496, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(551.6215, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.9128, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.3278, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.4816, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6751e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.8188, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.1677, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.0045, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5664, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.5062, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
len accept list 3
len all weights is 3
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 90.50% 

Test Accuracy: 88.20% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3686010241508484
distance 1 is tensor(138.7082, device='cuda:0')
distance 2 is tensor(10.3632, device='cuda:0')
benign distance is  tensor(10.3632, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6282743811607361
distance 1 is tensor(130.4748, device='cuda:0')
distance 2 is tensor(9.8118, device='cuda:0')
benign distance is  tensor(9.8118, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.19806215167045593
distance 1 is tensor(109.6592, device='cuda:0')
distance 2 is tensor(8.3570, device='cuda:0')
benign distance is  tensor(8.3570, device='cuda:0')
norm1 res is  tensor(0.1296, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.520422637462616
distance 1 is tensor(129.9817, device='cuda:0')
distance 2 is tensor(9.9512, device='cuda:0')
benign distance is  tensor(9.9512, device='cuda:0')
norm1 res is  tensor(0.1504, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.4022703170776367
distance 1 is tensor(119.5758, device='cuda:0')
distance 2 is tensor(8.9577, device='cuda:0')
benign distance is  tensor(8.9577, device='cuda:0')
norm1 res is  tensor(0.1387, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.46803173422813416
distance 1 is tensor(136.1183, device='cuda:0')
distance 2 is tensor(10.1975, device='cuda:0')
benign distance is  tensor(10.1975, device='cuda:0')
norm1 res is  tensor(0.1567, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.10612034797668457
distance 1 is tensor(126.0717, device='cuda:0')
distance 2 is tensor(9.4590, device='cuda:0')
benign distance is  tensor(9.4590, device='cuda:0')
norm1 res is  tensor(0.1437, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.46567583084106445
distance 1 is tensor(138.1029, device='cuda:0')
distance 2 is tensor(10.3437, device='cuda:0')
benign distance is  tensor(10.3437, device='cuda:0')
norm1 res is  tensor(0.1587, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.2827177941799164
distance 1 is tensor(120.9125, device='cuda:0')
distance 2 is tensor(9.1576, device='cuda:0')
benign distance is  tensor(9.1576, device='cuda:0')
norm1 res is  tensor(0.1413, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.14265108108520508
distance 1 is tensor(127.8273, device='cuda:0')
distance 2 is tensor(9.8474, device='cuda:0')
benign distance is  tensor(9.8474, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.266692578792572
distance 1 is tensor(143.4353, device='cuda:0')
distance 2 is tensor(10.7364, device='cuda:0')
benign distance is  tensor(10.7364, device='cuda:0')
norm1 res is  tensor(0.1634, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.04396361857652664
distance 1 is tensor(118.4918, device='cuda:0')
distance 2 is tensor(9.0815, device='cuda:0')
benign distance is  tensor(9.0815, device='cuda:0')
norm1 res is  tensor(0.1391, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.4674411416053772
distance 1 is tensor(135.5844, device='cuda:0')
distance 2 is tensor(10.2211, device='cuda:0')
benign distance is  tensor(10.2211, device='cuda:0')
norm1 res is  tensor(0.1585, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.8211687803268433
distance 1 is tensor(131.8928, device='cuda:0')
distance 2 is tensor(10.0420, device='cuda:0')
benign distance is  tensor(10.0420, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.6961134076118469
distance 1 is tensor(135.6274, device='cuda:0')
distance 2 is tensor(10.3126, device='cuda:0')
benign distance is  tensor(10.3126, device='cuda:0')
norm1 res is  tensor(0.1583, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.31032371520996094
distance 1 is tensor(135.5030, device='cuda:0')
distance 2 is tensor(10.0050, device='cuda:0')
benign distance is  tensor(10.0050, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 32
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.0760, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.7118, device='cuda:0')
c is  tensor(0.0110, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.6868, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.7998e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.7094, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.4926e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9744, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.3666e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.4200, device='cuda:0')
c is  tensor(0.0119, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0896e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.3701, device='cuda:0')
c is  tensor(0.0111, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4713e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.6620, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.1656e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.5936, device='cuda:0')
c is  tensor(0.0111, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5007e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.2210, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.2149, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.2825e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.1058, device='cuda:0')
c is  tensor(0.0106, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.5483e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.5125, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6276e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.1172, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.6064, device='cuda:0')
c is  tensor(0.0101, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.7844e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.6487, device='cuda:0')
c is  tensor(0.0103, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.8234e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.8030, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1653e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.6696, device='cuda:0')
c is  tensor(0.0107, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.9268, device='cuda:0')
c is  tensor(0.0103, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.5935e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.2735, device='cuda:0')
c is  tensor(0.0107, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.3782, device='cuda:0')
c is  tensor(0.0107, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2550e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.5227, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.4359, device='cuda:0')
c is  tensor(0.0108, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.1646, device='cuda:0')
c is  tensor(0.0103, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.7354e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.7549, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6141e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.1411, device='cuda:0')
c is  tensor(0.0110, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5502e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.5396, device='cuda:0')
c is  tensor(0.0102, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.3889e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.4023, device='cuda:0')
c is  tensor(0.0108, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.7382e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.6642, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.6793e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.4211, device='cuda:0')
c is  tensor(0.0106, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.8256e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.8404, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.8276, device='cuda:0')
c is  tensor(0.0103, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.1303e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.8956, device='cuda:0')
c is  tensor(0.0103, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
len accept list 26
len all weights is 26
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 91.25% 

Test Accuracy: 88.95% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
 benign loss is  0.34850892424583435
distance 1 is tensor(113.6283, device='cuda:0')
distance 2 is tensor(8.6719, device='cuda:0')
benign distance is  tensor(8.6719, device='cuda:0')
norm1 res is  tensor(0.1313, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5156084299087524
distance 1 is tensor(141.1817, device='cuda:0')
distance 2 is tensor(10.5388, device='cuda:0')
benign distance is  tensor(10.5388, device='cuda:0')
norm1 res is  tensor(0.1626, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.05666641518473625
distance 1 is tensor(129.2149, device='cuda:0')
distance 2 is tensor(9.4950, device='cuda:0')
benign distance is  tensor(9.4950, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.4950599670410156
distance 1 is tensor(127.5471, device='cuda:0')
distance 2 is tensor(9.6202, device='cuda:0')
benign distance is  tensor(9.6202, device='cuda:0')
norm1 res is  tensor(0.1462, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9327532649040222
distance 1 is tensor(125.7925, device='cuda:0')
distance 2 is tensor(9.4207, device='cuda:0')
benign distance is  tensor(9.4207, device='cuda:0')
norm1 res is  tensor(0.1421, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6505151987075806
distance 1 is tensor(127.5471, device='cuda:0')
distance 2 is tensor(9.7244, device='cuda:0')
benign distance is  tensor(9.7244, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.08832654356956482
distance 1 is tensor(115.9784, device='cuda:0')
distance 2 is tensor(8.6352, device='cuda:0')
benign distance is  tensor(8.6352, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.36039847135543823
distance 1 is tensor(112.5293, device='cuda:0')
distance 2 is tensor(8.6812, device='cuda:0')
benign distance is  tensor(8.6812, device='cuda:0')
norm1 res is  tensor(0.1311, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.24205496907234192
distance 1 is tensor(131.6604, device='cuda:0')
distance 2 is tensor(9.7700, device='cuda:0')
benign distance is  tensor(9.7700, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.40948909521102905
distance 1 is tensor(142.3008, device='cuda:0')
distance 2 is tensor(10.6615, device='cuda:0')
benign distance is  tensor(10.6615, device='cuda:0')
norm1 res is  tensor(0.1617, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.018416166305542
distance 1 is tensor(128.6308, device='cuda:0')
distance 2 is tensor(9.5437, device='cuda:0')
benign distance is  tensor(9.5437, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.6177548170089722
distance 1 is tensor(137.4077, device='cuda:0')
distance 2 is tensor(10.3852, device='cuda:0')
benign distance is  tensor(10.3852, device='cuda:0')
norm1 res is  tensor(0.1608, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.4684683680534363
distance 1 is tensor(118.4677, device='cuda:0')
distance 2 is tensor(8.9483, device='cuda:0')
benign distance is  tensor(8.9483, device='cuda:0')
norm1 res is  tensor(0.1394, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6787267923355103
distance 1 is tensor(121.4863, device='cuda:0')
distance 2 is tensor(9.1395, device='cuda:0')
benign distance is  tensor(9.1395, device='cuda:0')
norm1 res is  tensor(0.1420, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.37953826785087585
distance 1 is tensor(130.2205, device='cuda:0')
distance 2 is tensor(9.7523, device='cuda:0')
benign distance is  tensor(9.7523, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.9500421285629272
distance 1 is tensor(129.1582, device='cuda:0')
distance 2 is tensor(9.6396, device='cuda:0')
benign distance is  tensor(9.6396, device='cuda:0')
norm1 res is  tensor(0.1484, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.11467258632183075
distance 1 is tensor(129.8155, device='cuda:0')
distance 2 is tensor(9.8947, device='cuda:0')
benign distance is  tensor(9.8947, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.4607703685760498
distance 1 is tensor(129.8585, device='cuda:0')
distance 2 is tensor(9.8798, device='cuda:0')
benign distance is  tensor(9.8798, device='cuda:0')
norm1 res is  tensor(0.1521, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.5682725310325623
distance 1 is tensor(133.2121, device='cuda:0')
distance 2 is tensor(10.2003, device='cuda:0')
benign distance is  tensor(10.2003, device='cuda:0')
norm1 res is  tensor(0.1572, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.3705734610557556
distance 1 is tensor(132.3445, device='cuda:0')
distance 2 is tensor(9.9350, device='cuda:0')
benign distance is  tensor(9.9350, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.4306686818599701
distance 1 is tensor(121.9599, device='cuda:0')
distance 2 is tensor(9.1999, device='cuda:0')
benign distance is  tensor(9.1999, device='cuda:0')
norm1 res is  tensor(0.1416, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.7235300540924072
distance 1 is tensor(125.5561, device='cuda:0')
distance 2 is tensor(9.4948, device='cuda:0')
benign distance is  tensor(9.4948, device='cuda:0')
norm1 res is  tensor(0.1459, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.43507012724876404
distance 1 is tensor(129.5606, device='cuda:0')
distance 2 is tensor(9.8812, device='cuda:0')
benign distance is  tensor(9.8812, device='cuda:0')
norm1 res is  tensor(0.1528, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.6015791893005371
distance 1 is tensor(123.6450, device='cuda:0')
distance 2 is tensor(9.3448, device='cuda:0')
benign distance is  tensor(9.3448, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.05014505982398987
distance 1 is tensor(122.7449, device='cuda:0')
distance 2 is tensor(9.3444, device='cuda:0')
benign distance is  tensor(9.3444, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.2118118554353714
distance 1 is tensor(124.6764, device='cuda:0')
distance 2 is tensor(9.4952, device='cuda:0')
benign distance is  tensor(9.4952, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.17160512506961823
distance 1 is tensor(121.6315, device='cuda:0')
distance 2 is tensor(9.2258, device='cuda:0')
benign distance is  tensor(9.2258, device='cuda:0')
norm1 res is  tensor(0.1397, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  1.0645931959152222
distance 1 is tensor(138.7865, device='cuda:0')
distance 2 is tensor(10.4877, device='cuda:0')
benign distance is  tensor(10.4877, device='cuda:0')
norm1 res is  tensor(0.1613, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.4411519467830658
distance 1 is tensor(135.1460, device='cuda:0')
distance 2 is tensor(10.2668, device='cuda:0')
benign distance is  tensor(10.2668, device='cuda:0')
norm1 res is  tensor(0.1582, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.5150439739227295
distance 1 is tensor(142.3365, device='cuda:0')
distance 2 is tensor(10.6259, device='cuda:0')
benign distance is  tensor(10.6259, device='cuda:0')
norm1 res is  tensor(0.1644, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.7413249611854553
distance 1 is tensor(140.8981, device='cuda:0')
distance 2 is tensor(10.5666, device='cuda:0')
benign distance is  tensor(10.5666, device='cuda:0')
norm1 res is  tensor(0.1628, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.8197389841079712
distance 1 is tensor(129.1367, device='cuda:0')
distance 2 is tensor(9.6324, device='cuda:0')
benign distance is  tensor(9.6324, device='cuda:0')
norm1 res is  tensor(0.1494, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(134.9392, device='cuda:0')
distance 2 is tensor(10.1184, device='cuda:0')
compute distance is  tensor(10.1184, device='cuda:0')
compute norm is  tensor(54.0585, device='cuda:0')
distance 1 is tensor(135.3362, device='cuda:0')
distance 2 is tensor(10.2395, device='cuda:0')
compute distance is  tensor(10.2395, device='cuda:0')
compute norm is  tensor(54.0614, device='cuda:0')
distance 1 is tensor(158.2196, device='cuda:0')
distance 2 is tensor(12.0049, device='cuda:0')
compute distance is  tensor(12.0049, device='cuda:0')
compute norm is  tensor(54.8064, device='cuda:0')
distance 1 is tensor(138.9142, device='cuda:0')
distance 2 is tensor(10.6461, device='cuda:0')
compute distance is  tensor(10.6461, device='cuda:0')
compute norm is  tensor(54.1703, device='cuda:0')
distance 1 is tensor(143.6757, device='cuda:0')
distance 2 is tensor(10.9200, device='cuda:0')
compute distance is  tensor(10.9200, device='cuda:0')
compute norm is  tensor(54.4912, device='cuda:0')
distance 1 is tensor(146.2947, device='cuda:0')
distance 2 is tensor(11.0560, device='cuda:0')
compute distance is  tensor(11.0560, device='cuda:0')
compute norm is  tensor(54.5005, device='cuda:0')
distance 1 is tensor(148.8100, device='cuda:0')
distance 2 is tensor(11.3511, device='cuda:0')
compute distance is  tensor(11.3511, device='cuda:0')
compute norm is  tensor(54.4766, device='cuda:0')
distance 1 is tensor(131.4249, device='cuda:0')
distance 2 is tensor(10.0788, device='cuda:0')
compute distance is  tensor(10.0788, device='cuda:0')
compute norm is  tensor(54.1334, device='cuda:0')
distance 1 is tensor(133.7666, device='cuda:0')
distance 2 is tensor(10.0865, device='cuda:0')
compute distance is  tensor(10.0865, device='cuda:0')
compute norm is  tensor(54.1641, device='cuda:0')
distance 1 is tensor(135.9715, device='cuda:0')
distance 2 is tensor(10.1376, device='cuda:0')
compute distance is  tensor(10.1376, device='cuda:0')
compute norm is  tensor(54.0934, device='cuda:0')
distance 1 is tensor(138.5715, device='cuda:0')
distance 2 is tensor(10.3056, device='cuda:0')
compute distance is  tensor(10.3056, device='cuda:0')
compute norm is  tensor(54.3052, device='cuda:0')
distance 1 is tensor(127.2491, device='cuda:0')
distance 2 is tensor(9.6296, device='cuda:0')
compute distance is  tensor(9.6296, device='cuda:0')
compute norm is  tensor(53.9310, device='cuda:0')
batch acc is 0.10305000015633192
batch acc is 0.10152500015633656
batch acc is 0.10101666682300633
batch acc is 0.10076250015634124
batch acc is 0.10061000015634217
batch acc is 0.10050833348967068
batch acc is 0.10043571444204473
batch acc is 0.10038125015632526
batch acc is 0.10033888904521013
batch acc is 0.10030500015631802
mal_rand_acc is 0.10000000049999999
mal_rand loss is 7.360365169748214e+17
len of model dicts is  12
distance 1 is tensor(134.9392, device='cuda:0')
distance 2 is tensor(10.1184, device='cuda:0')
compute distance is  tensor(10.1184, device='cuda:0')
compute norm is  tensor(54.0585, device='cuda:0')
distance 1 is tensor(135.3362, device='cuda:0')
distance 2 is tensor(10.2395, device='cuda:0')
compute distance is  tensor(10.2395, device='cuda:0')
compute norm is  tensor(54.0614, device='cuda:0')
distance 1 is tensor(158.2196, device='cuda:0')
distance 2 is tensor(12.0049, device='cuda:0')
compute distance is  tensor(12.0049, device='cuda:0')
compute norm is  tensor(54.8064, device='cuda:0')
distance 1 is tensor(138.9142, device='cuda:0')
distance 2 is tensor(10.6461, device='cuda:0')
compute distance is  tensor(10.6461, device='cuda:0')
compute norm is  tensor(54.1703, device='cuda:0')
distance 1 is tensor(143.6757, device='cuda:0')
distance 2 is tensor(10.9200, device='cuda:0')
compute distance is  tensor(10.9200, device='cuda:0')
compute norm is  tensor(54.4912, device='cuda:0')
distance 1 is tensor(146.2947, device='cuda:0')
distance 2 is tensor(11.0560, device='cuda:0')
compute distance is  tensor(11.0560, device='cuda:0')
compute norm is  tensor(54.5005, device='cuda:0')
distance 1 is tensor(148.8100, device='cuda:0')
distance 2 is tensor(11.3511, device='cuda:0')
compute distance is  tensor(11.3511, device='cuda:0')
compute norm is  tensor(54.4766, device='cuda:0')
distance 1 is tensor(131.4249, device='cuda:0')
distance 2 is tensor(10.0788, device='cuda:0')
compute distance is  tensor(10.0788, device='cuda:0')
compute norm is  tensor(54.1334, device='cuda:0')
distance 1 is tensor(133.7666, device='cuda:0')
distance 2 is tensor(10.0865, device='cuda:0')
compute distance is  tensor(10.0865, device='cuda:0')
compute norm is  tensor(54.1641, device='cuda:0')
distance 1 is tensor(135.9715, device='cuda:0')
distance 2 is tensor(10.1376, device='cuda:0')
compute distance is  tensor(10.1376, device='cuda:0')
compute norm is  tensor(54.0934, device='cuda:0')
distance 1 is tensor(138.5715, device='cuda:0')
distance 2 is tensor(10.3056, device='cuda:0')
compute distance is  tensor(10.3056, device='cuda:0')
compute norm is  tensor(54.3052, device='cuda:0')
distance 1 is tensor(127.2491, device='cuda:0')
distance 2 is tensor(9.6296, device='cuda:0')
compute distance is  tensor(9.6296, device='cuda:0')
compute norm is  tensor(53.9310, device='cuda:0')
distance Threshold  is  tensor(12.0049, device='cuda:0')
distance 1 is tensor(1102103.6250, device='cuda:0')
distance 2 is tensor(79395.7031, device='cuda:0')
________________________________
test distance is  tensor(79395.7031, device='cuda:0')
test similarity is  tensor(-0.1344, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197235612487785e+17
test entropy is  0.0
________________________________
cal ratio is  0.011066840025409705
distance 1 is tensor(12196.8115, device='cuda:0')
distance 2 is tensor(878.6595, device='cuda:0')
cal_distance is  tensor(878.6595, device='cuda:0')
cal ratio is  0.10519905058724212
distance 1 is tensor(1283.0994, device='cuda:0')
distance 2 is tensor(92.4341, device='cuda:0')
cal_distance is  tensor(92.4341, device='cuda:0')
cal ratio is  0.3243440383676831
distance 1 is tensor(416.1705, device='cuda:0')
distance 2 is tensor(29.9805, device='cuda:0')
cal_distance is  tensor(29.9805, device='cuda:0')
cal ratio is  0.5695120914203818
distance 1 is tensor(237.0173, device='cuda:0')
distance 2 is tensor(17.0742, device='cuda:0')
cal_distance is  tensor(17.0742, device='cuda:0')
cal ratio is  0.7546602433773623
distance 1 is tensor(178.8693, device='cuda:0')
distance 2 is tensor(12.8852, device='cuda:0')
cal_distance is  tensor(12.8852, device='cuda:0')
cal ratio is  0.8687118556204205
distance 1 is tensor(155.3868, device='cuda:0')
distance 2 is tensor(11.1936, device='cuda:0')
cal_distance is  tensor(11.1936, device='cuda:0')
distance 1 is tensor(155.3868, device='cuda:0')
distance 2 is tensor(11.1936, device='cuda:0')
________________________________
test distance is  tensor(11.1936, device='cuda:0')
test similarity is  tensor(0.9423, device='cuda:0')
test acc is  0.8720500001563224
test loss is 39.95366308989047
test entropy is  0.02371505202162318
________________________________
distance 1 is tensor(155.3868, device='cuda:0')
distance 2 is tensor(11.1936, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.02445513559263639
avg test loss is  40.022054477032825
avg accuracy is  0.8709500001563225
solo acc is  0.222866666823004
compute similarity  is  tensor(0.9423, device='cuda:0')
compute_distance is  tensor(11.1936, device='cuda:0')
compute_norm is  tensor(53.7658, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(146.5290, device='cuda:0')
distance 2 is tensor(12.6738, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.924120679211769
avg test loss is  1.5585438821361517
avg accuracy is  0.8451666668229901
solo acc is  0.32558333348967333
compute similarity  is  tensor(0.9434, device='cuda:0')
compute_distance is  tensor(12.6738, device='cuda:0')
compute_norm is  tensor(52.4134, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.9374, device='cuda:0')
distance 2 is tensor(13.0265, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8941170364808935
avg test loss is  1.6064282448561207
avg accuracy is  0.8415666668229903
solo acc is  0.2691500001563389
compute similarity  is  tensor(0.9430, device='cuda:0')
compute_distance is  tensor(13.0265, device='cuda:0')
compute_norm is  tensor(52.0474, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.0232, device='cuda:0')
distance 2 is tensor(13.2753, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8800832511646661
avg test loss is  1.5660548821441147
avg accuracy is  0.8448000001563235
solo acc is  0.265533333489672
compute similarity  is  tensor(0.9427, device='cuda:0')
compute_distance is  tensor(13.2753, device='cuda:0')
compute_norm is  tensor(51.7138, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.9054, device='cuda:0')
distance 2 is tensor(13.4773, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8736441642490785
avg test loss is  1.5314891521356253
avg accuracy is  0.8473500001563233
solo acc is  0.26121666682300526
compute similarity  is  tensor(0.9425, device='cuda:0')
compute_distance is  tensor(13.4773, device='cuda:0')
compute_norm is  tensor(51.4000, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.8033, device='cuda:0')
distance 2 is tensor(13.6688, device='cuda:0')
________________________________
test distance is  tensor(13.6688, device='cuda:0')
test similarity is  tensor(0.9423, device='cuda:0')
test acc is  0.8502166668229899
test loss is 1.511834050038222
test entropy is  0.8645838873345715
________________________________
cal ratio is  0.8434439294717704
distance 1 is tensor(130.5689, device='cuda:0')
distance 2 is tensor(11.5289, device='cuda:0')
cal_distance is  tensor(11.5289, device='cuda:0')
distance 1 is tensor(130.5689, device='cuda:0')
distance 2 is tensor(11.5289, device='cuda:0')
________________________________
test distance is  tensor(11.5289, device='cuda:0')
test similarity is  tensor(0.9591, device='cuda:0')
test acc is  0.8694000001563226
test loss is 0.9746255135612447
test entropy is  0.9166679550716872
________________________________
distance 1 is tensor(130.5689, device='cuda:0')
distance 2 is tensor(11.5289, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9169935143705624
avg test loss is  0.9760547957694861
avg accuracy is  0.8680666668229892
solo acc is  0.5981166668230045
compute similarity  is  tensor(0.9591, device='cuda:0')
compute_distance is  tensor(11.5289, device='cuda:0')
compute_norm is  tensor(51.1077, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.4630, device='cuda:0')
distance 2 is tensor(12.0365, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8560506466355151
avg test loss is  1.4878062424120873
avg accuracy is  0.8609333334896562
solo acc is  0.26590000015633863
compute similarity  is  tensor(0.9579, device='cuda:0')
compute_distance is  tensor(12.0365, device='cuda:0')
compute_norm is  tensor(50.7914, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.8067, device='cuda:0')
distance 2 is tensor(12.2588, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8475734937165592
avg test loss is  1.462695213904513
avg accuracy is  0.8644666668229892
solo acc is  0.2639500001563387
compute similarity  is  tensor(0.9576, device='cuda:0')
compute_distance is  tensor(12.2588, device='cuda:0')
compute_norm is  tensor(50.4936, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.9597, device='cuda:0')
distance 2 is tensor(12.4524, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8429997243098358
avg test loss is  1.4458305448103053
avg accuracy is  0.8639833334896562
solo acc is  0.2607833334896719
compute similarity  is  tensor(0.9573, device='cuda:0')
compute_distance is  tensor(12.4524, device='cuda:0')
compute_norm is  tensor(50.2059, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.0387, device='cuda:0')
distance 2 is tensor(12.6345, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8344785651164268
avg test loss is  1.435398445963097
avg accuracy is  0.8661500001563226
solo acc is  0.2542000001563383
compute similarity  is  tensor(0.9570, device='cuda:0')
compute_distance is  tensor(12.6345, device='cuda:0')
compute_norm is  tensor(49.9257, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.0848, device='cuda:0')
distance 2 is tensor(12.8072, device='cuda:0')
________________________________
test distance is  tensor(12.8072, device='cuda:0')
test similarity is  tensor(0.9568, device='cuda:0')
test acc is  0.8675166668229893
test loss is 1.402917859142523
test entropy is  0.8419049802238244
________________________________
cal ratio is  0.8713558743481605
distance 1 is tensor(124.6785, device='cuda:0')
distance 2 is tensor(11.1596, device='cuda:0')
cal_distance is  tensor(11.1596, device='cuda:0')
distance 1 is tensor(124.6785, device='cuda:0')
distance 2 is tensor(11.1596, device='cuda:0')
________________________________
test distance is  tensor(11.1596, device='cuda:0')
test similarity is  tensor(0.9676, device='cuda:0')
test acc is  0.8802500001563222
test loss is 0.9310442408137738
test entropy is  0.8932990341552539
________________________________
distance 1 is tensor(124.6785, device='cuda:0')
distance 2 is tensor(11.1596, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8948039132903125
avg test loss is  0.9273257347058131
avg accuracy is  0.8798833334896554
solo acc is  0.6055166668230038
compute similarity  is  tensor(0.9676, device='cuda:0')
compute_distance is  tensor(11.1596, device='cuda:0')
compute_norm is  tensor(49.8926, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(128.4702, device='cuda:0')
distance 2 is tensor(11.6247, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8270115030091455
avg test loss is  1.4072375922823257
avg accuracy is  0.8759333334896556
solo acc is  0.25996666682300523
compute similarity  is  tensor(0.9665, device='cuda:0')
compute_distance is  tensor(11.6247, device='cuda:0')
compute_norm is  tensor(49.6110, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.9108, device='cuda:0')
distance 2 is tensor(11.8352, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8269802978806404
avg test loss is  1.3800979126999373
avg accuracy is  0.8765000001563222
solo acc is  0.2615166668230053
compute similarity  is  tensor(0.9661, device='cuda:0')
compute_distance is  tensor(11.8352, device='cuda:0')
compute_norm is  tensor(49.3374, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.2171, device='cuda:0')
distance 2 is tensor(12.0242, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8202614512906146
avg test loss is  1.3746941580828318
avg accuracy is  0.8779500001563223
solo acc is  0.2553500001563384
compute similarity  is  tensor(0.9658, device='cuda:0')
compute_distance is  tensor(12.0242, device='cuda:0')
compute_norm is  tensor(49.0696, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.4577, device='cuda:0')
distance 2 is tensor(12.2053, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8124268477532401
avg test loss is  1.3678006837362928
avg accuracy is  0.8811666668229887
solo acc is  0.2510500001563382
compute similarity  is  tensor(0.9655, device='cuda:0')
compute_distance is  tensor(12.2053, device='cuda:0')
compute_norm is  tensor(48.8057, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.6447, device='cuda:0')
distance 2 is tensor(12.3803, device='cuda:0')
________________________________
test distance is  tensor(12.3803, device='cuda:0')
test similarity is  tensor(0.9652, device='cuda:0')
test acc is  0.882050000156322
test loss is 1.3479171315235878
test entropy is  0.8134305480319554
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.1764891147613525
mal norm is  tensor(6.0966, device='cuda:0')
distance 1 is tensor(137.6447, device='cuda:0')
distance 2 is tensor(12.3803, device='cuda:0')
mal distance is  tensor(12.3803, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1727, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.3785, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.7119, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.5580, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.5762, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.6860, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.8348, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.7612, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.8014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.5068, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.7450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6617, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 1
len all weights is 1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 89.10% 

Test Accuracy: 87.09% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
 benign loss is  0.15574176609516144
distance 1 is tensor(147.1114, device='cuda:0')
distance 2 is tensor(11.1804, device='cuda:0')
benign distance is  tensor(11.1804, device='cuda:0')
norm1 res is  tensor(0.1696, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.19882909953594208
distance 1 is tensor(153.2058, device='cuda:0')
distance 2 is tensor(11.6970, device='cuda:0')
benign distance is  tensor(11.6970, device='cuda:0')
norm1 res is  tensor(0.1745, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.07047306001186371
distance 1 is tensor(95.9870, device='cuda:0')
distance 2 is tensor(7.1701, device='cuda:0')
benign distance is  tensor(7.1701, device='cuda:0')
norm1 res is  tensor(0.1078, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.7050448656082153
distance 1 is tensor(151.9914, device='cuda:0')
distance 2 is tensor(11.5994, device='cuda:0')
benign distance is  tensor(11.5994, device='cuda:0')
norm1 res is  tensor(0.1750, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.23665520548820496
distance 1 is tensor(135.3348, device='cuda:0')
distance 2 is tensor(10.0477, device='cuda:0')
benign distance is  tensor(10.0477, device='cuda:0')
norm1 res is  tensor(0.1520, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.4996764659881592
distance 1 is tensor(153.8685, device='cuda:0')
distance 2 is tensor(11.5768, device='cuda:0')
benign distance is  tensor(11.5768, device='cuda:0')
norm1 res is  tensor(0.1785, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.14895138144493103
distance 1 is tensor(155.7659, device='cuda:0')
distance 2 is tensor(11.5753, device='cuda:0')
benign distance is  tensor(11.5753, device='cuda:0')
norm1 res is  tensor(0.1722, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.22122809290885925
distance 1 is tensor(155.2210, device='cuda:0')
distance 2 is tensor(11.6263, device='cuda:0')
benign distance is  tensor(11.6263, device='cuda:0')
norm1 res is  tensor(0.1763, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(174.9859, device='cuda:0')
distance 2 is tensor(12.9434, device='cuda:0')
compute distance is  tensor(12.9434, device='cuda:0')
compute norm is  tensor(54.5525, device='cuda:0')
distance 1 is tensor(180.3921, device='cuda:0')
distance 2 is tensor(13.3501, device='cuda:0')
compute distance is  tensor(13.3501, device='cuda:0')
compute norm is  tensor(54.8591, device='cuda:0')
distance 1 is tensor(183.5323, device='cuda:0')
distance 2 is tensor(13.5458, device='cuda:0')
compute distance is  tensor(13.5458, device='cuda:0')
compute norm is  tensor(55.0351, device='cuda:0')
distance 1 is tensor(179.9262, device='cuda:0')
distance 2 is tensor(13.3845, device='cuda:0')
compute distance is  tensor(13.3845, device='cuda:0')
compute norm is  tensor(54.7045, device='cuda:0')
distance 1 is tensor(173.4540, device='cuda:0')
distance 2 is tensor(12.9932, device='cuda:0')
compute distance is  tensor(12.9932, device='cuda:0')
compute norm is  tensor(54.7248, device='cuda:0')
distance 1 is tensor(175.0582, device='cuda:0')
distance 2 is tensor(13.0667, device='cuda:0')
compute distance is  tensor(13.0667, device='cuda:0')
compute norm is  tensor(54.8748, device='cuda:0')
distance 1 is tensor(179.6855, device='cuda:0')
distance 2 is tensor(13.3179, device='cuda:0')
compute distance is  tensor(13.3179, device='cuda:0')
compute norm is  tensor(54.7432, device='cuda:0')
distance 1 is tensor(169.7865, device='cuda:0')
distance 2 is tensor(12.5472, device='cuda:0')
compute distance is  tensor(12.5472, device='cuda:0')
compute norm is  tensor(54.4916, device='cuda:0')
distance 1 is tensor(173.9507, device='cuda:0')
distance 2 is tensor(12.9437, device='cuda:0')
compute distance is  tensor(12.9437, device='cuda:0')
compute norm is  tensor(54.7476, device='cuda:0')
distance 1 is tensor(169.4371, device='cuda:0')
distance 2 is tensor(12.5571, device='cuda:0')
compute distance is  tensor(12.5571, device='cuda:0')
compute norm is  tensor(54.6228, device='cuda:0')
distance 1 is tensor(170.3316, device='cuda:0')
distance 2 is tensor(12.5892, device='cuda:0')
compute distance is  tensor(12.5892, device='cuda:0')
compute norm is  tensor(54.6887, device='cuda:0')
distance 1 is tensor(174.9261, device='cuda:0')
distance 2 is tensor(12.8082, device='cuda:0')
compute distance is  tensor(12.8082, device='cuda:0')
compute norm is  tensor(54.6104, device='cuda:0')
distance Threshold  is  tensor(13.5458, device='cuda:0')
distance 1 is tensor(1102102.7500, device='cuda:0')
distance 2 is tensor(79395.6016, device='cuda:0')
________________________________
test distance is  tensor(79395.6016, device='cuda:0')
test similarity is  tensor(-0.1267, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.198119196237354e+17
test entropy is  0.0
________________________________
cal ratio is  0.0117556638770319
distance 1 is tensor(12955.9561, device='cuda:0')
distance 2 is tensor(933.3480, device='cuda:0')
cal_distance is  tensor(933.3480, device='cuda:0')
cal ratio is  0.10842353736404574
distance 1 is tensor(1404.7371, device='cuda:0')
distance 2 is tensor(101.1969, device='cuda:0')
cal_distance is  tensor(101.1969, device='cuda:0')
cal ratio is  0.3292772993194878
distance 1 is tensor(462.5529, device='cuda:0')
distance 2 is tensor(33.3218, device='cuda:0')
cal_distance is  tensor(33.3218, device='cuda:0')
cal ratio is  0.5738268873644129
distance 1 is tensor(265.4284, device='cuda:0')
distance 2 is tensor(19.1210, device='cuda:0')
cal_distance is  tensor(19.1210, device='cuda:0')
cal ratio is  0.7575136578622205
distance 1 is tensor(201.0674, device='cuda:0')
distance 2 is tensor(14.4844, device='cuda:0')
cal_distance is  tensor(14.4844, device='cuda:0')
cal ratio is  0.8703525849019563
distance 1 is tensor(175.0004, device='cuda:0')
distance 2 is tensor(12.6065, device='cuda:0')
cal_distance is  tensor(12.6065, device='cuda:0')
distance 1 is tensor(175.0004, device='cuda:0')
distance 2 is tensor(12.6065, device='cuda:0')
________________________________
test distance is  tensor(12.6065, device='cuda:0')
test similarity is  tensor(0.9319, device='cuda:0')
test acc is  0.8060833334896585
test loss is 105.71042483396876
test entropy is  0.0035609272616466798
________________________________
distance 1 is tensor(175.0004, device='cuda:0')
distance 2 is tensor(12.6065, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0035884593739082854
avg test loss is  105.60222179193232
avg accuracy is  0.8068166668229918
solo acc is  0.11918333348966526
compute similarity  is  tensor(0.9319, device='cuda:0')
compute_distance is  tensor(12.6065, device='cuda:0')
compute_norm is  tensor(55.4940, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(164.7494, device='cuda:0')
distance 2 is tensor(14.0998, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9482331502793441
avg test loss is  1.6483749569351993
avg accuracy is  0.8205833334896578
solo acc is  0.3096166668230063
compute similarity  is  tensor(0.9340, device='cuda:0')
compute_distance is  tensor(14.0998, device='cuda:0')
compute_norm is  tensor(54.0016, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(167.4716, device='cuda:0')
distance 2 is tensor(14.4540, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9016459656041315
avg test loss is  1.700559897463459
avg accuracy is  0.8202666668229912
solo acc is  0.26020000015633854
compute similarity  is  tensor(0.9335, device='cuda:0')
compute_distance is  tensor(14.4540, device='cuda:0')
compute_norm is  tensor(53.6153, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(169.7862, device='cuda:0')
distance 2 is tensor(14.7144, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8990209356808205
avg test loss is  1.641707919680996
avg accuracy is  0.8238500001563243
solo acc is  0.2528666668230049
compute similarity  is  tensor(0.9331, device='cuda:0')
compute_distance is  tensor(14.7144, device='cuda:0')
compute_norm is  tensor(53.2659, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(171.7819, device='cuda:0')
distance 2 is tensor(14.9282, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8894596366104541
avg test loss is  1.6140394101519067
avg accuracy is  0.8268666668229908
solo acc is  0.24720000015633817
compute similarity  is  tensor(0.9328, device='cuda:0')
compute_distance is  tensor(14.9282, device='cuda:0')
compute_norm is  tensor(52.9373, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(173.7500, device='cuda:0')
distance 2 is tensor(15.1230, device='cuda:0')
________________________________
test distance is  tensor(15.1230, device='cuda:0')
test similarity is  tensor(0.9325, device='cuda:0')
test acc is  0.8307000001563241
test loss is 1.5711354943735005
test entropy is  0.8854782120632464
________________________________
cal ratio is  0.8517770976275968
distance 1 is tensor(147.9971, device='cuda:0')
distance 2 is tensor(12.8815, device='cuda:0')
cal_distance is  tensor(12.8815, device='cuda:0')
distance 1 is tensor(147.9971, device='cuda:0')
distance 2 is tensor(12.8815, device='cuda:0')
________________________________
test distance is  tensor(12.8815, device='cuda:0')
test similarity is  tensor(0.9511, device='cuda:0')
test acc is  0.8464166668229901
test loss is 1.0944325139781814
test entropy is  0.9025547877430662
________________________________
distance 1 is tensor(147.9971, device='cuda:0')
distance 2 is tensor(12.8815, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9012163307493938
avg test loss is  1.0990723804243083
avg accuracy is  0.8443333334896569
solo acc is  0.549550000156342
compute similarity  is  tensor(0.9511, device='cuda:0')
compute_distance is  tensor(12.8815, device='cuda:0')
compute_norm is  tensor(52.5585, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.2276, device='cuda:0')
distance 2 is tensor(13.3830, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8696432072979047
avg test loss is  1.5585073355926888
avg accuracy is  0.8392500001563237
solo acc is  0.2575500001563384
compute similarity  is  tensor(0.9499, device='cuda:0')
compute_distance is  tensor(13.3830, device='cuda:0')
compute_norm is  tensor(52.2259, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.7520, device='cuda:0')
distance 2 is tensor(13.6143, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8746133517227701
avg test loss is  1.5143102369328807
avg accuracy is  0.8406333334896571
solo acc is  0.2584500001563385
compute similarity  is  tensor(0.9495, device='cuda:0')
compute_distance is  tensor(13.6143, device='cuda:0')
compute_norm is  tensor(51.9159, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.0442, device='cuda:0')
distance 2 is tensor(13.8204, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8657583922211295
avg test loss is  1.4968895506757154
avg accuracy is  0.8431166668229902
solo acc is  0.2551000001563384
compute similarity  is  tensor(0.9492, device='cuda:0')
compute_distance is  tensor(13.8204, device='cuda:0')
compute_norm is  tensor(51.6161, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.1993, device='cuda:0')
distance 2 is tensor(14.0108, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8613672604693025
avg test loss is  1.4747476384583822
avg accuracy is  0.8451000001563236
solo acc is  0.25501666682300506
compute similarity  is  tensor(0.9489, device='cuda:0')
compute_distance is  tensor(14.0108, device='cuda:0')
compute_norm is  tensor(51.3231, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(161.2564, device='cuda:0')
distance 2 is tensor(14.1904, device='cuda:0')
________________________________
test distance is  tensor(14.1904, device='cuda:0')
test similarity is  tensor(0.9486, device='cuda:0')
test acc is  0.8474333334896568
test loss is 1.4611849803914394
test entropy is  0.859720456828949
________________________________
cal ratio is  0.8793220116484992
distance 1 is tensor(141.7970, device='cuda:0')
distance 2 is tensor(12.4779, device='cuda:0')
cal_distance is  tensor(12.4779, device='cuda:0')
distance 1 is tensor(141.7970, device='cuda:0')
distance 2 is tensor(12.4779, device='cuda:0')
________________________________
test distance is  tensor(12.4779, device='cuda:0')
test similarity is  tensor(0.9606, device='cuda:0')
test acc is  0.8567833334896564
test loss is 1.0445045474241537
test entropy is  0.8929232744011544
________________________________
distance 1 is tensor(141.7970, device='cuda:0')
distance 2 is tensor(12.4779, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8897529203754498
avg test loss is  1.0390298604202677
avg accuracy is  0.8559166668229897
solo acc is  0.5509000001563419
compute similarity  is  tensor(0.9606, device='cuda:0')
compute_distance is  tensor(12.4779, device='cuda:0')
compute_norm is  tensor(51.2274, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.6342, device='cuda:0')
distance 2 is tensor(12.9090, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8455175677342202
avg test loss is  1.4382279869844157
avg accuracy is  0.8520833334896566
solo acc is  0.2675333334896721
compute similarity  is  tensor(0.9596, device='cuda:0')
compute_distance is  tensor(12.9090, device='cuda:0')
compute_norm is  tensor(50.9305, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.2389, device='cuda:0')
distance 2 is tensor(13.1331, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8492499296344928
avg test loss is  1.4269039935903
avg accuracy is  0.8528833334896565
solo acc is  0.26065000015633855
compute similarity  is  tensor(0.9591, device='cuda:0')
compute_distance is  tensor(13.1331, device='cuda:0')
compute_norm is  tensor(50.6464, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.5246, device='cuda:0')
distance 2 is tensor(13.3265, device='cuda:0')
exit early
distance 1 is tensor(150.5246, device='cuda:0')
distance 2 is tensor(13.3265, device='cuda:0')
________________________________
test distance is  tensor(13.3265, device='cuda:0')
test similarity is  tensor(0.9588, device='cuda:0')
test acc is  0.8550500001563233
test loss is 1.4314814614080418
test entropy is  0.8365956609691384
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.196498990058899
mal norm is  tensor(6.7426, device='cuda:0')
distance 1 is tensor(150.5246, device='cuda:0')
distance 2 is tensor(13.3265, device='cuda:0')
mal distance is  tensor(13.3265, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1172, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.6960, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.2567e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.9670, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.6975e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(427.4751, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.9565e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.4343, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.9988, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6555e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.8055, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.8573e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.5420, device='cuda:0')
c is  tensor(0.0131, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.8422, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.5641e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2560, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7691e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(795.6388, device='cuda:0')
c is  tensor(0.0121, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.8106e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(803.5613, device='cuda:0')
c is  tensor(0.0121, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.1240e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.9088, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.4999e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.1375, device='cuda:0')
c is  tensor(0.0120, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.9390e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.9239, device='cuda:0')
c is  tensor(0.0119, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(795.7960, device='cuda:0')
c is  tensor(0.0121, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.9709e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(798.2151, device='cuda:0')
c is  tensor(0.0121, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.0173e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(812.0161, device='cuda:0')
c is  tensor(0.0120, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.5773e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(760.9448, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.8401e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.2101, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.7926e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(724.8278, device='cuda:0')
c is  tensor(0.0127, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(779.7841, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.3502, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.8053e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.8045, device='cuda:0')
c is  tensor(0.0127, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.8032e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.8486, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.8382e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.4856, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 17
len all weights is 17
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 87.76% 

Test Accuracy: 86.32% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2509309649467468
distance 1 is tensor(149.6120, device='cuda:0')
distance 2 is tensor(11.2484, device='cuda:0')
benign distance is  tensor(11.2484, device='cuda:0')
norm1 res is  tensor(0.1596, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.1390289068222046
distance 1 is tensor(174.1839, device='cuda:0')
distance 2 is tensor(13.0290, device='cuda:0')
benign distance is  tensor(13.0290, device='cuda:0')
norm1 res is  tensor(0.1823, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.11088047176599503
distance 1 is tensor(137.1621, device='cuda:0')
distance 2 is tensor(10.2830, device='cuda:0')
benign distance is  tensor(10.2830, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6806124448776245
distance 1 is tensor(155.9941, device='cuda:0')
distance 2 is tensor(11.8641, device='cuda:0')
benign distance is  tensor(11.8641, device='cuda:0')
norm1 res is  tensor(0.1694, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5605407953262329
distance 1 is tensor(145.3679, device='cuda:0')
distance 2 is tensor(10.9604, device='cuda:0')
benign distance is  tensor(10.9604, device='cuda:0')
norm1 res is  tensor(0.1529, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.2657634019851685
distance 1 is tensor(157.8016, device='cuda:0')
distance 2 is tensor(11.7932, device='cuda:0')
benign distance is  tensor(11.7932, device='cuda:0')
norm1 res is  tensor(0.1679, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.20065411925315857
distance 1 is tensor(153.7999, device='cuda:0')
distance 2 is tensor(11.3796, device='cuda:0')
benign distance is  tensor(11.3796, device='cuda:0')
norm1 res is  tensor(0.1606, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2135220319032669
distance 1 is tensor(170.4332, device='cuda:0')
distance 2 is tensor(12.8219, device='cuda:0')
benign distance is  tensor(12.8219, device='cuda:0')
norm1 res is  tensor(0.1818, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.6198190450668335
distance 1 is tensor(152.0579, device='cuda:0')
distance 2 is tensor(11.4271, device='cuda:0')
benign distance is  tensor(11.4271, device='cuda:0')
norm1 res is  tensor(0.1626, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.39303091168403625
distance 1 is tensor(172.5797, device='cuda:0')
distance 2 is tensor(12.7880, device='cuda:0')
benign distance is  tensor(12.7880, device='cuda:0')
norm1 res is  tensor(0.1815, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.7577415704727173
distance 1 is tensor(160.3381, device='cuda:0')
distance 2 is tensor(11.8917, device='cuda:0')
benign distance is  tensor(11.8917, device='cuda:0')
norm1 res is  tensor(0.1671, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.7759087085723877
distance 1 is tensor(158.6287, device='cuda:0')
distance 2 is tensor(11.9110, device='cuda:0')
benign distance is  tensor(11.9110, device='cuda:0')
norm1 res is  tensor(0.1687, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.283667653799057
distance 1 is tensor(151.9400, device='cuda:0')
distance 2 is tensor(11.5097, device='cuda:0')
benign distance is  tensor(11.5097, device='cuda:0')
norm1 res is  tensor(0.1599, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.3486747443675995
distance 1 is tensor(158.2935, device='cuda:0')
distance 2 is tensor(11.8176, device='cuda:0')
benign distance is  tensor(11.8176, device='cuda:0')
norm1 res is  tensor(0.1678, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.23420186340808868
distance 1 is tensor(156.1911, device='cuda:0')
distance 2 is tensor(11.8282, device='cuda:0')
benign distance is  tensor(11.8282, device='cuda:0')
norm1 res is  tensor(0.1679, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.927959144115448
distance 1 is tensor(169.1901, device='cuda:0')
distance 2 is tensor(12.6348, device='cuda:0')
benign distance is  tensor(12.6348, device='cuda:0')
norm1 res is  tensor(0.1816, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.18027237057685852
distance 1 is tensor(152.4487, device='cuda:0')
distance 2 is tensor(11.4525, device='cuda:0')
benign distance is  tensor(11.4525, device='cuda:0')
norm1 res is  tensor(0.1635, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6439074873924255
distance 1 is tensor(164.1592, device='cuda:0')
distance 2 is tensor(12.2725, device='cuda:0')
benign distance is  tensor(12.2725, device='cuda:0')
norm1 res is  tensor(0.1690, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.31623998284339905
distance 1 is tensor(168.2207, device='cuda:0')
distance 2 is tensor(12.9439, device='cuda:0')
benign distance is  tensor(12.9439, device='cuda:0')
norm1 res is  tensor(0.1775, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.0979392528533936
distance 1 is tensor(165.1732, device='cuda:0')
distance 2 is tensor(12.4561, device='cuda:0')
benign distance is  tensor(12.4561, device='cuda:0')
norm1 res is  tensor(0.1705, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.3105829954147339
distance 1 is tensor(164.7462, device='cuda:0')
distance 2 is tensor(12.1662, device='cuda:0')
benign distance is  tensor(12.1662, device='cuda:0')
norm1 res is  tensor(0.1714, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.2508409321308136
distance 1 is tensor(164.7526, device='cuda:0')
distance 2 is tensor(12.4673, device='cuda:0')
benign distance is  tensor(12.4673, device='cuda:0')
norm1 res is  tensor(0.1738, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.2850671410560608
distance 1 is tensor(166.8290, device='cuda:0')
distance 2 is tensor(12.6657, device='cuda:0')
benign distance is  tensor(12.6657, device='cuda:0')
norm1 res is  tensor(0.1790, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.47364553809165955
distance 1 is tensor(161.8013, device='cuda:0')
distance 2 is tensor(12.2850, device='cuda:0')
benign distance is  tensor(12.2850, device='cuda:0')
norm1 res is  tensor(0.1732, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(177.0421, device='cuda:0')
distance 2 is tensor(13.8572, device='cuda:0')
compute distance is  tensor(13.8572, device='cuda:0')
compute norm is  tensor(54.7612, device='cuda:0')
distance 1 is tensor(186.8490, device='cuda:0')
distance 2 is tensor(14.3682, device='cuda:0')
compute distance is  tensor(14.3682, device='cuda:0')
compute norm is  tensor(54.9913, device='cuda:0')
distance 1 is tensor(195.4960, device='cuda:0')
distance 2 is tensor(15.1041, device='cuda:0')
compute distance is  tensor(15.1041, device='cuda:0')
compute norm is  tensor(55.3300, device='cuda:0')
distance 1 is tensor(181.2162, device='cuda:0')
distance 2 is tensor(14.0237, device='cuda:0')
compute distance is  tensor(14.0237, device='cuda:0')
compute norm is  tensor(54.8569, device='cuda:0')
distance 1 is tensor(190.4902, device='cuda:0')
distance 2 is tensor(14.8530, device='cuda:0')
compute distance is  tensor(14.8530, device='cuda:0')
compute norm is  tensor(55.2840, device='cuda:0')
distance 1 is tensor(182.8643, device='cuda:0')
distance 2 is tensor(14.2003, device='cuda:0')
compute distance is  tensor(14.2003, device='cuda:0')
compute norm is  tensor(55.1130, device='cuda:0')
distance 1 is tensor(183.3944, device='cuda:0')
distance 2 is tensor(14.0725, device='cuda:0')
compute distance is  tensor(14.0725, device='cuda:0')
compute norm is  tensor(54.9433, device='cuda:0')
distance 1 is tensor(179.6647, device='cuda:0')
distance 2 is tensor(13.9156, device='cuda:0')
compute distance is  tensor(13.9156, device='cuda:0')
compute norm is  tensor(54.7834, device='cuda:0')
distance 1 is tensor(180.9701, device='cuda:0')
distance 2 is tensor(14.0189, device='cuda:0')
compute distance is  tensor(14.0189, device='cuda:0')
compute norm is  tensor(54.9836, device='cuda:0')
distance 1 is tensor(180.7968, device='cuda:0')
distance 2 is tensor(13.9777, device='cuda:0')
compute distance is  tensor(13.9777, device='cuda:0')
compute norm is  tensor(54.8963, device='cuda:0')
distance 1 is tensor(177.5699, device='cuda:0')
distance 2 is tensor(13.7888, device='cuda:0')
compute distance is  tensor(13.7888, device='cuda:0')
compute norm is  tensor(54.9683, device='cuda:0')
distance 1 is tensor(173.3635, device='cuda:0')
distance 2 is tensor(13.5843, device='cuda:0')
compute distance is  tensor(13.5843, device='cuda:0')
compute norm is  tensor(54.6818, device='cuda:0')
distance Threshold  is  tensor(15.1041, device='cuda:0')
distance 1 is tensor(1102054.7500, device='cuda:0')
distance 2 is tensor(79391.3984, device='cuda:0')
________________________________
test distance is  tensor(79391.3984, device='cuda:0')
test similarity is  tensor(0.0052, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.203800830996759e+17
test entropy is  0.0
________________________________
cal ratio is  0.012413738021577123
distance 1 is tensor(13680.6260, device='cuda:0')
distance 2 is tensor(985.5441, device='cuda:0')
cal_distance is  tensor(985.5441, device='cuda:0')
cal ratio is  0.11141695105445615
distance 1 is tensor(1524.2601, device='cuda:0')
distance 2 is tensor(109.8063, device='cuda:0')
cal_distance is  tensor(109.8063, device='cuda:0')
cal ratio is  0.3337917696071287
distance 1 is tensor(508.7903, device='cuda:0')
distance 2 is tensor(36.6524, device='cuda:0')
cal_distance is  tensor(36.6524, device='cuda:0')
cal ratio is  0.5777471699564878
distance 1 is tensor(293.9552, device='cuda:0')
distance 2 is tensor(21.1758, device='cuda:0')
cal_distance is  tensor(21.1758, device='cuda:0')
cal ratio is  0.760096810929005
distance 1 is tensor(223.4361, device='cuda:0')
distance 2 is tensor(16.0957, device='cuda:0')
cal_distance is  tensor(16.0957, device='cuda:0')
cal ratio is  0.8718353231692725
distance 1 is tensor(194.8004, device='cuda:0')
distance 2 is tensor(14.0328, device='cuda:0')
cal_distance is  tensor(14.0328, device='cuda:0')
distance 1 is tensor(194.8004, device='cuda:0')
distance 2 is tensor(14.0328, device='cuda:0')
________________________________
test distance is  tensor(14.0328, device='cuda:0')
test similarity is  tensor(0.9152, device='cuda:0')
test acc is  0.11483333348966528
test loss is 275.27919809955523
test entropy is  1.1326588263908595e-33
________________________________
distance 1 is tensor(194.8004, device='cuda:0')
distance 2 is tensor(14.0328, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  3.6206126909638897e-34
avg test loss is  275.339633900982
avg accuracy is  0.11496666682299861
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9152, device='cuda:0')
compute_distance is  tensor(14.0328, device='cuda:0')
compute_norm is  tensor(54.8741, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(172.6544, device='cuda:0')
distance 2 is tensor(14.2732, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9661877546101999
avg test loss is  1.5699235117003354
avg accuracy is  0.6310833334896684
solo acc is  0.29613333348967275
compute similarity  is  tensor(0.9196, device='cuda:0')
compute_distance is  tensor(14.2732, device='cuda:0')
compute_norm is  tensor(54.0370, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(172.6544, device='cuda:0')
distance 2 is tensor(14.2732, device='cuda:0')
________________________________
test distance is  tensor(14.2732, device='cuda:0')
test similarity is  tensor(0.9196, device='cuda:0')
test acc is  0.6288833334896686
test loss is 1.5694809158219458
test entropy is  0.9670749235509047
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3522310256958008
mal norm is  tensor(9.4250, device='cuda:0')
distance 1 is tensor(172.6544, device='cuda:0')
distance 2 is tensor(14.2732, device='cuda:0')
mal distance is  tensor(14.2732, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1688, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.2429, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.5035, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.3749, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0541, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.8080, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3723, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.4478, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.2309, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(942.5010, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(799.0420, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.5352, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.1657, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(789.9315, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(761.2327, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.9432, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(798.3196, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(763.8497, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 91.05% 

Test Accuracy: 88.95% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
 benign loss is  0.25045230984687805
distance 1 is tensor(122.1799, device='cuda:0')
distance 2 is tensor(9.2479, device='cuda:0')
benign distance is  tensor(9.2479, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.05254978686571121
distance 1 is tensor(120.3318, device='cuda:0')
distance 2 is tensor(9.0035, device='cuda:0')
benign distance is  tensor(9.0035, device='cuda:0')
norm1 res is  tensor(0.1357, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.09370756894350052
distance 1 is tensor(89.3800, device='cuda:0')
distance 2 is tensor(6.7479, device='cuda:0')
benign distance is  tensor(6.7479, device='cuda:0')
norm1 res is  tensor(0.0992, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.24726831912994385
distance 1 is tensor(126.3363, device='cuda:0')
distance 2 is tensor(9.3248, device='cuda:0')
benign distance is  tensor(9.3248, device='cuda:0')
norm1 res is  tensor(0.1408, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.39732080698013306
distance 1 is tensor(118.2623, device='cuda:0')
distance 2 is tensor(8.5818, device='cuda:0')
benign distance is  tensor(8.5818, device='cuda:0')
norm1 res is  tensor(0.1279, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.3371191620826721
distance 1 is tensor(136.8465, device='cuda:0')
distance 2 is tensor(10.0133, device='cuda:0')
benign distance is  tensor(10.0133, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.24094721674919128
distance 1 is tensor(116.7408, device='cuda:0')
distance 2 is tensor(8.4973, device='cuda:0')
benign distance is  tensor(8.4973, device='cuda:0')
norm1 res is  tensor(0.1274, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.12763050198554993
distance 1 is tensor(128.3441, device='cuda:0')
distance 2 is tensor(9.5473, device='cuda:0')
benign distance is  tensor(9.5473, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.09083906561136246
distance 1 is tensor(134.9052, device='cuda:0')
distance 2 is tensor(10.0201, device='cuda:0')
benign distance is  tensor(10.0201, device='cuda:0')
norm1 res is  tensor(0.1504, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.5068526268005371
distance 1 is tensor(137.6153, device='cuda:0')
distance 2 is tensor(10.0715, device='cuda:0')
benign distance is  tensor(10.0715, device='cuda:0')
norm1 res is  tensor(0.1517, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.14049412310123444
distance 1 is tensor(136.7069, device='cuda:0')
distance 2 is tensor(10.2197, device='cuda:0')
benign distance is  tensor(10.2197, device='cuda:0')
norm1 res is  tensor(0.1518, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.08445297181606293
distance 1 is tensor(141.5584, device='cuda:0')
distance 2 is tensor(10.3510, device='cuda:0')
benign distance is  tensor(10.3510, device='cuda:0')
norm1 res is  tensor(0.1567, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.7933193445205688
distance 1 is tensor(132.7805, device='cuda:0')
distance 2 is tensor(9.7276, device='cuda:0')
benign distance is  tensor(9.7276, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.49105820059776306
distance 1 is tensor(137.9732, device='cuda:0')
distance 2 is tensor(10.1077, device='cuda:0')
benign distance is  tensor(10.1077, device='cuda:0')
norm1 res is  tensor(0.1516, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.3980702757835388
distance 1 is tensor(131.6709, device='cuda:0')
distance 2 is tensor(9.8089, device='cuda:0')
benign distance is  tensor(9.8089, device='cuda:0')
norm1 res is  tensor(0.1488, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.2103666365146637
distance 1 is tensor(140.0298, device='cuda:0')
distance 2 is tensor(10.2134, device='cuda:0')
benign distance is  tensor(10.2134, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(154.6571, device='cuda:0')
distance 2 is tensor(11.6269, device='cuda:0')
compute distance is  tensor(11.6269, device='cuda:0')
compute norm is  tensor(54.9434, device='cuda:0')
distance 1 is tensor(148.0368, device='cuda:0')
distance 2 is tensor(11.4368, device='cuda:0')
compute distance is  tensor(11.4368, device='cuda:0')
compute norm is  tensor(54.9985, device='cuda:0')
distance 1 is tensor(164.0919, device='cuda:0')
distance 2 is tensor(12.4703, device='cuda:0')
compute distance is  tensor(12.4703, device='cuda:0')
compute norm is  tensor(55.4756, device='cuda:0')
distance 1 is tensor(157.8143, device='cuda:0')
distance 2 is tensor(11.8094, device='cuda:0')
compute distance is  tensor(11.8094, device='cuda:0')
compute norm is  tensor(55.1473, device='cuda:0')
distance 1 is tensor(170.4408, device='cuda:0')
distance 2 is tensor(12.9994, device='cuda:0')
compute distance is  tensor(12.9994, device='cuda:0')
compute norm is  tensor(55.5885, device='cuda:0')
distance 1 is tensor(167.1129, device='cuda:0')
distance 2 is tensor(12.6420, device='cuda:0')
compute distance is  tensor(12.6420, device='cuda:0')
compute norm is  tensor(55.5756, device='cuda:0')
distance 1 is tensor(163.2063, device='cuda:0')
distance 2 is tensor(12.1514, device='cuda:0')
compute distance is  tensor(12.1514, device='cuda:0')
compute norm is  tensor(55.2977, device='cuda:0')
distance 1 is tensor(154.1080, device='cuda:0')
distance 2 is tensor(11.7610, device='cuda:0')
compute distance is  tensor(11.7610, device='cuda:0')
compute norm is  tensor(55.0886, device='cuda:0')
distance 1 is tensor(161.3092, device='cuda:0')
distance 2 is tensor(12.1632, device='cuda:0')
compute distance is  tensor(12.1632, device='cuda:0')
compute norm is  tensor(55.2422, device='cuda:0')
distance 1 is tensor(150.7651, device='cuda:0')
distance 2 is tensor(11.4811, device='cuda:0')
compute distance is  tensor(11.4811, device='cuda:0')
compute norm is  tensor(54.9623, device='cuda:0')
distance 1 is tensor(162.6852, device='cuda:0')
distance 2 is tensor(12.1997, device='cuda:0')
compute distance is  tensor(12.1997, device='cuda:0')
compute norm is  tensor(55.4140, device='cuda:0')
distance 1 is tensor(155.8682, device='cuda:0')
distance 2 is tensor(11.7853, device='cuda:0')
compute distance is  tensor(11.7853, device='cuda:0')
compute norm is  tensor(55.0646, device='cuda:0')
distance Threshold  is  tensor(12.9994, device='cuda:0')
distance 1 is tensor(1102079.2500, device='cuda:0')
distance 2 is tensor(79393.8203, device='cuda:0')
________________________________
test distance is  tensor(79393.8203, device='cuda:0')
test similarity is  tensor(-0.0653, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197397509860562e+17
test entropy is  0.0
________________________________
cal ratio is  0.011516246323557994
distance 1 is tensor(12691.8223, device='cuda:0')
distance 2 is tensor(914.3188, device='cuda:0')
cal_distance is  tensor(914.3188, device='cuda:0')
cal ratio is  0.1073137718197802
distance 1 is tensor(1362.0139, device='cuda:0')
distance 2 is tensor(98.1190, device='cuda:0')
cal_distance is  tensor(98.1190, device='cuda:0')
cal ratio is  0.327587785321371
distance 1 is tensor(446.1839, device='cuda:0')
distance 2 is tensor(32.1426, device='cuda:0')
cal_distance is  tensor(32.1426, device='cuda:0')
cal ratio is  0.5723528585248107
distance 1 is tensor(255.3777, device='cuda:0')
distance 2 is tensor(18.3969, device='cuda:0')
cal_distance is  tensor(18.3969, device='cuda:0')
cal ratio is  0.7565400930723996
distance 1 is tensor(193.2053, device='cuda:0')
distance 2 is tensor(13.9180, device='cuda:0')
cal_distance is  tensor(13.9180, device='cuda:0')
cal ratio is  0.8697930859460882
distance 1 is tensor(168.0496, device='cuda:0')
distance 2 is tensor(12.1058, device='cuda:0')
cal_distance is  tensor(12.1058, device='cuda:0')
distance 1 is tensor(168.0496, device='cuda:0')
distance 2 is tensor(12.1058, device='cuda:0')
________________________________
test distance is  tensor(12.1058, device='cuda:0')
test similarity is  tensor(0.9333, device='cuda:0')
test acc is  0.7917500001563258
test loss is 100.70253801650838
test entropy is  0.0006643891862099186
________________________________
distance 1 is tensor(168.0496, device='cuda:0')
distance 2 is tensor(12.1058, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.000701726185383446
avg test loss is  100.49535555321016
avg accuracy is  0.7898833334896592
solo acc is  0.10181666682299864
compute similarity  is  tensor(0.9333, device='cuda:0')
compute_distance is  tensor(12.1058, device='cuda:0')
compute_norm is  tensor(53.9987, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(155.5025, device='cuda:0')
distance 2 is tensor(13.0931, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9526240762744123
avg test loss is  1.5155031655643032
avg accuracy is  0.8237500001563243
solo acc is  0.3214333334896733
compute similarity  is  tensor(0.9354, device='cuda:0')
compute_distance is  tensor(13.0931, device='cuda:0')
compute_norm is  tensor(52.9323, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.9788, device='cuda:0')
distance 2 is tensor(13.3559, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9022164980867016
avg test loss is  1.5877363395843425
avg accuracy is  0.8229000001563244
solo acc is  0.2642166668230054
compute similarity  is  tensor(0.9353, device='cuda:0')
compute_distance is  tensor(13.3559, device='cuda:0')
compute_norm is  tensor(52.5877, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.2682, device='cuda:0')
distance 2 is tensor(13.5507, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8954439973399075
avg test loss is  1.5670498884054644
avg accuracy is  0.8237666668229909
solo acc is  0.2513833334896716
compute similarity  is  tensor(0.9351, device='cuda:0')
compute_distance is  tensor(13.5507, device='cuda:0')
compute_norm is  tensor(52.2688, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.6059, device='cuda:0')
distance 2 is tensor(13.7237, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8824565841445028
avg test loss is  1.5484426232543327
avg accuracy is  0.8262000001563242
solo acc is  0.2475000001563382
compute similarity  is  tensor(0.9350, device='cuda:0')
compute_distance is  tensor(13.7237, device='cuda:0')
compute_norm is  tensor(51.9649, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(160.8864, device='cuda:0')
distance 2 is tensor(13.8729, device='cuda:0')
________________________________
test distance is  tensor(13.8729, device='cuda:0')
test similarity is  tensor(0.9349, device='cuda:0')
test acc is  0.8277500001563242
test loss is 1.5136991886696074
test entropy is  0.8760453165848372
________________________________
cal ratio is  0.8712060392391123
distance 1 is tensor(140.1660, device='cuda:0')
distance 2 is tensor(12.0861, device='cuda:0')
cal_distance is  tensor(12.0861, device='cuda:0')
distance 1 is tensor(140.1660, device='cuda:0')
distance 2 is tensor(12.0861, device='cuda:0')
________________________________
test distance is  tensor(12.0861, device='cuda:0')
test similarity is  tensor(0.9502, device='cuda:0')
test acc is  0.8444833334896568
test loss is 1.1247819038723577
test entropy is  0.9607820643036604
________________________________
distance 1 is tensor(140.1660, device='cuda:0')
distance 2 is tensor(12.0861, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9610227889724886
avg test loss is  1.1304742269424488
avg accuracy is  0.8453666668229901
solo acc is  0.485250000156342
compute similarity  is  tensor(0.9502, device='cuda:0')
compute_distance is  tensor(12.0861, device='cuda:0')
compute_norm is  tensor(51.4774, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.7229, device='cuda:0')
distance 2 is tensor(12.4142, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8593515588530599
avg test loss is  1.5025316615348685
avg accuracy is  0.8392166668229903
solo acc is  0.2506666668230049
compute similarity  is  tensor(0.9496, device='cuda:0')
compute_distance is  tensor(12.4142, device='cuda:0')
compute_norm is  tensor(51.1821, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.5578, device='cuda:0')
distance 2 is tensor(12.5942, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8669216468263028
avg test loss is  1.46460630352309
avg accuracy is  0.8408000001563237
solo acc is  0.2563333334896718
compute similarity  is  tensor(0.9494, device='cuda:0')
compute_distance is  tensor(12.5942, device='cuda:0')
compute_norm is  tensor(50.8970, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.2396, device='cuda:0')
distance 2 is tensor(12.7494, device='cuda:0')
exit early
distance 1 is tensor(146.2396, device='cuda:0')
distance 2 is tensor(12.7494, device='cuda:0')
________________________________
test distance is  tensor(12.7494, device='cuda:0')
test similarity is  tensor(0.9493, device='cuda:0')
test acc is  0.8421833334896569
test loss is 1.4556475539705647
test entropy is  0.8556184895765553
________________________________
distance 1 is tensor(146.2396, device='cuda:0')
distance 2 is tensor(12.7494, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8553890991312608
avg test loss is  1.4571715336618647
avg accuracy is  0.8423333334896569
solo acc is  0.2542666668230051
compute similarity  is  tensor(0.9493, device='cuda:0')
compute_distance is  tensor(12.7494, device='cuda:0')
compute_norm is  tensor(50.6206, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.9147, device='cuda:0')
distance 2 is tensor(12.8966, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8527914562077918
avg test loss is  1.437460410188256
avg accuracy is  0.84606666682299
solo acc is  0.25290000015633834
compute similarity  is  tensor(0.9491, device='cuda:0')
compute_distance is  tensor(12.8966, device='cuda:0')
compute_norm is  tensor(50.3491, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.5363, device='cuda:0')
distance 2 is tensor(13.0379, device='cuda:0')
exit early
distance 1 is tensor(149.5363, device='cuda:0')
distance 2 is tensor(13.0379, device='cuda:0')
________________________________
test distance is  tensor(13.0379, device='cuda:0')
test similarity is  tensor(0.9489, device='cuda:0')
test acc is  0.8478166668229901
test loss is 1.4313141922198378
test entropy is  0.849670080932727
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4082800149917603
mal norm is  tensor(7.1208, device='cuda:0')
distance 1 is tensor(149.5363, device='cuda:0')
distance 2 is tensor(13.0379, device='cuda:0')
mal distance is  tensor(13.0379, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2596, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.2374, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.1408, device='cuda:0')
c is  tensor(0.0220, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(388.3257, device='cuda:0')
c is  tensor(0.0259, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6139e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.4667, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.6273, device='cuda:0')
c is  tensor(0.0226, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.0358, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.2988, device='cuda:0')
c is  tensor(0.0227, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.6538, device='cuda:0')
c is  tensor(0.0214, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0793, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.6438, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.0233, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.1434, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.9773, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.1163, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.1103e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.7657, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.5863, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.9268e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7483, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.9553, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.0285, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1996, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.4819, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.6827, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.9900, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.9248e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.6539, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(724.1376, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:0')
len accept list 13
len all weights is 13
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 91.33% 

Test Accuracy: 89.08% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
 benign loss is  0.38659554719924927
distance 1 is tensor(120.0159, device='cuda:0')
distance 2 is tensor(8.9590, device='cuda:0')
benign distance is  tensor(8.9590, device='cuda:0')
norm1 res is  tensor(0.1360, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.20253176987171173
distance 1 is tensor(125.4679, device='cuda:0')
distance 2 is tensor(9.2881, device='cuda:0')
benign distance is  tensor(9.2881, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.028078895062208176
distance 1 is tensor(101.7852, device='cuda:0')
distance 2 is tensor(7.5905, device='cuda:0')
benign distance is  tensor(7.5905, device='cuda:0')
norm1 res is  tensor(0.1132, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.26042240858078003
distance 1 is tensor(117.9947, device='cuda:0')
distance 2 is tensor(8.8414, device='cuda:0')
benign distance is  tensor(8.8414, device='cuda:0')
norm1 res is  tensor(0.1349, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5369848012924194
distance 1 is tensor(109.7855, device='cuda:0')
distance 2 is tensor(8.0438, device='cuda:0')
benign distance is  tensor(8.0438, device='cuda:0')
norm1 res is  tensor(0.1223, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.32685503363609314
distance 1 is tensor(141.4180, device='cuda:0')
distance 2 is tensor(10.5241, device='cuda:0')
benign distance is  tensor(10.5241, device='cuda:0')
norm1 res is  tensor(0.1612, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.11012129485607147
distance 1 is tensor(112.2409, device='cuda:0')
distance 2 is tensor(8.3210, device='cuda:0')
benign distance is  tensor(8.3210, device='cuda:0')
norm1 res is  tensor(0.1260, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.21526458859443665
distance 1 is tensor(125.4249, device='cuda:0')
distance 2 is tensor(9.3159, device='cuda:0')
benign distance is  tensor(9.3159, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.1943453848361969
distance 1 is tensor(130.6908, device='cuda:0')
distance 2 is tensor(9.6869, device='cuda:0')
benign distance is  tensor(9.6869, device='cuda:0')
norm1 res is  tensor(0.1500, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.5607192516326904
distance 1 is tensor(132.3054, device='cuda:0')
distance 2 is tensor(9.7040, device='cuda:0')
benign distance is  tensor(9.7040, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.7256638407707214
distance 1 is tensor(120.6053, device='cuda:0')
distance 2 is tensor(9.0161, device='cuda:0')
benign distance is  tensor(9.0161, device='cuda:0')
norm1 res is  tensor(0.1382, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5365071296691895
distance 1 is tensor(123.0920, device='cuda:0')
distance 2 is tensor(9.2406, device='cuda:0')
benign distance is  tensor(9.2406, device='cuda:0')
norm1 res is  tensor(0.1392, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.27787846326828003
distance 1 is tensor(129.4824, device='cuda:0')
distance 2 is tensor(9.7560, device='cuda:0')
benign distance is  tensor(9.7560, device='cuda:0')
norm1 res is  tensor(0.1477, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.28326278924942017
distance 1 is tensor(113.9566, device='cuda:0')
distance 2 is tensor(8.6206, device='cuda:0')
benign distance is  tensor(8.6206, device='cuda:0')
norm1 res is  tensor(0.1322, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.501470685005188
distance 1 is tensor(123.9005, device='cuda:0')
distance 2 is tensor(9.3181, device='cuda:0')
benign distance is  tensor(9.3181, device='cuda:0')
norm1 res is  tensor(0.1406, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.2849491536617279
distance 1 is tensor(139.7278, device='cuda:0')
distance 2 is tensor(10.4103, device='cuda:0')
benign distance is  tensor(10.4103, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.24963080883026123
distance 1 is tensor(123.8773, device='cuda:0')
distance 2 is tensor(9.3110, device='cuda:0')
benign distance is  tensor(9.3110, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.13004055619239807
distance 1 is tensor(132.8662, device='cuda:0')
distance 2 is tensor(9.8761, device='cuda:0')
benign distance is  tensor(9.8761, device='cuda:0')
norm1 res is  tensor(0.1504, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.36343032121658325
distance 1 is tensor(139.8671, device='cuda:0')
distance 2 is tensor(10.4985, device='cuda:0')
benign distance is  tensor(10.4985, device='cuda:0')
norm1 res is  tensor(0.1581, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.5605829954147339
distance 1 is tensor(114.4663, device='cuda:0')
distance 2 is tensor(8.5647, device='cuda:0')
benign distance is  tensor(8.5647, device='cuda:0')
norm1 res is  tensor(0.1318, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.1989293098449707
distance 1 is tensor(126.6694, device='cuda:0')
distance 2 is tensor(9.4490, device='cuda:0')
benign distance is  tensor(9.4490, device='cuda:0')
norm1 res is  tensor(0.1439, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.2507515549659729
distance 1 is tensor(121.5037, device='cuda:0')
distance 2 is tensor(9.1397, device='cuda:0')
benign distance is  tensor(9.1397, device='cuda:0')
norm1 res is  tensor(0.1373, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.6568865776062012
distance 1 is tensor(120.6580, device='cuda:0')
distance 2 is tensor(9.0501, device='cuda:0')
benign distance is  tensor(9.0501, device='cuda:0')
norm1 res is  tensor(0.1367, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.14164386689662933
distance 1 is tensor(119.8931, device='cuda:0')
distance 2 is tensor(8.9787, device='cuda:0')
benign distance is  tensor(8.9787, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(138.7077, device='cuda:0')
distance 2 is tensor(10.3465, device='cuda:0')
compute distance is  tensor(10.3465, device='cuda:0')
compute norm is  tensor(54.7645, device='cuda:0')
distance 1 is tensor(145.5209, device='cuda:0')
distance 2 is tensor(10.9773, device='cuda:0')
compute distance is  tensor(10.9773, device='cuda:0')
compute norm is  tensor(55.0799, device='cuda:0')
distance 1 is tensor(161.9438, device='cuda:0')
distance 2 is tensor(12.2096, device='cuda:0')
compute distance is  tensor(12.2096, device='cuda:0')
compute norm is  tensor(55.3730, device='cuda:0')
distance 1 is tensor(152.3211, device='cuda:0')
distance 2 is tensor(11.3675, device='cuda:0')
compute distance is  tensor(11.3675, device='cuda:0')
compute norm is  tensor(55.0467, device='cuda:0')
distance 1 is tensor(150.3730, device='cuda:0')
distance 2 is tensor(11.4639, device='cuda:0')
compute distance is  tensor(11.4639, device='cuda:0')
compute norm is  tensor(55.2400, device='cuda:0')
distance 1 is tensor(150.7705, device='cuda:0')
distance 2 is tensor(11.3746, device='cuda:0')
compute distance is  tensor(11.3746, device='cuda:0')
compute norm is  tensor(55.2459, device='cuda:0')
distance 1 is tensor(140.6112, device='cuda:0')
distance 2 is tensor(10.7723, device='cuda:0')
compute distance is  tensor(10.7723, device='cuda:0')
compute norm is  tensor(55.0140, device='cuda:0')
distance 1 is tensor(142.7354, device='cuda:0')
distance 2 is tensor(10.7216, device='cuda:0')
compute distance is  tensor(10.7216, device='cuda:0')
compute norm is  tensor(54.9878, device='cuda:0')
distance 1 is tensor(145.3559, device='cuda:0')
distance 2 is tensor(11.0794, device='cuda:0')
compute distance is  tensor(11.0794, device='cuda:0')
compute norm is  tensor(55.1503, device='cuda:0')
distance 1 is tensor(149.4403, device='cuda:0')
distance 2 is tensor(11.1426, device='cuda:0')
compute distance is  tensor(11.1426, device='cuda:0')
compute norm is  tensor(55.0524, device='cuda:0')
distance 1 is tensor(155.0103, device='cuda:0')
distance 2 is tensor(11.6103, device='cuda:0')
compute distance is  tensor(11.6103, device='cuda:0')
compute norm is  tensor(55.3692, device='cuda:0')
distance 1 is tensor(137.1140, device='cuda:0')
distance 2 is tensor(10.3003, device='cuda:0')
compute distance is  tensor(10.3003, device='cuda:0')
compute norm is  tensor(54.9227, device='cuda:0')
distance Threshold  is  tensor(12.2096, device='cuda:0')
distance 1 is tensor(1102091., device='cuda:0')
distance 2 is tensor(79394.7656, device='cuda:0')
________________________________
test distance is  tensor(79394.7656, device='cuda:0')
test similarity is  tensor(-0.0971, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.195376472247607e+17
test entropy is  0.0
________________________________
cal ratio is  0.011160861423333585
distance 1 is tensor(12300.2920, device='cuda:0')
distance 2 is tensor(886.1140, device='cuda:0')
cal_distance is  tensor(886.1140, device='cuda:0')
cal ratio is  0.1056449812532003
distance 1 is tensor(1299.4707, device='cuda:0')
distance 2 is tensor(93.6135, device='cuda:0')
cal_distance is  tensor(93.6135, device='cuda:0')
cal ratio is  0.3250307543123359
distance 1 is tensor(422.3728, device='cuda:0')
distance 2 is tensor(30.4273, device='cuda:0')
cal_distance is  tensor(30.4273, device='cuda:0')
cal ratio is  0.570114684613998
distance 1 is tensor(240.8040, device='cuda:0')
distance 2 is tensor(17.3470, device='cuda:0')
cal_distance is  tensor(17.3470, device='cuda:0')
cal ratio is  0.7550593769017423
distance 1 is tensor(181.8231, device='cuda:0')
distance 2 is tensor(13.0980, device='cuda:0')
cal_distance is  tensor(13.0980, device='cuda:0')
cal ratio is  0.8689415775355134
distance 1 is tensor(157.9946, device='cuda:0')
distance 2 is tensor(11.3814, device='cuda:0')
cal_distance is  tensor(11.3814, device='cuda:0')
distance 1 is tensor(157.9946, device='cuda:0')
distance 2 is tensor(11.3814, device='cuda:0')
________________________________
test distance is  tensor(11.3814, device='cuda:0')
test similarity is  tensor(0.9406, device='cuda:0')
test acc is  0.8614500001563229
test loss is 58.750753024493704
test entropy is  0.00821726126437261
________________________________
distance 1 is tensor(157.9946, device='cuda:0')
distance 2 is tensor(11.3814, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.008497004423512066
avg test loss is  58.729276921449184
avg accuracy is  0.8589333334896563
solo acc is  0.13618333348966521
compute similarity  is  tensor(0.9406, device='cuda:0')
compute_distance is  tensor(11.3814, device='cuda:0')
compute_norm is  tensor(53.8779, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.3850, device='cuda:0')
distance 2 is tensor(12.6241, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9143536824153177
avg test loss is  1.5578182984008464
avg accuracy is  0.8456166668229901
solo acc is  0.3192500001563399
compute similarity  is  tensor(0.9423, device='cuda:0')
compute_distance is  tensor(12.6241, device='cuda:0')
compute_norm is  tensor(52.6912, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.4109, device='cuda:0')
distance 2 is tensor(12.9301, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8849522961990666
avg test loss is  1.6178503699902533
avg accuracy is  0.84631666682299
solo acc is  0.263583333489672
compute similarity  is  tensor(0.9420, device='cuda:0')
compute_distance is  tensor(12.9301, device='cuda:0')
compute_norm is  tensor(52.3375, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.1797, device='cuda:0')
distance 2 is tensor(13.1500, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8824772071609619
avg test loss is  1.5752372756949875
avg accuracy is  0.8499500001563233
solo acc is  0.2579166668230052
compute similarity  is  tensor(0.9418, device='cuda:0')
compute_distance is  tensor(13.1500, device='cuda:0')
compute_norm is  tensor(52.0100, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.8788, device='cuda:0')
distance 2 is tensor(13.3430, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8746587269341768
avg test loss is  1.5379168345475756
avg accuracy is  0.8503000001563232
solo acc is  0.2599500001563385
compute similarity  is  tensor(0.9416, device='cuda:0')
compute_distance is  tensor(13.3430, device='cuda:0')
compute_norm is  tensor(51.6990, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.5928, device='cuda:0')
distance 2 is tensor(13.5189, device='cuda:0')
________________________________
test distance is  tensor(13.5189, device='cuda:0')
test similarity is  tensor(0.9414, device='cuda:0')
test acc is  0.852950000156323
test loss is 1.519266243682487
test entropy is  0.8721740444077611
________________________________
cal ratio is  0.8553082166570771
distance 1 is tensor(132.2254, device='cuda:0')
distance 2 is tensor(11.5628, device='cuda:0')
cal_distance is  tensor(11.5628, device='cuda:0')
distance 1 is tensor(132.2254, device='cuda:0')
distance 2 is tensor(11.5628, device='cuda:0')
________________________________
test distance is  tensor(11.5628, device='cuda:0')
test similarity is  tensor(0.9571, device='cuda:0')
test acc is  0.8720000001563224
test loss is 1.0166670434764709
test entropy is  0.9292046313982274
________________________________
distance 1 is tensor(132.2254, device='cuda:0')
distance 2 is tensor(11.5628, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9299654460537916
avg test loss is  1.018342214225452
avg accuracy is  0.8712166668229891
solo acc is  0.5671833334896738
compute similarity  is  tensor(0.9571, device='cuda:0')
compute_distance is  tensor(11.5628, device='cuda:0')
compute_norm is  tensor(51.3131, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.6410, device='cuda:0')
distance 2 is tensor(11.9967, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8568429077612058
avg test loss is  1.4838045269949858
avg accuracy is  0.8669666668229893
solo acc is  0.2647000001563387
compute similarity  is  tensor(0.9562, device='cuda:0')
compute_distance is  tensor(11.9967, device='cuda:0')
compute_norm is  tensor(51.0083, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.7263, device='cuda:0')
distance 2 is tensor(12.1948, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8560775512698363
avg test loss is  1.4712596686918344
avg accuracy is  0.8684833334896558
solo acc is  0.2579500001563385
compute similarity  is  tensor(0.9560, device='cuda:0')
compute_distance is  tensor(12.1948, device='cuda:0')
compute_norm is  tensor(50.7181, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.6578, device='cuda:0')
distance 2 is tensor(12.3690, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8577260406795086
avg test loss is  1.4387083791974764
avg accuracy is  0.8700666668229892
solo acc is  0.26191666682300524
compute similarity  is  tensor(0.9557, device='cuda:0')
compute_distance is  tensor(12.3690, device='cuda:0')
compute_norm is  tensor(50.4375, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.5760, device='cuda:0')
distance 2 is tensor(12.5383, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8534464365256621
avg test loss is  1.4273054777686276
avg accuracy is  0.8707500001563225
solo acc is  0.2564833334896717
compute similarity  is  tensor(0.9555, device='cuda:0')
compute_distance is  tensor(12.5383, device='cuda:0')
compute_norm is  tensor(50.1614, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.4876, device='cuda:0')
distance 2 is tensor(12.6987, device='cuda:0')
________________________________
test distance is  tensor(12.6987, device='cuda:0')
test similarity is  tensor(0.9553, device='cuda:0')
test acc is  0.8726333334896557
test loss is 1.426983902830559
test entropy is  0.836376610404647
________________________________
cal ratio is  0.8824977036681301
distance 1 is tensor(126.6282, device='cuda:0')
distance 2 is tensor(11.2066, device='cuda:0')
cal_distance is  tensor(11.2066, device='cuda:0')
distance 1 is tensor(126.6282, device='cuda:0')
distance 2 is tensor(11.2066, device='cuda:0')
________________________________
test distance is  tensor(11.2066, device='cuda:0')
test similarity is  tensor(0.9654, device='cuda:0')
test acc is  0.8847166668229886
test loss is 0.989471195539686
test entropy is  0.8965148960095225
________________________________
distance 1 is tensor(126.6282, device='cuda:0')
distance 2 is tensor(11.2066, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8950731664705378
avg test loss is  0.9879191736422622
avg accuracy is  0.883300000156322
solo acc is  0.5586500001563411
compute similarity  is  tensor(0.9654, device='cuda:0')
compute_distance is  tensor(11.2066, device='cuda:0')
compute_norm is  tensor(50.0378, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.9453, device='cuda:0')
distance 2 is tensor(11.5976, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8310766150829381
avg test loss is  1.4102178852695393
avg accuracy is  0.8823166668229887
solo acc is  0.2571166668230051
compute similarity  is  tensor(0.9646, device='cuda:0')
compute_distance is  tensor(11.5976, device='cuda:0')
compute_norm is  tensor(49.7584, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.2183, device='cuda:0')
distance 2 is tensor(11.7897, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.831546646000734
avg test loss is  1.3951776279315258
avg accuracy is  0.8816500001563221
solo acc is  0.2553666668230051
compute similarity  is  tensor(0.9643, device='cuda:0')
compute_distance is  tensor(11.7897, device='cuda:0')
compute_norm is  tensor(49.4871, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.3521, device='cuda:0')
distance 2 is tensor(11.9684, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8289815141702257
avg test loss is  1.3779012531613999
avg accuracy is  0.8847500001563219
solo acc is  0.25281666682300497
compute similarity  is  tensor(0.9640, device='cuda:0')
compute_distance is  tensor(11.9684, device='cuda:0')
compute_norm is  tensor(49.2213, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.3757, device='cuda:0')
distance 2 is tensor(12.1362, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8247500122356008
avg test loss is  1.3617926556418445
avg accuracy is  0.8860000001563219
solo acc is  0.25420000015633837
compute similarity  is  tensor(0.9638, device='cuda:0')
compute_distance is  tensor(12.1362, device='cuda:0')
compute_norm is  tensor(48.9600, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.3500, device='cuda:0')
distance 2 is tensor(12.2973, device='cuda:0')
________________________________
test distance is  tensor(12.2973, device='cuda:0')
test similarity is  tensor(0.9635, device='cuda:0')
test acc is  0.8860666668229885
test loss is 1.3541665416536555
test entropy is  0.817531400969796
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.2259345054626465
mal norm is  tensor(6.1398, device='cuda:0')
distance 1 is tensor(138.3500, device='cuda:0')
distance 2 is tensor(12.2973, device='cuda:0')
mal distance is  tensor(12.2973, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1654, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.5502, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.2179e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.4508, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(444.5824, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.9573e-07, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.2011, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.4284, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.5145, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.5514, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.3552e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.7371, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9761, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
len accept list 1
len all weights is 1
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 90.13% 

Test Accuracy: 87.72% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1150006428360939
distance 1 is tensor(137.4424, device='cuda:0')
distance 2 is tensor(10.2488, device='cuda:0')
benign distance is  tensor(10.2488, device='cuda:0')
norm1 res is  tensor(0.1555, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.15818080306053162
distance 1 is tensor(151.5317, device='cuda:0')
distance 2 is tensor(11.3211, device='cuda:0')
benign distance is  tensor(11.3211, device='cuda:0')
norm1 res is  tensor(0.1698, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.16769978404045105
distance 1 is tensor(77.2957, device='cuda:0')
distance 2 is tensor(5.9196, device='cuda:0')
benign distance is  tensor(5.9196, device='cuda:0')
norm1 res is  tensor(0.0876, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3109939992427826
distance 1 is tensor(154.9143, device='cuda:0')
distance 2 is tensor(11.5088, device='cuda:0')
benign distance is  tensor(11.5088, device='cuda:0')
norm1 res is  tensor(0.1728, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.4331603944301605
distance 1 is tensor(137.7285, device='cuda:0')
distance 2 is tensor(10.2235, device='cuda:0')
benign distance is  tensor(10.2235, device='cuda:0')
norm1 res is  tensor(0.1539, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.2891848683357239
distance 1 is tensor(147.4854, device='cuda:0')
distance 2 is tensor(11.0219, device='cuda:0')
benign distance is  tensor(11.0219, device='cuda:0')
norm1 res is  tensor(0.1642, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.024172503501176834
distance 1 is tensor(138.1198, device='cuda:0')
distance 2 is tensor(10.0950, device='cuda:0')
benign distance is  tensor(10.0950, device='cuda:0')
norm1 res is  tensor(0.1499, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2754007577896118
distance 1 is tensor(149.0088, device='cuda:0')
distance 2 is tensor(11.0374, device='cuda:0')
benign distance is  tensor(11.0374, device='cuda:0')
norm1 res is  tensor(0.1656, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(153.8894, device='cuda:0')
distance 2 is tensor(11.5038, device='cuda:0')
compute distance is  tensor(11.5038, device='cuda:0')
compute norm is  tensor(54.5499, device='cuda:0')
distance 1 is tensor(163.2292, device='cuda:0')
distance 2 is tensor(12.0966, device='cuda:0')
compute distance is  tensor(12.0966, device='cuda:0')
compute norm is  tensor(54.8301, device='cuda:0')
distance 1 is tensor(170.5455, device='cuda:0')
distance 2 is tensor(12.7001, device='cuda:0')
compute distance is  tensor(12.7001, device='cuda:0')
compute norm is  tensor(55.0902, device='cuda:0')
distance 1 is tensor(164.3842, device='cuda:0')
distance 2 is tensor(12.1969, device='cuda:0')
compute distance is  tensor(12.1969, device='cuda:0')
compute norm is  tensor(54.9157, device='cuda:0')
distance 1 is tensor(174.9462, device='cuda:0')
distance 2 is tensor(13.0873, device='cuda:0')
compute distance is  tensor(13.0873, device='cuda:0')
compute norm is  tensor(55.1250, device='cuda:0')
distance 1 is tensor(175.3354, device='cuda:0')
distance 2 is tensor(13.0532, device='cuda:0')
compute distance is  tensor(13.0532, device='cuda:0')
compute norm is  tensor(55.2676, device='cuda:0')
distance 1 is tensor(155.7068, device='cuda:0')
distance 2 is tensor(11.5440, device='cuda:0')
compute distance is  tensor(11.5440, device='cuda:0')
compute norm is  tensor(54.6805, device='cuda:0')
distance 1 is tensor(164.1007, device='cuda:0')
distance 2 is tensor(12.1464, device='cuda:0')
compute distance is  tensor(12.1464, device='cuda:0')
compute norm is  tensor(54.7352, device='cuda:0')
distance 1 is tensor(153.1700, device='cuda:0')
distance 2 is tensor(11.4050, device='cuda:0')
compute distance is  tensor(11.4050, device='cuda:0')
compute norm is  tensor(54.6750, device='cuda:0')
distance 1 is tensor(158.5026, device='cuda:0')
distance 2 is tensor(11.6911, device='cuda:0')
compute distance is  tensor(11.6911, device='cuda:0')
compute norm is  tensor(54.7914, device='cuda:0')
distance 1 is tensor(165.8415, device='cuda:0')
distance 2 is tensor(12.1404, device='cuda:0')
compute distance is  tensor(12.1404, device='cuda:0')
compute norm is  tensor(54.9072, device='cuda:0')
distance 1 is tensor(161.3553, device='cuda:0')
distance 2 is tensor(11.9902, device='cuda:0')
compute distance is  tensor(11.9902, device='cuda:0')
compute norm is  tensor(54.8776, device='cuda:0')
distance Threshold  is  tensor(13.0873, device='cuda:0')
distance 1 is tensor(1102088.1250, device='cuda:0')
distance 2 is tensor(79394.6953, device='cuda:0')
________________________________
test distance is  tensor(79394.6953, device='cuda:0')
test similarity is  tensor(-0.0953, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197865499021155e+17
test entropy is  0.0
________________________________
cal ratio is  0.011555033125662735
distance 1 is tensor(12734.6719, device='cuda:0')
distance 2 is tensor(917.4083, device='cuda:0')
cal_distance is  tensor(917.4083, device='cuda:0')
cal ratio is  0.10749434350207704
distance 1 is tensor(1368.9119, device='cuda:0')
distance 2 is tensor(98.6162, device='cuda:0')
cal_distance is  tensor(98.6162, device='cuda:0')
cal ratio is  0.3278633061849471
distance 1 is tensor(448.8208, device='cuda:0')
distance 2 is tensor(32.3326, device='cuda:0')
cal_distance is  tensor(32.3326, device='cuda:0')
cal ratio is  0.5725934885456738
distance 1 is tensor(256.9950, device='cuda:0')
distance 2 is tensor(18.5135, device='cuda:0')
cal_distance is  tensor(18.5135, device='cuda:0')
cal ratio is  0.7566990114450078
distance 1 is tensor(194.4696, device='cuda:0')
distance 2 is tensor(14.0091, device='cuda:0')
cal_distance is  tensor(14.0091, device='cuda:0')
cal ratio is  0.8698845569706677
distance 1 is tensor(169.1670, device='cuda:0')
distance 2 is tensor(12.1863, device='cuda:0')
cal_distance is  tensor(12.1863, device='cuda:0')
distance 1 is tensor(169.1670, device='cuda:0')
distance 2 is tensor(12.1863, device='cuda:0')
________________________________
test distance is  tensor(12.1863, device='cuda:0')
test similarity is  tensor(0.9351, device='cuda:0')
test acc is  0.808950000156325
test loss is 100.03920444903343
test entropy is  0.0019028868875492413
________________________________
distance 1 is tensor(169.1670, device='cuda:0')
distance 2 is tensor(12.1863, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0019525592090191026
avg test loss is  99.94383331656711
avg accuracy is  0.8099666668229917
solo acc is  0.10876666682299863
compute similarity  is  tensor(0.9351, device='cuda:0')
compute_distance is  tensor(12.1863, device='cuda:0')
compute_norm is  tensor(54.9991, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(157.9772, device='cuda:0')
distance 2 is tensor(13.4586, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9684684612730673
avg test loss is  1.582138861547401
avg accuracy is  0.8222500001563244
solo acc is  0.3156000001563398
compute similarity  is  tensor(0.9370, device='cuda:0')
compute_distance is  tensor(13.4586, device='cuda:0')
compute_norm is  tensor(53.7222, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(160.1871, device='cuda:0')
distance 2 is tensor(13.7780, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9103234536103857
avg test loss is  1.6438590466086545
avg accuracy is  0.8218000001563245
solo acc is  0.26313333348967194
compute similarity  is  tensor(0.9366, device='cuda:0')
compute_distance is  tensor(13.7780, device='cuda:0')
compute_norm is  tensor(53.3563, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(161.9780, device='cuda:0')
distance 2 is tensor(14.0090, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9012943061430063
avg test loss is  1.6126721359010954
avg accuracy is  0.8260500001563243
solo acc is  0.2534000001563384
compute similarity  is  tensor(0.9363, device='cuda:0')
compute_distance is  tensor(14.0090, device='cuda:0')
compute_norm is  tensor(53.0217, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(163.6433, device='cuda:0')
distance 2 is tensor(14.2058, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8938291888120078
avg test loss is  1.569533835087758
avg accuracy is  0.8277500001563242
solo acc is  0.25470000015633837
compute similarity  is  tensor(0.9361, device='cuda:0')
compute_distance is  tensor(14.2058, device='cuda:0')
compute_norm is  tensor(52.7048, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(165.3895, device='cuda:0')
distance 2 is tensor(14.3905, device='cuda:0')
________________________________
test distance is  tensor(14.3905, device='cuda:0')
test similarity is  tensor(0.9359, device='cuda:0')
test acc is  0.8292500001563242
test loss is 1.5556240296567172
test entropy is  0.8788791688393428
________________________________
cal ratio is  0.8582803044712394
distance 1 is tensor(141.9514, device='cuda:0')
distance 2 is tensor(12.3511, device='cuda:0')
cal_distance is  tensor(12.3511, device='cuda:0')
distance 1 is tensor(141.9514, device='cuda:0')
distance 2 is tensor(12.3511, device='cuda:0')
________________________________
test distance is  tensor(12.3511, device='cuda:0')
test similarity is  tensor(0.9526, device='cuda:0')
test acc is  0.8443500001563236
test loss is 1.1121155015949502
test entropy is  0.941990479477433
________________________________
distance 1 is tensor(141.9514, device='cuda:0')
distance 2 is tensor(12.3511, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9403383001716915
avg test loss is  1.115611885020982
avg accuracy is  0.8438000001563236
solo acc is  0.5168833334896755
compute similarity  is  tensor(0.9526, device='cuda:0')
compute_distance is  tensor(12.3511, device='cuda:0')
compute_norm is  tensor(52.2768, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.3864, device='cuda:0')
distance 2 is tensor(12.7712, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.861110249244328
avg test loss is  1.5282276842131544
avg accuracy is  0.8406000001563236
solo acc is  0.25646666682300506
compute similarity  is  tensor(0.9518, device='cuda:0')
compute_distance is  tensor(12.7712, device='cuda:0')
compute_norm is  tensor(51.9608, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.5614, device='cuda:0')
distance 2 is tensor(12.9794, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8706315378390396
avg test loss is  1.4886517853879218
avg accuracy is  0.8427166668229903
solo acc is  0.25733333348967186
compute similarity  is  tensor(0.9515, device='cuda:0')
compute_distance is  tensor(12.9794, device='cuda:0')
compute_norm is  tensor(51.6606, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.5775, device='cuda:0')
distance 2 is tensor(13.1687, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8515936629350251
avg test loss is  1.4794449527888918
avg accuracy is  0.8463166668229901
solo acc is  0.25500000015633845
compute similarity  is  tensor(0.9512, device='cuda:0')
compute_distance is  tensor(13.1687, device='cuda:0')
compute_norm is  tensor(51.3690, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.5452, device='cuda:0')
distance 2 is tensor(13.3499, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8497952668905766
avg test loss is  1.4629238101719284
avg accuracy is  0.8472000001563234
solo acc is  0.25010000015633826
compute similarity  is  tensor(0.9509, device='cuda:0')
compute_distance is  tensor(13.3499, device='cuda:0')
compute_norm is  tensor(51.0842, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.3831, device='cuda:0')
distance 2 is tensor(13.5150, device='cuda:0')
________________________________
test distance is  tensor(13.5150, device='cuda:0')
test similarity is  tensor(0.9507, device='cuda:0')
test acc is  0.8491500001563234
test loss is 1.440526837479077
test entropy is  0.8474340205634835
________________________________
cal ratio is  0.8856419479024539
distance 1 is tensor(135.8432, device='cuda:0')
distance 2 is tensor(11.9695, device='cuda:0')
cal_distance is  tensor(11.9695, device='cuda:0')
distance 1 is tensor(135.8432, device='cuda:0')
distance 2 is tensor(11.9695, device='cuda:0')
________________________________
test distance is  tensor(11.9695, device='cuda:0')
test similarity is  tensor(0.9616, device='cuda:0')
test acc is  0.8564166668229898
test loss is 1.038196757340482
test entropy is  0.9087366415366435
________________________________
distance 1 is tensor(135.8432, device='cuda:0')
distance 2 is tensor(11.9695, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9068811162829653
avg test loss is  1.0328222398818938
avg accuracy is  0.856850000156323
solo acc is  0.5367833334896757
compute similarity  is  tensor(0.9616, device='cuda:0')
compute_distance is  tensor(11.9695, device='cuda:0')
compute_norm is  tensor(50.9300, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.1762, device='cuda:0')
distance 2 is tensor(12.3499, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8361376136350733
avg test loss is  1.432337670438071
avg accuracy is  0.8525500001563231
solo acc is  0.25458333348967166
compute similarity  is  tensor(0.9607, device='cuda:0')
compute_distance is  tensor(12.3499, device='cuda:0')
compute_norm is  tensor(50.6441, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.4698, device='cuda:0')
distance 2 is tensor(12.5485, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8340813189681405
avg test loss is  1.4129292462934564
avg accuracy is  0.8531000001563231
solo acc is  0.2575166668230051
compute similarity  is  tensor(0.9604, device='cuda:0')
compute_distance is  tensor(12.5485, device='cuda:0')
compute_norm is  tensor(50.3672, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.6109, device='cuda:0')
distance 2 is tensor(12.7325, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8361533908828743
avg test loss is  1.3969444161030784
avg accuracy is  0.8558166668229897
solo acc is  0.2529333334896717
compute similarity  is  tensor(0.9601, device='cuda:0')
compute_distance is  tensor(12.7325, device='cuda:0')
compute_norm is  tensor(50.0955, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.6424, device='cuda:0')
distance 2 is tensor(12.9031, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8382633501278566
avg test loss is  1.3749856374411187
avg accuracy is  0.8563666668229897
solo acc is  0.254816666823005
compute similarity  is  tensor(0.9598, device='cuda:0')
compute_distance is  tensor(12.9031, device='cuda:0')
compute_norm is  tensor(49.8298, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.6562, device='cuda:0')
distance 2 is tensor(13.0679, device='cuda:0')
________________________________
test distance is  tensor(13.0679, device='cuda:0')
test similarity is  tensor(0.9596, device='cuda:0')
test acc is  0.858800000156323
test loss is 1.3725887697134445
test entropy is  0.8307176037256652
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.5000000005
mal loss is 1.2124650478363037
mal norm is  tensor(6.5695, device='cuda:0')
distance 1 is tensor(147.6562, device='cuda:0')
distance 2 is tensor(13.0679, device='cuda:0')
mal distance is  tensor(13.0679, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1690, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.7318, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.6755, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(346.7827, device='cuda:0')
c is  tensor(0.0221, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3959, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.8733, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.6143, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9406e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.0970, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.1965, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.1451e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.9462, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.9489, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.4291, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.8972, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(774.6912, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.7248e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(766.5411, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(779.0270, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(779.8394, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.1224e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.3214, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(791.9932, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.8870e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(798.5306, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.2941e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(834.2141, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.3055e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(803.8359, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.1817e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(801.3290, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(812.6334, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.9108e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.6296, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.3591, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.4249, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.1429e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.8391, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(724.5350, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.5524e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.3846, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.6503e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.5649, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.0073, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.0151, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.2575e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4442, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.6782, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.9607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.1531, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.7106, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.4361, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.6635, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.7815, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.5198, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.2069, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 24
len all weights is 24
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.38% 

Test Accuracy: 87.83% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
 benign loss is  0.21492965519428253
distance 1 is tensor(131.5754, device='cuda:0')
distance 2 is tensor(10.0957, device='cuda:0')
benign distance is  tensor(10.0957, device='cuda:0')
norm1 res is  tensor(0.1453, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.19854000210762024
distance 1 is tensor(130.8170, device='cuda:0')
distance 2 is tensor(9.6885, device='cuda:0')
benign distance is  tensor(9.6885, device='cuda:0')
norm1 res is  tensor(0.1400, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.27721741795539856
distance 1 is tensor(106.4422, device='cuda:0')
distance 2 is tensor(7.9818, device='cuda:0')
benign distance is  tensor(7.9818, device='cuda:0')
norm1 res is  tensor(0.1159, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.47450876235961914
distance 1 is tensor(145.5672, device='cuda:0')
distance 2 is tensor(10.8217, device='cuda:0')
benign distance is  tensor(10.8217, device='cuda:0')
norm1 res is  tensor(0.1585, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6544305682182312
distance 1 is tensor(152.5786, device='cuda:0')
distance 2 is tensor(11.2277, device='cuda:0')
benign distance is  tensor(11.2277, device='cuda:0')
norm1 res is  tensor(0.1630, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.47563427686691284
distance 1 is tensor(149.2996, device='cuda:0')
distance 2 is tensor(11.2595, device='cuda:0')
benign distance is  tensor(11.2595, device='cuda:0')
norm1 res is  tensor(0.1633, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.4195457100868225
distance 1 is tensor(146.9539, device='cuda:0')
distance 2 is tensor(10.7680, device='cuda:0')
benign distance is  tensor(10.7680, device='cuda:0')
norm1 res is  tensor(0.1545, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2187642753124237
distance 1 is tensor(141.7080, device='cuda:0')
distance 2 is tensor(10.3847, device='cuda:0')
benign distance is  tensor(10.3847, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.5094090700149536
distance 1 is tensor(160.7623, device='cuda:0')
distance 2 is tensor(11.7819, device='cuda:0')
benign distance is  tensor(11.7819, device='cuda:0')
norm1 res is  tensor(0.1735, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.4257127344608307
distance 1 is tensor(153.0784, device='cuda:0')
distance 2 is tensor(11.5445, device='cuda:0')
benign distance is  tensor(11.5445, device='cuda:0')
norm1 res is  tensor(0.1658, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.5811209082603455
distance 1 is tensor(143.9695, device='cuda:0')
distance 2 is tensor(10.8061, device='cuda:0')
benign distance is  tensor(10.8061, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5246211290359497
distance 1 is tensor(155.6796, device='cuda:0')
distance 2 is tensor(11.5272, device='cuda:0')
benign distance is  tensor(11.5272, device='cuda:0')
norm1 res is  tensor(0.1680, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.4375787675380707
distance 1 is tensor(141.5906, device='cuda:0')
distance 2 is tensor(10.7333, device='cuda:0')
benign distance is  tensor(10.7333, device='cuda:0')
norm1 res is  tensor(0.1553, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.27938908338546753
distance 1 is tensor(155.5966, device='cuda:0')
distance 2 is tensor(11.5962, device='cuda:0')
benign distance is  tensor(11.5962, device='cuda:0')
norm1 res is  tensor(0.1683, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.3565880060195923
distance 1 is tensor(158.7380, device='cuda:0')
distance 2 is tensor(11.9203, device='cuda:0')
benign distance is  tensor(11.9203, device='cuda:0')
norm1 res is  tensor(0.1738, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.577347457408905
distance 1 is tensor(154.5448, device='cuda:0')
distance 2 is tensor(11.5242, device='cuda:0')
benign distance is  tensor(11.5242, device='cuda:0')
norm1 res is  tensor(0.1663, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.0643162876367569
distance 1 is tensor(152.3006, device='cuda:0')
distance 2 is tensor(11.3526, device='cuda:0')
benign distance is  tensor(11.3526, device='cuda:0')
norm1 res is  tensor(0.1649, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.8328992128372192
distance 1 is tensor(160.0258, device='cuda:0')
distance 2 is tensor(11.8008, device='cuda:0')
benign distance is  tensor(11.8008, device='cuda:0')
norm1 res is  tensor(0.1722, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.37581756711006165
distance 1 is tensor(150.6913, device='cuda:0')
distance 2 is tensor(11.2731, device='cuda:0')
benign distance is  tensor(11.2731, device='cuda:0')
norm1 res is  tensor(0.1637, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.3298604488372803
distance 1 is tensor(148.0191, device='cuda:0')
distance 2 is tensor(11.1082, device='cuda:0')
benign distance is  tensor(11.1082, device='cuda:0')
norm1 res is  tensor(0.1622, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.36238086223602295
distance 1 is tensor(145.3929, device='cuda:0')
distance 2 is tensor(10.8991, device='cuda:0')
benign distance is  tensor(10.8991, device='cuda:0')
norm1 res is  tensor(0.1544, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.5149796009063721
distance 1 is tensor(145.7882, device='cuda:0')
distance 2 is tensor(10.9549, device='cuda:0')
benign distance is  tensor(10.9549, device='cuda:0')
norm1 res is  tensor(0.1562, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.6811885833740234
distance 1 is tensor(156.9328, device='cuda:0')
distance 2 is tensor(11.7621, device='cuda:0')
benign distance is  tensor(11.7621, device='cuda:0')
norm1 res is  tensor(0.1713, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.6664824485778809
distance 1 is tensor(156.6849, device='cuda:0')
distance 2 is tensor(11.7124, device='cuda:0')
benign distance is  tensor(11.7124, device='cuda:0')
norm1 res is  tensor(0.1700, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.2682819962501526
distance 1 is tensor(155.9821, device='cuda:0')
distance 2 is tensor(11.5378, device='cuda:0')
benign distance is  tensor(11.5378, device='cuda:0')
norm1 res is  tensor(0.1678, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.2911294102668762
distance 1 is tensor(150.3302, device='cuda:0')
distance 2 is tensor(11.0292, device='cuda:0')
benign distance is  tensor(11.0292, device='cuda:0')
norm1 res is  tensor(0.1597, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.5636839270591736
distance 1 is tensor(158.5820, device='cuda:0')
distance 2 is tensor(11.9316, device='cuda:0')
benign distance is  tensor(11.9316, device='cuda:0')
norm1 res is  tensor(0.1718, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.36069387197494507
distance 1 is tensor(157.6681, device='cuda:0')
distance 2 is tensor(11.9217, device='cuda:0')
benign distance is  tensor(11.9217, device='cuda:0')
norm1 res is  tensor(0.1695, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.5510162711143494
distance 1 is tensor(146.1588, device='cuda:0')
distance 2 is tensor(10.7987, device='cuda:0')
benign distance is  tensor(10.7987, device='cuda:0')
norm1 res is  tensor(0.1538, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8540061116218567
distance 1 is tensor(155.1395, device='cuda:0')
distance 2 is tensor(11.5533, device='cuda:0')
benign distance is  tensor(11.5533, device='cuda:0')
norm1 res is  tensor(0.1656, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.16937288641929626
distance 1 is tensor(162.4187, device='cuda:0')
distance 2 is tensor(11.9775, device='cuda:0')
benign distance is  tensor(11.9775, device='cuda:0')
norm1 res is  tensor(0.1718, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.1867978721857071
distance 1 is tensor(147.6449, device='cuda:0')
distance 2 is tensor(11.1799, device='cuda:0')
benign distance is  tensor(11.1799, device='cuda:0')
norm1 res is  tensor(0.1582, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.49103736877441406
distance 1 is tensor(150.9718, device='cuda:0')
distance 2 is tensor(11.2768, device='cuda:0')
benign distance is  tensor(11.2768, device='cuda:0')
norm1 res is  tensor(0.1601, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.3758215308189392
distance 1 is tensor(152.0418, device='cuda:0')
distance 2 is tensor(11.2939, device='cuda:0')
benign distance is  tensor(11.2939, device='cuda:0')
norm1 res is  tensor(0.1602, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.3399668335914612
distance 1 is tensor(145.8909, device='cuda:0')
distance 2 is tensor(10.8807, device='cuda:0')
benign distance is  tensor(10.8807, device='cuda:0')
norm1 res is  tensor(0.1559, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.6202810406684875
distance 1 is tensor(159.2543, device='cuda:0')
distance 2 is tensor(11.9735, device='cuda:0')
benign distance is  tensor(11.9735, device='cuda:0')
norm1 res is  tensor(0.1717, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.45221981406211853
distance 1 is tensor(149.1106, device='cuda:0')
distance 2 is tensor(11.2902, device='cuda:0')
benign distance is  tensor(11.2902, device='cuda:0')
norm1 res is  tensor(0.1594, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.5296921730041504
distance 1 is tensor(166.8900, device='cuda:0')
distance 2 is tensor(12.4003, device='cuda:0')
benign distance is  tensor(12.4003, device='cuda:0')
norm1 res is  tensor(0.1803, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.9557684659957886
distance 1 is tensor(151.7673, device='cuda:0')
distance 2 is tensor(11.2652, device='cuda:0')
benign distance is  tensor(11.2652, device='cuda:0')
norm1 res is  tensor(0.1626, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5817629098892212
distance 1 is tensor(158.9361, device='cuda:0')
distance 2 is tensor(11.7772, device='cuda:0')
benign distance is  tensor(11.7772, device='cuda:0')
norm1 res is  tensor(0.1709, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(187.7857, device='cuda:0')
distance 2 is tensor(14.3724, device='cuda:0')
compute distance is  tensor(14.3724, device='cuda:0')
compute norm is  tensor(56.1613, device='cuda:0')
distance 1 is tensor(195.3444, device='cuda:0')
distance 2 is tensor(15.1057, device='cuda:0')
compute distance is  tensor(15.1057, device='cuda:0')
compute norm is  tensor(56.5496, device='cuda:0')
distance 1 is tensor(193.2137, device='cuda:0')
distance 2 is tensor(15.0355, device='cuda:0')
compute distance is  tensor(15.0355, device='cuda:0')
compute norm is  tensor(56.4189, device='cuda:0')
distance 1 is tensor(190.4940, device='cuda:0')
distance 2 is tensor(14.6554, device='cuda:0')
compute distance is  tensor(14.6554, device='cuda:0')
compute norm is  tensor(56.1683, device='cuda:0')
distance 1 is tensor(193.9935, device='cuda:0')
distance 2 is tensor(14.8567, device='cuda:0')
compute distance is  tensor(14.8567, device='cuda:0')
compute norm is  tensor(56.2824, device='cuda:0')
distance 1 is tensor(198.0435, device='cuda:0')
distance 2 is tensor(15.4467, device='cuda:0')
compute distance is  tensor(15.4467, device='cuda:0')
compute norm is  tensor(56.6724, device='cuda:0')
distance 1 is tensor(194.6333, device='cuda:0')
distance 2 is tensor(14.8115, device='cuda:0')
compute distance is  tensor(14.8115, device='cuda:0')
compute norm is  tensor(56.2491, device='cuda:0')
distance 1 is tensor(191.5340, device='cuda:0')
distance 2 is tensor(14.7350, device='cuda:0')
compute distance is  tensor(14.7350, device='cuda:0')
compute norm is  tensor(56.3200, device='cuda:0')
distance 1 is tensor(189.5975, device='cuda:0')
distance 2 is tensor(14.5006, device='cuda:0')
compute distance is  tensor(14.5006, device='cuda:0')
compute norm is  tensor(56.2991, device='cuda:0')
distance 1 is tensor(190.0381, device='cuda:0')
distance 2 is tensor(14.6657, device='cuda:0')
compute distance is  tensor(14.6657, device='cuda:0')
compute norm is  tensor(56.1927, device='cuda:0')
distance 1 is tensor(194.8085, device='cuda:0')
distance 2 is tensor(14.9457, device='cuda:0')
compute distance is  tensor(14.9457, device='cuda:0')
compute norm is  tensor(56.3987, device='cuda:0')
distance 1 is tensor(193.5152, device='cuda:0')
distance 2 is tensor(14.9234, device='cuda:0')
compute distance is  tensor(14.9234, device='cuda:0')
compute norm is  tensor(56.4254, device='cuda:0')
distance Threshold  is  tensor(15.4467, device='cuda:0')
distance 1 is tensor(1102051.7500, device='cuda:0')
distance 2 is tensor(79391.5859, device='cuda:0')
________________________________
test distance is  tensor(79391.5859, device='cuda:0')
test similarity is  tensor(0.0054, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.193708786081373e+17
test entropy is  0.0
________________________________
cal ratio is  0.012553737688620295
distance 1 is tensor(13834.8760, device='cuda:0')
distance 2 is tensor(996.6611, device='cuda:0')
cal_distance is  tensor(996.6611, device='cuda:0')
cal ratio is  0.11204346694931283
distance 1 is tensor(1550.1140, device='cuda:0')
distance 2 is tensor(111.6694, device='cuda:0')
cal_distance is  tensor(111.6694, device='cuda:0')
cal ratio is  0.3347289349047534
distance 1 is tensor(518.8727, device='cuda:0')
distance 2 is tensor(37.3790, device='cuda:0')
cal_distance is  tensor(37.3790, device='cuda:0')
cal ratio is  0.5785576469619221
distance 1 is tensor(300.2008, device='cuda:0')
distance 2 is tensor(21.6259, device='cuda:0')
cal_distance is  tensor(21.6259, device='cuda:0')
cal ratio is  0.7606296982067643
distance 1 is tensor(228.3434, device='cuda:0')
distance 2 is tensor(16.4493, device='cuda:0')
cal_distance is  tensor(16.4493, device='cuda:0')
cal ratio is  0.872140868473564
distance 1 is tensor(199.1486, device='cuda:0')
distance 2 is tensor(14.3461, device='cuda:0')
cal_distance is  tensor(14.3461, device='cuda:0')
distance 1 is tensor(199.1486, device='cuda:0')
distance 2 is tensor(14.3461, device='cuda:0')
________________________________
test distance is  tensor(14.3461, device='cuda:0')
test similarity is  tensor(0.9109, device='cuda:0')
test acc is  0.1726166668230015
test loss is 286.73982477899807
test entropy is  5.78135135282328e-26
________________________________
distance 1 is tensor(199.1486, device='cuda:0')
distance 2 is tensor(14.3461, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  9.071643904556454e-27
avg test loss is  286.6331230277446
avg accuracy is  0.17313333348966817
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9109, device='cuda:0')
compute_distance is  tensor(14.3461, device='cuda:0')
compute_norm is  tensor(54.7292, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(176.2715, device='cuda:0')
distance 2 is tensor(14.5961, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9723043432876245
avg test loss is  1.5584779986694677
avg accuracy is  0.7292000001563289
solo acc is  0.29656666682300614
compute similarity  is  tensor(0.9156, device='cuda:0')
compute_distance is  tensor(14.5961, device='cuda:0')
compute_norm is  tensor(53.9091, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(176.2715, device='cuda:0')
distance 2 is tensor(14.5961, device='cuda:0')
________________________________
test distance is  tensor(14.5961, device='cuda:0')
test similarity is  tensor(0.9156, device='cuda:0')
test acc is  0.7278000001563291
test loss is 1.5580914997851163
test entropy is  0.9713710636726575
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2821794748306274
mal norm is  tensor(9.6263, device='cuda:0')
distance 1 is tensor(176.2715, device='cuda:0')
distance 2 is tensor(14.5961, device='cuda:0')
mal distance is  tensor(14.5961, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.0830, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.4969, device='cuda:0')
c is  tensor(0.0120, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.1949, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.1338, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.3359, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.0050e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1685, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6613e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.6574, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.7029e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.5198, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.2381e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.4960, device='cuda:0')
c is  tensor(0.0119, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.0561e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.6276, device='cuda:0')
c is  tensor(0.0093, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
len accept list 7
len all weights is 7
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 90.91% 

Test Accuracy: 88.97% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1944279968738556
distance 1 is tensor(117.2198, device='cuda:0')
distance 2 is tensor(8.5985, device='cuda:0')
benign distance is  tensor(8.5985, device='cuda:0')
norm1 res is  tensor(0.1276, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.15906952321529388
distance 1 is tensor(120.6980, device='cuda:0')
distance 2 is tensor(8.7772, device='cuda:0')
benign distance is  tensor(8.7772, device='cuda:0')
norm1 res is  tensor(0.1314, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.017867375165224075
distance 1 is tensor(91.6107, device='cuda:0')
distance 2 is tensor(6.8979, device='cuda:0')
benign distance is  tensor(6.8979, device='cuda:0')
norm1 res is  tensor(0.0990, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.20384415984153748
distance 1 is tensor(122.4189, device='cuda:0')
distance 2 is tensor(8.9969, device='cuda:0')
benign distance is  tensor(8.9969, device='cuda:0')
norm1 res is  tensor(0.1331, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6397247910499573
distance 1 is tensor(129.4372, device='cuda:0')
distance 2 is tensor(9.3528, device='cuda:0')
benign distance is  tensor(9.3528, device='cuda:0')
norm1 res is  tensor(0.1369, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7689375281333923
distance 1 is tensor(145.5445, device='cuda:0')
distance 2 is tensor(10.5145, device='cuda:0')
benign distance is  tensor(10.5145, device='cuda:0')
norm1 res is  tensor(0.1584, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.30308401584625244
distance 1 is tensor(125.4017, device='cuda:0')
distance 2 is tensor(9.2558, device='cuda:0')
benign distance is  tensor(9.2558, device='cuda:0')
norm1 res is  tensor(0.1397, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.45044437050819397
distance 1 is tensor(135.6854, device='cuda:0')
distance 2 is tensor(10.0694, device='cuda:0')
benign distance is  tensor(10.0694, device='cuda:0')
norm1 res is  tensor(0.1478, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(160.7873, device='cuda:0')
distance 2 is tensor(11.6857, device='cuda:0')
compute distance is  tensor(11.6857, device='cuda:0')
compute norm is  tensor(52.9458, device='cuda:0')
distance 1 is tensor(175.3972, device='cuda:0')
distance 2 is tensor(12.8474, device='cuda:0')
compute distance is  tensor(12.8474, device='cuda:0')
compute norm is  tensor(53.4919, device='cuda:0')
distance 1 is tensor(184.9188, device='cuda:0')
distance 2 is tensor(13.2933, device='cuda:0')
compute distance is  tensor(13.2933, device='cuda:0')
compute norm is  tensor(53.6070, device='cuda:0')
distance 1 is tensor(175.8540, device='cuda:0')
distance 2 is tensor(12.7364, device='cuda:0')
compute distance is  tensor(12.7364, device='cuda:0')
compute norm is  tensor(53.3328, device='cuda:0')
distance 1 is tensor(177.5946, device='cuda:0')
distance 2 is tensor(12.9301, device='cuda:0')
compute distance is  tensor(12.9301, device='cuda:0')
compute norm is  tensor(53.5097, device='cuda:0')
distance 1 is tensor(184.9699, device='cuda:0')
distance 2 is tensor(13.2417, device='cuda:0')
compute distance is  tensor(13.2417, device='cuda:0')
compute norm is  tensor(53.5256, device='cuda:0')
distance 1 is tensor(176.7267, device='cuda:0')
distance 2 is tensor(12.8631, device='cuda:0')
compute distance is  tensor(12.8631, device='cuda:0')
compute norm is  tensor(53.3779, device='cuda:0')
distance 1 is tensor(179.8369, device='cuda:0')
distance 2 is tensor(12.8536, device='cuda:0')
compute distance is  tensor(12.8536, device='cuda:0')
compute norm is  tensor(53.4357, device='cuda:0')
distance 1 is tensor(177.7559, device='cuda:0')
distance 2 is tensor(12.9229, device='cuda:0')
compute distance is  tensor(12.9229, device='cuda:0')
compute norm is  tensor(53.5826, device='cuda:0')
distance 1 is tensor(171.2934, device='cuda:0')
distance 2 is tensor(12.4182, device='cuda:0')
compute distance is  tensor(12.4182, device='cuda:0')
compute norm is  tensor(53.2511, device='cuda:0')
distance 1 is tensor(179.0466, device='cuda:0')
distance 2 is tensor(12.9585, device='cuda:0')
compute distance is  tensor(12.9585, device='cuda:0')
compute norm is  tensor(53.4395, device='cuda:0')
distance 1 is tensor(168.5055, device='cuda:0')
distance 2 is tensor(12.2790, device='cuda:0')
compute distance is  tensor(12.2790, device='cuda:0')
compute norm is  tensor(53.2140, device='cuda:0')
distance Threshold  is  tensor(13.2933, device='cuda:0')
distance 1 is tensor(1102058.5000, device='cuda:0')
distance 2 is tensor(79392.4297, device='cuda:0')
________________________________
test distance is  tensor(79392.4297, device='cuda:0')
test similarity is  tensor(-0.0141, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197268824215278e+17
test entropy is  0.0
________________________________
cal ratio is  0.011645791212268325
distance 1 is tensor(12834.3496, device='cuda:0')
distance 2 is tensor(924.5878, device='cuda:0')
cal_distance is  tensor(924.5878, device='cuda:0')
cal ratio is  0.10791566165844413
distance 1 is tensor(1385.0339, device='cuda:0')
distance 2 is tensor(99.7775, device='cuda:0')
cal_distance is  tensor(99.7775, device='cuda:0')
cal ratio is  0.3285051915692606
distance 1 is tensor(454.9956, device='cuda:0')
distance 2 is tensor(32.7774, device='cuda:0')
cal_distance is  tensor(32.7774, device='cuda:0')
cal ratio is  0.5731537584662783
distance 1 is tensor(260.7855, device='cuda:0')
distance 2 is tensor(18.7865, device='cuda:0')
cal_distance is  tensor(18.7865, device='cuda:0')
cal ratio is  0.7570691066760094
distance 1 is tensor(197.4344, device='cuda:0')
distance 2 is tensor(14.2227, device='cuda:0')
cal_distance is  tensor(14.2227, device='cuda:0')
cal ratio is  0.870097267616444
distance 1 is tensor(171.7881, device='cuda:0')
distance 2 is tensor(12.3751, device='cuda:0')
cal_distance is  tensor(12.3751, device='cuda:0')
distance 1 is tensor(171.7881, device='cuda:0')
distance 2 is tensor(12.3751, device='cuda:0')
________________________________
test distance is  tensor(12.3751, device='cuda:0')
test similarity is  tensor(0.9315, device='cuda:0')
test acc is  0.633700000156335
test loss is 146.4055592713834
test entropy is  4.1352693796420264e-05
________________________________
distance 1 is tensor(171.7881, device='cuda:0')
distance 2 is tensor(12.3751, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  4.486419574435432e-05
avg test loss is  146.50792457401624
avg accuracy is  0.6324833334896685
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9315, device='cuda:0')
compute_distance is  tensor(12.3751, device='cuda:0')
compute_norm is  tensor(54.0332, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(156.6363, device='cuda:0')
distance 2 is tensor(13.1152, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9148079902251393
avg test loss is  1.5078246987450605
avg accuracy is  0.8194666668229911
solo acc is  0.3147000001563398
compute similarity  is  tensor(0.9341, device='cuda:0')
compute_distance is  tensor(13.1152, device='cuda:0')
compute_norm is  tensor(53.1218, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.5045, device='cuda:0')
distance 2 is tensor(13.3096, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8960708348608729
avg test loss is  1.5588360639777519
avg accuracy is  0.817933333489658
solo acc is  0.2613000001563386
compute similarity  is  tensor(0.9340, device='cuda:0')
compute_distance is  tensor(13.3096, device='cuda:0')
compute_norm is  tensor(52.7915, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.4088, device='cuda:0')
distance 2 is tensor(13.4640, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8839295376846785
avg test loss is  1.5254359756197249
avg accuracy is  0.8195500001563245
solo acc is  0.25580000015633836
compute similarity  is  tensor(0.9340, device='cuda:0')
compute_distance is  tensor(13.4640, device='cuda:0')
compute_norm is  tensor(52.4834, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.3216, device='cuda:0')
distance 2 is tensor(13.5982, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8751102675761241
avg test loss is  1.5175414020572897
avg accuracy is  0.8215333334896577
solo acc is  0.24700000015633816
compute similarity  is  tensor(0.9339, device='cuda:0')
compute_distance is  tensor(13.5982, device='cuda:0')
compute_norm is  tensor(52.1888, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(160.2664, device='cuda:0')
distance 2 is tensor(13.7181, device='cuda:0')
________________________________
test distance is  tensor(13.7181, device='cuda:0')
test similarity is  tensor(0.9339, device='cuda:0')
test acc is  0.8228500001563244
test loss is 1.4802198912034918
test entropy is  0.8755597298714652
________________________________
cal ratio is  0.8859550746809417
distance 1 is tensor(141.9896, device='cuda:0')
distance 2 is tensor(12.1536, device='cuda:0')
cal_distance is  tensor(12.1536, device='cuda:0')
distance 1 is tensor(141.9896, device='cuda:0')
distance 2 is tensor(12.1536, device='cuda:0')
________________________________
test distance is  tensor(12.1536, device='cuda:0')
test similarity is  tensor(0.9475, device='cuda:0')
test acc is  0.8412500001563236
test loss is 1.1720990541774328
test entropy is  0.9452644386398259
________________________________
distance 1 is tensor(141.9896, device='cuda:0')
distance 2 is tensor(12.1536, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9446922278861756
avg test loss is  1.167910827057702
avg accuracy is  0.8404500001563235
solo acc is  0.443983333489675
compute similarity  is  tensor(0.9475, device='cuda:0')
compute_distance is  tensor(12.1536, device='cuda:0')
compute_norm is  tensor(51.6373, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.8044, device='cuda:0')
distance 2 is tensor(12.3916, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.861308742942078
avg test loss is  1.4699746250852084
avg accuracy is  0.8351666668229906
solo acc is  0.24993333348967153
compute similarity  is  tensor(0.9471, device='cuda:0')
compute_distance is  tensor(12.3916, device='cuda:0')
compute_norm is  tensor(51.3516, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.2773, device='cuda:0')
distance 2 is tensor(12.5414, device='cuda:0')
exit early
distance 1 is tensor(145.2773, device='cuda:0')
distance 2 is tensor(12.5414, device='cuda:0')
________________________________
test distance is  tensor(12.5414, device='cuda:0')
test similarity is  tensor(0.9470, device='cuda:0')
test acc is  0.8385333334896571
test loss is 1.4688499963868147
test entropy is  0.850386108226105
________________________________
distance 1 is tensor(145.2773, device='cuda:0')
distance 2 is tensor(12.5414, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8502353976911573
avg test loss is  1.4692208186141464
avg accuracy is  0.8387500001563237
solo acc is  0.24398333348967144
compute similarity  is  tensor(0.9470, device='cuda:0')
compute_distance is  tensor(12.5414, device='cuda:0')
compute_norm is  tensor(51.0730, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.5966, device='cuda:0')
distance 2 is tensor(12.6679, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8534772687120986
avg test loss is  1.4315398536257145
avg accuracy is  0.8407000001563236
solo acc is  0.251716666823005
compute similarity  is  tensor(0.9469, device='cuda:0')
compute_distance is  tensor(12.6679, device='cuda:0')
compute_norm is  tensor(50.7998, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.8914, device='cuda:0')
distance 2 is tensor(12.7861, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8489124616707312
avg test loss is  1.4248027515563884
avg accuracy is  0.8408000001563237
solo acc is  0.24450000015633802
compute similarity  is  tensor(0.9468, device='cuda:0')
compute_distance is  tensor(12.7861, device='cuda:0')
compute_norm is  tensor(50.5338, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.2493, device='cuda:0')
distance 2 is tensor(12.9086, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8503157730931158
avg test loss is  1.413609330715147
avg accuracy is  0.8445500001563234
solo acc is  0.24335000015633804
compute similarity  is  tensor(0.9467, device='cuda:0')
compute_distance is  tensor(12.9086, device='cuda:0')
compute_norm is  tensor(50.2703, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.6805, device='cuda:0')
distance 2 is tensor(13.0303, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8439551197897905
avg test loss is  1.401812226152115
avg accuracy is  0.8445833334896568
solo acc is  0.242000000156338
compute similarity  is  tensor(0.9466, device='cuda:0')
compute_distance is  tensor(13.0303, device='cuda:0')
compute_norm is  tensor(50.0103, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.0782, device='cuda:0')
distance 2 is tensor(13.1453, device='cuda:0')
________________________________
test distance is  tensor(13.1453, device='cuda:0')
test similarity is  tensor(0.9465, device='cuda:0')
test acc is  0.84596666682299
test loss is 1.38312793426168
test entropy is  0.8461487352975142
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2056858539581299
mal norm is  tensor(7.2379, device='cuda:0')
distance 1 is tensor(152.0782, device='cuda:0')
distance 2 is tensor(13.1453, device='cuda:0')
mal distance is  tensor(13.1453, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1793, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.2281, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.8733, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.6537e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(394.0225, device='cuda:0')
c is  tensor(0.0213, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.0187, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.5084, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.9538, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.9246, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7635e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.8858, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.2896e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.7909, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7573, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.8972, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.2544, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.3096, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.9838, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.1216, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.0231e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.0163, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.1467e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.8312, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 6
len all weights is 6
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 90.79% 

Test Accuracy: 89.35% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
 benign loss is  0.19429145753383636
distance 1 is tensor(114.7279, device='cuda:0')
distance 2 is tensor(8.5748, device='cuda:0')
benign distance is  tensor(8.5748, device='cuda:0')
norm1 res is  tensor(0.1282, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.4008822441101074
distance 1 is tensor(119.9102, device='cuda:0')
distance 2 is tensor(8.8103, device='cuda:0')
benign distance is  tensor(8.8103, device='cuda:0')
norm1 res is  tensor(0.1326, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.1849031150341034
distance 1 is tensor(79.2532, device='cuda:0')
distance 2 is tensor(5.9676, device='cuda:0')
benign distance is  tensor(5.9676, device='cuda:0')
norm1 res is  tensor(0.0856, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5171791315078735
distance 1 is tensor(128.7110, device='cuda:0')
distance 2 is tensor(9.5354, device='cuda:0')
benign distance is  tensor(9.5354, device='cuda:0')
norm1 res is  tensor(0.1389, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8560821413993835
distance 1 is tensor(129.6024, device='cuda:0')
distance 2 is tensor(9.4484, device='cuda:0')
benign distance is  tensor(9.4484, device='cuda:0')
norm1 res is  tensor(0.1386, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6936273574829102
distance 1 is tensor(123.2010, device='cuda:0')
distance 2 is tensor(9.1305, device='cuda:0')
benign distance is  tensor(9.1305, device='cuda:0')
norm1 res is  tensor(0.1371, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.22315776348114014
distance 1 is tensor(113.2765, device='cuda:0')
distance 2 is tensor(8.3036, device='cuda:0')
benign distance is  tensor(8.3036, device='cuda:0')
norm1 res is  tensor(0.1240, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.4108002781867981
distance 1 is tensor(127.5250, device='cuda:0')
distance 2 is tensor(9.4061, device='cuda:0')
benign distance is  tensor(9.4061, device='cuda:0')
norm1 res is  tensor(0.1416, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.04001551866531372
distance 1 is tensor(138.7308, device='cuda:0')
distance 2 is tensor(10.0838, device='cuda:0')
benign distance is  tensor(10.0838, device='cuda:0')
norm1 res is  tensor(0.1524, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.19021199643611908
distance 1 is tensor(138.1121, device='cuda:0')
distance 2 is tensor(10.1520, device='cuda:0')
benign distance is  tensor(10.1520, device='cuda:0')
norm1 res is  tensor(0.1495, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.14054134488105774
distance 1 is tensor(138.1258, device='cuda:0')
distance 2 is tensor(10.1142, device='cuda:0')
benign distance is  tensor(10.1142, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.42455750703811646
distance 1 is tensor(134.8484, device='cuda:0')
distance 2 is tensor(9.9969, device='cuda:0')
benign distance is  tensor(9.9969, device='cuda:0')
norm1 res is  tensor(0.1490, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.20795443654060364
distance 1 is tensor(133.6349, device='cuda:0')
distance 2 is tensor(9.8736, device='cuda:0')
benign distance is  tensor(9.8736, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.4687906801700592
distance 1 is tensor(125.0492, device='cuda:0')
distance 2 is tensor(9.2423, device='cuda:0')
benign distance is  tensor(9.2423, device='cuda:0')
norm1 res is  tensor(0.1377, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.27532076835632324
distance 1 is tensor(130.7483, device='cuda:0')
distance 2 is tensor(9.7762, device='cuda:0')
benign distance is  tensor(9.7762, device='cuda:0')
norm1 res is  tensor(0.1453, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.5857185125350952
distance 1 is tensor(136.0012, device='cuda:0')
distance 2 is tensor(10.0439, device='cuda:0')
benign distance is  tensor(10.0439, device='cuda:0')
norm1 res is  tensor(0.1499, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(157.7216, device='cuda:0')
distance 2 is tensor(11.6232, device='cuda:0')
compute distance is  tensor(11.6232, device='cuda:0')
compute norm is  tensor(53.7421, device='cuda:0')
distance 1 is tensor(152.1987, device='cuda:0')
distance 2 is tensor(11.3592, device='cuda:0')
compute distance is  tensor(11.3592, device='cuda:0')
compute norm is  tensor(53.6610, device='cuda:0')
distance 1 is tensor(163.6650, device='cuda:0')
distance 2 is tensor(12.2247, device='cuda:0')
compute distance is  tensor(12.2247, device='cuda:0')
compute norm is  tensor(54.0359, device='cuda:0')
distance 1 is tensor(157.5954, device='cuda:0')
distance 2 is tensor(11.6544, device='cuda:0')
compute distance is  tensor(11.6544, device='cuda:0')
compute norm is  tensor(53.7773, device='cuda:0')
distance 1 is tensor(161.8560, device='cuda:0')
distance 2 is tensor(12.0660, device='cuda:0')
compute distance is  tensor(12.0660, device='cuda:0')
compute norm is  tensor(53.8561, device='cuda:0')
distance 1 is tensor(164.9500, device='cuda:0')
distance 2 is tensor(12.2513, device='cuda:0')
compute distance is  tensor(12.2513, device='cuda:0')
compute norm is  tensor(54.1397, device='cuda:0')
distance 1 is tensor(158.9990, device='cuda:0')
distance 2 is tensor(11.7965, device='cuda:0')
compute distance is  tensor(11.7965, device='cuda:0')
compute norm is  tensor(53.8720, device='cuda:0')
distance 1 is tensor(149.1094, device='cuda:0')
distance 2 is tensor(11.3220, device='cuda:0')
compute distance is  tensor(11.3220, device='cuda:0')
compute norm is  tensor(53.7779, device='cuda:0')
distance 1 is tensor(149.4731, device='cuda:0')
distance 2 is tensor(11.2215, device='cuda:0')
compute distance is  tensor(11.2215, device='cuda:0')
compute norm is  tensor(53.6870, device='cuda:0')
distance 1 is tensor(150.9456, device='cuda:0')
distance 2 is tensor(11.1503, device='cuda:0')
compute distance is  tensor(11.1503, device='cuda:0')
compute norm is  tensor(53.7488, device='cuda:0')
distance 1 is tensor(160.3700, device='cuda:0')
distance 2 is tensor(11.8933, device='cuda:0')
compute distance is  tensor(11.8933, device='cuda:0')
compute norm is  tensor(53.9500, device='cuda:0')
distance 1 is tensor(155.1621, device='cuda:0')
distance 2 is tensor(11.4737, device='cuda:0')
compute distance is  tensor(11.4737, device='cuda:0')
compute norm is  tensor(53.8725, device='cuda:0')
distance Threshold  is  tensor(12.2513, device='cuda:0')
distance 1 is tensor(1102062., device='cuda:0')
distance 2 is tensor(79392.8125, device='cuda:0')
________________________________
test distance is  tensor(79392.8125, device='cuda:0')
test similarity is  tensor(-0.0234, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.194891012368872e+17
test entropy is  0.0
________________________________
cal ratio is  0.011180008568460643
distance 1 is tensor(12321.0693, device='cuda:0')
distance 2 is tensor(887.6122, device='cuda:0')
cal_distance is  tensor(887.6122, device='cuda:0')
cal ratio is  0.10573556410194275
distance 1 is tensor(1302.7817, device='cuda:0')
distance 2 is tensor(93.8522, device='cuda:0')
cal_distance is  tensor(93.8522, device='cuda:0')
cal ratio is  0.3251700540991759
distance 1 is tensor(423.6305, device='cuda:0')
distance 2 is tensor(30.5179, device='cuda:0')
cal_distance is  tensor(30.5179, device='cuda:0')
cal ratio is  0.5702368709636584
distance 1 is tensor(241.5728, device='cuda:0')
distance 2 is tensor(17.4024, device='cuda:0')
cal_distance is  tensor(17.4024, device='cuda:0')
cal ratio is  0.7551402907576498
distance 1 is tensor(182.4231, device='cuda:0')
distance 2 is tensor(13.1413, device='cuda:0')
cal_distance is  tensor(13.1413, device='cuda:0')
cal ratio is  0.8689880813290499
distance 1 is tensor(158.5245, device='cuda:0')
distance 2 is tensor(11.4196, device='cuda:0')
cal_distance is  tensor(11.4196, device='cuda:0')
distance 1 is tensor(158.5245, device='cuda:0')
distance 2 is tensor(11.4196, device='cuda:0')
________________________________
test distance is  tensor(11.4196, device='cuda:0')
test similarity is  tensor(0.9412, device='cuda:0')
test acc is  0.7912666668229925
test loss is 92.0348357096918
test entropy is  0.0006906432341666479
________________________________
distance 1 is tensor(158.5245, device='cuda:0')
distance 2 is tensor(11.4196, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0008331113531207699
avg test loss is  92.18957308868863
avg accuracy is  0.7912666668229924
solo acc is  0.10255000015633196
compute similarity  is  tensor(0.9412, device='cuda:0')
compute_distance is  tensor(11.4196, device='cuda:0')
compute_norm is  tensor(53.8462, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(146.1487, device='cuda:0')
distance 2 is tensor(12.3269, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9204381122899208
avg test loss is  1.4747659199273409
avg accuracy is  0.8374000001563237
solo acc is  0.3202333334896733
compute similarity  is  tensor(0.9431, device='cuda:0')
compute_distance is  tensor(12.3269, device='cuda:0')
compute_norm is  tensor(52.8847, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.5193, device='cuda:0')
distance 2 is tensor(12.5479, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8829127806844488
avg test loss is  1.5370966273584346
avg accuracy is  0.8355000001563239
solo acc is  0.26726666682300537
compute similarity  is  tensor(0.9429, device='cuda:0')
compute_distance is  tensor(12.5479, device='cuda:0')
compute_norm is  tensor(52.5580, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.6772, device='cuda:0')
distance 2 is tensor(12.7122, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8663549465792519
avg test loss is  1.5235540321640877
avg accuracy is  0.839133333489657
solo acc is  0.2551166668230051
compute similarity  is  tensor(0.9429, device='cuda:0')
compute_distance is  tensor(12.7122, device='cuda:0')
compute_norm is  tensor(52.2527, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.8023, device='cuda:0')
distance 2 is tensor(12.8496, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8681108478798287
avg test loss is  1.4775114283124522
avg accuracy is  0.8419500001563236
solo acc is  0.2636000001563386
compute similarity  is  tensor(0.9428, device='cuda:0')
compute_distance is  tensor(12.8496, device='cuda:0')
compute_norm is  tensor(51.9595, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.9829, device='cuda:0')
distance 2 is tensor(12.9818, device='cuda:0')
________________________________
test distance is  tensor(12.9818, device='cuda:0')
test similarity is  tensor(0.9427, device='cuda:0')
test acc is  0.8451666668229901
test loss is 1.4776886482991136
test entropy is  0.8645131199090466
________________________________
cal ratio is  0.8743079786811628
distance 1 is tensor(132.0064, device='cuda:0')
distance 2 is tensor(11.3501, device='cuda:0')
cal_distance is  tensor(11.3501, device='cuda:0')
distance 1 is tensor(132.0064, device='cuda:0')
distance 2 is tensor(11.3501, device='cuda:0')
________________________________
test distance is  tensor(11.3501, device='cuda:0')
test similarity is  tensor(0.9558, device='cuda:0')
test acc is  0.858600000156323
test loss is 1.0877164234357601
test entropy is  0.9449279951388394
________________________________
distance 1 is tensor(132.0064, device='cuda:0')
distance 2 is tensor(11.3501, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9449875781785196
avg test loss is  1.0862994533993289
avg accuracy is  0.857650000156323
solo acc is  0.49840000015634206
compute similarity  is  tensor(0.9558, device='cuda:0')
compute_distance is  tensor(11.3501, device='cuda:0')
compute_norm is  tensor(51.4762, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.3557, device='cuda:0')
distance 2 is tensor(11.6496, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8545169862729909
avg test loss is  1.44050969891965
avg accuracy is  0.8533666668229898
solo acc is  0.2623166668230053
compute similarity  is  tensor(0.9553, device='cuda:0')
compute_distance is  tensor(11.6496, device='cuda:0')
compute_norm is  tensor(51.1912, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.0241, device='cuda:0')
distance 2 is tensor(11.8130, device='cuda:0')
exit early
distance 1 is tensor(136.0241, device='cuda:0')
distance 2 is tensor(11.8130, device='cuda:0')
________________________________
test distance is  tensor(11.8130, device='cuda:0')
test similarity is  tensor(0.9552, device='cuda:0')
test acc is  0.8539666668229897
test loss is 1.4400017889959218
test entropy is  0.8475420164274
________________________________
distance 1 is tensor(136.0241, device='cuda:0')
distance 2 is tensor(11.8130, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8491601555078014
avg test loss is  1.4418337157031875
avg accuracy is  0.8552666668229898
solo acc is  0.2507500001563382
compute similarity  is  tensor(0.9552, device='cuda:0')
compute_distance is  tensor(11.8130, device='cuda:0')
compute_norm is  tensor(50.9134, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.5763, device='cuda:0')
distance 2 is tensor(11.9598, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8452886848815723
avg test loss is  1.4337673367721948
avg accuracy is  0.8556833334896563
solo acc is  0.2453166668230047
compute similarity  is  tensor(0.9550, device='cuda:0')
compute_distance is  tensor(11.9598, device='cuda:0')
compute_norm is  tensor(50.6432, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.0432, device='cuda:0')
distance 2 is tensor(12.0907, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8499191193057022
avg test loss is  1.4104257707656829
avg accuracy is  0.8567666668229896
solo acc is  0.24630000015633813
compute similarity  is  tensor(0.9549, device='cuda:0')
compute_distance is  tensor(12.0907, device='cuda:0')
compute_norm is  tensor(50.3767, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.5247, device='cuda:0')
distance 2 is tensor(12.2147, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.846591870858471
avg test loss is  1.3954914330419448
avg accuracy is  0.8590166668229895
solo acc is  0.24746666682300486
compute similarity  is  tensor(0.9548, device='cuda:0')
compute_distance is  tensor(12.2147, device='cuda:0')
compute_norm is  tensor(50.1172, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.9947, device='cuda:0')
distance 2 is tensor(12.3388, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8427088763286819
avg test loss is  1.3882329913853073
avg accuracy is  0.8618833334896561
solo acc is  0.24085000015633792
compute similarity  is  tensor(0.9546, device='cuda:0')
compute_distance is  tensor(12.3388, device='cuda:0')
compute_norm is  tensor(49.8605, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.5127, device='cuda:0')
distance 2 is tensor(12.4629, device='cuda:0')
________________________________
test distance is  tensor(12.4629, device='cuda:0')
test similarity is  tensor(0.9545, device='cuda:0')
test acc is  0.8612666668229896
test loss is 1.3805011587102276
test entropy is  0.8393404199116266
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.3019168376922607
mal norm is  tensor(6.7005, device='cuda:0')
distance 1 is tensor(143.5127, device='cuda:0')
distance 2 is tensor(12.4629, device='cuda:0')
mal distance is  tensor(12.4629, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1330, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.3888, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.0031, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(337.7286, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.2696e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.4044, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.6013, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.0012, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.3437, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.3969e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.0936, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.2284e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.0493, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0037e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7791, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.7619e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9164, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6529e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.5571, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.8230e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.1157, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.6480e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.1089, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.4642, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.2846, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.6790, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.1079e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.9266, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.9214e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.8749, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.4360, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.2519, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.0831, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.3320, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.7173e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.3662, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.2681e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.8414, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 6
len all weights is 6
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 91.10% 

Test Accuracy: 89.23% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5300391912460327
distance 1 is tensor(115.0615, device='cuda:0')
distance 2 is tensor(8.6945, device='cuda:0')
benign distance is  tensor(8.6945, device='cuda:0')
norm1 res is  tensor(0.1293, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.2550393044948578
distance 1 is tensor(116.7523, device='cuda:0')
distance 2 is tensor(8.6004, device='cuda:0')
benign distance is  tensor(8.6004, device='cuda:0')
norm1 res is  tensor(0.1332, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.023255450651049614
distance 1 is tensor(87.1683, device='cuda:0')
distance 2 is tensor(6.4816, device='cuda:0')
benign distance is  tensor(6.4816, device='cuda:0')
norm1 res is  tensor(0.0955, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.34607425332069397
distance 1 is tensor(124.3031, device='cuda:0')
distance 2 is tensor(9.1778, device='cuda:0')
benign distance is  tensor(9.1778, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.31833988428115845
distance 1 is tensor(113.7397, device='cuda:0')
distance 2 is tensor(8.4194, device='cuda:0')
benign distance is  tensor(8.4194, device='cuda:0')
norm1 res is  tensor(0.1278, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.37731945514678955
distance 1 is tensor(139.8568, device='cuda:0')
distance 2 is tensor(10.3434, device='cuda:0')
benign distance is  tensor(10.3434, device='cuda:0')
norm1 res is  tensor(0.1562, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.2540987730026245
distance 1 is tensor(111.3216, device='cuda:0')
distance 2 is tensor(8.1010, device='cuda:0')
benign distance is  tensor(8.1010, device='cuda:0')
norm1 res is  tensor(0.1239, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.06477000564336777
distance 1 is tensor(132.8692, device='cuda:0')
distance 2 is tensor(9.8418, device='cuda:0')
benign distance is  tensor(9.8418, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.04050896316766739
distance 1 is tensor(132.3841, device='cuda:0')
distance 2 is tensor(9.7930, device='cuda:0')
benign distance is  tensor(9.7930, device='cuda:0')
norm1 res is  tensor(0.1468, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.49559158086776733
distance 1 is tensor(139.2581, device='cuda:0')
distance 2 is tensor(10.1941, device='cuda:0')
benign distance is  tensor(10.1941, device='cuda:0')
norm1 res is  tensor(0.1545, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.1471358835697174
distance 1 is tensor(132.4095, device='cuda:0')
distance 2 is tensor(9.7513, device='cuda:0')
benign distance is  tensor(9.7513, device='cuda:0')
norm1 res is  tensor(0.1446, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.24348346889019012
distance 1 is tensor(127.1190, device='cuda:0')
distance 2 is tensor(9.5181, device='cuda:0')
benign distance is  tensor(9.5181, device='cuda:0')
norm1 res is  tensor(0.1450, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.4975849688053131
distance 1 is tensor(133.8251, device='cuda:0')
distance 2 is tensor(10.0068, device='cuda:0')
benign distance is  tensor(10.0068, device='cuda:0')
norm1 res is  tensor(0.1493, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.3334403932094574
distance 1 is tensor(139.7963, device='cuda:0')
distance 2 is tensor(10.3676, device='cuda:0')
benign distance is  tensor(10.3676, device='cuda:0')
norm1 res is  tensor(0.1571, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.3724076449871063
distance 1 is tensor(139.1662, device='cuda:0')
distance 2 is tensor(10.4037, device='cuda:0')
benign distance is  tensor(10.4037, device='cuda:0')
norm1 res is  tensor(0.1596, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.6796460747718811
distance 1 is tensor(131.2522, device='cuda:0')
distance 2 is tensor(9.7338, device='cuda:0')
benign distance is  tensor(9.7338, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.3867826759815216
distance 1 is tensor(119.4262, device='cuda:0')
distance 2 is tensor(8.9316, device='cuda:0')
benign distance is  tensor(8.9316, device='cuda:0')
norm1 res is  tensor(0.1327, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.051927350461483
distance 1 is tensor(134.8881, device='cuda:0')
distance 2 is tensor(10.0279, device='cuda:0')
benign distance is  tensor(10.0279, device='cuda:0')
norm1 res is  tensor(0.1539, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.17719325423240662
distance 1 is tensor(137.5426, device='cuda:0')
distance 2 is tensor(10.1251, device='cuda:0')
benign distance is  tensor(10.1251, device='cuda:0')
norm1 res is  tensor(0.1525, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.2204124927520752
distance 1 is tensor(132.1315, device='cuda:0')
distance 2 is tensor(9.8673, device='cuda:0')
benign distance is  tensor(9.8673, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.0797659307718277
distance 1 is tensor(132.8655, device='cuda:0')
distance 2 is tensor(9.8171, device='cuda:0')
benign distance is  tensor(9.8171, device='cuda:0')
norm1 res is  tensor(0.1474, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.6621097326278687
distance 1 is tensor(128.8282, device='cuda:0')
distance 2 is tensor(9.6604, device='cuda:0')
benign distance is  tensor(9.6604, device='cuda:0')
norm1 res is  tensor(0.1433, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.31253427267074585
distance 1 is tensor(125.2170, device='cuda:0')
distance 2 is tensor(9.3097, device='cuda:0')
benign distance is  tensor(9.3097, device='cuda:0')
norm1 res is  tensor(0.1392, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.1184568777680397
distance 1 is tensor(123.9278, device='cuda:0')
distance 2 is tensor(9.1807, device='cuda:0')
benign distance is  tensor(9.1807, device='cuda:0')
norm1 res is  tensor(0.1389, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(134.2870, device='cuda:0')
distance 2 is tensor(9.9480, device='cuda:0')
compute distance is  tensor(9.9480, device='cuda:0')
compute norm is  tensor(54.0747, device='cuda:0')
distance 1 is tensor(133.6608, device='cuda:0')
distance 2 is tensor(10.0661, device='cuda:0')
compute distance is  tensor(10.0661, device='cuda:0')
compute norm is  tensor(54.1834, device='cuda:0')
distance 1 is tensor(144.7571, device='cuda:0')
distance 2 is tensor(10.8002, device='cuda:0')
compute distance is  tensor(10.8002, device='cuda:0')
compute norm is  tensor(54.4158, device='cuda:0')
distance 1 is tensor(141.6636, device='cuda:0')
distance 2 is tensor(10.4756, device='cuda:0')
compute distance is  tensor(10.4756, device='cuda:0')
compute norm is  tensor(54.2294, device='cuda:0')
distance 1 is tensor(133.4138, device='cuda:0')
distance 2 is tensor(10.0171, device='cuda:0')
compute distance is  tensor(10.0171, device='cuda:0')
compute norm is  tensor(54.2203, device='cuda:0')
distance 1 is tensor(147.6481, device='cuda:0')
distance 2 is tensor(10.8945, device='cuda:0')
compute distance is  tensor(10.8945, device='cuda:0')
compute norm is  tensor(54.5066, device='cuda:0')
distance 1 is tensor(145.6177, device='cuda:0')
distance 2 is tensor(10.8190, device='cuda:0')
compute distance is  tensor(10.8190, device='cuda:0')
compute norm is  tensor(54.4494, device='cuda:0')
distance 1 is tensor(143.8300, device='cuda:0')
distance 2 is tensor(10.5667, device='cuda:0')
compute distance is  tensor(10.5667, device='cuda:0')
compute norm is  tensor(54.4064, device='cuda:0')
distance 1 is tensor(141.5552, device='cuda:0')
distance 2 is tensor(10.5233, device='cuda:0')
compute distance is  tensor(10.5233, device='cuda:0')
compute norm is  tensor(54.3649, device='cuda:0')
distance 1 is tensor(137.7916, device='cuda:0')
distance 2 is tensor(10.2481, device='cuda:0')
compute distance is  tensor(10.2481, device='cuda:0')
compute norm is  tensor(54.3024, device='cuda:0')
distance 1 is tensor(126.3698, device='cuda:0')
distance 2 is tensor(9.3838, device='cuda:0')
compute distance is  tensor(9.3838, device='cuda:0')
compute norm is  tensor(54.1498, device='cuda:0')
distance 1 is tensor(137.8706, device='cuda:0')
distance 2 is tensor(10.1683, device='cuda:0')
compute distance is  tensor(10.1683, device='cuda:0')
compute norm is  tensor(54.3367, device='cuda:0')
distance Threshold  is  tensor(10.8945, device='cuda:0')
distance 1 is tensor(1102076.8750, device='cuda:0')
distance 2 is tensor(79393.9688, device='cuda:0')
________________________________
test distance is  tensor(79393.9688, device='cuda:0')
test similarity is  tensor(-0.0670, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.192135586997801e+17
test entropy is  0.0
________________________________
cal ratio is  0.010542696072769687
distance 1 is tensor(11618.8701, device='cuda:0')
distance 2 is tensor(837.0266, device='cuda:0')
cal_distance is  tensor(837.0266, device='cuda:0')
cal ratio is  0.1026776291682934
distance 1 is tensor(1193.0045, device='cuda:0')
distance 2 is tensor(85.9439, device='cuda:0')
cal_distance is  tensor(85.9439, device='cuda:0')
cal ratio is  0.3204335260864682
distance 1 is tensor(382.2835, device='cuda:0')
distance 2 is tensor(27.5393, device='cuda:0')
cal_distance is  tensor(27.5393, device='cuda:0')
cal ratio is  0.5660684430611812
distance 1 is tensor(216.4018, device='cuda:0')
distance 2 is tensor(15.5891, device='cuda:0')
cal_distance is  tensor(15.5891, device='cuda:0')
cal ratio is  0.7523751617719201
distance 1 is tensor(162.8171, device='cuda:0')
distance 2 is tensor(11.7289, device='cuda:0')
cal_distance is  tensor(11.7289, device='cuda:0')
cal ratio is  0.8673956461427085
distance 1 is tensor(141.2278, device='cuda:0')
distance 2 is tensor(10.1736, device='cuda:0')
cal_distance is  tensor(10.1736, device='cuda:0')
distance 1 is tensor(141.2278, device='cuda:0')
distance 2 is tensor(10.1736, device='cuda:0')
________________________________
test distance is  tensor(10.1736, device='cuda:0')
test similarity is  tensor(0.9526, device='cuda:0')
test acc is  0.8627166668229894
test loss is 42.16585862865326
test entropy is  0.016364734206835842
________________________________
distance 1 is tensor(141.2278, device='cuda:0')
distance 2 is tensor(10.1736, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.01573169807635732
avg test loss is  42.19985049721529
avg accuracy is  0.8639000001563227
solo acc is  0.16871666682300115
compute similarity  is  tensor(0.9526, device='cuda:0')
compute_distance is  tensor(10.1736, device='cuda:0')
compute_norm is  tensor(53.7166, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(133.3367, device='cuda:0')
distance 2 is tensor(11.5054, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9217962483480286
avg test loss is  1.4744468028865643
avg accuracy is  0.8522333334896566
solo acc is  0.33345000015634024
compute similarity  is  tensor(0.9534, device='cuda:0')
compute_distance is  tensor(11.5054, device='cuda:0')
compute_norm is  tensor(52.6050, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.3079, device='cuda:0')
distance 2 is tensor(11.7920, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8737009690641594
avg test loss is  1.5677089224746232
avg accuracy is  0.8527500001563231
solo acc is  0.2628500001563386
compute similarity  is  tensor(0.9532, device='cuda:0')
compute_distance is  tensor(11.7920, device='cuda:0')
compute_norm is  tensor(52.2662, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.1485, device='cuda:0')
distance 2 is tensor(12.0035, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8591602659428806
avg test loss is  1.5273355321843487
avg accuracy is  0.8540833334896565
solo acc is  0.26525000015633865
compute similarity  is  tensor(0.9530, device='cuda:0')
compute_distance is  tensor(12.0035, device='cuda:0')
compute_norm is  tensor(51.9461, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.9224, device='cuda:0')
distance 2 is tensor(12.1835, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.866395541345641
avg test loss is  1.47613188783243
avg accuracy is  0.856700000156323
solo acc is  0.26735000015633875
compute similarity  is  tensor(0.9529, device='cuda:0')
compute_distance is  tensor(12.1835, device='cuda:0')
compute_norm is  tensor(51.6396, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.6907, device='cuda:0')
distance 2 is tensor(12.3616, device='cuda:0')
________________________________
test distance is  tensor(12.3616, device='cuda:0')
test similarity is  tensor(0.9527, device='cuda:0')
test acc is  0.8591166668229895
test loss is 1.4756256724471477
test entropy is  0.8549404151276994
________________________________
cal ratio is  0.8449053483635032
distance 1 is tensor(118.8713, device='cuda:0')
distance 2 is tensor(10.4444, device='cuda:0')
cal_distance is  tensor(10.4444, device='cuda:0')
distance 1 is tensor(118.8713, device='cuda:0')
distance 2 is tensor(10.4444, device='cuda:0')
________________________________
test distance is  tensor(10.4444, device='cuda:0')
test similarity is  tensor(0.9662, device='cuda:0')
test acc is  0.8747500001563222
test loss is 0.9564625248471811
test entropy is  0.9030480286968288
________________________________
distance 1 is tensor(118.8713, device='cuda:0')
distance 2 is tensor(10.4444, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9022374739651995
avg test loss is  0.9555124912434804
avg accuracy is  0.8743000001563223
solo acc is  0.5981000001563378
compute similarity  is  tensor(0.9662, device='cuda:0')
compute_distance is  tensor(10.4444, device='cuda:0')
compute_norm is  tensor(51.2975, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(122.4811, device='cuda:0')
distance 2 is tensor(10.8985, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8431938895538672
avg test loss is  1.4417837187171236
avg accuracy is  0.8664166668229892
solo acc is  0.26755000015633873
compute similarity  is  tensor(0.9653, device='cuda:0')
compute_distance is  tensor(10.8985, device='cuda:0')
compute_norm is  tensor(50.9932, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(124.7413, device='cuda:0')
distance 2 is tensor(11.1074, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8419667998356606
avg test loss is  1.4305200619992418
avg accuracy is  0.8688666668229892
solo acc is  0.2597000001563385
compute similarity  is  tensor(0.9650, device='cuda:0')
compute_distance is  tensor(11.1074, device='cuda:0')
compute_norm is  tensor(50.7040, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(126.7076, device='cuda:0')
distance 2 is tensor(11.2804, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.840630461412198
avg test loss is  1.411585356253805
avg accuracy is  0.8717333334896558
solo acc is  0.2576500001563385
compute similarity  is  tensor(0.9648, device='cuda:0')
compute_distance is  tensor(11.2804, device='cuda:0')
compute_norm is  tensor(50.4235, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(128.5782, device='cuda:0')
distance 2 is tensor(11.4408, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8353216648737251
avg test loss is  1.395545512501365
avg accuracy is  0.8719166668229891
solo acc is  0.25643333348967173
compute similarity  is  tensor(0.9646, device='cuda:0')
compute_distance is  tensor(11.4408, device='cuda:0')
compute_norm is  tensor(50.1508, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.4052, device='cuda:0')
distance 2 is tensor(11.5969, device='cuda:0')
________________________________
test distance is  tensor(11.5969, device='cuda:0')
test similarity is  tensor(0.9644, device='cuda:0')
test acc is  0.8748500001563223
test loss is 1.3835042094879313
test entropy is  0.8326175616367031
________________________________
cal ratio is  0.87231818902203
distance 1 is tensor(113.7556, device='cuda:0')
distance 2 is tensor(10.1162, device='cuda:0')
cal_distance is  tensor(10.1162, device='cuda:0')
distance 1 is tensor(113.7556, device='cuda:0')
distance 2 is tensor(10.1162, device='cuda:0')
________________________________
test distance is  tensor(10.1162, device='cuda:0')
test similarity is  tensor(0.9732, device='cuda:0')
test acc is  0.8838333334896552
test loss is 0.9342154752471046
test entropy is  0.8822220441883307
________________________________
distance 1 is tensor(113.7556, device='cuda:0')
distance 2 is tensor(10.1162, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8815517513863822
avg test loss is  0.9319786535524356
avg accuracy is  0.883200000156322
solo acc is  0.5931166668230048
compute similarity  is  tensor(0.9732, device='cuda:0')
compute_distance is  tensor(10.1162, device='cuda:0')
compute_norm is  tensor(50.0682, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(117.1713, device='cuda:0')
distance 2 is tensor(10.5200, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8211598528473616
avg test loss is  1.3729408407516317
avg accuracy is  0.8799833334896553
solo acc is  0.2630333334896719
compute similarity  is  tensor(0.9723, device='cuda:0')
compute_distance is  tensor(10.5200, device='cuda:0')
compute_norm is  tensor(49.7924, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(119.3807, device='cuda:0')
distance 2 is tensor(10.7082, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8203031214823855
avg test loss is  1.3541800426775967
avg accuracy is  0.881900000156322
solo acc is  0.2652000001563387
compute similarity  is  tensor(0.9720, device='cuda:0')
compute_distance is  tensor(10.7082, device='cuda:0')
compute_norm is  tensor(49.5250, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(121.4623, device='cuda:0')
distance 2 is tensor(10.8798, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8141923193484227
avg test loss is  1.3456544379181445
avg accuracy is  0.882650000156322
solo acc is  0.2598666668230052
compute similarity  is  tensor(0.9718, device='cuda:0')
compute_distance is  tensor(10.8798, device='cuda:0')
compute_norm is  tensor(49.2630, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(123.4790, device='cuda:0')
distance 2 is tensor(11.0441, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8118885925202481
avg test loss is  1.3370353158857269
avg accuracy is  0.8849666668229885
solo acc is  0.2570000001563384
compute similarity  is  tensor(0.9716, device='cuda:0')
compute_distance is  tensor(11.0441, device='cuda:0')
compute_norm is  tensor(49.0032, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(125.5324, device='cuda:0')
distance 2 is tensor(11.2072, device='cuda:0')
________________________________
test distance is  tensor(11.2072, device='cuda:0')
test similarity is  tensor(0.9713, device='cuda:0')
test acc is  0.8866666668229886
test loss is 1.328116021113101
test entropy is  0.8081528844990964
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.25604248046875
mal norm is  tensor(5.4726, device='cuda:0')
distance 1 is tensor(125.5324, device='cuda:0')
distance 2 is tensor(11.2072, device='cuda:0')
mal distance is  tensor(11.2072, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.0818, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(509.9276, device='cuda:0')
c is  tensor(0.0127, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.0514e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.6984, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.8938e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(373.6125, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.9279, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4373e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.6101, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.1639e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.2841, device='cuda:0')
c is  tensor(0.0115, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.1762, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.7538e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.2998, device='cuda:0')
c is  tensor(0.0118, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2905e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.2580, device='cuda:0')
c is  tensor(0.0122, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4285e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.2335, device='cuda:0')
c is  tensor(0.0107, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.2791e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.8646, device='cuda:0')
c is  tensor(0.0110, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.6035e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.3092, device='cuda:0')
c is  tensor(0.0106, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.8224e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.1482, device='cuda:0')
c is  tensor(0.0107, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.9741e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.7512, device='cuda:0')
c is  tensor(0.0111, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.8669, device='cuda:0')
c is  tensor(0.0108, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.9505e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.2396, device='cuda:0')
c is  tensor(0.0106, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0305e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.6516, device='cuda:0')
c is  tensor(0.0110, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.4434e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.3459, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.1851e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.1711, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.4449e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.0068, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1820e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.3391, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.2988, device='cuda:0')
c is  tensor(0.0114, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.4368e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.7510, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.0012e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.7438, device='cuda:0')
c is  tensor(0.0114, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.4943, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.2448e-05, device='cuda:0')
len accept list 8
len all weights is 8
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 91.06% 

Test Accuracy: 89.10% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
 benign loss is  0.9935070276260376
distance 1 is tensor(120.0781, device='cuda:0')
distance 2 is tensor(8.9984, device='cuda:0')
benign distance is  tensor(8.9984, device='cuda:0')
norm1 res is  tensor(0.1342, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.4676240384578705
distance 1 is tensor(122.9571, device='cuda:0')
distance 2 is tensor(9.0129, device='cuda:0')
benign distance is  tensor(9.0129, device='cuda:0')
norm1 res is  tensor(0.1353, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.14930149912834167
distance 1 is tensor(76.1451, device='cuda:0')
distance 2 is tensor(5.7721, device='cuda:0')
benign distance is  tensor(5.7721, device='cuda:0')
norm1 res is  tensor(0.0838, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3752168118953705
distance 1 is tensor(130.3947, device='cuda:0')
distance 2 is tensor(9.4681, device='cuda:0')
benign distance is  tensor(9.4681, device='cuda:0')
norm1 res is  tensor(0.1409, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.458931028842926
distance 1 is tensor(119.1335, device='cuda:0')
distance 2 is tensor(8.7400, device='cuda:0')
benign distance is  tensor(8.7400, device='cuda:0')
norm1 res is  tensor(0.1317, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.35172712802886963
distance 1 is tensor(133.4060, device='cuda:0')
distance 2 is tensor(9.8614, device='cuda:0')
benign distance is  tensor(9.8614, device='cuda:0')
norm1 res is  tensor(0.1499, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.47251591086387634
distance 1 is tensor(110.8209, device='cuda:0')
distance 2 is tensor(8.0940, device='cuda:0')
benign distance is  tensor(8.0940, device='cuda:0')
norm1 res is  tensor(0.1216, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.1559317708015442
distance 1 is tensor(119.8242, device='cuda:0')
distance 2 is tensor(8.8696, device='cuda:0')
benign distance is  tensor(8.8696, device='cuda:0')
norm1 res is  tensor(0.1367, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.017979199066758156
distance 1 is tensor(128.2653, device='cuda:0')
distance 2 is tensor(9.4537, device='cuda:0')
benign distance is  tensor(9.4537, device='cuda:0')
norm1 res is  tensor(0.1440, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.30266696214675903
distance 1 is tensor(136.4814, device='cuda:0')
distance 2 is tensor(10.0982, device='cuda:0')
benign distance is  tensor(10.0982, device='cuda:0')
norm1 res is  tensor(0.1518, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.5074386596679688
distance 1 is tensor(122.1535, device='cuda:0')
distance 2 is tensor(9.0144, device='cuda:0')
benign distance is  tensor(9.0144, device='cuda:0')
norm1 res is  tensor(0.1344, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5545150637626648
distance 1 is tensor(136.5662, device='cuda:0')
distance 2 is tensor(10.0204, device='cuda:0')
benign distance is  tensor(10.0204, device='cuda:0')
norm1 res is  tensor(0.1508, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.6731012463569641
distance 1 is tensor(120.2405, device='cuda:0')
distance 2 is tensor(9.0743, device='cuda:0')
benign distance is  tensor(9.0743, device='cuda:0')
norm1 res is  tensor(0.1367, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.38996508717536926
distance 1 is tensor(128.1071, device='cuda:0')
distance 2 is tensor(9.5146, device='cuda:0')
benign distance is  tensor(9.5146, device='cuda:0')
norm1 res is  tensor(0.1450, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.2590605616569519
distance 1 is tensor(118.3461, device='cuda:0')
distance 2 is tensor(8.7812, device='cuda:0')
benign distance is  tensor(8.7812, device='cuda:0')
norm1 res is  tensor(0.1326, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.4827348589897156
distance 1 is tensor(144.9993, device='cuda:0')
distance 2 is tensor(10.6359, device='cuda:0')
benign distance is  tensor(10.6359, device='cuda:0')
norm1 res is  tensor(0.1617, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.07769723981618881
distance 1 is tensor(141.3943, device='cuda:0')
distance 2 is tensor(10.5071, device='cuda:0')
benign distance is  tensor(10.5071, device='cuda:0')
norm1 res is  tensor(0.1593, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.44197607040405273
distance 1 is tensor(133.6924, device='cuda:0')
distance 2 is tensor(9.8206, device='cuda:0')
benign distance is  tensor(9.8206, device='cuda:0')
norm1 res is  tensor(0.1477, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.41857343912124634
distance 1 is tensor(146.7145, device='cuda:0')
distance 2 is tensor(10.7152, device='cuda:0')
benign distance is  tensor(10.7152, device='cuda:0')
norm1 res is  tensor(0.1594, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.29298847913742065
distance 1 is tensor(130.8902, device='cuda:0')
distance 2 is tensor(9.8202, device='cuda:0')
benign distance is  tensor(9.8202, device='cuda:0')
norm1 res is  tensor(0.1462, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.4612152576446533
distance 1 is tensor(126.1979, device='cuda:0')
distance 2 is tensor(9.2156, device='cuda:0')
benign distance is  tensor(9.2156, device='cuda:0')
norm1 res is  tensor(0.1387, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.5019378662109375
distance 1 is tensor(137.1492, device='cuda:0')
distance 2 is tensor(10.1252, device='cuda:0')
benign distance is  tensor(10.1252, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.25876668095588684
distance 1 is tensor(135.6718, device='cuda:0')
distance 2 is tensor(10.0125, device='cuda:0')
benign distance is  tensor(10.0125, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.28536540269851685
distance 1 is tensor(129.2100, device='cuda:0')
distance 2 is tensor(9.5566, device='cuda:0')
benign distance is  tensor(9.5566, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(165.6005, device='cuda:0')
distance 2 is tensor(12.3246, device='cuda:0')
compute distance is  tensor(12.3246, device='cuda:0')
compute norm is  tensor(55.3769, device='cuda:0')
distance 1 is tensor(163.0137, device='cuda:0')
distance 2 is tensor(12.1871, device='cuda:0')
compute distance is  tensor(12.1871, device='cuda:0')
compute norm is  tensor(55.4848, device='cuda:0')
distance 1 is tensor(160.2741, device='cuda:0')
distance 2 is tensor(12.1159, device='cuda:0')
compute distance is  tensor(12.1159, device='cuda:0')
compute norm is  tensor(55.4456, device='cuda:0')
distance 1 is tensor(173.6181, device='cuda:0')
distance 2 is tensor(12.9595, device='cuda:0')
compute distance is  tensor(12.9595, device='cuda:0')
compute norm is  tensor(55.7325, device='cuda:0')
distance 1 is tensor(163.7814, device='cuda:0')
distance 2 is tensor(12.3604, device='cuda:0')
compute distance is  tensor(12.3604, device='cuda:0')
compute norm is  tensor(55.4864, device='cuda:0')
distance 1 is tensor(177.7990, device='cuda:0')
distance 2 is tensor(13.2005, device='cuda:0')
compute distance is  tensor(13.2005, device='cuda:0')
compute norm is  tensor(55.7189, device='cuda:0')
distance 1 is tensor(163.3207, device='cuda:0')
distance 2 is tensor(12.2610, device='cuda:0')
compute distance is  tensor(12.2610, device='cuda:0')
compute norm is  tensor(55.4043, device='cuda:0')
distance 1 is tensor(170.0121, device='cuda:0')
distance 2 is tensor(12.6493, device='cuda:0')
compute distance is  tensor(12.6493, device='cuda:0')
compute norm is  tensor(55.5834, device='cuda:0')
distance 1 is tensor(168.0937, device='cuda:0')
distance 2 is tensor(12.5906, device='cuda:0')
compute distance is  tensor(12.5906, device='cuda:0')
compute norm is  tensor(55.7063, device='cuda:0')
distance 1 is tensor(153.2602, device='cuda:0')
distance 2 is tensor(11.5101, device='cuda:0')
compute distance is  tensor(11.5101, device='cuda:0')
compute norm is  tensor(55.1616, device='cuda:0')
distance 1 is tensor(164.6743, device='cuda:0')
distance 2 is tensor(12.3123, device='cuda:0')
compute distance is  tensor(12.3123, device='cuda:0')
compute norm is  tensor(55.5541, device='cuda:0')
distance 1 is tensor(163.7233, device='cuda:0')
distance 2 is tensor(12.1579, device='cuda:0')
compute distance is  tensor(12.1579, device='cuda:0')
compute norm is  tensor(55.4011, device='cuda:0')
distance Threshold  is  tensor(13.2005, device='cuda:0')
distance 1 is tensor(1102069.5000, device='cuda:0')
distance 2 is tensor(79393.4844, device='cuda:0')
________________________________
test distance is  tensor(79393.4844, device='cuda:0')
test similarity is  tensor(-0.0450, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197553978541201e+17
test entropy is  0.0
________________________________
cal ratio is  0.01160501297390327
distance 1 is tensor(12789.5361, device='cuda:0')
distance 2 is tensor(921.3624, device='cuda:0')
cal_distance is  tensor(921.3624, device='cuda:0')
cal ratio is  0.10772656703764717
distance 1 is tensor(1377.7793, device='cuda:0')
distance 2 is tensor(99.2552, device='cuda:0')
cal_distance is  tensor(99.2552, device='cuda:0')
cal ratio is  0.32821726523605327
distance 1 is tensor(452.2158, device='cuda:0')
distance 2 is tensor(32.5773, device='cuda:0')
cal_distance is  tensor(32.5773, device='cuda:0')
cal ratio is  0.5729024716843975
distance 1 is tensor(259.0786, device='cuda:0')
distance 2 is tensor(18.6636, device='cuda:0')
cal_distance is  tensor(18.6636, device='cuda:0')
cal ratio is  0.7569032176968812
distance 1 is tensor(196.0992, device='cuda:0')
distance 2 is tensor(14.1265, device='cuda:0')
cal_distance is  tensor(14.1265, device='cuda:0')
cal ratio is  0.8700018234069395
distance 1 is tensor(170.6076, device='cuda:0')
distance 2 is tensor(12.2901, device='cuda:0')
cal_distance is  tensor(12.2901, device='cuda:0')
distance 1 is tensor(170.6076, device='cuda:0')
distance 2 is tensor(12.2901, device='cuda:0')
________________________________
test distance is  tensor(12.2901, device='cuda:0')
test similarity is  tensor(0.9326, device='cuda:0')
test acc is  0.815933333489658
test loss is 109.87396450896762
test entropy is  0.0005713092520299925
________________________________
distance 1 is tensor(170.6076, device='cuda:0')
distance 2 is tensor(12.2901, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0006690749210270832
avg test loss is  109.51525865892357
avg accuracy is  0.8139500001563248
solo acc is  0.1018833334896653
compute similarity  is  tensor(0.9326, device='cuda:0')
compute_distance is  tensor(12.2901, device='cuda:0')
compute_norm is  tensor(54.2707, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(157.1896, device='cuda:0')
distance 2 is tensor(13.2446, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9381866411232491
avg test loss is  1.4776467571634728
avg accuracy is  0.84676666682299
solo acc is  0.3242833334896734
compute similarity  is  tensor(0.9348, device='cuda:0')
compute_distance is  tensor(13.2446, device='cuda:0')
compute_norm is  tensor(53.2067, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.5357, device='cuda:0')
distance 2 is tensor(13.4802, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8855831665652139
avg test loss is  1.5458241326214155
avg accuracy is  0.8471333334896568
solo acc is  0.2704333334896722
compute similarity  is  tensor(0.9346, device='cuda:0')
compute_distance is  tensor(13.4802, device='cuda:0')
compute_norm is  tensor(52.8689, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.7400, device='cuda:0')
distance 2 is tensor(13.6568, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8781499832169588
avg test loss is  1.5193765077001251
avg accuracy is  0.8493833334896566
solo acc is  0.26403333348967195
compute similarity  is  tensor(0.9345, device='cuda:0')
compute_distance is  tensor(13.6568, device='cuda:0')
compute_norm is  tensor(52.5576, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(160.9744, device='cuda:0')
distance 2 is tensor(13.8162, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8710463899157957
avg test loss is  1.5109730040086613
avg accuracy is  0.8509500001563233
solo acc is  0.25101666682300494
compute similarity  is  tensor(0.9344, device='cuda:0')
compute_distance is  tensor(13.8162, device='cuda:0')
compute_norm is  tensor(52.2575, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(162.1761, device='cuda:0')
distance 2 is tensor(13.9599, device='cuda:0')
________________________________
test distance is  tensor(13.9599, device='cuda:0')
test similarity is  tensor(0.9343, device='cuda:0')
test acc is  0.8539166668229897
test loss is 1.492906374209471
test entropy is  0.8617675616415833
________________________________
cal ratio is  0.8751804972856573
distance 1 is tensor(141.9342, device='cuda:0')
distance 2 is tensor(12.2174, device='cuda:0')
cal_distance is  tensor(12.2174, device='cuda:0')
distance 1 is tensor(141.9342, device='cuda:0')
distance 2 is tensor(12.2174, device='cuda:0')
________________________________
test distance is  tensor(12.2174, device='cuda:0')
test similarity is  tensor(0.9492, device='cuda:0')
test acc is  0.8662833334896559
test loss is 1.0759911947667218
test entropy is  0.9327743174806078
________________________________
distance 1 is tensor(141.9342, device='cuda:0')
distance 2 is tensor(12.2174, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9326079905922733
avg test loss is  1.0731778586469989
avg accuracy is  0.8670000001563226
solo acc is  0.5126166668230088
compute similarity  is  tensor(0.9492, device='cuda:0')
compute_distance is  tensor(12.2174, device='cuda:0')
compute_norm is  tensor(51.7441, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.4413, device='cuda:0')
distance 2 is tensor(12.5401, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8541683034220738
avg test loss is  1.4602307240083527
avg accuracy is  0.8627333334896561
solo acc is  0.25608333348967177
compute similarity  is  tensor(0.9487, device='cuda:0')
compute_distance is  tensor(12.5401, device='cuda:0')
compute_norm is  tensor(51.4511, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.1258, device='cuda:0')
distance 2 is tensor(12.7061, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8494720788144353
avg test loss is  1.4495039362388888
avg accuracy is  0.8657000001563226
solo acc is  0.2544833334896717
compute similarity  is  tensor(0.9485, device='cuda:0')
compute_distance is  tensor(12.7061, device='cuda:0')
compute_norm is  tensor(51.1693, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.7357, device='cuda:0')
distance 2 is tensor(12.8566, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8458070659052843
avg test loss is  1.4373536646239031
avg accuracy is  0.8651166668229894
solo acc is  0.2483500001563382
compute similarity  is  tensor(0.9483, device='cuda:0')
compute_distance is  tensor(12.8566, device='cuda:0')
compute_norm is  tensor(50.8945, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.2421, device='cuda:0')
distance 2 is tensor(12.9902, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8470746942166326
avg test loss is  1.4116869965341807
avg accuracy is  0.8675666668229893
solo acc is  0.24830000015633819
compute similarity  is  tensor(0.9482, device='cuda:0')
compute_distance is  tensor(12.9902, device='cuda:0')
compute_norm is  tensor(50.6255, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.7046, device='cuda:0')
distance 2 is tensor(13.1197, device='cuda:0')
________________________________
test distance is  tensor(13.1197, device='cuda:0')
test similarity is  tensor(0.9481, device='cuda:0')
test acc is  0.8674333334896559
test loss is 1.4032321469361848
test entropy is  0.8439883299982116
________________________________
distance 1 is tensor(150.7046, device='cuda:0')
distance 2 is tensor(13.1197, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8428710095409645
avg test loss is  1.4030247697952205
avg accuracy is  0.8688166668229892
solo acc is  0.24905000015633816
compute similarity  is  tensor(0.9481, device='cuda:0')
compute_distance is  tensor(13.1197, device='cuda:0')
compute_norm is  tensor(50.3606, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.1805, device='cuda:0')
distance 2 is tensor(13.2448, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8377685158618732
avg test loss is  1.3822997492005322
avg accuracy is  0.8707833334896559
solo acc is  0.2540500001563384
compute similarity  is  tensor(0.9479, device='cuda:0')
compute_distance is  tensor(13.2448, device='cuda:0')
compute_norm is  tensor(50.1002, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.6927, device='cuda:0')
distance 2 is tensor(13.3754, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8358544540176513
avg test loss is  1.3712228790783425
avg accuracy is  0.8721833334896557
solo acc is  0.2489166668230048
compute similarity  is  tensor(0.9478, device='cuda:0')
compute_distance is  tensor(13.3754, device='cuda:0')
compute_norm is  tensor(49.8413, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.2120, device='cuda:0')
distance 2 is tensor(13.5002, device='cuda:0')
exit early
distance 1 is tensor(155.2120, device='cuda:0')
distance 2 is tensor(13.5002, device='cuda:0')
________________________________
test distance is  tensor(13.5002, device='cuda:0')
test similarity is  tensor(0.9477, device='cuda:0')
test acc is  0.8738000001563222
test loss is 1.3650395525798107
test entropy is  0.8366028291584332
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.0748590230941772
mal norm is  tensor(7.2148, device='cuda:0')
distance 1 is tensor(155.2120, device='cuda:0')
distance 2 is tensor(13.5002, device='cuda:0')
mal distance is  tensor(13.5002, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1110, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.0620, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.2350e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.1088, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6282e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(334.0350, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.7617e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.0965, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(525.1398, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.3395, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(478.9768, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.5403, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1346e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.4763, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
len accept list 2
len all weights is 2
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 90.65% 

Test Accuracy: 88.84% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
 benign loss is  0.32153481245040894
distance 1 is tensor(136.6649, device='cuda:0')
distance 2 is tensor(10.0861, device='cuda:0')
benign distance is  tensor(10.0861, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5546493530273438
distance 1 is tensor(131.3037, device='cuda:0')
distance 2 is tensor(9.7972, device='cuda:0')
benign distance is  tensor(9.7972, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.16619068384170532
distance 1 is tensor(73.1455, device='cuda:0')
distance 2 is tensor(5.4724, device='cuda:0')
benign distance is  tensor(5.4724, device='cuda:0')
norm1 res is  tensor(0.0813, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3881576657295227
distance 1 is tensor(140.5787, device='cuda:0')
distance 2 is tensor(10.5326, device='cuda:0')
benign distance is  tensor(10.5326, device='cuda:0')
norm1 res is  tensor(0.1584, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.3928014636039734
distance 1 is tensor(120.0708, device='cuda:0')
distance 2 is tensor(8.8154, device='cuda:0')
benign distance is  tensor(8.8154, device='cuda:0')
norm1 res is  tensor(0.1317, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.16068804264068604
distance 1 is tensor(138.5950, device='cuda:0')
distance 2 is tensor(10.2875, device='cuda:0')
benign distance is  tensor(10.2875, device='cuda:0')
norm1 res is  tensor(0.1570, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.7958564758300781
distance 1 is tensor(134.2928, device='cuda:0')
distance 2 is tensor(9.7137, device='cuda:0')
benign distance is  tensor(9.7137, device='cuda:0')
norm1 res is  tensor(0.1452, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.015949422493577003
distance 1 is tensor(104.9857, device='cuda:0')
distance 2 is tensor(7.8416, device='cuda:0')
benign distance is  tensor(7.8416, device='cuda:0')
norm1 res is  tensor(0.1209, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(175.5187, device='cuda:0')
distance 2 is tensor(12.9195, device='cuda:0')
compute distance is  tensor(12.9195, device='cuda:0')
compute norm is  tensor(53.0227, device='cuda:0')
distance 1 is tensor(164.3716, device='cuda:0')
distance 2 is tensor(12.0584, device='cuda:0')
compute distance is  tensor(12.0584, device='cuda:0')
compute norm is  tensor(52.7291, device='cuda:0')
distance 1 is tensor(168.9930, device='cuda:0')
distance 2 is tensor(12.3996, device='cuda:0')
compute distance is  tensor(12.3996, device='cuda:0')
compute norm is  tensor(53.1088, device='cuda:0')
distance 1 is tensor(169.4304, device='cuda:0')
distance 2 is tensor(12.3295, device='cuda:0')
compute distance is  tensor(12.3295, device='cuda:0')
compute norm is  tensor(52.8424, device='cuda:0')
distance 1 is tensor(171.6714, device='cuda:0')
distance 2 is tensor(12.6120, device='cuda:0')
compute distance is  tensor(12.6120, device='cuda:0')
compute norm is  tensor(53.1273, device='cuda:0')
distance 1 is tensor(179.8033, device='cuda:0')
distance 2 is tensor(13.0529, device='cuda:0')
compute distance is  tensor(13.0529, device='cuda:0')
compute norm is  tensor(53.4325, device='cuda:0')
distance 1 is tensor(166.0940, device='cuda:0')
distance 2 is tensor(12.1240, device='cuda:0')
compute distance is  tensor(12.1240, device='cuda:0')
compute norm is  tensor(53.0198, device='cuda:0')
distance 1 is tensor(167.1552, device='cuda:0')
distance 2 is tensor(12.1646, device='cuda:0')
compute distance is  tensor(12.1646, device='cuda:0')
compute norm is  tensor(52.9633, device='cuda:0')
distance 1 is tensor(159.0224, device='cuda:0')
distance 2 is tensor(11.6870, device='cuda:0')
compute distance is  tensor(11.6870, device='cuda:0')
compute norm is  tensor(52.8039, device='cuda:0')
distance 1 is tensor(170.0206, device='cuda:0')
distance 2 is tensor(12.3957, device='cuda:0')
compute distance is  tensor(12.3957, device='cuda:0')
compute norm is  tensor(52.9773, device='cuda:0')
distance 1 is tensor(169.0619, device='cuda:0')
distance 2 is tensor(12.1875, device='cuda:0')
compute distance is  tensor(12.1875, device='cuda:0')
compute norm is  tensor(53.0558, device='cuda:0')
distance 1 is tensor(168.0385, device='cuda:0')
distance 2 is tensor(12.3957, device='cuda:0')
compute distance is  tensor(12.3957, device='cuda:0')
compute norm is  tensor(53.1160, device='cuda:0')
distance Threshold  is  tensor(13.0529, device='cuda:0')
distance 1 is tensor(1102068.7500, device='cuda:0')
distance 2 is tensor(79393.5000, device='cuda:0')
________________________________
test distance is  tensor(79393.5000, device='cuda:0')
test similarity is  tensor(-0.0477, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.200261588929663e+17
test entropy is  0.0
________________________________
cal ratio is  0.011539940374763
distance 1 is tensor(12717.8145, device='cuda:0')
distance 2 is tensor(916.1963, device='cuda:0')
cal_distance is  tensor(916.1963, device='cuda:0')
cal ratio is  0.10742411121294973
distance 1 is tensor(1366.2063, device='cuda:0')
distance 2 is tensor(98.4216, device='cuda:0')
cal_distance is  tensor(98.4216, device='cuda:0')
cal ratio is  0.3277561785205046
distance 1 is tensor(447.7874, device='cuda:0')
distance 2 is tensor(32.2583, device='cuda:0')
cal_distance is  tensor(32.2583, device='cuda:0')
cal ratio is  0.5724999515042014
distance 1 is tensor(256.3613, device='cuda:0')
distance 2 is tensor(18.4679, device='cuda:0')
cal_distance is  tensor(18.4679, device='cuda:0')
cal ratio is  0.756637279402663
distance 1 is tensor(193.9743, device='cuda:0')
distance 2 is tensor(13.9735, device='cuda:0')
cal_distance is  tensor(13.9735, device='cuda:0')
cal ratio is  0.8698490076332728
distance 1 is tensor(168.7293, device='cuda:0')
distance 2 is tensor(12.1548, device='cuda:0')
cal_distance is  tensor(12.1548, device='cuda:0')
distance 1 is tensor(168.7293, device='cuda:0')
distance 2 is tensor(12.1548, device='cuda:0')
________________________________
test distance is  tensor(12.1548, device='cuda:0')
test similarity is  tensor(0.9355, device='cuda:0')
test acc is  0.8066833334896585
test loss is 113.23797685505231
test entropy is  0.0010459057441223128
________________________________
distance 1 is tensor(168.7293, device='cuda:0')
distance 2 is tensor(12.1548, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0010804373673365406
avg test loss is  113.16502630075158
avg accuracy is  0.8092666668229918
solo acc is  0.1044833334896653
compute similarity  is  tensor(0.9355, device='cuda:0')
compute_distance is  tensor(12.1548, device='cuda:0')
compute_norm is  tensor(54.8034, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(156.5396, device='cuda:0')
distance 2 is tensor(13.2961, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9102607019293283
avg test loss is  1.544110658199294
avg accuracy is  0.8351500001563238
solo acc is  0.30848333348967305
compute similarity  is  tensor(0.9373, device='cuda:0')
compute_distance is  tensor(13.2961, device='cuda:0')
compute_norm is  tensor(53.7239, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.3425, device='cuda:0')
distance 2 is tensor(13.5619, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8884519874922502
avg test loss is  1.5813933127978717
avg accuracy is  0.8339333334896573
solo acc is  0.2612833334896719
compute similarity  is  tensor(0.9371, device='cuda:0')
compute_distance is  tensor(13.5619, device='cuda:0')
compute_norm is  tensor(53.3839, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.8264, device='cuda:0')
distance 2 is tensor(13.7496, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8883542166844106
avg test loss is  1.5411772894452629
avg accuracy is  0.8375500001563237
solo acc is  0.2580833334896717
compute similarity  is  tensor(0.9369, device='cuda:0')
compute_distance is  tensor(13.7496, device='cuda:0')
compute_norm is  tensor(53.0689, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(161.2372, device='cuda:0')
distance 2 is tensor(13.9147, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8799702139424362
avg test loss is  1.5203879267167943
avg accuracy is  0.8390000001563237
solo acc is  0.25738333348967185
compute similarity  is  tensor(0.9368, device='cuda:0')
compute_distance is  tensor(13.9147, device='cuda:0')
compute_norm is  tensor(52.7672, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(162.5509, device='cuda:0')
distance 2 is tensor(14.0598, device='cuda:0')
________________________________
test distance is  tensor(14.0598, device='cuda:0')
test similarity is  tensor(0.9366, device='cuda:0')
test acc is  0.840133333489657
test loss is 1.50129609677329
test entropy is  0.8737760607494729
________________________________
cal ratio is  0.8671735319095178
distance 1 is tensor(140.9606, device='cuda:0')
distance 2 is tensor(12.1923, device='cuda:0')
cal_distance is  tensor(12.1923, device='cuda:0')
distance 1 is tensor(140.9606, device='cuda:0')
distance 2 is tensor(12.1923, device='cuda:0')
________________________________
test distance is  tensor(12.1923, device='cuda:0')
test similarity is  tensor(0.9519, device='cuda:0')
test acc is  0.8554166668229897
test loss is 1.0747388596854992
test entropy is  0.945174731425385
________________________________
distance 1 is tensor(140.9606, device='cuda:0')
distance 2 is tensor(12.1923, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9456294378492115
avg test loss is  1.0726135336895233
avg accuracy is  0.8551166668229898
solo acc is  0.521016666823009
compute similarity  is  tensor(0.9519, device='cuda:0')
compute_distance is  tensor(12.1923, device='cuda:0')
compute_norm is  tensor(52.2612, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.8173, device='cuda:0')
distance 2 is tensor(12.5498, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8551583930627623
avg test loss is  1.4840623008162737
avg accuracy is  0.8506500001563232
solo acc is  0.25336666682300496
compute similarity  is  tensor(0.9513, device='cuda:0')
compute_distance is  tensor(12.5498, device='cuda:0')
compute_norm is  tensor(51.9654, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.6587, device='cuda:0')
distance 2 is tensor(12.7302, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8593695402018297
avg test loss is  1.4639627252306258
avg accuracy is  0.8514166668229898
solo acc is  0.2511500001563383
compute similarity  is  tensor(0.9510, device='cuda:0')
compute_distance is  tensor(12.7302, device='cuda:0')
compute_norm is  tensor(51.6787, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.2899, device='cuda:0')
distance 2 is tensor(12.8798, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8599501273779473
avg test loss is  1.4333945066689937
avg accuracy is  0.8543666668229898
solo acc is  0.25321666682300503
compute similarity  is  tensor(0.9509, device='cuda:0')
compute_distance is  tensor(12.8798, device='cuda:0')
compute_norm is  tensor(51.4012, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.8472, device='cuda:0')
distance 2 is tensor(13.0202, device='cuda:0')
exit early
distance 1 is tensor(148.8472, device='cuda:0')
distance 2 is tensor(13.0202, device='cuda:0')
________________________________
test distance is  tensor(13.0202, device='cuda:0')
test similarity is  tensor(0.9507, device='cuda:0')
test acc is  0.8545166668229898
test loss is 1.4337356995417874
test entropy is  0.8542685652338365
________________________________
distance 1 is tensor(148.8472, device='cuda:0')
distance 2 is tensor(13.0202, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8526123368790918
avg test loss is  1.4318928648668057
avg accuracy is  0.8547500001563231
solo acc is  0.24556666682300474
compute similarity  is  tensor(0.9507, device='cuda:0')
compute_distance is  tensor(13.0202, device='cuda:0')
compute_norm is  tensor(51.1306, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.4755, device='cuda:0')
distance 2 is tensor(13.1606, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8496947258011873
avg test loss is  1.4258173575787656
avg accuracy is  0.8572333334896564
solo acc is  0.24236666682300465
compute similarity  is  tensor(0.9505, device='cuda:0')
compute_distance is  tensor(13.1606, device='cuda:0')
compute_norm is  tensor(50.8641, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.0188, device='cuda:0')
distance 2 is tensor(13.2908, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8471630989615597
avg test loss is  1.414310902293557
avg accuracy is  0.8574333334896563
solo acc is  0.24253333348967132
compute similarity  is  tensor(0.9504, device='cuda:0')
compute_distance is  tensor(13.2908, device='cuda:0')
compute_norm is  tensor(50.6021, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.5635, device='cuda:0')
distance 2 is tensor(13.4169, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8433492929696529
avg test loss is  1.3941392971000184
avg accuracy is  0.8595666668229895
solo acc is  0.24435000015633804
compute similarity  is  tensor(0.9502, device='cuda:0')
compute_distance is  tensor(13.4169, device='cuda:0')
compute_norm is  tensor(50.3432, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.1351, device='cuda:0')
distance 2 is tensor(13.5444, device='cuda:0')
exit early
distance 1 is tensor(155.1351, device='cuda:0')
distance 2 is tensor(13.5444, device='cuda:0')
________________________________
test distance is  tensor(13.5444, device='cuda:0')
test similarity is  tensor(0.9501, device='cuda:0')
test acc is  0.8596333334896562
test loss is 1.3936781518494905
test entropy is  0.8360600759352702
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.1674284934997559
mal norm is  tensor(7.1493, device='cuda:0')
distance 1 is tensor(155.1351, device='cuda:0')
distance 2 is tensor(13.5444, device='cuda:0')
mal distance is  tensor(13.5444, device='cuda:0')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1293, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.3109, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.0726, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.4815e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(311.8330, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.9834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.3622, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.0539e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.8297, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.8723e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8179, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.7638e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.8687, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3296e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(474.7142, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.2660e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9273, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3273e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.1714, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.5531e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.2384, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.0851, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3902e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(748.5861, device='cuda:0')
c is  tensor(0.0131, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.7343, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(781.3591, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.8876, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9283e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.2878, device='cuda:0')
c is  tensor(0.0131, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.4786e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.0630, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.7280, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4155e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.2126, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.0217e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.0011, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.9666, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.9993, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.0033e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.6336, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.7965e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.2969, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.5213e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.6964, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.8795, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.9932, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.1502e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.3947, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.7549e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.8342, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.9618e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.2881, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.4519e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.9286, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.3530, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4209e-05, device='cuda:0')
len accept list 30
len all weights is 30
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 90.42% 

Test Accuracy: 88.95% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
 benign loss is  0.08990316092967987
distance 1 is tensor(159.1939, device='cuda:0')
distance 2 is tensor(11.7473, device='cuda:0')
benign distance is  tensor(11.7473, device='cuda:0')
norm1 res is  tensor(0.1711, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.2956126630306244
distance 1 is tensor(137.1708, device='cuda:0')
distance 2 is tensor(10.0814, device='cuda:0')
benign distance is  tensor(10.0814, device='cuda:0')
norm1 res is  tensor(0.1452, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.3347140848636627
distance 1 is tensor(113.4737, device='cuda:0')
distance 2 is tensor(8.4258, device='cuda:0')
benign distance is  tensor(8.4258, device='cuda:0')
norm1 res is  tensor(0.1218, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.1772889792919159
distance 1 is tensor(146.9277, device='cuda:0')
distance 2 is tensor(10.9382, device='cuda:0')
benign distance is  tensor(10.9382, device='cuda:0')
norm1 res is  tensor(0.1594, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7133013010025024
distance 1 is tensor(131.9938, device='cuda:0')
distance 2 is tensor(9.8362, device='cuda:0')
benign distance is  tensor(9.8362, device='cuda:0')
norm1 res is  tensor(0.1426, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5839934945106506
distance 1 is tensor(145.3284, device='cuda:0')
distance 2 is tensor(10.6587, device='cuda:0')
benign distance is  tensor(10.6587, device='cuda:0')
norm1 res is  tensor(0.1547, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.2373029738664627
distance 1 is tensor(133.1042, device='cuda:0')
distance 2 is tensor(9.6909, device='cuda:0')
benign distance is  tensor(9.6909, device='cuda:0')
norm1 res is  tensor(0.1396, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.37708741426467896
distance 1 is tensor(130.7792, device='cuda:0')
distance 2 is tensor(9.6096, device='cuda:0')
benign distance is  tensor(9.6096, device='cuda:0')
norm1 res is  tensor(0.1430, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.4625313878059387
distance 1 is tensor(162.9095, device='cuda:0')
distance 2 is tensor(11.9235, device='cuda:0')
benign distance is  tensor(11.9235, device='cuda:0')
norm1 res is  tensor(0.1761, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.47597044706344604
distance 1 is tensor(144.6197, device='cuda:0')
distance 2 is tensor(10.8101, device='cuda:0')
benign distance is  tensor(10.8101, device='cuda:0')
norm1 res is  tensor(0.1561, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.7819465398788452
distance 1 is tensor(151.0790, device='cuda:0')
distance 2 is tensor(11.1165, device='cuda:0')
benign distance is  tensor(11.1165, device='cuda:0')
norm1 res is  tensor(0.1585, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.2990492582321167
distance 1 is tensor(162.6654, device='cuda:0')
distance 2 is tensor(11.8000, device='cuda:0')
benign distance is  tensor(11.8000, device='cuda:0')
norm1 res is  tensor(0.1727, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.3663819432258606
distance 1 is tensor(140.2610, device='cuda:0')
distance 2 is tensor(10.5410, device='cuda:0')
benign distance is  tensor(10.5410, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.13252480328083038
distance 1 is tensor(136.3452, device='cuda:0')
distance 2 is tensor(10.2048, device='cuda:0')
benign distance is  tensor(10.2048, device='cuda:0')
norm1 res is  tensor(0.1476, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.06593738496303558
distance 1 is tensor(147.7002, device='cuda:0')
distance 2 is tensor(10.8849, device='cuda:0')
benign distance is  tensor(10.8849, device='cuda:0')
norm1 res is  tensor(0.1576, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.6258879899978638
distance 1 is tensor(161.5833, device='cuda:0')
distance 2 is tensor(12.1069, device='cuda:0')
benign distance is  tensor(12.1069, device='cuda:0')
norm1 res is  tensor(0.1750, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.24531443417072296
distance 1 is tensor(159.1444, device='cuda:0')
distance 2 is tensor(11.6880, device='cuda:0')
benign distance is  tensor(11.6880, device='cuda:0')
norm1 res is  tensor(0.1700, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  1.171823263168335
distance 1 is tensor(153.4632, device='cuda:0')
distance 2 is tensor(11.4602, device='cuda:0')
benign distance is  tensor(11.4602, device='cuda:0')
norm1 res is  tensor(0.1655, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.3487901985645294
distance 1 is tensor(147.9516, device='cuda:0')
distance 2 is tensor(11.0474, device='cuda:0')
benign distance is  tensor(11.0474, device='cuda:0')
norm1 res is  tensor(0.1589, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.5484582781791687
distance 1 is tensor(142.6039, device='cuda:0')
distance 2 is tensor(10.5857, device='cuda:0')
benign distance is  tensor(10.5857, device='cuda:0')
norm1 res is  tensor(0.1538, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.8545126914978027
distance 1 is tensor(149.4791, device='cuda:0')
distance 2 is tensor(11.0862, device='cuda:0')
benign distance is  tensor(11.0862, device='cuda:0')
norm1 res is  tensor(0.1615, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8380802869796753
distance 1 is tensor(128.1290, device='cuda:0')
distance 2 is tensor(9.4356, device='cuda:0')
benign distance is  tensor(9.4356, device='cuda:0')
norm1 res is  tensor(0.1343, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.2372162640094757
distance 1 is tensor(158.3476, device='cuda:0')
distance 2 is tensor(11.9254, device='cuda:0')
benign distance is  tensor(11.9254, device='cuda:0')
norm1 res is  tensor(0.1723, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.9293946027755737
distance 1 is tensor(155.6634, device='cuda:0')
distance 2 is tensor(11.5790, device='cuda:0')
benign distance is  tensor(11.5790, device='cuda:0')
norm1 res is  tensor(0.1688, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.44798406958580017
distance 1 is tensor(161.4810, device='cuda:0')
distance 2 is tensor(11.9285, device='cuda:0')
benign distance is  tensor(11.9285, device='cuda:0')
norm1 res is  tensor(0.1722, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.4541218876838684
distance 1 is tensor(150.3058, device='cuda:0')
distance 2 is tensor(11.0916, device='cuda:0')
benign distance is  tensor(11.0916, device='cuda:0')
norm1 res is  tensor(0.1614, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.3628815710544586
distance 1 is tensor(134.4256, device='cuda:0')
distance 2 is tensor(9.9339, device='cuda:0')
benign distance is  tensor(9.9339, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.9052168726921082
distance 1 is tensor(154.1036, device='cuda:0')
distance 2 is tensor(11.5051, device='cuda:0')
benign distance is  tensor(11.5051, device='cuda:0')
norm1 res is  tensor(0.1659, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.13955768942832947
distance 1 is tensor(140.8213, device='cuda:0')
distance 2 is tensor(10.5625, device='cuda:0')
benign distance is  tensor(10.5625, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.7248093485832214
distance 1 is tensor(159.9648, device='cuda:0')
distance 2 is tensor(11.8224, device='cuda:0')
benign distance is  tensor(11.8224, device='cuda:0')
norm1 res is  tensor(0.1713, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.5924217104911804
distance 1 is tensor(152.6405, device='cuda:0')
distance 2 is tensor(11.0258, device='cuda:0')
benign distance is  tensor(11.0258, device='cuda:0')
norm1 res is  tensor(0.1604, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.382728636264801
distance 1 is tensor(151.3744, device='cuda:0')
distance 2 is tensor(11.3198, device='cuda:0')
benign distance is  tensor(11.3198, device='cuda:0')
norm1 res is  tensor(0.1626, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(149.6983, device='cuda:0')
distance 2 is tensor(11.0235, device='cuda:0')
compute distance is  tensor(11.0235, device='cuda:0')
compute norm is  tensor(52.9378, device='cuda:0')
distance 1 is tensor(151.4005, device='cuda:0')
distance 2 is tensor(11.3571, device='cuda:0')
compute distance is  tensor(11.3571, device='cuda:0')
compute norm is  tensor(53.2126, device='cuda:0')
distance 1 is tensor(163.6815, device='cuda:0')
distance 2 is tensor(12.2236, device='cuda:0')
compute distance is  tensor(12.2236, device='cuda:0')
compute norm is  tensor(53.4464, device='cuda:0')
distance 1 is tensor(151.7193, device='cuda:0')
distance 2 is tensor(11.1313, device='cuda:0')
compute distance is  tensor(11.1313, device='cuda:0')
compute norm is  tensor(53.0534, device='cuda:0')
distance 1 is tensor(158.7363, device='cuda:0')
distance 2 is tensor(11.7675, device='cuda:0')
compute distance is  tensor(11.7675, device='cuda:0')
compute norm is  tensor(53.3285, device='cuda:0')
distance 1 is tensor(156.7835, device='cuda:0')
distance 2 is tensor(11.6261, device='cuda:0')
compute distance is  tensor(11.6261, device='cuda:0')
compute norm is  tensor(53.3512, device='cuda:0')
distance 1 is tensor(155.9060, device='cuda:0')
distance 2 is tensor(11.3627, device='cuda:0')
compute distance is  tensor(11.3627, device='cuda:0')
compute norm is  tensor(53.1520, device='cuda:0')
distance 1 is tensor(159.0507, device='cuda:0')
distance 2 is tensor(11.7477, device='cuda:0')
compute distance is  tensor(11.7477, device='cuda:0')
compute norm is  tensor(53.2926, device='cuda:0')
distance 1 is tensor(157.4510, device='cuda:0')
distance 2 is tensor(11.6179, device='cuda:0')
compute distance is  tensor(11.6179, device='cuda:0')
compute norm is  tensor(53.4522, device='cuda:0')
distance 1 is tensor(148.3863, device='cuda:0')
distance 2 is tensor(10.9156, device='cuda:0')
compute distance is  tensor(10.9156, device='cuda:0')
compute norm is  tensor(53.1036, device='cuda:0')
distance 1 is tensor(157.3875, device='cuda:0')
distance 2 is tensor(11.3619, device='cuda:0')
compute distance is  tensor(11.3619, device='cuda:0')
compute norm is  tensor(53.1866, device='cuda:0')
distance 1 is tensor(155.5529, device='cuda:0')
distance 2 is tensor(11.6192, device='cuda:0')
compute distance is  tensor(11.6192, device='cuda:0')
compute norm is  tensor(53.3465, device='cuda:0')
distance Threshold  is  tensor(12.2236, device='cuda:0')
distance 1 is tensor(1102037.5000, device='cuda:0')
distance 2 is tensor(79390.8828, device='cuda:0')
________________________________
test distance is  tensor(79390.8828, device='cuda:0')
test similarity is  tensor(0.0404, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197360468011273e+17
test entropy is  0.0
________________________________
cal ratio is  0.011167506575465289
distance 1 is tensor(12307.0176, device='cuda:0')
distance 2 is tensor(886.5982, device='cuda:0')
cal_distance is  tensor(886.5982, device='cuda:0')
cal ratio is  0.10567642389043636
distance 1 is tensor(1300.5684, device='cuda:0')
distance 2 is tensor(93.6925, device='cuda:0')
cal_distance is  tensor(93.6925, device='cuda:0')
cal ratio is  0.3250791187449959
distance 1 is tensor(422.7924, device='cuda:0')
distance 2 is tensor(30.4575, device='cuda:0')
cal_distance is  tensor(30.4575, device='cuda:0')
cal ratio is  0.5701570886996231
distance 1 is tensor(241.0612, device='cuda:0')
distance 2 is tensor(17.3656, device='cuda:0')
cal_distance is  tensor(17.3656, device='cuda:0')
cal ratio is  0.7550874467758809
distance 1 is tensor(182.0241, device='cuda:0')
distance 2 is tensor(13.1125, device='cuda:0')
cal_distance is  tensor(13.1125, device='cuda:0')
cal ratio is  0.868957690242754
distance 1 is tensor(158.1722, device='cuda:0')
distance 2 is tensor(11.3942, device='cuda:0')
cal_distance is  tensor(11.3942, device='cuda:0')
distance 1 is tensor(158.1722, device='cuda:0')
distance 2 is tensor(11.3942, device='cuda:0')
________________________________
test distance is  tensor(11.3942, device='cuda:0')
test similarity is  tensor(0.9426, device='cuda:0')
test acc is  0.5619166668230076
test loss is 103.8931113692489
test entropy is  7.086089119355669e-05
________________________________
distance 1 is tensor(158.1722, device='cuda:0')
distance 2 is tensor(11.3942, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  6.329601526115806e-05
avg test loss is  104.0558535041077
avg accuracy is  0.563583333489674
solo acc is  0.10015000015633198
compute similarity  is  tensor(0.9426, device='cuda:0')
compute_distance is  tensor(11.3942, device='cuda:0')
compute_norm is  tensor(53.9244, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(144.4782, device='cuda:0')
distance 2 is tensor(11.9426, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9185282928603036
avg test loss is  1.4643170467571918
avg accuracy is  0.7943666668229923
solo acc is  0.308133333489673
compute similarity  is  tensor(0.9447, device='cuda:0')
compute_distance is  tensor(11.9426, device='cuda:0')
compute_norm is  tensor(53.1622, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(144.4782, device='cuda:0')
distance 2 is tensor(11.9426, device='cuda:0')
________________________________
test distance is  tensor(11.9426, device='cuda:0')
test similarity is  tensor(0.9447, device='cuda:0')
test acc is  0.7918500001563258
test loss is 1.4598879336294082
test entropy is  0.9177443170344143
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.459260106086731
mal norm is  tensor(7.7083, device='cuda:0')
distance 1 is tensor(144.4782, device='cuda:0')
distance 2 is tensor(11.9426, device='cuda:0')
mal distance is  tensor(11.9426, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1542, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.6700, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.2517, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(480.4028, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.2010, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.2264, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1069e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9197, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.0497e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.6042, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.2631, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.9750e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.8270, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
len accept list 6
len all weights is 6
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 90.85% 

Test Accuracy: 89.44% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
 benign loss is  0.044870004057884216
distance 1 is tensor(112.3087, device='cuda:0')
distance 2 is tensor(8.3218, device='cuda:0')
benign distance is  tensor(8.3218, device='cuda:0')
norm1 res is  tensor(0.1223, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.3194369077682495
distance 1 is tensor(120.6791, device='cuda:0')
distance 2 is tensor(8.8261, device='cuda:0')
benign distance is  tensor(8.8261, device='cuda:0')
norm1 res is  tensor(0.1322, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.13312488794326782
distance 1 is tensor(88.8814, device='cuda:0')
distance 2 is tensor(6.7110, device='cuda:0')
benign distance is  tensor(6.7110, device='cuda:0')
norm1 res is  tensor(0.0969, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.36975622177124023
distance 1 is tensor(138.5599, device='cuda:0')
distance 2 is tensor(10.1408, device='cuda:0')
benign distance is  tensor(10.1408, device='cuda:0')
norm1 res is  tensor(0.1479, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7541830539703369
distance 1 is tensor(129.3426, device='cuda:0')
distance 2 is tensor(9.3797, device='cuda:0')
benign distance is  tensor(9.3797, device='cuda:0')
norm1 res is  tensor(0.1374, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.2995733618736267
distance 1 is tensor(138.1495, device='cuda:0')
distance 2 is tensor(10.2006, device='cuda:0')
benign distance is  tensor(10.2006, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.15511861443519592
distance 1 is tensor(122.9624, device='cuda:0')
distance 2 is tensor(8.8954, device='cuda:0')
benign distance is  tensor(8.8954, device='cuda:0')
norm1 res is  tensor(0.1315, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5918108224868774
distance 1 is tensor(115.6257, device='cuda:0')
distance 2 is tensor(8.4342, device='cuda:0')
benign distance is  tensor(8.4342, device='cuda:0')
norm1 res is  tensor(0.1267, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(150.3983, device='cuda:0')
distance 2 is tensor(11.1107, device='cuda:0')
compute distance is  tensor(11.1107, device='cuda:0')
compute norm is  tensor(53.3444, device='cuda:0')
distance 1 is tensor(159.3584, device='cuda:0')
distance 2 is tensor(11.5994, device='cuda:0')
compute distance is  tensor(11.5994, device='cuda:0')
compute norm is  tensor(53.4827, device='cuda:0')
distance 1 is tensor(168.5874, device='cuda:0')
distance 2 is tensor(12.2723, device='cuda:0')
compute distance is  tensor(12.2723, device='cuda:0')
compute norm is  tensor(53.7322, device='cuda:0')
distance 1 is tensor(154.6853, device='cuda:0')
distance 2 is tensor(11.3030, device='cuda:0')
compute distance is  tensor(11.3030, device='cuda:0')
compute norm is  tensor(53.4473, device='cuda:0')
distance 1 is tensor(157.8209, device='cuda:0')
distance 2 is tensor(11.6089, device='cuda:0')
compute distance is  tensor(11.6089, device='cuda:0')
compute norm is  tensor(53.4976, device='cuda:0')
distance 1 is tensor(158.8057, device='cuda:0')
distance 2 is tensor(11.7461, device='cuda:0')
compute distance is  tensor(11.7461, device='cuda:0')
compute norm is  tensor(53.6139, device='cuda:0')
distance 1 is tensor(151.1279, device='cuda:0')
distance 2 is tensor(11.1959, device='cuda:0')
compute distance is  tensor(11.1959, device='cuda:0')
compute norm is  tensor(53.4948, device='cuda:0')
distance 1 is tensor(153.3303, device='cuda:0')
distance 2 is tensor(11.2057, device='cuda:0')
compute distance is  tensor(11.2057, device='cuda:0')
compute norm is  tensor(53.3947, device='cuda:0')
distance 1 is tensor(159.8293, device='cuda:0')
distance 2 is tensor(11.9304, device='cuda:0')
compute distance is  tensor(11.9304, device='cuda:0')
compute norm is  tensor(53.6213, device='cuda:0')
distance 1 is tensor(156.4669, device='cuda:0')
distance 2 is tensor(11.4193, device='cuda:0')
compute distance is  tensor(11.4193, device='cuda:0')
compute norm is  tensor(53.4982, device='cuda:0')
distance 1 is tensor(161.5540, device='cuda:0')
distance 2 is tensor(11.9650, device='cuda:0')
compute distance is  tensor(11.9650, device='cuda:0')
compute norm is  tensor(53.8075, device='cuda:0')
distance 1 is tensor(153.7715, device='cuda:0')
distance 2 is tensor(11.2968, device='cuda:0')
compute distance is  tensor(11.2968, device='cuda:0')
compute norm is  tensor(53.5219, device='cuda:0')
distance Threshold  is  tensor(12.2723, device='cuda:0')
distance 1 is tensor(1102045.6250, device='cuda:0')
distance 2 is tensor(79391.7656, device='cuda:0')
________________________________
test distance is  tensor(79391.7656, device='cuda:0')
test similarity is  tensor(0.0184, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.199542876245366e+17
test entropy is  0.0
________________________________
cal ratio is  0.011189663869818232
distance 1 is tensor(12331.5264, device='cuda:0')
distance 2 is tensor(888.3671, device='cuda:0')
cal_distance is  tensor(888.3671, device='cuda:0')
cal ratio is  0.10578120797035306
distance 1 is tensor(1304.4502, device='cuda:0')
distance 2 is tensor(93.9725, device='cuda:0')
cal_distance is  tensor(93.9725, device='cuda:0')
cal ratio is  0.32524021972711925
distance 1 is tensor(424.2645, device='cuda:0')
distance 2 is tensor(30.5637, device='cuda:0')
cal_distance is  tensor(30.5637, device='cuda:0')
cal ratio is  0.570298377606845
distance 1 is tensor(241.9605, device='cuda:0')
distance 2 is tensor(17.4304, device='cuda:0')
cal_distance is  tensor(17.4304, device='cuda:0')
cal ratio is  0.7551809841772468
distance 1 is tensor(182.7257, device='cuda:0')
distance 2 is tensor(13.1631, device='cuda:0')
cal_distance is  tensor(13.1631, device='cuda:0')
cal ratio is  0.8690115545210316
distance 1 is tensor(158.7917, device='cuda:0')
distance 2 is tensor(11.4389, device='cuda:0')
cal_distance is  tensor(11.4389, device='cuda:0')
distance 1 is tensor(158.7917, device='cuda:0')
distance 2 is tensor(11.4389, device='cuda:0')
________________________________
test distance is  tensor(11.4389, device='cuda:0')
test similarity is  tensor(0.9425, device='cuda:0')
test acc is  0.7752166668229933
test loss is 95.05739582932071
test entropy is  0.0007923993964908551
________________________________
distance 1 is tensor(158.7917, device='cuda:0')
distance 2 is tensor(11.4389, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0007936429236922337
avg test loss is  95.14256033663557
avg accuracy is  0.7737666668229933
solo acc is  0.10250000015633197
compute similarity  is  tensor(0.9425, device='cuda:0')
compute_distance is  tensor(11.4389, device='cuda:0')
compute_norm is  tensor(54.1534, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.1385, device='cuda:0')
distance 2 is tensor(12.2787, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9162055875446751
avg test loss is  1.4405367820501835
avg accuracy is  0.8356833334896573
solo acc is  0.3208166668230066
compute similarity  is  tensor(0.9441, device='cuda:0')
compute_distance is  tensor(12.2787, device='cuda:0')
compute_norm is  tensor(53.2960, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.2285, device='cuda:0')
distance 2 is tensor(12.4685, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8818234357117082
avg test loss is  1.5080558188688526
avg accuracy is  0.8350000001563238
solo acc is  0.266183333489672
compute similarity  is  tensor(0.9440, device='cuda:0')
compute_distance is  tensor(12.4685, device='cuda:0')
compute_norm is  tensor(52.9835, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.1733, device='cuda:0')
distance 2 is tensor(12.6070, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8687629533856154
avg test loss is  1.4993353643651202
avg accuracy is  0.8361000001563238
solo acc is  0.25325000015633836
compute similarity  is  tensor(0.9440, device='cuda:0')
compute_distance is  tensor(12.6070, device='cuda:0')
compute_norm is  tensor(52.6851, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.1906, device='cuda:0')
distance 2 is tensor(12.7344, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8707849876458711
avg test loss is  1.4716426688216642
avg accuracy is  0.8379666668229904
solo acc is  0.2509333334896716
compute similarity  is  tensor(0.9439, device='cuda:0')
compute_distance is  tensor(12.7344, device='cuda:0')
compute_norm is  tensor(52.3972, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.1128, device='cuda:0')
distance 2 is tensor(12.8436, device='cuda:0')
________________________________
test distance is  tensor(12.8436, device='cuda:0')
test similarity is  tensor(0.9439, device='cuda:0')
test acc is  0.8371666668229905
test loss is 1.4525509674920203
test entropy is  0.8634623709136743
________________________________
cal ratio is  0.8797538484991635
distance 1 is tensor(132.9428, device='cuda:0')
distance 2 is tensor(11.2992, device='cuda:0')
cal_distance is  tensor(11.2992, device='cuda:0')
distance 1 is tensor(132.9428, device='cuda:0')
distance 2 is tensor(11.2992, device='cuda:0')
________________________________
test distance is  tensor(11.2992, device='cuda:0')
test similarity is  tensor(0.9560, device='cuda:0')
test acc is  0.8542666668229898
test loss is 1.1021550798466972
test entropy is  0.9310709332098076
________________________________
distance 1 is tensor(132.9428, device='cuda:0')
distance 2 is tensor(11.2992, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.931860306433269
avg test loss is  1.1018507675702638
avg accuracy is  0.8548833334896563
solo acc is  0.47870000015634195
compute similarity  is  tensor(0.9560, device='cuda:0')
compute_distance is  tensor(11.2992, device='cuda:0')
compute_norm is  tensor(51.8687, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.9004, device='cuda:0')
distance 2 is tensor(11.5558, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8503649713896485
avg test loss is  1.4215748320256214
avg accuracy is  0.8496833334896565
solo acc is  0.2586333334896718
compute similarity  is  tensor(0.9556, device='cuda:0')
compute_distance is  tensor(11.5558, device='cuda:0')
compute_norm is  tensor(51.5887, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.3229, device='cuda:0')
distance 2 is tensor(11.6993, device='cuda:0')
exit early
distance 1 is tensor(136.3229, device='cuda:0')
distance 2 is tensor(11.6993, device='cuda:0')
________________________________
test distance is  tensor(11.6993, device='cuda:0')
test similarity is  tensor(0.9555, device='cuda:0')
test acc is  0.8500833334896566
test loss is 1.419653853373741
test entropy is  0.8484611154746399
________________________________
distance 1 is tensor(136.3229, device='cuda:0')
distance 2 is tensor(11.6993, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.849163024092534
avg test loss is  1.422092515522483
avg accuracy is  0.8515666668229899
solo acc is  0.25130000015633824
compute similarity  is  tensor(0.9555, device='cuda:0')
compute_distance is  tensor(11.6993, device='cuda:0')
compute_norm is  tensor(51.3156, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.5930, device='cuda:0')
distance 2 is tensor(11.8227, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8473681016390258
avg test loss is  1.4041454221394016
avg accuracy is  0.8525500001563232
solo acc is  0.2522000001563383
compute similarity  is  tensor(0.9554, device='cuda:0')
compute_distance is  tensor(11.8227, device='cuda:0')
compute_norm is  tensor(51.0503, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.8842, device='cuda:0')
distance 2 is tensor(11.9411, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8441186177450964
avg test loss is  1.3938227368316163
avg accuracy is  0.8532500001563231
solo acc is  0.24753333348967152
compute similarity  is  tensor(0.9553, device='cuda:0')
compute_distance is  tensor(11.9411, device='cuda:0')
compute_norm is  tensor(50.7886, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.1341, device='cuda:0')
distance 2 is tensor(12.0504, device='cuda:0')
exit early
distance 1 is tensor(140.1341, device='cuda:0')
distance 2 is tensor(12.0504, device='cuda:0')
________________________________
test distance is  tensor(12.0504, device='cuda:0')
test similarity is  tensor(0.9552, device='cuda:0')
test acc is  0.8532333334896566
test loss is 1.3920376956589948
test entropy is  0.8400658091375315
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.4389128684997559
mal norm is  tensor(6.6895, device='cuda:0')
distance 1 is tensor(140.1341, device='cuda:0')
distance 2 is tensor(12.0504, device='cuda:0')
mal distance is  tensor(12.0504, device='cuda:0')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2372, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(484.6968, device='cuda:0')
c is  tensor(0.0221, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(518.2569, device='cuda:0')
c is  tensor(0.0214, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.5648e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(383.1486, device='cuda:0')
c is  tensor(0.0249, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.0621, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.5043, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.1989, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.4771, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.0732, device='cuda:0')
c is  tensor(0.0218, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.2797e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9532, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.6431, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.0734, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.1373, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.6722, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.4359, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.7492, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.7387, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.6097, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.7010, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.6375, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.7710, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.3868, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.1044, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6786, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.4936, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.4922, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.4763e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.0718, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.0245, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4352, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.8272, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.3999, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.8599, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.2990, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.4915e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.9363, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
len accept list 14
len all weights is 14
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 91.39% 

Test Accuracy: 89.72% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
 benign loss is  0.46962985396385193
distance 1 is tensor(94.1863, device='cuda:0')
distance 2 is tensor(7.0692, device='cuda:0')
benign distance is  tensor(7.0692, device='cuda:0')
norm1 res is  tensor(0.1045, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5285367965698242
distance 1 is tensor(117.9328, device='cuda:0')
distance 2 is tensor(8.6033, device='cuda:0')
benign distance is  tensor(8.6033, device='cuda:0')
norm1 res is  tensor(0.1303, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.12986887991428375
distance 1 is tensor(73.4227, device='cuda:0')
distance 2 is tensor(5.5318, device='cuda:0')
benign distance is  tensor(5.5318, device='cuda:0')
norm1 res is  tensor(0.0792, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.13323143124580383
distance 1 is tensor(121.8371, device='cuda:0')
distance 2 is tensor(8.9467, device='cuda:0')
benign distance is  tensor(8.9467, device='cuda:0')
norm1 res is  tensor(0.1355, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.32037651538848877
distance 1 is tensor(123.1532, device='cuda:0')
distance 2 is tensor(9.0245, device='cuda:0')
benign distance is  tensor(9.0245, device='cuda:0')
norm1 res is  tensor(0.1360, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.4389157295227051
distance 1 is tensor(128.7785, device='cuda:0')
distance 2 is tensor(9.4739, device='cuda:0')
benign distance is  tensor(9.4739, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.024265039712190628
distance 1 is tensor(111.7835, device='cuda:0')
distance 2 is tensor(8.1192, device='cuda:0')
benign distance is  tensor(8.1192, device='cuda:0')
norm1 res is  tensor(0.1223, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.31964805722236633
distance 1 is tensor(127.3216, device='cuda:0')
distance 2 is tensor(9.2504, device='cuda:0')
benign distance is  tensor(9.2504, device='cuda:0')
norm1 res is  tensor(0.1393, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.5433384776115417
distance 1 is tensor(129.8701, device='cuda:0')
distance 2 is tensor(9.4275, device='cuda:0')
benign distance is  tensor(9.4275, device='cuda:0')
norm1 res is  tensor(0.1409, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.4340965151786804
distance 1 is tensor(132.8162, device='cuda:0')
distance 2 is tensor(9.8395, device='cuda:0')
benign distance is  tensor(9.8395, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6082407236099243
distance 1 is tensor(119.2530, device='cuda:0')
distance 2 is tensor(8.8062, device='cuda:0')
benign distance is  tensor(8.8062, device='cuda:0')
norm1 res is  tensor(0.1330, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.32820960879325867
distance 1 is tensor(132.1488, device='cuda:0')
distance 2 is tensor(9.8020, device='cuda:0')
benign distance is  tensor(9.8020, device='cuda:0')
norm1 res is  tensor(0.1441, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.5164758563041687
distance 1 is tensor(121.3733, device='cuda:0')
distance 2 is tensor(9.1389, device='cuda:0')
benign distance is  tensor(9.1389, device='cuda:0')
norm1 res is  tensor(0.1385, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.13779431581497192
distance 1 is tensor(119.8099, device='cuda:0')
distance 2 is tensor(8.8100, device='cuda:0')
benign distance is  tensor(8.8100, device='cuda:0')
norm1 res is  tensor(0.1331, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.12124220281839371
distance 1 is tensor(123.8405, device='cuda:0')
distance 2 is tensor(9.3437, device='cuda:0')
benign distance is  tensor(9.3437, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.6796211004257202
distance 1 is tensor(144.6756, device='cuda:0')
distance 2 is tensor(10.7368, device='cuda:0')
benign distance is  tensor(10.7368, device='cuda:0')
norm1 res is  tensor(0.1601, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.4777654707431793
distance 1 is tensor(135.0169, device='cuda:0')
distance 2 is tensor(9.9289, device='cuda:0')
benign distance is  tensor(9.9289, device='cuda:0')
norm1 res is  tensor(0.1492, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.31647443771362305
distance 1 is tensor(135.4286, device='cuda:0')
distance 2 is tensor(9.8057, device='cuda:0')
benign distance is  tensor(9.8057, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.6281872987747192
distance 1 is tensor(151.7500, device='cuda:0')
distance 2 is tensor(11.0620, device='cuda:0')
benign distance is  tensor(11.0620, device='cuda:0')
norm1 res is  tensor(0.1674, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.6433804631233215
distance 1 is tensor(146.9930, device='cuda:0')
distance 2 is tensor(10.8358, device='cuda:0')
benign distance is  tensor(10.8358, device='cuda:0')
norm1 res is  tensor(0.1616, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.2539791464805603
distance 1 is tensor(126.9142, device='cuda:0')
distance 2 is tensor(9.3496, device='cuda:0')
benign distance is  tensor(9.3496, device='cuda:0')
norm1 res is  tensor(0.1391, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.4520164430141449
distance 1 is tensor(134.5052, device='cuda:0')
distance 2 is tensor(9.7728, device='cuda:0')
benign distance is  tensor(9.7728, device='cuda:0')
norm1 res is  tensor(0.1478, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.14385172724723816
distance 1 is tensor(135.0650, device='cuda:0')
distance 2 is tensor(9.9145, device='cuda:0')
benign distance is  tensor(9.9145, device='cuda:0')
norm1 res is  tensor(0.1474, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.5382320880889893
distance 1 is tensor(126.6721, device='cuda:0')
distance 2 is tensor(9.3377, device='cuda:0')
benign distance is  tensor(9.3377, device='cuda:0')
norm1 res is  tensor(0.1394, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.1587851643562317
distance 1 is tensor(130.9108, device='cuda:0')
distance 2 is tensor(9.5919, device='cuda:0')
benign distance is  tensor(9.5919, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.19100084900856018
distance 1 is tensor(136.8315, device='cuda:0')
distance 2 is tensor(10.0338, device='cuda:0')
benign distance is  tensor(10.0338, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.12857678532600403
distance 1 is tensor(140.3255, device='cuda:0')
distance 2 is tensor(10.3904, device='cuda:0')
benign distance is  tensor(10.3904, device='cuda:0')
norm1 res is  tensor(0.1596, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.15728716552257538
distance 1 is tensor(123.4172, device='cuda:0')
distance 2 is tensor(9.1385, device='cuda:0')
benign distance is  tensor(9.1385, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.20104296505451202
distance 1 is tensor(137.5356, device='cuda:0')
distance 2 is tensor(10.0089, device='cuda:0')
benign distance is  tensor(10.0089, device='cuda:0')
norm1 res is  tensor(0.1500, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.4087182581424713
distance 1 is tensor(131.1936, device='cuda:0')
distance 2 is tensor(9.6770, device='cuda:0')
benign distance is  tensor(9.6770, device='cuda:0')
norm1 res is  tensor(0.1430, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.4717279374599457
distance 1 is tensor(135.6601, device='cuda:0')
distance 2 is tensor(10.1104, device='cuda:0')
benign distance is  tensor(10.1104, device='cuda:0')
norm1 res is  tensor(0.1513, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.06212357431650162
distance 1 is tensor(130.8878, device='cuda:0')
distance 2 is tensor(9.5737, device='cuda:0')
benign distance is  tensor(9.5737, device='cuda:0')
norm1 res is  tensor(0.1446, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(144.8380, device='cuda:0')
distance 2 is tensor(10.7487, device='cuda:0')
compute distance is  tensor(10.7487, device='cuda:0')
compute norm is  tensor(53.9370, device='cuda:0')
distance 1 is tensor(142.0942, device='cuda:0')
distance 2 is tensor(10.7490, device='cuda:0')
compute distance is  tensor(10.7490, device='cuda:0')
compute norm is  tensor(54.1398, device='cuda:0')
distance 1 is tensor(157.1956, device='cuda:0')
distance 2 is tensor(11.6847, device='cuda:0')
compute distance is  tensor(11.6847, device='cuda:0')
compute norm is  tensor(54.3900, device='cuda:0')
distance 1 is tensor(145.8506, device='cuda:0')
distance 2 is tensor(10.9655, device='cuda:0')
compute distance is  tensor(10.9655, device='cuda:0')
compute norm is  tensor(54.1163, device='cuda:0')
distance 1 is tensor(142.1510, device='cuda:0')
distance 2 is tensor(10.7966, device='cuda:0')
compute distance is  tensor(10.7966, device='cuda:0')
compute norm is  tensor(54.0789, device='cuda:0')
distance 1 is tensor(152.7818, device='cuda:0')
distance 2 is tensor(11.4665, device='cuda:0')
compute distance is  tensor(11.4665, device='cuda:0')
compute norm is  tensor(54.4186, device='cuda:0')
distance 1 is tensor(148.3864, device='cuda:0')
distance 2 is tensor(11.2023, device='cuda:0')
compute distance is  tensor(11.2023, device='cuda:0')
compute norm is  tensor(54.1823, device='cuda:0')
distance 1 is tensor(148.6071, device='cuda:0')
distance 2 is tensor(11.1323, device='cuda:0')
compute distance is  tensor(11.1323, device='cuda:0')
compute norm is  tensor(54.1325, device='cuda:0')
distance 1 is tensor(152.5696, device='cuda:0')
distance 2 is tensor(11.3769, device='cuda:0')
compute distance is  tensor(11.3769, device='cuda:0')
compute norm is  tensor(54.3600, device='cuda:0')
distance 1 is tensor(149.9099, device='cuda:0')
distance 2 is tensor(11.2113, device='cuda:0')
compute distance is  tensor(11.2113, device='cuda:0')
compute norm is  tensor(54.0974, device='cuda:0')
distance 1 is tensor(147.9666, device='cuda:0')
distance 2 is tensor(11.0952, device='cuda:0')
compute distance is  tensor(11.0952, device='cuda:0')
compute norm is  tensor(54.3017, device='cuda:0')
distance 1 is tensor(143.2057, device='cuda:0')
distance 2 is tensor(10.6309, device='cuda:0')
compute distance is  tensor(10.6309, device='cuda:0')
compute norm is  tensor(54.0767, device='cuda:0')
distance Threshold  is  tensor(11.6847, device='cuda:0')
distance 1 is tensor(1102058.2500, device='cuda:0')
distance 2 is tensor(79392.7578, device='cuda:0')
________________________________
test distance is  tensor(79392.7578, device='cuda:0')
test similarity is  tensor(-0.0157, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.198200665448137e+17
test entropy is  0.0
________________________________
cal ratio is  0.010918427926423899
distance 1 is tensor(12032.7510, device='cuda:0')
distance 2 is tensor(866.8442, device='cuda:0')
cal_distance is  tensor(866.8442, device='cuda:0')
cal ratio is  0.10449127954462901
distance 1 is tensor(1257.3242, device='cuda:0')
distance 2 is tensor(90.5777, device='cuda:0')
cal_distance is  tensor(90.5777, device='cuda:0')
cal ratio is  0.32325110039999433
distance 1 is tensor(406.4362, device='cuda:0')
distance 2 is tensor(29.2793, device='cuda:0')
cal_distance is  tensor(29.2793, device='cuda:0')
cal ratio is  0.5685517683514449
distance 1 is tensor(231.0832, device='cuda:0')
distance 2 is tensor(16.6468, device='cuda:0')
cal_distance is  tensor(16.6468, device='cuda:0')
cal ratio is  0.7540237386600422
distance 1 is tensor(174.2440, device='cuda:0')
distance 2 is tensor(12.5521, device='cuda:0')
cal_distance is  tensor(12.5521, device='cuda:0')
cal ratio is  0.8683454195823987
distance 1 is tensor(151.3049, device='cuda:0')
distance 2 is tensor(10.8996, device='cuda:0')
cal_distance is  tensor(10.8996, device='cuda:0')
distance 1 is tensor(151.3049, device='cuda:0')
distance 2 is tensor(10.8996, device='cuda:0')
________________________________
test distance is  tensor(10.8996, device='cuda:0')
test similarity is  tensor(0.9468, device='cuda:0')
test acc is  0.8527833334896564
test loss is 62.504547237079024
test entropy is  0.005749164000590829
________________________________
distance 1 is tensor(151.3049, device='cuda:0')
distance 2 is tensor(10.8996, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.005721172201867542
avg test loss is  62.53198587462338
avg accuracy is  0.8512000001563231
solo acc is  0.12115000015633193
compute similarity  is  tensor(0.9468, device='cuda:0')
compute_distance is  tensor(10.8996, device='cuda:0')
compute_norm is  tensor(53.9810, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(140.9708, device='cuda:0')
distance 2 is tensor(11.9610, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9134776252292113
avg test loss is  1.4219245881414109
avg accuracy is  0.8576833334896563
solo acc is  0.33148333348967335
compute similarity  is  tensor(0.9480, device='cuda:0')
compute_distance is  tensor(11.9610, device='cuda:0')
compute_norm is  tensor(53.0034, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.4123, device='cuda:0')
distance 2 is tensor(12.1868, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8743651493398874
avg test loss is  1.5080761628618626
avg accuracy is  0.8572166668229897
solo acc is  0.2657166668230053
compute similarity  is  tensor(0.9479, device='cuda:0')
compute_distance is  tensor(12.1868, device='cuda:0')
compute_norm is  tensor(52.6821, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.6949, device='cuda:0')
distance 2 is tensor(12.3492, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8672328731144415
avg test loss is  1.4844295160094303
avg accuracy is  0.8568333334896563
solo acc is  0.263983333489672
compute similarity  is  tensor(0.9478, device='cuda:0')
compute_distance is  tensor(12.3492, device='cuda:0')
compute_norm is  tensor(52.3783, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.8884, device='cuda:0')
distance 2 is tensor(12.4868, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8616382420571373
avg test loss is  1.4571025418574368
avg accuracy is  0.8608666668229894
solo acc is  0.2612833334896719
compute similarity  is  tensor(0.9477, device='cuda:0')
compute_distance is  tensor(12.4868, device='cuda:0')
compute_norm is  tensor(52.0876, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.1051, device='cuda:0')
distance 2 is tensor(12.6153, device='cuda:0')
________________________________
test distance is  tensor(12.6153, device='cuda:0')
test similarity is  tensor(0.9477, device='cuda:0')
test acc is  0.8615000001563228
test loss is 1.4395215798542698
test entropy is  0.8555863724588585
________________________________
cal ratio is  0.866167543995151
distance 1 is tensor(126.5524, device='cuda:0')
distance 2 is tensor(10.9270, device='cuda:0')
cal_distance is  tensor(10.9270, device='cuda:0')
distance 1 is tensor(126.5524, device='cuda:0')
distance 2 is tensor(10.9270, device='cuda:0')
________________________________
test distance is  tensor(10.9270, device='cuda:0')
test similarity is  tensor(0.9604, device='cuda:0')
test acc is  0.8776666668229888
test loss is 0.9999788381905952
test entropy is  0.9088348840980895
________________________________
distance 1 is tensor(126.5524, device='cuda:0')
distance 2 is tensor(10.9270, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9081045080985087
avg test loss is  1.0007423693691488
avg accuracy is  0.8778166668229888
solo acc is  0.5579500001563413
compute similarity  is  tensor(0.9604, device='cuda:0')
compute_distance is  tensor(10.9270, device='cuda:0')
compute_norm is  tensor(51.6280, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.1650, device='cuda:0')
distance 2 is tensor(11.2760, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8466480704131665
avg test loss is  1.422162821170872
avg accuracy is  0.8723333334896557
solo acc is  0.2599666668230052
compute similarity  is  tensor(0.9598, device='cuda:0')
compute_distance is  tensor(11.2760, device='cuda:0')
compute_norm is  tensor(51.3400, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.8770, device='cuda:0')
distance 2 is tensor(11.4415, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8435618470091302
avg test loss is  1.4067667741765346
avg accuracy is  0.8733000001563224
solo acc is  0.25851666682300506
compute similarity  is  tensor(0.9596, device='cuda:0')
compute_distance is  tensor(11.4415, device='cuda:0')
compute_norm is  tensor(51.0623, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.4072, device='cuda:0')
distance 2 is tensor(11.5839, device='cuda:0')
exit early
distance 1 is tensor(132.4072, device='cuda:0')
distance 2 is tensor(11.5839, device='cuda:0')
________________________________
test distance is  tensor(11.5839, device='cuda:0')
test similarity is  tensor(0.9595, device='cuda:0')
test acc is  0.874866666822989
test loss is 1.4089365939595806
test entropy is  0.8406747880139585
________________________________
distance 1 is tensor(132.4072, device='cuda:0')
distance 2 is tensor(11.5839, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.839942855494363
avg test loss is  1.405163623249607
avg accuracy is  0.8748333334896556
solo acc is  0.24776666682300483
compute similarity  is  tensor(0.9595, device='cuda:0')
compute_distance is  tensor(11.5839, device='cuda:0')
compute_norm is  tensor(50.7936, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.8794, device='cuda:0')
distance 2 is tensor(11.7094, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8417729868182241
avg test loss is  1.382272579014174
avg accuracy is  0.8777166668229888
solo acc is  0.24851666682300486
compute similarity  is  tensor(0.9594, device='cuda:0')
compute_distance is  tensor(11.7094, device='cuda:0')
compute_norm is  tensor(50.5291, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.3495, device='cuda:0')
distance 2 is tensor(11.8337, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8370510904011188
avg test loss is  1.3729002839212479
avg accuracy is  0.8768000001563221
solo acc is  0.25025000015633825
compute similarity  is  tensor(0.9593, device='cuda:0')
compute_distance is  tensor(11.8337, device='cuda:0')
compute_norm is  tensor(50.2682, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.8454, device='cuda:0')
distance 2 is tensor(11.9573, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8298440086943254
avg test loss is  1.3657175723169404
avg accuracy is  0.8796000001563221
solo acc is  0.24788333348967156
compute similarity  is  tensor(0.9591, device='cuda:0')
compute_distance is  tensor(11.9573, device='cuda:0')
compute_norm is  tensor(50.0116, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.3146, device='cuda:0')
distance 2 is tensor(12.0760, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.830193945212659
avg test loss is  1.3540176356525055
avg accuracy is  0.8806166668229887
solo acc is  0.2464333334896715
compute similarity  is  tensor(0.9590, device='cuda:0')
compute_distance is  tensor(12.0760, device='cuda:0')
compute_norm is  tensor(49.7573, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.8194, device='cuda:0')
distance 2 is tensor(12.1940, device='cuda:0')
________________________________
test distance is  tensor(12.1940, device='cuda:0')
test similarity is  tensor(0.9589, device='cuda:0')
test acc is  0.8829166668229885
test loss is 1.3376735811040346
test entropy is  0.8289913026762924
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2317876815795898
mal norm is  tensor(6.3967, device='cuda:0')
distance 1 is tensor(139.8194, device='cuda:0')
distance 2 is tensor(12.1940, device='cuda:0')
mal distance is  tensor(12.1940, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1050, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(412.8454, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.6211e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.2474, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.4951e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(308.6754, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.2410e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(530.5999, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.7603, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.2067, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9254e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(484.9741, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.2787e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.2242, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.6133e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.6732, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3834e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.5562, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.1214e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.7815, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.5224, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.1212e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4773, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.5890e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.8008, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.3698, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.7387, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.2981, device='cuda:0')
c is  tensor(0.0125, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 3
len all weights is 3
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 90.88% 

Test Accuracy: 89.30% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2824559211730957
distance 1 is tensor(119.5966, device='cuda:0')
distance 2 is tensor(8.9091, device='cuda:0')
benign distance is  tensor(8.9091, device='cuda:0')
norm1 res is  tensor(0.1315, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6379045248031616
distance 1 is tensor(123.8366, device='cuda:0')
distance 2 is tensor(9.1227, device='cuda:0')
benign distance is  tensor(9.1227, device='cuda:0')
norm1 res is  tensor(0.1350, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.06418029963970184
distance 1 is tensor(94.7386, device='cuda:0')
distance 2 is tensor(7.0730, device='cuda:0')
benign distance is  tensor(7.0730, device='cuda:0')
norm1 res is  tensor(0.1049, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.8684374094009399
distance 1 is tensor(122.6077, device='cuda:0')
distance 2 is tensor(9.0812, device='cuda:0')
benign distance is  tensor(9.0812, device='cuda:0')
norm1 res is  tensor(0.1348, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5480226874351501
distance 1 is tensor(126.9746, device='cuda:0')
distance 2 is tensor(9.3641, device='cuda:0')
benign distance is  tensor(9.3641, device='cuda:0')
norm1 res is  tensor(0.1391, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.28169721364974976
distance 1 is tensor(137.0182, device='cuda:0')
distance 2 is tensor(10.0425, device='cuda:0')
benign distance is  tensor(10.0425, device='cuda:0')
norm1 res is  tensor(0.1490, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.06631970405578613
distance 1 is tensor(116.3312, device='cuda:0')
distance 2 is tensor(8.5294, device='cuda:0')
benign distance is  tensor(8.5294, device='cuda:0')
norm1 res is  tensor(0.1278, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.4431091845035553
distance 1 is tensor(105.7762, device='cuda:0')
distance 2 is tensor(7.8014, device='cuda:0')
benign distance is  tensor(7.8014, device='cuda:0')
norm1 res is  tensor(0.1163, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.1991606205701828
distance 1 is tensor(120.0148, device='cuda:0')
distance 2 is tensor(8.7669, device='cuda:0')
benign distance is  tensor(8.7669, device='cuda:0')
norm1 res is  tensor(0.1295, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.6530479192733765
distance 1 is tensor(152.9259, device='cuda:0')
distance 2 is tensor(11.2614, device='cuda:0')
benign distance is  tensor(11.2614, device='cuda:0')
norm1 res is  tensor(0.1667, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.23677146434783936
distance 1 is tensor(128.2451, device='cuda:0')
distance 2 is tensor(9.4389, device='cuda:0')
benign distance is  tensor(9.4389, device='cuda:0')
norm1 res is  tensor(0.1419, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.16478562355041504
distance 1 is tensor(129.4212, device='cuda:0')
distance 2 is tensor(9.6985, device='cuda:0')
benign distance is  tensor(9.6985, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.28027960658073425
distance 1 is tensor(133.4625, device='cuda:0')
distance 2 is tensor(9.8111, device='cuda:0')
benign distance is  tensor(9.8111, device='cuda:0')
norm1 res is  tensor(0.1466, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9164829254150391
distance 1 is tensor(140.0649, device='cuda:0')
distance 2 is tensor(10.1911, device='cuda:0')
benign distance is  tensor(10.1911, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.26139986515045166
distance 1 is tensor(140.4925, device='cuda:0')
distance 2 is tensor(10.3518, device='cuda:0')
benign distance is  tensor(10.3518, device='cuda:0')
norm1 res is  tensor(0.1534, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.3017541468143463
distance 1 is tensor(139.7875, device='cuda:0')
distance 2 is tensor(10.2303, device='cuda:0')
benign distance is  tensor(10.2303, device='cuda:0')
norm1 res is  tensor(0.1531, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(150.6624, device='cuda:0')
distance 2 is tensor(11.2401, device='cuda:0')
compute distance is  tensor(11.2401, device='cuda:0')
compute norm is  tensor(53.6319, device='cuda:0')
distance 1 is tensor(149.1629, device='cuda:0')
distance 2 is tensor(11.1453, device='cuda:0')
compute distance is  tensor(11.1453, device='cuda:0')
compute norm is  tensor(53.6623, device='cuda:0')
distance 1 is tensor(165.7113, device='cuda:0')
distance 2 is tensor(12.2501, device='cuda:0')
compute distance is  tensor(12.2501, device='cuda:0')
compute norm is  tensor(54.0052, device='cuda:0')
distance 1 is tensor(152.5005, device='cuda:0')
distance 2 is tensor(11.3116, device='cuda:0')
compute distance is  tensor(11.3116, device='cuda:0')
compute norm is  tensor(53.6536, device='cuda:0')
distance 1 is tensor(158.0791, device='cuda:0')
distance 2 is tensor(11.7039, device='cuda:0')
compute distance is  tensor(11.7039, device='cuda:0')
compute norm is  tensor(53.8061, device='cuda:0')
distance 1 is tensor(162.8310, device='cuda:0')
distance 2 is tensor(12.1155, device='cuda:0')
compute distance is  tensor(12.1155, device='cuda:0')
compute norm is  tensor(54.1151, device='cuda:0')
distance 1 is tensor(149.0128, device='cuda:0')
distance 2 is tensor(11.0590, device='cuda:0')
compute distance is  tensor(11.0590, device='cuda:0')
compute norm is  tensor(53.7257, device='cuda:0')
distance 1 is tensor(155.3028, device='cuda:0')
distance 2 is tensor(11.5550, device='cuda:0')
compute distance is  tensor(11.5550, device='cuda:0')
compute norm is  tensor(53.7522, device='cuda:0')
distance 1 is tensor(154.0339, device='cuda:0')
distance 2 is tensor(11.3761, device='cuda:0')
compute distance is  tensor(11.3761, device='cuda:0')
compute norm is  tensor(53.7453, device='cuda:0')
distance 1 is tensor(162.6452, device='cuda:0')
distance 2 is tensor(12.0359, device='cuda:0')
compute distance is  tensor(12.0359, device='cuda:0')
compute norm is  tensor(54.0163, device='cuda:0')
distance 1 is tensor(152.7616, device='cuda:0')
distance 2 is tensor(11.2739, device='cuda:0')
compute distance is  tensor(11.2739, device='cuda:0')
compute norm is  tensor(53.7606, device='cuda:0')
distance 1 is tensor(142.4265, device='cuda:0')
distance 2 is tensor(10.7087, device='cuda:0')
compute distance is  tensor(10.7087, device='cuda:0')
compute norm is  tensor(53.5121, device='cuda:0')
distance Threshold  is  tensor(12.2501, device='cuda:0')
distance 1 is tensor(1102055.1250, device='cuda:0')
distance 2 is tensor(79392.5938, device='cuda:0')
________________________________
test distance is  tensor(79392.5938, device='cuda:0')
test similarity is  tensor(-0.0040, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.196686322618323e+17
test entropy is  0.0
________________________________
cal ratio is  0.01117948878787564
distance 1 is tensor(12320.4199, device='cuda:0')
distance 2 is tensor(887.5686, device='cuda:0')
cal_distance is  tensor(887.5686, device='cuda:0')
cal ratio is  0.10573310266784519
distance 1 is tensor(1302.6826, device='cuda:0')
distance 2 is tensor(93.8454, device='cuda:0')
cal_distance is  tensor(93.8454, device='cuda:0')
cal ratio is  0.32516626795377357
distance 1 is tensor(423.5933, device='cuda:0')
distance 2 is tensor(30.5154, device='cuda:0')
cal_distance is  tensor(30.5154, device='cuda:0')
cal ratio is  0.5702335266408007
distance 1 is tensor(241.5502, device='cuda:0')
distance 2 is tensor(17.4009, device='cuda:0')
cal_distance is  tensor(17.4009, device='cuda:0')
cal ratio is  0.7551380850029691
distance 1 is tensor(182.4056, device='cuda:0')
distance 2 is tensor(13.1401, device='cuda:0')
cal_distance is  tensor(13.1401, device='cuda:0')
cal ratio is  0.8689868034802825
distance 1 is tensor(158.5090, device='cuda:0')
distance 2 is tensor(11.4185, device='cuda:0')
cal_distance is  tensor(11.4185, device='cuda:0')
distance 1 is tensor(158.5090, device='cuda:0')
distance 2 is tensor(11.4185, device='cuda:0')
________________________________
test distance is  tensor(11.4185, device='cuda:0')
test similarity is  tensor(0.9430, device='cuda:0')
test acc is  0.8189000001563246
test loss is 80.04652556885026
test entropy is  0.0027482363585956144
________________________________
distance 1 is tensor(158.5090, device='cuda:0')
distance 2 is tensor(11.4185, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.002975949271748039
avg test loss is  79.99004980546833
avg accuracy is  0.8181166668229912
solo acc is  0.10928333348966529
compute similarity  is  tensor(0.9430, device='cuda:0')
compute_distance is  tensor(11.4185, device='cuda:0')
compute_norm is  tensor(54.4169, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.4391, device='cuda:0')
distance 2 is tensor(12.4303, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9220096510229334
avg test loss is  1.4292027275445365
avg accuracy is  0.8397000001563237
solo acc is  0.32941666682300674
compute similarity  is  tensor(0.9443, device='cuda:0')
compute_distance is  tensor(12.4303, device='cuda:0')
compute_norm is  tensor(53.5259, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.7671, device='cuda:0')
distance 2 is tensor(12.6447, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8813618741182885
avg test loss is  1.518013749549638
avg accuracy is  0.8390166668229905
solo acc is  0.26218333348967193
compute similarity  is  tensor(0.9441, device='cuda:0')
compute_distance is  tensor(12.6447, device='cuda:0')
compute_norm is  tensor(53.2079, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.9700, device='cuda:0')
distance 2 is tensor(12.7984, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8661268803991997
avg test loss is  1.4887657076565188
avg accuracy is  0.8399666668229904
solo acc is  0.2607833334896719
compute similarity  is  tensor(0.9440, device='cuda:0')
compute_distance is  tensor(12.7984, device='cuda:0')
compute_norm is  tensor(52.9059, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.2730, device='cuda:0')
distance 2 is tensor(12.9443, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8735956728204227
avg test loss is  1.4689143882123137
avg accuracy is  0.8397500001563237
solo acc is  0.25376666682300497
compute similarity  is  tensor(0.9439, device='cuda:0')
compute_distance is  tensor(12.9443, device='cuda:0')
compute_norm is  tensor(52.6128, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.4119, device='cuda:0')
distance 2 is tensor(13.0658, device='cuda:0')
________________________________
test distance is  tensor(13.0658, device='cuda:0')
test similarity is  tensor(0.9438, device='cuda:0')
test acc is  0.8419333334896569
test loss is 1.4403253259943491
test entropy is  0.8727998277907179
________________________________
cal ratio is  0.8714536356238876
distance 1 is tensor(132.8208, device='cuda:0')
distance 2 is tensor(11.3862, device='cuda:0')
cal_distance is  tensor(11.3862, device='cuda:0')
distance 1 is tensor(132.8208, device='cuda:0')
distance 2 is tensor(11.3862, device='cuda:0')
________________________________
test distance is  tensor(11.3862, device='cuda:0')
test similarity is  tensor(0.9568, device='cuda:0')
test acc is  0.8560833334896563
test loss is 1.0483388903298612
test entropy is  0.9580422055238346
________________________________
distance 1 is tensor(132.8208, device='cuda:0')
distance 2 is tensor(11.3862, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9581402918931518
avg test loss is  1.049051523844062
avg accuracy is  0.8551666668229898
solo acc is  0.5176333334896756
compute similarity  is  tensor(0.9568, device='cuda:0')
compute_distance is  tensor(11.3862, device='cuda:0')
compute_norm is  tensor(52.1003, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.2003, device='cuda:0')
distance 2 is tensor(11.6952, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.84847081082462
avg test loss is  1.4268150404572233
avg accuracy is  0.8535500001563231
solo acc is  0.2603666668230052
compute similarity  is  tensor(0.9563, device='cuda:0')
compute_distance is  tensor(11.6952, device='cuda:0')
compute_norm is  tensor(51.8195, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.8558, device='cuda:0')
distance 2 is tensor(11.8539, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8453305232118188
avg test loss is  1.4176587095138615
avg accuracy is  0.8518500001563231
solo acc is  0.2501500001563383
compute similarity  is  tensor(0.9561, device='cuda:0')
compute_distance is  tensor(11.8539, device='cuda:0')
compute_norm is  tensor(51.5419, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.3350, device='cuda:0')
distance 2 is tensor(11.9852, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8434886540304115
avg test loss is  1.4015232921917555
avg accuracy is  0.8534833334896564
solo acc is  0.253516666823005
compute similarity  is  tensor(0.9560, device='cuda:0')
compute_distance is  tensor(11.9852, device='cuda:0')
compute_norm is  tensor(51.2707, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.7797, device='cuda:0')
distance 2 is tensor(12.1122, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8466609356754116
avg test loss is  1.391099427046298
avg accuracy is  0.8541666668229898
solo acc is  0.24753333348967152
compute similarity  is  tensor(0.9558, device='cuda:0')
compute_distance is  tensor(12.1122, device='cuda:0')
compute_norm is  tensor(51.0063, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.1915, device='cuda:0')
distance 2 is tensor(12.2327, device='cuda:0')
________________________________
test distance is  tensor(12.2327, device='cuda:0')
test similarity is  tensor(0.9557, device='cuda:0')
test acc is  0.8559666668229896
test loss is 1.3803916562086485
test entropy is  0.8389562317557426
________________________________
distance 1 is tensor(141.1915, device='cuda:0')
distance 2 is tensor(12.2327, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8405998800990424
avg test loss is  1.3802645325914884
avg accuracy is  0.8571833334896564
solo acc is  0.2463166668230048
compute similarity  is  tensor(0.9557, device='cuda:0')
compute_distance is  tensor(12.2327, device='cuda:0')
compute_norm is  tensor(50.7467, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.6534, device='cuda:0')
distance 2 is tensor(12.3534, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8378042297195524
avg test loss is  1.3708617556323883
avg accuracy is  0.8580166668229896
solo acc is  0.24223333348967133
compute similarity  is  tensor(0.9556, device='cuda:0')
compute_distance is  tensor(12.3534, device='cuda:0')
compute_norm is  tensor(50.4899, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.0865, device='cuda:0')
distance 2 is tensor(12.4658, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8342867702690523
avg test loss is  1.360410295823998
avg accuracy is  0.8583333334896563
solo acc is  0.24448333348967138
compute similarity  is  tensor(0.9554, device='cuda:0')
compute_distance is  tensor(12.4658, device='cuda:0')
compute_norm is  tensor(50.2362, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.5425, device='cuda:0')
distance 2 is tensor(12.5775, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8347892934706673
avg test loss is  1.3457953055530214
avg accuracy is  0.8605500001563229
solo acc is  0.24533333348967143
compute similarity  is  tensor(0.9553, device='cuda:0')
compute_distance is  tensor(12.5775, device='cuda:0')
compute_norm is  tensor(49.9845, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.0604, device='cuda:0')
distance 2 is tensor(12.6942, device='cuda:0')
exit early
distance 1 is tensor(147.0604, device='cuda:0')
distance 2 is tensor(12.6942, device='cuda:0')
________________________________
test distance is  tensor(12.6942, device='cuda:0')
test similarity is  tensor(0.9552, device='cuda:0')
test acc is  0.8609000001563228
test loss is 1.3488205168038798
test entropy is  0.8267205587582294
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.234845519065857
mal norm is  tensor(6.7126, device='cuda:0')
distance 1 is tensor(147.0604, device='cuda:0')
distance 2 is tensor(12.6942, device='cuda:0')
mal distance is  tensor(12.6942, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1986, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(518.4872, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.9945e-07, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.2479, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(405.7862, device='cuda:0')
c is  tensor(0.0221, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(526.9827, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.2650, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.7850, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6740e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.1902, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.4263e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(455.9195, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.4163e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.2627, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.8969, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.3029e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.1924, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.4791, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.3874, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.6396e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.5309, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.1119, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.0262, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.7523e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.3763, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 7
len all weights is 7
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 91.12% 

Test Accuracy: 89.26% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
 benign loss is  0.463556706905365
distance 1 is tensor(103.0810, device='cuda:0')
distance 2 is tensor(7.7343, device='cuda:0')
benign distance is  tensor(7.7343, device='cuda:0')
norm1 res is  tensor(0.1165, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.17630940675735474
distance 1 is tensor(128.3544, device='cuda:0')
distance 2 is tensor(9.2842, device='cuda:0')
benign distance is  tensor(9.2842, device='cuda:0')
norm1 res is  tensor(0.1398, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.0050185369327664375
distance 1 is tensor(82.0354, device='cuda:0')
distance 2 is tensor(6.1173, device='cuda:0')
benign distance is  tensor(6.1173, device='cuda:0')
norm1 res is  tensor(0.0882, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6257332563400269
distance 1 is tensor(125.1277, device='cuda:0')
distance 2 is tensor(9.1452, device='cuda:0')
benign distance is  tensor(9.1452, device='cuda:0')
norm1 res is  tensor(0.1381, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7675637006759644
distance 1 is tensor(125.2181, device='cuda:0')
distance 2 is tensor(9.0849, device='cuda:0')
benign distance is  tensor(9.0849, device='cuda:0')
norm1 res is  tensor(0.1337, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.9800007939338684
distance 1 is tensor(129.7399, device='cuda:0')
distance 2 is tensor(9.4301, device='cuda:0')
benign distance is  tensor(9.4301, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.11575137078762054
distance 1 is tensor(102.8500, device='cuda:0')
distance 2 is tensor(7.4429, device='cuda:0')
benign distance is  tensor(7.4429, device='cuda:0')
norm1 res is  tensor(0.1143, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.08582955598831177
distance 1 is tensor(98.3922, device='cuda:0')
distance 2 is tensor(7.2090, device='cuda:0')
benign distance is  tensor(7.2090, device='cuda:0')
norm1 res is  tensor(0.1067, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.1838291585445404
distance 1 is tensor(136.4670, device='cuda:0')
distance 2 is tensor(10.0693, device='cuda:0')
benign distance is  tensor(10.0693, device='cuda:0')
norm1 res is  tensor(0.1504, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8267165422439575
distance 1 is tensor(134.4886, device='cuda:0')
distance 2 is tensor(9.8093, device='cuda:0')
benign distance is  tensor(9.8093, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.38295191526412964
distance 1 is tensor(133.3181, device='cuda:0')
distance 2 is tensor(9.7134, device='cuda:0')
benign distance is  tensor(9.7134, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.45774540305137634
distance 1 is tensor(140.0222, device='cuda:0')
distance 2 is tensor(10.2994, device='cuda:0')
benign distance is  tensor(10.2994, device='cuda:0')
norm1 res is  tensor(0.1549, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.45993709564208984
distance 1 is tensor(116.9685, device='cuda:0')
distance 2 is tensor(8.7006, device='cuda:0')
benign distance is  tensor(8.7006, device='cuda:0')
norm1 res is  tensor(0.1319, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7346597909927368
distance 1 is tensor(128.5181, device='cuda:0')
distance 2 is tensor(9.4586, device='cuda:0')
benign distance is  tensor(9.4586, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.22204509377479553
distance 1 is tensor(114.4108, device='cuda:0')
distance 2 is tensor(8.5512, device='cuda:0')
benign distance is  tensor(8.5512, device='cuda:0')
norm1 res is  tensor(0.1318, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.1811409294605255
distance 1 is tensor(141.5494, device='cuda:0')
distance 2 is tensor(10.4807, device='cuda:0')
benign distance is  tensor(10.4807, device='cuda:0')
norm1 res is  tensor(0.1580, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(153.9503, device='cuda:0')
distance 2 is tensor(11.2682, device='cuda:0')
compute distance is  tensor(11.2682, device='cuda:0')
compute norm is  tensor(54.3909, device='cuda:0')
distance 1 is tensor(175.1316, device='cuda:0')
distance 2 is tensor(12.7622, device='cuda:0')
compute distance is  tensor(12.7622, device='cuda:0')
compute norm is  tensor(54.9070, device='cuda:0')
distance 1 is tensor(164.2503, device='cuda:0')
distance 2 is tensor(12.1921, device='cuda:0')
compute distance is  tensor(12.1921, device='cuda:0')
compute norm is  tensor(54.7478, device='cuda:0')
distance 1 is tensor(152.4231, device='cuda:0')
distance 2 is tensor(11.2943, device='cuda:0')
compute distance is  tensor(11.2943, device='cuda:0')
compute norm is  tensor(54.4120, device='cuda:0')
distance 1 is tensor(154.4757, device='cuda:0')
distance 2 is tensor(11.4553, device='cuda:0')
compute distance is  tensor(11.4553, device='cuda:0')
compute norm is  tensor(54.4006, device='cuda:0')
distance 1 is tensor(164.7114, device='cuda:0')
distance 2 is tensor(12.1753, device='cuda:0')
compute distance is  tensor(12.1753, device='cuda:0')
compute norm is  tensor(54.8189, device='cuda:0')
distance 1 is tensor(158.4874, device='cuda:0')
distance 2 is tensor(11.8294, device='cuda:0')
compute distance is  tensor(11.8294, device='cuda:0')
compute norm is  tensor(54.5436, device='cuda:0')
distance 1 is tensor(155.0712, device='cuda:0')
distance 2 is tensor(11.3100, device='cuda:0')
compute distance is  tensor(11.3100, device='cuda:0')
compute norm is  tensor(54.4560, device='cuda:0')
distance 1 is tensor(170.5857, device='cuda:0')
distance 2 is tensor(12.4113, device='cuda:0')
compute distance is  tensor(12.4113, device='cuda:0')
compute norm is  tensor(54.7656, device='cuda:0')
distance 1 is tensor(153.4572, device='cuda:0')
distance 2 is tensor(11.2365, device='cuda:0')
compute distance is  tensor(11.2365, device='cuda:0')
compute norm is  tensor(54.5045, device='cuda:0')
distance 1 is tensor(161.9024, device='cuda:0')
distance 2 is tensor(11.7578, device='cuda:0')
compute distance is  tensor(11.7578, device='cuda:0')
compute norm is  tensor(54.8140, device='cuda:0')
distance 1 is tensor(156.8530, device='cuda:0')
distance 2 is tensor(11.5784, device='cuda:0')
compute distance is  tensor(11.5784, device='cuda:0')
compute norm is  tensor(54.5164, device='cuda:0')
distance Threshold  is  tensor(12.7622, device='cuda:0')
distance 1 is tensor(1102056.6250, device='cuda:0')
distance 2 is tensor(79392.8359, device='cuda:0')
________________________________
test distance is  tensor(79392.8359, device='cuda:0')
test similarity is  tensor(-0.0161, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.198522658688433e+17
test entropy is  0.0
________________________________
cal ratio is  0.011410742213287634
distance 1 is tensor(12575.2920, device='cuda:0')
distance 2 is tensor(905.9312, device='cuda:0')
cal_distance is  tensor(905.9312, device='cuda:0')
cal ratio is  0.1068210795024224
distance 1 is tensor(1343.3126, device='cuda:0')
distance 2 is tensor(96.7726, device='cuda:0')
cal_distance is  tensor(96.7726, device='cuda:0')
cal ratio is  0.32683493416058756
distance 1 is tensor(439.0464, device='cuda:0')
distance 2 is tensor(31.6287, device='cuda:0')
cal_distance is  tensor(31.6287, device='cuda:0')
cal ratio is  0.571694778748865
distance 1 is tensor(251.0036, device='cuda:0')
distance 2 is tensor(18.0819, device='cuda:0')
cal_distance is  tensor(18.0819, device='cuda:0')
cal ratio is  0.7561049625726538
distance 1 is tensor(189.7868, device='cuda:0')
distance 2 is tensor(13.6718, device='cuda:0')
cal_distance is  tensor(13.6718, device='cuda:0')
cal ratio is  0.8695429901399837
distance 1 is tensor(165.0288, device='cuda:0')
distance 2 is tensor(11.8883, device='cuda:0')
cal_distance is  tensor(11.8883, device='cuda:0')
distance 1 is tensor(165.0288, device='cuda:0')
distance 2 is tensor(11.8883, device='cuda:0')
________________________________
test distance is  tensor(11.8883, device='cuda:0')
test similarity is  tensor(0.9387, device='cuda:0')
test acc is  0.8363333334896572
test loss is 92.86369459562972
test entropy is  0.0020587086191272384
________________________________
distance 1 is tensor(165.0288, device='cuda:0')
distance 2 is tensor(11.8883, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0019079302275146182
avg test loss is  92.86780873443018
avg accuracy is  0.8375000001563238
solo acc is  0.10778333348966529
compute similarity  is  tensor(0.9387, device='cuda:0')
compute_distance is  tensor(11.8883, device='cuda:0')
compute_norm is  tensor(54.7108, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(153.0910, device='cuda:0')
distance 2 is tensor(12.9721, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9134715422511355
avg test loss is  1.4689054637194188
avg accuracy is  0.8431333334896568
solo acc is  0.3168333334896732
compute similarity  is  tensor(0.9402, device='cuda:0')
compute_distance is  tensor(12.9721, device='cuda:0')
compute_norm is  tensor(53.7729, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.4272, device='cuda:0')
distance 2 is tensor(13.2006, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8791655780537042
avg test loss is  1.53744660321075
avg accuracy is  0.8412666668229902
solo acc is  0.25821666682300515
compute similarity  is  tensor(0.9400, device='cuda:0')
compute_distance is  tensor(13.2006, device='cuda:0')
compute_norm is  tensor(53.4506, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.6321, device='cuda:0')
distance 2 is tensor(13.3639, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8758146164895121
avg test loss is  1.50618882817246
avg accuracy is  0.8428166668229902
solo acc is  0.2550500001563384
compute similarity  is  tensor(0.9399, device='cuda:0')
compute_distance is  tensor(13.3639, device='cuda:0')
compute_norm is  tensor(53.1498, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.7900, device='cuda:0')
distance 2 is tensor(13.5041, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.866869642853991
avg test loss is  1.4850115094866072
avg accuracy is  0.8449666668229902
solo acc is  0.25336666682300496
compute similarity  is  tensor(0.9398, device='cuda:0')
compute_distance is  tensor(13.5041, device='cuda:0')
compute_norm is  tensor(52.8595, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.9090, device='cuda:0')
distance 2 is tensor(13.6303, device='cuda:0')
________________________________
test distance is  tensor(13.6303, device='cuda:0')
test similarity is  tensor(0.9397, device='cuda:0')
test acc is  0.84536666682299
test loss is 1.4639803005942404
test entropy is  0.866607769465904
________________________________
cal ratio is  0.8708660994910307
distance 1 is tensor(137.5185, device='cuda:0')
distance 2 is tensor(11.8702, device='cuda:0')
cal_distance is  tensor(11.8702, device='cuda:0')
distance 1 is tensor(137.5185, device='cuda:0')
distance 2 is tensor(11.8702, device='cuda:0')
________________________________
test distance is  tensor(11.8702, device='cuda:0')
test similarity is  tensor(0.9538, device='cuda:0')
test acc is  0.8600833334896562
test loss is 1.0468623739188667
test entropy is  0.9369654893112589
________________________________
distance 1 is tensor(137.5185, device='cuda:0')
distance 2 is tensor(11.8702, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9389325639586459
avg test loss is  1.0472660047540279
avg accuracy is  0.8591666668229897
solo acc is  0.5238500001563423
compute similarity  is  tensor(0.9538, device='cuda:0')
compute_distance is  tensor(11.8702, device='cuda:0')
compute_norm is  tensor(52.3279, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.9925, device='cuda:0')
distance 2 is tensor(12.1963, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8596173450509622
avg test loss is  1.433365131237868
avg accuracy is  0.8546500001563231
solo acc is  0.25855000015633844
compute similarity  is  tensor(0.9532, device='cuda:0')
compute_distance is  tensor(12.1963, device='cuda:0')
compute_norm is  tensor(52.0422, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.5383, device='cuda:0')
distance 2 is tensor(12.3511, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8562963799372919
avg test loss is  1.423231316654921
avg accuracy is  0.8577166668229896
solo acc is  0.25266666682300504
compute similarity  is  tensor(0.9530, device='cuda:0')
compute_distance is  tensor(12.3511, device='cuda:0')
compute_norm is  tensor(51.7669, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.9445, device='cuda:0')
distance 2 is tensor(12.4820, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8528705076622302
avg test loss is  1.4121983741392206
avg accuracy is  0.8596333334896562
solo acc is  0.24671666682300483
compute similarity  is  tensor(0.9529, device='cuda:0')
compute_distance is  tensor(12.4820, device='cuda:0')
compute_norm is  tensor(51.4968, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.3767, device='cuda:0')
distance 2 is tensor(12.6102, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.848470007686981
avg test loss is  1.4025544988066911
avg accuracy is  0.8593000001563229
solo acc is  0.24695000015633817
compute similarity  is  tensor(0.9528, device='cuda:0')
compute_distance is  tensor(12.6102, device='cuda:0')
compute_norm is  tensor(51.2315, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.7643, device='cuda:0')
distance 2 is tensor(12.7294, device='cuda:0')
________________________________
test distance is  tensor(12.7294, device='cuda:0')
test similarity is  tensor(0.9527, device='cuda:0')
test acc is  0.8614333334896562
test loss is 1.3939078858157974
test entropy is  0.8482068284615271
________________________________
distance 1 is tensor(145.7643, device='cuda:0')
distance 2 is tensor(12.7294, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.848737541482901
avg test loss is  1.3902496354920524
avg accuracy is  0.8620666668229894
solo acc is  0.24436666682300479
compute similarity  is  tensor(0.9527, device='cuda:0')
compute_distance is  tensor(12.7294, device='cuda:0')
compute_norm is  tensor(50.9719, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.1622, device='cuda:0')
distance 2 is tensor(12.8441, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8393537845692909
avg test loss is  1.3816093708406378
avg accuracy is  0.8625833334896561
solo acc is  0.2429000001563381
compute similarity  is  tensor(0.9525, device='cuda:0')
compute_distance is  tensor(12.8441, device='cuda:0')
compute_norm is  tensor(50.7145, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.6111, device='cuda:0')
distance 2 is tensor(12.9620, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8427895840042944
avg test loss is  1.3696435126287343
avg accuracy is  0.8629333334896561
solo acc is  0.23948333348967119
compute similarity  is  tensor(0.9524, device='cuda:0')
compute_distance is  tensor(12.9620, device='cuda:0')
compute_norm is  tensor(50.4608, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.0582, device='cuda:0')
distance 2 is tensor(13.0752, device='cuda:0')
exit early
distance 1 is tensor(150.0582, device='cuda:0')
distance 2 is tensor(13.0752, device='cuda:0')
________________________________
test distance is  tensor(13.0752, device='cuda:0')
test similarity is  tensor(0.9523, device='cuda:0')
test acc is  0.8649000001563226
test loss is 1.3693764378775413
test entropy is  0.8335280774244621
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.277076005935669
mal norm is  tensor(6.9589, device='cuda:0')
distance 1 is tensor(150.0582, device='cuda:0')
distance 2 is tensor(13.0752, device='cuda:0')
mal distance is  tensor(13.0752, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1790, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(455.3607, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.8560e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.5390, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(349.4434, device='cuda:0')
c is  tensor(0.0226, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.5376, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.3761, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.8455, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(433.4478, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.0088e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(422.6540, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.3553e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8915, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
len accept list 3
len all weights is 3
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 90.86% 

Test Accuracy: 89.38% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4074830114841461
distance 1 is tensor(103.1626, device='cuda:0')
distance 2 is tensor(7.6307, device='cuda:0')
benign distance is  tensor(7.6307, device='cuda:0')
norm1 res is  tensor(0.1165, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.44369348883628845
distance 1 is tensor(125.7160, device='cuda:0')
distance 2 is tensor(9.3229, device='cuda:0')
benign distance is  tensor(9.3229, device='cuda:0')
norm1 res is  tensor(0.1389, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.05354434996843338
distance 1 is tensor(65.3560, device='cuda:0')
distance 2 is tensor(4.9878, device='cuda:0')
benign distance is  tensor(4.9878, device='cuda:0')
norm1 res is  tensor(0.0727, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.9964717626571655
distance 1 is tensor(142.1653, device='cuda:0')
distance 2 is tensor(10.4636, device='cuda:0')
benign distance is  tensor(10.4636, device='cuda:0')
norm1 res is  tensor(0.1554, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  2.206347942352295
distance 1 is tensor(130.7718, device='cuda:0')
distance 2 is tensor(9.5739, device='cuda:0')
benign distance is  tensor(9.5739, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8289289474487305
distance 1 is tensor(142.9263, device='cuda:0')
distance 2 is tensor(10.4975, device='cuda:0')
benign distance is  tensor(10.4975, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.2589743733406067
distance 1 is tensor(116.4064, device='cuda:0')
distance 2 is tensor(8.3777, device='cuda:0')
benign distance is  tensor(8.3777, device='cuda:0')
norm1 res is  tensor(0.1274, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8795804977416992
distance 1 is tensor(96.5694, device='cuda:0')
distance 2 is tensor(7.0938, device='cuda:0')
benign distance is  tensor(7.0938, device='cuda:0')
norm1 res is  tensor(0.1062, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(156.6000, device='cuda:0')
distance 2 is tensor(11.5215, device='cuda:0')
compute distance is  tensor(11.5215, device='cuda:0')
compute norm is  tensor(52.6089, device='cuda:0')
distance 1 is tensor(158.5916, device='cuda:0')
distance 2 is tensor(11.6920, device='cuda:0')
compute distance is  tensor(11.6920, device='cuda:0')
compute norm is  tensor(52.8462, device='cuda:0')
distance 1 is tensor(171.0190, device='cuda:0')
distance 2 is tensor(12.4517, device='cuda:0')
compute distance is  tensor(12.4517, device='cuda:0')
compute norm is  tensor(53.0301, device='cuda:0')
distance 1 is tensor(164.6429, device='cuda:0')
distance 2 is tensor(11.8818, device='cuda:0')
compute distance is  tensor(11.8818, device='cuda:0')
compute norm is  tensor(52.8484, device='cuda:0')
distance 1 is tensor(168.3807, device='cuda:0')
distance 2 is tensor(12.2624, device='cuda:0')
compute distance is  tensor(12.2624, device='cuda:0')
compute norm is  tensor(53.0213, device='cuda:0')
distance 1 is tensor(167.9314, device='cuda:0')
distance 2 is tensor(12.1395, device='cuda:0')
compute distance is  tensor(12.1395, device='cuda:0')
compute norm is  tensor(53.1337, device='cuda:0')
distance 1 is tensor(170.0720, device='cuda:0')
distance 2 is tensor(12.3980, device='cuda:0')
compute distance is  tensor(12.3980, device='cuda:0')
compute norm is  tensor(53.1610, device='cuda:0')
distance 1 is tensor(159.7833, device='cuda:0')
distance 2 is tensor(11.7541, device='cuda:0')
compute distance is  tensor(11.7541, device='cuda:0')
compute norm is  tensor(52.8674, device='cuda:0')
distance 1 is tensor(172.1947, device='cuda:0')
distance 2 is tensor(12.4979, device='cuda:0')
compute distance is  tensor(12.4979, device='cuda:0')
compute norm is  tensor(53.1528, device='cuda:0')
distance 1 is tensor(175.7584, device='cuda:0')
distance 2 is tensor(12.7287, device='cuda:0')
compute distance is  tensor(12.7287, device='cuda:0')
compute norm is  tensor(53.1627, device='cuda:0')
distance 1 is tensor(162.2766, device='cuda:0')
distance 2 is tensor(11.8308, device='cuda:0')
compute distance is  tensor(11.8308, device='cuda:0')
compute norm is  tensor(52.9826, device='cuda:0')
distance 1 is tensor(167.2883, device='cuda:0')
distance 2 is tensor(12.2811, device='cuda:0')
compute distance is  tensor(12.2811, device='cuda:0')
compute norm is  tensor(52.9194, device='cuda:0')
distance Threshold  is  tensor(12.7287, device='cuda:0')
distance 1 is tensor(1102055.3750, device='cuda:0')
distance 2 is tensor(79392.8047, device='cuda:0')
________________________________
test distance is  tensor(79392.8047, device='cuda:0')
test similarity is  tensor(-0.0177, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.200173236781951e+17
test entropy is  0.0
________________________________
cal ratio is  0.01139576142204235
distance 1 is tensor(12558.7666, device='cuda:0')
distance 2 is tensor(904.7415, device='cuda:0')
cal_distance is  tensor(904.7415, device='cuda:0')
cal ratio is  0.10675092719954592
distance 1 is tensor(1340.6667, device='cuda:0')
distance 2 is tensor(96.5820, device='cuda:0')
cal_distance is  tensor(96.5820, device='cuda:0')
cal ratio is  0.32672759860957584
distance 1 is tensor(438.0376, device='cuda:0')
distance 2 is tensor(31.5560, device='cuda:0')
cal_distance is  tensor(31.5560, device='cuda:0')
cal ratio is  0.5716009045979474
distance 1 is tensor(250.3858, device='cuda:0')
distance 2 is tensor(18.0374, device='cuda:0')
cal_distance is  tensor(18.0374, device='cuda:0')
cal ratio is  0.7560428627329161
distance 1 is tensor(189.3042, device='cuda:0')
distance 2 is tensor(13.6371, device='cuda:0')
cal_distance is  tensor(13.6371, device='cuda:0')
cal ratio is  0.8695073157869746
distance 1 is tensor(164.6023, device='cuda:0')
distance 2 is tensor(11.8575, device='cuda:0')
cal_distance is  tensor(11.8575, device='cuda:0')
distance 1 is tensor(164.6023, device='cuda:0')
distance 2 is tensor(11.8575, device='cuda:0')
________________________________
test distance is  tensor(11.8575, device='cuda:0')
test similarity is  tensor(0.9401, device='cuda:0')
test acc is  0.8316333334896574
test loss is 98.73942478074194
test entropy is  0.002968234085799303
________________________________
distance 1 is tensor(164.6023, device='cuda:0')
distance 2 is tensor(11.8575, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0028593249797906986
avg test loss is  98.66280513836631
avg accuracy is  0.8312833334896574
solo acc is  0.1126166668229986
compute similarity  is  tensor(0.9401, device='cuda:0')
compute_distance is  tensor(11.8575, device='cuda:0')
compute_norm is  tensor(55.1774, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(153.3250, device='cuda:0')
distance 2 is tensor(13.0176, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9286847053560366
avg test loss is  1.4638443352825352
avg accuracy is  0.8377666668229904
solo acc is  0.32170000015634004
compute similarity  is  tensor(0.9416, device='cuda:0')
compute_distance is  tensor(13.0176, device='cuda:0')
compute_norm is  tensor(54.1678, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.9723, device='cuda:0')
distance 2 is tensor(13.2586, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8917166106482305
avg test loss is  1.530085123805349
avg accuracy is  0.836983333489657
solo acc is  0.26726666682300537
compute similarity  is  tensor(0.9414, device='cuda:0')
compute_distance is  tensor(13.2586, device='cuda:0')
compute_norm is  tensor(53.8363, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.3306, device='cuda:0')
distance 2 is tensor(13.4303, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8717445776914992
avg test loss is  1.518844542854122
avg accuracy is  0.8379666668229904
solo acc is  0.25595000015633845
compute similarity  is  tensor(0.9412, device='cuda:0')
compute_distance is  tensor(13.4303, device='cuda:0')
compute_norm is  tensor(53.5258, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.6151, device='cuda:0')
distance 2 is tensor(13.5772, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8713377465698511
avg test loss is  1.4928880646538887
avg accuracy is  0.8410833334896569
solo acc is  0.2529833334896716
compute similarity  is  tensor(0.9411, device='cuda:0')
compute_distance is  tensor(13.5772, device='cuda:0')
compute_norm is  tensor(53.2278, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.8455, device='cuda:0')
distance 2 is tensor(13.7105, device='cuda:0')
________________________________
test distance is  tensor(13.7105, device='cuda:0')
test similarity is  tensor(0.9410, device='cuda:0')
test acc is  0.8421333334896568
test loss is 1.4712064444129147
test entropy is  0.866185897258299
________________________________
cal ratio is  0.8671760651118052
distance 1 is tensor(137.7478, device='cuda:0')
distance 2 is tensor(11.8894, device='cuda:0')
cal_distance is  tensor(11.8894, device='cuda:0')
distance 1 is tensor(137.7478, device='cuda:0')
distance 2 is tensor(11.8894, device='cuda:0')
________________________________
test distance is  tensor(11.8894, device='cuda:0')
test similarity is  tensor(0.9552, device='cuda:0')
test acc is  0.8578833334896562
test loss is 1.040923391450951
test entropy is  0.9199354546919052
________________________________
distance 1 is tensor(137.7478, device='cuda:0')
distance 2 is tensor(11.8894, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.920539268616166
avg test loss is  1.041968805512894
avg accuracy is  0.8556333334896563
solo acc is  0.535966666823009
compute similarity  is  tensor(0.9552, device='cuda:0')
compute_distance is  tensor(11.8894, device='cuda:0')
compute_norm is  tensor(52.7061, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.4920, device='cuda:0')
distance 2 is tensor(12.2462, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8559110772126773
avg test loss is  1.4420158821128324
avg accuracy is  0.8536666668229898
solo acc is  0.2583000001563385
compute similarity  is  tensor(0.9545, device='cuda:0')
compute_distance is  tensor(12.2462, device='cuda:0')
compute_norm is  tensor(52.4122, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.2268, device='cuda:0')
distance 2 is tensor(12.4130, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8519938693626095
avg test loss is  1.4332387901064176
avg accuracy is  0.8555666668229898
solo acc is  0.25228333348967164
compute similarity  is  tensor(0.9543, device='cuda:0')
compute_distance is  tensor(12.4130, device='cuda:0')
compute_norm is  tensor(52.1292, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.7816, device='cuda:0')
distance 2 is tensor(12.5589, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8436427876385036
avg test loss is  1.4249281138499408
avg accuracy is  0.8580666668229895
solo acc is  0.24906666682300488
compute similarity  is  tensor(0.9541, device='cuda:0')
compute_distance is  tensor(12.5589, device='cuda:0')
compute_norm is  tensor(51.8536, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.2818, device='cuda:0')
distance 2 is tensor(12.6932, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8539064934512953
avg test loss is  1.4010052361976364
avg accuracy is  0.8569666668229896
solo acc is  0.2483500001563381
compute similarity  is  tensor(0.9540, device='cuda:0')
compute_distance is  tensor(12.6932, device='cuda:0')
compute_norm is  tensor(51.5831, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.7749, device='cuda:0')
distance 2 is tensor(12.8206, device='cuda:0')
________________________________
test distance is  tensor(12.8206, device='cuda:0')
test similarity is  tensor(0.9538, device='cuda:0')
test acc is  0.8590666668229895
test loss is 1.40096983205535
test entropy is  0.8438509653117865
________________________________
cal ratio is  0.8967679282151809
distance 1 is tensor(131.6236, device='cuda:0')
distance 2 is tensor(11.4971, device='cuda:0')
cal_distance is  tensor(11.4971, device='cuda:0')
distance 1 is tensor(131.6236, device='cuda:0')
distance 2 is tensor(11.4971, device='cuda:0')
________________________________
test distance is  tensor(11.4971, device='cuda:0')
test similarity is  tensor(0.9629, device='cuda:0')
test acc is  0.8689666668229892
test loss is 1.0442536480264115
test entropy is  0.9041326526385635
________________________________
distance 1 is tensor(131.6236, device='cuda:0')
distance 2 is tensor(11.4971, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9039891188714042
avg test loss is  1.040206403493373
avg accuracy is  0.8693833334896557
solo acc is  0.5088666668230089
compute similarity  is  tensor(0.9629, device='cuda:0')
compute_distance is  tensor(11.4971, device='cuda:0')
compute_norm is  tensor(51.3339, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.3793, device='cuda:0')
distance 2 is tensor(11.8140, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8376213259407198
avg test loss is  1.383570919540137
avg accuracy is  0.865683333489656
solo acc is  0.2501833334896716
compute similarity  is  tensor(0.9622, device='cuda:0')
compute_distance is  tensor(11.8140, device='cuda:0')
compute_norm is  tensor(51.0643, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.2611, device='cuda:0')
distance 2 is tensor(11.9758, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.837121569906979
avg test loss is  1.375149333400767
avg accuracy is  0.8682833334896558
solo acc is  0.24710000015633818
compute similarity  is  tensor(0.9620, device='cuda:0')
compute_distance is  tensor(11.9758, device='cuda:0')
compute_norm is  tensor(50.8003, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.0081, device='cuda:0')
distance 2 is tensor(12.1177, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8377086871595525
avg test loss is  1.3649512869971139
avg accuracy is  0.8696500001563223
solo acc is  0.2414166668230047
compute similarity  is  tensor(0.9618, device='cuda:0')
compute_distance is  tensor(12.1177, device='cuda:0')
compute_norm is  tensor(50.5418, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.7302, device='cuda:0')
distance 2 is tensor(12.2585, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8317203864868261
avg test loss is  1.354481063036522
avg accuracy is  0.8729666668229891
solo acc is  0.24335000015633798
compute similarity  is  tensor(0.9616, device='cuda:0')
compute_distance is  tensor(12.2585, device='cuda:0')
compute_norm is  tensor(50.2858, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.4132, device='cuda:0')
distance 2 is tensor(12.3914, device='cuda:0')
________________________________
test distance is  tensor(12.3914, device='cuda:0')
test similarity is  tensor(0.9615, device='cuda:0')
test acc is  0.8710000001563224
test loss is 1.3497647153797434
test entropy is  0.8266293074149312
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.3845794200897217
mal norm is  tensor(6.3324, device='cuda:0')
distance 1 is tensor(141.4132, device='cuda:0')
distance 2 is tensor(12.3914, device='cuda:0')
mal distance is  tensor(12.3914, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2148, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(457.9422, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.4258, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9643e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(286.2370, device='cuda:0')
c is  tensor(0.0274, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4446, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.6896, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.0441, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(504.9773, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(421.7347, device='cuda:0')
c is  tensor(0.0226, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.2428, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.4670, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.5422e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.4576, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.5292e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.5135, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.3573, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.3137, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.7517e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6379, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.4372, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(716.4328, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.7288e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.9686, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.9224, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9367e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.3712, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.3846, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.3774e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.9599, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.6528, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.2028, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.2183e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.8166, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.1165, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.0325, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.4565, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.7875, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.7662, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.5522, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.7388e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.0414, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.9307e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.8513, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.9694, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.6749, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.6222, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.8125, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.0251, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.5309, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.7863e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.5295, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.3834, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 7
len all weights is 7
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 91.03% 

Test Accuracy: 89.45% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
 benign loss is  0.29063454270362854
distance 1 is tensor(92.9344, device='cuda:0')
distance 2 is tensor(7.0665, device='cuda:0')
benign distance is  tensor(7.0665, device='cuda:0')
norm1 res is  tensor(0.1052, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.10568307340145111
distance 1 is tensor(123.3883, device='cuda:0')
distance 2 is tensor(9.1075, device='cuda:0')
benign distance is  tensor(9.1075, device='cuda:0')
norm1 res is  tensor(0.1369, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.021077638491988182
distance 1 is tensor(79.3908, device='cuda:0')
distance 2 is tensor(5.9119, device='cuda:0')
benign distance is  tensor(5.9119, device='cuda:0')
norm1 res is  tensor(0.0901, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3697509169578552
distance 1 is tensor(123.5219, device='cuda:0')
distance 2 is tensor(9.1340, device='cuda:0')
benign distance is  tensor(9.1340, device='cuda:0')
norm1 res is  tensor(0.1354, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.59087073802948
distance 1 is tensor(130.5216, device='cuda:0')
distance 2 is tensor(9.5532, device='cuda:0')
benign distance is  tensor(9.5532, device='cuda:0')
norm1 res is  tensor(0.1426, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.4172157347202301
distance 1 is tensor(126.9314, device='cuda:0')
distance 2 is tensor(9.3844, device='cuda:0')
benign distance is  tensor(9.3844, device='cuda:0')
norm1 res is  tensor(0.1431, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.316794216632843
distance 1 is tensor(111.9237, device='cuda:0')
distance 2 is tensor(8.2030, device='cuda:0')
benign distance is  tensor(8.2030, device='cuda:0')
norm1 res is  tensor(0.1241, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.438572496175766
distance 1 is tensor(113.8282, device='cuda:0')
distance 2 is tensor(8.3046, device='cuda:0')
benign distance is  tensor(8.3046, device='cuda:0')
norm1 res is  tensor(0.1250, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.3313824534416199
distance 1 is tensor(132.3218, device='cuda:0')
distance 2 is tensor(9.8321, device='cuda:0')
benign distance is  tensor(9.8321, device='cuda:0')
norm1 res is  tensor(0.1489, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.571709930896759
distance 1 is tensor(133.6723, device='cuda:0')
distance 2 is tensor(9.8206, device='cuda:0')
benign distance is  tensor(9.8206, device='cuda:0')
norm1 res is  tensor(0.1475, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.40820327401161194
distance 1 is tensor(135.0821, device='cuda:0')
distance 2 is tensor(9.8838, device='cuda:0')
benign distance is  tensor(9.8838, device='cuda:0')
norm1 res is  tensor(0.1464, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.8005638122558594
distance 1 is tensor(135.0815, device='cuda:0')
distance 2 is tensor(10.0119, device='cuda:0')
benign distance is  tensor(10.0119, device='cuda:0')
norm1 res is  tensor(0.1498, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.24066106975078583
distance 1 is tensor(130.9866, device='cuda:0')
distance 2 is tensor(9.7209, device='cuda:0')
benign distance is  tensor(9.7209, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7904416918754578
distance 1 is tensor(123.5605, device='cuda:0')
distance 2 is tensor(9.1045, device='cuda:0')
benign distance is  tensor(9.1045, device='cuda:0')
norm1 res is  tensor(0.1366, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.4065345227718353
distance 1 is tensor(129.2965, device='cuda:0')
distance 2 is tensor(9.6192, device='cuda:0')
benign distance is  tensor(9.6192, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.10428325831890106
distance 1 is tensor(133.1173, device='cuda:0')
distance 2 is tensor(9.8755, device='cuda:0')
benign distance is  tensor(9.8755, device='cuda:0')
norm1 res is  tensor(0.1466, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.10140632092952728
distance 1 is tensor(136.3930, device='cuda:0')
distance 2 is tensor(9.9418, device='cuda:0')
benign distance is  tensor(9.9418, device='cuda:0')
norm1 res is  tensor(0.1522, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.8033882975578308
distance 1 is tensor(145.7248, device='cuda:0')
distance 2 is tensor(10.7016, device='cuda:0')
benign distance is  tensor(10.7016, device='cuda:0')
norm1 res is  tensor(0.1590, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.26868999004364014
distance 1 is tensor(124.3966, device='cuda:0')
distance 2 is tensor(9.2691, device='cuda:0')
benign distance is  tensor(9.2691, device='cuda:0')
norm1 res is  tensor(0.1375, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.4334690570831299
distance 1 is tensor(129.1852, device='cuda:0')
distance 2 is tensor(9.8056, device='cuda:0')
benign distance is  tensor(9.8056, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.16279378533363342
distance 1 is tensor(130.8149, device='cuda:0')
distance 2 is tensor(9.6151, device='cuda:0')
benign distance is  tensor(9.6151, device='cuda:0')
norm1 res is  tensor(0.1428, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.651465654373169
distance 1 is tensor(132.5876, device='cuda:0')
distance 2 is tensor(9.6384, device='cuda:0')
benign distance is  tensor(9.6384, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.13251033425331116
distance 1 is tensor(129.2300, device='cuda:0')
distance 2 is tensor(9.5080, device='cuda:0')
benign distance is  tensor(9.5080, device='cuda:0')
norm1 res is  tensor(0.1457, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.5346765518188477
distance 1 is tensor(137.4500, device='cuda:0')
distance 2 is tensor(10.0910, device='cuda:0')
benign distance is  tensor(10.0910, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.09145399183034897
distance 1 is tensor(143.7029, device='cuda:0')
distance 2 is tensor(10.5871, device='cuda:0')
benign distance is  tensor(10.5871, device='cuda:0')
norm1 res is  tensor(0.1610, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.32621464133262634
distance 1 is tensor(142.8590, device='cuda:0')
distance 2 is tensor(10.5135, device='cuda:0')
benign distance is  tensor(10.5135, device='cuda:0')
norm1 res is  tensor(0.1555, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.36610010266304016
distance 1 is tensor(146.3997, device='cuda:0')
distance 2 is tensor(10.6895, device='cuda:0')
benign distance is  tensor(10.6895, device='cuda:0')
norm1 res is  tensor(0.1622, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.4873172640800476
distance 1 is tensor(137.2923, device='cuda:0')
distance 2 is tensor(10.1015, device='cuda:0')
benign distance is  tensor(10.1015, device='cuda:0')
norm1 res is  tensor(0.1528, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.657333493232727
distance 1 is tensor(136.8893, device='cuda:0')
distance 2 is tensor(10.0288, device='cuda:0')
benign distance is  tensor(10.0288, device='cuda:0')
norm1 res is  tensor(0.1533, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.4831676483154297
distance 1 is tensor(136.2353, device='cuda:0')
distance 2 is tensor(10.0639, device='cuda:0')
benign distance is  tensor(10.0639, device='cuda:0')
norm1 res is  tensor(0.1492, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.2180965393781662
distance 1 is tensor(134.8363, device='cuda:0')
distance 2 is tensor(9.8012, device='cuda:0')
benign distance is  tensor(9.8012, device='cuda:0')
norm1 res is  tensor(0.1477, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.8413753509521484
distance 1 is tensor(127.8794, device='cuda:0')
distance 2 is tensor(9.4798, device='cuda:0')
benign distance is  tensor(9.4798, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.1870885044336319
distance 1 is tensor(135.7976, device='cuda:0')
distance 2 is tensor(9.9770, device='cuda:0')
benign distance is  tensor(9.9770, device='cuda:0')
norm1 res is  tensor(0.1494, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.12981808185577393
distance 1 is tensor(135.6073, device='cuda:0')
distance 2 is tensor(10.0894, device='cuda:0')
benign distance is  tensor(10.0894, device='cuda:0')
norm1 res is  tensor(0.1487, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.03417196497321129
distance 1 is tensor(126.4605, device='cuda:0')
distance 2 is tensor(9.3735, device='cuda:0')
benign distance is  tensor(9.3735, device='cuda:0')
norm1 res is  tensor(0.1392, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.28452664613723755
distance 1 is tensor(129.1049, device='cuda:0')
distance 2 is tensor(9.5196, device='cuda:0')
benign distance is  tensor(9.5196, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.39341944456100464
distance 1 is tensor(132.2549, device='cuda:0')
distance 2 is tensor(9.6453, device='cuda:0')
benign distance is  tensor(9.6453, device='cuda:0')
norm1 res is  tensor(0.1447, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.24480459094047546
distance 1 is tensor(145.3141, device='cuda:0')
distance 2 is tensor(10.6513, device='cuda:0')
benign distance is  tensor(10.6513, device='cuda:0')
norm1 res is  tensor(0.1581, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.3320651352405548
distance 1 is tensor(147.0189, device='cuda:0')
distance 2 is tensor(10.7556, device='cuda:0')
benign distance is  tensor(10.7556, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.17432720959186554
distance 1 is tensor(143.7158, device='cuda:0')
distance 2 is tensor(10.5472, device='cuda:0')
benign distance is  tensor(10.5472, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(148.4552, device='cuda:0')
distance 2 is tensor(10.8829, device='cuda:0')
compute distance is  tensor(10.8829, device='cuda:0')
compute norm is  tensor(53.2926, device='cuda:0')
distance 1 is tensor(146.2659, device='cuda:0')
distance 2 is tensor(10.6804, device='cuda:0')
compute distance is  tensor(10.6804, device='cuda:0')
compute norm is  tensor(53.2337, device='cuda:0')
distance 1 is tensor(149.9678, device='cuda:0')
distance 2 is tensor(10.8812, device='cuda:0')
compute distance is  tensor(10.8812, device='cuda:0')
compute norm is  tensor(53.2342, device='cuda:0')
distance 1 is tensor(149.6142, device='cuda:0')
distance 2 is tensor(10.9553, device='cuda:0')
compute distance is  tensor(10.9553, device='cuda:0')
compute norm is  tensor(53.2026, device='cuda:0')
distance 1 is tensor(155.9692, device='cuda:0')
distance 2 is tensor(11.4382, device='cuda:0')
compute distance is  tensor(11.4382, device='cuda:0')
compute norm is  tensor(53.3412, device='cuda:0')
distance 1 is tensor(148.3001, device='cuda:0')
distance 2 is tensor(11.0163, device='cuda:0')
compute distance is  tensor(11.0163, device='cuda:0')
compute norm is  tensor(53.2691, device='cuda:0')
distance 1 is tensor(153.9620, device='cuda:0')
distance 2 is tensor(11.2734, device='cuda:0')
compute distance is  tensor(11.2734, device='cuda:0')
compute norm is  tensor(53.3176, device='cuda:0')
distance 1 is tensor(149.6075, device='cuda:0')
distance 2 is tensor(11.0080, device='cuda:0')
compute distance is  tensor(11.0080, device='cuda:0')
compute norm is  tensor(53.3500, device='cuda:0')
distance 1 is tensor(141.0156, device='cuda:0')
distance 2 is tensor(10.3767, device='cuda:0')
compute distance is  tensor(10.3767, device='cuda:0')
compute norm is  tensor(53.0775, device='cuda:0')
distance 1 is tensor(164.5061, device='cuda:0')
distance 2 is tensor(12.0117, device='cuda:0')
compute distance is  tensor(12.0117, device='cuda:0')
compute norm is  tensor(53.6593, device='cuda:0')
distance 1 is tensor(150.4815, device='cuda:0')
distance 2 is tensor(10.8792, device='cuda:0')
compute distance is  tensor(10.8792, device='cuda:0')
compute norm is  tensor(53.3792, device='cuda:0')
distance 1 is tensor(156.9742, device='cuda:0')
distance 2 is tensor(11.5098, device='cuda:0')
compute distance is  tensor(11.5098, device='cuda:0')
compute norm is  tensor(53.4877, device='cuda:0')
distance Threshold  is  tensor(12.0117, device='cuda:0')
distance 1 is tensor(1102056.1250, device='cuda:0')
distance 2 is tensor(79392.7891, device='cuda:0')
________________________________
test distance is  tensor(79392.7891, device='cuda:0')
test similarity is  tensor(-0.0128, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.195364546707711e+17
test entropy is  0.0
________________________________
cal ratio is  0.011070145002467063
distance 1 is tensor(12199.9287, device='cuda:0')
distance 2 is tensor(878.8897, device='cuda:0')
cal_distance is  tensor(878.8897, device='cuda:0')
cal ratio is  0.10521475725894458
distance 1 is tensor(1283.6191, device='cuda:0')
distance 2 is tensor(92.4722, device='cuda:0')
cal_distance is  tensor(92.4722, device='cuda:0')
cal ratio is  0.3243682447733359
distance 1 is tensor(416.3701, device='cuda:0')
distance 2 is tensor(29.9950, device='cuda:0')
cal_distance is  tensor(29.9950, device='cuda:0')
cal ratio is  0.5695333480796315
distance 1 is tensor(237.1398, device='cuda:0')
distance 2 is tensor(17.0832, device='cuda:0')
cal_distance is  tensor(17.0832, device='cuda:0')
cal ratio is  0.7546743498420625
distance 1 is tensor(178.9651, device='cuda:0')
distance 2 is tensor(12.8922, device='cuda:0')
cal_distance is  tensor(12.8922, device='cuda:0')
cal ratio is  0.8687199697175475
distance 1 is tensor(155.4715, device='cuda:0')
distance 2 is tensor(11.1997, device='cuda:0')
cal_distance is  tensor(11.1997, device='cuda:0')
distance 1 is tensor(155.4715, device='cuda:0')
distance 2 is tensor(11.1997, device='cuda:0')
________________________________
test distance is  tensor(11.1997, device='cuda:0')
test similarity is  tensor(0.9450, device='cuda:0')
test acc is  0.8513666668229899
test loss is 66.58541296692545
test entropy is  0.0059214235009020025
________________________________
distance 1 is tensor(155.4715, device='cuda:0')
distance 2 is tensor(11.1997, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.006142184387366411
avg test loss is  66.8213244358868
avg accuracy is  0.8533000001563231
solo acc is  0.12243333348966526
compute similarity  is  tensor(0.9450, device='cuda:0')
compute_distance is  tensor(11.1997, device='cuda:0')
compute_norm is  tensor(54.4441, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(145.7064, device='cuda:0')
distance 2 is tensor(12.3487, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9233682852055727
avg test loss is  1.4371923253353216
avg accuracy is  0.8519500001563233
solo acc is  0.32386666682300663
compute similarity  is  tensor(0.9461, device='cuda:0')
compute_distance is  tensor(12.3487, device='cuda:0')
compute_norm is  tensor(53.4976, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.2101, device='cuda:0')
distance 2 is tensor(12.5819, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8817836002373238
avg test loss is  1.5093384184308651
avg accuracy is  0.8516333334896564
solo acc is  0.2649666668230053
compute similarity  is  tensor(0.9459, device='cuda:0')
compute_distance is  tensor(12.5819, device='cuda:0')
compute_norm is  tensor(53.1761, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.5038, device='cuda:0')
distance 2 is tensor(12.7501, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8742704971004397
avg test loss is  1.4855457959907141
avg accuracy is  0.8517666668229898
solo acc is  0.2605166668230052
compute similarity  is  tensor(0.9457, device='cuda:0')
compute_distance is  tensor(12.7501, device='cuda:0')
compute_norm is  tensor(52.8754, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.7244, device='cuda:0')
distance 2 is tensor(12.8970, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8649683493032638
avg test loss is  1.470856768363066
avg accuracy is  0.8528333334896564
solo acc is  0.25300000015633833
compute similarity  is  tensor(0.9456, device='cuda:0')
compute_distance is  tensor(12.8970, device='cuda:0')
compute_norm is  tensor(52.5882, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.8799, device='cuda:0')
distance 2 is tensor(13.0254, device='cuda:0')
________________________________
test distance is  tensor(13.0254, device='cuda:0')
test similarity is  tensor(0.9455, device='cuda:0')
test acc is  0.853000000156323
test loss is 1.4475889617700313
test entropy is  0.8664890986515769
________________________________
cal ratio is  0.8642689818614193
distance 1 is tensor(130.4017, device='cuda:0')
distance 2 is tensor(11.2574, device='cuda:0')
cal_distance is  tensor(11.2574, device='cuda:0')
distance 1 is tensor(130.4017, device='cuda:0')
distance 2 is tensor(11.2574, device='cuda:0')
________________________________
test distance is  tensor(11.2574, device='cuda:0')
test similarity is  tensor(0.9589, device='cuda:0')
test acc is  0.8687833334896559
test loss is 1.0109998774426832
test entropy is  0.9557013613964195
________________________________
distance 1 is tensor(130.4017, device='cuda:0')
distance 2 is tensor(11.2574, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9564730640032144
avg test loss is  1.0120912719128736
avg accuracy is  0.8692000001563225
solo acc is  0.5479333334896754
compute similarity  is  tensor(0.9589, device='cuda:0')
compute_distance is  tensor(11.2574, device='cuda:0')
compute_norm is  tensor(52.0980, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.9848, device='cuda:0')
distance 2 is tensor(11.5964, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8452972590542043
avg test loss is  1.4323013532898827
avg accuracy is  0.8655666668229893
solo acc is  0.25740000015633846
compute similarity  is  tensor(0.9583, device='cuda:0')
compute_distance is  tensor(11.5964, device='cuda:0')
compute_norm is  tensor(51.8169, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.5694, device='cuda:0')
distance 2 is tensor(11.7482, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8530946114678373
avg test loss is  1.4033362271943326
avg accuracy is  0.8645000001563227
solo acc is  0.25818333348967176
compute similarity  is  tensor(0.9582, device='cuda:0')
compute_distance is  tensor(11.7482, device='cuda:0')
compute_norm is  tensor(51.5424, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.0651, device='cuda:0')
distance 2 is tensor(11.8862, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8484707096619393
avg test loss is  1.3944181562232565
avg accuracy is  0.8653500001563226
solo acc is  0.25473333348967175
compute similarity  is  tensor(0.9580, device='cuda:0')
compute_distance is  tensor(11.8862, device='cuda:0')
compute_norm is  tensor(51.2746, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.4355, device='cuda:0')
distance 2 is tensor(12.0102, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8440441970250754
avg test loss is  1.3890777273472947
avg accuracy is  0.8684833334896559
solo acc is  0.24863333348967154
compute similarity  is  tensor(0.9579, device='cuda:0')
compute_distance is  tensor(12.0102, device='cuda:0')
compute_norm is  tensor(51.0125, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.8903, device='cuda:0')
distance 2 is tensor(12.1371, device='cuda:0')
________________________________
test distance is  tensor(12.1371, device='cuda:0')
test similarity is  tensor(0.9577, device='cuda:0')
test acc is  0.8692666668229891
test loss is 1.3877193162690347
test entropy is  0.8415591241454264
________________________________
cal ratio is  0.8953382907767703
distance 1 is tensor(124.3544, device='cuda:0')
distance 2 is tensor(10.8668, device='cuda:0')
cal_distance is  tensor(10.8668, device='cuda:0')
distance 1 is tensor(124.3544, device='cuda:0')
distance 2 is tensor(10.8668, device='cuda:0')
________________________________
test distance is  tensor(10.8668, device='cuda:0')
test similarity is  tensor(0.9662, device='cuda:0')
test acc is  0.8796666668229887
test loss is 1.0209257081627592
test entropy is  0.9208974611403337
________________________________
distance 1 is tensor(124.3544, device='cuda:0')
distance 2 is tensor(10.8668, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9216752334444254
avg test loss is  1.0162685693327043
avg accuracy is  0.8789500001563221
solo acc is  0.5138666668230089
compute similarity  is  tensor(0.9662, device='cuda:0')
compute_distance is  tensor(10.8668, device='cuda:0')
compute_norm is  tensor(50.7817, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(127.0100, device='cuda:0')
distance 2 is tensor(11.1711, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8350475625569886
avg test loss is  1.3670151031601911
avg accuracy is  0.8761333334896555
solo acc is  0.2523166668230049
compute similarity  is  tensor(0.9656, device='cuda:0')
compute_distance is  tensor(11.1711, device='cuda:0')
compute_norm is  tensor(50.5223, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(128.8147, device='cuda:0')
distance 2 is tensor(11.3240, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8330567390171449
avg test loss is  1.3555434128877197
avg accuracy is  0.8757500001563222
solo acc is  0.24951666682300497
compute similarity  is  tensor(0.9654, device='cuda:0')
compute_distance is  tensor(11.3240, device='cuda:0')
compute_norm is  tensor(50.2648, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.5272, device='cuda:0')
distance 2 is tensor(11.4672, device='cuda:0')
exit early
distance 1 is tensor(130.5272, device='cuda:0')
distance 2 is tensor(11.4672, device='cuda:0')
________________________________
test distance is  tensor(11.4672, device='cuda:0')
test similarity is  tensor(0.9652, device='cuda:0')
test acc is  0.8788666668229888
test loss is 1.3559040455167481
test entropy is  0.8287691122560359
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1203373670578003
mal norm is  tensor(5.9485, device='cuda:0')
distance 1 is tensor(130.5272, device='cuda:0')
distance 2 is tensor(11.4672, device='cuda:0')
mal distance is  tensor(11.4672, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(0.1769, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(414.2645, device='cuda:0')
c is  tensor(0.0207, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.8499, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(339.7972, device='cuda:0')
c is  tensor(0.0228, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.7442e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.9267, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.1326, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.5870, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(487.2841, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(493.7374, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8504, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.5682, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.5038, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.7963e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.3887, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.4036e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.3878, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.7687, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.8401, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.7419, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.4092, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.4208e-05, device='cuda:0')
accept
len accept list 4
len all weights is 4
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 91.01% 

Test Accuracy: 89.43% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
 benign loss is  0.11634079366922379
distance 1 is tensor(111.6500, device='cuda:0')
distance 2 is tensor(8.4197, device='cuda:0')
benign distance is  tensor(8.4197, device='cuda:0')
norm1 res is  tensor(0.1271, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.19621114432811737
distance 1 is tensor(127.3227, device='cuda:0')
distance 2 is tensor(9.3848, device='cuda:0')
benign distance is  tensor(9.3848, device='cuda:0')
norm1 res is  tensor(0.1400, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.23784497380256653
distance 1 is tensor(80.9015, device='cuda:0')
distance 2 is tensor(6.0374, device='cuda:0')
benign distance is  tensor(6.0374, device='cuda:0')
norm1 res is  tensor(0.0884, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3926318287849426
distance 1 is tensor(134.1887, device='cuda:0')
distance 2 is tensor(9.8900, device='cuda:0')
benign distance is  tensor(9.8900, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5449339747428894
distance 1 is tensor(117.0137, device='cuda:0')
distance 2 is tensor(8.6026, device='cuda:0')
benign distance is  tensor(8.6026, device='cuda:0')
norm1 res is  tensor(0.1281, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.3894175887107849
distance 1 is tensor(131.7337, device='cuda:0')
distance 2 is tensor(9.8166, device='cuda:0')
benign distance is  tensor(9.8166, device='cuda:0')
norm1 res is  tensor(0.1497, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.17327813804149628
distance 1 is tensor(112.8960, device='cuda:0')
distance 2 is tensor(8.1398, device='cuda:0')
benign distance is  tensor(8.1398, device='cuda:0')
norm1 res is  tensor(0.1204, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.028864076361060143
distance 1 is tensor(116.0709, device='cuda:0')
distance 2 is tensor(8.4707, device='cuda:0')
benign distance is  tensor(8.4707, device='cuda:0')
norm1 res is  tensor(0.1271, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.2097773253917694
distance 1 is tensor(114.6242, device='cuda:0')
distance 2 is tensor(8.4047, device='cuda:0')
benign distance is  tensor(8.4047, device='cuda:0')
norm1 res is  tensor(0.1264, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.2279725819826126
distance 1 is tensor(118.7118, device='cuda:0')
distance 2 is tensor(8.8316, device='cuda:0')
benign distance is  tensor(8.8316, device='cuda:0')
norm1 res is  tensor(0.1327, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.08979245275259018
distance 1 is tensor(141.0349, device='cuda:0')
distance 2 is tensor(10.3833, device='cuda:0')
benign distance is  tensor(10.3833, device='cuda:0')
norm1 res is  tensor(0.1554, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.24215535819530487
distance 1 is tensor(121.9437, device='cuda:0')
distance 2 is tensor(8.9593, device='cuda:0')
benign distance is  tensor(8.9593, device='cuda:0')
norm1 res is  tensor(0.1344, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.5060703754425049
distance 1 is tensor(144.2877, device='cuda:0')
distance 2 is tensor(10.5237, device='cuda:0')
benign distance is  tensor(10.5237, device='cuda:0')
norm1 res is  tensor(0.1563, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.37252816557884216
distance 1 is tensor(136.4403, device='cuda:0')
distance 2 is tensor(10.0464, device='cuda:0')
benign distance is  tensor(10.0464, device='cuda:0')
norm1 res is  tensor(0.1494, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.550301194190979
distance 1 is tensor(136.1787, device='cuda:0')
distance 2 is tensor(10.0802, device='cuda:0')
benign distance is  tensor(10.0802, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.07722704112529755
distance 1 is tensor(119.2443, device='cuda:0')
distance 2 is tensor(8.7963, device='cuda:0')
benign distance is  tensor(8.7963, device='cuda:0')
norm1 res is  tensor(0.1344, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(138.1508, device='cuda:0')
distance 2 is tensor(9.9689, device='cuda:0')
compute distance is  tensor(9.9689, device='cuda:0')
compute norm is  tensor(53.4474, device='cuda:0')
distance 1 is tensor(135.1729, device='cuda:0')
distance 2 is tensor(9.8789, device='cuda:0')
compute distance is  tensor(9.8789, device='cuda:0')
compute norm is  tensor(53.4930, device='cuda:0')
distance 1 is tensor(139.1881, device='cuda:0')
distance 2 is tensor(10.1725, device='cuda:0')
compute distance is  tensor(10.1725, device='cuda:0')
compute norm is  tensor(53.6101, device='cuda:0')
distance 1 is tensor(142.3267, device='cuda:0')
distance 2 is tensor(10.5493, device='cuda:0')
compute distance is  tensor(10.5493, device='cuda:0')
compute norm is  tensor(53.6845, device='cuda:0')
distance 1 is tensor(148.0365, device='cuda:0')
distance 2 is tensor(10.7284, device='cuda:0')
compute distance is  tensor(10.7284, device='cuda:0')
compute norm is  tensor(53.7212, device='cuda:0')
distance 1 is tensor(154.6677, device='cuda:0')
distance 2 is tensor(11.2916, device='cuda:0')
compute distance is  tensor(11.2916, device='cuda:0')
compute norm is  tensor(54.0028, device='cuda:0')
distance 1 is tensor(139.2456, device='cuda:0')
distance 2 is tensor(10.1801, device='cuda:0')
compute distance is  tensor(10.1801, device='cuda:0')
compute norm is  tensor(53.6398, device='cuda:0')
distance 1 is tensor(149.1229, device='cuda:0')
distance 2 is tensor(10.7142, device='cuda:0')
compute distance is  tensor(10.7142, device='cuda:0')
compute norm is  tensor(53.7695, device='cuda:0')
distance 1 is tensor(146.2947, device='cuda:0')
distance 2 is tensor(10.6299, device='cuda:0')
compute distance is  tensor(10.6299, device='cuda:0')
compute norm is  tensor(53.7736, device='cuda:0')
distance 1 is tensor(142.4439, device='cuda:0')
distance 2 is tensor(10.4806, device='cuda:0')
compute distance is  tensor(10.4806, device='cuda:0')
compute norm is  tensor(53.6751, device='cuda:0')
distance 1 is tensor(151.2718, device='cuda:0')
distance 2 is tensor(11.1956, device='cuda:0')
compute distance is  tensor(11.1956, device='cuda:0')
compute norm is  tensor(53.9372, device='cuda:0')
distance 1 is tensor(139.7946, device='cuda:0')
distance 2 is tensor(10.3053, device='cuda:0')
compute distance is  tensor(10.3053, device='cuda:0')
compute norm is  tensor(53.6233, device='cuda:0')
distance Threshold  is  tensor(11.2916, device='cuda:0')
distance 1 is tensor(1102059.6250, device='cuda:0')
distance 2 is tensor(79393.0781, device='cuda:0')
________________________________
test distance is  tensor(79393.0781, device='cuda:0')
test similarity is  tensor(-0.0236, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.19332033788356e+17
test entropy is  0.0
________________________________
cal ratio is  0.010733184665587682
distance 1 is tensor(11828.6172, device='cuda:0')
distance 2 is tensor(852.1406, device='cuda:0')
cal_distance is  tensor(852.1406, device='cuda:0')
cal ratio is  0.10360108514100035
distance 1 is tensor(1225.4639, device='cuda:0')
distance 2 is tensor(88.2827, device='cuda:0')
cal_distance is  tensor(88.2827, device='cuda:0')
cal ratio is  0.32187125333438704
distance 1 is tensor(394.4465, device='cuda:0')
distance 2 is tensor(28.4157, device='cuda:0')
cal_distance is  tensor(28.4157, device='cuda:0')
cal ratio is  0.5673369628449847
distance 1 is tensor(223.7872, device='cuda:0')
distance 2 is tensor(16.1213, device='cuda:0')
cal_distance is  tensor(16.1213, device='cuda:0')
cal ratio is  0.753217688669852
distance 1 is tensor(168.5623, device='cuda:0')
distance 2 is tensor(12.1428, device='cuda:0')
cal_distance is  tensor(12.1428, device='cuda:0')
cal ratio is  0.8678811490053834
distance 1 is tensor(146.2930, device='cuda:0')
distance 2 is tensor(10.5385, device='cuda:0')
cal_distance is  tensor(10.5385, device='cuda:0')
distance 1 is tensor(146.2930, device='cuda:0')
distance 2 is tensor(10.5385, device='cuda:0')
________________________________
test distance is  tensor(10.5385, device='cuda:0')
test similarity is  tensor(0.9508, device='cuda:0')
test acc is  0.8639500001563227
test loss is 47.76876824547741
test entropy is  0.013263475510078301
________________________________
distance 1 is tensor(146.2930, device='cuda:0')
distance 2 is tensor(10.5385, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.013615887101388205
avg test loss is  47.94680162686021
avg accuracy is  0.866783333489656
solo acc is  0.15725000015633378
compute similarity  is  tensor(0.9508, device='cuda:0')
compute_distance is  tensor(10.5385, device='cuda:0')
compute_norm is  tensor(54.2656, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(138.1133, device='cuda:0')
distance 2 is tensor(11.7702, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9178027306030045
avg test loss is  1.4177646628702119
avg accuracy is  0.8502500001563232
solo acc is  0.3384833334896736
compute similarity  is  tensor(0.9516, device='cuda:0')
compute_distance is  tensor(11.7702, device='cuda:0')
compute_norm is  tensor(53.3112, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.7434, device='cuda:0')
distance 2 is tensor(12.0204, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8836913936809182
avg test loss is  1.4951112313565416
avg accuracy is  0.8488833334896565
solo acc is  0.2711000001563388
compute similarity  is  tensor(0.9514, device='cuda:0')
compute_distance is  tensor(12.0204, device='cuda:0')
compute_norm is  tensor(52.9872, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.1905, device='cuda:0')
distance 2 is tensor(12.2056, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8760146374133095
avg test loss is  1.479574811738183
avg accuracy is  0.8507000001563232
solo acc is  0.2591833334896718
compute similarity  is  tensor(0.9512, device='cuda:0')
compute_distance is  tensor(12.2056, device='cuda:0')
compute_norm is  tensor(52.6835, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.4706, device='cuda:0')
distance 2 is tensor(12.3541, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8622346641158244
avg test loss is  1.466079696155052
avg accuracy is  0.8521000001563233
solo acc is  0.25310000015633827
compute similarity  is  tensor(0.9511, device='cuda:0')
compute_distance is  tensor(12.3541, device='cuda:0')
compute_norm is  tensor(52.3941, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.7566, device='cuda:0')
distance 2 is tensor(12.4940, device='cuda:0')
________________________________
test distance is  tensor(12.4940, device='cuda:0')
test similarity is  tensor(0.9510, device='cuda:0')
test acc is  0.8546333334896563
test loss is 1.45454819192256
test entropy is  0.8502835241207944
________________________________
cal ratio is  0.8555966414913347
distance 1 is tensor(122.9986, device='cuda:0')
distance 2 is tensor(10.6898, device='cuda:0')
cal_distance is  tensor(10.6898, device='cuda:0')
distance 1 is tensor(122.9986, device='cuda:0')
distance 2 is tensor(10.6898, device='cuda:0')
________________________________
test distance is  tensor(10.6898, device='cuda:0')
test similarity is  tensor(0.9639, device='cuda:0')
test acc is  0.8687833334896559
test loss is 0.9774367815650093
test entropy is  0.9112834758850049
________________________________
distance 1 is tensor(122.9986, device='cuda:0')
distance 2 is tensor(10.6898, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9128873407967818
avg test loss is  0.9794450679313399
avg accuracy is  0.8691166668229892
solo acc is  0.5731833334896732
compute similarity  is  tensor(0.9639, device='cuda:0')
compute_distance is  tensor(10.6898, device='cuda:0')
compute_norm is  tensor(51.9633, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(125.8577, device='cuda:0')
distance 2 is tensor(11.0650, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8443010759506144
avg test loss is  1.4157187885312892
avg accuracy is  0.8661666668229893
solo acc is  0.264483333489672
compute similarity  is  tensor(0.9632, device='cuda:0')
compute_distance is  tensor(11.0650, device='cuda:0')
compute_norm is  tensor(51.6769, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(127.5967, device='cuda:0')
distance 2 is tensor(11.2351, device='cuda:0')
exit early
distance 1 is tensor(127.5967, device='cuda:0')
distance 2 is tensor(11.2351, device='cuda:0')
________________________________
test distance is  tensor(11.2351, device='cuda:0')
test similarity is  tensor(0.9630, device='cuda:0')
test acc is  0.8684000001563225
test loss is 1.4168537220339785
test entropy is  0.8386324597065891
________________________________
distance 1 is tensor(127.5967, device='cuda:0')
distance 2 is tensor(11.2351, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8398268011841439
avg test loss is  1.4119094143798356
avg accuracy is  0.8659666668229893
solo acc is  0.2552833334896718
compute similarity  is  tensor(0.9630, device='cuda:0')
compute_distance is  tensor(11.2351, device='cuda:0')
compute_norm is  tensor(51.4028, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.2607, device='cuda:0')
distance 2 is tensor(11.3872, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8439842679226068
avg test loss is  1.3948900671655944
avg accuracy is  0.8679000001563225
solo acc is  0.2513333334896716
compute similarity  is  tensor(0.9629, device='cuda:0')
compute_distance is  tensor(11.3872, device='cuda:0')
compute_norm is  tensor(51.1333, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.8067, device='cuda:0')
distance 2 is tensor(11.5265, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8392653426508914
avg test loss is  1.38298969482308
avg accuracy is  0.8685833334896558
solo acc is  0.2514833334896716
compute similarity  is  tensor(0.9627, device='cuda:0')
compute_distance is  tensor(11.5265, device='cuda:0')
compute_norm is  tensor(50.8706, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.3491, device='cuda:0')
distance 2 is tensor(11.6580, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8406617101321596
avg test loss is  1.3652230837324788
avg accuracy is  0.8696666668229892
solo acc is  0.25191666682300495
compute similarity  is  tensor(0.9626, device='cuda:0')
compute_distance is  tensor(11.6580, device='cuda:0')
compute_norm is  tensor(50.6112, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.8896, device='cuda:0')
distance 2 is tensor(11.7875, device='cuda:0')
exit early
distance 1 is tensor(133.8896, device='cuda:0')
distance 2 is tensor(11.7875, device='cuda:0')
________________________________
test distance is  tensor(11.7875, device='cuda:0')
test similarity is  tensor(0.9624, device='cuda:0')
test acc is  0.8727666668229891
test loss is 1.3654494645244786
test entropy is  0.8344069576339681
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.358486533164978
mal norm is  tensor(6.1915, device='cuda:0')
distance 1 is tensor(133.8896, device='cuda:0')
distance 2 is tensor(11.7875, device='cuda:0')
mal distance is  tensor(11.7875, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.0451, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.5983, device='cuda:0')
c is  tensor(0.0095, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.9752e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(554.3973, device='cuda:0')
c is  tensor(0.0090, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.5329e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(342.3794, device='cuda:0')
c is  tensor(0.0115, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.5996e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.7728, device='cuda:0')
c is  tensor(0.0088, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0495e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(509.3748, device='cuda:0')
c is  tensor(0.0094, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.2549e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.4236, device='cuda:0')
c is  tensor(0.0088, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.0530e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.0557, device='cuda:0')
c is  tensor(0.0097, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.7540e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.0964, device='cuda:0')
c is  tensor(0.0095, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.5043e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.1525, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5224e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.8275, device='cuda:0')
c is  tensor(0.0083, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.5296e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.3162, device='cuda:0')
c is  tensor(0.0084, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.4978e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.4933, device='cuda:0')
c is  tensor(0.0083, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.9475e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.0031, device='cuda:0')
c is  tensor(0.0083, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.8039e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.8952, device='cuda:0')
c is  tensor(0.0084, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.3834e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.3910, device='cuda:0')
c is  tensor(0.0086, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.8329e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.4141, device='cuda:0')
c is  tensor(0.0085, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.9403e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.6589, device='cuda:0')
c is  tensor(0.0083, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.2993e-05, device='cuda:0')
accept
len accept list 27
len all weights is 27
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 90.54% 

Test Accuracy: 88.86% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4130570888519287
distance 1 is tensor(118.8326, device='cuda:0')
distance 2 is tensor(8.8315, device='cuda:0')
benign distance is  tensor(8.8315, device='cuda:0')
norm1 res is  tensor(0.1274, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.2539319097995758
distance 1 is tensor(142.2957, device='cuda:0')
distance 2 is tensor(10.4794, device='cuda:0')
benign distance is  tensor(10.4794, device='cuda:0')
norm1 res is  tensor(0.1564, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.03235276788473129
distance 1 is tensor(124.5284, device='cuda:0')
distance 2 is tensor(9.2264, device='cuda:0')
benign distance is  tensor(9.2264, device='cuda:0')
norm1 res is  tensor(0.1304, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3602672219276428
distance 1 is tensor(148.1951, device='cuda:0')
distance 2 is tensor(10.7909, device='cuda:0')
benign distance is  tensor(10.7909, device='cuda:0')
norm1 res is  tensor(0.1575, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0253933668136597
distance 1 is tensor(137.7011, device='cuda:0')
distance 2 is tensor(10.2267, device='cuda:0')
benign distance is  tensor(10.2267, device='cuda:0')
norm1 res is  tensor(0.1473, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5995832085609436
distance 1 is tensor(146.0613, device='cuda:0')
distance 2 is tensor(10.8641, device='cuda:0')
benign distance is  tensor(10.8641, device='cuda:0')
norm1 res is  tensor(0.1590, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.43458908796310425
distance 1 is tensor(123.9921, device='cuda:0')
distance 2 is tensor(9.1756, device='cuda:0')
benign distance is  tensor(9.1756, device='cuda:0')
norm1 res is  tensor(0.1319, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.10853378474712372
distance 1 is tensor(138.7479, device='cuda:0')
distance 2 is tensor(10.3450, device='cuda:0')
benign distance is  tensor(10.3450, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.09370219707489014
distance 1 is tensor(142.4320, device='cuda:0')
distance 2 is tensor(10.5007, device='cuda:0')
benign distance is  tensor(10.5007, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.6004576683044434
distance 1 is tensor(138.0401, device='cuda:0')
distance 2 is tensor(10.2048, device='cuda:0')
benign distance is  tensor(10.2048, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.5659081339836121
distance 1 is tensor(134.0432, device='cuda:0')
distance 2 is tensor(9.8703, device='cuda:0')
benign distance is  tensor(9.8703, device='cuda:0')
norm1 res is  tensor(0.1451, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.7669702172279358
distance 1 is tensor(143.9696, device='cuda:0')
distance 2 is tensor(10.7696, device='cuda:0')
benign distance is  tensor(10.7696, device='cuda:0')
norm1 res is  tensor(0.1563, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.3532867431640625
distance 1 is tensor(140.3023, device='cuda:0')
distance 2 is tensor(10.3509, device='cuda:0')
benign distance is  tensor(10.3509, device='cuda:0')
norm1 res is  tensor(0.1498, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.4311927855014801
distance 1 is tensor(133.7599, device='cuda:0')
distance 2 is tensor(9.8188, device='cuda:0')
benign distance is  tensor(9.8188, device='cuda:0')
norm1 res is  tensor(0.1428, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.2711932361125946
distance 1 is tensor(145.5708, device='cuda:0')
distance 2 is tensor(10.7666, device='cuda:0')
benign distance is  tensor(10.7666, device='cuda:0')
norm1 res is  tensor(0.1589, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.42601174116134644
distance 1 is tensor(147.0153, device='cuda:0')
distance 2 is tensor(10.8584, device='cuda:0')
benign distance is  tensor(10.8584, device='cuda:0')
norm1 res is  tensor(0.1609, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(146.6543, device='cuda:0')
distance 2 is tensor(10.9665, device='cuda:0')
compute distance is  tensor(10.9665, device='cuda:0')
compute norm is  tensor(53.4870, device='cuda:0')
distance 1 is tensor(168.5894, device='cuda:0')
distance 2 is tensor(12.5902, device='cuda:0')
compute distance is  tensor(12.5902, device='cuda:0')
compute norm is  tensor(54.0076, device='cuda:0')
distance 1 is tensor(162.0941, device='cuda:0')
distance 2 is tensor(12.1405, device='cuda:0')
compute distance is  tensor(12.1405, device='cuda:0')
compute norm is  tensor(54.0222, device='cuda:0')
distance 1 is tensor(153.3755, device='cuda:0')
distance 2 is tensor(11.3745, device='cuda:0')
compute distance is  tensor(11.3745, device='cuda:0')
compute norm is  tensor(53.6263, device='cuda:0')
distance 1 is tensor(166.7247, device='cuda:0')
distance 2 is tensor(12.3514, device='cuda:0')
compute distance is  tensor(12.3514, device='cuda:0')
compute norm is  tensor(53.9741, device='cuda:0')
distance 1 is tensor(160.7995, device='cuda:0')
distance 2 is tensor(12.0337, device='cuda:0')
compute distance is  tensor(12.0337, device='cuda:0')
compute norm is  tensor(54.1005, device='cuda:0')
distance 1 is tensor(169.1030, device='cuda:0')
distance 2 is tensor(12.5357, device='cuda:0')
compute distance is  tensor(12.5357, device='cuda:0')
compute norm is  tensor(54.0823, device='cuda:0')
distance 1 is tensor(160.0939, device='cuda:0')
distance 2 is tensor(11.8393, device='cuda:0')
compute distance is  tensor(11.8393, device='cuda:0')
compute norm is  tensor(53.8887, device='cuda:0')
distance 1 is tensor(166.0796, device='cuda:0')
distance 2 is tensor(12.0273, device='cuda:0')
compute distance is  tensor(12.0273, device='cuda:0')
compute norm is  tensor(53.8801, device='cuda:0')
distance 1 is tensor(156.5591, device='cuda:0')
distance 2 is tensor(11.6379, device='cuda:0')
compute distance is  tensor(11.6379, device='cuda:0')
compute norm is  tensor(53.8014, device='cuda:0')
distance 1 is tensor(163.1162, device='cuda:0')
distance 2 is tensor(12.0527, device='cuda:0')
compute distance is  tensor(12.0527, device='cuda:0')
compute norm is  tensor(54.0087, device='cuda:0')
distance 1 is tensor(147.8008, device='cuda:0')
distance 2 is tensor(10.9024, device='cuda:0')
compute distance is  tensor(10.9024, device='cuda:0')
compute norm is  tensor(53.6716, device='cuda:0')
distance Threshold  is  tensor(12.5902, device='cuda:0')
distance 1 is tensor(1102028.6250, device='cuda:0')
distance 2 is tensor(79390.4453, device='cuda:0')
________________________________
test distance is  tensor(79390.4453, device='cuda:0')
test similarity is  tensor(0.0609, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.196833030642367e+17
test entropy is  0.0
________________________________
cal ratio is  0.011333796522970238
distance 1 is tensor(12490.1758, device='cuda:0')
distance 2 is tensor(899.7952, device='cuda:0')
cal_distance is  tensor(899.7952, device='cuda:0')
cal ratio is  0.10646029725599239
distance 1 is tensor(1329.7142, device='cuda:0')
distance 2 is tensor(95.7925, device='cuda:0')
cal_distance is  tensor(95.7925, device='cuda:0')
cal ratio is  0.3262825518844173
distance 1 is tensor(433.8674, device='cuda:0')
distance 2 is tensor(31.2554, device='cuda:0')
cal_distance is  tensor(31.2554, device='cuda:0')
cal ratio is  0.5712114557225928
distance 1 is tensor(247.8331, device='cuda:0')
distance 2 is tensor(17.8534, device='cuda:0')
cal_distance is  tensor(17.8534, device='cuda:0')
cal ratio is  0.7557853414075012
distance 1 is tensor(187.3104, device='cuda:0')
distance 2 is tensor(13.4934, device='cuda:0')
cal_distance is  tensor(13.4934, device='cuda:0')
cal ratio is  0.8693591335667008
distance 1 is tensor(162.8410, device='cuda:0')
distance 2 is tensor(11.7306, device='cuda:0')
cal_distance is  tensor(11.7306, device='cuda:0')
distance 1 is tensor(162.8410, device='cuda:0')
distance 2 is tensor(11.7306, device='cuda:0')
________________________________
test distance is  tensor(11.7306, device='cuda:0')
test similarity is  tensor(0.9414, device='cuda:0')
test acc is  0.5206333334896756
test loss is 117.65175307381637
test entropy is  6.509554924521435e-05
________________________________
distance 1 is tensor(162.8410, device='cuda:0')
distance 2 is tensor(11.7306, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  2.2493001262582506e-05
avg test loss is  117.65019195979592
avg accuracy is  0.5225166668230089
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9414, device='cuda:0')
compute_distance is  tensor(11.7306, device='cuda:0')
compute_norm is  tensor(54.5495, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(148.2531, device='cuda:0')
distance 2 is tensor(12.2408, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9075894310657404
avg test loss is  1.4318252612532838
avg accuracy is  0.7956000001563256
solo acc is  0.31305000015633977
compute similarity  is  tensor(0.9436, device='cuda:0')
compute_distance is  tensor(12.2408, device='cuda:0')
compute_norm is  tensor(53.8474, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(148.2531, device='cuda:0')
distance 2 is tensor(12.2408, device='cuda:0')
________________________________
test distance is  tensor(12.2408, device='cuda:0')
test similarity is  tensor(0.9436, device='cuda:0')
test acc is  0.794183333489659
test loss is 1.4335996892406488
test entropy is  0.9072218564654718
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.1639715433120728
mal norm is  tensor(7.9298, device='cuda:0')
distance 1 is tensor(148.2531, device='cuda:0')
distance 2 is tensor(12.2408, device='cuda:0')
mal distance is  tensor(12.2408, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1421, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.6498, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.9026, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.5914e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(518.8689, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8601, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.6256, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9475e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.6058, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.2906, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.9628, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.9792, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9387e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2686, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.6290, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.6232, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.9709, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.8214, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1068, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.6688, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.1420, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
len accept list 14
len all weights is 14
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 79.23% 

Test Accuracy: 77.95% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8299050331115723
distance 1 is tensor(225.4503, device='cuda:0')
distance 2 is tensor(16.9185, device='cuda:0')
benign distance is  tensor(16.9185, device='cuda:0')
norm1 res is  tensor(0.2248, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5707770586013794
distance 1 is tensor(221.4951, device='cuda:0')
distance 2 is tensor(17.1409, device='cuda:0')
benign distance is  tensor(17.1409, device='cuda:0')
norm1 res is  tensor(0.2222, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.33581528067588806
distance 1 is tensor(221.9566, device='cuda:0')
distance 2 is tensor(17.0036, device='cuda:0')
benign distance is  tensor(17.0036, device='cuda:0')
norm1 res is  tensor(0.2203, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.22656580805778503
distance 1 is tensor(226.5410, device='cuda:0')
distance 2 is tensor(17.2211, device='cuda:0')
benign distance is  tensor(17.2211, device='cuda:0')
norm1 res is  tensor(0.2278, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8600999712944031
distance 1 is tensor(215.3490, device='cuda:0')
distance 2 is tensor(15.9723, device='cuda:0')
benign distance is  tensor(15.9723, device='cuda:0')
norm1 res is  tensor(0.2126, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5792932510375977
distance 1 is tensor(218.4854, device='cuda:0')
distance 2 is tensor(16.4452, device='cuda:0')
benign distance is  tensor(16.4452, device='cuda:0')
norm1 res is  tensor(0.2185, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.5364257097244263
distance 1 is tensor(213.9358, device='cuda:0')
distance 2 is tensor(16.2328, device='cuda:0')
benign distance is  tensor(16.2328, device='cuda:0')
norm1 res is  tensor(0.2140, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6422601938247681
distance 1 is tensor(228.5963, device='cuda:0')
distance 2 is tensor(17.3155, device='cuda:0')
benign distance is  tensor(17.3155, device='cuda:0')
norm1 res is  tensor(0.2265, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.36095184087753296
distance 1 is tensor(221.1513, device='cuda:0')
distance 2 is tensor(16.9705, device='cuda:0')
benign distance is  tensor(16.9705, device='cuda:0')
norm1 res is  tensor(0.2191, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.5512828230857849
distance 1 is tensor(220.9115, device='cuda:0')
distance 2 is tensor(17.1245, device='cuda:0')
benign distance is  tensor(17.1245, device='cuda:0')
norm1 res is  tensor(0.2235, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.24307425320148468
distance 1 is tensor(215.7541, device='cuda:0')
distance 2 is tensor(16.4098, device='cuda:0')
benign distance is  tensor(16.4098, device='cuda:0')
norm1 res is  tensor(0.2118, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9670360684394836
distance 1 is tensor(225.4032, device='cuda:0')
distance 2 is tensor(17.4728, device='cuda:0')
benign distance is  tensor(17.4728, device='cuda:0')
norm1 res is  tensor(0.2290, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.41431277990341187
distance 1 is tensor(225.8444, device='cuda:0')
distance 2 is tensor(17.4562, device='cuda:0')
benign distance is  tensor(17.4562, device='cuda:0')
norm1 res is  tensor(0.2224, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.1622333526611328
distance 1 is tensor(210.4587, device='cuda:0')
distance 2 is tensor(15.7872, device='cuda:0')
benign distance is  tensor(15.7872, device='cuda:0')
norm1 res is  tensor(0.2113, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.477599561214447
distance 1 is tensor(204.7723, device='cuda:0')
distance 2 is tensor(15.9939, device='cuda:0')
benign distance is  tensor(15.9939, device='cuda:0')
norm1 res is  tensor(0.2038, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.17176681756973267
distance 1 is tensor(219.4905, device='cuda:0')
distance 2 is tensor(16.9159, device='cuda:0')
benign distance is  tensor(16.9159, device='cuda:0')
norm1 res is  tensor(0.2213, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(207.2120, device='cuda:0')
distance 2 is tensor(16.0032, device='cuda:0')
compute distance is  tensor(16.0032, device='cuda:0')
compute norm is  tensor(53.8577, device='cuda:0')
distance 1 is tensor(204.9207, device='cuda:0')
distance 2 is tensor(15.8385, device='cuda:0')
compute distance is  tensor(15.8385, device='cuda:0')
compute norm is  tensor(53.8478, device='cuda:0')
distance 1 is tensor(219.6119, device='cuda:0')
distance 2 is tensor(16.7819, device='cuda:0')
compute distance is  tensor(16.7819, device='cuda:0')
compute norm is  tensor(54.2141, device='cuda:0')
distance 1 is tensor(212.1040, device='cuda:0')
distance 2 is tensor(16.2640, device='cuda:0')
compute distance is  tensor(16.2640, device='cuda:0')
compute norm is  tensor(53.9297, device='cuda:0')
distance 1 is tensor(215.2302, device='cuda:0')
distance 2 is tensor(16.5292, device='cuda:0')
compute distance is  tensor(16.5292, device='cuda:0')
compute norm is  tensor(54.1662, device='cuda:0')
distance 1 is tensor(219.1341, device='cuda:0')
distance 2 is tensor(16.7723, device='cuda:0')
compute distance is  tensor(16.7723, device='cuda:0')
compute norm is  tensor(54.3998, device='cuda:0')
distance 1 is tensor(216.4047, device='cuda:0')
distance 2 is tensor(16.6442, device='cuda:0')
compute distance is  tensor(16.6442, device='cuda:0')
compute norm is  tensor(54.2237, device='cuda:0')
distance 1 is tensor(216.9949, device='cuda:0')
distance 2 is tensor(16.7746, device='cuda:0')
compute distance is  tensor(16.7746, device='cuda:0')
compute norm is  tensor(54.1157, device='cuda:0')
distance 1 is tensor(215.7621, device='cuda:0')
distance 2 is tensor(16.4111, device='cuda:0')
compute distance is  tensor(16.4111, device='cuda:0')
compute norm is  tensor(54.1633, device='cuda:0')
distance 1 is tensor(213.4432, device='cuda:0')
distance 2 is tensor(16.4077, device='cuda:0')
compute distance is  tensor(16.4077, device='cuda:0')
compute norm is  tensor(54.1188, device='cuda:0')
distance 1 is tensor(216.7680, device='cuda:0')
distance 2 is tensor(16.5715, device='cuda:0')
compute distance is  tensor(16.5715, device='cuda:0')
compute norm is  tensor(54.1144, device='cuda:0')
distance 1 is tensor(206.7370, device='cuda:0')
distance 2 is tensor(16.0336, device='cuda:0')
compute distance is  tensor(16.0336, device='cuda:0')
compute norm is  tensor(54.0108, device='cuda:0')
distance Threshold  is  tensor(16.7819, device='cuda:0')
distance 1 is tensor(1101943.8750, device='cuda:0')
distance 2 is tensor(79383.7578, device='cuda:0')
________________________________
test distance is  tensor(79383.7578, device='cuda:0')
test similarity is  tensor(0.2822, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.194559636502365e+17
test entropy is  0.0
________________________________
cal ratio is  0.01308572728629616
distance 1 is tensor(14419.7432, device='cuda:0')
distance 2 is tensor(1038.7944, device='cuda:0')
cal_distance is  tensor(1038.7944, device='cuda:0')
cal ratio is  0.11439285001256921
distance 1 is tensor(1649.5217, device='cuda:0')
distance 2 is tensor(118.8306, device='cuda:0')
cal_distance is  tensor(118.8306, device='cuda:0')
cal ratio is  0.33822013796327954
distance 1 is tensor(557.9062, device='cuda:0')
distance 2 is tensor(40.1909, device='cuda:0')
cal_distance is  tensor(40.1909, device='cuda:0')
cal ratio is  0.5815669426192331
distance 1 is tensor(324.4629, device='cuda:0')
distance 2 is tensor(23.3737, device='cuda:0')
cal_distance is  tensor(23.3737, device='cuda:0')
cal ratio is  0.7626054081209567
distance 1 is tensor(247.4388, device='cuda:0')
distance 2 is tensor(17.8249, device='cuda:0')
cal_distance is  tensor(17.8249, device='cuda:0')
cal ratio is  0.8732728642600094
distance 1 is tensor(216.0826, device='cuda:0')
distance 2 is tensor(15.5660, device='cuda:0')
cal_distance is  tensor(15.5660, device='cuda:0')
distance 1 is tensor(216.0826, device='cuda:0')
distance 2 is tensor(15.5660, device='cuda:0')
________________________________
test distance is  tensor(15.5660, device='cuda:0')
test similarity is  tensor(0.9291, device='cuda:0')
test acc is  0.10033333348966532
test loss is 445.1940081826151
test entropy is  3.7348040093945016e-47
________________________________
distance 1 is tensor(216.0826, device='cuda:0')
distance 2 is tensor(15.5660, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  2.581134404696729e-40
avg test loss is  444.5341144553634
avg accuracy is  0.10036666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9291, device='cuda:0')
compute_distance is  tensor(15.5660, device='cuda:0')
compute_norm is  tensor(59.8043, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(206.6505, device='cuda:0')
distance 2 is tensor(16.8428, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.0503824218503957
avg test loss is  1.6738481198800907
avg accuracy is  0.35248333348967376
solo acc is  0.2452500001563381
compute similarity  is  tensor(0.9310, device='cuda:0')
compute_distance is  tensor(16.8428, device='cuda:0')
compute_norm is  tensor(59.8346, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(206.4687, device='cuda:0')
distance 2 is tensor(16.9554, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.6441018127047939
avg test loss is  2.501921793036878
avg accuracy is  0.2214833334896706
solo acc is  0.11523333348966527
compute similarity  is  tensor(0.9309, device='cuda:0')
compute_distance is  tensor(16.9554, device='cuda:0')
compute_norm is  tensor(59.6022, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(206.1648, device='cuda:0')
distance 2 is tensor(16.8267, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9742484376120415
avg test loss is  1.544804533534467
avg accuracy is  0.3733166668230074
solo acc is  0.265283333489672
compute similarity  is  tensor(0.9309, device='cuda:0')
compute_distance is  tensor(16.8267, device='cuda:0')
compute_norm is  tensor(59.1863, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(206.1648, device='cuda:0')
distance 2 is tensor(16.8267, device='cuda:0')
________________________________
test distance is  tensor(16.8267, device='cuda:0')
test similarity is  tensor(0.9309, device='cuda:0')
test acc is  0.37438333348967406
test loss is 1.5469904590263042
test entropy is  0.9752085820189925
________________________________
cal ratio is  0.8988033684177205
distance 1 is tensor(185.3022, device='cuda:0')
distance 2 is tensor(15.1239, device='cuda:0')
cal_distance is  tensor(15.1239, device='cuda:0')
distance 1 is tensor(185.3022, device='cuda:0')
distance 2 is tensor(15.1239, device='cuda:0')
________________________________
test distance is  tensor(15.1239, device='cuda:0')
test similarity is  tensor(0.9420, device='cuda:0')
test acc is  0.3988166668230077
test loss is 1.5139687773007064
test entropy is  1.0159059356906013
________________________________
distance 1 is tensor(185.3022, device='cuda:0')
distance 2 is tensor(15.1239, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.013749137679651
avg test loss is  1.5062835541869533
avg accuracy is  0.39841666682300775
solo acc is  0.27128333348967215
compute similarity  is  tensor(0.9420, device='cuda:0')
compute_distance is  tensor(15.1239, device='cuda:0')
compute_norm is  tensor(58.3596, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(185.5875, device='cuda:0')
distance 2 is tensor(15.2669, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.6031864940611793
avg test loss is  2.3992106734054177
avg accuracy is  0.23830000015633787
solo acc is  0.11160000015633195
compute similarity  is  tensor(0.9418, device='cuda:0')
compute_distance is  tensor(15.2669, device='cuda:0')
compute_norm is  tensor(58.1259, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(185.8950, device='cuda:0')
distance 2 is tensor(15.2163, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9365939368952566
avg test loss is  1.4769952377276634
avg accuracy is  0.4065000001563412
solo acc is  0.2693666668230055
compute similarity  is  tensor(0.9417, device='cuda:0')
compute_distance is  tensor(15.2163, device='cuda:0')
compute_norm is  tensor(57.7457, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(185.8950, device='cuda:0')
distance 2 is tensor(15.2163, device='cuda:0')
________________________________
test distance is  tensor(15.2163, device='cuda:0')
test similarity is  tensor(0.9417, device='cuda:0')
test acc is  0.40540000015634114
test loss is 1.4772876799742043
test entropy is  0.9357200742784594
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3523849248886108
mal norm is  tensor(9.2971, device='cuda:0')
distance 1 is tensor(185.8950, device='cuda:0')
distance 2 is tensor(15.2163, device='cuda:0')
mal distance is  tensor(15.2163, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.3320, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(884.3152, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0032, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(884.5530, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0037, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.7623, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(895.3709, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0036, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(835.2526, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0044, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.9712, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0032, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(847.6756, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(894.9698, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0038, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.7135, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1011.2250, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0028, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(985.7833, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0027, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(995.7430, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0036, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(983.0051, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0034, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(971.7663, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0036, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(968.4202, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0037, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(965.6382, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0030, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(952.6501, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0032, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(852.2622, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(828.4071, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0034, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5379, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0027, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(860.0801, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0034, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(838.0381, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0033, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(821.4960, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0034, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(870.7261, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0027, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(870.2974, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0030, device='cuda:0')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 90.87% 

Test Accuracy: 89.21% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
 benign loss is  0.02286897972226143
distance 1 is tensor(135.9866, device='cuda:0')
distance 2 is tensor(10.0424, device='cuda:0')
benign distance is  tensor(10.0424, device='cuda:0')
norm1 res is  tensor(0.1468, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6074589490890503
distance 1 is tensor(136.0033, device='cuda:0')
distance 2 is tensor(10.0197, device='cuda:0')
benign distance is  tensor(10.0197, device='cuda:0')
norm1 res is  tensor(0.1460, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.04398792237043381
distance 1 is tensor(120.3890, device='cuda:0')
distance 2 is tensor(8.9895, device='cuda:0')
benign distance is  tensor(8.9895, device='cuda:0')
norm1 res is  tensor(0.1282, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3097865581512451
distance 1 is tensor(142.1385, device='cuda:0')
distance 2 is tensor(10.4699, device='cuda:0')
benign distance is  tensor(10.4699, device='cuda:0')
norm1 res is  tensor(0.1496, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7962855100631714
distance 1 is tensor(136.5328, device='cuda:0')
distance 2 is tensor(10.1421, device='cuda:0')
benign distance is  tensor(10.1421, device='cuda:0')
norm1 res is  tensor(0.1484, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7421411275863647
distance 1 is tensor(138.1180, device='cuda:0')
distance 2 is tensor(10.2397, device='cuda:0')
benign distance is  tensor(10.2397, device='cuda:0')
norm1 res is  tensor(0.1481, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.31459012627601624
distance 1 is tensor(137.0895, device='cuda:0')
distance 2 is tensor(9.9045, device='cuda:0')
benign distance is  tensor(9.9045, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5959417223930359
distance 1 is tensor(125.7393, device='cuda:0')
distance 2 is tensor(9.2776, device='cuda:0')
benign distance is  tensor(9.2776, device='cuda:0')
norm1 res is  tensor(0.1338, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.18078839778900146
distance 1 is tensor(144.9815, device='cuda:0')
distance 2 is tensor(10.6503, device='cuda:0')
benign distance is  tensor(10.6503, device='cuda:0')
norm1 res is  tensor(0.1544, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.28259360790252686
distance 1 is tensor(139.1701, device='cuda:0')
distance 2 is tensor(10.4906, device='cuda:0')
benign distance is  tensor(10.4906, device='cuda:0')
norm1 res is  tensor(0.1500, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.5414941310882568
distance 1 is tensor(146.7890, device='cuda:0')
distance 2 is tensor(10.6790, device='cuda:0')
benign distance is  tensor(10.6790, device='cuda:0')
norm1 res is  tensor(0.1567, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.8076988458633423
distance 1 is tensor(151.0521, device='cuda:0')
distance 2 is tensor(11.0684, device='cuda:0')
benign distance is  tensor(11.0684, device='cuda:0')
norm1 res is  tensor(0.1607, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.23636436462402344
distance 1 is tensor(129.1056, device='cuda:0')
distance 2 is tensor(9.7386, device='cuda:0')
benign distance is  tensor(9.7386, device='cuda:0')
norm1 res is  tensor(0.1389, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.06489020586013794
distance 1 is tensor(155.1591, device='cuda:0')
distance 2 is tensor(11.3636, device='cuda:0')
benign distance is  tensor(11.3636, device='cuda:0')
norm1 res is  tensor(0.1644, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.5469648241996765
distance 1 is tensor(138.4787, device='cuda:0')
distance 2 is tensor(10.2821, device='cuda:0')
benign distance is  tensor(10.2821, device='cuda:0')
norm1 res is  tensor(0.1479, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.8819211721420288
distance 1 is tensor(151.7287, device='cuda:0')
distance 2 is tensor(11.2727, device='cuda:0')
benign distance is  tensor(11.2727, device='cuda:0')
norm1 res is  tensor(0.1637, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.27439218759536743
distance 1 is tensor(141.0231, device='cuda:0')
distance 2 is tensor(10.3574, device='cuda:0')
benign distance is  tensor(10.3574, device='cuda:0')
norm1 res is  tensor(0.1494, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.464405357837677
distance 1 is tensor(140.6159, device='cuda:0')
distance 2 is tensor(10.3226, device='cuda:0')
benign distance is  tensor(10.3226, device='cuda:0')
norm1 res is  tensor(0.1463, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.4645848870277405
distance 1 is tensor(155.1701, device='cuda:0')
distance 2 is tensor(11.4150, device='cuda:0')
benign distance is  tensor(11.4150, device='cuda:0')
norm1 res is  tensor(0.1651, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.3917488753795624
distance 1 is tensor(158.3161, device='cuda:0')
distance 2 is tensor(11.8861, device='cuda:0')
benign distance is  tensor(11.8861, device='cuda:0')
norm1 res is  tensor(0.1715, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.3141898512840271
distance 1 is tensor(146.8145, device='cuda:0')
distance 2 is tensor(10.7322, device='cuda:0')
benign distance is  tensor(10.7322, device='cuda:0')
norm1 res is  tensor(0.1568, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.49952563643455505
distance 1 is tensor(144.0067, device='cuda:0')
distance 2 is tensor(10.6414, device='cuda:0')
benign distance is  tensor(10.6414, device='cuda:0')
norm1 res is  tensor(0.1516, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.21567365527153015
distance 1 is tensor(143.3943, device='cuda:0')
distance 2 is tensor(10.4695, device='cuda:0')
benign distance is  tensor(10.4695, device='cuda:0')
norm1 res is  tensor(0.1494, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.9004670977592468
distance 1 is tensor(141.0790, device='cuda:0')
distance 2 is tensor(10.5279, device='cuda:0')
benign distance is  tensor(10.5279, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(168.9777, device='cuda:0')
distance 2 is tensor(12.5613, device='cuda:0')
compute distance is  tensor(12.5613, device='cuda:0')
compute norm is  tensor(54.3543, device='cuda:0')
distance 1 is tensor(169.1750, device='cuda:0')
distance 2 is tensor(12.7160, device='cuda:0')
compute distance is  tensor(12.7160, device='cuda:0')
compute norm is  tensor(54.5466, device='cuda:0')
distance 1 is tensor(184.5084, device='cuda:0')
distance 2 is tensor(13.7668, device='cuda:0')
compute distance is  tensor(13.7668, device='cuda:0')
compute norm is  tensor(54.9042, device='cuda:0')
distance 1 is tensor(168.3804, device='cuda:0')
distance 2 is tensor(12.5629, device='cuda:0')
compute distance is  tensor(12.5629, device='cuda:0')
compute norm is  tensor(54.4756, device='cuda:0')
distance 1 is tensor(177.1746, device='cuda:0')
distance 2 is tensor(13.1083, device='cuda:0')
compute distance is  tensor(13.1083, device='cuda:0')
compute norm is  tensor(54.6713, device='cuda:0')
distance 1 is tensor(190.8288, device='cuda:0')
distance 2 is tensor(14.2493, device='cuda:0')
compute distance is  tensor(14.2493, device='cuda:0')
compute norm is  tensor(55.1076, device='cuda:0')
distance 1 is tensor(174.0600, device='cuda:0')
distance 2 is tensor(13.0157, device='cuda:0')
compute distance is  tensor(13.0157, device='cuda:0')
compute norm is  tensor(54.6559, device='cuda:0')
distance 1 is tensor(175.0873, device='cuda:0')
distance 2 is tensor(13.2141, device='cuda:0')
compute distance is  tensor(13.2141, device='cuda:0')
compute norm is  tensor(54.6725, device='cuda:0')
distance 1 is tensor(175.2024, device='cuda:0')
distance 2 is tensor(13.1836, device='cuda:0')
compute distance is  tensor(13.1836, device='cuda:0')
compute norm is  tensor(54.7780, device='cuda:0')
distance 1 is tensor(165.7968, device='cuda:0')
distance 2 is tensor(12.4310, device='cuda:0')
compute distance is  tensor(12.4310, device='cuda:0')
compute norm is  tensor(54.5341, device='cuda:0')
distance 1 is tensor(175.3555, device='cuda:0')
distance 2 is tensor(13.0606, device='cuda:0')
compute distance is  tensor(13.0606, device='cuda:0')
compute norm is  tensor(54.8453, device='cuda:0')
distance 1 is tensor(176.7055, device='cuda:0')
distance 2 is tensor(13.0366, device='cuda:0')
compute distance is  tensor(13.0366, device='cuda:0')
compute norm is  tensor(54.6205, device='cuda:0')
distance Threshold  is  tensor(14.2493, device='cuda:0')
distance 1 is tensor(1102015.6250, device='cuda:0')
distance 2 is tensor(79389.5703, device='cuda:0')
________________________________
test distance is  tensor(79389.5703, device='cuda:0')
test similarity is  tensor(0.1173, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.199468218175044e+17
test entropy is  0.0
________________________________
cal ratio is  0.012057525910618419
distance 1 is tensor(13287.5879, device='cuda:0')
distance 2 is tensor(957.2418, device='cuda:0')
cal_distance is  tensor(957.2418, device='cuda:0')
cal ratio is  0.10980676608830686
distance 1 is tensor(1459.0735, device='cuda:0')
distance 2 is tensor(105.1116, device='cuda:0')
cal_distance is  tensor(105.1116, device='cuda:0')
cal ratio is  0.3313710232294243
distance 1 is tensor(483.4995, device='cuda:0')
distance 2 is tensor(34.8309, device='cuda:0')
cal_distance is  tensor(34.8309, device='cuda:0')
cal ratio is  0.575648411265394
distance 1 is tensor(278.3288, device='cuda:0')
distance 2 is tensor(20.0504, device='cuda:0')
cal_distance is  tensor(20.0504, device='cuda:0')
cal ratio is  0.7587149294426242
distance 1 is tensor(211.1739, device='cuda:0')
distance 2 is tensor(15.2125, device='cuda:0')
cal_distance is  tensor(15.2125, device='cuda:0')
cal ratio is  0.8710424324281056
distance 1 is tensor(183.9424, device='cuda:0')
distance 2 is tensor(13.2508, device='cuda:0')
cal_distance is  tensor(13.2508, device='cuda:0')
distance 1 is tensor(183.9424, device='cuda:0')
distance 2 is tensor(13.2508, device='cuda:0')
________________________________
test distance is  tensor(13.2508, device='cuda:0')
test similarity is  tensor(0.9330, device='cuda:0')
test acc is  0.6806166668229985
test loss is 133.74987206530216
test entropy is  0.00010402811286427488
________________________________
distance 1 is tensor(183.9424, device='cuda:0')
distance 2 is tensor(13.2508, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.00014809125856203662
avg test loss is  133.76834827902982
avg accuracy is  0.6811000001563318
solo acc is  0.10043333348966532
compute similarity  is  tensor(0.9330, device='cuda:0')
compute_distance is  tensor(13.2508, device='cuda:0')
compute_norm is  tensor(56.4946, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(169.4523, device='cuda:0')
distance 2 is tensor(13.9915, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9400899209447507
avg test loss is  1.4488912935195954
avg accuracy is  0.8122333334896581
solo acc is  0.3158666668230065
compute similarity  is  tensor(0.9348, device='cuda:0')
compute_distance is  tensor(13.9915, device='cuda:0')
compute_norm is  tensor(55.8658, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(169.8380, device='cuda:0')
distance 2 is tensor(14.1465, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8989623840302546
avg test loss is  1.5262754755233652
avg accuracy is  0.8081666668229917
solo acc is  0.2560166668230051
compute similarity  is  tensor(0.9347, device='cuda:0')
compute_distance is  tensor(14.1465, device='cuda:0')
compute_norm is  tensor(55.5521, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(170.3188, device='cuda:0')
distance 2 is tensor(14.2511, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8905230784721212
avg test loss is  1.5035485967135886
avg accuracy is  0.8085000001563251
solo acc is  0.2511500001563382
compute similarity  is  tensor(0.9346, device='cuda:0')
compute_distance is  tensor(14.2511, device='cuda:0')
compute_norm is  tensor(55.2537, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(170.8227, device='cuda:0')
distance 2 is tensor(14.3373, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8789393357249465
avg test loss is  1.488344749916337
avg accuracy is  0.8110500001563249
solo acc is  0.2487166668230048
compute similarity  is  tensor(0.9346, device='cuda:0')
compute_distance is  tensor(14.3373, device='cuda:0')
compute_norm is  tensor(54.9617, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(171.3778, device='cuda:0')
distance 2 is tensor(14.4181, device='cuda:0')
________________________________
test distance is  tensor(14.4181, device='cuda:0')
test similarity is  tensor(0.9345, device='cuda:0')
test acc is  0.8122666668229914
test loss is 1.4683350183562176
test entropy is  0.8756774874257126
________________________________
cal ratio is  0.8947174161732058
distance 1 is tensor(153.3354, device='cuda:0')
distance 2 is tensor(12.9001, device='cuda:0')
cal_distance is  tensor(12.9001, device='cuda:0')
distance 1 is tensor(153.3354, device='cuda:0')
distance 2 is tensor(12.9001, device='cuda:0')
________________________________
test distance is  tensor(12.9001, device='cuda:0')
test similarity is  tensor(0.9464, device='cuda:0')
test acc is  0.8257500001563242
test loss is 1.1854925461923644
test entropy is  0.9856937503509684
________________________________
distance 1 is tensor(153.3354, device='cuda:0')
distance 2 is tensor(12.9001, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9853730268442809
avg test loss is  1.180005121650472
avg accuracy is  0.8242500001563242
solo acc is  0.41228333348967455
compute similarity  is  tensor(0.9464, device='cuda:0')
compute_distance is  tensor(12.9001, device='cuda:0')
compute_norm is  tensor(54.2430, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.5461, device='cuda:0')
distance 2 is tensor(13.0782, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8709483752881032
avg test loss is  1.446593459735293
avg accuracy is  0.8214166668229911
solo acc is  0.24946666682300492
compute similarity  is  tensor(0.9461, device='cuda:0')
compute_distance is  tensor(13.0782, device='cuda:0')
compute_norm is  tensor(53.9636, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.4252, device='cuda:0')
distance 2 is tensor(13.1765, device='cuda:0')
exit early
distance 1 is tensor(155.4252, device='cuda:0')
distance 2 is tensor(13.1765, device='cuda:0')
________________________________
test distance is  tensor(13.1765, device='cuda:0')
test similarity is  tensor(0.9460, device='cuda:0')
test acc is  0.8214000001563244
test loss is 1.446517739087534
test entropy is  0.8547141233614004
________________________________
distance 1 is tensor(155.4252, device='cuda:0')
distance 2 is tensor(13.1765, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8542501193755216
avg test loss is  1.4452722092935526
avg accuracy is  0.823916666822991
solo acc is  0.2445166668230048
compute similarity  is  tensor(0.9460, device='cuda:0')
compute_distance is  tensor(13.1765, device='cuda:0')
compute_norm is  tensor(53.6883, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.2720, device='cuda:0')
distance 2 is tensor(13.2628, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.855541594946054
avg test loss is  1.4335361558999589
avg accuracy is  0.822566666822991
solo acc is  0.2405666668230046
compute similarity  is  tensor(0.9459, device='cuda:0')
compute_distance is  tensor(13.2628, device='cuda:0')
compute_norm is  tensor(53.4165, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.0956, device='cuda:0')
distance 2 is tensor(13.3446, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8548850896897346
avg test loss is  1.4203793101473403
avg accuracy is  0.8253833334896576
solo acc is  0.24231666682300473
compute similarity  is  tensor(0.9459, device='cuda:0')
compute_distance is  tensor(13.3446, device='cuda:0')
compute_norm is  tensor(53.1505, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.9821, device='cuda:0')
distance 2 is tensor(13.4276, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8540637809584644
avg test loss is  1.4071863632974848
avg accuracy is  0.8263666668229909
solo acc is  0.23961666682300464
compute similarity  is  tensor(0.9458, device='cuda:0')
compute_distance is  tensor(13.4276, device='cuda:0')
compute_norm is  tensor(52.8861, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.8887, device='cuda:0')
distance 2 is tensor(13.5070, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8500595803835245
avg test loss is  1.4000405482391813
avg accuracy is  0.8264666668229909
solo acc is  0.23915000015633792
compute similarity  is  tensor(0.9457, device='cuda:0')
compute_distance is  tensor(13.5070, device='cuda:0')
compute_norm is  tensor(52.6249, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.8514, device='cuda:0')
distance 2 is tensor(13.5868, device='cuda:0')
________________________________
test distance is  tensor(13.5868, device='cuda:0')
test similarity is  tensor(0.9456, device='cuda:0')
test acc is  0.8275500001563241
test loss is 1.3925764934340519
test entropy is  0.8476688905692558
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4381933212280273
mal norm is  tensor(7.6790, device='cuda:0')
distance 1 is tensor(159.8514, device='cuda:0')
distance 2 is tensor(13.5868, device='cuda:0')
mal distance is  tensor(13.5868, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1705, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.5715, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.0725e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.1809, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.7674, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.5051, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.1763e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.3115, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.8881, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.7048, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.2813, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.0426e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9019, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
len accept list 5
len all weights is 5
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 90.98% 

Test Accuracy: 89.32% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
 benign loss is  0.731052577495575
distance 1 is tensor(112.2592, device='cuda:0')
distance 2 is tensor(8.3728, device='cuda:0')
benign distance is  tensor(8.3728, device='cuda:0')
norm1 res is  tensor(0.1199, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.26577696204185486
distance 1 is tensor(113.3263, device='cuda:0')
distance 2 is tensor(8.3239, device='cuda:0')
benign distance is  tensor(8.3239, device='cuda:0')
norm1 res is  tensor(0.1187, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.24768488109111786
distance 1 is tensor(104.6784, device='cuda:0')
distance 2 is tensor(7.6542, device='cuda:0')
benign distance is  tensor(7.6542, device='cuda:0')
norm1 res is  tensor(0.1077, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.63776695728302
distance 1 is tensor(133.7439, device='cuda:0')
distance 2 is tensor(9.7159, device='cuda:0')
benign distance is  tensor(9.7159, device='cuda:0')
norm1 res is  tensor(0.1413, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.41741424798965454
distance 1 is tensor(128.0829, device='cuda:0')
distance 2 is tensor(9.5147, device='cuda:0')
benign distance is  tensor(9.5147, device='cuda:0')
norm1 res is  tensor(0.1378, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5313790440559387
distance 1 is tensor(144.3352, device='cuda:0')
distance 2 is tensor(10.6677, device='cuda:0')
benign distance is  tensor(10.6677, device='cuda:0')
norm1 res is  tensor(0.1566, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.016173887997865677
distance 1 is tensor(120.9612, device='cuda:0')
distance 2 is tensor(8.8204, device='cuda:0')
benign distance is  tensor(8.8204, device='cuda:0')
norm1 res is  tensor(0.1264, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.09354543685913086
distance 1 is tensor(113.7303, device='cuda:0')
distance 2 is tensor(8.3794, device='cuda:0')
benign distance is  tensor(8.3794, device='cuda:0')
norm1 res is  tensor(0.1227, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(159.0213, device='cuda:0')
distance 2 is tensor(11.9533, device='cuda:0')
compute distance is  tensor(11.9533, device='cuda:0')
compute norm is  tensor(53.8031, device='cuda:0')
distance 1 is tensor(158.4654, device='cuda:0')
distance 2 is tensor(11.8159, device='cuda:0')
compute distance is  tensor(11.8159, device='cuda:0')
compute norm is  tensor(53.8853, device='cuda:0')
distance 1 is tensor(168.8415, device='cuda:0')
distance 2 is tensor(12.7331, device='cuda:0')
compute distance is  tensor(12.7331, device='cuda:0')
compute norm is  tensor(54.2299, device='cuda:0')
distance 1 is tensor(162.7385, device='cuda:0')
distance 2 is tensor(12.0620, device='cuda:0')
compute distance is  tensor(12.0620, device='cuda:0')
compute norm is  tensor(54.0508, device='cuda:0')
distance 1 is tensor(163.3045, device='cuda:0')
distance 2 is tensor(12.0539, device='cuda:0')
compute distance is  tensor(12.0539, device='cuda:0')
compute norm is  tensor(54.0589, device='cuda:0')
distance 1 is tensor(162.0150, device='cuda:0')
distance 2 is tensor(12.2474, device='cuda:0')
compute distance is  tensor(12.2474, device='cuda:0')
compute norm is  tensor(54.0775, device='cuda:0')
distance 1 is tensor(160.7846, device='cuda:0')
distance 2 is tensor(12.0161, device='cuda:0')
compute distance is  tensor(12.0161, device='cuda:0')
compute norm is  tensor(53.8835, device='cuda:0')
distance 1 is tensor(166.9635, device='cuda:0')
distance 2 is tensor(12.5099, device='cuda:0')
compute distance is  tensor(12.5099, device='cuda:0')
compute norm is  tensor(54.0559, device='cuda:0')
distance 1 is tensor(171.3070, device='cuda:0')
distance 2 is tensor(12.8430, device='cuda:0')
compute distance is  tensor(12.8430, device='cuda:0')
compute norm is  tensor(54.2394, device='cuda:0')
distance 1 is tensor(153.7099, device='cuda:0')
distance 2 is tensor(11.5610, device='cuda:0')
compute distance is  tensor(11.5610, device='cuda:0')
compute norm is  tensor(53.6976, device='cuda:0')
distance 1 is tensor(169.9233, device='cuda:0')
distance 2 is tensor(12.7322, device='cuda:0')
compute distance is  tensor(12.7322, device='cuda:0')
compute norm is  tensor(54.3821, device='cuda:0')
distance 1 is tensor(159.3330, device='cuda:0')
distance 2 is tensor(12.0356, device='cuda:0')
compute distance is  tensor(12.0356, device='cuda:0')
compute norm is  tensor(54.0493, device='cuda:0')
distance Threshold  is  tensor(12.8430, device='cuda:0')
distance 1 is tensor(1102023.2500, device='cuda:0')
distance 2 is tensor(79390.3281, device='cuda:0')
________________________________
test distance is  tensor(79390.3281, device='cuda:0')
test similarity is  tensor(0.0953, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.1973432412546e+17
test entropy is  0.0
________________________________
cal ratio is  0.011446998970798703
distance 1 is tensor(12614.8672, device='cuda:0')
distance 2 is tensor(908.7812, device='cuda:0')
cal_distance is  tensor(908.7812, device='cuda:0')
cal ratio is  0.10699063791425141
distance 1 is tensor(1349.6791, device='cuda:0')
distance 2 is tensor(97.2311, device='cuda:0')
cal_distance is  tensor(97.2311, device='cuda:0')
cal ratio is  0.32709424449656954
distance 1 is tensor(441.4771, device='cuda:0')
distance 2 is tensor(31.8037, device='cuda:0')
cal_distance is  tensor(31.8037, device='cuda:0')
cal ratio is  0.5719215249069189
distance 1 is tensor(252.4933, device='cuda:0')
distance 2 is tensor(18.1892, device='cuda:0')
cal_distance is  tensor(18.1892, device='cuda:0')
cal ratio is  0.756254907071926
distance 1 is tensor(190.9511, device='cuda:0')
distance 2 is tensor(13.7557, device='cuda:0')
cal_distance is  tensor(13.7557, device='cuda:0')
cal ratio is  0.8696292133105858
distance 1 is tensor(166.0576, device='cuda:0')
distance 2 is tensor(11.9624, device='cuda:0')
cal_distance is  tensor(11.9624, device='cuda:0')
distance 1 is tensor(166.0576, device='cuda:0')
distance 2 is tensor(11.9624, device='cuda:0')
________________________________
test distance is  tensor(11.9624, device='cuda:0')
test similarity is  tensor(0.9440, device='cuda:0')
test acc is  0.8327833334896573
test loss is 76.25002756505124
test entropy is  0.004341597085861745
________________________________
distance 1 is tensor(166.0576, device='cuda:0')
distance 2 is tensor(11.9624, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.003976016090380551
avg test loss is  76.14173468242068
avg accuracy is  0.8323833334896573
solo acc is  0.1155666668229986
compute similarity  is  tensor(0.9440, device='cuda:0')
compute_distance is  tensor(11.9624, device='cuda:0')
compute_norm is  tensor(56.1813, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(154.7203, device='cuda:0')
distance 2 is tensor(12.9321, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9253246496989529
avg test loss is  1.4437149978522807
avg accuracy is  0.8305000001563241
solo acc is  0.3124333334896731
compute similarity  is  tensor(0.9449, device='cuda:0')
compute_distance is  tensor(12.9321, device='cuda:0')
compute_norm is  tensor(55.4706, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.6114, device='cuda:0')
distance 2 is tensor(13.1197, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8911620968186271
avg test loss is  1.5084068204548313
avg accuracy is  0.8298166668229907
solo acc is  0.25701666682300517
compute similarity  is  tensor(0.9447, device='cuda:0')
compute_distance is  tensor(13.1197, device='cuda:0')
compute_norm is  tensor(55.1547, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.4252, device='cuda:0')
distance 2 is tensor(13.2481, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.876360630747606
avg test loss is  1.4900917826430884
avg accuracy is  0.8303500001563241
solo acc is  0.25178333348967163
compute similarity  is  tensor(0.9446, device='cuda:0')
compute_distance is  tensor(13.2481, device='cuda:0')
compute_norm is  tensor(54.8547, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.1958, device='cuda:0')
distance 2 is tensor(13.3526, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8728051502059009
avg test loss is  1.4622027683359728
avg accuracy is  0.832350000156324
solo acc is  0.2537833334896717
compute similarity  is  tensor(0.9445, device='cuda:0')
compute_distance is  tensor(13.3526, device='cuda:0')
compute_norm is  tensor(54.5654, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.0090, device='cuda:0')
distance 2 is tensor(13.4486, device='cuda:0')
________________________________
test distance is  tensor(13.4486, device='cuda:0')
test similarity is  tensor(0.9444, device='cuda:0')
test acc is  0.835300000156324
test loss is 1.4473821159873181
test entropy is  0.8628144426259405
________________________________
cal ratio is  0.8795030718999698
distance 1 is tensor(138.9702, device='cuda:0')
distance 2 is tensor(11.8281, device='cuda:0')
cal_distance is  tensor(11.8281, device='cuda:0')
distance 1 is tensor(138.9702, device='cuda:0')
distance 2 is tensor(11.8281, device='cuda:0')
________________________________
test distance is  tensor(11.8281, device='cuda:0')
test similarity is  tensor(0.9562, device='cuda:0')
test acc is  0.8457666668229902
test loss is 1.076123841662905
test entropy is  0.9776730374105449
________________________________
distance 1 is tensor(138.9702, device='cuda:0')
distance 2 is tensor(11.8281, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9774883493685773
avg test loss is  1.076973681574437
avg accuracy is  0.8466000001563233
solo acc is  0.49096666682300866
compute similarity  is  tensor(0.9562, device='cuda:0')
compute_distance is  tensor(11.8281, device='cuda:0')
compute_norm is  tensor(53.9216, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.7550, device='cuda:0')
distance 2 is tensor(12.0809, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8661898344056185
avg test loss is  1.4281898073550225
avg accuracy is  0.8448500001563235
solo acc is  0.2518000001563383
compute similarity  is  tensor(0.9557, device='cuda:0')
compute_distance is  tensor(12.0809, device='cuda:0')
compute_norm is  tensor(53.6425, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.9341, device='cuda:0')
distance 2 is tensor(12.2033, device='cuda:0')
exit early
distance 1 is tensor(141.9341, device='cuda:0')
distance 2 is tensor(12.2033, device='cuda:0')
________________________________
test distance is  tensor(12.2033, device='cuda:0')
test similarity is  tensor(0.9556, device='cuda:0')
test acc is  0.8458500001563234
test loss is 1.4267117939015697
test entropy is  0.8509035883173506
________________________________
distance 1 is tensor(141.9341, device='cuda:0')
distance 2 is tensor(12.2033, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8506729108438309
avg test loss is  1.4255547242632298
avg accuracy is  0.8432000001563236
solo acc is  0.24435000015633807
compute similarity  is  tensor(0.9556, device='cuda:0')
compute_distance is  tensor(12.2033, device='cuda:0')
compute_norm is  tensor(53.3664, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.0882, device='cuda:0')
distance 2 is tensor(12.3134, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.85303501228788
avg test loss is  1.4080948783898912
avg accuracy is  0.8457333334896566
solo acc is  0.24610000015633815
compute similarity  is  tensor(0.9554, device='cuda:0')
compute_distance is  tensor(12.3134, device='cuda:0')
compute_norm is  tensor(53.0953, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.1857, device='cuda:0')
distance 2 is tensor(12.4110, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.843036796619643
avg test loss is  1.4135311348860198
avg accuracy is  0.8484500001563233
solo acc is  0.23771666682300457
compute similarity  is  tensor(0.9553, device='cuda:0')
compute_distance is  tensor(12.4110, device='cuda:0')
compute_norm is  tensor(52.8290, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.2993, device='cuda:0')
distance 2 is tensor(12.5039, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8469738192649793
avg test loss is  1.3850107472588513
avg accuracy is  0.84916666682299
solo acc is  0.24225000015633805
compute similarity  is  tensor(0.9552, device='cuda:0')
compute_distance is  tensor(12.5039, device='cuda:0')
compute_norm is  tensor(52.5642, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.4481, device='cuda:0')
distance 2 is tensor(12.5981, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8509952285523608
avg test loss is  1.3771536815395233
avg accuracy is  0.8498166668229901
solo acc is  0.2373500001563379
compute similarity  is  tensor(0.9551, device='cuda:0')
compute_distance is  tensor(12.5981, device='cuda:0')
compute_norm is  tensor(52.3029, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.6186, device='cuda:0')
distance 2 is tensor(12.6927, device='cuda:0')
________________________________
test distance is  tensor(12.6927, device='cuda:0')
test similarity is  tensor(0.9550, device='cuda:0')
test acc is  0.8510666668229899
test loss is 1.3697441262222811
test entropy is  0.8385996803291825
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2565253973007202
mal norm is  tensor(6.9472, device='cuda:0')
distance 1 is tensor(147.6186, device='cuda:0')
distance 2 is tensor(12.6927, device='cuda:0')
mal distance is  tensor(12.6927, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.0937, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.2040, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.3269e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(468.4001, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.1070e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(424.8384, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.8219, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.5809, device='cuda:0')
c is  tensor(0.0131, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.6267e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.1060, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.3142e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.4935, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.0610e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.8488, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0179e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7159, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.6710e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(724.6050, device='cuda:0')
c is  tensor(0.0114, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.6743e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.0679, device='cuda:0')
c is  tensor(0.0115, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.3316, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0135e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.6905, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.2106e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.6382, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.0916e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.0436, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.1709e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(761.9260, device='cuda:0')
c is  tensor(0.0111, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.8993e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.5176, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.1916e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0331, device='cuda:0')
c is  tensor(0.0118, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.3505, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.7796, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.7132, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.5085, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9016e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8148, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.7692e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.3603, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.3734e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.9652, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.6336e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(899.3812, device='cuda:0')
c is  tensor(0.0102, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(911.2709, device='cuda:0')
c is  tensor(0.0101, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(878.3553, device='cuda:0')
c is  tensor(0.0103, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1209e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.7633, device='cuda:0')
c is  tensor(0.0101, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.1884e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.1397, device='cuda:0')
c is  tensor(0.0101, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.2775, device='cuda:0')
c is  tensor(0.0104, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.2826, device='cuda:0')
c is  tensor(0.0105, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.7752e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(902.0143, device='cuda:0')
c is  tensor(0.0102, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0077e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.2252, device='cuda:0')
c is  tensor(0.0121, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.7668e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.3694, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.8268e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.7053, device='cuda:0')
c is  tensor(0.0121, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.0049e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.5312, device='cuda:0')
c is  tensor(0.0119, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.3246e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.2040, device='cuda:0')
c is  tensor(0.0127, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.0014e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.3623, device='cuda:0')
c is  tensor(0.0118, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.7750, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4088e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.4257, device='cuda:0')
c is  tensor(0.0118, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 24
len all weights is 24
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 91.19% 

Test Accuracy: 89.63% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5067691206932068
distance 1 is tensor(106.8631, device='cuda:0')
distance 2 is tensor(7.9857, device='cuda:0')
benign distance is  tensor(7.9857, device='cuda:0')
norm1 res is  tensor(0.1165, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.36081886291503906
distance 1 is tensor(117.8002, device='cuda:0')
distance 2 is tensor(8.6032, device='cuda:0')
benign distance is  tensor(8.6032, device='cuda:0')
norm1 res is  tensor(0.1255, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.044815629720687866
distance 1 is tensor(82.5205, device='cuda:0')
distance 2 is tensor(6.2269, device='cuda:0')
benign distance is  tensor(6.2269, device='cuda:0')
norm1 res is  tensor(0.0905, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3205234110355377
distance 1 is tensor(133.1856, device='cuda:0')
distance 2 is tensor(9.8159, device='cuda:0')
benign distance is  tensor(9.8159, device='cuda:0')
norm1 res is  tensor(0.1421, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5002415180206299
distance 1 is tensor(114.2068, device='cuda:0')
distance 2 is tensor(8.2261, device='cuda:0')
benign distance is  tensor(8.2261, device='cuda:0')
norm1 res is  tensor(0.1190, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7778662443161011
distance 1 is tensor(134.2372, device='cuda:0')
distance 2 is tensor(9.9676, device='cuda:0')
benign distance is  tensor(9.9676, device='cuda:0')
norm1 res is  tensor(0.1458, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.267604798078537
distance 1 is tensor(112.8099, device='cuda:0')
distance 2 is tensor(8.1542, device='cuda:0')
benign distance is  tensor(8.1542, device='cuda:0')
norm1 res is  tensor(0.1189, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.016769934445619583
distance 1 is tensor(94.9709, device='cuda:0')
distance 2 is tensor(7.0289, device='cuda:0')
benign distance is  tensor(7.0289, device='cuda:0')
norm1 res is  tensor(0.1028, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.13092054426670074
distance 1 is tensor(130.3284, device='cuda:0')
distance 2 is tensor(9.4511, device='cuda:0')
benign distance is  tensor(9.4511, device='cuda:0')
norm1 res is  tensor(0.1408, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7646152973175049
distance 1 is tensor(136.6366, device='cuda:0')
distance 2 is tensor(9.9706, device='cuda:0')
benign distance is  tensor(9.9706, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6680892705917358
distance 1 is tensor(128.4983, device='cuda:0')
distance 2 is tensor(9.3405, device='cuda:0')
benign distance is  tensor(9.3405, device='cuda:0')
norm1 res is  tensor(0.1360, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5947121381759644
distance 1 is tensor(131.2369, device='cuda:0')
distance 2 is tensor(9.7323, device='cuda:0')
benign distance is  tensor(9.7323, device='cuda:0')
norm1 res is  tensor(0.1419, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.17778685688972473
distance 1 is tensor(132.8710, device='cuda:0')
distance 2 is tensor(9.8825, device='cuda:0')
benign distance is  tensor(9.8825, device='cuda:0')
norm1 res is  tensor(0.1440, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.07135950028896332
distance 1 is tensor(115.6213, device='cuda:0')
distance 2 is tensor(8.6280, device='cuda:0')
benign distance is  tensor(8.6280, device='cuda:0')
norm1 res is  tensor(0.1287, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.07660618424415588
distance 1 is tensor(124.2665, device='cuda:0')
distance 2 is tensor(9.2117, device='cuda:0')
benign distance is  tensor(9.2117, device='cuda:0')
norm1 res is  tensor(0.1365, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.621650218963623
distance 1 is tensor(132.2462, device='cuda:0')
distance 2 is tensor(9.6631, device='cuda:0')
benign distance is  tensor(9.6631, device='cuda:0')
norm1 res is  tensor(0.1406, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.2719651758670807
distance 1 is tensor(131.8510, device='cuda:0')
distance 2 is tensor(9.6538, device='cuda:0')
benign distance is  tensor(9.6538, device='cuda:0')
norm1 res is  tensor(0.1419, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.5266545414924622
distance 1 is tensor(144.7584, device='cuda:0')
distance 2 is tensor(10.7500, device='cuda:0')
benign distance is  tensor(10.7500, device='cuda:0')
norm1 res is  tensor(0.1562, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.966073215007782
distance 1 is tensor(118.2625, device='cuda:0')
distance 2 is tensor(8.8048, device='cuda:0')
benign distance is  tensor(8.8048, device='cuda:0')
norm1 res is  tensor(0.1295, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.28416138887405396
distance 1 is tensor(124.9908, device='cuda:0')
distance 2 is tensor(9.2707, device='cuda:0')
benign distance is  tensor(9.2707, device='cuda:0')
norm1 res is  tensor(0.1387, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.5019025206565857
distance 1 is tensor(128.0016, device='cuda:0')
distance 2 is tensor(9.4909, device='cuda:0')
benign distance is  tensor(9.4909, device='cuda:0')
norm1 res is  tensor(0.1371, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.5718593597412109
distance 1 is tensor(132.9586, device='cuda:0')
distance 2 is tensor(9.7315, device='cuda:0')
benign distance is  tensor(9.7315, device='cuda:0')
norm1 res is  tensor(0.1419, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.26122236251831055
distance 1 is tensor(132.3172, device='cuda:0')
distance 2 is tensor(9.8146, device='cuda:0')
benign distance is  tensor(9.8146, device='cuda:0')
norm1 res is  tensor(0.1451, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.07461972534656525
distance 1 is tensor(138.9883, device='cuda:0')
distance 2 is tensor(10.2237, device='cuda:0')
benign distance is  tensor(10.2237, device='cuda:0')
norm1 res is  tensor(0.1484, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.34405797719955444
distance 1 is tensor(109.6564, device='cuda:0')
distance 2 is tensor(8.1732, device='cuda:0')
benign distance is  tensor(8.1732, device='cuda:0')
norm1 res is  tensor(0.1177, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.5096990466117859
distance 1 is tensor(137.5374, device='cuda:0')
distance 2 is tensor(10.1719, device='cuda:0')
benign distance is  tensor(10.1719, device='cuda:0')
norm1 res is  tensor(0.1502, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.14142225682735443
distance 1 is tensor(133.6992, device='cuda:0')
distance 2 is tensor(9.8286, device='cuda:0')
benign distance is  tensor(9.8286, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.09145329892635345
distance 1 is tensor(129.9035, device='cuda:0')
distance 2 is tensor(9.5909, device='cuda:0')
benign distance is  tensor(9.5909, device='cuda:0')
norm1 res is  tensor(0.1396, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.09427126497030258
distance 1 is tensor(131.2039, device='cuda:0')
distance 2 is tensor(9.6940, device='cuda:0')
benign distance is  tensor(9.6940, device='cuda:0')
norm1 res is  tensor(0.1402, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.3740083873271942
distance 1 is tensor(134.9183, device='cuda:0')
distance 2 is tensor(10.0693, device='cuda:0')
benign distance is  tensor(10.0693, device='cuda:0')
norm1 res is  tensor(0.1432, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.2730594873428345
distance 1 is tensor(116.7133, device='cuda:0')
distance 2 is tensor(8.8031, device='cuda:0')
benign distance is  tensor(8.8031, device='cuda:0')
norm1 res is  tensor(0.1274, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.24837645888328552
distance 1 is tensor(118.8110, device='cuda:0')
distance 2 is tensor(8.6961, device='cuda:0')
benign distance is  tensor(8.6961, device='cuda:0')
norm1 res is  tensor(0.1254, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.08350028097629547
distance 1 is tensor(137.4032, device='cuda:0')
distance 2 is tensor(10.1945, device='cuda:0')
benign distance is  tensor(10.1945, device='cuda:0')
norm1 res is  tensor(0.1485, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.4005403518676758
distance 1 is tensor(140.0874, device='cuda:0')
distance 2 is tensor(10.0826, device='cuda:0')
benign distance is  tensor(10.0826, device='cuda:0')
norm1 res is  tensor(0.1456, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.3133612275123596
distance 1 is tensor(122.3161, device='cuda:0')
distance 2 is tensor(9.0976, device='cuda:0')
benign distance is  tensor(9.0976, device='cuda:0')
norm1 res is  tensor(0.1325, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.580849826335907
distance 1 is tensor(128.5184, device='cuda:0')
distance 2 is tensor(9.6816, device='cuda:0')
benign distance is  tensor(9.6816, device='cuda:0')
norm1 res is  tensor(0.1422, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.4759843945503235
distance 1 is tensor(126.9347, device='cuda:0')
distance 2 is tensor(9.3549, device='cuda:0')
benign distance is  tensor(9.3549, device='cuda:0')
norm1 res is  tensor(0.1391, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.7386437058448792
distance 1 is tensor(148.0672, device='cuda:0')
distance 2 is tensor(10.7833, device='cuda:0')
benign distance is  tensor(10.7833, device='cuda:0')
norm1 res is  tensor(0.1581, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8715251088142395
distance 1 is tensor(141.0323, device='cuda:0')
distance 2 is tensor(10.2758, device='cuda:0')
benign distance is  tensor(10.2758, device='cuda:0')
norm1 res is  tensor(0.1487, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5372346639633179
distance 1 is tensor(145.8108, device='cuda:0')
distance 2 is tensor(10.6623, device='cuda:0')
benign distance is  tensor(10.6623, device='cuda:0')
norm1 res is  tensor(0.1604, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(150.1864, device='cuda:0')
distance 2 is tensor(11.2175, device='cuda:0')
compute distance is  tensor(11.2175, device='cuda:0')
compute norm is  tensor(54.1248, device='cuda:0')
distance 1 is tensor(149.4434, device='cuda:0')
distance 2 is tensor(11.1919, device='cuda:0')
compute distance is  tensor(11.1919, device='cuda:0')
compute norm is  tensor(54.1778, device='cuda:0')
distance 1 is tensor(161.4706, device='cuda:0')
distance 2 is tensor(12.0821, device='cuda:0')
compute distance is  tensor(12.0821, device='cuda:0')
compute norm is  tensor(54.5140, device='cuda:0')
distance 1 is tensor(145.4199, device='cuda:0')
distance 2 is tensor(10.8994, device='cuda:0')
compute distance is  tensor(10.8994, device='cuda:0')
compute norm is  tensor(54.0633, device='cuda:0')
distance 1 is tensor(138.8270, device='cuda:0')
distance 2 is tensor(10.6613, device='cuda:0')
compute distance is  tensor(10.6613, device='cuda:0')
compute norm is  tensor(54.0073, device='cuda:0')
distance 1 is tensor(156.3122, device='cuda:0')
distance 2 is tensor(11.8046, device='cuda:0')
compute distance is  tensor(11.8046, device='cuda:0')
compute norm is  tensor(54.4087, device='cuda:0')
distance 1 is tensor(153.1186, device='cuda:0')
distance 2 is tensor(11.4966, device='cuda:0')
compute distance is  tensor(11.4966, device='cuda:0')
compute norm is  tensor(54.2733, device='cuda:0')
distance 1 is tensor(153.4611, device='cuda:0')
distance 2 is tensor(11.6087, device='cuda:0')
compute distance is  tensor(11.6087, device='cuda:0')
compute norm is  tensor(54.2359, device='cuda:0')
distance 1 is tensor(147.7064, device='cuda:0')
distance 2 is tensor(11.1295, device='cuda:0')
compute distance is  tensor(11.1295, device='cuda:0')
compute norm is  tensor(54.1272, device='cuda:0')
distance 1 is tensor(148.5589, device='cuda:0')
distance 2 is tensor(11.1060, device='cuda:0')
compute distance is  tensor(11.1060, device='cuda:0')
compute norm is  tensor(54.1217, device='cuda:0')
distance 1 is tensor(151.5406, device='cuda:0')
distance 2 is tensor(11.3825, device='cuda:0')
compute distance is  tensor(11.3825, device='cuda:0')
compute norm is  tensor(54.2635, device='cuda:0')
distance 1 is tensor(143.9878, device='cuda:0')
distance 2 is tensor(10.8060, device='cuda:0')
compute distance is  tensor(10.8060, device='cuda:0')
compute norm is  tensor(54.0473, device='cuda:0')
distance Threshold  is  tensor(12.0821, device='cuda:0')
distance 1 is tensor(1102037.5000, device='cuda:0')
distance 2 is tensor(79391.4453, device='cuda:0')
________________________________
test distance is  tensor(79391.4453, device='cuda:0')
test similarity is  tensor(0.0592, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.192602739509755e+17
test entropy is  0.0
________________________________
cal ratio is  0.011102668245801115
distance 1 is tensor(12235.5635, device='cuda:0')
distance 2 is tensor(881.4568, device='cuda:0')
cal_distance is  tensor(881.4568, device='cuda:0')
cal ratio is  0.10536920021660857
distance 1 is tensor(1289.2579, device='cuda:0')
distance 2 is tensor(92.8784, device='cuda:0')
cal_distance is  tensor(92.8784, device='cuda:0')
cal ratio is  0.3246062309581107
distance 1 is tensor(418.5060, device='cuda:0')
distance 2 is tensor(30.1489, device='cuda:0')
cal_distance is  tensor(30.1489, device='cuda:0')
cal ratio is  0.5697422484447641
distance 1 is tensor(238.4437, device='cuda:0')
distance 2 is tensor(17.1771, device='cuda:0')
cal_distance is  tensor(17.1771, device='cuda:0')
cal ratio is  0.7548126815848746
distance 1 is tensor(179.9821, device='cuda:0')
distance 2 is tensor(12.9655, device='cuda:0')
cal_distance is  tensor(12.9655, device='cuda:0')
cal ratio is  0.8687996061145037
distance 1 is tensor(156.3693, device='cuda:0')
distance 2 is tensor(11.2644, device='cuda:0')
cal_distance is  tensor(11.2644, device='cuda:0')
distance 1 is tensor(156.3693, device='cuda:0')
distance 2 is tensor(11.2644, device='cuda:0')
________________________________
test distance is  tensor(11.2644, device='cuda:0')
test similarity is  tensor(0.9477, device='cuda:0')
test acc is  0.8619500001563227
test loss is 51.47669123586561
test entropy is  0.012604989909526666
________________________________
distance 1 is tensor(156.3693, device='cuda:0')
distance 2 is tensor(11.2644, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.012849715538368013
avg test loss is  51.491533795907806
avg accuracy is  0.8605166668229896
solo acc is  0.1522833334896667
compute similarity  is  tensor(0.9477, device='cuda:0')
compute_distance is  tensor(11.2644, device='cuda:0')
compute_norm is  tensor(55.4165, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.2432, device='cuda:0')
distance 2 is tensor(12.4319, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.931637631296349
avg test loss is  1.3971077973908708
avg accuracy is  0.8505833334896565
solo acc is  0.33143333348967347
compute similarity  is  tensor(0.9482, device='cuda:0')
compute_distance is  tensor(12.4319, device='cuda:0')
compute_norm is  tensor(54.6322, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.4058, device='cuda:0')
distance 2 is tensor(12.6404, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8835488297283522
avg test loss is  1.4930609373141452
avg accuracy is  0.8499333334896567
solo acc is  0.2659000001563387
compute similarity  is  tensor(0.9480, device='cuda:0')
compute_distance is  tensor(12.6404, device='cuda:0')
compute_norm is  tensor(54.3188, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.3881, device='cuda:0')
distance 2 is tensor(12.7809, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8775410152066236
avg test loss is  1.46835011053187
avg accuracy is  0.8508666668229898
solo acc is  0.2591333334896719
compute similarity  is  tensor(0.9479, device='cuda:0')
compute_distance is  tensor(12.7809, device='cuda:0')
compute_norm is  tensor(54.0216, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.3778, device='cuda:0')
distance 2 is tensor(12.9037, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8728616250984704
avg test loss is  1.448541462548506
avg accuracy is  0.8547833334896564
solo acc is  0.25396666682300506
compute similarity  is  tensor(0.9478, device='cuda:0')
compute_distance is  tensor(12.9037, device='cuda:0')
compute_norm is  tensor(53.7351, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.3262, device='cuda:0')
distance 2 is tensor(13.0078, device='cuda:0')
________________________________
test distance is  tensor(13.0078, device='cuda:0')
test similarity is  tensor(0.9477, device='cuda:0')
test acc is  0.8555333334896563
test loss is 1.4285533152409453
test entropy is  0.8647674791085949
________________________________
cal ratio is  0.867387269181929
distance 1 is tensor(131.2593, device='cuda:0')
distance 2 is tensor(11.2828, device='cuda:0')
cal_distance is  tensor(11.2828, device='cuda:0')
distance 1 is tensor(131.2593, device='cuda:0')
distance 2 is tensor(11.2828, device='cuda:0')
________________________________
test distance is  tensor(11.2828, device='cuda:0')
test similarity is  tensor(0.9601, device='cuda:0')
test acc is  0.8681833334896559
test loss is 1.0005690714062403
test entropy is  0.97782515075161
________________________________
distance 1 is tensor(131.2593, device='cuda:0')
distance 2 is tensor(11.2828, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9786095394889938
avg test loss is  0.9954907446146519
avg accuracy is  0.8675500001563224
solo acc is  0.5562166668230081
compute similarity  is  tensor(0.9601, device='cuda:0')
compute_distance is  tensor(11.2828, device='cuda:0')
compute_norm is  tensor(53.1521, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.5182, device='cuda:0')
distance 2 is tensor(11.5993, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8531951469653196
avg test loss is  1.4169291462471236
avg accuracy is  0.864083333489656
solo acc is  0.2566833334896718
compute similarity  is  tensor(0.9595, device='cuda:0')
compute_distance is  tensor(11.5993, device='cuda:0')
compute_norm is  tensor(52.8739, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.9304, device='cuda:0')
distance 2 is tensor(11.7400, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8513440416057481
avg test loss is  1.4036523521836124
avg accuracy is  0.8670000001563225
solo acc is  0.25303333348967166
compute similarity  is  tensor(0.9593, device='cuda:0')
compute_distance is  tensor(11.7400, device='cuda:0')
compute_norm is  tensor(52.5997, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.2403, device='cuda:0')
distance 2 is tensor(11.8641, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8508930637765286
avg test loss is  1.3950364007624483
avg accuracy is  0.8655000001563227
solo acc is  0.2479000001563382
compute similarity  is  tensor(0.9592, device='cuda:0')
compute_distance is  tensor(11.8641, device='cuda:0')
compute_norm is  tensor(52.3303, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.5201, device='cuda:0')
distance 2 is tensor(11.9781, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8448165726941278
avg test loss is  1.385561844687472
avg accuracy is  0.8685666668229891
solo acc is  0.24960000015633824
compute similarity  is  tensor(0.9590, device='cuda:0')
compute_distance is  tensor(11.9781, device='cuda:0')
compute_norm is  tensor(52.0662, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.8267, device='cuda:0')
distance 2 is tensor(12.0938, device='cuda:0')
________________________________
test distance is  tensor(12.0938, device='cuda:0')
test similarity is  tensor(0.9589, device='cuda:0')
test acc is  0.8687000001563225
test loss is 1.3751229191385608
test entropy is  0.8469427637835302
________________________________
cal ratio is  0.8995648673307414
distance 1 is tensor(124.8842, device='cuda:0')
distance 2 is tensor(10.8792, device='cuda:0')
cal_distance is  tensor(10.8792, device='cuda:0')
distance 1 is tensor(124.8842, device='cuda:0')
distance 2 is tensor(10.8792, device='cuda:0')
________________________________
test distance is  tensor(10.8792, device='cuda:0')
test similarity is  tensor(0.9666, device='cuda:0')
test acc is  0.8769000001563221
test loss is 1.0254984912968903
test entropy is  0.9417505557857343
________________________________
distance 1 is tensor(124.8842, device='cuda:0')
distance 2 is tensor(10.8792, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.939644391157988
avg test loss is  1.0252057099774448
avg accuracy is  0.8770833334896555
solo acc is  0.5027666668230089
compute similarity  is  tensor(0.9666, device='cuda:0')
compute_distance is  tensor(10.8792, device='cuda:0')
compute_norm is  tensor(51.7636, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(127.1823, device='cuda:0')
distance 2 is tensor(11.1533, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8342541725015336
avg test loss is  1.3624220139690553
avg accuracy is  0.8751166668229889
solo acc is  0.25330000015633836
compute similarity  is  tensor(0.9661, device='cuda:0')
compute_distance is  tensor(11.1533, device='cuda:0')
compute_norm is  tensor(51.5041, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(128.7764, device='cuda:0')
distance 2 is tensor(11.2879, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8322266879112228
avg test loss is  1.357367985538328
avg accuracy is  0.875066666822989
solo acc is  0.24653333348967144
compute similarity  is  tensor(0.9659, device='cuda:0')
compute_distance is  tensor(11.2879, device='cuda:0')
compute_norm is  tensor(51.2449, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.2933, device='cuda:0')
distance 2 is tensor(11.4135, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8347875913068938
avg test loss is  1.3456331740564376
avg accuracy is  0.8767333334896554
solo acc is  0.24640000015633812
compute similarity  is  tensor(0.9657, device='cuda:0')
compute_distance is  tensor(11.4135, device='cuda:0')
compute_norm is  tensor(50.9894, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.7762, device='cuda:0')
distance 2 is tensor(11.5315, device='cuda:0')
exit early
distance 1 is tensor(131.7762, device='cuda:0')
distance 2 is tensor(11.5315, device='cuda:0')
________________________________
test distance is  tensor(11.5315, device='cuda:0')
test similarity is  tensor(0.9656, device='cuda:0')
test acc is  0.879750000156322
test loss is 1.3519896815326422
test entropy is  0.8268283707882041
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.168210744857788
mal norm is  tensor(5.9648, device='cuda:0')
distance 1 is tensor(131.7762, device='cuda:0')
distance 2 is tensor(11.5315, device='cuda:0')
mal distance is  tensor(11.5315, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1364, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.1333, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(496.8506, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.3720e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(346.9384, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.3899e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.5266, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(473.0708, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.3928, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(468.2097, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.8949e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(406.0143, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.4799, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0754e-05, device='cuda:0')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 86.64% 

Test Accuracy: 85.08% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3107362687587738
distance 1 is tensor(141.7728, device='cuda:0')
distance 2 is tensor(10.7843, device='cuda:0')
benign distance is  tensor(10.7843, device='cuda:0')
norm1 res is  tensor(0.1494, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5645840167999268
distance 1 is tensor(171.5388, device='cuda:0')
distance 2 is tensor(12.9894, device='cuda:0')
benign distance is  tensor(12.9894, device='cuda:0')
norm1 res is  tensor(0.1797, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.37354758381843567
distance 1 is tensor(162.8123, device='cuda:0')
distance 2 is tensor(12.3804, device='cuda:0')
benign distance is  tensor(12.3804, device='cuda:0')
norm1 res is  tensor(0.1685, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.7560123205184937
distance 1 is tensor(154.6266, device='cuda:0')
distance 2 is tensor(11.8647, device='cuda:0')
benign distance is  tensor(11.8647, device='cuda:0')
norm1 res is  tensor(0.1633, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9295160174369812
distance 1 is tensor(151.4921, device='cuda:0')
distance 2 is tensor(11.4234, device='cuda:0')
benign distance is  tensor(11.4234, device='cuda:0')
norm1 res is  tensor(0.1564, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7030404806137085
distance 1 is tensor(165.8294, device='cuda:0')
distance 2 is tensor(12.7318, device='cuda:0')
benign distance is  tensor(12.7318, device='cuda:0')
norm1 res is  tensor(0.1734, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.9074821472167969
distance 1 is tensor(133.7775, device='cuda:0')
distance 2 is tensor(10.0587, device='cuda:0')
benign distance is  tensor(10.0587, device='cuda:0')
norm1 res is  tensor(0.1355, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.43256276845932007
distance 1 is tensor(160.6465, device='cuda:0')
distance 2 is tensor(12.1734, device='cuda:0')
benign distance is  tensor(12.1734, device='cuda:0')
norm1 res is  tensor(0.1675, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(170.6672, device='cuda:0')
distance 2 is tensor(13.1428, device='cuda:0')
compute distance is  tensor(13.1428, device='cuda:0')
compute norm is  tensor(52.9274, device='cuda:0')
distance 1 is tensor(173.6009, device='cuda:0')
distance 2 is tensor(13.3554, device='cuda:0')
compute distance is  tensor(13.3554, device='cuda:0')
compute norm is  tensor(53.1877, device='cuda:0')
distance 1 is tensor(190.4157, device='cuda:0')
distance 2 is tensor(14.4733, device='cuda:0')
compute distance is  tensor(14.4733, device='cuda:0')
compute norm is  tensor(53.5792, device='cuda:0')
distance 1 is tensor(174.1949, device='cuda:0')
distance 2 is tensor(13.3011, device='cuda:0')
compute distance is  tensor(13.3011, device='cuda:0')
compute norm is  tensor(53.1917, device='cuda:0')
distance 1 is tensor(179.6305, device='cuda:0')
distance 2 is tensor(13.8581, device='cuda:0')
compute distance is  tensor(13.8581, device='cuda:0')
compute norm is  tensor(53.3055, device='cuda:0')
distance 1 is tensor(174.1449, device='cuda:0')
distance 2 is tensor(13.4273, device='cuda:0')
compute distance is  tensor(13.4273, device='cuda:0')
compute norm is  tensor(53.2906, device='cuda:0')
distance 1 is tensor(178.4449, device='cuda:0')
distance 2 is tensor(13.5552, device='cuda:0')
compute distance is  tensor(13.5552, device='cuda:0')
compute norm is  tensor(53.1995, device='cuda:0')
distance 1 is tensor(181.1579, device='cuda:0')
distance 2 is tensor(13.6945, device='cuda:0')
compute distance is  tensor(13.6945, device='cuda:0')
compute norm is  tensor(53.2361, device='cuda:0')
distance 1 is tensor(172.0804, device='cuda:0')
distance 2 is tensor(13.2884, device='cuda:0')
compute distance is  tensor(13.2884, device='cuda:0')
compute norm is  tensor(53.1361, device='cuda:0')
distance 1 is tensor(175.6833, device='cuda:0')
distance 2 is tensor(13.5692, device='cuda:0')
compute distance is  tensor(13.5692, device='cuda:0')
compute norm is  tensor(53.1066, device='cuda:0')
distance 1 is tensor(185.3942, device='cuda:0')
distance 2 is tensor(14.1356, device='cuda:0')
compute distance is  tensor(14.1356, device='cuda:0')
compute norm is  tensor(53.4978, device='cuda:0')
distance 1 is tensor(179.5313, device='cuda:0')
distance 2 is tensor(13.6981, device='cuda:0')
compute distance is  tensor(13.6981, device='cuda:0')
compute norm is  tensor(53.2305, device='cuda:0')
distance Threshold  is  tensor(14.4733, device='cuda:0')
distance 1 is tensor(1101976.7500, device='cuda:0')
distance 2 is tensor(79386.4062, device='cuda:0')
________________________________
test distance is  tensor(79386.4062, device='cuda:0')
test similarity is  tensor(0.2173, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197599570763762e+17
test entropy is  0.0
________________________________
cal ratio is  0.012152154154537761
distance 1 is tensor(13391.3955, device='cuda:0')
distance 2 is tensor(964.7159, device='cuda:0')
cal_distance is  tensor(964.7159, device='cuda:0')
cal ratio is  0.11023680627833095
distance 1 is tensor(1476.2312, device='cuda:0')
distance 2 is tensor(106.3472, device='cuda:0')
cal_distance is  tensor(106.3472, device='cuda:0')
cal ratio is  0.33201928711826134
distance 1 is tensor(490.1421, device='cuda:0')
distance 2 is tensor(35.3093, device='cuda:0')
cal_distance is  tensor(35.3093, device='cuda:0')
cal ratio is  0.5762111570254287
distance 1 is tensor(282.4284, device='cuda:0')
distance 2 is tensor(20.3456, device='cuda:0')
cal_distance is  tensor(20.3456, device='cuda:0')
cal ratio is  0.7590857590731415
distance 1 is tensor(214.3891, device='cuda:0')
distance 2 is tensor(15.4441, device='cuda:0')
cal_distance is  tensor(15.4441, device='cuda:0')
cal ratio is  0.8712552759922042
distance 1 is tensor(186.7886, device='cuda:0')
distance 2 is tensor(13.4557, device='cuda:0')
cal_distance is  tensor(13.4557, device='cuda:0')
distance 1 is tensor(186.7886, device='cuda:0')
distance 2 is tensor(13.4557, device='cuda:0')
________________________________
test distance is  tensor(13.4557, device='cuda:0')
test similarity is  tensor(0.9361, device='cuda:0')
test acc is  0.1129166668229986
test loss is 207.40358062288655
test entropy is  2.0528714568026664e-23
________________________________
distance 1 is tensor(186.7886, device='cuda:0')
distance 2 is tensor(13.4557, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  8.86267502205676e-21
avg test loss is  207.61960757973353
avg accuracy is  0.11193333348966529
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9361, device='cuda:0')
compute_distance is  tensor(13.4557, device='cuda:0')
compute_norm is  tensor(56.3764, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(168.8224, device='cuda:0')
distance 2 is tensor(13.5549, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9341390750555596
avg test loss is  1.415685425943403
avg accuracy is  0.5625000001563408
solo acc is  0.2961500001563395
compute similarity  is  tensor(0.9390, device='cuda:0')
compute_distance is  tensor(13.5549, device='cuda:0')
compute_norm is  tensor(56.0098, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(168.8224, device='cuda:0')
distance 2 is tensor(13.5549, device='cuda:0')
________________________________
test distance is  tensor(13.5549, device='cuda:0')
test similarity is  tensor(0.9390, device='cuda:0')
test acc is  0.5658333334896738
test loss is 1.4218008796543455
test entropy is  0.9342934510855279
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2085407972335815
mal norm is  tensor(9.0882, device='cuda:0')
distance 1 is tensor(168.8224, device='cuda:0')
distance 2 is tensor(13.5549, device='cuda:0')
mal distance is  tensor(13.5549, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2045, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.5286, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.2934, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.0051, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1801, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.6891, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.5974, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.7044, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.5813, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.8191, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.2583, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.5178, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.9203, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(766.3278, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.0658, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.2192, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.7908, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.3655, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.3661, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.4657, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.4589, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.1429, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.2635, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.7538, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.7357, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.1819, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 91.12% 

Test Accuracy: 89.46% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5708354115486145
distance 1 is tensor(119.5488, device='cuda:0')
distance 2 is tensor(8.8692, device='cuda:0')
benign distance is  tensor(8.8692, device='cuda:0')
norm1 res is  tensor(0.1272, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.23182468116283417
distance 1 is tensor(120.2476, device='cuda:0')
distance 2 is tensor(8.8271, device='cuda:0')
benign distance is  tensor(8.8271, device='cuda:0')
norm1 res is  tensor(0.1281, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.40169358253479004
distance 1 is tensor(107.7236, device='cuda:0')
distance 2 is tensor(8.0341, device='cuda:0')
benign distance is  tensor(8.0341, device='cuda:0')
norm1 res is  tensor(0.1155, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.34256869554519653
distance 1 is tensor(135.7061, device='cuda:0')
distance 2 is tensor(10.0123, device='cuda:0')
benign distance is  tensor(10.0123, device='cuda:0')
norm1 res is  tensor(0.1436, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.4727266728878021
distance 1 is tensor(126.2776, device='cuda:0')
distance 2 is tensor(9.0887, device='cuda:0')
benign distance is  tensor(9.0887, device='cuda:0')
norm1 res is  tensor(0.1311, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.4306258261203766
distance 1 is tensor(137.7256, device='cuda:0')
distance 2 is tensor(10.2335, device='cuda:0')
benign distance is  tensor(10.2335, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.2779114842414856
distance 1 is tensor(121.8971, device='cuda:0')
distance 2 is tensor(8.7632, device='cuda:0')
benign distance is  tensor(8.7632, device='cuda:0')
norm1 res is  tensor(0.1285, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.09961726516485214
distance 1 is tensor(122.7445, device='cuda:0')
distance 2 is tensor(9.0682, device='cuda:0')
benign distance is  tensor(9.0682, device='cuda:0')
norm1 res is  tensor(0.1320, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.5508266687393188
distance 1 is tensor(129.5631, device='cuda:0')
distance 2 is tensor(9.2726, device='cuda:0')
benign distance is  tensor(9.2726, device='cuda:0')
norm1 res is  tensor(0.1357, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.22912302613258362
distance 1 is tensor(131.7678, device='cuda:0')
distance 2 is tensor(9.7826, device='cuda:0')
benign distance is  tensor(9.7826, device='cuda:0')
norm1 res is  tensor(0.1405, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6150090098381042
distance 1 is tensor(131.0026, device='cuda:0')
distance 2 is tensor(9.6658, device='cuda:0')
benign distance is  tensor(9.6658, device='cuda:0')
norm1 res is  tensor(0.1386, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.521572470664978
distance 1 is tensor(122.2008, device='cuda:0')
distance 2 is tensor(9.0800, device='cuda:0')
benign distance is  tensor(9.0800, device='cuda:0')
norm1 res is  tensor(0.1295, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.5374053716659546
distance 1 is tensor(127.6969, device='cuda:0')
distance 2 is tensor(9.5335, device='cuda:0')
benign distance is  tensor(9.5335, device='cuda:0')
norm1 res is  tensor(0.1383, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.3076595067977905
distance 1 is tensor(121.9758, device='cuda:0')
distance 2 is tensor(8.9567, device='cuda:0')
benign distance is  tensor(8.9567, device='cuda:0')
norm1 res is  tensor(0.1284, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.6457685828208923
distance 1 is tensor(125.1021, device='cuda:0')
distance 2 is tensor(9.2367, device='cuda:0')
benign distance is  tensor(9.2367, device='cuda:0')
norm1 res is  tensor(0.1357, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.8346281051635742
distance 1 is tensor(141.2272, device='cuda:0')
distance 2 is tensor(10.3720, device='cuda:0')
benign distance is  tensor(10.3720, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.24456052482128143
distance 1 is tensor(135.0999, device='cuda:0')
distance 2 is tensor(9.8769, device='cuda:0')
benign distance is  tensor(9.8769, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.43115320801734924
distance 1 is tensor(130.0690, device='cuda:0')
distance 2 is tensor(9.5547, device='cuda:0')
benign distance is  tensor(9.5547, device='cuda:0')
norm1 res is  tensor(0.1377, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.2581891119480133
distance 1 is tensor(143.9974, device='cuda:0')
distance 2 is tensor(10.7030, device='cuda:0')
benign distance is  tensor(10.7030, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.25050029158592224
distance 1 is tensor(136.4569, device='cuda:0')
distance 2 is tensor(9.9948, device='cuda:0')
benign distance is  tensor(9.9948, device='cuda:0')
norm1 res is  tensor(0.1423, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.7912853956222534
distance 1 is tensor(136.1329, device='cuda:0')
distance 2 is tensor(9.9135, device='cuda:0')
benign distance is  tensor(9.9135, device='cuda:0')
norm1 res is  tensor(0.1428, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.06046523526310921
distance 1 is tensor(137.3409, device='cuda:0')
distance 2 is tensor(10.1133, device='cuda:0')
benign distance is  tensor(10.1133, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.20138046145439148
distance 1 is tensor(136.3531, device='cuda:0')
distance 2 is tensor(10.1091, device='cuda:0')
benign distance is  tensor(10.1091, device='cuda:0')
norm1 res is  tensor(0.1456, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.25817206501960754
distance 1 is tensor(131.9109, device='cuda:0')
distance 2 is tensor(9.9792, device='cuda:0')
benign distance is  tensor(9.9792, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(199.5733, device='cuda:0')
distance 2 is tensor(14.6486, device='cuda:0')
compute distance is  tensor(14.6486, device='cuda:0')
compute norm is  tensor(54.8885, device='cuda:0')
distance 1 is tensor(196.6012, device='cuda:0')
distance 2 is tensor(14.7922, device='cuda:0')
compute distance is  tensor(14.7922, device='cuda:0')
compute norm is  tensor(55.2603, device='cuda:0')
distance 1 is tensor(219.5067, device='cuda:0')
distance 2 is tensor(16.4649, device='cuda:0')
compute distance is  tensor(16.4649, device='cuda:0')
compute norm is  tensor(55.6605, device='cuda:0')
distance 1 is tensor(216.5191, device='cuda:0')
distance 2 is tensor(15.6253, device='cuda:0')
compute distance is  tensor(15.6253, device='cuda:0')
compute norm is  tensor(55.4847, device='cuda:0')
distance 1 is tensor(222.7157, device='cuda:0')
distance 2 is tensor(16.2865, device='cuda:0')
compute distance is  tensor(16.2865, device='cuda:0')
compute norm is  tensor(55.7346, device='cuda:0')
distance 1 is tensor(217.7130, device='cuda:0')
distance 2 is tensor(16.1442, device='cuda:0')
compute distance is  tensor(16.1442, device='cuda:0')
compute norm is  tensor(55.5293, device='cuda:0')
distance 1 is tensor(199.7155, device='cuda:0')
distance 2 is tensor(14.8386, device='cuda:0')
compute distance is  tensor(14.8386, device='cuda:0')
compute norm is  tensor(55.1652, device='cuda:0')
distance 1 is tensor(199.9444, device='cuda:0')
distance 2 is tensor(15.0086, device='cuda:0')
compute distance is  tensor(15.0086, device='cuda:0')
compute norm is  tensor(54.9261, device='cuda:0')
distance 1 is tensor(205.1917, device='cuda:0')
distance 2 is tensor(14.8344, device='cuda:0')
compute distance is  tensor(14.8344, device='cuda:0')
compute norm is  tensor(55.2232, device='cuda:0')
distance 1 is tensor(218.3549, device='cuda:0')
distance 2 is tensor(15.9656, device='cuda:0')
compute distance is  tensor(15.9656, device='cuda:0')
compute norm is  tensor(55.7447, device='cuda:0')
distance 1 is tensor(218.9874, device='cuda:0')
distance 2 is tensor(16.1722, device='cuda:0')
compute distance is  tensor(16.1722, device='cuda:0')
compute norm is  tensor(55.6994, device='cuda:0')
distance 1 is tensor(212.7822, device='cuda:0')
distance 2 is tensor(15.5704, device='cuda:0')
compute distance is  tensor(15.5704, device='cuda:0')
compute norm is  tensor(55.5354, device='cuda:0')
distance Threshold  is  tensor(16.4649, device='cuda:0')
distance 1 is tensor(1102013.2500, device='cuda:0')
distance 2 is tensor(79389.5938, device='cuda:0')
________________________________
test distance is  tensor(79389.5938, device='cuda:0')
test similarity is  tensor(0.1257, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.199509308466e+17
test entropy is  0.0
________________________________
cal ratio is  0.012961043286684048
distance 1 is tensor(14283.2480, device='cuda:0')
distance 2 is tensor(1028.9719, device='cuda:0')
cal_distance is  tensor(1028.9719, device='cuda:0')
cal ratio is  0.11384657727258841
distance 1 is tensor(1626.1052, device='cuda:0')
distance 2 is tensor(117.1449, device='cuda:0')
cal_distance is  tensor(117.1449, device='cuda:0')
cal ratio is  0.3374116006953188
distance 1 is tensor(548.6715, device='cuda:0')
distance 2 is tensor(39.5261, device='cuda:0')
cal_distance is  tensor(39.5261, device='cuda:0')
cal ratio is  0.5808713656472472
distance 1 is tensor(318.7106, device='cuda:0')
distance 2 is tensor(22.9596, device='cuda:0')
cal_distance is  tensor(22.9596, device='cuda:0')
cal ratio is  0.7621491938463049
distance 1 is tensor(242.9068, device='cuda:0')
distance 2 is tensor(17.4986, device='cuda:0')
cal_distance is  tensor(17.4986, device='cuda:0')
cal ratio is  0.8730115711831575
distance 1 is tensor(212.0613, device='cuda:0')
distance 2 is tensor(15.2765, device='cuda:0')
cal_distance is  tensor(15.2765, device='cuda:0')
distance 1 is tensor(212.0613, device='cuda:0')
distance 2 is tensor(15.2765, device='cuda:0')
________________________________
test distance is  tensor(15.2765, device='cuda:0')
test similarity is  tensor(0.9151, device='cuda:0')
test acc is  0.49266666682300875
test loss is 277.7255306772586
test entropy is  4.741352853648859e-12
________________________________
distance 1 is tensor(212.0613, device='cuda:0')
distance 2 is tensor(15.2765, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  5.329968221337265e-06
avg test loss is  277.6201504217282
avg accuracy is  0.49078333348967534
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9151, device='cuda:0')
compute_distance is  tensor(15.2765, device='cuda:0')
compute_norm is  tensor(57.2915, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(194.8650, device='cuda:0')
distance 2 is tensor(16.2709, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9626818865474099
avg test loss is  1.499442588164608
avg accuracy is  0.7898833334896591
solo acc is  0.28221666682300584
compute similarity  is  tensor(0.9182, device='cuda:0')
compute_distance is  tensor(16.2709, device='cuda:0')
compute_norm is  tensor(56.8970, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(194.8650, device='cuda:0')
distance 2 is tensor(16.2709, device='cuda:0')
________________________________
test distance is  tensor(16.2709, device='cuda:0')
test similarity is  tensor(0.9182, device='cuda:0')
test acc is  0.7901333334896591
test loss is 1.50377835025157
test entropy is  0.9601558513605772
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.5854798555374146
mal norm is  tensor(10.3700, device='cuda:0')
distance 1 is tensor(194.8650, device='cuda:0')
distance 2 is tensor(16.2709, device='cuda:0')
mal distance is  tensor(16.2709, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1827, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.1597, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.8057, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.6599e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.0502, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.7867, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.0066e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(515.1613, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.4261, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.4293e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.9644, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.1275, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.3188e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1037.0026, device='cuda:0')
c is  tensor(0.0133, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.2531, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1338e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.9201, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.4232e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.6714, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.7009, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.7757, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.0795, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.3269e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.9559, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.9994, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
len accept list 9
len all weights is 9
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 91.18% 

Test Accuracy: 89.70% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
 benign loss is  0.44401079416275024
distance 1 is tensor(104.3970, device='cuda:0')
distance 2 is tensor(7.8763, device='cuda:0')
benign distance is  tensor(7.8763, device='cuda:0')
norm1 res is  tensor(0.1136, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.2197239398956299
distance 1 is tensor(118.6888, device='cuda:0')
distance 2 is tensor(8.6127, device='cuda:0')
benign distance is  tensor(8.6127, device='cuda:0')
norm1 res is  tensor(0.1268, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.09872571378946304
distance 1 is tensor(113.3675, device='cuda:0')
distance 2 is tensor(8.3824, device='cuda:0')
benign distance is  tensor(8.3824, device='cuda:0')
norm1 res is  tensor(0.1199, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.49606576561927795
distance 1 is tensor(127.0955, device='cuda:0')
distance 2 is tensor(9.2640, device='cuda:0')
benign distance is  tensor(9.2640, device='cuda:0')
norm1 res is  tensor(0.1366, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.37922996282577515
distance 1 is tensor(119.7157, device='cuda:0')
distance 2 is tensor(8.7383, device='cuda:0')
benign distance is  tensor(8.7383, device='cuda:0')
norm1 res is  tensor(0.1270, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.045662760734558
distance 1 is tensor(134.7073, device='cuda:0')
distance 2 is tensor(9.7267, device='cuda:0')
benign distance is  tensor(9.7267, device='cuda:0')
norm1 res is  tensor(0.1444, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.20395731925964355
distance 1 is tensor(109.4674, device='cuda:0')
distance 2 is tensor(8.0293, device='cuda:0')
benign distance is  tensor(8.0293, device='cuda:0')
norm1 res is  tensor(0.1180, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2537503242492676
distance 1 is tensor(111.6638, device='cuda:0')
distance 2 is tensor(8.1560, device='cuda:0')
benign distance is  tensor(8.1560, device='cuda:0')
norm1 res is  tensor(0.1188, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.15055005252361298
distance 1 is tensor(118.7357, device='cuda:0')
distance 2 is tensor(8.7092, device='cuda:0')
benign distance is  tensor(8.7092, device='cuda:0')
norm1 res is  tensor(0.1278, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.6131764054298401
distance 1 is tensor(133.2172, device='cuda:0')
distance 2 is tensor(9.7013, device='cuda:0')
benign distance is  tensor(9.7013, device='cuda:0')
norm1 res is  tensor(0.1421, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.12572680413722992
distance 1 is tensor(133.1811, device='cuda:0')
distance 2 is tensor(9.9574, device='cuda:0')
benign distance is  tensor(9.9574, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.2961682379245758
distance 1 is tensor(119.1320, device='cuda:0')
distance 2 is tensor(8.8839, device='cuda:0')
benign distance is  tensor(8.8839, device='cuda:0')
norm1 res is  tensor(0.1318, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.6900805234909058
distance 1 is tensor(140.5124, device='cuda:0')
distance 2 is tensor(10.3610, device='cuda:0')
benign distance is  tensor(10.3610, device='cuda:0')
norm1 res is  tensor(0.1484, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.3275554180145264
distance 1 is tensor(134.0449, device='cuda:0')
distance 2 is tensor(9.7810, device='cuda:0')
benign distance is  tensor(9.7810, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.35628625750541687
distance 1 is tensor(136.0182, device='cuda:0')
distance 2 is tensor(9.8894, device='cuda:0')
benign distance is  tensor(9.8894, device='cuda:0')
norm1 res is  tensor(0.1475, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.45145153999328613
distance 1 is tensor(131.4151, device='cuda:0')
distance 2 is tensor(9.6287, device='cuda:0')
benign distance is  tensor(9.6287, device='cuda:0')
norm1 res is  tensor(0.1405, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(142.6410, device='cuda:0')
distance 2 is tensor(10.4237, device='cuda:0')
compute distance is  tensor(10.4237, device='cuda:0')
compute norm is  tensor(53.7234, device='cuda:0')
distance 1 is tensor(153.6480, device='cuda:0')
distance 2 is tensor(11.2121, device='cuda:0')
compute distance is  tensor(11.2121, device='cuda:0')
compute norm is  tensor(53.9975, device='cuda:0')
distance 1 is tensor(155.5474, device='cuda:0')
distance 2 is tensor(11.3017, device='cuda:0')
compute distance is  tensor(11.3017, device='cuda:0')
compute norm is  tensor(54.2504, device='cuda:0')
distance 1 is tensor(146.7554, device='cuda:0')
distance 2 is tensor(10.6726, device='cuda:0')
compute distance is  tensor(10.6726, device='cuda:0')
compute norm is  tensor(53.8179, device='cuda:0')
distance 1 is tensor(152.4888, device='cuda:0')
distance 2 is tensor(11.1923, device='cuda:0')
compute distance is  tensor(11.1923, device='cuda:0')
compute norm is  tensor(54.0586, device='cuda:0')
distance 1 is tensor(148.3006, device='cuda:0')
distance 2 is tensor(10.8950, device='cuda:0')
compute distance is  tensor(10.8950, device='cuda:0')
compute norm is  tensor(54.0798, device='cuda:0')
distance 1 is tensor(145.3581, device='cuda:0')
distance 2 is tensor(10.6469, device='cuda:0')
compute distance is  tensor(10.6469, device='cuda:0')
compute norm is  tensor(53.8662, device='cuda:0')
distance 1 is tensor(148.5547, device='cuda:0')
distance 2 is tensor(10.8281, device='cuda:0')
compute distance is  tensor(10.8281, device='cuda:0')
compute norm is  tensor(53.8777, device='cuda:0')
distance 1 is tensor(160.6467, device='cuda:0')
distance 2 is tensor(11.5699, device='cuda:0')
compute distance is  tensor(11.5699, device='cuda:0')
compute norm is  tensor(54.2731, device='cuda:0')
distance 1 is tensor(154.2419, device='cuda:0')
distance 2 is tensor(11.2736, device='cuda:0')
compute distance is  tensor(11.2736, device='cuda:0')
compute norm is  tensor(54.0383, device='cuda:0')
distance 1 is tensor(152.7244, device='cuda:0')
distance 2 is tensor(11.0412, device='cuda:0')
compute distance is  tensor(11.0412, device='cuda:0')
compute norm is  tensor(54.0102, device='cuda:0')
distance 1 is tensor(146.1812, device='cuda:0')
distance 2 is tensor(10.6179, device='cuda:0')
compute distance is  tensor(10.6179, device='cuda:0')
compute norm is  tensor(53.9325, device='cuda:0')
distance Threshold  is  tensor(11.5699, device='cuda:0')
distance 1 is tensor(1102028.5000, device='cuda:0')
distance 2 is tensor(79390.9219, device='cuda:0')
________________________________
test distance is  tensor(79390.9219, device='cuda:0')
test similarity is  tensor(0.0814, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.19759285559613e+17
test entropy is  0.0
________________________________
cal ratio is  0.010864826499595921
distance 1 is tensor(11973.3555, device='cuda:0')
distance 2 is tensor(862.5687, device='cuda:0')
cal_distance is  tensor(862.5687, device='cuda:0')
cal ratio is  0.10423447076095166
distance 1 is tensor(1248.0428, device='cuda:0')
distance 2 is tensor(89.9094, device='cuda:0')
cal_distance is  tensor(89.9094, device='cuda:0')
cal ratio is  0.3228536415379318
distance 1 is tensor(402.9401, device='cuda:0')
distance 2 is tensor(29.0276, device='cuda:0')
cal_distance is  tensor(29.0276, device='cuda:0')
cal ratio is  0.5682020996201987
distance 1 is tensor(228.9545, device='cuda:0')
distance 2 is tensor(16.4935, device='cuda:0')
cal_distance is  tensor(16.4935, device='cuda:0')
cal ratio is  0.7537917881384739
distance 1 is tensor(172.5858, device='cuda:0')
distance 2 is tensor(12.4327, device='cuda:0')
cal_distance is  tensor(12.4327, device='cuda:0')
cal ratio is  0.8682119143914814
distance 1 is tensor(149.8420, device='cuda:0')
distance 2 is tensor(10.7942, device='cuda:0')
cal_distance is  tensor(10.7942, device='cuda:0')
distance 1 is tensor(149.8420, device='cuda:0')
distance 2 is tensor(10.7942, device='cuda:0')
________________________________
test distance is  tensor(10.7942, device='cuda:0')
test similarity is  tensor(0.9526, device='cuda:0')
test acc is  0.8719000001563224
test loss is 42.573468255081664
test entropy is  0.017868184530485443
________________________________
distance 1 is tensor(149.8420, device='cuda:0')
distance 2 is tensor(10.7942, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.018637168072814105
avg test loss is  42.426366338343506
avg accuracy is  0.871416666822989
solo acc is  0.17588333348966834
compute similarity  is  tensor(0.9526, device='cuda:0')
compute_distance is  tensor(10.7942, device='cuda:0')
compute_norm is  tensor(55.4439, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(141.6008, device='cuda:0')
distance 2 is tensor(11.8934, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9052373233126171
avg test loss is  1.3778666686782959
avg accuracy is  0.8594833334896562
solo acc is  0.3263666668230067
compute similarity  is  tensor(0.9529, device='cuda:0')
compute_distance is  tensor(11.8934, device='cuda:0')
compute_norm is  tensor(54.6603, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.5136, device='cuda:0')
distance 2 is tensor(12.0839, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8670358502788584
avg test loss is  1.460651963250215
avg accuracy is  0.8585166668229897
solo acc is  0.2651000001563387
compute similarity  is  tensor(0.9528, device='cuda:0')
compute_distance is  tensor(12.0839, device='cuda:0')
compute_norm is  tensor(54.3529, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.3976, device='cuda:0')
distance 2 is tensor(12.2109, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8639124238541894
avg test loss is  1.4390261135121654
avg accuracy is  0.8599500001563228
solo acc is  0.2582666668230052
compute similarity  is  tensor(0.9527, device='cuda:0')
compute_distance is  tensor(12.2109, device='cuda:0')
compute_norm is  tensor(54.0592, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.2537, device='cuda:0')
distance 2 is tensor(12.3194, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8563501107921478
avg test loss is  1.4216102937391317
avg accuracy is  0.8623833334896561
solo acc is  0.2576500001563385
compute similarity  is  tensor(0.9526, device='cuda:0')
compute_distance is  tensor(12.3194, device='cuda:0')
compute_norm is  tensor(53.7767, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.1490, device='cuda:0')
distance 2 is tensor(12.4225, device='cuda:0')
________________________________
test distance is  tensor(12.4225, device='cuda:0')
test similarity is  tensor(0.9525, device='cuda:0')
test acc is  0.8597833334896562
test loss is 1.3916926988279388
test entropy is  0.8657505308895477
________________________________
cal ratio is  0.8685692352112839
distance 1 is tensor(126.0728, device='cuda:0')
distance 2 is tensor(10.7898, device='cuda:0')
cal_distance is  tensor(10.7898, device='cuda:0')
distance 1 is tensor(126.0728, device='cuda:0')
distance 2 is tensor(10.7898, device='cuda:0')
________________________________
test distance is  tensor(10.7898, device='cuda:0')
test similarity is  tensor(0.9636, device='cuda:0')
test acc is  0.8741333334896556
test loss is 0.9763501086977245
test entropy is  0.9591044184368557
________________________________
distance 1 is tensor(126.0728, device='cuda:0')
distance 2 is tensor(10.7898, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9591500663172716
avg test loss is  0.9796756239715161
avg accuracy is  0.8732333334896556
solo acc is  0.5601333334896744
compute similarity  is  tensor(0.9636, device='cuda:0')
compute_distance is  tensor(10.7898, device='cuda:0')
compute_norm is  tensor(53.2187, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(128.3074, device='cuda:0')
distance 2 is tensor(11.1055, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8432674877552081
avg test loss is  1.3911284829761936
avg accuracy is  0.870116666822989
solo acc is  0.2573833334896718
compute similarity  is  tensor(0.9631, device='cuda:0')
compute_distance is  tensor(11.1055, device='cuda:0')
compute_norm is  tensor(52.9444, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.6577, device='cuda:0')
distance 2 is tensor(11.2392, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8434700931567373
avg test loss is  1.381067453861745
avg accuracy is  0.8717500001563224
solo acc is  0.2527833334896717
compute similarity  is  tensor(0.9629, device='cuda:0')
compute_distance is  tensor(11.2392, device='cuda:0')
compute_norm is  tensor(52.6735, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.8987, device='cuda:0')
distance 2 is tensor(11.3577, device='cuda:0')
exit early
distance 1 is tensor(130.8987, device='cuda:0')
distance 2 is tensor(11.3577, device='cuda:0')
________________________________
test distance is  tensor(11.3577, device='cuda:0')
test similarity is  tensor(0.9628, device='cuda:0')
test acc is  0.8729500001563224
test loss is 1.3791786702965367
test entropy is  0.8333730590877249
________________________________
distance 1 is tensor(130.8987, device='cuda:0')
distance 2 is tensor(11.3577, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8333865395232812
avg test loss is  1.379730533689324
avg accuracy is  0.8746500001563222
solo acc is  0.24340000015633806
compute similarity  is  tensor(0.9628, device='cuda:0')
compute_distance is  tensor(11.3577, device='cuda:0')
compute_norm is  tensor(52.4080, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.0927, device='cuda:0')
distance 2 is tensor(11.4649, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8397276935292713
avg test loss is  1.3559590633998293
avg accuracy is  0.8739833334896556
solo acc is  0.2514833334896716
compute similarity  is  tensor(0.9626, device='cuda:0')
compute_distance is  tensor(11.4649, device='cuda:0')
compute_norm is  tensor(52.1461, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.2596, device='cuda:0')
distance 2 is tensor(11.5692, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8377136237331545
avg test loss is  1.3508017060599093
avg accuracy is  0.8721000001563224
solo acc is  0.2478833334896715
compute similarity  is  tensor(0.9625, device='cuda:0')
compute_distance is  tensor(11.5692, device='cuda:0')
compute_norm is  tensor(51.8878, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.5185, device='cuda:0')
distance 2 is tensor(11.6761, device='cuda:0')
exit early
distance 1 is tensor(134.5185, device='cuda:0')
distance 2 is tensor(11.6761, device='cuda:0')
________________________________
test distance is  tensor(11.6761, device='cuda:0')
test similarity is  tensor(0.9624, device='cuda:0')
test acc is  0.8770166668229888
test loss is 1.3467759699709634
test entropy is  0.8329259596908016
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.143436312675476
mal norm is  tensor(6.2911, device='cuda:0')
distance 1 is tensor(134.5185, device='cuda:0')
distance 2 is tensor(11.6761, device='cuda:0')
mal distance is  tensor(11.6761, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1953, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(448.2433, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.3737, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.9782, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.3137, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.5178, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.0550, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(462.1078, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.5906, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1149, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.2632, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.8553, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.1044e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.1085, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.4602, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.9982, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.9316e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.1390, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.6381e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.1464, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3459, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
len accept list 14
len all weights is 14
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 86.14% 

Test Accuracy: 84.71% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
 benign loss is  0.46283355355262756
distance 1 is tensor(151.1924, device='cuda:0')
distance 2 is tensor(11.5553, device='cuda:0')
benign distance is  tensor(11.5553, device='cuda:0')
norm1 res is  tensor(0.1558, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7749856114387512
distance 1 is tensor(150.5303, device='cuda:0')
distance 2 is tensor(11.3623, device='cuda:0')
benign distance is  tensor(11.3623, device='cuda:0')
norm1 res is  tensor(0.1548, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.42823338508605957
distance 1 is tensor(153.6884, device='cuda:0')
distance 2 is tensor(11.7149, device='cuda:0')
benign distance is  tensor(11.7149, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.8089418411254883
distance 1 is tensor(155.4195, device='cuda:0')
distance 2 is tensor(11.6654, device='cuda:0')
benign distance is  tensor(11.6654, device='cuda:0')
norm1 res is  tensor(0.1589, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.3699168562889099
distance 1 is tensor(149.2857, device='cuda:0')
distance 2 is tensor(11.3291, device='cuda:0')
benign distance is  tensor(11.3291, device='cuda:0')
norm1 res is  tensor(0.1498, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.4930465817451477
distance 1 is tensor(156.6628, device='cuda:0')
distance 2 is tensor(11.8972, device='cuda:0')
benign distance is  tensor(11.8972, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.39395466446876526
distance 1 is tensor(149.1645, device='cuda:0')
distance 2 is tensor(11.1427, device='cuda:0')
benign distance is  tensor(11.1427, device='cuda:0')
norm1 res is  tensor(0.1535, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5106886625289917
distance 1 is tensor(152.0248, device='cuda:0')
distance 2 is tensor(11.5897, device='cuda:0')
benign distance is  tensor(11.5897, device='cuda:0')
norm1 res is  tensor(0.1659, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.36219075322151184
distance 1 is tensor(174.1926, device='cuda:0')
distance 2 is tensor(13.0684, device='cuda:0')
benign distance is  tensor(13.0684, device='cuda:0')
norm1 res is  tensor(0.1767, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.455963134765625
distance 1 is tensor(157.9680, device='cuda:0')
distance 2 is tensor(11.8419, device='cuda:0')
benign distance is  tensor(11.8419, device='cuda:0')
norm1 res is  tensor(0.1622, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.4080129563808441
distance 1 is tensor(150.6451, device='cuda:0')
distance 2 is tensor(11.4616, device='cuda:0')
benign distance is  tensor(11.4616, device='cuda:0')
norm1 res is  tensor(0.1574, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.719173789024353
distance 1 is tensor(180.5787, device='cuda:0')
distance 2 is tensor(13.6584, device='cuda:0')
benign distance is  tensor(13.6584, device='cuda:0')
norm1 res is  tensor(0.1897, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.4166627824306488
distance 1 is tensor(166.4336, device='cuda:0')
distance 2 is tensor(12.5132, device='cuda:0')
benign distance is  tensor(12.5132, device='cuda:0')
norm1 res is  tensor(0.1721, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.5853885412216187
distance 1 is tensor(157.1156, device='cuda:0')
distance 2 is tensor(12.0397, device='cuda:0')
benign distance is  tensor(12.0397, device='cuda:0')
norm1 res is  tensor(0.1643, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.2137402594089508
distance 1 is tensor(156.2121, device='cuda:0')
distance 2 is tensor(11.9160, device='cuda:0')
benign distance is  tensor(11.9160, device='cuda:0')
norm1 res is  tensor(0.1638, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.44367533922195435
distance 1 is tensor(182.1815, device='cuda:0')
distance 2 is tensor(13.6907, device='cuda:0')
benign distance is  tensor(13.6907, device='cuda:0')
norm1 res is  tensor(0.1809, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(176.0522, device='cuda:0')
distance 2 is tensor(13.5437, device='cuda:0')
compute distance is  tensor(13.5437, device='cuda:0')
compute norm is  tensor(54.2584, device='cuda:0')
distance 1 is tensor(178.1187, device='cuda:0')
distance 2 is tensor(13.8550, device='cuda:0')
compute distance is  tensor(13.8550, device='cuda:0')
compute norm is  tensor(54.4499, device='cuda:0')
distance 1 is tensor(188.5025, device='cuda:0')
distance 2 is tensor(14.6945, device='cuda:0')
compute distance is  tensor(14.6945, device='cuda:0')
compute norm is  tensor(54.5994, device='cuda:0')
distance 1 is tensor(179.1578, device='cuda:0')
distance 2 is tensor(13.7583, device='cuda:0')
compute distance is  tensor(13.7583, device='cuda:0')
compute norm is  tensor(54.2865, device='cuda:0')
distance 1 is tensor(186.9652, device='cuda:0')
distance 2 is tensor(14.2124, device='cuda:0')
compute distance is  tensor(14.2124, device='cuda:0')
compute norm is  tensor(54.5017, device='cuda:0')
distance 1 is tensor(192.8425, device='cuda:0')
distance 2 is tensor(14.7324, device='cuda:0')
compute distance is  tensor(14.7324, device='cuda:0')
compute norm is  tensor(54.6325, device='cuda:0')
distance 1 is tensor(183.0498, device='cuda:0')
distance 2 is tensor(13.9281, device='cuda:0')
compute distance is  tensor(13.9281, device='cuda:0')
compute norm is  tensor(54.5110, device='cuda:0')
distance 1 is tensor(182.5099, device='cuda:0')
distance 2 is tensor(14.1113, device='cuda:0')
compute distance is  tensor(14.1113, device='cuda:0')
compute norm is  tensor(54.3582, device='cuda:0')
distance 1 is tensor(191.5111, device='cuda:0')
distance 2 is tensor(14.4763, device='cuda:0')
compute distance is  tensor(14.4763, device='cuda:0')
compute norm is  tensor(54.6765, device='cuda:0')
distance 1 is tensor(188.4138, device='cuda:0')
distance 2 is tensor(14.4554, device='cuda:0')
compute distance is  tensor(14.4554, device='cuda:0')
compute norm is  tensor(54.6787, device='cuda:0')
distance 1 is tensor(190.2439, device='cuda:0')
distance 2 is tensor(14.7227, device='cuda:0')
compute distance is  tensor(14.7227, device='cuda:0')
compute norm is  tensor(54.6014, device='cuda:0')
distance 1 is tensor(175.7988, device='cuda:0')
distance 2 is tensor(13.5181, device='cuda:0')
compute distance is  tensor(13.5181, device='cuda:0')
compute norm is  tensor(54.3705, device='cuda:0')
distance Threshold  is  tensor(14.7324, device='cuda:0')
distance 1 is tensor(1101963.1250, device='cuda:0')
distance 2 is tensor(79385.5000, device='cuda:0')
________________________________
test distance is  tensor(79385.5000, device='cuda:0')
test similarity is  tensor(0.2498, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.199250168637939e+17
test entropy is  0.0
________________________________
cal ratio is  0.012260534319346079
distance 1 is tensor(13510.6650, device='cuda:0')
distance 2 is tensor(973.3086, device='cuda:0')
cal_distance is  tensor(973.3086, device='cuda:0')
cal ratio is  0.11072729896189333
distance 1 is tensor(1496.0059, device='cuda:0')
distance 2 is tensor(107.7718, device='cuda:0')
cal_distance is  tensor(107.7718, device='cuda:0')
cal ratio is  0.33275714467644635
distance 1 is tensor(497.8114, device='cuda:0')
distance 2 is tensor(35.8618, device='cuda:0')
cal_distance is  tensor(35.8618, device='cuda:0')
cal ratio is  0.5768510282625522
distance 1 is tensor(287.1661, device='cuda:0')
distance 2 is tensor(20.6869, device='cuda:0')
cal_distance is  tensor(20.6869, device='cuda:0')
cal ratio is  0.7595070724076398
distance 1 is tensor(218.1064, device='cuda:0')
distance 2 is tensor(15.7119, device='cuda:0')
cal_distance is  tensor(15.7119, device='cuda:0')
cal ratio is  0.8714970138501928
distance 1 is tensor(190.0800, device='cuda:0')
distance 2 is tensor(13.6929, device='cuda:0')
cal_distance is  tensor(13.6929, device='cuda:0')
distance 1 is tensor(190.0800, device='cuda:0')
distance 2 is tensor(13.6929, device='cuda:0')
________________________________
test distance is  tensor(13.6929, device='cuda:0')
test similarity is  tensor(0.9383, device='cuda:0')
test acc is  0.10756666682299862
test loss is 243.50030031183888
test entropy is  3.9341872712638083e-25
________________________________
distance 1 is tensor(190.0800, device='cuda:0')
distance 2 is tensor(13.6929, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  2.3566407344340903e-23
avg test loss is  243.53304442057987
avg accuracy is  0.10678333348966529
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9383, device='cuda:0')
compute_distance is  tensor(13.6929, device='cuda:0')
compute_norm is  tensor(57.3415, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(171.6861, device='cuda:0')
distance 2 is tensor(13.7936, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9511923083364328
avg test loss is  1.3984609204314664
avg accuracy is  0.556916666823008
solo acc is  0.3014000001563396
compute similarity  is  tensor(0.9413, device='cuda:0')
compute_distance is  tensor(13.7936, device='cuda:0')
compute_norm is  tensor(57.0297, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(171.6861, device='cuda:0')
distance 2 is tensor(13.7936, device='cuda:0')
________________________________
test distance is  tensor(13.7936, device='cuda:0')
test similarity is  tensor(0.9413, device='cuda:0')
test acc is  0.5613333334896743
test loss is 1.4016639920694234
test entropy is  0.9528093321491152
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3802988529205322
mal norm is  tensor(9.2455, device='cuda:0')
distance 1 is tensor(171.6861, device='cuda:0')
distance 2 is tensor(13.7936, device='cuda:0')
mal distance is  tensor(13.7936, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(0.2259, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4607, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.0244, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.4810, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.7444, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.0375, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.3788, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.4424, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.4624, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(924.5538, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0016, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.4979, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(810.9518, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(793.8363, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1497, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.0036, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(784.0250, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.7419, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(736.9754, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0028, device='cuda:0')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 90.77% 

Test Accuracy: 89.50% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3890857994556427
distance 1 is tensor(123.6475, device='cuda:0')
distance 2 is tensor(9.2121, device='cuda:0')
benign distance is  tensor(9.2121, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.43908557295799255
distance 1 is tensor(121.8509, device='cuda:0')
distance 2 is tensor(9.0147, device='cuda:0')
benign distance is  tensor(9.0147, device='cuda:0')
norm1 res is  tensor(0.1317, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.2766057848930359
distance 1 is tensor(105.4785, device='cuda:0')
distance 2 is tensor(7.8590, device='cuda:0')
benign distance is  tensor(7.8590, device='cuda:0')
norm1 res is  tensor(0.1090, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.31271684169769287
distance 1 is tensor(127.4531, device='cuda:0')
distance 2 is tensor(9.3515, device='cuda:0')
benign distance is  tensor(9.3515, device='cuda:0')
norm1 res is  tensor(0.1321, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5449815988540649
distance 1 is tensor(129.1921, device='cuda:0')
distance 2 is tensor(9.4563, device='cuda:0')
benign distance is  tensor(9.4563, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.29924455285072327
distance 1 is tensor(145.3412, device='cuda:0')
distance 2 is tensor(10.6396, device='cuda:0')
benign distance is  tensor(10.6396, device='cuda:0')
norm1 res is  tensor(0.1548, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.44444742798805237
distance 1 is tensor(127.0873, device='cuda:0')
distance 2 is tensor(9.2211, device='cuda:0')
benign distance is  tensor(9.2211, device='cuda:0')
norm1 res is  tensor(0.1333, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.4147490859031677
distance 1 is tensor(124.6961, device='cuda:0')
distance 2 is tensor(9.2099, device='cuda:0')
benign distance is  tensor(9.2099, device='cuda:0')
norm1 res is  tensor(0.1327, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.6005128622055054
distance 1 is tensor(123.7535, device='cuda:0')
distance 2 is tensor(9.1673, device='cuda:0')
benign distance is  tensor(9.1673, device='cuda:0')
norm1 res is  tensor(0.1311, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.1993962526321411
distance 1 is tensor(123.9335, device='cuda:0')
distance 2 is tensor(9.2444, device='cuda:0')
benign distance is  tensor(9.2444, device='cuda:0')
norm1 res is  tensor(0.1330, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.36033737659454346
distance 1 is tensor(141.0684, device='cuda:0')
distance 2 is tensor(10.3832, device='cuda:0')
benign distance is  tensor(10.3832, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.029751133173704147
distance 1 is tensor(127.3828, device='cuda:0')
distance 2 is tensor(9.4755, device='cuda:0')
benign distance is  tensor(9.4755, device='cuda:0')
norm1 res is  tensor(0.1356, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.45059919357299805
distance 1 is tensor(134.0382, device='cuda:0')
distance 2 is tensor(9.7432, device='cuda:0')
benign distance is  tensor(9.7432, device='cuda:0')
norm1 res is  tensor(0.1388, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.43454569578170776
distance 1 is tensor(141.7559, device='cuda:0')
distance 2 is tensor(10.4568, device='cuda:0')
benign distance is  tensor(10.4568, device='cuda:0')
norm1 res is  tensor(0.1525, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.5459576845169067
distance 1 is tensor(126.9956, device='cuda:0')
distance 2 is tensor(9.3803, device='cuda:0')
benign distance is  tensor(9.3803, device='cuda:0')
norm1 res is  tensor(0.1319, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6787117719650269
distance 1 is tensor(125.4012, device='cuda:0')
distance 2 is tensor(9.1501, device='cuda:0')
benign distance is  tensor(9.1501, device='cuda:0')
norm1 res is  tensor(0.1310, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(141.0762, device='cuda:0')
distance 2 is tensor(10.6026, device='cuda:0')
compute distance is  tensor(10.6026, device='cuda:0')
compute norm is  tensor(54.0052, device='cuda:0')
distance 1 is tensor(153.3543, device='cuda:0')
distance 2 is tensor(11.4766, device='cuda:0')
compute distance is  tensor(11.4766, device='cuda:0')
compute norm is  tensor(54.2405, device='cuda:0')
distance 1 is tensor(155.3860, device='cuda:0')
distance 2 is tensor(11.6412, device='cuda:0')
compute distance is  tensor(11.6412, device='cuda:0')
compute norm is  tensor(54.2740, device='cuda:0')
distance 1 is tensor(159.2746, device='cuda:0')
distance 2 is tensor(11.8484, device='cuda:0')
compute distance is  tensor(11.8484, device='cuda:0')
compute norm is  tensor(54.1512, device='cuda:0')
distance 1 is tensor(148.9883, device='cuda:0')
distance 2 is tensor(11.1896, device='cuda:0')
compute distance is  tensor(11.1896, device='cuda:0')
compute norm is  tensor(54.1506, device='cuda:0')
distance 1 is tensor(154.3743, device='cuda:0')
distance 2 is tensor(11.3742, device='cuda:0')
compute distance is  tensor(11.3742, device='cuda:0')
compute norm is  tensor(54.3740, device='cuda:0')
distance 1 is tensor(150.3880, device='cuda:0')
distance 2 is tensor(11.2937, device='cuda:0')
compute distance is  tensor(11.2937, device='cuda:0')
compute norm is  tensor(54.1819, device='cuda:0')
distance 1 is tensor(146.8181, device='cuda:0')
distance 2 is tensor(10.9567, device='cuda:0')
compute distance is  tensor(10.9567, device='cuda:0')
compute norm is  tensor(54.1147, device='cuda:0')
distance 1 is tensor(162.3105, device='cuda:0')
distance 2 is tensor(12.0561, device='cuda:0')
compute distance is  tensor(12.0561, device='cuda:0')
compute norm is  tensor(54.4486, device='cuda:0')
distance 1 is tensor(146.6529, device='cuda:0')
distance 2 is tensor(11.0246, device='cuda:0')
compute distance is  tensor(11.0246, device='cuda:0')
compute norm is  tensor(54.1065, device='cuda:0')
distance 1 is tensor(156.4040, device='cuda:0')
distance 2 is tensor(11.6985, device='cuda:0')
compute distance is  tensor(11.6985, device='cuda:0')
compute norm is  tensor(54.3881, device='cuda:0')
distance 1 is tensor(150.8066, device='cuda:0')
distance 2 is tensor(11.2290, device='cuda:0')
compute distance is  tensor(11.2290, device='cuda:0')
compute norm is  tensor(54.2748, device='cuda:0')
distance Threshold  is  tensor(12.0561, device='cuda:0')
distance 1 is tensor(1102003.6250, device='cuda:0')
distance 2 is tensor(79388.9297, device='cuda:0')
________________________________
test distance is  tensor(79388.9297, device='cuda:0')
test similarity is  tensor(0.1510, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.194549240666812e+17
test entropy is  0.0
________________________________
cal ratio is  0.011090887331661428
distance 1 is tensor(12222.2070, device='cuda:0')
distance 2 is tensor(880.4938, device='cuda:0')
cal_distance is  tensor(880.4938, device='cuda:0')
cal ratio is  0.10531327828698414
distance 1 is tensor(1287.1671, device='cuda:0')
distance 2 is tensor(92.7277, device='cuda:0')
cal_distance is  tensor(92.7277, device='cuda:0')
cal ratio is  0.3245200843433012
distance 1 is tensor(417.7164, device='cuda:0')
distance 2 is tensor(30.0920, device='cuda:0')
cal_distance is  tensor(30.0920, device='cuda:0')
cal ratio is  0.5696666556566296
distance 1 is tensor(237.9622, device='cuda:0')
distance 2 is tensor(17.1424, device='cuda:0')
cal_distance is  tensor(17.1424, device='cuda:0')
cal ratio is  0.7547625652441138
distance 1 is tensor(179.6068, device='cuda:0')
distance 2 is tensor(12.9384, device='cuda:0')
cal_distance is  tensor(12.9384, device='cuda:0')
cal ratio is  0.8687707922526199
distance 1 is tensor(156.0381, device='cuda:0')
distance 2 is tensor(11.2405, device='cuda:0')
cal_distance is  tensor(11.2405, device='cuda:0')
distance 1 is tensor(156.0381, device='cuda:0')
distance 2 is tensor(11.2405, device='cuda:0')
________________________________
test distance is  tensor(11.2405, device='cuda:0')
test similarity is  tensor(0.9516, device='cuda:0')
test acc is  0.8202333334896578
test loss is 66.14623884351523
test entropy is  0.004770517187334908
________________________________
distance 1 is tensor(156.0381, device='cuda:0')
distance 2 is tensor(11.2405, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.004755521216047023
avg test loss is  65.96064060430791
avg accuracy is  0.8208666668229911
solo acc is  0.11370000015633194
compute similarity  is  tensor(0.9516, device='cuda:0')
compute_distance is  tensor(11.2405, device='cuda:0')
compute_norm is  tensor(55.8884, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(145.7327, device='cuda:0')
distance 2 is tensor(12.0135, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8927793008432205
avg test loss is  1.3862724535500826
avg accuracy is  0.8418666668229903
solo acc is  0.3089500001563397
compute similarity  is  tensor(0.9525, device='cuda:0')
compute_distance is  tensor(12.0135, device='cuda:0')
compute_norm is  tensor(55.2715, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.1339, device='cuda:0')
distance 2 is tensor(12.1376, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8576765929076717
avg test loss is  1.4628939205395388
avg accuracy is  0.8395833334896571
solo acc is  0.25011666682300493
compute similarity  is  tensor(0.9524, device='cuda:0')
compute_distance is  tensor(12.1376, device='cuda:0')
compute_norm is  tensor(54.9713, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.5206, device='cuda:0')
distance 2 is tensor(12.2190, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8574986429865172
avg test loss is  1.4416627206527857
avg accuracy is  0.8414333334896569
solo acc is  0.2469666668230048
compute similarity  is  tensor(0.9524, device='cuda:0')
compute_distance is  tensor(12.2190, device='cuda:0')
compute_norm is  tensor(54.6815, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.9556, device='cuda:0')
distance 2 is tensor(12.2884, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8505273468331742
avg test loss is  1.4275012879229303
avg accuracy is  0.8422500001563236
solo acc is  0.24640000015633812
compute similarity  is  tensor(0.9524, device='cuda:0')
compute_distance is  tensor(12.2884, device='cuda:0')
compute_norm is  tensor(54.4007, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.4783, device='cuda:0')
distance 2 is tensor(12.3585, device='cuda:0')
________________________________
test distance is  tensor(12.3585, device='cuda:0')
test similarity is  tensor(0.9523, device='cuda:0')
test acc is  0.8432333334896568
test loss is 1.4181813870920048
test entropy is  0.848191948841884
________________________________
cal ratio is  0.8889224584063627
distance 1 is tensor(131.0975, device='cuda:0')
distance 2 is tensor(10.9857, device='cuda:0')
cal_distance is  tensor(10.9857, device='cuda:0')
distance 1 is tensor(131.0975, device='cuda:0')
distance 2 is tensor(10.9857, device='cuda:0')
________________________________
test distance is  tensor(10.9857, device='cuda:0')
test similarity is  tensor(0.9616, device='cuda:0')
test acc is  0.8554000001563231
test loss is 1.0860848348023795
test entropy is  0.943026691166831
________________________________
distance 1 is tensor(131.0975, device='cuda:0')
distance 2 is tensor(10.9857, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9433415542279225
avg test loss is  1.0900198770230258
avg accuracy is  0.8547500001563231
solo acc is  0.46008333348967506
compute similarity  is  tensor(0.9616, device='cuda:0')
compute_distance is  tensor(10.9857, device='cuda:0')
compute_norm is  tensor(53.7881, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.4115, device='cuda:0')
distance 2 is tensor(11.1744, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8449335170707215
avg test loss is  1.3801617253817984
avg accuracy is  0.8489833334896566
solo acc is  0.2538333334896717
compute similarity  is  tensor(0.9614, device='cuda:0')
compute_distance is  tensor(11.1744, device='cuda:0')
compute_norm is  tensor(53.5168, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.3132, device='cuda:0')
distance 2 is tensor(11.2682, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.847799261813479
avg test loss is  1.3694226003404875
avg accuracy is  0.8518666668229897
solo acc is  0.25010000015633815
compute similarity  is  tensor(0.9613, device='cuda:0')
compute_distance is  tensor(11.2682, device='cuda:0')
compute_norm is  tensor(53.2474, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.2000, device='cuda:0')
distance 2 is tensor(11.3559, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8380111457188246
avg test loss is  1.3799343386184433
avg accuracy is  0.8533166668229898
solo acc is  0.2398166668230046
compute similarity  is  tensor(0.9612, device='cuda:0')
compute_distance is  tensor(11.3559, device='cuda:0')
compute_norm is  tensor(52.9834, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.0851, device='cuda:0')
distance 2 is tensor(11.4313, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8375682114029744
avg test loss is  1.3625752158256481
avg accuracy is  0.8541166668229898
solo acc is  0.2410000001563379
compute similarity  is  tensor(0.9612, device='cuda:0')
compute_distance is  tensor(11.4313, device='cuda:0')
compute_norm is  tensor(52.7218, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.0065, device='cuda:0')
distance 2 is tensor(11.5151, device='cuda:0')
________________________________
test distance is  tensor(11.5151, device='cuda:0')
test similarity is  tensor(0.9611, device='cuda:0')
test acc is  0.8539833334896564
test loss is 1.3541231263420983
test entropy is  0.8408949376423476
________________________________
distance 1 is tensor(136.0065, device='cuda:0')
distance 2 is tensor(11.5151, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8403308915812323
avg test loss is  1.3530131733493764
avg accuracy is  0.8549333334896564
solo acc is  0.2371666668230045
compute similarity  is  tensor(0.9611, device='cuda:0')
compute_distance is  tensor(11.5151, device='cuda:0')
compute_norm is  tensor(52.4635, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.9649, device='cuda:0')
distance 2 is tensor(11.5942, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8245717811940322
avg test loss is  1.362140444105368
avg accuracy is  0.8540666668229898
solo acc is  0.2359833334896711
compute similarity  is  tensor(0.9610, device='cuda:0')
compute_distance is  tensor(11.5942, device='cuda:0')
compute_norm is  tensor(52.2096, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.9927, device='cuda:0')
distance 2 is tensor(11.6749, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8265851156543821
avg test loss is  1.3488317332796451
avg accuracy is  0.8558666668229897
solo acc is  0.23028333348967098
compute similarity  is  tensor(0.9610, device='cuda:0')
compute_distance is  tensor(11.6749, device='cuda:0')
compute_norm is  tensor(51.9564, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.0063, device='cuda:0')
distance 2 is tensor(11.7535, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8296320402164703
avg test loss is  1.332009493669213
avg accuracy is  0.857150000156323
solo acc is  0.2342333334896711
compute similarity  is  tensor(0.9609, device='cuda:0')
compute_distance is  tensor(11.7535, device='cuda:0')
compute_norm is  tensor(51.7054, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.0845, device='cuda:0')
distance 2 is tensor(11.8379, device='cuda:0')
exit early
distance 1 is tensor(140.0845, device='cuda:0')
distance 2 is tensor(11.8379, device='cuda:0')
________________________________
test distance is  tensor(11.8379, device='cuda:0')
test similarity is  tensor(0.9608, device='cuda:0')
test acc is  0.857900000156323
test loss is 1.332491710750279
test entropy is  0.8288314222399868
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2113533020019531
mal norm is  tensor(6.4511, device='cuda:0')
distance 1 is tensor(140.0845, device='cuda:0')
distance 2 is tensor(11.8379, device='cuda:0')
mal distance is  tensor(11.8379, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1803, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(518.6246, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.4957, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(431.5603, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.7840e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.0411, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.9637e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.4126, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.8102, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.0052, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.8104, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.3085e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1130, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.5884, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.1692, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.8734e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.9128, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.3066e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.6996, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7523e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.6403, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.7256e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8033, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.8440e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.9966, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.6133, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.4667, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.9087e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.4510, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.4544e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.9836, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.3002, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.8190, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.0110e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.6984, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.2623, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6721e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.7908, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.3039, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.3004, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.0300, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.8934e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.3333, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.7213e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.1215, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.0926, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.0253, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.3251e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.1710, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.6309, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.1208e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.3756, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.1017e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.9522, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.3332, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.3044, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.8120, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.4695, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.6664e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.5302, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
len accept list 9
len all weights is 9
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 91.10% 

Test Accuracy: 89.39% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2615012526512146
distance 1 is tensor(121.3889, device='cuda:0')
distance 2 is tensor(8.9145, device='cuda:0')
benign distance is  tensor(8.9145, device='cuda:0')
norm1 res is  tensor(0.1305, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.30595144629478455
distance 1 is tensor(111.2175, device='cuda:0')
distance 2 is tensor(8.1375, device='cuda:0')
benign distance is  tensor(8.1375, device='cuda:0')
norm1 res is  tensor(0.1179, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8890800476074219
distance 1 is tensor(102.9671, device='cuda:0')
distance 2 is tensor(7.8303, device='cuda:0')
benign distance is  tensor(7.8303, device='cuda:0')
norm1 res is  tensor(0.1103, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.28298714756965637
distance 1 is tensor(118.2276, device='cuda:0')
distance 2 is tensor(8.7297, device='cuda:0')
benign distance is  tensor(8.7297, device='cuda:0')
norm1 res is  tensor(0.1278, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7509528398513794
distance 1 is tensor(117.8629, device='cuda:0')
distance 2 is tensor(8.6656, device='cuda:0')
benign distance is  tensor(8.6656, device='cuda:0')
norm1 res is  tensor(0.1244, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6244417428970337
distance 1 is tensor(133.2132, device='cuda:0')
distance 2 is tensor(9.7312, device='cuda:0')
benign distance is  tensor(9.7312, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.25929927825927734
distance 1 is tensor(118.0582, device='cuda:0')
distance 2 is tensor(8.6887, device='cuda:0')
benign distance is  tensor(8.6887, device='cuda:0')
norm1 res is  tensor(0.1234, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.23387761414051056
distance 1 is tensor(113.2348, device='cuda:0')
distance 2 is tensor(8.3237, device='cuda:0')
benign distance is  tensor(8.3237, device='cuda:0')
norm1 res is  tensor(0.1228, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.3560142517089844
distance 1 is tensor(138.0039, device='cuda:0')
distance 2 is tensor(10.0108, device='cuda:0')
benign distance is  tensor(10.0108, device='cuda:0')
norm1 res is  tensor(0.1485, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8818763494491577
distance 1 is tensor(122.2053, device='cuda:0')
distance 2 is tensor(9.0028, device='cuda:0')
benign distance is  tensor(9.0028, device='cuda:0')
norm1 res is  tensor(0.1309, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6332350969314575
distance 1 is tensor(126.3065, device='cuda:0')
distance 2 is tensor(9.3003, device='cuda:0')
benign distance is  tensor(9.3003, device='cuda:0')
norm1 res is  tensor(0.1347, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.6593778729438782
distance 1 is tensor(131.0043, device='cuda:0')
distance 2 is tensor(9.7449, device='cuda:0')
benign distance is  tensor(9.7449, device='cuda:0')
norm1 res is  tensor(0.1420, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.598235011100769
distance 1 is tensor(129.6259, device='cuda:0')
distance 2 is tensor(9.4409, device='cuda:0')
benign distance is  tensor(9.4409, device='cuda:0')
norm1 res is  tensor(0.1380, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.4638407826423645
distance 1 is tensor(123.2502, device='cuda:0')
distance 2 is tensor(9.1158, device='cuda:0')
benign distance is  tensor(9.1158, device='cuda:0')
norm1 res is  tensor(0.1316, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.575986385345459
distance 1 is tensor(128.5878, device='cuda:0')
distance 2 is tensor(9.4377, device='cuda:0')
benign distance is  tensor(9.4377, device='cuda:0')
norm1 res is  tensor(0.1370, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.631426990032196
distance 1 is tensor(140.6562, device='cuda:0')
distance 2 is tensor(10.2540, device='cuda:0')
benign distance is  tensor(10.2540, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.02270382270216942
distance 1 is tensor(114.4627, device='cuda:0')
distance 2 is tensor(8.5317, device='cuda:0')
benign distance is  tensor(8.5317, device='cuda:0')
norm1 res is  tensor(0.1241, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.6977945566177368
distance 1 is tensor(139.9553, device='cuda:0')
distance 2 is tensor(10.3318, device='cuda:0')
benign distance is  tensor(10.3318, device='cuda:0')
norm1 res is  tensor(0.1492, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.3744591474533081
distance 1 is tensor(131.0077, device='cuda:0')
distance 2 is tensor(9.6616, device='cuda:0')
benign distance is  tensor(9.6616, device='cuda:0')
norm1 res is  tensor(0.1393, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.27239394187927246
distance 1 is tensor(124.5367, device='cuda:0')
distance 2 is tensor(9.2354, device='cuda:0')
benign distance is  tensor(9.2354, device='cuda:0')
norm1 res is  tensor(0.1343, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.565468430519104
distance 1 is tensor(141.3835, device='cuda:0')
distance 2 is tensor(10.7490, device='cuda:0')
benign distance is  tensor(10.7490, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.3745962381362915
distance 1 is tensor(133.1102, device='cuda:0')
distance 2 is tensor(9.8137, device='cuda:0')
benign distance is  tensor(9.8137, device='cuda:0')
norm1 res is  tensor(0.1419, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.4734838008880615
distance 1 is tensor(136.0391, device='cuda:0')
distance 2 is tensor(10.0517, device='cuda:0')
benign distance is  tensor(10.0517, device='cuda:0')
norm1 res is  tensor(0.1452, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.0206191539764404
distance 1 is tensor(143.6024, device='cuda:0')
distance 2 is tensor(10.4084, device='cuda:0')
benign distance is  tensor(10.4084, device='cuda:0')
norm1 res is  tensor(0.1518, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.4160689413547516
distance 1 is tensor(124.5564, device='cuda:0')
distance 2 is tensor(9.1456, device='cuda:0')
benign distance is  tensor(9.1456, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.7155710458755493
distance 1 is tensor(129.5361, device='cuda:0')
distance 2 is tensor(9.3794, device='cuda:0')
benign distance is  tensor(9.3794, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.3114546239376068
distance 1 is tensor(141.3000, device='cuda:0')
distance 2 is tensor(10.3699, device='cuda:0')
benign distance is  tensor(10.3699, device='cuda:0')
norm1 res is  tensor(0.1487, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.5612722039222717
distance 1 is tensor(141.4843, device='cuda:0')
distance 2 is tensor(10.3625, device='cuda:0')
benign distance is  tensor(10.3625, device='cuda:0')
norm1 res is  tensor(0.1506, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.1084238290786743
distance 1 is tensor(121.6697, device='cuda:0')
distance 2 is tensor(8.9345, device='cuda:0')
benign distance is  tensor(8.9345, device='cuda:0')
norm1 res is  tensor(0.1282, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.17144599556922913
distance 1 is tensor(133.7067, device='cuda:0')
distance 2 is tensor(9.7885, device='cuda:0')
benign distance is  tensor(9.7885, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.283224880695343
distance 1 is tensor(128.9297, device='cuda:0')
distance 2 is tensor(9.4171, device='cuda:0')
benign distance is  tensor(9.4171, device='cuda:0')
norm1 res is  tensor(0.1364, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.3297501802444458
distance 1 is tensor(128.6828, device='cuda:0')
distance 2 is tensor(9.5531, device='cuda:0')
benign distance is  tensor(9.5531, device='cuda:0')
norm1 res is  tensor(0.1392, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.1692960560321808
distance 1 is tensor(136.1735, device='cuda:0')
distance 2 is tensor(10.0665, device='cuda:0')
benign distance is  tensor(10.0665, device='cuda:0')
norm1 res is  tensor(0.1431, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.11802756786346436
distance 1 is tensor(128.1295, device='cuda:0')
distance 2 is tensor(9.4129, device='cuda:0')
benign distance is  tensor(9.4129, device='cuda:0')
norm1 res is  tensor(0.1372, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.024163702502846718
distance 1 is tensor(120.7556, device='cuda:0')
distance 2 is tensor(8.9127, device='cuda:0')
benign distance is  tensor(8.9127, device='cuda:0')
norm1 res is  tensor(0.1300, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.7590834498405457
distance 1 is tensor(134.7544, device='cuda:0')
distance 2 is tensor(10.0219, device='cuda:0')
benign distance is  tensor(10.0219, device='cuda:0')
norm1 res is  tensor(0.1473, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.41310930252075195
distance 1 is tensor(128.3844, device='cuda:0')
distance 2 is tensor(9.5468, device='cuda:0')
benign distance is  tensor(9.5468, device='cuda:0')
norm1 res is  tensor(0.1397, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.2616255581378937
distance 1 is tensor(142.8033, device='cuda:0')
distance 2 is tensor(10.4896, device='cuda:0')
benign distance is  tensor(10.4896, device='cuda:0')
norm1 res is  tensor(0.1548, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.765618622303009
distance 1 is tensor(129.2308, device='cuda:0')
distance 2 is tensor(9.4871, device='cuda:0')
benign distance is  tensor(9.4871, device='cuda:0')
norm1 res is  tensor(0.1366, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.3714565932750702
distance 1 is tensor(124.9012, device='cuda:0')
distance 2 is tensor(9.2145, device='cuda:0')
benign distance is  tensor(9.2145, device='cuda:0')
norm1 res is  tensor(0.1349, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(155.6265, device='cuda:0')
distance 2 is tensor(11.4798, device='cuda:0')
compute distance is  tensor(11.4798, device='cuda:0')
compute norm is  tensor(52.8438, device='cuda:0')
distance 1 is tensor(172.6432, device='cuda:0')
distance 2 is tensor(12.7598, device='cuda:0')
compute distance is  tensor(12.7598, device='cuda:0')
compute norm is  tensor(53.4039, device='cuda:0')
distance 1 is tensor(169.2392, device='cuda:0')
distance 2 is tensor(12.4670, device='cuda:0')
compute distance is  tensor(12.4670, device='cuda:0')
compute norm is  tensor(53.3303, device='cuda:0')
distance 1 is tensor(160.8152, device='cuda:0')
distance 2 is tensor(11.8433, device='cuda:0')
compute distance is  tensor(11.8433, device='cuda:0')
compute norm is  tensor(53.0010, device='cuda:0')
distance 1 is tensor(167.3402, device='cuda:0')
distance 2 is tensor(12.3016, device='cuda:0')
compute distance is  tensor(12.3016, device='cuda:0')
compute norm is  tensor(53.1935, device='cuda:0')
distance 1 is tensor(169.9955, device='cuda:0')
distance 2 is tensor(12.4903, device='cuda:0')
compute distance is  tensor(12.4903, device='cuda:0')
compute norm is  tensor(53.5142, device='cuda:0')
distance 1 is tensor(163.7400, device='cuda:0')
distance 2 is tensor(12.2545, device='cuda:0')
compute distance is  tensor(12.2545, device='cuda:0')
compute norm is  tensor(53.0886, device='cuda:0')
distance 1 is tensor(168.5217, device='cuda:0')
distance 2 is tensor(12.2168, device='cuda:0')
compute distance is  tensor(12.2168, device='cuda:0')
compute norm is  tensor(53.0464, device='cuda:0')
distance 1 is tensor(174.1929, device='cuda:0')
distance 2 is tensor(12.7646, device='cuda:0')
compute distance is  tensor(12.7646, device='cuda:0')
compute norm is  tensor(53.4272, device='cuda:0')
distance 1 is tensor(165.0778, device='cuda:0')
distance 2 is tensor(12.1809, device='cuda:0')
compute distance is  tensor(12.1809, device='cuda:0')
compute norm is  tensor(53.1085, device='cuda:0')
distance 1 is tensor(164.5746, device='cuda:0')
distance 2 is tensor(12.0465, device='cuda:0')
compute distance is  tensor(12.0465, device='cuda:0')
compute norm is  tensor(53.1007, device='cuda:0')
distance 1 is tensor(167.5469, device='cuda:0')
distance 2 is tensor(12.3565, device='cuda:0')
compute distance is  tensor(12.3565, device='cuda:0')
compute norm is  tensor(53.2021, device='cuda:0')
distance Threshold  is  tensor(12.7646, device='cuda:0')
distance 1 is tensor(1102019.6250, device='cuda:0')
distance 2 is tensor(79390.2344, device='cuda:0')
________________________________
test distance is  tensor(79390.2344, device='cuda:0')
test similarity is  tensor(0.1090, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.193692904409554e+17
test entropy is  0.0
________________________________
cal ratio is  0.011412002377469156
distance 1 is tensor(12576.2549, device='cuda:0')
distance 2 is tensor(906.0015, device='cuda:0')
cal_distance is  tensor(906.0015, device='cuda:0')
cal ratio is  0.10682697964690763
distance 1 is tensor(1343.4899, device='cuda:0')
distance 2 is tensor(96.7854, device='cuda:0')
cal_distance is  tensor(96.7854, device='cuda:0')
cal ratio is  0.32684396336584354
distance 1 is tensor(439.1164, device='cuda:0')
distance 2 is tensor(31.6337, device='cuda:0')
cal_distance is  tensor(31.6337, device='cuda:0')
cal ratio is  0.5717026959042077
distance 1 is tensor(251.0471, device='cuda:0')
distance 2 is tensor(18.0851, device='cuda:0')
cal_distance is  tensor(18.0851, device='cuda:0')
cal ratio is  0.7561102304477626
distance 1 is tensor(189.8211, device='cuda:0')
distance 2 is tensor(13.6743, device='cuda:0')
cal_distance is  tensor(13.6743, device='cuda:0')
cal ratio is  0.8695459606232131
distance 1 is tensor(165.0591, device='cuda:0')
distance 2 is tensor(11.8904, device='cuda:0')
cal_distance is  tensor(11.8904, device='cuda:0')
distance 1 is tensor(165.0591, device='cuda:0')
distance 2 is tensor(11.8904, device='cuda:0')
________________________________
test distance is  tensor(11.8904, device='cuda:0')
test similarity is  tensor(0.9449, device='cuda:0')
test acc is  0.8453333334896567
test loss is 75.81688545405991
test entropy is  0.004470689291327794
________________________________
distance 1 is tensor(165.0591, device='cuda:0')
distance 2 is tensor(11.8904, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.004528321606598554
avg test loss is  75.63750536660396
avg accuracy is  0.8419500001563236
solo acc is  0.11696666682299858
compute similarity  is  tensor(0.9449, device='cuda:0')
compute_distance is  tensor(11.8904, device='cuda:0')
compute_norm is  tensor(56.0823, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(153.7871, device='cuda:0')
distance 2 is tensor(12.7710, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9097751792051645
avg test loss is  1.3769205488375764
avg accuracy is  0.8523333334896565
solo acc is  0.3242166668230067
compute similarity  is  tensor(0.9459, device='cuda:0')
compute_distance is  tensor(12.7710, device='cuda:0')
compute_norm is  tensor(55.3772, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.4144, device='cuda:0')
distance 2 is tensor(12.9325, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8661297700806722
avg test loss is  1.4709491273487554
avg accuracy is  0.8507666668229897
solo acc is  0.2575500001563385
compute similarity  is  tensor(0.9458, device='cuda:0')
compute_distance is  tensor(12.9325, device='cuda:0')
compute_norm is  tensor(55.0684, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.0266, device='cuda:0')
distance 2 is tensor(13.0431, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8592050046300583
avg test loss is  1.4601249921042274
avg accuracy is  0.8515666668229898
solo acc is  0.2504666668230049
compute similarity  is  tensor(0.9457, device='cuda:0')
compute_distance is  tensor(13.0431, device='cuda:0')
compute_norm is  tensor(54.7734, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.6018, device='cuda:0')
distance 2 is tensor(13.1350, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8607756116751161
avg test loss is  1.4245351273367908
avg accuracy is  0.8521000001563233
solo acc is  0.25593333348967184
compute similarity  is  tensor(0.9456, device='cuda:0')
compute_distance is  tensor(13.1350, device='cuda:0')
compute_norm is  tensor(54.4884, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.2835, device='cuda:0')
distance 2 is tensor(13.2228, device='cuda:0')
________________________________
test distance is  tensor(13.2228, device='cuda:0')
test similarity is  tensor(0.9456, device='cuda:0')
test acc is  0.8530333334896565
test loss is 1.4151529686283202
test entropy is  0.8618577214192226
________________________________
cal ratio is  0.8842669131139331
distance 1 is tensor(138.1971, device='cuda:0')
distance 2 is tensor(11.6925, device='cuda:0')
cal_distance is  tensor(11.6925, device='cuda:0')
distance 1 is tensor(138.1971, device='cuda:0')
distance 2 is tensor(11.6925, device='cuda:0')
________________________________
test distance is  tensor(11.6925, device='cuda:0')
test similarity is  tensor(0.9566, device='cuda:0')
test acc is  0.8649166668229893
test loss is 1.050405870876841
test entropy is  0.9593630239272168
________________________________
distance 1 is tensor(138.1971, device='cuda:0')
distance 2 is tensor(11.6925, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9613733025374951
avg test loss is  1.0527971073635605
avg accuracy is  0.8645833334896561
solo acc is  0.5011166668230087
compute similarity  is  tensor(0.9566, device='cuda:0')
compute_distance is  tensor(11.6925, device='cuda:0')
compute_norm is  tensor(53.8582, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.8374, device='cuda:0')
distance 2 is tensor(11.9316, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.853507803447211
avg test loss is  1.394880381982718
avg accuracy is  0.8619333334896562
solo acc is  0.25366666682300504
compute similarity  is  tensor(0.9562, device='cuda:0')
compute_distance is  tensor(11.9316, device='cuda:0')
compute_norm is  tensor(53.5838, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.8773, device='cuda:0')
distance 2 is tensor(12.0376, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.851325600513263
avg test loss is  1.3851986969711938
avg accuracy is  0.8631500001563227
solo acc is  0.2468166668230048
compute similarity  is  tensor(0.9561, device='cuda:0')
compute_distance is  tensor(12.0376, device='cuda:0')
compute_norm is  tensor(53.3118, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.8823, device='cuda:0')
distance 2 is tensor(12.1375, device='cuda:0')
exit early
distance 1 is tensor(141.8823, device='cuda:0')
distance 2 is tensor(12.1375, device='cuda:0')
________________________________
test distance is  tensor(12.1375, device='cuda:0')
test similarity is  tensor(0.9560, device='cuda:0')
test acc is  0.8634833334896561
test loss is 1.3829773578054108
test entropy is  0.845947585253319
________________________________
distance 1 is tensor(141.8823, device='cuda:0')
distance 2 is tensor(12.1375, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8462299811941728
avg test loss is  1.38485494160703
avg accuracy is  0.8647666668229893
solo acc is  0.23891666682300455
compute similarity  is  tensor(0.9560, device='cuda:0')
compute_distance is  tensor(12.1375, device='cuda:0')
compute_norm is  tensor(53.0449, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.8887, device='cuda:0')
distance 2 is tensor(12.2251, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8429952721987197
avg test loss is  1.3595708921265754
avg accuracy is  0.864833333489656
solo acc is  0.2511500001563383
compute similarity  is  tensor(0.9559, device='cuda:0')
compute_distance is  tensor(12.2251, device='cuda:0')
compute_norm is  tensor(52.7815, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.9323, device='cuda:0')
distance 2 is tensor(12.3203, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.833734059892992
avg test loss is  1.372402188874511
avg accuracy is  0.8668666668229893
solo acc is  0.23625000015633776
compute similarity  is  tensor(0.9558, device='cuda:0')
compute_distance is  tensor(12.3203, device='cuda:0')
compute_norm is  tensor(52.5210, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.9664, device='cuda:0')
distance 2 is tensor(12.4045, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8307473562292452
avg test loss is  1.3609215720121794
avg accuracy is  0.8700833334896558
solo acc is  0.2378333334896712
compute similarity  is  tensor(0.9557, device='cuda:0')
compute_distance is  tensor(12.4045, device='cuda:0')
compute_norm is  tensor(52.2631, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.0143, device='cuda:0')
distance 2 is tensor(12.4897, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8340377081304725
avg test loss is  1.3473780654005405
avg accuracy is  0.8699500001563225
solo acc is  0.2353500001563378
compute similarity  is  tensor(0.9556, device='cuda:0')
compute_distance is  tensor(12.4897, device='cuda:0')
compute_norm is  tensor(52.0083, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.1220, device='cuda:0')
distance 2 is tensor(12.5777, device='cuda:0')
________________________________
test distance is  tensor(12.5777, device='cuda:0')
test similarity is  tensor(0.9555, device='cuda:0')
test acc is  0.8700500001563225
test loss is 1.3397804207639146
test entropy is  0.829903921974239
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.296689748764038
mal norm is  tensor(6.8839, device='cuda:0')
distance 1 is tensor(147.1220, device='cuda:0')
distance 2 is tensor(12.5777, device='cuda:0')
mal distance is  tensor(12.5777, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1524, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.9382, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6264e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(464.3736, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9676e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(436.7173, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.1279, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7023e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(493.7689, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.1838, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.2681, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(472.3882, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.2949e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.3862, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4736e-05, device='cuda:0')
len accept list 2
len all weights is 2
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 90.65% 

Test Accuracy: 89.21% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1258809119462967
distance 1 is tensor(124.3662, device='cuda:0')
distance 2 is tensor(9.2458, device='cuda:0')
benign distance is  tensor(9.2458, device='cuda:0')
norm1 res is  tensor(0.1342, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7407904863357544
distance 1 is tensor(118.5863, device='cuda:0')
distance 2 is tensor(8.7003, device='cuda:0')
benign distance is  tensor(8.7003, device='cuda:0')
norm1 res is  tensor(0.1279, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.005427083931863308
distance 1 is tensor(76.4859, device='cuda:0')
distance 2 is tensor(5.6673, device='cuda:0')
benign distance is  tensor(5.6673, device='cuda:0')
norm1 res is  tensor(0.0791, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.22174367308616638
distance 1 is tensor(153.2662, device='cuda:0')
distance 2 is tensor(11.0262, device='cuda:0')
benign distance is  tensor(11.0262, device='cuda:0')
norm1 res is  tensor(0.1650, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.49542346596717834
distance 1 is tensor(130.5173, device='cuda:0')
distance 2 is tensor(9.6253, device='cuda:0')
benign distance is  tensor(9.6253, device='cuda:0')
norm1 res is  tensor(0.1380, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6470673084259033
distance 1 is tensor(148.2967, device='cuda:0')
distance 2 is tensor(11.0154, device='cuda:0')
benign distance is  tensor(11.0154, device='cuda:0')
norm1 res is  tensor(0.1613, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.7012720704078674
distance 1 is tensor(123.2061, device='cuda:0')
distance 2 is tensor(8.9766, device='cuda:0')
benign distance is  tensor(8.9766, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.1971142590045929
distance 1 is tensor(123.2241, device='cuda:0')
distance 2 is tensor(9.0703, device='cuda:0')
benign distance is  tensor(9.0703, device='cuda:0')
norm1 res is  tensor(0.1328, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(149.0528, device='cuda:0')
distance 2 is tensor(10.9967, device='cuda:0')
compute distance is  tensor(10.9967, device='cuda:0')
compute norm is  tensor(53.4441, device='cuda:0')
distance 1 is tensor(154.3969, device='cuda:0')
distance 2 is tensor(11.2985, device='cuda:0')
compute distance is  tensor(11.2985, device='cuda:0')
compute norm is  tensor(53.7279, device='cuda:0')
distance 1 is tensor(158.2040, device='cuda:0')
distance 2 is tensor(11.5892, device='cuda:0')
compute distance is  tensor(11.5892, device='cuda:0')
compute norm is  tensor(53.7720, device='cuda:0')
distance 1 is tensor(148.8409, device='cuda:0')
distance 2 is tensor(10.8551, device='cuda:0')
compute distance is  tensor(10.8551, device='cuda:0')
compute norm is  tensor(53.4663, device='cuda:0')
distance 1 is tensor(156.0555, device='cuda:0')
distance 2 is tensor(11.5510, device='cuda:0')
compute distance is  tensor(11.5510, device='cuda:0')
compute norm is  tensor(53.8399, device='cuda:0')
distance 1 is tensor(152.7548, device='cuda:0')
distance 2 is tensor(11.1473, device='cuda:0')
compute distance is  tensor(11.1473, device='cuda:0')
compute norm is  tensor(53.6115, device='cuda:0')
distance 1 is tensor(153.8117, device='cuda:0')
distance 2 is tensor(11.2925, device='cuda:0')
compute distance is  tensor(11.2925, device='cuda:0')
compute norm is  tensor(53.7362, device='cuda:0')
distance 1 is tensor(162.0983, device='cuda:0')
distance 2 is tensor(11.7963, device='cuda:0')
compute distance is  tensor(11.7963, device='cuda:0')
compute norm is  tensor(53.7220, device='cuda:0')
distance 1 is tensor(157.1609, device='cuda:0')
distance 2 is tensor(11.4644, device='cuda:0')
compute distance is  tensor(11.4644, device='cuda:0')
compute norm is  tensor(53.7969, device='cuda:0')
distance 1 is tensor(151.4787, device='cuda:0')
distance 2 is tensor(11.0699, device='cuda:0')
compute distance is  tensor(11.0699, device='cuda:0')
compute norm is  tensor(53.5919, device='cuda:0')
distance 1 is tensor(149.4064, device='cuda:0')
distance 2 is tensor(10.9594, device='cuda:0')
compute distance is  tensor(10.9594, device='cuda:0')
compute norm is  tensor(53.5983, device='cuda:0')
distance 1 is tensor(158.5067, device='cuda:0')
distance 2 is tensor(11.5096, device='cuda:0')
compute distance is  tensor(11.5096, device='cuda:0')
compute norm is  tensor(53.8329, device='cuda:0')
distance Threshold  is  tensor(11.7963, device='cuda:0')
distance 1 is tensor(1102023.1250, device='cuda:0')
distance 2 is tensor(79390.5469, device='cuda:0')
________________________________
test distance is  tensor(79390.5469, device='cuda:0')
test similarity is  tensor(0.0972, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197907631826135e+17
test entropy is  0.0
________________________________
cal ratio is  0.010970610402075594
distance 1 is tensor(12089.8711, device='cuda:0')
distance 2 is tensor(870.9628, device='cuda:0')
cal_distance is  tensor(870.9628, device='cuda:0')
cal ratio is  0.10474068159112165
distance 1 is tensor(1266.3080, device='cuda:0')
distance 2 is tensor(91.2252, device='cuda:0')
cal_distance is  tensor(91.2252, device='cuda:0')
cal ratio is  0.32363664052721763
distance 1 is tensor(409.8285, device='cuda:0')
distance 2 is tensor(29.5238, device='cuda:0')
cal_distance is  tensor(29.5238, device='cuda:0')
cal ratio is  0.5688907200307866
distance 1 is tensor(233.1508, device='cuda:0')
distance 2 is tensor(16.7958, device='cuda:0')
cal_distance is  tensor(16.7958, device='cuda:0')
cal ratio is  0.7542484807235291
distance 1 is tensor(175.8554, device='cuda:0')
distance 2 is tensor(12.6682, device='cuda:0')
cal_distance is  tensor(12.6682, device='cuda:0')
cal ratio is  0.8684747626981255
distance 1 is tensor(152.7269, device='cuda:0')
distance 2 is tensor(11.0020, device='cuda:0')
cal_distance is  tensor(11.0020, device='cuda:0')
distance 1 is tensor(152.7269, device='cuda:0')
distance 2 is tensor(11.0020, device='cuda:0')
________________________________
test distance is  tensor(11.0020, device='cuda:0')
test similarity is  tensor(0.9528, device='cuda:0')
test acc is  0.8542000001563231
test loss is 53.75389560300913
test entropy is  0.014513747055843525
________________________________
distance 1 is tensor(152.7269, device='cuda:0')
distance 2 is tensor(11.0020, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.015474213693390351
avg test loss is  53.643510781879876
avg accuracy is  0.8536666668229898
solo acc is  0.16298333348966754
compute similarity  is  tensor(0.9528, device='cuda:0')
compute_distance is  tensor(11.0020, device='cuda:0')
compute_norm is  tensor(56.1819, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(144.1933, device='cuda:0')
distance 2 is tensor(12.1116, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9016791900464975
avg test loss is  1.3971155453592474
avg accuracy is  0.8556166668229898
solo acc is  0.31896666682300656
compute similarity  is  tensor(0.9530, device='cuda:0')
compute_distance is  tensor(12.1116, device='cuda:0')
compute_norm is  tensor(55.3798, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.1827, device='cuda:0')
distance 2 is tensor(12.2963, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.868524442730682
avg test loss is  1.4633075508481659
avg accuracy is  0.8551833334896565
solo acc is  0.26238333348967197
compute similarity  is  tensor(0.9528, device='cuda:0')
compute_distance is  tensor(12.2963, device='cuda:0')
compute_norm is  tensor(55.0629, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.0348, device='cuda:0')
distance 2 is tensor(12.4313, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8729409584994001
avg test loss is  1.4370388210709415
avg accuracy is  0.8566333334896563
solo acc is  0.2567166668230051
compute similarity  is  tensor(0.9527, device='cuda:0')
compute_distance is  tensor(12.4313, device='cuda:0')
compute_norm is  tensor(54.7656, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.8692, device='cuda:0')
distance 2 is tensor(12.5425, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8605120308490705
avg test loss is  1.4247011119114565
avg accuracy is  0.8581000001563229
solo acc is  0.25343333348967173
compute similarity  is  tensor(0.9526, device='cuda:0')
compute_distance is  tensor(12.5425, device='cuda:0')
compute_norm is  tensor(54.4778, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.6877, device='cuda:0')
distance 2 is tensor(12.6420, device='cuda:0')
________________________________
test distance is  tensor(12.6420, device='cuda:0')
test similarity is  tensor(0.9525, device='cuda:0')
test acc is  0.8600666668229895
test loss is 1.4043678374432806
test entropy is  0.8579657459691135
________________________________
cal ratio is  0.8693744332937647
distance 1 is tensor(128.3967, device='cuda:0')
distance 2 is tensor(10.9907, device='cuda:0')
cal_distance is  tensor(10.9907, device='cuda:0')
distance 1 is tensor(128.3967, device='cuda:0')
distance 2 is tensor(10.9907, device='cuda:0')
________________________________
test distance is  tensor(10.9907, device='cuda:0')
test similarity is  tensor(0.9635, device='cuda:0')
test acc is  0.8735500001563223
test loss is 0.995081999090943
test entropy is  0.9459704603594757
________________________________
distance 1 is tensor(128.3967, device='cuda:0')
distance 2 is tensor(10.9907, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9472525740610257
avg test loss is  0.9949572567365317
avg accuracy is  0.8722500001563224
solo acc is  0.5493000001563422
compute similarity  is  tensor(0.9635, device='cuda:0')
compute_distance is  tensor(10.9907, device='cuda:0')
compute_norm is  tensor(53.9009, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.5684, device='cuda:0')
distance 2 is tensor(11.2995, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8424850738506073
avg test loss is  1.3879231754650694
avg accuracy is  0.8692333334896558
solo acc is  0.2579166668230051
compute similarity  is  tensor(0.9629, device='cuda:0')
compute_distance is  tensor(11.2995, device='cuda:0')
compute_norm is  tensor(53.6190, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.8929, device='cuda:0')
distance 2 is tensor(11.4373, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8462821794852519
avg test loss is  1.378516630069025
avg accuracy is  0.8693666668229891
solo acc is  0.2522000001563383
compute similarity  is  tensor(0.9627, device='cuda:0')
compute_distance is  tensor(11.4373, device='cuda:0')
compute_norm is  tensor(53.3427, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.1322, device='cuda:0')
distance 2 is tensor(11.5526, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8417858536055347
avg test loss is  1.365318912242267
avg accuracy is  0.8704500001563223
solo acc is  0.25315000015633826
compute similarity  is  tensor(0.9626, device='cuda:0')
compute_distance is  tensor(11.5526, device='cuda:0')
compute_norm is  tensor(53.0715, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.3294, device='cuda:0')
distance 2 is tensor(11.6636, device='cuda:0')
exit early
distance 1 is tensor(134.3294, device='cuda:0')
distance 2 is tensor(11.6636, device='cuda:0')
________________________________
test distance is  tensor(11.6636, device='cuda:0')
test similarity is  tensor(0.9624, device='cuda:0')
test acc is  0.8728166668229891
test loss is 1.3662968056161267
test entropy is  0.8359267003119373
________________________________
distance 1 is tensor(134.3294, device='cuda:0')
distance 2 is tensor(11.6636, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8345674702099392
avg test loss is  1.3697254657745361
avg accuracy is  0.8709166668229891
solo acc is  0.24150000015633794
compute similarity  is  tensor(0.9624, device='cuda:0')
compute_distance is  tensor(11.6636, device='cuda:0')
compute_norm is  tensor(52.8068, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.4965, device='cuda:0')
distance 2 is tensor(11.7650, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8308899936391346
avg test loss is  1.3542972271884683
avg accuracy is  0.8747666668229889
solo acc is  0.24376666682300474
compute similarity  is  tensor(0.9623, device='cuda:0')
compute_distance is  tensor(11.7650, device='cuda:0')
compute_norm is  tensor(52.5453, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.7474, device='cuda:0')
distance 2 is tensor(11.8675, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8334946127207294
avg test loss is  1.339255486533586
avg accuracy is  0.8756833334896555
solo acc is  0.24378333348967132
compute similarity  is  tensor(0.9622, device='cuda:0')
compute_distance is  tensor(11.8675, device='cuda:0')
compute_norm is  tensor(52.2858, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.0067, device='cuda:0')
distance 2 is tensor(11.9704, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8298063058970071
avg test loss is  1.3314994323863658
avg accuracy is  0.876066666822989
solo acc is  0.24236666682300467
compute similarity  is  tensor(0.9621, device='cuda:0')
compute_distance is  tensor(11.9704, device='cuda:0')
compute_norm is  tensor(52.0284, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.2686, device='cuda:0')
distance 2 is tensor(12.0697, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8285066730686342
avg test loss is  1.3236872706331932
avg accuracy is  0.8766500001563221
solo acc is  0.24126666682300463
compute similarity  is  tensor(0.9620, device='cuda:0')
compute_distance is  tensor(12.0697, device='cuda:0')
compute_norm is  tensor(51.7735, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.5129, device='cuda:0')
distance 2 is tensor(12.1647, device='cuda:0')
________________________________
test distance is  tensor(12.1647, device='cuda:0')
test similarity is  tensor(0.9619, device='cuda:0')
test acc is  0.8794833334896555
test loss is 1.3165041921235352
test entropy is  0.8205677408145181
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.238542079925537
mal norm is  tensor(6.3999, device='cuda:0')
distance 1 is tensor(140.5129, device='cuda:0')
distance 2 is tensor(12.1647, device='cuda:0')
mal distance is  tensor(12.1647, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.3247, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.4278, device='cuda:0')
c is  tensor(0.0246, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(509.0316, device='cuda:0')
c is  tensor(0.0253, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(312.4655, device='cuda:0')
c is  tensor(0.0322, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.2633, device='cuda:0')
c is  tensor(0.0224, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.3798, device='cuda:0')
c is  tensor(0.0244, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.1249, device='cuda:0')
c is  tensor(0.0226, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(518.1385, device='cuda:0')
c is  tensor(0.0250, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.0211, device='cuda:0')
c is  tensor(0.0249, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.2166e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9891, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.7578, device='cuda:0')
c is  tensor(0.0228, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.5989e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.1386, device='cuda:0')
c is  tensor(0.0238, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.1922, device='cuda:0')
c is  tensor(0.0237, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.5303, device='cuda:0')
c is  tensor(0.0230, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.4242, device='cuda:0')
c is  tensor(0.0233, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.0528e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.6896, device='cuda:0')
c is  tensor(0.0238, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.5875, device='cuda:0')
c is  tensor(0.0233, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.7483, device='cuda:0')
c is  tensor(0.0224, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
len accept list 21
len all weights is 21
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 89.88% 

Test Accuracy: 88.51% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8797241449356079
distance 1 is tensor(133.0238, device='cuda:0')
distance 2 is tensor(9.9176, device='cuda:0')
benign distance is  tensor(9.9176, device='cuda:0')
norm1 res is  tensor(0.1378, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.4053395688533783
distance 1 is tensor(132.5485, device='cuda:0')
distance 2 is tensor(9.8671, device='cuda:0')
benign distance is  tensor(9.8671, device='cuda:0')
norm1 res is  tensor(0.1372, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.3076317608356476
distance 1 is tensor(116.5529, device='cuda:0')
distance 2 is tensor(8.8428, device='cuda:0')
benign distance is  tensor(8.8428, device='cuda:0')
norm1 res is  tensor(0.1231, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.4067811965942383
distance 1 is tensor(150.3478, device='cuda:0')
distance 2 is tensor(11.0986, device='cuda:0')
benign distance is  tensor(11.0986, device='cuda:0')
norm1 res is  tensor(0.1545, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5433249473571777
distance 1 is tensor(138.5778, device='cuda:0')
distance 2 is tensor(10.1220, device='cuda:0')
benign distance is  tensor(10.1220, device='cuda:0')
norm1 res is  tensor(0.1433, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.3234136700630188
distance 1 is tensor(158.9482, device='cuda:0')
distance 2 is tensor(11.8239, device='cuda:0')
benign distance is  tensor(11.8239, device='cuda:0')
norm1 res is  tensor(0.1644, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.24012640118598938
distance 1 is tensor(132.5319, device='cuda:0')
distance 2 is tensor(9.8064, device='cuda:0')
benign distance is  tensor(9.8064, device='cuda:0')
norm1 res is  tensor(0.1350, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.08018313348293304
distance 1 is tensor(141.0093, device='cuda:0')
distance 2 is tensor(10.3850, device='cuda:0')
benign distance is  tensor(10.3850, device='cuda:0')
norm1 res is  tensor(0.1463, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.540924072265625
distance 1 is tensor(162.3674, device='cuda:0')
distance 2 is tensor(12.0744, device='cuda:0')
benign distance is  tensor(12.0744, device='cuda:0')
norm1 res is  tensor(0.1697, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.635503888130188
distance 1 is tensor(142.4126, device='cuda:0')
distance 2 is tensor(10.5004, device='cuda:0')
benign distance is  tensor(10.5004, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.4012185037136078
distance 1 is tensor(156.6497, device='cuda:0')
distance 2 is tensor(11.5087, device='cuda:0')
benign distance is  tensor(11.5087, device='cuda:0')
norm1 res is  tensor(0.1609, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.22571244835853577
distance 1 is tensor(155.4310, device='cuda:0')
distance 2 is tensor(11.5258, device='cuda:0')
benign distance is  tensor(11.5258, device='cuda:0')
norm1 res is  tensor(0.1607, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.563193142414093
distance 1 is tensor(135.5245, device='cuda:0')
distance 2 is tensor(10.1090, device='cuda:0')
benign distance is  tensor(10.1090, device='cuda:0')
norm1 res is  tensor(0.1421, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.5100502967834473
distance 1 is tensor(144.4799, device='cuda:0')
distance 2 is tensor(10.6605, device='cuda:0')
benign distance is  tensor(10.6605, device='cuda:0')
norm1 res is  tensor(0.1508, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.3058759272098541
distance 1 is tensor(138.4088, device='cuda:0')
distance 2 is tensor(10.3793, device='cuda:0')
benign distance is  tensor(10.3793, device='cuda:0')
norm1 res is  tensor(0.1457, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.28664806485176086
distance 1 is tensor(159.9651, device='cuda:0')
distance 2 is tensor(11.8280, device='cuda:0')
benign distance is  tensor(11.8280, device='cuda:0')
norm1 res is  tensor(0.1664, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(161.9563, device='cuda:0')
distance 2 is tensor(12.0373, device='cuda:0')
compute distance is  tensor(12.0373, device='cuda:0')
compute norm is  tensor(53.9352, device='cuda:0')
distance 1 is tensor(159.0348, device='cuda:0')
distance 2 is tensor(11.9970, device='cuda:0')
compute distance is  tensor(11.9970, device='cuda:0')
compute norm is  tensor(54.0244, device='cuda:0')
distance 1 is tensor(172.4647, device='cuda:0')
distance 2 is tensor(13.1906, device='cuda:0')
compute distance is  tensor(13.1906, device='cuda:0')
compute norm is  tensor(54.3056, device='cuda:0')
distance 1 is tensor(164.6461, device='cuda:0')
distance 2 is tensor(12.5027, device='cuda:0')
compute distance is  tensor(12.5027, device='cuda:0')
compute norm is  tensor(54.1156, device='cuda:0')
distance 1 is tensor(161.5953, device='cuda:0')
distance 2 is tensor(12.3875, device='cuda:0')
compute distance is  tensor(12.3875, device='cuda:0')
compute norm is  tensor(54.0383, device='cuda:0')
distance 1 is tensor(167.0380, device='cuda:0')
distance 2 is tensor(12.8161, device='cuda:0')
compute distance is  tensor(12.8161, device='cuda:0')
compute norm is  tensor(54.3301, device='cuda:0')
distance 1 is tensor(164.2702, device='cuda:0')
distance 2 is tensor(12.4681, device='cuda:0')
compute distance is  tensor(12.4681, device='cuda:0')
compute norm is  tensor(54.2305, device='cuda:0')
distance 1 is tensor(168.6754, device='cuda:0')
distance 2 is tensor(12.8448, device='cuda:0')
compute distance is  tensor(12.8448, device='cuda:0')
compute norm is  tensor(54.2125, device='cuda:0')
distance 1 is tensor(164.8920, device='cuda:0')
distance 2 is tensor(12.6280, device='cuda:0')
compute distance is  tensor(12.6280, device='cuda:0')
compute norm is  tensor(54.1145, device='cuda:0')
distance 1 is tensor(169.1790, device='cuda:0')
distance 2 is tensor(12.8028, device='cuda:0')
compute distance is  tensor(12.8028, device='cuda:0')
compute norm is  tensor(54.1980, device='cuda:0')
distance 1 is tensor(163.4442, device='cuda:0')
distance 2 is tensor(12.4623, device='cuda:0')
compute distance is  tensor(12.4623, device='cuda:0')
compute norm is  tensor(54.2148, device='cuda:0')
distance 1 is tensor(162.1801, device='cuda:0')
distance 2 is tensor(12.4322, device='cuda:0')
compute distance is  tensor(12.4322, device='cuda:0')
compute norm is  tensor(54.2172, device='cuda:0')
distance Threshold  is  tensor(13.1906, device='cuda:0')
distance 1 is tensor(1101980.1250, device='cuda:0')
distance 2 is tensor(79387.0312, device='cuda:0')
________________________________
test distance is  tensor(79387.0312, device='cuda:0')
test similarity is  tensor(0.2071, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.20136769997158e+17
test entropy is  0.0
________________________________
cal ratio is  0.01160111208333971
distance 1 is tensor(12784.2012, device='cuda:0')
distance 2 is tensor(920.9778, device='cuda:0')
cal_distance is  tensor(920.9778, device='cuda:0')
cal ratio is  0.10770845666626369
distance 1 is tensor(1376.9730, device='cuda:0')
distance 2 is tensor(99.1971, device='cuda:0')
cal_distance is  tensor(99.1971, device='cuda:0')
cal ratio is  0.32818968339693927
distance 1 is tensor(451.9131, device='cuda:0')
distance 2 is tensor(32.5555, device='cuda:0')
cal_distance is  tensor(32.5555, device='cuda:0')
cal ratio is  0.5728784325297278
distance 1 is tensor(258.8944, device='cuda:0')
distance 2 is tensor(18.6503, device='cuda:0')
cal_distance is  tensor(18.6503, device='cuda:0')
cal ratio is  0.756887334838074
distance 1 is tensor(195.9556, device='cuda:0')
distance 2 is tensor(14.1162, device='cuda:0')
cal_distance is  tensor(14.1162, device='cuda:0')
cal ratio is  0.8699927223657539
distance 1 is tensor(170.4809, device='cuda:0')
distance 2 is tensor(12.2810, device='cuda:0')
cal_distance is  tensor(12.2810, device='cuda:0')
distance 1 is tensor(170.4809, device='cuda:0')
distance 2 is tensor(12.2810, device='cuda:0')
________________________________
test distance is  tensor(12.2810, device='cuda:0')
test similarity is  tensor(0.9467, device='cuda:0')
test acc is  0.4296333334896748
test loss is 134.81735744354313
test entropy is  1.8567138978989108e-05
________________________________
distance 1 is tensor(170.4809, device='cuda:0')
distance 2 is tensor(12.2810, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  3.584882572272985e-05
avg test loss is  134.81904829793902
avg accuracy is  0.43148333348967477
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9467, device='cuda:0')
compute_distance is  tensor(12.2810, device='cuda:0')
compute_norm is  tensor(56.6103, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(154.0826, device='cuda:0')
distance 2 is tensor(12.5053, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9127681092031474
avg test loss is  1.3431774123645286
avg accuracy is  0.7734333334896599
solo acc is  0.3205833334896732
compute similarity  is  tensor(0.9490, device='cuda:0')
compute_distance is  tensor(12.5053, device='cuda:0')
compute_norm is  tensor(56.1233, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(154.0826, device='cuda:0')
distance 2 is tensor(12.5053, device='cuda:0')
________________________________
test distance is  tensor(12.5053, device='cuda:0')
test similarity is  tensor(0.9490, device='cuda:0')
test acc is  0.7721166668229933
test loss is 1.3439186928368836
test entropy is  0.9101650944904986
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.181581735610962
mal norm is  tensor(8.2942, device='cuda:0')
distance 1 is tensor(154.0826, device='cuda:0')
distance 2 is tensor(12.5053, device='cuda:0')
mal distance is  tensor(12.5053, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1538, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.9839, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.3387, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(476.8980, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.3755, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.2333, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.0090, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.3402, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.8536, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4221, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.1010, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.2837, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.6640, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.6282, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.0452, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.0903, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.8498, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.2964, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.9312e-05, device='cuda:0')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 90.99% 

Test Accuracy: 89.52% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7137965559959412
distance 1 is tensor(108.0854, device='cuda:0')
distance 2 is tensor(8.1892, device='cuda:0')
benign distance is  tensor(8.1892, device='cuda:0')
norm1 res is  tensor(0.1172, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6331770420074463
distance 1 is tensor(122.9921, device='cuda:0')
distance 2 is tensor(9.0634, device='cuda:0')
benign distance is  tensor(9.0634, device='cuda:0')
norm1 res is  tensor(0.1304, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.20646822452545166
distance 1 is tensor(119.3924, device='cuda:0')
distance 2 is tensor(8.8312, device='cuda:0')
benign distance is  tensor(8.8312, device='cuda:0')
norm1 res is  tensor(0.1242, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.8354721069335938
distance 1 is tensor(122.4737, device='cuda:0')
distance 2 is tensor(8.9579, device='cuda:0')
benign distance is  tensor(8.9579, device='cuda:0')
norm1 res is  tensor(0.1287, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.008663535118103
distance 1 is tensor(129.7848, device='cuda:0')
distance 2 is tensor(9.4058, device='cuda:0')
benign distance is  tensor(9.4058, device='cuda:0')
norm1 res is  tensor(0.1343, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5613338351249695
distance 1 is tensor(140.5346, device='cuda:0')
distance 2 is tensor(10.1488, device='cuda:0')
benign distance is  tensor(10.1488, device='cuda:0')
norm1 res is  tensor(0.1478, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.4192584156990051
distance 1 is tensor(114.2579, device='cuda:0')
distance 2 is tensor(8.2906, device='cuda:0')
benign distance is  tensor(8.2906, device='cuda:0')
norm1 res is  tensor(0.1180, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2954009771347046
distance 1 is tensor(118.8588, device='cuda:0')
distance 2 is tensor(8.8118, device='cuda:0')
benign distance is  tensor(8.8118, device='cuda:0')
norm1 res is  tensor(0.1317, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.08354447036981583
distance 1 is tensor(124.0593, device='cuda:0')
distance 2 is tensor(9.0751, device='cuda:0')
benign distance is  tensor(9.0751, device='cuda:0')
norm1 res is  tensor(0.1331, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7110222578048706
distance 1 is tensor(151.4367, device='cuda:0')
distance 2 is tensor(11.0477, device='cuda:0')
benign distance is  tensor(11.0477, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.1550234705209732
distance 1 is tensor(139.1487, device='cuda:0')
distance 2 is tensor(10.0874, device='cuda:0')
benign distance is  tensor(10.0874, device='cuda:0')
norm1 res is  tensor(0.1463, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.3760460317134857
distance 1 is tensor(131.1852, device='cuda:0')
distance 2 is tensor(9.7337, device='cuda:0')
benign distance is  tensor(9.7337, device='cuda:0')
norm1 res is  tensor(0.1399, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.7117154002189636
distance 1 is tensor(126.6021, device='cuda:0')
distance 2 is tensor(9.3389, device='cuda:0')
benign distance is  tensor(9.3389, device='cuda:0')
norm1 res is  tensor(0.1352, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.6844483613967896
distance 1 is tensor(134.5210, device='cuda:0')
distance 2 is tensor(9.7626, device='cuda:0')
benign distance is  tensor(9.7626, device='cuda:0')
norm1 res is  tensor(0.1403, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.3422321081161499
distance 1 is tensor(130.1987, device='cuda:0')
distance 2 is tensor(9.6889, device='cuda:0')
benign distance is  tensor(9.6889, device='cuda:0')
norm1 res is  tensor(0.1396, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.5177103281021118
distance 1 is tensor(138.7442, device='cuda:0')
distance 2 is tensor(10.1570, device='cuda:0')
benign distance is  tensor(10.1570, device='cuda:0')
norm1 res is  tensor(0.1462, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(175.1537, device='cuda:0')
distance 2 is tensor(12.9075, device='cuda:0')
compute distance is  tensor(12.9075, device='cuda:0')
compute norm is  tensor(53.7680, device='cuda:0')
distance 1 is tensor(160.3755, device='cuda:0')
distance 2 is tensor(11.8682, device='cuda:0')
compute distance is  tensor(11.8682, device='cuda:0')
compute norm is  tensor(53.5913, device='cuda:0')
distance 1 is tensor(177.4080, device='cuda:0')
distance 2 is tensor(13.0848, device='cuda:0')
compute distance is  tensor(13.0848, device='cuda:0')
compute norm is  tensor(53.8972, device='cuda:0')
distance 1 is tensor(170.5448, device='cuda:0')
distance 2 is tensor(12.4286, device='cuda:0')
compute distance is  tensor(12.4286, device='cuda:0')
compute norm is  tensor(53.8365, device='cuda:0')
distance 1 is tensor(172.0748, device='cuda:0')
distance 2 is tensor(12.3235, device='cuda:0')
compute distance is  tensor(12.3235, device='cuda:0')
compute norm is  tensor(53.9431, device='cuda:0')
distance 1 is tensor(186.3242, device='cuda:0')
distance 2 is tensor(13.6116, device='cuda:0')
compute distance is  tensor(13.6116, device='cuda:0')
compute norm is  tensor(54.2831, device='cuda:0')
distance 1 is tensor(168.1139, device='cuda:0')
distance 2 is tensor(12.3554, device='cuda:0')
compute distance is  tensor(12.3554, device='cuda:0')
compute norm is  tensor(53.5980, device='cuda:0')
distance 1 is tensor(168.1546, device='cuda:0')
distance 2 is tensor(12.2277, device='cuda:0')
compute distance is  tensor(12.2277, device='cuda:0')
compute norm is  tensor(53.6637, device='cuda:0')
distance 1 is tensor(171.7168, device='cuda:0')
distance 2 is tensor(12.4266, device='cuda:0')
compute distance is  tensor(12.4266, device='cuda:0')
compute norm is  tensor(53.8671, device='cuda:0')
distance 1 is tensor(157.9740, device='cuda:0')
distance 2 is tensor(11.4313, device='cuda:0')
compute distance is  tensor(11.4313, device='cuda:0')
compute norm is  tensor(53.6411, device='cuda:0')
distance 1 is tensor(165.7813, device='cuda:0')
distance 2 is tensor(12.0886, device='cuda:0')
compute distance is  tensor(12.0886, device='cuda:0')
compute norm is  tensor(53.8048, device='cuda:0')
distance 1 is tensor(167.9325, device='cuda:0')
distance 2 is tensor(12.3247, device='cuda:0')
compute distance is  tensor(12.3247, device='cuda:0')
compute norm is  tensor(53.7225, device='cuda:0')
distance Threshold  is  tensor(13.6116, device='cuda:0')
distance 1 is tensor(1102003.8750, device='cuda:0')
distance 2 is tensor(79389.1406, device='cuda:0')
________________________________
test distance is  tensor(79389.1406, device='cuda:0')
test similarity is  tensor(0.1494, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.196868962576865e+17
test entropy is  0.0
________________________________
cal ratio is  0.011784648422559291
distance 1 is tensor(12986.7354, device='cuda:0')
distance 2 is tensor(935.5729, device='cuda:0')
cal_distance is  tensor(935.5729, device='cuda:0')
cal ratio is  0.10855713208051733
distance 1 is tensor(1409.8092, device='cuda:0')
distance 2 is tensor(101.5631, device='cuda:0')
cal_distance is  tensor(101.5631, device='cuda:0')
cal ratio is  0.3294800720519994
distance 1 is tensor(464.5089, device='cuda:0')
distance 2 is tensor(33.4630, device='cuda:0')
cal_distance is  tensor(33.4630, device='cuda:0')
cal ratio is  0.5740035467345621
distance 1 is tensor(266.6328, device='cuda:0')
distance 2 is tensor(19.2079, device='cuda:0')
cal_distance is  tensor(19.2079, device='cuda:0')
cal ratio is  0.7576302511766145
distance 1 is tensor(202.0108, device='cuda:0')
distance 2 is tensor(14.5525, device='cuda:0')
cal_distance is  tensor(14.5525, device='cuda:0')
cal ratio is  0.8704195918929885
distance 1 is tensor(175.8351, device='cuda:0')
distance 2 is tensor(12.6668, device='cuda:0')
cal_distance is  tensor(12.6668, device='cuda:0')
distance 1 is tensor(175.8351, device='cuda:0')
distance 2 is tensor(12.6668, device='cuda:0')
________________________________
test distance is  tensor(12.6668, device='cuda:0')
test similarity is  tensor(0.9412, device='cuda:0')
test acc is  0.7886166668229926
test loss is 120.89060530835377
test entropy is  0.0009383077519828297
________________________________
distance 1 is tensor(175.8351, device='cuda:0')
distance 2 is tensor(12.6668, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0009783976084323306
avg test loss is  120.96291873500799
avg accuracy is  0.7896500001563259
solo acc is  0.10335000015633197
compute similarity  is  tensor(0.9412, device='cuda:0')
compute_distance is  tensor(12.6668, device='cuda:0')
compute_norm is  tensor(56.7977, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(161.9768, device='cuda:0')
distance 2 is tensor(13.3735, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8977872661944392
avg test loss is  1.3632568415802424
avg accuracy is  0.8470333334896567
solo acc is  0.32283333348967336
compute similarity  is  tensor(0.9429, device='cuda:0')
compute_distance is  tensor(13.3735, device='cuda:0')
compute_norm is  tensor(56.2076, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(162.1982, device='cuda:0')
distance 2 is tensor(13.4902, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.863532996952915
avg test loss is  1.4528312922032403
avg accuracy is  0.8464500001563233
solo acc is  0.2577166668230051
compute similarity  is  tensor(0.9428, device='cuda:0')
compute_distance is  tensor(13.4902, device='cuda:0')
compute_norm is  tensor(55.9020, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(162.3965, device='cuda:0')
distance 2 is tensor(13.5581, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8579273553036931
avg test loss is  1.4333193894388325
avg accuracy is  0.8478333334896567
solo acc is  0.2566166668230051
compute similarity  is  tensor(0.9427, device='cuda:0')
compute_distance is  tensor(13.5581, device='cuda:0')
compute_norm is  tensor(55.6080, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(162.6952, device='cuda:0')
distance 2 is tensor(13.6228, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8576757048747179
avg test loss is  1.4216628832095213
avg accuracy is  0.8463500001563233
solo acc is  0.24665000015633817
compute similarity  is  tensor(0.9427, device='cuda:0')
compute_distance is  tensor(13.6228, device='cuda:0')
compute_norm is  tensor(55.3223, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(163.0116, device='cuda:0')
distance 2 is tensor(13.6809, device='cuda:0')
________________________________
test distance is  tensor(13.6809, device='cuda:0')
test similarity is  tensor(0.9427, device='cuda:0')
test acc is  0.8496333334896565
test loss is 1.414282879722652
test entropy is  0.8512123278590408
________________________________
cal ratio is  0.8977190827373621
distance 1 is tensor(146.3393, device='cuda:0')
distance 2 is tensor(12.2816, device='cuda:0')
cal_distance is  tensor(12.2816, device='cuda:0')
distance 1 is tensor(146.3393, device='cuda:0')
distance 2 is tensor(12.2816, device='cuda:0')
________________________________
test distance is  tensor(12.2816, device='cuda:0')
test similarity is  tensor(0.9528, device='cuda:0')
test acc is  0.8604000001563229
test loss is 1.10651498003555
test entropy is  0.9432925950489572
________________________________
distance 1 is tensor(146.3393, device='cuda:0')
distance 2 is tensor(12.2816, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9417117982785076
avg test loss is  1.109303414059092
avg accuracy is  0.8597166668229895
solo acc is  0.44283333348967485
compute similarity  is  tensor(0.9528, device='cuda:0')
compute_distance is  tensor(12.2816, device='cuda:0')
compute_norm is  tensor(54.6482, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.4280, device='cuda:0')
distance 2 is tensor(12.4556, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8534543788128062
avg test loss is  1.3832807139292964
avg accuracy is  0.8574166668229896
solo acc is  0.24710000015633823
compute similarity  is  tensor(0.9526, device='cuda:0')
compute_distance is  tensor(12.4556, device='cuda:0')
compute_norm is  tensor(54.3741, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.1718, device='cuda:0')
distance 2 is tensor(12.5389, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8460142323330267
avg test loss is  1.3777136812840443
avg accuracy is  0.8592666668229896
solo acc is  0.2430666668230047
compute similarity  is  tensor(0.9525, device='cuda:0')
compute_distance is  tensor(12.5389, device='cuda:0')
compute_norm is  tensor(54.1011, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.8714, device='cuda:0')
distance 2 is tensor(12.6102, device='cuda:0')
exit early
distance 1 is tensor(148.8714, device='cuda:0')
distance 2 is tensor(12.6102, device='cuda:0')
________________________________
test distance is  tensor(12.6102, device='cuda:0')
test similarity is  tensor(0.9524, device='cuda:0')
test acc is  0.8596500001563229
test loss is 1.375791920781898
test entropy is  0.8401399143596193
________________________________
distance 1 is tensor(148.8714, device='cuda:0')
distance 2 is tensor(12.6102, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8389537989584877
avg test loss is  1.377989675825847
avg accuracy is  0.857900000156323
solo acc is  0.23975000015633793
compute similarity  is  tensor(0.9524, device='cuda:0')
compute_distance is  tensor(12.6102, device='cuda:0')
compute_norm is  tensor(53.8342, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.5838, device='cuda:0')
distance 2 is tensor(12.6755, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8414847893374306
avg test loss is  1.3644570870313055
avg accuracy is  0.8606666668229895
solo acc is  0.23850000015633782
compute similarity  is  tensor(0.9524, device='cuda:0')
compute_distance is  tensor(12.6755, device='cuda:0')
compute_norm is  tensor(53.5697, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.3774, device='cuda:0')
distance 2 is tensor(12.7437, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8384078828129433
avg test loss is  1.3572568273239298
avg accuracy is  0.8622666668229894
solo acc is  0.23616666682300452
compute similarity  is  tensor(0.9523, device='cuda:0')
compute_distance is  tensor(12.7437, device='cuda:0')
compute_norm is  tensor(53.3076, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.1781, device='cuda:0')
distance 2 is tensor(12.8093, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8380626762853757
avg test loss is  1.3500391497795008
avg accuracy is  0.8628500001563227
solo acc is  0.232983333489671
compute similarity  is  tensor(0.9523, device='cuda:0')
compute_distance is  tensor(12.8093, device='cuda:0')
compute_norm is  tensor(53.0494, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.0062, device='cuda:0')
distance 2 is tensor(12.8735, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8380095843058913
avg test loss is  1.3349545225659922
avg accuracy is  0.8642333334896559
solo acc is  0.23511666682300447
compute similarity  is  tensor(0.9522, device='cuda:0')
compute_distance is  tensor(12.8735, device='cuda:0')
compute_norm is  tensor(52.7939, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.9052, device='cuda:0')
distance 2 is tensor(12.9442, device='cuda:0')
________________________________
test distance is  tensor(12.9442, device='cuda:0')
test similarity is  tensor(0.9522, device='cuda:0')
test acc is  0.8634166668229892
test loss is 1.3440298185165502
test entropy is  0.8241472211219608
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3275973796844482
mal norm is  tensor(7.2896, device='cuda:0')
distance 1 is tensor(152.9052, device='cuda:0')
distance 2 is tensor(12.9442, device='cuda:0')
mal distance is  tensor(12.9442, device='cuda:0')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2402, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(462.3579, device='cuda:0')
c is  tensor(0.0228, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.1681e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.2945, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.0362e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(492.3224, device='cuda:0')
c is  tensor(0.0221, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.2160, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.6494, device='cuda:0')
c is  tensor(0.0212, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0010, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.7202, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(469.7833, device='cuda:0')
c is  tensor(0.0226, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.8919e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.7845, device='cuda:0')
c is  tensor(0.0218, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.9591e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.9600, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.6094, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.8330, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.1588, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.2352, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.3888, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.2977e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.3891, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.3375, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.0085, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.6260, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.7371, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.2234, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.8817e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.1666, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.4951, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.1069, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.8922e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.9361, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.6190e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.8631, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.7594e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.6570, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.9539, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.5387, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.3164, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.8540e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.9365, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.9329, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.0303e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.7449, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.1856, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
len accept list 13
len all weights is 13
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 91.00% 

Test Accuracy: 89.69% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
 benign loss is  0.30225032567977905
distance 1 is tensor(123.6678, device='cuda:0')
distance 2 is tensor(9.1595, device='cuda:0')
benign distance is  tensor(9.1595, device='cuda:0')
norm1 res is  tensor(0.1336, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.0565994493663311
distance 1 is tensor(117.8414, device='cuda:0')
distance 2 is tensor(8.4835, device='cuda:0')
benign distance is  tensor(8.4835, device='cuda:0')
norm1 res is  tensor(0.1206, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.23858320713043213
distance 1 is tensor(96.8806, device='cuda:0')
distance 2 is tensor(7.1735, device='cuda:0')
benign distance is  tensor(7.1735, device='cuda:0')
norm1 res is  tensor(0.1024, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5157616138458252
distance 1 is tensor(133.6518, device='cuda:0')
distance 2 is tensor(9.7438, device='cuda:0')
benign distance is  tensor(9.7438, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.1173356771469116
distance 1 is tensor(122.7547, device='cuda:0')
distance 2 is tensor(9.0444, device='cuda:0')
benign distance is  tensor(9.0444, device='cuda:0')
norm1 res is  tensor(0.1287, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7102285027503967
distance 1 is tensor(134.6468, device='cuda:0')
distance 2 is tensor(9.8472, device='cuda:0')
benign distance is  tensor(9.8472, device='cuda:0')
norm1 res is  tensor(0.1420, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.14731204509735107
distance 1 is tensor(101.4324, device='cuda:0')
distance 2 is tensor(7.3409, device='cuda:0')
benign distance is  tensor(7.3409, device='cuda:0')
norm1 res is  tensor(0.1066, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6312430500984192
distance 1 is tensor(107.6293, device='cuda:0')
distance 2 is tensor(8.0282, device='cuda:0')
benign distance is  tensor(8.0282, device='cuda:0')
norm1 res is  tensor(0.1176, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.22055590152740479
distance 1 is tensor(131.8735, device='cuda:0')
distance 2 is tensor(9.6331, device='cuda:0')
benign distance is  tensor(9.6331, device='cuda:0')
norm1 res is  tensor(0.1420, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.4426754415035248
distance 1 is tensor(133.4902, device='cuda:0')
distance 2 is tensor(9.7998, device='cuda:0')
benign distance is  tensor(9.7998, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.14871273934841156
distance 1 is tensor(129.1119, device='cuda:0')
distance 2 is tensor(9.4017, device='cuda:0')
benign distance is  tensor(9.4017, device='cuda:0')
norm1 res is  tensor(0.1380, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.1759842336177826
distance 1 is tensor(130.9910, device='cuda:0')
distance 2 is tensor(9.5504, device='cuda:0')
benign distance is  tensor(9.5504, device='cuda:0')
norm1 res is  tensor(0.1404, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.33957308530807495
distance 1 is tensor(141.1610, device='cuda:0')
distance 2 is tensor(10.3995, device='cuda:0')
benign distance is  tensor(10.3995, device='cuda:0')
norm1 res is  tensor(0.1519, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.07968485355377197
distance 1 is tensor(126.1881, device='cuda:0')
distance 2 is tensor(9.4209, device='cuda:0')
benign distance is  tensor(9.4209, device='cuda:0')
norm1 res is  tensor(0.1371, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.3065294325351715
distance 1 is tensor(139.0644, device='cuda:0')
distance 2 is tensor(10.1118, device='cuda:0')
benign distance is  tensor(10.1118, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.7858706712722778
distance 1 is tensor(138.5285, device='cuda:0')
distance 2 is tensor(10.0918, device='cuda:0')
benign distance is  tensor(10.0918, device='cuda:0')
norm1 res is  tensor(0.1482, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.1638171523809433
distance 1 is tensor(129.1891, device='cuda:0')
distance 2 is tensor(9.4972, device='cuda:0')
benign distance is  tensor(9.4972, device='cuda:0')
norm1 res is  tensor(0.1377, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.16636326909065247
distance 1 is tensor(133.6469, device='cuda:0')
distance 2 is tensor(9.6240, device='cuda:0')
benign distance is  tensor(9.6240, device='cuda:0')
norm1 res is  tensor(0.1414, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.8082342147827148
distance 1 is tensor(145.8173, device='cuda:0')
distance 2 is tensor(10.6326, device='cuda:0')
benign distance is  tensor(10.6326, device='cuda:0')
norm1 res is  tensor(0.1552, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.36242780089378357
distance 1 is tensor(137.9912, device='cuda:0')
distance 2 is tensor(10.0894, device='cuda:0')
benign distance is  tensor(10.0894, device='cuda:0')
norm1 res is  tensor(0.1463, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.6604201793670654
distance 1 is tensor(131.3703, device='cuda:0')
distance 2 is tensor(9.5743, device='cuda:0')
benign distance is  tensor(9.5743, device='cuda:0')
norm1 res is  tensor(0.1390, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.12987983226776123
distance 1 is tensor(139.8249, device='cuda:0')
distance 2 is tensor(10.1370, device='cuda:0')
benign distance is  tensor(10.1370, device='cuda:0')
norm1 res is  tensor(0.1500, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.28170254826545715
distance 1 is tensor(129.9130, device='cuda:0')
distance 2 is tensor(9.5069, device='cuda:0')
benign distance is  tensor(9.5069, device='cuda:0')
norm1 res is  tensor(0.1402, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.5607961416244507
distance 1 is tensor(128.1395, device='cuda:0')
distance 2 is tensor(9.5821, device='cuda:0')
benign distance is  tensor(9.5821, device='cuda:0')
norm1 res is  tensor(0.1392, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.3847000300884247
distance 1 is tensor(134.3557, device='cuda:0')
distance 2 is tensor(9.9400, device='cuda:0')
benign distance is  tensor(9.9400, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.4339922368526459
distance 1 is tensor(131.9506, device='cuda:0')
distance 2 is tensor(9.7191, device='cuda:0')
benign distance is  tensor(9.7191, device='cuda:0')
norm1 res is  tensor(0.1413, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.2941703498363495
distance 1 is tensor(133.5426, device='cuda:0')
distance 2 is tensor(9.9008, device='cuda:0')
benign distance is  tensor(9.9008, device='cuda:0')
norm1 res is  tensor(0.1458, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.20686852931976318
distance 1 is tensor(134.1857, device='cuda:0')
distance 2 is tensor(9.9181, device='cuda:0')
benign distance is  tensor(9.9181, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.8299945592880249
distance 1 is tensor(131.6858, device='cuda:0')
distance 2 is tensor(9.5737, device='cuda:0')
benign distance is  tensor(9.5737, device='cuda:0')
norm1 res is  tensor(0.1371, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.642747163772583
distance 1 is tensor(131.2750, device='cuda:0')
distance 2 is tensor(9.5980, device='cuda:0')
benign distance is  tensor(9.5980, device='cuda:0')
norm1 res is  tensor(0.1376, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.11402218043804169
distance 1 is tensor(129.1472, device='cuda:0')
distance 2 is tensor(9.4584, device='cuda:0')
benign distance is  tensor(9.4584, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.38761261105537415
distance 1 is tensor(128.5904, device='cuda:0')
distance 2 is tensor(9.4439, device='cuda:0')
benign distance is  tensor(9.4439, device='cuda:0')
norm1 res is  tensor(0.1347, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(139.0532, device='cuda:0')
distance 2 is tensor(9.9497, device='cuda:0')
compute distance is  tensor(9.9497, device='cuda:0')
compute norm is  tensor(53.6226, device='cuda:0')
distance 1 is tensor(141.4357, device='cuda:0')
distance 2 is tensor(10.3943, device='cuda:0')
compute distance is  tensor(10.3943, device='cuda:0')
compute norm is  tensor(54.0251, device='cuda:0')
distance 1 is tensor(149.6103, device='cuda:0')
distance 2 is tensor(10.9041, device='cuda:0')
compute distance is  tensor(10.9041, device='cuda:0')
compute norm is  tensor(54.1802, device='cuda:0')
distance 1 is tensor(147.1656, device='cuda:0')
distance 2 is tensor(10.8473, device='cuda:0')
compute distance is  tensor(10.8473, device='cuda:0')
compute norm is  tensor(54.0172, device='cuda:0')
distance 1 is tensor(141.4932, device='cuda:0')
distance 2 is tensor(10.4257, device='cuda:0')
compute distance is  tensor(10.4257, device='cuda:0')
compute norm is  tensor(53.7689, device='cuda:0')
distance 1 is tensor(147.2957, device='cuda:0')
distance 2 is tensor(10.7237, device='cuda:0')
compute distance is  tensor(10.7237, device='cuda:0')
compute norm is  tensor(54.1119, device='cuda:0')
distance 1 is tensor(148.9627, device='cuda:0')
distance 2 is tensor(10.8597, device='cuda:0')
compute distance is  tensor(10.8597, device='cuda:0')
compute norm is  tensor(54.0492, device='cuda:0')
distance 1 is tensor(142.6228, device='cuda:0')
distance 2 is tensor(10.2689, device='cuda:0')
compute distance is  tensor(10.2689, device='cuda:0')
compute norm is  tensor(53.9038, device='cuda:0')
distance 1 is tensor(149.3045, device='cuda:0')
distance 2 is tensor(10.7578, device='cuda:0')
compute distance is  tensor(10.7578, device='cuda:0')
compute norm is  tensor(53.9874, device='cuda:0')
distance 1 is tensor(143.1710, device='cuda:0')
distance 2 is tensor(10.3818, device='cuda:0')
compute distance is  tensor(10.3818, device='cuda:0')
compute norm is  tensor(53.8086, device='cuda:0')
distance 1 is tensor(152.8271, device='cuda:0')
distance 2 is tensor(11.0421, device='cuda:0')
compute distance is  tensor(11.0421, device='cuda:0')
compute norm is  tensor(54.1348, device='cuda:0')
distance 1 is tensor(137.2577, device='cuda:0')
distance 2 is tensor(9.9343, device='cuda:0')
compute distance is  tensor(9.9343, device='cuda:0')
compute norm is  tensor(53.8162, device='cuda:0')
distance Threshold  is  tensor(11.0421, device='cuda:0')
distance 1 is tensor(1102009.3750, device='cuda:0')
distance 2 is tensor(79389.6172, device='cuda:0')
________________________________
test distance is  tensor(79389.6172, device='cuda:0')
test similarity is  tensor(0.1361, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197623572762661e+17
test entropy is  0.0
________________________________
cal ratio is  0.01061419981907867
distance 1 is tensor(11696.9541, device='cuda:0')
distance 2 is tensor(842.6572, device='cuda:0')
cal_distance is  tensor(842.6572, device='cuda:0')
cal ratio is  0.10302524022128966
distance 1 is tensor(1205.0881, device='cuda:0')
distance 2 is tensor(86.8150, device='cuda:0')
cal_distance is  tensor(86.8150, device='cuda:0')
cal ratio is  0.3209754426566871
distance 1 is tensor(386.8086, device='cuda:0')
distance 2 is tensor(27.8655, device='cuda:0')
cal_distance is  tensor(27.8655, device='cuda:0')
cal ratio is  0.5665469288251138
distance 1 is tensor(219.1483, device='cuda:0')
distance 2 is tensor(15.7871, device='cuda:0')
cal_distance is  tensor(15.7871, device='cuda:0')
cal ratio is  0.7526931201060124
distance 1 is tensor(164.9532, device='cuda:0')
distance 2 is tensor(11.8828, device='cuda:0')
cal_distance is  tensor(11.8828, device='cuda:0')
cal ratio is  0.8675789171375847
distance 1 is tensor(143.1109, device='cuda:0')
distance 2 is tensor(10.3093, device='cuda:0')
cal_distance is  tensor(10.3093, device='cuda:0')
distance 1 is tensor(143.1109, device='cuda:0')
distance 2 is tensor(10.3093, device='cuda:0')
________________________________
test distance is  tensor(10.3093, device='cuda:0')
test similarity is  tensor(0.9588, device='cuda:0')
test acc is  0.8749000001563223
test loss is 33.45499558845309
test entropy is  0.02770460834431309
________________________________
distance 1 is tensor(143.1109, device='cuda:0')
distance 2 is tensor(10.3093, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.029025832042798027
avg test loss is  33.29758333193976
avg accuracy is  0.8776833334896554
solo acc is  0.22211666682300396
compute similarity  is  tensor(0.9588, device='cuda:0')
compute_distance is  tensor(10.3093, device='cuda:0')
compute_norm is  tensor(55.8583, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(135.4690, device='cuda:0')
distance 2 is tensor(11.3640, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8849821265445335
avg test loss is  1.3491464279480834
avg accuracy is  0.8652166668229893
solo acc is  0.3229333334896733
compute similarity  is  tensor(0.9589, device='cuda:0')
compute_distance is  tensor(11.3640, device='cuda:0')
compute_norm is  tensor(55.1506, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.2437, device='cuda:0')
distance 2 is tensor(11.5213, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8647345822375975
avg test loss is  1.4137392389748904
avg accuracy is  0.8642166668229893
solo acc is  0.26420000015633865
compute similarity  is  tensor(0.9587, device='cuda:0')
compute_distance is  tensor(11.5213, device='cuda:0')
compute_norm is  tensor(54.8496, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.8635, device='cuda:0')
distance 2 is tensor(11.6240, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.854620176782486
avg test loss is  1.3985313818271734
avg accuracy is  0.8662666668229893
solo acc is  0.26248333348967195
compute similarity  is  tensor(0.9586, device='cuda:0')
compute_distance is  tensor(11.6240, device='cuda:0')
compute_norm is  tensor(54.5606, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.5131, device='cuda:0')
distance 2 is tensor(11.7168, device='cuda:0')
exit early
distance 1 is tensor(137.5131, device='cuda:0')
distance 2 is tensor(11.7168, device='cuda:0')
________________________________
test distance is  tensor(11.7168, device='cuda:0')
test similarity is  tensor(0.9586, device='cuda:0')
test acc is  0.8684166668229891
test loss is 1.3957209219810551
test entropy is  0.8470972661397604
________________________________
cal ratio is  0.873705784534365
distance 1 is tensor(120.1468, device='cuda:0')
distance 2 is tensor(10.2370, device='cuda:0')
cal_distance is  tensor(10.2370, device='cuda:0')
distance 1 is tensor(120.1468, device='cuda:0')
distance 2 is tensor(10.2370, device='cuda:0')
________________________________
test distance is  tensor(10.2370, device='cuda:0')
test similarity is  tensor(0.9678, device='cuda:0')
test acc is  0.879400000156322
test loss is 0.9848186586584363
test entropy is  0.934934654914494
________________________________
distance 1 is tensor(120.1468, device='cuda:0')
distance 2 is tensor(10.2370, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9361445931737611
avg test loss is  0.9863029231648963
avg accuracy is  0.8779833334896555
solo acc is  0.5486500001563421
compute similarity  is  tensor(0.9678, device='cuda:0')
compute_distance is  tensor(10.2370, device='cuda:0')
compute_norm is  tensor(53.9627, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(122.0693, device='cuda:0')
distance 2 is tensor(10.5231, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8387407853659282
avg test loss is  1.3760704929386374
avg accuracy is  0.8738166668229889
solo acc is  0.25603333348967167
compute similarity  is  tensor(0.9673, device='cuda:0')
compute_distance is  tensor(10.5231, device='cuda:0')
compute_norm is  tensor(53.6850, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(123.1328, device='cuda:0')
distance 2 is tensor(10.6335, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8413483331452555
avg test loss is  1.3620182570618098
avg accuracy is  0.8748500001563223
solo acc is  0.2495000001563382
compute similarity  is  tensor(0.9672, device='cuda:0')
compute_distance is  tensor(10.6335, device='cuda:0')
compute_norm is  tensor(53.4107, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(124.1439, device='cuda:0')
distance 2 is tensor(10.7319, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8415102032201884
avg test loss is  1.3487497574484932
avg accuracy is  0.8773333334896555
solo acc is  0.24736666682300484
compute similarity  is  tensor(0.9671, device='cuda:0')
compute_distance is  tensor(10.7319, device='cuda:0')
compute_norm is  tensor(53.1415, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(125.1383, device='cuda:0')
distance 2 is tensor(10.8259, device='cuda:0')
exit early
distance 1 is tensor(125.1383, device='cuda:0')
distance 2 is tensor(10.8259, device='cuda:0')
________________________________
test distance is  tensor(10.8259, device='cuda:0')
test similarity is  tensor(0.9670, device='cuda:0')
test acc is  0.8784500001563221
test loss is 1.3470778040794422
test entropy is  0.8324121299074657
________________________________
distance 1 is tensor(125.1383, device='cuda:0')
distance 2 is tensor(10.8259, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8333050528569008
avg test loss is  1.3435213770439376
avg accuracy is  0.8778000001563221
solo acc is  0.2443333334896714
compute similarity  is  tensor(0.9670, device='cuda:0')
compute_distance is  tensor(10.8259, device='cuda:0')
compute_norm is  tensor(52.8774, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(126.1584, device='cuda:0')
distance 2 is tensor(10.9136, device='cuda:0')
exit early
distance 1 is tensor(126.1584, device='cuda:0')
distance 2 is tensor(10.9136, device='cuda:0')
________________________________
test distance is  tensor(10.9136, device='cuda:0')
test similarity is  tensor(0.9669, device='cuda:0')
test acc is  0.880350000156322
test loss is 1.3384275135200923
test entropy is  0.8284826925568489
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3558156490325928
mal norm is  tensor(6.0209, device='cuda:0')
distance 1 is tensor(126.1584, device='cuda:0')
distance 2 is tensor(10.9136, device='cuda:0')
mal distance is  tensor(10.9136, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1850, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.8058, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(479.5122, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.4892e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(404.7046, device='cuda:0')
c is  tensor(0.0214, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.4772, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(509.7435, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.1439, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(420.8423, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(453.1855, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.0894, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 3
len all weights is 3
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 90.86% 

Test Accuracy: 89.34% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
 benign loss is  0.28754061460494995
distance 1 is tensor(118.9083, device='cuda:0')
distance 2 is tensor(8.8172, device='cuda:0')
benign distance is  tensor(8.8172, device='cuda:0')
norm1 res is  tensor(0.1277, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.2365131825208664
distance 1 is tensor(99.6600, device='cuda:0')
distance 2 is tensor(7.4046, device='cuda:0')
benign distance is  tensor(7.4046, device='cuda:0')
norm1 res is  tensor(0.1068, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.10217167437076569
distance 1 is tensor(83.2450, device='cuda:0')
distance 2 is tensor(6.3954, device='cuda:0')
benign distance is  tensor(6.3954, device='cuda:0')
norm1 res is  tensor(0.0904, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5518702864646912
distance 1 is tensor(141.5277, device='cuda:0')
distance 2 is tensor(10.3219, device='cuda:0')
benign distance is  tensor(10.3219, device='cuda:0')
norm1 res is  tensor(0.1489, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7744163274765015
distance 1 is tensor(129.8305, device='cuda:0')
distance 2 is tensor(9.4939, device='cuda:0')
benign distance is  tensor(9.4939, device='cuda:0')
norm1 res is  tensor(0.1372, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5340819954872131
distance 1 is tensor(143.0385, device='cuda:0')
distance 2 is tensor(10.5383, device='cuda:0')
benign distance is  tensor(10.5383, device='cuda:0')
norm1 res is  tensor(0.1559, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.5649675130844116
distance 1 is tensor(125.4880, device='cuda:0')
distance 2 is tensor(8.9391, device='cuda:0')
benign distance is  tensor(8.9391, device='cuda:0')
norm1 res is  tensor(0.1294, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.380704402923584
distance 1 is tensor(129.9764, device='cuda:0')
distance 2 is tensor(9.4247, device='cuda:0')
benign distance is  tensor(9.4247, device='cuda:0')
norm1 res is  tensor(0.1366, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(152.9500, device='cuda:0')
distance 2 is tensor(11.0863, device='cuda:0')
compute distance is  tensor(11.0863, device='cuda:0')
compute norm is  tensor(54.1817, device='cuda:0')
distance 1 is tensor(143.6150, device='cuda:0')
distance 2 is tensor(10.5583, device='cuda:0')
compute distance is  tensor(10.5583, device='cuda:0')
compute norm is  tensor(54.0718, device='cuda:0')
distance 1 is tensor(149.7029, device='cuda:0')
distance 2 is tensor(10.9772, device='cuda:0')
compute distance is  tensor(10.9772, device='cuda:0')
compute norm is  tensor(54.1203, device='cuda:0')
distance 1 is tensor(155.6606, device='cuda:0')
distance 2 is tensor(11.3575, device='cuda:0')
compute distance is  tensor(11.3575, device='cuda:0')
compute norm is  tensor(54.2575, device='cuda:0')
distance 1 is tensor(150.5647, device='cuda:0')
distance 2 is tensor(11.1221, device='cuda:0')
compute distance is  tensor(11.1221, device='cuda:0')
compute norm is  tensor(54.2995, device='cuda:0')
distance 1 is tensor(156.1617, device='cuda:0')
distance 2 is tensor(11.4017, device='cuda:0')
compute distance is  tensor(11.4017, device='cuda:0')
compute norm is  tensor(54.3397, device='cuda:0')
distance 1 is tensor(156.2838, device='cuda:0')
distance 2 is tensor(11.3894, device='cuda:0')
compute distance is  tensor(11.3894, device='cuda:0')
compute norm is  tensor(54.3180, device='cuda:0')
distance 1 is tensor(155.7971, device='cuda:0')
distance 2 is tensor(11.3100, device='cuda:0')
compute distance is  tensor(11.3100, device='cuda:0')
compute norm is  tensor(54.2012, device='cuda:0')
distance 1 is tensor(152.7915, device='cuda:0')
distance 2 is tensor(11.1068, device='cuda:0')
compute distance is  tensor(11.1068, device='cuda:0')
compute norm is  tensor(54.2674, device='cuda:0')
distance 1 is tensor(154.5289, device='cuda:0')
distance 2 is tensor(11.3379, device='cuda:0')
compute distance is  tensor(11.3379, device='cuda:0')
compute norm is  tensor(54.2968, device='cuda:0')
distance 1 is tensor(153.5162, device='cuda:0')
distance 2 is tensor(11.0813, device='cuda:0')
compute distance is  tensor(11.0813, device='cuda:0')
compute norm is  tensor(54.2658, device='cuda:0')
distance 1 is tensor(145.4023, device='cuda:0')
distance 2 is tensor(10.6921, device='cuda:0')
compute distance is  tensor(10.6921, device='cuda:0')
compute norm is  tensor(54.1780, device='cuda:0')
distance Threshold  is  tensor(11.4017, device='cuda:0')
distance 1 is tensor(1102011.8750, device='cuda:0')
distance 2 is tensor(79389.8594, device='cuda:0')
________________________________
test distance is  tensor(79389.8594, device='cuda:0')
test similarity is  tensor(0.1255, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.193979301253947e+17
test entropy is  0.0
________________________________
cal ratio is  0.010785616412910388
distance 1 is tensor(11885.8828, device='cuda:0')
distance 2 is tensor(856.2686, device='cuda:0')
cal_distance is  tensor(856.2686, device='cuda:0')
cal ratio is  0.10385381990973966
distance 1 is tensor(1234.4010, device='cuda:0')
distance 2 is tensor(88.9268, device='cuda:0')
cal_distance is  tensor(88.9268, device='cuda:0')
cal ratio is  0.32226361291430644
distance 1 is tensor(397.8073, device='cuda:0')
distance 2 is tensor(28.6579, device='cuda:0')
cal_distance is  tensor(28.6579, device='cuda:0')
cal ratio is  0.5676826144584329
distance 1 is tensor(225.8315, device='cuda:0')
distance 2 is tensor(16.2686, device='cuda:0')
cal_distance is  tensor(16.2686, device='cuda:0')
cal ratio is  0.7534471887149875
distance 1 is tensor(170.1539, device='cuda:0')
distance 2 is tensor(12.2575, device='cuda:0')
cal_distance is  tensor(12.2575, device='cuda:0')
cal ratio is  0.8680133701670308
distance 1 is tensor(147.6968, device='cuda:0')
distance 2 is tensor(10.6397, device='cuda:0')
cal_distance is  tensor(10.6397, device='cuda:0')
distance 1 is tensor(147.6968, device='cuda:0')
distance 2 is tensor(10.6397, device='cuda:0')
________________________________
test distance is  tensor(10.6397, device='cuda:0')
test similarity is  tensor(0.9570, device='cuda:0')
test acc is  0.8681500001563225
test loss is 44.43478025912222
test entropy is  0.01978110255140273
________________________________
distance 1 is tensor(147.6968, device='cuda:0')
distance 2 is tensor(10.6397, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.019400142618549287
avg test loss is  44.52684555785742
avg accuracy is  0.8676333334896559
solo acc is  0.18445000015633556
compute similarity  is  tensor(0.9570, device='cuda:0')
compute_distance is  tensor(10.6397, device='cuda:0')
compute_norm is  tensor(56.4508, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(139.7421, device='cuda:0')
distance 2 is tensor(11.7216, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8864456326849679
avg test loss is  1.353790949656765
avg accuracy is  0.8558333334896563
solo acc is  0.3321166668230068
compute similarity  is  tensor(0.9570, device='cuda:0')
compute_distance is  tensor(11.7216, device='cuda:0')
compute_norm is  tensor(55.7189, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.8187, device='cuda:0')
distance 2 is tensor(11.9033, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8641191708253645
avg test loss is  1.420921139117243
avg accuracy is  0.8563666668229897
solo acc is  0.2717166668230055
compute similarity  is  tensor(0.9568, device='cuda:0')
compute_distance is  tensor(11.9033, device='cuda:0')
compute_norm is  tensor(55.4071, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.6452, device='cuda:0')
distance 2 is tensor(12.0218, device='cuda:0')
exit early
distance 1 is tensor(141.6452, device='cuda:0')
distance 2 is tensor(12.0218, device='cuda:0')
________________________________
test distance is  tensor(12.0218, device='cuda:0')
test similarity is  tensor(0.9567, device='cuda:0')
test acc is  0.8567833334896563
test loss is 1.4188455476689694
test entropy is  0.8547051538790721
________________________________
cal ratio is  0.8764806097201209
distance 1 is tensor(124.1501, device='cuda:0')
distance 2 is tensor(10.5369, device='cuda:0')
cal_distance is  tensor(10.5369, device='cuda:0')
distance 1 is tensor(124.1501, device='cuda:0')
distance 2 is tensor(10.5369, device='cuda:0')
________________________________
test distance is  tensor(10.5369, device='cuda:0')
test similarity is  tensor(0.9661, device='cuda:0')
test acc is  0.8682000001563225
test loss is 1.0285330384270723
test entropy is  0.943296475324041
________________________________
distance 1 is tensor(124.1501, device='cuda:0')
distance 2 is tensor(10.5369, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.942547314266152
avg test loss is  1.023498669171384
avg accuracy is  0.8682000001563225
solo acc is  0.526116666823009
compute similarity  is  tensor(0.9661, device='cuda:0')
compute_distance is  tensor(10.5369, device='cuda:0')
compute_norm is  tensor(54.7611, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(126.1297, device='cuda:0')
distance 2 is tensor(10.8296, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8413276791191304
avg test loss is  1.4005219091230363
avg accuracy is  0.8646166668229893
solo acc is  0.25941666682300524
compute similarity  is  tensor(0.9656, device='cuda:0')
compute_distance is  tensor(10.8296, device='cuda:0')
compute_norm is  tensor(54.4714, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(127.2850, device='cuda:0')
distance 2 is tensor(10.9575, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8472499335244266
avg test loss is  1.3770558679027598
avg accuracy is  0.8635666668229894
solo acc is  0.2551500001563384
compute similarity  is  tensor(0.9655, device='cuda:0')
compute_distance is  tensor(10.9575, device='cuda:0')
compute_norm is  tensor(54.1892, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(128.3442, device='cuda:0')
distance 2 is tensor(11.0677, device='cuda:0')
exit early
distance 1 is tensor(128.3442, device='cuda:0')
distance 2 is tensor(11.0677, device='cuda:0')
________________________________
test distance is  tensor(11.0677, device='cuda:0')
test similarity is  tensor(0.9653, device='cuda:0')
test acc is  0.8665666668229891
test loss is 1.3728978032750616
test entropy is  0.8448046531631495
________________________________
distance 1 is tensor(128.3442, device='cuda:0')
distance 2 is tensor(11.0677, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8447077318803587
avg test loss is  1.3729750112429866
avg accuracy is  0.8658000001563226
solo acc is  0.24605000015633816
compute similarity  is  tensor(0.9653, device='cuda:0')
compute_distance is  tensor(11.0677, device='cuda:0')
compute_norm is  tensor(53.9132, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.3829, device='cuda:0')
distance 2 is tensor(11.1651, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8396380020102967
avg test loss is  1.356452693690115
avg accuracy is  0.8683833334896558
solo acc is  0.25091666682300495
compute similarity  is  tensor(0.9652, device='cuda:0')
compute_distance is  tensor(11.1651, device='cuda:0')
compute_norm is  tensor(53.6418, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.4436, device='cuda:0')
distance 2 is tensor(11.2622, device='cuda:0')
exit early
distance 1 is tensor(130.4436, device='cuda:0')
distance 2 is tensor(11.2622, device='cuda:0')
________________________________
test distance is  tensor(11.2622, device='cuda:0')
test similarity is  tensor(0.9651, device='cuda:0')
test acc is  0.8676833334896559
test loss is 1.3480909220191206
test entropy is  0.8379849112237187
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2251594066619873
mal norm is  tensor(6.2776, device='cuda:0')
distance 1 is tensor(130.4436, device='cuda:0')
distance 2 is tensor(11.2622, device='cuda:0')
mal distance is  tensor(11.2622, device='cuda:0')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1340, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.7614, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(420.7515, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(356.6851, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4043e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.6701, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.6559, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.2565, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.7186e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.9510, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.5536, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.2863e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7590, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7383e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.1470, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.5808, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.2036, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.4909, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.3666, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1340e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.1022, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.1605, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.4540, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.8396, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.0049, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.9885, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.3991e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.4246, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.0947e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.8505, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.2994, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.8553, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.2469, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.2314, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.3824e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.3903, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6168e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.9423, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.1917, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.5428, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.7534, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.7763e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.7827, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.8380, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 6
len all weights is 6
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 91.05% 

Test Accuracy: 89.39% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6899569630622864
distance 1 is tensor(123.8007, device='cuda:0')
distance 2 is tensor(9.1423, device='cuda:0')
benign distance is  tensor(9.1423, device='cuda:0')
norm1 res is  tensor(0.1367, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.496940553188324
distance 1 is tensor(113.3331, device='cuda:0')
distance 2 is tensor(8.3618, device='cuda:0')
benign distance is  tensor(8.3618, device='cuda:0')
norm1 res is  tensor(0.1212, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.027290230616927147
distance 1 is tensor(107.7313, device='cuda:0')
distance 2 is tensor(7.8083, device='cuda:0')
benign distance is  tensor(7.8083, device='cuda:0')
norm1 res is  tensor(0.1125, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5263537168502808
distance 1 is tensor(135.3562, device='cuda:0')
distance 2 is tensor(9.7593, device='cuda:0')
benign distance is  tensor(9.7593, device='cuda:0')
norm1 res is  tensor(0.1436, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.4959614872932434
distance 1 is tensor(117.5523, device='cuda:0')
distance 2 is tensor(8.5539, device='cuda:0')
benign distance is  tensor(8.5539, device='cuda:0')
norm1 res is  tensor(0.1211, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.48524969816207886
distance 1 is tensor(131.0377, device='cuda:0')
distance 2 is tensor(9.6301, device='cuda:0')
benign distance is  tensor(9.6301, device='cuda:0')
norm1 res is  tensor(0.1406, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.2866702675819397
distance 1 is tensor(111.3313, device='cuda:0')
distance 2 is tensor(8.2129, device='cuda:0')
benign distance is  tensor(8.2129, device='cuda:0')
norm1 res is  tensor(0.1194, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.3942358195781708
distance 1 is tensor(111.2117, device='cuda:0')
distance 2 is tensor(8.2442, device='cuda:0')
benign distance is  tensor(8.2442, device='cuda:0')
norm1 res is  tensor(0.1244, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.04868067800998688
distance 1 is tensor(136.4982, device='cuda:0')
distance 2 is tensor(10.0715, device='cuda:0')
benign distance is  tensor(10.0715, device='cuda:0')
norm1 res is  tensor(0.1528, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.40308037400245667
distance 1 is tensor(139.0389, device='cuda:0')
distance 2 is tensor(10.2571, device='cuda:0')
benign distance is  tensor(10.2571, device='cuda:0')
norm1 res is  tensor(0.1516, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.3196662366390228
distance 1 is tensor(134.2901, device='cuda:0')
distance 2 is tensor(9.7937, device='cuda:0')
benign distance is  tensor(9.7937, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5763977766036987
distance 1 is tensor(142.9868, device='cuda:0')
distance 2 is tensor(10.3879, device='cuda:0')
benign distance is  tensor(10.3879, device='cuda:0')
norm1 res is  tensor(0.1532, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.2954026162624359
distance 1 is tensor(129.8148, device='cuda:0')
distance 2 is tensor(9.4746, device='cuda:0')
benign distance is  tensor(9.4746, device='cuda:0')
norm1 res is  tensor(0.1402, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.1903626024723053
distance 1 is tensor(122.0179, device='cuda:0')
distance 2 is tensor(8.9672, device='cuda:0')
benign distance is  tensor(8.9672, device='cuda:0')
norm1 res is  tensor(0.1293, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.6290578842163086
distance 1 is tensor(143.3361, device='cuda:0')
distance 2 is tensor(10.5407, device='cuda:0')
benign distance is  tensor(10.5407, device='cuda:0')
norm1 res is  tensor(0.1593, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.6743759512901306
distance 1 is tensor(141.1468, device='cuda:0')
distance 2 is tensor(10.4666, device='cuda:0')
benign distance is  tensor(10.4666, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.041643720120191574
distance 1 is tensor(129.3972, device='cuda:0')
distance 2 is tensor(9.3833, device='cuda:0')
benign distance is  tensor(9.3833, device='cuda:0')
norm1 res is  tensor(0.1394, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.5324801206588745
distance 1 is tensor(140.1158, device='cuda:0')
distance 2 is tensor(10.3265, device='cuda:0')
benign distance is  tensor(10.3265, device='cuda:0')
norm1 res is  tensor(0.1517, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.41643232107162476
distance 1 is tensor(138.6471, device='cuda:0')
distance 2 is tensor(10.1446, device='cuda:0')
benign distance is  tensor(10.1446, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.667178750038147
distance 1 is tensor(122.4991, device='cuda:0')
distance 2 is tensor(9.2936, device='cuda:0')
benign distance is  tensor(9.2936, device='cuda:0')
norm1 res is  tensor(0.1369, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.3154991567134857
distance 1 is tensor(139.0190, device='cuda:0')
distance 2 is tensor(10.3089, device='cuda:0')
benign distance is  tensor(10.3089, device='cuda:0')
norm1 res is  tensor(0.1478, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.41844338178634644
distance 1 is tensor(136.6789, device='cuda:0')
distance 2 is tensor(9.9534, device='cuda:0')
benign distance is  tensor(9.9534, device='cuda:0')
norm1 res is  tensor(0.1473, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.22670714557170868
distance 1 is tensor(137.5231, device='cuda:0')
distance 2 is tensor(10.1860, device='cuda:0')
benign distance is  tensor(10.1860, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.46740469336509705
distance 1 is tensor(140.9117, device='cuda:0')
distance 2 is tensor(10.2602, device='cuda:0')
benign distance is  tensor(10.2602, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.6051155924797058
distance 1 is tensor(138.8894, device='cuda:0')
distance 2 is tensor(10.2007, device='cuda:0')
benign distance is  tensor(10.2007, device='cuda:0')
norm1 res is  tensor(0.1502, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.14733847975730896
distance 1 is tensor(135.1670, device='cuda:0')
distance 2 is tensor(9.7921, device='cuda:0')
benign distance is  tensor(9.7921, device='cuda:0')
norm1 res is  tensor(0.1418, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.21891018748283386
distance 1 is tensor(120.7500, device='cuda:0')
distance 2 is tensor(8.9092, device='cuda:0')
benign distance is  tensor(8.9092, device='cuda:0')
norm1 res is  tensor(0.1287, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.35917890071868896
distance 1 is tensor(136.7762, device='cuda:0')
distance 2 is tensor(10.1238, device='cuda:0')
benign distance is  tensor(10.1238, device='cuda:0')
norm1 res is  tensor(0.1474, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.2451557219028473
distance 1 is tensor(122.1408, device='cuda:0')
distance 2 is tensor(8.9898, device='cuda:0')
benign distance is  tensor(8.9898, device='cuda:0')
norm1 res is  tensor(0.1315, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.5530979037284851
distance 1 is tensor(140.9537, device='cuda:0')
distance 2 is tensor(10.2441, device='cuda:0')
benign distance is  tensor(10.2441, device='cuda:0')
norm1 res is  tensor(0.1495, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.639945387840271
distance 1 is tensor(146.6752, device='cuda:0')
distance 2 is tensor(10.7201, device='cuda:0')
benign distance is  tensor(10.7201, device='cuda:0')
norm1 res is  tensor(0.1571, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.7859419584274292
distance 1 is tensor(132.6389, device='cuda:0')
distance 2 is tensor(9.7181, device='cuda:0')
benign distance is  tensor(9.7181, device='cuda:0')
norm1 res is  tensor(0.1441, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(150.7711, device='cuda:0')
distance 2 is tensor(10.7886, device='cuda:0')
compute distance is  tensor(10.7886, device='cuda:0')
compute norm is  tensor(54.5874, device='cuda:0')
distance 1 is tensor(150.5908, device='cuda:0')
distance 2 is tensor(10.8602, device='cuda:0')
compute distance is  tensor(10.8602, device='cuda:0')
compute norm is  tensor(54.8135, device='cuda:0')
distance 1 is tensor(159.7484, device='cuda:0')
distance 2 is tensor(11.6582, device='cuda:0')
compute distance is  tensor(11.6582, device='cuda:0')
compute norm is  tensor(54.9449, device='cuda:0')
distance 1 is tensor(150.8850, device='cuda:0')
distance 2 is tensor(11.0617, device='cuda:0')
compute distance is  tensor(11.0617, device='cuda:0')
compute norm is  tensor(54.7587, device='cuda:0')
distance 1 is tensor(155.0011, device='cuda:0')
distance 2 is tensor(11.2428, device='cuda:0')
compute distance is  tensor(11.2428, device='cuda:0')
compute norm is  tensor(54.8996, device='cuda:0')
distance 1 is tensor(159.8813, device='cuda:0')
distance 2 is tensor(11.6270, device='cuda:0')
compute distance is  tensor(11.6270, device='cuda:0')
compute norm is  tensor(55.0328, device='cuda:0')
distance 1 is tensor(155.4138, device='cuda:0')
distance 2 is tensor(11.3088, device='cuda:0')
compute distance is  tensor(11.3088, device='cuda:0')
compute norm is  tensor(54.7287, device='cuda:0')
distance 1 is tensor(165.3418, device='cuda:0')
distance 2 is tensor(12.0441, device='cuda:0')
compute distance is  tensor(12.0441, device='cuda:0')
compute norm is  tensor(55.1258, device='cuda:0')
distance 1 is tensor(158.0817, device='cuda:0')
distance 2 is tensor(11.5906, device='cuda:0')
compute distance is  tensor(11.5906, device='cuda:0')
compute norm is  tensor(54.9061, device='cuda:0')
distance 1 is tensor(151.7820, device='cuda:0')
distance 2 is tensor(10.9946, device='cuda:0')
compute distance is  tensor(10.9946, device='cuda:0')
compute norm is  tensor(54.7908, device='cuda:0')
distance 1 is tensor(157.9176, device='cuda:0')
distance 2 is tensor(11.4686, device='cuda:0')
compute distance is  tensor(11.4686, device='cuda:0')
compute norm is  tensor(55.0153, device='cuda:0')
distance 1 is tensor(157.6145, device='cuda:0')
distance 2 is tensor(11.4417, device='cuda:0')
compute distance is  tensor(11.4417, device='cuda:0')
compute norm is  tensor(55.0156, device='cuda:0')
distance Threshold  is  tensor(12.0441, device='cuda:0')
distance 1 is tensor(1102016.7500, device='cuda:0')
distance 2 is tensor(79390.3125, device='cuda:0')
________________________________
test distance is  tensor(79390.3125, device='cuda:0')
test similarity is  tensor(0.1111, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.198356694558563e+17
test entropy is  0.0
________________________________
cal ratio is  0.01108525854141303
distance 1 is tensor(12216.1484, device='cuda:0')
distance 2 is tensor(880.0622, device='cuda:0')
cal_distance is  tensor(880.0622, device='cuda:0')
cal ratio is  0.10528654930721124
distance 1 is tensor(1286.2024, device='cuda:0')
distance 2 is tensor(92.6587, device='cuda:0')
cal_distance is  tensor(92.6587, device='cuda:0')
cal ratio is  0.3244789088581382
distance 1 is tensor(417.3504, device='cuda:0')
distance 2 is tensor(30.0658, device='cuda:0')
cal_distance is  tensor(30.0658, device='cuda:0')
cal ratio is  0.5696305082505627
distance 1 is tensor(237.7386, device='cuda:0')
distance 2 is tensor(17.1264, device='cuda:0')
cal_distance is  tensor(17.1264, device='cuda:0')
cal ratio is  0.7547386732581424
distance 1 is tensor(179.4323, device='cuda:0')
distance 2 is tensor(12.9260, device='cuda:0')
cal_distance is  tensor(12.9260, device='cuda:0')
cal ratio is  0.8687570379507278
distance 1 is tensor(155.8840, device='cuda:0')
distance 2 is tensor(11.2295, device='cuda:0')
cal_distance is  tensor(11.2295, device='cuda:0')
distance 1 is tensor(155.8840, device='cuda:0')
distance 2 is tensor(11.2295, device='cuda:0')
________________________________
test distance is  tensor(11.2295, device='cuda:0')
test similarity is  tensor(0.9516, device='cuda:0')
test acc is  0.8729333334896557
test loss is 48.62222691436312
test entropy is  0.018102766197151177
________________________________
distance 1 is tensor(155.8840, device='cuda:0')
distance 2 is tensor(11.2295, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.018855663818096977
avg test loss is  48.61518847662757
avg accuracy is  0.8731833334896556
solo acc is  0.18646666682300234
compute similarity  is  tensor(0.9516, device='cuda:0')
compute_distance is  tensor(11.2295, device='cuda:0')
compute_norm is  tensor(56.4624, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(146.5102, device='cuda:0')
distance 2 is tensor(12.3178, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9007062139287432
avg test loss is  1.3819562707628523
avg accuracy is  0.856200000156323
solo acc is  0.3198166668230066
compute similarity  is  tensor(0.9519, device='cuda:0')
compute_distance is  tensor(12.3178, device='cuda:0')
compute_norm is  tensor(55.6999, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.5068, device='cuda:0')
distance 2 is tensor(12.4963, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8613669206338651
avg test loss is  1.4533042751395626
avg accuracy is  0.8582333334896564
solo acc is  0.26815000015633883
compute similarity  is  tensor(0.9517, device='cuda:0')
compute_distance is  tensor(12.4963, device='cuda:0')
compute_norm is  tensor(55.3881, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.2622, device='cuda:0')
distance 2 is tensor(12.6148, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.862402612974903
avg test loss is  1.425530944805918
avg accuracy is  0.8594000001563229
solo acc is  0.2602833334896719
compute similarity  is  tensor(0.9516, device='cuda:0')
compute_distance is  tensor(12.6148, device='cuda:0')
compute_norm is  tensor(55.0906, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.0494, device='cuda:0')
distance 2 is tensor(12.7230, device='cuda:0')
exit early
distance 1 is tensor(149.0494, device='cuda:0')
distance 2 is tensor(12.7230, device='cuda:0')
________________________________
test distance is  tensor(12.7230, device='cuda:0')
test similarity is  tensor(0.9514, device='cuda:0')
test acc is  0.8586333334896562
test loss is 1.4273478526042214
test entropy is  0.852868729118091
________________________________
cal ratio is  0.8756576039045926
distance 1 is tensor(130.5170, device='cuda:0')
distance 2 is tensor(11.1410, device='cuda:0')
cal_distance is  tensor(11.1410, device='cuda:0')
distance 1 is tensor(130.5170, device='cuda:0')
distance 2 is tensor(11.1410, device='cuda:0')
________________________________
test distance is  tensor(11.1410, device='cuda:0')
test similarity is  tensor(0.9621, device='cuda:0')
test acc is  0.8701833334896557
test loss is 1.0150815275178027
test entropy is  0.9479546158679767
________________________________
distance 1 is tensor(130.5170, device='cuda:0')
distance 2 is tensor(11.1410, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.948908686892056
avg test loss is  1.0160965591605537
avg accuracy is  0.871266666822989
solo acc is  0.529116666823009
compute similarity  is  tensor(0.9621, device='cuda:0')
compute_distance is  tensor(11.1410, device='cuda:0')
compute_norm is  tensor(54.4539, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.5347, device='cuda:0')
distance 2 is tensor(11.4293, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.840813978775732
avg test loss is  1.3911924970937943
avg accuracy is  0.8698833334896559
solo acc is  0.26025000015633853
compute similarity  is  tensor(0.9616, device='cuda:0')
compute_distance is  tensor(11.4293, device='cuda:0')
compute_norm is  tensor(54.1697, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.7627, device='cuda:0')
distance 2 is tensor(11.5607, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8482523804534473
avg test loss is  1.374059629719903
avg accuracy is  0.8697333334896559
solo acc is  0.25640000015633846
compute similarity  is  tensor(0.9614, device='cuda:0')
compute_distance is  tensor(11.5607, device='cuda:0')
compute_norm is  tensor(53.8894, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.8396, device='cuda:0')
distance 2 is tensor(11.6713, device='cuda:0')
exit early
distance 1 is tensor(134.8396, device='cuda:0')
distance 2 is tensor(11.6713, device='cuda:0')
________________________________
test distance is  tensor(11.6713, device='cuda:0')
test similarity is  tensor(0.9612, device='cuda:0')
test acc is  0.8702500001563224
test loss is 1.3653006999731572
test entropy is  0.8406537420459902
________________________________
distance 1 is tensor(134.8396, device='cuda:0')
distance 2 is tensor(11.6713, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8398456834018357
avg test loss is  1.3693237919797268
avg accuracy is  0.8704833334896557
solo acc is  0.2517000001563383
compute similarity  is  tensor(0.9612, device='cuda:0')
compute_distance is  tensor(11.6713, device='cuda:0')
compute_norm is  tensor(53.6163, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.9240, device='cuda:0')
distance 2 is tensor(11.7743, device='cuda:0')
exit early
distance 1 is tensor(135.9240, device='cuda:0')
distance 2 is tensor(11.7743, device='cuda:0')
________________________________
test distance is  tensor(11.7743, device='cuda:0')
test similarity is  tensor(0.9611, device='cuda:0')
test acc is  0.8724833334896557
test loss is 1.3645187313876934
test entropy is  0.8330679924757496
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3687841892242432
mal norm is  tensor(6.6031, device='cuda:0')
distance 1 is tensor(135.9240, device='cuda:0')
distance 2 is tensor(11.7743, device='cuda:0')
mal distance is  tensor(11.7743, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1122, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.3127, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(480.6438, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.7631e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(447.3483, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.0085, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.0027, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.3605e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.6124, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.9904, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.8158e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(486.9557, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.9241e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.3121, device='cuda:0')
c is  tensor(0.0130, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 85.87% 

Test Accuracy: 84.59% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
 benign loss is  0.48083561658859253
distance 1 is tensor(151.1896, device='cuda:0')
distance 2 is tensor(11.4756, device='cuda:0')
benign distance is  tensor(11.4756, device='cuda:0')
norm1 res is  tensor(0.1570, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.4146901071071625
distance 1 is tensor(181.6471, device='cuda:0')
distance 2 is tensor(13.5184, device='cuda:0')
benign distance is  tensor(13.5184, device='cuda:0')
norm1 res is  tensor(0.1841, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.2692018151283264
distance 1 is tensor(157.7470, device='cuda:0')
distance 2 is tensor(11.9226, device='cuda:0')
benign distance is  tensor(11.9226, device='cuda:0')
norm1 res is  tensor(0.1593, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.285948783159256
distance 1 is tensor(161.4774, device='cuda:0')
distance 2 is tensor(12.2335, device='cuda:0')
benign distance is  tensor(12.2335, device='cuda:0')
norm1 res is  tensor(0.1674, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8399680852890015
distance 1 is tensor(154.9356, device='cuda:0')
distance 2 is tensor(11.9151, device='cuda:0')
benign distance is  tensor(11.9151, device='cuda:0')
norm1 res is  tensor(0.1623, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.48415088653564453
distance 1 is tensor(175.3353, device='cuda:0')
distance 2 is tensor(13.1471, device='cuda:0')
benign distance is  tensor(13.1471, device='cuda:0')
norm1 res is  tensor(0.1802, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.21477007865905762
distance 1 is tensor(143.4547, device='cuda:0')
distance 2 is tensor(10.9107, device='cuda:0')
benign distance is  tensor(10.9107, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.477184921503067
distance 1 is tensor(157.6002, device='cuda:0')
distance 2 is tensor(11.8173, device='cuda:0')
benign distance is  tensor(11.8173, device='cuda:0')
norm1 res is  tensor(0.1620, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(173.9979, device='cuda:0')
distance 2 is tensor(12.7375, device='cuda:0')
compute distance is  tensor(12.7375, device='cuda:0')
compute norm is  tensor(53.9187, device='cuda:0')
distance 1 is tensor(171.7655, device='cuda:0')
distance 2 is tensor(12.7729, device='cuda:0')
compute distance is  tensor(12.7729, device='cuda:0')
compute norm is  tensor(53.8947, device='cuda:0')
distance 1 is tensor(174.0424, device='cuda:0')
distance 2 is tensor(12.9500, device='cuda:0')
compute distance is  tensor(12.9500, device='cuda:0')
compute norm is  tensor(53.9712, device='cuda:0')
distance 1 is tensor(177.4160, device='cuda:0')
distance 2 is tensor(13.0845, device='cuda:0')
compute distance is  tensor(13.0845, device='cuda:0')
compute norm is  tensor(53.9647, device='cuda:0')
distance 1 is tensor(169.5423, device='cuda:0')
distance 2 is tensor(12.7081, device='cuda:0')
compute distance is  tensor(12.7081, device='cuda:0')
compute norm is  tensor(53.9998, device='cuda:0')
distance 1 is tensor(176.6642, device='cuda:0')
distance 2 is tensor(13.1701, device='cuda:0')
compute distance is  tensor(13.1701, device='cuda:0')
compute norm is  tensor(54.1716, device='cuda:0')
distance 1 is tensor(168.5178, device='cuda:0')
distance 2 is tensor(12.5280, device='cuda:0')
compute distance is  tensor(12.5280, device='cuda:0')
compute norm is  tensor(53.7898, device='cuda:0')
distance 1 is tensor(182.4543, device='cuda:0')
distance 2 is tensor(13.5167, device='cuda:0')
compute distance is  tensor(13.5167, device='cuda:0')
compute norm is  tensor(54.2332, device='cuda:0')
distance 1 is tensor(177.3637, device='cuda:0')
distance 2 is tensor(13.0856, device='cuda:0')
compute distance is  tensor(13.0856, device='cuda:0')
compute norm is  tensor(54.1135, device='cuda:0')
distance 1 is tensor(181.8579, device='cuda:0')
distance 2 is tensor(13.4835, device='cuda:0')
compute distance is  tensor(13.4835, device='cuda:0')
compute norm is  tensor(54.2624, device='cuda:0')
distance 1 is tensor(174.5695, device='cuda:0')
distance 2 is tensor(13.0039, device='cuda:0')
compute distance is  tensor(13.0039, device='cuda:0')
compute norm is  tensor(54.1809, device='cuda:0')
distance 1 is tensor(165.4636, device='cuda:0')
distance 2 is tensor(12.1981, device='cuda:0')
compute distance is  tensor(12.1981, device='cuda:0')
compute norm is  tensor(53.8535, device='cuda:0')
distance Threshold  is  tensor(13.5167, device='cuda:0')
distance 1 is tensor(1101948.8750, device='cuda:0')
distance 2 is tensor(79384.6094, device='cuda:0')
________________________________
test distance is  tensor(79384.6094, device='cuda:0')
test similarity is  tensor(0.2849, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.201421003720923e+17
test entropy is  0.0
________________________________
cal ratio is  0.011743838957280137
distance 1 is tensor(12941.1162, device='cuda:0')
distance 2 is tensor(932.2800, device='cuda:0')
cal_distance is  tensor(932.2800, device='cuda:0')
cal ratio is  0.10836899666881049
distance 1 is tensor(1402.4222, device='cuda:0')
distance 2 is tensor(101.0303, device='cuda:0')
cal_distance is  tensor(101.0303, device='cuda:0')
cal ratio is  0.3291944466660588
distance 1 is tensor(461.6744, device='cuda:0')
distance 2 is tensor(33.2586, device='cuda:0')
cal_distance is  tensor(33.2586, device='cuda:0')
cal ratio is  0.5737547147781531
distance 1 is tensor(264.8910, device='cuda:0')
distance 2 is tensor(19.0823, device='cuda:0')
cal_distance is  tensor(19.0823, device='cuda:0')
cal ratio is  0.7574659510787835
distance 1 is tensor(200.6477, device='cuda:0')
distance 2 is tensor(14.4542, device='cuda:0')
cal_distance is  tensor(14.4542, device='cuda:0')
cal ratio is  0.8703251815502043
distance 1 is tensor(174.6297, device='cuda:0')
distance 2 is tensor(12.5798, device='cuda:0')
cal_distance is  tensor(12.5798, device='cuda:0')
distance 1 is tensor(174.6297, device='cuda:0')
distance 2 is tensor(12.5798, device='cuda:0')
________________________________
test distance is  tensor(12.5798, device='cuda:0')
test similarity is  tensor(0.9513, device='cuda:0')
test acc is  0.14031666682299895
test loss is 163.30546724364194
test entropy is  3.6977145213223255e-09
________________________________
distance 1 is tensor(174.6297, device='cuda:0')
distance 2 is tensor(12.5798, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.1150739672238825e-14
avg test loss is  163.4486053564401
avg accuracy is  0.14085000015633234
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9513, device='cuda:0')
compute_distance is  tensor(12.5798, device='cuda:0')
compute_norm is  tensor(58.3286, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(158.0533, device='cuda:0')
distance 2 is tensor(12.6080, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9262048959859145
avg test loss is  1.391253533139666
avg accuracy is  0.5838833334896723
solo acc is  0.3016833334896729
compute similarity  is  tensor(0.9535, device='cuda:0')
compute_distance is  tensor(12.6080, device='cuda:0')
compute_norm is  tensor(57.9324, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(158.0533, device='cuda:0')
distance 2 is tensor(12.6080, device='cuda:0')
________________________________
test distance is  tensor(12.6080, device='cuda:0')
test similarity is  tensor(0.9535, device='cuda:0')
test acc is  0.5867500001563386
test loss is 1.3935462137910604
test entropy is  0.9272369415775291
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4067195653915405
mal norm is  tensor(8.4931, device='cuda:0')
distance 1 is tensor(158.0533, device='cuda:0')
distance 2 is tensor(12.6080, device='cuda:0')
mal distance is  tensor(12.6080, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2381, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.9776, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0025, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.4871, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0025, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.8107, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2352, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.6313, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.6993, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.9990, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0027, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.1279, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.3141, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.7126, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.0550, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4754, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0025, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.4077, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.0209, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.4946, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.2117, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.7374, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(760.2892, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.4509, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0027, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(741.0535, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.7824, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.5468, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.2772, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(779.4670, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.3362, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0028, device='cuda:0')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 91.05% 

Test Accuracy: 89.54% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
 benign loss is  0.18132029473781586
distance 1 is tensor(120.9135, device='cuda:0')
distance 2 is tensor(8.8500, device='cuda:0')
benign distance is  tensor(8.8500, device='cuda:0')
norm1 res is  tensor(0.1285, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6721546053886414
distance 1 is tensor(113.4146, device='cuda:0')
distance 2 is tensor(8.2736, device='cuda:0')
benign distance is  tensor(8.2736, device='cuda:0')
norm1 res is  tensor(0.1178, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.046051282435655594
distance 1 is tensor(92.0441, device='cuda:0')
distance 2 is tensor(6.8869, device='cuda:0')
benign distance is  tensor(6.8869, device='cuda:0')
norm1 res is  tensor(0.0948, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3087479770183563
distance 1 is tensor(124.4680, device='cuda:0')
distance 2 is tensor(9.0685, device='cuda:0')
benign distance is  tensor(9.0685, device='cuda:0')
norm1 res is  tensor(0.1294, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9519028663635254
distance 1 is tensor(130.0725, device='cuda:0')
distance 2 is tensor(9.5348, device='cuda:0')
benign distance is  tensor(9.5348, device='cuda:0')
norm1 res is  tensor(0.1370, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.559391438961029
distance 1 is tensor(131.9976, device='cuda:0')
distance 2 is tensor(9.8013, device='cuda:0')
benign distance is  tensor(9.8013, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.3027366101741791
distance 1 is tensor(121.1564, device='cuda:0')
distance 2 is tensor(8.8805, device='cuda:0')
benign distance is  tensor(8.8805, device='cuda:0')
norm1 res is  tensor(0.1268, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.636839747428894
distance 1 is tensor(111.0976, device='cuda:0')
distance 2 is tensor(8.2574, device='cuda:0')
benign distance is  tensor(8.2574, device='cuda:0')
norm1 res is  tensor(0.1191, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.700348973274231
distance 1 is tensor(122.5383, device='cuda:0')
distance 2 is tensor(9.0349, device='cuda:0')
benign distance is  tensor(9.0349, device='cuda:0')
norm1 res is  tensor(0.1291, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.38776224851608276
distance 1 is tensor(133.4353, device='cuda:0')
distance 2 is tensor(9.7585, device='cuda:0')
benign distance is  tensor(9.7585, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6007068753242493
distance 1 is tensor(138.8785, device='cuda:0')
distance 2 is tensor(10.1487, device='cuda:0')
benign distance is  tensor(10.1487, device='cuda:0')
norm1 res is  tensor(0.1491, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.26569676399230957
distance 1 is tensor(141.5746, device='cuda:0')
distance 2 is tensor(10.4534, device='cuda:0')
benign distance is  tensor(10.4534, device='cuda:0')
norm1 res is  tensor(0.1502, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.5072953104972839
distance 1 is tensor(134.1864, device='cuda:0')
distance 2 is tensor(9.9581, device='cuda:0')
benign distance is  tensor(9.9581, device='cuda:0')
norm1 res is  tensor(0.1452, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.3524406850337982
distance 1 is tensor(126.4032, device='cuda:0')
distance 2 is tensor(9.3032, device='cuda:0')
benign distance is  tensor(9.3032, device='cuda:0')
norm1 res is  tensor(0.1344, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.328553169965744
distance 1 is tensor(131.2152, device='cuda:0')
distance 2 is tensor(9.6378, device='cuda:0')
benign distance is  tensor(9.6378, device='cuda:0')
norm1 res is  tensor(0.1405, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.8772730827331543
distance 1 is tensor(146.5491, device='cuda:0')
distance 2 is tensor(10.7361, device='cuda:0')
benign distance is  tensor(10.7361, device='cuda:0')
norm1 res is  tensor(0.1549, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.5141175985336304
distance 1 is tensor(137.3035, device='cuda:0')
distance 2 is tensor(9.9821, device='cuda:0')
benign distance is  tensor(9.9821, device='cuda:0')
norm1 res is  tensor(0.1446, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.7287818193435669
distance 1 is tensor(136.8662, device='cuda:0')
distance 2 is tensor(9.9858, device='cuda:0')
benign distance is  tensor(9.9858, device='cuda:0')
norm1 res is  tensor(0.1418, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.4460274577140808
distance 1 is tensor(154.7463, device='cuda:0')
distance 2 is tensor(11.3320, device='cuda:0')
benign distance is  tensor(11.3320, device='cuda:0')
norm1 res is  tensor(0.1627, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.6119346618652344
distance 1 is tensor(137.8837, device='cuda:0')
distance 2 is tensor(10.0840, device='cuda:0')
benign distance is  tensor(10.0840, device='cuda:0')
norm1 res is  tensor(0.1461, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.5393652319908142
distance 1 is tensor(139.2625, device='cuda:0')
distance 2 is tensor(10.2374, device='cuda:0')
benign distance is  tensor(10.2374, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.10834624618291855
distance 1 is tensor(131.5762, device='cuda:0')
distance 2 is tensor(9.6537, device='cuda:0')
benign distance is  tensor(9.6537, device='cuda:0')
norm1 res is  tensor(0.1392, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.24958066642284393
distance 1 is tensor(124.9659, device='cuda:0')
distance 2 is tensor(9.1405, device='cuda:0')
benign distance is  tensor(9.1405, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.5035528540611267
distance 1 is tensor(141.4668, device='cuda:0')
distance 2 is tensor(10.4425, device='cuda:0')
benign distance is  tensor(10.4425, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(130.9792, device='cuda:0')
distance 2 is tensor(9.4965, device='cuda:0')
compute distance is  tensor(9.4965, device='cuda:0')
compute norm is  tensor(53.8757, device='cuda:0')
distance 1 is tensor(138.1234, device='cuda:0')
distance 2 is tensor(10.1785, device='cuda:0')
compute distance is  tensor(10.1785, device='cuda:0')
compute norm is  tensor(54.0837, device='cuda:0')
distance 1 is tensor(153.8041, device='cuda:0')
distance 2 is tensor(11.2087, device='cuda:0')
compute distance is  tensor(11.2087, device='cuda:0')
compute norm is  tensor(54.4283, device='cuda:0')
distance 1 is tensor(153.4758, device='cuda:0')
distance 2 is tensor(11.1557, device='cuda:0')
compute distance is  tensor(11.1557, device='cuda:0')
compute norm is  tensor(54.3329, device='cuda:0')
distance 1 is tensor(141.4137, device='cuda:0')
distance 2 is tensor(10.4728, device='cuda:0')
compute distance is  tensor(10.4728, device='cuda:0')
compute norm is  tensor(54.2209, device='cuda:0')
distance 1 is tensor(150.9212, device='cuda:0')
distance 2 is tensor(11.0047, device='cuda:0')
compute distance is  tensor(11.0047, device='cuda:0')
compute norm is  tensor(54.3650, device='cuda:0')
distance 1 is tensor(149.1261, device='cuda:0')
distance 2 is tensor(10.8988, device='cuda:0')
compute distance is  tensor(10.8988, device='cuda:0')
compute norm is  tensor(54.3241, device='cuda:0')
distance 1 is tensor(148.7674, device='cuda:0')
distance 2 is tensor(10.6842, device='cuda:0')
compute distance is  tensor(10.6842, device='cuda:0')
compute norm is  tensor(54.2218, device='cuda:0')
distance 1 is tensor(155.3835, device='cuda:0')
distance 2 is tensor(11.0781, device='cuda:0')
compute distance is  tensor(11.0781, device='cuda:0')
compute norm is  tensor(54.3891, device='cuda:0')
distance 1 is tensor(158.2788, device='cuda:0')
distance 2 is tensor(11.6177, device='cuda:0')
compute distance is  tensor(11.6177, device='cuda:0')
compute norm is  tensor(54.7156, device='cuda:0')
distance 1 is tensor(147.8290, device='cuda:0')
distance 2 is tensor(10.7214, device='cuda:0')
compute distance is  tensor(10.7214, device='cuda:0')
compute norm is  tensor(54.3850, device='cuda:0')
distance 1 is tensor(139.8053, device='cuda:0')
distance 2 is tensor(10.3463, device='cuda:0')
compute distance is  tensor(10.3463, device='cuda:0')
compute norm is  tensor(54.2222, device='cuda:0')
distance Threshold  is  tensor(11.6177, device='cuda:0')
distance 1 is tensor(1101993.8750, device='cuda:0')
distance 2 is tensor(79388.3984, device='cuda:0')
________________________________
test distance is  tensor(79388.3984, device='cuda:0')
test similarity is  tensor(0.1808, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.191855007865185e+17
test entropy is  0.0
________________________________
cal ratio is  0.010887374608206586
distance 1 is tensor(11997.8271, device='cuda:0')
distance 2 is tensor(864.3311, device='cuda:0')
cal_distance is  tensor(864.3311, device='cuda:0')
cal ratio is  0.10434258991429426
distance 1 is tensor(1251.8909, device='cuda:0')
distance 2 is tensor(90.1865, device='cuda:0')
cal_distance is  tensor(90.1865, device='cuda:0')
cal ratio is  0.3230210463451301
distance 1 is tensor(404.3920, device='cuda:0')
distance 2 is tensor(29.1322, device='cuda:0')
cal_distance is  tensor(29.1322, device='cuda:0')
cal ratio is  0.5683493536626081
distance 1 is tensor(229.8390, device='cuda:0')
distance 2 is tensor(16.5572, device='cuda:0')
cal_distance is  tensor(16.5572, device='cuda:0')
cal ratio is  0.7538894568435849
distance 1 is tensor(173.2750, device='cuda:0')
distance 2 is tensor(12.4823, device='cuda:0')
cal_distance is  tensor(12.4823, device='cuda:0')
cal ratio is  0.8682681047296766
distance 1 is tensor(150.4501, device='cuda:0')
distance 2 is tensor(10.8380, device='cuda:0')
cal_distance is  tensor(10.8380, device='cuda:0')
distance 1 is tensor(150.4501, device='cuda:0')
distance 2 is tensor(10.8380, device='cuda:0')
________________________________
test distance is  tensor(10.8380, device='cuda:0')
test similarity is  tensor(0.9576, device='cuda:0')
test acc is  0.8567166668229896
test loss is 48.73417046227689
test entropy is  0.013455500805240245
________________________________
distance 1 is tensor(150.4501, device='cuda:0')
distance 2 is tensor(10.8380, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.013086940031612955
avg test loss is  48.913332774440875
avg accuracy is  0.8574333334896563
solo acc is  0.1422833334896658
compute similarity  is  tensor(0.9576, device='cuda:0')
compute_distance is  tensor(10.8380, device='cuda:0')
compute_norm is  tensor(56.8838, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(141.1748, device='cuda:0')
distance 2 is tensor(11.6656, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8791335783025095
avg test loss is  1.355435589864564
avg accuracy is  0.8495000001563232
solo acc is  0.32020000015634
compute similarity  is  tensor(0.9581, device='cuda:0')
compute_distance is  tensor(11.6656, device='cuda:0')
compute_norm is  tensor(56.2823, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.6114, device='cuda:0')
distance 2 is tensor(11.7975, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8602107842720902
avg test loss is  1.4215059615909926
avg accuracy is  0.84676666682299
solo acc is  0.25971666682300526
compute similarity  is  tensor(0.9580, device='cuda:0')
compute_distance is  tensor(11.7975, device='cuda:0')
compute_norm is  tensor(55.9787, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.9966, device='cuda:0')
distance 2 is tensor(11.8815, device='cuda:0')
exit early
distance 1 is tensor(141.9966, device='cuda:0')
distance 2 is tensor(11.8815, device='cuda:0')
________________________________
test distance is  tensor(11.8815, device='cuda:0')
test similarity is  tensor(0.9579, device='cuda:0')
test acc is  0.8478000001563234
test loss is 1.411198604971107
test entropy is  0.8507689567390027
________________________________
cal ratio is  0.8899504375721589
distance 1 is tensor(126.3707, device='cuda:0')
distance 2 is tensor(10.5740, device='cuda:0')
cal_distance is  tensor(10.5740, device='cuda:0')
distance 1 is tensor(126.3707, device='cuda:0')
distance 2 is tensor(10.5740, device='cuda:0')
________________________________
test distance is  tensor(10.5740, device='cuda:0')
test similarity is  tensor(0.9660, device='cuda:0')
test acc is  0.8605666668229895
test loss is 1.0859304773909197
test entropy is  0.9399171086516716
________________________________
distance 1 is tensor(126.3707, device='cuda:0')
distance 2 is tensor(10.5740, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9404094497532224
avg test loss is  1.087098589584009
avg accuracy is  0.8608166668229895
solo acc is  0.4693166668230085
compute similarity  is  tensor(0.9660, device='cuda:0')
compute_distance is  tensor(10.5740, device='cuda:0')
compute_norm is  tensor(55.3082, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(127.6129, device='cuda:0')
distance 2 is tensor(10.7790, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.843996985317039
avg test loss is  1.3896585603766858
avg accuracy is  0.8555333334896564
solo acc is  0.25736666682300513
compute similarity  is  tensor(0.9657, device='cuda:0')
compute_distance is  tensor(10.7790, device='cuda:0')
compute_norm is  tensor(55.0234, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(128.3606, device='cuda:0')
distance 2 is tensor(10.8743, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8424231426548093
avg test loss is  1.3823828947569516
avg accuracy is  0.8559166668229896
solo acc is  0.24503333348967143
compute similarity  is  tensor(0.9656, device='cuda:0')
compute_distance is  tensor(10.8743, device='cuda:0')
compute_norm is  tensor(54.7441, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.1678, device='cuda:0')
distance 2 is tensor(10.9596, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8406461179256439
avg test loss is  1.3678797736350916
avg accuracy is  0.8575666668229897
solo acc is  0.24733333348967146
compute similarity  is  tensor(0.9655, device='cuda:0')
compute_distance is  tensor(10.9596, device='cuda:0')
compute_norm is  tensor(54.4689, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.9330, device='cuda:0')
distance 2 is tensor(11.0326, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8426189930327157
avg test loss is  1.352838980490719
avg accuracy is  0.8592666668229897
solo acc is  0.24795000015633817
compute similarity  is  tensor(0.9655, device='cuda:0')
compute_distance is  tensor(11.0326, device='cuda:0')
compute_norm is  tensor(54.1988, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.7918, device='cuda:0')
distance 2 is tensor(11.1130, device='cuda:0')
________________________________
test distance is  tensor(11.1130, device='cuda:0')
test similarity is  tensor(0.9654, device='cuda:0')
test acc is  0.8584833334896562
test loss is 1.3524550765053804
test entropy is  0.8375688608902604
________________________________
distance 1 is tensor(130.7918, device='cuda:0')
distance 2 is tensor(11.1130, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8362877523339888
avg test loss is  1.353262399686679
avg accuracy is  0.8591666668229895
solo acc is  0.24093333348967133
compute similarity  is  tensor(0.9654, device='cuda:0')
compute_distance is  tensor(11.1130, device='cuda:0')
compute_norm is  tensor(53.9321, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.6530, device='cuda:0')
distance 2 is tensor(11.1870, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.839196512439866
avg test loss is  1.3405673403475584
avg accuracy is  0.8601666668229895
solo acc is  0.2388666668230046
compute similarity  is  tensor(0.9653, device='cuda:0')
compute_distance is  tensor(11.1870, device='cuda:0')
compute_norm is  tensor(53.6675, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.5167, device='cuda:0')
distance 2 is tensor(11.2583, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8357412676567207
avg test loss is  1.3310358389608388
avg accuracy is  0.8625666668229894
solo acc is  0.24128333348967126
compute similarity  is  tensor(0.9653, device='cuda:0')
compute_distance is  tensor(11.2583, device='cuda:0')
compute_norm is  tensor(53.4060, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.4530, device='cuda:0')
distance 2 is tensor(11.3345, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8298521766911692
avg test loss is  1.3245191011093318
avg accuracy is  0.865733333489656
solo acc is  0.23448333348967104
compute similarity  is  tensor(0.9652, device='cuda:0')
compute_distance is  tensor(11.3345, device='cuda:0')
compute_norm is  tensor(53.1471, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.4389, device='cuda:0')
distance 2 is tensor(11.4145, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8239526387089605
avg test loss is  1.3307993807263974
avg accuracy is  0.8643000001563226
solo acc is  0.23020000015633763
compute similarity  is  tensor(0.9651, device='cuda:0')
compute_distance is  tensor(11.4145, device='cuda:0')
compute_norm is  tensor(52.8906, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.4825, device='cuda:0')
distance 2 is tensor(11.4958, device='cuda:0')
________________________________
test distance is  tensor(11.4958, device='cuda:0')
test similarity is  tensor(0.9651, device='cuda:0')
test acc is  0.8646166668229893
test loss is 1.3212503950987289
test entropy is  0.8246612349934161
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2625095844268799
mal norm is  tensor(6.2575, device='cuda:0')
distance 1 is tensor(135.4825, device='cuda:0')
distance 2 is tensor(11.4958, device='cuda:0')
mal distance is  tensor(11.4958, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1815, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.2372, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(467.9905, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(376.8513, device='cuda:0')
c is  tensor(0.0219, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.4970, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.3386e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.8774, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.1913, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.3665, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.4644e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(460.0801, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.0713e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7545, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.7410, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.2343, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.8441, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.2148, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.3359, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.6966, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.2614, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.5183, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.0202e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.1228, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.4659, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.6319, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.2413, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.2206, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.2321, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.6191, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.8649e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.8089, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 10
len all weights is 10
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 91.02% 

Test Accuracy: 89.63% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
 benign loss is  0.47416773438453674
distance 1 is tensor(106.3305, device='cuda:0')
distance 2 is tensor(8.0055, device='cuda:0')
benign distance is  tensor(8.0055, device='cuda:0')
norm1 res is  tensor(0.1131, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.4810516834259033
distance 1 is tensor(120.3553, device='cuda:0')
distance 2 is tensor(8.7624, device='cuda:0')
benign distance is  tensor(8.7624, device='cuda:0')
norm1 res is  tensor(0.1276, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.23622480034828186
distance 1 is tensor(94.8406, device='cuda:0')
distance 2 is tensor(7.0402, device='cuda:0')
benign distance is  tensor(7.0402, device='cuda:0')
norm1 res is  tensor(0.0992, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3933051526546478
distance 1 is tensor(138.2549, device='cuda:0')
distance 2 is tensor(10.0580, device='cuda:0')
benign distance is  tensor(10.0580, device='cuda:0')
norm1 res is  tensor(0.1475, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.44574838876724243
distance 1 is tensor(127.8069, device='cuda:0')
distance 2 is tensor(9.2949, device='cuda:0')
benign distance is  tensor(9.2949, device='cuda:0')
norm1 res is  tensor(0.1340, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.3081994652748108
distance 1 is tensor(137.1839, device='cuda:0')
distance 2 is tensor(10.0398, device='cuda:0')
benign distance is  tensor(10.0398, device='cuda:0')
norm1 res is  tensor(0.1502, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.05203326791524887
distance 1 is tensor(115.8002, device='cuda:0')
distance 2 is tensor(8.3951, device='cuda:0')
benign distance is  tensor(8.3951, device='cuda:0')
norm1 res is  tensor(0.1218, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5106312036514282
distance 1 is tensor(115.9380, device='cuda:0')
distance 2 is tensor(8.4195, device='cuda:0')
benign distance is  tensor(8.4195, device='cuda:0')
norm1 res is  tensor(0.1253, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.35103654861450195
distance 1 is tensor(127.9798, device='cuda:0')
distance 2 is tensor(9.2838, device='cuda:0')
benign distance is  tensor(9.2838, device='cuda:0')
norm1 res is  tensor(0.1361, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.5495418906211853
distance 1 is tensor(142.4151, device='cuda:0')
distance 2 is tensor(10.4282, device='cuda:0')
benign distance is  tensor(10.4282, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.26055678725242615
distance 1 is tensor(136.7926, device='cuda:0')
distance 2 is tensor(9.9873, device='cuda:0')
benign distance is  tensor(9.9873, device='cuda:0')
norm1 res is  tensor(0.1436, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.0849440097808838
distance 1 is tensor(123.2195, device='cuda:0')
distance 2 is tensor(9.1087, device='cuda:0')
benign distance is  tensor(9.1087, device='cuda:0')
norm1 res is  tensor(0.1334, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.45168155431747437
distance 1 is tensor(127.9614, device='cuda:0')
distance 2 is tensor(9.4026, device='cuda:0')
benign distance is  tensor(9.4026, device='cuda:0')
norm1 res is  tensor(0.1376, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.7175796627998352
distance 1 is tensor(134.3397, device='cuda:0')
distance 2 is tensor(9.7080, device='cuda:0')
benign distance is  tensor(9.7080, device='cuda:0')
norm1 res is  tensor(0.1426, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.070703886449337
distance 1 is tensor(132.6373, device='cuda:0')
distance 2 is tensor(9.7520, device='cuda:0')
benign distance is  tensor(9.7520, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.4698505997657776
distance 1 is tensor(135.4258, device='cuda:0')
distance 2 is tensor(9.8267, device='cuda:0')
benign distance is  tensor(9.8267, device='cuda:0')
norm1 res is  tensor(0.1408, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.30679845809936523
distance 1 is tensor(125.6689, device='cuda:0')
distance 2 is tensor(9.1703, device='cuda:0')
benign distance is  tensor(9.1703, device='cuda:0')
norm1 res is  tensor(0.1325, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.05824725702404976
distance 1 is tensor(121.8886, device='cuda:0')
distance 2 is tensor(8.9980, device='cuda:0')
benign distance is  tensor(8.9980, device='cuda:0')
norm1 res is  tensor(0.1312, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.3211415410041809
distance 1 is tensor(131.5711, device='cuda:0')
distance 2 is tensor(9.5899, device='cuda:0')
benign distance is  tensor(9.5899, device='cuda:0')
norm1 res is  tensor(0.1386, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.21397261321544647
distance 1 is tensor(122.2391, device='cuda:0')
distance 2 is tensor(9.0299, device='cuda:0')
benign distance is  tensor(9.0299, device='cuda:0')
norm1 res is  tensor(0.1313, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.43759506940841675
distance 1 is tensor(137.4807, device='cuda:0')
distance 2 is tensor(9.9263, device='cuda:0')
benign distance is  tensor(9.9263, device='cuda:0')
norm1 res is  tensor(0.1452, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.12258780002593994
distance 1 is tensor(136.1651, device='cuda:0')
distance 2 is tensor(9.9643, device='cuda:0')
benign distance is  tensor(9.9643, device='cuda:0')
norm1 res is  tensor(0.1437, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.36899107694625854
distance 1 is tensor(131.4791, device='cuda:0')
distance 2 is tensor(9.6562, device='cuda:0')
benign distance is  tensor(9.6562, device='cuda:0')
norm1 res is  tensor(0.1414, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.26830625534057617
distance 1 is tensor(135.5692, device='cuda:0')
distance 2 is tensor(9.9526, device='cuda:0')
benign distance is  tensor(9.9526, device='cuda:0')
norm1 res is  tensor(0.1420, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(140.8318, device='cuda:0')
distance 2 is tensor(10.2414, device='cuda:0')
compute distance is  tensor(10.2414, device='cuda:0')
compute norm is  tensor(54.3958, device='cuda:0')
distance 1 is tensor(145.6609, device='cuda:0')
distance 2 is tensor(10.7022, device='cuda:0')
compute distance is  tensor(10.7022, device='cuda:0')
compute norm is  tensor(54.5603, device='cuda:0')
distance 1 is tensor(146.2864, device='cuda:0')
distance 2 is tensor(10.7834, device='cuda:0')
compute distance is  tensor(10.7834, device='cuda:0')
compute norm is  tensor(54.4971, device='cuda:0')
distance 1 is tensor(136.0758, device='cuda:0')
distance 2 is tensor(9.9952, device='cuda:0')
compute distance is  tensor(9.9952, device='cuda:0')
compute norm is  tensor(54.1915, device='cuda:0')
distance 1 is tensor(144.6288, device='cuda:0')
distance 2 is tensor(10.7288, device='cuda:0')
compute distance is  tensor(10.7288, device='cuda:0')
compute norm is  tensor(54.4660, device='cuda:0')
distance 1 is tensor(151.7441, device='cuda:0')
distance 2 is tensor(11.2287, device='cuda:0')
compute distance is  tensor(11.2287, device='cuda:0')
compute norm is  tensor(54.6663, device='cuda:0')
distance 1 is tensor(133.6127, device='cuda:0')
distance 2 is tensor(9.7328, device='cuda:0')
compute distance is  tensor(9.7328, device='cuda:0')
compute norm is  tensor(54.2199, device='cuda:0')
distance 1 is tensor(156.3615, device='cuda:0')
distance 2 is tensor(11.3761, device='cuda:0')
compute distance is  tensor(11.3761, device='cuda:0')
compute norm is  tensor(54.8166, device='cuda:0')
distance 1 is tensor(141.3537, device='cuda:0')
distance 2 is tensor(10.2778, device='cuda:0')
compute distance is  tensor(10.2778, device='cuda:0')
compute norm is  tensor(54.4355, device='cuda:0')
distance 1 is tensor(142.1115, device='cuda:0')
distance 2 is tensor(10.4191, device='cuda:0')
compute distance is  tensor(10.4191, device='cuda:0')
compute norm is  tensor(54.4774, device='cuda:0')
distance 1 is tensor(141.1921, device='cuda:0')
distance 2 is tensor(10.2069, device='cuda:0')
compute distance is  tensor(10.2069, device='cuda:0')
compute norm is  tensor(54.4720, device='cuda:0')
distance 1 is tensor(138.3284, device='cuda:0')
distance 2 is tensor(9.9973, device='cuda:0')
compute distance is  tensor(9.9973, device='cuda:0')
compute norm is  tensor(54.3434, device='cuda:0')
distance Threshold  is  tensor(11.3761, device='cuda:0')
distance 1 is tensor(1102007.8750, device='cuda:0')
distance 2 is tensor(79389.6094, device='cuda:0')
________________________________
test distance is  tensor(79389.6094, device='cuda:0')
test similarity is  tensor(0.1408, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.197040747348983e+17
test entropy is  0.0
________________________________
cal ratio is  0.010773501387010175
distance 1 is tensor(11872.4893, device='cuda:0')
distance 2 is tensor(855.3042, device='cuda:0')
cal_distance is  tensor(855.3042, device='cuda:0')
cal ratio is  0.10379547173470145
distance 1 is tensor(1232.3171, device='cuda:0')
distance 2 is tensor(88.7767, device='cuda:0')
cal_distance is  tensor(88.7767, device='cuda:0')
cal ratio is  0.3221730747841616
distance 1 is tensor(397.0243, device='cuda:0')
distance 2 is tensor(28.6015, device='cuda:0')
cal_distance is  tensor(28.6015, device='cuda:0')
cal ratio is  0.5676029197281066
distance 1 is tensor(225.3553, device='cuda:0')
distance 2 is tensor(16.2343, device='cuda:0')
cal_distance is  tensor(16.2343, device='cuda:0')
cal ratio is  0.7533942580185033
distance 1 is tensor(169.7831, device='cuda:0')
distance 2 is tensor(12.2308, device='cuda:0')
cal_distance is  tensor(12.2308, device='cuda:0')
cal ratio is  0.8679827780838926
distance 1 is tensor(147.3698, device='cuda:0')
distance 2 is tensor(10.6161, device='cuda:0')
cal_distance is  tensor(10.6161, device='cuda:0')
distance 1 is tensor(147.3698, device='cuda:0')
distance 2 is tensor(10.6161, device='cuda:0')
________________________________
test distance is  tensor(10.6161, device='cuda:0')
test similarity is  tensor(0.9579, device='cuda:0')
test acc is  0.881950000156322
test loss is 32.04634688607157
test entropy is  0.030003372138477306
________________________________
distance 1 is tensor(147.3698, device='cuda:0')
distance 2 is tensor(10.6161, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.030006130650040826
avg test loss is  32.04228261081395
avg accuracy is  0.881400000156322
solo acc is  0.24226666682300468
compute similarity  is  tensor(0.9579, device='cuda:0')
compute_distance is  tensor(10.6161, device='cuda:0')
compute_norm is  tensor(56.7273, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(139.3040, device='cuda:0')
distance 2 is tensor(11.6882, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8906249646693151
avg test loss is  1.3429168665459923
avg accuracy is  0.8626000001563228
solo acc is  0.3296000001563401
compute similarity  is  tensor(0.9579, device='cuda:0')
compute_distance is  tensor(11.6882, device='cuda:0')
compute_norm is  tensor(55.9916, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.1948, device='cuda:0')
distance 2 is tensor(11.8643, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8528662225457905
avg test loss is  1.4241689728267157
avg accuracy is  0.8610000001563228
solo acc is  0.26840000015633875
compute similarity  is  tensor(0.9577, device='cuda:0')
compute_distance is  tensor(11.8643, device='cuda:0')
compute_norm is  tensor(55.6797, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.9313, device='cuda:0')
distance 2 is tensor(11.9763, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8500055471844257
avg test loss is  1.408643550837218
avg accuracy is  0.8642500001563226
solo acc is  0.2591000001563385
compute similarity  is  tensor(0.9576, device='cuda:0')
compute_distance is  tensor(11.9763, device='cuda:0')
compute_norm is  tensor(55.3826, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.6052, device='cuda:0')
distance 2 is tensor(12.0729, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8498208776338777
avg test loss is  1.3867450439091176
avg accuracy is  0.8648333334896561
solo acc is  0.254516666823005
compute similarity  is  tensor(0.9575, device='cuda:0')
compute_distance is  tensor(12.0729, device='cuda:0')
compute_norm is  tensor(55.0933, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.3477, device='cuda:0')
distance 2 is tensor(12.1626, device='cuda:0')
________________________________
test distance is  tensor(12.1626, device='cuda:0')
test similarity is  tensor(0.9574, device='cuda:0')
test acc is  0.8654166668229892
test loss is 1.3746087711248824
test entropy is  0.8466133770149654
________________________________
cal ratio is  0.8704139342173091
distance 1 is tensor(123.9022, device='cuda:0')
distance 2 is tensor(10.5865, device='cuda:0')
cal_distance is  tensor(10.5865, device='cuda:0')
distance 1 is tensor(123.9022, device='cuda:0')
distance 2 is tensor(10.5865, device='cuda:0')
________________________________
test distance is  tensor(10.5865, device='cuda:0')
test similarity is  tensor(0.9671, device='cuda:0')
test acc is  0.8779666668229889
test loss is 0.9621019572464388
test entropy is  0.9316346551309517
________________________________
distance 1 is tensor(123.9022, device='cuda:0')
distance 2 is tensor(10.5865, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9322180022308821
avg test loss is  0.9632343576152695
avg accuracy is  0.8784666668229888
solo acc is  0.5615000001563409
compute similarity  is  tensor(0.9671, device='cuda:0')
compute_distance is  tensor(10.5865, device='cuda:0')
compute_norm is  tensor(54.5097, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(125.8762, device='cuda:0')
distance 2 is tensor(10.8726, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8380670525880256
avg test loss is  1.367854255857244
avg accuracy is  0.8742166668229889
solo acc is  0.252866666823005
compute similarity  is  tensor(0.9666, device='cuda:0')
compute_distance is  tensor(10.8726, device='cuda:0')
compute_norm is  tensor(54.2312, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(127.0460, device='cuda:0')
distance 2 is tensor(10.9903, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8365409001231447
avg test loss is  1.355991601181437
avg accuracy is  0.8741666668229889
solo acc is  0.2502666668230049
compute similarity  is  tensor(0.9665, device='cuda:0')
compute_distance is  tensor(10.9903, device='cuda:0')
compute_norm is  tensor(53.9552, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(128.1423, device='cuda:0')
distance 2 is tensor(11.0958, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8342982351398671
avg test loss is  1.3476652537327585
avg accuracy is  0.8753000001563223
solo acc is  0.24418333348967142
compute similarity  is  tensor(0.9663, device='cuda:0')
compute_distance is  tensor(11.0958, device='cuda:0')
compute_norm is  tensor(53.6834, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.2258, device='cuda:0')
distance 2 is tensor(11.1944, device='cuda:0')
exit early
distance 1 is tensor(129.2258, device='cuda:0')
distance 2 is tensor(11.1944, device='cuda:0')
________________________________
test distance is  tensor(11.1944, device='cuda:0')
test similarity is  tensor(0.9662, device='cuda:0')
test acc is  0.8782333334896555
test loss is 1.3439754274354052
test entropy is  0.8291431035695553
________________________________
distance 1 is tensor(129.2258, device='cuda:0')
distance 2 is tensor(11.1944, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8279812323259138
avg test loss is  1.3462426509303071
avg accuracy is  0.8776166668229888
solo acc is  0.24190000015633803
compute similarity  is  tensor(0.9662, device='cuda:0')
compute_distance is  tensor(11.1944, device='cuda:0')
compute_norm is  tensor(53.4170, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.2854, device='cuda:0')
distance 2 is tensor(11.2842, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8247269582011298
avg test loss is  1.3250161096739617
avg accuracy is  0.879800000156322
solo acc is  0.24403333348967135
compute similarity  is  tensor(0.9661, device='cuda:0')
compute_distance is  tensor(11.2842, device='cuda:0')
compute_norm is  tensor(53.1525, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.4079, device='cuda:0')
distance 2 is tensor(11.3746, device='cuda:0')
exit early
distance 1 is tensor(131.4079, device='cuda:0')
distance 2 is tensor(11.3746, device='cuda:0')
________________________________
test distance is  tensor(11.3746, device='cuda:0')
test similarity is  tensor(0.9660, device='cuda:0')
test acc is  0.8832000001563219
test loss is 1.3242891228783613
test entropy is  0.8234323259355671
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2796024084091187
mal norm is  tensor(6.1634, device='cuda:0')
distance 1 is tensor(131.4079, device='cuda:0')
distance 2 is tensor(11.3746, device='cuda:0')
mal distance is  tensor(11.3746, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.0737, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(449.5499, device='cuda:0')
c is  tensor(0.0128, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.5049e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.4527, device='cuda:0')
c is  tensor(0.0121, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.8988e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(395.1286, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.8551e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.4901, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4313e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.2346, device='cuda:0')
c is  tensor(0.0118, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.7051, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(478.1154, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.6301e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(478.6922, device='cuda:0')
c is  tensor(0.0124, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.9433e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.3362, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1979e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.9630, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4122e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.0757, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.5798e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.6980, device='cuda:0')
c is  tensor(0.0111, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.7087e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.1691, device='cuda:0')
c is  tensor(0.0110, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.6388e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.0318, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.4215e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(551.5101, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3684e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.7703, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.1592e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.3754, device='cuda:0')
c is  tensor(0.0108, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 15
len all weights is 15
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 87.70% 

Test Accuracy: 86.10% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8632786870002747
distance 1 is tensor(145.2867, device='cuda:0')
distance 2 is tensor(11.0137, device='cuda:0')
benign distance is  tensor(11.0137, device='cuda:0')
norm1 res is  tensor(0.1502, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7584342956542969
distance 1 is tensor(136.9938, device='cuda:0')
distance 2 is tensor(10.4318, device='cuda:0')
benign distance is  tensor(10.4318, device='cuda:0')
norm1 res is  tensor(0.1418, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.1550268679857254
distance 1 is tensor(158.0651, device='cuda:0')
distance 2 is tensor(11.8249, device='cuda:0')
benign distance is  tensor(11.8249, device='cuda:0')
norm1 res is  tensor(0.1624, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.40810495615005493
distance 1 is tensor(155.6912, device='cuda:0')
distance 2 is tensor(11.6157, device='cuda:0')
benign distance is  tensor(11.6157, device='cuda:0')
norm1 res is  tensor(0.1612, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8044978976249695
distance 1 is tensor(149.8222, device='cuda:0')
distance 2 is tensor(11.1396, device='cuda:0')
benign distance is  tensor(11.1396, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5288212895393372
distance 1 is tensor(159.6354, device='cuda:0')
distance 2 is tensor(11.9701, device='cuda:0')
benign distance is  tensor(11.9701, device='cuda:0')
norm1 res is  tensor(0.1620, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.07463093847036362
distance 1 is tensor(147.1241, device='cuda:0')
distance 2 is tensor(11.0055, device='cuda:0')
benign distance is  tensor(11.0055, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.11375226080417633
distance 1 is tensor(150.0143, device='cuda:0')
distance 2 is tensor(11.2214, device='cuda:0')
benign distance is  tensor(11.2214, device='cuda:0')
norm1 res is  tensor(0.1556, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.35182085633277893
distance 1 is tensor(171.8098, device='cuda:0')
distance 2 is tensor(12.7474, device='cuda:0')
benign distance is  tensor(12.7474, device='cuda:0')
norm1 res is  tensor(0.1767, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.23449429869651794
distance 1 is tensor(157.8960, device='cuda:0')
distance 2 is tensor(11.7979, device='cuda:0')
benign distance is  tensor(11.7979, device='cuda:0')
norm1 res is  tensor(0.1615, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9617633819580078
distance 1 is tensor(156.9751, device='cuda:0')
distance 2 is tensor(11.8254, device='cuda:0')
benign distance is  tensor(11.8254, device='cuda:0')
norm1 res is  tensor(0.1624, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0318790674209595
distance 1 is tensor(175.3471, device='cuda:0')
distance 2 is tensor(13.0047, device='cuda:0')
benign distance is  tensor(13.0047, device='cuda:0')
norm1 res is  tensor(0.1799, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.2569606304168701
distance 1 is tensor(152.2834, device='cuda:0')
distance 2 is tensor(11.5451, device='cuda:0')
benign distance is  tensor(11.5451, device='cuda:0')
norm1 res is  tensor(0.1578, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.03773472458124161
distance 1 is tensor(153.8792, device='cuda:0')
distance 2 is tensor(11.5114, device='cuda:0')
benign distance is  tensor(11.5114, device='cuda:0')
norm1 res is  tensor(0.1576, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.5307630300521851
distance 1 is tensor(154.0138, device='cuda:0')
distance 2 is tensor(11.6849, device='cuda:0')
benign distance is  tensor(11.6849, device='cuda:0')
norm1 res is  tensor(0.1568, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.3739398419857025
distance 1 is tensor(165.0406, device='cuda:0')
distance 2 is tensor(12.4954, device='cuda:0')
benign distance is  tensor(12.4954, device='cuda:0')
norm1 res is  tensor(0.1758, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(178.1644, device='cuda:0')
distance 2 is tensor(13.6297, device='cuda:0')
compute distance is  tensor(13.6297, device='cuda:0')
compute norm is  tensor(54.7786, device='cuda:0')
distance 1 is tensor(179.8798, device='cuda:0')
distance 2 is tensor(13.7468, device='cuda:0')
compute distance is  tensor(13.7468, device='cuda:0')
compute norm is  tensor(54.9904, device='cuda:0')
distance 1 is tensor(191.6364, device='cuda:0')
distance 2 is tensor(14.6033, device='cuda:0')
compute distance is  tensor(14.6033, device='cuda:0')
compute norm is  tensor(55.2009, device='cuda:0')
distance 1 is tensor(188.8525, device='cuda:0')
distance 2 is tensor(14.2328, device='cuda:0')
compute distance is  tensor(14.2328, device='cuda:0')
compute norm is  tensor(55.1193, device='cuda:0')
distance 1 is tensor(184.1207, device='cuda:0')
distance 2 is tensor(13.9782, device='cuda:0')
compute distance is  tensor(13.9782, device='cuda:0')
compute norm is  tensor(55.0427, device='cuda:0')
distance 1 is tensor(181.9364, device='cuda:0')
distance 2 is tensor(13.8308, device='cuda:0')
compute distance is  tensor(13.8308, device='cuda:0')
compute norm is  tensor(55.1171, device='cuda:0')
distance 1 is tensor(180.0847, device='cuda:0')
distance 2 is tensor(13.6802, device='cuda:0')
compute distance is  tensor(13.6802, device='cuda:0')
compute norm is  tensor(55.0170, device='cuda:0')
distance 1 is tensor(190.3214, device='cuda:0')
distance 2 is tensor(14.3772, device='cuda:0')
compute distance is  tensor(14.3772, device='cuda:0')
compute norm is  tensor(55.0932, device='cuda:0')
distance 1 is tensor(189.3413, device='cuda:0')
distance 2 is tensor(14.2538, device='cuda:0')
compute distance is  tensor(14.2538, device='cuda:0')
compute norm is  tensor(55.1973, device='cuda:0')
distance 1 is tensor(180.3796, device='cuda:0')
distance 2 is tensor(13.7299, device='cuda:0')
compute distance is  tensor(13.7299, device='cuda:0')
compute norm is  tensor(55.0390, device='cuda:0')
distance 1 is tensor(194.3055, device='cuda:0')
distance 2 is tensor(14.6387, device='cuda:0')
compute distance is  tensor(14.6387, device='cuda:0')
compute norm is  tensor(55.3226, device='cuda:0')
distance 1 is tensor(185.8112, device='cuda:0')
distance 2 is tensor(14.1505, device='cuda:0')
compute distance is  tensor(14.1505, device='cuda:0')
compute norm is  tensor(55.1809, device='cuda:0')
distance Threshold  is  tensor(14.6387, device='cuda:0')
distance 1 is tensor(1101948.6250, device='cuda:0')
distance 2 is tensor(79384.6719, device='cuda:0')
________________________________
test distance is  tensor(79384.6719, device='cuda:0')
test similarity is  tensor(0.2895, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.20054009329087e+17
test entropy is  0.0
________________________________
cal ratio is  0.01222150837616832
distance 1 is tensor(13467.4805, device='cuda:0')
distance 2 is tensor(970.2004, device='cuda:0')
cal_distance is  tensor(970.2004, device='cuda:0')
cal ratio is  0.1105509332646582
distance 1 is tensor(1488.8489, device='cuda:0')
distance 2 is tensor(107.2566, device='cuda:0')
cal_distance is  tensor(107.2566, device='cuda:0')
cal ratio is  0.3324920138765977
distance 1 is tensor(495.0352, device='cuda:0')
distance 2 is tensor(35.6619, device='cuda:0')
cal_distance is  tensor(35.6619, device='cuda:0')
cal ratio is  0.5766211968293828
distance 1 is tensor(285.4509, device='cuda:0')
distance 2 is tensor(20.5634, device='cuda:0')
cal_distance is  tensor(20.5634, device='cuda:0')
cal ratio is  0.759355703744499
distance 1 is tensor(216.7605, device='cuda:0')
distance 2 is tensor(15.6150, device='cuda:0')
cal_distance is  tensor(15.6150, device='cuda:0')
cal ratio is  0.8714102275361573
distance 1 is tensor(188.8882, device='cuda:0')
distance 2 is tensor(13.6070, device='cuda:0')
cal_distance is  tensor(13.6070, device='cuda:0')
distance 1 is tensor(188.8882, device='cuda:0')
distance 2 is tensor(13.6070, device='cuda:0')
________________________________
test distance is  tensor(13.6070, device='cuda:0')
test similarity is  tensor(0.9447, device='cuda:0')
test acc is  0.1342000001563319
test loss is 230.88140556807204
test entropy is  1.2862082954804668e-21
________________________________
distance 1 is tensor(188.8882, device='cuda:0')
distance 2 is tensor(13.6070, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  3.863646819015017e-21
avg test loss is  230.96431670361744
avg accuracy is  0.13423333348966524
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9447, device='cuda:0')
compute_distance is  tensor(13.6070, device='cuda:0')
compute_norm is  tensor(58.7110, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(170.4796, device='cuda:0')
distance 2 is tensor(13.6726, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9146647129231679
avg test loss is  1.3813182645515083
avg accuracy is  0.6294833334896686
solo acc is  0.3022833334896729
compute similarity  is  tensor(0.9475, device='cuda:0')
compute_distance is  tensor(13.6726, device='cuda:0')
compute_norm is  tensor(58.4123, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(170.4796, device='cuda:0')
distance 2 is tensor(13.6726, device='cuda:0')
________________________________
test distance is  tensor(13.6726, device='cuda:0')
test similarity is  tensor(0.9475, device='cuda:0')
test acc is  0.6274833334896687
test loss is 1.3792892124480023
test entropy is  0.9175107027294793
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.309796690940857
mal norm is  tensor(9.1780, device='cuda:0')
distance 1 is tensor(170.4796, device='cuda:0')
distance 2 is tensor(13.6726, device='cuda:0')
mal distance is  tensor(13.6726, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.2218, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.5188, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.8600, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.7401, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.8101, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.0251, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.8873, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.1779, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.8365, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(917.7960, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
len accept list 8
len all weights is 8
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 90.73% 

Test Accuracy: 89.26% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8512707948684692
distance 1 is tensor(118.2333, device='cuda:0')
distance 2 is tensor(8.8789, device='cuda:0')
benign distance is  tensor(8.8789, device='cuda:0')
norm1 res is  tensor(0.1283, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.20096781849861145
distance 1 is tensor(119.6684, device='cuda:0')
distance 2 is tensor(8.7105, device='cuda:0')
benign distance is  tensor(8.7105, device='cuda:0')
norm1 res is  tensor(0.1229, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.5629411935806274
distance 1 is tensor(126.0550, device='cuda:0')
distance 2 is tensor(9.3055, device='cuda:0')
benign distance is  tensor(9.3055, device='cuda:0')
norm1 res is  tensor(0.1333, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.4893642067909241
distance 1 is tensor(120.9266, device='cuda:0')
distance 2 is tensor(8.9700, device='cuda:0')
benign distance is  tensor(8.9700, device='cuda:0')
norm1 res is  tensor(0.1256, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.3469840884208679
distance 1 is tensor(129.8322, device='cuda:0')
distance 2 is tensor(9.3940, device='cuda:0')
benign distance is  tensor(9.3940, device='cuda:0')
norm1 res is  tensor(0.1337, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5043238401412964
distance 1 is tensor(150.2548, device='cuda:0')
distance 2 is tensor(11.0760, device='cuda:0')
benign distance is  tensor(11.0760, device='cuda:0')
norm1 res is  tensor(0.1569, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.3017202913761139
distance 1 is tensor(123.2663, device='cuda:0')
distance 2 is tensor(8.9233, device='cuda:0')
benign distance is  tensor(8.9233, device='cuda:0')
norm1 res is  tensor(0.1263, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.20238637924194336
distance 1 is tensor(124.8180, device='cuda:0')
distance 2 is tensor(9.1867, device='cuda:0')
benign distance is  tensor(9.1867, device='cuda:0')
norm1 res is  tensor(0.1344, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(167.6676, device='cuda:0')
distance 2 is tensor(12.7393, device='cuda:0')
compute distance is  tensor(12.7393, device='cuda:0')
compute norm is  tensor(54.5407, device='cuda:0')
distance 1 is tensor(167.0958, device='cuda:0')
distance 2 is tensor(12.7070, device='cuda:0')
compute distance is  tensor(12.7070, device='cuda:0')
compute norm is  tensor(54.7386, device='cuda:0')
distance 1 is tensor(187.1565, device='cuda:0')
distance 2 is tensor(14.1932, device='cuda:0')
compute distance is  tensor(14.1932, device='cuda:0')
compute norm is  tensor(55.2843, device='cuda:0')
distance 1 is tensor(171.2504, device='cuda:0')
distance 2 is tensor(12.9708, device='cuda:0')
compute distance is  tensor(12.9708, device='cuda:0')
compute norm is  tensor(54.8130, device='cuda:0')
distance 1 is tensor(171.7664, device='cuda:0')
distance 2 is tensor(13.1437, device='cuda:0')
compute distance is  tensor(13.1437, device='cuda:0')
compute norm is  tensor(54.8033, device='cuda:0')
distance 1 is tensor(176.4232, device='cuda:0')
distance 2 is tensor(13.4312, device='cuda:0')
compute distance is  tensor(13.4312, device='cuda:0')
compute norm is  tensor(55.0570, device='cuda:0')
distance 1 is tensor(170.3827, device='cuda:0')
distance 2 is tensor(13.0498, device='cuda:0')
compute distance is  tensor(13.0498, device='cuda:0')
compute norm is  tensor(54.7211, device='cuda:0')
distance 1 is tensor(184.3411, device='cuda:0')
distance 2 is tensor(13.9224, device='cuda:0')
compute distance is  tensor(13.9224, device='cuda:0')
compute norm is  tensor(55.0643, device='cuda:0')
distance 1 is tensor(172.1183, device='cuda:0')
distance 2 is tensor(13.0976, device='cuda:0')
compute distance is  tensor(13.0976, device='cuda:0')
compute norm is  tensor(54.9493, device='cuda:0')
distance 1 is tensor(169.6193, device='cuda:0')
distance 2 is tensor(12.7433, device='cuda:0')
compute distance is  tensor(12.7433, device='cuda:0')
compute norm is  tensor(54.6783, device='cuda:0')
distance 1 is tensor(178.9910, device='cuda:0')
distance 2 is tensor(13.5787, device='cuda:0')
compute distance is  tensor(13.5787, device='cuda:0')
compute norm is  tensor(55.1423, device='cuda:0')
distance 1 is tensor(178.2597, device='cuda:0')
distance 2 is tensor(13.4827, device='cuda:0')
compute distance is  tensor(13.4827, device='cuda:0')
compute norm is  tensor(55.0846, device='cuda:0')
distance Threshold  is  tensor(14.1932, device='cuda:0')
distance 1 is tensor(1101965.2500, device='cuda:0')
distance 2 is tensor(79386.1641, device='cuda:0')
________________________________
test distance is  tensor(79386.1641, device='cuda:0')
test similarity is  tensor(0.2582, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.196236689909852e+17
test entropy is  0.0
________________________________
cal ratio is  0.012033998801216887
distance 1 is tensor(13261.0566, device='cuda:0')
distance 2 is tensor(955.3331, device='cuda:0')
cal_distance is  tensor(955.3331, device='cuda:0')
cal ratio is  0.10969957972914297
distance 1 is tensor(1454.7388, device='cuda:0')
distance 2 is tensor(104.7996, device='cuda:0')
cal_distance is  tensor(104.7996, device='cuda:0')
cal ratio is  0.3312092965237565
distance 1 is tensor(481.8278, device='cuda:0')
distance 2 is tensor(34.7106, device='cuda:0')
cal_distance is  tensor(34.7106, device='cuda:0')
cal ratio is  0.5755078066276499
distance 1 is tensor(277.2987, device='cuda:0')
distance 2 is tensor(19.9762, device='cuda:0')
cal_distance is  tensor(19.9762, device='cuda:0')
cal ratio is  0.7586223050841334
distance 1 is tensor(210.3667, device='cuda:0')
distance 2 is tensor(15.1544, device='cuda:0')
cal_distance is  tensor(15.1544, device='cuda:0')
cal ratio is  0.8709893312008852
distance 1 is tensor(183.2281, device='cuda:0')
distance 2 is tensor(13.1993, device='cuda:0')
cal_distance is  tensor(13.1993, device='cuda:0')
distance 1 is tensor(183.2281, device='cuda:0')
distance 2 is tensor(13.1993, device='cuda:0')
________________________________
test distance is  tensor(13.1993, device='cuda:0')
test similarity is  tensor(0.9465, device='cuda:0')
test acc is  0.698733333489664
test loss is 156.72164529828882
test entropy is  0.0001389479444862936
________________________________
distance 1 is tensor(183.2281, device='cuda:0')
distance 2 is tensor(13.1993, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.00017390634548131593
avg test loss is  156.60492913707742
avg accuracy is  0.6964000001563309
solo acc is  0.10051666682299863
compute similarity  is  tensor(0.9465, device='cuda:0')
compute_distance is  tensor(13.1993, device='cuda:0')
compute_norm is  tensor(58.8226, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(167.7946, device='cuda:0')
distance 2 is tensor(13.7055, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8909186200419469
avg test loss is  1.363999803310264
avg accuracy is  0.8246500001563242
solo acc is  0.30375000015633963
compute similarity  is  tensor(0.9485, device='cuda:0')
compute_distance is  tensor(13.7055, device='cuda:0')
compute_norm is  tensor(58.4320, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(167.4342, device='cuda:0')
distance 2 is tensor(13.7318, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8494270507460718
avg test loss is  1.446745372911506
avg accuracy is  0.823366666822991
solo acc is  0.24811666682300487
compute similarity  is  tensor(0.9485, device='cuda:0')
compute_distance is  tensor(13.7318, device='cuda:0')
compute_norm is  tensor(58.1197, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(167.0515, device='cuda:0')
distance 2 is tensor(13.7340, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8485546793891932
avg test loss is  1.4310237819960376
avg accuracy is  0.8253000001563242
solo acc is  0.24173333348967135
compute similarity  is  tensor(0.9485, device='cuda:0')
compute_distance is  tensor(13.7340, device='cuda:0')
compute_norm is  tensor(57.8142, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(166.8392, device='cuda:0')
distance 2 is tensor(13.7378, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8486888310167072
avg test loss is  1.4131796708239166
avg accuracy is  0.8251166668229909
solo acc is  0.23666666682300444
compute similarity  is  tensor(0.9485, device='cuda:0')
compute_distance is  tensor(13.7378, device='cuda:0')
compute_norm is  tensor(57.5175, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(166.7698, device='cuda:0')
distance 2 is tensor(13.7459, device='cuda:0')
________________________________
test distance is  tensor(13.7459, device='cuda:0')
test similarity is  tensor(0.9485, device='cuda:0')
test acc is  0.8272000001563242
test loss is 1.4006116198324192
test entropy is  0.8507074643808133
________________________________
distance 1 is tensor(166.7698, device='cuda:0')
distance 2 is tensor(13.7459, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8504369935628447
avg test loss is  1.401568143098339
avg accuracy is  0.8277000001563241
solo acc is  0.23591666682300444
compute similarity  is  tensor(0.9485, device='cuda:0')
compute_distance is  tensor(13.7459, device='cuda:0')
compute_norm is  tensor(57.2277, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(166.7307, device='cuda:0')
distance 2 is tensor(13.7517, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8436000485664238
avg test loss is  1.390527520479678
avg accuracy is  0.8268500001563241
solo acc is  0.23480000015633778
compute similarity  is  tensor(0.9485, device='cuda:0')
compute_distance is  tensor(13.7517, device='cuda:0')
compute_norm is  tensor(56.9448, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(166.8019, device='cuda:0')
distance 2 is tensor(13.7614, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8465202171792353
avg test loss is  1.3771113346634642
avg accuracy is  0.829050000156324
solo acc is  0.23318333348967107
compute similarity  is  tensor(0.9486, device='cuda:0')
compute_distance is  tensor(13.7614, device='cuda:0')
compute_norm is  tensor(56.6646, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(166.9297, device='cuda:0')
distance 2 is tensor(13.7729, device='cuda:0')
exit early
distance 1 is tensor(166.9297, device='cuda:0')
distance 2 is tensor(13.7729, device='cuda:0')
________________________________
test distance is  tensor(13.7729, device='cuda:0')
test similarity is  tensor(0.9486, device='cuda:0')
test acc is  0.8311333334896575
test loss is 1.3727560711822022
test entropy is  0.8305008119103242
________________________________
distance 1 is tensor(166.9297, device='cuda:0')
distance 2 is tensor(13.7729, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.830146707959775
avg test loss is  1.370161179667597
avg accuracy is  0.8304000001563241
solo acc is  0.23681666682300448
compute similarity  is  tensor(0.9486, device='cuda:0')
compute_distance is  tensor(13.7729, device='cuda:0')
compute_norm is  tensor(56.3868, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(167.1345, device='cuda:0')
distance 2 is tensor(13.7927, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8430979449484648
avg test loss is  1.3630540480237525
avg accuracy is  0.8303333334896574
solo acc is  0.2284000001563375
compute similarity  is  tensor(0.9486, device='cuda:0')
compute_distance is  tensor(13.7927, device='cuda:0')
compute_norm is  tensor(56.1119, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(167.3853, device='cuda:0')
distance 2 is tensor(13.8133, device='cuda:0')
exit early
distance 1 is tensor(167.3853, device='cuda:0')
distance 2 is tensor(13.8133, device='cuda:0')
________________________________
test distance is  tensor(13.8133, device='cuda:0')
test similarity is  tensor(0.9486, device='cuda:0')
test acc is  0.8338166668229906
test loss is 1.359406766352623
test entropy is  0.829301959733719
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.319746732711792
mal norm is  tensor(8.3619, device='cuda:0')
distance 1 is tensor(167.3853, device='cuda:0')
distance 2 is tensor(13.8133, device='cuda:0')
mal distance is  tensor(13.8133, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2144, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.2154, device='cuda:0')
c is  tensor(0.0207, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.3908e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.5115, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4187e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.9437, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(496.0626, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(515.2974, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.3932, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.3393, device='cuda:0')
c is  tensor(0.0207, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.9014, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2149e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1935, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.4648, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.2682, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.0082, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7996, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.4597, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.1795, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.5829e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(785.5876, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.0423e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.7745, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.8398, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1401e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.0743, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.2640e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.8968, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.6230, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.2335, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.8018, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.1411e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.1812, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.3177, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.2204, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.4121, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.3353e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.6133, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.9500, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.9736, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.4631, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.6304e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.7825, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.8215, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.6251, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.3864, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.3577e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.3420, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.3487, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.1094, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.3300, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1949e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.5487, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.5805, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 18
len all weights is 18
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 91.05% 

Test Accuracy: 89.61% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4524022042751312
distance 1 is tensor(98.2908, device='cuda:0')
distance 2 is tensor(7.3366, device='cuda:0')
benign distance is  tensor(7.3366, device='cuda:0')
norm1 res is  tensor(0.1045, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.4754837453365326
distance 1 is tensor(117.4562, device='cuda:0')
distance 2 is tensor(8.5200, device='cuda:0')
benign distance is  tensor(8.5200, device='cuda:0')
norm1 res is  tensor(0.1222, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.11208252608776093
distance 1 is tensor(80.3968, device='cuda:0')
distance 2 is tensor(5.9702, device='cuda:0')
benign distance is  tensor(5.9702, device='cuda:0')
norm1 res is  tensor(0.0851, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.4091860353946686
distance 1 is tensor(128.7002, device='cuda:0')
distance 2 is tensor(9.3106, device='cuda:0')
benign distance is  tensor(9.3106, device='cuda:0')
norm1 res is  tensor(0.1340, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5444509387016296
distance 1 is tensor(121.1911, device='cuda:0')
distance 2 is tensor(9.0051, device='cuda:0')
benign distance is  tensor(9.0051, device='cuda:0')
norm1 res is  tensor(0.1307, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5447779297828674
distance 1 is tensor(148.5999, device='cuda:0')
distance 2 is tensor(10.8194, device='cuda:0')
benign distance is  tensor(10.8194, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.41602659225463867
distance 1 is tensor(127.5665, device='cuda:0')
distance 2 is tensor(9.3170, device='cuda:0')
benign distance is  tensor(9.3170, device='cuda:0')
norm1 res is  tensor(0.1334, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5643020868301392
distance 1 is tensor(111.4211, device='cuda:0')
distance 2 is tensor(8.4119, device='cuda:0')
benign distance is  tensor(8.4119, device='cuda:0')
norm1 res is  tensor(0.1210, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.5540458559989929
distance 1 is tensor(131.5624, device='cuda:0')
distance 2 is tensor(9.5705, device='cuda:0')
benign distance is  tensor(9.5705, device='cuda:0')
norm1 res is  tensor(0.1381, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.22182360291481018
distance 1 is tensor(127.0022, device='cuda:0')
distance 2 is tensor(9.3291, device='cuda:0')
benign distance is  tensor(9.3291, device='cuda:0')
norm1 res is  tensor(0.1366, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.5995334386825562
distance 1 is tensor(134.6537, device='cuda:0')
distance 2 is tensor(9.8429, device='cuda:0')
benign distance is  tensor(9.8429, device='cuda:0')
norm1 res is  tensor(0.1414, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.34404948353767395
distance 1 is tensor(138.3149, device='cuda:0')
distance 2 is tensor(10.1443, device='cuda:0')
benign distance is  tensor(10.1443, device='cuda:0')
norm1 res is  tensor(0.1461, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.6290887594223022
distance 1 is tensor(127.6147, device='cuda:0')
distance 2 is tensor(9.3594, device='cuda:0')
benign distance is  tensor(9.3594, device='cuda:0')
norm1 res is  tensor(0.1360, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.828272819519043
distance 1 is tensor(132.4436, device='cuda:0')
distance 2 is tensor(9.7710, device='cuda:0')
benign distance is  tensor(9.7710, device='cuda:0')
norm1 res is  tensor(0.1414, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.4962430000305176
distance 1 is tensor(139.2276, device='cuda:0')
distance 2 is tensor(10.2101, device='cuda:0')
benign distance is  tensor(10.2101, device='cuda:0')
norm1 res is  tensor(0.1475, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.2991665303707123
distance 1 is tensor(138.9928, device='cuda:0')
distance 2 is tensor(10.2320, device='cuda:0')
benign distance is  tensor(10.2320, device='cuda:0')
norm1 res is  tensor(0.1497, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.07897041738033295
distance 1 is tensor(127.7222, device='cuda:0')
distance 2 is tensor(9.3630, device='cuda:0')
benign distance is  tensor(9.3630, device='cuda:0')
norm1 res is  tensor(0.1377, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.16807660460472107
distance 1 is tensor(148.0551, device='cuda:0')
distance 2 is tensor(10.8167, device='cuda:0')
benign distance is  tensor(10.8167, device='cuda:0')
norm1 res is  tensor(0.1573, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.279213011264801
distance 1 is tensor(150.4048, device='cuda:0')
distance 2 is tensor(11.0652, device='cuda:0')
benign distance is  tensor(11.0652, device='cuda:0')
norm1 res is  tensor(0.1593, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.3680647909641266
distance 1 is tensor(123.1393, device='cuda:0')
distance 2 is tensor(9.0519, device='cuda:0')
benign distance is  tensor(9.0519, device='cuda:0')
norm1 res is  tensor(0.1300, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.4901813864707947
distance 1 is tensor(135.2936, device='cuda:0')
distance 2 is tensor(9.9135, device='cuda:0')
benign distance is  tensor(9.9135, device='cuda:0')
norm1 res is  tensor(0.1405, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.3882594704627991
distance 1 is tensor(134.6244, device='cuda:0')
distance 2 is tensor(9.8161, device='cuda:0')
benign distance is  tensor(9.8161, device='cuda:0')
norm1 res is  tensor(0.1401, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.45596179366111755
distance 1 is tensor(137.8451, device='cuda:0')
distance 2 is tensor(10.0154, device='cuda:0')
benign distance is  tensor(10.0154, device='cuda:0')
norm1 res is  tensor(0.1461, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.2916383147239685
distance 1 is tensor(138.6996, device='cuda:0')
distance 2 is tensor(10.0416, device='cuda:0')
benign distance is  tensor(10.0416, device='cuda:0')
norm1 res is  tensor(0.1440, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.3841211199760437
distance 1 is tensor(130.0059, device='cuda:0')
distance 2 is tensor(9.5060, device='cuda:0')
benign distance is  tensor(9.5060, device='cuda:0')
norm1 res is  tensor(0.1369, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.29671651124954224
distance 1 is tensor(134.3267, device='cuda:0')
distance 2 is tensor(9.7669, device='cuda:0')
benign distance is  tensor(9.7669, device='cuda:0')
norm1 res is  tensor(0.1380, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.1694193333387375
distance 1 is tensor(142.0874, device='cuda:0')
distance 2 is tensor(10.4514, device='cuda:0')
benign distance is  tensor(10.4514, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.11186834424734116
distance 1 is tensor(145.9396, device='cuda:0')
distance 2 is tensor(10.6385, device='cuda:0')
benign distance is  tensor(10.6385, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.7632623314857483
distance 1 is tensor(133.4917, device='cuda:0')
distance 2 is tensor(9.8513, device='cuda:0')
benign distance is  tensor(9.8513, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.5464207530021667
distance 1 is tensor(137.7450, device='cuda:0')
distance 2 is tensor(10.1349, device='cuda:0')
benign distance is  tensor(10.1349, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.4651121199131012
distance 1 is tensor(132.6402, device='cuda:0')
distance 2 is tensor(9.6445, device='cuda:0')
benign distance is  tensor(9.6445, device='cuda:0')
norm1 res is  tensor(0.1407, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.28634974360466003
distance 1 is tensor(135.9220, device='cuda:0')
distance 2 is tensor(10.1553, device='cuda:0')
benign distance is  tensor(10.1553, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.2184005081653595
distance 1 is tensor(132.7354, device='cuda:0')
distance 2 is tensor(9.8546, device='cuda:0')
benign distance is  tensor(9.8546, device='cuda:0')
norm1 res is  tensor(0.1402, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.19948355853557587
distance 1 is tensor(127.0872, device='cuda:0')
distance 2 is tensor(9.2164, device='cuda:0')
benign distance is  tensor(9.2164, device='cuda:0')
norm1 res is  tensor(0.1340, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.0441696643829346
distance 1 is tensor(122.9462, device='cuda:0')
distance 2 is tensor(9.0530, device='cuda:0')
benign distance is  tensor(9.0530, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.14824117720127106
distance 1 is tensor(144.8405, device='cuda:0')
distance 2 is tensor(10.7304, device='cuda:0')
benign distance is  tensor(10.7304, device='cuda:0')
norm1 res is  tensor(0.1533, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.4411551356315613
distance 1 is tensor(128.5617, device='cuda:0')
distance 2 is tensor(9.4458, device='cuda:0')
benign distance is  tensor(9.4458, device='cuda:0')
norm1 res is  tensor(0.1377, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.8911207914352417
distance 1 is tensor(148.2951, device='cuda:0')
distance 2 is tensor(10.7752, device='cuda:0')
benign distance is  tensor(10.7752, device='cuda:0')
norm1 res is  tensor(0.1529, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.9389883279800415
distance 1 is tensor(144.7820, device='cuda:0')
distance 2 is tensor(10.5058, device='cuda:0')
benign distance is  tensor(10.5058, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.32453879714012146
distance 1 is tensor(153.1825, device='cuda:0')
distance 2 is tensor(10.9694, device='cuda:0')
benign distance is  tensor(10.9694, device='cuda:0')
norm1 res is  tensor(0.1584, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(162.0083, device='cuda:0')
distance 2 is tensor(11.8009, device='cuda:0')
compute distance is  tensor(11.8009, device='cuda:0')
compute norm is  tensor(54.9688, device='cuda:0')
distance 1 is tensor(166.9449, device='cuda:0')
distance 2 is tensor(12.1727, device='cuda:0')
compute distance is  tensor(12.1727, device='cuda:0')
compute norm is  tensor(55.1457, device='cuda:0')
distance 1 is tensor(174.0228, device='cuda:0')
distance 2 is tensor(12.6791, device='cuda:0')
compute distance is  tensor(12.6791, device='cuda:0')
compute norm is  tensor(55.2160, device='cuda:0')
distance 1 is tensor(166.2789, device='cuda:0')
distance 2 is tensor(12.2548, device='cuda:0')
compute distance is  tensor(12.2548, device='cuda:0')
compute norm is  tensor(54.9527, device='cuda:0')
distance 1 is tensor(177.4659, device='cuda:0')
distance 2 is tensor(12.8592, device='cuda:0')
compute distance is  tensor(12.8592, device='cuda:0')
compute norm is  tensor(55.4232, device='cuda:0')
distance 1 is tensor(183.6145, device='cuda:0')
distance 2 is tensor(13.2621, device='cuda:0')
compute distance is  tensor(13.2621, device='cuda:0')
compute norm is  tensor(55.5760, device='cuda:0')
distance 1 is tensor(173.9051, device='cuda:0')
distance 2 is tensor(12.7788, device='cuda:0')
compute distance is  tensor(12.7788, device='cuda:0')
compute norm is  tensor(55.1868, device='cuda:0')
distance 1 is tensor(177.9941, device='cuda:0')
distance 2 is tensor(13.0367, device='cuda:0')
compute distance is  tensor(13.0367, device='cuda:0')
compute norm is  tensor(55.3847, device='cuda:0')
distance 1 is tensor(190.5913, device='cuda:0')
distance 2 is tensor(13.7258, device='cuda:0')
compute distance is  tensor(13.7258, device='cuda:0')
compute norm is  tensor(55.7038, device='cuda:0')
distance 1 is tensor(171.4021, device='cuda:0')
distance 2 is tensor(12.5239, device='cuda:0')
compute distance is  tensor(12.5239, device='cuda:0')
compute norm is  tensor(55.1842, device='cuda:0')
distance 1 is tensor(173.1371, device='cuda:0')
distance 2 is tensor(12.7378, device='cuda:0')
compute distance is  tensor(12.7378, device='cuda:0')
compute norm is  tensor(55.4047, device='cuda:0')
distance 1 is tensor(165.8622, device='cuda:0')
distance 2 is tensor(12.2037, device='cuda:0')
compute distance is  tensor(12.2037, device='cuda:0')
compute norm is  tensor(54.9140, device='cuda:0')
distance Threshold  is  tensor(13.7258, device='cuda:0')
distance 1 is tensor(1101994.1250, device='cuda:0')
distance 2 is tensor(79388.5312, device='cuda:0')
________________________________
test distance is  tensor(79388.5312, device='cuda:0')
test similarity is  tensor(0.1830, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.196226046449745e+17
test entropy is  0.0
________________________________
cal ratio is  0.011834023573631152
distance 1 is tensor(13041.0293, device='cuda:0')
distance 2 is tensor(939.4858, device='cuda:0')
cal_distance is  tensor(939.4858, device='cuda:0')
cal ratio is  0.10878429582176036
distance 1 is tensor(1418.6658, device='cuda:0')
distance 2 is tensor(102.2013, device='cuda:0')
cal_distance is  tensor(102.2013, device='cuda:0')
cal ratio is  0.32982466610410394
distance 1 is tensor(467.9157, device='cuda:0')
distance 2 is tensor(33.7085, device='cuda:0')
cal_distance is  tensor(33.7085, device='cuda:0')
cal ratio is  0.5743035958334951
distance 1 is tensor(268.7288, device='cuda:0')
distance 2 is tensor(19.3589, device='cuda:0')
cal_distance is  tensor(19.3589, device='cuda:0')
cal ratio is  0.7578282498168276
distance 1 is tensor(203.6520, device='cuda:0')
distance 2 is tensor(14.6707, device='cuda:0')
cal_distance is  tensor(14.6707, device='cuda:0')
cal ratio is  0.8705333477449214
distance 1 is tensor(177.2868, device='cuda:0')
distance 2 is tensor(12.7714, device='cuda:0')
cal_distance is  tensor(12.7714, device='cuda:0')
distance 1 is tensor(177.2868, device='cuda:0')
distance 2 is tensor(12.7714, device='cuda:0')
________________________________
test distance is  tensor(12.7714, device='cuda:0')
test similarity is  tensor(0.9446, device='cuda:0')
test acc is  0.8470833334896567
test loss is 99.8895198195728
test entropy is  0.003929457106266902
________________________________
distance 1 is tensor(177.2868, device='cuda:0')
distance 2 is tensor(12.7714, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0038953607270016937
avg test loss is  99.40930905372603
avg accuracy is  0.84671666682299
solo acc is  0.11555000015633193
compute similarity  is  tensor(0.9446, device='cuda:0')
compute_distance is  tensor(12.7714, device='cuda:0')
compute_norm is  tensor(58.0867, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(163.3173, device='cuda:0')
distance 2 is tensor(13.4938, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8922746570379749
avg test loss is  1.358100542190995
avg accuracy is  0.856150000156323
solo acc is  0.3235166668230067
compute similarity  is  tensor(0.9460, device='cuda:0')
compute_distance is  tensor(13.4938, device='cuda:0')
compute_norm is  tensor(57.5137, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(163.4996, device='cuda:0')
distance 2 is tensor(13.5996, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8588334957419682
avg test loss is  1.4457138944536383
avg accuracy is  0.8549333334896564
solo acc is  0.25901666682300517
compute similarity  is  tensor(0.9459, device='cuda:0')
compute_distance is  tensor(13.5996, device='cuda:0')
compute_norm is  tensor(57.2011, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(163.6769, device='cuda:0')
distance 2 is tensor(13.6631, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8555171856366749
avg test loss is  1.4279649783807522
avg accuracy is  0.8559000001563231
solo acc is  0.25050000015633833
compute similarity  is  tensor(0.9458, device='cuda:0')
compute_distance is  tensor(13.6631, device='cuda:0')
compute_norm is  tensor(56.8981, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(163.8456, device='cuda:0')
distance 2 is tensor(13.7117, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8523201512248277
avg test loss is  1.404162456358928
avg accuracy is  0.8567666668229896
solo acc is  0.25026666682300486
compute similarity  is  tensor(0.9458, device='cuda:0')
compute_distance is  tensor(13.7117, device='cuda:0')
compute_norm is  tensor(56.6023, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(164.1281, device='cuda:0')
distance 2 is tensor(13.7603, device='cuda:0')
________________________________
test distance is  tensor(13.7603, device='cuda:0')
test similarity is  tensor(0.9457, device='cuda:0')
test acc is  0.8599333334896562
test loss is 1.3975999050303054
test entropy is  0.8420174839272936
________________________________
cal ratio is  0.8988707252563123
distance 1 is tensor(147.5307, device='cuda:0')
distance 2 is tensor(12.3687, device='cuda:0')
cal_distance is  tensor(12.3687, device='cuda:0')
distance 1 is tensor(147.5307, device='cuda:0')
distance 2 is tensor(12.3687, device='cuda:0')
________________________________
test distance is  tensor(12.3687, device='cuda:0')
test similarity is  tensor(0.9552, device='cuda:0')
test acc is  0.8693833334896558
test loss is 1.07885672059903
test entropy is  0.9279547350874333
________________________________
distance 1 is tensor(147.5307, device='cuda:0')
distance 2 is tensor(12.3687, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.928777728698401
avg test loss is  1.082449326001759
avg accuracy is  0.8687333334896559
solo acc is  0.456633333489675
compute similarity  is  tensor(0.9552, device='cuda:0')
compute_distance is  tensor(12.3687, device='cuda:0')
compute_norm is  tensor(55.9076, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.6542, device='cuda:0')
distance 2 is tensor(12.5509, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.841750059237104
avg test loss is  1.3709052561569823
avg accuracy is  0.865733333489656
solo acc is  0.2498166668230049
compute similarity  is  tensor(0.9549, device='cuda:0')
compute_distance is  tensor(12.5509, device='cuda:0')
compute_norm is  tensor(55.6268, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.3578, device='cuda:0')
distance 2 is tensor(12.6276, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8346082315261938
avg test loss is  1.3623808539752513
avg accuracy is  0.8680666668229892
solo acc is  0.24978333348967155
compute similarity  is  tensor(0.9548, device='cuda:0')
compute_distance is  tensor(12.6276, device='cuda:0')
compute_norm is  tensor(55.3470, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.0637, device='cuda:0')
distance 2 is tensor(12.6953, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8343412751582131
avg test loss is  1.3563554178931312
avg accuracy is  0.8693166668229891
solo acc is  0.24410000015633815
compute similarity  is  tensor(0.9547, device='cuda:0')
compute_distance is  tensor(12.6953, device='cuda:0')
compute_norm is  tensor(55.0710, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.7356, device='cuda:0')
distance 2 is tensor(12.7576, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8397861510705846
avg test loss is  1.3412760884395794
avg accuracy is  0.8700833334896558
solo acc is  0.24295000015633803
compute similarity  is  tensor(0.9546, device='cuda:0')
compute_distance is  tensor(12.7576, device='cuda:0')
compute_norm is  tensor(54.7986, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.4842, device='cuda:0')
distance 2 is tensor(12.8201, device='cuda:0')
________________________________
test distance is  tensor(12.8201, device='cuda:0')
test similarity is  tensor(0.9546, device='cuda:0')
test acc is  0.8703500001563224
test loss is 1.3395459978565225
test entropy is  0.8279134485640252
________________________________
distance 1 is tensor(151.4842, device='cuda:0')
distance 2 is tensor(12.8201, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8287461943972085
avg test loss is  1.3371597809323879
avg accuracy is  0.870316666822989
solo acc is  0.24193333348967136
compute similarity  is  tensor(0.9546, device='cuda:0')
compute_distance is  tensor(12.8201, device='cuda:0')
compute_norm is  tensor(54.5303, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.2395, device='cuda:0')
distance 2 is tensor(12.8842, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8327175408029861
avg test loss is  1.3294360175697026
avg accuracy is  0.872116666822989
solo acc is  0.2392333334896713
compute similarity  is  tensor(0.9545, device='cuda:0')
compute_distance is  tensor(12.8842, device='cuda:0')
compute_norm is  tensor(54.2642, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.0416, device='cuda:0')
distance 2 is tensor(12.9490, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8224560446195257
avg test loss is  1.3355567541712128
avg accuracy is  0.8707166668229891
solo acc is  0.22960000015633755
compute similarity  is  tensor(0.9544, device='cuda:0')
compute_distance is  tensor(12.9490, device='cuda:0')
compute_norm is  tensor(54.0024, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.9012, device='cuda:0')
distance 2 is tensor(13.0140, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8198349133991738
avg test loss is  1.3195193010860924
avg accuracy is  0.8756333334896556
solo acc is  0.2344166668230045
compute similarity  is  tensor(0.9544, device='cuda:0')
compute_distance is  tensor(13.0140, device='cuda:0')
compute_norm is  tensor(53.7412, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.7958, device='cuda:0')
distance 2 is tensor(13.0830, device='cuda:0')
exit early
distance 1 is tensor(154.7958, device='cuda:0')
distance 2 is tensor(13.0830, device='cuda:0')
________________________________
test distance is  tensor(13.0830, device='cuda:0')
test similarity is  tensor(0.9543, device='cuda:0')
test acc is  0.8744000001563222
test loss is 1.321620489869799
test entropy is  0.8176263648945131
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 0.9992188215255737
mal norm is  tensor(7.3125, device='cuda:0')
distance 1 is tensor(154.7958, device='cuda:0')
distance 2 is tensor(13.0830, device='cuda:0')
mal distance is  tensor(13.0830, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1336, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(407.4610, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.1224e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(484.0202, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(327.7661, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.3262, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(516.7354, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.1889, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(526.3481, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(475.4135, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.4081e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.2510, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6506e-05, device='cuda:0')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 85.61% 

Test Accuracy: 84.26% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
 benign loss is  0.34266218543052673
distance 1 is tensor(164.2643, device='cuda:0')
distance 2 is tensor(12.5235, device='cuda:0')
benign distance is  tensor(12.5235, device='cuda:0')
norm1 res is  tensor(0.1714, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.0312131643295288
distance 1 is tensor(166.8381, device='cuda:0')
distance 2 is tensor(12.6600, device='cuda:0')
benign distance is  tensor(12.6600, device='cuda:0')
norm1 res is  tensor(0.1691, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.22141234576702118
distance 1 is tensor(164.3790, device='cuda:0')
distance 2 is tensor(12.3909, device='cuda:0')
benign distance is  tensor(12.3909, device='cuda:0')
norm1 res is  tensor(0.1653, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6268843412399292
distance 1 is tensor(180.2656, device='cuda:0')
distance 2 is tensor(13.5726, device='cuda:0')
benign distance is  tensor(13.5726, device='cuda:0')
norm1 res is  tensor(0.1823, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.387293815612793
distance 1 is tensor(151.0839, device='cuda:0')
distance 2 is tensor(11.4367, device='cuda:0')
benign distance is  tensor(11.4367, device='cuda:0')
norm1 res is  tensor(0.1536, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7832578420639038
distance 1 is tensor(183.1115, device='cuda:0')
distance 2 is tensor(13.7456, device='cuda:0')
benign distance is  tensor(13.7456, device='cuda:0')
norm1 res is  tensor(0.1836, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.3444739878177643
distance 1 is tensor(157.5374, device='cuda:0')
distance 2 is tensor(11.8737, device='cuda:0')
benign distance is  tensor(11.8737, device='cuda:0')
norm1 res is  tensor(0.1575, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.41636618971824646
distance 1 is tensor(168.4176, device='cuda:0')
distance 2 is tensor(12.8713, device='cuda:0')
benign distance is  tensor(12.8713, device='cuda:0')
norm1 res is  tensor(0.1719, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(179.4901, device='cuda:0')
distance 2 is tensor(13.7738, device='cuda:0')
compute distance is  tensor(13.7738, device='cuda:0')
compute norm is  tensor(54.6527, device='cuda:0')
distance 1 is tensor(179.9007, device='cuda:0')
distance 2 is tensor(13.9515, device='cuda:0')
compute distance is  tensor(13.9515, device='cuda:0')
compute norm is  tensor(54.7326, device='cuda:0')
distance 1 is tensor(196.9012, device='cuda:0')
distance 2 is tensor(15.2806, device='cuda:0')
compute distance is  tensor(15.2806, device='cuda:0')
compute norm is  tensor(55.0949, device='cuda:0')
distance 1 is tensor(181.3465, device='cuda:0')
distance 2 is tensor(14.0624, device='cuda:0')
compute distance is  tensor(14.0624, device='cuda:0')
compute norm is  tensor(54.7928, device='cuda:0')
distance 1 is tensor(186.8009, device='cuda:0')
distance 2 is tensor(14.5512, device='cuda:0')
compute distance is  tensor(14.5512, device='cuda:0')
compute norm is  tensor(54.9189, device='cuda:0')
distance 1 is tensor(195.2846, device='cuda:0')
distance 2 is tensor(15.0201, device='cuda:0')
compute distance is  tensor(15.0201, device='cuda:0')
compute norm is  tensor(55.2009, device='cuda:0')
distance 1 is tensor(182.1268, device='cuda:0')
distance 2 is tensor(14.1002, device='cuda:0')
compute distance is  tensor(14.1002, device='cuda:0')
compute norm is  tensor(54.7830, device='cuda:0')
distance 1 is tensor(198.1533, device='cuda:0')
distance 2 is tensor(15.2075, device='cuda:0')
compute distance is  tensor(15.2075, device='cuda:0')
compute norm is  tensor(55.2699, device='cuda:0')
distance 1 is tensor(186.2594, device='cuda:0')
distance 2 is tensor(14.2710, device='cuda:0')
compute distance is  tensor(14.2710, device='cuda:0')
compute norm is  tensor(54.9359, device='cuda:0')
distance 1 is tensor(186.0801, device='cuda:0')
distance 2 is tensor(14.4313, device='cuda:0')
compute distance is  tensor(14.4313, device='cuda:0')
compute norm is  tensor(54.8680, device='cuda:0')
distance 1 is tensor(196.4715, device='cuda:0')
distance 2 is tensor(15.0318, device='cuda:0')
compute distance is  tensor(15.0318, device='cuda:0')
compute norm is  tensor(55.1199, device='cuda:0')
distance 1 is tensor(194.9779, device='cuda:0')
distance 2 is tensor(14.8222, device='cuda:0')
compute distance is  tensor(14.8222, device='cuda:0')
compute norm is  tensor(55.1012, device='cuda:0')
distance Threshold  is  tensor(15.2806, device='cuda:0')
distance 1 is tensor(1101916.6250, device='cuda:0')
distance 2 is tensor(79382.2500, device='cuda:0')
________________________________
test distance is  tensor(79382.2500, device='cuda:0')
test similarity is  tensor(0.3704, device='cuda:0')
test acc is  0.10000000015633198
test loss is 8.195303268422075e+17
test entropy is  0.0
________________________________
cal ratio is  0.012486801010178732
distance 1 is tensor(13759.4189, device='cuda:0')
distance 2 is tensor(991.2304, device='cuda:0')
cal_distance is  tensor(991.2304, device='cuda:0')
cal ratio is  0.11174435493013032
distance 1 is tensor(1537.5439, device='cuda:0')
distance 2 is tensor(110.7644, device='cuda:0')
cal_distance is  tensor(110.7644, device='cuda:0')
cal ratio is  0.3342818671947672
distance 1 is tensor(513.9778, device='cuda:0')
distance 2 is tensor(37.0265, device='cuda:0')
cal_distance is  tensor(37.0265, device='cuda:0')
cal ratio is  0.5781711722313687
distance 1 is tensor(297.1702, device='cuda:0')
distance 2 is tensor(21.4077, device='cuda:0')
cal_distance is  tensor(21.4077, device='cuda:0')
cal ratio is  0.7603756351810068
distance 1 is tensor(225.9627, device='cuda:0')
distance 2 is tensor(16.2779, device='cuda:0')
cal_distance is  tensor(16.2779, device='cuda:0')
cal ratio is  0.8719951823680024
distance 1 is tensor(197.0393, device='cuda:0')
distance 2 is tensor(14.1942, device='cuda:0')
cal_distance is  tensor(14.1942, device='cuda:0')
distance 1 is tensor(197.0393, device='cuda:0')
distance 2 is tensor(14.1942, device='cuda:0')
________________________________
test distance is  tensor(14.1942, device='cuda:0')
test similarity is  tensor(0.9486, device='cuda:0')
test acc is  0.11056666682299861
test loss is 283.558585876595
test entropy is  9.69688607007602e-23
________________________________
distance 1 is tensor(197.0393, device='cuda:0')
distance 2 is tensor(14.1942, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  2.394432893155388e-27
avg test loss is  283.6295360247972
avg accuracy is  0.10910000015633195
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9486, device='cuda:0')
compute_distance is  tensor(14.1942, device='cuda:0')
compute_norm is  tensor(59.9614, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(180.1019, device='cuda:0')
distance 2 is tensor(14.3608, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9195624635036566
avg test loss is  1.3835795559862782
avg accuracy is  0.5429833334896758
solo acc is  0.2909833334896727
compute similarity  is  tensor(0.9514, device='cuda:0')
compute_distance is  tensor(14.3608, device='cuda:0')
compute_norm is  tensor(59.8701, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(180.1019, device='cuda:0')
distance 2 is tensor(14.3608, device='cuda:0')
________________________________
test distance is  tensor(14.3608, device='cuda:0')
test similarity is  tensor(0.9514, device='cuda:0')
test acc is  0.545566666823009
test loss is 1.3888310777353072
test entropy is  0.9189521418705678
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.183308720588684
mal norm is  tensor(9.5953, device='cuda:0')
distance 1 is tensor(180.1019, device='cuda:0')
distance 2 is tensor(14.3608, device='cuda:0')
mal distance is  tensor(14.3608, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2286, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.4900, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.1450, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.4929, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.0770, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.2549, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.8282, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.1517, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.9738, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5292, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0019, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(846.2853, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(842.4034, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.1432, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(839.7482, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.7374, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(858.1366, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(858.4337, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(860.9393, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(766.3464, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.5909, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(775.1042, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.7887, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3270, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(771.2927, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(798.4619, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(789.5122, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 91.12% 

Test Accuracy: 89.49% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 91.12%
|----0th round Training Accuracy : 91.60%
|----1th round Training Accuracy : 91.13%
|----2th round Training Accuracy : 91.17%
|----3th round Training Accuracy : 91.03%
|----4th round Training Accuracy : 90.50%
|----5th round Training Accuracy : 91.25%
|----6th round Training Accuracy : 89.10%
|----7th round Training Accuracy : 87.76%
|----8th round Training Accuracy : 91.05%
|----9th round Training Accuracy : 91.33%
|----10th round Training Accuracy : 90.13%
|----11th round Training Accuracy : 89.38%
|----12th round Training Accuracy : 90.91%
|----13th round Training Accuracy : 90.79%
|----14th round Training Accuracy : 91.10%
|----15th round Training Accuracy : 91.06%
|----16th round Training Accuracy : 90.65%
|----17th round Training Accuracy : 90.42%
|----18th round Training Accuracy : 90.85%
|----19th round Training Accuracy : 91.39%
|----20th round Training Accuracy : 90.88%
|----21th round Training Accuracy : 91.12%
|----22th round Training Accuracy : 90.86%
|----23th round Training Accuracy : 91.03%
|----24th round Training Accuracy : 91.01%
|----25th round Training Accuracy : 90.54%
|----26th round Training Accuracy : 79.23%
|----27th round Training Accuracy : 90.87%
|----28th round Training Accuracy : 90.98%
|----29th round Training Accuracy : 91.19%
|----30th round Training Accuracy : 86.64%
|----31th round Training Accuracy : 91.12%
|----32th round Training Accuracy : 91.18%
|----33th round Training Accuracy : 86.14%
|----34th round Training Accuracy : 90.77%
|----35th round Training Accuracy : 91.10%
|----36th round Training Accuracy : 90.65%
|----37th round Training Accuracy : 89.88%
|----38th round Training Accuracy : 90.99%
|----39th round Training Accuracy : 91.00%
|----40th round Training Accuracy : 90.86%
|----41th round Training Accuracy : 91.05%
|----42th round Training Accuracy : 85.87%
|----43th round Training Accuracy : 91.05%
|----44th round Training Accuracy : 91.02%
|----45th round Training Accuracy : 87.70%
|----46th round Training Accuracy : 90.73%
|----47th round Training Accuracy : 91.05%
|----48th round Training Accuracy : 85.61%
|----49th round Training Accuracy : 91.12%
|----Final Test Accuracy: 89.49%
|----0th round Final Test Accuracy : 89.26%
|----1th round Final Test Accuracy : 88.79%
|----2th round Final Test Accuracy : 89.06%
|----3th round Final Test Accuracy : 88.75%
|----4th round Final Test Accuracy : 88.20%
|----5th round Final Test Accuracy : 88.95%
|----6th round Final Test Accuracy : 87.09%
|----7th round Final Test Accuracy : 86.32%
|----8th round Final Test Accuracy : 88.95%
|----9th round Final Test Accuracy : 89.08%
|----10th round Final Test Accuracy : 87.72%
|----11th round Final Test Accuracy : 87.83%
|----12th round Final Test Accuracy : 88.97%
|----13th round Final Test Accuracy : 89.35%
|----14th round Final Test Accuracy : 89.23%
|----15th round Final Test Accuracy : 89.10%
|----16th round Final Test Accuracy : 88.84%
|----17th round Final Test Accuracy : 88.95%
|----18th round Final Test Accuracy : 89.44%
|----19th round Final Test Accuracy : 89.72%
|----20th round Final Test Accuracy : 89.30%
|----21th round Final Test Accuracy : 89.26%
|----22th round Final Test Accuracy : 89.38%
|----23th round Final Test Accuracy : 89.45%
|----24th round Final Test Accuracy : 89.43%
|----25th round Final Test Accuracy : 88.86%
|----26th round Final Test Accuracy : 77.95%
|----27th round Final Test Accuracy : 89.21%
|----28th round Final Test Accuracy : 89.32%
|----29th round Final Test Accuracy : 89.63%
|----30th round Final Test Accuracy : 85.08%
|----31th round Final Test Accuracy : 89.46%
|----32th round Final Test Accuracy : 89.70%
|----33th round Final Test Accuracy : 84.71%
|----34th round Final Test Accuracy : 89.50%
|----35th round Final Test Accuracy : 89.39%
|----36th round Final Test Accuracy : 89.21%
|----37th round Final Test Accuracy : 88.51%
|----38th round Final Test Accuracy : 89.52%
|----39th round Final Test Accuracy : 89.69%
|----40th round Final Test Accuracy : 89.34%
|----41th round Final Test Accuracy : 89.39%
|----42th round Final Test Accuracy : 84.59%
|----43th round Final Test Accuracy : 89.54%
|----44th round Final Test Accuracy : 89.63%
|----45th round Final Test Accuracy : 86.10%
|----46th round Final Test Accuracy : 89.26%
|----47th round Final Test Accuracy : 89.61%
|----48th round Final Test Accuracy : 84.26%
|----49th round Final Test Accuracy : 89.49%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 18322.4820
