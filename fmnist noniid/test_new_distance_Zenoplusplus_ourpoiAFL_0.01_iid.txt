
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3961946964263916
distance 1 is tensor(117.6163, device='cuda:1')
distance 2 is tensor(8.6396, device='cuda:1')
benign distance is  tensor(8.6396, device='cuda:1')
norm1 res is  tensor(0.1336, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.21456460654735565
distance 1 is tensor(141.6184, device='cuda:1')
distance 2 is tensor(10.4063, device='cuda:1')
benign distance is  tensor(10.4063, device='cuda:1')
norm1 res is  tensor(0.1584, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.051776349544525146
distance 1 is tensor(151.3076, device='cuda:1')
distance 2 is tensor(11.0427, device='cuda:1')
benign distance is  tensor(11.0427, device='cuda:1')
norm1 res is  tensor(0.1691, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.5497058033943176
distance 1 is tensor(150.2338, device='cuda:1')
distance 2 is tensor(10.9264, device='cuda:1')
benign distance is  tensor(10.9264, device='cuda:1')
norm1 res is  tensor(0.1668, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.5906649231910706
distance 1 is tensor(141.2258, device='cuda:1')
distance 2 is tensor(10.3247, device='cuda:1')
benign distance is  tensor(10.3247, device='cuda:1')
norm1 res is  tensor(0.1640, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.22791016101837158
distance 1 is tensor(150.7783, device='cuda:1')
distance 2 is tensor(11.0602, device='cuda:1')
benign distance is  tensor(11.0602, device='cuda:1')
norm1 res is  tensor(0.1681, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.6046687364578247
distance 1 is tensor(145.6104, device='cuda:1')
distance 2 is tensor(10.4834, device='cuda:1')
benign distance is  tensor(10.4834, device='cuda:1')
norm1 res is  tensor(0.1606, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.5980167984962463
distance 1 is tensor(162.2312, device='cuda:1')
distance 2 is tensor(11.7607, device='cuda:1')
benign distance is  tensor(11.7607, device='cuda:1')
norm1 res is  tensor(0.1801, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.39664003252983093
distance 1 is tensor(159.4596, device='cuda:1')
distance 2 is tensor(11.5404, device='cuda:1')
benign distance is  tensor(11.5404, device='cuda:1')
norm1 res is  tensor(0.1737, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.4381411671638489
distance 1 is tensor(139.9529, device='cuda:1')
distance 2 is tensor(10.3240, device='cuda:1')
benign distance is  tensor(10.3240, device='cuda:1')
norm1 res is  tensor(0.1561, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  1.0251085758209229
distance 1 is tensor(156.0621, device='cuda:1')
distance 2 is tensor(11.2589, device='cuda:1')
benign distance is  tensor(11.2589, device='cuda:1')
norm1 res is  tensor(0.1716, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.6675196290016174
distance 1 is tensor(161.6235, device='cuda:1')
distance 2 is tensor(11.7043, device='cuda:1')
benign distance is  tensor(11.7043, device='cuda:1')
norm1 res is  tensor(0.1756, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.26554107666015625
distance 1 is tensor(155.4884, device='cuda:1')
distance 2 is tensor(11.6239, device='cuda:1')
benign distance is  tensor(11.6239, device='cuda:1')
norm1 res is  tensor(0.1756, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.3938843607902527
distance 1 is tensor(164.9108, device='cuda:1')
distance 2 is tensor(12.0390, device='cuda:1')
benign distance is  tensor(12.0390, device='cuda:1')
norm1 res is  tensor(0.1832, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.38103729486465454
distance 1 is tensor(148.4842, device='cuda:1')
distance 2 is tensor(10.8933, device='cuda:1')
benign distance is  tensor(10.8933, device='cuda:1')
norm1 res is  tensor(0.1673, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.3914017081260681
distance 1 is tensor(145.0215, device='cuda:1')
distance 2 is tensor(10.5437, device='cuda:1')
benign distance is  tensor(10.5437, device='cuda:1')
norm1 res is  tensor(0.1609, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.0589437372982502
distance 1 is tensor(163.6011, device='cuda:1')
distance 2 is tensor(11.7671, device='cuda:1')
benign distance is  tensor(11.7671, device='cuda:1')
norm1 res is  tensor(0.1829, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.6583752036094666
distance 1 is tensor(162.9431, device='cuda:1')
distance 2 is tensor(12.1823, device='cuda:1')
benign distance is  tensor(12.1823, device='cuda:1')
norm1 res is  tensor(0.1859, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.20963799953460693
distance 1 is tensor(152.2188, device='cuda:1')
distance 2 is tensor(11.2323, device='cuda:1')
benign distance is  tensor(11.2323, device='cuda:1')
norm1 res is  tensor(0.1701, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.4708937704563141
distance 1 is tensor(138.7601, device='cuda:1')
distance 2 is tensor(10.1512, device='cuda:1')
benign distance is  tensor(10.1512, device='cuda:1')
norm1 res is  tensor(0.1547, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.13696333765983582
distance 1 is tensor(152.7330, device='cuda:1')
distance 2 is tensor(11.2034, device='cuda:1')
benign distance is  tensor(11.2034, device='cuda:1')
norm1 res is  tensor(0.1705, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  0.7443498373031616
distance 1 is tensor(157.6529, device='cuda:1')
distance 2 is tensor(11.4579, device='cuda:1')
benign distance is  tensor(11.4579, device='cuda:1')
norm1 res is  tensor(0.1725, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.09857767075300217
distance 1 is tensor(162.9320, device='cuda:1')
distance 2 is tensor(12.0563, device='cuda:1')
benign distance is  tensor(12.0563, device='cuda:1')
norm1 res is  tensor(0.1838, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  0.8177769780158997
distance 1 is tensor(143.5680, device='cuda:1')
distance 2 is tensor(10.6317, device='cuda:1')
benign distance is  tensor(10.6317, device='cuda:1')
norm1 res is  tensor(0.1602, device='cuda:1')
current submit client idx and staleness is  24 4
 benign loss is  0.39020752906799316
distance 1 is tensor(174.0260, device='cuda:1')
distance 2 is tensor(12.5584, device='cuda:1')
benign distance is  tensor(12.5584, device='cuda:1')
norm1 res is  tensor(0.1976, device='cuda:1')
current submit client idx and staleness is  25 4
 benign loss is  0.3498687446117401
distance 1 is tensor(155.8568, device='cuda:1')
distance 2 is tensor(11.1723, device='cuda:1')
benign distance is  tensor(11.1723, device='cuda:1')
norm1 res is  tensor(0.1710, device='cuda:1')
current submit client idx and staleness is  26 4
 benign loss is  0.34555584192276
distance 1 is tensor(154.3080, device='cuda:1')
distance 2 is tensor(11.4017, device='cuda:1')
benign distance is  tensor(11.4017, device='cuda:1')
norm1 res is  tensor(0.1707, device='cuda:1')
current submit client idx and staleness is  27 4
 benign loss is  0.5224076509475708
distance 1 is tensor(156.0534, device='cuda:1')
distance 2 is tensor(11.5227, device='cuda:1')
benign distance is  tensor(11.5227, device='cuda:1')
norm1 res is  tensor(0.1756, device='cuda:1')
current submit client idx and staleness is  28 4
 benign loss is  0.7002913951873779
distance 1 is tensor(151.8796, device='cuda:1')
distance 2 is tensor(11.0641, device='cuda:1')
benign distance is  tensor(11.0641, device='cuda:1')
norm1 res is  tensor(0.1665, device='cuda:1')
current submit client idx and staleness is  29 4
 benign loss is  0.7169808149337769
distance 1 is tensor(162.9841, device='cuda:1')
distance 2 is tensor(11.9483, device='cuda:1')
benign distance is  tensor(11.9483, device='cuda:1')
norm1 res is  tensor(0.1810, device='cuda:1')
current submit client idx and staleness is  30 4
 benign loss is  0.24351374804973602
distance 1 is tensor(154.1680, device='cuda:1')
distance 2 is tensor(11.3122, device='cuda:1')
benign distance is  tensor(11.3122, device='cuda:1')
norm1 res is  tensor(0.1712, device='cuda:1')
current submit client idx and staleness is  31 4
 benign loss is  0.9695679545402527
distance 1 is tensor(150.0047, device='cuda:1')
distance 2 is tensor(11.0933, device='cuda:1')
benign distance is  tensor(11.0933, device='cuda:1')
norm1 res is  tensor(0.1695, device='cuda:1')
current submit client idx and staleness is  32 5
 benign loss is  0.6356065273284912
distance 1 is tensor(140.9130, device='cuda:1')
distance 2 is tensor(10.3860, device='cuda:1')
benign distance is  tensor(10.3860, device='cuda:1')
norm1 res is  tensor(0.1554, device='cuda:1')
current submit client idx and staleness is  33 5
 benign loss is  0.25163179636001587
distance 1 is tensor(158.0199, device='cuda:1')
distance 2 is tensor(11.5651, device='cuda:1')
benign distance is  tensor(11.5651, device='cuda:1')
norm1 res is  tensor(0.1754, device='cuda:1')
current submit client idx and staleness is  34 5
 benign loss is  0.5302650332450867
distance 1 is tensor(162.6848, device='cuda:1')
distance 2 is tensor(12.0077, device='cuda:1')
benign distance is  tensor(12.0077, device='cuda:1')
norm1 res is  tensor(0.1817, device='cuda:1')
current submit client idx and staleness is  35 5
 benign loss is  0.16270843148231506
distance 1 is tensor(154.4573, device='cuda:1')
distance 2 is tensor(11.2894, device='cuda:1')
benign distance is  tensor(11.2894, device='cuda:1')
norm1 res is  tensor(0.1713, device='cuda:1')
current submit client idx and staleness is  36 5
 benign loss is  0.4555184245109558
distance 1 is tensor(160.4012, device='cuda:1')
distance 2 is tensor(11.8384, device='cuda:1')
benign distance is  tensor(11.8384, device='cuda:1')
norm1 res is  tensor(0.1790, device='cuda:1')
current submit client idx and staleness is  37 5
 benign loss is  0.19784031808376312
distance 1 is tensor(153.3107, device='cuda:1')
distance 2 is tensor(11.1519, device='cuda:1')
benign distance is  tensor(11.1519, device='cuda:1')
norm1 res is  tensor(0.1664, device='cuda:1')
current submit client idx and staleness is  38 5
 benign loss is  0.11661318689584732
distance 1 is tensor(149.8766, device='cuda:1')
distance 2 is tensor(11.1346, device='cuda:1')
benign distance is  tensor(11.1346, device='cuda:1')
norm1 res is  tensor(0.1655, device='cuda:1')
current submit client idx and staleness is  39 5
 benign loss is  0.6478015780448914
distance 1 is tensor(147.2025, device='cuda:1')
distance 2 is tensor(10.7717, device='cuda:1')
benign distance is  tensor(10.7717, device='cuda:1')
norm1 res is  tensor(0.1618, device='cuda:1')
current submit client idx and staleness is  40 6
 benign loss is  0.9330522418022156
distance 1 is tensor(166.8056, device='cuda:1')
distance 2 is tensor(12.1645, device='cuda:1')
benign distance is  tensor(12.1645, device='cuda:1')
norm1 res is  tensor(0.1807, device='cuda:1')
current submit client idx and staleness is  41 6
 benign loss is  0.4994850158691406
distance 1 is tensor(158.7609, device='cuda:1')
distance 2 is tensor(11.6109, device='cuda:1')
benign distance is  tensor(11.6109, device='cuda:1')
norm1 res is  tensor(0.1760, device='cuda:1')
current submit client idx and staleness is  42 6
 benign loss is  0.14172491431236267
distance 1 is tensor(149.3146, device='cuda:1')
distance 2 is tensor(10.9248, device='cuda:1')
benign distance is  tensor(10.9248, device='cuda:1')
norm1 res is  tensor(0.1625, device='cuda:1')
current submit client idx and staleness is  43 6
 benign loss is  1.0416781902313232
distance 1 is tensor(169.7515, device='cuda:1')
distance 2 is tensor(12.5679, device='cuda:1')
benign distance is  tensor(12.5679, device='cuda:1')
norm1 res is  tensor(0.1892, device='cuda:1')
current submit client idx and staleness is  44 6
 benign loss is  0.22520363330841064
distance 1 is tensor(151.7224, device='cuda:1')
distance 2 is tensor(11.2816, device='cuda:1')
benign distance is  tensor(11.2816, device='cuda:1')
norm1 res is  tensor(0.1670, device='cuda:1')
current submit client idx and staleness is  45 6
 benign loss is  0.9946692585945129
distance 1 is tensor(162.1997, device='cuda:1')
distance 2 is tensor(11.8954, device='cuda:1')
benign distance is  tensor(11.8954, device='cuda:1')
norm1 res is  tensor(0.1783, device='cuda:1')
current submit client idx and staleness is  46 6
 benign loss is  0.3956254720687866
distance 1 is tensor(158.4499, device='cuda:1')
distance 2 is tensor(11.6383, device='cuda:1')
benign distance is  tensor(11.6383, device='cuda:1')
norm1 res is  tensor(0.1748, device='cuda:1')
current submit client idx and staleness is  47 6
 benign loss is  0.4476493299007416
distance 1 is tensor(154.0059, device='cuda:1')
distance 2 is tensor(11.3673, device='cuda:1')
benign distance is  tensor(11.3673, device='cuda:1')
norm1 res is  tensor(0.1759, device='cuda:1')
current submit client idx and staleness is  48 1
 benign loss is  0.2768891155719757
distance 1 is tensor(138.8475, device='cuda:1')
distance 2 is tensor(10.1333, device='cuda:1')
benign distance is  tensor(10.1333, device='cuda:1')
norm1 res is  tensor(0.1513, device='cuda:1')
current submit client idx and staleness is  49 1
 benign loss is  1.1430069208145142
distance 1 is tensor(156.3625, device='cuda:1')
distance 2 is tensor(11.4447, device='cuda:1')
benign distance is  tensor(11.4447, device='cuda:1')
norm1 res is  tensor(0.1738, device='cuda:1')
current submit client idx and staleness is  50 1
 benign loss is  0.845646858215332
distance 1 is tensor(165.7908, device='cuda:1')
distance 2 is tensor(12.0748, device='cuda:1')
benign distance is  tensor(12.0748, device='cuda:1')
norm1 res is  tensor(0.1825, device='cuda:1')
current submit client idx and staleness is  51 1
 benign loss is  0.6535168886184692
distance 1 is tensor(144.7447, device='cuda:1')
distance 2 is tensor(10.4969, device='cuda:1')
benign distance is  tensor(10.4969, device='cuda:1')
norm1 res is  tensor(0.1600, device='cuda:1')
current submit client idx and staleness is  52 1
 benign loss is  0.5586442351341248
distance 1 is tensor(157.9445, device='cuda:1')
distance 2 is tensor(11.4522, device='cuda:1')
benign distance is  tensor(11.4522, device='cuda:1')
norm1 res is  tensor(0.1717, device='cuda:1')
current submit client idx and staleness is  53 1
 benign loss is  0.9452310800552368
distance 1 is tensor(166.9734, device='cuda:1')
distance 2 is tensor(12.2157, device='cuda:1')
benign distance is  tensor(12.2157, device='cuda:1')
norm1 res is  tensor(0.1845, device='cuda:1')
current submit client idx and staleness is  54 1
 benign loss is  0.09508220106363297
distance 1 is tensor(156.2120, device='cuda:1')
distance 2 is tensor(11.4437, device='cuda:1')
benign distance is  tensor(11.4437, device='cuda:1')
norm1 res is  tensor(0.1741, device='cuda:1')
current submit client idx and staleness is  55 1
 benign loss is  0.37698274850845337
distance 1 is tensor(163.0574, device='cuda:1')
distance 2 is tensor(11.7600, device='cuda:1')
benign distance is  tensor(11.7600, device='cuda:1')
norm1 res is  tensor(0.1796, device='cuda:1')
current submit client idx and staleness is  56 1
 benign loss is  0.3427940607070923
distance 1 is tensor(137.7168, device='cuda:1')
distance 2 is tensor(10.0134, device='cuda:1')
benign distance is  tensor(10.0134, device='cuda:1')
norm1 res is  tensor(0.1544, device='cuda:1')
current submit client idx and staleness is  57 1
 benign loss is  0.33071762323379517
distance 1 is tensor(140.0714, device='cuda:1')
distance 2 is tensor(10.3061, device='cuda:1')
benign distance is  tensor(10.3061, device='cuda:1')
norm1 res is  tensor(0.1535, device='cuda:1')
current submit client idx and staleness is  58 1
 benign loss is  0.3212807774543762
distance 1 is tensor(166.2606, device='cuda:1')
distance 2 is tensor(12.0199, device='cuda:1')
benign distance is  tensor(12.0199, device='cuda:1')
norm1 res is  tensor(0.1826, device='cuda:1')
current submit client idx and staleness is  59 1
 benign loss is  0.22917990386486053
distance 1 is tensor(142.4774, device='cuda:1')
distance 2 is tensor(10.2384, device='cuda:1')
benign distance is  tensor(10.2384, device='cuda:1')
norm1 res is  tensor(0.1542, device='cuda:1')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.3655, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(515.3231, device='cuda:1')
c is  tensor(0.0266, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.6763, device='cuda:1')
c is  tensor(0.0241, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.1472, device='cuda:1')
c is  tensor(0.0234, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.0906, device='cuda:1')
c is  tensor(0.0235, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.9937, device='cuda:1')
c is  tensor(0.0243, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.7223, device='cuda:1')
c is  tensor(0.0234, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.3006, device='cuda:1')
c is  tensor(0.0240, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.8998, device='cuda:1')
c is  tensor(0.0226, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.7138, device='cuda:1')
c is  tensor(0.0247, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.1133, device='cuda:1')
c is  tensor(0.0230, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.3613, device='cuda:1')
c is  tensor(0.0225, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.1204, device='cuda:1')
c is  tensor(0.0240, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.8903, device='cuda:1')
c is  tensor(0.0232, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8141, device='cuda:1')
c is  tensor(0.0224, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.9230, device='cuda:1')
c is  tensor(0.0230, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.3351, device='cuda:1')
c is  tensor(0.0227, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.2976, device='cuda:1')
c is  tensor(0.0246, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.2272, device='cuda:1')
c is  tensor(0.0246, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.0037, device='cuda:1')
c is  tensor(0.0225, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.0483, device='cuda:1')
c is  tensor(0.0244, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:1')
accept
len accept list 19
len all weights is 19
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 93.24% 

Test Accuracy: 89.94% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  0.36705222725868225
distance 1 is tensor(119.4806, device='cuda:1')
distance 2 is tensor(8.5933, device='cuda:1')
benign distance is  tensor(8.5933, device='cuda:1')
norm1 res is  tensor(0.1291, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.4827287793159485
distance 1 is tensor(143.0786, device='cuda:1')
distance 2 is tensor(10.4585, device='cuda:1')
benign distance is  tensor(10.4585, device='cuda:1')
norm1 res is  tensor(0.1618, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.1574234664440155
distance 1 is tensor(133.8849, device='cuda:1')
distance 2 is tensor(9.5614, device='cuda:1')
benign distance is  tensor(9.5614, device='cuda:1')
norm1 res is  tensor(0.1457, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.5745183229446411
distance 1 is tensor(121.6058, device='cuda:1')
distance 2 is tensor(8.8857, device='cuda:1')
benign distance is  tensor(8.8857, device='cuda:1')
norm1 res is  tensor(0.1370, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.6117979288101196
distance 1 is tensor(120.5654, device='cuda:1')
distance 2 is tensor(8.6420, device='cuda:1')
benign distance is  tensor(8.6420, device='cuda:1')
norm1 res is  tensor(0.1319, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.9666527509689331
distance 1 is tensor(137.9377, device='cuda:1')
distance 2 is tensor(10.0602, device='cuda:1')
benign distance is  tensor(10.0602, device='cuda:1')
norm1 res is  tensor(0.1571, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.38016998767852783
distance 1 is tensor(128.9662, device='cuda:1')
distance 2 is tensor(9.3274, device='cuda:1')
benign distance is  tensor(9.3274, device='cuda:1')
norm1 res is  tensor(0.1424, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.3355028033256531
distance 1 is tensor(144.2392, device='cuda:1')
distance 2 is tensor(10.6341, device='cuda:1')
benign distance is  tensor(10.6341, device='cuda:1')
norm1 res is  tensor(0.1618, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2631, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.8775, device='cuda:1')
c is  tensor(0.0227, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.1919, device='cuda:1')
c is  tensor(0.0203, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.4494, device='cuda:1')
c is  tensor(0.0213, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(538.9288, device='cuda:1')
c is  tensor(0.0221, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.2679e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.4341, device='cuda:1')
c is  tensor(0.0227, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.6635, device='cuda:1')
c is  tensor(0.0207, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.4617, device='cuda:1')
c is  tensor(0.0216, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.9237e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9236, device='cuda:1')
c is  tensor(0.0203, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.6766, device='cuda:1')
c is  tensor(0.0195, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.3361, device='cuda:1')
c is  tensor(0.0205, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.9100, device='cuda:1')
c is  tensor(0.0196, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.2544, device='cuda:1')
c is  tensor(0.0194, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.5158, device='cuda:1')
c is  tensor(0.0193, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.0964, device='cuda:1')
c is  tensor(0.0191, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.7030, device='cuda:1')
c is  tensor(0.0198, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.5643e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.1613, device='cuda:1')
c is  tensor(0.0202, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
len accept list 3
len all weights is 3
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 92.75% 

Test Accuracy: 89.46% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3871794044971466
distance 1 is tensor(110.1668, device='cuda:1')
distance 2 is tensor(7.9891, device='cuda:1')
benign distance is  tensor(7.9891, device='cuda:1')
norm1 res is  tensor(0.1179, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.21077151596546173
distance 1 is tensor(140.7682, device='cuda:1')
distance 2 is tensor(10.2625, device='cuda:1')
benign distance is  tensor(10.2625, device='cuda:1')
norm1 res is  tensor(0.1558, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.15293090045452118
distance 1 is tensor(108.9889, device='cuda:1')
distance 2 is tensor(7.9328, device='cuda:1')
benign distance is  tensor(7.9328, device='cuda:1')
norm1 res is  tensor(0.1212, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.24633678793907166
distance 1 is tensor(127.5370, device='cuda:1')
distance 2 is tensor(9.3283, device='cuda:1')
benign distance is  tensor(9.3283, device='cuda:1')
norm1 res is  tensor(0.1420, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.8144391179084778
distance 1 is tensor(144.8566, device='cuda:1')
distance 2 is tensor(10.4493, device='cuda:1')
benign distance is  tensor(10.4493, device='cuda:1')
norm1 res is  tensor(0.1587, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.39569875597953796
distance 1 is tensor(140.2721, device='cuda:1')
distance 2 is tensor(10.1837, device='cuda:1')
benign distance is  tensor(10.1837, device='cuda:1')
norm1 res is  tensor(0.1562, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.5401559472084045
distance 1 is tensor(144.1997, device='cuda:1')
distance 2 is tensor(10.4200, device='cuda:1')
benign distance is  tensor(10.4200, device='cuda:1')
norm1 res is  tensor(0.1574, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.44374173879623413
distance 1 is tensor(126.8402, device='cuda:1')
distance 2 is tensor(9.1242, device='cuda:1')
benign distance is  tensor(9.1242, device='cuda:1')
norm1 res is  tensor(0.1384, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.1620447337627411
distance 1 is tensor(151.4660, device='cuda:1')
distance 2 is tensor(11.0577, device='cuda:1')
benign distance is  tensor(11.0577, device='cuda:1')
norm1 res is  tensor(0.1678, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.1497669816017151
distance 1 is tensor(155.9937, device='cuda:1')
distance 2 is tensor(11.3872, device='cuda:1')
benign distance is  tensor(11.3872, device='cuda:1')
norm1 res is  tensor(0.1764, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.11427853256464005
distance 1 is tensor(148.7815, device='cuda:1')
distance 2 is tensor(10.6670, device='cuda:1')
benign distance is  tensor(10.6670, device='cuda:1')
norm1 res is  tensor(0.1610, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.6298915147781372
distance 1 is tensor(151.7443, device='cuda:1')
distance 2 is tensor(10.9786, device='cuda:1')
benign distance is  tensor(10.9786, device='cuda:1')
norm1 res is  tensor(0.1670, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.3218131363391876
distance 1 is tensor(146.3328, device='cuda:1')
distance 2 is tensor(10.6250, device='cuda:1')
benign distance is  tensor(10.6250, device='cuda:1')
norm1 res is  tensor(0.1609, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.36469393968582153
distance 1 is tensor(140.3595, device='cuda:1')
distance 2 is tensor(10.3210, device='cuda:1')
benign distance is  tensor(10.3210, device='cuda:1')
norm1 res is  tensor(0.1607, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.5588079690933228
distance 1 is tensor(142.0294, device='cuda:1')
distance 2 is tensor(10.4876, device='cuda:1')
benign distance is  tensor(10.4876, device='cuda:1')
norm1 res is  tensor(0.1577, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.5176225304603577
distance 1 is tensor(163.7556, device='cuda:1')
distance 2 is tensor(11.9149, device='cuda:1')
benign distance is  tensor(11.9149, device='cuda:1')
norm1 res is  tensor(0.1779, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1833, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(464.9258, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.5416, device='cuda:1')
c is  tensor(0.0173, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.8190e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(468.9854, device='cuda:1')
c is  tensor(0.0198, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9941e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.4311, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.6984, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.4337, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.1570, device='cuda:1')
c is  tensor(0.0171, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.2816, device='cuda:1')
c is  tensor(0.0183, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(782.6112, device='cuda:1')
c is  tensor(0.0153, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.2717, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.1642, device='cuda:1')
c is  tensor(0.0158, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.0855e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.8033, device='cuda:1')
c is  tensor(0.0164, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.2578, device='cuda:1')
c is  tensor(0.0158, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.7057, device='cuda:1')
c is  tensor(0.0157, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5819, device='cuda:1')
c is  tensor(0.0153, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.2475, device='cuda:1')
c is  tensor(0.0162, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
len accept list 1
len all weights is 1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 91.01% 

Test Accuracy: 88.64% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.43308982253074646
distance 1 is tensor(146.4135, device='cuda:1')
distance 2 is tensor(10.6359, device='cuda:1')
benign distance is  tensor(10.6359, device='cuda:1')
norm1 res is  tensor(0.1608, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.7121161818504333
distance 1 is tensor(93.7437, device='cuda:1')
distance 2 is tensor(6.8546, device='cuda:1')
benign distance is  tensor(6.8546, device='cuda:1')
norm1 res is  tensor(0.1015, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.15162333846092224
distance 1 is tensor(154.1836, device='cuda:1')
distance 2 is tensor(11.0804, device='cuda:1')
benign distance is  tensor(11.0804, device='cuda:1')
norm1 res is  tensor(0.1657, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.7247940301895142
distance 1 is tensor(148.7785, device='cuda:1')
distance 2 is tensor(10.6181, device='cuda:1')
benign distance is  tensor(10.6181, device='cuda:1')
norm1 res is  tensor(0.1588, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.46268290281295776
distance 1 is tensor(146.2336, device='cuda:1')
distance 2 is tensor(10.6250, device='cuda:1')
benign distance is  tensor(10.6250, device='cuda:1')
norm1 res is  tensor(0.1561, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.08741670846939087
distance 1 is tensor(166.7646, device='cuda:1')
distance 2 is tensor(12.1676, device='cuda:1')
benign distance is  tensor(12.1676, device='cuda:1')
norm1 res is  tensor(0.1859, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.5824981331825256
distance 1 is tensor(161.4548, device='cuda:1')
distance 2 is tensor(11.6885, device='cuda:1')
benign distance is  tensor(11.6885, device='cuda:1')
norm1 res is  tensor(0.1711, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.6491455435752869
distance 1 is tensor(158.6673, device='cuda:1')
distance 2 is tensor(11.3027, device='cuda:1')
benign distance is  tensor(11.3027, device='cuda:1')
norm1 res is  tensor(0.1705, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.04192397743463516
distance 1 is tensor(152.8670, device='cuda:1')
distance 2 is tensor(11.2171, device='cuda:1')
benign distance is  tensor(11.2171, device='cuda:1')
norm1 res is  tensor(0.1675, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.6090717315673828
distance 1 is tensor(172.8358, device='cuda:1')
distance 2 is tensor(12.6271, device='cuda:1')
benign distance is  tensor(12.6271, device='cuda:1')
norm1 res is  tensor(0.1884, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.08310277760028839
distance 1 is tensor(158.7220, device='cuda:1')
distance 2 is tensor(11.7638, device='cuda:1')
benign distance is  tensor(11.7638, device='cuda:1')
norm1 res is  tensor(0.1719, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.3257617652416229
distance 1 is tensor(168.0053, device='cuda:1')
distance 2 is tensor(11.9741, device='cuda:1')
benign distance is  tensor(11.9741, device='cuda:1')
norm1 res is  tensor(0.1781, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.215312197804451
distance 1 is tensor(140.6604, device='cuda:1')
distance 2 is tensor(10.3500, device='cuda:1')
benign distance is  tensor(10.3500, device='cuda:1')
norm1 res is  tensor(0.1517, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  0.7044378519058228
distance 1 is tensor(157.3848, device='cuda:1')
distance 2 is tensor(11.3115, device='cuda:1')
benign distance is  tensor(11.3115, device='cuda:1')
norm1 res is  tensor(0.1656, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.4449858069419861
distance 1 is tensor(174.7679, device='cuda:1')
distance 2 is tensor(12.6836, device='cuda:1')
benign distance is  tensor(12.6836, device='cuda:1')
norm1 res is  tensor(0.1891, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  0.8396797180175781
distance 1 is tensor(161.8948, device='cuda:1')
distance 2 is tensor(11.9048, device='cuda:1')
benign distance is  tensor(11.9048, device='cuda:1')
norm1 res is  tensor(0.1767, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 24
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1741, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.7667, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(399.6228, device='cuda:1')
c is  tensor(0.0209, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.7050, device='cuda:1')
c is  tensor(0.0164, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4277e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9017, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.8099, device='cuda:1')
c is  tensor(0.0168, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.1838, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.1821, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.4693, device='cuda:1')
c is  tensor(0.0161, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(963.8450, device='cuda:1')
c is  tensor(0.0134, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1891e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(880.7397, device='cuda:1')
c is  tensor(0.0141, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(876.3955, device='cuda:1')
c is  tensor(0.0141, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.7935, device='cuda:1')
c is  tensor(0.0140, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.5335e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(863.6608, device='cuda:1')
c is  tensor(0.0142, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(908.0079, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(883.6898, device='cuda:1')
c is  tensor(0.0140, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.4385, device='cuda:1')
c is  tensor(0.0142, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(825.0264, device='cuda:1')
c is  tensor(0.0145, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.6957e-07, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(843.5544, device='cuda:1')
c is  tensor(0.0144, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(797.4282, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.0746e-06, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.0222, device='cuda:1')
c is  tensor(0.0146, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(795.3856, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4268e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(793.7522, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.5264e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(789.7854, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.8645e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(854.4323, device='cuda:1')
c is  tensor(0.0143, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.2994e-05, device='cuda:1')
len accept list 11
len all weights is 11
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 92.73% 

Test Accuracy: 89.83% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
 benign loss is  0.12678949534893036
distance 1 is tensor(102.2487, device='cuda:1')
distance 2 is tensor(7.4500, device='cuda:1')
benign distance is  tensor(7.4500, device='cuda:1')
norm1 res is  tensor(0.1091, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.8799872398376465
distance 1 is tensor(103.4930, device='cuda:1')
distance 2 is tensor(7.6121, device='cuda:1')
benign distance is  tensor(7.6121, device='cuda:1')
norm1 res is  tensor(0.1171, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.2580125629901886
distance 1 is tensor(127.8756, device='cuda:1')
distance 2 is tensor(9.2505, device='cuda:1')
benign distance is  tensor(9.2505, device='cuda:1')
norm1 res is  tensor(0.1395, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.1848677694797516
distance 1 is tensor(134.1860, device='cuda:1')
distance 2 is tensor(9.8302, device='cuda:1')
benign distance is  tensor(9.8302, device='cuda:1')
norm1 res is  tensor(0.1500, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.3876205384731293
distance 1 is tensor(129.0964, device='cuda:1')
distance 2 is tensor(9.4147, device='cuda:1')
benign distance is  tensor(9.4147, device='cuda:1')
norm1 res is  tensor(0.1426, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.27968132495880127
distance 1 is tensor(132.7087, device='cuda:1')
distance 2 is tensor(9.6159, device='cuda:1')
benign distance is  tensor(9.6159, device='cuda:1')
norm1 res is  tensor(0.1451, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.16151298582553864
distance 1 is tensor(131.1660, device='cuda:1')
distance 2 is tensor(9.5193, device='cuda:1')
benign distance is  tensor(9.5193, device='cuda:1')
norm1 res is  tensor(0.1453, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.521666944026947
distance 1 is tensor(122.5528, device='cuda:1')
distance 2 is tensor(8.9475, device='cuda:1')
benign distance is  tensor(8.9475, device='cuda:1')
norm1 res is  tensor(0.1392, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.5257761478424072
distance 1 is tensor(143.0459, device='cuda:1')
distance 2 is tensor(10.2545, device='cuda:1')
benign distance is  tensor(10.2545, device='cuda:1')
norm1 res is  tensor(0.1559, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.5365919470787048
distance 1 is tensor(135.4283, device='cuda:1')
distance 2 is tensor(9.7951, device='cuda:1')
benign distance is  tensor(9.7951, device='cuda:1')
norm1 res is  tensor(0.1476, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.9343404769897461
distance 1 is tensor(137.0612, device='cuda:1')
distance 2 is tensor(9.7368, device='cuda:1')
benign distance is  tensor(9.7368, device='cuda:1')
norm1 res is  tensor(0.1464, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.5417500734329224
distance 1 is tensor(138.5798, device='cuda:1')
distance 2 is tensor(10.0336, device='cuda:1')
benign distance is  tensor(10.0336, device='cuda:1')
norm1 res is  tensor(0.1535, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.3374576270580292
distance 1 is tensor(133.0025, device='cuda:1')
distance 2 is tensor(9.9167, device='cuda:1')
benign distance is  tensor(9.9167, device='cuda:1')
norm1 res is  tensor(0.1518, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.011610710993409157
distance 1 is tensor(132.1555, device='cuda:1')
distance 2 is tensor(9.5234, device='cuda:1')
benign distance is  tensor(9.5234, device='cuda:1')
norm1 res is  tensor(0.1433, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.29636311531066895
distance 1 is tensor(132.2912, device='cuda:1')
distance 2 is tensor(9.6974, device='cuda:1')
benign distance is  tensor(9.6974, device='cuda:1')
norm1 res is  tensor(0.1478, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  1.1831324100494385
distance 1 is tensor(140.6533, device='cuda:1')
distance 2 is tensor(10.1845, device='cuda:1')
benign distance is  tensor(10.1845, device='cuda:1')
norm1 res is  tensor(0.1528, device='cuda:1')
current submit client idx and staleness is  24 4
 benign loss is  0.31671541929244995
distance 1 is tensor(148.7475, device='cuda:1')
distance 2 is tensor(10.6241, device='cuda:1')
benign distance is  tensor(10.6241, device='cuda:1')
norm1 res is  tensor(0.1622, device='cuda:1')
current submit client idx and staleness is  25 4
 benign loss is  0.16118432581424713
distance 1 is tensor(142.4994, device='cuda:1')
distance 2 is tensor(10.1744, device='cuda:1')
benign distance is  tensor(10.1744, device='cuda:1')
norm1 res is  tensor(0.1512, device='cuda:1')
current submit client idx and staleness is  26 4
 benign loss is  0.15501460433006287
distance 1 is tensor(143.4523, device='cuda:1')
distance 2 is tensor(10.3560, device='cuda:1')
benign distance is  tensor(10.3560, device='cuda:1')
norm1 res is  tensor(0.1570, device='cuda:1')
current submit client idx and staleness is  27 4
 benign loss is  0.32892125844955444
distance 1 is tensor(149.3880, device='cuda:1')
distance 2 is tensor(10.7885, device='cuda:1')
benign distance is  tensor(10.7885, device='cuda:1')
norm1 res is  tensor(0.1631, device='cuda:1')
current submit client idx and staleness is  28 4
 benign loss is  0.766577422618866
distance 1 is tensor(144.1642, device='cuda:1')
distance 2 is tensor(10.4914, device='cuda:1')
benign distance is  tensor(10.4914, device='cuda:1')
norm1 res is  tensor(0.1562, device='cuda:1')
current submit client idx and staleness is  29 4
 benign loss is  0.21805858612060547
distance 1 is tensor(150.0405, device='cuda:1')
distance 2 is tensor(10.7870, device='cuda:1')
benign distance is  tensor(10.7870, device='cuda:1')
norm1 res is  tensor(0.1658, device='cuda:1')
current submit client idx and staleness is  30 4
 benign loss is  0.4377352297306061
distance 1 is tensor(142.0251, device='cuda:1')
distance 2 is tensor(10.2891, device='cuda:1')
benign distance is  tensor(10.2891, device='cuda:1')
norm1 res is  tensor(0.1565, device='cuda:1')
current submit client idx and staleness is  31 4
 benign loss is  0.3154802918434143
distance 1 is tensor(145.6973, device='cuda:1')
distance 2 is tensor(10.7233, device='cuda:1')
benign distance is  tensor(10.7233, device='cuda:1')
norm1 res is  tensor(0.1632, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(0.1752, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(429.5964, device='cuda:1')
c is  tensor(0.0202, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.3959e-07, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(456.0854, device='cuda:1')
c is  tensor(0.0196, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.8411, device='cuda:1')
c is  tensor(0.0178, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.9686, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.9306, device='cuda:1')
c is  tensor(0.0177, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.5086e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.6601, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.5464, device='cuda:1')
c is  tensor(0.0174, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.6005, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.1991e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.8345, device='cuda:1')
c is  tensor(0.0157, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.5165, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(798.1589, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.8416, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.6283, device='cuda:1')
c is  tensor(0.0149, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.7390, device='cuda:1')
c is  tensor(0.0153, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.3790, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(716.9992, device='cuda:1')
c is  tensor(0.0156, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
len accept list 4
len all weights is 4
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 92.73% 

Test Accuracy: 89.78% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
 benign loss is  0.33838751912117004
distance 1 is tensor(109.1797, device='cuda:1')
distance 2 is tensor(8.0486, device='cuda:1')
benign distance is  tensor(8.0486, device='cuda:1')
norm1 res is  tensor(0.1191, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.37242430448532104
distance 1 is tensor(127.6848, device='cuda:1')
distance 2 is tensor(9.1759, device='cuda:1')
benign distance is  tensor(9.1759, device='cuda:1')
norm1 res is  tensor(0.1365, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.1632269024848938
distance 1 is tensor(131.8169, device='cuda:1')
distance 2 is tensor(9.6455, device='cuda:1')
benign distance is  tensor(9.6455, device='cuda:1')
norm1 res is  tensor(0.1469, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.12677565217018127
distance 1 is tensor(142.2902, device='cuda:1')
distance 2 is tensor(10.3376, device='cuda:1')
benign distance is  tensor(10.3376, device='cuda:1')
norm1 res is  tensor(0.1576, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.7338606119155884
distance 1 is tensor(138.9932, device='cuda:1')
distance 2 is tensor(9.9748, device='cuda:1')
benign distance is  tensor(9.9748, device='cuda:1')
norm1 res is  tensor(0.1525, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.8679076433181763
distance 1 is tensor(142.5184, device='cuda:1')
distance 2 is tensor(10.4382, device='cuda:1')
benign distance is  tensor(10.4382, device='cuda:1')
norm1 res is  tensor(0.1590, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.5109371542930603
distance 1 is tensor(135.8374, device='cuda:1')
distance 2 is tensor(9.8185, device='cuda:1')
benign distance is  tensor(9.8185, device='cuda:1')
norm1 res is  tensor(0.1496, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.45418810844421387
distance 1 is tensor(131.9130, device='cuda:1')
distance 2 is tensor(9.4444, device='cuda:1')
benign distance is  tensor(9.4444, device='cuda:1')
norm1 res is  tensor(0.1462, device='cuda:1')
current submit client idx and staleness is  32 5
 benign loss is  0.45647257566452026
distance 1 is tensor(139.0491, device='cuda:1')
distance 2 is tensor(10.1625, device='cuda:1')
benign distance is  tensor(10.1625, device='cuda:1')
norm1 res is  tensor(0.1497, device='cuda:1')
current submit client idx and staleness is  33 5
 benign loss is  0.3387971520423889
distance 1 is tensor(149.7579, device='cuda:1')
distance 2 is tensor(10.8911, device='cuda:1')
benign distance is  tensor(10.8911, device='cuda:1')
norm1 res is  tensor(0.1668, device='cuda:1')
current submit client idx and staleness is  34 5
 benign loss is  0.4816104769706726
distance 1 is tensor(145.8506, device='cuda:1')
distance 2 is tensor(10.5026, device='cuda:1')
benign distance is  tensor(10.5026, device='cuda:1')
norm1 res is  tensor(0.1581, device='cuda:1')
current submit client idx and staleness is  35 5
 benign loss is  0.11624512821435928
distance 1 is tensor(139.0343, device='cuda:1')
distance 2 is tensor(10.1003, device='cuda:1')
benign distance is  tensor(10.1003, device='cuda:1')
norm1 res is  tensor(0.1566, device='cuda:1')
current submit client idx and staleness is  36 5
 benign loss is  0.5565659999847412
distance 1 is tensor(154.8532, device='cuda:1')
distance 2 is tensor(11.3415, device='cuda:1')
benign distance is  tensor(11.3415, device='cuda:1')
norm1 res is  tensor(0.1741, device='cuda:1')
current submit client idx and staleness is  37 5
 benign loss is  0.5908724069595337
distance 1 is tensor(136.1650, device='cuda:1')
distance 2 is tensor(10.0503, device='cuda:1')
benign distance is  tensor(10.0503, device='cuda:1')
norm1 res is  tensor(0.1471, device='cuda:1')
current submit client idx and staleness is  38 5
 benign loss is  0.27243950963020325
distance 1 is tensor(142.1710, device='cuda:1')
distance 2 is tensor(10.3958, device='cuda:1')
benign distance is  tensor(10.3958, device='cuda:1')
norm1 res is  tensor(0.1559, device='cuda:1')
current submit client idx and staleness is  39 5
 benign loss is  0.22800025343894958
distance 1 is tensor(134.1104, device='cuda:1')
distance 2 is tensor(9.6957, device='cuda:1')
benign distance is  tensor(9.6957, device='cuda:1')
norm1 res is  tensor(0.1455, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 32
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1556, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(462.3847, device='cuda:1')
c is  tensor(0.0183, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.9435, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.6859, device='cuda:1')
c is  tensor(0.0163, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.4969e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.8442, device='cuda:1')
c is  tensor(0.0158, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.9687e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.7139, device='cuda:1')
c is  tensor(0.0161, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.9777, device='cuda:1')
c is  tensor(0.0158, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.6371, device='cuda:1')
c is  tensor(0.0162, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4580e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.2592, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(801.2042, device='cuda:1')
c is  tensor(0.0139, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(780.7956, device='cuda:1')
c is  tensor(0.0141, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.0916, device='cuda:1')
c is  tensor(0.0146, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(826.8328, device='cuda:1')
c is  tensor(0.0137, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.1613, device='cuda:1')
c is  tensor(0.0144, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(786.9890, device='cuda:1')
c is  tensor(0.0141, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.7692e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(780.9926, device='cuda:1')
c is  tensor(0.0141, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(780.3364, device='cuda:1')
c is  tensor(0.0141, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.3490, device='cuda:1')
c is  tensor(0.0142, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.3087e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(834.0880, device='cuda:1')
c is  tensor(0.0137, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.9519e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.5840, device='cuda:1')
c is  tensor(0.0141, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.0934e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.0281, device='cuda:1')
c is  tensor(0.0139, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5059, device='cuda:1')
c is  tensor(0.0147, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.0345, device='cuda:1')
c is  tensor(0.0143, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.9871e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(835.1301, device='cuda:1')
c is  tensor(0.0136, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.9190e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(802.0555, device='cuda:1')
c is  tensor(0.0139, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.7439, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.8315, device='cuda:1')
c is  tensor(0.0158, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.1348e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.0344, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.7717, device='cuda:1')
c is  tensor(0.0155, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.2348e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.0999, device='cuda:1')
c is  tensor(0.0156, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.6458e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.1529, device='cuda:1')
c is  tensor(0.0159, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7913, device='cuda:1')
c is  tensor(0.0157, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8169, device='cuda:1')
c is  tensor(0.0155, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
len accept list 9
len all weights is 9
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 92.85% 

Test Accuracy: 89.81% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
 benign loss is  0.061121128499507904
distance 1 is tensor(115.5249, device='cuda:1')
distance 2 is tensor(8.2184, device='cuda:1')
benign distance is  tensor(8.2184, device='cuda:1')
norm1 res is  tensor(0.1226, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.011165686883032322
distance 1 is tensor(77.8487, device='cuda:1')
distance 2 is tensor(5.7558, device='cuda:1')
benign distance is  tensor(5.7558, device='cuda:1')
norm1 res is  tensor(0.0837, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.061726462095975876
distance 1 is tensor(106.8702, device='cuda:1')
distance 2 is tensor(7.6985, device='cuda:1')
benign distance is  tensor(7.6985, device='cuda:1')
norm1 res is  tensor(0.1138, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.4178239703178406
distance 1 is tensor(124.8940, device='cuda:1')
distance 2 is tensor(9.0469, device='cuda:1')
benign distance is  tensor(9.0469, device='cuda:1')
norm1 res is  tensor(0.1351, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.656408429145813
distance 1 is tensor(135.5538, device='cuda:1')
distance 2 is tensor(9.8363, device='cuda:1')
benign distance is  tensor(9.8363, device='cuda:1')
norm1 res is  tensor(0.1467, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.9931879043579102
distance 1 is tensor(146.5550, device='cuda:1')
distance 2 is tensor(10.6114, device='cuda:1')
benign distance is  tensor(10.6114, device='cuda:1')
norm1 res is  tensor(0.1611, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.30354347825050354
distance 1 is tensor(123.2341, device='cuda:1')
distance 2 is tensor(8.8285, device='cuda:1')
benign distance is  tensor(8.8285, device='cuda:1')
norm1 res is  tensor(0.1330, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.3043379783630371
distance 1 is tensor(112.2440, device='cuda:1')
distance 2 is tensor(8.1295, device='cuda:1')
benign distance is  tensor(8.1295, device='cuda:1')
norm1 res is  tensor(0.1218, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.11940642446279526
distance 1 is tensor(151.9057, device='cuda:1')
distance 2 is tensor(10.8785, device='cuda:1')
benign distance is  tensor(10.8785, device='cuda:1')
norm1 res is  tensor(0.1677, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.3046784996986389
distance 1 is tensor(129.8472, device='cuda:1')
distance 2 is tensor(9.4844, device='cuda:1')
benign distance is  tensor(9.4844, device='cuda:1')
norm1 res is  tensor(0.1440, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  1.274076223373413
distance 1 is tensor(135.8249, device='cuda:1')
distance 2 is tensor(9.8134, device='cuda:1')
benign distance is  tensor(9.8134, device='cuda:1')
norm1 res is  tensor(0.1472, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.420989990234375
distance 1 is tensor(146.4887, device='cuda:1')
distance 2 is tensor(10.5732, device='cuda:1')
benign distance is  tensor(10.5732, device='cuda:1')
norm1 res is  tensor(0.1608, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.3400114178657532
distance 1 is tensor(147.0397, device='cuda:1')
distance 2 is tensor(10.6670, device='cuda:1')
benign distance is  tensor(10.6670, device='cuda:1')
norm1 res is  tensor(0.1588, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.14608189463615417
distance 1 is tensor(139.4309, device='cuda:1')
distance 2 is tensor(10.0586, device='cuda:1')
benign distance is  tensor(10.0586, device='cuda:1')
norm1 res is  tensor(0.1523, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.11173542588949203
distance 1 is tensor(142.9232, device='cuda:1')
distance 2 is tensor(10.5127, device='cuda:1')
benign distance is  tensor(10.5127, device='cuda:1')
norm1 res is  tensor(0.1601, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.9457341432571411
distance 1 is tensor(151.6121, device='cuda:1')
distance 2 is tensor(10.9674, device='cuda:1')
benign distance is  tensor(10.9674, device='cuda:1')
norm1 res is  tensor(0.1639, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.16530530154705048
distance 1 is tensor(135.2731, device='cuda:1')
distance 2 is tensor(9.9101, device='cuda:1')
benign distance is  tensor(9.9101, device='cuda:1')
norm1 res is  tensor(0.1509, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.4497099816799164
distance 1 is tensor(143.4664, device='cuda:1')
distance 2 is tensor(10.4397, device='cuda:1')
benign distance is  tensor(10.4397, device='cuda:1')
norm1 res is  tensor(0.1568, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.16509804129600525
distance 1 is tensor(139.1900, device='cuda:1')
distance 2 is tensor(10.1102, device='cuda:1')
benign distance is  tensor(10.1102, device='cuda:1')
norm1 res is  tensor(0.1518, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.292208731174469
distance 1 is tensor(135.0272, device='cuda:1')
distance 2 is tensor(9.8336, device='cuda:1')
benign distance is  tensor(9.8336, device='cuda:1')
norm1 res is  tensor(0.1486, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.19327209889888763
distance 1 is tensor(145.5082, device='cuda:1')
distance 2 is tensor(10.4859, device='cuda:1')
benign distance is  tensor(10.4859, device='cuda:1')
norm1 res is  tensor(0.1571, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  0.5023959279060364
distance 1 is tensor(145.4846, device='cuda:1')
distance 2 is tensor(10.5398, device='cuda:1')
benign distance is  tensor(10.5398, device='cuda:1')
norm1 res is  tensor(0.1612, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.35411345958709717
distance 1 is tensor(140.2484, device='cuda:1')
distance 2 is tensor(10.2100, device='cuda:1')
benign distance is  tensor(10.2100, device='cuda:1')
norm1 res is  tensor(0.1547, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  1.1754076480865479
distance 1 is tensor(141.6491, device='cuda:1')
distance 2 is tensor(10.2490, device='cuda:1')
benign distance is  tensor(10.2490, device='cuda:1')
norm1 res is  tensor(0.1537, device='cuda:1')
current submit client idx and staleness is  40 6
 benign loss is  0.01561262272298336
distance 1 is tensor(152.6652, device='cuda:1')
distance 2 is tensor(11.3484, device='cuda:1')
benign distance is  tensor(11.3484, device='cuda:1')
norm1 res is  tensor(0.1682, device='cuda:1')
current submit client idx and staleness is  41 6
 benign loss is  0.13253767788410187
distance 1 is tensor(135.9471, device='cuda:1')
distance 2 is tensor(10.0293, device='cuda:1')
benign distance is  tensor(10.0293, device='cuda:1')
norm1 res is  tensor(0.1509, device='cuda:1')
current submit client idx and staleness is  42 6
 benign loss is  0.12091661989688873
distance 1 is tensor(128.1460, device='cuda:1')
distance 2 is tensor(9.2978, device='cuda:1')
benign distance is  tensor(9.2978, device='cuda:1')
norm1 res is  tensor(0.1381, device='cuda:1')
current submit client idx and staleness is  43 6
 benign loss is  0.795911431312561
distance 1 is tensor(139.0097, device='cuda:1')
distance 2 is tensor(10.0053, device='cuda:1')
benign distance is  tensor(10.0053, device='cuda:1')
norm1 res is  tensor(0.1531, device='cuda:1')
current submit client idx and staleness is  44 6
 benign loss is  0.18594080209732056
distance 1 is tensor(155.9537, device='cuda:1')
distance 2 is tensor(11.2881, device='cuda:1')
benign distance is  tensor(11.2881, device='cuda:1')
norm1 res is  tensor(0.1712, device='cuda:1')
current submit client idx and staleness is  45 6
 benign loss is  0.16436251997947693
distance 1 is tensor(151.0837, device='cuda:1')
distance 2 is tensor(10.8710, device='cuda:1')
benign distance is  tensor(10.8710, device='cuda:1')
norm1 res is  tensor(0.1617, device='cuda:1')
current submit client idx and staleness is  46 6
 benign loss is  0.8624943494796753
distance 1 is tensor(160.7827, device='cuda:1')
distance 2 is tensor(11.5420, device='cuda:1')
benign distance is  tensor(11.5420, device='cuda:1')
norm1 res is  tensor(0.1762, device='cuda:1')
current submit client idx and staleness is  47 6
 benign loss is  0.14420075714588165
distance 1 is tensor(141.5993, device='cuda:1')
distance 2 is tensor(10.2598, device='cuda:1')
benign distance is  tensor(10.2598, device='cuda:1')
norm1 res is  tensor(0.1566, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(162.9819, device='cuda:1')
distance 2 is tensor(11.6414, device='cuda:1')
compute distance is  tensor(11.6414, device='cuda:1')
compute norm is  tensor(53.5809, device='cuda:1')
distance 1 is tensor(160.2377, device='cuda:1')
distance 2 is tensor(11.5539, device='cuda:1')
compute distance is  tensor(11.5539, device='cuda:1')
compute norm is  tensor(53.4256, device='cuda:1')
distance 1 is tensor(184.8883, device='cuda:1')
distance 2 is tensor(13.2079, device='cuda:1')
compute distance is  tensor(13.2079, device='cuda:1')
compute norm is  tensor(54.0350, device='cuda:1')
distance 1 is tensor(150.1679, device='cuda:1')
distance 2 is tensor(10.9333, device='cuda:1')
compute distance is  tensor(10.9333, device='cuda:1')
compute norm is  tensor(53.2956, device='cuda:1')
distance 1 is tensor(165.2764, device='cuda:1')
distance 2 is tensor(11.9461, device='cuda:1')
compute distance is  tensor(11.9461, device='cuda:1')
compute norm is  tensor(53.6773, device='cuda:1')
distance 1 is tensor(174.9742, device='cuda:1')
distance 2 is tensor(12.5946, device='cuda:1')
compute distance is  tensor(12.5946, device='cuda:1')
compute norm is  tensor(53.9712, device='cuda:1')
distance 1 is tensor(182.0722, device='cuda:1')
distance 2 is tensor(13.0981, device='cuda:1')
compute distance is  tensor(13.0981, device='cuda:1')
compute norm is  tensor(54.1700, device='cuda:1')
distance 1 is tensor(173.9790, device='cuda:1')
distance 2 is tensor(12.5204, device='cuda:1')
compute distance is  tensor(12.5204, device='cuda:1')
compute norm is  tensor(53.8913, device='cuda:1')
distance 1 is tensor(152.6813, device='cuda:1')
distance 2 is tensor(11.0256, device='cuda:1')
compute distance is  tensor(11.0256, device='cuda:1')
compute norm is  tensor(53.5475, device='cuda:1')
distance 1 is tensor(162.2209, device='cuda:1')
distance 2 is tensor(11.6058, device='cuda:1')
compute distance is  tensor(11.6058, device='cuda:1')
compute norm is  tensor(53.6480, device='cuda:1')
distance 1 is tensor(166.9585, device='cuda:1')
distance 2 is tensor(11.9628, device='cuda:1')
compute distance is  tensor(11.9628, device='cuda:1')
compute norm is  tensor(53.7839, device='cuda:1')
distance 1 is tensor(155.1322, device='cuda:1')
distance 2 is tensor(11.0270, device='cuda:1')
compute distance is  tensor(11.0270, device='cuda:1')
compute norm is  tensor(53.5787, device='cuda:1')
batch acc is 0.10320000015633192
batch acc is 0.10160000015633655
batch acc is 0.10106666682300632
batch acc is 0.10080000015634122
batch acc is 0.10064000015634215
batch acc is 0.10053333348967068
batch acc is 0.1004571430134733
batch acc is 0.10040000015632526
batch acc is 0.10035555571187679
batch acc is 0.10032000015631802
mal_rand_acc is 0.1500000005
mal_rand loss is 6.26871298852651e+17
len of model dicts is  12
distance 1 is tensor(162.9819, device='cuda:1')
distance 2 is tensor(11.6414, device='cuda:1')
compute distance is  tensor(11.6414, device='cuda:1')
compute norm is  tensor(53.5809, device='cuda:1')
distance 1 is tensor(160.2377, device='cuda:1')
distance 2 is tensor(11.5539, device='cuda:1')
compute distance is  tensor(11.5539, device='cuda:1')
compute norm is  tensor(53.4256, device='cuda:1')
distance 1 is tensor(184.8883, device='cuda:1')
distance 2 is tensor(13.2079, device='cuda:1')
compute distance is  tensor(13.2079, device='cuda:1')
compute norm is  tensor(54.0350, device='cuda:1')
distance 1 is tensor(150.1679, device='cuda:1')
distance 2 is tensor(10.9333, device='cuda:1')
compute distance is  tensor(10.9333, device='cuda:1')
compute norm is  tensor(53.2956, device='cuda:1')
distance 1 is tensor(165.2764, device='cuda:1')
distance 2 is tensor(11.9461, device='cuda:1')
compute distance is  tensor(11.9461, device='cuda:1')
compute norm is  tensor(53.6773, device='cuda:1')
distance 1 is tensor(174.9742, device='cuda:1')
distance 2 is tensor(12.5946, device='cuda:1')
compute distance is  tensor(12.5946, device='cuda:1')
compute norm is  tensor(53.9712, device='cuda:1')
distance 1 is tensor(182.0722, device='cuda:1')
distance 2 is tensor(13.0981, device='cuda:1')
compute distance is  tensor(13.0981, device='cuda:1')
compute norm is  tensor(54.1700, device='cuda:1')
distance 1 is tensor(173.9790, device='cuda:1')
distance 2 is tensor(12.5204, device='cuda:1')
compute distance is  tensor(12.5204, device='cuda:1')
compute norm is  tensor(53.8913, device='cuda:1')
distance 1 is tensor(152.6813, device='cuda:1')
distance 2 is tensor(11.0256, device='cuda:1')
compute distance is  tensor(11.0256, device='cuda:1')
compute norm is  tensor(53.5475, device='cuda:1')
distance 1 is tensor(162.2209, device='cuda:1')
distance 2 is tensor(11.6058, device='cuda:1')
compute distance is  tensor(11.6058, device='cuda:1')
compute norm is  tensor(53.6480, device='cuda:1')
distance 1 is tensor(166.9585, device='cuda:1')
distance 2 is tensor(11.9628, device='cuda:1')
compute distance is  tensor(11.9628, device='cuda:1')
compute norm is  tensor(53.7839, device='cuda:1')
distance 1 is tensor(155.1322, device='cuda:1')
distance 2 is tensor(11.0270, device='cuda:1')
compute distance is  tensor(11.0270, device='cuda:1')
compute norm is  tensor(53.5787, device='cuda:1')
distance Threshold  is  tensor(13.2079, device='cuda:1')
distance 1 is tensor(1017917.9375, device='cuda:1')
distance 2 is tensor(74725.8828, device='cuda:1')
________________________________
test distance is  tensor(74725.8828, device='cuda:1')
test similarity is  tensor(-0.1221, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.541303578734623e+17
test entropy is  0.0
________________________________
cal ratio is  0.011965287087731055
distance 1 is tensor(12179.6855, device='cuda:1')
distance 2 is tensor(894.1167, device='cuda:1')
cal_distance is  tensor(894.1167, device='cuda:1')
cal ratio is  0.1093859492083715
distance 1 is tensor(1332.2921, device='cuda:1')
distance 2 is tensor(97.8038, device='cuda:1')
cal_distance is  tensor(97.8038, device='cuda:1')
cal ratio is  0.330735466238786
distance 1 is tensor(440.6405, device='cuda:1')
distance 2 is tensor(32.3472, device='cuda:1')
cal_distance is  tensor(32.3472, device='cuda:1')
cal ratio is  0.5750960495275828
distance 1 is tensor(253.4133, device='cuda:1')
distance 2 is tensor(18.6027, device='cuda:1')
cal_distance is  tensor(18.6027, device='cuda:1')
cal ratio is  0.7583508260686589
distance 1 is tensor(192.1777, device='cuda:1')
distance 2 is tensor(14.1074, device='cuda:1')
cal_distance is  tensor(14.1074, device='cuda:1')
cal ratio is  0.8708334454318861
distance 1 is tensor(167.3556, device='cuda:1')
distance 2 is tensor(12.2852, device='cuda:1')
cal_distance is  tensor(12.2852, device='cuda:1')
distance 1 is tensor(167.3556, device='cuda:1')
distance 2 is tensor(12.2852, device='cuda:1')
________________________________
test distance is  tensor(12.2852, device='cuda:1')
test similarity is  tensor(0.9407, device='cuda:1')
test acc is  0.8009500001563254
test loss is 115.09336325151325
test entropy is  0.0117148589294444
________________________________
distance 1 is tensor(167.3556, device='cuda:1')
distance 2 is tensor(12.2852, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.012157139380938153
avg test loss is  115.33826130946308
avg accuracy is  0.7995666668229922
solo acc is  0.22163333348967065
compute similarity  is  tensor(0.9407, device='cuda:1')
compute_distance is  tensor(12.2852, device='cuda:1')
compute_norm is  tensor(53.7284, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(153.9426, device='cuda:1')
distance 2 is tensor(13.8059, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0010348496787838
avg test loss is  1.6421772225070863
avg accuracy is  0.8312000001563241
solo acc is  0.29721666682300607
compute similarity  is  tensor(0.9430, device='cuda:1')
compute_distance is  tensor(13.8059, device='cuda:1')
compute_norm is  tensor(52.5045, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.0881, device='cuda:1')
distance 2 is tensor(14.1511, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9562463865859676
avg test loss is  1.6796294998512593
avg accuracy is  0.8255333334896575
solo acc is  0.2490833334896716
compute similarity  is  tensor(0.9425, device='cuda:1')
compute_distance is  tensor(14.1511, device='cuda:1')
compute_norm is  tensor(52.1810, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.8704, device='cuda:1')
distance 2 is tensor(14.3859, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9326196877814051
avg test loss is  1.6349305443163873
avg accuracy is  0.8274000001563242
solo acc is  0.24853333348967152
compute similarity  is  tensor(0.9422, device='cuda:1')
compute_distance is  tensor(14.3859, device='cuda:1')
compute_norm is  tensor(51.8775, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.6084, device='cuda:1')
distance 2 is tensor(14.5789, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.9194496771547077
avg test loss is  1.5946063209952577
avg accuracy is  0.8286833334896575
solo acc is  0.24876666682300488
compute similarity  is  tensor(0.9420, device='cuda:1')
compute_distance is  tensor(14.5789, device='cuda:1')
compute_norm is  tensor(51.5863, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(161.3862, device='cuda:1')
distance 2 is tensor(14.7601, device='cuda:1')
________________________________
test distance is  tensor(14.7601, device='cuda:1')
test similarity is  tensor(0.9417, device='cuda:1')
test acc is  0.8317833334896574
test loss is 1.5709864137523464
test entropy is  0.9042240490537208
________________________________
cal ratio is  0.8513610409057276
distance 1 is tensor(137.3987, device='cuda:1')
distance 2 is tensor(12.5662, device='cuda:1')
cal_distance is  tensor(12.5662, device='cuda:1')
distance 1 is tensor(137.3987, device='cuda:1')
distance 2 is tensor(12.5662, device='cuda:1')
________________________________
test distance is  tensor(12.5662, device='cuda:1')
test similarity is  tensor(0.9578, device='cuda:1')
test acc is  0.8576166668229896
test loss is 1.1167336864385016
test entropy is  0.9708423695838782
________________________________
distance 1 is tensor(137.3987, device='cuda:1')
distance 2 is tensor(12.5662, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.9700621194295538
avg test loss is  1.1186900262766555
avg accuracy is  0.858700000156323
solo acc is  0.5114000001563421
compute similarity  is  tensor(0.9578, device='cuda:1')
compute_distance is  tensor(12.5662, device='cuda:1')
compute_norm is  tensor(51.2723, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.2341, device='cuda:1')
distance 2 is tensor(13.0381, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8966606266335893
avg test loss is  1.5503023798023459
avg accuracy is  0.84911666682299
solo acc is  0.24733333348967146
compute similarity  is  tensor(0.9568, device='cuda:1')
compute_distance is  tensor(13.0381, device='cuda:1')
compute_norm is  tensor(50.9844, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.5694, device='cuda:1')
distance 2 is tensor(13.2574, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8861528543521092
avg test loss is  1.524454646400297
avg accuracy is  0.84951666682299
solo acc is  0.2477500001563382
compute similarity  is  tensor(0.9565, device='cuda:1')
compute_distance is  tensor(13.2574, device='cuda:1')
compute_norm is  tensor(50.7028, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.7290, device='cuda:1')
distance 2 is tensor(13.4431, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8802565024224426
avg test loss is  1.5020687857162216
avg accuracy is  0.8514333334896566
solo acc is  0.24898333348967158
compute similarity  is  tensor(0.9562, device='cuda:1')
compute_distance is  tensor(13.4431, device='cuda:1')
compute_norm is  tensor(50.4276, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.8067, device='cuda:1')
distance 2 is tensor(13.6105, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8760694894455135
avg test loss is  1.4724342383301334
avg accuracy is  0.8536166668229899
solo acc is  0.25001666682300494
compute similarity  is  tensor(0.9559, device='cuda:1')
compute_distance is  tensor(13.6105, device='cuda:1')
compute_norm is  tensor(50.1576, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.8475, device='cuda:1')
distance 2 is tensor(13.7706, device='cuda:1')
________________________________
test distance is  tensor(13.7706, device='cuda:1')
test similarity is  tensor(0.9556, device='cuda:1')
test acc is  0.8541500001563233
test loss is 1.4620440822166165
test entropy is  0.8692091780939082
________________________________
cal ratio is  0.8814171044205913
distance 1 is tensor(132.0788, device='cuda:1')
distance 2 is tensor(12.1377, device='cuda:1')
cal_distance is  tensor(12.1377, device='cuda:1')
distance 1 is tensor(132.0788, device='cuda:1')
distance 2 is tensor(12.1377, device='cuda:1')
________________________________
test distance is  tensor(12.1377, device='cuda:1')
test similarity is  tensor(0.9658, device='cuda:1')
test acc is  0.8708500001563225
test loss is 1.0719377159563972
test entropy is  0.9326685770615332
________________________________
distance 1 is tensor(132.0788, device='cuda:1')
distance 2 is tensor(12.1377, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.9334624908499117
avg test loss is  1.070228917194582
avg accuracy is  0.870366666822989
solo acc is  0.5046833334896754
compute similarity  is  tensor(0.9658, device='cuda:1')
compute_distance is  tensor(12.1377, device='cuda:1')
compute_norm is  tensor(50.0734, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.9083, device='cuda:1')
distance 2 is tensor(12.5629, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8638949404393178
avg test loss is  1.4469629559181392
avg accuracy is  0.8640000001563227
solo acc is  0.25413333348967176
compute similarity  is  tensor(0.9649, device='cuda:1')
compute_distance is  tensor(12.5629, device='cuda:1')
compute_norm is  tensor(49.8142, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.4506, device='cuda:1')
distance 2 is tensor(12.7703, device='cuda:1')
exit early
distance 1 is tensor(138.4506, device='cuda:1')
distance 2 is tensor(12.7703, device='cuda:1')
________________________________
test distance is  tensor(12.7703, device='cuda:1')
test similarity is  tensor(0.9645, device='cuda:1')
test acc is  0.8644833334896561
test loss is 1.4425546853527078
test entropy is  0.8525945699926633
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.141451358795166
mal norm is  tensor(6.4600, device='cuda:1')
distance 1 is tensor(138.4506, device='cuda:1')
distance 2 is tensor(12.7703, device='cuda:1')
mal distance is  tensor(12.7703, device='cuda:1')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1107, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(486.7770, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.4224e-06, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(333.0484, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.1271e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(449.6586, device='cuda:1')
c is  tensor(0.0157, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.2552e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.9167, device='cuda:1')
c is  tensor(0.0144, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9047e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.7465, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.0082, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.6756, device='cuda:1')
c is  tensor(0.0146, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9966e-06, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.7187, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.0014, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
len accept list 15
len all weights is 15
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 85.82% 

Test Accuracy: 83.97% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
 benign loss is  0.060961030423641205
distance 1 is tensor(173.0578, device='cuda:1')
distance 2 is tensor(12.7828, device='cuda:1')
benign distance is  tensor(12.7828, device='cuda:1')
norm1 res is  tensor(0.1817, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.4952433109283447
distance 1 is tensor(173.5012, device='cuda:1')
distance 2 is tensor(12.7550, device='cuda:1')
benign distance is  tensor(12.7550, device='cuda:1')
norm1 res is  tensor(0.1780, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.3078725337982178
distance 1 is tensor(173.4774, device='cuda:1')
distance 2 is tensor(12.6260, device='cuda:1')
benign distance is  tensor(12.6260, device='cuda:1')
norm1 res is  tensor(0.1794, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.4277598261833191
distance 1 is tensor(173.5536, device='cuda:1')
distance 2 is tensor(12.6231, device='cuda:1')
benign distance is  tensor(12.6231, device='cuda:1')
norm1 res is  tensor(0.1767, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  1.031131625175476
distance 1 is tensor(180.6288, device='cuda:1')
distance 2 is tensor(13.2726, device='cuda:1')
benign distance is  tensor(13.2726, device='cuda:1')
norm1 res is  tensor(0.1883, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.7379969358444214
distance 1 is tensor(202.9498, device='cuda:1')
distance 2 is tensor(14.9071, device='cuda:1')
benign distance is  tensor(14.9071, device='cuda:1')
norm1 res is  tensor(0.2102, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.5528335571289062
distance 1 is tensor(170.2126, device='cuda:1')
distance 2 is tensor(12.5034, device='cuda:1')
benign distance is  tensor(12.5034, device='cuda:1')
norm1 res is  tensor(0.1767, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.706025242805481
distance 1 is tensor(166.6070, device='cuda:1')
distance 2 is tensor(12.2902, device='cuda:1')
benign distance is  tensor(12.2902, device='cuda:1')
norm1 res is  tensor(0.1724, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(179.1845, device='cuda:1')
distance 2 is tensor(14.0416, device='cuda:1')
compute distance is  tensor(14.0416, device='cuda:1')
compute norm is  tensor(53.8777, device='cuda:1')
distance 1 is tensor(194.3867, device='cuda:1')
distance 2 is tensor(15.0031, device='cuda:1')
compute distance is  tensor(15.0031, device='cuda:1')
compute norm is  tensor(54.2436, device='cuda:1')
distance 1 is tensor(206.3410, device='cuda:1')
distance 2 is tensor(15.7252, device='cuda:1')
compute distance is  tensor(15.7252, device='cuda:1')
compute norm is  tensor(54.6318, device='cuda:1')
distance 1 is tensor(181.2210, device='cuda:1')
distance 2 is tensor(14.1337, device='cuda:1')
compute distance is  tensor(14.1337, device='cuda:1')
compute norm is  tensor(54.0079, device='cuda:1')
distance 1 is tensor(190.3361, device='cuda:1')
distance 2 is tensor(14.7992, device='cuda:1')
compute distance is  tensor(14.7992, device='cuda:1')
compute norm is  tensor(54.2882, device='cuda:1')
distance 1 is tensor(197.9906, device='cuda:1')
distance 2 is tensor(15.2305, device='cuda:1')
compute distance is  tensor(15.2305, device='cuda:1')
compute norm is  tensor(54.4686, device='cuda:1')
distance 1 is tensor(186.8405, device='cuda:1')
distance 2 is tensor(14.4443, device='cuda:1')
compute distance is  tensor(14.4443, device='cuda:1')
compute norm is  tensor(54.1347, device='cuda:1')
distance 1 is tensor(188.6689, device='cuda:1')
distance 2 is tensor(14.6098, device='cuda:1')
compute distance is  tensor(14.6098, device='cuda:1')
compute norm is  tensor(54.1120, device='cuda:1')
distance 1 is tensor(188.9871, device='cuda:1')
distance 2 is tensor(14.6447, device='cuda:1')
compute distance is  tensor(14.6447, device='cuda:1')
compute norm is  tensor(54.3041, device='cuda:1')
distance 1 is tensor(190.5639, device='cuda:1')
distance 2 is tensor(14.7382, device='cuda:1')
compute distance is  tensor(14.7382, device='cuda:1')
compute norm is  tensor(54.2560, device='cuda:1')
distance 1 is tensor(187.8784, device='cuda:1')
distance 2 is tensor(14.4416, device='cuda:1')
compute distance is  tensor(14.4416, device='cuda:1')
compute norm is  tensor(54.2368, device='cuda:1')
distance 1 is tensor(179.6132, device='cuda:1')
distance 2 is tensor(13.9091, device='cuda:1')
compute distance is  tensor(13.9091, device='cuda:1')
compute norm is  tensor(54.0766, device='cuda:1')
distance Threshold  is  tensor(15.7252, device='cuda:1')
distance 1 is tensor(1017867.3125, device='cuda:1')
distance 2 is tensor(74720.9766, device='cuda:1')
________________________________
test distance is  tensor(74720.9766, device='cuda:1')
test similarity is  tensor(0.0199, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.537371957246769e+17
test entropy is  0.0
________________________________
cal ratio is  0.013056282664332008
distance 1 is tensor(13289.5693, device='cuda:1')
distance 2 is tensor(975.5783, device='cuda:1')
cal_distance is  tensor(975.5783, device='cuda:1')
cal ratio is  0.11426408457046987
distance 1 is tensor(1518.5261, device='cuda:1')
distance 2 is tensor(111.4736, device='cuda:1')
cal_distance is  tensor(111.4736, device='cuda:1')
cal ratio is  0.3380297139719973
distance 1 is tensor(513.3111, device='cuda:1')
distance 2 is tensor(37.6814, device='cuda:1')
cal_distance is  tensor(37.6814, device='cuda:1')
cal ratio is  0.5814032521794656
distance 1 is tensor(298.4434, device='cuda:1')
distance 2 is tensor(21.9081, device='cuda:1')
cal_distance is  tensor(21.9081, device='cuda:1')
cal ratio is  0.762498060208339
distance 1 is tensor(227.5640, device='cuda:1')
distance 2 is tensor(16.7049, device='cuda:1')
cal_distance is  tensor(16.7049, device='cuda:1')
cal ratio is  0.8732113287756134
distance 1 is tensor(198.7122, device='cuda:1')
distance 2 is tensor(14.5869, device='cuda:1')
cal_distance is  tensor(14.5869, device='cuda:1')
distance 1 is tensor(198.7122, device='cuda:1')
distance 2 is tensor(14.5869, device='cuda:1')
________________________________
test distance is  tensor(14.5869, device='cuda:1')
test similarity is  tensor(0.9187, device='cuda:1')
test acc is  0.1270166668229986
test loss is 421.53846698427503
test entropy is  3.588193111619295e-24
________________________________
distance 1 is tensor(198.7122, device='cuda:1')
distance 2 is tensor(14.5869, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  6.40971704601222e-15
avg test loss is  420.80954955534133
avg accuracy is  0.1273500001563319
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9187, device='cuda:1')
compute_distance is  tensor(14.5869, device='cuda:1')
compute_norm is  tensor(53.6363, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(178.1320, device='cuda:1')
distance 2 is tensor(14.9878, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0139254598475214
avg test loss is  1.5855933251157244
avg accuracy is  0.4853000001563419
solo acc is  0.27048333348967213
compute similarity  is  tensor(0.9240, device='cuda:1')
compute_distance is  tensor(14.9878, device='cuda:1')
compute_norm is  tensor(53.3157, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(178.4388, device='cuda:1')
distance 2 is tensor(15.1261, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.626902440431784
avg test loss is  2.468041530931428
avg accuracy is  0.3308333334896735
solo acc is  0.11295000015633196
compute similarity  is  tensor(0.9239, device='cuda:1')
compute_distance is  tensor(15.1261, device='cuda:1')
compute_norm is  tensor(53.1102, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(178.4860, device='cuda:1')
distance 2 is tensor(15.1468, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9883982426067913
avg test loss is  1.493643405340882
avg accuracy is  0.4985333334896754
solo acc is  0.27161666682300556
compute similarity  is  tensor(0.9241, device='cuda:1')
compute_distance is  tensor(15.1468, device='cuda:1')
compute_norm is  tensor(52.7464, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(178.4860, device='cuda:1')
distance 2 is tensor(15.1468, device='cuda:1')
________________________________
test distance is  tensor(15.1468, device='cuda:1')
test similarity is  tensor(0.9241, device='cuda:1')
test acc is  0.494250000156342
test loss is 1.486876027924674
test entropy is  0.987699449316525
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2357136011123657
mal norm is  tensor(9.5081, device='cuda:1')
distance 1 is tensor(178.4860, device='cuda:1')
distance 2 is tensor(15.1468, device='cuda:1')
mal distance is  tensor(15.1468, device='cuda:1')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2197, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.2866, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(707.8267, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.2501, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.4375, device='cuda:1')
c is  tensor(0.0177, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.8995, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(834.2529, device='cuda:1')
c is  tensor(0.0162, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3518, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.4509, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.8129, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0025, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.1901, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(755.5829, device='cuda:1')
c is  tensor(0.0171, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.4949, device='cuda:1')
c is  tensor(0.0168, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(793.9708, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(778.7300, device='cuda:1')
c is  tensor(0.0168, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.5886, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(778.7902, device='cuda:1')
c is  tensor(0.0168, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(800.3730, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(780.0566, device='cuda:1')
c is  tensor(0.0168, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1965, device='cuda:1')
c is  tensor(0.0177, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(716.2568, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.4188, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.5832, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(740.5605, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(761.1697, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.2818, device='cuda:1')
c is  tensor(0.0169, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:1')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 92.77% 

Test Accuracy: 89.70% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
 benign loss is  0.23743829131126404
distance 1 is tensor(110.3781, device='cuda:1')
distance 2 is tensor(7.9218, device='cuda:1')
benign distance is  tensor(7.9218, device='cuda:1')
norm1 res is  tensor(0.1156, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.13608399033546448
distance 1 is tensor(111.8236, device='cuda:1')
distance 2 is tensor(8.0657, device='cuda:1')
benign distance is  tensor(8.0657, device='cuda:1')
norm1 res is  tensor(0.1184, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.3463036119937897
distance 1 is tensor(119.2433, device='cuda:1')
distance 2 is tensor(8.5795, device='cuda:1')
benign distance is  tensor(8.5795, device='cuda:1')
norm1 res is  tensor(0.1260, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.24697093665599823
distance 1 is tensor(120.9284, device='cuda:1')
distance 2 is tensor(8.6497, device='cuda:1')
benign distance is  tensor(8.6497, device='cuda:1')
norm1 res is  tensor(0.1280, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.6034866571426392
distance 1 is tensor(119.6137, device='cuda:1')
distance 2 is tensor(8.6368, device='cuda:1')
benign distance is  tensor(8.6368, device='cuda:1')
norm1 res is  tensor(0.1272, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.7568317651748657
distance 1 is tensor(143.8116, device='cuda:1')
distance 2 is tensor(10.4275, device='cuda:1')
benign distance is  tensor(10.4275, device='cuda:1')
norm1 res is  tensor(0.1572, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.3465195298194885
distance 1 is tensor(121.6544, device='cuda:1')
distance 2 is tensor(8.7184, device='cuda:1')
benign distance is  tensor(8.7184, device='cuda:1')
norm1 res is  tensor(0.1268, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.2404979169368744
distance 1 is tensor(135.1091, device='cuda:1')
distance 2 is tensor(9.6084, device='cuda:1')
benign distance is  tensor(9.6084, device='cuda:1')
norm1 res is  tensor(0.1456, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.26739734411239624
distance 1 is tensor(137.3007, device='cuda:1')
distance 2 is tensor(9.9265, device='cuda:1')
benign distance is  tensor(9.9265, device='cuda:1')
norm1 res is  tensor(0.1464, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.674177885055542
distance 1 is tensor(138.8458, device='cuda:1')
distance 2 is tensor(9.9440, device='cuda:1')
benign distance is  tensor(9.9440, device='cuda:1')
norm1 res is  tensor(0.1476, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.37510254979133606
distance 1 is tensor(126.1224, device='cuda:1')
distance 2 is tensor(9.0055, device='cuda:1')
benign distance is  tensor(9.0055, device='cuda:1')
norm1 res is  tensor(0.1345, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.6067586541175842
distance 1 is tensor(131.0546, device='cuda:1')
distance 2 is tensor(9.4545, device='cuda:1')
benign distance is  tensor(9.4545, device='cuda:1')
norm1 res is  tensor(0.1391, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.5946048498153687
distance 1 is tensor(135.6652, device='cuda:1')
distance 2 is tensor(9.8595, device='cuda:1')
benign distance is  tensor(9.8595, device='cuda:1')
norm1 res is  tensor(0.1467, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.025020908564329147
distance 1 is tensor(139.0882, device='cuda:1')
distance 2 is tensor(9.9775, device='cuda:1')
benign distance is  tensor(9.9775, device='cuda:1')
norm1 res is  tensor(0.1489, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.3776536285877228
distance 1 is tensor(125.3341, device='cuda:1')
distance 2 is tensor(9.1911, device='cuda:1')
benign distance is  tensor(9.1911, device='cuda:1')
norm1 res is  tensor(0.1362, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.5617133975028992
distance 1 is tensor(157.2762, device='cuda:1')
distance 2 is tensor(11.1964, device='cuda:1')
benign distance is  tensor(11.1964, device='cuda:1')
norm1 res is  tensor(0.1664, device='cuda:1')
current submit client idx and staleness is  24 4
 benign loss is  0.10848145186901093
distance 1 is tensor(164.0123, device='cuda:1')
distance 2 is tensor(11.8046, device='cuda:1')
benign distance is  tensor(11.8046, device='cuda:1')
norm1 res is  tensor(0.1795, device='cuda:1')
current submit client idx and staleness is  25 4
 benign loss is  0.4220272898674011
distance 1 is tensor(138.8895, device='cuda:1')
distance 2 is tensor(9.9235, device='cuda:1')
benign distance is  tensor(9.9235, device='cuda:1')
norm1 res is  tensor(0.1462, device='cuda:1')
current submit client idx and staleness is  26 4
 benign loss is  0.3621686100959778
distance 1 is tensor(167.4548, device='cuda:1')
distance 2 is tensor(11.9701, device='cuda:1')
benign distance is  tensor(11.9701, device='cuda:1')
norm1 res is  tensor(0.1767, device='cuda:1')
current submit client idx and staleness is  27 4
 benign loss is  1.0236479043960571
distance 1 is tensor(142.8926, device='cuda:1')
distance 2 is tensor(10.2208, device='cuda:1')
benign distance is  tensor(10.2208, device='cuda:1')
norm1 res is  tensor(0.1527, device='cuda:1')
current submit client idx and staleness is  28 4
 benign loss is  0.8846513032913208
distance 1 is tensor(135.9967, device='cuda:1')
distance 2 is tensor(9.8018, device='cuda:1')
benign distance is  tensor(9.8018, device='cuda:1')
norm1 res is  tensor(0.1449, device='cuda:1')
current submit client idx and staleness is  29 4
 benign loss is  0.6035434603691101
distance 1 is tensor(144.9084, device='cuda:1')
distance 2 is tensor(10.5247, device='cuda:1')
benign distance is  tensor(10.5247, device='cuda:1')
norm1 res is  tensor(0.1559, device='cuda:1')
current submit client idx and staleness is  30 4
 benign loss is  0.43210530281066895
distance 1 is tensor(145.9182, device='cuda:1')
distance 2 is tensor(10.6366, device='cuda:1')
benign distance is  tensor(10.6366, device='cuda:1')
norm1 res is  tensor(0.1590, device='cuda:1')
current submit client idx and staleness is  31 4
 benign loss is  0.9363554120063782
distance 1 is tensor(139.7940, device='cuda:1')
distance 2 is tensor(10.1342, device='cuda:1')
benign distance is  tensor(10.1342, device='cuda:1')
norm1 res is  tensor(0.1497, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(164.1644, device='cuda:1')
distance 2 is tensor(12.0947, device='cuda:1')
compute distance is  tensor(12.0947, device='cuda:1')
compute norm is  tensor(54.8780, device='cuda:1')
distance 1 is tensor(176.8035, device='cuda:1')
distance 2 is tensor(12.9595, device='cuda:1')
compute distance is  tensor(12.9595, device='cuda:1')
compute norm is  tensor(55.0983, device='cuda:1')
distance 1 is tensor(180.4722, device='cuda:1')
distance 2 is tensor(13.2654, device='cuda:1')
compute distance is  tensor(13.2654, device='cuda:1')
compute norm is  tensor(55.3061, device='cuda:1')
distance 1 is tensor(167.9161, device='cuda:1')
distance 2 is tensor(12.3835, device='cuda:1')
compute distance is  tensor(12.3835, device='cuda:1')
compute norm is  tensor(55.0065, device='cuda:1')
distance 1 is tensor(181.7305, device='cuda:1')
distance 2 is tensor(13.1864, device='cuda:1')
compute distance is  tensor(13.1864, device='cuda:1')
compute norm is  tensor(55.2900, device='cuda:1')
distance 1 is tensor(193.2199, device='cuda:1')
distance 2 is tensor(13.9846, device='cuda:1')
compute distance is  tensor(13.9846, device='cuda:1')
compute norm is  tensor(55.7479, device='cuda:1')
distance 1 is tensor(174.0857, device='cuda:1')
distance 2 is tensor(12.7290, device='cuda:1')
compute distance is  tensor(12.7290, device='cuda:1')
compute norm is  tensor(55.2674, device='cuda:1')
distance 1 is tensor(171.3746, device='cuda:1')
distance 2 is tensor(12.4701, device='cuda:1')
compute distance is  tensor(12.4701, device='cuda:1')
compute norm is  tensor(55.0596, device='cuda:1')
distance 1 is tensor(172.0901, device='cuda:1')
distance 2 is tensor(12.4669, device='cuda:1')
compute distance is  tensor(12.4669, device='cuda:1')
compute norm is  tensor(55.2123, device='cuda:1')
distance 1 is tensor(174.3441, device='cuda:1')
distance 2 is tensor(12.6731, device='cuda:1')
compute distance is  tensor(12.6731, device='cuda:1')
compute norm is  tensor(55.1473, device='cuda:1')
distance 1 is tensor(172.1190, device='cuda:1')
distance 2 is tensor(12.4203, device='cuda:1')
compute distance is  tensor(12.4203, device='cuda:1')
compute norm is  tensor(55.0914, device='cuda:1')
distance 1 is tensor(160.1258, device='cuda:1')
distance 2 is tensor(11.8148, device='cuda:1')
compute distance is  tensor(11.8148, device='cuda:1')
compute norm is  tensor(54.9559, device='cuda:1')
distance Threshold  is  tensor(13.9846, device='cuda:1')
distance 1 is tensor(1017900.1250, device='cuda:1')
distance 2 is tensor(74724.2578, device='cuda:1')
________________________________
test distance is  tensor(74724.2578, device='cuda:1')
test similarity is  tensor(-0.0710, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.537701008153153e+17
test entropy is  0.0
________________________________
cal ratio is  0.012312247570049272
distance 1 is tensor(12532.6445, device='cuda:1')
distance 2 is tensor(920.0235, device='cuda:1')
cal_distance is  tensor(920.0235, device='cuda:1')
cal ratio is  0.11096057135647729
distance 1 is tensor(1390.6349, device='cuda:1')
distance 2 is tensor(102.0863, device='cuda:1')
cal_distance is  tensor(102.0863, device='cuda:1')
cal ratio is  0.33310744352937993
distance 1 is tensor(463.2350, device='cuda:1')
distance 2 is tensor(34.0057, device='cuda:1')
cal_distance is  tensor(34.0057, device='cuda:1')
cal ratio is  0.5771546161146612
distance 1 is tensor(267.3609, device='cuda:1')
distance 2 is tensor(19.6266, device='cuda:1')
cal_distance is  tensor(19.6266, device='cuda:1')
cal ratio is  0.759706901497127
distance 1 is tensor(203.1174, device='cuda:1')
distance 2 is tensor(14.9104, device='cuda:1')
cal_distance is  tensor(14.9104, device='cuda:1')
cal ratio is  0.8716116538263073
distance 1 is tensor(177.0404, device='cuda:1')
distance 2 is tensor(12.9961, device='cuda:1')
cal_distance is  tensor(12.9961, device='cuda:1')
distance 1 is tensor(177.0404, device='cuda:1')
distance 2 is tensor(12.9961, device='cuda:1')
________________________________
test distance is  tensor(12.9961, device='cuda:1')
test similarity is  tensor(0.9330, device='cuda:1')
test acc is  0.6833000001563317
test loss is 190.40482872025544
test entropy is  0.00288780386965103
________________________________
distance 1 is tensor(177.0404, device='cuda:1')
distance 2 is tensor(12.9961, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0027736363926645718
avg test loss is  190.57729233861733
avg accuracy is  0.6787333334896654
solo acc is  0.1192166668229986
compute similarity  is  tensor(0.9330, device='cuda:1')
compute_distance is  tensor(12.9961, device='cuda:1')
compute_norm is  tensor(53.3788, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(161.0587, device='cuda:1')
distance 2 is tensor(13.9839, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9871503644660592
avg test loss is  1.5804239601722911
avg accuracy is  0.7959666668229923
solo acc is  0.29353333348967275
compute similarity  is  tensor(0.9363, device='cuda:1')
compute_distance is  tensor(13.9839, device='cuda:1')
compute_norm is  tensor(52.5792, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(161.0587, device='cuda:1')
distance 2 is tensor(13.9839, device='cuda:1')
________________________________
test distance is  tensor(13.9839, device='cuda:1')
test similarity is  tensor(0.9363, device='cuda:1')
test acc is  0.7937500001563258
test loss is 1.576258746037351
test entropy is  0.9875503783541193
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.26266348361969
mal norm is  tensor(8.6195, device='cuda:1')
distance 1 is tensor(161.0587, device='cuda:1')
distance 2 is tensor(13.9839, device='cuda:1')
mal distance is  tensor(13.9839, device='cuda:1')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1636, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(456.4625, device='cuda:1')
c is  tensor(0.0189, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.0046e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.5555, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(495.6936, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(508.2462, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.1500, device='cuda:1')
c is  tensor(0.0180, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.9930, device='cuda:1')
c is  tensor(0.0162, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.0271e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.5251, device='cuda:1')
c is  tensor(0.0180, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.9346, device='cuda:1')
c is  tensor(0.0169, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9464, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.1573, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.6232, device='cuda:1')
c is  tensor(0.0159, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.6441, device='cuda:1')
c is  tensor(0.0161, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.6506, device='cuda:1')
c is  tensor(0.0163, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0239e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.4314, device='cuda:1')
c is  tensor(0.0158, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.9153, device='cuda:1')
c is  tensor(0.0157, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.4979, device='cuda:1')
c is  tensor(0.0159, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3219e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.9638, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
len accept list 20
len all weights is 20
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 85.53% 

Test Accuracy: 83.85% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
 benign loss is  0.27744871377944946
distance 1 is tensor(224.5187, device='cuda:1')
distance 2 is tensor(16.6330, device='cuda:1')
benign distance is  tensor(16.6330, device='cuda:1')
norm1 res is  tensor(0.2310, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.6640514135360718
distance 1 is tensor(216.8961, device='cuda:1')
distance 2 is tensor(15.7929, device='cuda:1')
benign distance is  tensor(15.7929, device='cuda:1')
norm1 res is  tensor(0.2158, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.25180375576019287
distance 1 is tensor(226.5406, device='cuda:1')
distance 2 is tensor(16.6331, device='cuda:1')
benign distance is  tensor(16.6331, device='cuda:1')
norm1 res is  tensor(0.2267, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.9890381097793579
distance 1 is tensor(220.4695, device='cuda:1')
distance 2 is tensor(16.0001, device='cuda:1')
benign distance is  tensor(16.0001, device='cuda:1')
norm1 res is  tensor(0.2208, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  1.6943986415863037
distance 1 is tensor(239.1361, device='cuda:1')
distance 2 is tensor(17.3977, device='cuda:1')
benign distance is  tensor(17.3977, device='cuda:1')
norm1 res is  tensor(0.2383, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  1.9851834774017334
distance 1 is tensor(212.4716, device='cuda:1')
distance 2 is tensor(15.5143, device='cuda:1')
benign distance is  tensor(15.5143, device='cuda:1')
norm1 res is  tensor(0.2165, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.6490224003791809
distance 1 is tensor(221.0949, device='cuda:1')
distance 2 is tensor(15.9218, device='cuda:1')
benign distance is  tensor(15.9218, device='cuda:1')
norm1 res is  tensor(0.2187, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.656328558921814
distance 1 is tensor(220.0683, device='cuda:1')
distance 2 is tensor(16.2000, device='cuda:1')
benign distance is  tensor(16.2000, device='cuda:1')
norm1 res is  tensor(0.2244, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.37334030866622925
distance 1 is tensor(219.4965, device='cuda:1')
distance 2 is tensor(16.0360, device='cuda:1')
benign distance is  tensor(16.0360, device='cuda:1')
norm1 res is  tensor(0.2184, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.9617164731025696
distance 1 is tensor(232.0679, device='cuda:1')
distance 2 is tensor(16.7291, device='cuda:1')
benign distance is  tensor(16.7291, device='cuda:1')
norm1 res is  tensor(0.2268, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.6391463279724121
distance 1 is tensor(197.4688, device='cuda:1')
distance 2 is tensor(14.5233, device='cuda:1')
benign distance is  tensor(14.5233, device='cuda:1')
norm1 res is  tensor(0.1964, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.29359644651412964
distance 1 is tensor(227.8173, device='cuda:1')
distance 2 is tensor(16.8228, device='cuda:1')
benign distance is  tensor(16.8228, device='cuda:1')
norm1 res is  tensor(0.2322, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.408499538898468
distance 1 is tensor(219.0638, device='cuda:1')
distance 2 is tensor(15.7684, device='cuda:1')
benign distance is  tensor(15.7684, device='cuda:1')
norm1 res is  tensor(0.2174, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  0.9980424642562866
distance 1 is tensor(198.3943, device='cuda:1')
distance 2 is tensor(14.4694, device='cuda:1')
benign distance is  tensor(14.4694, device='cuda:1')
norm1 res is  tensor(0.1959, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.47649312019348145
distance 1 is tensor(201.2275, device='cuda:1')
distance 2 is tensor(14.7679, device='cuda:1')
benign distance is  tensor(14.7679, device='cuda:1')
norm1 res is  tensor(0.1983, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  0.6647175550460815
distance 1 is tensor(194.7626, device='cuda:1')
distance 2 is tensor(14.5239, device='cuda:1')
benign distance is  tensor(14.5239, device='cuda:1')
norm1 res is  tensor(0.1968, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(174.8589, device='cuda:1')
distance 2 is tensor(13.3730, device='cuda:1')
compute distance is  tensor(13.3730, device='cuda:1')
compute norm is  tensor(54.2199, device='cuda:1')
distance 1 is tensor(192.0077, device='cuda:1')
distance 2 is tensor(14.6234, device='cuda:1')
compute distance is  tensor(14.6234, device='cuda:1')
compute norm is  tensor(54.4866, device='cuda:1')
distance 1 is tensor(200.9167, device='cuda:1')
distance 2 is tensor(15.2681, device='cuda:1')
compute distance is  tensor(15.2681, device='cuda:1')
compute norm is  tensor(54.6376, device='cuda:1')
distance 1 is tensor(193.5981, device='cuda:1')
distance 2 is tensor(14.7249, device='cuda:1')
compute distance is  tensor(14.7249, device='cuda:1')
compute norm is  tensor(54.6735, device='cuda:1')
distance 1 is tensor(184.2997, device='cuda:1')
distance 2 is tensor(14.1184, device='cuda:1')
compute distance is  tensor(14.1184, device='cuda:1')
compute norm is  tensor(54.4340, device='cuda:1')
distance 1 is tensor(213.0361, device='cuda:1')
distance 2 is tensor(15.9259, device='cuda:1')
compute distance is  tensor(15.9259, device='cuda:1')
compute norm is  tensor(55.1711, device='cuda:1')
distance 1 is tensor(189.4586, device='cuda:1')
distance 2 is tensor(14.4318, device='cuda:1')
compute distance is  tensor(14.4318, device='cuda:1')
compute norm is  tensor(54.6144, device='cuda:1')
distance 1 is tensor(181.9459, device='cuda:1')
distance 2 is tensor(14.0055, device='cuda:1')
compute distance is  tensor(14.0055, device='cuda:1')
compute norm is  tensor(54.4238, device='cuda:1')
distance 1 is tensor(183.1545, device='cuda:1')
distance 2 is tensor(14.1048, device='cuda:1')
compute distance is  tensor(14.1048, device='cuda:1')
compute norm is  tensor(54.5424, device='cuda:1')
distance 1 is tensor(183.6278, device='cuda:1')
distance 2 is tensor(14.0519, device='cuda:1')
compute distance is  tensor(14.0519, device='cuda:1')
compute norm is  tensor(54.3918, device='cuda:1')
distance 1 is tensor(190.6837, device='cuda:1')
distance 2 is tensor(14.5281, device='cuda:1')
compute distance is  tensor(14.5281, device='cuda:1')
compute norm is  tensor(54.6779, device='cuda:1')
distance 1 is tensor(170.0561, device='cuda:1')
distance 2 is tensor(13.2318, device='cuda:1')
compute distance is  tensor(13.2318, device='cuda:1')
compute norm is  tensor(54.1867, device='cuda:1')
distance Threshold  is  tensor(15.9259, device='cuda:1')
distance 1 is tensor(1017843.0625, device='cuda:1')
distance 2 is tensor(74719.4609, device='cuda:1')
________________________________
test distance is  tensor(74719.4609, device='cuda:1')
test similarity is  tensor(0.0844, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.535679599469677e+17
test entropy is  0.0
________________________________
cal ratio is  0.013139458331196853
distance 1 is tensor(13373.9111, device='cuda:1')
distance 2 is tensor(981.7733, device='cuda:1')
cal_distance is  tensor(981.7733, device='cuda:1')
cal ratio is  0.11462747489437225
distance 1 is tensor(1533.0232, device='cuda:1')
distance 2 is tensor(112.5382, device='cuda:1')
cal_distance is  tensor(112.5382, device='cuda:1')
cal ratio is  0.33856679876893053
distance 1 is tensor(519.0350, device='cuda:1')
distance 2 is tensor(38.1017, device='cuda:1')
cal_distance is  tensor(38.1017, device='cuda:1')
cal ratio is  0.5818649376963088
distance 1 is tensor(302.0109, device='cuda:1')
distance 2 is tensor(22.1700, device='cuda:1')
cal_distance is  tensor(22.1700, device='cuda:1')
cal ratio is  0.7628006596410117
distance 1 is tensor(230.3756, device='cuda:1')
distance 2 is tensor(16.9113, device='cuda:1')
cal_distance is  tensor(16.9113, device='cuda:1')
cal ratio is  0.8733846453948528
distance 1 is tensor(201.2073, device='cuda:1')
distance 2 is tensor(14.7701, device='cuda:1')
cal_distance is  tensor(14.7701, device='cuda:1')
distance 1 is tensor(201.2073, device='cuda:1')
distance 2 is tensor(14.7701, device='cuda:1')
________________________________
test distance is  tensor(14.7701, device='cuda:1')
test similarity is  tensor(0.9247, device='cuda:1')
test acc is  0.21468333348967034
test loss is 372.22109718566765
test entropy is  4.62832352009682e-05
________________________________
distance 1 is tensor(201.2073, device='cuda:1')
distance 2 is tensor(14.7701, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  5.459676113117064e-05
avg test loss is  372.4617623205124
avg accuracy is  0.21433333348967035
solo acc is  0.10015000015633198
compute similarity  is  tensor(0.9247, device='cuda:1')
compute_distance is  tensor(14.7701, device='cuda:1')
compute_norm is  tensor(55.7366, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(183.9591, device='cuda:1')
distance 2 is tensor(15.8543, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.068746044246881
avg test loss is  1.683874737479285
avg accuracy is  0.5311500001563423
solo acc is  0.2584500001563385
compute similarity  is  tensor(0.9287, device='cuda:1')
compute_distance is  tensor(15.8543, device='cuda:1')
compute_norm is  tensor(55.5589, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(184.6032, device='cuda:1')
distance 2 is tensor(16.0848, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6556474470507616
avg test loss is  2.6046463144359304
avg accuracy is  0.3788500001563408
solo acc is  0.11386666682299862
compute similarity  is  tensor(0.9283, device='cuda:1')
compute_distance is  tensor(16.0848, device='cuda:1')
compute_norm is  tensor(55.3826, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(185.4595, device='cuda:1')
distance 2 is tensor(16.0824, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.003651621435751
avg test loss is  1.6010119809524845
avg accuracy is  0.540516666823009
solo acc is  0.25955000015633867
compute similarity  is  tensor(0.9282, device='cuda:1')
compute_distance is  tensor(16.0824, device='cuda:1')
compute_norm is  tensor(54.9833, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(186.2401, device='cuda:1')
distance 2 is tensor(16.2772, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6283429290757758
avg test loss is  2.467768915553591
avg accuracy is  0.3879833334896743
solo acc is  0.11326666682299862
compute similarity  is  tensor(0.9279, device='cuda:1')
compute_distance is  tensor(16.2772, device='cuda:1')
compute_norm is  tensor(54.8001, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(187.0561, device='cuda:1')
distance 2 is tensor(16.2360, device='cuda:1')
________________________________
test distance is  tensor(16.2360, device='cuda:1')
test similarity is  tensor(0.9278, device='cuda:1')
test acc is  0.5530500001563416
test loss is 1.537882473677206
test entropy is  0.9915294471198816
________________________________
cal ratio is  0.8913639907782935
distance 1 is tensor(166.7357, device='cuda:1')
distance 2 is tensor(14.4722, device='cuda:1')
cal_distance is  tensor(14.4722, device='cuda:1')
distance 1 is tensor(166.7357, device='cuda:1')
distance 2 is tensor(14.4722, device='cuda:1')
________________________________
test distance is  tensor(14.4722, device='cuda:1')
test similarity is  tensor(0.9413, device='cuda:1')
test acc is  0.5875166668230053
test loss is 1.4302801102209193
test entropy is  1.0675722196666417
________________________________
distance 1 is tensor(166.7357, device='cuda:1')
distance 2 is tensor(14.4722, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.067841981646857
avg test loss is  1.4293410076515507
avg accuracy is  0.5865166668230054
solo acc is  0.30006666682300615
compute similarity  is  tensor(0.9413, device='cuda:1')
compute_distance is  tensor(14.4722, device='cuda:1')
compute_norm is  tensor(53.8702, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(167.9935, device='cuda:1')
distance 2 is tensor(14.7328, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6179700990094305
avg test loss is  2.398133417309474
avg accuracy is  0.42483333348967467
solo acc is  0.11218333348966529
compute similarity  is  tensor(0.9408, device='cuda:1')
compute_distance is  tensor(14.7328, device='cuda:1')
compute_norm is  tensor(53.6984, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(169.4159, device='cuda:1')
distance 2 is tensor(14.7519, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9599004439326492
avg test loss is  1.4884002969971597
avg accuracy is  0.5834666668230056
solo acc is  0.26613333348967205
compute similarity  is  tensor(0.9407, device='cuda:1')
compute_distance is  tensor(14.7519, device='cuda:1')
compute_norm is  tensor(53.3283, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(169.4159, device='cuda:1')
distance 2 is tensor(14.7519, device='cuda:1')
________________________________
test distance is  tensor(14.7519, device='cuda:1')
test similarity is  tensor(0.9407, device='cuda:1')
test acc is  0.5804000001563391
test loss is 1.4896575470468891
test entropy is  0.959394241065613
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.124708652496338
mal norm is  tensor(8.5386, device='cuda:1')
distance 1 is tensor(169.4159, device='cuda:1')
distance 2 is tensor(14.7519, device='cuda:1')
mal distance is  tensor(14.7519, device='cuda:1')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2628, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(919.9100, device='cuda:1')
c is  tensor(0.0169, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(858.7834, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(902.3856, device='cuda:1')
c is  tensor(0.0171, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(867.7357, device='cuda:1')
c is  tensor(0.0174, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(948.5038, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(856.0036, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(868.0748, device='cuda:1')
c is  tensor(0.0174, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(895.5615, device='cuda:1')
c is  tensor(0.0171, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8591, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(833.5840, device='cuda:1')
c is  tensor(0.0178, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(890.7017, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(852.3757, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(855.0854, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.1398, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6852, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.8469, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(820.3059, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.3668, device='cuda:1')
c is  tensor(0.0191, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.8890, device='cuda:1')
c is  tensor(0.0190, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.5971, device='cuda:1')
c is  tensor(0.0198, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.0891, device='cuda:1')
c is  tensor(0.0194, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.7632, device='cuda:1')
c is  tensor(0.0191, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.2269, device='cuda:1')
c is  tensor(0.0190, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3082, device='cuda:1')
c is  tensor(0.0195, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(784.3065, device='cuda:1')
c is  tensor(0.0183, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:1')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 92.40% 

Test Accuracy: 89.75% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
 benign loss is  0.01430797390639782
distance 1 is tensor(126.4901, device='cuda:1')
distance 2 is tensor(9.2343, device='cuda:1')
benign distance is  tensor(9.2343, device='cuda:1')
norm1 res is  tensor(0.1388, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  1.3824541568756104
distance 1 is tensor(126.6846, device='cuda:1')
distance 2 is tensor(9.1065, device='cuda:1')
benign distance is  tensor(9.1065, device='cuda:1')
norm1 res is  tensor(0.1343, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.2792116105556488
distance 1 is tensor(137.9607, device='cuda:1')
distance 2 is tensor(9.9805, device='cuda:1')
benign distance is  tensor(9.9805, device='cuda:1')
norm1 res is  tensor(0.1488, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.8596380352973938
distance 1 is tensor(142.2705, device='cuda:1')
distance 2 is tensor(10.2047, device='cuda:1')
benign distance is  tensor(10.2047, device='cuda:1')
norm1 res is  tensor(0.1502, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.9744762182235718
distance 1 is tensor(166.2535, device='cuda:1')
distance 2 is tensor(11.8355, device='cuda:1')
benign distance is  tensor(11.8355, device='cuda:1')
norm1 res is  tensor(0.1746, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.7312678098678589
distance 1 is tensor(139.4328, device='cuda:1')
distance 2 is tensor(10.0476, device='cuda:1')
benign distance is  tensor(10.0476, device='cuda:1')
norm1 res is  tensor(0.1466, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.12323892116546631
distance 1 is tensor(146.7685, device='cuda:1')
distance 2 is tensor(10.5094, device='cuda:1')
benign distance is  tensor(10.5094, device='cuda:1')
norm1 res is  tensor(0.1564, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.1939234435558319
distance 1 is tensor(132.2425, device='cuda:1')
distance 2 is tensor(9.4905, device='cuda:1')
benign distance is  tensor(9.4905, device='cuda:1')
norm1 res is  tensor(0.1397, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  1.0074065923690796
distance 1 is tensor(150.2787, device='cuda:1')
distance 2 is tensor(10.8256, device='cuda:1')
benign distance is  tensor(10.8256, device='cuda:1')
norm1 res is  tensor(0.1599, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.6363018751144409
distance 1 is tensor(143.9434, device='cuda:1')
distance 2 is tensor(10.1944, device='cuda:1')
benign distance is  tensor(10.1944, device='cuda:1')
norm1 res is  tensor(0.1506, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.6189979314804077
distance 1 is tensor(136.2995, device='cuda:1')
distance 2 is tensor(9.9116, device='cuda:1')
benign distance is  tensor(9.9116, device='cuda:1')
norm1 res is  tensor(0.1456, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.9582648277282715
distance 1 is tensor(150.4557, device='cuda:1')
distance 2 is tensor(10.8963, device='cuda:1')
benign distance is  tensor(10.8963, device='cuda:1')
norm1 res is  tensor(0.1602, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.6254185438156128
distance 1 is tensor(140.9113, device='cuda:1')
distance 2 is tensor(10.3039, device='cuda:1')
benign distance is  tensor(10.3039, device='cuda:1')
norm1 res is  tensor(0.1556, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.6110438108444214
distance 1 is tensor(138.3318, device='cuda:1')
distance 2 is tensor(9.9998, device='cuda:1')
benign distance is  tensor(9.9998, device='cuda:1')
norm1 res is  tensor(0.1468, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.6872295141220093
distance 1 is tensor(140.4873, device='cuda:1')
distance 2 is tensor(10.1856, device='cuda:1')
benign distance is  tensor(10.1856, device='cuda:1')
norm1 res is  tensor(0.1520, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.4657721519470215
distance 1 is tensor(151.3749, device='cuda:1')
distance 2 is tensor(10.6627, device='cuda:1')
benign distance is  tensor(10.6627, device='cuda:1')
norm1 res is  tensor(0.1554, device='cuda:1')
current submit client idx and staleness is  32 5
 benign loss is  0.3014516234397888
distance 1 is tensor(151.5748, device='cuda:1')
distance 2 is tensor(10.7793, device='cuda:1')
benign distance is  tensor(10.7793, device='cuda:1')
norm1 res is  tensor(0.1597, device='cuda:1')
current submit client idx and staleness is  33 5
 benign loss is  0.13999681174755096
distance 1 is tensor(157.0407, device='cuda:1')
distance 2 is tensor(11.2539, device='cuda:1')
benign distance is  tensor(11.2539, device='cuda:1')
norm1 res is  tensor(0.1636, device='cuda:1')
current submit client idx and staleness is  34 5
 benign loss is  0.834879994392395
distance 1 is tensor(163.7561, device='cuda:1')
distance 2 is tensor(11.8538, device='cuda:1')
benign distance is  tensor(11.8538, device='cuda:1')
norm1 res is  tensor(0.1726, device='cuda:1')
current submit client idx and staleness is  35 5
 benign loss is  0.1377149522304535
distance 1 is tensor(153.7343, device='cuda:1')
distance 2 is tensor(11.0792, device='cuda:1')
benign distance is  tensor(11.0792, device='cuda:1')
norm1 res is  tensor(0.1632, device='cuda:1')
current submit client idx and staleness is  36 5
 benign loss is  0.27919214963912964
distance 1 is tensor(157.1097, device='cuda:1')
distance 2 is tensor(11.1649, device='cuda:1')
benign distance is  tensor(11.1649, device='cuda:1')
norm1 res is  tensor(0.1645, device='cuda:1')
current submit client idx and staleness is  37 5
 benign loss is  0.805106520652771
distance 1 is tensor(135.6228, device='cuda:1')
distance 2 is tensor(9.7890, device='cuda:1')
benign distance is  tensor(9.7890, device='cuda:1')
norm1 res is  tensor(0.1433, device='cuda:1')
current submit client idx and staleness is  38 5
 benign loss is  0.5458126664161682
distance 1 is tensor(163.4332, device='cuda:1')
distance 2 is tensor(11.8903, device='cuda:1')
benign distance is  tensor(11.8903, device='cuda:1')
norm1 res is  tensor(0.1740, device='cuda:1')
current submit client idx and staleness is  39 5
 benign loss is  0.5746863484382629
distance 1 is tensor(153.8897, device='cuda:1')
distance 2 is tensor(10.9571, device='cuda:1')
benign distance is  tensor(10.9571, device='cuda:1')
norm1 res is  tensor(0.1583, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(157.5720, device='cuda:1')
distance 2 is tensor(11.7632, device='cuda:1')
compute distance is  tensor(11.7632, device='cuda:1')
compute norm is  tensor(54.5681, device='cuda:1')
distance 1 is tensor(167.3570, device='cuda:1')
distance 2 is tensor(12.4664, device='cuda:1')
compute distance is  tensor(12.4664, device='cuda:1')
compute norm is  tensor(54.7653, device='cuda:1')
distance 1 is tensor(176.0650, device='cuda:1')
distance 2 is tensor(13.1774, device='cuda:1')
compute distance is  tensor(13.1774, device='cuda:1')
compute norm is  tensor(54.9764, device='cuda:1')
distance 1 is tensor(170.7212, device='cuda:1')
distance 2 is tensor(12.5826, device='cuda:1')
compute distance is  tensor(12.5826, device='cuda:1')
compute norm is  tensor(54.8257, device='cuda:1')
distance 1 is tensor(168.1549, device='cuda:1')
distance 2 is tensor(12.6170, device='cuda:1')
compute distance is  tensor(12.6170, device='cuda:1')
compute norm is  tensor(54.8054, device='cuda:1')
distance 1 is tensor(169.9979, device='cuda:1')
distance 2 is tensor(12.6406, device='cuda:1')
compute distance is  tensor(12.6406, device='cuda:1')
compute norm is  tensor(54.9781, device='cuda:1')
distance 1 is tensor(170.0788, device='cuda:1')
distance 2 is tensor(12.7858, device='cuda:1')
compute distance is  tensor(12.7858, device='cuda:1')
compute norm is  tensor(55.0242, device='cuda:1')
distance 1 is tensor(172.9980, device='cuda:1')
distance 2 is tensor(12.8781, device='cuda:1')
compute distance is  tensor(12.8781, device='cuda:1')
compute norm is  tensor(54.9720, device='cuda:1')
distance 1 is tensor(153.8295, device='cuda:1')
distance 2 is tensor(11.4958, device='cuda:1')
compute distance is  tensor(11.4958, device='cuda:1')
compute norm is  tensor(54.6140, device='cuda:1')
distance 1 is tensor(157.6506, device='cuda:1')
distance 2 is tensor(11.8664, device='cuda:1')
compute distance is  tensor(11.8664, device='cuda:1')
compute norm is  tensor(54.7606, device='cuda:1')
distance 1 is tensor(161.0607, device='cuda:1')
distance 2 is tensor(11.9278, device='cuda:1')
compute distance is  tensor(11.9278, device='cuda:1')
compute norm is  tensor(54.7506, device='cuda:1')
distance 1 is tensor(156.0265, device='cuda:1')
distance 2 is tensor(11.7296, device='cuda:1')
compute distance is  tensor(11.7296, device='cuda:1')
compute norm is  tensor(54.6592, device='cuda:1')
distance Threshold  is  tensor(13.1774, device='cuda:1')
distance 1 is tensor(1017891.4375, device='cuda:1')
distance 2 is tensor(74723.6250, device='cuda:1')
________________________________
test distance is  tensor(74723.6250, device='cuda:1')
test similarity is  tensor(-0.0359, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.541542963178356e+17
test entropy is  0.0
________________________________
cal ratio is  0.0119516824564461
distance 1 is tensor(12165.5225, device='cuda:1')
distance 2 is tensor(893.0730, device='cuda:1')
cal_distance is  tensor(893.0730, device='cuda:1')
cal ratio is  0.10932375341707493
distance 1 is tensor(1329.9861, device='cuda:1')
distance 2 is tensor(97.6341, device='cuda:1')
cal_distance is  tensor(97.6341, device='cuda:1')
cal ratio is  0.3306414254512664
distance 1 is tensor(439.7527, device='cuda:1')
distance 2 is tensor(32.2819, device='cuda:1')
cal_distance is  tensor(32.2819, device='cuda:1')
cal ratio is  0.5750143176348708
distance 1 is tensor(252.8667, device='cuda:1')
distance 2 is tensor(18.5625, device='cuda:1')
cal_distance is  tensor(18.5625, device='cuda:1')
cal ratio is  0.7582969642832944
distance 1 is tensor(191.7496, device='cuda:1')
distance 2 is tensor(14.0759, device='cuda:1')
cal_distance is  tensor(14.0759, device='cuda:1')
cal ratio is  0.8708024811564999
distance 1 is tensor(166.9768, device='cuda:1')
distance 2 is tensor(12.2573, device='cuda:1')
cal_distance is  tensor(12.2573, device='cuda:1')
distance 1 is tensor(166.9768, device='cuda:1')
distance 2 is tensor(12.2573, device='cuda:1')
________________________________
test distance is  tensor(12.2573, device='cuda:1')
test similarity is  tensor(0.9416, device='cuda:1')
test acc is  0.7433500001563282
test loss is 124.6071384649541
test entropy is  0.007728938786049541
________________________________
distance 1 is tensor(166.9768, device='cuda:1')
distance 2 is tensor(12.2573, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.007442302000076019
avg test loss is  124.20250770227233
avg accuracy is  0.7426500001563283
solo acc is  0.15108333348966663
compute similarity  is  tensor(0.9416, device='cuda:1')
compute_distance is  tensor(12.2573, device='cuda:1')
compute_norm is  tensor(53.7968, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(154.8366, device='cuda:1')
distance 2 is tensor(13.4547, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9999209689433133
avg test loss is  1.5799483331535924
avg accuracy is  0.7998666668229921
solo acc is  0.29518333348967274
compute similarity  is  tensor(0.9433, device='cuda:1')
compute_distance is  tensor(13.4547, device='cuda:1')
compute_norm is  tensor(52.9841, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(154.8366, device='cuda:1')
distance 2 is tensor(13.4547, device='cuda:1')
________________________________
test distance is  tensor(13.4547, device='cuda:1')
test similarity is  tensor(0.9433, device='cuda:1')
test acc is  0.7984500001563255
test loss is 1.5777479773645462
test entropy is  0.9981113541355011
________________________________
cal ratio is  0.8906783640082923
distance 1 is tensor(137.9102, device='cuda:1')
distance 2 is tensor(11.9838, device='cuda:1')
cal_distance is  tensor(11.9838, device='cuda:1')
distance 1 is tensor(137.9102, device='cuda:1')
distance 2 is tensor(11.9838, device='cuda:1')
________________________________
test distance is  tensor(11.9838, device='cuda:1')
test similarity is  tensor(0.9545, device='cuda:1')
test acc is  0.8209833334896578
test loss is 1.2656181447668624
test entropy is  1.0773797475579958
________________________________
distance 1 is tensor(137.9102, device='cuda:1')
distance 2 is tensor(11.9838, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0767885722331147
avg test loss is  1.266870551970976
avg accuracy is  0.8210000001563245
solo acc is  0.454683333489675
compute similarity  is  tensor(0.9545, device='cuda:1')
compute_distance is  tensor(11.9838, device='cuda:1')
compute_norm is  tensor(52.7020, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.2241, device='cuda:1')
distance 2 is tensor(12.3808, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.941935730260064
avg test loss is  1.6351235672863307
avg accuracy is  0.8065333334896585
solo acc is  0.2481500001563382
compute similarity  is  tensor(0.9540, device='cuda:1')
compute_distance is  tensor(12.3808, device='cuda:1')
compute_norm is  tensor(52.3932, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.8106, device='cuda:1')
distance 2 is tensor(12.5927, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9152287995256086
avg test loss is  1.5951662537639837
avg accuracy is  0.8084666668229917
solo acc is  0.2481000001563382
compute similarity  is  tensor(0.9537, device='cuda:1')
compute_distance is  tensor(12.5927, device='cuda:1')
compute_norm is  tensor(52.1063, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.3612, device='cuda:1')
distance 2 is tensor(12.7691, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9096686059096729
avg test loss is  1.5678361557694132
avg accuracy is  0.807900000156325
solo acc is  0.24575000015633808
compute similarity  is  tensor(0.9535, device='cuda:1')
compute_distance is  tensor(12.7691, device='cuda:1')
compute_norm is  tensor(51.8240, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.8952, device='cuda:1')
distance 2 is tensor(12.9214, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.9075911735802062
avg test loss is  1.5396533168709354
avg accuracy is  0.810500000156325
solo acc is  0.242250000156338
compute similarity  is  tensor(0.9533, device='cuda:1')
compute_distance is  tensor(12.9214, device='cuda:1')
compute_norm is  tensor(51.5511, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.4284, device='cuda:1')
distance 2 is tensor(13.0578, device='cuda:1')
________________________________
test distance is  tensor(13.0578, device='cuda:1')
test similarity is  tensor(0.9532, device='cuda:1')
test acc is  0.8127166668229915
test loss is 1.5243081905440228
test entropy is  0.8870234966659343
________________________________
distance 1 is tensor(146.4284, device='cuda:1')
distance 2 is tensor(13.0578, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.88547249770622
avg test loss is  1.5254575386484548
avg accuracy is  0.8125666668229916
solo acc is  0.2419833334896713
compute similarity  is  tensor(0.9532, device='cuda:1')
compute_distance is  tensor(13.0578, device='cuda:1')
compute_norm is  tensor(51.2836, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.0307, device='cuda:1')
distance 2 is tensor(13.1914, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8877375216118054
avg test loss is  1.4880861204061935
avg accuracy is  0.8139333334896581
solo acc is  0.24881666682300488
compute similarity  is  tensor(0.9530, device='cuda:1')
compute_distance is  tensor(13.1914, device='cuda:1')
compute_norm is  tensor(51.0181, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.6298, device='cuda:1')
distance 2 is tensor(13.3217, device='cuda:1')
exit early
distance 1 is tensor(149.6298, device='cuda:1')
distance 2 is tensor(13.3217, device='cuda:1')
________________________________
test distance is  tensor(13.3217, device='cuda:1')
test similarity is  tensor(0.9528, device='cuda:1')
test acc is  0.8146500001563248
test loss is 1.4902809088164046
test entropy is  0.8769024888843869
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.1489638090133667
mal norm is  tensor(7.2963, device='cuda:1')
distance 1 is tensor(149.6298, device='cuda:1')
distance 2 is tensor(13.3217, device='cuda:1')
mal distance is  tensor(13.3217, device='cuda:1')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.2335, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.7087, device='cuda:1')
c is  tensor(0.0207, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.8138, device='cuda:1')
c is  tensor(0.0209, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.7979, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.3627, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0012, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.4100, device='cuda:1')
c is  tensor(0.0184, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.4534, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.1354, device='cuda:1')
c is  tensor(0.0195, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.2518, device='cuda:1')
c is  tensor(0.0206, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.6290, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
len accept list 15
len all weights is 15
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 81.35% 

Test Accuracy: 80.25% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4687444567680359
distance 1 is tensor(198.7312, device='cuda:1')
distance 2 is tensor(14.6801, device='cuda:1')
benign distance is  tensor(14.6801, device='cuda:1')
norm1 res is  tensor(0.1976, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.18442438542842865
distance 1 is tensor(216.2186, device='cuda:1')
distance 2 is tensor(15.9769, device='cuda:1')
benign distance is  tensor(15.9769, device='cuda:1')
norm1 res is  tensor(0.2143, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.3365967571735382
distance 1 is tensor(212.6218, device='cuda:1')
distance 2 is tensor(15.7285, device='cuda:1')
benign distance is  tensor(15.7285, device='cuda:1')
norm1 res is  tensor(0.2079, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.855606734752655
distance 1 is tensor(201.0905, device='cuda:1')
distance 2 is tensor(14.8502, device='cuda:1')
benign distance is  tensor(14.8502, device='cuda:1')
norm1 res is  tensor(0.1984, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  1.5094295740127563
distance 1 is tensor(234.8880, device='cuda:1')
distance 2 is tensor(17.2690, device='cuda:1')
benign distance is  tensor(17.2690, device='cuda:1')
norm1 res is  tensor(0.2350, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.7322365641593933
distance 1 is tensor(206.1690, device='cuda:1')
distance 2 is tensor(15.3076, device='cuda:1')
benign distance is  tensor(15.3076, device='cuda:1')
norm1 res is  tensor(0.2058, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.11710544675588608
distance 1 is tensor(228.4853, device='cuda:1')
distance 2 is tensor(16.7760, device='cuda:1')
benign distance is  tensor(16.7760, device='cuda:1')
norm1 res is  tensor(0.2250, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.3907943367958069
distance 1 is tensor(194.8287, device='cuda:1')
distance 2 is tensor(14.5986, device='cuda:1')
benign distance is  tensor(14.5986, device='cuda:1')
norm1 res is  tensor(0.1938, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(206.9514, device='cuda:1')
distance 2 is tensor(16.5231, device='cuda:1')
compute distance is  tensor(16.5231, device='cuda:1')
compute norm is  tensor(54.6680, device='cuda:1')
distance 1 is tensor(199.6176, device='cuda:1')
distance 2 is tensor(16.0714, device='cuda:1')
compute distance is  tensor(16.0714, device='cuda:1')
compute norm is  tensor(54.4875, device='cuda:1')
distance 1 is tensor(209.3056, device='cuda:1')
distance 2 is tensor(16.6805, device='cuda:1')
compute distance is  tensor(16.6805, device='cuda:1')
compute norm is  tensor(54.6993, device='cuda:1')
distance 1 is tensor(207.1637, device='cuda:1')
distance 2 is tensor(16.5150, device='cuda:1')
compute distance is  tensor(16.5150, device='cuda:1')
compute norm is  tensor(54.6548, device='cuda:1')
distance 1 is tensor(210.3242, device='cuda:1')
distance 2 is tensor(16.9076, device='cuda:1')
compute distance is  tensor(16.9076, device='cuda:1')
compute norm is  tensor(54.7673, device='cuda:1')
distance 1 is tensor(217.1053, device='cuda:1')
distance 2 is tensor(17.2914, device='cuda:1')
compute distance is  tensor(17.2914, device='cuda:1')
compute norm is  tensor(55.0157, device='cuda:1')
distance 1 is tensor(212.7056, device='cuda:1')
distance 2 is tensor(17.0208, device='cuda:1')
compute distance is  tensor(17.0208, device='cuda:1')
compute norm is  tensor(55.0350, device='cuda:1')
distance 1 is tensor(207.5631, device='cuda:1')
distance 2 is tensor(16.5226, device='cuda:1')
compute distance is  tensor(16.5226, device='cuda:1')
compute norm is  tensor(54.6989, device='cuda:1')
distance 1 is tensor(204.9590, device='cuda:1')
distance 2 is tensor(16.3144, device='cuda:1')
compute distance is  tensor(16.3144, device='cuda:1')
compute norm is  tensor(54.8234, device='cuda:1')
distance 1 is tensor(210.2638, device='cuda:1')
distance 2 is tensor(16.8768, device='cuda:1')
compute distance is  tensor(16.8768, device='cuda:1')
compute norm is  tensor(54.8317, device='cuda:1')
distance 1 is tensor(217.8790, device='cuda:1')
distance 2 is tensor(17.1178, device='cuda:1')
compute distance is  tensor(17.1178, device='cuda:1')
compute norm is  tensor(54.9953, device='cuda:1')
distance 1 is tensor(205.9422, device='cuda:1')
distance 2 is tensor(16.5153, device='cuda:1')
compute distance is  tensor(16.5153, device='cuda:1')
compute norm is  tensor(54.8048, device='cuda:1')
distance Threshold  is  tensor(17.2914, device='cuda:1')
distance 1 is tensor(1017826.8750, device='cuda:1')
distance 2 is tensor(74717.9375, device='cuda:1')
________________________________
test distance is  tensor(74717.9375, device='cuda:1')
test similarity is  tensor(0.1388, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.540850842294135e+17
test entropy is  0.0
________________________________
cal ratio is  0.013691296040270643
distance 1 is tensor(13935.3760, device='cuda:1')
distance 2 is tensor(1022.9854, device='cuda:1')
cal_distance is  tensor(1022.9854, device='cuda:1')
cal ratio is  0.11700981664854668
distance 1 is tensor(1630.5813, device='cuda:1')
distance 2 is tensor(119.6993, device='cuda:1')
cal_distance is  tensor(119.6993, device='cuda:1')
cal ratio is  0.342066961117173
distance 1 is tensor(557.7721, device='cuda:1')
distance 2 is tensor(40.9452, device='cuda:1')
cal_distance is  tensor(40.9452, device='cuda:1')
cal ratio is  0.5848648934971882
distance 1 is tensor(326.2240, device='cuda:1')
distance 2 is tensor(23.9474, device='cuda:1')
cal_distance is  tensor(23.9474, device='cuda:1')
cal ratio is  0.7647645743734314
distance 1 is tensor(249.4860, device='cuda:1')
distance 2 is tensor(18.3141, device='cuda:1')
cal_distance is  tensor(18.3141, device='cuda:1')
cal ratio is  0.8745082130553555
distance 1 is tensor(218.1783, device='cuda:1')
distance 2 is tensor(16.0159, device='cuda:1')
cal_distance is  tensor(16.0159, device='cuda:1')
distance 1 is tensor(218.1783, device='cuda:1')
distance 2 is tensor(16.0159, device='cuda:1')
________________________________
test distance is  tensor(16.0159, device='cuda:1')
test similarity is  tensor(0.9160, device='cuda:1')
test acc is  0.10821666682299863
test loss is 528.6393983104844
test entropy is  9.212091836174272e-15
________________________________
distance 1 is tensor(218.1783, device='cuda:1')
distance 2 is tensor(16.0159, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  4.3224453979136525e-22
avg test loss is  528.0337812346436
avg accuracy is  0.10725000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9160, device='cuda:1')
compute_distance is  tensor(16.0159, device='cuda:1')
compute_norm is  tensor(55.9386, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(207.9610, device='cuda:1')
distance 2 is tensor(17.8552, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.1085885816545629
avg test loss is  1.7721334619562763
avg accuracy is  0.32601666682300673
solo acc is  0.22161666682300393
compute similarity  is  tensor(0.9196, device='cuda:1')
compute_distance is  tensor(17.8552, device='cuda:1')
compute_norm is  tensor(56.5002, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(207.6828, device='cuda:1')
distance 2 is tensor(17.9065, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6679078759923418
avg test loss is  2.6000735180210204
avg accuracy is  0.21075000015633688
solo acc is  0.11043333348966529
compute similarity  is  tensor(0.9195, device='cuda:1')
compute_distance is  tensor(17.9065, device='cuda:1')
compute_norm is  tensor(56.3584, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(207.1618, device='cuda:1')
distance 2 is tensor(17.6813, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0367682445913489
avg test loss is  1.6330342166967737
avg accuracy is  0.3528666668230071
solo acc is  0.24931666682300496
compute similarity  is  tensor(0.9197, device='cuda:1')
compute_distance is  tensor(17.6813, device='cuda:1')
compute_norm is  tensor(55.9406, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(207.1343, device='cuda:1')
distance 2 is tensor(17.7604, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6444428383287336
avg test loss is  2.500724014824133
avg accuracy is  0.21706666682300374
solo acc is  0.10860000015633195
compute similarity  is  tensor(0.9196, device='cuda:1')
compute_distance is  tensor(17.7604, device='cuda:1')
compute_norm is  tensor(55.7857, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(206.8441, device='cuda:1')
distance 2 is tensor(17.5891, device='cuda:1')
________________________________
test distance is  tensor(17.5891, device='cuda:1')
test similarity is  tensor(0.9197, device='cuda:1')
test acc is  0.37471666682300747
test loss is 1.5668723903485198
test entropy is  0.9953378677876519
________________________________
cal ratio is  0.8923498787566779
distance 1 is tensor(184.5779, device='cuda:1')
distance 2 is tensor(15.6956, device='cuda:1')
cal_distance is  tensor(15.6956, device='cuda:1')
distance 1 is tensor(184.5779, device='cuda:1')
distance 2 is tensor(15.6956, device='cuda:1')
________________________________
test distance is  tensor(15.6956, device='cuda:1')
test similarity is  tensor(0.9339, device='cuda:1')
test acc is  0.4045833334896745
test loss is 1.5236981891111525
test entropy is  1.0665485137052881
________________________________
distance 1 is tensor(184.5779, device='cuda:1')
distance 2 is tensor(15.6956, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0653080614263823
avg test loss is  1.527697312679372
avg accuracy is  0.4040333334896745
solo acc is  0.25293333348967173
compute similarity  is  tensor(0.9339, device='cuda:1')
compute_distance is  tensor(15.6956, device='cuda:1')
compute_norm is  tensor(54.6300, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(185.0434, device='cuda:1')
distance 2 is tensor(15.8378, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6220181990089193
avg test loss is  2.4264018127658984
avg accuracy is  0.2465833334896715
solo acc is  0.10860000015633195
compute similarity  is  tensor(0.9337, device='cuda:1')
compute_distance is  tensor(15.8378, device='cuda:1')
compute_norm is  tensor(54.4772, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(185.3908, device='cuda:1')
distance 2 is tensor(15.7542, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9823586370136692
avg test loss is  1.514678456508783
avg accuracy is  0.4130166668230079
solo acc is  0.2570000001563385
compute similarity  is  tensor(0.9337, device='cuda:1')
compute_distance is  tensor(15.7542, device='cuda:1')
compute_norm is  tensor(54.1058, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(185.3908, device='cuda:1')
distance 2 is tensor(15.7542, device='cuda:1')
________________________________
test distance is  tensor(15.7542, device='cuda:1')
test similarity is  tensor(0.9337, device='cuda:1')
test acc is  0.4153000001563413
test loss is 1.5123339602942152
test entropy is  0.981849764710042
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.238797664642334
mal norm is  tensor(9.2582, device='cuda:1')
distance 1 is tensor(185.3908, device='cuda:1')
distance 2 is tensor(15.7542, device='cuda:1')
mal distance is  tensor(15.7542, device='cuda:1')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2726, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(781.8827, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(843.2798, device='cuda:1')
c is  tensor(0.0180, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(825.0603, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(788.7364, device='cuda:1')
c is  tensor(0.0186, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.3667, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.8781, device='cuda:1')
c is  tensor(0.0183, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.8926, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.5691, device='cuda:1')
c is  tensor(0.0188, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.8221, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(988.3055, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(946.7588, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(911.9705, device='cuda:1')
c is  tensor(0.0173, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(945.9175, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(991.2529, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(962.4985, device='cuda:1')
c is  tensor(0.0168, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1007.5661, device='cuda:1')
c is  tensor(0.0164, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(949.1612, device='cuda:1')
c is  tensor(0.0169, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(930.8069, device='cuda:1')
c is  tensor(0.0171, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.7191, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.9377, device='cuda:1')
c is  tensor(0.0173, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(845.4626, device='cuda:1')
c is  tensor(0.0180, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.3652, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(855.8794, device='cuda:1')
c is  tensor(0.0178, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(858.3320, device='cuda:1')
c is  tensor(0.0178, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(831.9009, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(903.0671, device='cuda:1')
c is  tensor(0.0174, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(938.3111, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(821.3704, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(952.3885, device='cuda:1')
c is  tensor(0.0169, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(900.0509, device='cuda:1')
c is  tensor(0.0174, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(818.9282, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(826.5050, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(821.3246, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.2411, device='cuda:1')
c is  tensor(0.0184, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(775.3807, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.3082, device='cuda:1')
c is  tensor(0.0189, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(816.3408, device='cuda:1')
c is  tensor(0.0183, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.5372, device='cuda:1')
c is  tensor(0.0186, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(766.3890, device='cuda:1')
c is  tensor(0.0189, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(781.7307, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.5372, device='cuda:1')
c is  tensor(0.0185, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
len accept list 40
len all weights is 40
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 92.03% 

Test Accuracy: 89.72% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
 benign loss is  0.29422441124916077
distance 1 is tensor(106.8867, device='cuda:1')
distance 2 is tensor(7.8203, device='cuda:1')
benign distance is  tensor(7.8203, device='cuda:1')
norm1 res is  tensor(0.1118, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.8105238676071167
distance 1 is tensor(121.6181, device='cuda:1')
distance 2 is tensor(8.7887, device='cuda:1')
benign distance is  tensor(8.7887, device='cuda:1')
norm1 res is  tensor(0.1266, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.1559406965970993
distance 1 is tensor(121.1457, device='cuda:1')
distance 2 is tensor(8.7029, device='cuda:1')
benign distance is  tensor(8.7029, device='cuda:1')
norm1 res is  tensor(0.1258, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.7262571454048157
distance 1 is tensor(144.7837, device='cuda:1')
distance 2 is tensor(10.4400, device='cuda:1')
benign distance is  tensor(10.4400, device='cuda:1')
norm1 res is  tensor(0.1509, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.7265383005142212
distance 1 is tensor(127.4891, device='cuda:1')
distance 2 is tensor(9.0741, device='cuda:1')
benign distance is  tensor(9.0741, device='cuda:1')
norm1 res is  tensor(0.1290, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.6707009077072144
distance 1 is tensor(149.8915, device='cuda:1')
distance 2 is tensor(10.7474, device='cuda:1')
benign distance is  tensor(10.7474, device='cuda:1')
norm1 res is  tensor(0.1577, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.4035675525665283
distance 1 is tensor(124.3052, device='cuda:1')
distance 2 is tensor(9.0083, device='cuda:1')
benign distance is  tensor(9.0083, device='cuda:1')
norm1 res is  tensor(0.1302, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.6174712777137756
distance 1 is tensor(138.2120, device='cuda:1')
distance 2 is tensor(10.0461, device='cuda:1')
benign distance is  tensor(10.0461, device='cuda:1')
norm1 res is  tensor(0.1480, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.5838748216629028
distance 1 is tensor(153.5114, device='cuda:1')
distance 2 is tensor(11.0659, device='cuda:1')
benign distance is  tensor(11.0659, device='cuda:1')
norm1 res is  tensor(0.1610, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  1.0197820663452148
distance 1 is tensor(135.4613, device='cuda:1')
distance 2 is tensor(9.7189, device='cuda:1')
benign distance is  tensor(9.7189, device='cuda:1')
norm1 res is  tensor(0.1379, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.5325287580490112
distance 1 is tensor(144.8588, device='cuda:1')
distance 2 is tensor(10.2932, device='cuda:1')
benign distance is  tensor(10.2932, device='cuda:1')
norm1 res is  tensor(0.1497, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.5235270857810974
distance 1 is tensor(135.8616, device='cuda:1')
distance 2 is tensor(9.8560, device='cuda:1')
benign distance is  tensor(9.8560, device='cuda:1')
norm1 res is  tensor(0.1422, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.9621389508247375
distance 1 is tensor(134.2475, device='cuda:1')
distance 2 is tensor(9.6544, device='cuda:1')
benign distance is  tensor(9.6544, device='cuda:1')
norm1 res is  tensor(0.1397, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.18432898819446564
distance 1 is tensor(144.1408, device='cuda:1')
distance 2 is tensor(10.3375, device='cuda:1')
benign distance is  tensor(10.3375, device='cuda:1')
norm1 res is  tensor(0.1508, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.357685387134552
distance 1 is tensor(143.9095, device='cuda:1')
distance 2 is tensor(10.2958, device='cuda:1')
benign distance is  tensor(10.2958, device='cuda:1')
norm1 res is  tensor(0.1492, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.5287463665008545
distance 1 is tensor(140.4979, device='cuda:1')
distance 2 is tensor(10.0681, device='cuda:1')
benign distance is  tensor(10.0681, device='cuda:1')
norm1 res is  tensor(0.1486, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.19486965239048004
distance 1 is tensor(155.6882, device='cuda:1')
distance 2 is tensor(11.1456, device='cuda:1')
benign distance is  tensor(11.1456, device='cuda:1')
norm1 res is  tensor(0.1629, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.48869261145591736
distance 1 is tensor(154.7080, device='cuda:1')
distance 2 is tensor(11.1394, device='cuda:1')
benign distance is  tensor(11.1394, device='cuda:1')
norm1 res is  tensor(0.1601, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.02013387158513069
distance 1 is tensor(137.7929, device='cuda:1')
distance 2 is tensor(10.0393, device='cuda:1')
benign distance is  tensor(10.0393, device='cuda:1')
norm1 res is  tensor(0.1435, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.2516076862812042
distance 1 is tensor(151.8176, device='cuda:1')
distance 2 is tensor(10.9631, device='cuda:1')
benign distance is  tensor(10.9631, device='cuda:1')
norm1 res is  tensor(0.1581, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.3314512372016907
distance 1 is tensor(137.0614, device='cuda:1')
distance 2 is tensor(10.0051, device='cuda:1')
benign distance is  tensor(10.0051, device='cuda:1')
norm1 res is  tensor(0.1405, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  0.6768404841423035
distance 1 is tensor(136.4092, device='cuda:1')
distance 2 is tensor(9.8674, device='cuda:1')
benign distance is  tensor(9.8674, device='cuda:1')
norm1 res is  tensor(0.1399, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.23035159707069397
distance 1 is tensor(153.9467, device='cuda:1')
distance 2 is tensor(11.2312, device='cuda:1')
benign distance is  tensor(11.2312, device='cuda:1')
norm1 res is  tensor(0.1629, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  0.24458232522010803
distance 1 is tensor(142.2526, device='cuda:1')
distance 2 is tensor(10.1917, device='cuda:1')
benign distance is  tensor(10.1917, device='cuda:1')
norm1 res is  tensor(0.1459, device='cuda:1')
current submit client idx and staleness is  24 4
 benign loss is  0.17664219439029694
distance 1 is tensor(137.1440, device='cuda:1')
distance 2 is tensor(9.9318, device='cuda:1')
benign distance is  tensor(9.9318, device='cuda:1')
norm1 res is  tensor(0.1448, device='cuda:1')
current submit client idx and staleness is  25 4
 benign loss is  0.9596841931343079
distance 1 is tensor(127.1947, device='cuda:1')
distance 2 is tensor(9.0464, device='cuda:1')
benign distance is  tensor(9.0464, device='cuda:1')
norm1 res is  tensor(0.1297, device='cuda:1')
current submit client idx and staleness is  26 4
 benign loss is  0.3114653527736664
distance 1 is tensor(165.8836, device='cuda:1')
distance 2 is tensor(11.8375, device='cuda:1')
benign distance is  tensor(11.8375, device='cuda:1')
norm1 res is  tensor(0.1703, device='cuda:1')
current submit client idx and staleness is  27 4
 benign loss is  0.21812012791633606
distance 1 is tensor(142.0334, device='cuda:1')
distance 2 is tensor(10.2319, device='cuda:1')
benign distance is  tensor(10.2319, device='cuda:1')
norm1 res is  tensor(0.1480, device='cuda:1')
current submit client idx and staleness is  28 4
 benign loss is  0.4745938777923584
distance 1 is tensor(143.4886, device='cuda:1')
distance 2 is tensor(10.2530, device='cuda:1')
benign distance is  tensor(10.2530, device='cuda:1')
norm1 res is  tensor(0.1477, device='cuda:1')
current submit client idx and staleness is  29 4
 benign loss is  0.7399666905403137
distance 1 is tensor(142.6471, device='cuda:1')
distance 2 is tensor(10.2857, device='cuda:1')
benign distance is  tensor(10.2857, device='cuda:1')
norm1 res is  tensor(0.1484, device='cuda:1')
current submit client idx and staleness is  30 4
 benign loss is  0.31810054183006287
distance 1 is tensor(152.1239, device='cuda:1')
distance 2 is tensor(11.0138, device='cuda:1')
benign distance is  tensor(11.0138, device='cuda:1')
norm1 res is  tensor(0.1575, device='cuda:1')
current submit client idx and staleness is  31 4
 benign loss is  0.7829880118370056
distance 1 is tensor(153.6315, device='cuda:1')
distance 2 is tensor(11.0240, device='cuda:1')
benign distance is  tensor(11.0240, device='cuda:1')
norm1 res is  tensor(0.1603, device='cuda:1')
current submit client idx and staleness is  40 6
 benign loss is  0.34447306394577026
distance 1 is tensor(147.6125, device='cuda:1')
distance 2 is tensor(10.5903, device='cuda:1')
benign distance is  tensor(10.5903, device='cuda:1')
norm1 res is  tensor(0.1514, device='cuda:1')
current submit client idx and staleness is  41 6
 benign loss is  0.29398977756500244
distance 1 is tensor(141.8212, device='cuda:1')
distance 2 is tensor(10.2270, device='cuda:1')
benign distance is  tensor(10.2270, device='cuda:1')
norm1 res is  tensor(0.1478, device='cuda:1')
current submit client idx and staleness is  42 6
 benign loss is  0.3368806838989258
distance 1 is tensor(131.2895, device='cuda:1')
distance 2 is tensor(9.4314, device='cuda:1')
benign distance is  tensor(9.4314, device='cuda:1')
norm1 res is  tensor(0.1361, device='cuda:1')
current submit client idx and staleness is  43 6
 benign loss is  0.8577300310134888
distance 1 is tensor(157.5605, device='cuda:1')
distance 2 is tensor(11.3702, device='cuda:1')
benign distance is  tensor(11.3702, device='cuda:1')
norm1 res is  tensor(0.1642, device='cuda:1')
current submit client idx and staleness is  44 6
 benign loss is  0.07235988229513168
distance 1 is tensor(146.4912, device='cuda:1')
distance 2 is tensor(10.5780, device='cuda:1')
benign distance is  tensor(10.5780, device='cuda:1')
norm1 res is  tensor(0.1524, device='cuda:1')
current submit client idx and staleness is  45 6
 benign loss is  0.23798838257789612
distance 1 is tensor(159.3772, device='cuda:1')
distance 2 is tensor(11.4494, device='cuda:1')
benign distance is  tensor(11.4494, device='cuda:1')
norm1 res is  tensor(0.1630, device='cuda:1')
current submit client idx and staleness is  46 6
 benign loss is  0.8070074915885925
distance 1 is tensor(149.8323, device='cuda:1')
distance 2 is tensor(10.6604, device='cuda:1')
benign distance is  tensor(10.6604, device='cuda:1')
norm1 res is  tensor(0.1525, device='cuda:1')
current submit client idx and staleness is  47 6
 benign loss is  0.37577909231185913
distance 1 is tensor(139.5933, device='cuda:1')
distance 2 is tensor(10.1501, device='cuda:1')
benign distance is  tensor(10.1501, device='cuda:1')
norm1 res is  tensor(0.1453, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(172.2603, device='cuda:1')
distance 2 is tensor(12.2244, device='cuda:1')
compute distance is  tensor(12.2244, device='cuda:1')
compute norm is  tensor(52.3538, device='cuda:1')
distance 1 is tensor(177.1343, device='cuda:1')
distance 2 is tensor(12.5551, device='cuda:1')
compute distance is  tensor(12.5551, device='cuda:1')
compute norm is  tensor(52.4525, device='cuda:1')
distance 1 is tensor(175.1476, device='cuda:1')
distance 2 is tensor(12.4216, device='cuda:1')
compute distance is  tensor(12.4216, device='cuda:1')
compute norm is  tensor(52.3387, device='cuda:1')
distance 1 is tensor(160.2664, device='cuda:1')
distance 2 is tensor(11.3583, device='cuda:1')
compute distance is  tensor(11.3583, device='cuda:1')
compute norm is  tensor(52.0144, device='cuda:1')
distance 1 is tensor(180.6407, device='cuda:1')
distance 2 is tensor(12.9134, device='cuda:1')
compute distance is  tensor(12.9134, device='cuda:1')
compute norm is  tensor(52.6195, device='cuda:1')
distance 1 is tensor(182.8482, device='cuda:1')
distance 2 is tensor(12.8388, device='cuda:1')
compute distance is  tensor(12.8388, device='cuda:1')
compute norm is  tensor(52.7789, device='cuda:1')
distance 1 is tensor(185.9665, device='cuda:1')
distance 2 is tensor(13.2547, device='cuda:1')
compute distance is  tensor(13.2547, device='cuda:1')
compute norm is  tensor(52.7493, device='cuda:1')
distance 1 is tensor(200.9964, device='cuda:1')
distance 2 is tensor(14.0710, device='cuda:1')
compute distance is  tensor(14.0710, device='cuda:1')
compute norm is  tensor(53.1177, device='cuda:1')
distance 1 is tensor(173.2367, device='cuda:1')
distance 2 is tensor(12.3311, device='cuda:1')
compute distance is  tensor(12.3311, device='cuda:1')
compute norm is  tensor(52.5978, device='cuda:1')
distance 1 is tensor(183.6605, device='cuda:1')
distance 2 is tensor(12.9123, device='cuda:1')
compute distance is  tensor(12.9123, device='cuda:1')
compute norm is  tensor(52.6085, device='cuda:1')
distance 1 is tensor(178.7678, device='cuda:1')
distance 2 is tensor(12.3732, device='cuda:1')
compute distance is  tensor(12.3732, device='cuda:1')
compute norm is  tensor(52.6461, device='cuda:1')
distance 1 is tensor(181.9203, device='cuda:1')
distance 2 is tensor(12.7890, device='cuda:1')
compute distance is  tensor(12.7890, device='cuda:1')
compute norm is  tensor(52.6777, device='cuda:1')
distance Threshold  is  tensor(14.0710, device='cuda:1')
distance 1 is tensor(1017883., device='cuda:1')
distance 2 is tensor(74722.8125, device='cuda:1')
________________________________
test distance is  tensor(74722.8125, device='cuda:1')
test similarity is  tensor(-0.0010, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.53962635719153e+17
test entropy is  0.0
________________________________
cal ratio is  0.012350329722870014
distance 1 is tensor(12571.1963, device='cuda:1')
distance 2 is tensor(922.8513, device='cuda:1')
cal_distance is  tensor(922.8513, device='cuda:1')
cal ratio is  0.11113204113570216
distance 1 is tensor(1397.0682, device='cuda:1')
distance 2 is tensor(102.5584, device='cuda:1')
cal_distance is  tensor(102.5584, device='cuda:1')
cal ratio is  0.3333647169548302
distance 1 is tensor(465.7375, device='cuda:1')
distance 2 is tensor(34.1893, device='cuda:1')
cal_distance is  tensor(34.1893, device='cuda:1')
cal ratio is  0.5773774621126014
distance 1 is tensor(268.9090, device='cuda:1')
distance 2 is tensor(19.7402, device='cuda:1')
cal_distance is  tensor(19.7402, device='cuda:1')
cal ratio is  0.7598535936907564
distance 1 is tensor(204.3329, device='cuda:1')
distance 2 is tensor(14.9996, device='cuda:1')
cal_distance is  tensor(14.9996, device='cuda:1')
cal ratio is  0.8716957892542565
distance 1 is tensor(178.1170, device='cuda:1')
distance 2 is tensor(13.0751, device='cuda:1')
cal_distance is  tensor(13.0751, device='cuda:1')
distance 1 is tensor(178.1170, device='cuda:1')
distance 2 is tensor(13.0751, device='cuda:1')
________________________________
test distance is  tensor(13.0751, device='cuda:1')
test similarity is  tensor(0.9346, device='cuda:1')
test acc is  0.6723833334896657
test loss is 155.76163972313725
test entropy is  0.0032929298546303227
________________________________
distance 1 is tensor(178.1170, device='cuda:1')
distance 2 is tensor(13.0751, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0033911036354213513
avg test loss is  155.50656400408064
avg accuracy is  0.6715333334896658
solo acc is  0.1181666668229986
compute similarity  is  tensor(0.9346, device='cuda:1')
compute_distance is  tensor(13.0751, device='cuda:1')
compute_norm is  tensor(53.9103, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(163.6588, device='cuda:1')
distance 2 is tensor(14.0192, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9949599569921554
avg test loss is  1.5327985459553408
avg accuracy is  0.7835833334896595
solo acc is  0.30038333348967283
compute similarity  is  tensor(0.9371, device='cuda:1')
compute_distance is  tensor(14.0192, device='cuda:1')
compute_norm is  tensor(53.2963, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(163.6588, device='cuda:1')
distance 2 is tensor(14.0192, device='cuda:1')
________________________________
test distance is  tensor(14.0192, device='cuda:1')
test similarity is  tensor(0.9371, device='cuda:1')
test acc is  0.7860333334896593
test loss is 1.5335268108829507
test entropy is  0.9941233796859855
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4746291637420654
mal norm is  tensor(8.7212, device='cuda:1')
distance 1 is tensor(163.6588, device='cuda:1')
distance 2 is tensor(14.0192, device='cuda:1')
mal distance is  tensor(14.0192, device='cuda:1')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.2703, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(443.1416, device='cuda:1')
c is  tensor(0.0247, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.9521, device='cuda:1')
c is  tensor(0.0232, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.5475, device='cuda:1')
c is  tensor(0.0233, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.5757, device='cuda:1')
c is  tensor(0.0214, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.4073, device='cuda:1')
c is  tensor(0.0230, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.5378, device='cuda:1')
c is  tensor(0.0208, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.9126, device='cuda:1')
c is  tensor(0.0229, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.9143e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.7029, device='cuda:1')
c is  tensor(0.0215, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.1226, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
len accept list 15
len all weights is 15
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 79.37% 

Test Accuracy: 78.22% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5463706254959106
distance 1 is tensor(232.3383, device='cuda:1')
distance 2 is tensor(17.1094, device='cuda:1')
benign distance is  tensor(17.1094, device='cuda:1')
norm1 res is  tensor(0.2228, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  1.1870057582855225
distance 1 is tensor(224.6925, device='cuda:1')
distance 2 is tensor(16.9517, device='cuda:1')
benign distance is  tensor(16.9517, device='cuda:1')
norm1 res is  tensor(0.2188, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.5435974597930908
distance 1 is tensor(232.5169, device='cuda:1')
distance 2 is tensor(17.4129, device='cuda:1')
benign distance is  tensor(17.4129, device='cuda:1')
norm1 res is  tensor(0.2221, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.6045570969581604
distance 1 is tensor(213.8598, device='cuda:1')
distance 2 is tensor(15.6121, device='cuda:1')
benign distance is  tensor(15.6121, device='cuda:1')
norm1 res is  tensor(0.2043, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.7182905673980713
distance 1 is tensor(216.6206, device='cuda:1')
distance 2 is tensor(15.9743, device='cuda:1')
benign distance is  tensor(15.9743, device='cuda:1')
norm1 res is  tensor(0.2098, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.9171863794326782
distance 1 is tensor(250.6683, device='cuda:1')
distance 2 is tensor(18.4898, device='cuda:1')
benign distance is  tensor(18.4898, device='cuda:1')
norm1 res is  tensor(0.2419, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.22345829010009766
distance 1 is tensor(231.6421, device='cuda:1')
distance 2 is tensor(16.8028, device='cuda:1')
benign distance is  tensor(16.8028, device='cuda:1')
norm1 res is  tensor(0.2174, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.8601276278495789
distance 1 is tensor(262.0623, device='cuda:1')
distance 2 is tensor(19.1774, device='cuda:1')
benign distance is  tensor(19.1774, device='cuda:1')
norm1 res is  tensor(0.2498, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(207.3416, device='cuda:1')
distance 2 is tensor(16.3304, device='cuda:1')
compute distance is  tensor(16.3304, device='cuda:1')
compute norm is  tensor(53.5142, device='cuda:1')
distance 1 is tensor(210.0547, device='cuda:1')
distance 2 is tensor(16.3368, device='cuda:1')
compute distance is  tensor(16.3368, device='cuda:1')
compute norm is  tensor(53.3762, device='cuda:1')
distance 1 is tensor(207.8220, device='cuda:1')
distance 2 is tensor(16.3250, device='cuda:1')
compute distance is  tensor(16.3250, device='cuda:1')
compute norm is  tensor(53.4531, device='cuda:1')
distance 1 is tensor(205.7664, device='cuda:1')
distance 2 is tensor(16.1951, device='cuda:1')
compute distance is  tensor(16.1951, device='cuda:1')
compute norm is  tensor(53.2673, device='cuda:1')
distance 1 is tensor(211.6758, device='cuda:1')
distance 2 is tensor(16.6421, device='cuda:1')
compute distance is  tensor(16.6421, device='cuda:1')
compute norm is  tensor(53.5609, device='cuda:1')
distance 1 is tensor(228.7235, device='cuda:1')
distance 2 is tensor(17.4639, device='cuda:1')
compute distance is  tensor(17.4639, device='cuda:1')
compute norm is  tensor(53.9233, device='cuda:1')
distance 1 is tensor(205.9248, device='cuda:1')
distance 2 is tensor(16.0972, device='cuda:1')
compute distance is  tensor(16.0972, device='cuda:1')
compute norm is  tensor(53.3437, device='cuda:1')
distance 1 is tensor(200.7475, device='cuda:1')
distance 2 is tensor(15.8738, device='cuda:1')
compute distance is  tensor(15.8738, device='cuda:1')
compute norm is  tensor(53.3052, device='cuda:1')
distance 1 is tensor(225.3153, device='cuda:1')
distance 2 is tensor(17.2523, device='cuda:1')
compute distance is  tensor(17.2523, device='cuda:1')
compute norm is  tensor(53.9093, device='cuda:1')
distance 1 is tensor(212.2009, device='cuda:1')
distance 2 is tensor(16.5657, device='cuda:1')
compute distance is  tensor(16.5657, device='cuda:1')
compute norm is  tensor(53.5768, device='cuda:1')
distance 1 is tensor(218.7961, device='cuda:1')
distance 2 is tensor(16.9293, device='cuda:1')
compute distance is  tensor(16.9293, device='cuda:1')
compute norm is  tensor(53.7434, device='cuda:1')
distance 1 is tensor(200.0713, device='cuda:1')
distance 2 is tensor(15.7282, device='cuda:1')
compute distance is  tensor(15.7282, device='cuda:1')
compute norm is  tensor(53.4548, device='cuda:1')
distance Threshold  is  tensor(17.4639, device='cuda:1')
distance 1 is tensor(1017797.1875, device='cuda:1')
distance 2 is tensor(74715.8438, device='cuda:1')
________________________________
test distance is  tensor(74715.8438, device='cuda:1')
test similarity is  tensor(0.2171, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.539312800768868e+17
test entropy is  0.0
________________________________
cal ratio is  0.013759636288023855
distance 1 is tensor(14004.5254, device='cuda:1')
distance 2 is tensor(1028.0626, device='cuda:1')
cal_distance is  tensor(1028.0626, device='cuda:1')
cal ratio is  0.11730149279997293
distance 1 is tensor(1642.7571, device='cuda:1')
distance 2 is tensor(120.5933, device='cuda:1')
cal_distance is  tensor(120.5933, device='cuda:1')
cal ratio is  0.3424930305885647
distance 1 is tensor(562.6370, device='cuda:1')
distance 2 is tensor(41.3024, device='cuda:1')
cal_distance is  tensor(41.3024, device='cuda:1')
cal ratio is  0.5852290257219758
distance 1 is tensor(329.2741, device='cuda:1')
distance 2 is tensor(24.1713, device='cuda:1')
cal_distance is  tensor(24.1713, device='cuda:1')
cal ratio is  0.7650026645333504
distance 1 is tensor(251.8971, device='cuda:1')
distance 2 is tensor(18.4911, device='cuda:1')
cal_distance is  tensor(18.4911, device='cuda:1')
cal ratio is  0.874644289942633
distance 1 is tensor(220.3211, device='cuda:1')
distance 2 is tensor(16.1732, device='cuda:1')
cal_distance is  tensor(16.1732, device='cuda:1')
distance 1 is tensor(220.3211, device='cuda:1')
distance 2 is tensor(16.1732, device='cuda:1')
________________________________
test distance is  tensor(16.1732, device='cuda:1')
test similarity is  tensor(0.9255, device='cuda:1')
test acc is  0.11761666682299861
test loss is 463.77301539439384
test entropy is  7.454437940627688e-06
________________________________
distance 1 is tensor(220.3211, device='cuda:1')
distance 2 is tensor(16.1732, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.2322144013059844e-05
avg test loss is  464.3987102711887
avg accuracy is  0.1178166668229986
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9255, device='cuda:1')
compute_distance is  tensor(16.1732, device='cuda:1')
compute_norm is  tensor(58.1674, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(216.6444, device='cuda:1')
distance 2 is tensor(18.9728, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.1727781097517846
avg test loss is  1.9509951176165519
avg accuracy is  0.288966666823006
solo acc is  0.1959500001563362
compute similarity  is  tensor(0.9270, device='cuda:1')
compute_distance is  tensor(18.9728, device='cuda:1')
compute_norm is  tensor(59.0888, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(216.3376, device='cuda:1')
distance 2 is tensor(19.0746, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7050194482305157
avg test loss is  2.7593867463597865
avg accuracy is  0.19413333348966944
solo acc is  0.11020000015633195
compute similarity  is  tensor(0.9268, device='cuda:1')
compute_distance is  tensor(19.0746, device='cuda:1')
compute_norm is  tensor(58.9830, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(215.6250, device='cuda:1')
distance 2 is tensor(18.7362, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0644807300842138
avg test loss is  1.7491205104632672
avg accuracy is  0.32636666682300675
solo acc is  0.2293000001563376
compute similarity  is  tensor(0.9270, device='cuda:1')
compute_distance is  tensor(18.7362, device='cuda:1')
compute_norm is  tensor(58.5071, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(215.5487, device='cuda:1')
distance 2 is tensor(18.8551, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6662986001480363
avg test loss is  2.588088476073259
avg accuracy is  0.21090000015633686
solo acc is  0.11083333348966529
compute similarity  is  tensor(0.9267, device='cuda:1')
compute_distance is  tensor(18.8551, device='cuda:1')
compute_norm is  tensor(58.3722, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(215.3478, device='cuda:1')
distance 2 is tensor(18.6224, device='cuda:1')
________________________________
test distance is  tensor(18.6224, device='cuda:1')
test similarity is  tensor(0.9268, device='cuda:1')
test acc is  0.34571666682300706
test loss is 1.6353312425776076
test entropy is  1.020526546659246
________________________________
cal ratio is  0.8715571747128523
distance 1 is tensor(187.6886, device='cuda:1')
distance 2 is tensor(16.2305, device='cuda:1')
cal_distance is  tensor(16.2305, device='cuda:1')
distance 1 is tensor(187.6886, device='cuda:1')
distance 2 is tensor(16.2305, device='cuda:1')
________________________________
test distance is  tensor(16.2305, device='cuda:1')
test similarity is  tensor(0.9419, device='cuda:1')
test acc is  0.38558333348967433
test loss is 1.5727369916210296
test entropy is  1.1503542373175306
________________________________
distance 1 is tensor(187.6886, device='cuda:1')
distance 2 is tensor(16.2305, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1492585317412418
avg test loss is  1.5760245377829334
avg accuracy is  0.387750000156341
solo acc is  0.24846666682300486
compute similarity  is  tensor(0.9419, device='cuda:1')
compute_distance is  tensor(16.2305, device='cuda:1')
compute_norm is  tensor(56.8946, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(188.2551, device='cuda:1')
distance 2 is tensor(16.4409, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6503135628664671
avg test loss is  2.4953017112797005
avg accuracy is  0.23531666682300445
solo acc is  0.11113333348966528
compute similarity  is  tensor(0.9416, device='cuda:1')
compute_distance is  tensor(16.4409, device='cuda:1')
compute_norm is  tensor(56.7678, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(188.8151, device='cuda:1')
distance 2 is tensor(16.3342, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9909530654390738
avg test loss is  1.571983325455997
avg accuracy is  0.38430000015634086
solo acc is  0.2586833334896719
compute similarity  is  tensor(0.9414, device='cuda:1')
compute_distance is  tensor(16.3342, device='cuda:1')
compute_norm is  tensor(56.3855, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(188.8151, device='cuda:1')
distance 2 is tensor(16.3342, device='cuda:1')
________________________________
test distance is  tensor(16.3342, device='cuda:1')
test similarity is  tensor(0.9414, device='cuda:1')
test acc is  0.38533333348967425
test loss is 1.5693625472247728
test entropy is  0.9916128876493938
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3729146718978882
mal norm is  tensor(9.2234, device='cuda:1')
distance 1 is tensor(188.8151, device='cuda:1')
distance 2 is tensor(16.3342, device='cuda:1')
mal distance is  tensor(16.3342, device='cuda:1')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.3012, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(885.3939, device='cuda:1')
c is  tensor(0.0184, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.9384, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.6219e-06, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(877.9462, device='cuda:1')
c is  tensor(0.0185, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.9205, device='cuda:1')
c is  tensor(0.0193, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(830.1146, device='cuda:1')
c is  tensor(0.0190, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(956.5654, device='cuda:1')
c is  tensor(0.0177, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5258, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(992.4839, device='cuda:1')
c is  tensor(0.0174, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0012, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(922.3442, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(876.3501, device='cuda:1')
c is  tensor(0.0185, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(818.9802, device='cuda:1')
c is  tensor(0.0192, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(847.3057, device='cuda:1')
c is  tensor(0.0189, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(825.2545, device='cuda:1')
c is  tensor(0.0191, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.0098, device='cuda:1')
c is  tensor(0.0193, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(849.6461, device='cuda:1')
c is  tensor(0.0188, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(843.6860, device='cuda:1')
c is  tensor(0.0189, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(828.9302, device='cuda:1')
c is  tensor(0.0191, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 91.05% 

Test Accuracy: 89.08% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
 benign loss is  0.08565653860569
distance 1 is tensor(145.3949, device='cuda:1')
distance 2 is tensor(10.5205, device='cuda:1')
benign distance is  tensor(10.5205, device='cuda:1')
norm1 res is  tensor(0.1478, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.9324744343757629
distance 1 is tensor(149.7741, device='cuda:1')
distance 2 is tensor(10.8982, device='cuda:1')
benign distance is  tensor(10.8982, device='cuda:1')
norm1 res is  tensor(0.1563, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  1.0349687337875366
distance 1 is tensor(153.0935, device='cuda:1')
distance 2 is tensor(10.8543, device='cuda:1')
benign distance is  tensor(10.8543, device='cuda:1')
norm1 res is  tensor(0.1541, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.6587520837783813
distance 1 is tensor(148.1380, device='cuda:1')
distance 2 is tensor(10.5553, device='cuda:1')
benign distance is  tensor(10.5553, device='cuda:1')
norm1 res is  tensor(0.1472, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.45205479860305786
distance 1 is tensor(135.2655, device='cuda:1')
distance 2 is tensor(9.7111, device='cuda:1')
benign distance is  tensor(9.7111, device='cuda:1')
norm1 res is  tensor(0.1349, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.7242254614830017
distance 1 is tensor(150.0799, device='cuda:1')
distance 2 is tensor(10.7310, device='cuda:1')
benign distance is  tensor(10.7310, device='cuda:1')
norm1 res is  tensor(0.1523, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.49227291345596313
distance 1 is tensor(126.4269, device='cuda:1')
distance 2 is tensor(9.0872, device='cuda:1')
benign distance is  tensor(9.0872, device='cuda:1')
norm1 res is  tensor(0.1278, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.34551459550857544
distance 1 is tensor(149.0006, device='cuda:1')
distance 2 is tensor(10.6995, device='cuda:1')
benign distance is  tensor(10.6995, device='cuda:1')
norm1 res is  tensor(0.1515, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.5046623349189758
distance 1 is tensor(167.2658, device='cuda:1')
distance 2 is tensor(11.9049, device='cuda:1')
benign distance is  tensor(11.9049, device='cuda:1')
norm1 res is  tensor(0.1698, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.17931415140628815
distance 1 is tensor(158.8146, device='cuda:1')
distance 2 is tensor(11.5650, device='cuda:1')
benign distance is  tensor(11.5650, device='cuda:1')
norm1 res is  tensor(0.1630, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.44968539476394653
distance 1 is tensor(177.5357, device='cuda:1')
distance 2 is tensor(12.6612, device='cuda:1')
benign distance is  tensor(12.6612, device='cuda:1')
norm1 res is  tensor(0.1797, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.8311644792556763
distance 1 is tensor(182.0692, device='cuda:1')
distance 2 is tensor(13.0898, device='cuda:1')
benign distance is  tensor(13.0898, device='cuda:1')
norm1 res is  tensor(0.1842, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.6258190870285034
distance 1 is tensor(153.8674, device='cuda:1')
distance 2 is tensor(11.1411, device='cuda:1')
benign distance is  tensor(11.1411, device='cuda:1')
norm1 res is  tensor(0.1563, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.4761579632759094
distance 1 is tensor(165.4597, device='cuda:1')
distance 2 is tensor(11.9016, device='cuda:1')
benign distance is  tensor(11.9016, device='cuda:1')
norm1 res is  tensor(0.1691, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.570344865322113
distance 1 is tensor(145.4615, device='cuda:1')
distance 2 is tensor(10.6386, device='cuda:1')
benign distance is  tensor(10.6386, device='cuda:1')
norm1 res is  tensor(0.1484, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  1.1277329921722412
distance 1 is tensor(159.2304, device='cuda:1')
distance 2 is tensor(11.4776, device='cuda:1')
benign distance is  tensor(11.4776, device='cuda:1')
norm1 res is  tensor(0.1600, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(189.4715, device='cuda:1')
distance 2 is tensor(13.4398, device='cuda:1')
compute distance is  tensor(13.4398, device='cuda:1')
compute norm is  tensor(53.5811, device='cuda:1')
distance 1 is tensor(231.5134, device='cuda:1')
distance 2 is tensor(16.2862, device='cuda:1')
compute distance is  tensor(16.2862, device='cuda:1')
compute norm is  tensor(54.6439, device='cuda:1')
distance 1 is tensor(207.1138, device='cuda:1')
distance 2 is tensor(14.5664, device='cuda:1')
compute distance is  tensor(14.5664, device='cuda:1')
compute norm is  tensor(54.0596, device='cuda:1')
distance 1 is tensor(198.8015, device='cuda:1')
distance 2 is tensor(13.8682, device='cuda:1')
compute distance is  tensor(13.8682, device='cuda:1')
compute norm is  tensor(53.8012, device='cuda:1')
distance 1 is tensor(215.9633, device='cuda:1')
distance 2 is tensor(15.3584, device='cuda:1')
compute distance is  tensor(15.3584, device='cuda:1')
compute norm is  tensor(54.6575, device='cuda:1')
distance 1 is tensor(214.9071, device='cuda:1')
distance 2 is tensor(15.3925, device='cuda:1')
compute distance is  tensor(15.3925, device='cuda:1')
compute norm is  tensor(54.4195, device='cuda:1')
distance 1 is tensor(213.2992, device='cuda:1')
distance 2 is tensor(15.0642, device='cuda:1')
compute distance is  tensor(15.0642, device='cuda:1')
compute norm is  tensor(54.2826, device='cuda:1')
distance 1 is tensor(202.9023, device='cuda:1')
distance 2 is tensor(14.4885, device='cuda:1')
compute distance is  tensor(14.4885, device='cuda:1')
compute norm is  tensor(54.0027, device='cuda:1')
distance 1 is tensor(227.0039, device='cuda:1')
distance 2 is tensor(16.0288, device='cuda:1')
compute distance is  tensor(16.0288, device='cuda:1')
compute norm is  tensor(54.5665, device='cuda:1')
distance 1 is tensor(187.9678, device='cuda:1')
distance 2 is tensor(13.2045, device='cuda:1')
compute distance is  tensor(13.2045, device='cuda:1')
compute norm is  tensor(53.6468, device='cuda:1')
distance 1 is tensor(200.0985, device='cuda:1')
distance 2 is tensor(14.0554, device='cuda:1')
compute distance is  tensor(14.0554, device='cuda:1')
compute norm is  tensor(53.8777, device='cuda:1')
distance 1 is tensor(201.6854, device='cuda:1')
distance 2 is tensor(14.1552, device='cuda:1')
compute distance is  tensor(14.1552, device='cuda:1')
compute norm is  tensor(54.1005, device='cuda:1')
distance Threshold  is  tensor(16.2862, device='cuda:1')
distance 1 is tensor(1017859.0625, device='cuda:1')
distance 2 is tensor(74720.8984, device='cuda:1')
________________________________
test distance is  tensor(74720.8984, device='cuda:1')
test similarity is  tensor(0.0838, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.531731835864652e+17
test entropy is  0.0
________________________________
cal ratio is  0.013287129502123145
distance 1 is tensor(13524.4316, device='cuda:1')
distance 2 is tensor(992.8264, device='cuda:1')
cal_distance is  tensor(992.8264, device='cuda:1')
cal ratio is  0.11526980388864685
distance 1 is tensor(1558.9641, device='cuda:1')
distance 2 is tensor(114.4429, device='cuda:1')
cal_distance is  tensor(114.4429, device='cuda:1')
cal ratio is  0.3395140693046408
distance 1 is tensor(529.2944, device='cuda:1')
distance 2 is tensor(38.8550, device='cuda:1')
cal_distance is  tensor(38.8550, device='cuda:1')
cal ratio is  0.5826784079367213
distance 1 is tensor(308.4110, device='cuda:1')
distance 2 is tensor(22.6400, device='cuda:1')
cal_distance is  tensor(22.6400, device='cuda:1')
cal ratio is  0.7633336833018816
distance 1 is tensor(235.4220, device='cuda:1')
distance 2 is tensor(17.2818, device='cuda:1')
cal_distance is  tensor(17.2818, device='cuda:1')
cal ratio is  0.8736897317623301
distance 1 is tensor(205.6866, device='cuda:1')
distance 2 is tensor(15.0990, device='cuda:1')
cal_distance is  tensor(15.0990, device='cuda:1')
distance 1 is tensor(205.6866, device='cuda:1')
distance 2 is tensor(15.0990, device='cuda:1')
________________________________
test distance is  tensor(15.0990, device='cuda:1')
test similarity is  tensor(0.9227, device='cuda:1')
test acc is  0.6105000001563368
test loss is 229.02198667871926
test entropy is  0.001131279971193349
________________________________
distance 1 is tensor(205.6866, device='cuda:1')
distance 2 is tensor(15.0990, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.001159593376108214
avg test loss is  228.98220799167527
avg accuracy is  0.6097666668230035
solo acc is  0.10580000015633197
compute similarity  is  tensor(0.9227, device='cuda:1')
compute_distance is  tensor(15.0990, device='cuda:1')
compute_norm is  tensor(55.9294, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(190.2766, device='cuda:1')
distance 2 is tensor(16.3870, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0373630854112508
avg test loss is  1.6325511425288755
avg accuracy is  0.7052500001563302
solo acc is  0.26168333348967193
compute similarity  is  tensor(0.9254, device='cuda:1')
compute_distance is  tensor(16.3870, device='cuda:1')
compute_norm is  tensor(55.6921, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(191.1259, device='cuda:1')
distance 2 is tensor(16.6657, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.650389666115043
avg test loss is  2.511422743675297
avg accuracy is  0.6423333334896676
solo acc is  0.11475000015633194
compute similarity  is  tensor(0.9250, device='cuda:1')
compute_distance is  tensor(16.6657, device='cuda:1')
compute_norm is  tensor(55.5117, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(191.4881, device='cuda:1')
distance 2 is tensor(16.6122, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9739487247426373
avg test loss is  1.5598284314944546
avg accuracy is  0.7115000001563299
solo acc is  0.2633666668230053
compute similarity  is  tensor(0.9251, device='cuda:1')
compute_distance is  tensor(16.6122, device='cuda:1')
compute_norm is  tensor(55.1637, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(191.4881, device='cuda:1')
distance 2 is tensor(16.6122, device='cuda:1')
________________________________
test distance is  tensor(16.6122, device='cuda:1')
test similarity is  tensor(0.9251, device='cuda:1')
test acc is  0.7094166668229968
test loss is 1.562219662198634
test entropy is  0.9760501178215816
________________________________
cal ratio is  0.8911249062811933
distance 1 is tensor(170.6405, device='cuda:1')
distance 2 is tensor(14.8035, device='cuda:1')
cal_distance is  tensor(14.8035, device='cuda:1')
distance 1 is tensor(170.6405, device='cuda:1')
distance 2 is tensor(14.8035, device='cuda:1')
________________________________
test distance is  tensor(14.8035, device='cuda:1')
test similarity is  tensor(0.9389, device='cuda:1')
test acc is  0.7398833334896616
test loss is 1.33379638125139
test entropy is  1.1464333323273324
________________________________
distance 1 is tensor(170.6405, device='cuda:1')
distance 2 is tensor(14.8035, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1468820020334045
avg test loss is  1.331143530192914
avg accuracy is  0.739566666822995
solo acc is  0.35870000015634057
compute similarity  is  tensor(0.9389, device='cuda:1')
compute_distance is  tensor(14.8035, device='cuda:1')
compute_norm is  tensor(54.5653, device='cuda:1')
++++++++++++++++++++
restore alpha
distance 1 is tensor(172.2975, device='cuda:1')
distance 2 is tensor(15.1691, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6239927182319576
avg test loss is  2.430300829634229
avg accuracy is  0.6759166668229988
solo acc is  0.11211666682299862
compute similarity  is  tensor(0.9383, device='cuda:1')
compute_distance is  tensor(15.1691, device='cuda:1')
compute_norm is  tensor(54.3991, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(173.0017, device='cuda:1')
distance 2 is tensor(15.1115, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9559634141703405
avg test loss is  1.4747531084872003
avg accuracy is  0.7432500001563281
solo acc is  0.27430000015633893
compute similarity  is  tensor(0.9383, device='cuda:1')
compute_distance is  tensor(15.1115, device='cuda:1')
compute_norm is  tensor(54.0504, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(173.0017, device='cuda:1')
distance 2 is tensor(15.1115, device='cuda:1')
________________________________
test distance is  tensor(15.1115, device='cuda:1')
test similarity is  tensor(0.9383, device='cuda:1')
test acc is  0.7425666668229948
test loss is 1.4742749691772055
test entropy is  0.95511000344494
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.381524682044983
mal norm is  tensor(8.8602, device='cuda:1')
distance 1 is tensor(173.0017, device='cuda:1')
distance 2 is tensor(15.1115, device='cuda:1')
mal distance is  tensor(15.1115, device='cuda:1')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.2029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.7928, device='cuda:1')
c is  tensor(0.0186, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5260e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.8796, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7336, device='cuda:1')
c is  tensor(0.0182, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.3073, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(538.4943, device='cuda:1')
c is  tensor(0.0194, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.8191, device='cuda:1')
c is  tensor(0.0185, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.9572, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.3275e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.1929, device='cuda:1')
c is  tensor(0.0184, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.3359e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0231, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.4189, device='cuda:1')
c is  tensor(0.0164, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2725, device='cuda:1')
c is  tensor(0.0162, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(799.6760, device='cuda:1')
c is  tensor(0.0159, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.8585, device='cuda:1')
c is  tensor(0.0162, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.9658, device='cuda:1')
c is  tensor(0.0161, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.4844, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6449e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(812.1650, device='cuda:1')
c is  tensor(0.0158, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.9511e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.7185, device='cuda:1')
c is  tensor(0.0164, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.3007, device='cuda:1')
c is  tensor(0.0168, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.3184, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.9508e-06, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.4866, device='cuda:1')
c is  tensor(0.0178, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.3608, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.3680, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6962e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.7134, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.4633, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.3261, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
len accept list 14
len all weights is 14
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 92.00% 

Test Accuracy: 89.77% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2222365140914917
distance 1 is tensor(93.8348, device='cuda:1')
distance 2 is tensor(6.9338, device='cuda:1')
benign distance is  tensor(6.9338, device='cuda:1')
norm1 res is  tensor(0.0994, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.564111053943634
distance 1 is tensor(123.4688, device='cuda:1')
distance 2 is tensor(8.8573, device='cuda:1')
benign distance is  tensor(8.8573, device='cuda:1')
norm1 res is  tensor(0.1305, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.1511731892824173
distance 1 is tensor(108.6711, device='cuda:1')
distance 2 is tensor(7.6650, device='cuda:1')
benign distance is  tensor(7.6650, device='cuda:1')
norm1 res is  tensor(0.1083, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.5114735960960388
distance 1 is tensor(137.0577, device='cuda:1')
distance 2 is tensor(9.8021, device='cuda:1')
benign distance is  tensor(9.8021, device='cuda:1')
norm1 res is  tensor(0.1417, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.26537203788757324
distance 1 is tensor(120.3831, device='cuda:1')
distance 2 is tensor(8.6710, device='cuda:1')
benign distance is  tensor(8.6710, device='cuda:1')
norm1 res is  tensor(0.1255, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.554975152015686
distance 1 is tensor(139.2276, device='cuda:1')
distance 2 is tensor(9.9623, device='cuda:1')
benign distance is  tensor(9.9623, device='cuda:1')
norm1 res is  tensor(0.1453, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.3085046410560608
distance 1 is tensor(136.5266, device='cuda:1')
distance 2 is tensor(9.7882, device='cuda:1')
benign distance is  tensor(9.7882, device='cuda:1')
norm1 res is  tensor(0.1423, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.4381597936153412
distance 1 is tensor(136.8514, device='cuda:1')
distance 2 is tensor(9.8775, device='cuda:1')
benign distance is  tensor(9.8775, device='cuda:1')
norm1 res is  tensor(0.1436, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.27439719438552856
distance 1 is tensor(128.7559, device='cuda:1')
distance 2 is tensor(9.2755, device='cuda:1')
benign distance is  tensor(9.2755, device='cuda:1')
norm1 res is  tensor(0.1340, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.6272605061531067
distance 1 is tensor(148.4523, device='cuda:1')
distance 2 is tensor(10.7543, device='cuda:1')
benign distance is  tensor(10.7543, device='cuda:1')
norm1 res is  tensor(0.1563, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.21916183829307556
distance 1 is tensor(145.2653, device='cuda:1')
distance 2 is tensor(10.4683, device='cuda:1')
benign distance is  tensor(10.4683, device='cuda:1')
norm1 res is  tensor(0.1485, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.24611243605613708
distance 1 is tensor(126.8773, device='cuda:1')
distance 2 is tensor(9.2420, device='cuda:1')
benign distance is  tensor(9.2420, device='cuda:1')
norm1 res is  tensor(0.1348, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.4927698075771332
distance 1 is tensor(147.2116, device='cuda:1')
distance 2 is tensor(10.6829, device='cuda:1')
benign distance is  tensor(10.6829, device='cuda:1')
norm1 res is  tensor(0.1525, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  1.0920015573501587
distance 1 is tensor(126.0334, device='cuda:1')
distance 2 is tensor(8.9574, device='cuda:1')
benign distance is  tensor(8.9574, device='cuda:1')
norm1 res is  tensor(0.1295, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.2545788884162903
distance 1 is tensor(143.0919, device='cuda:1')
distance 2 is tensor(10.2315, device='cuda:1')
benign distance is  tensor(10.2315, device='cuda:1')
norm1 res is  tensor(0.1489, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  0.47820430994033813
distance 1 is tensor(137.1107, device='cuda:1')
distance 2 is tensor(9.8729, device='cuda:1')
benign distance is  tensor(9.8729, device='cuda:1')
norm1 res is  tensor(0.1440, device='cuda:1')
current submit client idx and staleness is  32 5
 benign loss is  0.5052613019943237
distance 1 is tensor(141.2032, device='cuda:1')
distance 2 is tensor(10.0042, device='cuda:1')
benign distance is  tensor(10.0042, device='cuda:1')
norm1 res is  tensor(0.1456, device='cuda:1')
current submit client idx and staleness is  33 5
 benign loss is  0.15380260348320007
distance 1 is tensor(155.6846, device='cuda:1')
distance 2 is tensor(11.1327, device='cuda:1')
benign distance is  tensor(11.1327, device='cuda:1')
norm1 res is  tensor(0.1611, device='cuda:1')
current submit client idx and staleness is  34 5
 benign loss is  0.5425164103507996
distance 1 is tensor(150.5230, device='cuda:1')
distance 2 is tensor(10.7861, device='cuda:1')
benign distance is  tensor(10.7861, device='cuda:1')
norm1 res is  tensor(0.1552, device='cuda:1')
current submit client idx and staleness is  35 5
 benign loss is  0.10798674821853638
distance 1 is tensor(132.7480, device='cuda:1')
distance 2 is tensor(9.5412, device='cuda:1')
benign distance is  tensor(9.5412, device='cuda:1')
norm1 res is  tensor(0.1377, device='cuda:1')
current submit client idx and staleness is  36 5
 benign loss is  0.7076415419578552
distance 1 is tensor(149.8960, device='cuda:1')
distance 2 is tensor(10.7181, device='cuda:1')
benign distance is  tensor(10.7181, device='cuda:1')
norm1 res is  tensor(0.1541, device='cuda:1')
current submit client idx and staleness is  37 5
 benign loss is  0.5038703083992004
distance 1 is tensor(142.0450, device='cuda:1')
distance 2 is tensor(10.1901, device='cuda:1')
benign distance is  tensor(10.1901, device='cuda:1')
norm1 res is  tensor(0.1459, device='cuda:1')
current submit client idx and staleness is  38 5
 benign loss is  0.5252991914749146
distance 1 is tensor(149.0003, device='cuda:1')
distance 2 is tensor(10.7098, device='cuda:1')
benign distance is  tensor(10.7098, device='cuda:1')
norm1 res is  tensor(0.1535, device='cuda:1')
current submit client idx and staleness is  39 5
 benign loss is  0.6073373556137085
distance 1 is tensor(134.3727, device='cuda:1')
distance 2 is tensor(9.5555, device='cuda:1')
benign distance is  tensor(9.5555, device='cuda:1')
norm1 res is  tensor(0.1351, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(154.1771, device='cuda:1')
distance 2 is tensor(11.3546, device='cuda:1')
compute distance is  tensor(11.3546, device='cuda:1')
compute norm is  tensor(53.7224, device='cuda:1')
distance 1 is tensor(149.1491, device='cuda:1')
distance 2 is tensor(10.7926, device='cuda:1')
compute distance is  tensor(10.7926, device='cuda:1')
compute norm is  tensor(53.5430, device='cuda:1')
distance 1 is tensor(171.9902, device='cuda:1')
distance 2 is tensor(12.5002, device='cuda:1')
compute distance is  tensor(12.5002, device='cuda:1')
compute norm is  tensor(54.0023, device='cuda:1')
distance 1 is tensor(150.0647, device='cuda:1')
distance 2 is tensor(11.0825, device='cuda:1')
compute distance is  tensor(11.0825, device='cuda:1')
compute norm is  tensor(53.5747, device='cuda:1')
distance 1 is tensor(166.3204, device='cuda:1')
distance 2 is tensor(12.0623, device='cuda:1')
compute distance is  tensor(12.0623, device='cuda:1')
compute norm is  tensor(54.0369, device='cuda:1')
distance 1 is tensor(169.7252, device='cuda:1')
distance 2 is tensor(12.1557, device='cuda:1')
compute distance is  tensor(12.1557, device='cuda:1')
compute norm is  tensor(53.9996, device='cuda:1')
distance 1 is tensor(155.9541, device='cuda:1')
distance 2 is tensor(11.2526, device='cuda:1')
compute distance is  tensor(11.2526, device='cuda:1')
compute norm is  tensor(53.7591, device='cuda:1')
distance 1 is tensor(160.4012, device='cuda:1')
distance 2 is tensor(11.5515, device='cuda:1')
compute distance is  tensor(11.5515, device='cuda:1')
compute norm is  tensor(53.8390, device='cuda:1')
distance 1 is tensor(162.7305, device='cuda:1')
distance 2 is tensor(11.8881, device='cuda:1')
compute distance is  tensor(11.8881, device='cuda:1')
compute norm is  tensor(54.0436, device='cuda:1')
distance 1 is tensor(153.2882, device='cuda:1')
distance 2 is tensor(11.0154, device='cuda:1')
compute distance is  tensor(11.0154, device='cuda:1')
compute norm is  tensor(53.7374, device='cuda:1')
distance 1 is tensor(173.6049, device='cuda:1')
distance 2 is tensor(12.4601, device='cuda:1')
compute distance is  tensor(12.4601, device='cuda:1')
compute norm is  tensor(54.1652, device='cuda:1')
distance 1 is tensor(169.2361, device='cuda:1')
distance 2 is tensor(12.3868, device='cuda:1')
compute distance is  tensor(12.3868, device='cuda:1')
compute norm is  tensor(54.2053, device='cuda:1')
distance Threshold  is  tensor(12.5002, device='cuda:1')
distance 1 is tensor(1017883.6250, device='cuda:1')
distance 2 is tensor(74723.0625, device='cuda:1')
________________________________
test distance is  tensor(74723.0625, device='cuda:1')
test similarity is  tensor(0.0027, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.54089243003205e+17
test entropy is  0.0
________________________________
cal ratio is  0.011640546693384483
distance 1 is tensor(11848.7285, device='cuda:1')
distance 2 is tensor(869.8174, device='cuda:1')
cal_distance is  tensor(869.8174, device='cuda:1')
cal ratio is  0.10789136036774871
distance 1 is tensor(1278.3807, device='cuda:1')
distance 2 is tensor(93.8458, device='cuda:1')
cal_distance is  tensor(93.8458, device='cuda:1')
cal ratio is  0.32846820865586857
distance 1 is tensor(419.9117, device='cuda:1')
distance 2 is tensor(30.8254, device='cuda:1')
cal_distance is  tensor(30.8254, device='cuda:1')
cal ratio is  0.5731214743893674
distance 1 is tensor(240.6631, device='cuda:1')
distance 2 is tensor(17.6667, device='cuda:1')
cal_distance is  tensor(17.6667, device='cuda:1')
cal ratio is  0.7570478703236277
distance 1 is tensor(182.1950, device='cuda:1')
distance 2 is tensor(13.3745, device='cuda:1')
cal_distance is  tensor(13.3745, device='cuda:1')
cal ratio is  0.8700849492429775
distance 1 is tensor(158.5260, device='cuda:1')
distance 2 is tensor(11.6370, device='cuda:1')
cal_distance is  tensor(11.6370, device='cuda:1')
distance 1 is tensor(158.5260, device='cuda:1')
distance 2 is tensor(11.6370, device='cuda:1')
________________________________
test distance is  tensor(11.6370, device='cuda:1')
test similarity is  tensor(0.9481, device='cuda:1')
test acc is  0.8046500001563252
test loss is 80.26289651541313
test entropy is  0.013448642966464915
________________________________
distance 1 is tensor(158.5260, device='cuda:1')
distance 2 is tensor(11.6370, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.013494139637643615
avg test loss is  80.44337463785591
avg accuracy is  0.8031000001563253
solo acc is  0.1828666668230021
compute similarity  is  tensor(0.9481, device='cuda:1')
compute_distance is  tensor(11.6370, device='cuda:1')
compute_norm is  tensor(53.9057, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(148.9453, device='cuda:1')
distance 2 is tensor(12.8550, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9658761522663173
avg test loss is  1.5231363084524678
avg accuracy is  0.8272166668229909
solo acc is  0.3011666668230062
compute similarity  is  tensor(0.9492, device='cuda:1')
compute_distance is  tensor(12.8550, device='cuda:1')
compute_norm is  tensor(53.1562, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.2128, device='cuda:1')
distance 2 is tensor(13.0869, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.921248013848689
avg test loss is  1.5918945146522034
avg accuracy is  0.8238500001563243
solo acc is  0.24821666682300486
compute similarity  is  tensor(0.9489, device='cuda:1')
compute_distance is  tensor(13.0869, device='cuda:1')
compute_norm is  tensor(52.8661, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.3740, device='cuda:1')
distance 2 is tensor(13.2533, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9200176536909807
avg test loss is  1.5554156308489313
avg accuracy is  0.8229833334896577
solo acc is  0.2456833334896715
compute similarity  is  tensor(0.9487, device='cuda:1')
compute_distance is  tensor(13.2533, device='cuda:1')
compute_norm is  tensor(52.5867, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.5789, device='cuda:1')
distance 2 is tensor(13.3885, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.9007211286884381
avg test loss is  1.5398208975537753
avg accuracy is  0.8244000001563243
solo acc is  0.2424666668230047
compute similarity  is  tensor(0.9486, device='cuda:1')
compute_distance is  tensor(13.3885, device='cuda:1')
compute_norm is  tensor(52.3158, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.8515, device='cuda:1')
distance 2 is tensor(13.5176, device='cuda:1')
________________________________
test distance is  tensor(13.5176, device='cuda:1')
test similarity is  tensor(0.9484, device='cuda:1')
test acc is  0.8274000001563242
test loss is 1.510289540295916
test entropy is  0.8905109296094126
________________________________
cal ratio is  0.865468148711492
distance 1 is tensor(133.1544, device='cuda:1')
distance 2 is tensor(11.6990, device='cuda:1')
cal_distance is  tensor(11.6990, device='cuda:1')
distance 1 is tensor(133.1544, device='cuda:1')
distance 2 is tensor(11.6990, device='cuda:1')
________________________________
test distance is  tensor(11.6990, device='cuda:1')
test similarity is  tensor(0.9610, device='cuda:1')
test acc is  0.8488000001563234
test loss is 1.1001183881180119
test entropy is  1.0549134193325855
________________________________
distance 1 is tensor(133.1544, device='cuda:1')
distance 2 is tensor(11.6990, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0552662960501875
avg test loss is  1.0996010842989248
avg accuracy is  0.8469166668229902
solo acc is  0.49105000015634204
compute similarity  is  tensor(0.9610, device='cuda:1')
compute_distance is  tensor(11.6990, device='cuda:1')
compute_norm is  tensor(51.8347, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.8130, device='cuda:1')
distance 2 is tensor(12.0273, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8906571399936798
avg test loss is  1.481104829163948
avg accuracy is  0.8395666668229905
solo acc is  0.25120000015633837
compute similarity  is  tensor(0.9604, device='cuda:1')
compute_distance is  tensor(12.0273, device='cuda:1')
compute_norm is  tensor(51.5741, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.6745, device='cuda:1')
distance 2 is tensor(12.1981, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.881267067465955
avg test loss is  1.4752750532713526
avg accuracy is  0.839233333489657
solo acc is  0.24023333348967132
compute similarity  is  tensor(0.9601, device='cuda:1')
compute_distance is  tensor(12.1981, device='cuda:1')
compute_norm is  tensor(51.3101, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.3395, device='cuda:1')
distance 2 is tensor(12.3435, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8770306191718908
avg test loss is  1.4526978590086834
avg accuracy is  0.8410000001563236
solo acc is  0.24720000015633817
compute similarity  is  tensor(0.9599, device='cuda:1')
compute_distance is  tensor(12.3435, device='cuda:1')
compute_norm is  tensor(51.0525, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.9752, device='cuda:1')
distance 2 is tensor(12.4773, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8750614327535446
avg test loss is  1.445265708701697
avg accuracy is  0.8414333334896569
solo acc is  0.2376833334896712
compute similarity  is  tensor(0.9597, device='cuda:1')
compute_distance is  tensor(12.4773, device='cuda:1')
compute_norm is  tensor(50.7993, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.6311, device='cuda:1')
distance 2 is tensor(12.6087, device='cuda:1')
________________________________
test distance is  tensor(12.6087, device='cuda:1')
test similarity is  tensor(0.9595, device='cuda:1')
test acc is  0.8408666668229903
test loss is 1.4377703000741726
test entropy is  0.8617738323933535
________________________________
cal ratio is  0.8961176312830456
distance 1 is tensor(127.8148, device='cuda:1')
distance 2 is tensor(11.2989, device='cuda:1')
cal_distance is  tensor(11.2989, device='cuda:1')
distance 1 is tensor(127.8148, device='cuda:1')
distance 2 is tensor(11.2989, device='cuda:1')
________________________________
test distance is  tensor(11.2989, device='cuda:1')
test similarity is  tensor(0.9674, device='cuda:1')
test acc is  0.8568500001563231
test loss is 1.100962409332617
test entropy is  1.0061525136295921
________________________________
distance 1 is tensor(127.8148, device='cuda:1')
distance 2 is tensor(11.2989, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0052742991747379
avg test loss is  1.1024947731352563
avg accuracy is  0.8560833334896563
solo acc is  0.45470000015634165
compute similarity  is  tensor(0.9674, device='cuda:1')
compute_distance is  tensor(11.2989, device='cuda:1')
compute_norm is  tensor(50.5625, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.6309, device='cuda:1')
distance 2 is tensor(11.5984, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8639281453100095
avg test loss is  1.420542941545881
avg accuracy is  0.8486500001563233
solo acc is  0.24683333348967154
compute similarity  is  tensor(0.9668, device='cuda:1')
compute_distance is  tensor(11.5984, device='cuda:1')
compute_norm is  tensor(50.3197, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.6452, device='cuda:1')
distance 2 is tensor(11.7632, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8557648567248509
avg test loss is  1.4127075081186762
avg accuracy is  0.8516666668229899
solo acc is  0.24028333348967132
compute similarity  is  tensor(0.9666, device='cuda:1')
compute_distance is  tensor(11.7632, device='cuda:1')
compute_norm is  tensor(50.0712, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.5193, device='cuda:1')
distance 2 is tensor(11.9076, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8592451062919234
avg test loss is  1.3978838028429923
avg accuracy is  0.8520333334896566
solo acc is  0.24151666682300463
compute similarity  is  tensor(0.9663, device='cuda:1')
compute_distance is  tensor(11.9076, device='cuda:1')
compute_norm is  tensor(49.8259, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.3774, device='cuda:1')
distance 2 is tensor(12.0474, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8467822754815189
avg test loss is  1.3915792964796014
avg accuracy is  0.8550166668229897
solo acc is  0.24025000015633796
compute similarity  is  tensor(0.9661, device='cuda:1')
compute_distance is  tensor(12.0474, device='cuda:1')
compute_norm is  tensor(49.5842, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.1926, device='cuda:1')
distance 2 is tensor(12.1819, device='cuda:1')
________________________________
test distance is  tensor(12.1819, device='cuda:1')
test similarity is  tensor(0.9659, device='cuda:1')
test acc is  0.8540500001563233
test loss is 1.3832033057965196
test entropy is  0.8492184620676264
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.5000000005
mal loss is 1.0540815591812134
mal norm is  tensor(6.1884, device='cuda:1')
distance 1 is tensor(138.1926, device='cuda:1')
distance 2 is tensor(12.1819, device='cuda:1')
mal distance is  tensor(12.1819, device='cuda:1')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2453, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(386.4107, device='cuda:1')
c is  tensor(0.0252, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.4775, device='cuda:1')
c is  tensor(0.0220, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(429.9748, device='cuda:1')
c is  tensor(0.0239, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.7993, device='cuda:1')
c is  tensor(0.0209, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.7514, device='cuda:1')
c is  tensor(0.0224, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.1575, device='cuda:1')
c is  tensor(0.0208, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.4883, device='cuda:1')
c is  tensor(0.0211, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.8149e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.5303, device='cuda:1')
c is  tensor(0.0207, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.2178e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.8372, device='cuda:1')
c is  tensor(0.0199, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.8167e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.0129, device='cuda:1')
c is  tensor(0.0204, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(530.7229, device='cuda:1')
c is  tensor(0.0215, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.4494, device='cuda:1')
c is  tensor(0.0189, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9586e-06, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.5939, device='cuda:1')
c is  tensor(0.0202, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.9113e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.0737, device='cuda:1')
c is  tensor(0.0202, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.3146, device='cuda:1')
c is  tensor(0.0201, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.4995, device='cuda:1')
c is  tensor(0.0196, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.7865, device='cuda:1')
c is  tensor(0.0194, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.7488, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.6133, device='cuda:1')
c is  tensor(0.0191, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.5367, device='cuda:1')
c is  tensor(0.0184, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.5400, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.3687, device='cuda:1')
c is  tensor(0.0193, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.5244, device='cuda:1')
c is  tensor(0.0188, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.5303, device='cuda:1')
c is  tensor(0.0198, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.6661, device='cuda:1')
c is  tensor(0.0192, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0010, device='cuda:1')
len accept list 18
len all weights is 18
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 87.63% 

Test Accuracy: 85.78% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
 benign loss is  0.9258705377578735
distance 1 is tensor(152.9458, device='cuda:1')
distance 2 is tensor(11.1496, device='cuda:1')
benign distance is  tensor(11.1496, device='cuda:1')
norm1 res is  tensor(0.1536, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  1.4046719074249268
distance 1 is tensor(179.0915, device='cuda:1')
distance 2 is tensor(13.1443, device='cuda:1')
benign distance is  tensor(13.1443, device='cuda:1')
norm1 res is  tensor(0.1811, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.09290890395641327
distance 1 is tensor(157.1415, device='cuda:1')
distance 2 is tensor(11.4256, device='cuda:1')
benign distance is  tensor(11.4256, device='cuda:1')
norm1 res is  tensor(0.1604, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.657629668712616
distance 1 is tensor(179.4978, device='cuda:1')
distance 2 is tensor(12.8249, device='cuda:1')
benign distance is  tensor(12.8249, device='cuda:1')
norm1 res is  tensor(0.1776, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  1.3174560070037842
distance 1 is tensor(160.2561, device='cuda:1')
distance 2 is tensor(11.6535, device='cuda:1')
benign distance is  tensor(11.6535, device='cuda:1')
norm1 res is  tensor(0.1612, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  1.5487805604934692
distance 1 is tensor(168.7431, device='cuda:1')
distance 2 is tensor(12.3153, device='cuda:1')
benign distance is  tensor(12.3153, device='cuda:1')
norm1 res is  tensor(0.1728, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.8205612897872925
distance 1 is tensor(163.1836, device='cuda:1')
distance 2 is tensor(11.7700, device='cuda:1')
benign distance is  tensor(11.7700, device='cuda:1')
norm1 res is  tensor(0.1613, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.287895143032074
distance 1 is tensor(156.7717, device='cuda:1')
distance 2 is tensor(11.6166, device='cuda:1')
benign distance is  tensor(11.6166, device='cuda:1')
norm1 res is  tensor(0.1578, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  1.2605520486831665
distance 1 is tensor(172.4791, device='cuda:1')
distance 2 is tensor(12.5291, device='cuda:1')
benign distance is  tensor(12.5291, device='cuda:1')
norm1 res is  tensor(0.1759, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.7360444068908691
distance 1 is tensor(156.7283, device='cuda:1')
distance 2 is tensor(11.4641, device='cuda:1')
benign distance is  tensor(11.4641, device='cuda:1')
norm1 res is  tensor(0.1584, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.34528398513793945
distance 1 is tensor(174.8511, device='cuda:1')
distance 2 is tensor(12.6493, device='cuda:1')
benign distance is  tensor(12.6493, device='cuda:1')
norm1 res is  tensor(0.1742, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.3570220172405243
distance 1 is tensor(172.9933, device='cuda:1')
distance 2 is tensor(12.6282, device='cuda:1')
benign distance is  tensor(12.6282, device='cuda:1')
norm1 res is  tensor(0.1743, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.558284342288971
distance 1 is tensor(151.1602, device='cuda:1')
distance 2 is tensor(11.1574, device='cuda:1')
benign distance is  tensor(11.1574, device='cuda:1')
norm1 res is  tensor(0.1526, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.1322878897190094
distance 1 is tensor(158.9463, device='cuda:1')
distance 2 is tensor(11.7009, device='cuda:1')
benign distance is  tensor(11.7009, device='cuda:1')
norm1 res is  tensor(0.1615, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.7070714831352234
distance 1 is tensor(162.8706, device='cuda:1')
distance 2 is tensor(12.0716, device='cuda:1')
benign distance is  tensor(12.0716, device='cuda:1')
norm1 res is  tensor(0.1660, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.4455869793891907
distance 1 is tensor(166.5312, device='cuda:1')
distance 2 is tensor(12.3417, device='cuda:1')
benign distance is  tensor(12.3417, device='cuda:1')
norm1 res is  tensor(0.1695, device='cuda:1')
current submit client idx and staleness is  24 4
 benign loss is  0.15870918333530426
distance 1 is tensor(185.9267, device='cuda:1')
distance 2 is tensor(13.4751, device='cuda:1')
benign distance is  tensor(13.4751, device='cuda:1')
norm1 res is  tensor(0.1861, device='cuda:1')
current submit client idx and staleness is  25 4
 benign loss is  1.0110630989074707
distance 1 is tensor(149.8353, device='cuda:1')
distance 2 is tensor(11.0048, device='cuda:1')
benign distance is  tensor(11.0048, device='cuda:1')
norm1 res is  tensor(0.1519, device='cuda:1')
current submit client idx and staleness is  26 4
 benign loss is  0.3081863522529602
distance 1 is tensor(171.6188, device='cuda:1')
distance 2 is tensor(12.5181, device='cuda:1')
benign distance is  tensor(12.5181, device='cuda:1')
norm1 res is  tensor(0.1712, device='cuda:1')
current submit client idx and staleness is  27 4
 benign loss is  0.6971832513809204
distance 1 is tensor(162.7135, device='cuda:1')
distance 2 is tensor(11.8724, device='cuda:1')
benign distance is  tensor(11.8724, device='cuda:1')
norm1 res is  tensor(0.1620, device='cuda:1')
current submit client idx and staleness is  28 4
 benign loss is  1.0751246213912964
distance 1 is tensor(167.1260, device='cuda:1')
distance 2 is tensor(12.2099, device='cuda:1')
benign distance is  tensor(12.2099, device='cuda:1')
norm1 res is  tensor(0.1688, device='cuda:1')
current submit client idx and staleness is  29 4
 benign loss is  1.0947144031524658
distance 1 is tensor(165.2220, device='cuda:1')
distance 2 is tensor(12.3050, device='cuda:1')
benign distance is  tensor(12.3050, device='cuda:1')
norm1 res is  tensor(0.1714, device='cuda:1')
current submit client idx and staleness is  30 4
 benign loss is  0.6693950891494751
distance 1 is tensor(158.5055, device='cuda:1')
distance 2 is tensor(11.7378, device='cuda:1')
benign distance is  tensor(11.7378, device='cuda:1')
norm1 res is  tensor(0.1606, device='cuda:1')
current submit client idx and staleness is  31 4
 benign loss is  0.6788458824157715
distance 1 is tensor(168.0921, device='cuda:1')
distance 2 is tensor(12.5885, device='cuda:1')
benign distance is  tensor(12.5885, device='cuda:1')
norm1 res is  tensor(0.1714, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(196.3145, device='cuda:1')
distance 2 is tensor(14.1843, device='cuda:1')
compute distance is  tensor(14.1843, device='cuda:1')
compute norm is  tensor(53.0193, device='cuda:1')
distance 1 is tensor(210.3301, device='cuda:1')
distance 2 is tensor(15.2222, device='cuda:1')
compute distance is  tensor(15.2222, device='cuda:1')
compute norm is  tensor(53.0672, device='cuda:1')
distance 1 is tensor(225.4819, device='cuda:1')
distance 2 is tensor(16.3942, device='cuda:1')
compute distance is  tensor(16.3942, device='cuda:1')
compute norm is  tensor(53.8814, device='cuda:1')
distance 1 is tensor(206.1830, device='cuda:1')
distance 2 is tensor(14.7890, device='cuda:1')
compute distance is  tensor(14.7890, device='cuda:1')
compute norm is  tensor(52.9991, device='cuda:1')
distance 1 is tensor(206.7475, device='cuda:1')
distance 2 is tensor(15.1391, device='cuda:1')
compute distance is  tensor(15.1391, device='cuda:1')
compute norm is  tensor(53.4696, device='cuda:1')
distance 1 is tensor(199.2332, device='cuda:1')
distance 2 is tensor(14.3543, device='cuda:1')
compute distance is  tensor(14.3543, device='cuda:1')
compute norm is  tensor(53.0644, device='cuda:1')
distance 1 is tensor(199.9277, device='cuda:1')
distance 2 is tensor(14.4299, device='cuda:1')
compute distance is  tensor(14.4299, device='cuda:1')
compute norm is  tensor(53.2316, device='cuda:1')
distance 1 is tensor(209.0939, device='cuda:1')
distance 2 is tensor(14.9920, device='cuda:1')
compute distance is  tensor(14.9920, device='cuda:1')
compute norm is  tensor(53.3610, device='cuda:1')
distance 1 is tensor(210.4679, device='cuda:1')
distance 2 is tensor(15.1080, device='cuda:1')
compute distance is  tensor(15.1080, device='cuda:1')
compute norm is  tensor(53.5857, device='cuda:1')
distance 1 is tensor(205.2026, device='cuda:1')
distance 2 is tensor(14.7047, device='cuda:1')
compute distance is  tensor(14.7047, device='cuda:1')
compute norm is  tensor(53.3788, device='cuda:1')
distance 1 is tensor(207.2531, device='cuda:1')
distance 2 is tensor(14.8796, device='cuda:1')
compute distance is  tensor(14.8796, device='cuda:1')
compute norm is  tensor(53.3948, device='cuda:1')
distance 1 is tensor(198.3564, device='cuda:1')
distance 2 is tensor(14.1824, device='cuda:1')
compute distance is  tensor(14.1824, device='cuda:1')
compute norm is  tensor(53.0941, device='cuda:1')
distance Threshold  is  tensor(16.3942, device='cuda:1')
distance 1 is tensor(1017837.0625, device='cuda:1')
distance 2 is tensor(74718.9844, device='cuda:1')
________________________________
test distance is  tensor(74718.9844, device='cuda:1')
test similarity is  tensor(0.1205, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.536960446265078e+17
test entropy is  0.0
________________________________
cal ratio is  0.013331297246235864
distance 1 is tensor(13569.0947, device='cuda:1')
distance 2 is tensor(996.1010, device='cuda:1')
cal_distance is  tensor(996.1010, device='cuda:1')
cal ratio is  0.11546123867355704
distance 1 is tensor(1566.7101, device='cuda:1')
distance 2 is tensor(115.0110, device='cuda:1')
cal_distance is  tensor(115.0110, device='cuda:1')
cal ratio is  0.3397958866483376
distance 1 is tensor(532.3658, device='cuda:1')
distance 2 is tensor(39.0803, device='cuda:1')
cal_distance is  tensor(39.0803, device='cuda:1')
cal ratio is  0.5829201384137184
distance 1 is tensor(310.3293, device='cuda:1')
distance 2 is tensor(22.7807, device='cuda:1')
cal_distance is  tensor(22.7807, device='cuda:1')
cal ratio is  0.7634920729073864
distance 1 is tensor(236.9354, device='cuda:1')
distance 2 is tensor(17.3929, device='cuda:1')
cal_distance is  tensor(17.3929, device='cuda:1')
cal ratio is  0.8737803528388423
distance 1 is tensor(207.0303, device='cuda:1')
distance 2 is tensor(15.1975, device='cuda:1')
cal_distance is  tensor(15.1975, device='cuda:1')
distance 1 is tensor(207.0303, device='cuda:1')
distance 2 is tensor(15.1975, device='cuda:1')
________________________________
test distance is  tensor(15.1975, device='cuda:1')
test similarity is  tensor(0.9202, device='cuda:1')
test acc is  0.1552500001563336
test loss is 386.5914844114389
test entropy is  5.752731483425142e-10
________________________________
distance 1 is tensor(207.0303, device='cuda:1')
distance 2 is tensor(15.1975, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0819471852978376e-14
avg test loss is  385.95173784918876
avg accuracy is  0.15615000015633373
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9202, device='cuda:1')
compute_distance is  tensor(15.1975, device='cuda:1')
compute_norm is  tensor(54.7580, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(187.4214, device='cuda:1')
distance 2 is tensor(15.8367, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9935973238970425
avg test loss is  1.5365908149717205
avg accuracy is  0.5677500001563404
solo acc is  0.26203333348967195
compute similarity  is  tensor(0.9251, device='cuda:1')
compute_distance is  tensor(15.8367, device='cuda:1')
compute_norm is  tensor(54.8155, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(187.4214, device='cuda:1')
distance 2 is tensor(15.8367, device='cuda:1')
________________________________
test distance is  tensor(15.8367, device='cuda:1')
test similarity is  tensor(0.9251, device='cuda:1')
test acc is  0.5679333334896737
test loss is 1.5402844375384641
test entropy is  0.9933410894387821
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3268909454345703
mal norm is  tensor(10.0627, device='cuda:1')
distance 1 is tensor(187.4214, device='cuda:1')
distance 2 is tensor(15.8367, device='cuda:1')
mal distance is  tensor(15.8367, device='cuda:1')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.2212, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.4636, device='cuda:1')
c is  tensor(0.0190, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.6941, device='cuda:1')
c is  tensor(0.0175, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.3147, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.0773, device='cuda:1')
c is  tensor(0.0178, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.7635, device='cuda:1')
c is  tensor(0.0186, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.2708, device='cuda:1')
c is  tensor(0.0180, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.5827, device='cuda:1')
c is  tensor(0.0186, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.9308, device='cuda:1')
c is  tensor(0.0188, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1006.2701, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:1')
len accept list 8
len all weights is 8
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 91.52% 

Test Accuracy: 89.30% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6671667098999023
distance 1 is tensor(110.5093, device='cuda:1')
distance 2 is tensor(8.1223, device='cuda:1')
benign distance is  tensor(8.1223, device='cuda:1')
norm1 res is  tensor(0.1154, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.2095513641834259
distance 1 is tensor(119.7194, device='cuda:1')
distance 2 is tensor(8.6528, device='cuda:1')
benign distance is  tensor(8.6528, device='cuda:1')
norm1 res is  tensor(0.1236, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.03822699561715126
distance 1 is tensor(123.8911, device='cuda:1')
distance 2 is tensor(9.0707, device='cuda:1')
benign distance is  tensor(9.0707, device='cuda:1')
norm1 res is  tensor(0.1286, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.4976012110710144
distance 1 is tensor(124.6727, device='cuda:1')
distance 2 is tensor(8.9467, device='cuda:1')
benign distance is  tensor(8.9467, device='cuda:1')
norm1 res is  tensor(0.1260, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.8737218976020813
distance 1 is tensor(133.6873, device='cuda:1')
distance 2 is tensor(9.5109, device='cuda:1')
benign distance is  tensor(9.5109, device='cuda:1')
norm1 res is  tensor(0.1367, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.5458607077598572
distance 1 is tensor(157.7336, device='cuda:1')
distance 2 is tensor(11.4962, device='cuda:1')
benign distance is  tensor(11.4962, device='cuda:1')
norm1 res is  tensor(0.1662, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.18365630507469177
distance 1 is tensor(127.5096, device='cuda:1')
distance 2 is tensor(9.0669, device='cuda:1')
benign distance is  tensor(9.0669, device='cuda:1')
norm1 res is  tensor(0.1322, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.14096853137016296
distance 1 is tensor(126.6615, device='cuda:1')
distance 2 is tensor(8.9750, device='cuda:1')
benign distance is  tensor(8.9750, device='cuda:1')
norm1 res is  tensor(0.1270, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(166.1242, device='cuda:1')
distance 2 is tensor(12.3202, device='cuda:1')
compute distance is  tensor(12.3202, device='cuda:1')
compute norm is  tensor(53.0289, device='cuda:1')
distance 1 is tensor(163.6718, device='cuda:1')
distance 2 is tensor(12.2878, device='cuda:1')
compute distance is  tensor(12.2878, device='cuda:1')
compute norm is  tensor(52.9889, device='cuda:1')
distance 1 is tensor(165.8479, device='cuda:1')
distance 2 is tensor(12.5429, device='cuda:1')
compute distance is  tensor(12.5429, device='cuda:1')
compute norm is  tensor(53.0781, device='cuda:1')
distance 1 is tensor(162.0320, device='cuda:1')
distance 2 is tensor(12.0872, device='cuda:1')
compute distance is  tensor(12.0872, device='cuda:1')
compute norm is  tensor(52.9405, device='cuda:1')
distance 1 is tensor(174.1023, device='cuda:1')
distance 2 is tensor(13.0094, device='cuda:1')
compute distance is  tensor(13.0094, device='cuda:1')
compute norm is  tensor(53.3566, device='cuda:1')
distance 1 is tensor(181.8940, device='cuda:1')
distance 2 is tensor(13.3930, device='cuda:1')
compute distance is  tensor(13.3930, device='cuda:1')
compute norm is  tensor(53.4438, device='cuda:1')
distance 1 is tensor(173.4241, device='cuda:1')
distance 2 is tensor(12.8637, device='cuda:1')
compute distance is  tensor(12.8637, device='cuda:1')
compute norm is  tensor(53.2875, device='cuda:1')
distance 1 is tensor(170.6217, device='cuda:1')
distance 2 is tensor(12.6385, device='cuda:1')
compute distance is  tensor(12.6385, device='cuda:1')
compute norm is  tensor(53.1778, device='cuda:1')
distance 1 is tensor(177.3116, device='cuda:1')
distance 2 is tensor(13.1818, device='cuda:1')
compute distance is  tensor(13.1818, device='cuda:1')
compute norm is  tensor(53.3562, device='cuda:1')
distance 1 is tensor(172.1530, device='cuda:1')
distance 2 is tensor(12.8123, device='cuda:1')
compute distance is  tensor(12.8123, device='cuda:1')
compute norm is  tensor(53.3415, device='cuda:1')
distance 1 is tensor(166.8287, device='cuda:1')
distance 2 is tensor(12.4110, device='cuda:1')
compute distance is  tensor(12.4110, device='cuda:1')
compute norm is  tensor(53.2142, device='cuda:1')
distance 1 is tensor(164.1962, device='cuda:1')
distance 2 is tensor(12.2479, device='cuda:1')
compute distance is  tensor(12.2479, device='cuda:1')
compute norm is  tensor(53.0787, device='cuda:1')
distance Threshold  is  tensor(13.3930, device='cuda:1')
distance 1 is tensor(1017854.3125, device='cuda:1')
distance 2 is tensor(74720.5859, device='cuda:1')
________________________________
test distance is  tensor(74720.5859, device='cuda:1')
test similarity is  tensor(0.0849, device='cuda:1')
test acc is  0.10000000015633198
test loss is 7.53591005404452e+17
test entropy is  0.0
________________________________
cal ratio is  0.012049288552914407
distance 1 is tensor(12264.4258, device='cuda:1')
distance 2 is tensor(900.3300, device='cuda:1')
cal_distance is  tensor(900.3300, device='cuda:1')
cal ratio is  0.10976924610273985
distance 1 is tensor(1346.2625, device='cuda:1')
distance 2 is tensor(98.8286, device='cuda:1')
cal_distance is  tensor(98.8286, device='cuda:1')
cal ratio is  0.33131439689650194
distance 1 is tensor(446.0403, device='cuda:1')
distance 2 is tensor(32.7433, device='cuda:1')
cal_distance is  tensor(32.7433, device='cuda:1')
cal ratio is  0.575599219276079
distance 1 is tensor(256.7431, device='cuda:1')
distance 2 is tensor(18.8470, device='cuda:1')
cal_distance is  tensor(18.8470, device='cuda:1')
cal ratio is  0.7586825710670436
distance 1 is tensor(194.7880, device='cuda:1')
distance 2 is tensor(14.2989, device='cuda:1')
cal_distance is  tensor(14.2989, device='cuda:1')
cal ratio is  0.8710238917098162
distance 1 is tensor(169.6658, device='cuda:1')
distance 2 is tensor(12.4547, device='cuda:1')
cal_distance is  tensor(12.4547, device='cuda:1')
distance 1 is tensor(169.6658, device='cuda:1')
distance 2 is tensor(12.4547, device='cuda:1')
________________________________
test distance is  tensor(12.4547, device='cuda:1')
test similarity is  tensor(0.9427, device='cuda:1')
test acc is  0.7484666668229946
test loss is 116.9764142636297
test entropy is  0.003470609295939229
________________________________
distance 1 is tensor(169.6658, device='cuda:1')
distance 2 is tensor(12.4547, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0035697510191211317
avg test loss is  116.83096868193734
avg accuracy is  0.7484166668229946
solo acc is  0.11450000015633194
compute similarity  is  tensor(0.9427, device='cuda:1')
compute_distance is  tensor(12.4547, device='cuda:1')
compute_norm is  tensor(53.7135, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(156.0979, device='cuda:1')
distance 2 is tensor(13.1178, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9410262385538137
avg test loss is  1.4490648063261118
avg accuracy is  0.8108000001563249
solo acc is  0.2901500001563393
compute similarity  is  tensor(0.9447, device='cuda:1')
compute_distance is  tensor(13.1178, device='cuda:1')
compute_norm is  tensor(53.2440, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.3922, device='cuda:1')
distance 2 is tensor(13.2323, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9096653643193275
avg test loss is  1.4951619937984166
avg accuracy is  0.8051666668229919
solo acc is  0.24661666682300487
compute similarity  is  tensor(0.9447, device='cuda:1')
compute_distance is  tensor(13.2323, device='cuda:1')
compute_norm is  tensor(52.9761, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.8235, device='cuda:1')
distance 2 is tensor(13.3178, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8966916005875765
avg test loss is  1.481151406063454
avg accuracy is  0.8057666668229918
solo acc is  0.24031666682300462
compute similarity  is  tensor(0.9447, device='cuda:1')
compute_distance is  tensor(13.3178, device='cuda:1')
compute_norm is  tensor(52.7136, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.3844, device='cuda:1')
distance 2 is tensor(13.3866, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8795169065756075
avg test loss is  1.4696904982585135
avg accuracy is  0.8082000001563251
solo acc is  0.24000000015633802
compute similarity  is  tensor(0.9446, device='cuda:1')
compute_distance is  tensor(13.3866, device='cuda:1')
compute_norm is  tensor(52.4535, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.0683, device='cuda:1')
distance 2 is tensor(13.4541, device='cuda:1')
________________________________
test distance is  tensor(13.4541, device='cuda:1')
test similarity is  tensor(0.9446, device='cuda:1')
test acc is  0.8064833334896584
test loss is 1.4582418325359126
test entropy is  0.8679034346456467
________________________________
cal ratio is  0.8979542877402679
distance 1 is tensor(141.9388, device='cuda:1')
distance 2 is tensor(12.0812, device='cuda:1')
cal_distance is  tensor(12.0812, device='cuda:1')
distance 1 is tensor(141.9388, device='cuda:1')
distance 2 is tensor(12.0812, device='cuda:1')
________________________________
test distance is  tensor(12.0812, device='cuda:1')
test similarity is  tensor(0.9546, device='cuda:1')
test acc is  0.8238500001563243
test loss is 1.175030132982014
test entropy is  0.9989254261130718
________________________________
distance 1 is tensor(141.9388, device='cuda:1')
distance 2 is tensor(12.0812, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.9970252212049611
avg test loss is  1.1765980160058434
avg accuracy is  0.8260333334896576
solo acc is  0.40123333348967444
compute similarity  is  tensor(0.9546, device='cuda:1')
compute_distance is  tensor(12.0812, device='cuda:1')
compute_norm is  tensor(51.8927, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.4168, device='cuda:1')
distance 2 is tensor(12.2623, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8677304284150666
avg test loss is  1.4444219237451614
avg accuracy is  0.8180333334896579
solo acc is  0.2366500001563378
compute similarity  is  tensor(0.9543, device='cuda:1')
compute_distance is  tensor(12.2623, device='cuda:1')
compute_norm is  tensor(51.6465, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.4590, device='cuda:1')
distance 2 is tensor(12.3519, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8659273471786524
avg test loss is  1.4230248942049837
avg accuracy is  0.8190500001563246
solo acc is  0.23873333348967124
compute similarity  is  tensor(0.9542, device='cuda:1')
compute_distance is  tensor(12.3519, device='cuda:1')
compute_norm is  tensor(51.3961, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.4618, device='cuda:1')
distance 2 is tensor(12.4363, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8618458580614915
avg test loss is  1.4121190978011597
avg accuracy is  0.8175833334896581
solo acc is  0.23816666682300458
compute similarity  is  tensor(0.9542, device='cuda:1')
compute_distance is  tensor(12.4363, device='cuda:1')
compute_norm is  tensor(51.1481, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.5396, device='cuda:1')
distance 2 is tensor(12.5196, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8497948654806182
avg test loss is  1.4187637032476315
avg accuracy is  0.8183333334896579
solo acc is  0.22943333348967096
compute similarity  is  tensor(0.9541, device='cuda:1')
compute_distance is  tensor(12.5196, device='cuda:1')
compute_norm is  tensor(50.9040, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.5830, device='cuda:1')
distance 2 is tensor(12.5954, device='cuda:1')
________________________________
test distance is  tensor(12.5954, device='cuda:1')
test similarity is  tensor(0.9540, device='cuda:1')
test acc is  0.8179666668229912
test loss is 1.3884536240146612
test entropy is  0.8541839143741868
________________________________
distance 1 is tensor(147.5830, device='cuda:1')