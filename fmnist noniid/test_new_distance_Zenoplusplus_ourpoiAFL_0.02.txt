
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5013307332992554
distance 1 is tensor(131.0403, device='cuda:0')
distance 2 is tensor(10.0060, device='cuda:0')
benign distance is  tensor(10.0060, device='cuda:0')
norm1 res is  tensor(0.1499, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6502259373664856
distance 1 is tensor(143.1098, device='cuda:0')
distance 2 is tensor(10.7636, device='cuda:0')
benign distance is  tensor(10.7636, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.2549388110637665
distance 1 is tensor(149.7371, device='cuda:0')
distance 2 is tensor(11.2683, device='cuda:0')
benign distance is  tensor(11.2683, device='cuda:0')
norm1 res is  tensor(0.1699, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5965280532836914
distance 1 is tensor(139.4753, device='cuda:0')
distance 2 is tensor(10.5235, device='cuda:0')
benign distance is  tensor(10.5235, device='cuda:0')
norm1 res is  tensor(0.1561, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.2812094986438751
distance 1 is tensor(133.0106, device='cuda:0')
distance 2 is tensor(9.8935, device='cuda:0')
benign distance is  tensor(9.8935, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.574550449848175
distance 1 is tensor(151.3168, device='cuda:0')
distance 2 is tensor(11.4418, device='cuda:0')
benign distance is  tensor(11.4418, device='cuda:0')
norm1 res is  tensor(0.1710, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.038942284882068634
distance 1 is tensor(149.3132, device='cuda:0')
distance 2 is tensor(11.0227, device='cuda:0')
benign distance is  tensor(11.0227, device='cuda:0')
norm1 res is  tensor(0.1656, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6216427087783813
distance 1 is tensor(141.4391, device='cuda:0')
distance 2 is tensor(10.8009, device='cuda:0')
benign distance is  tensor(10.8009, device='cuda:0')
norm1 res is  tensor(0.1623, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.362687885761261
distance 1 is tensor(160.0475, device='cuda:0')
distance 2 is tensor(11.7962, device='cuda:0')
benign distance is  tensor(11.7962, device='cuda:0')
norm1 res is  tensor(0.1771, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.3914615511894226
distance 1 is tensor(142.3249, device='cuda:0')
distance 2 is tensor(10.8132, device='cuda:0')
benign distance is  tensor(10.8132, device='cuda:0')
norm1 res is  tensor(0.1598, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.34995707869529724
distance 1 is tensor(145.7345, device='cuda:0')
distance 2 is tensor(10.9458, device='cuda:0')
benign distance is  tensor(10.9458, device='cuda:0')
norm1 res is  tensor(0.1636, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.6702054738998413
distance 1 is tensor(153.4006, device='cuda:0')
distance 2 is tensor(11.5046, device='cuda:0')
benign distance is  tensor(11.5046, device='cuda:0')
norm1 res is  tensor(0.1729, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.98997962474823
distance 1 is tensor(160.4537, device='cuda:0')
distance 2 is tensor(11.8932, device='cuda:0')
benign distance is  tensor(11.8932, device='cuda:0')
norm1 res is  tensor(0.1763, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.2423561066389084
distance 1 is tensor(153.3190, device='cuda:0')
distance 2 is tensor(11.6474, device='cuda:0')
benign distance is  tensor(11.6474, device='cuda:0')
norm1 res is  tensor(0.1741, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.2599680423736572
distance 1 is tensor(153.3923, device='cuda:0')
distance 2 is tensor(11.4382, device='cuda:0')
benign distance is  tensor(11.4382, device='cuda:0')
norm1 res is  tensor(0.1745, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.5938560962677002
distance 1 is tensor(161.8432, device='cuda:0')
distance 2 is tensor(11.8890, device='cuda:0')
benign distance is  tensor(11.8890, device='cuda:0')
norm1 res is  tensor(0.1812, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.1826559603214264
distance 1 is tensor(152.2706, device='cuda:0')
distance 2 is tensor(11.3537, device='cuda:0')
benign distance is  tensor(11.3537, device='cuda:0')
norm1 res is  tensor(0.1774, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.8940709829330444
distance 1 is tensor(171.2926, device='cuda:0')
distance 2 is tensor(12.8536, device='cuda:0')
benign distance is  tensor(12.8536, device='cuda:0')
norm1 res is  tensor(0.1939, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.11320849508047104
distance 1 is tensor(165.5083, device='cuda:0')
distance 2 is tensor(12.5077, device='cuda:0')
benign distance is  tensor(12.5077, device='cuda:0')
norm1 res is  tensor(0.1854, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.5368711948394775
distance 1 is tensor(155.8304, device='cuda:0')
distance 2 is tensor(11.6774, device='cuda:0')
benign distance is  tensor(11.6774, device='cuda:0')
norm1 res is  tensor(0.1757, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.24731817841529846
distance 1 is tensor(140.4645, device='cuda:0')
distance 2 is tensor(10.5423, device='cuda:0')
benign distance is  tensor(10.5423, device='cuda:0')
norm1 res is  tensor(0.1568, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.6606076955795288
distance 1 is tensor(153.1368, device='cuda:0')
distance 2 is tensor(11.4432, device='cuda:0')
benign distance is  tensor(11.4432, device='cuda:0')
norm1 res is  tensor(0.1723, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.2684344947338104
distance 1 is tensor(156.1069, device='cuda:0')
distance 2 is tensor(11.6636, device='cuda:0')
benign distance is  tensor(11.6636, device='cuda:0')
norm1 res is  tensor(0.1771, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.721043586730957
distance 1 is tensor(148.1763, device='cuda:0')
distance 2 is tensor(11.2076, device='cuda:0')
benign distance is  tensor(11.2076, device='cuda:0')
norm1 res is  tensor(0.1653, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.04052262380719185
distance 1 is tensor(153.6229, device='cuda:0')
distance 2 is tensor(11.4022, device='cuda:0')
benign distance is  tensor(11.4022, device='cuda:0')
norm1 res is  tensor(0.1711, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.30193814635276794
distance 1 is tensor(142.4083, device='cuda:0')
distance 2 is tensor(10.5838, device='cuda:0')
benign distance is  tensor(10.5838, device='cuda:0')
norm1 res is  tensor(0.1583, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.5787631869316101
distance 1 is tensor(172.6892, device='cuda:0')
distance 2 is tensor(12.7270, device='cuda:0')
benign distance is  tensor(12.7270, device='cuda:0')
norm1 res is  tensor(0.1928, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.18743614852428436
distance 1 is tensor(161.7792, device='cuda:0')
distance 2 is tensor(12.0193, device='cuda:0')
benign distance is  tensor(12.0193, device='cuda:0')
norm1 res is  tensor(0.1812, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.5098915696144104
distance 1 is tensor(147.5015, device='cuda:0')
distance 2 is tensor(10.9134, device='cuda:0')
benign distance is  tensor(10.9134, device='cuda:0')
norm1 res is  tensor(0.1641, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.6256598830223083
distance 1 is tensor(162.9232, device='cuda:0')
distance 2 is tensor(12.0680, device='cuda:0')
benign distance is  tensor(12.0680, device='cuda:0')
norm1 res is  tensor(0.1792, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.17451319098472595
distance 1 is tensor(154.6766, device='cuda:0')
distance 2 is tensor(11.6634, device='cuda:0')
benign distance is  tensor(11.6634, device='cuda:0')
norm1 res is  tensor(0.1758, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.8698292970657349
distance 1 is tensor(144.1532, device='cuda:0')
distance 2 is tensor(10.9201, device='cuda:0')
benign distance is  tensor(10.9201, device='cuda:0')
norm1 res is  tensor(0.1657, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.8840740919113159
distance 1 is tensor(159.5568, device='cuda:0')
distance 2 is tensor(12.1721, device='cuda:0')
benign distance is  tensor(12.1721, device='cuda:0')
norm1 res is  tensor(0.1807, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.2743876576423645
distance 1 is tensor(152.1282, device='cuda:0')
distance 2 is tensor(11.3437, device='cuda:0')
benign distance is  tensor(11.3437, device='cuda:0')
norm1 res is  tensor(0.1718, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.30136579275131226
distance 1 is tensor(159.5544, device='cuda:0')
distance 2 is tensor(11.9703, device='cuda:0')
benign distance is  tensor(11.9703, device='cuda:0')
norm1 res is  tensor(0.1808, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.40017443895339966
distance 1 is tensor(148.9612, device='cuda:0')
distance 2 is tensor(11.2439, device='cuda:0')
benign distance is  tensor(11.2439, device='cuda:0')
norm1 res is  tensor(0.1671, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.3500063717365265
distance 1 is tensor(158.4161, device='cuda:0')
distance 2 is tensor(11.8691, device='cuda:0')
benign distance is  tensor(11.8691, device='cuda:0')
norm1 res is  tensor(0.1735, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.661724328994751
distance 1 is tensor(143.7581, device='cuda:0')
distance 2 is tensor(10.8634, device='cuda:0')
benign distance is  tensor(10.8634, device='cuda:0')
norm1 res is  tensor(0.1611, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.23669317364692688
distance 1 is tensor(158.1794, device='cuda:0')
distance 2 is tensor(11.9429, device='cuda:0')
benign distance is  tensor(11.9429, device='cuda:0')
norm1 res is  tensor(0.1807, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6185100078582764
distance 1 is tensor(150.7834, device='cuda:0')
distance 2 is tensor(11.2075, device='cuda:0')
benign distance is  tensor(11.2075, device='cuda:0')
norm1 res is  tensor(0.1689, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.18489184975624084
distance 1 is tensor(152.7962, device='cuda:0')
distance 2 is tensor(11.5517, device='cuda:0')
benign distance is  tensor(11.5517, device='cuda:0')
norm1 res is  tensor(0.1695, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.11166037619113922
distance 1 is tensor(154.9666, device='cuda:0')
distance 2 is tensor(11.6249, device='cuda:0')
benign distance is  tensor(11.6249, device='cuda:0')
norm1 res is  tensor(0.1734, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.16337497532367706
distance 1 is tensor(142.0160, device='cuda:0')
distance 2 is tensor(10.6430, device='cuda:0')
benign distance is  tensor(10.6430, device='cuda:0')
norm1 res is  tensor(0.1611, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.3878389000892639
distance 1 is tensor(156.7116, device='cuda:0')
distance 2 is tensor(11.7128, device='cuda:0')
benign distance is  tensor(11.7128, device='cuda:0')
norm1 res is  tensor(0.1759, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.5593801140785217
distance 1 is tensor(157.4579, device='cuda:0')
distance 2 is tensor(11.7758, device='cuda:0')
benign distance is  tensor(11.7758, device='cuda:0')
norm1 res is  tensor(0.1745, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.7607709169387817
distance 1 is tensor(164.1693, device='cuda:0')
distance 2 is tensor(12.0972, device='cuda:0')
benign distance is  tensor(12.0972, device='cuda:0')
norm1 res is  tensor(0.1794, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.32675808668136597
distance 1 is tensor(144.7358, device='cuda:0')
distance 2 is tensor(10.7484, device='cuda:0')
benign distance is  tensor(10.7484, device='cuda:0')
norm1 res is  tensor(0.1594, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.2544252574443817
distance 1 is tensor(145.1404, device='cuda:0')
distance 2 is tensor(10.9406, device='cuda:0')
benign distance is  tensor(10.9406, device='cuda:0')
norm1 res is  tensor(0.1649, device='cuda:0')
current submit client idx and staleness is  48 1
 benign loss is  0.578417956829071
distance 1 is tensor(138.7926, device='cuda:0')
distance 2 is tensor(10.5681, device='cuda:0')
benign distance is  tensor(10.5681, device='cuda:0')
norm1 res is  tensor(0.1598, device='cuda:0')
current submit client idx and staleness is  49 1
 benign loss is  0.34890854358673096
distance 1 is tensor(150.0105, device='cuda:0')
distance 2 is tensor(11.1901, device='cuda:0')
benign distance is  tensor(11.1901, device='cuda:0')
norm1 res is  tensor(0.1727, device='cuda:0')
current submit client idx and staleness is  50 1
 benign loss is  0.5246299505233765
distance 1 is tensor(155.2751, device='cuda:0')
distance 2 is tensor(11.6240, device='cuda:0')
benign distance is  tensor(11.6240, device='cuda:0')
norm1 res is  tensor(0.1742, device='cuda:0')
current submit client idx and staleness is  51 1
 benign loss is  0.4808362126350403
distance 1 is tensor(141.8377, device='cuda:0')
distance 2 is tensor(10.4509, device='cuda:0')
benign distance is  tensor(10.4509, device='cuda:0')
norm1 res is  tensor(0.1589, device='cuda:0')
current submit client idx and staleness is  52 1
 benign loss is  0.4737112522125244
distance 1 is tensor(167.8466, device='cuda:0')
distance 2 is tensor(12.5340, device='cuda:0')
benign distance is  tensor(12.5340, device='cuda:0')
norm1 res is  tensor(0.1875, device='cuda:0')
current submit client idx and staleness is  53 1
 benign loss is  0.3612968921661377
distance 1 is tensor(158.8698, device='cuda:0')
distance 2 is tensor(12.0641, device='cuda:0')
benign distance is  tensor(12.0641, device='cuda:0')
norm1 res is  tensor(0.1824, device='cuda:0')
current submit client idx and staleness is  54 1
 benign loss is  0.45971375703811646
distance 1 is tensor(163.0325, device='cuda:0')
distance 2 is tensor(12.1622, device='cuda:0')
benign distance is  tensor(12.1622, device='cuda:0')
norm1 res is  tensor(0.1847, device='cuda:0')
current submit client idx and staleness is  55 1
 benign loss is  0.24301262199878693
distance 1 is tensor(163.8967, device='cuda:0')
distance 2 is tensor(12.1042, device='cuda:0')
benign distance is  tensor(12.1042, device='cuda:0')
norm1 res is  tensor(0.1852, device='cuda:0')
current submit client idx and staleness is  56 1
 benign loss is  0.43041762709617615
distance 1 is tensor(138.3571, device='cuda:0')
distance 2 is tensor(10.3691, device='cuda:0')
benign distance is  tensor(10.3691, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  57 1
 benign loss is  0.9137839078903198
distance 1 is tensor(156.8977, device='cuda:0')
distance 2 is tensor(11.9231, device='cuda:0')
benign distance is  tensor(11.9231, device='cuda:0')
norm1 res is  tensor(0.1812, device='cuda:0')
current submit client idx and staleness is  58 1
 benign loss is  0.4479479193687439
distance 1 is tensor(150.4721, device='cuda:0')
distance 2 is tensor(11.3028, device='cuda:0')
benign distance is  tensor(11.3028, device='cuda:0')
norm1 res is  tensor(0.1695, device='cuda:0')
current submit client idx and staleness is  59 1
 benign loss is  0.27059435844421387
distance 1 is tensor(155.3568, device='cuda:0')
distance 2 is tensor(11.5594, device='cuda:0')
benign distance is  tensor(11.5594, device='cuda:0')
norm1 res is  tensor(0.1741, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.6810, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.9315, device='cuda:0')
c is  tensor(0.0340, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0142, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8837, device='cuda:0')
c is  tensor(0.0326, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0161, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1060, device='cuda:0')
c is  tensor(0.0317, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0148, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.1957, device='cuda:0')
c is  tensor(0.0331, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0150, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.0521, device='cuda:0')
c is  tensor(0.0339, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0155, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.2722, device='cuda:0')
c is  tensor(0.0317, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0120, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.3553, device='cuda:0')
c is  tensor(0.0321, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0148, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.8474, device='cuda:0')
c is  tensor(0.0326, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0137, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.4926, device='cuda:0')
c is  tensor(0.0328, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0152, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.4906, device='cuda:0')
c is  tensor(0.0319, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0082, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.8335, device='cuda:0')
c is  tensor(0.0314, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0139, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.8998, device='cuda:0')
c is  tensor(0.0331, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0097, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.5884, device='cuda:0')
c is  tensor(0.0303, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0123, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.8415, device='cuda:0')
c is  tensor(0.0307, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0176, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.4659, device='cuda:0')
c is  tensor(0.0306, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0195, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.4531, device='cuda:0')
c is  tensor(0.0305, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0126, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.9629, device='cuda:0')
c is  tensor(0.0331, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0122, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1326, device='cuda:0')
c is  tensor(0.0311, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0124, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.8248, device='cuda:0')
c is  tensor(0.0319, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0173, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.2766, device='cuda:0')
c is  tensor(0.0316, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0200, device='cuda:0')
accept
len accept list 20
len all weights is 20
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 92.59% 

Test Accuracy: 89.77% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  0.06909121572971344
distance 1 is tensor(112.6865, device='cuda:0')
distance 2 is tensor(8.2925, device='cuda:0')
benign distance is  tensor(8.2925, device='cuda:0')
norm1 res is  tensor(0.1286, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.862191379070282
distance 1 is tensor(136.3613, device='cuda:0')
distance 2 is tensor(9.8826, device='cuda:0')
benign distance is  tensor(9.8826, device='cuda:0')
norm1 res is  tensor(0.1532, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.020209159702062607
distance 1 is tensor(132.9001, device='cuda:0')
distance 2 is tensor(9.6473, device='cuda:0')
benign distance is  tensor(9.6473, device='cuda:0')
norm1 res is  tensor(0.1462, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.767398476600647
distance 1 is tensor(140.2319, device='cuda:0')
distance 2 is tensor(10.2503, device='cuda:0')
benign distance is  tensor(10.2503, device='cuda:0')
norm1 res is  tensor(0.1577, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7732849717140198
distance 1 is tensor(132.3186, device='cuda:0')
distance 2 is tensor(9.5672, device='cuda:0')
benign distance is  tensor(9.5672, device='cuda:0')
norm1 res is  tensor(0.1444, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.36155766248703003
distance 1 is tensor(149.8904, device='cuda:0')
distance 2 is tensor(10.9622, device='cuda:0')
benign distance is  tensor(10.9622, device='cuda:0')
norm1 res is  tensor(0.1669, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.17713692784309387
distance 1 is tensor(148.1878, device='cuda:0')
distance 2 is tensor(10.6574, device='cuda:0')
benign distance is  tensor(10.6574, device='cuda:0')
norm1 res is  tensor(0.1610, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5236378908157349
distance 1 is tensor(146.3455, device='cuda:0')
distance 2 is tensor(10.7700, device='cuda:0')
benign distance is  tensor(10.7700, device='cuda:0')
norm1 res is  tensor(0.1634, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.3070, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(493.6007, device='cuda:0')
c is  tensor(0.0249, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.9822, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.2835, device='cuda:0')
c is  tensor(0.0230, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.2076, device='cuda:0')
c is  tensor(0.0222, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.9996, device='cuda:0')
c is  tensor(0.0232, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.9352, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.8542, device='cuda:0')
c is  tensor(0.0220, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.0811, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.3735, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.8395, device='cuda:0')
c is  tensor(0.0221, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.2868e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.1077, device='cuda:0')
c is  tensor(0.0218, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.3744e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0979, device='cuda:0')
c is  tensor(0.0214, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.2474, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.2355, device='cuda:0')
c is  tensor(0.0212, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.4982, device='cuda:0')
c is  tensor(0.0211, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.1245, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5036e-05, device='cuda:0')
accept
len accept list 7
len all weights is 7
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 92.24% 

Test Accuracy: 89.29% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.09648074209690094
distance 1 is tensor(109.2214, device='cuda:0')
distance 2 is tensor(8.0871, device='cuda:0')
benign distance is  tensor(8.0871, device='cuda:0')
norm1 res is  tensor(0.1232, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7912651300430298
distance 1 is tensor(130.0910, device='cuda:0')
distance 2 is tensor(9.5089, device='cuda:0')
benign distance is  tensor(9.5089, device='cuda:0')
norm1 res is  tensor(0.1466, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.38955914974212646
distance 1 is tensor(135.9262, device='cuda:0')
distance 2 is tensor(9.8047, device='cuda:0')
benign distance is  tensor(9.8047, device='cuda:0')
norm1 res is  tensor(0.1513, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5003769397735596
distance 1 is tensor(135.8316, device='cuda:0')
distance 2 is tensor(9.8810, device='cuda:0')
benign distance is  tensor(9.8810, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6339941620826721
distance 1 is tensor(109.2010, device='cuda:0')
distance 2 is tensor(8.0293, device='cuda:0')
benign distance is  tensor(8.0293, device='cuda:0')
norm1 res is  tensor(0.1220, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.047725748270750046
distance 1 is tensor(146.7145, device='cuda:0')
distance 2 is tensor(10.6990, device='cuda:0')
benign distance is  tensor(10.6990, device='cuda:0')
norm1 res is  tensor(0.1666, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.2619036138057709
distance 1 is tensor(128.9414, device='cuda:0')
distance 2 is tensor(9.3718, device='cuda:0')
benign distance is  tensor(9.3718, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.1610139161348343
distance 1 is tensor(147.0388, device='cuda:0')
distance 2 is tensor(10.5936, device='cuda:0')
benign distance is  tensor(10.5936, device='cuda:0')
norm1 res is  tensor(0.1638, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.15371474623680115
distance 1 is tensor(155.2843, device='cuda:0')
distance 2 is tensor(11.2853, device='cuda:0')
benign distance is  tensor(11.2853, device='cuda:0')
norm1 res is  tensor(0.1719, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.22680246829986572
distance 1 is tensor(141.6967, device='cuda:0')
distance 2 is tensor(10.5060, device='cuda:0')
benign distance is  tensor(10.5060, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.3824121356010437
distance 1 is tensor(121.4577, device='cuda:0')
distance 2 is tensor(8.8373, device='cuda:0')
benign distance is  tensor(8.8373, device='cuda:0')
norm1 res is  tensor(0.1348, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.7745040655136108
distance 1 is tensor(136.2240, device='cuda:0')
distance 2 is tensor(9.9160, device='cuda:0')
benign distance is  tensor(9.9160, device='cuda:0')
norm1 res is  tensor(0.1488, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.6265907287597656
distance 1 is tensor(129.0218, device='cuda:0')
distance 2 is tensor(9.5926, device='cuda:0')
benign distance is  tensor(9.5926, device='cuda:0')
norm1 res is  tensor(0.1458, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.47352370619773865
distance 1 is tensor(136.4379, device='cuda:0')
distance 2 is tensor(10.0587, device='cuda:0')
benign distance is  tensor(10.0587, device='cuda:0')
norm1 res is  tensor(0.1529, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.38793593645095825
distance 1 is tensor(143.5919, device='cuda:0')
distance 2 is tensor(10.5969, device='cuda:0')
benign distance is  tensor(10.5969, device='cuda:0')
norm1 res is  tensor(0.1619, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.023161571472883224
distance 1 is tensor(133.3585, device='cuda:0')
distance 2 is tensor(9.6968, device='cuda:0')
benign distance is  tensor(9.6968, device='cuda:0')
norm1 res is  tensor(0.1491, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1807, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(486.7078, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.8877, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.7316, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.6887, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(481.1903, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.4857, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.4061, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.1962, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.4602e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.0244, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(774.0140, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(748.6157, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.6831, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.3761, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.7168, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.4102, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.5195e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.5105, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 8
len all weights is 8
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 92.25% 

Test Accuracy: 89.25% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4405779242515564
distance 1 is tensor(108.4205, device='cuda:0')
distance 2 is tensor(8.0260, device='cuda:0')
benign distance is  tensor(8.0260, device='cuda:0')
norm1 res is  tensor(0.1231, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.4808012545108795
distance 1 is tensor(130.7314, device='cuda:0')
distance 2 is tensor(9.4783, device='cuda:0')
benign distance is  tensor(9.4783, device='cuda:0')
norm1 res is  tensor(0.1462, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.23580729961395264
distance 1 is tensor(132.5121, device='cuda:0')
distance 2 is tensor(9.6936, device='cuda:0')
benign distance is  tensor(9.6936, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.1285642683506012
distance 1 is tensor(127.5892, device='cuda:0')
distance 2 is tensor(9.3107, device='cuda:0')
benign distance is  tensor(9.3107, device='cuda:0')
norm1 res is  tensor(0.1395, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7627442479133606
distance 1 is tensor(126.6799, device='cuda:0')
distance 2 is tensor(9.2037, device='cuda:0')
benign distance is  tensor(9.2037, device='cuda:0')
norm1 res is  tensor(0.1393, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.2877541780471802
distance 1 is tensor(136.7065, device='cuda:0')
distance 2 is tensor(9.9911, device='cuda:0')
benign distance is  tensor(9.9911, device='cuda:0')
norm1 res is  tensor(0.1544, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.1771952509880066
distance 1 is tensor(131.6359, device='cuda:0')
distance 2 is tensor(9.5826, device='cuda:0')
benign distance is  tensor(9.5826, device='cuda:0')
norm1 res is  tensor(0.1474, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.34638696908950806
distance 1 is tensor(131.1387, device='cuda:0')
distance 2 is tensor(9.5196, device='cuda:0')
benign distance is  tensor(9.5196, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.044742122292518616
distance 1 is tensor(138.9076, device='cuda:0')
distance 2 is tensor(10.1750, device='cuda:0')
benign distance is  tensor(10.1750, device='cuda:0')
norm1 res is  tensor(0.1568, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  1.0078294277191162
distance 1 is tensor(152.3381, device='cuda:0')
distance 2 is tensor(11.1861, device='cuda:0')
benign distance is  tensor(11.1861, device='cuda:0')
norm1 res is  tensor(0.1725, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.24642638862133026
distance 1 is tensor(137.1088, device='cuda:0')
distance 2 is tensor(10.0116, device='cuda:0')
benign distance is  tensor(10.0116, device='cuda:0')
norm1 res is  tensor(0.1498, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.483409583568573
distance 1 is tensor(138.0673, device='cuda:0')
distance 2 is tensor(10.0642, device='cuda:0')
benign distance is  tensor(10.0642, device='cuda:0')
norm1 res is  tensor(0.1531, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.6452109217643738
distance 1 is tensor(146.6449, device='cuda:0')
distance 2 is tensor(10.6656, device='cuda:0')
benign distance is  tensor(10.6656, device='cuda:0')
norm1 res is  tensor(0.1602, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.781796932220459
distance 1 is tensor(134.3355, device='cuda:0')
distance 2 is tensor(9.8050, device='cuda:0')
benign distance is  tensor(9.8050, device='cuda:0')
norm1 res is  tensor(0.1479, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.34571385383605957
distance 1 is tensor(139.8139, device='cuda:0')
distance 2 is tensor(10.1994, device='cuda:0')
benign distance is  tensor(10.1994, device='cuda:0')
norm1 res is  tensor(0.1571, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.7329576015472412
distance 1 is tensor(134.0900, device='cuda:0')
distance 2 is tensor(9.9006, device='cuda:0')
benign distance is  tensor(9.9006, device='cuda:0')
norm1 res is  tensor(0.1480, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 24
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1798, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.6309, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.4338, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.4326e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.1864, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.2094, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.2352e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.9116, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.4021, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.8907, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.3210, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(707.3723, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.3385, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(784.7149, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.9552e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.6296, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.0043e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.5687, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.8046, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.5331e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6396, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.4934e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.3938, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.6074e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.3748, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.6977, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.12418589740991592
distance 1 is tensor(143.6607, device='cuda:0')
distance 2 is tensor(10.7614, device='cuda:0')
benign distance is  tensor(10.7614, device='cuda:0')
norm1 res is  tensor(0.1640, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.43929219245910645
distance 1 is tensor(138.4230, device='cuda:0')
distance 2 is tensor(10.3974, device='cuda:0')
benign distance is  tensor(10.3974, device='cuda:0')
norm1 res is  tensor(0.1587, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.19991835951805115
distance 1 is tensor(154.0093, device='cuda:0')
distance 2 is tensor(11.5115, device='cuda:0')
benign distance is  tensor(11.5115, device='cuda:0')
norm1 res is  tensor(0.1716, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.7788828015327454
distance 1 is tensor(149.1328, device='cuda:0')
distance 2 is tensor(11.1775, device='cuda:0')
benign distance is  tensor(11.1775, device='cuda:0')
norm1 res is  tensor(0.1683, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9576736688613892
distance 1 is tensor(132.0255, device='cuda:0')
distance 2 is tensor(9.9591, device='cuda:0')
benign distance is  tensor(9.9591, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.4085538387298584
distance 1 is tensor(154.0473, device='cuda:0')
distance 2 is tensor(11.5360, device='cuda:0')
benign distance is  tensor(11.5360, device='cuda:0')
norm1 res is  tensor(0.1749, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.5806844830513
distance 1 is tensor(147.4101, device='cuda:0')
distance 2 is tensor(11.0597, device='cuda:0')
benign distance is  tensor(11.0597, device='cuda:0')
norm1 res is  tensor(0.1672, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5259882211685181
distance 1 is tensor(144.5976, device='cuda:0')
distance 2 is tensor(10.9172, device='cuda:0')
benign distance is  tensor(10.9172, device='cuda:0')
norm1 res is  tensor(0.1631, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.40725478529930115
distance 1 is tensor(159.2361, device='cuda:0')
distance 2 is tensor(11.8018, device='cuda:0')
benign distance is  tensor(11.8018, device='cuda:0')
norm1 res is  tensor(0.1759, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.3655337691307068
distance 1 is tensor(145.6719, device='cuda:0')
distance 2 is tensor(11.0509, device='cuda:0')
benign distance is  tensor(11.0509, device='cuda:0')
norm1 res is  tensor(0.1629, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.40130615234375
distance 1 is tensor(157.5054, device='cuda:0')
distance 2 is tensor(11.7879, device='cuda:0')
benign distance is  tensor(11.7879, device='cuda:0')
norm1 res is  tensor(0.1791, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.42304834723472595
distance 1 is tensor(154.8634, device='cuda:0')
distance 2 is tensor(11.5864, device='cuda:0')
benign distance is  tensor(11.5864, device='cuda:0')
norm1 res is  tensor(0.1743, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.22883141040802
distance 1 is tensor(156.8366, device='cuda:0')
distance 2 is tensor(11.7132, device='cuda:0')
benign distance is  tensor(11.7132, device='cuda:0')
norm1 res is  tensor(0.1767, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.06367374211549759
distance 1 is tensor(155.2955, device='cuda:0')
distance 2 is tensor(11.6464, device='cuda:0')
benign distance is  tensor(11.6464, device='cuda:0')
norm1 res is  tensor(0.1752, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.5109201669692993
distance 1 is tensor(154.0510, device='cuda:0')
distance 2 is tensor(11.5872, device='cuda:0')
benign distance is  tensor(11.5872, device='cuda:0')
norm1 res is  tensor(0.1761, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.6179982423782349
distance 1 is tensor(158.2405, device='cuda:0')
distance 2 is tensor(11.6476, device='cuda:0')
benign distance is  tensor(11.6476, device='cuda:0')
norm1 res is  tensor(0.1764, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.06016805022954941
distance 1 is tensor(148.8073, device='cuda:0')
distance 2 is tensor(11.0436, device='cuda:0')
benign distance is  tensor(11.0436, device='cuda:0')
norm1 res is  tensor(0.1712, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7315859198570251
distance 1 is tensor(159.8551, device='cuda:0')
distance 2 is tensor(11.9847, device='cuda:0')
benign distance is  tensor(11.9847, device='cuda:0')
norm1 res is  tensor(0.1831, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.4572623670101166
distance 1 is tensor(155.0494, device='cuda:0')
distance 2 is tensor(11.7441, device='cuda:0')
benign distance is  tensor(11.7441, device='cuda:0')
norm1 res is  tensor(0.1750, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.7043510675430298
distance 1 is tensor(154.2516, device='cuda:0')
distance 2 is tensor(11.4911, device='cuda:0')
benign distance is  tensor(11.4911, device='cuda:0')
norm1 res is  tensor(0.1732, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.38635605573654175
distance 1 is tensor(137.4601, device='cuda:0')
distance 2 is tensor(10.2907, device='cuda:0')
benign distance is  tensor(10.2907, device='cuda:0')
norm1 res is  tensor(0.1533, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.6710842847824097
distance 1 is tensor(160.0387, device='cuda:0')
distance 2 is tensor(11.9329, device='cuda:0')
benign distance is  tensor(11.9329, device='cuda:0')
norm1 res is  tensor(0.1781, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.3657805323600769
distance 1 is tensor(153.3700, device='cuda:0')
distance 2 is tensor(11.5450, device='cuda:0')
benign distance is  tensor(11.5450, device='cuda:0')
norm1 res is  tensor(0.1736, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.941677451133728
distance 1 is tensor(148.8412, device='cuda:0')
distance 2 is tensor(11.1145, device='cuda:0')
benign distance is  tensor(11.1145, device='cuda:0')
norm1 res is  tensor(0.1656, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.05724257975816727
distance 1 is tensor(151.8036, device='cuda:0')
distance 2 is tensor(11.2653, device='cuda:0')
benign distance is  tensor(11.2653, device='cuda:0')
norm1 res is  tensor(0.1701, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.3167376220226288
distance 1 is tensor(145.6862, device='cuda:0')
distance 2 is tensor(10.7532, device='cuda:0')
benign distance is  tensor(10.7532, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.48460760712623596
distance 1 is tensor(174.2390, device='cuda:0')
distance 2 is tensor(12.8758, device='cuda:0')
benign distance is  tensor(12.8758, device='cuda:0')
norm1 res is  tensor(0.1932, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.19221845269203186
distance 1 is tensor(160.2034, device='cuda:0')
distance 2 is tensor(11.7638, device='cuda:0')
benign distance is  tensor(11.7638, device='cuda:0')
norm1 res is  tensor(0.1763, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.5471185445785522
distance 1 is tensor(144.7066, device='cuda:0')
distance 2 is tensor(10.7566, device='cuda:0')
benign distance is  tensor(10.7566, device='cuda:0')
norm1 res is  tensor(0.1616, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.9677316546440125
distance 1 is tensor(167.7993, device='cuda:0')
distance 2 is tensor(12.4916, device='cuda:0')
benign distance is  tensor(12.4916, device='cuda:0')
norm1 res is  tensor(0.1852, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.2391166239976883
distance 1 is tensor(160.0954, device='cuda:0')
distance 2 is tensor(12.1210, device='cuda:0')
benign distance is  tensor(12.1210, device='cuda:0')
norm1 res is  tensor(0.1801, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.7534493803977966
distance 1 is tensor(144.2630, device='cuda:0')
distance 2 is tensor(10.9030, device='cuda:0')
benign distance is  tensor(10.9030, device='cuda:0')
norm1 res is  tensor(0.1642, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.8151485323905945
distance 1 is tensor(159.2448, device='cuda:0')
distance 2 is tensor(12.0327, device='cuda:0')
benign distance is  tensor(12.0327, device='cuda:0')
norm1 res is  tensor(0.1783, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.2642662227153778
distance 1 is tensor(155.4157, device='cuda:0')
distance 2 is tensor(11.6057, device='cuda:0')
benign distance is  tensor(11.6057, device='cuda:0')
norm1 res is  tensor(0.1771, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.47641387581825256
distance 1 is tensor(158.0772, device='cuda:0')
distance 2 is tensor(11.8013, device='cuda:0')
benign distance is  tensor(11.8013, device='cuda:0')
norm1 res is  tensor(0.1778, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.5203992128372192
distance 1 is tensor(152.8589, device='cuda:0')
distance 2 is tensor(11.3376, device='cuda:0')
benign distance is  tensor(11.3376, device='cuda:0')
norm1 res is  tensor(0.1681, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.44276151061058044
distance 1 is tensor(159.2145, device='cuda:0')
distance 2 is tensor(11.9442, device='cuda:0')
benign distance is  tensor(11.9442, device='cuda:0')
norm1 res is  tensor(0.1767, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.7072843313217163
distance 1 is tensor(143.8236, device='cuda:0')
distance 2 is tensor(10.8246, device='cuda:0')
benign distance is  tensor(10.8246, device='cuda:0')
norm1 res is  tensor(0.1618, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.3132370114326477
distance 1 is tensor(162.5349, device='cuda:0')
distance 2 is tensor(12.1362, device='cuda:0')
benign distance is  tensor(12.1362, device='cuda:0')
norm1 res is  tensor(0.1838, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.8183915019035339
distance 1 is tensor(155.5704, device='cuda:0')
distance 2 is tensor(11.5685, device='cuda:0')
benign distance is  tensor(11.5685, device='cuda:0')
norm1 res is  tensor(0.1737, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.22882123291492462
distance 1 is tensor(150.3582, device='cuda:0')
distance 2 is tensor(11.4484, device='cuda:0')
benign distance is  tensor(11.4484, device='cuda:0')
norm1 res is  tensor(0.1679, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.09714357554912567
distance 1 is tensor(158.9439, device='cuda:0')
distance 2 is tensor(11.7679, device='cuda:0')
benign distance is  tensor(11.7679, device='cuda:0')
norm1 res is  tensor(0.1761, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.035752542316913605
distance 1 is tensor(139.6496, device='cuda:0')
distance 2 is tensor(10.5375, device='cuda:0')
benign distance is  tensor(10.5375, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.5218199491500854
distance 1 is tensor(157.0222, device='cuda:0')
distance 2 is tensor(11.7067, device='cuda:0')
benign distance is  tensor(11.7067, device='cuda:0')
norm1 res is  tensor(0.1758, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.3366360366344452
distance 1 is tensor(158.4070, device='cuda:0')
distance 2 is tensor(11.8031, device='cuda:0')
benign distance is  tensor(11.8031, device='cuda:0')
norm1 res is  tensor(0.1774, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.44766172766685486
distance 1 is tensor(164.0748, device='cuda:0')
distance 2 is tensor(12.2660, device='cuda:0')
benign distance is  tensor(12.2660, device='cuda:0')
norm1 res is  tensor(0.1798, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.3461056649684906
distance 1 is tensor(154.2040, device='cuda:0')
distance 2 is tensor(11.3890, device='cuda:0')
benign distance is  tensor(11.3890, device='cuda:0')
norm1 res is  tensor(0.1686, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.4960053861141205
distance 1 is tensor(147.0238, device='cuda:0')
distance 2 is tensor(11.0885, device='cuda:0')
benign distance is  tensor(11.0885, device='cuda:0')
norm1 res is  tensor(0.1662, device='cuda:0')
current submit client idx and staleness is  48 1
 benign loss is  0.7073829174041748
distance 1 is tensor(136.5788, device='cuda:0')
distance 2 is tensor(10.3395, device='cuda:0')
benign distance is  tensor(10.3395, device='cuda:0')
norm1 res is  tensor(0.1562, device='cuda:0')
current submit client idx and staleness is  49 1
 benign loss is  0.3770758807659149
distance 1 is tensor(142.4478, device='cuda:0')
distance 2 is tensor(10.5808, device='cuda:0')
benign distance is  tensor(10.5808, device='cuda:0')
norm1 res is  tensor(0.1630, device='cuda:0')
current submit client idx and staleness is  50 1
 benign loss is  0.7557996511459351
distance 1 is tensor(156.8521, device='cuda:0')
distance 2 is tensor(11.7871, device='cuda:0')
benign distance is  tensor(11.7871, device='cuda:0')
norm1 res is  tensor(0.1768, device='cuda:0')
current submit client idx and staleness is  51 1
 benign loss is  0.3702239990234375
distance 1 is tensor(139.6362, device='cuda:0')
distance 2 is tensor(10.3455, device='cuda:0')
benign distance is  tensor(10.3455, device='cuda:0')
norm1 res is  tensor(0.1557, device='cuda:0')
current submit client idx and staleness is  52 1
 benign loss is  0.3246154189109802
distance 1 is tensor(168.9703, device='cuda:0')
distance 2 is tensor(12.5144, device='cuda:0')
benign distance is  tensor(12.5144, device='cuda:0')
norm1 res is  tensor(0.1865, device='cuda:0')
current submit client idx and staleness is  53 1
 benign loss is  0.6883957982063293
distance 1 is tensor(152.9528, device='cuda:0')
distance 2 is tensor(11.7249, device='cuda:0')
benign distance is  tensor(11.7249, device='cuda:0')
norm1 res is  tensor(0.1756, device='cuda:0')
current submit client idx and staleness is  54 1
 benign loss is  0.05355135351419449
distance 1 is tensor(162.2309, device='cuda:0')
distance 2 is tensor(12.2369, device='cuda:0')
benign distance is  tensor(12.2369, device='cuda:0')
norm1 res is  tensor(0.1837, device='cuda:0')
current submit client idx and staleness is  55 1
 benign loss is  0.36027705669403076
distance 1 is tensor(153.7135, device='cuda:0')
distance 2 is tensor(11.3669, device='cuda:0')
benign distance is  tensor(11.3669, device='cuda:0')
norm1 res is  tensor(0.1735, device='cuda:0')
current submit client idx and staleness is  56 1
 benign loss is  0.28351300954818726
distance 1 is tensor(140.7247, device='cuda:0')
distance 2 is tensor(10.4662, device='cuda:0')
benign distance is  tensor(10.4662, device='cuda:0')
norm1 res is  tensor(0.1593, device='cuda:0')
current submit client idx and staleness is  57 1
 benign loss is  0.5738166570663452
distance 1 is tensor(147.3850, device='cuda:0')
distance 2 is tensor(11.2020, device='cuda:0')
benign distance is  tensor(11.2020, device='cuda:0')
norm1 res is  tensor(0.1675, device='cuda:0')
current submit client idx and staleness is  58 1
 benign loss is  0.37937113642692566
distance 1 is tensor(154.8042, device='cuda:0')
distance 2 is tensor(11.6159, device='cuda:0')
benign distance is  tensor(11.6159, device='cuda:0')
norm1 res is  tensor(0.1748, device='cuda:0')
current submit client idx and staleness is  59 1
 benign loss is  0.1360710859298706
distance 1 is tensor(154.8975, device='cuda:0')
distance 2 is tensor(11.5901, device='cuda:0')
benign distance is  tensor(11.5901, device='cuda:0')
norm1 res is  tensor(0.1728, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.6810, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.3848, device='cuda:0')
c is  tensor(0.0328, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0121, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.0018, device='cuda:0')
c is  tensor(0.0329, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0139, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.7496, device='cuda:0')
c is  tensor(0.0316, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0135, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.6920, device='cuda:0')
c is  tensor(0.0320, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0143, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.5645, device='cuda:0')
c is  tensor(0.0338, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0138, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.2997, device='cuda:0')
c is  tensor(0.0313, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0124, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.4051, device='cuda:0')
c is  tensor(0.0321, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0167, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.4716, device='cuda:0')
c is  tensor(0.0324, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0124, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.7011, device='cuda:0')
c is  tensor(0.0332, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0158, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.4153, device='cuda:0')
c is  tensor(0.0328, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0094, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.8433, device='cuda:0')
c is  tensor(0.0312, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0114, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.5331, device='cuda:0')
c is  tensor(0.0333, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0112, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.3892, device='cuda:0')
c is  tensor(0.0303, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0121, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.4730, device='cuda:0')
c is  tensor(0.0312, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0178, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.8776, device='cuda:0')
c is  tensor(0.0308, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0177, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.8721, device='cuda:0')
c is  tensor(0.0314, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0139, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.8998, device='cuda:0')
c is  tensor(0.0331, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0119, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.4044, device='cuda:0')
c is  tensor(0.0322, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0134, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.4773, device='cuda:0')
c is  tensor(0.0314, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0162, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.3947, device='cuda:0')
c is  tensor(0.0315, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0191, device='cuda:0')
accept
len accept list 20
len all weights is 20
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 92.54% 

Test Accuracy: 89.74% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  0.07116583734750748
distance 1 is tensor(111.2258, device='cuda:0')
distance 2 is tensor(8.1753, device='cuda:0')
benign distance is  tensor(8.1753, device='cuda:0')
norm1 res is  tensor(0.1229, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5880335569381714
distance 1 is tensor(136.0260, device='cuda:0')
distance 2 is tensor(9.9550, device='cuda:0')
benign distance is  tensor(9.9550, device='cuda:0')
norm1 res is  tensor(0.1534, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.028983939439058304
distance 1 is tensor(137.1002, device='cuda:0')
distance 2 is tensor(9.8301, device='cuda:0')
benign distance is  tensor(9.8301, device='cuda:0')
norm1 res is  tensor(0.1499, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.803493857383728
distance 1 is tensor(123.0710, device='cuda:0')
distance 2 is tensor(9.1080, device='cuda:0')
benign distance is  tensor(9.1080, device='cuda:0')
norm1 res is  tensor(0.1394, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.874355137348175
distance 1 is tensor(131.2925, device='cuda:0')
distance 2 is tensor(9.5016, device='cuda:0')
benign distance is  tensor(9.5016, device='cuda:0')
norm1 res is  tensor(0.1482, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.116895318031311
distance 1 is tensor(139.1006, device='cuda:0')
distance 2 is tensor(10.2478, device='cuda:0')
benign distance is  tensor(10.2478, device='cuda:0')
norm1 res is  tensor(0.1554, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.0872613713145256
distance 1 is tensor(133.6242, device='cuda:0')
distance 2 is tensor(9.6945, device='cuda:0')
benign distance is  tensor(9.6945, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5207493305206299
distance 1 is tensor(140.5112, device='cuda:0')
distance 2 is tensor(10.2462, device='cuda:0')
benign distance is  tensor(10.2462, device='cuda:0')
norm1 res is  tensor(0.1557, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.3007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.2173, device='cuda:0')
c is  tensor(0.0249, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.6160, device='cuda:0')
c is  tensor(0.0223, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.0095, device='cuda:0')
c is  tensor(0.0226, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.6231, device='cuda:0')
c is  tensor(0.0233, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.4973, device='cuda:0')
c is  tensor(0.0231, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.5319, device='cuda:0')
c is  tensor(0.0221, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.4984, device='cuda:0')
c is  tensor(0.0227, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.0904, device='cuda:0')
c is  tensor(0.0221, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.2744, device='cuda:0')
c is  tensor(0.0207, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.3136, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.9789, device='cuda:0')
c is  tensor(0.0207, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.1664, device='cuda:0')
c is  tensor(0.0211, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.1481, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.7054, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.9174, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.8450, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.8609e-05, device='cuda:0')
accept
len accept list 9
len all weights is 9
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 92.33% 

Test Accuracy: 89.46% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.27413588762283325
distance 1 is tensor(109.4767, device='cuda:0')
distance 2 is tensor(8.0832, device='cuda:0')
benign distance is  tensor(8.0832, device='cuda:0')
norm1 res is  tensor(0.1227, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7259048819541931
distance 1 is tensor(136.8334, device='cuda:0')
distance 2 is tensor(9.9053, device='cuda:0')
benign distance is  tensor(9.9053, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.5541056394577026
distance 1 is tensor(127.9484, device='cuda:0')
distance 2 is tensor(9.3298, device='cuda:0')
benign distance is  tensor(9.3298, device='cuda:0')
norm1 res is  tensor(0.1439, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5381430983543396
distance 1 is tensor(122.0941, device='cuda:0')
distance 2 is tensor(9.0080, device='cuda:0')
benign distance is  tensor(9.0080, device='cuda:0')
norm1 res is  tensor(0.1373, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5176519155502319
distance 1 is tensor(134.6666, device='cuda:0')
distance 2 is tensor(9.8101, device='cuda:0')
benign distance is  tensor(9.8101, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.23811963200569153
distance 1 is tensor(142.0801, device='cuda:0')
distance 2 is tensor(10.3096, device='cuda:0')
benign distance is  tensor(10.3096, device='cuda:0')
norm1 res is  tensor(0.1596, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.8800044059753418
distance 1 is tensor(129.1310, device='cuda:0')
distance 2 is tensor(9.3187, device='cuda:0')
benign distance is  tensor(9.3187, device='cuda:0')
norm1 res is  tensor(0.1444, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.17332389950752258
distance 1 is tensor(139.2002, device='cuda:0')
distance 2 is tensor(10.1905, device='cuda:0')
benign distance is  tensor(10.1905, device='cuda:0')
norm1 res is  tensor(0.1546, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.31267625093460083
distance 1 is tensor(143.0987, device='cuda:0')
distance 2 is tensor(10.3937, device='cuda:0')
benign distance is  tensor(10.3937, device='cuda:0')
norm1 res is  tensor(0.1590, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9119445085525513
distance 1 is tensor(141.8787, device='cuda:0')
distance 2 is tensor(10.4352, device='cuda:0')
benign distance is  tensor(10.4352, device='cuda:0')
norm1 res is  tensor(0.1601, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.2854480743408203
distance 1 is tensor(143.8188, device='cuda:0')
distance 2 is tensor(10.4276, device='cuda:0')
benign distance is  tensor(10.4276, device='cuda:0')
norm1 res is  tensor(0.1590, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.9039558172225952
distance 1 is tensor(147.8831, device='cuda:0')
distance 2 is tensor(10.6994, device='cuda:0')
benign distance is  tensor(10.6994, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.7133568525314331
distance 1 is tensor(132.0982, device='cuda:0')
distance 2 is tensor(9.6959, device='cuda:0')
benign distance is  tensor(9.6959, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.06485964357852936
distance 1 is tensor(138.5575, device='cuda:0')
distance 2 is tensor(10.1762, device='cuda:0')
benign distance is  tensor(10.1762, device='cuda:0')
norm1 res is  tensor(0.1560, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.18682751059532166
distance 1 is tensor(148.6214, device='cuda:0')
distance 2 is tensor(10.8461, device='cuda:0')
benign distance is  tensor(10.8461, device='cuda:0')
norm1 res is  tensor(0.1666, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.5513482689857483
distance 1 is tensor(150.9639, device='cuda:0')
distance 2 is tensor(10.7905, device='cuda:0')
benign distance is  tensor(10.7905, device='cuda:0')
norm1 res is  tensor(0.1648, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.2148, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(484.3018, device='cuda:0')
c is  tensor(0.0211, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.2327e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.7576, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.3793, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.4801e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.1252, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.7798, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.5338, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.9669e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.2772, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.8836e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.4562, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.9244e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.8187, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.9788e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.0194, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7482, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.7676e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.4473, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.9642, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.3527, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.0248, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6058e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.3087, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 3
len all weights is 3
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 91.70% 

Test Accuracy: 89.27% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.15441545844078064
distance 1 is tensor(141.4249, device='cuda:0')
distance 2 is tensor(10.2272, device='cuda:0')
benign distance is  tensor(10.2272, device='cuda:0')
norm1 res is  tensor(0.1579, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.43116265535354614
distance 1 is tensor(144.2502, device='cuda:0')
distance 2 is tensor(10.3582, device='cuda:0')
benign distance is  tensor(10.3582, device='cuda:0')
norm1 res is  tensor(0.1582, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.32107943296432495
distance 1 is tensor(130.2685, device='cuda:0')
distance 2 is tensor(9.4850, device='cuda:0')
benign distance is  tensor(9.4850, device='cuda:0')
norm1 res is  tensor(0.1440, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.090326227247715
distance 1 is tensor(144.5227, device='cuda:0')
distance 2 is tensor(10.3108, device='cuda:0')
benign distance is  tensor(10.3108, device='cuda:0')
norm1 res is  tensor(0.1569, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7024805545806885
distance 1 is tensor(117.6633, device='cuda:0')
distance 2 is tensor(8.6220, device='cuda:0')
benign distance is  tensor(8.6220, device='cuda:0')
norm1 res is  tensor(0.1288, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8903697729110718
distance 1 is tensor(146.1590, device='cuda:0')
distance 2 is tensor(10.6002, device='cuda:0')
benign distance is  tensor(10.6002, device='cuda:0')
norm1 res is  tensor(0.1639, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.117225781083107
distance 1 is tensor(144.8077, device='cuda:0')
distance 2 is tensor(10.5959, device='cuda:0')
benign distance is  tensor(10.5959, device='cuda:0')
norm1 res is  tensor(0.1612, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.1434945911169052
distance 1 is tensor(141.9583, device='cuda:0')
distance 2 is tensor(10.4376, device='cuda:0')
benign distance is  tensor(10.4376, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.300367146730423
distance 1 is tensor(147.8008, device='cuda:0')
distance 2 is tensor(10.6561, device='cuda:0')
benign distance is  tensor(10.6561, device='cuda:0')
norm1 res is  tensor(0.1630, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9229490160942078
distance 1 is tensor(151.4097, device='cuda:0')
distance 2 is tensor(11.0756, device='cuda:0')
benign distance is  tensor(11.0756, device='cuda:0')
norm1 res is  tensor(0.1671, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.36815011501312256
distance 1 is tensor(128.8440, device='cuda:0')
distance 2 is tensor(9.3516, device='cuda:0')
benign distance is  tensor(9.3516, device='cuda:0')
norm1 res is  tensor(0.1417, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.36440443992614746
distance 1 is tensor(136.8171, device='cuda:0')
distance 2 is tensor(9.9469, device='cuda:0')
benign distance is  tensor(9.9469, device='cuda:0')
norm1 res is  tensor(0.1520, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.5609652996063232
distance 1 is tensor(134.6176, device='cuda:0')
distance 2 is tensor(9.8022, device='cuda:0')
benign distance is  tensor(9.8022, device='cuda:0')
norm1 res is  tensor(0.1466, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.34415221214294434
distance 1 is tensor(139.5981, device='cuda:0')
distance 2 is tensor(10.1028, device='cuda:0')
benign distance is  tensor(10.1028, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.3943442404270172
distance 1 is tensor(130.2713, device='cuda:0')
distance 2 is tensor(9.4528, device='cuda:0')
benign distance is  tensor(9.4528, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.6768057942390442
distance 1 is tensor(139.0799, device='cuda:0')
distance 2 is tensor(10.1537, device='cuda:0')
benign distance is  tensor(10.1537, device='cuda:0')
norm1 res is  tensor(0.1540, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 24
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1957, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.2741, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.1730e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.3992, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6634e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.0538, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.6384e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.8198, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.9320e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.7514, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.2843e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.2794, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.0307e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.1465, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.5185, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.6739e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.5447, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.2412, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.3374e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6801, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.1608e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.8187, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.7042, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(782.7834, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.3248e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.9530, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.8854e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.8663, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.8587, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.9991e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(707.2707, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.4280e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.5361, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.3751, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.5103, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0523, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.0721, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.9055, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 17
len all weights is 17
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 92.51% 

Test Accuracy: 89.65% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5103277564048767
distance 1 is tensor(102.0816, device='cuda:0')
distance 2 is tensor(7.5456, device='cuda:0')
benign distance is  tensor(7.5456, device='cuda:0')
norm1 res is  tensor(0.1145, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.834888756275177
distance 1 is tensor(121.2939, device='cuda:0')
distance 2 is tensor(8.8745, device='cuda:0')
benign distance is  tensor(8.8745, device='cuda:0')
norm1 res is  tensor(0.1360, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.2645821273326874
distance 1 is tensor(117.0569, device='cuda:0')
distance 2 is tensor(8.4930, device='cuda:0')
benign distance is  tensor(8.4930, device='cuda:0')
norm1 res is  tensor(0.1275, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3472645580768585
distance 1 is tensor(109.5926, device='cuda:0')
distance 2 is tensor(7.9898, device='cuda:0')
benign distance is  tensor(7.9898, device='cuda:0')
norm1 res is  tensor(0.1204, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.30797451734542847
distance 1 is tensor(120.0161, device='cuda:0')
distance 2 is tensor(8.5989, device='cuda:0')
benign distance is  tensor(8.5989, device='cuda:0')
norm1 res is  tensor(0.1302, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.3122454583644867
distance 1 is tensor(139.5485, device='cuda:0')
distance 2 is tensor(10.0927, device='cuda:0')
benign distance is  tensor(10.0927, device='cuda:0')
norm1 res is  tensor(0.1554, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.046675972640514374
distance 1 is tensor(120.4809, device='cuda:0')
distance 2 is tensor(8.8420, device='cuda:0')
benign distance is  tensor(8.8420, device='cuda:0')
norm1 res is  tensor(0.1342, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.4047544002532959
distance 1 is tensor(125.3966, device='cuda:0')
distance 2 is tensor(9.1273, device='cuda:0')
benign distance is  tensor(9.1273, device='cuda:0')
norm1 res is  tensor(0.1428, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.47414979338645935
distance 1 is tensor(141.6434, device='cuda:0')
distance 2 is tensor(10.3061, device='cuda:0')
benign distance is  tensor(10.3061, device='cuda:0')
norm1 res is  tensor(0.1583, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.4717978835105896
distance 1 is tensor(124.2071, device='cuda:0')
distance 2 is tensor(9.0876, device='cuda:0')
benign distance is  tensor(9.0876, device='cuda:0')
norm1 res is  tensor(0.1379, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.7312856912612915
distance 1 is tensor(121.2643, device='cuda:0')
distance 2 is tensor(8.8101, device='cuda:0')
benign distance is  tensor(8.8101, device='cuda:0')
norm1 res is  tensor(0.1344, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.7374290227890015
distance 1 is tensor(131.2717, device='cuda:0')
distance 2 is tensor(9.4807, device='cuda:0')
benign distance is  tensor(9.4807, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.5639822483062744
distance 1 is tensor(126.5292, device='cuda:0')
distance 2 is tensor(9.4053, device='cuda:0')
benign distance is  tensor(9.4053, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.03608791157603264
distance 1 is tensor(127.5095, device='cuda:0')
distance 2 is tensor(9.4461, device='cuda:0')
benign distance is  tensor(9.4461, device='cuda:0')
norm1 res is  tensor(0.1474, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.35840702056884766
distance 1 is tensor(132.8230, device='cuda:0')
distance 2 is tensor(9.7633, device='cuda:0')
benign distance is  tensor(9.7633, device='cuda:0')
norm1 res is  tensor(0.1485, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.129716157913208
distance 1 is tensor(134.2602, device='cuda:0')
distance 2 is tensor(9.7550, device='cuda:0')
benign distance is  tensor(9.7550, device='cuda:0')
norm1 res is  tensor(0.1499, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.33307623863220215
distance 1 is tensor(141.5858, device='cuda:0')
distance 2 is tensor(10.2427, device='cuda:0')
benign distance is  tensor(10.2427, device='cuda:0')
norm1 res is  tensor(0.1580, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.3461269736289978
distance 1 is tensor(132.9067, device='cuda:0')
distance 2 is tensor(9.6404, device='cuda:0')
benign distance is  tensor(9.6404, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.4002001881599426
distance 1 is tensor(145.9385, device='cuda:0')
distance 2 is tensor(10.6391, device='cuda:0')
benign distance is  tensor(10.6391, device='cuda:0')
norm1 res is  tensor(0.1610, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.27012455463409424
distance 1 is tensor(138.1101, device='cuda:0')
distance 2 is tensor(9.8525, device='cuda:0')
benign distance is  tensor(9.8525, device='cuda:0')
norm1 res is  tensor(0.1488, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.5533661842346191
distance 1 is tensor(147.8678, device='cuda:0')
distance 2 is tensor(10.7357, device='cuda:0')
benign distance is  tensor(10.7357, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.26733213663101196
distance 1 is tensor(135.1228, device='cuda:0')
distance 2 is tensor(10.0391, device='cuda:0')
benign distance is  tensor(10.0391, device='cuda:0')
norm1 res is  tensor(0.1524, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.46180590987205505
distance 1 is tensor(130.9401, device='cuda:0')
distance 2 is tensor(9.5923, device='cuda:0')
benign distance is  tensor(9.5923, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.3316490650177002
distance 1 is tensor(139.0831, device='cuda:0')
distance 2 is tensor(10.2221, device='cuda:0')
benign distance is  tensor(10.2221, device='cuda:0')
norm1 res is  tensor(0.1563, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(0.1561, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(448.7270, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.4381, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.0400, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.4799e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(469.2964, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(510.1736, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.8684e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.8659, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.4496, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.5214, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.5463e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5984, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.6743, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.7333e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.6642, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.2824, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1956, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.5059e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.7852, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.6898, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.2924, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
len accept list 8
len all weights is 8
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 92.22% 

Test Accuracy: 89.36% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
 benign loss is  0.32374364137649536
distance 1 is tensor(108.3090, device='cuda:0')
distance 2 is tensor(7.9207, device='cuda:0')
benign distance is  tensor(7.9207, device='cuda:0')
norm1 res is  tensor(0.1186, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.38420385122299194
distance 1 is tensor(134.0822, device='cuda:0')
distance 2 is tensor(9.8165, device='cuda:0')
benign distance is  tensor(9.8165, device='cuda:0')
norm1 res is  tensor(0.1474, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.27666670083999634
distance 1 is tensor(107.8709, device='cuda:0')
distance 2 is tensor(7.9549, device='cuda:0')
benign distance is  tensor(7.9549, device='cuda:0')
norm1 res is  tensor(0.1190, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.41220664978027344
distance 1 is tensor(125.5543, device='cuda:0')
distance 2 is tensor(9.0063, device='cuda:0')
benign distance is  tensor(9.0063, device='cuda:0')
norm1 res is  tensor(0.1345, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.2808558940887451
distance 1 is tensor(92.8407, device='cuda:0')
distance 2 is tensor(6.7675, device='cuda:0')
benign distance is  tensor(6.7675, device='cuda:0')
norm1 res is  tensor(0.1019, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.9069684147834778
distance 1 is tensor(144.7555, device='cuda:0')
distance 2 is tensor(10.5281, device='cuda:0')
benign distance is  tensor(10.5281, device='cuda:0')
norm1 res is  tensor(0.1640, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.11264447867870331
distance 1 is tensor(129.3668, device='cuda:0')
distance 2 is tensor(9.3486, device='cuda:0')
benign distance is  tensor(9.3486, device='cuda:0')
norm1 res is  tensor(0.1457, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.23257169127464294
distance 1 is tensor(132.1937, device='cuda:0')
distance 2 is tensor(9.4998, device='cuda:0')
benign distance is  tensor(9.4998, device='cuda:0')
norm1 res is  tensor(0.1456, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.3477432429790497
distance 1 is tensor(130.9831, device='cuda:0')
distance 2 is tensor(9.5875, device='cuda:0')
benign distance is  tensor(9.5875, device='cuda:0')
norm1 res is  tensor(0.1450, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.4991544187068939
distance 1 is tensor(125.9146, device='cuda:0')
distance 2 is tensor(9.3547, device='cuda:0')
benign distance is  tensor(9.3547, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.7141222953796387
distance 1 is tensor(136.2537, device='cuda:0')
distance 2 is tensor(9.9194, device='cuda:0')
benign distance is  tensor(9.9194, device='cuda:0')
norm1 res is  tensor(0.1506, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.07767043262720108
distance 1 is tensor(141.0078, device='cuda:0')
distance 2 is tensor(10.2999, device='cuda:0')
benign distance is  tensor(10.2999, device='cuda:0')
norm1 res is  tensor(0.1590, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.3377266824245453
distance 1 is tensor(140.1559, device='cuda:0')
distance 2 is tensor(10.2229, device='cuda:0')
benign distance is  tensor(10.2229, device='cuda:0')
norm1 res is  tensor(0.1547, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.5647132396697998
distance 1 is tensor(132.3340, device='cuda:0')
distance 2 is tensor(9.6413, device='cuda:0')
benign distance is  tensor(9.6413, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.2713187634944916
distance 1 is tensor(138.4157, device='cuda:0')
distance 2 is tensor(10.1081, device='cuda:0')
benign distance is  tensor(10.1081, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.4360191226005554
distance 1 is tensor(134.4048, device='cuda:0')
distance 2 is tensor(9.7086, device='cuda:0')
benign distance is  tensor(9.7086, device='cuda:0')
norm1 res is  tensor(0.1464, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 32
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1439, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(466.3915, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.9072e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.1398, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(472.0341, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.7613, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6606e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(398.8425, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.1127e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.7368, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.5874e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.2300, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.5895, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.8563, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.3080e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.3809, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.4884e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.0956, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.7285, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.4406, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4347e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.1463, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.8720e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.5635, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.7770e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.4401, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.5374e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.1505, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.5771e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.0575, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.5535, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.7086, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.7835e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.7915, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.4897e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.0786, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.0396, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.3823, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.8295, device='cuda:0')
c is  tensor(0.0148, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.9898e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.7029, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.1589, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.7058e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.8979, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.1374e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.7352, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.4200, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.5258e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.2467, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.7633e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.2228, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3914e-05, device='cuda:0')
len accept list 21
len all weights is 21
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 92.44% 

Test Accuracy: 89.72% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
 benign loss is  0.15369375050067902
distance 1 is tensor(99.8004, device='cuda:0')
distance 2 is tensor(7.3123, device='cuda:0')
benign distance is  tensor(7.3123, device='cuda:0')
norm1 res is  tensor(0.1087, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.13681109249591827
distance 1 is tensor(125.9436, device='cuda:0')
distance 2 is tensor(9.2558, device='cuda:0')
benign distance is  tensor(9.2558, device='cuda:0')
norm1 res is  tensor(0.1419, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.0033478315453976393
distance 1 is tensor(115.2537, device='cuda:0')
distance 2 is tensor(8.4114, device='cuda:0')
benign distance is  tensor(8.4114, device='cuda:0')
norm1 res is  tensor(0.1280, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.17093884944915771
distance 1 is tensor(119.8375, device='cuda:0')
distance 2 is tensor(8.7211, device='cuda:0')
benign distance is  tensor(8.7211, device='cuda:0')
norm1 res is  tensor(0.1326, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0237739086151123
distance 1 is tensor(111.7398, device='cuda:0')
distance 2 is tensor(8.1042, device='cuda:0')
benign distance is  tensor(8.1042, device='cuda:0')
norm1 res is  tensor(0.1208, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.273621141910553
distance 1 is tensor(144.6779, device='cuda:0')
distance 2 is tensor(10.6624, device='cuda:0')
benign distance is  tensor(10.6624, device='cuda:0')
norm1 res is  tensor(0.1640, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.24853427708148956
distance 1 is tensor(123.8639, device='cuda:0')
distance 2 is tensor(8.8687, device='cuda:0')
benign distance is  tensor(8.8687, device='cuda:0')
norm1 res is  tensor(0.1343, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.4054810404777527
distance 1 is tensor(129.4089, device='cuda:0')
distance 2 is tensor(9.3761, device='cuda:0')
benign distance is  tensor(9.3761, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.03607819229364395
distance 1 is tensor(139.1025, device='cuda:0')
distance 2 is tensor(9.9247, device='cuda:0')
benign distance is  tensor(9.9247, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.5664535760879517
distance 1 is tensor(135.2437, device='cuda:0')
distance 2 is tensor(9.8477, device='cuda:0')
benign distance is  tensor(9.8477, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6202008724212646
distance 1 is tensor(131.4115, device='cuda:0')
distance 2 is tensor(9.5313, device='cuda:0')
benign distance is  tensor(9.5313, device='cuda:0')
norm1 res is  tensor(0.1451, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5925906896591187
distance 1 is tensor(136.9712, device='cuda:0')
distance 2 is tensor(10.0457, device='cuda:0')
benign distance is  tensor(10.0457, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.20267033576965332
distance 1 is tensor(135.1178, device='cuda:0')
distance 2 is tensor(10.0535, device='cuda:0')
benign distance is  tensor(10.0535, device='cuda:0')
norm1 res is  tensor(0.1518, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.21671243011951447
distance 1 is tensor(129.9106, device='cuda:0')
distance 2 is tensor(9.3243, device='cuda:0')
benign distance is  tensor(9.3243, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.13705343008041382
distance 1 is tensor(135.0775, device='cuda:0')
distance 2 is tensor(10.0371, device='cuda:0')
benign distance is  tensor(10.0371, device='cuda:0')
norm1 res is  tensor(0.1571, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.91815185546875
distance 1 is tensor(138.5270, device='cuda:0')
distance 2 is tensor(9.9809, device='cuda:0')
benign distance is  tensor(9.9809, device='cuda:0')
norm1 res is  tensor(0.1522, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.14941319823265076
distance 1 is tensor(137.8237, device='cuda:0')
distance 2 is tensor(10.0396, device='cuda:0')
benign distance is  tensor(10.0396, device='cuda:0')
norm1 res is  tensor(0.1539, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.6073547601699829
distance 1 is tensor(140.2096, device='cuda:0')
distance 2 is tensor(10.3034, device='cuda:0')
benign distance is  tensor(10.3034, device='cuda:0')
norm1 res is  tensor(0.1571, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.056562572717666626
distance 1 is tensor(124.5342, device='cuda:0')
distance 2 is tensor(9.2241, device='cuda:0')
benign distance is  tensor(9.2241, device='cuda:0')
norm1 res is  tensor(0.1374, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.2571071982383728
distance 1 is tensor(142.6388, device='cuda:0')
distance 2 is tensor(10.3013, device='cuda:0')
benign distance is  tensor(10.3013, device='cuda:0')
norm1 res is  tensor(0.1587, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.36556488275527954
distance 1 is tensor(129.1002, device='cuda:0')
distance 2 is tensor(9.3572, device='cuda:0')
benign distance is  tensor(9.3572, device='cuda:0')
norm1 res is  tensor(0.1398, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9542908668518066
distance 1 is tensor(143.5691, device='cuda:0')
distance 2 is tensor(10.2576, device='cuda:0')
benign distance is  tensor(10.2576, device='cuda:0')
norm1 res is  tensor(0.1552, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.3063160479068756
distance 1 is tensor(128.3236, device='cuda:0')
distance 2 is tensor(9.3464, device='cuda:0')
benign distance is  tensor(9.3464, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.6433278322219849
distance 1 is tensor(131.6517, device='cuda:0')
distance 2 is tensor(9.6350, device='cuda:0')
benign distance is  tensor(9.6350, device='cuda:0')
norm1 res is  tensor(0.1447, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.0458824448287487
distance 1 is tensor(127.5953, device='cuda:0')
distance 2 is tensor(9.3905, device='cuda:0')
benign distance is  tensor(9.3905, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.2407415807247162
distance 1 is tensor(129.8711, device='cuda:0')
distance 2 is tensor(9.3590, device='cuda:0')
benign distance is  tensor(9.3590, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.016462255269289017
distance 1 is tensor(127.9758, device='cuda:0')
distance 2 is tensor(9.4155, device='cuda:0')
benign distance is  tensor(9.4155, device='cuda:0')
norm1 res is  tensor(0.1432, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.4078756868839264
distance 1 is tensor(149.0516, device='cuda:0')
distance 2 is tensor(10.7294, device='cuda:0')
benign distance is  tensor(10.7294, device='cuda:0')
norm1 res is  tensor(0.1633, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.15384827554225922
distance 1 is tensor(137.9869, device='cuda:0')
distance 2 is tensor(10.1046, device='cuda:0')
benign distance is  tensor(10.1046, device='cuda:0')
norm1 res is  tensor(0.1558, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  1.0350722074508667
distance 1 is tensor(148.5124, device='cuda:0')
distance 2 is tensor(10.6958, device='cuda:0')
benign distance is  tensor(10.6958, device='cuda:0')
norm1 res is  tensor(0.1619, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.4917876720428467
distance 1 is tensor(129.8797, device='cuda:0')
distance 2 is tensor(9.2778, device='cuda:0')
benign distance is  tensor(9.2778, device='cuda:0')
norm1 res is  tensor(0.1402, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.6987558007240295
distance 1 is tensor(134.4119, device='cuda:0')
distance 2 is tensor(9.9006, device='cuda:0')
benign distance is  tensor(9.9006, device='cuda:0')
norm1 res is  tensor(0.1508, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(142.9960, device='cuda:0')
distance 2 is tensor(10.3689, device='cuda:0')
compute distance is  tensor(10.3689, device='cuda:0')
compute norm is  tensor(50.8269, device='cuda:0')
distance 1 is tensor(140.4362, device='cuda:0')
distance 2 is tensor(10.2674, device='cuda:0')
compute distance is  tensor(10.2674, device='cuda:0')
compute norm is  tensor(50.7131, device='cuda:0')
distance 1 is tensor(146.4800, device='cuda:0')
distance 2 is tensor(10.6944, device='cuda:0')
compute distance is  tensor(10.6944, device='cuda:0')
compute norm is  tensor(50.8456, device='cuda:0')
distance 1 is tensor(150.2760, device='cuda:0')
distance 2 is tensor(10.8701, device='cuda:0')
compute distance is  tensor(10.8701, device='cuda:0')
compute norm is  tensor(50.8813, device='cuda:0')
distance 1 is tensor(147.9314, device='cuda:0')
distance 2 is tensor(10.7461, device='cuda:0')
compute distance is  tensor(10.7461, device='cuda:0')
compute norm is  tensor(50.9890, device='cuda:0')
distance 1 is tensor(140.2751, device='cuda:0')
distance 2 is tensor(10.1896, device='cuda:0')
compute distance is  tensor(10.1896, device='cuda:0')
compute norm is  tensor(50.8998, device='cuda:0')
distance 1 is tensor(160.4986, device='cuda:0')
distance 2 is tensor(11.6667, device='cuda:0')
compute distance is  tensor(11.6667, device='cuda:0')
compute norm is  tensor(51.3029, device='cuda:0')
distance 1 is tensor(147.9637, device='cuda:0')
distance 2 is tensor(10.7383, device='cuda:0')
compute distance is  tensor(10.7383, device='cuda:0')
compute norm is  tensor(50.9666, device='cuda:0')
distance 1 is tensor(136.5473, device='cuda:0')
distance 2 is tensor(9.8776, device='cuda:0')
compute distance is  tensor(9.8776, device='cuda:0')
compute norm is  tensor(50.7332, device='cuda:0')
distance 1 is tensor(142.3450, device='cuda:0')
distance 2 is tensor(10.2770, device='cuda:0')
compute distance is  tensor(10.2770, device='cuda:0')
compute norm is  tensor(50.8361, device='cuda:0')
distance 1 is tensor(147.4449, device='cuda:0')
distance 2 is tensor(10.6119, device='cuda:0')
compute distance is  tensor(10.6119, device='cuda:0')
compute norm is  tensor(51.0786, device='cuda:0')
distance 1 is tensor(137.9987, device='cuda:0')
distance 2 is tensor(9.9831, device='cuda:0')
compute distance is  tensor(9.9831, device='cuda:0')
compute norm is  tensor(50.7407, device='cuda:0')
batch acc is 0.10260000015633194
batch acc is 0.1013000001563365
batch acc is 0.1008666668230063
batch acc is 0.1006500001563412
batch acc is 0.10052000015634215
batch acc is 0.10043333348967075
batch acc is 0.10037142872775907
batch acc is 0.10032500015632531
batch acc is 0.10028888904521017
batch acc is 0.10026000015631806
mal_rand_acc is 0.1500000005
mal_rand loss is 5.6914862202159104e+17
len of model dicts is  12
distance 1 is tensor(142.9960, device='cuda:0')
distance 2 is tensor(10.3689, device='cuda:0')
compute distance is  tensor(10.3689, device='cuda:0')
compute norm is  tensor(50.8269, device='cuda:0')
distance 1 is tensor(140.4362, device='cuda:0')
distance 2 is tensor(10.2674, device='cuda:0')
compute distance is  tensor(10.2674, device='cuda:0')
compute norm is  tensor(50.7131, device='cuda:0')
distance 1 is tensor(146.4800, device='cuda:0')
distance 2 is tensor(10.6944, device='cuda:0')
compute distance is  tensor(10.6944, device='cuda:0')
compute norm is  tensor(50.8456, device='cuda:0')
distance 1 is tensor(150.2760, device='cuda:0')
distance 2 is tensor(10.8701, device='cuda:0')
compute distance is  tensor(10.8701, device='cuda:0')
compute norm is  tensor(50.8813, device='cuda:0')
distance 1 is tensor(147.9314, device='cuda:0')
distance 2 is tensor(10.7461, device='cuda:0')
compute distance is  tensor(10.7461, device='cuda:0')
compute norm is  tensor(50.9890, device='cuda:0')
distance 1 is tensor(140.2751, device='cuda:0')
distance 2 is tensor(10.1896, device='cuda:0')
compute distance is  tensor(10.1896, device='cuda:0')
compute norm is  tensor(50.8998, device='cuda:0')
distance 1 is tensor(160.4986, device='cuda:0')
distance 2 is tensor(11.6667, device='cuda:0')
compute distance is  tensor(11.6667, device='cuda:0')
compute norm is  tensor(51.3029, device='cuda:0')
distance 1 is tensor(147.9637, device='cuda:0')
distance 2 is tensor(10.7383, device='cuda:0')
compute distance is  tensor(10.7383, device='cuda:0')
compute norm is  tensor(50.9666, device='cuda:0')
distance 1 is tensor(136.5473, device='cuda:0')
distance 2 is tensor(9.8776, device='cuda:0')
compute distance is  tensor(9.8776, device='cuda:0')
compute norm is  tensor(50.7332, device='cuda:0')
distance 1 is tensor(142.3450, device='cuda:0')
distance 2 is tensor(10.2770, device='cuda:0')
compute distance is  tensor(10.2770, device='cuda:0')
compute norm is  tensor(50.8361, device='cuda:0')
distance 1 is tensor(147.4449, device='cuda:0')
distance 2 is tensor(10.6119, device='cuda:0')
compute distance is  tensor(10.6119, device='cuda:0')
compute norm is  tensor(51.0786, device='cuda:0')
distance 1 is tensor(137.9987, device='cuda:0')
distance 2 is tensor(9.9831, device='cuda:0')
compute distance is  tensor(9.9831, device='cuda:0')
compute norm is  tensor(50.7407, device='cuda:0')
distance Threshold  is  tensor(11.6667, device='cuda:0')
distance 1 is tensor(1009221.9375, device='cuda:0')
distance 2 is tensor(73620.0469, device='cuda:0')
________________________________
test distance is  tensor(73620.0469, device='cuda:0')
test similarity is  tensor(-0.1068, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.822547931577889e+17
test entropy is  0.0
________________________________
cal ratio is  0.011329710179954003
distance 1 is tensor(11434.1992, device='cuda:0')
distance 2 is tensor(834.0939, device='cuda:0')
cal_distance is  tensor(834.0939, device='cuda:0')
cal ratio is  0.10644110680067323
distance 1 is tensor(1217.0741, device='cuda:0')
distance 2 is tensor(88.7819, device='cuda:0')
cal_distance is  tensor(88.7819, device='cuda:0')
cal ratio is  0.3262531416840394
distance 1 is tensor(397.0783, device='cuda:0')
distance 2 is tensor(28.9654, device='cuda:0')
cal_distance is  tensor(28.9654, device='cuda:0')
cal ratio is  0.5711856760229025
distance 1 is tensor(226.8080, device='cuda:0')
distance 2 is tensor(16.5446, device='cuda:0')
cal_distance is  tensor(16.5446, device='cuda:0')
cal ratio is  0.7557683490679711
distance 1 is tensor(171.4158, device='cuda:0')
distance 2 is tensor(12.5039, device='cuda:0')
cal_distance is  tensor(12.5039, device='cuda:0')
cal ratio is  0.8693493038359218
distance 1 is tensor(149.0210, device='cuda:0')
distance 2 is tensor(10.8702, device='cuda:0')
cal_distance is  tensor(10.8702, device='cuda:0')
distance 1 is tensor(149.0210, device='cuda:0')
distance 2 is tensor(10.8702, device='cuda:0')
________________________________
test distance is  tensor(10.8702, device='cuda:0')
test similarity is  tensor(0.9464, device='cuda:0')
test acc is  0.8103833334896584
test loss is 78.32286087231341
test entropy is  0.016634459928860423
________________________________
distance 1 is tensor(149.0210, device='cuda:0')
distance 2 is tensor(10.8702, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.01631169092114312
avg test loss is  78.62335863906438
avg accuracy is  0.8088333334896584
solo acc is  0.26001666682300534
compute similarity  is  tensor(0.9464, device='cuda:0')
compute_distance is  tensor(10.8702, device='cuda:0')
compute_norm is  tensor(50.3006, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(138.1908, device='cuda:0')
distance 2 is tensor(12.3129, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9755208945350606
avg test loss is  1.6101227550110075
avg accuracy is  0.8418166668229904
solo acc is  0.29658333348967275
compute similarity  is  tensor(0.9480, device='cuda:0')
compute_distance is  tensor(12.3129, device='cuda:0')
compute_norm is  tensor(49.1924, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.2672, device='cuda:0')
distance 2 is tensor(12.6266, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9440585448543655
avg test loss is  1.6471562898997814
avg accuracy is  0.8394000001563239
solo acc is  0.25153333348967166
compute similarity  is  tensor(0.9476, device='cuda:0')
compute_distance is  tensor(12.6266, device='cuda:0')
compute_norm is  tensor(48.8877, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.0193, device='cuda:0')
distance 2 is tensor(12.8557, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9270625037552197
avg test loss is  1.5928145963500049
avg accuracy is  0.8406166668229904
solo acc is  0.25330000015633836
compute similarity  is  tensor(0.9473, device='cuda:0')
compute_distance is  tensor(12.8557, device='cuda:0')
compute_norm is  tensor(48.6063, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.6871, device='cuda:0')
distance 2 is tensor(13.0464, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.914286586203809
avg test loss is  1.5544185923106635
avg accuracy is  0.841883333489657
solo acc is  0.25475000015633836
compute similarity  is  tensor(0.9470, device='cuda:0')
compute_distance is  tensor(13.0464, device='cuda:0')
compute_norm is  tensor(48.3367, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.3553, device='cuda:0')
distance 2 is tensor(13.2205, device='cuda:0')
________________________________
test distance is  tensor(13.2205, device='cuda:0')
test similarity is  tensor(0.9467, device='cuda:0')
test acc is  0.844683333489657
test loss is 1.5299117305893888
test entropy is  0.9022425047751429
________________________________
cal ratio is  0.8454605025856956
distance 1 is tensor(122.8930, device='cuda:0')
distance 2 is tensor(11.1774, device='cuda:0')
cal_distance is  tensor(11.1774, device='cuda:0')
distance 1 is tensor(122.8930, device='cuda:0')
distance 2 is tensor(11.1774, device='cuda:0')
________________________________
test distance is  tensor(11.1774, device='cuda:0')
test similarity is  tensor(0.9620, device='cuda:0')
test acc is  0.8677000001563226
test loss is 1.0618761796941127
test entropy is  0.9677044166557824
________________________________
distance 1 is tensor(122.8930, device='cuda:0')
distance 2 is tensor(11.1774, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9673949419689585
avg test loss is  1.061224430608851
avg accuracy is  0.8687666668229893
solo acc is  0.535366666823009
compute similarity  is  tensor(0.9620, device='cuda:0')
compute_distance is  tensor(11.1774, device='cuda:0')
compute_norm is  tensor(48.0420, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(126.8619, device='cuda:0')
distance 2 is tensor(11.6394, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8924533435657843
avg test loss is  1.5159436737550602
avg accuracy is  0.8595166668229897
solo acc is  0.25413333348967176
compute similarity  is  tensor(0.9609, device='cuda:0')
compute_distance is  tensor(11.6394, device='cuda:0')
compute_norm is  tensor(47.7752, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.1995, device='cuda:0')
distance 2 is tensor(11.8600, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8863486616469142
avg test loss is  1.4777279951170819
avg accuracy is  0.8600666668229896
solo acc is  0.25778333348967186
compute similarity  is  tensor(0.9605, device='cuda:0')
compute_distance is  tensor(11.8600, device='cuda:0')
compute_norm is  tensor(47.5165, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.3341, device='cuda:0')
distance 2 is tensor(12.0481, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8699463800962037
avg test loss is  1.4692236277848674
avg accuracy is  0.8622166668229895
solo acc is  0.25386666682300507
compute similarity  is  tensor(0.9601, device='cuda:0')
compute_distance is  tensor(12.0481, device='cuda:0')
compute_norm is  tensor(47.2652, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.3320, device='cuda:0')
distance 2 is tensor(12.2106, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8636732063313791
avg test loss is  1.443285959234624
avg accuracy is  0.8641166668229895
solo acc is  0.2548333334896718
compute similarity  is  tensor(0.9598, device='cuda:0')
compute_distance is  tensor(12.2106, device='cuda:0')
compute_norm is  tensor(47.0185, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.3445, device='cuda:0')
distance 2 is tensor(12.3726, device='cuda:0')
________________________________
test distance is  tensor(12.3726, device='cuda:0')
test similarity is  tensor(0.9595, device='cuda:0')
test acc is  0.8655500001563228
test loss is 1.4289723189909067
test entropy is  0.86239532227201
________________________________
cal ratio is  0.8739495791124485
distance 1 is tensor(118.2848, device='cuda:0')
distance 2 is tensor(10.8130, device='cuda:0')
cal_distance is  tensor(10.8130, device='cuda:0')
distance 1 is tensor(118.2848, device='cuda:0')
distance 2 is tensor(10.8130, device='cuda:0')
________________________________
test distance is  tensor(10.8130, device='cuda:0')
test similarity is  tensor(0.9694, device='cuda:0')
test acc is  0.8813000001563221
test loss is 1.0069108738192618
test entropy is  0.9308003689815749
________________________________
distance 1 is tensor(118.2848, device='cuda:0')
distance 2 is tensor(10.8130, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9305650327505588
avg test loss is  1.006170853813574
avg accuracy is  0.8805333334896555
solo acc is  0.5400333334896757
compute similarity  is  tensor(0.9694, device='cuda:0')
compute_distance is  tensor(10.8130, device='cuda:0')
compute_norm is  tensor(46.9481, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(122.2603, device='cuda:0')
distance 2 is tensor(11.2455, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8585488590350283
avg test loss is  1.4180825282769924
avg accuracy is  0.8735833334896558
solo acc is  0.2575666668230052
compute similarity  is  tensor(0.9683, device='cuda:0')
compute_distance is  tensor(11.2455, device='cuda:0')
compute_norm is  tensor(46.7070, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(124.7484, device='cuda:0')
distance 2 is tensor(11.4542, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8518612469310192
avg test loss is  1.4047338465637744
avg accuracy is  0.8757333334896557
solo acc is  0.2555500001563385
compute similarity  is  tensor(0.9678, device='cuda:0')
compute_distance is  tensor(11.4542, device='cuda:0')
compute_norm is  tensor(46.4658, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(127.0041, device='cuda:0')
distance 2 is tensor(11.6362, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8462355957229508
avg test loss is  1.390741174027864
avg accuracy is  0.8770833334896557
solo acc is  0.25365000015633843
compute similarity  is  tensor(0.9674, device='cuda:0')
compute_distance is  tensor(11.6362, device='cuda:0')
compute_norm is  tensor(46.2278, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.1933, device='cuda:0')
distance 2 is tensor(11.8069, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8381222958630844
avg test loss is  1.3842999810603127
avg accuracy is  0.8794000001563221
solo acc is  0.25070000015633825
compute similarity  is  tensor(0.9671, device='cuda:0')
compute_distance is  tensor(11.8069, device='cuda:0')
compute_norm is  tensor(45.9928, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.3463, device='cuda:0')
distance 2 is tensor(11.9695, device='cuda:0')
________________________________
test distance is  tensor(11.9695, device='cuda:0')
test similarity is  tensor(0.9668, device='cuda:0')
test acc is  0.8781333334896556
test loss is 1.3656764737070242
test entropy is  0.8328675545100719
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2748887538909912
mal norm is  tensor(5.8317, device='cuda:0')
distance 1 is tensor(131.3463, device='cuda:0')
distance 2 is tensor(11.9695, device='cuda:0')
mal distance is  tensor(11.9695, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1900, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(426.8055, device='cuda:0')
c is  tensor(0.0211, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.0252, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.0665, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.5046, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.5737e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(478.2768, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.7189, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.5841e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.1316, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.7208, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.1027e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1663, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 2
len all weights is 2
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 92.04% 

Test Accuracy: 89.43% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1357564628124237
distance 1 is tensor(113.6585, device='cuda:0')
distance 2 is tensor(8.3183, device='cuda:0')
benign distance is  tensor(8.3183, device='cuda:0')
norm1 res is  tensor(0.1278, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.28910747170448303
distance 1 is tensor(143.5502, device='cuda:0')
distance 2 is tensor(10.3958, device='cuda:0')
benign distance is  tensor(10.3958, device='cuda:0')
norm1 res is  tensor(0.1602, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.00392568577080965
distance 1 is tensor(113.7917, device='cuda:0')
distance 2 is tensor(8.1345, device='cuda:0')
benign distance is  tensor(8.1345, device='cuda:0')
norm1 res is  tensor(0.1230, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.7871254682540894
distance 1 is tensor(144.3985, device='cuda:0')
distance 2 is tensor(10.4356, device='cuda:0')
benign distance is  tensor(10.4356, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.22895272076129913
distance 1 is tensor(145.0537, device='cuda:0')
distance 2 is tensor(10.4860, device='cuda:0')
benign distance is  tensor(10.4860, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5212898254394531
distance 1 is tensor(153.6845, device='cuda:0')
distance 2 is tensor(11.3055, device='cuda:0')
benign distance is  tensor(11.3055, device='cuda:0')
norm1 res is  tensor(0.1724, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.3145515024662018
distance 1 is tensor(98.2371, device='cuda:0')
distance 2 is tensor(7.1472, device='cuda:0')
benign distance is  tensor(7.1472, device='cuda:0')
norm1 res is  tensor(0.1080, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.0738091841340065
distance 1 is tensor(153.3949, device='cuda:0')
distance 2 is tensor(11.0887, device='cuda:0')
benign distance is  tensor(11.0887, device='cuda:0')
norm1 res is  tensor(0.1720, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(156.0416, device='cuda:0')
distance 2 is tensor(11.2686, device='cuda:0')
compute distance is  tensor(11.2686, device='cuda:0')
compute norm is  tensor(51.0707, device='cuda:0')
distance 1 is tensor(162.4080, device='cuda:0')
distance 2 is tensor(11.6415, device='cuda:0')
compute distance is  tensor(11.6415, device='cuda:0')
compute norm is  tensor(51.1387, device='cuda:0')
distance 1 is tensor(170.8097, device='cuda:0')
distance 2 is tensor(12.2293, device='cuda:0')
compute distance is  tensor(12.2293, device='cuda:0')
compute norm is  tensor(51.3634, device='cuda:0')
distance 1 is tensor(161.3337, device='cuda:0')
distance 2 is tensor(11.5964, device='cuda:0')
compute distance is  tensor(11.5964, device='cuda:0')
compute norm is  tensor(51.1520, device='cuda:0')
distance 1 is tensor(173.6826, device='cuda:0')
distance 2 is tensor(12.5676, device='cuda:0')
compute distance is  tensor(12.5676, device='cuda:0')
compute norm is  tensor(51.3549, device='cuda:0')
distance 1 is tensor(157.7346, device='cuda:0')
distance 2 is tensor(11.2495, device='cuda:0')
compute distance is  tensor(11.2495, device='cuda:0')
compute norm is  tensor(51.1960, device='cuda:0')
distance 1 is tensor(171.9241, device='cuda:0')
distance 2 is tensor(12.4824, device='cuda:0')
compute distance is  tensor(12.4824, device='cuda:0')
compute norm is  tensor(51.6417, device='cuda:0')
distance 1 is tensor(162.2704, device='cuda:0')
distance 2 is tensor(11.8191, device='cuda:0')
compute distance is  tensor(11.8191, device='cuda:0')
compute norm is  tensor(51.2104, device='cuda:0')
distance 1 is tensor(162.7246, device='cuda:0')
distance 2 is tensor(11.8082, device='cuda:0')
compute distance is  tensor(11.8082, device='cuda:0')
compute norm is  tensor(51.3253, device='cuda:0')
distance 1 is tensor(160.3958, device='cuda:0')
distance 2 is tensor(11.8441, device='cuda:0')
compute distance is  tensor(11.8441, device='cuda:0')
compute norm is  tensor(51.2431, device='cuda:0')
distance 1 is tensor(155.1489, device='cuda:0')
distance 2 is tensor(11.2953, device='cuda:0')
compute distance is  tensor(11.2953, device='cuda:0')
compute norm is  tensor(51.1004, device='cuda:0')
distance 1 is tensor(149.3805, device='cuda:0')
distance 2 is tensor(10.7495, device='cuda:0')
compute distance is  tensor(10.7495, device='cuda:0')
compute norm is  tensor(50.9649, device='cuda:0')
distance Threshold  is  tensor(12.5676, device='cuda:0')
distance 1 is tensor(1009218.9375, device='cuda:0')
distance 2 is tensor(73619.9141, device='cuda:0')
________________________________
test distance is  tensor(73619.9141, device='cuda:0')
test similarity is  tensor(-0.1023, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82451968897419e+17
test entropy is  0.0
________________________________
cal ratio is  0.01175899477616491
distance 1 is tensor(11867.4053, device='cuda:0')
distance 2 is tensor(865.6961, device='cuda:0')
cal_distance is  tensor(865.6961, device='cuda:0')
cal ratio is  0.10843890220995603
distance 1 is tensor(1286.8939, device='cuda:0')
distance 2 is tensor(93.8751, device='cuda:0')
cal_distance is  tensor(93.8751, device='cuda:0')
cal ratio is  0.3293006299439425
distance 1 is tensor(423.7790, device='cuda:0')
distance 2 is tensor(30.9131, device='cuda:0')
cal_distance is  tensor(30.9131, device='cuda:0')
cal ratio is  0.5738472269928532
distance 1 is tensor(243.1870, device='cuda:0')
distance 2 is tensor(17.7394, device='cuda:0')
cal_distance is  tensor(17.7394, device='cuda:0')
cal ratio is  0.757527010124518
distance 1 is tensor(184.2221, device='cuda:0')
distance 2 is tensor(13.4381, device='cuda:0')
cal_distance is  tensor(13.4381, device='cuda:0')
cal ratio is  0.8703602954061195
distance 1 is tensor(160.3404, device='cuda:0')
distance 2 is tensor(11.6960, device='cuda:0')
cal_distance is  tensor(11.6960, device='cuda:0')
distance 1 is tensor(160.3404, device='cuda:0')
distance 2 is tensor(11.6960, device='cuda:0')
________________________________
test distance is  tensor(11.6960, device='cuda:0')
test similarity is  tensor(0.9403, device='cuda:0')
test acc is  0.7517666668229945
test loss is 131.40894360735473
test entropy is  0.008730619498670532
________________________________
distance 1 is tensor(160.3404, device='cuda:0')
distance 2 is tensor(11.6960, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.00868744881820047
avg test loss is  131.25817175663866
avg accuracy is  0.7552000001563277
solo acc is  0.18425000015633555
compute similarity  is  tensor(0.9403, device='cuda:0')
compute_distance is  tensor(11.6960, device='cuda:0')
compute_norm is  tensor(51.2380, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.3607, device='cuda:0')
distance 2 is tensor(13.0897, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.0219176837376185
avg test loss is  1.6038121170580768
avg accuracy is  0.8188166668229914
solo acc is  0.3026500001563395
compute similarity  is  tensor(0.9432, device='cuda:0')
compute_distance is  tensor(13.0897, device='cuda:0')
compute_norm is  tensor(50.1634, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.4632, device='cuda:0')
distance 2 is tensor(13.3963, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9521923009266478
avg test loss is  1.6815527265768315
avg accuracy is  0.8157500001563248
solo acc is  0.24875000015633822
compute similarity  is  tensor(0.9428, device='cuda:0')
compute_distance is  tensor(13.3963, device='cuda:0')
compute_norm is  tensor(49.8643, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.2742, device='cuda:0')
distance 2 is tensor(13.6261, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9424125376159448
avg test loss is  1.6317536351777344
avg accuracy is  0.8183833334896579
solo acc is  0.24243333348967142
compute similarity  is  tensor(0.9424, device='cuda:0')
compute_distance is  tensor(13.6261, device='cuda:0')
compute_norm is  tensor(49.5831, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.0009, device='cuda:0')
distance 2 is tensor(13.8178, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.9231215822798357
avg test loss is  1.5982774513870923
avg accuracy is  0.819683333489658
solo acc is  0.24593333348967147
compute similarity  is  tensor(0.9421, device='cuda:0')
compute_distance is  tensor(13.8178, device='cuda:0')
compute_norm is  tensor(49.3133, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.6167, device='cuda:0')
distance 2 is tensor(13.9806, device='cuda:0')
________________________________
test distance is  tensor(13.9806, device='cuda:0')
test similarity is  tensor(0.9419, device='cuda:0')
test acc is  0.8248666668229911
test loss is 1.5654810181558767
test entropy is  0.9152388181894827
________________________________
cal ratio is  0.8533056937633394
distance 1 is tensor(131.9360, device='cuda:0')
distance 2 is tensor(11.9297, device='cuda:0')
cal_distance is  tensor(11.9297, device='cuda:0')
distance 1 is tensor(131.9360, device='cuda:0')
distance 2 is tensor(11.9297, device='cuda:0')
________________________________
test distance is  tensor(11.9297, device='cuda:0')
test similarity is  tensor(0.9576, device='cuda:0')
test acc is  0.8498333334896567
test loss is 1.1395499135004177
test entropy is  0.9890824913470222
________________________________
distance 1 is tensor(131.9360, device='cuda:0')
distance 2 is tensor(11.9297, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9894938454317894
avg test loss is  1.1410787929731137
avg accuracy is  0.8509333334896567
solo acc is  0.493150000156342
compute similarity  is  tensor(0.9576, device='cuda:0')
compute_distance is  tensor(11.9297, device='cuda:0')
compute_norm is  tensor(48.9539, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.7312, device='cuda:0')
distance 2 is tensor(12.3765, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.910238118250487
avg test loss is  1.5475309703395819
avg accuracy is  0.8406166668229904
solo acc is  0.2465666668230048
compute similarity  is  tensor(0.9566, device='cuda:0')
compute_distance is  tensor(12.3765, device='cuda:0')
compute_norm is  tensor(48.6834, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.0065, device='cuda:0')
distance 2 is tensor(12.5911, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9065687200789259
avg test loss is  1.505142473081536
avg accuracy is  0.8433833334896569
solo acc is  0.25328333348967164
compute similarity  is  tensor(0.9562, device='cuda:0')
compute_distance is  tensor(12.5911, device='cuda:0')
compute_norm is  tensor(48.4250, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.0776, device='cuda:0')
distance 2 is tensor(12.7788, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8852612996406393
avg test loss is  1.5141035908066642
avg accuracy is  0.8461833334896569
solo acc is  0.24088333348967125
compute similarity  is  tensor(0.9558, device='cuda:0')
compute_distance is  tensor(12.7788, device='cuda:0')
compute_norm is  tensor(48.1712, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.0786, device='cuda:0')
distance 2 is tensor(12.9472, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8818523489208873
avg test loss is  1.4834220387788215
avg accuracy is  0.8466833334896569
solo acc is  0.24518333348967147
compute similarity  is  tensor(0.9555, device='cuda:0')
compute_distance is  tensor(12.9472, device='cuda:0')
compute_norm is  tensor(47.9219, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.0382, device='cuda:0')
distance 2 is tensor(13.1058, device='cuda:0')
________________________________
test distance is  tensor(13.1058, device='cuda:0')
test similarity is  tensor(0.9551, device='cuda:0')
test acc is  0.8502000001563234
test loss is 1.478709893503677
test entropy is  0.8766771816114373
________________________________
cal ratio is  0.8813237078258166
distance 1 is tensor(126.9449, device='cuda:0')
distance 2 is tensor(11.5505, device='cuda:0')
cal_distance is  tensor(11.5505, device='cuda:0')
distance 1 is tensor(126.9449, device='cuda:0')
distance 2 is tensor(11.5505, device='cuda:0')
________________________________
test distance is  tensor(11.5505, device='cuda:0')
test similarity is  tensor(0.9654, device='cuda:0')
test acc is  0.8633333334896562
test loss is 1.1027160843552302
test entropy is  0.9429436541442424
________________________________
distance 1 is tensor(126.9449, device='cuda:0')
distance 2 is tensor(11.5505, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9424621748771749
avg test loss is  1.098735957575251
avg accuracy is  0.8642500001563227
solo acc is  0.4851833334896753
compute similarity  is  tensor(0.9654, device='cuda:0')
compute_distance is  tensor(11.5505, device='cuda:0')
compute_norm is  tensor(47.7954, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.6353, device='cuda:0')
distance 2 is tensor(11.9443, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8764437825313763
avg test loss is  1.4423574974287803
avg accuracy is  0.8596166668229897
solo acc is  0.2569666668230051
compute similarity  is  tensor(0.9644, device='cuda:0')
compute_distance is  tensor(11.9443, device='cuda:0')
compute_norm is  tensor(47.5485, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.1345, device='cuda:0')
distance 2 is tensor(12.1483, device='cuda:0')
exit early
distance 1 is tensor(133.1345, device='cuda:0')
distance 2 is tensor(12.1483, device='cuda:0')
________________________________
test distance is  tensor(12.1483, device='cuda:0')
test similarity is  tensor(0.9640, device='cuda:0')
test acc is  0.8608166668229896
test loss is 1.4466655441184542
test entropy is  0.8600316922039365
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2824031114578247
mal norm is  tensor(6.0972, device='cuda:0')
distance 1 is tensor(133.1345, device='cuda:0')
distance 2 is tensor(12.1483, device='cuda:0')
mal distance is  tensor(12.1483, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.0840, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.7528, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.0961, device='cuda:0')
c is  tensor(0.0115, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(487.6036, device='cuda:0')
c is  tensor(0.0131, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.8033, device='cuda:0')
c is  tensor(0.0116, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.0569, device='cuda:0')
c is  tensor(0.0115, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.7345e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.9635, device='cuda:0')
c is  tensor(0.0111, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(425.6645, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.9621, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.2214e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7238, device='cuda:0')
c is  tensor(0.0117, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.6855, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.9807, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.8260e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(724.7398, device='cuda:0')
c is  tensor(0.0108, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.7703, device='cuda:0')
c is  tensor(0.0111, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.5094, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.3905e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.7890, device='cuda:0')
c is  tensor(0.0111, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.4900e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.0140, device='cuda:0')
c is  tensor(0.0113, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.2392e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8713, device='cuda:0')
c is  tensor(0.0109, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.0056, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1684e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.9417, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3902e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.3949, device='cuda:0')
c is  tensor(0.0115, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.1904e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.9175, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.7361e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.6942, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.4828e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.6533, device='cuda:0')
c is  tensor(0.0115, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.1453e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.1072, device='cuda:0')
c is  tensor(0.0111, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.6147e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.4496, device='cuda:0')
c is  tensor(0.0112, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.2379e-05, device='cuda:0')
len accept list 34
len all weights is 34
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 91.77% 

Test Accuracy: 89.18% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3052803874015808
distance 1 is tensor(121.6958, device='cuda:0')
distance 2 is tensor(8.9246, device='cuda:0')
benign distance is  tensor(8.9246, device='cuda:0')
norm1 res is  tensor(0.1325, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5548766851425171
distance 1 is tensor(146.5499, device='cuda:0')
distance 2 is tensor(10.5682, device='cuda:0')
benign distance is  tensor(10.5682, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.31212449073791504
distance 1 is tensor(123.4609, device='cuda:0')
distance 2 is tensor(8.8151, device='cuda:0')
benign distance is  tensor(8.8151, device='cuda:0')
norm1 res is  tensor(0.1319, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6613594889640808
distance 1 is tensor(137.1451, device='cuda:0')
distance 2 is tensor(9.9095, device='cuda:0')
benign distance is  tensor(9.9095, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6015680432319641
distance 1 is tensor(119.2331, device='cuda:0')
distance 2 is tensor(8.6100, device='cuda:0')
benign distance is  tensor(8.6100, device='cuda:0')
norm1 res is  tensor(0.1292, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.1006147861480713
distance 1 is tensor(156.6394, device='cuda:0')
distance 2 is tensor(11.2139, device='cuda:0')
benign distance is  tensor(11.2139, device='cuda:0')
norm1 res is  tensor(0.1694, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.08190342783927917
distance 1 is tensor(115.4425, device='cuda:0')
distance 2 is tensor(8.2205, device='cuda:0')
benign distance is  tensor(8.2205, device='cuda:0')
norm1 res is  tensor(0.1218, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.252959668636322
distance 1 is tensor(157.3861, device='cuda:0')
distance 2 is tensor(11.4426, device='cuda:0')
benign distance is  tensor(11.4426, device='cuda:0')
norm1 res is  tensor(0.1682, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.30852067470550537
distance 1 is tensor(157.8539, device='cuda:0')
distance 2 is tensor(11.2402, device='cuda:0')
benign distance is  tensor(11.2402, device='cuda:0')
norm1 res is  tensor(0.1663, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9326833486557007
distance 1 is tensor(161.2994, device='cuda:0')
distance 2 is tensor(11.5667, device='cuda:0')
benign distance is  tensor(11.5667, device='cuda:0')
norm1 res is  tensor(0.1728, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.4313977360725403
distance 1 is tensor(134.9838, device='cuda:0')
distance 2 is tensor(9.7503, device='cuda:0')
benign distance is  tensor(9.7503, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.356738418340683
distance 1 is tensor(149.2823, device='cuda:0')
distance 2 is tensor(10.8377, device='cuda:0')
benign distance is  tensor(10.8377, device='cuda:0')
norm1 res is  tensor(0.1604, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.13099931180477142
distance 1 is tensor(149.1778, device='cuda:0')
distance 2 is tensor(10.7865, device='cuda:0')
benign distance is  tensor(10.7865, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.043047014623880386
distance 1 is tensor(149.4142, device='cuda:0')
distance 2 is tensor(10.8873, device='cuda:0')
benign distance is  tensor(10.8873, device='cuda:0')
norm1 res is  tensor(0.1593, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.32279786467552185
distance 1 is tensor(136.8057, device='cuda:0')
distance 2 is tensor(10.0633, device='cuda:0')
benign distance is  tensor(10.0633, device='cuda:0')
norm1 res is  tensor(0.1498, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.8991111516952515
distance 1 is tensor(151.3683, device='cuda:0')
distance 2 is tensor(10.9719, device='cuda:0')
benign distance is  tensor(10.9719, device='cuda:0')
norm1 res is  tensor(0.1647, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.4996282458305359
distance 1 is tensor(151.7932, device='cuda:0')
distance 2 is tensor(11.1126, device='cuda:0')
benign distance is  tensor(11.1126, device='cuda:0')
norm1 res is  tensor(0.1647, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.13454334437847137
distance 1 is tensor(145.0110, device='cuda:0')
distance 2 is tensor(10.3235, device='cuda:0')
benign distance is  tensor(10.3235, device='cuda:0')
norm1 res is  tensor(0.1534, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.827284038066864
distance 1 is tensor(165.5685, device='cuda:0')
distance 2 is tensor(11.8950, device='cuda:0')
benign distance is  tensor(11.8950, device='cuda:0')
norm1 res is  tensor(0.1742, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.33234310150146484
distance 1 is tensor(149.2783, device='cuda:0')
distance 2 is tensor(10.7707, device='cuda:0')
benign distance is  tensor(10.7707, device='cuda:0')
norm1 res is  tensor(0.1602, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.8514540791511536
distance 1 is tensor(152.6011, device='cuda:0')
distance 2 is tensor(10.8619, device='cuda:0')
benign distance is  tensor(10.8619, device='cuda:0')
norm1 res is  tensor(0.1634, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.44648489356040955
distance 1 is tensor(147.9253, device='cuda:0')
distance 2 is tensor(10.7633, device='cuda:0')
benign distance is  tensor(10.7633, device='cuda:0')
norm1 res is  tensor(0.1564, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.2789602279663086
distance 1 is tensor(153.5576, device='cuda:0')
distance 2 is tensor(11.3053, device='cuda:0')
benign distance is  tensor(11.3053, device='cuda:0')
norm1 res is  tensor(0.1656, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.603622555732727
distance 1 is tensor(162.2944, device='cuda:0')
distance 2 is tensor(11.8998, device='cuda:0')
benign distance is  tensor(11.8998, device='cuda:0')
norm1 res is  tensor(0.1768, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(159.4874, device='cuda:0')
distance 2 is tensor(11.6793, device='cuda:0')
compute distance is  tensor(11.6793, device='cuda:0')
compute norm is  tensor(51.2343, device='cuda:0')
distance 1 is tensor(153.1871, device='cuda:0')
distance 2 is tensor(11.3062, device='cuda:0')
compute distance is  tensor(11.3062, device='cuda:0')
compute norm is  tensor(51.2684, device='cuda:0')
distance 1 is tensor(164.0361, device='cuda:0')
distance 2 is tensor(12.1296, device='cuda:0')
compute distance is  tensor(12.1296, device='cuda:0')
compute norm is  tensor(51.6199, device='cuda:0')
distance 1 is tensor(149.5025, device='cuda:0')
distance 2 is tensor(11.0282, device='cuda:0')
compute distance is  tensor(11.0282, device='cuda:0')
compute norm is  tensor(51.2588, device='cuda:0')
distance 1 is tensor(158.2727, device='cuda:0')
distance 2 is tensor(11.6253, device='cuda:0')
compute distance is  tensor(11.6253, device='cuda:0')
compute norm is  tensor(51.4078, device='cuda:0')
distance 1 is tensor(168.7108, device='cuda:0')
distance 2 is tensor(12.3971, device='cuda:0')
compute distance is  tensor(12.3971, device='cuda:0')
compute norm is  tensor(51.7589, device='cuda:0')
distance 1 is tensor(166.8502, device='cuda:0')
distance 2 is tensor(12.2661, device='cuda:0')
compute distance is  tensor(12.2661, device='cuda:0')
compute norm is  tensor(51.6238, device='cuda:0')
distance 1 is tensor(166.5534, device='cuda:0')
distance 2 is tensor(12.3555, device='cuda:0')
compute distance is  tensor(12.3555, device='cuda:0')
compute norm is  tensor(51.6925, device='cuda:0')
distance 1 is tensor(148.5173, device='cuda:0')
distance 2 is tensor(11.1103, device='cuda:0')
compute distance is  tensor(11.1103, device='cuda:0')
compute norm is  tensor(51.2439, device='cuda:0')
distance 1 is tensor(158.9372, device='cuda:0')
distance 2 is tensor(11.7360, device='cuda:0')
compute distance is  tensor(11.7360, device='cuda:0')
compute norm is  tensor(51.3062, device='cuda:0')
distance 1 is tensor(163.0078, device='cuda:0')
distance 2 is tensor(12.1016, device='cuda:0')
compute distance is  tensor(12.1016, device='cuda:0')
compute norm is  tensor(51.5822, device='cuda:0')
distance 1 is tensor(156.4005, device='cuda:0')
distance 2 is tensor(11.5530, device='cuda:0')
compute distance is  tensor(11.5530, device='cuda:0')
compute norm is  tensor(51.3723, device='cuda:0')
distance Threshold  is  tensor(12.3971, device='cuda:0')
distance 1 is tensor(1009201.5625, device='cuda:0')
distance 2 is tensor(73618.0781, device='cuda:0')
________________________________
test distance is  tensor(73618.0781, device='cuda:0')
test similarity is  tensor(-0.0447, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.824464666505312e+17
test entropy is  0.0
________________________________
cal ratio is  0.011679130108765317
distance 1 is tensor(11786.6025, device='cuda:0')
distance 2 is tensor(859.7951, device='cuda:0')
cal_distance is  tensor(859.7951, device='cuda:0')
cal ratio is  0.10807002463454438
distance 1 is tensor(1273.7837, device='cuda:0')
distance 2 is tensor(92.9181, device='cuda:0')
cal_distance is  tensor(92.9181, device='cuda:0')
cal ratio is  0.3287400543862402
distance 1 is tensor(418.7477, device='cuda:0')
distance 2 is tensor(30.5459, device='cuda:0')
cal_distance is  tensor(30.5459, device='cuda:0')
cal ratio is  0.5733586030989453
distance 1 is tensor(240.0952, device='cuda:0')
distance 2 is tensor(17.5138, device='cuda:0')
cal_distance is  tensor(17.5138, device='cuda:0')
cal ratio is  0.7572044186309773
distance 1 is tensor(181.8026, device='cuda:0')
distance 2 is tensor(13.2615, device='cuda:0')
cal_distance is  tensor(13.2615, device='cuda:0')
cal ratio is  0.8701749192939257
distance 1 is tensor(158.2009, device='cuda:0')
distance 2 is tensor(11.5398, device='cuda:0')
cal_distance is  tensor(11.5398, device='cuda:0')
distance 1 is tensor(158.2009, device='cuda:0')
distance 2 is tensor(11.5398, device='cuda:0')
________________________________
test distance is  tensor(11.5398, device='cuda:0')
test similarity is  tensor(0.9405, device='cuda:0')
test acc is  0.583600000156339
test loss is 155.23978225610404
test entropy is  0.002444009674955226
________________________________
distance 1 is tensor(158.2009, device='cuda:0')
distance 2 is tensor(11.5398, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0025238017270795376
avg test loss is  155.52213040902924
avg accuracy is  0.5827500001563389
solo acc is  0.11371666682299862
compute similarity  is  tensor(0.9405, device='cuda:0')
compute_distance is  tensor(11.5398, device='cuda:0')
compute_norm is  tensor(50.6036, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(142.6353, device='cuda:0')
distance 2 is tensor(12.3335, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.990455453266213
avg test loss is  1.5494933705340062
avg accuracy is  0.7505333334896611
solo acc is  0.29780000015633945
compute similarity  is  tensor(0.9437, device='cuda:0')
compute_distance is  tensor(12.3335, device='cuda:0')
compute_norm is  tensor(49.8270, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(142.6353, device='cuda:0')
distance 2 is tensor(12.3335, device='cuda:0')
________________________________
test distance is  tensor(12.3335, device='cuda:0')
test similarity is  tensor(0.9437, device='cuda:0')
test acc is  0.7489833334896613
test loss is 1.5461634869006142
test entropy is  0.9887889426654336
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.5610926151275635
mal norm is  tensor(7.5886, device='cuda:0')
distance 1 is tensor(142.6353, device='cuda:0')
distance 2 is tensor(12.3335, device='cuda:0')
mal distance is  tensor(12.3335, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1939, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.5696, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1539, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(515.7756, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.1341e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.0753, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.1620, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.6642, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.1446, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.8718, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.8624, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.8159, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.7535, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.1601, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.0190, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.1190, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.4843, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.2081, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.3542e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.5609, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
len accept list 12
len all weights is 12
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 54.12% 

Test Accuracy: 53.19% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7339354753494263
distance 1 is tensor(251.1171, device='cuda:0')
distance 2 is tensor(19.1100, device='cuda:0')
benign distance is  tensor(19.1100, device='cuda:0')
norm1 res is  tensor(0.2426, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7134507298469543
distance 1 is tensor(249.1979, device='cuda:0')
distance 2 is tensor(18.9136, device='cuda:0')
benign distance is  tensor(18.9136, device='cuda:0')
norm1 res is  tensor(0.2380, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  1.0300543308258057
distance 1 is tensor(238.2648, device='cuda:0')
distance 2 is tensor(17.8219, device='cuda:0')
benign distance is  tensor(17.8219, device='cuda:0')
norm1 res is  tensor(0.2328, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.2792074680328369
distance 1 is tensor(240.5189, device='cuda:0')
distance 2 is tensor(18.1260, device='cuda:0')
benign distance is  tensor(18.1260, device='cuda:0')
norm1 res is  tensor(0.2354, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5646140575408936
distance 1 is tensor(266.9780, device='cuda:0')
distance 2 is tensor(19.8609, device='cuda:0')
benign distance is  tensor(19.8609, device='cuda:0')
norm1 res is  tensor(0.2537, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6314088106155396
distance 1 is tensor(239.2153, device='cuda:0')
distance 2 is tensor(18.3512, device='cuda:0')
benign distance is  tensor(18.3512, device='cuda:0')
norm1 res is  tensor(0.2340, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.4373513162136078
distance 1 is tensor(254.9107, device='cuda:0')
distance 2 is tensor(18.9599, device='cuda:0')
benign distance is  tensor(18.9599, device='cuda:0')
norm1 res is  tensor(0.2447, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.19695647060871124
distance 1 is tensor(241.3056, device='cuda:0')
distance 2 is tensor(18.3897, device='cuda:0')
benign distance is  tensor(18.3897, device='cuda:0')
norm1 res is  tensor(0.2363, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.20061969757080078
distance 1 is tensor(233.1598, device='cuda:0')
distance 2 is tensor(17.6989, device='cuda:0')
benign distance is  tensor(17.6989, device='cuda:0')
norm1 res is  tensor(0.2215, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.6743388175964355
distance 1 is tensor(266.6158, device='cuda:0')
distance 2 is tensor(19.8957, device='cuda:0')
benign distance is  tensor(19.8957, device='cuda:0')
norm1 res is  tensor(0.2553, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.40530282258987427
distance 1 is tensor(249.9096, device='cuda:0')
distance 2 is tensor(18.6650, device='cuda:0')
benign distance is  tensor(18.6650, device='cuda:0')
norm1 res is  tensor(0.2375, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.8841112852096558
distance 1 is tensor(228.1331, device='cuda:0')
distance 2 is tensor(17.3112, device='cuda:0')
benign distance is  tensor(17.3112, device='cuda:0')
norm1 res is  tensor(0.2225, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.5432847738265991
distance 1 is tensor(241.1275, device='cuda:0')
distance 2 is tensor(18.1987, device='cuda:0')
benign distance is  tensor(18.1987, device='cuda:0')
norm1 res is  tensor(0.2306, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.4003475904464722
distance 1 is tensor(238.1912, device='cuda:0')
distance 2 is tensor(18.0872, device='cuda:0')
benign distance is  tensor(18.0872, device='cuda:0')
norm1 res is  tensor(0.2262, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.46368011832237244
distance 1 is tensor(235.3033, device='cuda:0')
distance 2 is tensor(17.6894, device='cuda:0')
benign distance is  tensor(17.6894, device='cuda:0')
norm1 res is  tensor(0.2293, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.7896185517311096
distance 1 is tensor(236.4725, device='cuda:0')
distance 2 is tensor(17.9597, device='cuda:0')
benign distance is  tensor(17.9597, device='cuda:0')
norm1 res is  tensor(0.2250, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(209.6325, device='cuda:0')
distance 2 is tensor(16.5556, device='cuda:0')
compute distance is  tensor(16.5556, device='cuda:0')
compute norm is  tensor(51.0109, device='cuda:0')
distance 1 is tensor(201.5312, device='cuda:0')
distance 2 is tensor(16.1535, device='cuda:0')
compute distance is  tensor(16.1535, device='cuda:0')
compute norm is  tensor(50.9021, device='cuda:0')
distance 1 is tensor(217.6979, device='cuda:0')
distance 2 is tensor(17.0054, device='cuda:0')
compute distance is  tensor(17.0054, device='cuda:0')
compute norm is  tensor(51.2340, device='cuda:0')
distance 1 is tensor(211.4472, device='cuda:0')
distance 2 is tensor(16.6740, device='cuda:0')
compute distance is  tensor(16.6740, device='cuda:0')
compute norm is  tensor(51.1428, device='cuda:0')
distance 1 is tensor(220.4444, device='cuda:0')
distance 2 is tensor(17.2190, device='cuda:0')
compute distance is  tensor(17.2190, device='cuda:0')
compute norm is  tensor(51.4347, device='cuda:0')
distance 1 is tensor(226.1701, device='cuda:0')
distance 2 is tensor(17.5066, device='cuda:0')
compute distance is  tensor(17.5066, device='cuda:0')
compute norm is  tensor(51.5492, device='cuda:0')
distance 1 is tensor(221.0654, device='cuda:0')
distance 2 is tensor(17.3934, device='cuda:0')
compute distance is  tensor(17.3934, device='cuda:0')
compute norm is  tensor(51.3601, device='cuda:0')
distance 1 is tensor(209.1873, device='cuda:0')
distance 2 is tensor(16.4748, device='cuda:0')
compute distance is  tensor(16.4748, device='cuda:0')
compute norm is  tensor(51.1496, device='cuda:0')
distance 1 is tensor(212.5920, device='cuda:0')
distance 2 is tensor(16.7224, device='cuda:0')
compute distance is  tensor(16.7224, device='cuda:0')
compute norm is  tensor(51.2600, device='cuda:0')
distance 1 is tensor(217.7973, device='cuda:0')
distance 2 is tensor(17.1824, device='cuda:0')
compute distance is  tensor(17.1824, device='cuda:0')
compute norm is  tensor(51.3453, device='cuda:0')
distance 1 is tensor(213.8556, device='cuda:0')
distance 2 is tensor(16.7383, device='cuda:0')
compute distance is  tensor(16.7383, device='cuda:0')
compute norm is  tensor(51.2352, device='cuda:0')
distance 1 is tensor(206.4147, device='cuda:0')
distance 2 is tensor(16.4328, device='cuda:0')
compute distance is  tensor(16.4328, device='cuda:0')
compute norm is  tensor(51.1848, device='cuda:0')
distance Threshold  is  tensor(17.5066, device='cuda:0')
distance 1 is tensor(1009113.6250, device='cuda:0')
distance 2 is tensor(73610.6562, device='cuda:0')
________________________________
test distance is  tensor(73610.6562, device='cuda:0')
test similarity is  tensor(0.2093, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.8227676082574e+17
test entropy is  0.0
________________________________
cal ratio is  0.013879466811522844
distance 1 is tensor(14005.9648, device='cuda:0')
distance 2 is tensor(1021.6766, device='cuda:0')
cal_distance is  tensor(1021.6766, device='cuda:0')
cal ratio is  0.11781115212731902
distance 1 is tensor(1650.0643, device='cuda:0')
distance 2 is tensor(120.3649, device='cuda:0')
cal_distance is  tensor(120.3649, device='cuda:0')
cal ratio is  0.34323627621817937
distance 1 is tensor(566.3657, device='cuda:0')
distance 2 is tensor(41.3136, device='cuda:0')
cal_distance is  tensor(41.3136, device='cuda:0')
cal ratio is  0.5858637038489497
distance 1 is tensor(331.8156, device='cuda:0')
distance 2 is tensor(24.2041, device='cuda:0')
cal_distance is  tensor(24.2041, device='cuda:0')
cal ratio is  0.7654173464314352
distance 1 is tensor(253.9789, device='cuda:0')
distance 2 is tensor(18.5263, device='cuda:0')
cal_distance is  tensor(18.5263, device='cuda:0')
cal ratio is  0.8748813940453071
distance 1 is tensor(222.2021, device='cuda:0')
distance 2 is tensor(16.2083, device='cuda:0')
cal_distance is  tensor(16.2083, device='cuda:0')
distance 1 is tensor(222.2021, device='cuda:0')
distance 2 is tensor(16.2083, device='cuda:0')
________________________________
test distance is  tensor(16.2083, device='cuda:0')
test similarity is  tensor(0.9163, device='cuda:0')
test acc is  0.1005833334896653
test loss is 746.4626240354103
test entropy is  8.216568820667904e-47
________________________________
distance 1 is tensor(222.2021, device='cuda:0')
distance 2 is tensor(16.2083, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.5760637402936234e-34
avg test loss is  748.1115051790086
avg accuracy is  0.10066666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9163, device='cuda:0')
compute_distance is  tensor(16.2083, device='cuda:0')
compute_norm is  tensor(55.6716, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(240.6906, device='cuda:0')
distance 2 is tensor(22.0067, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.634738315524323
avg test loss is  2.7788991440079616
avg accuracy is  0.158850000156334
solo acc is  0.10245000015633197
compute similarity  is  tensor(0.9117, device='cuda:0')
compute_distance is  tensor(22.0067, device='cuda:0')
compute_norm is  tensor(57.3664, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(240.7211, device='cuda:0')
distance 2 is tensor(22.4015, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.927288975796974
avg test loss is  3.4806758386494
avg accuracy is  0.13441666682299858
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9111, device='cuda:0')
compute_distance is  tensor(22.4015, device='cuda:0')
compute_norm is  tensor(57.6655, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(238.9679, device='cuda:0')
distance 2 is tensor(21.8371, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  1.5335785261095205
avg test loss is  2.723970343054993
avg accuracy is  0.16563333348966777
solo acc is  0.11273333348966529
compute similarity  is  tensor(0.9117, device='cuda:0')
compute_distance is  tensor(21.8371, device='cuda:0')
compute_norm is  tensor(56.9242, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(239.0578, device='cuda:0')
distance 2 is tensor(22.1491, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8796583821397346
avg test loss is  3.3874339327883365
avg accuracy is  0.13503333348966523
solo acc is  0.10068333348966532
compute similarity  is  tensor(0.9112, device='cuda:0')
compute_distance is  tensor(22.1491, device='cuda:0')
compute_norm is  tensor(57.1440, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(238.5015, device='cuda:0')
distance 2 is tensor(21.5384, device='cuda:0')
________________________________
test distance is  tensor(21.5384, device='cuda:0')
test similarity is  tensor(0.9119, device='cuda:0')
test acc is  0.15985000015633405
test loss is 2.3945236406854984
test entropy is  1.3732896548852738
________________________________
cal ratio is  0.8114025656684253
distance 1 is tensor(193.5217, device='cuda:0')
distance 2 is tensor(17.4763, device='cuda:0')
cal_distance is  tensor(17.4763, device='cuda:0')
distance 1 is tensor(193.5217, device='cuda:0')
distance 2 is tensor(17.4763, device='cuda:0')
________________________________
test distance is  tensor(17.4763, device='cuda:0')
test similarity is  tensor(0.9377, device='cuda:0')
test acc is  0.19108333348966927
test loss is 2.2675758382913145
test entropy is  1.589011805271035
________________________________
distance 1 is tensor(193.5217, device='cuda:0')
distance 2 is tensor(17.4763, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.5902994303052613
avg test loss is  2.2684234939912744
avg accuracy is  0.19236666682300263
solo acc is  0.1274666668229986
compute similarity  is  tensor(0.9377, device='cuda:0')
compute_distance is  tensor(17.4763, device='cuda:0')
compute_norm is  tensor(54.4874, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(194.3687, device='cuda:0')
distance 2 is tensor(17.7630, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8434952614403991
avg test loss is  3.0602885596533573
avg accuracy is  0.13658333348966525
solo acc is  0.10225000015633197
compute similarity  is  tensor(0.9371, device='cuda:0')
compute_distance is  tensor(17.7630, device='cuda:0')
compute_norm is  tensor(54.6392, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(194.0155, device='cuda:0')
distance 2 is tensor(17.3343, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  1.2231674400219785
avg test loss is  2.0600440330596874
avg accuracy is  0.20171666682300313
solo acc is  0.1665833334896678
compute similarity  is  tensor(0.9376, device='cuda:0')
compute_distance is  tensor(17.3343, device='cuda:0')
compute_norm is  tensor(54.1905, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(194.1014, device='cuda:0')
distance 2 is tensor(17.4394, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.7340584130429509
avg test loss is  2.8236109117455066
avg accuracy is  0.14525000015633283
solo acc is  0.1058333334896653
compute similarity  is  tensor(0.9373, device='cuda:0')
compute_distance is  tensor(17.4394, device='cuda:0')
compute_norm is  tensor(54.1471, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(193.5798, device='cuda:0')
distance 2 is tensor(17.0798, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  1.0741619884586537
avg test loss is  1.7514235890750438
avg accuracy is  0.22320000015633734
solo acc is  0.223666666823004
compute similarity  is  tensor(0.9376, device='cuda:0')
compute_distance is  tensor(17.0798, device='cuda:0')
compute_norm is  tensor(53.6656, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(193.6918, device='cuda:0')
distance 2 is tensor(17.1541, device='cuda:0')
________________________________
test distance is  tensor(17.1541, device='cuda:0')
test similarity is  tensor(0.9373, device='cuda:0')
test acc is  0.15031666682299996
test loss is 2.5728844327967306
test entropy is  0.6702017531847395
________________________________
distance 1 is tensor(193.6918, device='cuda:0')
distance 2 is tensor(17.1541, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.6713887819730396
avg test loss is  2.5727333748010177
avg accuracy is  0.15070000015633328
solo acc is  0.10836666682299861
compute similarity  is  tensor(0.9373, device='cuda:0')
compute_distance is  tensor(17.1541, device='cuda:0')
compute_norm is  tensor(53.5500, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(193.9975, device='cuda:0')
distance 2 is tensor(16.9870, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.0297507756808673
avg test loss is  1.631510691475004
avg accuracy is  0.22950000015633756
solo acc is  0.2461333334896715
compute similarity  is  tensor(0.9373, device='cuda:0')
compute_distance is  tensor(16.9870, device='cuda:0')
compute_norm is  tensor(53.1615, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(194.2449, device='cuda:0')
distance 2 is tensor(17.0699, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.6526941239579654
avg test loss is  2.4695157650183006
avg accuracy is  0.15206666682300002
solo acc is  0.10898333348966528
compute similarity  is  tensor(0.9369, device='cuda:0')
compute_distance is  tensor(17.0699, device='cuda:0')
compute_norm is  tensor(53.0312, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(194.7694, device='cuda:0')
distance 2 is tensor(16.9730, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  1.0008765363744072
avg test loss is  1.5740309785932367
avg accuracy is  0.2284666668230042
solo acc is  0.2548666668230051
compute similarity  is  tensor(0.9368, device='cuda:0')
compute_distance is  tensor(16.9730, device='cuda:0')
compute_norm is  tensor(52.6749, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(195.0604, device='cuda:0')
distance 2 is tensor(17.0615, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.6435382315980346
avg test loss is  2.402281834753846
avg accuracy is  0.15241666682300012
solo acc is  0.10770000015633195
compute similarity  is  tensor(0.9364, device='cuda:0')
compute_distance is  tensor(17.0615, device='cuda:0')
compute_norm is  tensor(52.5356, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(195.7687, device='cuda:0')
distance 2 is tensor(17.0075, device='cuda:0')
________________________________
test distance is  tensor(17.0075, device='cuda:0')
test similarity is  tensor(0.9362, device='cuda:0')
test acc is  0.2279000001563375
test loss is 1.5388983768949123
test entropy is  0.9944147495572755
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.4023798704147339
mal norm is  tensor(8.5939, device='cuda:0')
distance 1 is tensor(195.7687, device='cuda:0')
distance 2 is tensor(17.0075, device='cuda:0')
mal distance is  tensor(17.0075, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.3994, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(964.4168, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0040, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(946.2410, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0032, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.2762, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0050, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(925.4835, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0049, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1011.9703, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0066, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(928.8768, device='cuda:0')
c is  tensor(0.0207, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0057, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(964.1595, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0045, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.8638, device='cuda:0')
c is  tensor(0.0207, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0041, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.3881, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(996.2271, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0035, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1592, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1010.7107, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0035, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1031.0856, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0036, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1013.4319, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.0671, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0034, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1003.3611, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0030, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1000.3922, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0035, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(920.9744, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0034, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(953.2706, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0025, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.8290, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0030, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.3264, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0030, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(902.3002, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(912.0853, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0028, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(881.3165, device='cuda:0')
c is  tensor(0.0213, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0033, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(920.5721, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0032, device='cuda:0')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 91.16% 

Test Accuracy: 89.00% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6838210225105286
distance 1 is tensor(148.7677, device='cuda:0')
distance 2 is tensor(10.9102, device='cuda:0')
benign distance is  tensor(10.9102, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8399218320846558
distance 1 is tensor(148.9693, device='cuda:0')
distance 2 is tensor(10.7911, device='cuda:0')
benign distance is  tensor(10.7911, device='cuda:0')
norm1 res is  tensor(0.1580, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.3989681601524353
distance 1 is tensor(138.5156, device='cuda:0')
distance 2 is tensor(10.0704, device='cuda:0')
benign distance is  tensor(10.0704, device='cuda:0')
norm1 res is  tensor(0.1478, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.735889732837677
distance 1 is tensor(138.2866, device='cuda:0')
distance 2 is tensor(9.9176, device='cuda:0')
benign distance is  tensor(9.9176, device='cuda:0')
norm1 res is  tensor(0.1432, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.812582790851593
distance 1 is tensor(149.1200, device='cuda:0')
distance 2 is tensor(10.7207, device='cuda:0')
benign distance is  tensor(10.7207, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.9811455011367798
distance 1 is tensor(170.0628, device='cuda:0')
distance 2 is tensor(12.2120, device='cuda:0')
benign distance is  tensor(12.2120, device='cuda:0')
norm1 res is  tensor(0.1769, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.17380796372890472
distance 1 is tensor(136.2023, device='cuda:0')
distance 2 is tensor(9.7629, device='cuda:0')
benign distance is  tensor(9.7629, device='cuda:0')
norm1 res is  tensor(0.1405, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8878147006034851
distance 1 is tensor(156.0388, device='cuda:0')
distance 2 is tensor(11.2630, device='cuda:0')
benign distance is  tensor(11.2630, device='cuda:0')
norm1 res is  tensor(0.1666, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.8314286470413208
distance 1 is tensor(160.0612, device='cuda:0')
distance 2 is tensor(11.6053, device='cuda:0')
benign distance is  tensor(11.6053, device='cuda:0')
norm1 res is  tensor(0.1687, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.5448717474937439
distance 1 is tensor(147.0128, device='cuda:0')
distance 2 is tensor(10.6438, device='cuda:0')
benign distance is  tensor(10.6438, device='cuda:0')
norm1 res is  tensor(0.1520, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.598243772983551
distance 1 is tensor(166.0309, device='cuda:0')
distance 2 is tensor(11.8256, device='cuda:0')
benign distance is  tensor(11.8256, device='cuda:0')
norm1 res is  tensor(0.1685, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.7474265098571777
distance 1 is tensor(153.6553, device='cuda:0')
distance 2 is tensor(11.0644, device='cuda:0')
benign distance is  tensor(11.0644, device='cuda:0')
norm1 res is  tensor(0.1610, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.8504825830459595
distance 1 is tensor(156.9478, device='cuda:0')
distance 2 is tensor(11.3633, device='cuda:0')
benign distance is  tensor(11.3633, device='cuda:0')
norm1 res is  tensor(0.1641, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.5198351740837097
distance 1 is tensor(163.8360, device='cuda:0')
distance 2 is tensor(11.9288, device='cuda:0')
benign distance is  tensor(11.9288, device='cuda:0')
norm1 res is  tensor(0.1720, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.3319476246833801
distance 1 is tensor(151.1541, device='cuda:0')
distance 2 is tensor(10.8383, device='cuda:0')
benign distance is  tensor(10.8383, device='cuda:0')
norm1 res is  tensor(0.1577, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.7729859948158264
distance 1 is tensor(160.8296, device='cuda:0')
distance 2 is tensor(11.4221, device='cuda:0')
benign distance is  tensor(11.4221, device='cuda:0')
norm1 res is  tensor(0.1639, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.31784647703170776
distance 1 is tensor(161.1644, device='cuda:0')
distance 2 is tensor(11.7812, device='cuda:0')
benign distance is  tensor(11.7812, device='cuda:0')
norm1 res is  tensor(0.1703, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.20571045577526093
distance 1 is tensor(167.8366, device='cuda:0')
distance 2 is tensor(12.0444, device='cuda:0')
benign distance is  tensor(12.0444, device='cuda:0')
norm1 res is  tensor(0.1736, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.4590650498867035
distance 1 is tensor(150.2386, device='cuda:0')
distance 2 is tensor(10.7986, device='cuda:0')
benign distance is  tensor(10.7986, device='cuda:0')
norm1 res is  tensor(0.1563, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.11235865205526352
distance 1 is tensor(165.1010, device='cuda:0')
distance 2 is tensor(12.0761, device='cuda:0')
benign distance is  tensor(12.0761, device='cuda:0')
norm1 res is  tensor(0.1720, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.3819432258605957
distance 1 is tensor(172.5078, device='cuda:0')
distance 2 is tensor(12.2760, device='cuda:0')
benign distance is  tensor(12.2760, device='cuda:0')
norm1 res is  tensor(0.1763, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.24384355545043945
distance 1 is tensor(144.2238, device='cuda:0')
distance 2 is tensor(10.4934, device='cuda:0')
benign distance is  tensor(10.4934, device='cuda:0')
norm1 res is  tensor(0.1478, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.5042184591293335
distance 1 is tensor(158.5209, device='cuda:0')
distance 2 is tensor(11.5534, device='cuda:0')
benign distance is  tensor(11.5534, device='cuda:0')
norm1 res is  tensor(0.1639, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.12697798013687134
distance 1 is tensor(150.9116, device='cuda:0')
distance 2 is tensor(10.7778, device='cuda:0')
benign distance is  tensor(10.7778, device='cuda:0')
norm1 res is  tensor(0.1543, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(156.6480, device='cuda:0')
distance 2 is tensor(11.8406, device='cuda:0')
compute distance is  tensor(11.8406, device='cuda:0')
compute norm is  tensor(51.0568, device='cuda:0')
distance 1 is tensor(160.2043, device='cuda:0')
distance 2 is tensor(12.2218, device='cuda:0')
compute distance is  tensor(12.2218, device='cuda:0')
compute norm is  tensor(51.1368, device='cuda:0')
distance 1 is tensor(156.7091, device='cuda:0')
distance 2 is tensor(12.0875, device='cuda:0')
compute distance is  tensor(12.0875, device='cuda:0')
compute norm is  tensor(51.1245, device='cuda:0')
distance 1 is tensor(159.8111, device='cuda:0')
distance 2 is tensor(11.9930, device='cuda:0')
compute distance is  tensor(11.9930, device='cuda:0')
compute norm is  tensor(51.0857, device='cuda:0')
distance 1 is tensor(159.3724, device='cuda:0')
distance 2 is tensor(11.9791, device='cuda:0')
compute distance is  tensor(11.9791, device='cuda:0')
compute norm is  tensor(51.1123, device='cuda:0')
distance 1 is tensor(160.4136, device='cuda:0')
distance 2 is tensor(12.3175, device='cuda:0')
compute distance is  tensor(12.3175, device='cuda:0')
compute norm is  tensor(51.3451, device='cuda:0')
distance 1 is tensor(163.1114, device='cuda:0')
distance 2 is tensor(12.4340, device='cuda:0')
compute distance is  tensor(12.4340, device='cuda:0')
compute norm is  tensor(51.3743, device='cuda:0')
distance 1 is tensor(170.0750, device='cuda:0')
distance 2 is tensor(12.7621, device='cuda:0')
compute distance is  tensor(12.7621, device='cuda:0')
compute norm is  tensor(51.5221, device='cuda:0')
distance 1 is tensor(153.7015, device='cuda:0')
distance 2 is tensor(11.7840, device='cuda:0')
compute distance is  tensor(11.7840, device='cuda:0')
compute norm is  tensor(51.1371, device='cuda:0')
distance 1 is tensor(159.0063, device='cuda:0')
distance 2 is tensor(12.3047, device='cuda:0')
compute distance is  tensor(12.3047, device='cuda:0')
compute norm is  tensor(51.3404, device='cuda:0')
distance 1 is tensor(151.1309, device='cuda:0')
distance 2 is tensor(11.5405, device='cuda:0')
compute distance is  tensor(11.5405, device='cuda:0')
compute norm is  tensor(51.0238, device='cuda:0')
distance 1 is tensor(150.1473, device='cuda:0')
distance 2 is tensor(11.5108, device='cuda:0')
compute distance is  tensor(11.5108, device='cuda:0')
compute norm is  tensor(51.0640, device='cuda:0')
distance Threshold  is  tensor(12.7621, device='cuda:0')
distance 1 is tensor(1009186.2500, device='cuda:0')
distance 2 is tensor(73616.8594, device='cuda:0')
________________________________
test distance is  tensor(73616.8594, device='cuda:0')
test similarity is  tensor(0.0284, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.824922957648065e+17
test entropy is  0.0
________________________________
cal ratio is  0.011849916524540963
distance 1 is tensor(11958.7783, device='cuda:0')
distance 2 is tensor(872.3536, device='cuda:0')
cal_distance is  tensor(872.3536, device='cuda:0')
cal ratio is  0.10885732343783384
distance 1 is tensor(1301.8060, device='cuda:0')
distance 2 is tensor(94.9621, device='cuda:0')
cal_distance is  tensor(94.9621, device='cuda:0')
cal ratio is  0.32993534747146164
distance 1 is tensor(429.5158, device='cuda:0')
distance 2 is tensor(31.3313, device='cuda:0')
cal_distance is  tensor(31.3313, device='cuda:0')
cal ratio is  0.5743999701272304
distance 1 is tensor(246.7164, device='cuda:0')
distance 2 is tensor(17.9967, device='cuda:0')
cal_distance is  tensor(17.9967, device='cuda:0')
cal ratio is  0.7578917959353835
distance 1 is tensor(186.9858, device='cuda:0')
distance 2 is tensor(13.6396, device='cuda:0')
cal_distance is  tensor(13.6396, device='cuda:0')
cal ratio is  0.8705698396470699
distance 1 is tensor(162.7850, device='cuda:0')
distance 2 is tensor(11.8742, device='cuda:0')
cal_distance is  tensor(11.8742, device='cuda:0')
distance 1 is tensor(162.7850, device='cuda:0')
distance 2 is tensor(11.8742, device='cuda:0')
________________________________
test distance is  tensor(11.8742, device='cuda:0')
test similarity is  tensor(0.9405, device='cuda:0')
test acc is  0.6617833334896664
test loss is 113.02724777254214
test entropy is  0.006402402578232414
________________________________
distance 1 is tensor(162.7850, device='cuda:0')
distance 2 is tensor(11.8742, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.006796078183459015
avg test loss is  113.32032793773008
avg accuracy is  0.661850000156333
solo acc is  0.1397500001563323
compute similarity  is  tensor(0.9405, device='cuda:0')
compute_distance is  tensor(11.8742, device='cuda:0')
compute_norm is  tensor(51.5093, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(149.2926, device='cuda:0')
distance 2 is tensor(12.8009, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.0127165217770697
avg test loss is  1.5614857953240369
avg accuracy is  0.7674666668229937
solo acc is  0.2980333334896728
compute similarity  is  tensor(0.9425, device='cuda:0')
compute_distance is  tensor(12.8009, device='cuda:0')
compute_norm is  tensor(50.8668, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(150.5977, device='cuda:0')
distance 2 is tensor(13.1206, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.6227410580240079
avg test loss is  2.5010361738804816
avg accuracy is  0.7160500001563297
solo acc is  0.11880000015633194
compute similarity  is  tensor(0.9421, device='cuda:0')
compute_distance is  tensor(13.1206, device='cuda:0')
compute_norm is  tensor(50.6266, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(151.7069, device='cuda:0')
distance 2 is tensor(13.2668, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9771243369401391
avg test loss is  1.465117704639557
avg accuracy is  0.7687333334896602
solo acc is  0.2913333334896727
compute similarity  is  tensor(0.9420, device='cuda:0')
compute_distance is  tensor(13.2668, device='cuda:0')
compute_norm is  tensor(50.3084, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(151.7069, device='cuda:0')
distance 2 is tensor(13.2668, device='cuda:0')
________________________________
test distance is  tensor(13.2668, device='cuda:0')
test similarity is  tensor(0.9420, device='cuda:0')
test acc is  0.7671333334896603
test loss is 1.4711770914765054
test entropy is  0.9747918688539249
________________________________
cal ratio is  0.8827166729796379
distance 1 is tensor(133.9149, device='cuda:0')
distance 2 is tensor(11.7108, device='cuda:0')
cal_distance is  tensor(11.7108, device='cuda:0')
distance 1 is tensor(133.9149, device='cuda:0')
distance 2 is tensor(11.7108, device='cuda:0')
________________________________
test distance is  tensor(11.7108, device='cuda:0')
test similarity is  tensor(0.9541, device='cuda:0')
test acc is  0.7907166668229926
test loss is 1.1965783597436794
test entropy is  1.1134056569670818
________________________________
distance 1 is tensor(133.9149, device='cuda:0')
distance 2 is tensor(11.7108, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.1136109625606903
avg test loss is  1.1966808668967248
avg accuracy is  0.7907666668229926
solo acc is  0.45088333348967496
compute similarity  is  tensor(0.9541, device='cuda:0')
compute_distance is  tensor(11.7108, device='cuda:0')
compute_norm is  tensor(49.9629, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(136.2255, device='cuda:0')
distance 2 is tensor(12.1052, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.6099052338966174
avg test loss is  2.367187097509787
avg accuracy is  0.7373500001563286
solo acc is  0.1154166668229986
compute similarity  is  tensor(0.9533, device='cuda:0')
compute_distance is  tensor(12.1052, device='cuda:0')
compute_norm is  tensor(49.7474, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(138.0018, device='cuda:0')
distance 2 is tensor(12.2184, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9520208113102008
avg test loss is  1.4027007058231054
avg accuracy is  0.7869666668229927
solo acc is  0.2995000001563395
compute similarity  is  tensor(0.9532, device='cuda:0')
compute_distance is  tensor(12.2184, device='cuda:0')
compute_norm is  tensor(49.4400, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(138.0018, device='cuda:0')
distance 2 is tensor(12.2184, device='cuda:0')
________________________________
test distance is  tensor(12.2184, device='cuda:0')
test similarity is  tensor(0.9532, device='cuda:0')
test acc is  0.7847500001563261
test loss is 1.4020688425757484
test entropy is  0.9508228820524236
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2912185192108154
mal norm is  tensor(6.9176, device='cuda:0')
distance 1 is tensor(138.0018, device='cuda:0')
distance 2 is tensor(12.2184, device='cuda:0')
mal distance is  tensor(12.2184, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.3261, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.9874, device='cuda:0')
c is  tensor(0.0229, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.5493, device='cuda:0')
c is  tensor(0.0232, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.5115, device='cuda:0')
c is  tensor(0.0237, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.4598, device='cuda:0')
c is  tensor(0.0240, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0010, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.4193, device='cuda:0')
c is  tensor(0.0230, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0011, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.0833, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.3005, device='cuda:0')
c is  tensor(0.0242, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0433, device='cuda:0')
c is  tensor(0.0223, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0012, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.7552, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
len accept list 13
len all weights is 13
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 73.75% 

Test Accuracy: 72.30% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6571103930473328
distance 1 is tensor(220.2496, device='cuda:0')
distance 2 is tensor(16.2284, device='cuda:0')
benign distance is  tensor(16.2284, device='cuda:0')
norm1 res is  tensor(0.2097, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6721408367156982
distance 1 is tensor(221.6264, device='cuda:0')
distance 2 is tensor(17.0607, device='cuda:0')
benign distance is  tensor(17.0607, device='cuda:0')
norm1 res is  tensor(0.2177, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.3012007474899292
distance 1 is tensor(208.5258, device='cuda:0')
distance 2 is tensor(15.6601, device='cuda:0')
benign distance is  tensor(15.6601, device='cuda:0')
norm1 res is  tensor(0.2025, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.13702794909477234
distance 1 is tensor(206.3690, device='cuda:0')
distance 2 is tensor(15.2474, device='cuda:0')
benign distance is  tensor(15.2474, device='cuda:0')
norm1 res is  tensor(0.1991, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.4081382751464844
distance 1 is tensor(203.5240, device='cuda:0')
distance 2 is tensor(15.2966, device='cuda:0')
benign distance is  tensor(15.2966, device='cuda:0')
norm1 res is  tensor(0.1948, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.654067873954773
distance 1 is tensor(223.1212, device='cuda:0')
distance 2 is tensor(16.8836, device='cuda:0')
benign distance is  tensor(16.8836, device='cuda:0')
norm1 res is  tensor(0.2170, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.5043852925300598
distance 1 is tensor(201.8144, device='cuda:0')
distance 2 is tensor(14.9985, device='cuda:0')
benign distance is  tensor(14.9985, device='cuda:0')
norm1 res is  tensor(0.1902, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5909806489944458
distance 1 is tensor(208.5324, device='cuda:0')
distance 2 is tensor(15.5718, device='cuda:0')
benign distance is  tensor(15.5718, device='cuda:0')
norm1 res is  tensor(0.2024, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(217.7659, device='cuda:0')
distance 2 is tensor(17.7623, device='cuda:0')
compute distance is  tensor(17.7623, device='cuda:0')
compute norm is  tensor(50.9751, device='cuda:0')
distance 1 is tensor(213.7191, device='cuda:0')
distance 2 is tensor(17.5294, device='cuda:0')
compute distance is  tensor(17.5294, device='cuda:0')
compute norm is  tensor(50.8634, device='cuda:0')
distance 1 is tensor(222.2139, device='cuda:0')
distance 2 is tensor(17.9993, device='cuda:0')
compute distance is  tensor(17.9993, device='cuda:0')
compute norm is  tensor(51.2902, device='cuda:0')
distance 1 is tensor(223.3324, device='cuda:0')
distance 2 is tensor(18.0592, device='cuda:0')
compute distance is  tensor(18.0592, device='cuda:0')
compute norm is  tensor(51.2054, device='cuda:0')
distance 1 is tensor(228.5240, device='cuda:0')
distance 2 is tensor(18.4272, device='cuda:0')
compute distance is  tensor(18.4272, device='cuda:0')
compute norm is  tensor(51.4425, device='cuda:0')
distance 1 is tensor(230.5012, device='cuda:0')
distance 2 is tensor(18.3693, device='cuda:0')
compute distance is  tensor(18.3693, device='cuda:0')
compute norm is  tensor(51.5444, device='cuda:0')
distance 1 is tensor(230.0532, device='cuda:0')
distance 2 is tensor(18.4789, device='cuda:0')
compute distance is  tensor(18.4789, device='cuda:0')
compute norm is  tensor(51.4487, device='cuda:0')
distance 1 is tensor(227.1554, device='cuda:0')
distance 2 is tensor(18.2295, device='cuda:0')
compute distance is  tensor(18.2295, device='cuda:0')
compute norm is  tensor(51.4378, device='cuda:0')
distance 1 is tensor(220.2955, device='cuda:0')
distance 2 is tensor(17.8750, device='cuda:0')
compute distance is  tensor(17.8750, device='cuda:0')
compute norm is  tensor(51.2781, device='cuda:0')
distance 1 is tensor(215.6846, device='cuda:0')
distance 2 is tensor(17.6036, device='cuda:0')
compute distance is  tensor(17.6036, device='cuda:0')
compute norm is  tensor(51.0468, device='cuda:0')
distance 1 is tensor(223.7327, device='cuda:0')
distance 2 is tensor(18.0746, device='cuda:0')
compute distance is  tensor(18.0746, device='cuda:0')
compute norm is  tensor(51.3216, device='cuda:0')
distance 1 is tensor(219.7371, device='cuda:0')
distance 2 is tensor(17.8240, device='cuda:0')
compute distance is  tensor(17.8240, device='cuda:0')
compute norm is  tensor(51.3442, device='cuda:0')
distance Threshold  is  tensor(18.4789, device='cuda:0')
distance 1 is tensor(1009111.8750, device='cuda:0')
distance 2 is tensor(73610.4844, device='cuda:0')
________________________________
test distance is  tensor(73610.4844, device='cuda:0')
test similarity is  tensor(0.2351, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.81942780762134e+17
test entropy is  0.0
________________________________
cal ratio is  0.014259695566029693
distance 1 is tensor(14389.6328, device='cuda:0')
distance 2 is tensor(1049.6632, device='cuda:0')
cal_distance is  tensor(1049.6632, device='cuda:0')
cal ratio is  0.11941395782975242
distance 1 is tensor(1718.3284, device='cuda:0')
distance 2 is tensor(125.3444, device='cuda:0')
cal_distance is  tensor(125.3444, device='cuda:0')
cal ratio is  0.34556328094816424
distance 1 is tensor(593.7951, device='cuda:0')
distance 2 is tensor(43.3144, device='cuda:0')
cal_distance is  tensor(43.3144, device='cuda:0')
cal ratio is  0.5878462341886378
distance 1 is tensor(349.0627, device='cuda:0')
distance 2 is tensor(25.4622, device='cuda:0')
cal_distance is  tensor(25.4622, device='cuda:0')
cal ratio is  0.7667113685446941
distance 1 is tensor(267.6317, device='cuda:0')
distance 2 is tensor(19.5222, device='cuda:0')
cal_distance is  tensor(19.5222, device='cuda:0')
cal ratio is  0.875620552108871
distance 1 is tensor(234.3446, device='cuda:0')
distance 2 is tensor(17.0940, device='cuda:0')
cal_distance is  tensor(17.0940, device='cuda:0')
distance 1 is tensor(234.3446, device='cuda:0')
distance 2 is tensor(17.0940, device='cuda:0')
________________________________
test distance is  tensor(17.0940, device='cuda:0')
test similarity is  tensor(0.9115, device='cuda:0')
test acc is  0.10250000015633197
test loss is 731.8831673237814
test entropy is  2.269660136371532e-25
________________________________
distance 1 is tensor(234.3446, device='cuda:0')
distance 2 is tensor(17.0940, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  3.8750547656435477e-35
avg test loss is  733.3264499818847
avg accuracy is  0.1022333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9115, device='cuda:0')
compute_distance is  tensor(17.0940, device='cuda:0')
compute_norm is  tensor(56.0181, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(244.4478, device='cuda:0')
distance 2 is tensor(22.6110, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.647804364975073
avg test loss is  2.7710313535194153
avg accuracy is  0.143883333489666
solo acc is  0.10185000015633197
compute similarity  is  tensor(0.9096, device='cuda:0')
compute_distance is  tensor(22.6110, device='cuda:0')
compute_norm is  tensor(58.1328, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(244.3300, device='cuda:0')
distance 2 is tensor(23.0361, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9489398902413179
avg test loss is  3.4592079534205293
avg accuracy is  0.12181666682299859
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9091, device='cuda:0')
compute_distance is  tensor(23.0361, device='cuda:0')
compute_norm is  tensor(58.4564, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(242.6256, device='cuda:0')
distance 2 is tensor(22.4178, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  1.5298034928754958
avg test loss is  2.6767054872472147
avg accuracy is  0.15120000015633334
solo acc is  0.11168333348966529
compute similarity  is  tensor(0.9098, device='cuda:0')
compute_distance is  tensor(22.4178, device='cuda:0')
compute_norm is  tensor(57.7215, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(242.5379, device='cuda:0')
distance 2 is tensor(22.7038, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8730054732197637
avg test loss is  3.3212911724281717
avg accuracy is  0.1246666668229986
solo acc is  0.10066666682299863
compute similarity  is  tensor(0.9094, device='cuda:0')
compute_distance is  tensor(22.7038, device='cuda:0')
compute_norm is  tensor(57.9187, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(241.6254, device='cuda:0')
distance 2 is tensor(22.0236, device='cuda:0')
________________________________
test distance is  tensor(22.0236, device='cuda:0')
test similarity is  tensor(0.9102, device='cuda:0')
test acc is  0.16501666682300106
test loss is 2.2628229888263287
test entropy is  1.3156380493249467
________________________________
cal ratio is  0.8243957907923224
distance 1 is tensor(199.1958, device='cuda:0')
distance 2 is tensor(18.1562, device='cuda:0')
cal_distance is  tensor(18.1562, device='cuda:0')
distance 1 is tensor(199.1958, device='cuda:0')
distance 2 is tensor(18.1562, device='cuda:0')
________________________________
test distance is  tensor(18.1562, device='cuda:0')
test similarity is  tensor(0.9343, device='cuda:0')
test acc is  0.19608333348966955
test loss is 2.1792963698728762
test entropy is  1.4950842279106824
________________________________
distance 1 is tensor(199.1958, device='cuda:0')
distance 2 is tensor(18.1562, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.4954703942036578
avg test loss is  2.175412809543772
avg accuracy is  0.19691666682300285
solo acc is  0.1387333334896655
compute similarity  is  tensor(0.9343, device='cuda:0')
compute_distance is  tensor(18.1562, device='cuda:0')
compute_norm is  tensor(55.2839, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(199.6579, device='cuda:0')
distance 2 is tensor(18.3844, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.7998551275176026
avg test loss is  2.9726756081652286
avg accuracy is  0.13721666682299866
solo acc is  0.10296666682299864
compute similarity  is  tensor(0.9339, device='cuda:0')
compute_distance is  tensor(18.3844, device='cuda:0')
compute_norm is  tensor(55.3741, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(199.9157, device='cuda:0')
distance 2 is tensor(17.9617, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  1.2008268320992557
avg test loss is  2.031818139654741
avg accuracy is  0.19078333348966922
solo acc is  0.16578333348966776
compute similarity  is  tensor(0.9342, device='cuda:0')
compute_distance is  tensor(17.9617, device='cuda:0')
compute_norm is  tensor(54.8902, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(199.9333, device='cuda:0')
distance 2 is tensor(18.0328, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.7224263006181859
avg test loss is  2.8057351597844917
avg accuracy is  0.13745000015633202
solo acc is  0.10385000015633197
compute similarity  is  tensor(0.9339, device='cuda:0')
compute_distance is  tensor(18.0328, device='cuda:0')
compute_norm is  tensor(54.8154, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(199.8129, device='cuda:0')
distance 2 is tensor(17.6809, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  1.1516727772094548
avg test loss is  1.908778241448311
avg accuracy is  0.20785000015633676
solo acc is  0.174700000156335
compute similarity  is  tensor(0.9342, device='cuda:0')
compute_distance is  tensor(17.6809, device='cuda:0')
compute_norm is  tensor(54.3659, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(199.6729, device='cuda:0')
distance 2 is tensor(17.7401, device='cuda:0')
________________________________
test distance is  tensor(17.7401, device='cuda:0')
test similarity is  tensor(0.9340, device='cuda:0')
test acc is  0.1495000001563332
test loss is 2.6609447190502307
test entropy is  0.6892138225183304
________________________________
distance 1 is tensor(199.6729, device='cuda:0')
distance 2 is tensor(17.7401, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.6898402611711132
avg test loss is  2.6595932085122636
avg accuracy is  0.15063333348966662
solo acc is  0.10635000015633196
compute similarity  is  tensor(0.9340, device='cuda:0')
compute_distance is  tensor(17.7401, device='cuda:0')
compute_norm is  tensor(54.2639, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(198.9564, device='cuda:0')
distance 2 is tensor(17.4518, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.0378047853771812
avg test loss is  1.6564521230360083
avg accuracy is  0.2357833334896712
solo acc is  0.22863333348967085
compute similarity  is  tensor(0.9342, device='cuda:0')
compute_distance is  tensor(17.4518, device='cuda:0')
compute_norm is  tensor(53.8225, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(198.9189, device='cuda:0')
distance 2 is tensor(17.5063, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.646138818406347
avg test loss is  2.4580489230562628
avg accuracy is  0.15813333348966727
solo acc is  0.10863333348966529
compute similarity  is  tensor(0.9340, device='cuda:0')
compute_distance is  tensor(17.5063, device='cuda:0')
compute_norm is  tensor(53.6862, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(198.9888, device='cuda:0')
distance 2 is tensor(17.3521, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9991885786498788
avg test loss is  1.5903287240182922
avg accuracy is  0.24228333348967135
solo acc is  0.2356833334896712
compute similarity  is  tensor(0.9340, device='cuda:0')
compute_distance is  tensor(17.3521, device='cuda:0')
compute_norm is  tensor(53.3151, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(198.9888, device='cuda:0')
distance 2 is tensor(17.3521, device='cuda:0')
________________________________
test distance is  tensor(17.3521, device='cuda:0')
test similarity is  tensor(0.9340, device='cuda:0')
test acc is  0.2460000001563382
test loss is 1.5882092321605317
test entropy is  0.998702650766637
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.32733154296875
mal norm is  tensor(9.0551, device='cuda:0')
distance 1 is tensor(198.9888, device='cuda:0')
distance 2 is tensor(17.3521, device='cuda:0')
mal distance is  tensor(17.3521, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2827, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.9235, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.9183, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0025, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(799.8010, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.3565, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.4326, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(861.0383, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.5275, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(793.3173, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(905.5138, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1034.1582, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1039.5643, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1039.9183, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1083.6750, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1070.0066, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1077.7432, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1020.1491, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1055.1388, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(987.0775, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(950.0258, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1008.7148, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(970.8845, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(981.5499, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(956.4061, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(983.4367, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1017.7006, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(873.5714, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1011.9421, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(943.4307, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(882.6655, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.1919, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(893.0227, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(900.2939, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(890.4711, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(881.3329, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(831.6776, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(885.0366, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(858.8927, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(862.1558, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(891.9840, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(837.6959, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0025, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(865.2307, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
len accept list 40
len all weights is 40
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 91.07% 

Test Accuracy: 89.09% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4829448163509369
distance 1 is tensor(136.3392, device='cuda:0')
distance 2 is tensor(9.8706, device='cuda:0')
benign distance is  tensor(9.8706, device='cuda:0')
norm1 res is  tensor(0.1437, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.49151191115379333
distance 1 is tensor(132.4151, device='cuda:0')
distance 2 is tensor(9.6401, device='cuda:0')
benign distance is  tensor(9.6401, device='cuda:0')
norm1 res is  tensor(0.1347, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.1284847855567932
distance 1 is tensor(134.9429, device='cuda:0')
distance 2 is tensor(9.7809, device='cuda:0')
benign distance is  tensor(9.7809, device='cuda:0')
norm1 res is  tensor(0.1367, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.2179909646511078
distance 1 is tensor(130.8821, device='cuda:0')
distance 2 is tensor(9.4826, device='cuda:0')
benign distance is  tensor(9.4826, device='cuda:0')
norm1 res is  tensor(0.1332, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7827691435813904
distance 1 is tensor(145.2433, device='cuda:0')
distance 2 is tensor(10.1919, device='cuda:0')
benign distance is  tensor(10.1919, device='cuda:0')
norm1 res is  tensor(0.1412, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.0981605052947998
distance 1 is tensor(165.2382, device='cuda:0')
distance 2 is tensor(11.9125, device='cuda:0')
benign distance is  tensor(11.9125, device='cuda:0')
norm1 res is  tensor(0.1709, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.05806752294301987
distance 1 is tensor(132.3007, device='cuda:0')
distance 2 is tensor(9.4476, device='cuda:0')
benign distance is  tensor(9.4476, device='cuda:0')
norm1 res is  tensor(0.1343, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.3624831736087799
distance 1 is tensor(147.4984, device='cuda:0')
distance 2 is tensor(10.5153, device='cuda:0')
benign distance is  tensor(10.5153, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.12618598341941833
distance 1 is tensor(150.5237, device='cuda:0')
distance 2 is tensor(10.7947, device='cuda:0')
benign distance is  tensor(10.7947, device='cuda:0')
norm1 res is  tensor(0.1534, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.42010703682899475
distance 1 is tensor(149.5039, device='cuda:0')
distance 2 is tensor(10.8732, device='cuda:0')
benign distance is  tensor(10.8732, device='cuda:0')
norm1 res is  tensor(0.1588, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.5375611186027527
distance 1 is tensor(137.1087, device='cuda:0')
distance 2 is tensor(9.8944, device='cuda:0')
benign distance is  tensor(9.8944, device='cuda:0')
norm1 res is  tensor(0.1381, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0433379411697388
distance 1 is tensor(146.4280, device='cuda:0')
distance 2 is tensor(10.5110, device='cuda:0')
benign distance is  tensor(10.5110, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.3630835711956024
distance 1 is tensor(128.8333, device='cuda:0')
distance 2 is tensor(9.4798, device='cuda:0')
benign distance is  tensor(9.4798, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.1906696856021881
distance 1 is tensor(160.4191, device='cuda:0')
distance 2 is tensor(11.5813, device='cuda:0')
benign distance is  tensor(11.5813, device='cuda:0')
norm1 res is  tensor(0.1641, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.6219823360443115
distance 1 is tensor(151.9073, device='cuda:0')
distance 2 is tensor(10.9203, device='cuda:0')
benign distance is  tensor(10.9203, device='cuda:0')
norm1 res is  tensor(0.1551, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.160233497619629
distance 1 is tensor(152.8259, device='cuda:0')
distance 2 is tensor(11.1211, device='cuda:0')
benign distance is  tensor(11.1211, device='cuda:0')
norm1 res is  tensor(0.1580, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.47236403822898865
distance 1 is tensor(151.0927, device='cuda:0')
distance 2 is tensor(10.8711, device='cuda:0')
benign distance is  tensor(10.8711, device='cuda:0')
norm1 res is  tensor(0.1560, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.6502191424369812
distance 1 is tensor(154.6944, device='cuda:0')
distance 2 is tensor(11.2020, device='cuda:0')
benign distance is  tensor(11.2020, device='cuda:0')
norm1 res is  tensor(0.1593, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.8993788957595825
distance 1 is tensor(142.2966, device='cuda:0')
distance 2 is tensor(10.2007, device='cuda:0')
benign distance is  tensor(10.2007, device='cuda:0')
norm1 res is  tensor(0.1437, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.568179190158844
distance 1 is tensor(136.3312, device='cuda:0')
distance 2 is tensor(9.8518, device='cuda:0')
benign distance is  tensor(9.8518, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.6808597445487976
distance 1 is tensor(155.0759, device='cuda:0')
distance 2 is tensor(11.2754, device='cuda:0')
benign distance is  tensor(11.2754, device='cuda:0')
norm1 res is  tensor(0.1578, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.37332814931869507
distance 1 is tensor(152.5004, device='cuda:0')
distance 2 is tensor(10.9913, device='cuda:0')
benign distance is  tensor(10.9913, device='cuda:0')
norm1 res is  tensor(0.1550, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.042878929525613785
distance 1 is tensor(163.3685, device='cuda:0')
distance 2 is tensor(11.8220, device='cuda:0')
benign distance is  tensor(11.8220, device='cuda:0')
norm1 res is  tensor(0.1693, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.5898883938789368
distance 1 is tensor(139.0531, device='cuda:0')
distance 2 is tensor(10.1183, device='cuda:0')
benign distance is  tensor(10.1183, device='cuda:0')
norm1 res is  tensor(0.1404, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.3004354238510132
distance 1 is tensor(136.9185, device='cuda:0')
distance 2 is tensor(9.9433, device='cuda:0')
benign distance is  tensor(9.9433, device='cuda:0')
norm1 res is  tensor(0.1412, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.1498512476682663
distance 1 is tensor(144.4796, device='cuda:0')
distance 2 is tensor(10.3424, device='cuda:0')
benign distance is  tensor(10.3424, device='cuda:0')
norm1 res is  tensor(0.1468, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.20966729521751404
distance 1 is tensor(159.7183, device='cuda:0')
distance 2 is tensor(11.4246, device='cuda:0')
benign distance is  tensor(11.4246, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.4136025309562683
distance 1 is tensor(148.9846, device='cuda:0')
distance 2 is tensor(10.8698, device='cuda:0')
benign distance is  tensor(10.8698, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.9378694295883179
distance 1 is tensor(142.8368, device='cuda:0')
distance 2 is tensor(10.4541, device='cuda:0')
benign distance is  tensor(10.4541, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.3569752871990204
distance 1 is tensor(143.8997, device='cuda:0')
distance 2 is tensor(10.4404, device='cuda:0')
benign distance is  tensor(10.4404, device='cuda:0')
norm1 res is  tensor(0.1464, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.32841581106185913
distance 1 is tensor(146.2265, device='cuda:0')
distance 2 is tensor(10.7402, device='cuda:0')
benign distance is  tensor(10.7402, device='cuda:0')
norm1 res is  tensor(0.1554, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.6484388113021851
distance 1 is tensor(144.2622, device='cuda:0')
distance 2 is tensor(10.5428, device='cuda:0')
benign distance is  tensor(10.5428, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.46582895517349243
distance 1 is tensor(145.4389, device='cuda:0')
distance 2 is tensor(10.6645, device='cuda:0')
benign distance is  tensor(10.6645, device='cuda:0')
norm1 res is  tensor(0.1497, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.7227000594139099
distance 1 is tensor(147.0414, device='cuda:0')
distance 2 is tensor(10.4938, device='cuda:0')
benign distance is  tensor(10.4938, device='cuda:0')
norm1 res is  tensor(0.1479, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.07199734449386597
distance 1 is tensor(135.9016, device='cuda:0')
distance 2 is tensor(9.8646, device='cuda:0')
benign distance is  tensor(9.8646, device='cuda:0')
norm1 res is  tensor(0.1375, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.8964164853096008
distance 1 is tensor(154.0750, device='cuda:0')
distance 2 is tensor(11.1341, device='cuda:0')
benign distance is  tensor(11.1341, device='cuda:0')
norm1 res is  tensor(0.1570, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.21842896938323975
distance 1 is tensor(150.9548, device='cuda:0')
distance 2 is tensor(11.1626, device='cuda:0')
benign distance is  tensor(11.1626, device='cuda:0')
norm1 res is  tensor(0.1576, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.5332025289535522
distance 1 is tensor(145.6500, device='cuda:0')
distance 2 is tensor(10.6233, device='cuda:0')
benign distance is  tensor(10.6233, device='cuda:0')
norm1 res is  tensor(0.1492, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8406899571418762
distance 1 is tensor(140.7909, device='cuda:0')
distance 2 is tensor(10.0549, device='cuda:0')
benign distance is  tensor(10.0549, device='cuda:0')
norm1 res is  tensor(0.1411, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.7095562815666199
distance 1 is tensor(142.1190, device='cuda:0')
distance 2 is tensor(10.3619, device='cuda:0')
benign distance is  tensor(10.3619, device='cuda:0')
norm1 res is  tensor(0.1477, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(178.8112, device='cuda:0')
distance 2 is tensor(13.8881, device='cuda:0')
compute distance is  tensor(13.8881, device='cuda:0')
compute norm is  tensor(51.9707, device='cuda:0')
distance 1 is tensor(172.8534, device='cuda:0')
distance 2 is tensor(13.5334, device='cuda:0')
compute distance is  tensor(13.5334, device='cuda:0')
compute norm is  tensor(51.8833, device='cuda:0')
distance 1 is tensor(174.2021, device='cuda:0')
distance 2 is tensor(13.7550, device='cuda:0')
compute distance is  tensor(13.7550, device='cuda:0')
compute norm is  tensor(52.0428, device='cuda:0')
distance 1 is tensor(182.8747, device='cuda:0')
distance 2 is tensor(14.0634, device='cuda:0')
compute distance is  tensor(14.0634, device='cuda:0')
compute norm is  tensor(52.2211, device='cuda:0')
distance 1 is tensor(184.4933, device='cuda:0')
distance 2 is tensor(14.2578, device='cuda:0')
compute distance is  tensor(14.2578, device='cuda:0')
compute norm is  tensor(52.1032, device='cuda:0')
distance 1 is tensor(188.0146, device='cuda:0')
distance 2 is tensor(14.5288, device='cuda:0')
compute distance is  tensor(14.5288, device='cuda:0')
compute norm is  tensor(52.4675, device='cuda:0')
distance 1 is tensor(188.4614, device='cuda:0')
distance 2 is tensor(14.6115, device='cuda:0')
compute distance is  tensor(14.6115, device='cuda:0')
compute norm is  tensor(52.4020, device='cuda:0')
distance 1 is tensor(178.9977, device='cuda:0')
distance 2 is tensor(13.8763, device='cuda:0')
compute distance is  tensor(13.8763, device='cuda:0')
compute norm is  tensor(52.1349, device='cuda:0')
distance 1 is tensor(185.0151, device='cuda:0')
distance 2 is tensor(14.2803, device='cuda:0')
compute distance is  tensor(14.2803, device='cuda:0')
compute norm is  tensor(52.2655, device='cuda:0')
distance 1 is tensor(173.0033, device='cuda:0')
distance 2 is tensor(13.4852, device='cuda:0')
compute distance is  tensor(13.4852, device='cuda:0')
compute norm is  tensor(52.0141, device='cuda:0')
distance 1 is tensor(183.1542, device='cuda:0')
distance 2 is tensor(14.0173, device='cuda:0')
compute distance is  tensor(14.0173, device='cuda:0')
compute norm is  tensor(52.1995, device='cuda:0')
distance 1 is tensor(177.3172, device='cuda:0')
distance 2 is tensor(13.7755, device='cuda:0')
compute distance is  tensor(13.7755, device='cuda:0')
compute norm is  tensor(52.0882, device='cuda:0')
distance Threshold  is  tensor(14.6115, device='cuda:0')
distance 1 is tensor(1009177.8750, device='cuda:0')
distance 2 is tensor(73616.1641, device='cuda:0')
________________________________
test distance is  tensor(73616.1641, device='cuda:0')
test similarity is  tensor(0.0663, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.825829681838917e+17
test entropy is  0.0
________________________________
cal ratio is  0.012679552608875771
distance 1 is tensor(12795.9307, device='cuda:0')
distance 2 is tensor(933.4200, device='cuda:0')
cal_distance is  tensor(933.4200, device='cuda:0')
cal ratio is  0.11260351916795139
distance 1 is tensor(1440.8722, device='cuda:0')
distance 2 is tensor(105.1064, device='cuda:0')
cal_distance is  tensor(105.1064, device='cuda:0')
cal ratio is  0.33556447543612355
distance 1 is tensor(483.5095, device='cuda:0')
distance 2 is tensor(35.2700, device='cuda:0')
cal_distance is  tensor(35.2700, device='cuda:0')
cal ratio is  0.5792792558723695
distance 1 is tensor(280.0896, device='cuda:0')
distance 2 is tensor(20.4312, device='cuda:0')
cal_distance is  tensor(20.4312, device='cuda:0')
cal ratio is  0.7611040457912328
distance 1 is tensor(213.1787, device='cuda:0')
distance 2 is tensor(15.5502, device='cuda:0')
cal_distance is  tensor(15.5502, device='cuda:0')
cal ratio is  0.8724127157295346
distance 1 is tensor(185.9806, device='cuda:0')
distance 2 is tensor(13.5662, device='cuda:0')
cal_distance is  tensor(13.5662, device='cuda:0')
distance 1 is tensor(185.9806, device='cuda:0')
distance 2 is tensor(13.5662, device='cuda:0')
________________________________
test distance is  tensor(13.5662, device='cuda:0')
test similarity is  tensor(0.9266, device='cuda:0')
test acc is  0.5923000001563381
test loss is 178.11891426460576
test entropy is  0.0020933387830243022
________________________________
distance 1 is tensor(185.9806, device='cuda:0')
distance 2 is tensor(13.5662, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0022418755512684354
avg test loss is  177.85880835884925
avg accuracy is  0.5902500001563382
solo acc is  0.11180000015633196
compute similarity  is  tensor(0.9266, device='cuda:0')
compute_distance is  tensor(13.5662, device='cuda:0')
compute_norm is  tensor(52.3917, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(169.4190, device='cuda:0')
distance 2 is tensor(14.4563, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.001759293808866
avg test loss is  1.554711736468618
avg accuracy is  0.7558166668229941
solo acc is  0.2887500001563393
compute similarity  is  tensor(0.9296, device='cuda:0')
compute_distance is  tensor(14.4563, device='cuda:0')
compute_norm is  tensor(51.9398, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(170.3237, device='cuda:0')
distance 2 is tensor(14.7539, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.6258628277509197
avg test loss is  2.478004563973148
avg accuracy is  0.6967500001563307
solo acc is  0.1156666668229986
compute similarity  is  tensor(0.9291, device='cuda:0')
compute_distance is  tensor(14.7539, device='cuda:0')
compute_norm is  tensor(51.7310, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(170.6066, device='cuda:0')
distance 2 is tensor(14.7782, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9671342590216127
avg test loss is  1.488982199732937
avg accuracy is  0.7562333334896608
solo acc is  0.28061666682300584
compute similarity  is  tensor(0.9293, device='cuda:0')
compute_distance is  tensor(14.7782, device='cuda:0')
compute_norm is  tensor(51.4149, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(170.6066, device='cuda:0')
distance 2 is tensor(14.7782, device='cuda:0')
________________________________
test distance is  tensor(14.7782, device='cuda:0')
test similarity is  tensor(0.9293, device='cuda:0')
test acc is  0.7593000001563274
test loss is 1.486147056256276
test entropy is  0.9656669519095025
________________________________
cal ratio is  0.8949097931011769
distance 1 is tensor(152.6781, device='cuda:0')
distance 2 is tensor(13.2252, device='cuda:0')
cal_distance is  tensor(13.2252, device='cuda:0')
distance 1 is tensor(152.6781, device='cuda:0')
distance 2 is tensor(13.2252, device='cuda:0')
________________________________
test distance is  tensor(13.2252, device='cuda:0')
test similarity is  tensor(0.9421, device='cuda:0')
test acc is  0.7780666668229931
test loss is 1.2450213392279041
test entropy is  1.1164307719481779
________________________________
distance 1 is tensor(152.6781, device='cuda:0')
distance 2 is tensor(13.2252, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.1151940199230779
avg test loss is  1.2456522489915778
avg accuracy is  0.7780333334896599
solo acc is  0.40141666682300775
compute similarity  is  tensor(0.9421, device='cuda:0')
compute_distance is  tensor(13.2252, device='cuda:0')
compute_norm is  tensor(50.9410, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(154.3611, device='cuda:0')
distance 2 is tensor(13.5673, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.5960138116373437
avg test loss is  2.389023892152538
avg accuracy is  0.7181166668229962
solo acc is  0.11310000015633194
compute similarity  is  tensor(0.9414, device='cuda:0')
compute_distance is  tensor(13.5673, device='cuda:0')
compute_norm is  tensor(50.7483, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(155.1873, device='cuda:0')
distance 2 is tensor(13.5821, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9490273864919951
avg test loss is  1.4207517894854678
avg accuracy is  0.7754833334896598
solo acc is  0.28700000015633925
compute similarity  is  tensor(0.9415, device='cuda:0')
compute_distance is  tensor(13.5821, device='cuda:0')
compute_norm is  tensor(50.4372, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(155.1873, device='cuda:0')
distance 2 is tensor(13.5821, device='cuda:0')
________________________________
test distance is  tensor(13.5821, device='cuda:0')
test similarity is  tensor(0.9415, device='cuda:0')
test acc is  0.77428333348966
test loss is 1.4203807135889017
test entropy is  0.9468720498115524
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3359204530715942
mal norm is  tensor(7.9242, device='cuda:0')
distance 1 is tensor(155.1873, device='cuda:0')
distance 2 is tensor(13.5821, device='cuda:0')
mal distance is  tensor(13.5821, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.3060, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.2680, device='cuda:0')
c is  tensor(0.0236, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.5792, device='cuda:0')
c is  tensor(0.0239, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.7297, device='cuda:0')
c is  tensor(0.0238, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(525.6318, device='cuda:0')
c is  tensor(0.0241, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(559.9649, device='cuda:0')
c is  tensor(0.0234, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1405, device='cuda:0')
c is  tensor(0.0213, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0012, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.4896, device='cuda:0')
c is  tensor(0.0239, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.2322, device='cuda:0')
c is  tensor(0.0227, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.8502e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.4247, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 81.52% 

Test Accuracy: 80.35% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1776614636182785
distance 1 is tensor(207.8230, device='cuda:0')
distance 2 is tensor(15.2195, device='cuda:0')
benign distance is  tensor(15.2195, device='cuda:0')
norm1 res is  tensor(0.2050, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.45675143599510193
distance 1 is tensor(192.0273, device='cuda:0')
distance 2 is tensor(14.6208, device='cuda:0')
benign distance is  tensor(14.6208, device='cuda:0')
norm1 res is  tensor(0.1858, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7187376618385315
distance 1 is tensor(212.0826, device='cuda:0')
distance 2 is tensor(15.9640, device='cuda:0')
benign distance is  tensor(15.9640, device='cuda:0')
norm1 res is  tensor(0.2091, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.7153449058532715
distance 1 is tensor(199.2576, device='cuda:0')
distance 2 is tensor(14.7580, device='cuda:0')
benign distance is  tensor(14.7580, device='cuda:0')
norm1 res is  tensor(0.1941, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6563867330551147
distance 1 is tensor(194.9621, device='cuda:0')
distance 2 is tensor(14.7750, device='cuda:0')
benign distance is  tensor(14.7750, device='cuda:0')
norm1 res is  tensor(0.1899, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7259531617164612
distance 1 is tensor(197.4163, device='cuda:0')
distance 2 is tensor(14.8367, device='cuda:0')
benign distance is  tensor(14.8367, device='cuda:0')
norm1 res is  tensor(0.1936, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.5694743394851685
distance 1 is tensor(196.7204, device='cuda:0')
distance 2 is tensor(14.6979, device='cuda:0')
benign distance is  tensor(14.6979, device='cuda:0')
norm1 res is  tensor(0.1911, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6298651099205017
distance 1 is tensor(214.0654, device='cuda:0')
distance 2 is tensor(16.0549, device='cuda:0')
benign distance is  tensor(16.0549, device='cuda:0')
norm1 res is  tensor(0.2069, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(216.6145, device='cuda:0')
distance 2 is tensor(17.1734, device='cuda:0')
compute distance is  tensor(17.1734, device='cuda:0')
compute norm is  tensor(50.6336, device='cuda:0')
distance 1 is tensor(213.2934, device='cuda:0')
distance 2 is tensor(17.1113, device='cuda:0')
compute distance is  tensor(17.1113, device='cuda:0')
compute norm is  tensor(50.4908, device='cuda:0')
distance 1 is tensor(224.6955, device='cuda:0')
distance 2 is tensor(17.8232, device='cuda:0')
compute distance is  tensor(17.8232, device='cuda:0')
compute norm is  tensor(51.0468, device='cuda:0')
distance 1 is tensor(224.5231, device='cuda:0')
distance 2 is tensor(17.6300, device='cuda:0')
compute distance is  tensor(17.6300, device='cuda:0')
compute norm is  tensor(50.9749, device='cuda:0')
distance 1 is tensor(215.2501, device='cuda:0')
distance 2 is tensor(17.0586, device='cuda:0')
compute distance is  tensor(17.0586, device='cuda:0')
compute norm is  tensor(50.7030, device='cuda:0')
distance 1 is tensor(229.1856, device='cuda:0')
distance 2 is tensor(17.9529, device='cuda:0')
compute distance is  tensor(17.9529, device='cuda:0')
compute norm is  tensor(51.0072, device='cuda:0')
distance 1 is tensor(218.2919, device='cuda:0')
distance 2 is tensor(17.3658, device='cuda:0')
compute distance is  tensor(17.3658, device='cuda:0')
compute norm is  tensor(50.8018, device='cuda:0')
distance 1 is tensor(216.5533, device='cuda:0')
distance 2 is tensor(17.2638, device='cuda:0')
compute distance is  tensor(17.2638, device='cuda:0')
compute norm is  tensor(50.8034, device='cuda:0')
distance 1 is tensor(218.7823, device='cuda:0')
distance 2 is tensor(17.4353, device='cuda:0')
compute distance is  tensor(17.4353, device='cuda:0')
compute norm is  tensor(50.7675, device='cuda:0')
distance 1 is tensor(215.2050, device='cuda:0')
distance 2 is tensor(17.1829, device='cuda:0')
compute distance is  tensor(17.1829, device='cuda:0')
compute norm is  tensor(50.7660, device='cuda:0')
distance 1 is tensor(222.9373, device='cuda:0')
distance 2 is tensor(17.6819, device='cuda:0')
compute distance is  tensor(17.6819, device='cuda:0')
compute norm is  tensor(50.9802, device='cuda:0')
distance 1 is tensor(210.9885, device='cuda:0')
distance 2 is tensor(16.8387, device='cuda:0')
compute distance is  tensor(16.8387, device='cuda:0')
compute norm is  tensor(50.6935, device='cuda:0')
distance Threshold  is  tensor(17.9529, device='cuda:0')
distance 1 is tensor(1009106.9375, device='cuda:0')
distance 2 is tensor(73610.3203, device='cuda:0')
________________________________
test distance is  tensor(73610.3203, device='cuda:0')
test similarity is  tensor(0.2560, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.824374993449107e+17
test entropy is  0.0
________________________________
cal ratio is  0.014055325775429513
distance 1 is tensor(14183.3330, device='cuda:0')
distance 2 is tensor(1034.6171, device='cuda:0')
cal_distance is  tensor(1034.6171, device='cuda:0')
cal ratio is  0.11855515632348161
distance 1 is tensor(1681.5126, device='cuda:0')
distance 2 is tensor(122.6592, device='cuda:0')
cal_distance is  tensor(122.6592, device='cuda:0')
cal ratio is  0.3443183942059361
distance 1 is tensor(578.9796, device='cuda:0')
distance 2 is tensor(42.2338, device='cuda:0')
cal_distance is  tensor(42.2338, device='cuda:0')
cal ratio is  0.5867865217258201
distance 1 is tensor(339.7399, device='cuda:0')
distance 2 is tensor(24.7822, device='cuda:0')
cal_distance is  tensor(24.7822, device='cuda:0')
cal ratio is  0.7660199617985772
distance 1 is tensor(260.2489, device='cuda:0')
distance 2 is tensor(18.9837, device='cuda:0')
cal_distance is  tensor(18.9837, device='cuda:0')
cal ratio is  0.8752256766570353
distance 1 is tensor(227.7773, device='cuda:0')
distance 2 is tensor(16.6150, device='cuda:0')
cal_distance is  tensor(16.6150, device='cuda:0')
distance 1 is tensor(227.7773, device='cuda:0')
distance 2 is tensor(16.6150, device='cuda:0')
________________________________
test distance is  tensor(16.6150, device='cuda:0')
test similarity is  tensor(0.9186, device='cuda:0')
test acc is  0.12898333348966526
test loss is 523.3457006848952
test entropy is  9.09674630586196e-09
________________________________
distance 1 is tensor(227.7773, device='cuda:0')
distance 2 is tensor(16.6150, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.8579430022341572e-07
avg test loss is  523.0868444056399
avg accuracy is  0.12786666682299858
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9186, device='cuda:0')
compute_distance is  tensor(16.6150, device='cuda:0')
compute_norm is  tensor(56.2343, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(219.7808, device='cuda:0')
distance 2 is tensor(20.0746, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.5021039928708757
avg test loss is  2.418603375268135
avg accuracy is  0.24185000015633804
solo acc is  0.13260000015633192
compute similarity  is  tensor(0.9204, device='cuda:0')
compute_distance is  tensor(20.0746, device='cuda:0')
compute_norm is  tensor(57.6183, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(220.0216, device='cuda:0')
distance 2 is tensor(20.3598, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8426447418579923
avg test loss is  3.145144391924079
avg accuracy is  0.1713166668230015
solo acc is  0.10170000015633197
compute similarity  is  tensor(0.9201, device='cuda:0')
compute_distance is  tensor(20.3598, device='cuda:0')
compute_norm is  tensor(57.7696, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(218.3558, device='cuda:0')
distance 2 is tensor(19.6338, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  1.0906523083572957
avg test loss is  1.85227794395581
avg accuracy is  0.26793333348967213
solo acc is  0.21970000015633726
compute similarity  is  tensor(0.9212, device='cuda:0')
compute_distance is  tensor(19.6338, device='cuda:0')
compute_norm is  tensor(57.2029, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(218.0459, device='cuda:0')
distance 2 is tensor(19.6599, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.6714888308475266
avg test loss is  2.660652655782476
avg accuracy is  0.18656666682300235
solo acc is  0.11225000015633195
compute similarity  is  tensor(0.9210, device='cuda:0')
compute_distance is  tensor(19.6599, device='cuda:0')
compute_norm is  tensor(57.0833, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(217.3921, device='cuda:0')
distance 2 is tensor(19.2043, device='cuda:0')
________________________________
test distance is  tensor(19.2043, device='cuda:0')
test similarity is  tensor(0.9214, device='cuda:0')
test acc is  0.2820000001563392
test loss is 1.727217275323644
test entropy is  1.0558575333944007
________________________________
cal ratio is  0.8701827978193284
distance 1 is tensor(189.1716, device='cuda:0')
distance 2 is tensor(16.7113, device='cuda:0')
cal_distance is  tensor(16.7113, device='cuda:0')
distance 1 is tensor(189.1716, device='cuda:0')
distance 2 is tensor(16.7113, device='cuda:0')
________________________________
test distance is  tensor(16.7113, device='cuda:0')
test similarity is  tensor(0.9373, device='cuda:0')
test acc is  0.3259833334896734
test loss is 1.6985062914870694
test entropy is  1.1695777482823777
________________________________
distance 1 is tensor(189.1716, device='cuda:0')
distance 2 is tensor(16.7113, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.1711417667901338
avg test loss is  1.6978443877529235
avg accuracy is  0.32345000015633996
solo acc is  0.2078500001563368
compute similarity  is  tensor(0.9373, device='cuda:0')
compute_distance is  tensor(16.7113, device='cuda:0')
compute_norm is  tensor(55.3339, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(189.2044, device='cuda:0')
distance 2 is tensor(16.8153, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.6669252399823813
avg test loss is  2.5262954630323056
avg accuracy is  0.21616666682300376
solo acc is  0.10965000015633196
compute similarity  is  tensor(0.9370, device='cuda:0')
compute_distance is  tensor(16.8153, device='cuda:0')
compute_norm is  tensor(55.2257, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(188.7886, device='cuda:0')
distance 2 is tensor(16.5485, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  1.0053420864315683
avg test loss is  1.597567679277107
avg accuracy is  0.3535833334896738
solo acc is  0.24976666682300497
compute similarity  is  tensor(0.9372, device='cuda:0')
compute_distance is  tensor(16.5485, device='cuda:0')
compute_norm is  tensor(54.8253, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(188.8042, device='cuda:0')
distance 2 is tensor(16.6320, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.6328783161731671
avg test loss is  2.441665988614056
avg accuracy is  0.23023333348967093
solo acc is  0.11073333348966528
compute similarity  is  tensor(0.9370, device='cuda:0')
compute_distance is  tensor(16.6320, device='cuda:0')
compute_norm is  tensor(54.6824, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(188.4753, device='cuda:0')
distance 2 is tensor(16.4119, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.9810678644983499
avg test loss is  1.528378695313102
avg accuracy is  0.3815833334896742
solo acc is  0.2571166668230052
compute similarity  is  tensor(0.9371, device='cuda:0')
compute_distance is  tensor(16.4119, device='cuda:0')
compute_norm is  tensor(54.2856, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(188.4753, device='cuda:0')
distance 2 is tensor(16.4119, device='cuda:0')
________________________________
test distance is  tensor(16.4119, device='cuda:0')
test similarity is  tensor(0.9371, device='cuda:0')
test acc is  0.38025000015634086
test loss is 1.5327841863195018
test entropy is  0.9806516385917217
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.468430757522583
mal norm is  tensor(9.2131, device='cuda:0')
distance 1 is tensor(188.4753, device='cuda:0')
distance 2 is tensor(16.4119, device='cuda:0')
mal distance is  tensor(16.4119, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2523, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(799.7385, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.3657, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(825.4755, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.5902, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7302, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(765.6100, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.1071, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(814.2744, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(921.3055, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(803.6608, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.7728, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.6462, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(784.5438, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(740.4059, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(840.9929, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.4246, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4581, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 90.76% 

Test Accuracy: 88.69% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6508752703666687
distance 1 is tensor(143.1207, device='cuda:0')
distance 2 is tensor(10.4021, device='cuda:0')
benign distance is  tensor(10.4021, device='cuda:0')
norm1 res is  tensor(0.1456, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5737022757530212
distance 1 is tensor(137.5623, device='cuda:0')
distance 2 is tensor(9.9466, device='cuda:0')
benign distance is  tensor(9.9466, device='cuda:0')
norm1 res is  tensor(0.1388, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.26970261335372925
distance 1 is tensor(128.9834, device='cuda:0')
distance 2 is tensor(9.4979, device='cuda:0')
benign distance is  tensor(9.4979, device='cuda:0')
norm1 res is  tensor(0.1302, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.599646806716919
distance 1 is tensor(139.1206, device='cuda:0')
distance 2 is tensor(10.0318, device='cuda:0')
benign distance is  tensor(10.0318, device='cuda:0')
norm1 res is  tensor(0.1432, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.1626185178756714
distance 1 is tensor(153.5235, device='cuda:0')
distance 2 is tensor(10.8361, device='cuda:0')
benign distance is  tensor(10.8361, device='cuda:0')
norm1 res is  tensor(0.1549, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.9266238212585449
distance 1 is tensor(146.3693, device='cuda:0')
distance 2 is tensor(10.6860, device='cuda:0')
benign distance is  tensor(10.6860, device='cuda:0')
norm1 res is  tensor(0.1475, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.2513996958732605
distance 1 is tensor(120.7076, device='cuda:0')
distance 2 is tensor(8.8003, device='cuda:0')
benign distance is  tensor(8.8003, device='cuda:0')
norm1 res is  tensor(0.1219, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.9551989436149597
distance 1 is tensor(159.7176, device='cuda:0')
distance 2 is tensor(11.4140, device='cuda:0')
benign distance is  tensor(11.4140, device='cuda:0')
norm1 res is  tensor(0.1609, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.3460704982280731
distance 1 is tensor(151.7586, device='cuda:0')
distance 2 is tensor(10.7272, device='cuda:0')
benign distance is  tensor(10.7272, device='cuda:0')
norm1 res is  tensor(0.1544, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.4240848422050476
distance 1 is tensor(141.5836, device='cuda:0')
distance 2 is tensor(10.3314, device='cuda:0')
benign distance is  tensor(10.3314, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.44956088066101074
distance 1 is tensor(152.3264, device='cuda:0')
distance 2 is tensor(10.9683, device='cuda:0')
benign distance is  tensor(10.9683, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.9936696887016296
distance 1 is tensor(152.6320, device='cuda:0')
distance 2 is tensor(10.9962, device='cuda:0')
benign distance is  tensor(10.9962, device='cuda:0')
norm1 res is  tensor(0.1537, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.36640703678131104
distance 1 is tensor(137.8066, device='cuda:0')
distance 2 is tensor(10.0778, device='cuda:0')
benign distance is  tensor(10.0778, device='cuda:0')
norm1 res is  tensor(0.1404, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.3432818055152893
distance 1 is tensor(147.5296, device='cuda:0')
distance 2 is tensor(10.7104, device='cuda:0')
benign distance is  tensor(10.7104, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.13902530074119568
distance 1 is tensor(144.2212, device='cuda:0')
distance 2 is tensor(10.6132, device='cuda:0')
benign distance is  tensor(10.6132, device='cuda:0')
norm1 res is  tensor(0.1455, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.5337368845939636
distance 1 is tensor(141.0682, device='cuda:0')
distance 2 is tensor(10.2153, device='cuda:0')
benign distance is  tensor(10.2153, device='cuda:0')
norm1 res is  tensor(0.1398, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(201.3153, device='cuda:0')
distance 2 is tensor(14.2438, device='cuda:0')
compute distance is  tensor(14.2438, device='cuda:0')
compute norm is  tensor(51.6340, device='cuda:0')
distance 1 is tensor(214.3954, device='cuda:0')
distance 2 is tensor(15.0936, device='cuda:0')
compute distance is  tensor(15.0936, device='cuda:0')
compute norm is  tensor(51.8637, device='cuda:0')
distance 1 is tensor(227.2851, device='cuda:0')
distance 2 is tensor(15.9174, device='cuda:0')
compute distance is  tensor(15.9174, device='cuda:0')
compute norm is  tensor(52.4339, device='cuda:0')
distance 1 is tensor(208.8674, device='cuda:0')
distance 2 is tensor(14.7671, device='cuda:0')
compute distance is  tensor(14.7671, device='cuda:0')
compute norm is  tensor(51.6515, device='cuda:0')
distance 1 is tensor(233.5079, device='cuda:0')
distance 2 is tensor(16.5699, device='cuda:0')
compute distance is  tensor(16.5699, device='cuda:0')
compute norm is  tensor(52.8964, device='cuda:0')
distance 1 is tensor(230.4236, device='cuda:0')
distance 2 is tensor(16.1657, device='cuda:0')
compute distance is  tensor(16.1657, device='cuda:0')
compute norm is  tensor(52.4348, device='cuda:0')
distance 1 is tensor(227.4891, device='cuda:0')
distance 2 is tensor(16.3470, device='cuda:0')
compute distance is  tensor(16.3470, device='cuda:0')
compute norm is  tensor(52.4986, device='cuda:0')
distance 1 is tensor(218.7181, device='cuda:0')
distance 2 is tensor(15.3453, device='cuda:0')
compute distance is  tensor(15.3453, device='cuda:0')
compute norm is  tensor(52.1979, device='cuda:0')
distance 1 is tensor(253.4355, device='cuda:0')
distance 2 is tensor(17.3571, device='cuda:0')
compute distance is  tensor(17.3571, device='cuda:0')
compute norm is  tensor(53.1104, device='cuda:0')
distance 1 is tensor(205.5749, device='cuda:0')
distance 2 is tensor(14.6153, device='cuda:0')
compute distance is  tensor(14.6153, device='cuda:0')
compute norm is  tensor(51.8688, device='cuda:0')
distance 1 is tensor(223.9863, device='cuda:0')
distance 2 is tensor(15.8428, device='cuda:0')
compute distance is  tensor(15.8428, device='cuda:0')
compute norm is  tensor(52.2239, device='cuda:0')
distance 1 is tensor(208.7791, device='cuda:0')
distance 2 is tensor(14.7478, device='cuda:0')
compute distance is  tensor(14.7478, device='cuda:0')
compute norm is  tensor(52.1252, device='cuda:0')
distance Threshold  is  tensor(17.3571, device='cuda:0')
distance 1 is tensor(1009158., device='cuda:0')
distance 2 is tensor(73614.6328, device='cuda:0')
________________________________
test distance is  tensor(73614.6328, device='cuda:0')
test similarity is  tensor(0.1428, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.8220036070203e+17
test entropy is  0.0
________________________________
cal ratio is  0.013819718746864038
distance 1 is tensor(13946.2852, device='cuda:0')
distance 2 is tensor(1017.3335, device='cuda:0')
cal_distance is  tensor(1017.3335, device='cuda:0')
cal ratio is  0.1175572981242527
distance 1 is tensor(1639.4927, device='cuda:0')
distance 2 is tensor(119.5949, device='cuda:0')
cal_distance is  tensor(119.5949, device='cuda:0')
cal ratio is  0.3428663509326617
distance 1 is tensor(562.1309, device='cuda:0')
distance 2 is tensor(41.0051, device='cuda:0')
cal_distance is  tensor(41.0051, device='cuda:0')
cal ratio is  0.5855478318545696
distance 1 is tensor(329.1570, device='cuda:0')
distance 2 is tensor(24.0104, device='cuda:0')
cal_distance is  tensor(24.0104, device='cuda:0')
cal ratio is  0.7652109957478277
distance 1 is tensor(251.8760, device='cuda:0')
distance 2 is tensor(18.3731, device='cuda:0')
cal_distance is  tensor(18.3731, device='cuda:0')
cal ratio is  0.8747634847331526
distance 1 is tensor(220.3326, device='cuda:0')
distance 2 is tensor(16.0721, device='cuda:0')
cal_distance is  tensor(16.0721, device='cuda:0')
distance 1 is tensor(220.3326, device='cuda:0')
distance 2 is tensor(16.0721, device='cuda:0')
________________________________
test distance is  tensor(16.0721, device='cuda:0')
test similarity is  tensor(0.9114, device='cuda:0')
test acc is  0.5615666668230075
test loss is 305.9873853085646
test entropy is  0.0006896184463400285
________________________________
distance 1 is tensor(220.3326, device='cuda:0')
distance 2 is tensor(16.0721, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0006908437731102879
avg test loss is  306.00961632311726
avg accuracy is  0.5649166668230072
solo acc is  0.10386666682299864
compute similarity  is  tensor(0.9114, device='cuda:0')
compute_distance is  tensor(16.0721, device='cuda:0')
compute_norm is  tensor(54.7360, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(204.4848, device='cuda:0')
distance 2 is tensor(18.7222, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.2108368421160083
avg test loss is  1.8349413599795117
avg accuracy is  0.5831666668230057
solo acc is  0.22820000015633757
compute similarity  is  tensor(0.9139, device='cuda:0')
compute_distance is  tensor(18.7222, device='cuda:0')
compute_norm is  tensor(55.3488, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(205.0135, device='cuda:0')
distance 2 is tensor(18.9308, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.7185755829567085
avg test loss is  2.701183686886769
avg accuracy is  0.4638666668230084
solo acc is  0.11321666682299861
compute similarity  is  tensor(0.9134, device='cuda:0')
compute_distance is  tensor(18.9308, device='cuda:0')
compute_norm is  tensor(55.3167, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(204.6711, device='cuda:0')
distance 2 is tensor(18.5270, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  1.025956409381651
avg test loss is  1.626849058467442
avg accuracy is  0.6227500001563357
solo acc is  0.2579166668230052
compute similarity  is  tensor(0.9139, device='cuda:0')
compute_distance is  tensor(18.5270, device='cuda:0')
compute_norm is  tensor(54.8706, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(205.0777, device='cuda:0')
distance 2 is tensor(18.6504, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.6327075908687323
avg test loss is  2.497006060090909
avg accuracy is  0.5160000001563422
solo acc is  0.11233333348966529
compute similarity  is  tensor(0.9135, device='cuda:0')
compute_distance is  tensor(18.6504, device='cuda:0')
compute_norm is  tensor(54.7247, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(204.8427, device='cuda:0')
distance 2 is tensor(18.3268, device='cuda:0')
________________________________
test distance is  tensor(18.3268, device='cuda:0')
test similarity is  tensor(0.9138, device='cuda:0')
test acc is  0.6428333334896675
test loss is 1.5576107907396899
test entropy is  0.9950418312158158
________________________________
cal ratio is  0.8758675620349964
distance 1 is tensor(179.4159, device='cuda:0')
distance 2 is tensor(16.0518, device='cuda:0')
cal_distance is  tensor(16.0518, device='cuda:0')
distance 1 is tensor(179.4159, device='cuda:0')
distance 2 is tensor(16.0518, device='cuda:0')
________________________________
test distance is  tensor(16.0518, device='cuda:0')
test similarity is  tensor(0.9313, device='cuda:0')
test acc is  0.7013000001563305
test loss is 1.3914308492054563
test entropy is  1.185696802413794
________________________________
distance 1 is tensor(179.4159, device='cuda:0')
distance 2 is tensor(16.0518, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.1860152578303047
avg test loss is  1.3930836449553972
avg accuracy is  0.7008333334896639
solo acc is  0.309883333489673
compute similarity  is  tensor(0.9313, device='cuda:0')
compute_distance is  tensor(16.0518, device='cuda:0')
compute_norm is  tensor(53.3688, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(180.7504, device='cuda:0')
distance 2 is tensor(16.3407, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.6394849364310186
avg test loss is  2.3847503149941534
avg accuracy is  0.6068666668230037
solo acc is  0.11136666682299862
compute similarity  is  tensor(0.9305, device='cuda:0')
compute_distance is  tensor(16.3407, device='cuda:0')
compute_norm is  tensor(53.2547, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(181.0241, device='cuda:0')
distance 2 is tensor(16.1617, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9818571809131199
avg test loss is  1.5118517152536144
avg accuracy is  0.7020500001563305
solo acc is  0.24996666682300497
compute similarity  is  tensor(0.9307, device='cuda:0')
compute_distance is  tensor(16.1617, device='cuda:0')
compute_norm is  tensor(52.8982, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(181.0241, device='cuda:0')
distance 2 is tensor(16.1617, device='cuda:0')
________________________________
test distance is  tensor(16.1617, device='cuda:0')
test similarity is  tensor(0.9307, device='cuda:0')
test acc is  0.7006000001563305
test loss is 1.5099205565350904
test entropy is  0.9812604030693518
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2391581535339355
mal norm is  tensor(9.1375, device='cuda:0')
distance 1 is tensor(181.0241, device='cuda:0')
distance 2 is tensor(16.1617, device='cuda:0')
mal distance is  tensor(16.1617, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.2469, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.9784, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.1252, device='cuda:0')
c is  tensor(0.0214, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.8446, device='cuda:0')
c is  tensor(0.0219, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.0937, device='cuda:0')
c is  tensor(0.0211, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6557, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.4330, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(481.2982, device='cuda:0')
c is  tensor(0.0226, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.1310, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(913.7491, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(781.2763, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(795.4623, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.1336, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(793.5304, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.4598, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.5364, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.8055e-07, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.1387, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.1644, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.1989, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.9102, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7004, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.9359, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.9010, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9188e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.5553, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.0231, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.3314, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
len accept list 22
len all weights is 22
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 83.40% 

Test Accuracy: 81.74% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
 benign loss is  1.0722134113311768
distance 1 is tensor(179.9411, device='cuda:0')
distance 2 is tensor(13.2225, device='cuda:0')
benign distance is  tensor(13.2225, device='cuda:0')
norm1 res is  tensor(0.1754, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.763116180896759
distance 1 is tensor(166.3263, device='cuda:0')
distance 2 is tensor(12.3830, device='cuda:0')
benign distance is  tensor(12.3830, device='cuda:0')
norm1 res is  tensor(0.1650, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.5303868651390076
distance 1 is tensor(191.1015, device='cuda:0')
distance 2 is tensor(14.1002, device='cuda:0')
benign distance is  tensor(14.1002, device='cuda:0')
norm1 res is  tensor(0.1847, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.7217844724655151
distance 1 is tensor(192.7321, device='cuda:0')
distance 2 is tensor(14.1764, device='cuda:0')
benign distance is  tensor(14.1764, device='cuda:0')
norm1 res is  tensor(0.1867, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.1105997562408447
distance 1 is tensor(164.3039, device='cuda:0')
distance 2 is tensor(12.1445, device='cuda:0')
benign distance is  tensor(12.1445, device='cuda:0')
norm1 res is  tensor(0.1576, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5198172330856323
distance 1 is tensor(191.9468, device='cuda:0')
distance 2 is tensor(14.1060, device='cuda:0')
benign distance is  tensor(14.1060, device='cuda:0')
norm1 res is  tensor(0.1892, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.2675151228904724
distance 1 is tensor(184.8824, device='cuda:0')
distance 2 is tensor(13.5333, device='cuda:0')
benign distance is  tensor(13.5333, device='cuda:0')
norm1 res is  tensor(0.1838, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.34595930576324463
distance 1 is tensor(187.4774, device='cuda:0')
distance 2 is tensor(14.0436, device='cuda:0')
benign distance is  tensor(14.0436, device='cuda:0')
norm1 res is  tensor(0.1868, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.4336095452308655
distance 1 is tensor(194.9763, device='cuda:0')
distance 2 is tensor(14.2597, device='cuda:0')
benign distance is  tensor(14.2597, device='cuda:0')
norm1 res is  tensor(0.1890, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.794112503528595
distance 1 is tensor(186.9058, device='cuda:0')
distance 2 is tensor(14.0694, device='cuda:0')
benign distance is  tensor(14.0694, device='cuda:0')
norm1 res is  tensor(0.1838, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.4619804918766022
distance 1 is tensor(196.7601, device='cuda:0')
distance 2 is tensor(14.5281, device='cuda:0')
benign distance is  tensor(14.5281, device='cuda:0')
norm1 res is  tensor(0.1922, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.4523340165615082
distance 1 is tensor(186.5980, device='cuda:0')
distance 2 is tensor(13.6375, device='cuda:0')
benign distance is  tensor(13.6375, device='cuda:0')
norm1 res is  tensor(0.1827, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.517882227897644
distance 1 is tensor(185.3232, device='cuda:0')
distance 2 is tensor(13.6514, device='cuda:0')
benign distance is  tensor(13.6514, device='cuda:0')
norm1 res is  tensor(0.1786, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.7499058246612549
distance 1 is tensor(174.0543, device='cuda:0')
distance 2 is tensor(12.9360, device='cuda:0')
benign distance is  tensor(12.9360, device='cuda:0')
norm1 res is  tensor(0.1742, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.6082128882408142
distance 1 is tensor(189.5231, device='cuda:0')
distance 2 is tensor(14.1404, device='cuda:0')
benign distance is  tensor(14.1404, device='cuda:0')
norm1 res is  tensor(0.1878, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.0292185544967651
distance 1 is tensor(171.9173, device='cuda:0')
distance 2 is tensor(12.9990, device='cuda:0')
benign distance is  tensor(12.9990, device='cuda:0')
norm1 res is  tensor(0.1691, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  1.0369219779968262
distance 1 is tensor(177.9593, device='cuda:0')
distance 2 is tensor(12.9068, device='cuda:0')
benign distance is  tensor(12.9068, device='cuda:0')
norm1 res is  tensor(0.1696, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.22095274925231934
distance 1 is tensor(172.4055, device='cuda:0')
distance 2 is tensor(13.2069, device='cuda:0')
benign distance is  tensor(13.2069, device='cuda:0')
norm1 res is  tensor(0.1699, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.12814953923225403
distance 1 is tensor(183.1953, device='cuda:0')
distance 2 is tensor(13.7614, device='cuda:0')
benign distance is  tensor(13.7614, device='cuda:0')
norm1 res is  tensor(0.1797, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.12935756146907806
distance 1 is tensor(196.5003, device='cuda:0')
distance 2 is tensor(14.6106, device='cuda:0')
benign distance is  tensor(14.6106, device='cuda:0')
norm1 res is  tensor(0.1904, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.5485676527023315
distance 1 is tensor(180.3089, device='cuda:0')
distance 2 is tensor(13.1941, device='cuda:0')
benign distance is  tensor(13.1941, device='cuda:0')
norm1 res is  tensor(0.1744, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.6359854936599731
distance 1 is tensor(177.8194, device='cuda:0')
distance 2 is tensor(13.1959, device='cuda:0')
benign distance is  tensor(13.1959, device='cuda:0')
norm1 res is  tensor(0.1725, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.7357884049415588
distance 1 is tensor(186.9751, device='cuda:0')
distance 2 is tensor(13.9875, device='cuda:0')
benign distance is  tensor(13.9875, device='cuda:0')
norm1 res is  tensor(0.1820, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.31656479835510254
distance 1 is tensor(183.3581, device='cuda:0')
distance 2 is tensor(13.3467, device='cuda:0')
benign distance is  tensor(13.3467, device='cuda:0')
norm1 res is  tensor(0.1788, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(210.0960, device='cuda:0')
distance 2 is tensor(16.4153, device='cuda:0')
compute distance is  tensor(16.4153, device='cuda:0')
compute norm is  tensor(50.7942, device='cuda:0')
distance 1 is tensor(202.3457, device='cuda:0')
distance 2 is tensor(16.0442, device='cuda:0')
compute distance is  tensor(16.0442, device='cuda:0')
compute norm is  tensor(50.7282, device='cuda:0')
distance 1 is tensor(205.9462, device='cuda:0')
distance 2 is tensor(16.2429, device='cuda:0')
compute distance is  tensor(16.2429, device='cuda:0')
compute norm is  tensor(50.8733, device='cuda:0')
distance 1 is tensor(201.6507, device='cuda:0')
distance 2 is tensor(15.9032, device='cuda:0')
compute distance is  tensor(15.9032, device='cuda:0')
compute norm is  tensor(50.5148, device='cuda:0')
distance 1 is tensor(205.3618, device='cuda:0')
distance 2 is tensor(16.2538, device='cuda:0')
compute distance is  tensor(16.2538, device='cuda:0')
compute norm is  tensor(50.8197, device='cuda:0')
distance 1 is tensor(210.8575, device='cuda:0')
distance 2 is tensor(16.5133, device='cuda:0')
compute distance is  tensor(16.5133, device='cuda:0')
compute norm is  tensor(50.8305, device='cuda:0')
distance 1 is tensor(211.4875, device='cuda:0')
distance 2 is tensor(16.5776, device='cuda:0')
compute distance is  tensor(16.5776, device='cuda:0')
compute norm is  tensor(50.9217, device='cuda:0')
distance 1 is tensor(208.6093, device='cuda:0')
distance 2 is tensor(16.3666, device='cuda:0')
compute distance is  tensor(16.3666, device='cuda:0')
compute norm is  tensor(50.9029, device='cuda:0')
distance 1 is tensor(206.0070, device='cuda:0')
distance 2 is tensor(16.3268, device='cuda:0')
compute distance is  tensor(16.3268, device='cuda:0')
compute norm is  tensor(50.8931, device='cuda:0')
distance 1 is tensor(200.8160, device='cuda:0')
distance 2 is tensor(15.8607, device='cuda:0')
compute distance is  tensor(15.8607, device='cuda:0')
compute norm is  tensor(50.6278, device='cuda:0')
distance 1 is tensor(211.8742, device='cuda:0')
distance 2 is tensor(16.4944, device='cuda:0')
compute distance is  tensor(16.4944, device='cuda:0')
compute norm is  tensor(50.9619, device='cuda:0')
distance 1 is tensor(195.8552, device='cuda:0')
distance 2 is tensor(15.6239, device='cuda:0')
compute distance is  tensor(15.6239, device='cuda:0')
compute norm is  tensor(50.6444, device='cuda:0')
distance Threshold  is  tensor(16.5776, device='cuda:0')
distance 1 is tensor(1009109., device='cuda:0')
distance 2 is tensor(73610.6797, device='cuda:0')
________________________________
test distance is  tensor(73610.6797, device='cuda:0')
test similarity is  tensor(0.2660, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.823653088019825e+17
test entropy is  0.0
________________________________
cal ratio is  0.013506206304486191
distance 1 is tensor(13629.2402, device='cuda:0')
distance 2 is tensor(994.2010, device='cuda:0')
cal_distance is  tensor(994.2010, device='cuda:0')
cal ratio is  0.11621620438765794
distance 1 is tensor(1583.9438, device='cuda:0')
distance 2 is tensor(115.5423, device='cuda:0')
cal_distance is  tensor(115.5423, device='cuda:0')
cal ratio is  0.3409049650939623
distance 1 is tensor(539.9783, device='cuda:0')
distance 2 is tensor(39.3889, device='cuda:0')
cal_distance is  tensor(39.3889, device='cuda:0')
cal ratio is  0.5838706589024744
distance 1 is tensor(315.2799, device='cuda:0')
distance 2 is tensor(22.9980, device='cuda:0')
cal_distance is  tensor(22.9980, device='cuda:0')
cal ratio is  0.764114340679269
distance 1 is tensor(240.9113, device='cuda:0')
distance 2 is tensor(17.5731, device='cuda:0')
cal_distance is  tensor(17.5731, device='cuda:0')
cal ratio is  0.8741363087662702
distance 1 is tensor(210.5901, device='cuda:0')
distance 2 is tensor(15.3613, device='cuda:0')
cal_distance is  tensor(15.3613, device='cuda:0')
distance 1 is tensor(210.5901, device='cuda:0')
distance 2 is tensor(15.3613, device='cuda:0')
________________________________
test distance is  tensor(15.3613, device='cuda:0')
test similarity is  tensor(0.9304, device='cuda:0')
test acc is  0.44443333348967495
test loss is 191.47075317968438
test entropy is  0.0017730202711034853
________________________________
distance 1 is tensor(210.5901, device='cuda:0')
distance 2 is tensor(15.3613, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0019901813288571335
avg test loss is  191.78695403792457
avg accuracy is  0.44771666682300826
solo acc is  0.10711666682299864
compute similarity  is  tensor(0.9304, device='cuda:0')
compute_distance is  tensor(15.3613, device='cuda:0')
compute_norm is  tensor(56.1610, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(192.0518, device='cuda:0')
distance 2 is tensor(15.8126, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.0273363166399347
avg test loss is  1.589743192007801
avg accuracy is  0.5442166668230091
solo acc is  0.24998333348967167
compute similarity  is  tensor(0.9338, device='cuda:0')
compute_distance is  tensor(15.8126, device='cuda:0')
compute_norm is  tensor(56.2216, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(192.2127, device='cuda:0')
distance 2 is tensor(16.0021, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.6435744398946701
avg test loss is  2.4399915638763003
avg accuracy is  0.3985500001563411
solo acc is  0.11236666682299862
compute similarity  is  tensor(0.9336, device='cuda:0')
compute_distance is  tensor(16.0021, device='cuda:0')
compute_norm is  tensor(56.0597, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(191.9944, device='cuda:0')
distance 2 is tensor(15.8404, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9934119842072794
avg test loss is  1.4920318110156923
avg accuracy is  0.5544166668230082
solo acc is  0.2663666668230054
compute similarity  is  tensor(0.9337, device='cuda:0')
compute_distance is  tensor(15.8404, device='cuda:0')
compute_norm is  tensor(55.6995, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(191.9944, device='cuda:0')
distance 2 is tensor(15.8404, device='cuda:0')
________________________________
test distance is  tensor(15.8404, device='cuda:0')
test similarity is  tensor(0.9337, device='cuda:0')
test acc is  0.5527166668230085
test loss is 1.4929146117238856
test entropy is  0.9936720263093773
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3315155506134033
mal norm is  tensor(10.0220, device='cuda:0')
distance 1 is tensor(191.9944, device='cuda:0')
distance 2 is tensor(15.8404, device='cuda:0')
mal distance is  tensor(15.8404, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2488, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.3326, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.2702, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.8474, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(740.9738, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.7180, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.7599, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.2581, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.0036, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1002.2010, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0018, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(799.1910, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(816.3737, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(852.8478, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.5316, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(819.2731, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.2019, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.8630, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(816.9480, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.1711, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.7982, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.5635, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.1838, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.0978, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.3112, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.0387, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.0605, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 90.97% 

Test Accuracy: 89.14% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8212903738021851
distance 1 is tensor(134.1913, device='cuda:0')
distance 2 is tensor(9.7286, device='cuda:0')
benign distance is  tensor(9.7286, device='cuda:0')
norm1 res is  tensor(0.1355, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8457714915275574
distance 1 is tensor(143.4144, device='cuda:0')
distance 2 is tensor(10.4989, device='cuda:0')
benign distance is  tensor(10.4989, device='cuda:0')
norm1 res is  tensor(0.1459, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.34761732816696167
distance 1 is tensor(149.8328, device='cuda:0')
distance 2 is tensor(10.7788, device='cuda:0')
benign distance is  tensor(10.7788, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.7322453260421753
distance 1 is tensor(127.3480, device='cuda:0')
distance 2 is tensor(9.1045, device='cuda:0')
benign distance is  tensor(9.1045, device='cuda:0')
norm1 res is  tensor(0.1265, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.695354700088501
distance 1 is tensor(132.0881, device='cuda:0')
distance 2 is tensor(9.4689, device='cuda:0')
benign distance is  tensor(9.4689, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.4300162196159363
distance 1 is tensor(144.1432, device='cuda:0')
distance 2 is tensor(10.4036, device='cuda:0')
benign distance is  tensor(10.4036, device='cuda:0')
norm1 res is  tensor(0.1463, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.11765013635158539
distance 1 is tensor(132.1295, device='cuda:0')
distance 2 is tensor(9.3975, device='cuda:0')
benign distance is  tensor(9.3975, device='cuda:0')
norm1 res is  tensor(0.1325, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.366159051656723
distance 1 is tensor(127.4644, device='cuda:0')
distance 2 is tensor(9.2324, device='cuda:0')
benign distance is  tensor(9.2324, device='cuda:0')
norm1 res is  tensor(0.1289, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.8019500970840454
distance 1 is tensor(148.9553, device='cuda:0')
distance 2 is tensor(10.9471, device='cuda:0')
benign distance is  tensor(10.9471, device='cuda:0')
norm1 res is  tensor(0.1556, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.11635307222604752
distance 1 is tensor(139.8529, device='cuda:0')
distance 2 is tensor(10.0455, device='cuda:0')
benign distance is  tensor(10.0455, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.29524827003479004
distance 1 is tensor(136.0211, device='cuda:0')
distance 2 is tensor(9.9187, device='cuda:0')
benign distance is  tensor(9.9187, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.6710840463638306
distance 1 is tensor(153.3990, device='cuda:0')
distance 2 is tensor(11.0666, device='cuda:0')
benign distance is  tensor(11.0666, device='cuda:0')
norm1 res is  tensor(0.1551, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.1353422403335571
distance 1 is tensor(148.6781, device='cuda:0')
distance 2 is tensor(10.7031, device='cuda:0')
benign distance is  tensor(10.7031, device='cuda:0')
norm1 res is  tensor(0.1522, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.3134656846523285
distance 1 is tensor(136.0969, device='cuda:0')
distance 2 is tensor(9.9922, device='cuda:0')
benign distance is  tensor(9.9922, device='cuda:0')
norm1 res is  tensor(0.1396, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.38149189949035645
distance 1 is tensor(147.9951, device='cuda:0')
distance 2 is tensor(10.7922, device='cuda:0')
benign distance is  tensor(10.7922, device='cuda:0')
norm1 res is  tensor(0.1503, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.7709254622459412
distance 1 is tensor(160.3609, device='cuda:0')
distance 2 is tensor(11.5998, device='cuda:0')
benign distance is  tensor(11.5998, device='cuda:0')
norm1 res is  tensor(0.1656, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.5556098222732544
distance 1 is tensor(161.4513, device='cuda:0')
distance 2 is tensor(11.5852, device='cuda:0')
benign distance is  tensor(11.5852, device='cuda:0')
norm1 res is  tensor(0.1622, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.5790712237358093
distance 1 is tensor(137.0072, device='cuda:0')
distance 2 is tensor(9.8137, device='cuda:0')
benign distance is  tensor(9.8137, device='cuda:0')
norm1 res is  tensor(0.1360, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.0004161596298218
distance 1 is tensor(150.0662, device='cuda:0')
distance 2 is tensor(10.8948, device='cuda:0')
benign distance is  tensor(10.8948, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.4034333825111389
distance 1 is tensor(141.2900, device='cuda:0')
distance 2 is tensor(10.3973, device='cuda:0')
benign distance is  tensor(10.3973, device='cuda:0')
norm1 res is  tensor(0.1441, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.4510778188705444
distance 1 is tensor(134.8210, device='cuda:0')
distance 2 is tensor(9.7036, device='cuda:0')
benign distance is  tensor(9.7036, device='cuda:0')
norm1 res is  tensor(0.1348, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.47317638993263245
distance 1 is tensor(155.1658, device='cuda:0')
distance 2 is tensor(11.1636, device='cuda:0')
benign distance is  tensor(11.1636, device='cuda:0')
norm1 res is  tensor(0.1564, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.6337111592292786
distance 1 is tensor(142.0281, device='cuda:0')
distance 2 is tensor(10.3491, device='cuda:0')
benign distance is  tensor(10.3491, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.5203555822372437
distance 1 is tensor(139.2272, device='cuda:0')
distance 2 is tensor(10.1009, device='cuda:0')
benign distance is  tensor(10.1009, device='cuda:0')
norm1 res is  tensor(0.1428, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(203.0121, device='cuda:0')
distance 2 is tensor(14.3658, device='cuda:0')
compute distance is  tensor(14.3658, device='cuda:0')
compute norm is  tensor(51.6088, device='cuda:0')
distance 1 is tensor(206.0982, device='cuda:0')
distance 2 is tensor(14.7307, device='cuda:0')
compute distance is  tensor(14.7307, device='cuda:0')
compute norm is  tensor(51.6979, device='cuda:0')
distance 1 is tensor(206.2021, device='cuda:0')
distance 2 is tensor(14.7847, device='cuda:0')
compute distance is  tensor(14.7847, device='cuda:0')
compute norm is  tensor(52.0319, device='cuda:0')
distance 1 is tensor(204.8160, device='cuda:0')
distance 2 is tensor(14.5510, device='cuda:0')
compute distance is  tensor(14.5510, device='cuda:0')
compute norm is  tensor(51.7312, device='cuda:0')
distance 1 is tensor(202.0991, device='cuda:0')
distance 2 is tensor(14.2826, device='cuda:0')
compute distance is  tensor(14.2826, device='cuda:0')
compute norm is  tensor(51.7059, device='cuda:0')
distance 1 is tensor(204.3485, device='cuda:0')
distance 2 is tensor(14.6079, device='cuda:0')
compute distance is  tensor(14.6079, device='cuda:0')
compute norm is  tensor(51.9976, device='cuda:0')
distance 1 is tensor(188.7066, device='cuda:0')
distance 2 is tensor(13.3824, device='cuda:0')
compute distance is  tensor(13.3824, device='cuda:0')
compute norm is  tensor(51.4392, device='cuda:0')
distance 1 is tensor(203.9489, device='cuda:0')
distance 2 is tensor(14.5264, device='cuda:0')
compute distance is  tensor(14.5264, device='cuda:0')
compute norm is  tensor(51.6656, device='cuda:0')
distance 1 is tensor(201.9890, device='cuda:0')
distance 2 is tensor(14.3386, device='cuda:0')
compute distance is  tensor(14.3386, device='cuda:0')
compute norm is  tensor(51.5010, device='cuda:0')
distance 1 is tensor(189.2988, device='cuda:0')
distance 2 is tensor(13.6837, device='cuda:0')
compute distance is  tensor(13.6837, device='cuda:0')
compute norm is  tensor(51.6389, device='cuda:0')
distance 1 is tensor(195.2168, device='cuda:0')
distance 2 is tensor(13.9450, device='cuda:0')
compute distance is  tensor(13.9450, device='cuda:0')
compute norm is  tensor(51.7226, device='cuda:0')
distance 1 is tensor(205.0824, device='cuda:0')
distance 2 is tensor(14.4666, device='cuda:0')
compute distance is  tensor(14.4666, device='cuda:0')
compute norm is  tensor(51.8817, device='cuda:0')
distance Threshold  is  tensor(14.7847, device='cuda:0')
distance 1 is tensor(1009154.8750, device='cuda:0')
distance 2 is tensor(73614.5625, device='cuda:0')
________________________________
test distance is  tensor(73614.5625, device='cuda:0')
test similarity is  tensor(0.1517, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.818471431777005e+17
test entropy is  0.0
________________________________
cal ratio is  0.012754602957467548
distance 1 is tensor(12871.3770, device='cuda:0')
distance 2 is tensor(938.9245, device='cuda:0')
cal_distance is  tensor(938.9245, device='cuda:0')
cal ratio is  0.11293628035070441
distance 1 is tensor(1453.6508, device='cuda:0')
distance 2 is tensor(106.0386, device='cuda:0')
cal_distance is  tensor(106.0386, device='cuda:0')
cal ratio is  0.33605994321869637
distance 1 is tensor(488.5178, device='cuda:0')
distance 2 is tensor(35.6353, device='cuda:0')
cal_distance is  tensor(35.6353, device='cuda:0')
cal ratio is  0.5797067389675931
distance 1 is tensor(283.1996, device='cuda:0')
distance 2 is tensor(20.6580, device='cuda:0')
cal_distance is  tensor(20.6580, device='cuda:0')
cal ratio is  0.7613847839661246
distance 1 is tensor(215.6253, device='cuda:0')
distance 2 is tensor(15.7287, device='cuda:0')
cal_distance is  tensor(15.7287, device='cuda:0')
cal ratio is  0.8725736310844677
distance 1 is tensor(188.1497, device='cuda:0')
distance 2 is tensor(13.7245, device='cuda:0')
cal_distance is  tensor(13.7245, device='cuda:0')
distance 1 is tensor(188.1497, device='cuda:0')
distance 2 is tensor(13.7245, device='cuda:0')
________________________________
test distance is  tensor(13.7245, device='cuda:0')
test similarity is  tensor(0.9330, device='cuda:0')
test acc is  0.7626833334896606
test loss is 115.27768380301339
test entropy is  0.009669088004309571
________________________________
distance 1 is tensor(188.1497, device='cuda:0')
distance 2 is tensor(13.7245, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.010109876484980868
avg test loss is  115.7223699036946
avg accuracy is  0.7641500001563271
solo acc is  0.15301666682300014
compute similarity  is  tensor(0.9330, device='cuda:0')
compute_distance is  tensor(13.7245, device='cuda:0')
compute_norm is  tensor(54.0277, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(174.4472, device='cuda:0')
distance 2 is tensor(14.6235, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9774410933065516
avg test loss is  1.5303573427932349
avg accuracy is  0.7883500001563258
solo acc is  0.2837833334896725
compute similarity  is  tensor(0.9348, device='cuda:0')
compute_distance is  tensor(14.6235, device='cuda:0')
compute_norm is  tensor(53.6477, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(174.4472, device='cuda:0')
distance 2 is tensor(14.6235, device='cuda:0')
________________________________
test distance is  tensor(14.6235, device='cuda:0')
test similarity is  tensor(0.9348, device='cuda:0')
test acc is  0.7868666668229927
test loss is 1.522929439666683
test entropy is  0.9790856014055483
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.3934580087661743
mal norm is  tensor(9.1442, device='cuda:0')
distance 1 is tensor(174.4472, device='cuda:0')
distance 2 is tensor(14.6235, device='cuda:0')
mal distance is  tensor(14.6235, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.2732, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(540.4331, device='cuda:0')
c is  tensor(0.0225, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.4364, device='cuda:0')
c is  tensor(0.0218, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.1949, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.3943, device='cuda:0')
c is  tensor(0.0234, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.6078, device='cuda:0')
c is  tensor(0.0228, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.8456, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.5822, device='cuda:0')
c is  tensor(0.0228, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.9701, device='cuda:0')
c is  tensor(0.0231, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(914.4225, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:0')
len accept list 4
len all weights is 4
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 91.13% 

Test Accuracy: 88.81% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5993024110794067
distance 1 is tensor(144.2614, device='cuda:0')
distance 2 is tensor(10.4060, device='cuda:0')
benign distance is  tensor(10.4060, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.1851147711277008
distance 1 is tensor(154.7986, device='cuda:0')
distance 2 is tensor(11.2057, device='cuda:0')
benign distance is  tensor(11.2057, device='cuda:0')
norm1 res is  tensor(0.1578, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.30781790614128113
distance 1 is tensor(105.7921, device='cuda:0')
distance 2 is tensor(7.6452, device='cuda:0')
benign distance is  tensor(7.6452, device='cuda:0')
norm1 res is  tensor(0.1095, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.16367335617542267
distance 1 is tensor(122.3225, device='cuda:0')
distance 2 is tensor(8.7395, device='cuda:0')
benign distance is  tensor(8.7395, device='cuda:0')
norm1 res is  tensor(0.1220, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6671479344367981
distance 1 is tensor(127.3923, device='cuda:0')
distance 2 is tensor(9.1055, device='cuda:0')
benign distance is  tensor(9.1055, device='cuda:0')
norm1 res is  tensor(0.1282, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6737937927246094
distance 1 is tensor(159.2730, device='cuda:0')
distance 2 is tensor(11.4293, device='cuda:0')
benign distance is  tensor(11.4293, device='cuda:0')
norm1 res is  tensor(0.1613, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.038761552423238754
distance 1 is tensor(134.9561, device='cuda:0')
distance 2 is tensor(9.6136, device='cuda:0')
benign distance is  tensor(9.6136, device='cuda:0')
norm1 res is  tensor(0.1373, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5037410259246826
distance 1 is tensor(141.6035, device='cuda:0')
distance 2 is tensor(10.1334, device='cuda:0')
benign distance is  tensor(10.1334, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(168.3450, device='cuda:0')
distance 2 is tensor(12.4123, device='cuda:0')
compute distance is  tensor(12.4123, device='cuda:0')
compute norm is  tensor(50.5017, device='cuda:0')
distance 1 is tensor(171.3481, device='cuda:0')
distance 2 is tensor(12.6686, device='cuda:0')
compute distance is  tensor(12.6686, device='cuda:0')
compute norm is  tensor(50.5206, device='cuda:0')
distance 1 is tensor(177.3864, device='cuda:0')
distance 2 is tensor(13.1700, device='cuda:0')
compute distance is  tensor(13.1700, device='cuda:0')
compute norm is  tensor(50.6916, device='cuda:0')
distance 1 is tensor(169.6470, device='cuda:0')
distance 2 is tensor(12.5311, device='cuda:0')
compute distance is  tensor(12.5311, device='cuda:0')
compute norm is  tensor(50.4264, device='cuda:0')
distance 1 is tensor(164.0988, device='cuda:0')
distance 2 is tensor(12.3170, device='cuda:0')
compute distance is  tensor(12.3170, device='cuda:0')
compute norm is  tensor(50.4953, device='cuda:0')
distance 1 is tensor(178.2965, device='cuda:0')
distance 2 is tensor(13.2315, device='cuda:0')
compute distance is  tensor(13.2315, device='cuda:0')
compute norm is  tensor(50.6797, device='cuda:0')
distance 1 is tensor(171.6268, device='cuda:0')
distance 2 is tensor(12.7542, device='cuda:0')
compute distance is  tensor(12.7542, device='cuda:0')
compute norm is  tensor(50.5684, device='cuda:0')
distance 1 is tensor(167.3888, device='cuda:0')
distance 2 is tensor(12.3634, device='cuda:0')
compute distance is  tensor(12.3634, device='cuda:0')
compute norm is  tensor(50.6260, device='cuda:0')
distance 1 is tensor(173.2556, device='cuda:0')
distance 2 is tensor(12.7766, device='cuda:0')
compute distance is  tensor(12.7766, device='cuda:0')
compute norm is  tensor(50.8563, device='cuda:0')
distance 1 is tensor(160.9366, device='cuda:0')
distance 2 is tensor(12.0478, device='cuda:0')
compute distance is  tensor(12.0478, device='cuda:0')
compute norm is  tensor(50.5033, device='cuda:0')
distance 1 is tensor(173.4481, device='cuda:0')
distance 2 is tensor(12.9278, device='cuda:0')
compute distance is  tensor(12.9278, device='cuda:0')
compute norm is  tensor(50.7434, device='cuda:0')
distance 1 is tensor(160.4354, device='cuda:0')
distance 2 is tensor(12.0277, device='cuda:0')
compute distance is  tensor(12.0277, device='cuda:0')
compute norm is  tensor(50.5296, device='cuda:0')
distance Threshold  is  tensor(13.2315, device='cuda:0')
distance 1 is tensor(1009160.3750, device='cuda:0')
distance 2 is tensor(73615.1719, device='cuda:0')
________________________________
test distance is  tensor(73615.1719, device='cuda:0')
test similarity is  tensor(0.1305, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82143254377292e+17
test entropy is  0.0
________________________________
cal ratio is  0.01206600577495109
distance 1 is tensor(12176.5410, device='cuda:0')
distance 2 is tensor(888.2410, device='cuda:0')
cal_distance is  tensor(888.2410, device='cuda:0')
cal ratio is  0.10984537207543955
distance 1 is tensor(1337.5421, device='cuda:0')
distance 2 is tensor(97.5692, device='cuda:0')
cal_distance is  tensor(97.5692, device='cuda:0')
cal ratio is  0.33142929690347245
distance 1 is tensor(443.3046, device='cuda:0')
distance 2 is tensor(32.3373, device='cuda:0')
cal_distance is  tensor(32.3373, device='cuda:0')
cal ratio is  0.5756988779616143
distance 1 is tensor(255.2125, device='cuda:0')
distance 2 is tensor(18.6165, device='cuda:0')
cal_distance is  tensor(18.6165, device='cuda:0')
cal ratio is  0.7587483363471104
distance 1 is tensor(193.6435, device='cuda:0')
distance 2 is tensor(14.1253, device='cuda:0')
cal_distance is  tensor(14.1253, device='cuda:0')
cal ratio is  0.8710616101549651
distance 1 is tensor(168.6762, device='cuda:0')
distance 2 is tensor(12.3040, device='cuda:0')
cal_distance is  tensor(12.3040, device='cuda:0')
distance 1 is tensor(168.6762, device='cuda:0')
distance 2 is tensor(12.3040, device='cuda:0')
________________________________
test distance is  tensor(12.3040, device='cuda:0')
test similarity is  tensor(0.9446, device='cuda:0')
test acc is  0.8253500001563243
test loss is 70.18776774863953
test entropy is  0.019501663538597416
________________________________
distance 1 is tensor(168.6762, device='cuda:0')
distance 2 is tensor(12.3040, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.02030634952524139
avg test loss is  70.30635983399999
avg accuracy is  0.825266666822991
solo acc is  0.23136666682300433
compute similarity  is  tensor(0.9446, device='cuda:0')
compute_distance is  tensor(12.3040, device='cuda:0')
compute_norm is  tensor(53.8314, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(158.1275, device='cuda:0')
distance 2 is tensor(13.3750, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.0011729537678171
avg test loss is  1.478591722847302
avg accuracy is  0.8145500001563247
solo acc is  0.3074166668230064
compute similarity  is  tensor(0.9452, device='cuda:0')
compute_distance is  tensor(13.3750, device='cuda:0')
compute_norm is  tensor(53.2461, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.0971, device='cuda:0')
distance 2 is tensor(13.5799, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9405657694792189
avg test loss is  1.5759120267083142
avg accuracy is  0.8080833334896583
solo acc is  0.2434333334896714
compute similarity  is  tensor(0.9448, device='cuda:0')
compute_distance is  tensor(13.5799, device='cuda:0')
compute_norm is  tensor(52.9785, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.8540, device='cuda:0')
distance 2 is tensor(13.7126, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.931426671776436
avg test loss is  1.5429575144609153
avg accuracy is  0.8094000001563251
solo acc is  0.23871666682300446
compute similarity  is  tensor(0.9446, device='cuda:0')
compute_distance is  tensor(13.7126, device='cuda:0')
compute_norm is  tensor(52.7201, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(160.5981, device='cuda:0')
distance 2 is tensor(13.8176, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.912804975946829
avg test loss is  1.5275779796053353
avg accuracy is  0.8098666668229917
solo acc is  0.2383000001563379
compute similarity  is  tensor(0.9444, device='cuda:0')
compute_distance is  tensor(13.8176, device='cuda:0')
compute_norm is  tensor(52.4686, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(161.3471, device='cuda:0')
distance 2 is tensor(13.9065, device='cuda:0')
________________________________
test distance is  tensor(13.9065, device='cuda:0')
test similarity is  tensor(0.9442, device='cuda:0')
test acc is  0.809400000156325
test loss is 1.5074070418821468
test entropy is  0.9110699011318719
________________________________
cal ratio is  0.8778857142687981
distance 1 is tensor(141.6451, device='cuda:0')
distance 2 is tensor(12.2083, device='cuda:0')
cal_distance is  tensor(12.2083, device='cuda:0')
distance 1 is tensor(141.6451, device='cuda:0')
distance 2 is tensor(12.2083, device='cuda:0')
________________________________
test distance is  tensor(12.2083, device='cuda:0')
test similarity is  tensor(0.9561, device='cuda:0')
test acc is  0.8304500001563241
test loss is 1.125953574043347
test entropy is  1.1089102473975754
________________________________
distance 1 is tensor(141.6451, device='cuda:0')
distance 2 is tensor(12.2083, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.108511338991397
avg test loss is  1.1256877713874458
avg accuracy is  0.8297166668229908
solo acc is  0.46595000015634186
compute similarity  is  tensor(0.9561, device='cuda:0')
compute_distance is  tensor(12.2083, device='cuda:0')
compute_norm is  tensor(51.8143, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.6458, device='cuda:0')
distance 2 is tensor(12.4710, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8999680569176989
avg test loss is  1.5008676002528876
avg accuracy is  0.8259333334896577
solo acc is  0.23686666682300453
compute similarity  is  tensor(0.9555, device='cuda:0')
compute_distance is  tensor(12.4710, device='cuda:0')
compute_norm is  tensor(51.5743, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.8825, device='cuda:0')
distance 2 is tensor(12.5953, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8972841864709915
avg test loss is  1.4744726402927308
avg accuracy is  0.824516666822991
solo acc is  0.24021666682300455
compute similarity  is  tensor(0.9552, device='cuda:0')
compute_distance is  tensor(12.5953, device='cuda:0')
compute_norm is  tensor(51.3284, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.0571, device='cuda:0')
distance 2 is tensor(12.7027, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.892372957170645
avg test loss is  1.4585282500110455
avg accuracy is  0.8245833334896576
solo acc is  0.24056666682300462
compute similarity  is  tensor(0.9550, device='cuda:0')
compute_distance is  tensor(12.7027, device='cuda:0')
compute_norm is  tensor(51.0873, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.1656, device='cuda:0')
distance 2 is tensor(12.7972, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8820843842110908
avg test loss is  1.4509919792858523
avg accuracy is  0.8270833334896576
solo acc is  0.23555000015633779
compute similarity  is  tensor(0.9548, device='cuda:0')
compute_distance is  tensor(12.7972, device='cuda:0')
compute_norm is  tensor(50.8495, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.2662, device='cuda:0')
distance 2 is tensor(12.8852, device='cuda:0')
________________________________
test distance is  tensor(12.8852, device='cuda:0')
test similarity is  tensor(0.9546, device='cuda:0')
test acc is  0.8301000001563241
test loss is 1.4483653134120298
test entropy is  0.8757048420179119
________________________________
distance 1 is tensor(148.2662, device='cuda:0')
distance 2 is tensor(12.8852, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8752853247021307
avg test loss is  1.4495392565025704
avg accuracy is  0.8290833334896576
solo acc is  0.23121666682300437
compute similarity  is  tensor(0.9546, device='cuda:0')
compute_distance is  tensor(12.8852, device='cuda:0')
compute_norm is  tensor(50.6145, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.3969, device='cuda:0')
distance 2 is tensor(12.9713, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8808592829877125
avg test loss is  1.424725540157066
avg accuracy is  0.831850000156324
solo acc is  0.23503333348967118
compute similarity  is  tensor(0.9544, device='cuda:0')
compute_distance is  tensor(12.9713, device='cuda:0')
compute_norm is  tensor(50.3800, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.5912, device='cuda:0')
distance 2 is tensor(13.0582, device='cuda:0')
exit early
distance 1 is tensor(150.5912, device='cuda:0')
distance 2 is tensor(13.0582, device='cuda:0')
________________________________
test distance is  tensor(13.0582, device='cuda:0')
test similarity is  tensor(0.9542, device='cuda:0')
test acc is  0.8330000001563239
test loss is 1.4239892520502941
test entropy is  0.8681525642683765
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3367503881454468
mal norm is  tensor(7.0412, device='cuda:0')
distance 1 is tensor(150.5912, device='cuda:0')
distance 2 is tensor(13.0582, device='cuda:0')
mal distance is  tensor(13.0582, device='cuda:0')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1988, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.4338, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.8690, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(428.7399, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.4079e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.2159, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.0189e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.4633, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.7448, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.3702e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.3581, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.4611, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.7583e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.1220, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.2847, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.7938e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.3369, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.2955, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.8565, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.3713, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.6235, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.8625, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.3071e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.4325, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.9902, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(766.1889, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(796.5953, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.8174e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(762.2661, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.5789e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.5515, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.9342e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.1934, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(779.0765, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.1588, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.4946, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.8386, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.1647, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.5918, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.6015, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.2677, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.9727, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.7784, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.6974e-05, device='cuda:0')
len accept list 8
len all weights is 8
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 91.53% 

Test Accuracy: 89.27% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
 benign loss is  0.23366594314575195
distance 1 is tensor(134.7908, device='cuda:0')
distance 2 is tensor(9.7321, device='cuda:0')
benign distance is  tensor(9.7321, device='cuda:0')
norm1 res is  tensor(0.1385, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.0506558418273926
distance 1 is tensor(139.8766, device='cuda:0')
distance 2 is tensor(9.9883, device='cuda:0')
benign distance is  tensor(9.9883, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.15484671294689178
distance 1 is tensor(120.0495, device='cuda:0')
distance 2 is tensor(8.5683, device='cuda:0')
benign distance is  tensor(8.5683, device='cuda:0')
norm1 res is  tensor(0.1231, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.24095025658607483
distance 1 is tensor(137.8829, device='cuda:0')
distance 2 is tensor(9.8418, device='cuda:0')
benign distance is  tensor(9.8418, device='cuda:0')
norm1 res is  tensor(0.1399, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.3171860873699188
distance 1 is tensor(126.6523, device='cuda:0')
distance 2 is tensor(9.0822, device='cuda:0')
benign distance is  tensor(9.0822, device='cuda:0')
norm1 res is  tensor(0.1293, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.21399171650409698
distance 1 is tensor(149.5531, device='cuda:0')
distance 2 is tensor(10.6600, device='cuda:0')
benign distance is  tensor(10.6600, device='cuda:0')
norm1 res is  tensor(0.1534, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.27483201026916504
distance 1 is tensor(112.2094, device='cuda:0')
distance 2 is tensor(8.1249, device='cuda:0')
benign distance is  tensor(8.1249, device='cuda:0')
norm1 res is  tensor(0.1140, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  1.194664478302002
distance 1 is tensor(143.2264, device='cuda:0')
distance 2 is tensor(10.3084, device='cuda:0')
benign distance is  tensor(10.3084, device='cuda:0')
norm1 res is  tensor(0.1458, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.5296384692192078
distance 1 is tensor(138.1664, device='cuda:0')
distance 2 is tensor(9.8141, device='cuda:0')
benign distance is  tensor(9.8141, device='cuda:0')
norm1 res is  tensor(0.1440, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.5940083265304565
distance 1 is tensor(142.1489, device='cuda:0')
distance 2 is tensor(10.1432, device='cuda:0')
benign distance is  tensor(10.1432, device='cuda:0')
norm1 res is  tensor(0.1444, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.22770598530769348
distance 1 is tensor(146.1986, device='cuda:0')
distance 2 is tensor(10.3909, device='cuda:0')
benign distance is  tensor(10.3909, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.43333643674850464
distance 1 is tensor(139.3844, device='cuda:0')
distance 2 is tensor(10.0569, device='cuda:0')
benign distance is  tensor(10.0569, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.4679200053215027
distance 1 is tensor(132.7201, device='cuda:0')
distance 2 is tensor(9.6344, device='cuda:0')
benign distance is  tensor(9.6344, device='cuda:0')
norm1 res is  tensor(0.1376, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.2917441725730896
distance 1 is tensor(137.8655, device='cuda:0')
distance 2 is tensor(9.9105, device='cuda:0')
benign distance is  tensor(9.9105, device='cuda:0')
norm1 res is  tensor(0.1411, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.8187909126281738
distance 1 is tensor(140.7386, device='cuda:0')
distance 2 is tensor(10.1639, device='cuda:0')
benign distance is  tensor(10.1639, device='cuda:0')
norm1 res is  tensor(0.1458, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.5226178765296936
distance 1 is tensor(148.1916, device='cuda:0')
distance 2 is tensor(10.6065, device='cuda:0')
benign distance is  tensor(10.6065, device='cuda:0')
norm1 res is  tensor(0.1503, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.16152848303318024
distance 1 is tensor(146.2439, device='cuda:0')
distance 2 is tensor(10.4187, device='cuda:0')
benign distance is  tensor(10.4187, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.2294246405363083
distance 1 is tensor(149.6234, device='cuda:0')
distance 2 is tensor(10.6144, device='cuda:0')
benign distance is  tensor(10.6144, device='cuda:0')
norm1 res is  tensor(0.1519, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.15923257172107697
distance 1 is tensor(153.7313, device='cuda:0')
distance 2 is tensor(11.1076, device='cuda:0')
benign distance is  tensor(11.1076, device='cuda:0')
norm1 res is  tensor(0.1598, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.19929002225399017
distance 1 is tensor(144.9765, device='cuda:0')
distance 2 is tensor(10.4408, device='cuda:0')
benign distance is  tensor(10.4408, device='cuda:0')
norm1 res is  tensor(0.1497, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.292384535074234
distance 1 is tensor(140.9589, device='cuda:0')
distance 2 is tensor(10.2287, device='cuda:0')
benign distance is  tensor(10.2287, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8461617231369019
distance 1 is tensor(136.2246, device='cuda:0')
distance 2 is tensor(9.8041, device='cuda:0')
benign distance is  tensor(9.8041, device='cuda:0')
norm1 res is  tensor(0.1396, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.26785093545913696
distance 1 is tensor(147.2481, device='cuda:0')
distance 2 is tensor(10.6144, device='cuda:0')
benign distance is  tensor(10.6144, device='cuda:0')
norm1 res is  tensor(0.1503, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.6787606477737427
distance 1 is tensor(144.3114, device='cuda:0')
distance 2 is tensor(10.5692, device='cuda:0')
benign distance is  tensor(10.5692, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.211579367518425
distance 1 is tensor(138.2787, device='cuda:0')
distance 2 is tensor(10.0531, device='cuda:0')
benign distance is  tensor(10.0531, device='cuda:0')
norm1 res is  tensor(0.1409, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.17293371260166168
distance 1 is tensor(135.2421, device='cuda:0')
distance 2 is tensor(9.5650, device='cuda:0')
benign distance is  tensor(9.5650, device='cuda:0')
norm1 res is  tensor(0.1368, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.37579333782196045
distance 1 is tensor(132.6549, device='cuda:0')
distance 2 is tensor(9.5537, device='cuda:0')
benign distance is  tensor(9.5537, device='cuda:0')
norm1 res is  tensor(0.1352, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.2737610936164856
distance 1 is tensor(146.4917, device='cuda:0')
distance 2 is tensor(10.5989, device='cuda:0')
benign distance is  tensor(10.5989, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.3500804007053375
distance 1 is tensor(135.8873, device='cuda:0')
distance 2 is tensor(9.7447, device='cuda:0')
benign distance is  tensor(9.7447, device='cuda:0')
norm1 res is  tensor(0.1404, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.4568837583065033
distance 1 is tensor(155.3093, device='cuda:0')
distance 2 is tensor(11.0072, device='cuda:0')
benign distance is  tensor(11.0072, device='cuda:0')
norm1 res is  tensor(0.1547, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.9992645382881165
distance 1 is tensor(140.5497, device='cuda:0')
distance 2 is tensor(10.1572, device='cuda:0')
benign distance is  tensor(10.1572, device='cuda:0')
norm1 res is  tensor(0.1436, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.3965526521205902
distance 1 is tensor(136.8141, device='cuda:0')
distance 2 is tensor(9.6983, device='cuda:0')
benign distance is  tensor(9.6983, device='cuda:0')
norm1 res is  tensor(0.1397, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(191.7124, device='cuda:0')
distance 2 is tensor(13.8512, device='cuda:0')
compute distance is  tensor(13.8512, device='cuda:0')
compute norm is  tensor(51.6926, device='cuda:0')
distance 1 is tensor(195.8605, device='cuda:0')
distance 2 is tensor(14.3351, device='cuda:0')
compute distance is  tensor(14.3351, device='cuda:0')
compute norm is  tensor(51.7212, device='cuda:0')
distance 1 is tensor(202.1190, device='cuda:0')
distance 2 is tensor(14.6848, device='cuda:0')
compute distance is  tensor(14.6848, device='cuda:0')
compute norm is  tensor(52.0396, device='cuda:0')
distance 1 is tensor(199.4234, device='cuda:0')
distance 2 is tensor(14.1539, device='cuda:0')
compute distance is  tensor(14.1539, device='cuda:0')
compute norm is  tensor(51.7369, device='cuda:0')
distance 1 is tensor(211.1342, device='cuda:0')
distance 2 is tensor(15.4170, device='cuda:0')
compute distance is  tensor(15.4170, device='cuda:0')
compute norm is  tensor(52.3280, device='cuda:0')
distance 1 is tensor(217.9558, device='cuda:0')
distance 2 is tensor(15.4948, device='cuda:0')
compute distance is  tensor(15.4948, device='cuda:0')
compute norm is  tensor(52.5055, device='cuda:0')
distance 1 is tensor(208.7547, device='cuda:0')
distance 2 is tensor(14.9574, device='cuda:0')
compute distance is  tensor(14.9574, device='cuda:0')
compute norm is  tensor(52.1441, device='cuda:0')
distance 1 is tensor(203.9482, device='cuda:0')
distance 2 is tensor(14.7364, device='cuda:0')
compute distance is  tensor(14.7364, device='cuda:0')
compute norm is  tensor(52.0677, device='cuda:0')
distance 1 is tensor(194.3189, device='cuda:0')
distance 2 is tensor(14.0015, device='cuda:0')
compute distance is  tensor(14.0015, device='cuda:0')
compute norm is  tensor(51.8488, device='cuda:0')
distance 1 is tensor(204.0486, device='cuda:0')
distance 2 is tensor(14.6055, device='cuda:0')
compute distance is  tensor(14.6055, device='cuda:0')
compute norm is  tensor(52.2336, device='cuda:0')
distance 1 is tensor(204.9647, device='cuda:0')
distance 2 is tensor(14.5527, device='cuda:0')
compute distance is  tensor(14.5527, device='cuda:0')
compute norm is  tensor(51.9412, device='cuda:0')
distance 1 is tensor(210.5456, device='cuda:0')
distance 2 is tensor(15.2546, device='cuda:0')
compute distance is  tensor(15.2546, device='cuda:0')
compute norm is  tensor(52.3715, device='cuda:0')
distance Threshold  is  tensor(15.4948, device='cuda:0')
distance 1 is tensor(1009171.7500, device='cuda:0')
distance 2 is tensor(73616.1094, device='cuda:0')
________________________________
test distance is  tensor(73616.1094, device='cuda:0')
test similarity is  tensor(0.0959, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.819715010710766e+17
test entropy is  0.0
________________________________
cal ratio is  0.01305718993444301
distance 1 is tensor(13176.9521, device='cuda:0')
distance 2 is tensor(961.2194, device='cuda:0')
cal_distance is  tensor(961.2194, device='cuda:0')
cal ratio is  0.11426807210783027
distance 1 is tensor(1505.7104, device='cuda:0')
distance 2 is tensor(109.8367, device='cuda:0')
cal_distance is  tensor(109.8367, device='cuda:0')
cal ratio is  0.3380356055334666
distance 1 is tensor(508.9876, device='cuda:0')
distance 2 is tensor(37.1287, device='cuda:0')
cal_distance is  tensor(37.1287, device='cuda:0')
cal ratio is  0.5814082968413634
distance 1 is tensor(295.9322, device='cuda:0')
distance 2 is tensor(21.5869, device='cuda:0')
cal_distance is  tensor(21.5869, device='cuda:0')
cal ratio is  0.7625013210722938
distance 1 is tensor(225.6501, device='cuda:0')
distance 2 is tensor(16.4601, device='cuda:0')
cal_distance is  tensor(16.4601, device='cuda:0')
cal ratio is  0.8732131809851155
distance 1 is tensor(197.0414, device='cuda:0')
distance 2 is tensor(14.3732, device='cuda:0')
cal_distance is  tensor(14.3732, device='cuda:0')
distance 1 is tensor(197.0414, device='cuda:0')
distance 2 is tensor(14.3732, device='cuda:0')
________________________________
test distance is  tensor(14.3732, device='cuda:0')
test similarity is  tensor(0.9243, device='cuda:0')
test acc is  0.7362166668229954
test loss is 185.18698733396874
test entropy is  0.005968685107043891
________________________________
distance 1 is tensor(197.0414, device='cuda:0')
distance 2 is tensor(14.3732, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.005724258420899862
avg test loss is  185.41745476631215
avg accuracy is  0.7363666668229952
solo acc is  0.13421666682299857
compute similarity  is  tensor(0.9243, device='cuda:0')
compute_distance is  tensor(14.3732, device='cuda:0')
compute_norm is  tensor(54.0739, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(182.2471, device='cuda:0')
distance 2 is tensor(16.0596, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.071067443153243
avg test loss is  1.6385578269134962
avg accuracy is  0.7684833334896602
solo acc is  0.25281666682300497
compute similarity  is  tensor(0.9269, device='cuda:0')
compute_distance is  tensor(16.0596, device='cuda:0')
compute_norm is  tensor(54.0180, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(183.2625, device='cuda:0')
distance 2 is tensor(16.3682, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.6586376738065342
avg test loss is  2.5221277484253273
avg accuracy is  0.7324166668229954
solo acc is  0.11406666682299862
compute similarity  is  tensor(0.9262, device='cuda:0')
compute_distance is  tensor(16.3682, device='cuda:0')
compute_norm is  tensor(53.8792, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(182.9443, device='cuda:0')
distance 2 is tensor(16.2233, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9952033743548241
avg test loss is  1.5100823204908798
avg accuracy is  0.785850000156326
solo acc is  0.261783333489672
compute similarity  is  tensor(0.9264, device='cuda:0')
compute_distance is  tensor(16.2233, device='cuda:0')
compute_norm is  tensor(53.5312, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(182.9443, device='cuda:0')
distance 2 is tensor(16.2233, device='cuda:0')
________________________________
test distance is  tensor(16.2233, device='cuda:0')
test similarity is  tensor(0.9264, device='cuda:0')
test acc is  0.7853333334896595
test loss is 1.5082451951529172
test entropy is  0.9948249408431145
________________________________
cal ratio is  0.8795609012118389
distance 1 is tensor(160.9114, device='cuda:0')
distance 2 is tensor(14.2694, device='cuda:0')
cal_distance is  tensor(14.2694, device='cuda:0')
distance 1 is tensor(160.9114, device='cuda:0')
distance 2 is tensor(14.2694, device='cuda:0')
________________________________
test distance is  tensor(14.2694, device='cuda:0')
test similarity is  tensor(0.9414, device='cuda:0')
test acc is  0.8136000001563249
test loss is 1.226454150829234
test entropy is  1.1309440705949054
________________________________
distance 1 is tensor(160.9114, device='cuda:0')
distance 2 is tensor(14.2694, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.1319226410343195
avg test loss is  1.225213630939089
avg accuracy is  0.8128166668229916
solo acc is  0.4124166668230078
compute similarity  is  tensor(0.9414, device='cuda:0')
compute_distance is  tensor(14.2694, device='cuda:0')
compute_norm is  tensor(52.8547, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(162.4274, device='cuda:0')
distance 2 is tensor(14.5027, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9377173100834462
avg test loss is  1.5779140296775396
avg accuracy is  0.8056666668229918
solo acc is  0.2297333334896709
compute similarity  is  tensor(0.9408, device='cuda:0')
compute_distance is  tensor(14.5027, device='cuda:0')
compute_norm is  tensor(52.6297, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(163.3154, device='cuda:0')
distance 2 is tensor(14.5798, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9252023378541983
avg test loss is  1.5608176278915487
avg accuracy is  0.8074833334896585
solo acc is  0.22760000015633752
compute similarity  is  tensor(0.9405, device='cuda:0')
compute_distance is  tensor(14.5798, device='cuda:0')
compute_norm is  tensor(52.3743, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(164.1256, device='cuda:0')
distance 2 is tensor(14.6419, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9179765646264497
avg test loss is  1.5335974028623942
avg accuracy is  0.8084333334896583
solo acc is  0.23318333348967107
compute similarity  is  tensor(0.9403, device='cuda:0')
compute_distance is  tensor(14.6419, device='cuda:0')
compute_norm is  tensor(52.1208, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(164.9643, device='cuda:0')
distance 2 is tensor(14.7058, device='cuda:0')
exit early
distance 1 is tensor(164.9643, device='cuda:0')
distance 2 is tensor(14.7058, device='cuda:0')
________________________________
test distance is  tensor(14.7058, device='cuda:0')
test similarity is  tensor(0.9401, device='cuda:0')
test acc is  0.811550000156325
test loss is 1.5269057608362455
test entropy is  0.9084397021260089
________________________________
distance 1 is tensor(164.9643, device='cuda:0')
distance 2 is tensor(14.7058, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9080672292058656
avg test loss is  1.5270195267856248
avg accuracy is  0.8116833334896583
solo acc is  0.22655000015633742
compute similarity  is  tensor(0.9401, device='cuda:0')
compute_distance is  tensor(14.7058, device='cuda:0')
compute_norm is  tensor(51.8705, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(165.8145, device='cuda:0')
distance 2 is tensor(14.7644, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9005470705439033
avg test loss is  1.5068410953987381
avg accuracy is  0.8148166668229915
solo acc is  0.23000000015633756
compute similarity  is  tensor(0.9399, device='cuda:0')
compute_distance is  tensor(14.7644, device='cuda:0')
compute_norm is  tensor(51.6221, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(166.6714, device='cuda:0')
distance 2 is tensor(14.8200, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8907147332676438
avg test loss is  1.4982606792754964
avg accuracy is  0.8180666668229912
solo acc is  0.22626666682300414
compute similarity  is  tensor(0.9397, device='cuda:0')
compute_distance is  tensor(14.8200, device='cuda:0')
compute_norm is  tensor(51.3744, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(167.5332, device='cuda:0')
distance 2 is tensor(14.8737, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8885472488682916
avg test loss is  1.475557597207108
avg accuracy is  0.8197666668229913
solo acc is  0.23035000015633772
compute similarity  is  tensor(0.9395, device='cuda:0')
compute_distance is  tensor(14.8737, device='cuda:0')
compute_norm is  tensor(51.1252, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(168.4147, device='cuda:0')
distance 2 is tensor(14.9261, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8840104100673691
avg test loss is  1.4576709008674378
avg accuracy is  0.8221166668229911
solo acc is  0.2299000001563376
compute similarity  is  tensor(0.9393, device='cuda:0')
compute_distance is  tensor(14.9261, device='cuda:0')
compute_norm is  tensor(50.8796, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(169.3738, device='cuda:0')
distance 2 is tensor(14.9846, device='cuda:0')
________________________________
test distance is  tensor(14.9846, device='cuda:0')
test similarity is  tensor(0.9391, device='cuda:0')
test acc is  0.8237000001563243
test loss is 1.4506808078365285
test entropy is  0.8798270938493041
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.5882376432418823
mal norm is  tensor(8.1317, device='cuda:0')
distance 1 is tensor(169.3738, device='cuda:0')
distance 2 is tensor(14.9846, device='cuda:0')
mal distance is  tensor(14.9846, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1871, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.1589, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.8458, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.7905, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.3614e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.4697, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.7897e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(510.2741, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.7482, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.4766e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(448.9789, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.0505, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(813.1677, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2310e-05, device='cuda:0')
accept
len accept list 17
len all weights is 17
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 84.61% 

Test Accuracy: 83.47% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7232362627983093
distance 1 is tensor(181.1214, device='cuda:0')
distance 2 is tensor(13.2800, device='cuda:0')
benign distance is  tensor(13.2800, device='cuda:0')
norm1 res is  tensor(0.1756, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.569847583770752
distance 1 is tensor(173.6857, device='cuda:0')
distance 2 is tensor(12.7757, device='cuda:0')
benign distance is  tensor(12.7757, device='cuda:0')
norm1 res is  tensor(0.1719, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.15621061623096466
distance 1 is tensor(172.3509, device='cuda:0')
distance 2 is tensor(12.6181, device='cuda:0')
benign distance is  tensor(12.6181, device='cuda:0')
norm1 res is  tensor(0.1694, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.33170050382614136
distance 1 is tensor(163.7322, device='cuda:0')
distance 2 is tensor(11.8913, device='cuda:0')
benign distance is  tensor(11.8913, device='cuda:0')
norm1 res is  tensor(0.1562, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6361500024795532
distance 1 is tensor(162.6496, device='cuda:0')
distance 2 is tensor(12.0439, device='cuda:0')
benign distance is  tensor(12.0439, device='cuda:0')
norm1 res is  tensor(0.1573, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7698643803596497
distance 1 is tensor(183.3039, device='cuda:0')
distance 2 is tensor(13.5988, device='cuda:0')
benign distance is  tensor(13.5988, device='cuda:0')
norm1 res is  tensor(0.1815, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.32868698239326477
distance 1 is tensor(161.8830, device='cuda:0')
distance 2 is tensor(11.8952, device='cuda:0')
benign distance is  tensor(11.8952, device='cuda:0')
norm1 res is  tensor(0.1599, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.41657161712646484
distance 1 is tensor(191.5213, device='cuda:0')
distance 2 is tensor(14.0871, device='cuda:0')
benign distance is  tensor(14.0871, device='cuda:0')
norm1 res is  tensor(0.1882, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(179.7956, device='cuda:0')
distance 2 is tensor(13.5315, device='cuda:0')
compute distance is  tensor(13.5315, device='cuda:0')
compute norm is  tensor(51.0284, device='cuda:0')
distance 1 is tensor(176.9105, device='cuda:0')
distance 2 is tensor(13.6836, device='cuda:0')
compute distance is  tensor(13.6836, device='cuda:0')
compute norm is  tensor(51.1120, device='cuda:0')
distance 1 is tensor(187.4452, device='cuda:0')
distance 2 is tensor(13.9815, device='cuda:0')
compute distance is  tensor(13.9815, device='cuda:0')
compute norm is  tensor(51.3247, device='cuda:0')
distance 1 is tensor(175.4566, device='cuda:0')
distance 2 is tensor(13.1787, device='cuda:0')
compute distance is  tensor(13.1787, device='cuda:0')
compute norm is  tensor(50.9856, device='cuda:0')
distance 1 is tensor(172.5665, device='cuda:0')
distance 2 is tensor(13.1022, device='cuda:0')
compute distance is  tensor(13.1022, device='cuda:0')
compute norm is  tensor(51.0921, device='cuda:0')
distance 1 is tensor(190.0377, device='cuda:0')
distance 2 is tensor(14.2678, device='cuda:0')
compute distance is  tensor(14.2678, device='cuda:0')
compute norm is  tensor(51.3535, device='cuda:0')
distance 1 is tensor(174.7534, device='cuda:0')
distance 2 is tensor(13.4431, device='cuda:0')
compute distance is  tensor(13.4431, device='cuda:0')
compute norm is  tensor(50.9763, device='cuda:0')
distance 1 is tensor(180.3339, device='cuda:0')
distance 2 is tensor(13.6364, device='cuda:0')
compute distance is  tensor(13.6364, device='cuda:0')
compute norm is  tensor(51.0896, device='cuda:0')
distance 1 is tensor(181.7244, device='cuda:0')
distance 2 is tensor(13.7377, device='cuda:0')
compute distance is  tensor(13.7377, device='cuda:0')
compute norm is  tensor(51.0879, device='cuda:0')
distance 1 is tensor(180.0491, device='cuda:0')
distance 2 is tensor(13.7359, device='cuda:0')
compute distance is  tensor(13.7359, device='cuda:0')
compute norm is  tensor(51.1659, device='cuda:0')
distance 1 is tensor(190.5979, device='cuda:0')
distance 2 is tensor(14.2492, device='cuda:0')
compute distance is  tensor(14.2492, device='cuda:0')
compute norm is  tensor(51.4281, device='cuda:0')
distance 1 is tensor(186.5529, device='cuda:0')
distance 2 is tensor(13.8995, device='cuda:0')
compute distance is  tensor(13.8995, device='cuda:0')
compute norm is  tensor(51.3752, device='cuda:0')
distance Threshold  is  tensor(14.2678, device='cuda:0')
distance 1 is tensor(1009104.3750, device='cuda:0')
distance 2 is tensor(73610.4297, device='cuda:0')
________________________________
test distance is  tensor(73610.4297, device='cuda:0')
test similarity is  tensor(0.2719, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.826282953822447e+17
test entropy is  0.0
________________________________
cal ratio is  0.012529993226284253
distance 1 is tensor(12644.0771, device='cuda:0')
distance 2 is tensor(922.3382, device='cuda:0')
cal_distance is  tensor(922.3382, device='cuda:0')
cal ratio is  0.11193745191431691
distance 1 is tensor(1415.3511, device='cuda:0')
distance 2 is tensor(103.2442, device='cuda:0')
cal_distance is  tensor(103.2442, device='cuda:0')
cal ratio is  0.3345705449893498
distance 1 is tensor(473.5388, device='cuda:0')
distance 2 is tensor(34.5425, device='cuda:0')
cal_distance is  tensor(34.5425, device='cuda:0')
cal ratio is  0.5784207543804042
distance 1 is tensor(273.9072, device='cuda:0')
distance 2 is tensor(19.9801, device='cuda:0')
cal_distance is  tensor(19.9801, device='cuda:0')
cal ratio is  0.7605397510635756
distance 1 is tensor(208.3188, device='cuda:0')
distance 2 is tensor(15.1956, device='cuda:0')
cal_distance is  tensor(15.1956, device='cuda:0')
cal ratio is  0.8720893565594307
distance 1 is tensor(181.6733, device='cuda:0')
distance 2 is tensor(13.2520, device='cuda:0')
cal_distance is  tensor(13.2520, device='cuda:0')
distance 1 is tensor(181.6733, device='cuda:0')
distance 2 is tensor(13.2520, device='cuda:0')
________________________________
test distance is  tensor(13.2520, device='cuda:0')
test similarity is  tensor(0.9456, device='cuda:0')
test acc is  0.35675000015634056
test loss is 149.01373244653632
test entropy is  0.0010230860283206636
________________________________
distance 1 is tensor(181.6733, device='cuda:0')
distance 2 is tensor(13.2520, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0008514214471748087
avg test loss is  149.0625994668078
avg accuracy is  0.35815000015634063
solo acc is  0.1020333334896653
compute similarity  is  tensor(0.9456, device='cuda:0')
compute_distance is  tensor(13.2520, device='cuda:0')
compute_norm is  tensor(55.0226, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(163.8728, device='cuda:0')
distance 2 is tensor(13.3248, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9661140568347882
avg test loss is  1.4527586684552336
avg accuracy is  0.6062333334896703
solo acc is  0.27861666682300573
compute similarity  is  tensor(0.9484, device='cuda:0')
compute_distance is  tensor(13.3248, device='cuda:0')
compute_norm is  tensor(54.8356, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(163.8728, device='cuda:0')
distance 2 is tensor(13.3248, device='cuda:0')
________________________________
test distance is  tensor(13.3248, device='cuda:0')
test similarity is  tensor(0.9484, device='cuda:0')
test acc is  0.6079833334896703
test loss is 1.4551826071764615
test entropy is  0.9648135419466348
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4609524011611938
mal norm is  tensor(8.7462, device='cuda:0')
distance 1 is tensor(163.8728, device='cuda:0')
distance 2 is tensor(13.3248, device='cuda:0')
mal distance is  tensor(13.3248, device='cuda:0')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2937, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.1240, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.6548, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.5341, device='cuda:0')
c is  tensor(0.0211, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0028, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.6875, device='cuda:0')
c is  tensor(0.0218, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.6356, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.9003, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.3566, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.1168, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(874.6234, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0020, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5818, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.3558, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0025, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.9766, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(778.3673, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.7243, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.9783, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(741.4240, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.4998, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(772.9758, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.4358, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.4190, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.8170, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.7287, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.5240, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.3162, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0025, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.4167, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(748.2921, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(752.4236, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0024, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.2103, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(751.0559, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.5565, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.5275, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0027, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(759.5622, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0027, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(774.9786, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
len accept list 32
len all weights is 32
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 90.92% 

Test Accuracy: 89.20% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
 benign loss is  0.45332223176956177
distance 1 is tensor(119.9935, device='cuda:0')
distance 2 is tensor(8.7916, device='cuda:0')
benign distance is  tensor(8.7916, device='cuda:0')
norm1 res is  tensor(0.1244, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.436872661113739
distance 1 is tensor(141.7134, device='cuda:0')
distance 2 is tensor(10.3379, device='cuda:0')
benign distance is  tensor(10.3379, device='cuda:0')
norm1 res is  tensor(0.1454, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.2040858268737793
distance 1 is tensor(122.1478, device='cuda:0')
distance 2 is tensor(8.9557, device='cuda:0')
benign distance is  tensor(8.9557, device='cuda:0')
norm1 res is  tensor(0.1252, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.8615410923957825
distance 1 is tensor(124.7819, device='cuda:0')
distance 2 is tensor(9.0509, device='cuda:0')
benign distance is  tensor(9.0509, device='cuda:0')
norm1 res is  tensor(0.1240, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9796397089958191
distance 1 is tensor(120.9118, device='cuda:0')
distance 2 is tensor(8.7239, device='cuda:0')
benign distance is  tensor(8.7239, device='cuda:0')
norm1 res is  tensor(0.1208, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.2613056898117065
distance 1 is tensor(160.4059, device='cuda:0')
distance 2 is tensor(11.5586, device='cuda:0')
benign distance is  tensor(11.5586, device='cuda:0')
norm1 res is  tensor(0.1616, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.11403225362300873
distance 1 is tensor(119.0610, device='cuda:0')
distance 2 is tensor(8.5690, device='cuda:0')
benign distance is  tensor(8.5690, device='cuda:0')
norm1 res is  tensor(0.1194, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5628281235694885
distance 1 is tensor(142.6201, device='cuda:0')
distance 2 is tensor(10.1556, device='cuda:0')
benign distance is  tensor(10.1556, device='cuda:0')
norm1 res is  tensor(0.1422, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.5846433639526367
distance 1 is tensor(149.4887, device='cuda:0')
distance 2 is tensor(10.6256, device='cuda:0')
benign distance is  tensor(10.6256, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0964099168777466
distance 1 is tensor(138.4683, device='cuda:0')
distance 2 is tensor(9.9611, device='cuda:0')
benign distance is  tensor(9.9611, device='cuda:0')
norm1 res is  tensor(0.1413, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.92491614818573
distance 1 is tensor(127.5074, device='cuda:0')
distance 2 is tensor(9.2496, device='cuda:0')
benign distance is  tensor(9.2496, device='cuda:0')
norm1 res is  tensor(0.1268, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.3397351801395416
distance 1 is tensor(135.9571, device='cuda:0')
distance 2 is tensor(9.8762, device='cuda:0')
benign distance is  tensor(9.8762, device='cuda:0')
norm1 res is  tensor(0.1377, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.8765320777893066
distance 1 is tensor(138.5749, device='cuda:0')
distance 2 is tensor(10.0434, device='cuda:0')
benign distance is  tensor(10.0434, device='cuda:0')
norm1 res is  tensor(0.1403, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.3811456263065338
distance 1 is tensor(134.9285, device='cuda:0')
distance 2 is tensor(9.8022, device='cuda:0')
benign distance is  tensor(9.8022, device='cuda:0')
norm1 res is  tensor(0.1375, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.7832642197608948
distance 1 is tensor(133.3576, device='cuda:0')
distance 2 is tensor(9.6347, device='cuda:0')
benign distance is  tensor(9.6347, device='cuda:0')
norm1 res is  tensor(0.1355, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.8988493084907532
distance 1 is tensor(150.6135, device='cuda:0')
distance 2 is tensor(10.7828, device='cuda:0')
benign distance is  tensor(10.7828, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.08316566795110703
distance 1 is tensor(161.7997, device='cuda:0')
distance 2 is tensor(11.6082, device='cuda:0')
benign distance is  tensor(11.6082, device='cuda:0')
norm1 res is  tensor(0.1637, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.42339029908180237
distance 1 is tensor(127.7160, device='cuda:0')
distance 2 is tensor(9.1555, device='cuda:0')
benign distance is  tensor(9.1555, device='cuda:0')
norm1 res is  tensor(0.1245, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.5552355051040649
distance 1 is tensor(151.9064, device='cuda:0')
distance 2 is tensor(10.9794, device='cuda:0')
benign distance is  tensor(10.9794, device='cuda:0')
norm1 res is  tensor(0.1498, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.726492166519165
distance 1 is tensor(137.1238, device='cuda:0')
distance 2 is tensor(9.7250, device='cuda:0')
benign distance is  tensor(9.7250, device='cuda:0')
norm1 res is  tensor(0.1365, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.772834300994873
distance 1 is tensor(140.5628, device='cuda:0')
distance 2 is tensor(10.0225, device='cuda:0')
benign distance is  tensor(10.0225, device='cuda:0')
norm1 res is  tensor(0.1411, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.5590370893478394
distance 1 is tensor(154.7588, device='cuda:0')
distance 2 is tensor(11.2504, device='cuda:0')
benign distance is  tensor(11.2504, device='cuda:0')
norm1 res is  tensor(0.1566, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.49448806047439575
distance 1 is tensor(140.7055, device='cuda:0')
distance 2 is tensor(10.1423, device='cuda:0')
benign distance is  tensor(10.1423, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.5913015604019165
distance 1 is tensor(144.4463, device='cuda:0')
distance 2 is tensor(10.6142, device='cuda:0')
benign distance is  tensor(10.6142, device='cuda:0')
norm1 res is  tensor(0.1471, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7580069303512573
distance 1 is tensor(150.8510, device='cuda:0')
distance 2 is tensor(10.7342, device='cuda:0')
benign distance is  tensor(10.7342, device='cuda:0')
norm1 res is  tensor(0.1499, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.23898085951805115
distance 1 is tensor(144.7326, device='cuda:0')
distance 2 is tensor(10.6352, device='cuda:0')
benign distance is  tensor(10.6352, device='cuda:0')
norm1 res is  tensor(0.1489, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.20388741791248322
distance 1 is tensor(137.7478, device='cuda:0')
distance 2 is tensor(10.0203, device='cuda:0')
benign distance is  tensor(10.0203, device='cuda:0')
norm1 res is  tensor(0.1395, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.05108851194381714
distance 1 is tensor(144.3964, device='cuda:0')
distance 2 is tensor(10.5281, device='cuda:0')
benign distance is  tensor(10.5281, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.5252099633216858
distance 1 is tensor(137.7362, device='cuda:0')
distance 2 is tensor(9.8595, device='cuda:0')
benign distance is  tensor(9.8595, device='cuda:0')
norm1 res is  tensor(0.1385, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.8870218396186829
distance 1 is tensor(135.3783, device='cuda:0')
distance 2 is tensor(9.7118, device='cuda:0')
benign distance is  tensor(9.7118, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.12028630077838898
distance 1 is tensor(144.7335, device='cuda:0')
distance 2 is tensor(10.4288, device='cuda:0')
benign distance is  tensor(10.4288, device='cuda:0')
norm1 res is  tensor(0.1455, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.3862968981266022
distance 1 is tensor(133.0497, device='cuda:0')
distance 2 is tensor(9.6345, device='cuda:0')
benign distance is  tensor(9.6345, device='cuda:0')
norm1 res is  tensor(0.1325, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(168.4172, device='cuda:0')
distance 2 is tensor(12.1445, device='cuda:0')
compute distance is  tensor(12.1445, device='cuda:0')
compute norm is  tensor(52.0829, device='cuda:0')
distance 1 is tensor(190.3245, device='cuda:0')
distance 2 is tensor(13.7885, device='cuda:0')
compute distance is  tensor(13.7885, device='cuda:0')
compute norm is  tensor(52.6337, device='cuda:0')
distance 1 is tensor(167.6913, device='cuda:0')
distance 2 is tensor(11.9922, device='cuda:0')
compute distance is  tensor(11.9922, device='cuda:0')
compute norm is  tensor(52.1041, device='cuda:0')
distance 1 is tensor(180.6451, device='cuda:0')
distance 2 is tensor(12.8078, device='cuda:0')
compute distance is  tensor(12.8078, device='cuda:0')
compute norm is  tensor(52.3757, device='cuda:0')
distance 1 is tensor(181.2723, device='cuda:0')
distance 2 is tensor(13.0994, device='cuda:0')
compute distance is  tensor(13.0994, device='cuda:0')
compute norm is  tensor(52.5002, device='cuda:0')
distance 1 is tensor(181.6990, device='cuda:0')
distance 2 is tensor(13.1593, device='cuda:0')
compute distance is  tensor(13.1593, device='cuda:0')
compute norm is  tensor(52.6461, device='cuda:0')
distance 1 is tensor(179.7536, device='cuda:0')
distance 2 is tensor(12.8447, device='cuda:0')
compute distance is  tensor(12.8447, device='cuda:0')
compute norm is  tensor(52.4890, device='cuda:0')
distance 1 is tensor(174.1525, device='cuda:0')
distance 2 is tensor(12.5764, device='cuda:0')
compute distance is  tensor(12.5764, device='cuda:0')
compute norm is  tensor(52.3135, device='cuda:0')
distance 1 is tensor(180.1135, device='cuda:0')
distance 2 is tensor(12.8684, device='cuda:0')
compute distance is  tensor(12.8684, device='cuda:0')
compute norm is  tensor(52.5549, device='cuda:0')
distance 1 is tensor(180.5396, device='cuda:0')
distance 2 is tensor(12.9097, device='cuda:0')
compute distance is  tensor(12.9097, device='cuda:0')
compute norm is  tensor(52.4221, device='cuda:0')
distance 1 is tensor(192.1808, device='cuda:0')
distance 2 is tensor(13.5132, device='cuda:0')
compute distance is  tensor(13.5132, device='cuda:0')
compute norm is  tensor(52.7149, device='cuda:0')
distance 1 is tensor(177.6084, device='cuda:0')
distance 2 is tensor(12.7361, device='cuda:0')
compute distance is  tensor(12.7361, device='cuda:0')
compute norm is  tensor(52.2742, device='cuda:0')
distance Threshold  is  tensor(13.7885, device='cuda:0')
distance 1 is tensor(1009145.7500, device='cuda:0')
distance 2 is tensor(73613.8672, device='cuda:0')
________________________________
test distance is  tensor(73613.8672, device='cuda:0')
test similarity is  tensor(0.1837, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.823779534787488e+17
test entropy is  0.0
________________________________
cal ratio is  0.012317459202904717
distance 1 is tensor(12430.1182, device='cuda:0')
distance 2 is tensor(906.7358, device='cuda:0')
cal_distance is  tensor(906.7358, device='cuda:0')
cal ratio is  0.11098405107309652
distance 1 is tensor(1379.5503, device='cuda:0')
distance 2 is tensor(100.6332, device='cuda:0')
cal_distance is  tensor(100.6332, device='cuda:0')
cal ratio is  0.3331426977122903
distance 1 is tensor(459.5911, device='cuda:0')
distance 2 is tensor(33.5252, device='cuda:0')
cal_distance is  tensor(33.5252, device='cuda:0')
cal ratio is  0.5771851271377638
distance 1 is tensor(265.2717, device='cuda:0')
distance 2 is tensor(19.3503, device='cuda:0')
cal_distance is  tensor(19.3503, device='cuda:0')
cal ratio is  0.7597270149677983
distance 1 is tensor(201.5355, device='cuda:0')
distance 2 is tensor(14.7009, device='cuda:0')
cal_distance is  tensor(14.7009, device='cuda:0')
cal ratio is  0.871623230545434
distance 1 is tensor(175.6638, device='cuda:0')
distance 2 is tensor(12.8137, device='cuda:0')
cal_distance is  tensor(12.8137, device='cuda:0')
distance 1 is tensor(175.6638, device='cuda:0')
distance 2 is tensor(12.8137, device='cuda:0')
________________________________
test distance is  tensor(12.8137, device='cuda:0')
test similarity is  tensor(0.9433, device='cuda:0')
test acc is  0.8042166668229919
test loss is 78.65319157256755
test entropy is  0.016727730522472478
________________________________
distance 1 is tensor(175.6638, device='cuda:0')
distance 2 is tensor(12.8137, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.017077229350694882
avg test loss is  78.41573345127391
avg accuracy is  0.8038000001563252
solo acc is  0.18693333348966906
compute similarity  is  tensor(0.9433, device='cuda:0')
compute_distance is  tensor(12.8137, device='cuda:0')
compute_norm is  tensor(54.3096, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(164.2239, device='cuda:0')
distance 2 is tensor(13.6703, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.974554210519994
avg test loss is  1.4381422692778776
avg accuracy is  0.8060666668229919
solo acc is  0.3016166668230062
compute similarity  is  tensor(0.9442, device='cuda:0')
compute_distance is  tensor(13.6703, device='cuda:0')
compute_norm is  tensor(53.8731, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(164.6112, device='cuda:0')
distance 2 is tensor(13.8057, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9145368783712895
avg test loss is  1.5386384584502117
avg accuracy is  0.7981500001563255
solo acc is  0.2436333334896713
compute similarity  is  tensor(0.9440, device='cuda:0')
compute_distance is  tensor(13.8057, device='cuda:0')
compute_norm is  tensor(53.6228, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(164.6112, device='cuda:0')
distance 2 is tensor(13.8057, device='cuda:0')
________________________________
test distance is  tensor(13.8057, device='cuda:0')
test similarity is  tensor(0.9440, device='cuda:0')
test acc is  0.8013500001563253
test loss is 1.5434693384018026
test entropy is  0.9134475471876832
________________________________
cal ratio is  0.8994389483957277
distance 1 is tensor(148.0583, device='cuda:0')
distance 2 is tensor(12.4174, device='cuda:0')
cal_distance is  tensor(12.4174, device='cuda:0')
distance 1 is tensor(148.0583, device='cuda:0')
distance 2 is tensor(12.4174, device='cuda:0')
________________________________
test distance is  tensor(12.4174, device='cuda:0')
test similarity is  tensor(0.9535, device='cuda:0')
test acc is  0.8172166668229913
test loss is 1.2148971124879842
test entropy is  1.0721757828172591
________________________________
distance 1 is tensor(148.0583, device='cuda:0')
distance 2 is tensor(12.4174, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0716124124237214
avg test loss is  1.2141966058501303
avg accuracy is  0.8171000001563247
solo acc is  0.4062666668230078
compute similarity  is  tensor(0.9535, device='cuda:0')
compute_distance is  tensor(12.4174, device='cuda:0')
compute_norm is  tensor(53.1358, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.1935, device='cuda:0')
distance 2 is tensor(12.6153, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9063501227130768
avg test loss is  1.511804484482259
avg accuracy is  0.8095666668229917
solo acc is  0.24206666682300465
compute similarity  is  tensor(0.9532, device='cuda:0')
compute_distance is  tensor(12.6153, device='cuda:0')
compute_norm is  tensor(52.8905, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.8259, device='cuda:0')
distance 2 is tensor(12.7022, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9011148047853889
avg test loss is  1.4933449899209843
avg accuracy is  0.8076000001563252
solo acc is  0.23770000015633785
compute similarity  is  tensor(0.9530, device='cuda:0')
compute_distance is  tensor(12.7022, device='cuda:0')
compute_norm is  tensor(52.6411, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.4401, device='cuda:0')
distance 2 is tensor(12.7742, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8988406010019754
avg test loss is  1.4668572712808783
avg accuracy is  0.809000000156325
solo acc is  0.24335000015633804
compute similarity  is  tensor(0.9529, device='cuda:0')
compute_distance is  tensor(12.7742, device='cuda:0')
compute_norm is  tensor(52.3960, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.1664, device='cuda:0')
distance 2 is tensor(12.8444, device='cuda:0')
exit early
distance 1 is tensor(151.1664, device='cuda:0')
distance 2 is tensor(12.8444, device='cuda:0')
________________________________
test distance is  tensor(12.8444, device='cuda:0')
test similarity is  tensor(0.9528, device='cuda:0')
test acc is  0.8102166668229918
test loss is 1.4763273155765493
test entropy is  0.883888049039251
________________________________
distance 1 is tensor(151.1664, device='cuda:0')
distance 2 is tensor(12.8444, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8841743302116516
avg test loss is  1.474273322996046
avg accuracy is  0.8073666668229917
solo acc is  0.23500000015633785
compute similarity  is  tensor(0.9528, device='cuda:0')
compute_distance is  tensor(12.8444, device='cuda:0')
compute_norm is  tensor(52.1537, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.8504, device='cuda:0')
distance 2 is tensor(12.9053, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8888311846169836
avg test loss is  1.452381967862786
avg accuracy is  0.8078666668229917
solo acc is  0.23266666682300438
compute similarity  is  tensor(0.9527, device='cuda:0')
compute_distance is  tensor(12.9053, device='cuda:0')
compute_norm is  tensor(51.9134, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.5531, device='cuda:0')
distance 2 is tensor(12.9666, device='cuda:0')
exit early
distance 1 is tensor(152.5531, device='cuda:0')
distance 2 is tensor(12.9666, device='cuda:0')
________________________________
test distance is  tensor(12.9666, device='cuda:0')
test similarity is  tensor(0.9525, device='cuda:0')
test acc is  0.8101166668229915
test loss is 1.4557538473529856
test entropy is  0.8795818694746063
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3287246227264404
mal norm is  tensor(7.4490, device='cuda:0')
distance 1 is tensor(152.5531, device='cuda:0')
distance 2 is tensor(12.9666, device='cuda:0')
mal distance is  tensor(12.9666, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.2209, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.7417, device='cuda:0')
c is  tensor(0.0212, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.8066, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.9307, device='cuda:0')
c is  tensor(0.0212, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.7026, device='cuda:0')
c is  tensor(0.0212, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(476.9677, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8849, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.9925, device='cuda:0')
c is  tensor(0.0217, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.7598, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.1845e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9012, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5607e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.8445, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.2137, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.5964e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.5887, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.4917, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.8883, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.4336e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.6546, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.1731e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.8802, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.0646e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.8834, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 21
len all weights is 21
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 87.11% 

Test Accuracy: 85.76% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
 benign loss is  0.37283599376678467
distance 1 is tensor(170.1931, device='cuda:0')
distance 2 is tensor(12.4785, device='cuda:0')
benign distance is  tensor(12.4785, device='cuda:0')
norm1 res is  tensor(0.1696, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9139094352722168
distance 1 is tensor(163.4902, device='cuda:0')
distance 2 is tensor(11.9374, device='cuda:0')
benign distance is  tensor(11.9374, device='cuda:0')
norm1 res is  tensor(0.1612, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.18087805807590485
distance 1 is tensor(160.9256, device='cuda:0')
distance 2 is tensor(11.8817, device='cuda:0')
benign distance is  tensor(11.8817, device='cuda:0')
norm1 res is  tensor(0.1593, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6882786750793457
distance 1 is tensor(153.9311, device='cuda:0')
distance 2 is tensor(11.1037, device='cuda:0')
benign distance is  tensor(11.1037, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7017908096313477
distance 1 is tensor(156.7784, device='cuda:0')
distance 2 is tensor(11.6273, device='cuda:0')
benign distance is  tensor(11.6273, device='cuda:0')
norm1 res is  tensor(0.1555, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.911935031414032
distance 1 is tensor(181.0374, device='cuda:0')
distance 2 is tensor(13.3155, device='cuda:0')
benign distance is  tensor(13.3155, device='cuda:0')
norm1 res is  tensor(0.1789, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.11266088485717773
distance 1 is tensor(145.3217, device='cuda:0')
distance 2 is tensor(10.7517, device='cuda:0')
benign distance is  tensor(10.7517, device='cuda:0')
norm1 res is  tensor(0.1423, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.3300310969352722
distance 1 is tensor(149.6633, device='cuda:0')
distance 2 is tensor(10.9986, device='cuda:0')
benign distance is  tensor(10.9986, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.4031221866607666
distance 1 is tensor(154.4373, device='cuda:0')
distance 2 is tensor(11.3764, device='cuda:0')
benign distance is  tensor(11.3764, device='cuda:0')
norm1 res is  tensor(0.1552, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9448167681694031
distance 1 is tensor(179.3857, device='cuda:0')
distance 2 is tensor(13.2458, device='cuda:0')
benign distance is  tensor(13.2458, device='cuda:0')
norm1 res is  tensor(0.1756, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.03792920708656311
distance 1 is tensor(166.9146, device='cuda:0')
distance 2 is tensor(12.1894, device='cuda:0')
benign distance is  tensor(12.1894, device='cuda:0')
norm1 res is  tensor(0.1624, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.6978718042373657
distance 1 is tensor(167.5632, device='cuda:0')
distance 2 is tensor(12.3828, device='cuda:0')
benign distance is  tensor(12.3828, device='cuda:0')
norm1 res is  tensor(0.1659, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.3777042627334595
distance 1 is tensor(162.0300, device='cuda:0')
distance 2 is tensor(11.8734, device='cuda:0')
benign distance is  tensor(11.8734, device='cuda:0')
norm1 res is  tensor(0.1565, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8713061213493347
distance 1 is tensor(164.4912, device='cuda:0')
distance 2 is tensor(12.1033, device='cuda:0')
benign distance is  tensor(12.1033, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.6981724500656128
distance 1 is tensor(171.8738, device='cuda:0')
distance 2 is tensor(12.5900, device='cuda:0')
benign distance is  tensor(12.5900, device='cuda:0')
norm1 res is  tensor(0.1682, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.770592212677002
distance 1 is tensor(164.3683, device='cuda:0')
distance 2 is tensor(12.1479, device='cuda:0')
benign distance is  tensor(12.1479, device='cuda:0')
norm1 res is  tensor(0.1610, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(171.2353, device='cuda:0')
distance 2 is tensor(12.6255, device='cuda:0')
compute distance is  tensor(12.6255, device='cuda:0')
compute norm is  tensor(51.1822, device='cuda:0')
distance 1 is tensor(181.0559, device='cuda:0')
distance 2 is tensor(13.2292, device='cuda:0')
compute distance is  tensor(13.2292, device='cuda:0')
compute norm is  tensor(51.5300, device='cuda:0')
distance 1 is tensor(194.3858, device='cuda:0')
distance 2 is tensor(14.4915, device='cuda:0')
compute distance is  tensor(14.4915, device='cuda:0')
compute norm is  tensor(51.8412, device='cuda:0')
distance 1 is tensor(183.0094, device='cuda:0')
distance 2 is tensor(13.5755, device='cuda:0')
compute distance is  tensor(13.5755, device='cuda:0')
compute norm is  tensor(51.5912, device='cuda:0')
distance 1 is tensor(177.1533, device='cuda:0')
distance 2 is tensor(13.2203, device='cuda:0')
compute distance is  tensor(13.2203, device='cuda:0')
compute norm is  tensor(51.5483, device='cuda:0')
distance 1 is tensor(186.5258, device='cuda:0')
distance 2 is tensor(13.9004, device='cuda:0')
compute distance is  tensor(13.9004, device='cuda:0')
compute norm is  tensor(51.7797, device='cuda:0')
distance 1 is tensor(181.0689, device='cuda:0')
distance 2 is tensor(13.4636, device='cuda:0')
compute distance is  tensor(13.4636, device='cuda:0')
compute norm is  tensor(51.5082, device='cuda:0')
distance 1 is tensor(186.3983, device='cuda:0')
distance 2 is tensor(13.7655, device='cuda:0')
compute distance is  tensor(13.7655, device='cuda:0')
compute norm is  tensor(51.7986, device='cuda:0')
distance 1 is tensor(176.3673, device='cuda:0')
distance 2 is tensor(13.1519, device='cuda:0')
compute distance is  tensor(13.1519, device='cuda:0')
compute norm is  tensor(51.4641, device='cuda:0')
distance 1 is tensor(176.2582, device='cuda:0')
distance 2 is tensor(13.1785, device='cuda:0')
compute distance is  tensor(13.1785, device='cuda:0')
compute norm is  tensor(51.4449, device='cuda:0')
distance 1 is tensor(187.5646, device='cuda:0')
distance 2 is tensor(13.8245, device='cuda:0')
compute distance is  tensor(13.8245, device='cuda:0')
compute norm is  tensor(51.7465, device='cuda:0')
distance 1 is tensor(175.3697, device='cuda:0')
distance 2 is tensor(13.0337, device='cuda:0')
compute distance is  tensor(13.0337, device='cuda:0')
compute norm is  tensor(51.5766, device='cuda:0')
distance Threshold  is  tensor(14.4915, device='cuda:0')
distance 1 is tensor(1009098.6875, device='cuda:0')
distance 2 is tensor(73610.0547, device='cuda:0')
________________________________
test distance is  tensor(73610.0547, device='cuda:0')
test similarity is  tensor(0.2944, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82218321357806e+17
test entropy is  0.0
________________________________
cal ratio is  0.012627877138127084
distance 1 is tensor(12742.7803, device='cuda:0')
distance 2 is tensor(929.5388, device='cuda:0')
cal_distance is  tensor(929.5388, device='cuda:0')
cal ratio is  0.11237382183071287
distance 1 is tensor(1431.9602, device='cuda:0')
distance 2 is tensor(104.4558, device='cuda:0')
cal_distance is  tensor(104.4558, device='cuda:0')
cal ratio is  0.33522205507056135
distance 1 is tensor(480.0287, device='cuda:0')
distance 2 is tensor(35.0159, device='cuda:0')
cal_distance is  tensor(35.0159, device='cuda:0')
cal ratio is  0.5789836407102027
distance 1 is tensor(277.9313, device='cuda:0')
distance 2 is tensor(20.2736, device='cuda:0')
cal_distance is  tensor(20.2736, device='cuda:0')
cal ratio is  0.7609097230921213
distance 1 is tensor(211.4820, device='cuda:0')
distance 2 is tensor(15.4264, device='cuda:0')
cal_distance is  tensor(15.4264, device='cuda:0')
cal ratio is  0.872301335848715
distance 1 is tensor(184.4769, device='cuda:0')
distance 2 is tensor(13.4565, device='cuda:0')
cal_distance is  tensor(13.4565, device='cuda:0')
distance 1 is tensor(184.4769, device='cuda:0')
distance 2 is tensor(13.4565, device='cuda:0')
________________________________
test distance is  tensor(13.4565, device='cuda:0')
test similarity is  tensor(0.9470, device='cuda:0')
test acc is  0.45576666682300837
test loss is 151.00097061677783
test entropy is  0.0010255588307437012
________________________________
distance 1 is tensor(184.4769, device='cuda:0')
distance 2 is tensor(13.4565, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0008925288475868513
avg test loss is  150.75491611179766
avg accuracy is  0.4589666668230084
solo acc is  0.10265000015633197
compute similarity  is  tensor(0.9470, device='cuda:0')
compute_distance is  tensor(13.4565, device='cuda:0')
compute_norm is  tensor(55.8159, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(167.3846, device='cuda:0')
distance 2 is tensor(13.6971, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9495251162855356
avg test loss is  1.4549653241629286
avg accuracy is  0.6702666668229991
solo acc is  0.2843666668230058
compute similarity  is  tensor(0.9496, device='cuda:0')
compute_distance is  tensor(13.6971, device='cuda:0')
compute_norm is  tensor(55.6751, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(167.3846, device='cuda:0')
distance 2 is tensor(13.6971, device='cuda:0')
________________________________
test distance is  tensor(13.6971, device='cuda:0')
test similarity is  tensor(0.9496, device='cuda:0')
test acc is  0.6724333334896656
test loss is 1.4569348250624976
test entropy is  0.948510265108873
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.1909480094909668
mal norm is  tensor(8.8952, device='cuda:0')
distance 1 is tensor(167.3846, device='cuda:0')
distance 2 is tensor(13.6971, device='cuda:0')
mal distance is  tensor(13.6971, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2797, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.0150, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.1061, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.7620, device='cuda:0')
c is  tensor(0.0213, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.3101, device='cuda:0')
c is  tensor(0.0219, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.8045, device='cuda:0')
c is  tensor(0.0214, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(707.3170, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.7404, device='cuda:0')
c is  tensor(0.0222, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.6758, device='cuda:0')
c is  tensor(0.0218, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(889.5232, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0027, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.6644, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.3366, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.5739, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.8364, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.6116, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.6550, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.0916, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.9718, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 91.14% 

Test Accuracy: 89.16% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
 benign loss is  0.352935254573822
distance 1 is tensor(128.5507, device='cuda:0')
distance 2 is tensor(9.3648, device='cuda:0')
benign distance is  tensor(9.3648, device='cuda:0')
norm1 res is  tensor(0.1297, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.3014371991157532
distance 1 is tensor(142.7692, device='cuda:0')
distance 2 is tensor(10.1074, device='cuda:0')
benign distance is  tensor(10.1074, device='cuda:0')
norm1 res is  tensor(0.1431, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.16957338154315948
distance 1 is tensor(143.4800, device='cuda:0')
distance 2 is tensor(10.3788, device='cuda:0')
benign distance is  tensor(10.3788, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.7062028646469116
distance 1 is tensor(131.2573, device='cuda:0')
distance 2 is tensor(9.4111, device='cuda:0')
benign distance is  tensor(9.4111, device='cuda:0')
norm1 res is  tensor(0.1301, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8755937814712524
distance 1 is tensor(126.1724, device='cuda:0')
distance 2 is tensor(9.0747, device='cuda:0')
benign distance is  tensor(9.0747, device='cuda:0')
norm1 res is  tensor(0.1246, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.4952657222747803
distance 1 is tensor(159.7586, device='cuda:0')
distance 2 is tensor(11.3772, device='cuda:0')
benign distance is  tensor(11.3772, device='cuda:0')
norm1 res is  tensor(0.1585, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.585721492767334
distance 1 is tensor(139.4657, device='cuda:0')
distance 2 is tensor(10.0258, device='cuda:0')
benign distance is  tensor(10.0258, device='cuda:0')
norm1 res is  tensor(0.1391, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.03228645771741867
distance 1 is tensor(153.2326, device='cuda:0')
distance 2 is tensor(10.8323, device='cuda:0')
benign distance is  tensor(10.8323, device='cuda:0')
norm1 res is  tensor(0.1508, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.8661600947380066
distance 1 is tensor(147.0114, device='cuda:0')
distance 2 is tensor(10.5397, device='cuda:0')
benign distance is  tensor(10.5397, device='cuda:0')
norm1 res is  tensor(0.1476, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.78102707862854
distance 1 is tensor(143.3250, device='cuda:0')
distance 2 is tensor(10.3931, device='cuda:0')
benign distance is  tensor(10.3931, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6819776892662048
distance 1 is tensor(141.8902, device='cuda:0')
distance 2 is tensor(10.2400, device='cuda:0')
benign distance is  tensor(10.2400, device='cuda:0')
norm1 res is  tensor(0.1417, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.38502272963523865
distance 1 is tensor(147.3495, device='cuda:0')
distance 2 is tensor(10.6051, device='cuda:0')
benign distance is  tensor(10.6051, device='cuda:0')
norm1 res is  tensor(0.1487, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.7717269659042358
distance 1 is tensor(131.7614, device='cuda:0')
distance 2 is tensor(9.5971, device='cuda:0')
benign distance is  tensor(9.5971, device='cuda:0')
norm1 res is  tensor(0.1342, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.14970102906227112
distance 1 is tensor(144.3354, device='cuda:0')
distance 2 is tensor(10.5683, device='cuda:0')
benign distance is  tensor(10.5683, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.2549092173576355
distance 1 is tensor(133.4422, device='cuda:0')
distance 2 is tensor(9.6014, device='cuda:0')
benign distance is  tensor(9.6014, device='cuda:0')
norm1 res is  tensor(0.1353, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.1180572509765625
distance 1 is tensor(154.8779, device='cuda:0')
distance 2 is tensor(11.0161, device='cuda:0')
benign distance is  tensor(11.0161, device='cuda:0')
norm1 res is  tensor(0.1527, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(171.5186, device='cuda:0')
distance 2 is tensor(12.4568, device='cuda:0')
compute distance is  tensor(12.4568, device='cuda:0')
compute norm is  tensor(52.0910, device='cuda:0')
distance 1 is tensor(165.1235, device='cuda:0')
distance 2 is tensor(12.0978, device='cuda:0')
compute distance is  tensor(12.0978, device='cuda:0')
compute norm is  tensor(52.1015, device='cuda:0')
distance 1 is tensor(171.1933, device='cuda:0')
distance 2 is tensor(12.5362, device='cuda:0')
compute distance is  tensor(12.5362, device='cuda:0')
compute norm is  tensor(52.1912, device='cuda:0')
distance 1 is tensor(170.7758, device='cuda:0')
distance 2 is tensor(12.2048, device='cuda:0')
compute distance is  tensor(12.2048, device='cuda:0')
compute norm is  tensor(52.0505, device='cuda:0')
distance 1 is tensor(167.0970, device='cuda:0')
distance 2 is tensor(12.0371, device='cuda:0')
compute distance is  tensor(12.0371, device='cuda:0')
compute norm is  tensor(52.0439, device='cuda:0')
distance 1 is tensor(173.6457, device='cuda:0')
distance 2 is tensor(12.5927, device='cuda:0')
compute distance is  tensor(12.5927, device='cuda:0')
compute norm is  tensor(52.2060, device='cuda:0')
distance 1 is tensor(172.9327, device='cuda:0')
distance 2 is tensor(12.7509, device='cuda:0')
compute distance is  tensor(12.7509, device='cuda:0')
compute norm is  tensor(52.3000, device='cuda:0')
distance 1 is tensor(173.8061, device='cuda:0')
distance 2 is tensor(12.4804, device='cuda:0')
compute distance is  tensor(12.4804, device='cuda:0')
compute norm is  tensor(52.2440, device='cuda:0')
distance 1 is tensor(170.0039, device='cuda:0')
distance 2 is tensor(12.3192, device='cuda:0')
compute distance is  tensor(12.3192, device='cuda:0')
compute norm is  tensor(52.1252, device='cuda:0')
distance 1 is tensor(156.5063, device='cuda:0')
distance 2 is tensor(11.4429, device='cuda:0')
compute distance is  tensor(11.4429, device='cuda:0')
compute norm is  tensor(51.8940, device='cuda:0')
distance 1 is tensor(175.0851, device='cuda:0')
distance 2 is tensor(12.5877, device='cuda:0')
compute distance is  tensor(12.5877, device='cuda:0')
compute norm is  tensor(52.3342, device='cuda:0')
distance 1 is tensor(190.9379, device='cuda:0')
distance 2 is tensor(13.8067, device='cuda:0')
compute distance is  tensor(13.8067, device='cuda:0')
compute norm is  tensor(52.7154, device='cuda:0')
distance Threshold  is  tensor(13.8067, device='cuda:0')
distance 1 is tensor(1009130.8125, device='cuda:0')
distance 2 is tensor(73612.7422, device='cuda:0')
________________________________
test distance is  tensor(73612.7422, device='cuda:0')
test similarity is  tensor(0.2241, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82250871935067e+17
test entropy is  0.0
________________________________
cal ratio is  0.012325687561322398
distance 1 is tensor(12438.2363, device='cuda:0')
distance 2 is tensor(907.3277, device='cuda:0')
cal_distance is  tensor(907.3277, device='cuda:0')
cal ratio is  0.11102110955054759
distance 1 is tensor(1380.9124, device='cuda:0')
distance 2 is tensor(100.7325, device='cuda:0')
cal_distance is  tensor(100.7325, device='cuda:0')
cal ratio is  0.33319830695332653
distance 1 is tensor(460.1216, device='cuda:0')
distance 2 is tensor(33.5639, device='cuda:0')
cal_distance is  tensor(33.5639, device='cuda:0')
cal ratio is  0.5772333057570131
distance 1 is tensor(265.6001, device='cuda:0')
distance 2 is tensor(19.3742, device='cuda:0')
cal_distance is  tensor(19.3742, device='cuda:0')
cal ratio is  0.7597587251717645
distance 1 is tensor(201.7934, device='cuda:0')
distance 2 is tensor(14.7197, device='cuda:0')
cal_distance is  tensor(14.7197, device='cuda:0')
cal ratio is  0.8716413707888953
distance 1 is tensor(175.8923, device='cuda:0')
distance 2 is tensor(12.8303, device='cuda:0')
cal_distance is  tensor(12.8303, device='cuda:0')
distance 1 is tensor(175.8923, device='cuda:0')
distance 2 is tensor(12.8303, device='cuda:0')
________________________________
test distance is  tensor(12.8303, device='cuda:0')
test similarity is  tensor(0.9469, device='cuda:0')
test acc is  0.8029500001563253
test loss is 88.61021252532504
test entropy is  0.014621094562676216
________________________________
distance 1 is tensor(175.8923, device='cuda:0')
distance 2 is tensor(12.8303, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.01441066569262304
avg test loss is  88.71155351667262
avg accuracy is  0.8047666668229918
solo acc is  0.17345000015633485
compute similarity  is  tensor(0.9469, device='cuda:0')
compute_distance is  tensor(12.8303, device='cuda:0')
compute_norm is  tensor(55.2814, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(163.9891, device='cuda:0')
distance 2 is tensor(13.6348, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9534119732979772
avg test loss is  1.4420558094724154
avg accuracy is  0.8053166668229919
solo acc is  0.29556666682300614
compute similarity  is  tensor(0.9480, device='cuda:0')
compute_distance is  tensor(13.6348, device='cuda:0')
compute_norm is  tensor(54.9018, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(164.2607, device='cuda:0')
distance 2 is tensor(13.7503, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9045180614823217
avg test loss is  1.5201220049786923
avg accuracy is  0.7990666668229921
solo acc is  0.2431666668230047
compute similarity  is  tensor(0.9478, device='cuda:0')
compute_distance is  tensor(13.7503, device='cuda:0')
compute_norm is  tensor(54.6417, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(164.2607, device='cuda:0')
distance 2 is tensor(13.7503, device='cuda:0')
________________________________
test distance is  tensor(13.7503, device='cuda:0')
test similarity is  tensor(0.9478, device='cuda:0')
test acc is  0.798816666822992
test loss is 1.5193127093792977
test entropy is  0.9056357973928391
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3606898784637451
mal norm is  tensor(8.5098, device='cuda:0')
distance 1 is tensor(164.2607, device='cuda:0')
distance 2 is tensor(13.7503, device='cuda:0')
mal distance is  tensor(13.7503, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.2391, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.6005, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(564.0016, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.9616e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.7684, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(515.7133, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.1092e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(493.8541, device='cuda:0')
c is  tensor(0.0220, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.3112, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.2396, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1457e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.4229, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(850.9844, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.6663e-05, device='cuda:0')
accept
len accept list 19
len all weights is 19
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 85.00% 

Test Accuracy: 83.75% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
 benign loss is  1.248539686203003
distance 1 is tensor(185.1781, device='cuda:0')
distance 2 is tensor(13.5473, device='cuda:0')
benign distance is  tensor(13.5473, device='cuda:0')
norm1 res is  tensor(0.1805, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6762298941612244
distance 1 is tensor(167.7564, device='cuda:0')
distance 2 is tensor(12.4365, device='cuda:0')
benign distance is  tensor(12.4365, device='cuda:0')
norm1 res is  tensor(0.1628, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.26526957750320435
distance 1 is tensor(177.1656, device='cuda:0')
distance 2 is tensor(13.1990, device='cuda:0')
benign distance is  tensor(13.1990, device='cuda:0')
norm1 res is  tensor(0.1717, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.118948221206665
distance 1 is tensor(177.2539, device='cuda:0')
distance 2 is tensor(13.0375, device='cuda:0')
benign distance is  tensor(13.0375, device='cuda:0')
norm1 res is  tensor(0.1716, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5983000993728638
distance 1 is tensor(181.2648, device='cuda:0')
distance 2 is tensor(13.2127, device='cuda:0')
benign distance is  tensor(13.2127, device='cuda:0')
norm1 res is  tensor(0.1721, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.0420442819595337
distance 1 is tensor(182.4422, device='cuda:0')
distance 2 is tensor(13.4900, device='cuda:0')
benign distance is  tensor(13.4900, device='cuda:0')
norm1 res is  tensor(0.1787, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.1322784125804901
distance 1 is tensor(171.3508, device='cuda:0')
distance 2 is tensor(12.4826, device='cuda:0')
benign distance is  tensor(12.4826, device='cuda:0')
norm1 res is  tensor(0.1631, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7004797458648682
distance 1 is tensor(193.9655, device='cuda:0')
distance 2 is tensor(14.2692, device='cuda:0')
benign distance is  tensor(14.2692, device='cuda:0')
norm1 res is  tensor(0.1881, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(219.6461, device='cuda:0')
distance 2 is tensor(16.8572, device='cuda:0')
compute distance is  tensor(16.8572, device='cuda:0')
compute norm is  tensor(51.7597, device='cuda:0')
distance 1 is tensor(207.9100, device='cuda:0')
distance 2 is tensor(16.2437, device='cuda:0')
compute distance is  tensor(16.2437, device='cuda:0')
compute norm is  tensor(51.4675, device='cuda:0')
distance 1 is tensor(219.2563, device='cuda:0')
distance 2 is tensor(17.0826, device='cuda:0')
compute distance is  tensor(17.0826, device='cuda:0')
compute norm is  tensor(51.8064, device='cuda:0')
distance 1 is tensor(218.0943, device='cuda:0')
distance 2 is tensor(16.8562, device='cuda:0')
compute distance is  tensor(16.8562, device='cuda:0')
compute norm is  tensor(51.7459, device='cuda:0')
distance 1 is tensor(224.3682, device='cuda:0')
distance 2 is tensor(17.1206, device='cuda:0')
compute distance is  tensor(17.1206, device='cuda:0')
compute norm is  tensor(51.9289, device='cuda:0')
distance 1 is tensor(211.6882, device='cuda:0')
distance 2 is tensor(16.5452, device='cuda:0')
compute distance is  tensor(16.5452, device='cuda:0')
compute norm is  tensor(51.7323, device='cuda:0')
distance 1 is tensor(212.7199, device='cuda:0')
distance 2 is tensor(16.6230, device='cuda:0')
compute distance is  tensor(16.6230, device='cuda:0')
compute norm is  tensor(51.5578, device='cuda:0')
distance 1 is tensor(212.3301, device='cuda:0')
distance 2 is tensor(16.5448, device='cuda:0')
compute distance is  tensor(16.5448, device='cuda:0')
compute norm is  tensor(51.7043, device='cuda:0')
distance 1 is tensor(212.3984, device='cuda:0')
distance 2 is tensor(16.6019, device='cuda:0')
compute distance is  tensor(16.6019, device='cuda:0')
compute norm is  tensor(51.6842, device='cuda:0')
distance 1 is tensor(209.2489, device='cuda:0')
distance 2 is tensor(16.2877, device='cuda:0')
compute distance is  tensor(16.2877, device='cuda:0')
compute norm is  tensor(51.6658, device='cuda:0')
distance 1 is tensor(232.8168, device='cuda:0')
distance 2 is tensor(17.7746, device='cuda:0')
compute distance is  tensor(17.7746, device='cuda:0')
compute norm is  tensor(52.2049, device='cuda:0')
distance 1 is tensor(220.1425, device='cuda:0')
distance 2 is tensor(17.0583, device='cuda:0')
compute distance is  tensor(17.0583, device='cuda:0')
compute norm is  tensor(51.8255, device='cuda:0')
distance Threshold  is  tensor(17.7746, device='cuda:0')
distance 1 is tensor(1009064., device='cuda:0')
distance 2 is tensor(73607.4219, device='cuda:0')
________________________________
test distance is  tensor(73607.4219, device='cuda:0')
test similarity is  tensor(0.3749, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82328036654533e+17
test entropy is  0.0
________________________________
cal ratio is  0.013985629010516688
distance 1 is tensor(14112.4014, device='cuda:0')
distance 2 is tensor(1029.4460, device='cuda:0')
cal_distance is  tensor(1029.4460, device='cuda:0')
cal ratio is  0.11826085673867777
distance 1 is tensor(1668.9500, device='cuda:0')
distance 2 is tensor(121.7432, device='cuda:0')
cal_distance is  tensor(121.7432, device='cuda:0')
cal ratio is  0.3438907781515076
distance 1 is tensor(573.9404, device='cuda:0')
distance 2 is tensor(41.8664, device='cuda:0')
cal_distance is  tensor(41.8664, device='cuda:0')
cal ratio is  0.5864219775938098
distance 1 is tensor(336.5738, device='cuda:0')
distance 2 is tensor(24.5514, device='cuda:0')
cal_distance is  tensor(24.5514, device='cuda:0')
cal ratio is  0.7657819357423139
distance 1 is tensor(257.7435, device='cuda:0')
distance 2 is tensor(18.8010, device='cuda:0')
cal_distance is  tensor(18.8010, device='cuda:0')
cal ratio is  0.8750896625900808
distance 1 is tensor(225.5494, device='cuda:0')
distance 2 is tensor(16.4525, device='cuda:0')
cal_distance is  tensor(16.4525, device='cuda:0')
distance 1 is tensor(225.5494, device='cuda:0')
distance 2 is tensor(16.4525, device='cuda:0')
________________________________
test distance is  tensor(16.4525, device='cuda:0')
test similarity is  tensor(0.9397, device='cuda:0')
test acc is  0.21325000015633694
test loss is 456.32837470406406
test entropy is  2.9903071136116456e-05
________________________________
distance 1 is tensor(225.5494, device='cuda:0')
distance 2 is tensor(16.4525, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  2.2091738537559666e-05
avg test loss is  456.38986150745643
avg accuracy is  0.2165833334896704
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9397, device='cuda:0')
compute_distance is  tensor(16.4525, device='cuda:0')
compute_norm is  tensor(60.0677, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(222.3031, device='cuda:0')
distance 2 is tensor(20.7034, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  1.4804277048944665
avg test loss is  2.248069624910985
avg accuracy is  0.2613500001563386
solo acc is  0.15470000015633362
compute similarity  is  tensor(0.9395, device='cuda:0')
compute_distance is  tensor(20.7034, device='cuda:0')
compute_norm is  tensor(61.9519, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(222.6240, device='cuda:0')
distance 2 is tensor(21.0610, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8728463368248075
avg test loss is  2.974605103545606
avg accuracy is  0.18558333348966902
solo acc is  0.10436666682299864
compute similarity  is  tensor(0.9392, device='cuda:0')
compute_distance is  tensor(21.0610, device='cuda:0')
compute_norm is  tensor(62.1182, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(221.5267, device='cuda:0')
distance 2 is tensor(20.4702, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  1.250624070162458
avg test loss is  2.063504604642579
avg accuracy is  0.252016666823005
solo acc is  0.1620000001563342
compute similarity  is  tensor(0.9399, device='cuda:0')
compute_distance is  tensor(20.4702, device='cuda:0')
compute_norm is  tensor(61.6759, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(221.4133, device='cuda:0')
distance 2 is tensor(20.6403, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.769177443818497
avg test loss is  2.818147965839931
avg accuracy is  0.18361666682300223
solo acc is  0.1040833334896653
compute similarity  is  tensor(0.9396, device='cuda:0')
compute_distance is  tensor(20.6403, device='cuda:0')
compute_norm is  tensor(61.6574, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(220.6009, device='cuda:0')
distance 2 is tensor(20.1598, device='cuda:0')
________________________________
test distance is  tensor(20.1598, device='cuda:0')
test similarity is  tensor(0.9401, device='cuda:0')
test acc is  0.2592500001563385
test loss is 1.909313946898812
test entropy is  1.1576797686406035
________________________________
cal ratio is  0.8450835561352976
distance 1 is tensor(186.4270, device='cuda:0')
distance 2 is tensor(17.0367, device='cuda:0')
cal_distance is  tensor(17.0367, device='cuda:0')
distance 1 is tensor(186.4270, device='cuda:0')
distance 2 is tensor(17.0367, device='cuda:0')
________________________________
test distance is  tensor(17.0367, device='cuda:0')
test similarity is  tensor(0.9544, device='cuda:0')
test acc is  0.32755000015634
test loss is 1.8448025491446065
test entropy is  1.2961238171500185
________________________________
distance 1 is tensor(186.4270, device='cuda:0')
distance 2 is tensor(17.0367, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.2941140190624734
avg test loss is  1.8419958353042603
avg accuracy is  0.32850000015634007
solo acc is  0.16960000015633467
compute similarity  is  tensor(0.9544, device='cuda:0')
compute_distance is  tensor(17.0367, device='cuda:0')
compute_norm is  tensor(59.5638, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(186.8224, device='cuda:0')
distance 2 is tensor(17.2185, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.7150893379121955
avg test loss is  2.6789574155421145
avg accuracy is  0.22928333348967095
solo acc is  0.10540000015633197
compute similarity  is  tensor(0.9540, device='cuda:0')
compute_distance is  tensor(17.2185, device='cuda:0')
compute_norm is  tensor(59.5068, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(185.9535, device='cuda:0')
distance 2 is tensor(16.8141, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  1.0424524761085063
avg test loss is  1.6699151120968718
avg accuracy is  0.3825500001563409
solo acc is  0.2123000001563369
compute similarity  is  tensor(0.9545, device='cuda:0')
compute_distance is  tensor(16.8141, device='cuda:0')
compute_norm is  tensor(59.1196, device='cuda:0')
++++++++++++++++++++
restore alpha
distance 1 is tensor(185.7709, device='cuda:0')
distance 2 is tensor(16.8503, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.6278754341831085
avg test loss is  2.469382114756082
avg accuracy is  0.2661500001563388
solo acc is  0.10873333348966528
compute similarity  is  tensor(0.9543, device='cuda:0')
compute_distance is  tensor(16.8503, device='cuda:0')
compute_norm is  tensor(58.9565, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(184.8658, device='cuda:0')
distance 2 is tensor(16.4865, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.9746483636817445
avg test loss is  1.525607154313435
avg accuracy is  0.43841666682300817
solo acc is  0.2476833334896715
compute similarity  is  tensor(0.9547, device='cuda:0')
compute_distance is  tensor(16.4865, device='cuda:0')
compute_norm is  tensor(58.5494, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(184.8658, device='cuda:0')
distance 2 is tensor(16.4865, device='cuda:0')
________________________________
test distance is  tensor(16.4865, device='cuda:0')
test similarity is  tensor(0.9547, device='cuda:0')
test acc is  0.4350333334896748
test loss is 1.526918807644834
test entropy is  0.9735901504437298
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.5305697917938232
mal norm is  tensor(8.8607, device='cuda:0')
distance 1 is tensor(184.8658, device='cuda:0')
distance 2 is tensor(16.4865, device='cuda:0')
mal distance is  tensor(16.4865, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2715, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.2014, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.7243, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.7977, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.1006, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.8264, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.6483, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.0545, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.2482, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.0717, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0029, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(977.2967, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(959.5847, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(966.6454, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(999.8152, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(974.9029, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(1008.6847, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(971.3391, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(978.1742, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(876.7294, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3887, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(832.0313, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.7337, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.4032, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(854.9532, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.9634, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(814.5710, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.5038, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.5665, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.8354, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.4688, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.2224, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1666, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.2666, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.7729, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.3264, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(741.2614, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.0920, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.8718, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.6481, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.9463, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.0426, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(772.7864, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
len accept list 40
len all weights is 40
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 91.05% 

Test Accuracy: 89.07% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
 benign loss is  1.3331634998321533
distance 1 is tensor(142.3165, device='cuda:0')
distance 2 is tensor(10.4928, device='cuda:0')
benign distance is  tensor(10.4928, device='cuda:0')
norm1 res is  tensor(0.1447, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.2842581868171692
distance 1 is tensor(137.7636, device='cuda:0')
distance 2 is tensor(9.8326, device='cuda:0')
benign distance is  tensor(9.8326, device='cuda:0')
norm1 res is  tensor(0.1366, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7235700488090515
distance 1 is tensor(133.1130, device='cuda:0')
distance 2 is tensor(9.8094, device='cuda:0')
benign distance is  tensor(9.8094, device='cuda:0')
norm1 res is  tensor(0.1339, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6843485832214355
distance 1 is tensor(127.6157, device='cuda:0')
distance 2 is tensor(9.1674, device='cuda:0')
benign distance is  tensor(9.1674, device='cuda:0')
norm1 res is  tensor(0.1254, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7458256483078003
distance 1 is tensor(137.6029, device='cuda:0')
distance 2 is tensor(9.8113, device='cuda:0')
benign distance is  tensor(9.8113, device='cuda:0')
norm1 res is  tensor(0.1343, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.46449652314186096
distance 1 is tensor(155.2539, device='cuda:0')
distance 2 is tensor(11.2510, device='cuda:0')
benign distance is  tensor(11.2510, device='cuda:0')
norm1 res is  tensor(0.1560, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.49982404708862305
distance 1 is tensor(127.3806, device='cuda:0')
distance 2 is tensor(9.1352, device='cuda:0')
benign distance is  tensor(9.1352, device='cuda:0')
norm1 res is  tensor(0.1282, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5245110392570496
distance 1 is tensor(135.1421, device='cuda:0')
distance 2 is tensor(9.7469, device='cuda:0')
benign distance is  tensor(9.7469, device='cuda:0')
norm1 res is  tensor(0.1358, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.5938481092453003
distance 1 is tensor(144.4948, device='cuda:0')
distance 2 is tensor(10.4144, device='cuda:0')
benign distance is  tensor(10.4144, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.1620146036148071
distance 1 is tensor(145.8825, device='cuda:0')
distance 2 is tensor(10.6748, device='cuda:0')
benign distance is  tensor(10.6748, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.5349447131156921
distance 1 is tensor(138.0569, device='cuda:0')
distance 2 is tensor(9.8820, device='cuda:0')
benign distance is  tensor(9.8820, device='cuda:0')
norm1 res is  tensor(0.1363, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.35606828331947327
distance 1 is tensor(146.8375, device='cuda:0')
distance 2 is tensor(10.7695, device='cuda:0')
benign distance is  tensor(10.7695, device='cuda:0')
norm1 res is  tensor(0.1480, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.3647040128707886
distance 1 is tensor(146.8585, device='cuda:0')
distance 2 is tensor(10.5322, device='cuda:0')
benign distance is  tensor(10.5322, device='cuda:0')
norm1 res is  tensor(0.1463, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.27563634514808655
distance 1 is tensor(142.6772, device='cuda:0')
distance 2 is tensor(10.3350, device='cuda:0')
benign distance is  tensor(10.3350, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.9455579519271851
distance 1 is tensor(138.6030, device='cuda:0')
distance 2 is tensor(9.9694, device='cuda:0')
benign distance is  tensor(9.9694, device='cuda:0')
norm1 res is  tensor(0.1392, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.1094261407852173
distance 1 is tensor(148.5478, device='cuda:0')
distance 2 is tensor(10.7667, device='cuda:0')
benign distance is  tensor(10.7667, device='cuda:0')
norm1 res is  tensor(0.1491, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.38001278042793274
distance 1 is tensor(149.2855, device='cuda:0')
distance 2 is tensor(10.6582, device='cuda:0')
benign distance is  tensor(10.6582, device='cuda:0')
norm1 res is  tensor(0.1463, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7932175397872925
distance 1 is tensor(146.2427, device='cuda:0')
distance 2 is tensor(10.4483, device='cuda:0')
benign distance is  tensor(10.4483, device='cuda:0')
norm1 res is  tensor(0.1461, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.6222697496414185
distance 1 is tensor(148.8405, device='cuda:0')
distance 2 is tensor(10.7097, device='cuda:0')
benign distance is  tensor(10.7097, device='cuda:0')
norm1 res is  tensor(0.1478, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.5729485750198364
distance 1 is tensor(145.5564, device='cuda:0')
distance 2 is tensor(10.4513, device='cuda:0')
benign distance is  tensor(10.4513, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.4712623059749603
distance 1 is tensor(139.2477, device='cuda:0')
distance 2 is tensor(10.0936, device='cuda:0')
benign distance is  tensor(10.0936, device='cuda:0')
norm1 res is  tensor(0.1372, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.40093597769737244
distance 1 is tensor(135.4469, device='cuda:0')
distance 2 is tensor(9.8073, device='cuda:0')
benign distance is  tensor(9.8073, device='cuda:0')
norm1 res is  tensor(0.1353, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.3595276474952698
distance 1 is tensor(147.4104, device='cuda:0')
distance 2 is tensor(10.5097, device='cuda:0')
benign distance is  tensor(10.5097, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.28195279836654663
distance 1 is tensor(151.6343, device='cuda:0')
distance 2 is tensor(10.9394, device='cuda:0')
benign distance is  tensor(10.9394, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.4306600093841553
distance 1 is tensor(148.4731, device='cuda:0')
distance 2 is tensor(10.6417, device='cuda:0')
benign distance is  tensor(10.6417, device='cuda:0')
norm1 res is  tensor(0.1497, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6133896112442017
distance 1 is tensor(140.0045, device='cuda:0')
distance 2 is tensor(9.8885, device='cuda:0')
benign distance is  tensor(9.8885, device='cuda:0')
norm1 res is  tensor(0.1348, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.5799393653869629
distance 1 is tensor(142.7678, device='cuda:0')
distance 2 is tensor(10.4335, device='cuda:0')
benign distance is  tensor(10.4335, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.41931796073913574
distance 1 is tensor(142.6373, device='cuda:0')
distance 2 is tensor(10.1605, device='cuda:0')
benign distance is  tensor(10.1605, device='cuda:0')
norm1 res is  tensor(0.1440, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.7153996229171753
distance 1 is tensor(140.5475, device='cuda:0')
distance 2 is tensor(10.1417, device='cuda:0')
benign distance is  tensor(10.1417, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.5720862150192261
distance 1 is tensor(150.4756, device='cuda:0')
distance 2 is tensor(10.7615, device='cuda:0')
benign distance is  tensor(10.7615, device='cuda:0')
norm1 res is  tensor(0.1489, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5242149233818054
distance 1 is tensor(149.4950, device='cuda:0')
distance 2 is tensor(10.7925, device='cuda:0')
benign distance is  tensor(10.7925, device='cuda:0')
norm1 res is  tensor(0.1534, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.6400884389877319
distance 1 is tensor(153.8113, device='cuda:0')
distance 2 is tensor(11.0742, device='cuda:0')
benign distance is  tensor(11.0742, device='cuda:0')
norm1 res is  tensor(0.1527, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.3234519958496094
distance 1 is tensor(147.7704, device='cuda:0')
distance 2 is tensor(10.6575, device='cuda:0')
benign distance is  tensor(10.6575, device='cuda:0')
norm1 res is  tensor(0.1464, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.8629546165466309
distance 1 is tensor(144.4718, device='cuda:0')
distance 2 is tensor(10.2207, device='cuda:0')
benign distance is  tensor(10.2207, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.286886602640152
distance 1 is tensor(145.9254, device='cuda:0')
distance 2 is tensor(10.4119, device='cuda:0')
benign distance is  tensor(10.4119, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.20541968941688538
distance 1 is tensor(154.5662, device='cuda:0')
distance 2 is tensor(11.2887, device='cuda:0')
benign distance is  tensor(11.2887, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.41036170721054077
distance 1 is tensor(139.1171, device='cuda:0')
distance 2 is tensor(10.0977, device='cuda:0')
benign distance is  tensor(10.0977, device='cuda:0')
norm1 res is  tensor(0.1390, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.2819867730140686
distance 1 is tensor(147.1578, device='cuda:0')
distance 2 is tensor(10.5783, device='cuda:0')
benign distance is  tensor(10.5783, device='cuda:0')
norm1 res is  tensor(0.1431, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8334611058235168
distance 1 is tensor(155.4305, device='cuda:0')
distance 2 is tensor(11.0647, device='cuda:0')
benign distance is  tensor(11.0647, device='cuda:0')
norm1 res is  tensor(0.1527, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5451784133911133
distance 1 is tensor(141.9700, device='cuda:0')
distance 2 is tensor(10.2146, device='cuda:0')
benign distance is  tensor(10.2146, device='cuda:0')
norm1 res is  tensor(0.1399, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(159.0904, device='cuda:0')
distance 2 is tensor(11.4279, device='cuda:0')
compute distance is  tensor(11.4279, device='cuda:0')
compute norm is  tensor(51.9964, device='cuda:0')
distance 1 is tensor(165.4734, device='cuda:0')
distance 2 is tensor(11.8251, device='cuda:0')
compute distance is  tensor(11.8251, device='cuda:0')
compute norm is  tensor(51.7969, device='cuda:0')
distance 1 is tensor(172.8683, device='cuda:0')
distance 2 is tensor(12.3745, device='cuda:0')
compute distance is  tensor(12.3745, device='cuda:0')
compute norm is  tensor(52.2005, device='cuda:0')
distance 1 is tensor(199.2805, device='cuda:0')
distance 2 is tensor(14.1382, device='cuda:0')
compute distance is  tensor(14.1382, device='cuda:0')
compute norm is  tensor(52.8394, device='cuda:0')
distance 1 is tensor(168.5051, device='cuda:0')
distance 2 is tensor(12.2752, device='cuda:0')
compute distance is  tensor(12.2752, device='cuda:0')
compute norm is  tensor(52.2365, device='cuda:0')
distance 1 is tensor(168.5365, device='cuda:0')
distance 2 is tensor(12.0790, device='cuda:0')
compute distance is  tensor(12.0790, device='cuda:0')
compute norm is  tensor(52.0795, device='cuda:0')
distance 1 is tensor(172.0935, device='cuda:0')
distance 2 is tensor(12.2552, device='cuda:0')
compute distance is  tensor(12.2552, device='cuda:0')
compute norm is  tensor(52.2417, device='cuda:0')
distance 1 is tensor(170.8828, device='cuda:0')
distance 2 is tensor(12.4111, device='cuda:0')
compute distance is  tensor(12.4111, device='cuda:0')
compute norm is  tensor(52.1501, device='cuda:0')
distance 1 is tensor(167.2047, device='cuda:0')
distance 2 is tensor(12.0998, device='cuda:0')
compute distance is  tensor(12.0998, device='cuda:0')
compute norm is  tensor(52.0963, device='cuda:0')
distance 1 is tensor(174.6169, device='cuda:0')
distance 2 is tensor(12.5136, device='cuda:0')
compute distance is  tensor(12.5136, device='cuda:0')
compute norm is  tensor(52.2201, device='cuda:0')
distance 1 is tensor(184.9397, device='cuda:0')
distance 2 is tensor(13.1169, device='cuda:0')
compute distance is  tensor(13.1169, device='cuda:0')
compute norm is  tensor(52.5671, device='cuda:0')
distance 1 is tensor(171.1591, device='cuda:0')
distance 2 is tensor(12.2691, device='cuda:0')
compute distance is  tensor(12.2691, device='cuda:0')
compute norm is  tensor(52.3112, device='cuda:0')
distance Threshold  is  tensor(14.1382, device='cuda:0')
distance 1 is tensor(1009125.9375, device='cuda:0')
distance 2 is tensor(73612.3672, device='cuda:0')
________________________________
test distance is  tensor(73612.3672, device='cuda:0')
test similarity is  tensor(0.2419, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.824561641189073e+17
test entropy is  0.0
________________________________
cal ratio is  0.012472810752673267
distance 1 is tensor(12586.6436, device='cuda:0')
distance 2 is tensor(918.1530, device='cuda:0')
cal_distance is  tensor(918.1530, device='cuda:0')
cal ratio is  0.11168174672705049
distance 1 is tensor(1405.7035, device='cuda:0')
distance 2 is tensor(102.5409, device='cuda:0')
cal_distance is  tensor(102.5409, device='cuda:0')
cal ratio is  0.33418819231618324
distance 1 is tensor(469.7735, device='cuda:0')
distance 2 is tensor(34.2680, device='cuda:0')
cal_distance is  tensor(34.2680, device='cuda:0')
cal ratio is  0.5780901047768865
distance 1 is tensor(271.5739, device='cuda:0')
distance 2 is tensor(19.8100, device='cuda:0')
cal_distance is  tensor(19.8100, device='cuda:0')
cal ratio is  0.7603223613282946
distance 1 is tensor(206.4852, device='cuda:0')
distance 2 is tensor(15.0620, device='cuda:0')
cal_distance is  tensor(15.0620, device='cuda:0')
cal ratio is  0.8719646469296929
distance 1 is tensor(180.0486, device='cuda:0')
distance 2 is tensor(13.1335, device='cuda:0')
cal_distance is  tensor(13.1335, device='cuda:0')
distance 1 is tensor(180.0486, device='cuda:0')
distance 2 is tensor(13.1335, device='cuda:0')
________________________________
test distance is  tensor(13.1335, device='cuda:0')
test similarity is  tensor(0.9469, device='cuda:0')
test acc is  0.7998500001563255
test loss is 92.041825861819
test entropy is  0.01307224986818351
________________________________
distance 1 is tensor(180.0486, device='cuda:0')
distance 2 is tensor(13.1335, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.013715936457461763
avg test loss is  92.25310992991238
avg accuracy is  0.7995000001563254
solo acc is  0.16601666682300115
compute similarity  is  tensor(0.9469, device='cuda:0')
compute_distance is  tensor(13.1335, device='cuda:0')
compute_norm is  tensor(56.0872, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(167.6905, device='cuda:0')
distance 2 is tensor(13.9228, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9635256804637055
avg test loss is  1.4490985332775725
avg accuracy is  0.796283333489659
solo acc is  0.29675000015633946
compute similarity  is  tensor(0.9482, device='cuda:0')
compute_distance is  tensor(13.9228, device='cuda:0')
compute_norm is  tensor(55.7569, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(167.6905, device='cuda:0')
distance 2 is tensor(13.9228, device='cuda:0')
________________________________
test distance is  tensor(13.9228, device='cuda:0')
test similarity is  tensor(0.9482, device='cuda:0')
test acc is  0.7973833334896588
test loss is 1.453820792977998
test entropy is  0.9628549495866812
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.3658701181411743
mal norm is  tensor(8.7585, device='cuda:0')
distance 1 is tensor(167.6905, device='cuda:0')
distance 2 is tensor(13.9228, device='cuda:0')
mal distance is  tensor(13.9228, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(0.2039, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.7628, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.3156e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.5139, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.4688e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.1139, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.5992, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.5163, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.9360, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.7098e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.2313, device='cuda:0')
c is  tensor(0.0202, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.1450, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4274e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(875.8484, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.4233e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.0547, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.4506e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.6858, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.0200, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9759, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.1447, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.3383, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.6609, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.9982, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
len accept list 9
len all weights is 9
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 91.42% 

Test Accuracy: 89.39% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
 benign loss is  0.34084734320640564
distance 1 is tensor(108.9807, device='cuda:0')
distance 2 is tensor(7.9331, device='cuda:0')
benign distance is  tensor(7.9331, device='cuda:0')
norm1 res is  tensor(0.1133, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.042971983551979065
distance 1 is tensor(124.4178, device='cuda:0')
distance 2 is tensor(9.0073, device='cuda:0')
benign distance is  tensor(9.0073, device='cuda:0')
norm1 res is  tensor(0.1260, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.11185090243816376
distance 1 is tensor(119.5016, device='cuda:0')
distance 2 is tensor(8.7680, device='cuda:0')
benign distance is  tensor(8.7680, device='cuda:0')
norm1 res is  tensor(0.1230, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5925996899604797
distance 1 is tensor(135.6880, device='cuda:0')
distance 2 is tensor(9.7014, device='cuda:0')
benign distance is  tensor(9.7014, device='cuda:0')
norm1 res is  tensor(0.1345, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6810563206672668
distance 1 is tensor(130.9026, device='cuda:0')
distance 2 is tensor(9.3998, device='cuda:0')
benign distance is  tensor(9.3998, device='cuda:0')
norm1 res is  tensor(0.1347, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7271221280097961
distance 1 is tensor(136.9666, device='cuda:0')
distance 2 is tensor(9.7891, device='cuda:0')
benign distance is  tensor(9.7891, device='cuda:0')
norm1 res is  tensor(0.1388, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.21255497634410858
distance 1 is tensor(112.7624, device='cuda:0')
distance 2 is tensor(8.0615, device='cuda:0')
benign distance is  tensor(8.0615, device='cuda:0')
norm1 res is  tensor(0.1112, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.20794931054115295
distance 1 is tensor(149.5444, device='cuda:0')
distance 2 is tensor(10.6684, device='cuda:0')
benign distance is  tensor(10.6684, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.47161585092544556
distance 1 is tensor(143.5859, device='cuda:0')
distance 2 is tensor(10.3858, device='cuda:0')
benign distance is  tensor(10.3858, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.1696673333644867
distance 1 is tensor(148.7566, device='cuda:0')
distance 2 is tensor(10.8009, device='cuda:0')
benign distance is  tensor(10.8009, device='cuda:0')
norm1 res is  tensor(0.1506, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.5190837979316711
distance 1 is tensor(130.6364, device='cuda:0')
distance 2 is tensor(9.3659, device='cuda:0')
benign distance is  tensor(9.3659, device='cuda:0')
norm1 res is  tensor(0.1316, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.24569329619407654
distance 1 is tensor(133.0816, device='cuda:0')
distance 2 is tensor(9.6217, device='cuda:0')
benign distance is  tensor(9.6217, device='cuda:0')
norm1 res is  tensor(0.1319, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.5293455719947815
distance 1 is tensor(144.0486, device='cuda:0')
distance 2 is tensor(10.2782, device='cuda:0')
benign distance is  tensor(10.2782, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.2876087427139282
distance 1 is tensor(134.0068, device='cuda:0')
distance 2 is tensor(9.6707, device='cuda:0')
benign distance is  tensor(9.6707, device='cuda:0')
norm1 res is  tensor(0.1367, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.5534412264823914
distance 1 is tensor(141.1021, device='cuda:0')
distance 2 is tensor(10.1389, device='cuda:0')
benign distance is  tensor(10.1389, device='cuda:0')
norm1 res is  tensor(0.1409, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.45368045568466187
distance 1 is tensor(130.9924, device='cuda:0')
distance 2 is tensor(9.4203, device='cuda:0')
benign distance is  tensor(9.4203, device='cuda:0')
norm1 res is  tensor(0.1300, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(149.1339, device='cuda:0')
distance 2 is tensor(10.4999, device='cuda:0')
compute distance is  tensor(10.4999, device='cuda:0')
compute norm is  tensor(51.8752, device='cuda:0')
distance 1 is tensor(146.5156, device='cuda:0')
distance 2 is tensor(10.4252, device='cuda:0')
compute distance is  tensor(10.4252, device='cuda:0')
compute norm is  tensor(51.8036, device='cuda:0')
distance 1 is tensor(152.9271, device='cuda:0')
distance 2 is tensor(10.9974, device='cuda:0')
compute distance is  tensor(10.9974, device='cuda:0')
compute norm is  tensor(51.9073, device='cuda:0')
distance 1 is tensor(149.8521, device='cuda:0')
distance 2 is tensor(10.7367, device='cuda:0')
compute distance is  tensor(10.7367, device='cuda:0')
compute norm is  tensor(51.9433, device='cuda:0')
distance 1 is tensor(147.1067, device='cuda:0')
distance 2 is tensor(10.5775, device='cuda:0')
compute distance is  tensor(10.5775, device='cuda:0')
compute norm is  tensor(51.8727, device='cuda:0')
distance 1 is tensor(164.5147, device='cuda:0')
distance 2 is tensor(11.8040, device='cuda:0')
compute distance is  tensor(11.8040, device='cuda:0')
compute norm is  tensor(52.3566, device='cuda:0')
distance 1 is tensor(144.6193, device='cuda:0')
distance 2 is tensor(10.6125, device='cuda:0')
compute distance is  tensor(10.6125, device='cuda:0')
compute norm is  tensor(51.8561, device='cuda:0')
distance 1 is tensor(150.4692, device='cuda:0')
distance 2 is tensor(10.6847, device='cuda:0')
compute distance is  tensor(10.6847, device='cuda:0')
compute norm is  tensor(52.0335, device='cuda:0')
distance 1 is tensor(155.8901, device='cuda:0')
distance 2 is tensor(11.2060, device='cuda:0')
compute distance is  tensor(11.2060, device='cuda:0')
compute norm is  tensor(52.1491, device='cuda:0')
distance 1 is tensor(151.0281, device='cuda:0')
distance 2 is tensor(10.7334, device='cuda:0')
compute distance is  tensor(10.7334, device='cuda:0')
compute norm is  tensor(52.0241, device='cuda:0')
distance 1 is tensor(156.6435, device='cuda:0')
distance 2 is tensor(11.1091, device='cuda:0')
compute distance is  tensor(11.1091, device='cuda:0')
compute norm is  tensor(52.2046, device='cuda:0')
distance 1 is tensor(127.5872, device='cuda:0')
distance 2 is tensor(9.2301, device='cuda:0')
compute distance is  tensor(9.2301, device='cuda:0')
compute norm is  tensor(51.6407, device='cuda:0')
distance Threshold  is  tensor(11.8040, device='cuda:0')
distance 1 is tensor(1009142.0625, device='cuda:0')
distance 2 is tensor(73613.7500, device='cuda:0')
________________________________
test distance is  tensor(73613.7500, device='cuda:0')
test similarity is  tensor(0.1975, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.81896954468434e+17
test entropy is  0.0
________________________________
cal ratio is  0.01139663850559334
distance 1 is tensor(11500.8330, device='cuda:0')
distance 2 is tensor(838.9493, device='cuda:0')
cal_distance is  tensor(838.9493, device='cuda:0')
cal ratio is  0.10675504344296942
distance 1 is tensor(1227.7771, device='cuda:0')
distance 2 is tensor(89.5621, device='cuda:0')
cal_distance is  tensor(89.5621, device='cuda:0')
cal ratio is  0.32673391561460835
distance 1 is tensor(401.1605, device='cuda:0')
distance 2 is tensor(29.2630, device='cuda:0')
cal_distance is  tensor(29.2630, device='cuda:0')
cal ratio is  0.5716064369704463
distance 1 is tensor(229.3085, device='cuda:0')
distance 2 is tensor(16.7269, device='cuda:0')
cal_distance is  tensor(16.7269, device='cuda:0')
cal ratio is  0.7560465665167762
distance 1 is tensor(173.3694, device='cuda:0')
distance 2 is tensor(12.6463, device='cuda:0')
cal_distance is  tensor(12.6463, device='cuda:0')
cal ratio is  0.8695093146999362
distance 1 is tensor(150.7471, device='cuda:0')
distance 2 is tensor(10.9961, device='cuda:0')
cal_distance is  tensor(10.9961, device='cuda:0')
distance 1 is tensor(150.7471, device='cuda:0')
distance 2 is tensor(10.9961, device='cuda:0')
________________________________
test distance is  tensor(10.9961, device='cuda:0')
test similarity is  tensor(0.9587, device='cuda:0')
test acc is  0.8557166668229897
test loss is 34.33696474551138
test entropy is  0.03534522980028616
________________________________
distance 1 is tensor(150.7471, device='cuda:0')
distance 2 is tensor(10.9961, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.03676065058229731
avg test loss is  34.11554819078588
avg accuracy is  0.856950000156323
solo acc is  0.3381833334896736
compute similarity  is  tensor(0.9587, device='cuda:0')
compute_distance is  tensor(10.9961, device='cuda:0')
compute_norm is  tensor(54.7169, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(143.6116, device='cuda:0')
distance 2 is tensor(12.1906, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9507279857389455
avg test loss is  1.4184873696329243
avg accuracy is  0.8468000001563235
solo acc is  0.3087500001563397
compute similarity  is  tensor(0.9583, device='cuda:0')
compute_distance is  tensor(12.1906, device='cuda:0')
compute_norm is  tensor(54.1604, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.2686, device='cuda:0')
distance 2 is tensor(12.3512, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9126878467831276
avg test loss is  1.4993850877290087
avg accuracy is  0.8436166668229903
solo acc is  0.25056666682300494
compute similarity  is  tensor(0.9581, device='cuda:0')
compute_distance is  tensor(12.3512, device='cuda:0')
compute_norm is  tensor(53.8979, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.9288, device='cuda:0')
distance 2 is tensor(12.4578, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9008057624546449
avg test loss is  1.4730252139349735
avg accuracy is  0.8421166668229902
solo acc is  0.24713333348967156
compute similarity  is  tensor(0.9579, device='cuda:0')
compute_distance is  tensor(12.4578, device='cuda:0')
compute_norm is  tensor(53.6413, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.5706, device='cuda:0')
distance 2 is tensor(12.5392, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8928790029559308
avg test loss is  1.4654157175692415
avg accuracy is  0.8410666668229902
solo acc is  0.24083333348967131
compute similarity  is  tensor(0.9577, device='cuda:0')
compute_distance is  tensor(12.5392, device='cuda:0')
compute_norm is  tensor(53.3902, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.2352, device='cuda:0')
distance 2 is tensor(12.6128, device='cuda:0')
________________________________
test distance is  tensor(12.6128, device='cuda:0')
test similarity is  tensor(0.9576, device='cuda:0')
test acc is  0.8429833334896569
test loss is 1.4527868007037685
test entropy is  0.8938236728405902
________________________________
cal ratio is  0.8706626985388548
distance 1 is tensor(127.3223, device='cuda:0')
distance 2 is tensor(10.9815, device='cuda:0')
cal_distance is  tensor(10.9815, device='cuda:0')
distance 1 is tensor(127.3223, device='cuda:0')
distance 2 is tensor(10.9815, device='cuda:0')
________________________________
test distance is  tensor(10.9815, device='cuda:0')
test similarity is  tensor(0.9671, device='cuda:0')
test acc is  0.8587666668229896
test loss is 1.0604148467085255
test entropy is  1.0673966654963585
________________________________
distance 1 is tensor(127.3223, device='cuda:0')
distance 2 is tensor(10.9815, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0655296378171266
avg test loss is  1.0613408866467506
avg accuracy is  0.8600500001563229
solo acc is  0.495400000156342
compute similarity  is  tensor(0.9671, device='cuda:0')
compute_distance is  tensor(10.9815, device='cuda:0')
compute_norm is  tensor(52.7671, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.4430, device='cuda:0')
distance 2 is tensor(11.2518, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8723815396142158
avg test loss is  1.4460874253244542
avg accuracy is  0.8519833334896566
solo acc is  0.24225000015633802
compute similarity  is  tensor(0.9666, device='cuda:0')
compute_distance is  tensor(11.2518, device='cuda:0')
compute_norm is  tensor(52.5268, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.6293, device='cuda:0')
distance 2 is tensor(11.3640, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8829651210608005
avg test loss is  1.4253983770860539
avg accuracy is  0.8527666668229898
solo acc is  0.24121666682300466
compute similarity  is  tensor(0.9663, device='cuda:0')
compute_distance is  tensor(11.3640, device='cuda:0')
compute_norm is  tensor(52.2815, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.6887, device='cuda:0')
distance 2 is tensor(11.4537, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8731550538082367
avg test loss is  1.4172671939264228
avg accuracy is  0.8537166668229899
solo acc is  0.24280000015633804
compute similarity  is  tensor(0.9662, device='cuda:0')
compute_distance is  tensor(11.4537, device='cuda:0')
compute_norm is  tensor(52.0384, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.7653, device='cuda:0')
distance 2 is tensor(11.5433, device='cuda:0')
exit early
distance 1 is tensor(132.7653, device='cuda:0')
distance 2 is tensor(11.5433, device='cuda:0')
________________________________
test distance is  tensor(11.5433, device='cuda:0')
test similarity is  tensor(0.9660, device='cuda:0')
test acc is  0.8549333334896564
test loss is 1.4080961813042159
test entropy is  0.8676814192266606
________________________________
distance 1 is tensor(132.7653, device='cuda:0')
distance 2 is tensor(11.5433, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8679533239239569
avg test loss is  1.4090224734501544
avg accuracy is  0.856000000156323
solo acc is  0.23450000015633773
compute similarity  is  tensor(0.9660, device='cuda:0')
compute_distance is  tensor(11.5433, device='cuda:0')
compute_norm is  tensor(51.7981, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.8291, device='cuda:0')
distance 2 is tensor(11.6250, device='cuda:0')
exit early
distance 1 is tensor(133.8291, device='cuda:0')
distance 2 is tensor(11.6250, device='cuda:0')
________________________________
test distance is  tensor(11.6250, device='cuda:0')
test similarity is  tensor(0.9658, device='cuda:0')
test acc is  0.8561166668229898
test loss is 1.4040872347888662
test entropy is  0.8661908871456504
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2844032049179077
mal norm is  tensor(6.2751, device='cuda:0')
distance 1 is tensor(133.8291, device='cuda:0')
distance 2 is tensor(11.6250, device='cuda:0')
mal distance is  tensor(11.6250, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1833, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(441.5812, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.6104, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.8153e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(483.4301, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.5840, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.6877, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.3021, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(440.9316, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.8871, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5132, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.4084, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.0517, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.4610, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.9214, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.9259, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.8093, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.6841e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.6060, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.3873, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
len accept list 6
len all weights is 6
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 91.32% 

Test Accuracy: 89.06% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
 benign loss is  0.22858986258506775
distance 1 is tensor(112.9517, device='cuda:0')
distance 2 is tensor(8.2840, device='cuda:0')
benign distance is  tensor(8.2840, device='cuda:0')
norm1 res is  tensor(0.1155, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8413375616073608
distance 1 is tensor(132.2308, device='cuda:0')
distance 2 is tensor(9.5127, device='cuda:0')
benign distance is  tensor(9.5127, device='cuda:0')
norm1 res is  tensor(0.1349, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.046707842499017715
distance 1 is tensor(125.1815, device='cuda:0')
distance 2 is tensor(8.9228, device='cuda:0')
benign distance is  tensor(8.9228, device='cuda:0')
norm1 res is  tensor(0.1248, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5020912885665894
distance 1 is tensor(143.6893, device='cuda:0')
distance 2 is tensor(10.3731, device='cuda:0')
benign distance is  tensor(10.3731, device='cuda:0')
norm1 res is  tensor(0.1459, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0297054052352905
distance 1 is tensor(138.1048, device='cuda:0')
distance 2 is tensor(9.9655, device='cuda:0')
benign distance is  tensor(9.9655, device='cuda:0')
norm1 res is  tensor(0.1435, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.203303724527359
distance 1 is tensor(140.8095, device='cuda:0')
distance 2 is tensor(10.0722, device='cuda:0')
benign distance is  tensor(10.0722, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.43354931473731995
distance 1 is tensor(112.2874, device='cuda:0')
distance 2 is tensor(8.0486, device='cuda:0')
benign distance is  tensor(8.0486, device='cuda:0')
norm1 res is  tensor(0.1119, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2904525697231293
distance 1 is tensor(146.6602, device='cuda:0')
distance 2 is tensor(10.4789, device='cuda:0')
benign distance is  tensor(10.4789, device='cuda:0')
norm1 res is  tensor(0.1492, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.27263325452804565
distance 1 is tensor(147.4633, device='cuda:0')
distance 2 is tensor(10.4251, device='cuda:0')
benign distance is  tensor(10.4251, device='cuda:0')
norm1 res is  tensor(0.1487, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.3160686492919922
distance 1 is tensor(141.1692, device='cuda:0')
distance 2 is tensor(10.1679, device='cuda:0')
benign distance is  tensor(10.1679, device='cuda:0')
norm1 res is  tensor(0.1447, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6637524366378784
distance 1 is tensor(142.8183, device='cuda:0')
distance 2 is tensor(10.2053, device='cuda:0')
benign distance is  tensor(10.2053, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.4815547466278076
distance 1 is tensor(144.8721, device='cuda:0')
distance 2 is tensor(10.3800, device='cuda:0')
benign distance is  tensor(10.3800, device='cuda:0')
norm1 res is  tensor(0.1450, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.39828214049339294
distance 1 is tensor(134.8394, device='cuda:0')
distance 2 is tensor(9.8735, device='cuda:0')
benign distance is  tensor(9.8735, device='cuda:0')
norm1 res is  tensor(0.1375, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.05551527813076973
distance 1 is tensor(141.9755, device='cuda:0')
distance 2 is tensor(10.1885, device='cuda:0')
benign distance is  tensor(10.1885, device='cuda:0')
norm1 res is  tensor(0.1451, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.049212437123060226
distance 1 is tensor(130.8224, device='cuda:0')
distance 2 is tensor(9.4461, device='cuda:0')
benign distance is  tensor(9.4461, device='cuda:0')
norm1 res is  tensor(0.1357, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.3613695800304413
distance 1 is tensor(157.2848, device='cuda:0')
distance 2 is tensor(11.0833, device='cuda:0')
benign distance is  tensor(11.0833, device='cuda:0')
norm1 res is  tensor(0.1578, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(173.3205, device='cuda:0')
distance 2 is tensor(12.4552, device='cuda:0')
compute distance is  tensor(12.4552, device='cuda:0')
compute norm is  tensor(52.6753, device='cuda:0')
distance 1 is tensor(181.3056, device='cuda:0')
distance 2 is tensor(12.9850, device='cuda:0')
compute distance is  tensor(12.9850, device='cuda:0')
compute norm is  tensor(52.7554, device='cuda:0')
distance 1 is tensor(176.6870, device='cuda:0')
distance 2 is tensor(12.5788, device='cuda:0')
compute distance is  tensor(12.5788, device='cuda:0')
compute norm is  tensor(52.6386, device='cuda:0')
distance 1 is tensor(186.9568, device='cuda:0')
distance 2 is tensor(13.5588, device='cuda:0')
compute distance is  tensor(13.5588, device='cuda:0')
compute norm is  tensor(53.1503, device='cuda:0')
distance 1 is tensor(173.8121, device='cuda:0')
distance 2 is tensor(12.5858, device='cuda:0')
compute distance is  tensor(12.5858, device='cuda:0')
compute norm is  tensor(52.8057, device='cuda:0')
distance 1 is tensor(185.2216, device='cuda:0')
distance 2 is tensor(13.1437, device='cuda:0')
compute distance is  tensor(13.1437, device='cuda:0')
compute norm is  tensor(52.9984, device='cuda:0')
distance 1 is tensor(174.6112, device='cuda:0')
distance 2 is tensor(12.7649, device='cuda:0')
compute distance is  tensor(12.7649, device='cuda:0')
compute norm is  tensor(52.8844, device='cuda:0')
distance 1 is tensor(179.5059, device='cuda:0')
distance 2 is tensor(12.9284, device='cuda:0')
compute distance is  tensor(12.9284, device='cuda:0')
compute norm is  tensor(52.8735, device='cuda:0')
distance 1 is tensor(174.5568, device='cuda:0')
distance 2 is tensor(12.4746, device='cuda:0')
compute distance is  tensor(12.4746, device='cuda:0')
compute norm is  tensor(52.9278, device='cuda:0')
distance 1 is tensor(174.3544, device='cuda:0')
distance 2 is tensor(12.6050, device='cuda:0')
compute distance is  tensor(12.6050, device='cuda:0')
compute norm is  tensor(52.8450, device='cuda:0')
distance 1 is tensor(177.7310, device='cuda:0')
distance 2 is tensor(12.6876, device='cuda:0')
compute distance is  tensor(12.6876, device='cuda:0')
compute norm is  tensor(52.8299, device='cuda:0')
distance 1 is tensor(190.8363, device='cuda:0')
distance 2 is tensor(13.7103, device='cuda:0')
compute distance is  tensor(13.7103, device='cuda:0')
compute norm is  tensor(53.2861, device='cuda:0')
distance Threshold  is  tensor(13.7103, device='cuda:0')
distance 1 is tensor(1009141.7500, device='cuda:0')
distance 2 is tensor(73613.8516, device='cuda:0')
________________________________
test distance is  tensor(73613.8516, device='cuda:0')
test similarity is  tensor(0.1939, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.824049582916709e+17
test entropy is  0.0
________________________________
cal ratio is  0.012282497597293239
distance 1 is tensor(12394.7871, device='cuda:0')
distance 2 is tensor(904.1620, device='cuda:0')
cal_distance is  tensor(904.1620, device='cuda:0')
cal ratio is  0.11082642621067178
distance 1 is tensor(1373.6752, device='cuda:0')
distance 2 is tensor(100.2050, device='cuda:0')
cal_distance is  tensor(100.2050, device='cuda:0')
cal ratio is  0.33290602820498344
distance 1 is tensor(457.3088, device='cuda:0')
distance 2 is tensor(33.3589, device='cuda:0')
cal_distance is  tensor(33.3589, device='cuda:0')
cal ratio is  0.5769800720946942
distance 1 is tensor(263.8606, device='cuda:0')
distance 2 is tensor(19.2474, device='cuda:0')
cal_distance is  tensor(19.2474, device='cuda:0')
cal ratio is  0.7595921206022698
distance 1 is tensor(200.4279, device='cuda:0')
distance 2 is tensor(14.6202, device='cuda:0')
cal_distance is  tensor(14.6202, device='cuda:0')
cal ratio is  0.871545763302992
distance 1 is tensor(174.6828, device='cuda:0')
distance 2 is tensor(12.7422, device='cuda:0')
cal_distance is  tensor(12.7422, device='cuda:0')
distance 1 is tensor(174.6828, device='cuda:0')
distance 2 is tensor(12.7422, device='cuda:0')
________________________________
test distance is  tensor(12.7422, device='cuda:0')
test similarity is  tensor(0.9474, device='cuda:0')
test acc is  0.831550000156324
test loss is 78.05689027619515
test entropy is  0.02089561266892561
________________________________
distance 1 is tensor(174.6828, device='cuda:0')
distance 2 is tensor(12.7422, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.020359091756491293
avg test loss is  78.42164806211427
avg accuracy is  0.8311333334896572
solo acc is  0.2332500001563377
compute similarity  is  tensor(0.9474, device='cuda:0')
compute_distance is  tensor(12.7422, device='cuda:0')
compute_norm is  tensor(55.9882, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(164.5254, device='cuda:0')
distance 2 is tensor(13.8786, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9566492945400636
avg test loss is  1.4453146202223641
avg accuracy is  0.8181833334896579
solo acc is  0.3024166668230063
compute similarity  is  tensor(0.9480, device='cuda:0')
compute_distance is  tensor(13.8786, device='cuda:0')
compute_norm is  tensor(55.5065, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(164.9867, device='cuda:0')
distance 2 is tensor(14.0294, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9117076300990099
avg test loss is  1.529234314905301
avg accuracy is  0.8134500001563248
solo acc is  0.24661666682300487
compute similarity  is  tensor(0.9477, device='cuda:0')
compute_distance is  tensor(14.0294, device='cuda:0')
compute_norm is  tensor(55.2302, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(165.4205, device='cuda:0')
distance 2 is tensor(14.1160, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.9026300116007262
avg test loss is  1.5025233055736973
avg accuracy is  0.8178666668229914
solo acc is  0.24373333348967144
compute similarity  is  tensor(0.9475, device='cuda:0')
compute_distance is  tensor(14.1160, device='cuda:0')
compute_norm is  tensor(54.9642, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(165.8939, device='cuda:0')
distance 2 is tensor(14.1908, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8945469929338264
avg test loss is  1.4907493938261003
avg accuracy is  0.8155000001563246
solo acc is  0.23885000015633792
compute similarity  is  tensor(0.9473, device='cuda:0')
compute_distance is  tensor(14.1908, device='cuda:0')
compute_norm is  tensor(54.7031, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(166.4145, device='cuda:0')
distance 2 is tensor(14.2554, device='cuda:0')
________________________________
test distance is  tensor(14.2554, device='cuda:0')
test similarity is  tensor(0.9471, device='cuda:0')
test acc is  0.8157000001563247
test loss is 1.472321570046675
test entropy is  0.8863763396165518
________________________________
cal ratio is  0.8826271061636465
distance 1 is tensor(146.8827, device='cuda:0')
distance 2 is tensor(12.5822, device='cuda:0')
cal_distance is  tensor(12.5822, device='cuda:0')
distance 1 is tensor(146.8827, device='cuda:0')
distance 2 is tensor(12.5822, device='cuda:0')
________________________________
test distance is  tensor(12.5822, device='cuda:0')
test similarity is  tensor(0.9578, device='cuda:0')
test acc is  0.8355833334896573
test loss is 1.109874040206104
test entropy is  1.0692238769551585
________________________________
distance 1 is tensor(146.8827, device='cuda:0')
distance 2 is tensor(12.5822, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0732147589421221
avg test loss is  1.1151481384534572
avg accuracy is  0.8371166668229905
solo acc is  0.4554166668230084
compute similarity  is  tensor(0.9578, device='cuda:0')
compute_distance is  tensor(12.5822, device='cuda:0')
compute_norm is  tensor(53.9844, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.6174, device='cuda:0')
distance 2 is tensor(12.8150, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8895068328772018
avg test loss is  1.4568648663665187
avg accuracy is  0.8282500001563242
solo acc is  0.23690000015633778
compute similarity  is  tensor(0.9572, device='cuda:0')
compute_distance is  tensor(12.8150, device='cuda:0')
compute_norm is  tensor(53.7362, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.6490, device='cuda:0')
distance 2 is tensor(12.9097, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8842350622611259
avg test loss is  1.4404268166912135
avg accuracy is  0.8295000001563241
solo acc is  0.23771666682300452
compute similarity  is  tensor(0.9570, device='cuda:0')
compute_distance is  tensor(12.9097, device='cuda:0')
compute_norm is  tensor(53.4823, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.5769, device='cuda:0')
distance 2 is tensor(12.9930, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8786599514072638
avg test loss is  1.4289993572590955
avg accuracy is  0.8285833334896575
solo acc is  0.23618333348967113
compute similarity  is  tensor(0.9568, device='cuda:0')
compute_distance is  tensor(12.9930, device='cuda:0')
compute_norm is  tensor(53.2328, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.4847, device='cuda:0')
distance 2 is tensor(13.0709, device='cuda:0')
exit early
distance 1 is tensor(151.4847, device='cuda:0')
distance 2 is tensor(13.0709, device='cuda:0')
________________________________
test distance is  tensor(13.0709, device='cuda:0')
test similarity is  tensor(0.9566, device='cuda:0')
test acc is  0.8301166668229908
test loss is 1.4383227093133337
test entropy is  0.8673609504694624
________________________________
distance 1 is tensor(151.4847, device='cuda:0')
distance 2 is tensor(13.0709, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8680529510542783
avg test loss is  1.440177607002543
avg accuracy is  0.8321333334896575
solo acc is  0.22665000015633754
compute similarity  is  tensor(0.9566, device='cuda:0')
compute_distance is  tensor(13.0709, device='cuda:0')
compute_norm is  tensor(52.9847, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.3918, device='cuda:0')
distance 2 is tensor(13.1416, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8622667683975529
avg test loss is  1.420833771798148
avg accuracy is  0.831500000156324
solo acc is  0.23038333348967094
compute similarity  is  tensor(0.9565, device='cuda:0')
compute_distance is  tensor(13.1416, device='cuda:0')
compute_norm is  tensor(52.7400, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.2687, device='cuda:0')
distance 2 is tensor(13.2059, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8627119797633401
avg test loss is  1.403753993861965
avg accuracy is  0.8329000001563239
solo acc is  0.23301666682300437
compute similarity  is  tensor(0.9563, device='cuda:0')
compute_distance is  tensor(13.2059, device='cuda:0')
compute_norm is  tensor(52.4983, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.2219, device='cuda:0')
distance 2 is tensor(13.2728, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8613987356614965
avg test loss is  1.395341746969772
avg accuracy is  0.8356333334896572
solo acc is  0.22978333348967092
compute similarity  is  tensor(0.9562, device='cuda:0')
compute_distance is  tensor(13.2728, device='cuda:0')
compute_norm is  tensor(52.2581, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.1699, device='cuda:0')
distance 2 is tensor(13.3397, device='cuda:0')
exit early
distance 1 is tensor(155.1699, device='cuda:0')
distance 2 is tensor(13.3397, device='cuda:0')
________________________________
test distance is  tensor(13.3397, device='cuda:0')
test similarity is  tensor(0.9560, device='cuda:0')
test acc is  0.833400000156324
test loss is 1.3872049064524392
test entropy is  0.8615294046747659
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.317199945449829
mal norm is  tensor(7.2056, device='cuda:0')
distance 1 is tensor(155.1699, device='cuda:0')
distance 2 is tensor(13.3397, device='cuda:0')
mal distance is  tensor(13.3397, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1197, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(456.3560, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.9755, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7905e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.9008, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.6490, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.0514e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.9540, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.5384, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.7569e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(438.1545, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.3154, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.5646, device='cuda:0')
c is  tensor(0.0129, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9014e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7957, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.8395, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.3720, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.5819, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.2906, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.7230, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.7457e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.5792, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.9988e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.1235, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 6
len all weights is 6
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 91.42% 

Test Accuracy: 89.20% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
 benign loss is  1.019911289215088
distance 1 is tensor(108.5618, device='cuda:0')
distance 2 is tensor(7.8562, device='cuda:0')
benign distance is  tensor(7.8562, device='cuda:0')
norm1 res is  tensor(0.1137, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6610547304153442
distance 1 is tensor(137.9086, device='cuda:0')
distance 2 is tensor(9.7945, device='cuda:0')
benign distance is  tensor(9.7945, device='cuda:0')
norm1 res is  tensor(0.1387, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.0693245381116867
distance 1 is tensor(120.6451, device='cuda:0')
distance 2 is tensor(8.8671, device='cuda:0')
benign distance is  tensor(8.8671, device='cuda:0')
norm1 res is  tensor(0.1280, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6066042184829712
distance 1 is tensor(139.3024, device='cuda:0')
distance 2 is tensor(9.9404, device='cuda:0')
benign distance is  tensor(9.9404, device='cuda:0')
norm1 res is  tensor(0.1387, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.4303319454193115
distance 1 is tensor(153.2694, device='cuda:0')
distance 2 is tensor(10.9004, device='cuda:0')
benign distance is  tensor(10.9004, device='cuda:0')
norm1 res is  tensor(0.1533, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8418288230895996
distance 1 is tensor(162.6638, device='cuda:0')
distance 2 is tensor(11.6088, device='cuda:0')
benign distance is  tensor(11.6088, device='cuda:0')
norm1 res is  tensor(0.1687, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.08205612748861313
distance 1 is tensor(133.8410, device='cuda:0')
distance 2 is tensor(9.5239, device='cuda:0')
benign distance is  tensor(9.5239, device='cuda:0')
norm1 res is  tensor(0.1337, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.43419402837753296
distance 1 is tensor(138.6972, device='cuda:0')
distance 2 is tensor(9.8191, device='cuda:0')
benign distance is  tensor(9.8191, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.4834497570991516
distance 1 is tensor(145.8773, device='cuda:0')
distance 2 is tensor(10.3951, device='cuda:0')
benign distance is  tensor(10.3951, device='cuda:0')
norm1 res is  tensor(0.1476, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.40052565932273865
distance 1 is tensor(157.1803, device='cuda:0')
distance 2 is tensor(11.2385, device='cuda:0')
benign distance is  tensor(11.2385, device='cuda:0')
norm1 res is  tensor(0.1573, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.4025418758392334
distance 1 is tensor(151.0888, device='cuda:0')
distance 2 is tensor(10.8979, device='cuda:0')
benign distance is  tensor(10.8979, device='cuda:0')
norm1 res is  tensor(0.1521, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.36009490489959717
distance 1 is tensor(146.3577, device='cuda:0')
distance 2 is tensor(10.5328, device='cuda:0')
benign distance is  tensor(10.5328, device='cuda:0')
norm1 res is  tensor(0.1495, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.7216335535049438
distance 1 is tensor(148.7112, device='cuda:0')
distance 2 is tensor(10.8009, device='cuda:0')
benign distance is  tensor(10.8009, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.39079657196998596
distance 1 is tensor(155.9829, device='cuda:0')
distance 2 is tensor(11.2510, device='cuda:0')
benign distance is  tensor(11.2510, device='cuda:0')
norm1 res is  tensor(0.1569, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.15072636306285858
distance 1 is tensor(159.1394, device='cuda:0')
distance 2 is tensor(11.3575, device='cuda:0')
benign distance is  tensor(11.3575, device='cuda:0')
norm1 res is  tensor(0.1605, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.4199124872684479
distance 1 is tensor(167.4093, device='cuda:0')
distance 2 is tensor(11.9013, device='cuda:0')
benign distance is  tensor(11.9013, device='cuda:0')
norm1 res is  tensor(0.1684, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(161.4323, device='cuda:0')
distance 2 is tensor(11.5738, device='cuda:0')
compute distance is  tensor(11.5738, device='cuda:0')
compute norm is  tensor(52.5950, device='cuda:0')
distance 1 is tensor(157.1828, device='cuda:0')
distance 2 is tensor(11.2057, device='cuda:0')
compute distance is  tensor(11.2057, device='cuda:0')
compute norm is  tensor(52.4126, device='cuda:0')
distance 1 is tensor(161.6025, device='cuda:0')
distance 2 is tensor(11.6147, device='cuda:0')
compute distance is  tensor(11.6147, device='cuda:0')
compute norm is  tensor(52.7105, device='cuda:0')
distance 1 is tensor(161.1122, device='cuda:0')
distance 2 is tensor(11.4371, device='cuda:0')
compute distance is  tensor(11.4371, device='cuda:0')
compute norm is  tensor(52.6574, device='cuda:0')
distance 1 is tensor(160.3267, device='cuda:0')
distance 2 is tensor(11.4199, device='cuda:0')
compute distance is  tensor(11.4199, device='cuda:0')
compute norm is  tensor(52.6524, device='cuda:0')
distance 1 is tensor(179.9919, device='cuda:0')
distance 2 is tensor(12.5582, device='cuda:0')
compute distance is  tensor(12.5582, device='cuda:0')
compute norm is  tensor(53.1216, device='cuda:0')
distance 1 is tensor(155.6602, device='cuda:0')
distance 2 is tensor(11.1515, device='cuda:0')
compute distance is  tensor(11.1515, device='cuda:0')
compute norm is  tensor(52.5527, device='cuda:0')
distance 1 is tensor(159.3873, device='cuda:0')
distance 2 is tensor(11.4844, device='cuda:0')
compute distance is  tensor(11.4844, device='cuda:0')
compute norm is  tensor(52.6468, device='cuda:0')
distance 1 is tensor(172.5163, device='cuda:0')
distance 2 is tensor(12.1677, device='cuda:0')
compute distance is  tensor(12.1677, device='cuda:0')
compute norm is  tensor(53.1029, device='cuda:0')
distance 1 is tensor(153.3609, device='cuda:0')
distance 2 is tensor(10.9874, device='cuda:0')
compute distance is  tensor(10.9874, device='cuda:0')
compute norm is  tensor(52.4564, device='cuda:0')
distance 1 is tensor(176.5040, device='cuda:0')
distance 2 is tensor(12.4576, device='cuda:0')
compute distance is  tensor(12.4576, device='cuda:0')
compute norm is  tensor(53.0718, device='cuda:0')
distance 1 is tensor(152.2005, device='cuda:0')
distance 2 is tensor(10.8197, device='cuda:0')
compute distance is  tensor(10.8197, device='cuda:0')
compute norm is  tensor(52.6735, device='cuda:0')
distance Threshold  is  tensor(12.5582, device='cuda:0')
distance 1 is tensor(1009146.1250, device='cuda:0')
distance 2 is tensor(73614.2812, device='cuda:0')
________________________________
test distance is  tensor(73614.2812, device='cuda:0')
test similarity is  tensor(0.1796, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.820008635921015e+17
test entropy is  0.0
________________________________
cal ratio is  0.011755064265088306
distance 1 is tensor(11862.5850, device='cuda:0')
distance 2 is tensor(865.3405, device='cuda:0')
cal_distance is  tensor(865.3405, device='cuda:0')
cal ratio is  0.10842078210598997
distance 1 is tensor(1286.1560, device='cuda:0')
distance 2 is tensor(93.8209, device='cuda:0')
cal_distance is  tensor(93.8209, device='cuda:0')
cal ratio is  0.32927310219747025
distance 1 is tensor(423.5006, device='cuda:0')
distance 2 is tensor(30.8927, device='cuda:0')
cal_distance is  tensor(30.8927, device='cuda:0')
cal ratio is  0.5738232274167833
distance 1 is tensor(243.0170, device='cuda:0')
distance 2 is tensor(17.7269, device='cuda:0')
cal_distance is  tensor(17.7269, device='cuda:0')
cal ratio is  0.7575112040795876
distance 1 is tensor(184.0896, device='cuda:0')
distance 2 is tensor(13.4284, device='cuda:0')
cal_distance is  tensor(13.4284, device='cuda:0')
cal ratio is  0.8703512535849697
distance 1 is tensor(160.2234, device='cuda:0')
distance 2 is tensor(11.6874, device='cuda:0')
cal_distance is  tensor(11.6874, device='cuda:0')
distance 1 is tensor(160.2234, device='cuda:0')
distance 2 is tensor(11.6874, device='cuda:0')
________________________________
test distance is  tensor(11.6874, device='cuda:0')
test similarity is  tensor(0.9549, device='cuda:0')
test acc is  0.8539666668229899
test loss is 53.87474443968425
test entropy is  0.025097730647226653
________________________________
distance 1 is tensor(160.2234, device='cuda:0')
distance 2 is tensor(11.6874, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.025448704619076785
avg test loss is  53.78622127240146
avg accuracy is  0.8513000001563232
solo acc is  0.2923666668230061
compute similarity  is  tensor(0.9549, device='cuda:0')
compute_distance is  tensor(11.6874, device='cuda:0')
compute_norm is  tensor(55.9700, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(151.8755, device='cuda:0')
distance 2 is tensor(12.9541, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9558640881769185
avg test loss is  1.449109432539706
avg accuracy is  0.8314833334896574
solo acc is  0.29916666682300613
compute similarity  is  tensor(0.9546, device='cuda:0')
compute_distance is  tensor(12.9541, device='cuda:0')
compute_norm is  tensor(55.3474, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.8687, device='cuda:0')
distance 2 is tensor(13.1343, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9157249245053923
avg test loss is  1.50695943565511
avg accuracy is  0.8273833334896575
solo acc is  0.251216666823005
compute similarity  is  tensor(0.9543, device='cuda:0')
compute_distance is  tensor(13.1343, device='cuda:0')
compute_norm is  tensor(55.0689, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.7487, device='cuda:0')
distance 2 is tensor(13.2580, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8991155799136741
avg test loss is  1.500635983084819
avg accuracy is  0.8283000001563242
solo acc is  0.2399500001563379
compute similarity  is  tensor(0.9540, device='cuda:0')
compute_distance is  tensor(13.2580, device='cuda:0')
compute_norm is  tensor(54.7993, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.5427, device='cuda:0')
distance 2 is tensor(13.3506, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.890629077135627
avg test loss is  1.4874952295695796
avg accuracy is  0.8299166668229908
solo acc is  0.23801666682300454
compute similarity  is  tensor(0.9538, device='cuda:0')
compute_distance is  tensor(13.3506, device='cuda:0')
compute_norm is  tensor(54.5368, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.3154, device='cuda:0')
distance 2 is tensor(13.4304, device='cuda:0')
________________________________
test distance is  tensor(13.4304, device='cuda:0')
test similarity is  tensor(0.9536, device='cuda:0')
test acc is  0.8295833334896574
test loss is 1.4714700044599422
test entropy is  0.8783587257363903
________________________________
cal ratio is  0.8702847406148227
distance 1 is tensor(135.1694, device='cuda:0')
distance 2 is tensor(11.6883, device='cuda:0')
cal_distance is  tensor(11.6883, device='cuda:0')
distance 1 is tensor(135.1694, device='cuda:0')
distance 2 is tensor(11.6883, device='cuda:0')
________________________________
test distance is  tensor(11.6883, device='cuda:0')
test similarity is  tensor(0.9641, device='cuda:0')
test acc is  0.84956666682299
test loss is 1.0623803237226725
test entropy is  1.052046262569773
________________________________
distance 1 is tensor(135.1694, device='cuda:0')
distance 2 is tensor(11.6883, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0546611631984142
avg test loss is  1.0646703980370624
avg accuracy is  0.8468000001563234
solo acc is  0.49643333348967533
compute similarity  is  tensor(0.9641, device='cuda:0')
compute_distance is  tensor(11.6883, device='cuda:0')
compute_norm is  tensor(53.8878, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.4762, device='cuda:0')
distance 2 is tensor(11.9744, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8844669921947187
avg test loss is  1.4513735618672645
avg accuracy is  0.8413166668229902
solo acc is  0.24210000015633798
compute similarity  is  tensor(0.9634, device='cuda:0')
compute_distance is  tensor(11.9744, device='cuda:0')
compute_norm is  tensor(53.6337, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.7818, device='cuda:0')
distance 2 is tensor(12.0958, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8763013551357204
avg test loss is  1.4417074679820014
avg accuracy is  0.8430500001563236
solo acc is  0.2368166668230045
compute similarity  is  tensor(0.9632, device='cuda:0')
compute_distance is  tensor(12.0958, device='cuda:0')
compute_norm is  tensor(53.3783, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.0386, device='cuda:0')
distance 2 is tensor(12.2008, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8644234417343953
avg test loss is  1.4335034558259603
avg accuracy is  0.8446666668229902
solo acc is  0.23408333348967109
compute similarity  is  tensor(0.9629, device='cuda:0')
compute_distance is  tensor(12.2008, device='cuda:0')
compute_norm is  tensor(53.1266, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.2330, device='cuda:0')
distance 2 is tensor(12.2986, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.866192678525758
avg test loss is  1.415226316909546
avg accuracy is  0.8454166668229901
solo acc is  0.2345500001563377
compute similarity  is  tensor(0.9627, device='cuda:0')
compute_distance is  tensor(12.2986, device='cuda:0')
compute_norm is  tensor(52.8783, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.4609, device='cuda:0')
distance 2 is tensor(12.3944, device='cuda:0')
________________________________
test distance is  tensor(12.3944, device='cuda:0')
test similarity is  tensor(0.9625, device='cuda:0')
test acc is  0.8442000001563236
test loss is 1.411604692941027
test entropy is  0.8593172201596851
________________________________
distance 1 is tensor(142.4609, device='cuda:0')
distance 2 is tensor(12.3944, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8590868840466684
avg test loss is  1.409665619894894
avg accuracy is  0.8458333334896568
solo acc is  0.2325166668230044
compute similarity  is  tensor(0.9625, device='cuda:0')
compute_distance is  tensor(12.3944, device='cuda:0')
compute_norm is  tensor(52.6331, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.6223, device='cuda:0')
distance 2 is tensor(12.4812, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8572602516044178
avg test loss is  1.4022390867855503
avg accuracy is  0.8441000001563235
solo acc is  0.2288666668230042
compute similarity  is  tensor(0.9623, device='cuda:0')
compute_distance is  tensor(12.4812, device='cuda:0')
compute_norm is  tensor(52.3898, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.8521, device='cuda:0')
distance 2 is tensor(12.5684, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8489860449391388
avg test loss is  1.3959705209427042
avg accuracy is  0.8468500001563234
solo acc is  0.22863333348967088
compute similarity  is  tensor(0.9621, device='cuda:0')
compute_distance is  tensor(12.5684, device='cuda:0')
compute_norm is  tensor(52.1487, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.0374, device='cuda:0')
distance 2 is tensor(12.6504, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8524641481035554
avg test loss is  1.377202693714516
avg accuracy is  0.8491000001563234
solo acc is  0.2276666668230042
compute similarity  is  tensor(0.9619, device='cuda:0')
compute_distance is  tensor(12.6504, device='cuda:0')
compute_norm is  tensor(51.9092, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.3004, device='cuda:0')
distance 2 is tensor(12.7389, device='cuda:0')
exit early
distance 1 is tensor(147.3004, device='cuda:0')
distance 2 is tensor(12.7389, device='cuda:0')
________________________________
test distance is  tensor(12.7389, device='cuda:0')
test similarity is  tensor(0.9617, device='cuda:0')
test acc is  0.8504833334896567
test loss is 1.378207856022727
test entropy is  0.8464397310193922
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2044074535369873
mal norm is  tensor(6.6625, device='cuda:0')
distance 1 is tensor(147.3004, device='cuda:0')
distance 2 is tensor(12.7389, device='cuda:0')
mal distance is  tensor(12.7389, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1826, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(439.1836, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.1849, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(494.8174, device='cuda:0')
c is  tensor(0.0192, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.1853e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.7553, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.8868e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.2289, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.9817, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.0305, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.6811, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.2505, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.6014, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.3435e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.1083, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.0565, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.3820, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.0139, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.7826, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.8124, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.0725e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.4845, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.1791e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.9917, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.2883, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.7912e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.6431, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.5820, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.1927, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.6161, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.7761, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7704, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.6822e-05, device='cuda:0')
accept
len accept list 21
len all weights is 21
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 87.98% 

Test Accuracy: 86.37% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2576431632041931
distance 1 is tensor(132.5973, device='cuda:0')
distance 2 is tensor(9.7320, device='cuda:0')
benign distance is  tensor(9.7320, device='cuda:0')
norm1 res is  tensor(0.1345, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6580509543418884
distance 1 is tensor(157.5133, device='cuda:0')
distance 2 is tensor(11.5153, device='cuda:0')
benign distance is  tensor(11.5153, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.2874106764793396
distance 1 is tensor(135.5397, device='cuda:0')
distance 2 is tensor(9.8851, device='cuda:0')
benign distance is  tensor(9.8851, device='cuda:0')
norm1 res is  tensor(0.1345, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5245319604873657
distance 1 is tensor(136.9191, device='cuda:0')
distance 2 is tensor(9.9523, device='cuda:0')
benign distance is  tensor(9.9523, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.4449511170387268
distance 1 is tensor(153.4318, device='cuda:0')
distance 2 is tensor(11.1218, device='cuda:0')
benign distance is  tensor(11.1218, device='cuda:0')
norm1 res is  tensor(0.1541, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.1511566638946533
distance 1 is tensor(159.2290, device='cuda:0')
distance 2 is tensor(11.6047, device='cuda:0')
benign distance is  tensor(11.6047, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.3904924988746643
distance 1 is tensor(141.9894, device='cuda:0')
distance 2 is tensor(10.3455, device='cuda:0')
benign distance is  tensor(10.3455, device='cuda:0')
norm1 res is  tensor(0.1418, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.29597121477127075
distance 1 is tensor(149.3783, device='cuda:0')
distance 2 is tensor(10.8664, device='cuda:0')
benign distance is  tensor(10.8664, device='cuda:0')
norm1 res is  tensor(0.1513, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.5443164110183716
distance 1 is tensor(160.1091, device='cuda:0')
distance 2 is tensor(11.4939, device='cuda:0')
benign distance is  tensor(11.4939, device='cuda:0')
norm1 res is  tensor(0.1590, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.13373546302318573
distance 1 is tensor(156.4762, device='cuda:0')
distance 2 is tensor(11.4918, device='cuda:0')
benign distance is  tensor(11.4918, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6148313283920288
distance 1 is tensor(169.2272, device='cuda:0')
distance 2 is tensor(12.1364, device='cuda:0')
benign distance is  tensor(12.1364, device='cuda:0')
norm1 res is  tensor(0.1634, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5228466987609863
distance 1 is tensor(158.6721, device='cuda:0')
distance 2 is tensor(11.6942, device='cuda:0')
benign distance is  tensor(11.6942, device='cuda:0')
norm1 res is  tensor(0.1570, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.4343266487121582
distance 1 is tensor(162.3264, device='cuda:0')
distance 2 is tensor(11.9080, device='cuda:0')
benign distance is  tensor(11.9080, device='cuda:0')
norm1 res is  tensor(0.1636, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.3862209916114807
distance 1 is tensor(154.3310, device='cuda:0')
distance 2 is tensor(11.4353, device='cuda:0')
benign distance is  tensor(11.4353, device='cuda:0')
norm1 res is  tensor(0.1553, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.6864503622055054
distance 1 is tensor(153.0808, device='cuda:0')
distance 2 is tensor(11.1052, device='cuda:0')
benign distance is  tensor(11.1052, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.8733901977539062
distance 1 is tensor(163.8329, device='cuda:0')
distance 2 is tensor(11.9095, device='cuda:0')
benign distance is  tensor(11.9095, device='cuda:0')
norm1 res is  tensor(0.1628, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.4562048316001892
distance 1 is tensor(166.2823, device='cuda:0')
distance 2 is tensor(12.1019, device='cuda:0')
benign distance is  tensor(12.1019, device='cuda:0')
norm1 res is  tensor(0.1639, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.5230521559715271
distance 1 is tensor(150.9858, device='cuda:0')
distance 2 is tensor(10.9080, device='cuda:0')
benign distance is  tensor(10.9080, device='cuda:0')
norm1 res is  tensor(0.1466, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.4589460790157318
distance 1 is tensor(155.9262, device='cuda:0')
distance 2 is tensor(11.3471, device='cuda:0')
benign distance is  tensor(11.3471, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.31302887201309204
distance 1 is tensor(164.6750, device='cuda:0')
distance 2 is tensor(11.7849, device='cuda:0')
benign distance is  tensor(11.7849, device='cuda:0')
norm1 res is  tensor(0.1619, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.9503599405288696
distance 1 is tensor(152.9459, device='cuda:0')
distance 2 is tensor(11.0715, device='cuda:0')
benign distance is  tensor(11.0715, device='cuda:0')
norm1 res is  tensor(0.1519, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.2641238570213318
distance 1 is tensor(158.7117, device='cuda:0')
distance 2 is tensor(11.5008, device='cuda:0')
benign distance is  tensor(11.5008, device='cuda:0')
norm1 res is  tensor(0.1558, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.6296635270118713
distance 1 is tensor(153.1698, device='cuda:0')
distance 2 is tensor(11.4510, device='cuda:0')
benign distance is  tensor(11.4510, device='cuda:0')
norm1 res is  tensor(0.1584, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.3826037347316742
distance 1 is tensor(157.9863, device='cuda:0')
distance 2 is tensor(11.3923, device='cuda:0')
benign distance is  tensor(11.3923, device='cuda:0')
norm1 res is  tensor(0.1555, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(179.7851, device='cuda:0')
distance 2 is tensor(13.1721, device='cuda:0')
compute distance is  tensor(13.1721, device='cuda:0')
compute norm is  tensor(54.7472, device='cuda:0')
distance 1 is tensor(181.1887, device='cuda:0')
distance 2 is tensor(13.4454, device='cuda:0')
compute distance is  tensor(13.4454, device='cuda:0')
compute norm is  tensor(54.7582, device='cuda:0')
distance 1 is tensor(191.5899, device='cuda:0')
distance 2 is tensor(13.9012, device='cuda:0')
compute distance is  tensor(13.9012, device='cuda:0')
compute norm is  tensor(55.0942, device='cuda:0')
distance 1 is tensor(203.0259, device='cuda:0')
distance 2 is tensor(14.6539, device='cuda:0')
compute distance is  tensor(14.6539, device='cuda:0')
compute norm is  tensor(55.4978, device='cuda:0')
distance 1 is tensor(192.9863, device='cuda:0')
distance 2 is tensor(14.3621, device='cuda:0')
compute distance is  tensor(14.3621, device='cuda:0')
compute norm is  tensor(55.4289, device='cuda:0')
distance 1 is tensor(198.6576, device='cuda:0')
distance 2 is tensor(14.4427, device='cuda:0')
compute distance is  tensor(14.4427, device='cuda:0')
compute norm is  tensor(55.1426, device='cuda:0')
distance 1 is tensor(187.1955, device='cuda:0')
distance 2 is tensor(13.8972, device='cuda:0')
compute distance is  tensor(13.8972, device='cuda:0')
compute norm is  tensor(55.0600, device='cuda:0')
distance 1 is tensor(193.7927, device='cuda:0')
distance 2 is tensor(14.2305, device='cuda:0')
compute distance is  tensor(14.2305, device='cuda:0')
compute norm is  tensor(54.9183, device='cuda:0')
distance 1 is tensor(188.2333, device='cuda:0')
distance 2 is tensor(13.8740, device='cuda:0')
compute distance is  tensor(13.8740, device='cuda:0')
compute norm is  tensor(55.1430, device='cuda:0')
distance 1 is tensor(189.2876, device='cuda:0')
distance 2 is tensor(14.0018, device='cuda:0')
compute distance is  tensor(14.0018, device='cuda:0')
compute norm is  tensor(55.0485, device='cuda:0')
distance 1 is tensor(192.8918, device='cuda:0')
distance 2 is tensor(14.3672, device='cuda:0')
compute distance is  tensor(14.3672, device='cuda:0')
compute norm is  tensor(55.3357, device='cuda:0')
distance 1 is tensor(182.6849, device='cuda:0')
distance 2 is tensor(13.3466, device='cuda:0')
compute distance is  tensor(13.3466, device='cuda:0')
compute norm is  tensor(54.9503, device='cuda:0')
distance Threshold  is  tensor(14.6539, device='cuda:0')
distance 1 is tensor(1009102., device='cuda:0')
distance 2 is tensor(73610.4844, device='cuda:0')
________________________________
test distance is  tensor(73610.4844, device='cuda:0')
test similarity is  tensor(0.2895, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.822310606886915e+17
test entropy is  0.0
________________________________
cal ratio is  0.01269840365612076
distance 1 is tensor(12813.9912, device='cuda:0')
distance 2 is tensor(934.7356, device='cuda:0')
cal_distance is  tensor(934.7356, device='cuda:0')
cal ratio is  0.11268719655502264
distance 1 is tensor(1443.9779, device='cuda:0')
distance 2 is tensor(105.3327, device='cuda:0')
cal_distance is  tensor(105.3327, device='cuda:0')
cal ratio is  0.3356891570227023
distance 1 is tensor(484.7317, device='cuda:0')
distance 2 is tensor(35.3591, device='cuda:0')
cal_distance is  tensor(35.3591, device='cuda:0')
cal ratio is  0.579386864512912
distance 1 is tensor(280.8497, device='cuda:0')
distance 2 is tensor(20.4866, device='cuda:0')
cal_distance is  tensor(20.4866, device='cuda:0')
cal ratio is  0.7611746443954842
distance 1 is tensor(213.7771, device='cuda:0')
distance 2 is tensor(15.5939, device='cuda:0')
cal_distance is  tensor(15.5939, device='cuda:0')
cal ratio is  0.8724532517093994
distance 1 is tensor(186.5113, device='cuda:0')
distance 2 is tensor(13.6049, device='cuda:0')
cal_distance is  tensor(13.6049, device='cuda:0')
distance 1 is tensor(186.5113, device='cuda:0')
distance 2 is tensor(13.6049, device='cuda:0')
________________________________
test distance is  tensor(13.6049, device='cuda:0')
test similarity is  tensor(0.9478, device='cuda:0')
test acc is  0.5428500001563423
test loss is 166.0324641555103
test entropy is  0.0013743964815832524
________________________________
distance 1 is tensor(186.5113, device='cuda:0')
distance 2 is tensor(13.6049, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0012491751410176409
avg test loss is  165.86404718264842
avg accuracy is  0.5415000001563425
solo acc is  0.1036833334896653
compute similarity  is  tensor(0.9478, device='cuda:0')
compute_distance is  tensor(13.6049, device='cuda:0')
compute_norm is  tensor(57.0294, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(168.5641, device='cuda:0')
distance 2 is tensor(13.9057, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9431246817747413
avg test loss is  1.4275728532754537
avg accuracy is  0.6903166668229979
solo acc is  0.2741166668230056
compute similarity  is  tensor(0.9505, device='cuda:0')
compute_distance is  tensor(13.9057, device='cuda:0')
compute_norm is  tensor(56.8984, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(168.5641, device='cuda:0')
distance 2 is tensor(13.9057, device='cuda:0')
________________________________
test distance is  tensor(13.9057, device='cuda:0')
test similarity is  tensor(0.9505, device='cuda:0')
test acc is  0.6912500001563312
test loss is 1.4251958600747814
test entropy is  0.9435315967114495
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4173170328140259
mal norm is  tensor(8.9854, device='cuda:0')
distance 1 is tensor(168.5641, device='cuda:0')
distance 2 is tensor(13.9057, device='cuda:0')
mal distance is  tensor(13.9057, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.2120, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.2356, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.2772, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.3274, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.3446, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.8387, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4999, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.4634, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.8207, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.5424, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
len accept list 8
len all weights is 8
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 90.92% 

Test Accuracy: 88.76% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3387244939804077
distance 1 is tensor(144.6885, device='cuda:0')
distance 2 is tensor(10.4555, device='cuda:0')
benign distance is  tensor(10.4555, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.4957532286643982
distance 1 is tensor(152.2340, device='cuda:0')
distance 2 is tensor(11.0232, device='cuda:0')
benign distance is  tensor(11.0232, device='cuda:0')
norm1 res is  tensor(0.1577, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.2154822051525116
distance 1 is tensor(122.7075, device='cuda:0')
distance 2 is tensor(8.7935, device='cuda:0')
benign distance is  tensor(8.7935, device='cuda:0')
norm1 res is  tensor(0.1223, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.4523387849330902
distance 1 is tensor(126.0496, device='cuda:0')
distance 2 is tensor(9.0240, device='cuda:0')
benign distance is  tensor(9.0240, device='cuda:0')
norm1 res is  tensor(0.1241, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5454586744308472
distance 1 is tensor(140.1499, device='cuda:0')
distance 2 is tensor(9.9793, device='cuda:0')
benign distance is  tensor(9.9793, device='cuda:0')
norm1 res is  tensor(0.1388, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6125811338424683
distance 1 is tensor(140.0018, device='cuda:0')
distance 2 is tensor(10.0808, device='cuda:0')
benign distance is  tensor(10.0808, device='cuda:0')
norm1 res is  tensor(0.1399, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.3809909224510193
distance 1 is tensor(110.7518, device='cuda:0')
distance 2 is tensor(7.9753, device='cuda:0')
benign distance is  tensor(7.9753, device='cuda:0')
norm1 res is  tensor(0.1124, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2819216251373291
distance 1 is tensor(134.0027, device='cuda:0')
distance 2 is tensor(9.5100, device='cuda:0')
benign distance is  tensor(9.5100, device='cuda:0')
norm1 res is  tensor(0.1361, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(158.3343, device='cuda:0')
distance 2 is tensor(11.3437, device='cuda:0')
compute distance is  tensor(11.3437, device='cuda:0')
compute norm is  tensor(53.0263, device='cuda:0')
distance 1 is tensor(172.8756, device='cuda:0')
distance 2 is tensor(12.5141, device='cuda:0')
compute distance is  tensor(12.5141, device='cuda:0')
compute norm is  tensor(53.2262, device='cuda:0')
distance 1 is tensor(175.5570, device='cuda:0')
distance 2 is tensor(12.5985, device='cuda:0')
compute distance is  tensor(12.5985, device='cuda:0')
compute norm is  tensor(53.4082, device='cuda:0')
distance 1 is tensor(157.8203, device='cuda:0')
distance 2 is tensor(11.4305, device='cuda:0')
compute distance is  tensor(11.4305, device='cuda:0')
compute norm is  tensor(52.9418, device='cuda:0')
distance 1 is tensor(162.5538, device='cuda:0')
distance 2 is tensor(11.7685, device='cuda:0')
compute distance is  tensor(11.7685, device='cuda:0')
compute norm is  tensor(53.2722, device='cuda:0')
distance 1 is tensor(167.3622, device='cuda:0')
distance 2 is tensor(12.1863, device='cuda:0')
compute distance is  tensor(12.1863, device='cuda:0')
compute norm is  tensor(53.3059, device='cuda:0')
distance 1 is tensor(160.4881, device='cuda:0')
distance 2 is tensor(11.7128, device='cuda:0')
compute distance is  tensor(11.7128, device='cuda:0')
compute norm is  tensor(53.1049, device='cuda:0')
distance 1 is tensor(170.9434, device='cuda:0')
distance 2 is tensor(12.2404, device='cuda:0')
compute distance is  tensor(12.2404, device='cuda:0')
compute norm is  tensor(53.3826, device='cuda:0')
distance 1 is tensor(159.8053, device='cuda:0')
distance 2 is tensor(11.6665, device='cuda:0')
compute distance is  tensor(11.6665, device='cuda:0')
compute norm is  tensor(53.1880, device='cuda:0')
distance 1 is tensor(158.2491, device='cuda:0')
distance 2 is tensor(11.4446, device='cuda:0')
compute distance is  tensor(11.4446, device='cuda:0')
compute norm is  tensor(53.1476, device='cuda:0')
distance 1 is tensor(174.7099, device='cuda:0')
distance 2 is tensor(12.5224, device='cuda:0')
compute distance is  tensor(12.5224, device='cuda:0')
compute norm is  tensor(53.4275, device='cuda:0')
distance 1 is tensor(155.3785, device='cuda:0')
distance 2 is tensor(11.1550, device='cuda:0')
compute distance is  tensor(11.1550, device='cuda:0')
compute norm is  tensor(53.0724, device='cuda:0')
distance Threshold  is  tensor(12.5985, device='cuda:0')
distance 1 is tensor(1009117.6875, device='cuda:0')
distance 2 is tensor(73611.7422, device='cuda:0')
________________________________
test distance is  tensor(73611.7422, device='cuda:0')
test similarity is  tensor(0.2623, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.826161562112243e+17
test entropy is  0.0
________________________________
cal ratio is  0.011774131586841891
distance 1 is tensor(11881.4902, device='cuda:0')
distance 2 is tensor(866.7144, device='cuda:0')
cal_distance is  tensor(866.7144, device='cuda:0')
cal ratio is  0.10850866886093223
distance 1 is tensor(1289.2501, device='cuda:0')
distance 2 is tensor(94.0460, device='cuda:0')
cal_distance is  tensor(94.0460, device='cuda:0')
cal ratio is  0.32940654082448745
distance 1 is tensor(424.6914, device='cuda:0')
distance 2 is tensor(30.9794, device='cuda:0')
cal_distance is  tensor(30.9794, device='cuda:0')
cal ratio is  0.573939492965872
distance 1 is tensor(243.7497, device='cuda:0')
distance 2 is tensor(17.7803, device='cuda:0')
cal_distance is  tensor(17.7803, device='cuda:0')
cal ratio is  0.7575879367925865
distance 1 is tensor(184.6633, device='cuda:0')
distance 2 is tensor(13.4701, device='cuda:0')
cal_distance is  tensor(13.4701, device='cuda:0')
cal ratio is  0.8703952969079106
distance 1 is tensor(160.7309, device='cuda:0')
distance 2 is tensor(11.7243, device='cuda:0')
cal_distance is  tensor(11.7243, device='cuda:0')
distance 1 is tensor(160.7309, device='cuda:0')
distance 2 is tensor(11.7243, device='cuda:0')
________________________________
test distance is  tensor(11.7243, device='cuda:0')
test similarity is  tensor(0.9589, device='cuda:0')
test acc is  0.8456833334896569
test loss is 54.32378509049731
test entropy is  0.021811092647054497
________________________________
distance 1 is tensor(160.7309, device='cuda:0')
distance 2 is tensor(11.7243, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.022159645491793042
avg test loss is  54.6227543857306
avg accuracy is  0.8443333334896568
solo acc is  0.22426666682300406
compute similarity  is  tensor(0.9589, device='cuda:0')
compute_distance is  tensor(11.7243, device='cuda:0')
compute_norm is  tensor(56.6160, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(150.9084, device='cuda:0')
distance 2 is tensor(12.4831, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9305197567319565
avg test loss is  1.3704188516272156
avg accuracy is  0.8078666668229917
solo acc is  0.30305000015633954
compute similarity  is  tensor(0.9594, device='cuda:0')
compute_distance is  tensor(12.4831, device='cuda:0')
compute_norm is  tensor(56.1832, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.1259, device='cuda:0')
distance 2 is tensor(12.5782, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8820219944153768
avg test loss is  1.4672682512797781
avg accuracy is  0.8018500001563252
solo acc is  0.23801666682300454
compute similarity  is  tensor(0.9593, device='cuda:0')
compute_distance is  tensor(12.5782, device='cuda:0')
compute_norm is  tensor(55.9131, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.3724, device='cuda:0')
distance 2 is tensor(12.6293, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8802223848000265
avg test loss is  1.4485006788646235
avg accuracy is  0.799616666822992
solo acc is  0.23695000015633785
compute similarity  is  tensor(0.9592, device='cuda:0')
compute_distance is  tensor(12.6293, device='cuda:0')
compute_norm is  tensor(55.6470, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(151.3724, device='cuda:0')
distance 2 is tensor(12.6293, device='cuda:0')
________________________________
test distance is  tensor(12.6293, device='cuda:0')
test similarity is  tensor(0.9592, device='cuda:0')
test acc is  0.7954833334896588
test loss is 1.4450654353160086
test entropy is  0.8797784703118461
________________________________
cal ratio is  0.8989024413817371
distance 1 is tensor(136.0697, device='cuda:0')
distance 2 is tensor(11.3525, device='cuda:0')
cal_distance is  tensor(11.3525, device='cuda:0')
distance 1 is tensor(136.0697, device='cuda:0')
distance 2 is tensor(11.3525, device='cuda:0')
________________________________
test distance is  tensor(11.3525, device='cuda:0')
test similarity is  tensor(0.9662, device='cuda:0')
test acc is  0.8195666668229912
test loss is 1.1637914471788955
test entropy is  1.015148987266809
________________________________
distance 1 is tensor(136.0697, device='cuda:0')
distance 2 is tensor(11.3525, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0157030619410818
avg test loss is  1.160554567888093
avg accuracy is  0.8193000001563245
solo acc is  0.4065333334896745
compute similarity  is  tensor(0.9662, device='cuda:0')
compute_distance is  tensor(11.3525, device='cuda:0')
compute_norm is  tensor(55.2257, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.1145, device='cuda:0')
distance 2 is tensor(11.5130, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8770014632231137
avg test loss is  1.4363479433791724
avg accuracy is  0.8105833334896583
solo acc is  0.2319666668230043
compute similarity  is  tensor(0.9659, device='cuda:0')
compute_distance is  tensor(11.5130, device='cuda:0')
compute_norm is  tensor(54.9672, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.6288, device='cuda:0')
distance 2 is tensor(11.5719, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8696391474463538
avg test loss is  1.428153059884175
avg accuracy is  0.8114666668229916
solo acc is  0.2309000001563376
compute similarity  is  tensor(0.9658, device='cuda:0')
compute_distance is  tensor(11.5719, device='cuda:0')
compute_norm is  tensor(54.7096, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.2113, device='cuda:0')
distance 2 is tensor(11.6265, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8650845624744765
avg test loss is  1.4110466521431897
avg accuracy is  0.8123333334896583
solo acc is  0.23216666682300438
compute similarity  is  tensor(0.9657, device='cuda:0')
compute_distance is  tensor(11.6265, device='cuda:0')
compute_norm is  tensor(54.4537, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.7752, device='cuda:0')
distance 2 is tensor(11.6717, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8610550779650714
avg test loss is  1.3985637578882897
avg accuracy is  0.8133000001563248
solo acc is  0.231133333489671
compute similarity  is  tensor(0.9656, device='cuda:0')
compute_distance is  tensor(11.6717, device='cuda:0')
compute_norm is  tensor(54.2008, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.4042, device='cuda:0')
distance 2 is tensor(11.7258, device='cuda:0')
________________________________
test distance is  tensor(11.7258, device='cuda:0')
test similarity is  tensor(0.9655, device='cuda:0')
test acc is  0.8130000001563249
test loss is 1.3900827577373367
test entropy is  0.8609681682291824
________________________________
distance 1 is tensor(139.4042, device='cuda:0')
distance 2 is tensor(11.7258, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8602854175481207
avg test loss is  1.3892225241864413
avg accuracy is  0.8144333334896582
solo acc is  0.22680000015633744
compute similarity  is  tensor(0.9655, device='cuda:0')
compute_distance is  tensor(11.7258, device='cuda:0')
compute_norm is  tensor(53.9497, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.0469, device='cuda:0')
distance 2 is tensor(11.7754, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.849863117437627
avg test loss is  1.3799004425117964
avg accuracy is  0.8153833334896581
solo acc is  0.2310166668230043
compute similarity  is  tensor(0.9655, device='cuda:0')
compute_distance is  tensor(11.7754, device='cuda:0')
compute_norm is  tensor(53.7018, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.7556, device='cuda:0')
distance 2 is tensor(11.8292, device='cuda:0')
exit early
distance 1 is tensor(140.7556, device='cuda:0')
distance 2 is tensor(11.8292, device='cuda:0')
________________________________
test distance is  tensor(11.8292, device='cuda:0')
test similarity is  tensor(0.9654, device='cuda:0')
test acc is  0.8180500001563246
test loss is 1.376697385489051
test entropy is  0.8482102670395044
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.1723817586898804
mal norm is  tensor(6.6828, device='cuda:0')
distance 1 is tensor(140.7556, device='cuda:0')
distance 2 is tensor(11.8292, device='cuda:0')
mal distance is  tensor(11.8292, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1727, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.6346, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.0187, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.5317, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.4691, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(551.0408, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.4785, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.5279e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(433.4931, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.0312, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.9164e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.2802, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.0300, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.0245e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.9274, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6499e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.7593, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.8072, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.8422, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.3491, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.3336e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.8536, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.6763, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.4093, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.7309e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.0852, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.1711, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.4636e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.0685, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.6747e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.1781, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.4883e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.5237, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.7193e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.7126, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.6096e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.6344, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6630e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.2672, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.7043, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.9030, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.2822, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.3568, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.6558e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.3325, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.6025e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.8418, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.6493, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.9510, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.0674e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9294, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.0130e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.5632, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.4069, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.7582, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.6784, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.2330, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.1685, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.5824e-05, device='cuda:0')
len accept list 27
len all weights is 27
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 91.34% 

Test Accuracy: 89.34% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6603295803070068
distance 1 is tensor(122.8093, device='cuda:0')
distance 2 is tensor(8.8523, device='cuda:0')
benign distance is  tensor(8.8523, device='cuda:0')
norm1 res is  tensor(0.1244, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.48896175622940063
distance 1 is tensor(125.2495, device='cuda:0')
distance 2 is tensor(8.9855, device='cuda:0')
benign distance is  tensor(8.9855, device='cuda:0')
norm1 res is  tensor(0.1246, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6378803849220276
distance 1 is tensor(118.5228, device='cuda:0')
distance 2 is tensor(8.6295, device='cuda:0')
benign distance is  tensor(8.6295, device='cuda:0')
norm1 res is  tensor(0.1218, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.43281126022338867
distance 1 is tensor(128.2515, device='cuda:0')
distance 2 is tensor(9.0732, device='cuda:0')
benign distance is  tensor(9.0732, device='cuda:0')
norm1 res is  tensor(0.1255, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0769919157028198
distance 1 is tensor(117.3958, device='cuda:0')
distance 2 is tensor(8.3700, device='cuda:0')
benign distance is  tensor(8.3700, device='cuda:0')
norm1 res is  tensor(0.1183, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.06112539768219
distance 1 is tensor(146.3716, device='cuda:0')
distance 2 is tensor(10.3670, device='cuda:0')
benign distance is  tensor(10.3670, device='cuda:0')
norm1 res is  tensor(0.1484, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.10378855466842651
distance 1 is tensor(127.9861, device='cuda:0')
distance 2 is tensor(9.1685, device='cuda:0')
benign distance is  tensor(9.1685, device='cuda:0')
norm1 res is  tensor(0.1291, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.33520475029945374
distance 1 is tensor(129.3312, device='cuda:0')
distance 2 is tensor(9.4422, device='cuda:0')
benign distance is  tensor(9.4422, device='cuda:0')
norm1 res is  tensor(0.1375, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.5157190561294556
distance 1 is tensor(138.5077, device='cuda:0')
distance 2 is tensor(9.9052, device='cuda:0')
benign distance is  tensor(9.9052, device='cuda:0')
norm1 res is  tensor(0.1430, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.5567395687103271
distance 1 is tensor(138.7563, device='cuda:0')
distance 2 is tensor(10.0486, device='cuda:0')
benign distance is  tensor(10.0486, device='cuda:0')
norm1 res is  tensor(0.1433, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.573348879814148
distance 1 is tensor(149.1511, device='cuda:0')
distance 2 is tensor(10.6678, device='cuda:0')
benign distance is  tensor(10.6678, device='cuda:0')
norm1 res is  tensor(0.1485, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.4705375134944916
distance 1 is tensor(144.6783, device='cuda:0')
distance 2 is tensor(10.2735, device='cuda:0')
benign distance is  tensor(10.2735, device='cuda:0')
norm1 res is  tensor(0.1447, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.25036635994911194
distance 1 is tensor(132.7753, device='cuda:0')
distance 2 is tensor(9.6654, device='cuda:0')
benign distance is  tensor(9.6654, device='cuda:0')
norm1 res is  tensor(0.1370, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.19351239502429962
distance 1 is tensor(138.6610, device='cuda:0')
distance 2 is tensor(9.9971, device='cuda:0')
benign distance is  tensor(9.9971, device='cuda:0')
norm1 res is  tensor(0.1428, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.13547289371490479
distance 1 is tensor(130.6653, device='cuda:0')
distance 2 is tensor(9.4310, device='cuda:0')
benign distance is  tensor(9.4310, device='cuda:0')
norm1 res is  tensor(0.1337, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.2626993656158447
distance 1 is tensor(151.7911, device='cuda:0')
distance 2 is tensor(10.8666, device='cuda:0')
benign distance is  tensor(10.8666, device='cuda:0')
norm1 res is  tensor(0.1533, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.05289579555392265
distance 1 is tensor(147.9159, device='cuda:0')
distance 2 is tensor(10.6218, device='cuda:0')
benign distance is  tensor(10.6218, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.61385178565979
distance 1 is tensor(158.8503, device='cuda:0')
distance 2 is tensor(11.2994, device='cuda:0')
benign distance is  tensor(11.2994, device='cuda:0')
norm1 res is  tensor(0.1580, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.5554856061935425
distance 1 is tensor(136.4729, device='cuda:0')
distance 2 is tensor(10.0627, device='cuda:0')
benign distance is  tensor(10.0627, device='cuda:0')
norm1 res is  tensor(0.1376, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.2635995149612427
distance 1 is tensor(142.9906, device='cuda:0')
distance 2 is tensor(10.3744, device='cuda:0')
benign distance is  tensor(10.3744, device='cuda:0')
norm1 res is  tensor(0.1457, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.26048049330711365
distance 1 is tensor(143.1542, device='cuda:0')
distance 2 is tensor(10.2835, device='cuda:0')
benign distance is  tensor(10.2835, device='cuda:0')
norm1 res is  tensor(0.1428, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.4445123076438904
distance 1 is tensor(129.3997, device='cuda:0')
distance 2 is tensor(9.2324, device='cuda:0')
benign distance is  tensor(9.2324, device='cuda:0')
norm1 res is  tensor(0.1302, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.3560038208961487
distance 1 is tensor(140.3843, device='cuda:0')
distance 2 is tensor(10.1442, device='cuda:0')
benign distance is  tensor(10.1442, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.345287024974823
distance 1 is tensor(145.3113, device='cuda:0')
distance 2 is tensor(10.3400, device='cuda:0')
benign distance is  tensor(10.3400, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.9270209074020386
distance 1 is tensor(143.7009, device='cuda:0')
distance 2 is tensor(10.3492, device='cuda:0')
benign distance is  tensor(10.3492, device='cuda:0')
norm1 res is  tensor(0.1473, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.12029949575662613
distance 1 is tensor(143.8517, device='cuda:0')
distance 2 is tensor(10.3873, device='cuda:0')
benign distance is  tensor(10.3873, device='cuda:0')
norm1 res is  tensor(0.1454, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.7251836657524109
distance 1 is tensor(133.1085, device='cuda:0')
distance 2 is tensor(9.6845, device='cuda:0')
benign distance is  tensor(9.6845, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.10359524190425873
distance 1 is tensor(132.2513, device='cuda:0')
distance 2 is tensor(9.3887, device='cuda:0')
benign distance is  tensor(9.3887, device='cuda:0')
norm1 res is  tensor(0.1317, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  1.3245025873184204
distance 1 is tensor(142.4215, device='cuda:0')
distance 2 is tensor(10.2756, device='cuda:0')
benign distance is  tensor(10.2756, device='cuda:0')
norm1 res is  tensor(0.1468, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.2954329550266266
distance 1 is tensor(127.7953, device='cuda:0')
distance 2 is tensor(9.2826, device='cuda:0')
benign distance is  tensor(9.2826, device='cuda:0')
norm1 res is  tensor(0.1295, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.15395408868789673
distance 1 is tensor(140.0145, device='cuda:0')
distance 2 is tensor(10.1867, device='cuda:0')
benign distance is  tensor(10.1867, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.20400579273700714
distance 1 is tensor(135.3848, device='cuda:0')
distance 2 is tensor(9.5129, device='cuda:0')
benign distance is  tensor(9.5129, device='cuda:0')
norm1 res is  tensor(0.1338, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.15065032243728638
distance 1 is tensor(144.9268, device='cuda:0')
distance 2 is tensor(10.5155, device='cuda:0')
benign distance is  tensor(10.5155, device='cuda:0')
norm1 res is  tensor(0.1461, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.38426876068115234
distance 1 is tensor(141.4822, device='cuda:0')
distance 2 is tensor(10.1135, device='cuda:0')
benign distance is  tensor(10.1135, device='cuda:0')
norm1 res is  tensor(0.1428, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.1184842586517334
distance 1 is tensor(121.3136, device='cuda:0')
distance 2 is tensor(8.7442, device='cuda:0')
benign distance is  tensor(8.7442, device='cuda:0')
norm1 res is  tensor(0.1224, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.8847030401229858
distance 1 is tensor(148.0260, device='cuda:0')
distance 2 is tensor(10.6547, device='cuda:0')
benign distance is  tensor(10.6547, device='cuda:0')
norm1 res is  tensor(0.1476, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.22879822552204132
distance 1 is tensor(132.6434, device='cuda:0')
distance 2 is tensor(9.6540, device='cuda:0')
benign distance is  tensor(9.6540, device='cuda:0')
norm1 res is  tensor(0.1359, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.4887152314186096
distance 1 is tensor(147.7924, device='cuda:0')
distance 2 is tensor(10.6003, device='cuda:0')
benign distance is  tensor(10.6003, device='cuda:0')
norm1 res is  tensor(0.1481, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.38584664463996887
distance 1 is tensor(137.1142, device='cuda:0')
distance 2 is tensor(9.6890, device='cuda:0')
benign distance is  tensor(9.6890, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.4730314612388611
distance 1 is tensor(142.0069, device='cuda:0')
distance 2 is tensor(10.2311, device='cuda:0')
benign distance is  tensor(10.2311, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(149.2605, device='cuda:0')
distance 2 is tensor(10.6786, device='cuda:0')
compute distance is  tensor(10.6786, device='cuda:0')
compute norm is  tensor(52.9465, device='cuda:0')
distance 1 is tensor(141.8040, device='cuda:0')
distance 2 is tensor(10.2317, device='cuda:0')
compute distance is  tensor(10.2317, device='cuda:0')
compute norm is  tensor(52.8449, device='cuda:0')
distance 1 is tensor(150.2572, device='cuda:0')
distance 2 is tensor(10.9774, device='cuda:0')
compute distance is  tensor(10.9774, device='cuda:0')
compute norm is  tensor(53.0835, device='cuda:0')
distance 1 is tensor(153.2684, device='cuda:0')
distance 2 is tensor(11.0795, device='cuda:0')
compute distance is  tensor(11.0795, device='cuda:0')
compute norm is  tensor(52.9700, device='cuda:0')
distance 1 is tensor(143.5702, device='cuda:0')
distance 2 is tensor(10.3110, device='cuda:0')
compute distance is  tensor(10.3110, device='cuda:0')
compute norm is  tensor(52.9743, device='cuda:0')
distance 1 is tensor(153.3078, device='cuda:0')
distance 2 is tensor(10.9930, device='cuda:0')
compute distance is  tensor(10.9930, device='cuda:0')
compute norm is  tensor(53.1401, device='cuda:0')
distance 1 is tensor(149.2137, device='cuda:0')
distance 2 is tensor(10.7325, device='cuda:0')
compute distance is  tensor(10.7325, device='cuda:0')
compute norm is  tensor(52.9435, device='cuda:0')
distance 1 is tensor(148.5043, device='cuda:0')
distance 2 is tensor(10.5563, device='cuda:0')
compute distance is  tensor(10.5563, device='cuda:0')
compute norm is  tensor(53.0379, device='cuda:0')
distance 1 is tensor(152.9761, device='cuda:0')
distance 2 is tensor(10.8953, device='cuda:0')
compute distance is  tensor(10.8953, device='cuda:0')
compute norm is  tensor(53.2180, device='cuda:0')
distance 1 is tensor(147.3563, device='cuda:0')
distance 2 is tensor(10.5204, device='cuda:0')
compute distance is  tensor(10.5204, device='cuda:0')
compute norm is  tensor(53.0328, device='cuda:0')
distance 1 is tensor(160.7770, device='cuda:0')
distance 2 is tensor(11.4629, device='cuda:0')
compute distance is  tensor(11.4629, device='cuda:0')
compute norm is  tensor(53.2357, device='cuda:0')
distance 1 is tensor(129.2982, device='cuda:0')
distance 2 is tensor(9.4018, device='cuda:0')
compute distance is  tensor(9.4018, device='cuda:0')
compute norm is  tensor(52.7719, device='cuda:0')
distance Threshold  is  tensor(11.4629, device='cuda:0')
distance 1 is tensor(1009138., device='cuda:0')
distance 2 is tensor(73613.4688, device='cuda:0')
________________________________
test distance is  tensor(73613.4688, device='cuda:0')
test similarity is  tensor(0.2137, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.820528507920236e+17
test entropy is  0.0
________________________________
cal ratio is  0.011230802032200438
distance 1 is tensor(11333.4355, device='cuda:0')
distance 2 is tensor(826.7382, device='cuda:0')
cal_distance is  tensor(826.7382, device='cuda:0')
cal ratio is  0.10597548939301843
distance 1 is tensor(1201.0718, device='cuda:0')
distance 2 is tensor(87.6140, device='cuda:0')
cal_distance is  tensor(87.6140, device='cuda:0')
cal ratio is  0.32553876936772386
distance 1 is tensor(390.9995, device='cuda:0')
distance 2 is tensor(28.5217, device='cuda:0')
cal_distance is  tensor(28.5217, device='cuda:0')
cal ratio is  0.5705600347650569
distance 1 is tensor(223.0913, device='cuda:0')
distance 2 is tensor(16.2734, device='cuda:0')
cal_distance is  tensor(16.2734, device='cuda:0')
cal ratio is  0.755354218346868
distance 1 is tensor(168.5144, device='cuda:0')
distance 2 is tensor(12.2922, device='cuda:0')
cal_distance is  tensor(12.2922, device='cuda:0')
cal ratio is  0.8691111349181938
distance 1 is tensor(146.4585, device='cuda:0')
distance 2 is tensor(10.6833, device='cuda:0')
cal_distance is  tensor(10.6833, device='cuda:0')
distance 1 is tensor(146.4585, device='cuda:0')
distance 2 is tensor(10.6833, device='cuda:0')
________________________________
test distance is  tensor(10.6833, device='cuda:0')
test similarity is  tensor(0.9627, device='cuda:0')
test acc is  0.8799833334896555
test loss is 19.637163413358905
test entropy is  0.04735848547291082
________________________________
distance 1 is tensor(146.4585, device='cuda:0')
distance 2 is tensor(10.6833, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0464111041428565
avg test loss is  19.537317276000977
avg accuracy is  0.8800000001563222
solo acc is  0.4564666668230083
compute similarity  is  tensor(0.9627, device='cuda:0')
compute_distance is  tensor(10.6833, device='cuda:0')
compute_norm is  tensor(55.6676, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(139.6336, device='cuda:0')
distance 2 is tensor(11.8353, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9345455867395218
avg test loss is  1.3935832208407712
avg accuracy is  0.8443000001563234
solo acc is  0.30523333348967296
compute similarity  is  tensor(0.9621, device='cuda:0')
compute_distance is  tensor(11.8353, device='cuda:0')
compute_norm is  tensor(55.0943, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.3894, device='cuda:0')
distance 2 is tensor(11.9779, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8978139252932087
avg test loss is  1.4682311910047714
avg accuracy is  0.8393500001563237
solo acc is  0.24916666682300492
compute similarity  is  tensor(0.9619, device='cuda:0')
compute_distance is  tensor(11.9779, device='cuda:0')
compute_norm is  tensor(54.8260, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.0218, device='cuda:0')
distance 2 is tensor(12.0724, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8973315978990689
avg test loss is  1.4502894523809713
avg accuracy is  0.8367166668229905
solo acc is  0.24281666682300473
compute similarity  is  tensor(0.9617, device='cuda:0')
compute_distance is  tensor(12.0724, device='cuda:0')
compute_norm is  tensor(54.5642, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.6521, device='cuda:0')
distance 2 is tensor(12.1547, device='cuda:0')
exit early
distance 1 is tensor(141.6521, device='cuda:0')
distance 2 is tensor(12.1547, device='cuda:0')
________________________________
test distance is  tensor(12.1547, device='cuda:0')
test similarity is  tensor(0.9616, device='cuda:0')
test acc is  0.8391500001563237
test loss is 1.4529575719508028
test entropy is  0.8790517530715796
________________________________
cal ratio is  0.8740100130723151
distance 1 is tensor(123.8062, device='cuda:0')
distance 2 is tensor(10.6234, device='cuda:0')
cal_distance is  tensor(10.6234, device='cuda:0')
distance 1 is tensor(123.8062, device='cuda:0')
distance 2 is tensor(10.6234, device='cuda:0')
________________________________
test distance is  tensor(10.6234, device='cuda:0')
test similarity is  tensor(0.9700, device='cuda:0')
test acc is  0.8564833334896563
test loss is 1.0480647577659916
test entropy is  1.0583637923574143
________________________________
distance 1 is tensor(123.8062, device='cuda:0')
distance 2 is tensor(10.6234, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0586694055782961
avg test loss is  1.0461167716649549
avg accuracy is  0.855800000156323
solo acc is  0.5034333334896754
compute similarity  is  tensor(0.9700, device='cuda:0')
compute_distance is  tensor(10.6234, device='cuda:0')
compute_norm is  tensor(53.9373, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(125.7892, device='cuda:0')
distance 2 is tensor(10.8867, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8732751550069496
avg test loss is  1.430827636581494
avg accuracy is  0.8487000001563233
solo acc is  0.24385000015633812
compute similarity  is  tensor(0.9695, device='cuda:0')
compute_distance is  tensor(10.8867, device='cuda:0')
compute_norm is  tensor(53.6887, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(126.8904, device='cuda:0')
distance 2 is tensor(10.9960, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8677861809984707
avg test loss is  1.421425993254444
avg accuracy is  0.8487333334896565
solo acc is  0.2361500001563378
compute similarity  is  tensor(0.9693, device='cuda:0')
compute_distance is  tensor(10.9960, device='cuda:0')
compute_norm is  tensor(53.4368, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(127.9981, device='cuda:0')
distance 2 is tensor(11.0932, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8618031170195354
avg test loss is  1.4066832333739632
avg accuracy is  0.8496333334896566
solo acc is  0.23741666682300455
compute similarity  is  tensor(0.9691, device='cuda:0')
compute_distance is  tensor(11.0932, device='cuda:0')
compute_norm is  tensor(53.1879, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.0775, device='cuda:0')
distance 2 is tensor(11.1844, device='cuda:0')
exit early
distance 1 is tensor(129.0775, device='cuda:0')
distance 2 is tensor(11.1844, device='cuda:0')
________________________________
test distance is  tensor(11.1844, device='cuda:0')
test similarity is  tensor(0.9689, device='cuda:0')
test acc is  0.8509500001563233
test loss is 1.4041413803344596
test entropy is  0.8523578864933331
________________________________
distance 1 is tensor(129.0775, device='cuda:0')
distance 2 is tensor(11.1844, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8531483038147883
avg test loss is  1.3994018130465102
avg accuracy is  0.8515333334896565
solo acc is  0.23306666682300428
compute similarity  is  tensor(0.9689, device='cuda:0')
compute_distance is  tensor(11.1844, device='cuda:0')
compute_norm is  tensor(52.9404, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.1454, device='cuda:0')
distance 2 is tensor(11.2670, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8621904147840512
avg test loss is  1.3802722389382849
avg accuracy is  0.8528500001563232
solo acc is  0.23521666682300443
compute similarity  is  tensor(0.9687, device='cuda:0')
compute_distance is  tensor(11.2670, device='cuda:0')
compute_norm is  tensor(52.6950, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.2696, device='cuda:0')
distance 2 is tensor(11.3513, device='cuda:0')
exit early
distance 1 is tensor(131.2696, device='cuda:0')
distance 2 is tensor(11.3513, device='cuda:0')
________________________________
test distance is  tensor(11.3513, device='cuda:0')
test similarity is  tensor(0.9686, device='cuda:0')
test acc is  0.8539166668229898
test loss is 1.382750873880854
test entropy is  0.8466750830729634
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.191233515739441
mal norm is  tensor(6.1290, device='cuda:0')
distance 1 is tensor(131.2696, device='cuda:0')
distance 2 is tensor(11.3513, device='cuda:0')
mal distance is  tensor(11.3513, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1462, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(490.5582, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(494.3776, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9168e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(478.4517, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.8778, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.1317, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.8525e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.0887, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.4758, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.1943, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.9573e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.9026, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 4
len all weights is 4
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 91.15% 

Test Accuracy: 89.32% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
 benign loss is  0.11301766335964203
distance 1 is tensor(127.0852, device='cuda:0')
distance 2 is tensor(9.1241, device='cuda:0')
benign distance is  tensor(9.1241, device='cuda:0')
norm1 res is  tensor(0.1309, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6251839995384216
distance 1 is tensor(143.2857, device='cuda:0')
distance 2 is tensor(10.1122, device='cuda:0')
benign distance is  tensor(10.1122, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.09976580739021301
distance 1 is tensor(125.3667, device='cuda:0')
distance 2 is tensor(8.9112, device='cuda:0')
benign distance is  tensor(8.9112, device='cuda:0')
norm1 res is  tensor(0.1305, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.9979939460754395
distance 1 is tensor(138.5645, device='cuda:0')
distance 2 is tensor(9.8177, device='cuda:0')
benign distance is  tensor(9.8177, device='cuda:0')
norm1 res is  tensor(0.1375, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.2785566747188568
distance 1 is tensor(155.5436, device='cuda:0')
distance 2 is tensor(11.1197, device='cuda:0')
benign distance is  tensor(11.1197, device='cuda:0')
norm1 res is  tensor(0.1553, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.4636284410953522
distance 1 is tensor(162.1593, device='cuda:0')
distance 2 is tensor(11.6242, device='cuda:0')
benign distance is  tensor(11.6242, device='cuda:0')
norm1 res is  tensor(0.1649, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.02287212386727333
distance 1 is tensor(116.7198, device='cuda:0')
distance 2 is tensor(8.2478, device='cuda:0')
benign distance is  tensor(8.2478, device='cuda:0')
norm1 res is  tensor(0.1180, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.4600011706352234
distance 1 is tensor(129.2122, device='cuda:0')
distance 2 is tensor(9.1522, device='cuda:0')
benign distance is  tensor(9.1522, device='cuda:0')
norm1 res is  tensor(0.1320, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(157.1322, device='cuda:0')
distance 2 is tensor(11.2135, device='cuda:0')
compute distance is  tensor(11.2135, device='cuda:0')
compute norm is  tensor(53.5668, device='cuda:0')
distance 1 is tensor(156.5331, device='cuda:0')
distance 2 is tensor(11.1856, device='cuda:0')
compute distance is  tensor(11.1856, device='cuda:0')
compute norm is  tensor(53.4454, device='cuda:0')
distance 1 is tensor(167.5223, device='cuda:0')
distance 2 is tensor(11.8875, device='cuda:0')
compute distance is  tensor(11.8875, device='cuda:0')
compute norm is  tensor(53.7776, device='cuda:0')
distance 1 is tensor(153.4937, device='cuda:0')
distance 2 is tensor(10.9570, device='cuda:0')
compute distance is  tensor(10.9570, device='cuda:0')
compute norm is  tensor(53.3968, device='cuda:0')
distance 1 is tensor(174.3917, device='cuda:0')
distance 2 is tensor(12.5957, device='cuda:0')
compute distance is  tensor(12.5957, device='cuda:0')
compute norm is  tensor(54.0733, device='cuda:0')
distance 1 is tensor(172.7690, device='cuda:0')
distance 2 is tensor(12.3092, device='cuda:0')
compute distance is  tensor(12.3092, device='cuda:0')
compute norm is  tensor(54.1023, device='cuda:0')
distance 1 is tensor(163.3514, device='cuda:0')
distance 2 is tensor(11.7142, device='cuda:0')
compute distance is  tensor(11.7142, device='cuda:0')
compute norm is  tensor(53.8411, device='cuda:0')
distance 1 is tensor(154.9093, device='cuda:0')
distance 2 is tensor(11.0905, device='cuda:0')
compute distance is  tensor(11.0905, device='cuda:0')
compute norm is  tensor(53.6181, device='cuda:0')
distance 1 is tensor(154.1462, device='cuda:0')
distance 2 is tensor(11.0328, device='cuda:0')
compute distance is  tensor(11.0328, device='cuda:0')
compute norm is  tensor(53.6467, device='cuda:0')
distance 1 is tensor(160.3820, device='cuda:0')
distance 2 is tensor(11.4316, device='cuda:0')
compute distance is  tensor(11.4316, device='cuda:0')
compute norm is  tensor(53.6708, device='cuda:0')
distance 1 is tensor(158.7420, device='cuda:0')
distance 2 is tensor(11.2056, device='cuda:0')
compute distance is  tensor(11.2056, device='cuda:0')
compute norm is  tensor(53.7946, device='cuda:0')
distance 1 is tensor(154.7591, device='cuda:0')
distance 2 is tensor(10.9996, device='cuda:0')
compute distance is  tensor(10.9996, device='cuda:0')
compute norm is  tensor(53.6482, device='cuda:0')
distance Threshold  is  tensor(12.5957, device='cuda:0')
distance 1 is tensor(1009138.2500, device='cuda:0')
distance 2 is tensor(73613.6641, device='cuda:0')
________________________________
test distance is  tensor(73613.6641, device='cuda:0')
test similarity is  tensor(0.2017, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.823000569115078e+17
test entropy is  0.0
________________________________
cal ratio is  0.011772665388556145
distance 1 is tensor(11880.2529, device='cuda:0')
distance 2 is tensor(866.6289, device='cuda:0')
cal_distance is  tensor(866.6289, device='cuda:0')
cal ratio is  0.10850192156504146
distance 1 is tensor(1289.0355, device='cuda:0')
distance 2 is tensor(94.0309, device='cuda:0')
cal_distance is  tensor(94.0309, device='cuda:0')
cal ratio is  0.32939629937383597
distance 1 is tensor(424.6075, device='cuda:0')
distance 2 is tensor(30.9734, device='cuda:0')
cal_distance is  tensor(30.9734, device='cuda:0')
cal ratio is  0.5739305761817551
distance 1 is tensor(243.6978, device='cuda:0')
distance 2 is tensor(17.7766, device='cuda:0')
cal_distance is  tensor(17.7766, device='cuda:0')
cal ratio is  0.7575820419054484
distance 1 is tensor(184.6226, device='cuda:0')
distance 2 is tensor(13.4672, device='cuda:0')
cal_distance is  tensor(13.4672, device='cuda:0')
cal ratio is  0.8703918855714653
distance 1 is tensor(160.6947, device='cuda:0')
distance 2 is tensor(11.7218, device='cuda:0')
cal_distance is  tensor(11.7218, device='cuda:0')
distance 1 is tensor(160.6947, device='cuda:0')
distance 2 is tensor(11.7218, device='cuda:0')
________________________________
test distance is  tensor(11.7218, device='cuda:0')
test similarity is  tensor(0.9565, device='cuda:0')
test acc is  0.8592500001563229
test loss is 46.780761846855505
test entropy is  0.02848288265834396
________________________________
distance 1 is tensor(160.6947, device='cuda:0')
distance 2 is tensor(11.7218, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.027939131938919885
avg test loss is  46.82672364371164
avg accuracy is  0.8592000001563228
solo acc is  0.3256166668230067
compute similarity  is  tensor(0.9565, device='cuda:0')
compute_distance is  tensor(11.7218, device='cuda:0')
compute_norm is  tensor(56.6645, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(152.3050, device='cuda:0')
distance 2 is tensor(12.9342, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9424630430842768
avg test loss is  1.4051447588243464
avg accuracy is  0.8379666668229904
solo acc is  0.3141333334896731
compute similarity  is  tensor(0.9563, device='cuda:0')
compute_distance is  tensor(12.9342, device='cuda:0')
compute_norm is  tensor(56.0489, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.0704, device='cuda:0')
distance 2 is tensor(13.1010, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9045689901563404
avg test loss is  1.4977065758156116
avg accuracy is  0.8339666668229906
solo acc is  0.2463333334896715
compute similarity  is  tensor(0.9559, device='cuda:0')
compute_distance is  tensor(13.1010, device='cuda:0')
compute_norm is  tensor(55.7698, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.7071, device='cuda:0')
distance 2 is tensor(13.1983, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8964401583300471
avg test loss is  1.4857265775137618
avg accuracy is  0.8361666668229905
solo acc is  0.23685000015633786
compute similarity  is  tensor(0.9557, device='cuda:0')
compute_distance is  tensor(13.1983, device='cuda:0')
compute_norm is  tensor(55.4981, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.3374, device='cuda:0')
distance 2 is tensor(13.2753, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8921338629875102
avg test loss is  1.456386178541285
avg accuracy is  0.8354333334896572
solo acc is  0.24021666682300472
compute similarity  is  tensor(0.9555, device='cuda:0')
compute_distance is  tensor(13.2753, device='cuda:0')
compute_norm is  tensor(55.2333, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.0098, device='cuda:0')
distance 2 is tensor(13.3456, device='cuda:0')
________________________________
test distance is  tensor(13.3456, device='cuda:0')
test similarity is  tensor(0.9554, device='cuda:0')
test acc is  0.8386333334896571
test loss is 1.4493577812017917
test entropy is  0.8788090786064612
________________________________
cal ratio is  0.8743501937679482
distance 1 is tensor(135.5336, device='cuda:0')
distance 2 is tensor(11.6687, device='cuda:0')
cal_distance is  tensor(11.6687, device='cuda:0')
distance 1 is tensor(135.5336, device='cuda:0')
distance 2 is tensor(11.6687, device='cuda:0')
________________________________
test distance is  tensor(11.6687, device='cuda:0')
test similarity is  tensor(0.9651, device='cuda:0')
test acc is  0.8569666668229896
test loss is 1.0670187628345449
test entropy is  1.0245396386204497
________________________________
distance 1 is tensor(135.5336, device='cuda:0')
distance 2 is tensor(11.6687, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0251308119754547
avg test loss is  1.065844813770831
avg accuracy is  0.8557666668229897
solo acc is  0.4901666668230087
compute similarity  is  tensor(0.9651, device='cuda:0')
compute_distance is  tensor(11.6687, device='cuda:0')
compute_norm is  tensor(54.5790, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.4692, device='cuda:0')
distance 2 is tensor(11.9287, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8857503948308257
avg test loss is  1.4168529510498047
avg accuracy is  0.8495333334896567
solo acc is  0.2462000001563382
compute similarity  is  tensor(0.9646, device='cuda:0')
compute_distance is  tensor(11.9287, device='cuda:0')
compute_norm is  tensor(54.3223, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.6769, device='cuda:0')
distance 2 is tensor(12.0406, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8734848977787408
avg test loss is  1.422695605485424
avg accuracy is  0.8514666668229899
solo acc is  0.23598333348967113
compute similarity  is  tensor(0.9643, device='cuda:0')
compute_distance is  tensor(12.0406, device='cuda:0')
compute_norm is  tensor(54.0649, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.8010, device='cuda:0')
distance 2 is tensor(12.1344, device='cuda:0')
exit early
distance 1 is tensor(139.8010, device='cuda:0')
distance 2 is tensor(12.1344, device='cuda:0')
________________________________
test distance is  tensor(12.1344, device='cuda:0')
test similarity is  tensor(0.9641, device='cuda:0')
test acc is  0.8513833334896566
test loss is 1.420988005615755
test entropy is  0.8620555435797808
________________________________
distance 1 is tensor(139.8010, device='cuda:0')
distance 2 is tensor(12.1344, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8622053690683613
avg test loss is  1.4214259272953595
avg accuracy is  0.8516333334896565
solo acc is  0.23116666682300435
compute similarity  is  tensor(0.9641, device='cuda:0')
compute_distance is  tensor(12.1344, device='cuda:0')
compute_norm is  tensor(53.8110, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.8696, device='cuda:0')
distance 2 is tensor(12.2176, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8612089238441321
avg test loss is  1.4038909326738387
avg accuracy is  0.8530666668229899
solo acc is  0.23191666682300432
compute similarity  is  tensor(0.9639, device='cuda:0')
compute_distance is  tensor(12.2176, device='cuda:0')
compute_norm is  tensor(53.5594, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.9396, device='cuda:0')
distance 2 is tensor(12.2977, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8605062231453243
avg test loss is  1.3865862986934718
avg accuracy is  0.8542166668229898
solo acc is  0.2364500001563378
compute similarity  is  tensor(0.9637, device='cuda:0')
compute_distance is  tensor(12.2977, device='cuda:0')
compute_norm is  tensor(53.3106, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.9843, device='cuda:0')
distance 2 is tensor(12.3703, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.853431679546706
avg test loss is  1.3752342432038362
avg accuracy is  0.8564833334896563
solo acc is  0.23440000015633772
compute similarity  is  tensor(0.9636, device='cuda:0')
compute_distance is  tensor(12.3703, device='cuda:0')
compute_norm is  tensor(53.0642, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.0677, device='cuda:0')
distance 2 is tensor(12.4521, device='cuda:0')
exit early
distance 1 is tensor(144.0677, device='cuda:0')
distance 2 is tensor(12.4521, device='cuda:0')
________________________________
test distance is  tensor(12.4521, device='cuda:0')
test similarity is  tensor(0.9634, device='cuda:0')
test acc is  0.8573166668229897
test loss is 1.3760821352254098
test entropy is  0.85285012783018
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3110378980636597
mal norm is  tensor(6.6630, device='cuda:0')
distance 1 is tensor(144.0677, device='cuda:0')
distance 2 is tensor(12.4521, device='cuda:0')
mal distance is  tensor(12.4521, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1666, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.6145, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.6689, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.5284e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.4820, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.2767, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.6086, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.1846, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.9014e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(456.6135, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.9796, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.6579e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.3024, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3753e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.5234, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.8463, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.0640, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.9547, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.4319, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.7257, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.6691, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.5928e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.0287, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.1689e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.9667, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.1609e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.7510, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.7194e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.2020, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.9600, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.5176, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.5120e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.1001, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.1569, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.0026e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.8015, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.9717e-05, device='cuda:0')
accept
len accept list 12
len all weights is 12
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 91.55% 

Test Accuracy: 89.60% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
 benign loss is  1.0593416690826416
distance 1 is tensor(113.3748, device='cuda:0')
distance 2 is tensor(8.2179, device='cuda:0')
benign distance is  tensor(8.2179, device='cuda:0')
norm1 res is  tensor(0.1138, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.3402283191680908
distance 1 is tensor(123.4421, device='cuda:0')
distance 2 is tensor(8.8490, device='cuda:0')
benign distance is  tensor(8.8490, device='cuda:0')
norm1 res is  tensor(0.1264, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.23611252009868622
distance 1 is tensor(123.0583, device='cuda:0')
distance 2 is tensor(8.7455, device='cuda:0')
benign distance is  tensor(8.7455, device='cuda:0')
norm1 res is  tensor(0.1235, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.4108475148677826
distance 1 is tensor(141.8823, device='cuda:0')
distance 2 is tensor(9.9418, device='cuda:0')
benign distance is  tensor(9.9418, device='cuda:0')
norm1 res is  tensor(0.1384, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0834970474243164
distance 1 is tensor(140.9211, device='cuda:0')
distance 2 is tensor(10.1167, device='cuda:0')
benign distance is  tensor(10.1167, device='cuda:0')
norm1 res is  tensor(0.1437, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.24370074272155762
distance 1 is tensor(147.7540, device='cuda:0')
distance 2 is tensor(10.5418, device='cuda:0')
benign distance is  tensor(10.5418, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.18418142199516296
distance 1 is tensor(95.0658, device='cuda:0')
distance 2 is tensor(6.8342, device='cuda:0')
benign distance is  tensor(6.8342, device='cuda:0')
norm1 res is  tensor(0.0931, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2382996827363968
distance 1 is tensor(132.0872, device='cuda:0')
distance 2 is tensor(9.4687, device='cuda:0')
benign distance is  tensor(9.4687, device='cuda:0')
norm1 res is  tensor(0.1369, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.37805140018463135
distance 1 is tensor(153.8730, device='cuda:0')
distance 2 is tensor(10.9517, device='cuda:0')
benign distance is  tensor(10.9517, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.2423212230205536
distance 1 is tensor(138.9148, device='cuda:0')
distance 2 is tensor(9.9781, device='cuda:0')
benign distance is  tensor(9.9781, device='cuda:0')
norm1 res is  tensor(0.1402, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.48414769768714905
distance 1 is tensor(145.0879, device='cuda:0')
distance 2 is tensor(10.1727, device='cuda:0')
benign distance is  tensor(10.1727, device='cuda:0')
norm1 res is  tensor(0.1458, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.39001715183258057
distance 1 is tensor(150.9783, device='cuda:0')
distance 2 is tensor(10.8099, device='cuda:0')
benign distance is  tensor(10.8099, device='cuda:0')
norm1 res is  tensor(0.1535, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.7706918120384216
distance 1 is tensor(151.3143, device='cuda:0')
distance 2 is tensor(10.8914, device='cuda:0')
benign distance is  tensor(10.8914, device='cuda:0')
norm1 res is  tensor(0.1555, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.14220377802848816
distance 1 is tensor(133.5479, device='cuda:0')
distance 2 is tensor(9.6382, device='cuda:0')
benign distance is  tensor(9.6382, device='cuda:0')
norm1 res is  tensor(0.1347, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.13444560766220093
distance 1 is tensor(138.2511, device='cuda:0')
distance 2 is tensor(9.9578, device='cuda:0')
benign distance is  tensor(9.9578, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.3374937176704407
distance 1 is tensor(146.2635, device='cuda:0')
distance 2 is tensor(10.3542, device='cuda:0')
benign distance is  tensor(10.3542, device='cuda:0')
norm1 res is  tensor(0.1468, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.4522306025028229
distance 1 is tensor(156.5346, device='cuda:0')
distance 2 is tensor(11.0581, device='cuda:0')
benign distance is  tensor(11.0581, device='cuda:0')
norm1 res is  tensor(0.1609, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.45317625999450684
distance 1 is tensor(137.4873, device='cuda:0')
distance 2 is tensor(9.7326, device='cuda:0')
benign distance is  tensor(9.7326, device='cuda:0')
norm1 res is  tensor(0.1375, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.49465417861938477
distance 1 is tensor(159.7069, device='cuda:0')
distance 2 is tensor(11.4300, device='cuda:0')
benign distance is  tensor(11.4300, device='cuda:0')
norm1 res is  tensor(0.1627, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.7116202116012573
distance 1 is tensor(143.9535, device='cuda:0')
distance 2 is tensor(10.3082, device='cuda:0')
benign distance is  tensor(10.3082, device='cuda:0')
norm1 res is  tensor(0.1481, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.37875238060951233
distance 1 is tensor(136.2429, device='cuda:0')
distance 2 is tensor(9.7914, device='cuda:0')
benign distance is  tensor(9.7914, device='cuda:0')
norm1 res is  tensor(0.1377, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.08551827818155289
distance 1 is tensor(157.7316, device='cuda:0')
distance 2 is tensor(11.3491, device='cuda:0')
benign distance is  tensor(11.3491, device='cuda:0')
norm1 res is  tensor(0.1602, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.691356360912323
distance 1 is tensor(146.8159, device='cuda:0')
distance 2 is tensor(10.6339, device='cuda:0')
benign distance is  tensor(10.6339, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.5423170924186707
distance 1 is tensor(144.4555, device='cuda:0')
distance 2 is tensor(10.4250, device='cuda:0')
benign distance is  tensor(10.4250, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(161.1139, device='cuda:0')
distance 2 is tensor(11.4078, device='cuda:0')
compute distance is  tensor(11.4078, device='cuda:0')
compute norm is  tensor(54.3070, device='cuda:0')
distance 1 is tensor(148.7845, device='cuda:0')
distance 2 is tensor(10.6064, device='cuda:0')
compute distance is  tensor(10.6064, device='cuda:0')
compute norm is  tensor(54.0581, device='cuda:0')
distance 1 is tensor(169.4923, device='cuda:0')
distance 2 is tensor(12.0788, device='cuda:0')
compute distance is  tensor(12.0788, device='cuda:0')
compute norm is  tensor(54.3427, device='cuda:0')
distance 1 is tensor(159.0567, device='cuda:0')
distance 2 is tensor(11.2984, device='cuda:0')
compute distance is  tensor(11.2984, device='cuda:0')
compute norm is  tensor(54.1940, device='cuda:0')
distance 1 is tensor(172.2831, device='cuda:0')
distance 2 is tensor(12.2851, device='cuda:0')
compute distance is  tensor(12.2851, device='cuda:0')
compute norm is  tensor(54.4972, device='cuda:0')
distance 1 is tensor(174.3638, device='cuda:0')
distance 2 is tensor(12.5282, device='cuda:0')
compute distance is  tensor(12.5282, device='cuda:0')
compute norm is  tensor(54.6698, device='cuda:0')
distance 1 is tensor(150.5275, device='cuda:0')
distance 2 is tensor(10.6918, device='cuda:0')
compute distance is  tensor(10.6918, device='cuda:0')
compute norm is  tensor(54.0200, device='cuda:0')
distance 1 is tensor(151.5335, device='cuda:0')
distance 2 is tensor(10.8316, device='cuda:0')
compute distance is  tensor(10.8316, device='cuda:0')
compute norm is  tensor(54.0293, device='cuda:0')
distance 1 is tensor(152.4024, device='cuda:0')
distance 2 is tensor(10.8714, device='cuda:0')
compute distance is  tensor(10.8714, device='cuda:0')
compute norm is  tensor(54.2310, device='cuda:0')
distance 1 is tensor(159.0714, device='cuda:0')
distance 2 is tensor(11.2675, device='cuda:0')
compute distance is  tensor(11.2675, device='cuda:0')
compute norm is  tensor(54.2515, device='cuda:0')
distance 1 is tensor(167.4582, device='cuda:0')
distance 2 is tensor(11.8147, device='cuda:0')
compute distance is  tensor(11.8147, device='cuda:0')
compute norm is  tensor(54.5995, device='cuda:0')
distance 1 is tensor(154.3803, device='cuda:0')
distance 2 is tensor(10.9311, device='cuda:0')
compute distance is  tensor(10.9311, device='cuda:0')
compute norm is  tensor(54.1977, device='cuda:0')
distance Threshold  is  tensor(12.5282, device='cuda:0')
distance 1 is tensor(1009139.4375, device='cuda:0')
distance 2 is tensor(73613.7344, device='cuda:0')
________________________________
test distance is  tensor(73613.7344, device='cuda:0')
test similarity is  tensor(0.2031, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.821909148509702e+17
test entropy is  0.0
________________________________
cal ratio is  0.011741074498348844
distance 1 is tensor(11848.3867, device='cuda:0')
distance 2 is tensor(864.3043, device='cuda:0')
cal_distance is  tensor(864.3043, device='cuda:0')
cal ratio is  0.10835624311785091
distance 1 is tensor(1283.8522, device='cuda:0')
distance 2 is tensor(93.6528, device='cuda:0')
cal_distance is  tensor(93.6528, device='cuda:0')
cal ratio is  0.3291750869348011
distance 1 is tensor(422.6161, device='cuda:0')
distance 2 is tensor(30.8282, device='cuda:0')
cal_distance is  tensor(30.8282, device='cuda:0')
cal ratio is  0.5737378430481035
distance 1 is tensor(242.4734, device='cuda:0')
distance 2 is tensor(17.6873, device='cuda:0')
cal_distance is  tensor(17.6873, device='cuda:0')
cal ratio is  0.7574548286245553
distance 1 is tensor(183.6642, device='cuda:0')
distance 2 is tensor(13.3973, device='cuda:0')
cal_distance is  tensor(13.3973, device='cuda:0')
cal ratio is  0.8703187743667904
distance 1 is tensor(159.8471, device='cuda:0')
distance 2 is tensor(11.6599, device='cuda:0')
cal_distance is  tensor(11.6599, device='cuda:0')
distance 1 is tensor(159.8471, device='cuda:0')
distance 2 is tensor(11.6599, device='cuda:0')
________________________________
test distance is  tensor(11.6599, device='cuda:0')
test similarity is  tensor(0.9569, device='cuda:0')
test acc is  0.8629833334896561
test loss is 44.75618777244584
test entropy is  0.029388477877606508
________________________________
distance 1 is tensor(159.8471, device='cuda:0')
distance 2 is tensor(11.6599, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.028773915463574985
avg test loss is  44.7448994793109
avg accuracy is  0.864083333489656
solo acc is  0.3077500001563397
compute similarity  is  tensor(0.9569, device='cuda:0')
compute_distance is  tensor(11.6599, device='cuda:0')
compute_norm is  tensor(56.6933, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(151.4744, device='cuda:0')
distance 2 is tensor(12.8288, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9486069048264387
avg test loss is  1.3980470447143767
avg accuracy is  0.8422833334896569
solo acc is  0.30578333348967296
compute similarity  is  tensor(0.9568, device='cuda:0')
compute_distance is  tensor(12.8288, device='cuda:0')
compute_norm is  tensor(56.0890, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.1470, device='cuda:0')
distance 2 is tensor(12.9830, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.892362889259863
avg test loss is  1.4955708026123453
avg accuracy is  0.8388833334896572
solo acc is  0.24378333348967138
compute similarity  is  tensor(0.9565, device='cuda:0')
compute_distance is  tensor(12.9830, device='cuda:0')
compute_norm is  tensor(55.8137, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.6930, device='cuda:0')
distance 2 is tensor(13.0753, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.896050680674978
avg test loss is  1.4727551835432235
avg accuracy is  0.8382000001563237
solo acc is  0.23696666682300446
compute similarity  is  tensor(0.9563, device='cuda:0')
compute_distance is  tensor(13.0753, device='cuda:0')
compute_norm is  tensor(55.5463, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.3009, device='cuda:0')
distance 2 is tensor(13.1478, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8824887603584891
avg test loss is  1.4591524186673195
avg accuracy is  0.8371166668229905
solo acc is  0.23603333348967107
compute similarity  is  tensor(0.9562, device='cuda:0')
compute_distance is  tensor(13.1478, device='cuda:0')
compute_norm is  tensor(55.2834, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.8718, device='cuda:0')
distance 2 is tensor(13.2095, device='cuda:0')
________________________________
test distance is  tensor(13.2095, device='cuda:0')
test similarity is  tensor(0.9560, device='cuda:0')
test acc is  0.838883333489657
test loss is 1.4452334521675922
test entropy is  0.8729860534164697
________________________________
cal ratio is  0.8764848511518863
distance 1 is tensor(134.8670, device='cuda:0')
distance 2 is tensor(11.5779, device='cuda:0')
cal_distance is  tensor(11.5779, device='cuda:0')
distance 1 is tensor(134.8670, device='cuda:0')
distance 2 is tensor(11.5779, device='cuda:0')
________________________________
test distance is  tensor(11.5779, device='cuda:0')
test similarity is  tensor(0.9654, device='cuda:0')
test acc is  0.8593666668229896
test loss is 1.068646916702612
test entropy is  1.040379144616727
________________________________
distance 1 is tensor(134.8670, device='cuda:0')
distance 2 is tensor(11.5779, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.039170644494262
avg test loss is  1.0656482798458418
avg accuracy is  0.8564500001563231
solo acc is  0.4826500001563419
compute similarity  is  tensor(0.9654, device='cuda:0')
compute_distance is  tensor(11.5779, device='cuda:0')
compute_norm is  tensor(54.6405, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.8336, device='cuda:0')
distance 2 is tensor(11.8351, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8675641410513473
avg test loss is  1.4366555126236955
avg accuracy is  0.8520666668229899
solo acc is  0.23381666682300442
compute similarity  is  tensor(0.9649, device='cuda:0')
compute_distance is  tensor(11.8351, device='cuda:0')
compute_norm is  tensor(54.3872, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.9434, device='cuda:0')
distance 2 is tensor(11.9382, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8702977647913545
avg test loss is  1.4082851962748366
avg accuracy is  0.8509833334896566
solo acc is  0.2386833334896712
compute similarity  is  tensor(0.9647, device='cuda:0')
compute_distance is  tensor(11.9382, device='cuda:0')
compute_norm is  tensor(54.1302, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.0018, device='cuda:0')
distance 2 is tensor(12.0243, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8630476772531009
avg test loss is  1.3970907268239492
avg accuracy is  0.8507833334896565
solo acc is  0.23838333348967122
compute similarity  is  tensor(0.9645, device='cuda:0')
compute_distance is  tensor(12.0243, device='cuda:0')
compute_norm is  tensor(53.8770, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.0443, device='cuda:0')
distance 2 is tensor(12.1114, device='cuda:0')
exit early
distance 1 is tensor(140.0443, device='cuda:0')
distance 2 is tensor(12.1114, device='cuda:0')
________________________________
test distance is  tensor(12.1114, device='cuda:0')
test similarity is  tensor(0.9643, device='cuda:0')
test acc is  0.8529833334896566
test loss is 1.3925387159085223
test entropy is  0.8583305819964866
________________________________
distance 1 is tensor(140.0443, device='cuda:0')
distance 2 is tensor(12.1114, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8578560004737585
avg test loss is  1.3940796020951098
avg accuracy is  0.8517333334896565
solo acc is  0.23508333348967111
compute similarity  is  tensor(0.9643, device='cuda:0')
compute_distance is  tensor(12.1114, device='cuda:0')
compute_norm is  tensor(53.6274, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.0460, device='cuda:0')
distance 2 is tensor(12.1879, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8537355086315416
avg test loss is  1.3829858556612213
avg accuracy is  0.8536333334896564
solo acc is  0.23373333348967104
compute similarity  is  tensor(0.9642, device='cuda:0')
compute_distance is  tensor(12.1879, device='cuda:0')
compute_norm is  tensor(53.3793, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.0829, device='cuda:0')
distance 2 is tensor(12.2668, device='cuda:0')
exit early
distance 1 is tensor(142.0829, device='cuda:0')
distance 2 is tensor(12.2668, device='cuda:0')
________________________________
test distance is  tensor(12.2668, device='cuda:0')
test similarity is  tensor(0.9640, device='cuda:0')
test acc is  0.856650000156323
test loss is 1.3808199350894896
test entropy is  0.8491203335683737
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.248602271080017
mal norm is  tensor(6.6431, device='cuda:0')
distance 1 is tensor(142.0829, device='cuda:0')
distance 2 is tensor(12.2668, device='cuda:0')
mal distance is  tensor(12.2668, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1706, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(450.7574, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.4038e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.6255, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(484.6151, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.1392e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.5557, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.8907, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.1756, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(368.9838, device='cuda:0')
c is  tensor(0.0215, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.0198e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.5340, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3107, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2254e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.3530, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.5240, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.8235, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.2884e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.2589, device='cuda:0')
c is  tensor(0.0169, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.2042e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.1500, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.8525e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.2100, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.4176, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.7619e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.0627, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 18
len all weights is 18
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 86.88% 

Test Accuracy: 85.61% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7441234588623047
distance 1 is tensor(151.5801, device='cuda:0')
distance 2 is tensor(11.2358, device='cuda:0')
benign distance is  tensor(11.2358, device='cuda:0')
norm1 res is  tensor(0.1537, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5689487457275391
distance 1 is tensor(165.6974, device='cuda:0')
distance 2 is tensor(12.0009, device='cuda:0')
benign distance is  tensor(12.0009, device='cuda:0')
norm1 res is  tensor(0.1624, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.08300523459911346
distance 1 is tensor(145.4087, device='cuda:0')
distance 2 is tensor(10.6807, device='cuda:0')
benign distance is  tensor(10.6807, device='cuda:0')
norm1 res is  tensor(0.1449, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.29061585664749146
distance 1 is tensor(153.9054, device='cuda:0')
distance 2 is tensor(11.0845, device='cuda:0')
benign distance is  tensor(11.0845, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.710344672203064
distance 1 is tensor(135.0710, device='cuda:0')
distance 2 is tensor(9.9258, device='cuda:0')
benign distance is  tensor(9.9258, device='cuda:0')
norm1 res is  tensor(0.1339, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.25240880250930786
distance 1 is tensor(150.3587, device='cuda:0')
distance 2 is tensor(10.9805, device='cuda:0')
benign distance is  tensor(10.9805, device='cuda:0')
norm1 res is  tensor(0.1498, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.08031114935874939
distance 1 is tensor(139.6544, device='cuda:0')
distance 2 is tensor(10.1584, device='cuda:0')
benign distance is  tensor(10.1584, device='cuda:0')
norm1 res is  tensor(0.1378, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7876059412956238
distance 1 is tensor(157.8305, device='cuda:0')
distance 2 is tensor(11.5810, device='cuda:0')
benign distance is  tensor(11.5810, device='cuda:0')
norm1 res is  tensor(0.1590, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.043812353163957596
distance 1 is tensor(155.7865, device='cuda:0')
distance 2 is tensor(11.3504, device='cuda:0')
benign distance is  tensor(11.3504, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.5708943605422974
distance 1 is tensor(169.4159, device='cuda:0')
distance 2 is tensor(12.2039, device='cuda:0')
benign distance is  tensor(12.2039, device='cuda:0')
norm1 res is  tensor(0.1664, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.3926956057548523
distance 1 is tensor(168.6005, device='cuda:0')
distance 2 is tensor(12.5200, device='cuda:0')
benign distance is  tensor(12.5200, device='cuda:0')
norm1 res is  tensor(0.1670, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.6028106808662415
distance 1 is tensor(159.6089, device='cuda:0')
distance 2 is tensor(11.7203, device='cuda:0')
benign distance is  tensor(11.7203, device='cuda:0')
norm1 res is  tensor(0.1616, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.3994806408882141
distance 1 is tensor(159.5328, device='cuda:0')
distance 2 is tensor(11.7264, device='cuda:0')
benign distance is  tensor(11.7264, device='cuda:0')
norm1 res is  tensor(0.1570, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.750447154045105
distance 1 is tensor(150.3704, device='cuda:0')
distance 2 is tensor(10.9661, device='cuda:0')
benign distance is  tensor(10.9661, device='cuda:0')
norm1 res is  tensor(0.1473, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.3037481904029846
distance 1 is tensor(162.7679, device='cuda:0')
distance 2 is tensor(11.9554, device='cuda:0')
benign distance is  tensor(11.9554, device='cuda:0')
norm1 res is  tensor(0.1641, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.6680392026901245
distance 1 is tensor(167.8522, device='cuda:0')
distance 2 is tensor(12.3602, device='cuda:0')
benign distance is  tensor(12.3602, device='cuda:0')
norm1 res is  tensor(0.1666, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(159.7472, device='cuda:0')
distance 2 is tensor(11.7642, device='cuda:0')
compute distance is  tensor(11.7642, device='cuda:0')
compute norm is  tensor(53.7231, device='cuda:0')
distance 1 is tensor(163.8973, device='cuda:0')
distance 2 is tensor(12.0389, device='cuda:0')
compute distance is  tensor(12.0389, device='cuda:0')
compute norm is  tensor(53.5099, device='cuda:0')
distance 1 is tensor(172.6727, device='cuda:0')
distance 2 is tensor(12.6417, device='cuda:0')
compute distance is  tensor(12.6417, device='cuda:0')
compute norm is  tensor(53.9560, device='cuda:0')
distance 1 is tensor(168.8354, device='cuda:0')
distance 2 is tensor(12.2946, device='cuda:0')
compute distance is  tensor(12.2946, device='cuda:0')
compute norm is  tensor(53.6557, device='cuda:0')
distance 1 is tensor(172.1774, device='cuda:0')
distance 2 is tensor(12.5436, device='cuda:0')
compute distance is  tensor(12.5436, device='cuda:0')
compute norm is  tensor(53.9804, device='cuda:0')
distance 1 is tensor(192.8372, device='cuda:0')
distance 2 is tensor(14.1455, device='cuda:0')
compute distance is  tensor(14.1455, device='cuda:0')
compute norm is  tensor(54.4241, device='cuda:0')
distance 1 is tensor(164.2624, device='cuda:0')
distance 2 is tensor(12.0263, device='cuda:0')
compute distance is  tensor(12.0263, device='cuda:0')
compute norm is  tensor(53.6861, device='cuda:0')
distance 1 is tensor(181.5955, device='cuda:0')
distance 2 is tensor(13.2691, device='cuda:0')
compute distance is  tensor(13.2691, device='cuda:0')
compute norm is  tensor(54.2119, device='cuda:0')
distance 1 is tensor(180.1043, device='cuda:0')
distance 2 is tensor(12.9935, device='cuda:0')
compute distance is  tensor(12.9935, device='cuda:0')
compute norm is  tensor(54.0246, device='cuda:0')
distance 1 is tensor(159.1143, device='cuda:0')
distance 2 is tensor(11.6868, device='cuda:0')
compute distance is  tensor(11.6868, device='cuda:0')
compute norm is  tensor(53.6136, device='cuda:0')
distance 1 is tensor(182.6610, device='cuda:0')
distance 2 is tensor(12.9843, device='cuda:0')
compute distance is  tensor(12.9843, device='cuda:0')
compute norm is  tensor(54.1417, device='cuda:0')
distance 1 is tensor(162.9982, device='cuda:0')
distance 2 is tensor(11.7637, device='cuda:0')
compute distance is  tensor(11.7637, device='cuda:0')
compute norm is  tensor(53.8405, device='cuda:0')
distance Threshold  is  tensor(14.1455, device='cuda:0')
distance 1 is tensor(1009086.5625, device='cuda:0')
distance 2 is tensor(73609.2266, device='cuda:0')
________________________________
test distance is  tensor(73609.2266, device='cuda:0')
test similarity is  tensor(0.3294, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82480879833311e+17
test entropy is  0.0
________________________________
cal ratio is  0.012476288412700254
distance 1 is tensor(12589.6611, device='cuda:0')
distance 2 is tensor(918.3701, device='cuda:0')
cal_distance is  tensor(918.3701, device='cuda:0')
cal ratio is  0.11169729822952074
distance 1 is tensor(1406.2366, device='cuda:0')
distance 2 is tensor(102.5795, device='cuda:0')
cal_distance is  tensor(102.5795, device='cuda:0')
cal ratio is  0.3342114690386151
distance 1 is tensor(469.9843, device='cuda:0')
distance 2 is tensor(34.2832, device='cuda:0')
cal_distance is  tensor(34.2832, device='cuda:0')
cal ratio is  0.5781102735344936
distance 1 is tensor(271.7053, device='cuda:0')
distance 2 is tensor(19.8195, device='cuda:0')
cal_distance is  tensor(19.8195, device='cuda:0')
cal ratio is  0.7603356007689628
distance 1 is tensor(206.5887, device='cuda:0')
distance 2 is tensor(15.0695, device='cuda:0')
cal_distance is  tensor(15.0695, device='cuda:0')
cal ratio is  0.871972204757883
distance 1 is tensor(180.1404, device='cuda:0')
distance 2 is tensor(13.1402, device='cuda:0')
cal_distance is  tensor(13.1402, device='cuda:0')
distance 1 is tensor(180.1404, device='cuda:0')
distance 2 is tensor(13.1402, device='cuda:0')
________________________________
test distance is  tensor(13.1402, device='cuda:0')
test similarity is  tensor(0.9549, device='cuda:0')
test acc is  0.4635500001563418
test loss is 151.71700698429586
test entropy is  0.0007425747944677043
________________________________
distance 1 is tensor(180.1404, device='cuda:0')
distance 2 is tensor(13.1402, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0008178500232789416
avg test loss is  152.10690767983638
avg accuracy is  0.4604000001563417
solo acc is  0.10210000015633197
compute similarity  is  tensor(0.9549, device='cuda:0')
compute_distance is  tensor(13.1402, device='cuda:0')
compute_norm is  tensor(58.0517, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(162.2107, device='cuda:0')
distance 2 is tensor(13.2257, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9343663255161823
avg test loss is  1.3713472990084812
avg accuracy is  0.6694000001563326
solo acc is  0.291866666823006
compute similarity  is  tensor(0.9573, device='cuda:0')
compute_distance is  tensor(13.2257, device='cuda:0')
compute_norm is  tensor(57.8567, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(162.2107, device='cuda:0')
distance 2 is tensor(13.2257, device='cuda:0')
________________________________
test distance is  tensor(13.2257, device='cuda:0')
test similarity is  tensor(0.9573, device='cuda:0')
test acc is  0.6683333334896658
test loss is 1.3714824479017684
test entropy is  0.9347927436264339
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3884413242340088
mal norm is  tensor(8.6640, device='cuda:0')
distance 1 is tensor(162.2107, device='cuda:0')
distance 2 is tensor(13.2257, device='cuda:0')
mal distance is  tensor(13.2257, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.3082, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.1926, device='cuda:0')
c is  tensor(0.0226, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0038, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.1622, device='cuda:0')
c is  tensor(0.0219, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0028, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.9351, device='cuda:0')
c is  tensor(0.0232, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.3271, device='cuda:0')
c is  tensor(0.0228, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.4469, device='cuda:0')
c is  tensor(0.0242, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0030, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.4330, device='cuda:0')
c is  tensor(0.0228, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.2828, device='cuda:0')
c is  tensor(0.0238, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0035, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.9149, device='cuda:0')
c is  tensor(0.0223, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0030, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(866.4009, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0031, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(736.8748, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.6730, device='cuda:0')
c is  tensor(0.0213, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.8035, device='cuda:0')
c is  tensor(0.0212, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.5310, device='cuda:0')
c is  tensor(0.0206, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.3037, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.5435, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0028, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.4818, device='cuda:0')
c is  tensor(0.0212, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.4954, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0029, device='cuda:0')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 91.34% 

Test Accuracy: 89.38% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3170803189277649
distance 1 is tensor(127.8753, device='cuda:0')
distance 2 is tensor(9.2551, device='cuda:0')
benign distance is  tensor(9.2551, device='cuda:0')
norm1 res is  tensor(0.1305, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.4921402335166931
distance 1 is tensor(135.5294, device='cuda:0')
distance 2 is tensor(9.6174, device='cuda:0')
benign distance is  tensor(9.6174, device='cuda:0')
norm1 res is  tensor(0.1338, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.11605945974588394
distance 1 is tensor(138.2902, device='cuda:0')
distance 2 is tensor(9.8359, device='cuda:0')
benign distance is  tensor(9.8359, device='cuda:0')
norm1 res is  tensor(0.1370, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5587316155433655
distance 1 is tensor(147.6888, device='cuda:0')
distance 2 is tensor(10.6313, device='cuda:0')
benign distance is  tensor(10.6313, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.3078432083129883
distance 1 is tensor(137.0323, device='cuda:0')
distance 2 is tensor(9.8372, device='cuda:0')
benign distance is  tensor(9.8372, device='cuda:0')
norm1 res is  tensor(0.1373, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8470231890678406
distance 1 is tensor(149.2296, device='cuda:0')
distance 2 is tensor(10.6703, device='cuda:0')
benign distance is  tensor(10.6703, device='cuda:0')
norm1 res is  tensor(0.1544, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.2110065221786499
distance 1 is tensor(114.1762, device='cuda:0')
distance 2 is tensor(8.1354, device='cuda:0')
benign distance is  tensor(8.1354, device='cuda:0')
norm1 res is  tensor(0.1145, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.30370426177978516
distance 1 is tensor(143.2571, device='cuda:0')
distance 2 is tensor(10.3003, device='cuda:0')
benign distance is  tensor(10.3003, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.14405950903892517
distance 1 is tensor(145.3856, device='cuda:0')
distance 2 is tensor(10.4776, device='cuda:0')
benign distance is  tensor(10.4776, device='cuda:0')
norm1 res is  tensor(0.1487, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.3296355605125427
distance 1 is tensor(147.8133, device='cuda:0')
distance 2 is tensor(10.6248, device='cuda:0')
benign distance is  tensor(10.6248, device='cuda:0')
norm1 res is  tensor(0.1491, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6841117143630981
distance 1 is tensor(133.1867, device='cuda:0')
distance 2 is tensor(9.4617, device='cuda:0')
benign distance is  tensor(9.4617, device='cuda:0')
norm1 res is  tensor(0.1319, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.562951922416687
distance 1 is tensor(148.6595, device='cuda:0')
distance 2 is tensor(10.6325, device='cuda:0')
benign distance is  tensor(10.6325, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.8114339113235474
distance 1 is tensor(133.6199, device='cuda:0')
distance 2 is tensor(9.6301, device='cuda:0')
benign distance is  tensor(9.6301, device='cuda:0')
norm1 res is  tensor(0.1364, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.9025626182556152
distance 1 is tensor(157.0110, device='cuda:0')
distance 2 is tensor(11.3266, device='cuda:0')
benign distance is  tensor(11.3266, device='cuda:0')
norm1 res is  tensor(0.1626, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.36641398072242737
distance 1 is tensor(129.5891, device='cuda:0')
distance 2 is tensor(9.3623, device='cuda:0')
benign distance is  tensor(9.3623, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.2807251513004303
distance 1 is tensor(138.0737, device='cuda:0')
distance 2 is tensor(9.8929, device='cuda:0')
benign distance is  tensor(9.8929, device='cuda:0')
norm1 res is  tensor(0.1401, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(151.2305, device='cuda:0')
distance 2 is tensor(10.7892, device='cuda:0')
compute distance is  tensor(10.7892, device='cuda:0')
compute norm is  tensor(54.1517, device='cuda:0')
distance 1 is tensor(161.1542, device='cuda:0')
distance 2 is tensor(11.4361, device='cuda:0')
compute distance is  tensor(11.4361, device='cuda:0')
compute norm is  tensor(54.2158, device='cuda:0')
distance 1 is tensor(173.9764, device='cuda:0')
distance 2 is tensor(12.3211, device='cuda:0')
compute distance is  tensor(12.3211, device='cuda:0')
compute norm is  tensor(54.6879, device='cuda:0')
distance 1 is tensor(160.4759, device='cuda:0')
distance 2 is tensor(11.4711, device='cuda:0')
compute distance is  tensor(11.4711, device='cuda:0')
compute norm is  tensor(54.2397, device='cuda:0')
distance 1 is tensor(159.1697, device='cuda:0')
distance 2 is tensor(11.3035, device='cuda:0')
compute distance is  tensor(11.3035, device='cuda:0')
compute norm is  tensor(54.3686, device='cuda:0')
distance 1 is tensor(165.2969, device='cuda:0')
distance 2 is tensor(11.6618, device='cuda:0')
compute distance is  tensor(11.6618, device='cuda:0')
compute norm is  tensor(54.5294, device='cuda:0')
distance 1 is tensor(148.5985, device='cuda:0')
distance 2 is tensor(10.7507, device='cuda:0')
compute distance is  tensor(10.7507, device='cuda:0')
compute norm is  tensor(54.1798, device='cuda:0')
distance 1 is tensor(165.7573, device='cuda:0')
distance 2 is tensor(11.8386, device='cuda:0')
compute distance is  tensor(11.8386, device='cuda:0')
compute norm is  tensor(54.4248, device='cuda:0')
distance 1 is tensor(161.3846, device='cuda:0')
distance 2 is tensor(11.5550, device='cuda:0')
compute distance is  tensor(11.5550, device='cuda:0')
compute norm is  tensor(54.3796, device='cuda:0')
distance 1 is tensor(162.8272, device='cuda:0')
distance 2 is tensor(11.5184, device='cuda:0')
compute distance is  tensor(11.5184, device='cuda:0')
compute norm is  tensor(54.4226, device='cuda:0')
distance 1 is tensor(159.6557, device='cuda:0')
distance 2 is tensor(11.3190, device='cuda:0')
compute distance is  tensor(11.3190, device='cuda:0')
compute norm is  tensor(54.3362, device='cuda:0')
distance 1 is tensor(145.6156, device='cuda:0')
distance 2 is tensor(10.3324, device='cuda:0')
compute distance is  tensor(10.3324, device='cuda:0')
compute norm is  tensor(54.1280, device='cuda:0')
distance Threshold  is  tensor(12.3211, device='cuda:0')
distance 1 is tensor(1009118.5625, device='cuda:0')
distance 2 is tensor(73611.9297, device='cuda:0')
________________________________
test distance is  tensor(73611.9297, device='cuda:0')
test similarity is  tensor(0.2592, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.823784938570647e+17
test entropy is  0.0
________________________________
cal ratio is  0.011643778924543281
distance 1 is tensor(11749.9580, device='cuda:0')
distance 2 is tensor(857.1211, device='cuda:0')
cal_distance is  tensor(857.1211, device='cuda:0')
cal ratio is  0.1079063360910296
distance 1 is tensor(1267.9005, device='cuda:0')
distance 2 is tensor(92.4888, device='cuda:0')
cal_distance is  tensor(92.4888, device='cuda:0')
cal ratio is  0.32849100884779003
distance 1 is tensor(416.4979, device='cuda:0')
distance 2 is tensor(30.3817, device='cuda:0')
cal_distance is  tensor(30.3817, device='cuda:0')
cal ratio is  0.5731413546883813
distance 1 is tensor(238.7147, device='cuda:0')
distance 2 is tensor(17.4130, device='cuda:0')
cal_distance is  tensor(17.4130, device='cuda:0')
cal ratio is  0.7570610075968743
distance 1 is tensor(180.7231, device='cuda:0')
distance 2 is tensor(13.1827, device='cuda:0')
cal_distance is  tensor(13.1827, device='cuda:0')
cal ratio is  0.8700925511427025
distance 1 is tensor(157.2466, device='cuda:0')
distance 2 is tensor(11.4702, device='cuda:0')
cal_distance is  tensor(11.4702, device='cuda:0')
distance 1 is tensor(157.2466, device='cuda:0')
distance 2 is tensor(11.4702, device='cuda:0')
________________________________
test distance is  tensor(11.4702, device='cuda:0')
test similarity is  tensor(0.9613, device='cuda:0')
test acc is  0.8568833334896563
test loss is 46.822923955124324
test entropy is  0.02860080329588985
________________________________
distance 1 is tensor(157.2466, device='cuda:0')
distance 2 is tensor(11.4702, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.02916274398964865
avg test loss is  46.8594607351177
avg accuracy is  0.8561166668229898
solo acc is  0.25430000015633836
compute similarity  is  tensor(0.9613, device='cuda:0')
compute_distance is  tensor(11.4702, device='cuda:0')
compute_norm is  tensor(57.3456, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.6869, device='cuda:0')
distance 2 is tensor(12.3091, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9192682568833772
avg test loss is  1.366336803192269
avg accuracy is  0.8228000001563243
solo acc is  0.3081666668230063
compute similarity  is  tensor(0.9616, device='cuda:0')
compute_distance is  tensor(12.3091, device='cuda:0')
compute_norm is  tensor(56.8585, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.0592, device='cuda:0')
distance 2 is tensor(12.4236, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8745471159659469
avg test loss is  1.468640153596142
avg accuracy is  0.8154000001563246
solo acc is  0.24141666682300458
compute similarity  is  tensor(0.9614, device='cuda:0')
compute_distance is  tensor(12.4236, device='cuda:0')
compute_norm is  tensor(56.5835, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.2485, device='cuda:0')
distance 2 is tensor(12.4796, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8735108620195247
avg test loss is  1.4484364281076867
avg accuracy is  0.8165500001563247
solo acc is  0.2374166668230045
compute similarity  is  tensor(0.9613, device='cuda:0')
compute_distance is  tensor(12.4796, device='cuda:0')
compute_norm is  tensor(56.3142, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.5770, device='cuda:0')
distance 2 is tensor(12.5303, device='cuda:0')
exit early
distance 1 is tensor(148.5770, device='cuda:0')
distance 2 is tensor(12.5303, device='cuda:0')
________________________________
test distance is  tensor(12.5303, device='cuda:0')
test similarity is  tensor(0.9612, device='cuda:0')
test acc is  0.8181833334896579
test loss is 1.4442092303528207
test entropy is  0.8642187461034575
________________________________
cal ratio is  0.8924560246332576
distance 1 is tensor(132.5991, device='cuda:0')
distance 2 is tensor(11.1828, device='cuda:0')
cal_distance is  tensor(11.1828, device='cuda:0')
distance 1 is tensor(132.5991, device='cuda:0')
distance 2 is tensor(11.1828, device='cuda:0')
________________________________
test distance is  tensor(11.1828, device='cuda:0')
test similarity is  tensor(0.9684, device='cuda:0')
test acc is  0.8337166668229905
test loss is 1.133677864824531
test entropy is  1.0007176096759625
________________________________
distance 1 is tensor(132.5991, device='cuda:0')
distance 2 is tensor(11.1828, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0002292081999626
avg test loss is  1.1334581901905125
avg accuracy is  0.8343166668229907
solo acc is  0.41808333348967464
compute similarity  is  tensor(0.9684, device='cuda:0')
compute_distance is  tensor(11.1828, device='cuda:0')
compute_norm is  tensor(55.6573, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.8421, device='cuda:0')
distance 2 is tensor(11.3577, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8589577516004729
avg test loss is  1.421110432666502
avg accuracy is  0.8267166668229908
solo acc is  0.23586666682300444
compute similarity  is  tensor(0.9681, device='cuda:0')
compute_distance is  tensor(11.3577, device='cuda:0')
compute_norm is  tensor(55.4000, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.5010, device='cuda:0')
distance 2 is tensor(11.4259, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8550579279724723
avg test loss is  1.4109558117415097
avg accuracy is  0.8267333334896575
solo acc is  0.23465000015633783
compute similarity  is  tensor(0.9679, device='cuda:0')
compute_distance is  tensor(11.4259, device='cuda:0')
compute_norm is  tensor(55.1391, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.1705, device='cuda:0')
distance 2 is tensor(11.4856, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.863730240605279
avg test loss is  1.3850762091720028
avg accuracy is  0.8270833334896576
solo acc is  0.2333833334896711
compute similarity  is  tensor(0.9678, device='cuda:0')
compute_distance is  tensor(11.4856, device='cuda:0')
compute_norm is  tensor(54.8814, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.9127, device='cuda:0')
distance 2 is tensor(11.5501, device='cuda:0')
exit early
distance 1 is tensor(135.9127, device='cuda:0')
distance 2 is tensor(11.5501, device='cuda:0')
________________________________
test distance is  tensor(11.5501, device='cuda:0')
test similarity is  tensor(0.9677, device='cuda:0')
test acc is  0.8272666668229909
test loss is 1.3863470234088044
test entropy is  0.8570535195026316
________________________________
distance 1 is tensor(135.9127, device='cuda:0')
distance 2 is tensor(11.5501, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8562892998205319
avg test loss is  1.3886636534352292
avg accuracy is  0.8268000001563242
solo acc is  0.22785000015633752
compute similarity  is  tensor(0.9677, device='cuda:0')
compute_distance is  tensor(11.5501, device='cuda:0')
compute_norm is  tensor(54.6265, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.6905, device='cuda:0')
distance 2 is tensor(11.6111, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8535851335474677
avg test loss is  1.3780913928043106
avg accuracy is  0.8281166668229909
solo acc is  0.2297666668230043
compute similarity  is  tensor(0.9676, device='cuda:0')
compute_distance is  tensor(11.6111, device='cuda:0')
compute_norm is  tensor(54.3745, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.5190, device='cuda:0')
distance 2 is tensor(11.6727, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8472815790156057
avg test loss is  1.3724031884914267
avg accuracy is  0.8293833334896574
solo acc is  0.22761666682300416
compute similarity  is  tensor(0.9675, device='cuda:0')
compute_distance is  tensor(11.6727, device='cuda:0')
compute_norm is  tensor(54.1240, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.3821, device='cuda:0')
distance 2 is tensor(11.7337, device='cuda:0')
exit early
distance 1 is tensor(138.3821, device='cuda:0')
distance 2 is tensor(11.7337, device='cuda:0')
________________________________
test distance is  tensor(11.7337, device='cuda:0')
test similarity is  tensor(0.9674, device='cuda:0')
test acc is  0.8297166668229907
test loss is 1.3658234674030785
test entropy is  0.8378482512446609
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.285807728767395
mal norm is  tensor(6.4978, device='cuda:0')
distance 1 is tensor(138.3821, device='cuda:0')
distance 2 is tensor(11.7337, device='cuda:0')
mal distance is  tensor(11.7337, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(0.2333, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.2845, device='cuda:0')
c is  tensor(0.0213, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.5319e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.6301, device='cuda:0')
c is  tensor(0.0211, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.7029, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.2438, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.6538, device='cuda:0')
c is  tensor(0.0207, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.7790e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.6311, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.1558e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(438.4820, device='cuda:0')
c is  tensor(0.0231, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.2400, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7795, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.5819, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.3277, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.7208e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.0264, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.3384, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.5671, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.3387, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.9426, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.1711e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.2751, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.7797e-05, device='cuda:0')
len accept list 10
len all weights is 10
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 91.23% 

Test Accuracy: 89.46% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
 benign loss is  0.08577610552310944
distance 1 is tensor(124.7526, device='cuda:0')
distance 2 is tensor(9.0427, device='cuda:0')
benign distance is  tensor(9.0427, device='cuda:0')
norm1 res is  tensor(0.1261, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5336681604385376
distance 1 is tensor(131.2085, device='cuda:0')
distance 2 is tensor(9.3793, device='cuda:0')
benign distance is  tensor(9.3793, device='cuda:0')
norm1 res is  tensor(0.1338, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.5481396317481995
distance 1 is tensor(121.4705, device='cuda:0')
distance 2 is tensor(8.5561, device='cuda:0')
benign distance is  tensor(8.5561, device='cuda:0')
norm1 res is  tensor(0.1184, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3481461703777313
distance 1 is tensor(117.8187, device='cuda:0')
distance 2 is tensor(8.4383, device='cuda:0')
benign distance is  tensor(8.4383, device='cuda:0')
norm1 res is  tensor(0.1164, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.718370258808136
distance 1 is tensor(141.3352, device='cuda:0')
distance 2 is tensor(10.1446, device='cuda:0')
benign distance is  tensor(10.1446, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8094595074653625
distance 1 is tensor(145.1420, device='cuda:0')
distance 2 is tensor(10.4212, device='cuda:0')
benign distance is  tensor(10.4212, device='cuda:0')
norm1 res is  tensor(0.1478, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.04735930263996124
distance 1 is tensor(107.3413, device='cuda:0')
distance 2 is tensor(7.6874, device='cuda:0')
benign distance is  tensor(7.6874, device='cuda:0')
norm1 res is  tensor(0.1070, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6522459983825684
distance 1 is tensor(142.6305, device='cuda:0')
distance 2 is tensor(10.1372, device='cuda:0')
benign distance is  tensor(10.1372, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7272181510925293
distance 1 is tensor(141.2927, device='cuda:0')
distance 2 is tensor(10.0083, device='cuda:0')
benign distance is  tensor(10.0083, device='cuda:0')
norm1 res is  tensor(0.1418, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.136295884847641
distance 1 is tensor(133.0983, device='cuda:0')
distance 2 is tensor(9.6441, device='cuda:0')
benign distance is  tensor(9.6441, device='cuda:0')
norm1 res is  tensor(0.1344, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.3590361475944519
distance 1 is tensor(145.3691, device='cuda:0')
distance 2 is tensor(10.3245, device='cuda:0')
benign distance is  tensor(10.3245, device='cuda:0')
norm1 res is  tensor(0.1441, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.15625420212745667
distance 1 is tensor(132.2961, device='cuda:0')
distance 2 is tensor(9.5823, device='cuda:0')
benign distance is  tensor(9.5823, device='cuda:0')
norm1 res is  tensor(0.1332, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.5833330154418945
distance 1 is tensor(145.6330, device='cuda:0')
distance 2 is tensor(10.4249, device='cuda:0')
benign distance is  tensor(10.4249, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.6307487487792969
distance 1 is tensor(146.3158, device='cuda:0')
distance 2 is tensor(10.4471, device='cuda:0')
benign distance is  tensor(10.4471, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.37178000807762146
distance 1 is tensor(143.7265, device='cuda:0')
distance 2 is tensor(10.2835, device='cuda:0')
benign distance is  tensor(10.2835, device='cuda:0')
norm1 res is  tensor(0.1439, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.3991367816925049
distance 1 is tensor(134.7689, device='cuda:0')
distance 2 is tensor(9.7513, device='cuda:0')
benign distance is  tensor(9.7513, device='cuda:0')
norm1 res is  tensor(0.1361, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(158.9586, device='cuda:0')
distance 2 is tensor(11.4080, device='cuda:0')
compute distance is  tensor(11.4080, device='cuda:0')
compute norm is  tensor(54.2032, device='cuda:0')
distance 1 is tensor(147.5759, device='cuda:0')
distance 2 is tensor(10.4558, device='cuda:0')
compute distance is  tensor(10.4558, device='cuda:0')
compute norm is  tensor(53.8689, device='cuda:0')
distance 1 is tensor(162.6160, device='cuda:0')
distance 2 is tensor(11.6622, device='cuda:0')
compute distance is  tensor(11.6622, device='cuda:0')
compute norm is  tensor(54.2551, device='cuda:0')
distance 1 is tensor(154.7717, device='cuda:0')
distance 2 is tensor(10.9485, device='cuda:0')
compute distance is  tensor(10.9485, device='cuda:0')
compute norm is  tensor(53.9439, device='cuda:0')
distance 1 is tensor(148.4922, device='cuda:0')
distance 2 is tensor(10.5520, device='cuda:0')
compute distance is  tensor(10.5520, device='cuda:0')
compute norm is  tensor(53.9916, device='cuda:0')
distance 1 is tensor(164.5929, device='cuda:0')
distance 2 is tensor(11.7969, device='cuda:0')
compute distance is  tensor(11.7969, device='cuda:0')
compute norm is  tensor(54.3847, device='cuda:0')
distance 1 is tensor(149.5008, device='cuda:0')
distance 2 is tensor(10.8990, device='cuda:0')
compute distance is  tensor(10.8990, device='cuda:0')
compute norm is  tensor(54.0540, device='cuda:0')
distance 1 is tensor(144.7806, device='cuda:0')
distance 2 is tensor(10.4031, device='cuda:0')
compute distance is  tensor(10.4031, device='cuda:0')
compute norm is  tensor(53.9197, device='cuda:0')
distance 1 is tensor(150.2951, device='cuda:0')
distance 2 is tensor(10.7832, device='cuda:0')
compute distance is  tensor(10.7832, device='cuda:0')
compute norm is  tensor(54.0858, device='cuda:0')
distance 1 is tensor(146.7988, device='cuda:0')
distance 2 is tensor(10.5563, device='cuda:0')
compute distance is  tensor(10.5563, device='cuda:0')
compute norm is  tensor(54.0443, device='cuda:0')
distance 1 is tensor(152.7944, device='cuda:0')
distance 2 is tensor(10.8141, device='cuda:0')
compute distance is  tensor(10.8141, device='cuda:0')
compute norm is  tensor(54.1119, device='cuda:0')
distance 1 is tensor(153.6445, device='cuda:0')
distance 2 is tensor(10.8034, device='cuda:0')
compute distance is  tensor(10.8034, device='cuda:0')
compute norm is  tensor(54.2372, device='cuda:0')
distance Threshold  is  tensor(11.7969, device='cuda:0')
distance 1 is tensor(1009132.8125, device='cuda:0')
distance 2 is tensor(73613.0859, device='cuda:0')
________________________________
test distance is  tensor(73613.0859, device='cuda:0')
test similarity is  tensor(0.2278, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.819659155256333e+17
test entropy is  0.0
________________________________
cal ratio is  0.011393301504478828
distance 1 is tensor(11497.3584, device='cuda:0')
distance 2 is tensor(838.6962, device='cuda:0')
cal_distance is  tensor(838.6962, device='cuda:0')
cal ratio is  0.10673940440718664
distance 1 is tensor(1227.2267, device='cuda:0')
distance 2 is tensor(89.5219, device='cuda:0')
cal_distance is  tensor(89.5219, device='cuda:0')
cal ratio is  0.32670999531667183
distance 1 is tensor(400.9513, device='cuda:0')
distance 2 is tensor(29.2477, device='cuda:0')
cal_distance is  tensor(29.2477, device='cuda:0')
cal ratio is  0.5715855108064278
distance 1 is tensor(229.1805, device='cuda:0')
distance 2 is tensor(16.7176, device='cuda:0')
cal_distance is  tensor(16.7176, device='cuda:0')
cal ratio is  0.756032677233742
distance 1 is tensor(173.2694, device='cuda:0')
distance 2 is tensor(12.6390, device='cuda:0')
cal_distance is  tensor(12.6390, device='cuda:0')
cal ratio is  0.8695014023092236
distance 1 is tensor(150.6588, device='cuda:0')
distance 2 is tensor(10.9897, device='cuda:0')
cal_distance is  tensor(10.9897, device='cuda:0')
distance 1 is tensor(150.6588, device='cuda:0')
distance 2 is tensor(10.9897, device='cuda:0')
________________________________
test distance is  tensor(10.9897, device='cuda:0')
test similarity is  tensor(0.9627, device='cuda:0')
test acc is  0.8696000001563224
test loss is 31.007131090550534
test entropy is  0.03791475661835179
________________________________
distance 1 is tensor(150.6588, device='cuda:0')
distance 2 is tensor(10.9897, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.03931805511776691
avg test loss is  30.74858675125057
avg accuracy is  0.8713500001563224
solo acc is  0.36240000015634066
compute similarity  is  tensor(0.9627, device='cuda:0')
compute_distance is  tensor(10.9897, device='cuda:0')
compute_norm is  tensor(56.9394, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(143.2640, device='cuda:0')
distance 2 is tensor(12.1590, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9281761399083046
avg test loss is  1.3777762209174476
avg accuracy is  0.8556333334896564
solo acc is  0.3069166668230064
compute similarity  is  tensor(0.9622, device='cuda:0')
compute_distance is  tensor(12.1590, device='cuda:0')
compute_norm is  tensor(56.3274, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.9636, device='cuda:0')
distance 2 is tensor(12.3020, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.9014244051630309
avg test loss is  1.4524249956806077
avg accuracy is  0.8514833334896565
solo acc is  0.24693333348967147
compute similarity  is  tensor(0.9620, device='cuda:0')
compute_distance is  tensor(12.3020, device='cuda:0')
compute_norm is  tensor(56.0511, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.5274, device='cuda:0')
distance 2 is tensor(12.3846, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8843234830192411
avg test loss is  1.4451451755281706
avg accuracy is  0.8515833334896565
solo acc is  0.24096666682300474
compute similarity  is  tensor(0.9618, device='cuda:0')
compute_distance is  tensor(12.3846, device='cuda:0')
compute_norm is  tensor(55.7821, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.1157, device='cuda:0')
distance 2 is tensor(12.4553, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.881820010605143
avg test loss is  1.4243385151251038
avg accuracy is  0.8506500001563232
solo acc is  0.23990000015633797
compute similarity  is  tensor(0.9617, device='cuda:0')
compute_distance is  tensor(12.4553, device='cuda:0')
compute_norm is  tensor(55.5189, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.7037, device='cuda:0')
distance 2 is tensor(12.5122, device='cuda:0')
________________________________
test distance is  tensor(12.5122, device='cuda:0')
test similarity is  tensor(0.9616, device='cuda:0')
test acc is  0.8505833334896566
test loss is 1.4137873804645498
test entropy is  0.8713932271832342
________________________________
cal ratio is  0.873898588160937
distance 1 is tensor(127.3310, device='cuda:0')
distance 2 is tensor(10.9344, device='cuda:0')
cal_distance is  tensor(10.9344, device='cuda:0')
distance 1 is tensor(127.3310, device='cuda:0')
distance 2 is tensor(10.9344, device='cuda:0')
________________________________
test distance is  tensor(10.9344, device='cuda:0')
test similarity is  tensor(0.9700, device='cuda:0')
test acc is  0.8662833334896559
test loss is 1.039347965961326
test entropy is  1.0209586793807015
________________________________
distance 1 is tensor(127.3310, device='cuda:0')
distance 2 is tensor(10.9344, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.018636697581582
avg test loss is  1.0349486815268552
avg accuracy is  0.8704833334896557
solo acc is  0.4982000001563421
compute similarity  is  tensor(0.9700, device='cuda:0')
compute_distance is  tensor(10.9344, device='cuda:0')
compute_norm is  tensor(54.9029, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.2827, device='cuda:0')
distance 2 is tensor(11.1890, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8687919288047595
avg test loss is  1.401084855802532
avg accuracy is  0.8637833334896561
solo acc is  0.24058333348967126
compute similarity  is  tensor(0.9695, device='cuda:0')
compute_distance is  tensor(11.1890, device='cuda:0')
compute_norm is  tensor(54.6488, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.3984, device='cuda:0')
distance 2 is tensor(11.2912, device='cuda:0')
exit early
distance 1 is tensor(130.3984, device='cuda:0')
distance 2 is tensor(11.2912, device='cuda:0')
________________________________
test distance is  tensor(11.2912, device='cuda:0')
test similarity is  tensor(0.9693, device='cuda:0')
test acc is  0.8628166668229894
test loss is 1.3969185300219034
test entropy is  0.8559025094580295
________________________________
distance 1 is tensor(130.3984, device='cuda:0')
distance 2 is tensor(11.2912, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8554521338390643
avg test loss is  1.4013977503217359
avg accuracy is  0.8628833334896561
solo acc is  0.23545000015633777
compute similarity  is  tensor(0.9693, device='cuda:0')
compute_distance is  tensor(11.2912, device='cuda:0')
compute_norm is  tensor(54.3908, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.4117, device='cuda:0')
distance 2 is tensor(11.3746, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8557692831004861
avg test loss is  1.3870077100771068
avg accuracy is  0.8607166668229895
solo acc is  0.23378333348967104
compute similarity  is  tensor(0.9691, device='cuda:0')
compute_distance is  tensor(11.3746, device='cuda:0')
compute_norm is  tensor(54.1356, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.3835, device='cuda:0')
distance 2 is tensor(11.4519, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8492823700660835
avg test loss is  1.3714358248054854
avg accuracy is  0.8637500001563228
solo acc is  0.23536666682300444
compute similarity  is  tensor(0.9690, device='cuda:0')
compute_distance is  tensor(11.4519, device='cuda:0')
compute_norm is  tensor(53.8835, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.4287, device='cuda:0')
distance 2 is tensor(11.5307, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8462726703839007
avg test loss is  1.363440032961018
avg accuracy is  0.8663000001563226
solo acc is  0.23201666682300434
compute similarity  is  tensor(0.9688, device='cuda:0')
compute_distance is  tensor(11.5307, device='cuda:0')
compute_norm is  tensor(53.6320, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.4719, device='cuda:0')
distance 2 is tensor(11.6093, device='cuda:0')
exit early
distance 1 is tensor(134.4719, device='cuda:0')
distance 2 is tensor(11.6093, device='cuda:0')
________________________________
test distance is  tensor(11.6093, device='cuda:0')
test similarity is  tensor(0.9687, device='cuda:0')
test acc is  0.8654000001563228
test loss is 1.3614175627226515
test entropy is  0.8358121375158143
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.1417582035064697
mal norm is  tensor(6.2446, device='cuda:0')
distance 1 is tensor(134.4719, device='cuda:0')
distance 2 is tensor(11.6093, device='cuda:0')
mal distance is  tensor(11.6093, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1281, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(496.8534, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.6119, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(468.2072, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.5823e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(462.8261, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.7132e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(554.4835, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.1629e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.8817, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.6780e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(422.1092, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.0928, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4637, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.9980e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.2222, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.1534e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.7610, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.4307e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.2985, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.6587, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.6062e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.4153, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.5964, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.6935e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.9222, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.4207e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.2173, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.0595e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.6521, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.3331, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.1921e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.0121, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.1218e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.2014, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.8171e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.6248, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.6561, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.7050, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.3229e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.5522, device='cuda:0')
c is  tensor(0.0144, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.2674e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.9672, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.4145e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.4601, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4420, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.4794, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.2937e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.0238, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.9090, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.8613, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.1401e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.3223, device='cuda:0')
c is  tensor(0.0136, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.4694, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.5831e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.4383, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.2002, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.6436, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6312e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.5859, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.1865e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.3105, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.0654, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3545e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.3759, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.7383e-05, device='cuda:0')
len accept list 17
len all weights is 17
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 91.25% 

Test Accuracy: 89.63% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3632199168205261
distance 1 is tensor(133.0408, device='cuda:0')
distance 2 is tensor(9.6330, device='cuda:0')
benign distance is  tensor(9.6330, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.27026137709617615
distance 1 is tensor(132.7097, device='cuda:0')
distance 2 is tensor(9.4825, device='cuda:0')
benign distance is  tensor(9.4825, device='cuda:0')
norm1 res is  tensor(0.1326, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.15028592944145203
distance 1 is tensor(116.3156, device='cuda:0')
distance 2 is tensor(8.4091, device='cuda:0')
benign distance is  tensor(8.4091, device='cuda:0')
norm1 res is  tensor(0.1176, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.5792558789253235
distance 1 is tensor(130.0548, device='cuda:0')
distance 2 is tensor(9.3348, device='cuda:0')
benign distance is  tensor(9.3348, device='cuda:0')
norm1 res is  tensor(0.1314, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.4206969738006592
distance 1 is tensor(123.1045, device='cuda:0')
distance 2 is tensor(8.8242, device='cuda:0')
benign distance is  tensor(8.8242, device='cuda:0')
norm1 res is  tensor(0.1248, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.30670005083084106
distance 1 is tensor(155.9364, device='cuda:0')
distance 2 is tensor(11.1841, device='cuda:0')
benign distance is  tensor(11.1841, device='cuda:0')
norm1 res is  tensor(0.1612, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.5569910407066345
distance 1 is tensor(113.8271, device='cuda:0')
distance 2 is tensor(8.0581, device='cuda:0')
benign distance is  tensor(8.0581, device='cuda:0')
norm1 res is  tensor(0.1143, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.30201631784439087
distance 1 is tensor(147.6161, device='cuda:0')
distance 2 is tensor(10.4989, device='cuda:0')
benign distance is  tensor(10.4989, device='cuda:0')
norm1 res is  tensor(0.1479, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.4384300112724304
distance 1 is tensor(133.2691, device='cuda:0')
distance 2 is tensor(9.4225, device='cuda:0')
benign distance is  tensor(9.4225, device='cuda:0')
norm1 res is  tensor(0.1349, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.6176872253417969
distance 1 is tensor(145.7947, device='cuda:0')
distance 2 is tensor(10.3822, device='cuda:0')
benign distance is  tensor(10.3822, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.25120192766189575
distance 1 is tensor(144.1483, device='cuda:0')
distance 2 is tensor(10.2177, device='cuda:0')
benign distance is  tensor(10.2177, device='cuda:0')
norm1 res is  tensor(0.1458, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5010689496994019
distance 1 is tensor(137.6009, device='cuda:0')
distance 2 is tensor(9.9364, device='cuda:0')
benign distance is  tensor(9.9364, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.4010002017021179
distance 1 is tensor(125.3169, device='cuda:0')
distance 2 is tensor(9.0323, device='cuda:0')
benign distance is  tensor(9.0323, device='cuda:0')
norm1 res is  tensor(0.1283, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.09567112475633621
distance 1 is tensor(135.9765, device='cuda:0')
distance 2 is tensor(9.7357, device='cuda:0')
benign distance is  tensor(9.7357, device='cuda:0')
norm1 res is  tensor(0.1381, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.49699172377586365
distance 1 is tensor(139.2111, device='cuda:0')
distance 2 is tensor(10.0550, device='cuda:0')
benign distance is  tensor(10.0550, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.8712905049324036
distance 1 is tensor(138.4646, device='cuda:0')
distance 2 is tensor(9.9676, device='cuda:0')
benign distance is  tensor(9.9676, device='cuda:0')
norm1 res is  tensor(0.1431, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.32322263717651367
distance 1 is tensor(143.2036, device='cuda:0')
distance 2 is tensor(10.3557, device='cuda:0')
benign distance is  tensor(10.3557, device='cuda:0')
norm1 res is  tensor(0.1468, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.39674633741378784
distance 1 is tensor(148.0411, device='cuda:0')
distance 2 is tensor(10.7775, device='cuda:0')
benign distance is  tensor(10.7775, device='cuda:0')
norm1 res is  tensor(0.1533, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.3939777612686157
distance 1 is tensor(128.6855, device='cuda:0')
distance 2 is tensor(9.3573, device='cuda:0')
benign distance is  tensor(9.3573, device='cuda:0')
norm1 res is  tensor(0.1303, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.2413620948791504
distance 1 is tensor(130.3595, device='cuda:0')
distance 2 is tensor(9.4261, device='cuda:0')
benign distance is  tensor(9.4261, device='cuda:0')
norm1 res is  tensor(0.1349, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.2712855339050293
distance 1 is tensor(130.3072, device='cuda:0')
distance 2 is tensor(9.3866, device='cuda:0')
benign distance is  tensor(9.3866, device='cuda:0')
norm1 res is  tensor(0.1315, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.5658611059188843
distance 1 is tensor(149.8857, device='cuda:0')
distance 2 is tensor(10.6453, device='cuda:0')
benign distance is  tensor(10.6453, device='cuda:0')
norm1 res is  tensor(0.1537, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.20960934460163116
distance 1 is tensor(136.0973, device='cuda:0')
distance 2 is tensor(9.8969, device='cuda:0')
benign distance is  tensor(9.8969, device='cuda:0')
norm1 res is  tensor(0.1394, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.35362258553504944
distance 1 is tensor(135.6637, device='cuda:0')
distance 2 is tensor(9.7298, device='cuda:0')
benign distance is  tensor(9.7298, device='cuda:0')
norm1 res is  tensor(0.1376, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.18192562460899353
distance 1 is tensor(143.8932, device='cuda:0')
distance 2 is tensor(10.1981, device='cuda:0')
benign distance is  tensor(10.1981, device='cuda:0')
norm1 res is  tensor(0.1441, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.5407963395118713
distance 1 is tensor(135.2088, device='cuda:0')
distance 2 is tensor(9.5442, device='cuda:0')
benign distance is  tensor(9.5442, device='cuda:0')
norm1 res is  tensor(0.1316, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.3974417746067047
distance 1 is tensor(151.1639, device='cuda:0')
distance 2 is tensor(10.8135, device='cuda:0')
benign distance is  tensor(10.8135, device='cuda:0')
norm1 res is  tensor(0.1532, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.4103434979915619
distance 1 is tensor(147.4517, device='cuda:0')
distance 2 is tensor(10.6163, device='cuda:0')
benign distance is  tensor(10.6163, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.3049108982086182
distance 1 is tensor(137.8583, device='cuda:0')
distance 2 is tensor(9.7946, device='cuda:0')
benign distance is  tensor(9.7946, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.19973495602607727
distance 1 is tensor(143.4070, device='cuda:0')
distance 2 is tensor(10.2243, device='cuda:0')
benign distance is  tensor(10.2243, device='cuda:0')
norm1 res is  tensor(0.1441, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.3772295415401459
distance 1 is tensor(146.8813, device='cuda:0')
distance 2 is tensor(10.5857, device='cuda:0')
benign distance is  tensor(10.5857, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.4642295241355896
distance 1 is tensor(143.0042, device='cuda:0')
distance 2 is tensor(10.3814, device='cuda:0')
benign distance is  tensor(10.3814, device='cuda:0')
norm1 res is  tensor(0.1466, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.4539090096950531
distance 1 is tensor(147.8883, device='cuda:0')
distance 2 is tensor(10.7459, device='cuda:0')
benign distance is  tensor(10.7459, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.5002349019050598
distance 1 is tensor(129.3203, device='cuda:0')
distance 2 is tensor(9.1493, device='cuda:0')
benign distance is  tensor(9.1493, device='cuda:0')
norm1 res is  tensor(0.1295, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.42678728699684143
distance 1 is tensor(142.2963, device='cuda:0')
distance 2 is tensor(10.1045, device='cuda:0')
benign distance is  tensor(10.1045, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.3206510543823242
distance 1 is tensor(145.5413, device='cuda:0')
distance 2 is tensor(10.5020, device='cuda:0')
benign distance is  tensor(10.5020, device='cuda:0')
norm1 res is  tensor(0.1503, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.30040106177330017
distance 1 is tensor(123.5074, device='cuda:0')
distance 2 is tensor(8.7698, device='cuda:0')
benign distance is  tensor(8.7698, device='cuda:0')
norm1 res is  tensor(0.1251, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.2589022219181061
distance 1 is tensor(147.2872, device='cuda:0')
distance 2 is tensor(10.6453, device='cuda:0')
benign distance is  tensor(10.6453, device='cuda:0')
norm1 res is  tensor(0.1495, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.5113836526870728
distance 1 is tensor(138.4274, device='cuda:0')
distance 2 is tensor(9.8227, device='cuda:0')
benign distance is  tensor(9.8227, device='cuda:0')
norm1 res is  tensor(0.1403, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.3308568596839905
distance 1 is tensor(139.5909, device='cuda:0')
distance 2 is tensor(10.0061, device='cuda:0')
benign distance is  tensor(10.0061, device='cuda:0')
norm1 res is  tensor(0.1451, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(161.0707, device='cuda:0')
distance 2 is tensor(11.6718, device='cuda:0')
compute distance is  tensor(11.6718, device='cuda:0')
compute norm is  tensor(54.7360, device='cuda:0')
distance 1 is tensor(161.9853, device='cuda:0')
distance 2 is tensor(11.5489, device='cuda:0')
compute distance is  tensor(11.5489, device='cuda:0')
compute norm is  tensor(54.6959, device='cuda:0')
distance 1 is tensor(166.0055, device='cuda:0')
distance 2 is tensor(11.8595, device='cuda:0')
compute distance is  tensor(11.8595, device='cuda:0')
compute norm is  tensor(54.9161, device='cuda:0')
distance 1 is tensor(165.1423, device='cuda:0')
distance 2 is tensor(11.6226, device='cuda:0')
compute distance is  tensor(11.6226, device='cuda:0')
compute norm is  tensor(54.8368, device='cuda:0')
distance 1 is tensor(169.3938, device='cuda:0')
distance 2 is tensor(12.1418, device='cuda:0')
compute distance is  tensor(12.1418, device='cuda:0')
compute norm is  tensor(55.0499, device='cuda:0')
distance 1 is tensor(169.9491, device='cuda:0')
distance 2 is tensor(12.1013, device='cuda:0')
compute distance is  tensor(12.1013, device='cuda:0')
compute norm is  tensor(54.9804, device='cuda:0')
distance 1 is tensor(153.6980, device='cuda:0')
distance 2 is tensor(10.9746, device='cuda:0')
compute distance is  tensor(10.9746, device='cuda:0')
compute norm is  tensor(54.5799, device='cuda:0')
distance 1 is tensor(158.6765, device='cuda:0')
distance 2 is tensor(11.3590, device='cuda:0')
compute distance is  tensor(11.3590, device='cuda:0')
compute norm is  tensor(54.6712, device='cuda:0')
distance 1 is tensor(165.6141, device='cuda:0')
distance 2 is tensor(11.8700, device='cuda:0')
compute distance is  tensor(11.8700, device='cuda:0')
compute norm is  tensor(55.1320, device='cuda:0')
distance 1 is tensor(163.1293, device='cuda:0')
distance 2 is tensor(11.6815, device='cuda:0')
compute distance is  tensor(11.6815, device='cuda:0')
compute norm is  tensor(54.9950, device='cuda:0')
distance 1 is tensor(167.9293, device='cuda:0')
distance 2 is tensor(11.9383, device='cuda:0')
compute distance is  tensor(11.9383, device='cuda:0')
compute norm is  tensor(55.0315, device='cuda:0')
distance 1 is tensor(172.0761, device='cuda:0')
distance 2 is tensor(12.2450, device='cuda:0')
compute distance is  tensor(12.2450, device='cuda:0')
compute norm is  tensor(55.0974, device='cuda:0')
distance Threshold  is  tensor(12.2450, device='cuda:0')
distance 1 is tensor(1009135., device='cuda:0')
distance 2 is tensor(73613.2891, device='cuda:0')
________________________________
test distance is  tensor(73613.2891, device='cuda:0')
test similarity is  tensor(0.2213, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.819948256556466e+17
test entropy is  0.0
________________________________
cal ratio is  0.011607622993891774
distance 1 is tensor(11713.6631, device='cuda:0')
distance 2 is tensor(854.4753, device='cuda:0')
cal_distance is  tensor(854.4753, device='cuda:0')
cal ratio is  0.10773868093848332
distance 1 is tensor(1262.0200, device='cuda:0')
distance 2 is tensor(92.0600, device='cuda:0')
cal_distance is  tensor(92.0600, device='cuda:0')
cal ratio is  0.3282357253855269
distance 1 is tensor(414.2441, device='cuda:0')
distance 2 is tensor(30.2174, device='cuda:0')
cal_distance is  tensor(30.2174, device='cuda:0')
cal ratio is  0.572918609586947
distance 1 is tensor(237.3307, device='cuda:0')
distance 2 is tensor(17.3121, device='cuda:0')
cal_distance is  tensor(17.3121, device='cuda:0')
cal ratio is  0.7569138379767724
distance 1 is tensor(179.6404, device='cuda:0')
distance 2 is tensor(13.1038, device='cuda:0')
cal_distance is  tensor(13.1038, device='cuda:0')
cal ratio is  0.8700080109506955
distance 1 is tensor(156.2893, device='cuda:0')
distance 2 is tensor(11.4004, device='cuda:0')
cal_distance is  tensor(11.4004, device='cuda:0')
distance 1 is tensor(156.2893, device='cuda:0')
distance 2 is tensor(11.4004, device='cuda:0')
________________________________
test distance is  tensor(11.4004, device='cuda:0')
test similarity is  tensor(0.9598, device='cuda:0')
test acc is  0.865183333489656
test loss is 38.72246862220357
test entropy is  0.033058045188715655
________________________________
distance 1 is tensor(156.2893, device='cuda:0')
distance 2 is tensor(11.4004, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.034102896283289344
avg test loss is  38.78749630242777
avg accuracy is  0.8667000001563226
solo acc is  0.33896666682300697
compute similarity  is  tensor(0.9598, device='cuda:0')
compute_distance is  tensor(11.4004, device='cuda:0')
compute_norm is  tensor(57.0187, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.7119, device='cuda:0')
distance 2 is tensor(12.5269, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9177230001131355
avg test loss is  1.3991813153854564
avg accuracy is  0.8555666668229898
solo acc is  0.3028666668230062
compute similarity  is  tensor(0.9598, device='cuda:0')
compute_distance is  tensor(12.5269, device='cuda:0')
compute_norm is  tensor(56.4351, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.1826, device='cuda:0')
distance 2 is tensor(12.6579, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8876179976503986
avg test loss is  1.4730751088687353
avg accuracy is  0.8539333334896566
solo acc is  0.24405000015633807
compute similarity  is  tensor(0.9596, device='cuda:0')
compute_distance is  tensor(12.6579, device='cuda:0')
compute_norm is  tensor(56.1592, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.6480, device='cuda:0')
distance 2 is tensor(12.7388, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8886744167123523
avg test loss is  1.4391507581352934
avg accuracy is  0.8517166668229899
solo acc is  0.2458166668230048
compute similarity  is  tensor(0.9594, device='cuda:0')
compute_distance is  tensor(12.7388, device='cuda:0')
compute_norm is  tensor(55.8898, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.1073, device='cuda:0')
distance 2 is tensor(12.8033, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8761154274061036
avg test loss is  1.4265256618131708
avg accuracy is  0.8560666668229896
solo acc is  0.24420000015633803
compute similarity  is  tensor(0.9593, device='cuda:0')
compute_distance is  tensor(12.8033, device='cuda:0')
compute_norm is  tensor(55.6265, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.5800, device='cuda:0')
distance 2 is tensor(12.8574, device='cuda:0')
________________________________
test distance is  tensor(12.8574, device='cuda:0')
test similarity is  tensor(0.9592, device='cuda:0')
test acc is  0.8544500001563231
test loss is 1.414243332231477
test entropy is  0.8733960582630467
________________________________
cal ratio is  0.8783052296835357
distance 1 is tensor(131.3777, device='cuda:0')
distance 2 is tensor(11.2927, device='cuda:0')
cal_distance is  tensor(11.2927, device='cuda:0')
distance 1 is tensor(131.3777, device='cuda:0')
distance 2 is tensor(11.2927, device='cuda:0')
________________________________
test distance is  tensor(11.2927, device='cuda:0')
test similarity is  tensor(0.9678, device='cuda:0')
test acc is  0.8730000001563224
test loss is 1.0422408230014955
test entropy is  1.016666719717766
________________________________
distance 1 is tensor(131.3777, device='cuda:0')
distance 2 is tensor(11.2927, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0164640727582008
avg test loss is  1.044991544441882
avg accuracy is  0.872166666822989
solo acc is  0.495400000156342
compute similarity  is  tensor(0.9678, device='cuda:0')
compute_distance is  tensor(11.2927, device='cuda:0')
compute_norm is  tensor(54.9943, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.2943, device='cuda:0')
distance 2 is tensor(11.5453, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8606385454567257
avg test loss is  1.4110087813344845
avg accuracy is  0.8661833334896559
solo acc is  0.240000000156338
compute similarity  is  tensor(0.9673, device='cuda:0')
compute_distance is  tensor(11.5453, device='cuda:0')
compute_norm is  tensor(54.7386, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.2926, device='cuda:0')
distance 2 is tensor(11.6393, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8527451128974907
avg test loss is  1.3997412105358995
avg accuracy is  0.8667000001563226
solo acc is  0.2375833334896712
compute similarity  is  tensor(0.9671, device='cuda:0')
compute_distance is  tensor(11.6393, device='cuda:0')
compute_norm is  tensor(54.4816, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.2266, device='cuda:0')
distance 2 is tensor(11.7192, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.854284803369152
avg test loss is  1.3830755578556548
avg accuracy is  0.8672666668229893
solo acc is  0.23870000015633785
compute similarity  is  tensor(0.9669, device='cuda:0')
compute_distance is  tensor(11.7192, device='cuda:0')
compute_norm is  tensor(54.2258, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.1790, device='cuda:0')
distance 2 is tensor(11.7978, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8552435959961369
avg test loss is  1.3740204727090497
avg accuracy is  0.8674333334896559
solo acc is  0.23335000015633775
compute similarity  is  tensor(0.9668, device='cuda:0')
compute_distance is  tensor(11.7978, device='cuda:0')
compute_norm is  tensor(53.9710, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.1669, device='cuda:0')
distance 2 is tensor(11.8712, device='cuda:0')
________________________________
test distance is  tensor(11.8712, device='cuda:0')
test similarity is  tensor(0.9666, device='cuda:0')
test acc is  0.8688333334896559
test loss is 1.3675056471626388
test entropy is  0.8447652940811125
________________________________
distance 1 is tensor(137.1669, device='cuda:0')
distance 2 is tensor(11.8712, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8460114875327803
avg test loss is  1.3693322572372615
avg accuracy is  0.8690000001563225
solo acc is  0.2341666668230044
compute similarity  is  tensor(0.9666, device='cuda:0')
compute_distance is  tensor(11.8712, device='cuda:0')
compute_norm is  tensor(53.7203, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.1222, device='cuda:0')
distance 2 is tensor(11.9426, device='cuda:0')
exit early
distance 1 is tensor(138.1222, device='cuda:0')
distance 2 is tensor(11.9426, device='cuda:0')
________________________________
test distance is  tensor(11.9426, device='cuda:0')
test similarity is  tensor(0.9665, device='cuda:0')
test acc is  0.8705666668229891
test loss is 1.361005590287353
test entropy is  0.8404738087135591
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.4208509922027588
mal norm is  tensor(6.4690, device='cuda:0')
distance 1 is tensor(138.1222, device='cuda:0')
distance 2 is tensor(11.9426, device='cuda:0')
mal distance is  tensor(11.9426, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1353, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.6480, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.5226e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.9827, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(463.9221, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.1852, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.1780, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.5088, device='cuda:0')
c is  tensor(0.0146, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.2121e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(450.2682, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.4733, device='cuda:0')
c is  tensor(0.0152, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2749e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8973, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
len accept list 6
len all weights is 6
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 91.22% 

Test Accuracy: 89.46% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1987120807170868
distance 1 is tensor(108.8659, device='cuda:0')
distance 2 is tensor(8.0395, device='cuda:0')
benign distance is  tensor(8.0395, device='cuda:0')
norm1 res is  tensor(0.1150, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.3370993733406067
distance 1 is tensor(136.3361, device='cuda:0')
distance 2 is tensor(9.6819, device='cuda:0')
benign distance is  tensor(9.6819, device='cuda:0')
norm1 res is  tensor(0.1378, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.022324131801724434
distance 1 is tensor(110.3851, device='cuda:0')
distance 2 is tensor(7.8811, device='cuda:0')
benign distance is  tensor(7.8811, device='cuda:0')
norm1 res is  tensor(0.1127, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.35307151079177856
distance 1 is tensor(131.6289, device='cuda:0')
distance 2 is tensor(9.4062, device='cuda:0')
benign distance is  tensor(9.4062, device='cuda:0')
norm1 res is  tensor(0.1315, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5331130027770996
distance 1 is tensor(140.6465, device='cuda:0')
distance 2 is tensor(10.0410, device='cuda:0')
benign distance is  tensor(10.0410, device='cuda:0')
norm1 res is  tensor(0.1411, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.43815502524375916
distance 1 is tensor(139.8174, device='cuda:0')
distance 2 is tensor(9.8964, device='cuda:0')
benign distance is  tensor(9.8964, device='cuda:0')
norm1 res is  tensor(0.1452, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.520647406578064
distance 1 is tensor(87.2211, device='cuda:0')
distance 2 is tensor(6.2807, device='cuda:0')
benign distance is  tensor(6.2807, device='cuda:0')
norm1 res is  tensor(0.0874, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.26610714197158813
distance 1 is tensor(124.4631, device='cuda:0')
distance 2 is tensor(9.0502, device='cuda:0')
benign distance is  tensor(9.0502, device='cuda:0')
norm1 res is  tensor(0.1302, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(157.9572, device='cuda:0')
distance 2 is tensor(11.0775, device='cuda:0')
compute distance is  tensor(11.0775, device='cuda:0')
compute norm is  tensor(54.6080, device='cuda:0')
distance 1 is tensor(162.3440, device='cuda:0')
distance 2 is tensor(11.5817, device='cuda:0')
compute distance is  tensor(11.5817, device='cuda:0')
compute norm is  tensor(54.7927, device='cuda:0')
distance 1 is tensor(153.6846, device='cuda:0')
distance 2 is tensor(10.9423, device='cuda:0')
compute distance is  tensor(10.9423, device='cuda:0')
compute norm is  tensor(54.7097, device='cuda:0')
distance 1 is tensor(157.7164, device='cuda:0')
distance 2 is tensor(11.2035, device='cuda:0')
compute distance is  tensor(11.2035, device='cuda:0')
compute norm is  tensor(54.6972, device='cuda:0')
distance 1 is tensor(158.9578, device='cuda:0')
distance 2 is tensor(11.4905, device='cuda:0')
compute distance is  tensor(11.4905, device='cuda:0')
compute norm is  tensor(54.8385, device='cuda:0')
distance 1 is tensor(162.7860, device='cuda:0')
distance 2 is tensor(11.8097, device='cuda:0')
compute distance is  tensor(11.8097, device='cuda:0')
compute norm is  tensor(54.9722, device='cuda:0')
distance 1 is tensor(155.9114, device='cuda:0')
distance 2 is tensor(11.3520, device='cuda:0')
compute distance is  tensor(11.3520, device='cuda:0')
compute norm is  tensor(54.7584, device='cuda:0')
distance 1 is tensor(148.8920, device='cuda:0')
distance 2 is tensor(10.7821, device='cuda:0')
compute distance is  tensor(10.7821, device='cuda:0')
compute norm is  tensor(54.7472, device='cuda:0')
distance 1 is tensor(153.8754, device='cuda:0')
distance 2 is tensor(10.8439, device='cuda:0')
compute distance is  tensor(10.8439, device='cuda:0')
compute norm is  tensor(54.7087, device='cuda:0')
distance 1 is tensor(158.5283, device='cuda:0')
distance 2 is tensor(11.3763, device='cuda:0')
compute distance is  tensor(11.3763, device='cuda:0')
compute norm is  tensor(54.8349, device='cuda:0')
distance 1 is tensor(162.8871, device='cuda:0')
distance 2 is tensor(11.6162, device='cuda:0')
compute distance is  tensor(11.6162, device='cuda:0')
compute norm is  tensor(54.9659, device='cuda:0')
distance 1 is tensor(164.3296, device='cuda:0')
distance 2 is tensor(11.6837, device='cuda:0')
compute distance is  tensor(11.6837, device='cuda:0')
compute norm is  tensor(54.9573, device='cuda:0')
distance Threshold  is  tensor(11.8097, device='cuda:0')
distance 1 is tensor(1009137.6875, device='cuda:0')
distance 2 is tensor(73613.5938, device='cuda:0')
________________________________
test distance is  tensor(73613.5938, device='cuda:0')
test similarity is  tensor(0.2094, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.826758531430163e+17
test entropy is  0.0
________________________________
cal ratio is  0.011399444616066508
distance 1 is tensor(11503.6152, device='cuda:0')
distance 2 is tensor(839.1539, device='cuda:0')
cal_distance is  tensor(839.1539, device='cuda:0')
cal ratio is  0.10676818962623373
distance 1 is tensor(1228.2256, device='cuda:0')
distance 2 is tensor(89.5949, device='cuda:0')
cal_distance is  tensor(89.5949, device='cuda:0')
cal ratio is  0.326754011005513
distance 1 is tensor(401.3317, device='cuda:0')
distance 2 is tensor(29.2755, device='cuda:0')
cal_distance is  tensor(29.2755, device='cuda:0')
cal ratio is  0.5716240050655259
distance 1 is tensor(229.4134, device='cuda:0')
distance 2 is tensor(16.7346, device='cuda:0')
cal_distance is  tensor(16.7346, device='cuda:0')
cal ratio is  0.7560581886172992
distance 1 is tensor(173.4513, device='cuda:0')
distance 2 is tensor(12.6523, device='cuda:0')
cal_distance is  tensor(12.6523, device='cuda:0')
cal ratio is  0.8695161165221197
distance 1 is tensor(150.8195, device='cuda:0')
distance 2 is tensor(11.0014, device='cuda:0')
cal_distance is  tensor(11.0014, device='cuda:0')
distance 1 is tensor(150.8195, device='cuda:0')
distance 2 is tensor(11.0014, device='cuda:0')
________________________________
test distance is  tensor(11.0014, device='cuda:0')
test similarity is  tensor(0.9626, device='cuda:0')
test acc is  0.8735500001563223
test loss is 31.07395159206919
test entropy is  0.03712715315215512
________________________________
distance 1 is tensor(150.8195, device='cuda:0')
distance 2 is tensor(11.0014, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.03585713205790556
avg test loss is  30.794623537612622
avg accuracy is  0.872366666822989
solo acc is  0.40621666682300783
compute similarity  is  tensor(0.9626, device='cuda:0')
compute_distance is  tensor(11.0014, device='cuda:0')
compute_norm is  tensor(57.3563, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(144.1357, device='cuda:0')
distance 2 is tensor(12.3424, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9410978875943085
avg test loss is  1.3973584049291956
avg accuracy is  0.8546500001563231
solo acc is  0.30250000015633954
compute similarity  is  tensor(0.9619, device='cuda:0')
compute_distance is  tensor(12.3424, device='cuda:0')
compute_norm is  tensor(56.7006, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.0642, device='cuda:0')
distance 2 is tensor(12.5016, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8932483890163365
avg test loss is  1.477616981529732
avg accuracy is  0.8527833334896564
solo acc is  0.2455500001563381
compute similarity  is  tensor(0.9616, device='cuda:0')
compute_distance is  tensor(12.5016, device='cuda:0')
compute_norm is  tensor(56.4169, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.8109, device='cuda:0')
distance 2 is tensor(12.6007, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8824949203523745
avg test loss is  1.4584506654790215
avg accuracy is  0.8524166668229899
solo acc is  0.23816666682300452
compute similarity  is  tensor(0.9614, device='cuda:0')
compute_distance is  tensor(12.6007, device='cuda:0')
compute_norm is  tensor(56.1415, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.5625, device='cuda:0')
distance 2 is tensor(12.6792, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8811710072097494
avg test loss is  1.4350476646219998
avg accuracy is  0.8540833334896566
solo acc is  0.2392166668230046
compute similarity  is  tensor(0.9612, device='cuda:0')
compute_distance is  tensor(12.6792, device='cuda:0')
compute_norm is  tensor(55.8716, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.3428, device='cuda:0')
distance 2 is tensor(12.7539, device='cuda:0')
________________________________
test distance is  tensor(12.7539, device='cuda:0')
test similarity is  tensor(0.9611, device='cuda:0')
test acc is  0.8544500001563231
test loss is 1.430087731972432
test entropy is  0.869231099894306
________________________________
cal ratio is  0.8660458282035467
distance 1 is tensor(127.6064, device='cuda:0')
distance 2 is tensor(11.0455, device='cuda:0')
cal_distance is  tensor(11.0455, device='cuda:0')
distance 1 is tensor(127.6064, device='cuda:0')
distance 2 is tensor(11.0455, device='cuda:0')
________________________________
test distance is  tensor(11.0455, device='cuda:0')
test similarity is  tensor(0.9702, device='cuda:0')
test acc is  0.8737666668229891
test loss is 1.0298324651809643
test entropy is  1.0352563935556391
________________________________
distance 1 is tensor(127.6064, device='cuda:0')
distance 2 is tensor(11.0455, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0318907946665912
avg test loss is  1.0287672378488186
avg accuracy is  0.8755666668229889
solo acc is  0.5123000001563423
compute similarity  is  tensor(0.9702, device='cuda:0')
compute_distance is  tensor(11.0455, device='cuda:0')
compute_norm is  tensor(55.2533, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.9449, device='cuda:0')
distance 2 is tensor(11.3406, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8648635140105859
avg test loss is  1.4144041492486559
avg accuracy is  0.8682833334896558
solo acc is  0.23918333348967125
compute similarity  is  tensor(0.9696, device='cuda:0')
compute_distance is  tensor(11.3406, device='cuda:0')
compute_norm is  tensor(54.9953, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.2560, device='cuda:0')
distance 2 is tensor(11.4518, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.858913151185904
avg test loss is  1.409374102600602
avg accuracy is  0.8686166668229892
solo acc is  0.23463333348967108
compute similarity  is  tensor(0.9694, device='cuda:0')
compute_distance is  tensor(11.4518, device='cuda:0')
compute_norm is  tensor(54.7335, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.4495, device='cuda:0')
distance 2 is tensor(11.5446, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8538314935876362
avg test loss is  1.3914702098761031
avg accuracy is  0.8713833334896557
solo acc is  0.23443333348967108
compute similarity  is  tensor(0.9692, device='cuda:0')
compute_distance is  tensor(11.5446, device='cuda:0')
compute_norm is  tensor(54.4750, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.6048, device='cuda:0')
distance 2 is tensor(11.6331, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8575909588891052
avg test loss is  1.3719230751747262
avg accuracy is  0.8716333334896559
solo acc is  0.2351666668230045
compute similarity  is  tensor(0.9690, device='cuda:0')
compute_distance is  tensor(11.6331, device='cuda:0')
compute_norm is  tensor(54.2201, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.7639, device='cuda:0')
distance 2 is tensor(11.7214, device='cuda:0')
________________________________
test distance is  tensor(11.7214, device='cuda:0')
test similarity is  tensor(0.9688, device='cuda:0')
test acc is  0.8728333334896557
test loss is 1.373223389770939
test entropy is  0.8506702759118476
________________________________
distance 1 is tensor(134.7639, device='cuda:0')
distance 2 is tensor(11.7214, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.850893472684726
avg test loss is  1.37544200529676
avg accuracy is  0.8729833334896557
solo acc is  0.22880000015633753
compute similarity  is  tensor(0.9688, device='cuda:0')
compute_distance is  tensor(11.7214, device='cuda:0')
compute_norm is  tensor(53.9669, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.8919, device='cuda:0')
distance 2 is tensor(11.7973, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8422153051982302
avg test loss is  1.364664850522206
avg accuracy is  0.8749500001563224
solo acc is  0.2293333334896709
compute similarity  is  tensor(0.9687, device='cuda:0')
compute_distance is  tensor(11.7973, device='cuda:0')
compute_norm is  tensor(53.7164, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.0218, device='cuda:0')
distance 2 is tensor(11.8786, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8411114480830967
avg test loss is  1.3531147888474373
avg accuracy is  0.8744833334896556
solo acc is  0.23211666682300436
compute similarity  is  tensor(0.9685, device='cuda:0')
compute_distance is  tensor(11.8786, device='cuda:0')
compute_norm is  tensor(53.4670, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.2027, device='cuda:0')
distance 2 is tensor(11.9619, device='cuda:0')
exit early
distance 1 is tensor(138.2027, device='cuda:0')
distance 2 is tensor(11.9619, device='cuda:0')
________________________________
test distance is  tensor(11.9619, device='cuda:0')
test similarity is  tensor(0.9683, device='cuda:0')
test acc is  0.8758166668229889
test loss is 1.3528767861664168
test entropy is  0.8338069718148409
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1728360652923584
mal norm is  tensor(6.2472, device='cuda:0')
distance 1 is tensor(138.2027, device='cuda:0')
distance 2 is tensor(11.9619, device='cuda:0')
mal distance is  tensor(11.9619, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2069, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(452.0414, device='cuda:0')
c is  tensor(0.0214, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.4712e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.4178, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.8939e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(434.0547, device='cuda:0')
c is  tensor(0.0218, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.0746, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.8729, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.6781, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(348.3329, device='cuda:0')
c is  tensor(0.0244, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1529e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.4922, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.7173, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9450e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.5282, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.1755, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.8460, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.3177, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.6490, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.7236, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.0136, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.9075, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 3
len all weights is 3
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 91.08% 

Test Accuracy: 89.29% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2099728137254715
distance 1 is tensor(109.5863, device='cuda:0')
distance 2 is tensor(7.9755, device='cuda:0')
benign distance is  tensor(7.9755, device='cuda:0')
norm1 res is  tensor(0.1149, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6406983733177185
distance 1 is tensor(155.0233, device='cuda:0')
distance 2 is tensor(10.9312, device='cuda:0')
benign distance is  tensor(10.9312, device='cuda:0')
norm1 res is  tensor(0.1617, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.16389122605323792
distance 1 is tensor(119.3745, device='cuda:0')
distance 2 is tensor(8.5083, device='cuda:0')
benign distance is  tensor(8.5083, device='cuda:0')
norm1 res is  tensor(0.1266, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3420374393463135
distance 1 is tensor(143.2780, device='cuda:0')
distance 2 is tensor(10.2390, device='cuda:0')
benign distance is  tensor(10.2390, device='cuda:0')
norm1 res is  tensor(0.1460, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0891716480255127
distance 1 is tensor(140.8534, device='cuda:0')
distance 2 is tensor(9.9477, device='cuda:0')
benign distance is  tensor(9.9477, device='cuda:0')
norm1 res is  tensor(0.1406, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.11794153600931168
distance 1 is tensor(144.7280, device='cuda:0')
distance 2 is tensor(10.3478, device='cuda:0')
benign distance is  tensor(10.3478, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.517744779586792
distance 1 is tensor(121.6725, device='cuda:0')
distance 2 is tensor(8.6646, device='cuda:0')
benign distance is  tensor(8.6646, device='cuda:0')
norm1 res is  tensor(0.1232, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7908834218978882
distance 1 is tensor(130.7473, device='cuda:0')
distance 2 is tensor(9.3233, device='cuda:0')
benign distance is  tensor(9.3233, device='cuda:0')
norm1 res is  tensor(0.1323, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.24423523247241974
distance 1 is tensor(156.9414, device='cuda:0')
distance 2 is tensor(11.1196, device='cuda:0')
benign distance is  tensor(11.1196, device='cuda:0')
norm1 res is  tensor(0.1589, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.6478537321090698
distance 1 is tensor(147.8958, device='cuda:0')
distance 2 is tensor(10.6166, device='cuda:0')
benign distance is  tensor(10.6166, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.3888348639011383
distance 1 is tensor(147.2917, device='cuda:0')
distance 2 is tensor(10.4969, device='cuda:0')
benign distance is  tensor(10.4969, device='cuda:0')
norm1 res is  tensor(0.1460, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.07955415546894073
distance 1 is tensor(153.4970, device='cuda:0')
distance 2 is tensor(10.9113, device='cuda:0')
benign distance is  tensor(10.9113, device='cuda:0')
norm1 res is  tensor(0.1533, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.7004871368408203
distance 1 is tensor(151.5511, device='cuda:0')
distance 2 is tensor(10.9013, device='cuda:0')
benign distance is  tensor(10.9013, device='cuda:0')
norm1 res is  tensor(0.1598, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.07633320242166519
distance 1 is tensor(138.6373, device='cuda:0')
distance 2 is tensor(10.0031, device='cuda:0')
benign distance is  tensor(10.0031, device='cuda:0')
norm1 res is  tensor(0.1412, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.7014502286911011
distance 1 is tensor(134.8272, device='cuda:0')
distance 2 is tensor(9.6259, device='cuda:0')
benign distance is  tensor(9.6259, device='cuda:0')
norm1 res is  tensor(0.1412, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.9198160171508789
distance 1 is tensor(154.3000, device='cuda:0')
distance 2 is tensor(11.0612, device='cuda:0')
benign distance is  tensor(11.0612, device='cuda:0')
norm1 res is  tensor(0.1579, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(182.1361, device='cuda:0')
distance 2 is tensor(13.1819, device='cuda:0')
compute distance is  tensor(13.1819, device='cuda:0')
compute norm is  tensor(54.5201, device='cuda:0')
distance 1 is tensor(179.1675, device='cuda:0')
distance 2 is tensor(13.1403, device='cuda:0')
compute distance is  tensor(13.1403, device='cuda:0')
compute norm is  tensor(54.6084, device='cuda:0')
distance 1 is tensor(196.0439, device='cuda:0')
distance 2 is tensor(14.0923, device='cuda:0')
compute distance is  tensor(14.0923, device='cuda:0')
compute norm is  tensor(55.1220, device='cuda:0')
distance 1 is tensor(177.9679, device='cuda:0')
distance 2 is tensor(12.8674, device='cuda:0')
compute distance is  tensor(12.8674, device='cuda:0')
compute norm is  tensor(54.5420, device='cuda:0')
distance 1 is tensor(186.4801, device='cuda:0')
distance 2 is tensor(13.6032, device='cuda:0')
compute distance is  tensor(13.6032, device='cuda:0')
compute norm is  tensor(55.0283, device='cuda:0')
distance 1 is tensor(189.1375, device='cuda:0')
distance 2 is tensor(13.6169, device='cuda:0')
compute distance is  tensor(13.6169, device='cuda:0')
compute norm is  tensor(54.9897, device='cuda:0')
distance 1 is tensor(179.4037, device='cuda:0')
distance 2 is tensor(12.9785, device='cuda:0')
compute distance is  tensor(12.9785, device='cuda:0')
compute norm is  tensor(54.6265, device='cuda:0')
distance 1 is tensor(184.4066, device='cuda:0')
distance 2 is tensor(13.4947, device='cuda:0')
compute distance is  tensor(13.4947, device='cuda:0')
compute norm is  tensor(54.8346, device='cuda:0')
distance 1 is tensor(184.4908, device='cuda:0')
distance 2 is tensor(13.2754, device='cuda:0')
compute distance is  tensor(13.2754, device='cuda:0')
compute norm is  tensor(54.7676, device='cuda:0')
distance 1 is tensor(181.6219, device='cuda:0')
distance 2 is tensor(13.2331, device='cuda:0')
compute distance is  tensor(13.2331, device='cuda:0')
compute norm is  tensor(54.8146, device='cuda:0')
distance 1 is tensor(184.9836, device='cuda:0')
distance 2 is tensor(13.2817, device='cuda:0')
compute distance is  tensor(13.2817, device='cuda:0')
compute norm is  tensor(54.8122, device='cuda:0')
distance 1 is tensor(180.9457, device='cuda:0')
distance 2 is tensor(12.8960, device='cuda:0')
compute distance is  tensor(12.8960, device='cuda:0')
compute norm is  tensor(54.8993, device='cuda:0')
distance Threshold  is  tensor(14.0923, device='cuda:0')
distance 1 is tensor(1009138.1250, device='cuda:0')
distance 2 is tensor(73613.7188, device='cuda:0')
________________________________
test distance is  tensor(73613.7188, device='cuda:0')
test similarity is  tensor(0.2020, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.825277345747875e+17
test entropy is  0.0
________________________________
cal ratio is  0.012452429399378889
distance 1 is tensor(12566.2256, device='cuda:0')
distance 2 is tensor(916.6695, device='cuda:0')
cal_distance is  tensor(916.6695, device='cuda:0')
cal ratio is  0.11159046421171641
distance 1 is tensor(1402.2764, device='cuda:0')
distance 2 is tensor(102.2916, device='cuda:0')
cal_distance is  tensor(102.2916, device='cuda:0')
cal ratio is  0.3340515872182767
distance 1 is tensor(468.4367, device='cuda:0')
distance 2 is tensor(34.1707, device='cuda:0')
cal_distance is  tensor(34.1707, device='cuda:0')
cal ratio is  0.5779719384655402
distance 1 is tensor(270.7458, device='cuda:0')
distance 2 is tensor(19.7497, device='cuda:0')
cal_distance is  tensor(19.7497, device='cuda:0')
cal ratio is  0.7602446980001413
distance 1 is tensor(205.8345, device='cuda:0')
distance 2 is tensor(15.0146, device='cuda:0')
cal_distance is  tensor(15.0146, device='cuda:0')
cal ratio is  0.8719201014758948
distance 1 is tensor(179.4720, device='cuda:0')
distance 2 is tensor(13.0915, device='cuda:0')
cal_distance is  tensor(13.0915, device='cuda:0')
distance 1 is tensor(179.4720, device='cuda:0')
distance 2 is tensor(13.0915, device='cuda:0')
________________________________
test distance is  tensor(13.0915, device='cuda:0')
test similarity is  tensor(0.9495, device='cuda:0')
test acc is  0.8432666668229902
test loss is 105.58736095957155
test entropy is  0.014407137210730931
________________________________
distance 1 is tensor(179.4720, device='cuda:0')
distance 2 is tensor(13.0915, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.013865106058118666
avg test loss is  105.44564112518896
avg accuracy is  0.8423000001563236
solo acc is  0.21701666682300377
compute similarity  is  tensor(0.9495, device='cuda:0')
compute_distance is  tensor(13.0915, device='cuda:0')
compute_norm is  tensor(58.5726, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(168.4777, device='cuda:0')
distance 2 is tensor(14.3499, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9616621221179393
avg test loss is  1.4412067728256113
avg accuracy is  0.8156166668229914
solo acc is  0.2959833334896728
compute similarity  is  tensor(0.9501, device='cuda:0')
compute_distance is  tensor(14.3499, device='cuda:0')
compute_norm is  tensor(58.0839, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(169.1010, device='cuda:0')
distance 2 is tensor(14.4894, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8964627758145078
avg test loss is  1.5200194590635645
avg accuracy is  0.815033333489658
solo acc is  0.24151666682300468
compute similarity  is  tensor(0.9498, device='cuda:0')
compute_distance is  tensor(14.4894, device='cuda:0')
compute_norm is  tensor(57.7882, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(169.5646, device='cuda:0')
distance 2 is tensor(14.5670, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8897325889642305
avg test loss is  1.4953207482915443
avg accuracy is  0.8121333334896581
solo acc is  0.23178333348967103
compute similarity  is  tensor(0.9496, device='cuda:0')
compute_distance is  tensor(14.5670, device='cuda:0')
compute_norm is  tensor(57.5012, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(170.0800, device='cuda:0')
distance 2 is tensor(14.6315, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8857363898998131
avg test loss is  1.4721263772897375
avg accuracy is  0.8127666668229916
solo acc is  0.23028333348967092
compute similarity  is  tensor(0.9494, device='cuda:0')
compute_distance is  tensor(14.6315, device='cuda:0')
compute_norm is  tensor(57.2223, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(170.6164, device='cuda:0')
distance 2 is tensor(14.6860, device='cuda:0')
________________________________
test distance is  tensor(14.6860, device='cuda:0')
test similarity is  tensor(0.9492, device='cuda:0')
test acc is  0.8146833334896582
test loss is 1.4564566039073188
test entropy is  0.8766249611433635
________________________________
cal ratio is  0.8816212551843835
distance 1 is tensor(150.4198, device='cuda:0')
distance 2 is tensor(12.9475, device='cuda:0')
cal_distance is  tensor(12.9475, device='cuda:0')
distance 1 is tensor(150.4198, device='cuda:0')
distance 2 is tensor(12.9475, device='cuda:0')
________________________________
test distance is  tensor(12.9475, device='cuda:0')
test similarity is  tensor(0.9595, device='cuda:0')
test acc is  0.8346833334896573
test loss is 1.1142766098223769
test entropy is  1.0403835522467648
________________________________
distance 1 is tensor(150.4198, device='cuda:0')
distance 2 is tensor(12.9475, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0398600967581084
avg test loss is  1.1163526826830052
avg accuracy is  0.8375333334896572
solo acc is  0.44530000015634164
compute similarity  is  tensor(0.9595, device='cuda:0')
compute_distance is  tensor(12.9475, device='cuda:0')
compute_norm is  tensor(56.4801, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.1785, device='cuda:0')
distance 2 is tensor(13.1771, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8640246355711524
avg test loss is  1.4431969581890716
avg accuracy is  0.8301666668229908
solo acc is  0.23608333348967123
compute similarity  is  tensor(0.9590, device='cuda:0')
compute_distance is  tensor(13.1771, device='cuda:0')
compute_norm is  tensor(56.2150, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.1407, device='cuda:0')
distance 2 is tensor(13.2656, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8674766744759037
avg test loss is  1.4304432626217922
avg accuracy is  0.8312833334896574
solo acc is  0.23005000015633756
compute similarity  is  tensor(0.9588, device='cuda:0')
compute_distance is  tensor(13.2656, device='cuda:0')
compute_norm is  tensor(55.9445, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.0918, device='cuda:0')
distance 2 is tensor(13.3406, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8585218001149102
avg test loss is  1.4201416526394866
avg accuracy is  0.8315333334896574
solo acc is  0.22868333348967088
compute similarity  is  tensor(0.9586, device='cuda:0')
compute_distance is  tensor(13.3406, device='cuda:0')
compute_norm is  tensor(55.6787, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.9679, device='cuda:0')
distance 2 is tensor(13.4039, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8542592355818637
avg test loss is  1.4128262767913753
avg accuracy is  0.834350000156324
solo acc is  0.2241000001563374
compute similarity  is  tensor(0.9584, device='cuda:0')
compute_distance is  tensor(13.4039, device='cuda:0')
compute_norm is  tensor(55.4156, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.8725, device='cuda:0')
distance 2 is tensor(13.4668, device='cuda:0')
________________________________
test distance is  tensor(13.4668, device='cuda:0')
test similarity is  tensor(0.9583, device='cuda:0')
test acc is  0.8346333334896572
test loss is 1.4010617067056423
test entropy is  0.8497378500794043
________________________________
distance 1 is tensor(155.8725, device='cuda:0')
distance 2 is tensor(13.4668, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8517094500410531
avg test loss is  1.3978855261670502
avg accuracy is  0.8342166668229907
solo acc is  0.22553333348967075
compute similarity  is  tensor(0.9583, device='cuda:0')
compute_distance is  tensor(13.4668, device='cuda:0')
compute_norm is  tensor(55.1563, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.8019, device='cuda:0')
distance 2 is tensor(13.5293, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8520067831092297
avg test loss is  1.389122406684005
avg accuracy is  0.8364000001563237
solo acc is  0.22520000015633737
compute similarity  is  tensor(0.9581, device='cuda:0')
compute_distance is  tensor(13.5293, device='cuda:0')
compute_norm is  tensor(54.8984, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.7383, device='cuda:0')
distance 2 is tensor(13.5880, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.849596500142551
avg test loss is  1.3785872248444222
avg accuracy is  0.840583333489657
solo acc is  0.2273166668230042
compute similarity  is  tensor(0.9580, device='cuda:0')
compute_distance is  tensor(13.5880, device='cuda:0')
compute_norm is  tensor(54.6435, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.7359, device='cuda:0')
distance 2 is tensor(13.6523, device='cuda:0')
exit early
distance 1 is tensor(158.7359, device='cuda:0')
distance 2 is tensor(13.6523, device='cuda:0')
________________________________
test distance is  tensor(13.6523, device='cuda:0')
test similarity is  tensor(0.9579, device='cuda:0')
test acc is  0.841583333489657
test loss is 1.3815071614566388
test entropy is  0.8443857267467197
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.1936893463134766
mal norm is  tensor(7.3829, device='cuda:0')
distance 1 is tensor(158.7359, device='cuda:0')
distance 2 is tensor(13.6523, device='cuda:0')
mal distance is  tensor(13.6523, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.1945, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(446.7573, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.6599, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(472.5295, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.6742, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.3088e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(554.1096, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.9409e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.7200, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.3485e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(486.6913, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.7244, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.2211e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.2895, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.3398, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.2988e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.0922, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.7651, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.2679, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.9023, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.3185, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.2136, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.5475e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.2175, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 89.01% 

Test Accuracy: 87.48% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
 benign loss is  0.32561564445495605
distance 1 is tensor(126.2327, device='cuda:0')
distance 2 is tensor(9.3746, device='cuda:0')
benign distance is  tensor(9.3746, device='cuda:0')
norm1 res is  tensor(0.1326, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.57683265209198
distance 1 is tensor(136.5430, device='cuda:0')
distance 2 is tensor(9.8847, device='cuda:0')
benign distance is  tensor(9.8847, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.36369478702545166
distance 1 is tensor(133.8488, device='cuda:0')
distance 2 is tensor(9.6067, device='cuda:0')
benign distance is  tensor(9.6067, device='cuda:0')
norm1 res is  tensor(0.1336, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6749365925788879
distance 1 is tensor(154.0243, device='cuda:0')
distance 2 is tensor(11.1301, device='cuda:0')
benign distance is  tensor(11.1301, device='cuda:0')
norm1 res is  tensor(0.1531, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8561140894889832
distance 1 is tensor(147.3711, device='cuda:0')
distance 2 is tensor(10.6946, device='cuda:0')
benign distance is  tensor(10.6946, device='cuda:0')
norm1 res is  tensor(0.1468, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.048566222190857
distance 1 is tensor(174.9651, device='cuda:0')
distance 2 is tensor(12.5577, device='cuda:0')
benign distance is  tensor(12.5577, device='cuda:0')
norm1 res is  tensor(0.1767, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.09675491601228714
distance 1 is tensor(123.7246, device='cuda:0')
distance 2 is tensor(8.7548, device='cuda:0')
benign distance is  tensor(8.7548, device='cuda:0')
norm1 res is  tensor(0.1206, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.2989351451396942
distance 1 is tensor(161.1848, device='cuda:0')
distance 2 is tensor(11.5974, device='cuda:0')
benign distance is  tensor(11.5974, device='cuda:0')
norm1 res is  tensor(0.1646, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.37475818395614624
distance 1 is tensor(166.6589, device='cuda:0')
distance 2 is tensor(11.9359, device='cuda:0')
benign distance is  tensor(11.9359, device='cuda:0')
norm1 res is  tensor(0.1645, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.6776878833770752
distance 1 is tensor(162.1057, device='cuda:0')
distance 2 is tensor(11.7381, device='cuda:0')
benign distance is  tensor(11.7381, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.6779512763023376
distance 1 is tensor(158.6018, device='cuda:0')
distance 2 is tensor(11.4175, device='cuda:0')
benign distance is  tensor(11.4175, device='cuda:0')
norm1 res is  tensor(0.1578, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.3821864426136017
distance 1 is tensor(150.1607, device='cuda:0')
distance 2 is tensor(10.9331, device='cuda:0')
benign distance is  tensor(10.9331, device='cuda:0')
norm1 res is  tensor(0.1522, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.058031171560287476
distance 1 is tensor(152.7638, device='cuda:0')
distance 2 is tensor(10.9294, device='cuda:0')
benign distance is  tensor(10.9294, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8842713236808777
distance 1 is tensor(161.6955, device='cuda:0')
distance 2 is tensor(11.6017, device='cuda:0')
benign distance is  tensor(11.6017, device='cuda:0')
norm1 res is  tensor(0.1583, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.6183802485466003
distance 1 is tensor(187.7399, device='cuda:0')
distance 2 is tensor(13.4344, device='cuda:0')
benign distance is  tensor(13.4344, device='cuda:0')
norm1 res is  tensor(0.1840, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.4386209547519684
distance 1 is tensor(159.8168, device='cuda:0')
distance 2 is tensor(11.4555, device='cuda:0')
benign distance is  tensor(11.4555, device='cuda:0')
norm1 res is  tensor(0.1575, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(164.5363, device='cuda:0')
distance 2 is tensor(11.8523, device='cuda:0')
compute distance is  tensor(11.8523, device='cuda:0')
compute norm is  tensor(54.9863, device='cuda:0')
distance 1 is tensor(167.0950, device='cuda:0')
distance 2 is tensor(12.3033, device='cuda:0')
compute distance is  tensor(12.3033, device='cuda:0')
compute norm is  tensor(55.1039, device='cuda:0')
distance 1 is tensor(180.2892, device='cuda:0')
distance 2 is tensor(13.0198, device='cuda:0')
compute distance is  tensor(13.0198, device='cuda:0')
compute norm is  tensor(55.4514, device='cuda:0')
distance 1 is tensor(171.5002, device='cuda:0')
distance 2 is tensor(12.2479, device='cuda:0')
compute distance is  tensor(12.2479, device='cuda:0')
compute norm is  tensor(55.2036, device='cuda:0')
distance 1 is tensor(164.0806, device='cuda:0')
distance 2 is tensor(11.8024, device='cuda:0')
compute distance is  tensor(11.8024, device='cuda:0')
compute norm is  tensor(55.2198, device='cuda:0')
distance 1 is tensor(180.5451, device='cuda:0')
distance 2 is tensor(13.1072, device='cuda:0')
compute distance is  tensor(13.1072, device='cuda:0')
compute norm is  tensor(55.6217, device='cuda:0')
distance 1 is tensor(165.9107, device='cuda:0')
distance 2 is tensor(11.8670, device='cuda:0')
compute distance is  tensor(11.8670, device='cuda:0')
compute norm is  tensor(55.1099, device='cuda:0')
distance 1 is tensor(162.9411, device='cuda:0')
distance 2 is tensor(11.8168, device='cuda:0')
compute distance is  tensor(11.8168, device='cuda:0')
compute norm is  tensor(55.1213, device='cuda:0')
distance 1 is tensor(167.3371, device='cuda:0')
distance 2 is tensor(12.1417, device='cuda:0')
compute distance is  tensor(12.1417, device='cuda:0')
compute norm is  tensor(55.3498, device='cuda:0')
distance 1 is tensor(167.1226, device='cuda:0')
distance 2 is tensor(12.2721, device='cuda:0')
compute distance is  tensor(12.2721, device='cuda:0')
compute norm is  tensor(55.1285, device='cuda:0')
distance 1 is tensor(164.5725, device='cuda:0')
distance 2 is tensor(11.9603, device='cuda:0')
compute distance is  tensor(11.9603, device='cuda:0')
compute norm is  tensor(55.1961, device='cuda:0')
distance 1 is tensor(167.4712, device='cuda:0')
distance 2 is tensor(11.9610, device='cuda:0')
compute distance is  tensor(11.9610, device='cuda:0')
compute norm is  tensor(55.1939, device='cuda:0')
distance Threshold  is  tensor(13.1072, device='cuda:0')
distance 1 is tensor(1009096.3125, device='cuda:0')
distance 2 is tensor(73610.0938, device='cuda:0')
________________________________
test distance is  tensor(73610.0938, device='cuda:0')
test similarity is  tensor(0.3060, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.821514276359524e+17
test entropy is  0.0
________________________________
cal ratio is  0.0120096144490274
distance 1 is tensor(12118.8633, device='cuda:0')
distance 2 is tensor(884.0289, device='cuda:0')
cal_distance is  tensor(884.0289, device='cuda:0')
cal ratio is  0.10958838556020144
distance 1 is tensor(1328.0920, device='cuda:0')
distance 2 is tensor(96.8793, device='cuda:0')
cal_distance is  tensor(96.8793, device='cuda:0')
cal ratio is  0.3310413837291612
distance 1 is tensor(439.6574, device='cuda:0')
distance 2 is tensor(32.0711, device='cuda:0')
cal_distance is  tensor(32.0711, device='cuda:0')
cal ratio is  0.5753619231545317
distance 1 is tensor(252.9647, device='cuda:0')
distance 2 is tensor(18.4525, device='cuda:0')
cal_distance is  tensor(18.4525, device='cuda:0')
cal ratio is  0.7585261368796661
distance 1 is tensor(191.8818, device='cuda:0')
distance 2 is tensor(13.9967, device='cuda:0')
cal_distance is  tensor(13.9967, device='cuda:0')
cal ratio is  0.8709340925119221
distance 1 is tensor(167.1172, device='cuda:0')
distance 2 is tensor(12.1902, device='cuda:0')
cal_distance is  tensor(12.1902, device='cuda:0')
distance 1 is tensor(167.1172, device='cuda:0')
distance 2 is tensor(12.1902, device='cuda:0')
________________________________
test distance is  tensor(12.1902, device='cuda:0')
test similarity is  tensor(0.9603, device='cuda:0')
test acc is  0.7566833334896608
test loss is 80.25658418374783
test entropy is  0.009572102198901424
________________________________
distance 1 is tensor(167.1172, device='cuda:0')
distance 2 is tensor(12.1902, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.009772957678872795
avg test loss is  80.23813690966381
avg accuracy is  0.7566166668229941
solo acc is  0.1301000001563319
compute similarity  is  tensor(0.9603, device='cuda:0')
compute_distance is  tensor(12.1902, device='cuda:0')
compute_norm is  tensor(58.5469, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(152.6249, device='cuda:0')
distance 2 is tensor(12.4860, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9101584813615152
avg test loss is  1.3830772737450183
avg accuracy is  0.7362000001563286
solo acc is  0.2846333334896725
compute similarity  is  tensor(0.9618, device='cuda:0')
compute_distance is  tensor(12.4860, device='cuda:0')
compute_norm is  tensor(58.1649, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(152.6249, device='cuda:0')
distance 2 is tensor(12.4860, device='cuda:0')
________________________________
test distance is  tensor(12.4860, device='cuda:0')
test similarity is  tensor(0.9618, device='cuda:0')
test acc is  0.7351166668229953
test loss is 1.3866595613168502
test entropy is  0.9114480866933428
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.416776418685913
mal norm is  tensor(8.0741, device='cuda:0')
distance 1 is tensor(152.6249, device='cuda:0')
distance 2 is tensor(12.4860, device='cuda:0')
mal distance is  tensor(12.4860, device='cuda:0')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2121, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.3749, device='cuda:0')
c is  tensor(0.0204, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.2710, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(530.1799, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.7775, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.6772, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.3235, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.2184, device='cuda:0')
c is  tensor(0.0211, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.5834, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(807.4108, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0015, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.6436, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.2409, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.3311, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.3912, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.0624, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.4919, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.8052, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.1006, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.2757, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.3404, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.9842, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.9333, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.6660, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.7189, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.4508, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.7390, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.3612, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.9659, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.9884, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.3795, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.0776, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.5516, device='cuda:0')
c is  tensor(0.0180, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.3248, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(707.5778, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
len accept list 32
len all weights is 32
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 91.48% 

Test Accuracy: 89.62% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8679488897323608
distance 1 is tensor(120.1140, device='cuda:0')
distance 2 is tensor(8.7973, device='cuda:0')
benign distance is  tensor(8.7973, device='cuda:0')
norm1 res is  tensor(0.1222, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.27183669805526733
distance 1 is tensor(129.7066, device='cuda:0')
distance 2 is tensor(9.3075, device='cuda:0')
benign distance is  tensor(9.3075, device='cuda:0')
norm1 res is  tensor(0.1312, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.11575128883123398
distance 1 is tensor(99.2940, device='cuda:0')
distance 2 is tensor(7.3139, device='cuda:0')
benign distance is  tensor(7.3139, device='cuda:0')
norm1 res is  tensor(0.1024, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.8875371813774109
distance 1 is tensor(127.0123, device='cuda:0')
distance 2 is tensor(9.1898, device='cuda:0')
benign distance is  tensor(9.1898, device='cuda:0')
norm1 res is  tensor(0.1279, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.132559895515442
distance 1 is tensor(120.9286, device='cuda:0')
distance 2 is tensor(8.5737, device='cuda:0')
benign distance is  tensor(8.5737, device='cuda:0')
norm1 res is  tensor(0.1206, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7314552664756775
distance 1 is tensor(134.2482, device='cuda:0')
distance 2 is tensor(9.7276, device='cuda:0')
benign distance is  tensor(9.7276, device='cuda:0')
norm1 res is  tensor(0.1386, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.5555568933486938
distance 1 is tensor(104.7716, device='cuda:0')
distance 2 is tensor(7.4747, device='cuda:0')
benign distance is  tensor(7.4747, device='cuda:0')
norm1 res is  tensor(0.1055, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.469280481338501
distance 1 is tensor(138.4396, device='cuda:0')
distance 2 is tensor(9.8408, device='cuda:0')
benign distance is  tensor(9.8408, device='cuda:0')
norm1 res is  tensor(0.1460, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.0355549231171608
distance 1 is tensor(134.8702, device='cuda:0')
distance 2 is tensor(9.6251, device='cuda:0')
benign distance is  tensor(9.6251, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.29835182428359985
distance 1 is tensor(131.0633, device='cuda:0')
distance 2 is tensor(9.3983, device='cuda:0')
benign distance is  tensor(9.3983, device='cuda:0')
norm1 res is  tensor(0.1339, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.7024716138839722
distance 1 is tensor(139.8084, device='cuda:0')
distance 2 is tensor(9.9279, device='cuda:0')
benign distance is  tensor(9.9279, device='cuda:0')
norm1 res is  tensor(0.1399, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.7902811169624329
distance 1 is tensor(145.7005, device='cuda:0')
distance 2 is tensor(10.4157, device='cuda:0')
benign distance is  tensor(10.4157, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.49492350220680237
distance 1 is tensor(137.2318, device='cuda:0')
distance 2 is tensor(9.8929, device='cuda:0')
benign distance is  tensor(9.8929, device='cuda:0')
norm1 res is  tensor(0.1407, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.17732197046279907
distance 1 is tensor(127.7450, device='cuda:0')
distance 2 is tensor(9.1058, device='cuda:0')
benign distance is  tensor(9.1058, device='cuda:0')
norm1 res is  tensor(0.1290, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.22892911732196808
distance 1 is tensor(131.6956, device='cuda:0')
distance 2 is tensor(9.4236, device='cuda:0')
benign distance is  tensor(9.4236, device='cuda:0')
norm1 res is  tensor(0.1357, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.31131821870803833
distance 1 is tensor(147.8167, device='cuda:0')
distance 2 is tensor(10.6183, device='cuda:0')
benign distance is  tensor(10.6183, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.34328335523605347
distance 1 is tensor(163.8835, device='cuda:0')
distance 2 is tensor(11.5831, device='cuda:0')
benign distance is  tensor(11.5831, device='cuda:0')
norm1 res is  tensor(0.1664, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.7318769693374634
distance 1 is tensor(134.2819, device='cuda:0')
distance 2 is tensor(9.5658, device='cuda:0')
benign distance is  tensor(9.5658, device='cuda:0')
norm1 res is  tensor(0.1365, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.3611331582069397
distance 1 is tensor(152.7505, device='cuda:0')
distance 2 is tensor(11.0825, device='cuda:0')
benign distance is  tensor(11.0825, device='cuda:0')
norm1 res is  tensor(0.1551, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.47619548439979553
distance 1 is tensor(147.8174, device='cuda:0')
distance 2 is tensor(10.5589, device='cuda:0')
benign distance is  tensor(10.5589, device='cuda:0')
norm1 res is  tensor(0.1499, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.7533131837844849
distance 1 is tensor(142.7004, device='cuda:0')
distance 2 is tensor(10.1822, device='cuda:0')
benign distance is  tensor(10.1822, device='cuda:0')
norm1 res is  tensor(0.1433, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.25940996408462524
distance 1 is tensor(141.4492, device='cuda:0')
distance 2 is tensor(10.1780, device='cuda:0')
benign distance is  tensor(10.1780, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.3061850666999817
distance 1 is tensor(149.8043, device='cuda:0')
distance 2 is tensor(10.9781, device='cuda:0')
benign distance is  tensor(10.9781, device='cuda:0')
norm1 res is  tensor(0.1518, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.4727633595466614
distance 1 is tensor(142.1118, device='cuda:0')
distance 2 is tensor(10.1281, device='cuda:0')
benign distance is  tensor(10.1281, device='cuda:0')
norm1 res is  tensor(0.1433, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.6485942006111145
distance 1 is tensor(146.5448, device='cuda:0')
distance 2 is tensor(10.6149, device='cuda:0')
benign distance is  tensor(10.6149, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.061685316264629364
distance 1 is tensor(146.4593, device='cuda:0')
distance 2 is tensor(10.6143, device='cuda:0')
benign distance is  tensor(10.6143, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.4740277826786041
distance 1 is tensor(139.8913, device='cuda:0')
distance 2 is tensor(10.2319, device='cuda:0')
benign distance is  tensor(10.2319, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.19485166668891907
distance 1 is tensor(152.9722, device='cuda:0')
distance 2 is tensor(10.8008, device='cuda:0')
benign distance is  tensor(10.8008, device='cuda:0')
norm1 res is  tensor(0.1534, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.35902169346809387
distance 1 is tensor(143.7959, device='cuda:0')
distance 2 is tensor(10.0897, device='cuda:0')
benign distance is  tensor(10.0897, device='cuda:0')
norm1 res is  tensor(0.1467, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.6012442111968994
distance 1 is tensor(135.2387, device='cuda:0')
distance 2 is tensor(9.7518, device='cuda:0')
benign distance is  tensor(9.7518, device='cuda:0')
norm1 res is  tensor(0.1372, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.42265376448631287
distance 1 is tensor(147.5794, device='cuda:0')
distance 2 is tensor(10.6856, device='cuda:0')
benign distance is  tensor(10.6856, device='cuda:0')
norm1 res is  tensor(0.1496, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.28426453471183777
distance 1 is tensor(143.5300, device='cuda:0')
distance 2 is tensor(10.1957, device='cuda:0')
benign distance is  tensor(10.1957, device='cuda:0')
norm1 res is  tensor(0.1418, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(150.5205, device='cuda:0')
distance 2 is tensor(10.6116, device='cuda:0')
compute distance is  tensor(10.6116, device='cuda:0')
compute norm is  tensor(55.0842, device='cuda:0')
distance 1 is tensor(149.6225, device='cuda:0')
distance 2 is tensor(10.7348, device='cuda:0')
compute distance is  tensor(10.7348, device='cuda:0')
compute norm is  tensor(54.8907, device='cuda:0')
distance 1 is tensor(156.8055, device='cuda:0')
distance 2 is tensor(11.2838, device='cuda:0')
compute distance is  tensor(11.2838, device='cuda:0')
compute norm is  tensor(55.2319, device='cuda:0')
distance 1 is tensor(144.9784, device='cuda:0')
distance 2 is tensor(10.3217, device='cuda:0')
compute distance is  tensor(10.3217, device='cuda:0')
compute norm is  tensor(54.8722, device='cuda:0')
distance 1 is tensor(146.9369, device='cuda:0')
distance 2 is tensor(10.5428, device='cuda:0')
compute distance is  tensor(10.5428, device='cuda:0')
compute norm is  tensor(54.8811, device='cuda:0')
distance 1 is tensor(160.4451, device='cuda:0')
distance 2 is tensor(11.5234, device='cuda:0')
compute distance is  tensor(11.5234, device='cuda:0')
compute norm is  tensor(55.3299, device='cuda:0')
distance 1 is tensor(157.8869, device='cuda:0')
distance 2 is tensor(11.3215, device='cuda:0')
compute distance is  tensor(11.3215, device='cuda:0')
compute norm is  tensor(55.2048, device='cuda:0')
distance 1 is tensor(141.9647, device='cuda:0')
distance 2 is tensor(10.1855, device='cuda:0')
compute distance is  tensor(10.1855, device='cuda:0')
compute norm is  tensor(54.9249, device='cuda:0')
distance 1 is tensor(158.0621, device='cuda:0')
distance 2 is tensor(11.3077, device='cuda:0')
compute distance is  tensor(11.3077, device='cuda:0')
compute norm is  tensor(55.2461, device='cuda:0')
distance 1 is tensor(142.3081, device='cuda:0')
distance 2 is tensor(10.2402, device='cuda:0')
compute distance is  tensor(10.2402, device='cuda:0')
compute norm is  tensor(54.9570, device='cuda:0')
distance 1 is tensor(158.3638, device='cuda:0')
distance 2 is tensor(11.1897, device='cuda:0')
compute distance is  tensor(11.1897, device='cuda:0')
compute norm is  tensor(55.2183, device='cuda:0')
distance 1 is tensor(169.3239, device='cuda:0')
distance 2 is tensor(11.9998, device='cuda:0')
compute distance is  tensor(11.9998, device='cuda:0')
compute norm is  tensor(55.5060, device='cuda:0')
distance Threshold  is  tensor(11.9998, device='cuda:0')
distance 1 is tensor(1009128.6875, device='cuda:0')
distance 2 is tensor(73612.7656, device='cuda:0')
________________________________
test distance is  tensor(73612.7656, device='cuda:0')
test similarity is  tensor(0.2388, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.819035835901955e+17
test entropy is  0.0
________________________________
cal ratio is  0.011490846911382505
distance 1 is tensor(11595.7490, device='cuda:0')
distance 2 is tensor(845.8731, device='cuda:0')
cal_distance is  tensor(845.8731, device='cuda:0')
cal ratio is  0.10719536343054739
distance 1 is tensor(1243.0157, device='cuda:0')
distance 2 is tensor(90.6737, device='cuda:0')
cal_distance is  tensor(90.6737, device='cuda:0')
cal ratio is  0.32740704805284715
distance 1 is tensor(406.9762, device='cuda:0')
distance 2 is tensor(29.6872, device='cuda:0')
cal_distance is  tensor(29.6872, device='cuda:0')
cal ratio is  0.572194906558691
distance 1 is tensor(232.8723, device='cuda:0')
distance 2 is tensor(16.9869, device='cuda:0')
cal_distance is  tensor(16.9869, device='cuda:0')
cal ratio is  0.7564356501144638
distance 1 is tensor(176.1544, device='cuda:0')
distance 2 is tensor(12.8495, device='cuda:0')
cal_distance is  tensor(12.8495, device='cuda:0')
cal ratio is  0.8697331083690891
distance 1 is tensor(153.2081, device='cuda:0')
distance 2 is tensor(11.1756, device='cuda:0')
cal_distance is  tensor(11.1756, device='cuda:0')
distance 1 is tensor(153.2081, device='cuda:0')
distance 2 is tensor(11.1756, device='cuda:0')
________________________________
test distance is  tensor(11.1756, device='cuda:0')
test similarity is  tensor(0.9629, device='cuda:0')
test acc is  0.8749333334896556
test loss is 30.976807016807832
test entropy is  0.0379490291358216
________________________________
distance 1 is tensor(153.2081, device='cuda:0')
distance 2 is tensor(11.1756, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.03709584904555629
avg test loss is  30.79686340950191
avg accuracy is  0.8741000001563223
solo acc is  0.36520000015634063
compute similarity  is  tensor(0.9629, device='cuda:0')
compute_distance is  tensor(11.1756, device='cuda:0')
compute_norm is  tensor(57.8010, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(144.8431, device='cuda:0')
distance 2 is tensor(12.2287, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9156081315550977
avg test loss is  1.3899492282094732
avg accuracy is  0.8344333334896573
solo acc is  0.29386666682300605
compute similarity  is  tensor(0.9628, device='cuda:0')
compute_distance is  tensor(12.2287, device='cuda:0')
compute_norm is  tensor(57.2381, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.4844, device='cuda:0')
distance 2 is tensor(12.3559, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8888712313764894
avg test loss is  1.4510927440515204
avg accuracy is  0.8265500001563242
solo acc is  0.24228333348967135
compute similarity  is  tensor(0.9625, device='cuda:0')
compute_distance is  tensor(12.3559, device='cuda:0')
compute_norm is  tensor(56.9599, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.0018, device='cuda:0')
distance 2 is tensor(12.4317, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8823479084190784
avg test loss is  1.427812875588057
avg accuracy is  0.8253833334896576
solo acc is  0.2419166668230046
compute similarity  is  tensor(0.9624, device='cuda:0')
compute_distance is  tensor(12.4317, device='cuda:0')
compute_norm is  tensor(56.6873, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.5563, device='cuda:0')
distance 2 is tensor(12.4939, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8706165592807696
avg test loss is  1.4205765510672954
avg accuracy is  0.8276500001563242
solo acc is  0.23715000015633786
compute similarity  is  tensor(0.9623, device='cuda:0')
compute_distance is  tensor(12.4939, device='cuda:0')
compute_norm is  tensor(56.4200, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.1486, device='cuda:0')
distance 2 is tensor(12.5553, device='cuda:0')
________________________________
test distance is  tensor(12.5553, device='cuda:0')
test similarity is  tensor(0.9622, device='cuda:0')
test acc is  0.8275000001563242
test loss is 1.4118831677477497
test entropy is  0.8668978311486845
________________________________
cal ratio is  0.8798643672927691
distance 1 is tensor(129.4716, device='cuda:0')
distance 2 is tensor(11.0469, device='cuda:0')
cal_distance is  tensor(11.0469, device='cuda:0')
distance 1 is tensor(129.4716, device='cuda:0')
distance 2 is tensor(11.0469, device='cuda:0')
________________________________
test distance is  tensor(11.0469, device='cuda:0')
test similarity is  tensor(0.9701, device='cuda:0')
test acc is  0.8478000001563234
test loss is 1.0804919735200877
test entropy is  1.0165701795107267
________________________________
distance 1 is tensor(129.4716, device='cuda:0')
distance 2 is tensor(11.0469, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0162709781737216
avg test loss is  1.0765403451314612
avg accuracy is  0.8488666668229901
solo acc is  0.4581500001563417
compute similarity  is  tensor(0.9701, device='cuda:0')
compute_distance is  tensor(11.0469, device='cuda:0')
compute_norm is  tensor(55.7974, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.1653, device='cuda:0')
distance 2 is tensor(11.2668, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8580160130188663
avg test loss is  1.3974944129427358
avg accuracy is  0.8400500001563236
solo acc is  0.2366833334896712
compute similarity  is  tensor(0.9697, device='cuda:0')
compute_distance is  tensor(11.2668, device='cuda:0')
compute_norm is  tensor(55.5398, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.1285, device='cuda:0')
distance 2 is tensor(11.3527, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8573274262932572
avg test loss is  1.383794845421431
avg accuracy is  0.8407833334896571
solo acc is  0.23305000015633767
compute similarity  is  tensor(0.9695, device='cuda:0')
compute_distance is  tensor(11.3527, device='cuda:0')
compute_norm is  tensor(55.2796, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.0941, device='cuda:0')
distance 2 is tensor(11.4312, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8560506823474664
avg test loss is  1.368138398824216
avg accuracy is  0.8408500001563236
solo acc is  0.23713333348967117
compute similarity  is  tensor(0.9693, device='cuda:0')
compute_distance is  tensor(11.4312, device='cuda:0')
compute_norm is  tensor(55.0226, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.1226, device='cuda:0')
distance 2 is tensor(11.5109, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.847374207238907
avg test loss is  1.3766678576149158
avg accuracy is  0.8423500001563234
solo acc is  0.22680000015633747
compute similarity  is  tensor(0.9692, device='cuda:0')
compute_distance is  tensor(11.5109, device='cuda:0')
compute_norm is  tensor(54.7673, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.1043, device='cuda:0')
distance 2 is tensor(11.5828, device='cuda:0')
________________________________
test distance is  tensor(11.5828, device='cuda:0')
test similarity is  tensor(0.9691, device='cuda:0')
test acc is  0.8431833334896568
test loss is 1.3641292879830544
test entropy is  0.8492071418874045
________________________________
distance 1 is tensor(135.1043, device='cuda:0')
distance 2 is tensor(11.5828, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8484053581889505
avg test loss is  1.362316878302011
avg accuracy is  0.8438000001563235
solo acc is  0.2259500001563374
compute similarity  is  tensor(0.9691, device='cuda:0')
compute_distance is  tensor(11.5828, device='cuda:0')
compute_norm is  tensor(54.5122, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.1324, device='cuda:0')
distance 2 is tensor(11.6548, device='cuda:0')
exit early
distance 1 is tensor(136.1324, device='cuda:0')
distance 2 is tensor(11.6548, device='cuda:0')
________________________________
test distance is  tensor(11.6548, device='cuda:0')
test similarity is  tensor(0.9689, device='cuda:0')
test acc is  0.8479500001563234
test loss is 1.3650422811762357
test entropy is  0.8418449118320368
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2441507577896118
mal norm is  tensor(6.3378, device='cuda:0')
distance 1 is tensor(136.1324, device='cuda:0')
distance 2 is tensor(11.6548, device='cuda:0')
mal distance is  tensor(11.6548, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1212, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.5587, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.9356, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.9103e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(404.8068, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.0841, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(475.3618, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.6932e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.2457, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.2181e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(406.5986, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.3851, device='cuda:0')
c is  tensor(0.0147, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1124e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.7841, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
len accept list 7
len all weights is 7
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 91.48% 

Test Accuracy: 89.59% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2617957592010498
distance 1 is tensor(135.4124, device='cuda:0')
distance 2 is tensor(9.7966, device='cuda:0')
benign distance is  tensor(9.7966, device='cuda:0')
norm1 res is  tensor(0.1392, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.31440839171409607
distance 1 is tensor(133.3924, device='cuda:0')
distance 2 is tensor(9.4775, device='cuda:0')
benign distance is  tensor(9.4775, device='cuda:0')
norm1 res is  tensor(0.1344, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.07514596730470657
distance 1 is tensor(104.0692, device='cuda:0')
distance 2 is tensor(7.4871, device='cuda:0')
benign distance is  tensor(7.4871, device='cuda:0')
norm1 res is  tensor(0.1049, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.4185243248939514
distance 1 is tensor(141.5890, device='cuda:0')
distance 2 is tensor(10.0187, device='cuda:0')
benign distance is  tensor(10.0187, device='cuda:0')
norm1 res is  tensor(0.1403, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.2722011208534241
distance 1 is tensor(124.2164, device='cuda:0')
distance 2 is tensor(8.7476, device='cuda:0')
benign distance is  tensor(8.7476, device='cuda:0')
norm1 res is  tensor(0.1257, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.3301308751106262
distance 1 is tensor(152.5404, device='cuda:0')
distance 2 is tensor(11.0421, device='cuda:0')
benign distance is  tensor(11.0421, device='cuda:0')
norm1 res is  tensor(0.1571, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.03637466952204704
distance 1 is tensor(103.1494, device='cuda:0')
distance 2 is tensor(7.3023, device='cuda:0')
benign distance is  tensor(7.3023, device='cuda:0')
norm1 res is  tensor(0.1086, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.4360899031162262
distance 1 is tensor(132.7579, device='cuda:0')
distance 2 is tensor(9.5003, device='cuda:0')
benign distance is  tensor(9.5003, device='cuda:0')
norm1 res is  tensor(0.1364, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(144.9321, device='cuda:0')
distance 2 is tensor(10.3029, device='cuda:0')
compute distance is  tensor(10.3029, device='cuda:0')
compute norm is  tensor(54.7850, device='cuda:0')
distance 1 is tensor(138.3741, device='cuda:0')
distance 2 is tensor(10.0720, device='cuda:0')
compute distance is  tensor(10.0720, device='cuda:0')
compute norm is  tensor(54.6246, device='cuda:0')
distance 1 is tensor(158.9122, device='cuda:0')
distance 2 is tensor(11.3059, device='cuda:0')
compute distance is  tensor(11.3059, device='cuda:0')
compute norm is  tensor(55.1467, device='cuda:0')
distance 1 is tensor(147.5339, device='cuda:0')
distance 2 is tensor(10.5328, device='cuda:0')
compute distance is  tensor(10.5328, device='cuda:0')
compute norm is  tensor(54.7620, device='cuda:0')
distance 1 is tensor(150.8017, device='cuda:0')
distance 2 is tensor(10.7490, device='cuda:0')
compute distance is  tensor(10.7490, device='cuda:0')
compute norm is  tensor(54.9920, device='cuda:0')
distance 1 is tensor(150.6314, device='cuda:0')
distance 2 is tensor(10.8079, device='cuda:0')
compute distance is  tensor(10.8079, device='cuda:0')
compute norm is  tensor(55.1117, device='cuda:0')
distance 1 is tensor(139.9798, device='cuda:0')
distance 2 is tensor(10.0031, device='cuda:0')
compute distance is  tensor(10.0031, device='cuda:0')
compute norm is  tensor(54.9321, device='cuda:0')
distance 1 is tensor(147.1877, device='cuda:0')
distance 2 is tensor(10.5986, device='cuda:0')
compute distance is  tensor(10.5986, device='cuda:0')
compute norm is  tensor(55.0093, device='cuda:0')
distance 1 is tensor(155.0084, device='cuda:0')
distance 2 is tensor(10.9872, device='cuda:0')
compute distance is  tensor(10.9872, device='cuda:0')
compute norm is  tensor(55.1357, device='cuda:0')
distance 1 is tensor(149.1139, device='cuda:0')
distance 2 is tensor(10.6359, device='cuda:0')
compute distance is  tensor(10.6359, device='cuda:0')
compute norm is  tensor(55.0216, device='cuda:0')
distance 1 is tensor(150.6242, device='cuda:0')
distance 2 is tensor(10.7215, device='cuda:0')
compute distance is  tensor(10.7215, device='cuda:0')
compute norm is  tensor(55.0667, device='cuda:0')
distance 1 is tensor(152.6547, device='cuda:0')
distance 2 is tensor(10.9197, device='cuda:0')
compute distance is  tensor(10.9197, device='cuda:0')
compute norm is  tensor(55.1235, device='cuda:0')
distance Threshold  is  tensor(11.3059, device='cuda:0')
distance 1 is tensor(1009131.7500, device='cuda:0')
distance 2 is tensor(73613.0547, device='cuda:0')
________________________________
test distance is  tensor(73613.0547, device='cuda:0')
test similarity is  tensor(0.2290, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.820683543601978e+17
test entropy is  0.0
________________________________
cal ratio is  0.011153673364245942
distance 1 is tensor(11255.5293, device='cuda:0')
distance 2 is tensor(821.0561, device='cuda:0')
cal_distance is  tensor(821.0561, device='cuda:0')
cal ratio is  0.10561094711850438
distance 1 is tensor(1188.7126, device='cuda:0')
distance 2 is tensor(86.7125, device='cuda:0')
cal_distance is  tensor(86.7125, device='cuda:0')
cal ratio is  0.324978371505715
distance 1 is tensor(386.3099, device='cuda:0')
distance 2 is tensor(28.1797, device='cuda:0')
cal_distance is  tensor(28.1797, device='cuda:0')
cal ratio is  0.5700687627035343
distance 1 is tensor(220.2258, device='cuda:0')
distance 2 is tensor(16.0644, device='cuda:0')
cal_distance is  tensor(16.0644, device='cuda:0')
cal ratio is  0.755028972022485
distance 1 is tensor(166.2784, device='cuda:0')
distance 2 is tensor(12.1291, device='cuda:0')
cal_distance is  tensor(12.1291, device='cuda:0')
cal ratio is  0.8689239921192135
distance 1 is tensor(144.4841, device='cuda:0')
distance 2 is tensor(10.5392, device='cuda:0')
cal_distance is  tensor(10.5392, device='cuda:0')
distance 1 is tensor(144.4841, device='cuda:0')
distance 2 is tensor(10.5392, device='cuda:0')
________________________________
test distance is  tensor(10.5392, device='cuda:0')
test similarity is  tensor(0.9668, device='cuda:0')
test acc is  0.8776666668229889
test loss is 23.281384980500633
test entropy is  0.04107121408987505
________________________________
distance 1 is tensor(144.4841, device='cuda:0')
distance 2 is tensor(10.5392, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.04198556369872265
avg test loss is  23.079382117623204
avg accuracy is  0.8764666668229888
solo acc is  0.45223333348967504
compute similarity  is  tensor(0.9668, device='cuda:0')
compute_distance is  tensor(10.5392, device='cuda:0')
compute_norm is  tensor(57.9642, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(137.8101, device='cuda:0')
distance 2 is tensor(11.8140, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9359232298473814
avg test loss is  1.3634199033668046
avg accuracy is  0.8526500001563232
solo acc is  0.3071666668230063
compute similarity  is  tensor(0.9661, device='cuda:0')
compute_distance is  tensor(11.8140, device='cuda:0')
compute_norm is  tensor(57.3157, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.7226, device='cuda:0')
distance 2 is tensor(11.9703, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8811061974527485
avg test loss is  1.4618636373517864
avg accuracy is  0.8476833334896566
solo acc is  0.24233333348967134
compute similarity  is  tensor(0.9658, device='cuda:0')
compute_distance is  tensor(11.9703, device='cuda:0')
compute_norm is  tensor(57.0309, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.4411, device='cuda:0')
distance 2 is tensor(12.0638, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8737093912385928
avg test loss is  1.4372943117420303
avg accuracy is  0.8473833334896567
solo acc is  0.2409833334896713
compute similarity  is  tensor(0.9657, device='cuda:0')
compute_distance is  tensor(12.0638, device='cuda:0')
compute_norm is  tensor(56.7538, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.2116, device='cuda:0')
distance 2 is tensor(12.1415, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8697413918433159
avg test loss is  1.4194132131554171
avg accuracy is  0.8478000001563235
solo acc is  0.23925000015633802
compute similarity  is  tensor(0.9655, device='cuda:0')
compute_distance is  tensor(12.1415, device='cuda:0')
compute_norm is  tensor(56.4831, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.9737, device='cuda:0')
distance 2 is tensor(12.2089, device='cuda:0')
________________________________
test distance is  tensor(12.2089, device='cuda:0')
test similarity is  tensor(0.9654, device='cuda:0')
test acc is  0.8480000001563234
test loss is 1.4154476838579564
test entropy is  0.8599389893159683
________________________________
cal ratio is  0.8660781889372116
distance 1 is tensor(122.0950, device='cuda:0')
distance 2 is tensor(10.5739, device='cuda:0')
cal_distance is  tensor(10.5739, device='cuda:0')
distance 1 is tensor(122.0950, device='cuda:0')
distance 2 is tensor(10.5739, device='cuda:0')
________________________________
test distance is  tensor(10.5739, device='cuda:0')
test similarity is  tensor(0.9735, device='cuda:0')
test acc is  0.870266666822989
test loss is 1.0333359691379929
test entropy is  1.0127034294706927
________________________________
distance 1 is tensor(122.0950, device='cuda:0')
distance 2 is tensor(10.5739, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.0108985264799488
avg test loss is  1.0375743145500418
avg accuracy is  0.8697833334896559
solo acc is  0.495750000156342
compute similarity  is  tensor(0.9735, device='cuda:0')
compute_distance is  tensor(10.5739, device='cuda:0')
compute_norm is  tensor(55.8856, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(124.3635, device='cuda:0')
distance 2 is tensor(10.8557, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8559605407435248
avg test loss is  1.4015098755547741
avg accuracy is  0.8622666668229895
solo acc is  0.23691666682300455
compute similarity  is  tensor(0.9729, device='cuda:0')
compute_distance is  tensor(10.8557, device='cuda:0')
compute_norm is  tensor(55.6226, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(125.5906, device='cuda:0')
distance 2 is tensor(10.9589, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8542790005583245
avg test loss is  1.380036551306751
avg accuracy is  0.8644166668229892
solo acc is  0.2384333334896712
compute similarity  is  tensor(0.9727, device='cuda:0')
compute_distance is  tensor(10.9589, device='cuda:0')
compute_norm is  tensor(55.3567, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(126.7815, device='cuda:0')
distance 2 is tensor(11.0565, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8546754464284697
avg test loss is  1.3747308305077461
avg accuracy is  0.8646000001563227
solo acc is  0.23153333348967103
compute similarity  is  tensor(0.9726, device='cuda:0')
compute_distance is  tensor(11.0565, device='cuda:0')
compute_norm is  tensor(55.0943, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(127.9287, device='cuda:0')
distance 2 is tensor(11.1406, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8426829232717119
avg test loss is  1.361265036470092
avg accuracy is  0.8663666668229891
solo acc is  0.2353500001563378
compute similarity  is  tensor(0.9724, device='cuda:0')
compute_distance is  tensor(11.1406, device='cuda:0')
compute_norm is  tensor(54.8361, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.0793, device='cuda:0')
distance 2 is tensor(11.2251, device='cuda:0')
________________________________
test distance is  tensor(11.2251, device='cuda:0')
test similarity is  tensor(0.9722, device='cuda:0')
test acc is  0.8654166668229895
test loss is 1.3610776088385186
test entropy is  0.8390399131820654
________________________________
distance 1 is tensor(129.0793, device='cuda:0')
distance 2 is tensor(11.2251, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8395269992254945
avg test loss is  1.361761139908325
avg accuracy is  0.8661833334896559
solo acc is  0.2279333334896709
compute similarity  is  tensor(0.9722, device='cuda:0')
compute_distance is  tensor(11.2251, device='cuda:0')
compute_norm is  tensor(54.5789, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.2476, device='cuda:0')
distance 2 is tensor(11.3045, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8396231167352022
avg test loss is  1.3486730669861409
avg accuracy is  0.8694000001563225
solo acc is  0.2292000001563376
compute similarity  is  tensor(0.9721, device='cuda:0')
compute_distance is  tensor(11.3045, device='cuda:0')
compute_norm is  tensor(54.3237, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.4573, device='cuda:0')
distance 2 is tensor(11.3865, device='cuda:0')
exit early
distance 1 is tensor(131.4573, device='cuda:0')
distance 2 is tensor(11.3865, device='cuda:0')
________________________________
test distance is  tensor(11.3865, device='cuda:0')
test similarity is  tensor(0.9719, device='cuda:0')
test acc is  0.8684500001563225
test loss is 1.3509702963361354
test entropy is  0.8282451278238154
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.0520468950271606
mal norm is  tensor(5.9795, device='cuda:0')
distance 1 is tensor(131.4573, device='cuda:0')
distance 2 is tensor(11.3865, device='cuda:0')
mal distance is  tensor(11.3865, device='cuda:0')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2161, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.9313, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.1049e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(526.7579, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(408.3620, device='cuda:0')
c is  tensor(0.0230, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.9874e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.4304, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.8167e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.9461, device='cuda:0')
c is  tensor(0.0210, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.5999, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.3049e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(406.6439, device='cuda:0')
c is  tensor(0.0231, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(526.0284, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9469, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4490e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.1058, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.6326, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.5147, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.1263, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.3901, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.4312, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.8947, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.3385e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.2395, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.5656, device='cuda:0')
c is  tensor(0.0177, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.3713e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.2173, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.6292, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.9481, device='cuda:0')
c is  tensor(0.0184, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.0350, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.1645, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(749.7808, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.1849, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.7296, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.9769, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.4163, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.9078e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.7016, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.5393, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.8312, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.5105e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.2438, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.1343, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
len accept list 15
len all weights is 15
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 91.42% 

Test Accuracy: 89.77% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
 benign loss is  0.47260522842407227
distance 1 is tensor(105.9560, device='cuda:0')
distance 2 is tensor(7.8261, device='cuda:0')
benign distance is  tensor(7.8261, device='cuda:0')
norm1 res is  tensor(0.1091, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.2725716531276703
distance 1 is tensor(140.9233, device='cuda:0')
distance 2 is tensor(9.9568, device='cuda:0')
benign distance is  tensor(9.9568, device='cuda:0')
norm1 res is  tensor(0.1406, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.23858270049095154
distance 1 is tensor(117.4264, device='cuda:0')
distance 2 is tensor(8.3396, device='cuda:0')
benign distance is  tensor(8.3396, device='cuda:0')
norm1 res is  tensor(0.1186, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.3324316740036011
distance 1 is tensor(131.7773, device='cuda:0')
distance 2 is tensor(9.4598, device='cuda:0')
benign distance is  tensor(9.4598, device='cuda:0')
norm1 res is  tensor(0.1304, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.39616659283638
distance 1 is tensor(134.9360, device='cuda:0')
distance 2 is tensor(9.7161, device='cuda:0')
benign distance is  tensor(9.7161, device='cuda:0')
norm1 res is  tensor(0.1382, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5609983801841736
distance 1 is tensor(135.4470, device='cuda:0')
distance 2 is tensor(9.7106, device='cuda:0')
benign distance is  tensor(9.7106, device='cuda:0')
norm1 res is  tensor(0.1390, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.19162312150001526
distance 1 is tensor(110.8543, device='cuda:0')
distance 2 is tensor(7.9513, device='cuda:0')
benign distance is  tensor(7.9513, device='cuda:0')
norm1 res is  tensor(0.1115, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6302661895751953
distance 1 is tensor(125.1257, device='cuda:0')
distance 2 is tensor(9.0029, device='cuda:0')
benign distance is  tensor(9.0029, device='cuda:0')
norm1 res is  tensor(0.1293, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.06991185247898102
distance 1 is tensor(144.0707, device='cuda:0')
distance 2 is tensor(10.2363, device='cuda:0')
benign distance is  tensor(10.2363, device='cuda:0')
norm1 res is  tensor(0.1494, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.4037451148033142
distance 1 is tensor(137.6900, device='cuda:0')
distance 2 is tensor(10.0581, device='cuda:0')
benign distance is  tensor(10.0581, device='cuda:0')
norm1 res is  tensor(0.1457, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.7452449202537537
distance 1 is tensor(143.6201, device='cuda:0')
distance 2 is tensor(10.1139, device='cuda:0')
benign distance is  tensor(10.1139, device='cuda:0')
norm1 res is  tensor(0.1405, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.5349782705307007
distance 1 is tensor(144.3633, device='cuda:0')
distance 2 is tensor(10.1619, device='cuda:0')
benign distance is  tensor(10.1619, device='cuda:0')
norm1 res is  tensor(0.1456, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.542284369468689
distance 1 is tensor(135.5379, device='cuda:0')
distance 2 is tensor(9.9570, device='cuda:0')
benign distance is  tensor(9.9570, device='cuda:0')
norm1 res is  tensor(0.1397, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.031246546655893326
distance 1 is tensor(132.1696, device='cuda:0')
distance 2 is tensor(9.4238, device='cuda:0')
benign distance is  tensor(9.4238, device='cuda:0')
norm1 res is  tensor(0.1335, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.6203832626342773
distance 1 is tensor(139.2946, device='cuda:0')
distance 2 is tensor(9.9648, device='cuda:0')
benign distance is  tensor(9.9648, device='cuda:0')
norm1 res is  tensor(0.1428, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.5094746351242065
distance 1 is tensor(141.5237, device='cuda:0')
distance 2 is tensor(10.0355, device='cuda:0')
benign distance is  tensor(10.0355, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.41611379384994507
distance 1 is tensor(154.8724, device='cuda:0')
distance 2 is tensor(11.0918, device='cuda:0')
benign distance is  tensor(11.0918, device='cuda:0')
norm1 res is  tensor(0.1555, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.989514946937561
distance 1 is tensor(156.6965, device='cuda:0')
distance 2 is tensor(11.2504, device='cuda:0')
benign distance is  tensor(11.2504, device='cuda:0')
norm1 res is  tensor(0.1595, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.3091372847557068
distance 1 is tensor(155.4201, device='cuda:0')
distance 2 is tensor(11.2106, device='cuda:0')
benign distance is  tensor(11.2106, device='cuda:0')
norm1 res is  tensor(0.1581, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.3645157814025879
distance 1 is tensor(144.8873, device='cuda:0')
distance 2 is tensor(10.2263, device='cuda:0')
benign distance is  tensor(10.2263, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.5457897782325745
distance 1 is tensor(155.6493, device='cuda:0')
distance 2 is tensor(11.0816, device='cuda:0')
benign distance is  tensor(11.0816, device='cuda:0')
norm1 res is  tensor(0.1583, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9862281084060669
distance 1 is tensor(134.6208, device='cuda:0')
distance 2 is tensor(9.8109, device='cuda:0')
benign distance is  tensor(9.8109, device='cuda:0')
norm1 res is  tensor(0.1374, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.4994933009147644
distance 1 is tensor(149.7398, device='cuda:0')
distance 2 is tensor(10.7698, device='cuda:0')
benign distance is  tensor(10.7698, device='cuda:0')
norm1 res is  tensor(0.1540, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.2444595843553543
distance 1 is tensor(143.2634, device='cuda:0')
distance 2 is tensor(10.3970, device='cuda:0')
benign distance is  tensor(10.3970, device='cuda:0')
norm1 res is  tensor(0.1472, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.36464470624923706
distance 1 is tensor(137.9636, device='cuda:0')
distance 2 is tensor(10.0483, device='cuda:0')
benign distance is  tensor(10.0483, device='cuda:0')
norm1 res is  tensor(0.1390, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.14568237960338593
distance 1 is tensor(151.4438, device='cuda:0')
distance 2 is tensor(10.5779, device='cuda:0')
benign distance is  tensor(10.5779, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.03568893298506737
distance 1 is tensor(131.9147, device='cuda:0')
distance 2 is tensor(9.5070, device='cuda:0')
benign distance is  tensor(9.5070, device='cuda:0')
norm1 res is  tensor(0.1343, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.6699256300926208
distance 1 is tensor(141.3047, device='cuda:0')
distance 2 is tensor(10.1479, device='cuda:0')
benign distance is  tensor(10.1479, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.2759022116661072
distance 1 is tensor(138.7118, device='cuda:0')
distance 2 is tensor(9.9867, device='cuda:0')
benign distance is  tensor(9.9867, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.5059840083122253
distance 1 is tensor(151.5863, device='cuda:0')
distance 2 is tensor(10.6691, device='cuda:0')
benign distance is  tensor(10.6691, device='cuda:0')
norm1 res is  tensor(0.1495, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.20438890159130096
distance 1 is tensor(155.3298, device='cuda:0')
distance 2 is tensor(11.1641, device='cuda:0')
benign distance is  tensor(11.1641, device='cuda:0')
norm1 res is  tensor(0.1606, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.3713872730731964
distance 1 is tensor(145.7829, device='cuda:0')
distance 2 is tensor(10.4894, device='cuda:0')
benign distance is  tensor(10.4894, device='cuda:0')
norm1 res is  tensor(0.1487, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(159.4410, device='cuda:0')
distance 2 is tensor(11.3403, device='cuda:0')
compute distance is  tensor(11.3403, device='cuda:0')
compute norm is  tensor(55.7052, device='cuda:0')
distance 1 is tensor(158.0172, device='cuda:0')
distance 2 is tensor(11.3620, device='cuda:0')
compute distance is  tensor(11.3620, device='cuda:0')
compute norm is  tensor(55.5878, device='cuda:0')
distance 1 is tensor(168.9791, device='cuda:0')
distance 2 is tensor(12.1882, device='cuda:0')
compute distance is  tensor(12.1882, device='cuda:0')
compute norm is  tensor(55.8246, device='cuda:0')
distance 1 is tensor(152.9806, device='cuda:0')
distance 2 is tensor(11.0466, device='cuda:0')
compute distance is  tensor(11.0466, device='cuda:0')
compute norm is  tensor(55.4179, device='cuda:0')
distance 1 is tensor(163.9052, device='cuda:0')
distance 2 is tensor(11.7599, device='cuda:0')
compute distance is  tensor(11.7599, device='cuda:0')
compute norm is  tensor(55.8933, device='cuda:0')
distance 1 is tensor(163.6289, device='cuda:0')
distance 2 is tensor(11.6847, device='cuda:0')
compute distance is  tensor(11.6847, device='cuda:0')
compute norm is  tensor(55.8626, device='cuda:0')
distance 1 is tensor(144.0437, device='cuda:0')
distance 2 is tensor(10.3627, device='cuda:0')
compute distance is  tensor(10.3627, device='cuda:0')
compute norm is  tensor(55.4090, device='cuda:0')
distance 1 is tensor(152.8517, device='cuda:0')
distance 2 is tensor(10.9677, device='cuda:0')
compute distance is  tensor(10.9677, device='cuda:0')
compute norm is  tensor(55.5686, device='cuda:0')
distance 1 is tensor(160.5543, device='cuda:0')
distance 2 is tensor(11.5182, device='cuda:0')
compute distance is  tensor(11.5182, device='cuda:0')
compute norm is  tensor(55.7969, device='cuda:0')
distance 1 is tensor(161.5809, device='cuda:0')
distance 2 is tensor(11.5601, device='cuda:0')
compute distance is  tensor(11.5601, device='cuda:0')
compute norm is  tensor(55.8724, device='cuda:0')
distance 1 is tensor(160.0336, device='cuda:0')
distance 2 is tensor(11.2970, device='cuda:0')
compute distance is  tensor(11.2970, device='cuda:0')
compute norm is  tensor(55.7258, device='cuda:0')
distance 1 is tensor(156.3952, device='cuda:0')
distance 2 is tensor(11.1502, device='cuda:0')
compute distance is  tensor(11.1502, device='cuda:0')
compute norm is  tensor(55.7528, device='cuda:0')
distance Threshold  is  tensor(12.1882, device='cuda:0')
distance 1 is tensor(1009132.2500, device='cuda:0')
distance 2 is tensor(73613.1094, device='cuda:0')
________________________________
test distance is  tensor(73613.1094, device='cuda:0')
test similarity is  tensor(0.2286, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.821674307756744e+17
test entropy is  0.0
________________________________
cal ratio is  0.011580697364973807
distance 1 is tensor(11686.4609, device='cuda:0')
distance 2 is tensor(852.4912, device='cuda:0')
cal_distance is  tensor(852.4912, device='cuda:0')
cal ratio is  0.1076136461686057
distance 1 is tensor(1257.6279, device='cuda:0')
distance 2 is tensor(91.7397, device='cuda:0')
cal_distance is  tensor(91.7397, device='cuda:0')
cal ratio is  0.3280452086298919
distance 1 is tensor(412.5629, device='cuda:0')
distance 2 is tensor(30.0948, device='cuda:0')
cal_distance is  tensor(30.0948, device='cuda:0')
cal ratio is  0.5727522999772673
distance 1 is tensor(236.2989, device='cuda:0')
distance 2 is tensor(17.2368, device='cuda:0')
cal_distance is  tensor(17.2368, device='cuda:0')
cal ratio is  0.7568039284120768
distance 1 is tensor(178.8334, device='cuda:0')
distance 2 is tensor(13.0449, device='cuda:0')
cal_distance is  tensor(13.0449, device='cuda:0')
cal ratio is  0.869944829342471
distance 1 is tensor(155.5760, device='cuda:0')
distance 2 is tensor(11.3484, device='cuda:0')
cal_distance is  tensor(11.3484, device='cuda:0')
distance 1 is tensor(155.5760, device='cuda:0')
distance 2 is tensor(11.3484, device='cuda:0')
________________________________
test distance is  tensor(11.3484, device='cuda:0')
test similarity is  tensor(0.9619, device='cuda:0')
test acc is  0.8762166668229889
test loss is 34.74077295087802
test entropy is  0.03501378838531375
________________________________
distance 1 is tensor(155.5760, device='cuda:0')
distance 2 is tensor(11.3484, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.034932250312756874
avg test loss is  34.73858994359909
avg accuracy is  0.8743500001563222
solo acc is  0.3668666668230073
compute similarity  is  tensor(0.9619, device='cuda:0')
compute_distance is  tensor(11.3484, device='cuda:0')
compute_norm is  tensor(58.1406, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.0013, device='cuda:0')
distance 2 is tensor(12.5284, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.920749070039436
avg test loss is  1.3779148946184594
avg accuracy is  0.8535333334896564
solo acc is  0.30470000015633963
compute similarity  is  tensor(0.9617, device='cuda:0')
compute_distance is  tensor(12.5284, device='cuda:0')
compute_norm is  tensor(57.5449, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.6304, device='cuda:0')
distance 2 is tensor(12.6631, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8760658747224666
avg test loss is  1.481623956135341
avg accuracy is  0.84741666682299
solo acc is  0.23650000015633788
compute similarity  is  tensor(0.9615, device='cuda:0')
compute_distance is  tensor(12.6631, device='cuda:0')
compute_norm is  tensor(57.2642, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.1351, device='cuda:0')
distance 2 is tensor(12.7366, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8735669001079063
avg test loss is  1.4387228285580047
avg accuracy is  0.8468000001563234
solo acc is  0.24178333348967138
compute similarity  is  tensor(0.9613, device='cuda:0')
compute_distance is  tensor(12.7366, device='cuda:0')
compute_norm is  tensor(56.9883, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.7397, device='cuda:0')
distance 2 is tensor(12.8020, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8716828920312528
avg test loss is  1.429553159899803
avg accuracy is  0.8485333334896566
solo acc is  0.2330000001563377
compute similarity  is  tensor(0.9612, device='cuda:0')
compute_distance is  tensor(12.8020, device='cuda:0')
compute_norm is  tensor(56.7175, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.2905, device='cuda:0')
distance 2 is tensor(12.8506, device='cuda:0')
________________________________
test distance is  tensor(12.8506, device='cuda:0')
test similarity is  tensor(0.9611, device='cuda:0')
test acc is  0.8479500001563234
test loss is 1.409800261894523
test entropy is  0.8702713443653416
________________________________
cal ratio is  0.8764962808820614
distance 1 is tensor(130.8533, device='cuda:0')
distance 2 is tensor(11.2635, device='cuda:0')
cal_distance is  tensor(11.2635, device='cuda:0')
distance 1 is tensor(130.8533, device='cuda:0')
distance 2 is tensor(11.2635, device='cuda:0')
________________________________
test distance is  tensor(11.2635, device='cuda:0')
test similarity is  tensor(0.9694, device='cuda:0')
test acc is  0.8686166668229892
test loss is 1.0554532033166906
test entropy is  1.0130508455005027
________________________________
distance 1 is tensor(130.8533, device='cuda:0')
distance 2 is tensor(11.2635, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  1.012424665918228
avg test loss is  1.053479770861709
avg accuracy is  0.8686166668229892
solo acc is  0.4831000001563419
compute similarity  is  tensor(0.9694, device='cuda:0')
compute_distance is  tensor(11.2635, device='cuda:0')
compute_norm is  tensor(56.0850, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.7296, device='cuda:0')
distance 2 is tensor(11.5102, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8559310886778557
avg test loss is  1.4029492772718481
avg accuracy is  0.8608166668229895
solo acc is  0.23930000015633798
compute similarity  is  tensor(0.9689, device='cuda:0')
compute_distance is  tensor(11.5102, device='cuda:0')
compute_norm is  tensor(55.8243, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.7568, device='cuda:0')
distance 2 is tensor(11.6005, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8575799494409866
avg test loss is  1.3931426043703612
avg accuracy is  0.8629833334896561
solo acc is  0.23343333348967113
compute similarity  is  tensor(0.9687, device='cuda:0')
compute_distance is  tensor(11.6005, device='cuda:0')
compute_norm is  tensor(55.5600, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.8197, device='cuda:0')
distance 2 is tensor(11.6820, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8487377696072878
avg test loss is  1.3783447770421693
avg accuracy is  0.8624666668229894
solo acc is  0.23550000015633785
compute similarity  is  tensor(0.9686, device='cuda:0')
compute_distance is  tensor(11.6820, device='cuda:0')
compute_norm is  tensor(55.2994, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.8267, device='cuda:0')
distance 2 is tensor(11.7573, device='cuda:0')
exit early
distance 1 is tensor(135.8267, device='cuda:0')
distance 2 is tensor(11.7573, device='cuda:0')
________________________________
test distance is  tensor(11.7573, device='cuda:0')
test similarity is  tensor(0.9684, device='cuda:0')
test acc is  0.8651000001563226
test loss is 1.3705103584189913
test entropy is  0.8443368839810906
________________________________
distance 1 is tensor(135.8267, device='cuda:0')
distance 2 is tensor(11.7573, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8448907960452505
avg test loss is  1.377905810184316
avg accuracy is  0.8634833334896561
solo acc is  0.23020000015633754
compute similarity  is  tensor(0.9684, device='cuda:0')
compute_distance is  tensor(11.7573, device='cuda:0')
compute_norm is  tensor(55.0408, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.8539, device='cuda:0')
distance 2 is tensor(11.8308, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8398291682129475
avg test loss is  1.363759629634906
avg accuracy is  0.8669666668229893
solo acc is  0.23053333348967095
compute similarity  is  tensor(0.9683, device='cuda:0')
compute_distance is  tensor(11.8308, device='cuda:0')
compute_norm is  tensor(54.7842, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.8922, device='cuda:0')
distance 2 is tensor(11.9046, device='cuda:0')
exit early
distance 1 is tensor(137.8922, device='cuda:0')
distance 2 is tensor(11.9046, device='cuda:0')
________________________________
test distance is  tensor(11.9046, device='cuda:0')
test similarity is  tensor(0.9682, device='cuda:0')
test acc is  0.8665166668229893
test loss is 1.3599529285420742
test entropy is  0.8367787269768177
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1763060092926025
mal norm is  tensor(6.4345, device='cuda:0')
distance 1 is tensor(137.8922, device='cuda:0')
distance 2 is tensor(11.9046, device='cuda:0')
mal distance is  tensor(11.9046, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.0976, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(429.0681, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.1583e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.8566, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(466.8181, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(518.7435, device='cuda:0')
c is  tensor(0.0137, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.2080e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.0834, device='cuda:0')
c is  tensor(0.0135, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.7897, device='cuda:0')
c is  tensor(0.0134, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.1495e-07, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(432.7034, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.0886, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.1812e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4526, device='cuda:0')
c is  tensor(0.0123, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
len accept list 17
len all weights is 17
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 87.31% 

Test Accuracy: 85.76% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
 benign loss is  1.803876519203186
distance 1 is tensor(134.0611, device='cuda:0')
distance 2 is tensor(9.7334, device='cuda:0')
benign distance is  tensor(9.7334, device='cuda:0')
norm1 res is  tensor(0.1327, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.04146431013941765
distance 1 is tensor(141.9500, device='cuda:0')
distance 2 is tensor(10.5923, device='cuda:0')
benign distance is  tensor(10.5923, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6422321200370789
distance 1 is tensor(150.3546, device='cuda:0')
distance 2 is tensor(10.9793, device='cuda:0')
benign distance is  tensor(10.9793, device='cuda:0')
norm1 res is  tensor(0.1497, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1812846660614014
distance 1 is tensor(156.6120, device='cuda:0')
distance 2 is tensor(11.3956, device='cuda:0')
benign distance is  tensor(11.3956, device='cuda:0')
norm1 res is  tensor(0.1563, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.4873611032962799
distance 1 is tensor(156.4261, device='cuda:0')
distance 2 is tensor(11.5437, device='cuda:0')
benign distance is  tensor(11.5437, device='cuda:0')
norm1 res is  tensor(0.1548, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.2611299753189087
distance 1 is tensor(160.8616, device='cuda:0')
distance 2 is tensor(11.8061, device='cuda:0')
benign distance is  tensor(11.8061, device='cuda:0')
norm1 res is  tensor(0.1619, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.4546481668949127
distance 1 is tensor(141.0883, device='cuda:0')
distance 2 is tensor(10.3217, device='cuda:0')
benign distance is  tensor(10.3217, device='cuda:0')
norm1 res is  tensor(0.1405, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.9483175277709961
distance 1 is tensor(151.9910, device='cuda:0')
distance 2 is tensor(11.0439, device='cuda:0')
benign distance is  tensor(11.0439, device='cuda:0')
norm1 res is  tensor(0.1517, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(189.6328, device='cuda:0')
distance 2 is tensor(14.0456, device='cuda:0')
compute distance is  tensor(14.0456, device='cuda:0')
compute norm is  tensor(56.0387, device='cuda:0')
distance 1 is tensor(196.0417, device='cuda:0')
distance 2 is tensor(14.6432, device='cuda:0')
compute distance is  tensor(14.6432, device='cuda:0')
compute norm is  tensor(56.2021, device='cuda:0')
distance 1 is tensor(195.3031, device='cuda:0')
distance 2 is tensor(14.5207, device='cuda:0')
compute distance is  tensor(14.5207, device='cuda:0')
compute norm is  tensor(56.1776, device='cuda:0')
distance 1 is tensor(190.6885, device='cuda:0')
distance 2 is tensor(14.1662, device='cuda:0')
compute distance is  tensor(14.1662, device='cuda:0')
compute norm is  tensor(56.0144, device='cuda:0')
distance 1 is tensor(195.6067, device='cuda:0')
distance 2 is tensor(14.3498, device='cuda:0')
compute distance is  tensor(14.3498, device='cuda:0')
compute norm is  tensor(56.2073, device='cuda:0')
distance 1 is tensor(201.8190, device='cuda:0')
distance 2 is tensor(15.0828, device='cuda:0')
compute distance is  tensor(15.0828, device='cuda:0')
compute norm is  tensor(56.3527, device='cuda:0')
distance 1 is tensor(191.6765, device='cuda:0')
distance 2 is tensor(14.3096, device='cuda:0')
compute distance is  tensor(14.3096, device='cuda:0')
compute norm is  tensor(56.0377, device='cuda:0')
distance 1 is tensor(199.1698, device='cuda:0')
distance 2 is tensor(14.7897, device='cuda:0')
compute distance is  tensor(14.7897, device='cuda:0')
compute norm is  tensor(56.2911, device='cuda:0')
distance 1 is tensor(209.9301, device='cuda:0')
distance 2 is tensor(15.2869, device='cuda:0')
compute distance is  tensor(15.2869, device='cuda:0')
compute norm is  tensor(56.4577, device='cuda:0')
distance 1 is tensor(187.5476, device='cuda:0')
distance 2 is tensor(14.0151, device='cuda:0')
compute distance is  tensor(14.0151, device='cuda:0')
compute norm is  tensor(56.0602, device='cuda:0')
distance 1 is tensor(190.4698, device='cuda:0')
distance 2 is tensor(14.1049, device='cuda:0')
compute distance is  tensor(14.1049, device='cuda:0')
compute norm is  tensor(56.2099, device='cuda:0')
distance 1 is tensor(188.5401, device='cuda:0')
distance 2 is tensor(13.9756, device='cuda:0')
compute distance is  tensor(13.9756, device='cuda:0')
compute norm is  tensor(56.1736, device='cuda:0')
distance Threshold  is  tensor(15.2869, device='cuda:0')
distance 1 is tensor(1009077.5000, device='cuda:0')
distance 2 is tensor(73608.4922, device='cuda:0')
________________________________
test distance is  tensor(73608.4922, device='cuda:0')
test similarity is  tensor(0.3520, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82062153233301e+17
test entropy is  0.0
________________________________
cal ratio is  0.012969937560095235
distance 1 is tensor(13087.6768, device='cuda:0')
distance 2 is tensor(954.6975, device='cuda:0')
cal_distance is  tensor(954.6975, device='cuda:0')
cal ratio is  0.1138856387033999
distance 1 is tensor(1490.5038, device='cuda:0')
distance 2 is tensor(108.7263, device='cuda:0')
cal_distance is  tensor(108.7263, device='cuda:0')
cal ratio is  0.33746947508100955
distance 1 is tensor(503.0035, device='cuda:0')
distance 2 is tensor(36.6918, device='cuda:0')
cal_distance is  tensor(36.6918, device='cuda:0')
cal ratio is  0.5809211708347151
distance 1 is tensor(292.2079, device='cuda:0')
distance 2 is tensor(21.3151, device='cuda:0')
cal_distance is  tensor(21.3151, device='cuda:0')
cal ratio is  0.7621819117999294
distance 1 is tensor(222.7170, device='cuda:0')
distance 2 is tensor(16.2459, device='cuda:0')
cal_distance is  tensor(16.2459, device='cuda:0')
cal ratio is  0.8730302908941595
distance 1 is tensor(194.4395, device='cuda:0')
distance 2 is tensor(14.1832, device='cuda:0')
cal_distance is  tensor(14.1832, device='cuda:0')
distance 1 is tensor(194.4395, device='cuda:0')
distance 2 is tensor(14.1832, device='cuda:0')
________________________________
test distance is  tensor(14.1832, device='cuda:0')
test similarity is  tensor(0.9529, device='cuda:0')
test acc is  0.3200833334896732
test loss is 241.414697870771
test entropy is  0.00014692222194921003
________________________________
distance 1 is tensor(194.4395, device='cuda:0')
distance 2 is tensor(14.1832, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.00014736725083254622
avg test loss is  241.24010288588275
avg accuracy is  0.3201000001563398
solo acc is  0.10041666682299864
compute similarity  is  tensor(0.9529, device='cuda:0')
compute_distance is  tensor(14.1832, device='cuda:0')
compute_norm is  tensor(60.2631, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(176.3840, device='cuda:0')
distance 2 is tensor(14.8503, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9519207023862583
avg test loss is  1.4628615369166393
avg accuracy is  0.57200000015634
solo acc is  0.2570833334896719
compute similarity  is  tensor(0.9557, device='cuda:0')
compute_distance is  tensor(14.8503, device='cuda:0')
compute_norm is  tensor(60.4035, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(176.3840, device='cuda:0')
distance 2 is tensor(14.8503, device='cuda:0')
________________________________
test distance is  tensor(14.8503, device='cuda:0')
test similarity is  tensor(0.9557, device='cuda:0')
test acc is  0.5734500001563398
test loss is 1.46149928623171
test entropy is  0.9516210686931732
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4338620901107788
mal norm is  tensor(9.3664, device='cuda:0')
distance 1 is tensor(176.3840, device='cuda:0')
distance 2 is tensor(14.8503, device='cuda:0')
mal distance is  tensor(14.8503, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2449, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.8034, device='cuda:0')
c is  tensor(0.0216, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.8414, device='cuda:0')
c is  tensor(0.0208, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.7230, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.4429, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.0374, device='cuda:0')
c is  tensor(0.0201, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0026, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9794, device='cuda:0')
c is  tensor(0.0196, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.6349, device='cuda:0')
c is  tensor(0.0211, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.0325, device='cuda:0')
c is  tensor(0.0203, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0017, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(936.6399, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0024, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(763.2596, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.2805, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.0168, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0018, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.4402, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.8317, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.8455, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.5172, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(685.0192, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(698.8340, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.4328, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.3032, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.3981, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.0327, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.7281, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0019, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.7247, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.6628, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0023, device='cuda:0')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 91.38% 

Test Accuracy: 89.40% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
 benign loss is  1.1654102802276611
distance 1 is tensor(94.8916, device='cuda:0')
distance 2 is tensor(7.0137, device='cuda:0')
benign distance is  tensor(7.0137, device='cuda:0')
norm1 res is  tensor(0.0958, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.46811380982398987
distance 1 is tensor(140.0660, device='cuda:0')
distance 2 is tensor(9.9895, device='cuda:0')
benign distance is  tensor(9.9895, device='cuda:0')
norm1 res is  tensor(0.1408, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7377994060516357
distance 1 is tensor(113.4823, device='cuda:0')
distance 2 is tensor(8.2105, device='cuda:0')
benign distance is  tensor(8.2105, device='cuda:0')
norm1 res is  tensor(0.1170, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6150251626968384
distance 1 is tensor(126.5658, device='cuda:0')
distance 2 is tensor(9.0065, device='cuda:0')
benign distance is  tensor(9.0065, device='cuda:0')
norm1 res is  tensor(0.1255, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6101307272911072
distance 1 is tensor(129.0303, device='cuda:0')
distance 2 is tensor(9.2774, device='cuda:0')
benign distance is  tensor(9.2774, device='cuda:0')
norm1 res is  tensor(0.1317, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.3990762233734131
distance 1 is tensor(138.6072, device='cuda:0')
distance 2 is tensor(9.8708, device='cuda:0')
benign distance is  tensor(9.8708, device='cuda:0')
norm1 res is  tensor(0.1417, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.16057974100112915
distance 1 is tensor(114.3424, device='cuda:0')
distance 2 is tensor(8.3292, device='cuda:0')
benign distance is  tensor(8.3292, device='cuda:0')
norm1 res is  tensor(0.1159, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.40714868903160095
distance 1 is tensor(134.9245, device='cuda:0')
distance 2 is tensor(9.6705, device='cuda:0')
benign distance is  tensor(9.6705, device='cuda:0')
norm1 res is  tensor(0.1384, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.2994154095649719
distance 1 is tensor(146.7157, device='cuda:0')
distance 2 is tensor(10.5714, device='cuda:0')
benign distance is  tensor(10.5714, device='cuda:0')
norm1 res is  tensor(0.1503, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.3956950306892395
distance 1 is tensor(150.0895, device='cuda:0')
distance 2 is tensor(10.8444, device='cuda:0')
benign distance is  tensor(10.8444, device='cuda:0')
norm1 res is  tensor(0.1550, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.6732765436172485
distance 1 is tensor(161.1828, device='cuda:0')
distance 2 is tensor(11.4836, device='cuda:0')
benign distance is  tensor(11.4836, device='cuda:0')
norm1 res is  tensor(0.1594, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0966951847076416
distance 1 is tensor(151.7471, device='cuda:0')
distance 2 is tensor(10.8649, device='cuda:0')
benign distance is  tensor(10.8649, device='cuda:0')
norm1 res is  tensor(0.1545, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.1363136768341064
distance 1 is tensor(154.2729, device='cuda:0')
distance 2 is tensor(11.2613, device='cuda:0')
benign distance is  tensor(11.2613, device='cuda:0')
norm1 res is  tensor(0.1568, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.10325057804584503
distance 1 is tensor(130.4456, device='cuda:0')
distance 2 is tensor(9.4691, device='cuda:0')
benign distance is  tensor(9.4691, device='cuda:0')
norm1 res is  tensor(0.1319, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.15001198649406433
distance 1 is tensor(146.8453, device='cuda:0')
distance 2 is tensor(10.5369, device='cuda:0')
benign distance is  tensor(10.5369, device='cuda:0')
norm1 res is  tensor(0.1482, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.4892193377017975
distance 1 is tensor(150.0950, device='cuda:0')
distance 2 is tensor(10.7683, device='cuda:0')
benign distance is  tensor(10.7683, device='cuda:0')
norm1 res is  tensor(0.1540, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.23603156208992004
distance 1 is tensor(151.2524, device='cuda:0')
distance 2 is tensor(10.8734, device='cuda:0')
benign distance is  tensor(10.8734, device='cuda:0')
norm1 res is  tensor(0.1536, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.34470587968826294
distance 1 is tensor(144.7781, device='cuda:0')
distance 2 is tensor(10.3300, device='cuda:0')
benign distance is  tensor(10.3300, device='cuda:0')
norm1 res is  tensor(0.1427, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.1342340111732483
distance 1 is tensor(151.0975, device='cuda:0')
distance 2 is tensor(10.9999, device='cuda:0')
benign distance is  tensor(10.9999, device='cuda:0')
norm1 res is  tensor(0.1521, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.601024329662323
distance 1 is tensor(140.1228, device='cuda:0')
distance 2 is tensor(10.1205, device='cuda:0')
benign distance is  tensor(10.1205, device='cuda:0')
norm1 res is  tensor(0.1406, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.9902162551879883
distance 1 is tensor(142.2878, device='cuda:0')
distance 2 is tensor(10.2031, device='cuda:0')
benign distance is  tensor(10.2031, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.20856383442878723
distance 1 is tensor(138.9956, device='cuda:0')
distance 2 is tensor(9.9052, device='cuda:0')
benign distance is  tensor(9.9052, device='cuda:0')
norm1 res is  tensor(0.1389, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.6005120277404785
distance 1 is tensor(141.2638, device='cuda:0')
distance 2 is tensor(10.2628, device='cuda:0')
benign distance is  tensor(10.2628, device='cuda:0')
norm1 res is  tensor(0.1446, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.4354439675807953
distance 1 is tensor(141.9191, device='cuda:0')
distance 2 is tensor(10.0926, device='cuda:0')
benign distance is  tensor(10.0926, device='cuda:0')
norm1 res is  tensor(0.1434, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(151.9648, device='cuda:0')
distance 2 is tensor(10.7398, device='cuda:0')
compute distance is  tensor(10.7398, device='cuda:0')
compute norm is  tensor(55.5342, device='cuda:0')
distance 1 is tensor(159.6008, device='cuda:0')
distance 2 is tensor(11.4964, device='cuda:0')
compute distance is  tensor(11.4964, device='cuda:0')
compute norm is  tensor(55.7193, device='cuda:0')
distance 1 is tensor(177.2618, device='cuda:0')
distance 2 is tensor(12.6372, device='cuda:0')
compute distance is  tensor(12.6372, device='cuda:0')
compute norm is  tensor(56.1037, device='cuda:0')
distance 1 is tensor(160.5166, device='cuda:0')
distance 2 is tensor(11.4356, device='cuda:0')
compute distance is  tensor(11.4356, device='cuda:0')
compute norm is  tensor(55.9228, device='cuda:0')
distance 1 is tensor(161.6174, device='cuda:0')
distance 2 is tensor(11.5984, device='cuda:0')
compute distance is  tensor(11.5984, device='cuda:0')
compute norm is  tensor(55.8512, device='cuda:0')
distance 1 is tensor(161.7973, device='cuda:0')
distance 2 is tensor(11.7598, device='cuda:0')
compute distance is  tensor(11.7598, device='cuda:0')
compute norm is  tensor(55.8538, device='cuda:0')
distance 1 is tensor(159.2607, device='cuda:0')
distance 2 is tensor(11.4446, device='cuda:0')
compute distance is  tensor(11.4446, device='cuda:0')
compute norm is  tensor(55.9049, device='cuda:0')
distance 1 is tensor(173.6641, device='cuda:0')
distance 2 is tensor(12.4144, device='cuda:0')
compute distance is  tensor(12.4144, device='cuda:0')
compute norm is  tensor(56.2288, device='cuda:0')
distance 1 is tensor(174.8783, device='cuda:0')
distance 2 is tensor(12.3660, device='cuda:0')
compute distance is  tensor(12.3660, device='cuda:0')
compute norm is  tensor(56.1024, device='cuda:0')
distance 1 is tensor(180.6827, device='cuda:0')
distance 2 is tensor(12.9977, device='cuda:0')
compute distance is  tensor(12.9977, device='cuda:0')
compute norm is  tensor(56.3807, device='cuda:0')
distance 1 is tensor(173.2648, device='cuda:0')
distance 2 is tensor(12.2565, device='cuda:0')
compute distance is  tensor(12.2565, device='cuda:0')
compute norm is  tensor(56.1640, device='cuda:0')
distance 1 is tensor(165.3851, device='cuda:0')
distance 2 is tensor(11.7124, device='cuda:0')
compute distance is  tensor(11.7124, device='cuda:0')
compute norm is  tensor(56.1532, device='cuda:0')
distance Threshold  is  tensor(12.9977, device='cuda:0')
distance 1 is tensor(1009114.3125, device='cuda:0')
distance 2 is tensor(73611.6016, device='cuda:0')
________________________________
test distance is  tensor(73611.6016, device='cuda:0')
test similarity is  tensor(0.2737, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.822736254080369e+17
test entropy is  0.0
________________________________
cal ratio is  0.011959204987920108
distance 1 is tensor(12068.2129, device='cuda:0')
distance 2 is tensor(880.3364, device='cuda:0')
cal_distance is  tensor(880.3364, device='cuda:0')
cal ratio is  0.10935814276285939
distance 1 is tensor(1319.7625, device='cuda:0')
distance 2 is tensor(96.2719, device='cuda:0')
cal_distance is  tensor(96.2719, device='cuda:0')
cal ratio is  0.33069342219814535
distance 1 is tensor(436.4408, device='cuda:0')
distance 2 is tensor(31.8365, device='cuda:0')
cal_distance is  tensor(31.8365, device='cuda:0')
cal ratio is  0.5750595297784906
distance 1 is tensor(250.9820, device='cuda:0')
distance 2 is tensor(18.3079, device='cuda:0')
cal_distance is  tensor(18.3079, device='cuda:0')
cal ratio is  0.7583267606373539
distance 1 is tensor(190.3278, device='cuda:0')
distance 2 is tensor(13.8834, device='cuda:0')
cal_distance is  tensor(13.8834, device='cuda:0')
cal ratio is  0.8708195851045357
distance 1 is tensor(165.7420, device='cuda:0')
distance 2 is tensor(12.0899, device='cuda:0')
cal_distance is  tensor(12.0899, device='cuda:0')
distance 1 is tensor(165.7420, device='cuda:0')
distance 2 is tensor(12.0899, device='cuda:0')
________________________________
test distance is  tensor(12.0899, device='cuda:0')
test similarity is  tensor(0.9601, device='cuda:0')
test acc is  0.8496333334896565
test loss is 65.59169925860505
test entropy is  0.019478439763924025
________________________________
distance 1 is tensor(165.7420, device='cuda:0')
distance 2 is tensor(12.0899, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.019785509670944557
avg test loss is  65.5475613892968
avg accuracy is  0.8500333334896566
solo acc is  0.21525000015633702
compute similarity  is  tensor(0.9601, device='cuda:0')
compute_distance is  tensor(12.0899, device='cuda:0')
compute_norm is  tensor(59.0231, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(154.6121, device='cuda:0')
distance 2 is tensor(12.8910, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9158557773526035
avg test loss is  1.3746875876556837
avg accuracy is  0.8225166668229911
solo acc is  0.29443333348967277
compute similarity  is  tensor(0.9606, device='cuda:0')
compute_distance is  tensor(12.8910, device='cuda:0')
compute_norm is  tensor(58.5420, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.9088, device='cuda:0')
distance 2 is tensor(12.9868, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8712255230971745
avg test loss is  1.4558044403854973
avg accuracy is  0.8169333334896579
solo acc is  0.23930000015633793
compute similarity  is  tensor(0.9605, device='cuda:0')
compute_distance is  tensor(12.9868, device='cuda:0')
compute_norm is  tensor(58.2598, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.0912, device='cuda:0')
distance 2 is tensor(13.0333, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8698271105665643
avg test loss is  1.43876683356157
avg accuracy is  0.8135666668229914
solo acc is  0.2319000001563376
compute similarity  is  tensor(0.9604, device='cuda:0')
compute_distance is  tensor(13.0333, device='cuda:0')
compute_norm is  tensor(57.9842, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.3069, device='cuda:0')
distance 2 is tensor(13.0708, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8679471703480556
avg test loss is  1.4187322218280864
avg accuracy is  0.815283333489658
solo acc is  0.23173333348967104
compute similarity  is  tensor(0.9603, device='cuda:0')
compute_distance is  tensor(13.0708, device='cuda:0')
compute_norm is  tensor(57.7122, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.6293, device='cuda:0')
distance 2 is tensor(13.1048, device='cuda:0')
________________________________
test distance is  tensor(13.1048, device='cuda:0')
test similarity is  tensor(0.9602, device='cuda:0')
test acc is  0.8142666668229914
test loss is 1.4100399567628465
test entropy is  0.8613804716037027
________________________________
cal ratio is  0.8963155250857366
distance 1 is tensor(139.4937, device='cuda:0')
distance 2 is tensor(11.7460, device='cuda:0')
cal_distance is  tensor(11.7460, device='cuda:0')
distance 1 is tensor(139.4937, device='cuda:0')
distance 2 is tensor(11.7460, device='cuda:0')
________________________________
test distance is  tensor(11.7460, device='cuda:0')
test similarity is  tensor(0.9673, device='cuda:0')
test acc is  0.834650000156324
test loss is 1.128302541241717
test entropy is  0.9734800682901573
________________________________
distance 1 is tensor(139.4937, device='cuda:0')
distance 2 is tensor(11.7460, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9734105164054107
avg test loss is  1.128794206802779
avg accuracy is  0.8364500001563239
solo acc is  0.4106166668230079
compute similarity  is  tensor(0.9673, device='cuda:0')
compute_distance is  tensor(11.7460, device='cuda:0')
compute_norm is  tensor(57.0541, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.6261, device='cuda:0')
distance 2 is tensor(11.8976, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8580024394907677
avg test loss is  1.3861670752069843
avg accuracy is  0.8277166668229908
solo acc is  0.23461666682300447
compute similarity  is  tensor(0.9670, device='cuda:0')
compute_distance is  tensor(11.8976, device='cuda:0')
compute_norm is  tensor(56.7913, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.3123, device='cuda:0')
distance 2 is tensor(11.9600, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8522774052264085
avg test loss is  1.3809937744506642
avg accuracy is  0.8272500001563242
solo acc is  0.23191666682300435
compute similarity  is  tensor(0.9669, device='cuda:0')
compute_distance is  tensor(11.9600, device='cuda:0')
compute_norm is  tensor(56.5233, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.0285, device='cuda:0')
distance 2 is tensor(12.0149, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8496934943743097
avg test loss is  1.371963339700882
avg accuracy is  0.8290333334896574
solo acc is  0.2298166668230043
compute similarity  is  tensor(0.9668, device='cuda:0')
compute_distance is  tensor(12.0149, device='cuda:0')
compute_norm is  tensor(56.2589, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.7367, device='cuda:0')
distance 2 is tensor(12.0663, device='cuda:0')
exit early
distance 1 is tensor(142.7367, device='cuda:0')
distance 2 is tensor(12.0663, device='cuda:0')
________________________________
test distance is  tensor(12.0663, device='cuda:0')
test similarity is  tensor(0.9667, device='cuda:0')
test acc is  0.8297166668229907
test loss is 1.3724543148520658
test entropy is  0.8405859565048583
________________________________
distance 1 is tensor(142.7367, device='cuda:0')
distance 2 is tensor(12.0663, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8418784874842874
avg test loss is  1.3762365935453729
avg accuracy is  0.8282333334896576
solo acc is  0.2245000001563374
compute similarity  is  tensor(0.9667, device='cuda:0')
compute_distance is  tensor(12.0663, device='cuda:0')
compute_norm is  tensor(55.9967, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.5235, device='cuda:0')
distance 2 is tensor(12.1223, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8383779741172344
avg test loss is  1.3687487369153037
avg accuracy is  0.8295666668229907
solo acc is  0.21978333348967058
compute similarity  is  tensor(0.9666, device='cuda:0')
compute_distance is  tensor(12.1223, device='cuda:0')
compute_norm is  tensor(55.7371, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.2942, device='cuda:0')
distance 2 is tensor(12.1731, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8356474272604945
avg test loss is  1.353075656428266
avg accuracy is  0.8303166668229908
solo acc is  0.2267000001563375
compute similarity  is  tensor(0.9665, device='cuda:0')
compute_distance is  tensor(12.1731, device='cuda:0')
compute_norm is  tensor(55.4791, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.1162, device='cuda:0')
distance 2 is tensor(12.2256, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8394678803776373
avg test loss is  1.3449195549686326
avg accuracy is  0.832200000156324
solo acc is  0.22171666682300398
compute similarity  is  tensor(0.9664, device='cuda:0')
compute_distance is  tensor(12.2256, device='cuda:0')
compute_norm is  tensor(55.2230, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.9678, device='cuda:0')
distance 2 is tensor(12.2784, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8405276901050925
avg test loss is  1.3309189374767132
avg accuracy is  0.8343833334896572
solo acc is  0.22481666682300414
compute similarity  is  tensor(0.9664, device='cuda:0')
compute_distance is  tensor(12.2784, device='cuda:0')
compute_norm is  tensor(54.9681, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.8675, device='cuda:0')
distance 2 is tensor(12.3354, device='cuda:0')
________________________________
test distance is  tensor(12.3354, device='cuda:0')
test similarity is  tensor(0.9663, device='cuda:0')
test acc is  0.8354000001563239
test loss is 1.340676903978848
test entropy is  0.825082931945573
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.138265609741211
mal norm is  tensor(6.7306, device='cuda:0')
distance 1 is tensor(146.8675, device='cuda:0')
distance 2 is tensor(12.3354, device='cuda:0')
mal distance is  tensor(12.3354, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.2165, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(380.2139, device='cuda:0')
c is  tensor(0.0239, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.0654, device='cuda:0')
c is  tensor(0.0199, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(453.8417, device='cuda:0')
c is  tensor(0.0218, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(498.0530, device='cuda:0')
c is  tensor(0.0209, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(516.8846, device='cuda:0')
c is  tensor(0.0205, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.7885, device='cuda:0')
c is  tensor(0.0197, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(452.5599, device='cuda:0')
c is  tensor(0.0219, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.9547, device='cuda:0')
c is  tensor(0.0200, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.0607, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.1432e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.1788, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.2617, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.9037, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7493, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.9360, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.0729, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.3668, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.9768e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.7546, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.8346e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8405, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4257e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.8735, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.0837, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.9782e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.0573, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.1737, device='cuda:0')
c is  tensor(0.0182, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.2346, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.0079, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.1619, device='cuda:0')
c is  tensor(0.0189, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
len accept list 7
len all weights is 7
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 91.29% 

Test Accuracy: 89.23% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
 benign loss is  0.10780680179595947
distance 1 is tensor(114.5441, device='cuda:0')
distance 2 is tensor(8.2336, device='cuda:0')
benign distance is  tensor(8.2336, device='cuda:0')
norm1 res is  tensor(0.1175, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5288676023483276
distance 1 is tensor(139.0197, device='cuda:0')
distance 2 is tensor(9.8476, device='cuda:0')
benign distance is  tensor(9.8476, device='cuda:0')
norm1 res is  tensor(0.1402, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.10299699008464813
distance 1 is tensor(122.1447, device='cuda:0')
distance 2 is tensor(8.7133, device='cuda:0')
benign distance is  tensor(8.7133, device='cuda:0')
norm1 res is  tensor(0.1261, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.38409513235092163
distance 1 is tensor(124.0380, device='cuda:0')
distance 2 is tensor(8.8086, device='cuda:0')
benign distance is  tensor(8.8086, device='cuda:0')
norm1 res is  tensor(0.1237, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7691196799278259
distance 1 is tensor(127.5605, device='cuda:0')
distance 2 is tensor(9.1746, device='cuda:0')
benign distance is  tensor(9.1746, device='cuda:0')
norm1 res is  tensor(0.1304, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8384235501289368
distance 1 is tensor(152.9788, device='cuda:0')
distance 2 is tensor(11.0685, device='cuda:0')
benign distance is  tensor(11.0685, device='cuda:0')
norm1 res is  tensor(0.1604, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.057092975825071335
distance 1 is tensor(112.5278, device='cuda:0')
distance 2 is tensor(7.8924, device='cuda:0')
benign distance is  tensor(7.8924, device='cuda:0')
norm1 res is  tensor(0.1095, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.4715070128440857
distance 1 is tensor(130.0191, device='cuda:0')
distance 2 is tensor(9.2888, device='cuda:0')
benign distance is  tensor(9.2888, device='cuda:0')
norm1 res is  tensor(0.1321, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.1766836792230606
distance 1 is tensor(157.0841, device='cuda:0')
distance 2 is tensor(11.1975, device='cuda:0')
benign distance is  tensor(11.1975, device='cuda:0')
norm1 res is  tensor(0.1598, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7458975911140442
distance 1 is tensor(156.4766, device='cuda:0')
distance 2 is tensor(11.3305, device='cuda:0')
benign distance is  tensor(11.3305, device='cuda:0')
norm1 res is  tensor(0.1616, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.3081156611442566
distance 1 is tensor(146.4040, device='cuda:0')
distance 2 is tensor(10.5166, device='cuda:0')
benign distance is  tensor(10.5166, device='cuda:0')
norm1 res is  tensor(0.1458, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.4403116703033447
distance 1 is tensor(145.7051, device='cuda:0')
distance 2 is tensor(10.4165, device='cuda:0')
benign distance is  tensor(10.4165, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.0871441587805748
distance 1 is tensor(125.9139, device='cuda:0')
distance 2 is tensor(9.0852, device='cuda:0')
benign distance is  tensor(9.0852, device='cuda:0')
norm1 res is  tensor(0.1303, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.6015877723693848
distance 1 is tensor(143.2421, device='cuda:0')
distance 2 is tensor(10.2941, device='cuda:0')
benign distance is  tensor(10.2941, device='cuda:0')
norm1 res is  tensor(0.1437, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.41377443075180054
distance 1 is tensor(149.1272, device='cuda:0')
distance 2 is tensor(10.7058, device='cuda:0')
benign distance is  tensor(10.7058, device='cuda:0')
norm1 res is  tensor(0.1519, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.9569240808486938
distance 1 is tensor(149.6950, device='cuda:0')
distance 2 is tensor(10.7798, device='cuda:0')
benign distance is  tensor(10.7798, device='cuda:0')
norm1 res is  tensor(0.1507, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.46862244606018066
distance 1 is tensor(154.0718, device='cuda:0')
distance 2 is tensor(10.9727, device='cuda:0')
benign distance is  tensor(10.9727, device='cuda:0')
norm1 res is  tensor(0.1517, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.47682467103004456
distance 1 is tensor(135.0396, device='cuda:0')
distance 2 is tensor(9.8433, device='cuda:0')
benign distance is  tensor(9.8433, device='cuda:0')
norm1 res is  tensor(0.1416, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.07981337606906891
distance 1 is tensor(147.7612, device='cuda:0')
distance 2 is tensor(10.7150, device='cuda:0')
benign distance is  tensor(10.7150, device='cuda:0')
norm1 res is  tensor(0.1505, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  0.13619910180568695
distance 1 is tensor(140.6808, device='cuda:0')
distance 2 is tensor(10.1733, device='cuda:0')
benign distance is  tensor(10.1733, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.33732977509498596
distance 1 is tensor(155.1832, device='cuda:0')
distance 2 is tensor(11.1469, device='cuda:0')
benign distance is  tensor(11.1469, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.16736067831516266
distance 1 is tensor(142.3730, device='cuda:0')
distance 2 is tensor(10.2568, device='cuda:0')
benign distance is  tensor(10.2568, device='cuda:0')
norm1 res is  tensor(0.1450, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.47681888937950134
distance 1 is tensor(138.6747, device='cuda:0')
distance 2 is tensor(9.9306, device='cuda:0')
benign distance is  tensor(9.9306, device='cuda:0')
norm1 res is  tensor(0.1415, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.5025326013565063
distance 1 is tensor(138.5090, device='cuda:0')
distance 2 is tensor(9.9367, device='cuda:0')
benign distance is  tensor(9.9367, device='cuda:0')
norm1 res is  tensor(0.1400, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(154.4159, device='cuda:0')
distance 2 is tensor(10.9844, device='cuda:0')
compute distance is  tensor(10.9844, device='cuda:0')
compute norm is  tensor(55.7344, device='cuda:0')
distance 1 is tensor(148.4531, device='cuda:0')
distance 2 is tensor(10.5275, device='cuda:0')
compute distance is  tensor(10.5275, device='cuda:0')
compute norm is  tensor(55.6242, device='cuda:0')
distance 1 is tensor(156.8026, device='cuda:0')
distance 2 is tensor(11.2855, device='cuda:0')
compute distance is  tensor(11.2855, device='cuda:0')
compute norm is  tensor(55.8707, device='cuda:0')
distance 1 is tensor(152.9653, device='cuda:0')
distance 2 is tensor(10.9266, device='cuda:0')
compute distance is  tensor(10.9266, device='cuda:0')
compute norm is  tensor(55.7435, device='cuda:0')
distance 1 is tensor(159.4372, device='cuda:0')
distance 2 is tensor(11.4560, device='cuda:0')
compute distance is  tensor(11.4560, device='cuda:0')
compute norm is  tensor(55.9642, device='cuda:0')
distance 1 is tensor(162.6978, device='cuda:0')
distance 2 is tensor(11.7309, device='cuda:0')
compute distance is  tensor(11.7309, device='cuda:0')
compute norm is  tensor(56.0532, device='cuda:0')
distance 1 is tensor(162.7264, device='cuda:0')
distance 2 is tensor(11.6283, device='cuda:0')
compute distance is  tensor(11.6283, device='cuda:0')
compute norm is  tensor(55.9765, device='cuda:0')
distance 1 is tensor(164.4424, device='cuda:0')
distance 2 is tensor(11.7099, device='cuda:0')
compute distance is  tensor(11.7099, device='cuda:0')
compute norm is  tensor(56.0722, device='cuda:0')
distance 1 is tensor(163.8054, device='cuda:0')
distance 2 is tensor(11.5558, device='cuda:0')
compute distance is  tensor(11.5558, device='cuda:0')
compute norm is  tensor(56.0909, device='cuda:0')
distance 1 is tensor(146.1858, device='cuda:0')
distance 2 is tensor(10.5528, device='cuda:0')
compute distance is  tensor(10.5528, device='cuda:0')
compute norm is  tensor(55.6828, device='cuda:0')
distance 1 is tensor(158.8359, device='cuda:0')
distance 2 is tensor(11.2937, device='cuda:0')
compute distance is  tensor(11.2937, device='cuda:0')
compute norm is  tensor(55.9463, device='cuda:0')
distance 1 is tensor(155.4467, device='cuda:0')
distance 2 is tensor(10.9427, device='cuda:0')
compute distance is  tensor(10.9427, device='cuda:0')
compute norm is  tensor(56.0109, device='cuda:0')
distance Threshold  is  tensor(11.7309, device='cuda:0')
distance 1 is tensor(1009125.1875, device='cuda:0')
distance 2 is tensor(73612.5000, device='cuda:0')
________________________________
test distance is  tensor(73612.5000, device='cuda:0')
test similarity is  tensor(0.2480, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82506935064679e+17
test entropy is  0.0
________________________________
cal ratio is  0.011361412610442727
distance 1 is tensor(11465.0938, device='cuda:0')
distance 2 is tensor(836.3420, device='cuda:0')
cal_distance is  tensor(836.3420, device='cuda:0')
cal ratio is  0.10658993000732034
distance 1 is tensor(1222.0688, device='cuda:0')
distance 2 is tensor(89.1456, device='cuda:0')
cal_distance is  tensor(89.1456, device='cuda:0')
cal ratio is  0.3264811215919791
distance 1 is tensor(398.9865, device='cuda:0')
distance 2 is tensor(29.1044, device='cuda:0')
cal_distance is  tensor(29.1044, device='cuda:0')
cal ratio is  0.5713852481565587
distance 1 is tensor(227.9776, device='cuda:0')
distance 2 is tensor(16.6298, device='cuda:0')
cal_distance is  tensor(16.6298, device='cuda:0')
cal ratio is  0.7559003490608934
distance 1 is tensor(172.3298, device='cuda:0')
distance 2 is tensor(12.5705, device='cuda:0')
cal_distance is  tensor(12.5705, device='cuda:0')
cal ratio is  0.8694252731026211
distance 1 is tensor(149.8287, device='cuda:0')
distance 2 is tensor(10.9291, device='cuda:0')
cal_distance is  tensor(10.9291, device='cuda:0')
distance 1 is tensor(149.8287, device='cuda:0')
distance 2 is tensor(10.9291, device='cuda:0')
________________________________
test distance is  tensor(10.9291, device='cuda:0')
test similarity is  tensor(0.9658, device='cuda:0')
test acc is  0.8718166668229891
test loss is 32.2247141022672
test entropy is  0.034762755190995316
________________________________
distance 1 is tensor(149.8287, device='cuda:0')
distance 2 is tensor(10.9291, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.03502063706009857
avg test loss is  32.18952057153177
avg accuracy is  0.8705500001563223
solo acc is  0.3555333334896738
compute similarity  is  tensor(0.9658, device='cuda:0')
compute_distance is  tensor(10.9291, device='cuda:0')
compute_norm is  tensor(58.6507, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(141.1185, device='cuda:0')
distance 2 is tensor(11.9589, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.91865399219334
avg test loss is  1.3405464031675984
avg accuracy is  0.8458333334896567
solo acc is  0.31470000015633975
compute similarity  is  tensor(0.9657, device='cuda:0')
compute_distance is  tensor(11.9589, device='cuda:0')
compute_norm is  tensor(58.0601, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.8016, device='cuda:0')
distance 2 is tensor(12.0913, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8727590364179632
avg test loss is  1.4451966416607025
avg accuracy is  0.8417000001563236
solo acc is  0.24263333348967142
compute similarity  is  tensor(0.9655, device='cuda:0')
compute_distance is  tensor(12.0913, device='cuda:0')
compute_norm is  tensor(57.7767, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.3186, device='cuda:0')
distance 2 is tensor(12.1666, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8681918165322814
avg test loss is  1.4266550856104283
avg accuracy is  0.839183333489657
solo acc is  0.24373333348967144
compute similarity  is  tensor(0.9653, device='cuda:0')
compute_distance is  tensor(12.1666, device='cuda:0')
compute_norm is  tensor(57.4984, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.8875, device='cuda:0')
distance 2 is tensor(12.2292, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.862132068699611
avg test loss is  1.4139015415329923
avg accuracy is  0.8410166668229903
solo acc is  0.23841666682300458
compute similarity  is  tensor(0.9652, device='cuda:0')
compute_distance is  tensor(12.2292, device='cuda:0')
compute_norm is  tensor(57.2245, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.5361, device='cuda:0')
distance 2 is tensor(12.2889, device='cuda:0')
________________________________
test distance is  tensor(12.2889, device='cuda:0')
test similarity is  tensor(0.9651, device='cuda:0')
test acc is  0.8427166668229903
test loss is 1.3939981885047863
test entropy is  0.8678944578557126
________________________________
cal ratio is  0.8793289571880464
distance 1 is tensor(126.2162, device='cuda:0')
distance 2 is tensor(10.8060, device='cuda:0')
cal_distance is  tensor(10.8060, device='cuda:0')
distance 1 is tensor(126.2162, device='cuda:0')
distance 2 is tensor(10.8060, device='cuda:0')
________________________________
test distance is  tensor(10.8060, device='cuda:0')
test similarity is  tensor(0.9724, device='cuda:0')
test acc is  0.8596666668229895
test loss is 1.064314889691786
test entropy is  0.9865211120038144
________________________________
distance 1 is tensor(126.2162, device='cuda:0')
distance 2 is tensor(10.8060, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.9878620111357683
avg test loss is  1.0639265111006144
avg accuracy is  0.8605500001563229
solo acc is  0.4660666668230085
compute similarity  is  tensor(0.9724, device='cuda:0')
compute_distance is  tensor(10.8060, device='cuda:0')
compute_norm is  tensor(56.6177, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(128.0081, device='cuda:0')
distance 2 is tensor(11.0329, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8527653020328042
avg test loss is  1.380760105942358
avg accuracy is  0.8531166668229898
solo acc is  0.2406500001563379
compute similarity  is  tensor(0.9720, device='cuda:0')
compute_distance is  tensor(11.0329, device='cuda:0')
compute_norm is  tensor(56.3531, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(129.1229, device='cuda:0')
distance 2 is tensor(11.1289, device='cuda:0')
exit early
distance 1 is tensor(129.1229, device='cuda:0')
distance 2 is tensor(11.1289, device='cuda:0')
________________________________
test distance is  tensor(11.1289, device='cuda:0')
test similarity is  tensor(0.9718, device='cuda:0')
test acc is  0.8516000001563232
test loss is 1.3765997912075474
test entropy is  0.8475390668871052
________________________________
distance 1 is tensor(129.1229, device='cuda:0')
distance 2 is tensor(11.1289, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.8478422143947341
avg test loss is  1.376380950911467
avg accuracy is  0.8536000001563231
solo acc is  0.231933333489671
compute similarity  is  tensor(0.9718, device='cuda:0')
compute_distance is  tensor(11.1289, device='cuda:0')
compute_norm is  tensor(56.0865, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(130.1765, device='cuda:0')
distance 2 is tensor(11.2095, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8438293449024656
avg test loss is  1.3652187439678574
avg accuracy is  0.8534333334896564
solo acc is  0.23283333348967108
compute similarity  is  tensor(0.9717, device='cuda:0')
compute_distance is  tensor(11.2095, device='cuda:0')
compute_norm is  tensor(55.8220, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.1879, device='cuda:0')
distance 2 is tensor(11.2818, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8384306060352813
avg test loss is  1.3552238676847934
avg accuracy is  0.8544166668229898
solo acc is  0.23496666682300443
compute similarity  is  tensor(0.9716, device='cuda:0')
compute_distance is  tensor(11.2818, device='cuda:0')
compute_norm is  tensor(55.5581, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.2749, device='cuda:0')
distance 2 is tensor(11.3619, device='cuda:0')
exit early
distance 1 is tensor(132.2749, device='cuda:0')
distance 2 is tensor(11.3619, device='cuda:0')
________________________________
test distance is  tensor(11.3619, device='cuda:0')
test similarity is  tensor(0.9714, device='cuda:0')
test acc is  0.8553666668229898
test loss is 1.3578156855568957
test entropy is  0.837845397783495
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2392873764038086
mal norm is  tensor(6.2076, device='cuda:0')
distance 1 is tensor(132.2749, device='cuda:0')
distance 2 is tensor(11.3619, device='cuda:0')
mal distance is  tensor(11.3619, device='cuda:0')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1239, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(447.9785, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(554.6279, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(486.3641, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(487.3997, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.1447e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(512.3387, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.1476, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.5833e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(430.5629, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.8416, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.1027e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.7604, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.6944e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7758, device='cuda:0')
c is  tensor(0.0142, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.0004, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.2669e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.4070, device='cuda:0')
c is  tensor(0.0138, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.7066e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.1687, device='cuda:0')
c is  tensor(0.0140, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.3115, device='cuda:0')
c is  tensor(0.0139, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.5542e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.2672, device='cuda:0')
c is  tensor(0.0150, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.9388, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.4620e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.5673, device='cuda:0')
c is  tensor(0.0141, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:0')
len accept list 19
len all weights is 19
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 87.88% 

Test Accuracy: 86.28% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4253222942352295
distance 1 is tensor(150.4829, device='cuda:0')
distance 2 is tensor(11.0049, device='cuda:0')
benign distance is  tensor(11.0049, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.20061466097831726
distance 1 is tensor(150.3090, device='cuda:0')
distance 2 is tensor(10.9343, device='cuda:0')
benign distance is  tensor(10.9343, device='cuda:0')
norm1 res is  tensor(0.1457, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.08578280359506607
distance 1 is tensor(131.2789, device='cuda:0')
distance 2 is tensor(9.6229, device='cuda:0')
benign distance is  tensor(9.6229, device='cuda:0')
norm1 res is  tensor(0.1316, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.40656107664108276
distance 1 is tensor(141.3820, device='cuda:0')
distance 2 is tensor(10.4148, device='cuda:0')
benign distance is  tensor(10.4148, device='cuda:0')
norm1 res is  tensor(0.1411, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.6486595869064331
distance 1 is tensor(155.0689, device='cuda:0')
distance 2 is tensor(11.2201, device='cuda:0')
benign distance is  tensor(11.2201, device='cuda:0')
norm1 res is  tensor(0.1531, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.24033918976783752
distance 1 is tensor(176.6723, device='cuda:0')
distance 2 is tensor(13.0142, device='cuda:0')
benign distance is  tensor(13.0142, device='cuda:0')
norm1 res is  tensor(0.1793, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.07707477360963821
distance 1 is tensor(144.6602, device='cuda:0')
distance 2 is tensor(10.6292, device='cuda:0')
benign distance is  tensor(10.6292, device='cuda:0')
norm1 res is  tensor(0.1454, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.29354357719421387
distance 1 is tensor(144.9529, device='cuda:0')
distance 2 is tensor(10.5948, device='cuda:0')
benign distance is  tensor(10.5948, device='cuda:0')
norm1 res is  tensor(0.1447, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.2492479830980301
distance 1 is tensor(160.2903, device='cuda:0')
distance 2 is tensor(11.6526, device='cuda:0')
benign distance is  tensor(11.6526, device='cuda:0')
norm1 res is  tensor(0.1599, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.4814417362213135
distance 1 is tensor(156.0012, device='cuda:0')
distance 2 is tensor(11.2748, device='cuda:0')
benign distance is  tensor(11.2748, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.7405185699462891
distance 1 is tensor(153.5860, device='cuda:0')
distance 2 is tensor(11.1582, device='cuda:0')
benign distance is  tensor(11.1582, device='cuda:0')
norm1 res is  tensor(0.1483, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.2627103626728058
distance 1 is tensor(188.9636, device='cuda:0')
distance 2 is tensor(13.7820, device='cuda:0')
benign distance is  tensor(13.7820, device='cuda:0')
norm1 res is  tensor(0.1889, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.1013152599334717
distance 1 is tensor(169.8216, device='cuda:0')
distance 2 is tensor(12.6712, device='cuda:0')
benign distance is  tensor(12.6712, device='cuda:0')
norm1 res is  tensor(0.1706, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.17544589936733246
distance 1 is tensor(158.8236, device='cuda:0')
distance 2 is tensor(11.5791, device='cuda:0')
benign distance is  tensor(11.5791, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.2811509072780609
distance 1 is tensor(158.9253, device='cuda:0')
distance 2 is tensor(11.4708, device='cuda:0')
benign distance is  tensor(11.4708, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.4490794539451599
distance 1 is tensor(169.7491, device='cuda:0')
distance 2 is tensor(12.3825, device='cuda:0')
benign distance is  tensor(12.3825, device='cuda:0')
norm1 res is  tensor(0.1683, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(190.2890, device='cuda:0')
distance 2 is tensor(14.0393, device='cuda:0')
compute distance is  tensor(14.0393, device='cuda:0')
compute norm is  tensor(56.6074, device='cuda:0')
distance 1 is tensor(185.6988, device='cuda:0')
distance 2 is tensor(13.7308, device='cuda:0')
compute distance is  tensor(13.7308, device='cuda:0')
compute norm is  tensor(56.3777, device='cuda:0')
distance 1 is tensor(194.0397, device='cuda:0')
distance 2 is tensor(14.2080, device='cuda:0')
compute distance is  tensor(14.2080, device='cuda:0')
compute norm is  tensor(56.5360, device='cuda:0')
distance 1 is tensor(192.1791, device='cuda:0')
distance 2 is tensor(14.0171, device='cuda:0')
compute distance is  tensor(14.0171, device='cuda:0')
compute norm is  tensor(56.3290, device='cuda:0')
distance 1 is tensor(180.9763, device='cuda:0')
distance 2 is tensor(13.2899, device='cuda:0')
compute distance is  tensor(13.2899, device='cuda:0')
compute norm is  tensor(56.3206, device='cuda:0')
distance 1 is tensor(187.6419, device='cuda:0')
distance 2 is tensor(13.8226, device='cuda:0')
compute distance is  tensor(13.8226, device='cuda:0')
compute norm is  tensor(56.5294, device='cuda:0')
distance 1 is tensor(184.3829, device='cuda:0')
distance 2 is tensor(13.6946, device='cuda:0')
compute distance is  tensor(13.6946, device='cuda:0')
compute norm is  tensor(56.2545, device='cuda:0')
distance 1 is tensor(187.7082, device='cuda:0')
distance 2 is tensor(13.8640, device='cuda:0')
compute distance is  tensor(13.8640, device='cuda:0')
compute norm is  tensor(56.5316, device='cuda:0')
distance 1 is tensor(178.6670, device='cuda:0')
distance 2 is tensor(13.0905, device='cuda:0')
compute distance is  tensor(13.0905, device='cuda:0')
compute norm is  tensor(56.3412, device='cuda:0')
distance 1 is tensor(176.5144, device='cuda:0')
distance 2 is tensor(13.2619, device='cuda:0')
compute distance is  tensor(13.2619, device='cuda:0')
compute norm is  tensor(56.3562, device='cuda:0')
distance 1 is tensor(183.5012, device='cuda:0')
distance 2 is tensor(13.5648, device='cuda:0')
compute distance is  tensor(13.5648, device='cuda:0')
compute norm is  tensor(56.4426, device='cuda:0')
distance 1 is tensor(179.9447, device='cuda:0')
distance 2 is tensor(13.2865, device='cuda:0')
compute distance is  tensor(13.2865, device='cuda:0')
compute norm is  tensor(56.4073, device='cuda:0')
distance Threshold  is  tensor(14.2080, device='cuda:0')
distance 1 is tensor(1009077., device='cuda:0')
distance 2 is tensor(73608.4688, device='cuda:0')
________________________________
test distance is  tensor(73608.4688, device='cuda:0')
test similarity is  tensor(0.3539, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82030730886255e+17
test entropy is  0.0
________________________________
cal ratio is  0.012503868901042565
distance 1 is tensor(12617.3730, device='cuda:0')
distance 2 is tensor(920.3906, device='cuda:0')
cal_distance is  tensor(920.3906, device='cuda:0')
cal ratio is  0.11182070478147844
distance 1 is tensor(1410.8888, device='cuda:0')
distance 2 is tensor(102.9187, device='cuda:0')
cal_distance is  tensor(102.9187, device='cuda:0')
cal ratio is  0.33439603632415615
distance 1 is tensor(471.7996, device='cuda:0')
distance 2 is tensor(34.4156, device='cuda:0')
cal_distance is  tensor(34.4156, device='cuda:0')
cal ratio is  0.5782698658562425
distance 1 is tensor(272.8300, device='cuda:0')
distance 2 is tensor(19.9015, device='cuda:0')
cal_distance is  tensor(19.9015, device='cuda:0')
cal ratio is  0.7604405874034604
distance 1 is tensor(207.4725, device='cuda:0')
distance 2 is tensor(15.1339, device='cuda:0')
cal_distance is  tensor(15.1339, device='cuda:0')
cal ratio is  0.8720324158844419
distance 1 is tensor(180.9235, device='cuda:0')
distance 2 is tensor(13.1973, device='cuda:0')
cal_distance is  tensor(13.1973, device='cuda:0')
distance 1 is tensor(180.9235, device='cuda:0')
distance 2 is tensor(13.1973, device='cuda:0')
________________________________
test distance is  tensor(13.1973, device='cuda:0')
test similarity is  tensor(0.9593, device='cuda:0')
test acc is  0.4701666668230085
test loss is 170.68479773027303
test entropy is  0.0005322552154856064
________________________________
distance 1 is tensor(180.9235, device='cuda:0')
distance 2 is tensor(13.1973, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0003943057539597101
avg test loss is  170.17691975412592
avg accuracy is  0.4713500001563418
solo acc is  0.10115000015633197
compute similarity  is  tensor(0.9593, device='cuda:0')
compute_distance is  tensor(13.1973, device='cuda:0')
compute_norm is  tensor(60.4611, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(162.6551, device='cuda:0')
distance 2 is tensor(13.3363, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9167852748685809
avg test loss is  1.3758852622910602
avg accuracy is  0.6589500001563332
solo acc is  0.27881666682300577
compute similarity  is  tensor(0.9616, device='cuda:0')
compute_distance is  tensor(13.3363, device='cuda:0')
compute_norm is  tensor(60.2931, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(162.6551, device='cuda:0')
distance 2 is tensor(13.3363, device='cuda:0')
________________________________
test distance is  tensor(13.3363, device='cuda:0')
test similarity is  tensor(0.9616, device='cuda:0')
test acc is  0.6634166668229995
test loss is 1.3690283606047315
test entropy is  0.9161700998415062
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2614537477493286
mal norm is  tensor(8.6951, device='cuda:0')
distance 1 is tensor(162.6551, device='cuda:0')
distance 2 is tensor(13.3363, device='cuda:0')
mal distance is  tensor(13.3363, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.2030, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.6514, device='cuda:0')
c is  tensor(0.0185, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.7884, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0022, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(515.6259, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.7110, device='cuda:0')
c is  tensor(0.0191, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.5203, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.9741, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.0309, device='cuda:0')
c is  tensor(0.0190, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.9731, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(869.5065, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0014, device='cuda:0')
len accept list 8
len all weights is 8
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 90.90% 

Test Accuracy: 89.19% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7052105665206909
distance 1 is tensor(136.5021, device='cuda:0')
distance 2 is tensor(9.9154, device='cuda:0')
benign distance is  tensor(9.9154, device='cuda:0')
norm1 res is  tensor(0.1403, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7702969312667847
distance 1 is tensor(148.8358, device='cuda:0')
distance 2 is tensor(10.6557, device='cuda:0')
benign distance is  tensor(10.6557, device='cuda:0')
norm1 res is  tensor(0.1503, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.1614517718553543
distance 1 is tensor(118.8203, device='cuda:0')
distance 2 is tensor(8.7118, device='cuda:0')
benign distance is  tensor(8.7118, device='cuda:0')
norm1 res is  tensor(0.1209, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.6288138628005981
distance 1 is tensor(166.8425, device='cuda:0')
distance 2 is tensor(11.9778, device='cuda:0')
benign distance is  tensor(11.9778, device='cuda:0')
norm1 res is  tensor(0.1651, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0164430141448975
distance 1 is tensor(134.3354, device='cuda:0')
distance 2 is tensor(9.5878, device='cuda:0')
benign distance is  tensor(9.5878, device='cuda:0')
norm1 res is  tensor(0.1338, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5555369257926941
distance 1 is tensor(144.8639, device='cuda:0')
distance 2 is tensor(10.6211, device='cuda:0')
benign distance is  tensor(10.6211, device='cuda:0')
norm1 res is  tensor(0.1493, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.13513855636119843
distance 1 is tensor(115.9393, device='cuda:0')
distance 2 is tensor(8.2193, device='cuda:0')
benign distance is  tensor(8.2193, device='cuda:0')
norm1 res is  tensor(0.1160, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.22340109944343567
distance 1 is tensor(133.7004, device='cuda:0')
distance 2 is tensor(9.6772, device='cuda:0')
benign distance is  tensor(9.6772, device='cuda:0')
norm1 res is  tensor(0.1379, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(180.1561, device='cuda:0')
distance 2 is tensor(13.0722, device='cuda:0')
compute distance is  tensor(13.0722, device='cuda:0')
compute norm is  tensor(56.2701, device='cuda:0')
distance 1 is tensor(173.1109, device='cuda:0')
distance 2 is tensor(12.7107, device='cuda:0')
compute distance is  tensor(12.7107, device='cuda:0')
compute norm is  tensor(56.0938, device='cuda:0')
distance 1 is tensor(182.1881, device='cuda:0')
distance 2 is tensor(13.3737, device='cuda:0')
compute distance is  tensor(13.3737, device='cuda:0')
compute norm is  tensor(56.3532, device='cuda:0')
distance 1 is tensor(178.0304, device='cuda:0')
distance 2 is tensor(12.8082, device='cuda:0')
compute distance is  tensor(12.8082, device='cuda:0')
compute norm is  tensor(56.0526, device='cuda:0')
distance 1 is tensor(164.3247, device='cuda:0')
distance 2 is tensor(12.1119, device='cuda:0')
compute distance is  tensor(12.1119, device='cuda:0')
compute norm is  tensor(55.9408, device='cuda:0')
distance 1 is tensor(192.1473, device='cuda:0')
distance 2 is tensor(13.9131, device='cuda:0')
compute distance is  tensor(13.9131, device='cuda:0')
compute norm is  tensor(56.5469, device='cuda:0')
distance 1 is tensor(179.0728, device='cuda:0')
distance 2 is tensor(13.2592, device='cuda:0')
compute distance is  tensor(13.2592, device='cuda:0')
compute norm is  tensor(56.1773, device='cuda:0')
distance 1 is tensor(178.8368, device='cuda:0')
distance 2 is tensor(13.0160, device='cuda:0')
compute distance is  tensor(13.0160, device='cuda:0')
compute norm is  tensor(56.3358, device='cuda:0')
distance 1 is tensor(194.8933, device='cuda:0')
distance 2 is tensor(13.9486, device='cuda:0')
compute distance is  tensor(13.9486, device='cuda:0')
compute norm is  tensor(56.6164, device='cuda:0')
distance 1 is tensor(183.3813, device='cuda:0')
distance 2 is tensor(13.4396, device='cuda:0')
compute distance is  tensor(13.4396, device='cuda:0')
compute norm is  tensor(56.3655, device='cuda:0')
distance 1 is tensor(183.1606, device='cuda:0')
distance 2 is tensor(13.2941, device='cuda:0')
compute distance is  tensor(13.2941, device='cuda:0')
compute norm is  tensor(56.4076, device='cuda:0')
distance 1 is tensor(172.3454, device='cuda:0')
distance 2 is tensor(12.5287, device='cuda:0')
compute distance is  tensor(12.5287, device='cuda:0')
compute norm is  tensor(56.1055, device='cuda:0')
distance Threshold  is  tensor(13.9486, device='cuda:0')
distance 1 is tensor(1009093.1875, device='cuda:0')
distance 2 is tensor(73609.7266, device='cuda:0')
________________________________
test distance is  tensor(73609.7266, device='cuda:0')
test similarity is  tensor(0.3289, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.822679361972849e+17
test entropy is  0.0
________________________________
cal ratio is  0.01238912350993622
distance 1 is tensor(12501.7861, device='cuda:0')
distance 2 is tensor(911.9600, device='cuda:0')
cal_distance is  tensor(911.9600, device='cuda:0')
cal ratio is  0.11130644235775876
distance 1 is tensor(1391.5348, device='cuda:0')
distance 2 is tensor(101.5070, device='cuda:0')
cal_distance is  tensor(101.5070, device='cuda:0')
cal ratio is  0.33362620573265445
distance 1 is tensor(464.2564, device='cuda:0')
distance 2 is tensor(33.8654, device='cuda:0')
cal_distance is  tensor(33.8654, device='cuda:0')
cal ratio is  0.5776037954587807
distance 1 is tensor(268.1588, device='cuda:0')
distance 2 is tensor(19.5608, device='cuda:0')
cal_distance is  tensor(19.5608, device='cuda:0')
cal ratio is  0.7600025445023405
distance 1 is tensor(203.8028, device='cuda:0')
distance 2 is tensor(14.8662, device='cuda:0')
cal_distance is  tensor(14.8662, device='cuda:0')
cal ratio is  0.8717812180072465
distance 1 is tensor(177.6723, device='cuda:0')
distance 2 is tensor(12.9601, device='cuda:0')
cal_distance is  tensor(12.9601, device='cuda:0')
distance 1 is tensor(177.6723, device='cuda:0')
distance 2 is tensor(12.9601, device='cuda:0')
________________________________
test distance is  tensor(12.9601, device='cuda:0')
test similarity is  tensor(0.9599, device='cuda:0')
test acc is  0.7765000001563265
test loss is 132.87590236704486
test entropy is  0.005884611235461828
________________________________
distance 1 is tensor(177.6723, device='cuda:0')
distance 2 is tensor(12.9601, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.005889933619900569
avg test loss is  132.82417234733924
avg accuracy is  0.7782166668229931
solo acc is  0.12761666682299858
compute similarity  is  tensor(0.9599, device='cuda:0')
compute_distance is  tensor(12.9601, device='cuda:0')
compute_norm is  tensor(60.8379, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(163.9389, device='cuda:0')
distance 2 is tensor(13.8122, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9482134471951263
avg test loss is  1.4044162261206459
avg accuracy is  0.7687166668229936
solo acc is  0.2706000001563388
compute similarity  is  tensor(0.9615, device='cuda:0')
compute_distance is  tensor(13.8122, device='cuda:0')
compute_norm is  tensor(60.7039, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(163.9389, device='cuda:0')
distance 2 is tensor(13.8122, device='cuda:0')
________________________________
test distance is  tensor(13.8122, device='cuda:0')
test similarity is  tensor(0.9615, device='cuda:0')
test acc is  0.7705666668229936
test loss is 1.401465923801414
test entropy is  0.9478586868944961
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3579494953155518
mal norm is  tensor(8.5953, device='cuda:0')
distance 1 is tensor(163.9389, device='cuda:0')
distance 2 is tensor(13.8122, device='cuda:0')
mal distance is  tensor(13.8122, device='cuda:0')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1761, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.6268, device='cuda:0')
c is  tensor(0.0178, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.5940e-06, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.8811, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4524e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.2337, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.8176, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(525.7045, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.0427, device='cuda:0')
c is  tensor(0.0173, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.6506e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(451.4363, device='cuda:0')
c is  tensor(0.0198, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.2710, device='cuda:0')
c is  tensor(0.0181, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(859.5292, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.1069, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9409e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(728.3259, device='cuda:0')
c is  tensor(0.0155, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.3844e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(670.8939, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.6790, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.8091, device='cuda:0')
c is  tensor(0.0159, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.2628, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(755.9486, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.1764e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.0423, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.6070e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.8557, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.5348e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.9006, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.4987e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.9092, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.0384, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.4331e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.1472, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.7653, device='cuda:0')
c is  tensor(0.0168, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.4230e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.5627, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.8638e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.4043, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.4092, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.0905e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.4627, device='cuda:0')
c is  tensor(0.0158, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.5666, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9510, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.7916e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.5374, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.3149, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.9731, device='cuda:0')
c is  tensor(0.0161, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.2224, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.4561, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.3430, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1263e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.6965, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.4371, device='cuda:0')
c is  tensor(0.0154, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.4405, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.7152, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.5576e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9957, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.6454, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:0')
len accept list 16
len all weights is 16
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 91.39% 

Test Accuracy: 89.45% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
 benign loss is  0.42003098130226135
distance 1 is tensor(119.8975, device='cuda:0')
distance 2 is tensor(8.7231, device='cuda:0')
benign distance is  tensor(8.7231, device='cuda:0')
norm1 res is  tensor(0.1198, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5475820302963257
distance 1 is tensor(134.9498, device='cuda:0')
distance 2 is tensor(9.6590, device='cuda:0')
benign distance is  tensor(9.6590, device='cuda:0')
norm1 res is  tensor(0.1348, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.030081037431955338
distance 1 is tensor(126.1668, device='cuda:0')
distance 2 is tensor(9.0295, device='cuda:0')
benign distance is  tensor(9.0295, device='cuda:0')
norm1 res is  tensor(0.1296, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.27542799711227417
distance 1 is tensor(122.5286, device='cuda:0')
distance 2 is tensor(8.8152, device='cuda:0')
benign distance is  tensor(8.8152, device='cuda:0')
norm1 res is  tensor(0.1241, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7268899083137512
distance 1 is tensor(139.5306, device='cuda:0')
distance 2 is tensor(10.0246, device='cuda:0')
benign distance is  tensor(10.0246, device='cuda:0')
norm1 res is  tensor(0.1401, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8889011144638062
distance 1 is tensor(141.2211, device='cuda:0')
distance 2 is tensor(10.2086, device='cuda:0')
benign distance is  tensor(10.2086, device='cuda:0')
norm1 res is  tensor(0.1462, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.19598372280597687
distance 1 is tensor(103.7827, device='cuda:0')
distance 2 is tensor(7.4434, device='cuda:0')
benign distance is  tensor(7.4434, device='cuda:0')
norm1 res is  tensor(0.1027, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.04942605271935463
distance 1 is tensor(122.2435, device='cuda:0')
distance 2 is tensor(8.6811, device='cuda:0')
benign distance is  tensor(8.6811, device='cuda:0')
norm1 res is  tensor(0.1262, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.6077460646629333
distance 1 is tensor(137.5559, device='cuda:0')
distance 2 is tensor(9.7449, device='cuda:0')
benign distance is  tensor(9.7449, device='cuda:0')
norm1 res is  tensor(0.1384, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0230132341384888
distance 1 is tensor(149.3008, device='cuda:0')
distance 2 is tensor(10.6342, device='cuda:0')
benign distance is  tensor(10.6342, device='cuda:0')
norm1 res is  tensor(0.1497, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.5899673104286194
distance 1 is tensor(148.0686, device='cuda:0')
distance 2 is tensor(10.6054, device='cuda:0')
benign distance is  tensor(10.6054, device='cuda:0')
norm1 res is  tensor(0.1477, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.7182304263114929
distance 1 is tensor(140.0791, device='cuda:0')
distance 2 is tensor(10.0941, device='cuda:0')
benign distance is  tensor(10.0941, device='cuda:0')
norm1 res is  tensor(0.1412, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.3170159161090851
distance 1 is tensor(146.6923, device='cuda:0')
distance 2 is tensor(10.5513, device='cuda:0')
benign distance is  tensor(10.5513, device='cuda:0')
norm1 res is  tensor(0.1504, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.40430039167404175
distance 1 is tensor(145.5057, device='cuda:0')
distance 2 is tensor(10.5531, device='cuda:0')
benign distance is  tensor(10.5531, device='cuda:0')
norm1 res is  tensor(0.1493, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.48748594522476196
distance 1 is tensor(135.1121, device='cuda:0')
distance 2 is tensor(9.7798, device='cuda:0')
benign distance is  tensor(9.7798, device='cuda:0')
norm1 res is  tensor(0.1397, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  0.5406088829040527
distance 1 is tensor(143.1188, device='cuda:0')
distance 2 is tensor(10.2294, device='cuda:0')
benign distance is  tensor(10.2294, device='cuda:0')
norm1 res is  tensor(0.1453, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.4645311236381531
distance 1 is tensor(153.0376, device='cuda:0')
distance 2 is tensor(10.9275, device='cuda:0')
benign distance is  tensor(10.9275, device='cuda:0')
norm1 res is  tensor(0.1562, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7298016548156738
distance 1 is tensor(156.6783, device='cuda:0')
distance 2 is tensor(11.0797, device='cuda:0')
benign distance is  tensor(11.0797, device='cuda:0')
norm1 res is  tensor(0.1549, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.09704671800136566
distance 1 is tensor(138.8625, device='cuda:0')
distance 2 is tensor(10.0637, device='cuda:0')
benign distance is  tensor(10.0637, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.13085736334323883
distance 1 is tensor(151.1767, device='cuda:0')
distance 2 is tensor(10.8568, device='cuda:0')
benign distance is  tensor(10.8568, device='cuda:0')
norm1 res is  tensor(0.1543, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.7139227986335754
distance 1 is tensor(146.1453, device='cuda:0')
distance 2 is tensor(10.5824, device='cuda:0')
benign distance is  tensor(10.5824, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.7408744096755981
distance 1 is tensor(138.7464, device='cuda:0')
distance 2 is tensor(10.0189, device='cuda:0')
benign distance is  tensor(10.0189, device='cuda:0')
norm1 res is  tensor(0.1388, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  0.8472871780395508
distance 1 is tensor(154.5728, device='cuda:0')
distance 2 is tensor(11.2438, device='cuda:0')
benign distance is  tensor(11.2438, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.4050247073173523
distance 1 is tensor(145.0121, device='cuda:0')
distance 2 is tensor(10.5060, device='cuda:0')
benign distance is  tensor(10.5060, device='cuda:0')
norm1 res is  tensor(0.1463, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.11392495781183243
distance 1 is tensor(148.0692, device='cuda:0')
distance 2 is tensor(10.6637, device='cuda:0')
benign distance is  tensor(10.6637, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6750872731208801
distance 1 is tensor(140.9164, device='cuda:0')
distance 2 is tensor(10.0397, device='cuda:0')
benign distance is  tensor(10.0397, device='cuda:0')
norm1 res is  tensor(0.1378, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.46082568168640137
distance 1 is tensor(139.0707, device='cuda:0')
distance 2 is tensor(9.9671, device='cuda:0')
benign distance is  tensor(9.9671, device='cuda:0')
norm1 res is  tensor(0.1407, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  0.8906726837158203
distance 1 is tensor(147.4224, device='cuda:0')
distance 2 is tensor(10.5500, device='cuda:0')
benign distance is  tensor(10.5500, device='cuda:0')
norm1 res is  tensor(0.1485, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.434438556432724
distance 1 is tensor(140.5786, device='cuda:0')
distance 2 is tensor(10.1337, device='cuda:0')
benign distance is  tensor(10.1337, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.3852124512195587
distance 1 is tensor(140.2624, device='cuda:0')
distance 2 is tensor(10.0793, device='cuda:0')
benign distance is  tensor(10.0793, device='cuda:0')
norm1 res is  tensor(0.1445, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.20410700142383575
distance 1 is tensor(153.4516, device='cuda:0')
distance 2 is tensor(11.0403, device='cuda:0')
benign distance is  tensor(11.0403, device='cuda:0')
norm1 res is  tensor(0.1600, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.26625490188598633
distance 1 is tensor(145.1445, device='cuda:0')
distance 2 is tensor(10.6166, device='cuda:0')
benign distance is  tensor(10.6166, device='cuda:0')
norm1 res is  tensor(0.1488, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.09118279069662094
distance 1 is tensor(138.7417, device='cuda:0')
distance 2 is tensor(10.0344, device='cuda:0')
benign distance is  tensor(10.0344, device='cuda:0')
norm1 res is  tensor(0.1382, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  0.4312410354614258
distance 1 is tensor(141.3543, device='cuda:0')
distance 2 is tensor(10.0131, device='cuda:0')
benign distance is  tensor(10.0131, device='cuda:0')
norm1 res is  tensor(0.1412, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  0.7844586372375488
distance 1 is tensor(144.5762, device='cuda:0')
distance 2 is tensor(10.5298, device='cuda:0')
benign distance is  tensor(10.5298, device='cuda:0')
norm1 res is  tensor(0.1459, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.32981806993484497
distance 1 is tensor(150.6259, device='cuda:0')
distance 2 is tensor(11.1700, device='cuda:0')
benign distance is  tensor(11.1700, device='cuda:0')
norm1 res is  tensor(0.1564, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.5509662628173828
distance 1 is tensor(130.7241, device='cuda:0')
distance 2 is tensor(9.4045, device='cuda:0')
benign distance is  tensor(9.4045, device='cuda:0')
norm1 res is  tensor(0.1332, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.20764024555683136
distance 1 is tensor(142.1145, device='cuda:0')
distance 2 is tensor(10.2316, device='cuda:0')
benign distance is  tensor(10.2316, device='cuda:0')
norm1 res is  tensor(0.1413, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.4010821282863617
distance 1 is tensor(150.1257, device='cuda:0')
distance 2 is tensor(10.5760, device='cuda:0')
benign distance is  tensor(10.5760, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.36816972494125366
distance 1 is tensor(154.8841, device='cuda:0')
distance 2 is tensor(11.0394, device='cuda:0')
benign distance is  tensor(11.0394, device='cuda:0')
norm1 res is  tensor(0.1602, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(164.4801, device='cuda:0')
distance 2 is tensor(11.6099, device='cuda:0')
compute distance is  tensor(11.6099, device='cuda:0')
compute norm is  tensor(56.1703, device='cuda:0')
distance 1 is tensor(169.5868, device='cuda:0')
distance 2 is tensor(12.1791, device='cuda:0')
compute distance is  tensor(12.1791, device='cuda:0')
compute norm is  tensor(56.3748, device='cuda:0')
distance 1 is tensor(177.5182, device='cuda:0')
distance 2 is tensor(12.6757, device='cuda:0')
compute distance is  tensor(12.6757, device='cuda:0')
compute norm is  tensor(56.5424, device='cuda:0')
distance 1 is tensor(166.2293, device='cuda:0')
distance 2 is tensor(11.8853, device='cuda:0')
compute distance is  tensor(11.8853, device='cuda:0')
compute norm is  tensor(56.3004, device='cuda:0')
distance 1 is tensor(160.2875, device='cuda:0')
distance 2 is tensor(11.5910, device='cuda:0')
compute distance is  tensor(11.5910, device='cuda:0')
compute norm is  tensor(56.2394, device='cuda:0')
distance 1 is tensor(182.5713, device='cuda:0')
distance 2 is tensor(13.0217, device='cuda:0')
compute distance is  tensor(13.0217, device='cuda:0')
compute norm is  tensor(56.7266, device='cuda:0')
distance 1 is tensor(173.2491, device='cuda:0')
distance 2 is tensor(12.2298, device='cuda:0')
compute distance is  tensor(12.2298, device='cuda:0')
compute norm is  tensor(56.5156, device='cuda:0')
distance 1 is tensor(168.0991, device='cuda:0')
distance 2 is tensor(12.0651, device='cuda:0')
compute distance is  tensor(12.0651, device='cuda:0')
compute norm is  tensor(56.4696, device='cuda:0')
distance 1 is tensor(172.6613, device='cuda:0')
distance 2 is tensor(12.2875, device='cuda:0')
compute distance is  tensor(12.2875, device='cuda:0')
compute norm is  tensor(56.7369, device='cuda:0')
distance 1 is tensor(165.8765, device='cuda:0')
distance 2 is tensor(11.8285, device='cuda:0')
compute distance is  tensor(11.8285, device='cuda:0')
compute norm is  tensor(56.4067, device='cuda:0')
distance 1 is tensor(168.2912, device='cuda:0')
distance 2 is tensor(11.8336, device='cuda:0')
compute distance is  tensor(11.8336, device='cuda:0')
compute norm is  tensor(56.5010, device='cuda:0')
distance 1 is tensor(162.9447, device='cuda:0')
distance 2 is tensor(11.5891, device='cuda:0')
compute distance is  tensor(11.5891, device='cuda:0')
compute norm is  tensor(56.3397, device='cuda:0')
distance Threshold  is  tensor(13.0217, device='cuda:0')
distance 1 is tensor(1009113.7500, device='cuda:0')
distance 2 is tensor(73611.4766, device='cuda:0')
________________________________
test distance is  tensor(73611.4766, device='cuda:0')
test similarity is  tensor(0.2840, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82302553780214e+17
test entropy is  0.0
________________________________
cal ratio is  0.011970241627273224
distance 1 is tensor(12079.3418, device='cuda:0')
distance 2 is tensor(881.1472, device='cuda:0')
cal_distance is  tensor(881.1472, device='cuda:0')
cal ratio is  0.10940859470269777
distance 1 is tensor(1321.5891, device='cuda:0')
distance 2 is tensor(96.4051, device='cuda:0')
cal_distance is  tensor(96.4051, device='cuda:0')
cal ratio is  0.33076971431289093
distance 1 is tensor(437.1457, device='cuda:0')
distance 2 is tensor(31.8879, device='cuda:0')
cal_distance is  tensor(31.8879, device='cuda:0')
cal ratio is  0.5751258093093023
distance 1 is tensor(251.4163, device='cuda:0')
distance 2 is tensor(18.3395, device='cuda:0')
cal_distance is  tensor(18.3395, device='cuda:0')
cal ratio is  0.7583704980364802
distance 1 is tensor(190.6682, device='cuda:0')
distance 2 is tensor(13.9082, device='cuda:0')
cal_distance is  tensor(13.9082, device='cuda:0')
cal ratio is  0.870844755295555
distance 1 is tensor(166.0432, device='cuda:0')
distance 2 is tensor(12.1119, device='cuda:0')
cal_distance is  tensor(12.1119, device='cuda:0')
distance 1 is tensor(166.0432, device='cuda:0')
distance 2 is tensor(12.1119, device='cuda:0')
________________________________
test distance is  tensor(12.1119, device='cuda:0')
test similarity is  tensor(0.9616, device='cuda:0')
test acc is  0.863233333489656
test loss is 59.749441183452156
test entropy is  0.023036956700961415
________________________________
distance 1 is tensor(166.0432, device='cuda:0')
distance 2 is tensor(12.1119, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.023256974881140095
avg test loss is  59.49643526300947
avg accuracy is  0.8626833334896561
solo acc is  0.24223333348967144
compute similarity  is  tensor(0.9616, device='cuda:0')
compute_distance is  tensor(12.1119, device='cuda:0')
compute_norm is  tensor(59.9536, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(153.8362, device='cuda:0')
distance 2 is tensor(12.9609, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9076194726327843
avg test loss is  1.3389601011647345
avg accuracy is  0.8550500001563232
solo acc is  0.3075166668230063
compute similarity  is  tensor(0.9623, device='cuda:0')
compute_distance is  tensor(12.9609, device='cuda:0')
compute_norm is  tensor(59.4523, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.1932, device='cuda:0')
distance 2 is tensor(13.0560, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8722028391701835
avg test loss is  1.432664907944482
avg accuracy is  0.8508166668229898
solo acc is  0.24026666682300463
compute similarity  is  tensor(0.9621, device='cuda:0')
compute_distance is  tensor(13.0560, device='cuda:0')
compute_norm is  tensor(59.1624, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.4207, device='cuda:0')
distance 2 is tensor(13.0993, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8648815514055143
avg test loss is  1.4227154716245656
avg accuracy is  0.8505833334896565
solo acc is  0.2328000001563377
compute similarity  is  tensor(0.9620, device='cuda:0')
compute_distance is  tensor(13.0993, device='cuda:0')
compute_norm is  tensor(58.8777, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.6755, device='cuda:0')
distance 2 is tensor(13.1303, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.8604840514883558
avg test loss is  1.4069485652929685
avg accuracy is  0.8510333334896566
solo acc is  0.23251666682300431
compute similarity  is  tensor(0.9619, device='cuda:0')
compute_distance is  tensor(13.1303, device='cuda:0')
compute_norm is  tensor(58.6000, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.9826, device='cuda:0')
distance 2 is tensor(13.1603, device='cuda:0')
________________________________
test distance is  tensor(13.1603, device='cuda:0')
test similarity is  tensor(0.9618, device='cuda:0')
test acc is  0.8518166668229898
test loss is 1.4075898338736756
test entropy is  0.8469479537086446
________________________________
cal ratio is  0.8952479374160591
distance 1 is tensor(138.7485, device='cuda:0')
distance 2 is tensor(11.7817, device='cuda:0')
cal_distance is  tensor(11.7817, device='cuda:0')
distance 1 is tensor(138.7485, device='cuda:0')
distance 2 is tensor(11.7817, device='cuda:0')
________________________________
test distance is  tensor(11.7817, device='cuda:0')
test similarity is  tensor(0.9687, device='cuda:0')
test acc is  0.8689333334896558
test loss is 1.1017667616862479
test entropy is  0.9745369563097639
________________________________
distance 1 is tensor(138.7485, device='cuda:0')
distance 2 is tensor(11.7817, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.973885101804347
avg test loss is  1.1030020657251638
avg accuracy is  0.8705000001563223
solo acc is  0.42846666682300816
compute similarity  is  tensor(0.9687, device='cuda:0')
compute_distance is  tensor(11.7817, device='cuda:0')
compute_norm is  tensor(57.9377, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.1231, device='cuda:0')
distance 2 is tensor(11.9585, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8528819297041211
avg test loss is  1.3763694712348076
avg accuracy is  0.8634833334896561
solo acc is  0.23453333348967106
compute similarity  is  tensor(0.9684, device='cuda:0')
compute_distance is  tensor(11.9585, device='cuda:0')
compute_norm is  tensor(57.6669, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.8692, device='cuda:0')
distance 2 is tensor(12.0181, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.8484131352606613
avg test loss is  1.3646562954764376
avg accuracy is  0.8635333334896561
solo acc is  0.23558333348967117
compute similarity  is  tensor(0.9683, device='cuda:0')
compute_distance is  tensor(12.0181, device='cuda:0')
compute_norm is  tensor(57.3945, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.5991, device='cuda:0')
distance 2 is tensor(12.0715, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8507613009100021
avg test loss is  1.3536880825882527
avg accuracy is  0.8626000001563228
solo acc is  0.23071666682300432
compute similarity  is  tensor(0.9681, device='cuda:0')
compute_distance is  tensor(12.0715, device='cuda:0')
compute_norm is  tensor(57.1244, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.3923, device='cuda:0')
distance 2 is tensor(12.1249, device='cuda:0')
exit early
distance 1 is tensor(142.3923, device='cuda:0')
distance 2 is tensor(12.1249, device='cuda:0')
________________________________
test distance is  tensor(12.1249, device='cuda:0')
test similarity is  tensor(0.9680, device='cuda:0')
test acc is  0.8653166668229892
test loss is 1.357446193313802
test entropy is  0.8342488854805797
________________________________
distance 1 is tensor(142.3923, device='cuda:0')
distance 2 is tensor(12.1249, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.834937154357113
avg test loss is  1.3583511737491023
avg accuracy is  0.8651333334896559
solo acc is  0.22778333348967084
compute similarity  is  tensor(0.9680, device='cuda:0')
compute_distance is  tensor(12.1249, device='cuda:0')
compute_norm is  tensor(56.8571, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.2089, device='cuda:0')
distance 2 is tensor(12.1766, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.8363400374902591
avg test loss is  1.3457012306144243
avg accuracy is  0.866933333489656
solo acc is  0.22703333348967084
compute similarity  is  tensor(0.9679, device='cuda:0')
compute_distance is  tensor(12.1766, device='cuda:0')
compute_norm is  tensor(56.5903, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.0327, device='cuda:0')
distance 2 is tensor(12.2278, device='cuda:0')
++++++++++++++++++++
after training  2
avg test entropy is  0.834100398745364
avg test loss is  1.3397199486110256
avg accuracy is  0.867583333489656
solo acc is  0.22526666682300414
compute similarity  is  tensor(0.9678, device='cuda:0')
compute_distance is  tensor(12.2278, device='cuda:0')
compute_norm is  tensor(56.3251, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.8419, device='cuda:0')
distance 2 is tensor(12.2792, device='cuda:0')
++++++++++++++++++++
after training  3
avg test entropy is  0.8282529500120485
avg test loss is  1.3337688599822364
avg accuracy is  0.8681000001563225
solo acc is  0.22670000015633743
compute similarity  is  tensor(0.9677, device='cuda:0')
compute_distance is  tensor(12.2792, device='cuda:0')
compute_norm is  tensor(56.0636, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.7057, device='cuda:0')
distance 2 is tensor(12.3323, device='cuda:0')
++++++++++++++++++++
after training  4
avg test entropy is  0.822780489794481
avg test loss is  1.3225982805559122
avg accuracy is  0.8690500001563225
solo acc is  0.22555000015633742
compute similarity  is  tensor(0.9677, device='cuda:0')
compute_distance is  tensor(12.3323, device='cuda:0')
compute_norm is  tensor(55.8030, device='cuda:0')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.6295, device='cuda:0')
distance 2 is tensor(12.3926, device='cuda:0')
________________________________
test distance is  tensor(12.3926, device='cuda:0')
test similarity is  tensor(0.9676, device='cuda:0')
test acc is  0.870366666822989
test loss is 1.3237217702845265
test entropy is  0.8256276630516499
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2475885152816772
mal norm is  tensor(6.7216, device='cuda:0')
distance 1 is tensor(146.6295, device='cuda:0')
distance 2 is tensor(12.3926, device='cuda:0')
mal distance is  tensor(12.3926, device='cuda:0')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1175, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(476.1262, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(526.9749, device='cuda:0')
c is  tensor(0.0149, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.6342, device='cuda:0')
c is  tensor(0.0153, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.0101, device='cuda:0')
c is  tensor(0.0157, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.3370e-05, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.8303, device='cuda:0')
c is  tensor(0.0145, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.9382e-06, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.6106, device='cuda:0')
c is  tensor(0.0143, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1976e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(404.8271, device='cuda:0')
c is  tensor(0.0170, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(484.4535, device='cuda:0')
c is  tensor(0.0156, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1635, device='cuda:0')
c is  tensor(0.0132, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.4500e-05, device='cuda:0')
accept
len accept list 18
len all weights is 18
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 88.29% 

Test Accuracy: 86.60% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8650661706924438
distance 1 is tensor(138.5509, device='cuda:0')
distance 2 is tensor(10.2467, device='cuda:0')
benign distance is  tensor(10.2467, device='cuda:0')
norm1 res is  tensor(0.1389, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.15602536499500275
distance 1 is tensor(158.4846, device='cuda:0')
distance 2 is tensor(11.6960, device='cuda:0')
benign distance is  tensor(11.6960, device='cuda:0')
norm1 res is  tensor(0.1561, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6153103709220886
distance 1 is tensor(149.5533, device='cuda:0')
distance 2 is tensor(11.0142, device='cuda:0')
benign distance is  tensor(11.0142, device='cuda:0')
norm1 res is  tensor(0.1489, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.29992198944091797
distance 1 is tensor(154.4431, device='cuda:0')
distance 2 is tensor(11.2567, device='cuda:0')
benign distance is  tensor(11.2567, device='cuda:0')
norm1 res is  tensor(0.1502, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.5404762029647827
distance 1 is tensor(143.0933, device='cuda:0')
distance 2 is tensor(10.3908, device='cuda:0')
benign distance is  tensor(10.3908, device='cuda:0')
norm1 res is  tensor(0.1398, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7285679578781128
distance 1 is tensor(162.2624, device='cuda:0')
distance 2 is tensor(11.9525, device='cuda:0')
benign distance is  tensor(11.9525, device='cuda:0')
norm1 res is  tensor(0.1617, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.06264681369066238
distance 1 is tensor(145.5706, device='cuda:0')
distance 2 is tensor(10.5886, device='cuda:0')
benign distance is  tensor(10.5886, device='cuda:0')
norm1 res is  tensor(0.1410, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6042099595069885
distance 1 is tensor(156.7720, device='cuda:0')
distance 2 is tensor(11.2510, device='cuda:0')
benign distance is  tensor(11.2510, device='cuda:0')
norm1 res is  tensor(0.1548, device='cuda:0')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(185.3914, device='cuda:0')
distance 2 is tensor(13.4940, device='cuda:0')
compute distance is  tensor(13.4940, device='cuda:0')
compute norm is  tensor(56.4357, device='cuda:0')
distance 1 is tensor(196.6821, device='cuda:0')
distance 2 is tensor(14.4190, device='cuda:0')
compute distance is  tensor(14.4190, device='cuda:0')
compute norm is  tensor(56.7291, device='cuda:0')
distance 1 is tensor(190.4430, device='cuda:0')
distance 2 is tensor(14.2001, device='cuda:0')
compute distance is  tensor(14.2001, device='cuda:0')
compute norm is  tensor(56.6554, device='cuda:0')
distance 1 is tensor(183.3975, device='cuda:0')
distance 2 is tensor(13.5643, device='cuda:0')
compute distance is  tensor(13.5643, device='cuda:0')
compute norm is  tensor(56.2321, device='cuda:0')
distance 1 is tensor(176.5553, device='cuda:0')
distance 2 is tensor(13.1127, device='cuda:0')
compute distance is  tensor(13.1127, device='cuda:0')
compute norm is  tensor(56.3432, device='cuda:0')
distance 1 is tensor(191.3406, device='cuda:0')
distance 2 is tensor(14.2580, device='cuda:0')
compute distance is  tensor(14.2580, device='cuda:0')
compute norm is  tensor(56.7021, device='cuda:0')
distance 1 is tensor(184.2072, device='cuda:0')
distance 2 is tensor(13.7148, device='cuda:0')
compute distance is  tensor(13.7148, device='cuda:0')
compute norm is  tensor(56.5028, device='cuda:0')
distance 1 is tensor(190.9410, device='cuda:0')
distance 2 is tensor(13.9605, device='cuda:0')
compute distance is  tensor(13.9605, device='cuda:0')
compute norm is  tensor(56.7044, device='cuda:0')
distance 1 is tensor(180.4427, device='cuda:0')
distance 2 is tensor(13.2588, device='cuda:0')
compute distance is  tensor(13.2588, device='cuda:0')
compute norm is  tensor(56.4189, device='cuda:0')
distance 1 is tensor(176.6653, device='cuda:0')
distance 2 is tensor(13.1518, device='cuda:0')
compute distance is  tensor(13.1518, device='cuda:0')
compute norm is  tensor(56.3623, device='cuda:0')
distance 1 is tensor(200.2898, device='cuda:0')
distance 2 is tensor(14.7899, device='cuda:0')
compute distance is  tensor(14.7899, device='cuda:0')
compute norm is  tensor(56.9981, device='cuda:0')
distance 1 is tensor(178.1986, device='cuda:0')
distance 2 is tensor(13.2519, device='cuda:0')
compute distance is  tensor(13.2519, device='cuda:0')
compute norm is  tensor(56.5564, device='cuda:0')
distance Threshold  is  tensor(14.7899, device='cuda:0')
distance 1 is tensor(1009059.2500, device='cuda:0')
distance 2 is tensor(73606.9453, device='cuda:0')
________________________________
test distance is  tensor(73606.9453, device='cuda:0')
test similarity is  tensor(0.4000, device='cuda:0')
test acc is  0.10000000015633198
test loss is 6.82136252133681e+17
test entropy is  0.0
________________________________
cal ratio is  0.012757497962622016
distance 1 is tensor(12873.0762, device='cuda:0')
distance 2 is tensor(939.0403, device='cuda:0')
cal_distance is  tensor(939.0403, device='cuda:0')
cal ratio is  0.11294909781156474
distance 1 is tensor(1454.0077, device='cuda:0')
distance 2 is tensor(106.0638, device='cuda:0')
cal_distance is  tensor(106.0638, device='cuda:0')
cal ratio is  0.3360789961349787
distance 1 is tensor(488.6654, device='cuda:0')
distance 2 is tensor(35.6458, device='cuda:0')
cal_distance is  tensor(35.6458, device='cuda:0')
cal ratio is  0.5797232704231059
distance 1 is tensor(283.2933, device='cuda:0')
distance 2 is tensor(20.6647, device='cuda:0')
cal_distance is  tensor(20.6647, device='cuda:0')
cal ratio is  0.761395563668658
distance 1 is tensor(215.6997, device='cuda:0')
distance 2 is tensor(15.7340, device='cuda:0')
cal_distance is  tensor(15.7340, device='cuda:0')
cal ratio is  0.8725798003912987
distance 1 is tensor(188.2160, device='cuda:0')
distance 2 is tensor(13.7292, device='cuda:0')
cal_distance is  tensor(13.7292, device='cuda:0')
distance 1 is tensor(188.2160, device='cuda:0')
distance 2 is tensor(13.7292, device='cuda:0')
________________________________
test distance is  tensor(13.7292, device='cuda:0')
test similarity is  tensor(0.9604, device='cuda:0')
test acc is  0.3718000001563407
test loss is 218.9066034898575
test entropy is  0.00016304840429442154
________________________________
distance 1 is tensor(188.2160, device='cuda:0')
distance 2 is tensor(13.7292, device='cuda:0')
++++++++++++++++++++
after training  0
avg test entropy is  0.0001700628647183146
avg test loss is  219.1058360020489
avg accuracy is  0.3726666668230075
solo acc is  0.10038333348966531
compute similarity  is  tensor(0.9604, device='cuda:0')
compute_distance is  tensor(13.7292, device='cuda:0')
compute_norm is  tensor(61.4304, device='cuda:0')
++++++++++++++++++++
change alpha
distance 1 is tensor(170.9530, device='cuda:0')
distance 2 is tensor(14.2628, device='cuda:0')
++++++++++++++++++++
after training  1
avg test entropy is  0.9383862849745923
avg test loss is  1.4080591935720017
avg accuracy is  0.5795333334896725
solo acc is  0.2638666668230053
compute similarity  is  tensor(0.9627, device='cuda:0')
compute_distance is  tensor(14.2628, device='cuda:0')
compute_norm is  tensor(61.5110, device='cuda:0')
++++++++++++++++++++
distance 1 is tensor(170.9530, device='cuda:0')
distance 2 is tensor(14.2628, device='cuda:0')
________________________________
test distance is  tensor(14.2628, device='cuda:0')
test similarity is  tensor(0.9627, device='cuda:0')
test acc is  0.5831333334896723
test loss is 1.4120918647058482
test entropy is  0.9373660475206274
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.288419485092163
mal norm is  tensor(9.0657, device='cuda:0')
distance 1 is tensor(170.9530, device='cuda:0')
distance 2 is tensor(14.2628, device='cuda:0')
mal distance is  tensor(14.2628, device='cuda:0')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2070, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(544.1082, device='cuda:0')
c is  tensor(0.0195, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7968, device='cuda:0')
c is  tensor(0.0183, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0009, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.4629, device='cuda:0')
c is  tensor(0.0188, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.7709, device='cuda:0')
c is  tensor(0.0187, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.4662, device='cuda:0')
c is  tensor(0.0194, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0016, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.6412, device='cuda:0')
c is  tensor(0.0179, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.1398, device='cuda:0')
c is  tensor(0.0193, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.2234, device='cuda:0')
c is  tensor(0.0186, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(906.5652, device='cuda:0')
c is  tensor(0.0151, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0017, device='cuda:0')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.4955, device='cuda:0')
c is  tensor(0.0162, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.0158, device='cuda:0')
c is  tensor(0.0166, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0020, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(781.0717, device='cuda:0')
c is  tensor(0.0163, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(766.6586, device='cuda:0')
c is  tensor(0.0164, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(805.1181, device='cuda:0')
c is  tensor(0.0160, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.0174, device='cuda:0')
c is  tensor(0.0165, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4682, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.9380, device='cuda:0')
c is  tensor(0.0167, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.5715, device='cuda:0')
c is  tensor(0.0176, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6848, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.4092, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.1826, device='cuda:0')
c is  tensor(0.0174, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.5378, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.8878, device='cuda:0')
c is  tensor(0.0171, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.7975, device='cuda:0')
c is  tensor(0.0175, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0014, device='cuda:0')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.6204, device='cuda:0')
c is  tensor(0.0172, device='cuda:0')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:0')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 91.26% 

Test Accuracy: 89.34% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 91.26%
|----0th round Training Accuracy : 92.54%
|----1th round Training Accuracy : 92.33%
|----2th round Training Accuracy : 91.70%
|----3th round Training Accuracy : 92.51%
|----4th round Training Accuracy : 92.22%
|----5th round Training Accuracy : 92.44%
|----6th round Training Accuracy : 92.04%
|----7th round Training Accuracy : 91.77%
|----8th round Training Accuracy : 54.12%
|----9th round Training Accuracy : 91.16%
|----10th round Training Accuracy : 73.75%
|----11th round Training Accuracy : 91.07%
|----12th round Training Accuracy : 81.52%
|----13th round Training Accuracy : 90.76%
|----14th round Training Accuracy : 83.40%
|----15th round Training Accuracy : 90.97%
|----16th round Training Accuracy : 91.13%
|----17th round Training Accuracy : 91.53%
|----18th round Training Accuracy : 84.61%
|----19th round Training Accuracy : 90.92%
|----20th round Training Accuracy : 87.11%
|----21th round Training Accuracy : 91.14%
|----22th round Training Accuracy : 85.00%
|----23th round Training Accuracy : 91.05%
|----24th round Training Accuracy : 91.42%
|----25th round Training Accuracy : 91.32%
|----26th round Training Accuracy : 91.42%
|----27th round Training Accuracy : 87.98%
|----28th round Training Accuracy : 90.92%
|----29th round Training Accuracy : 91.34%
|----30th round Training Accuracy : 91.15%
|----31th round Training Accuracy : 91.55%
|----32th round Training Accuracy : 86.88%
|----33th round Training Accuracy : 91.34%
|----34th round Training Accuracy : 91.23%
|----35th round Training Accuracy : 91.25%
|----36th round Training Accuracy : 91.22%
|----37th round Training Accuracy : 91.08%
|----38th round Training Accuracy : 89.01%
|----39th round Training Accuracy : 91.48%
|----40th round Training Accuracy : 91.48%
|----41th round Training Accuracy : 91.42%
|----42th round Training Accuracy : 87.31%
|----43th round Training Accuracy : 91.38%
|----44th round Training Accuracy : 91.29%
|----45th round Training Accuracy : 87.88%
|----46th round Training Accuracy : 90.90%
|----47th round Training Accuracy : 91.39%
|----48th round Training Accuracy : 88.29%
|----49th round Training Accuracy : 91.26%
|----Final Test Accuracy: 89.34%
|----0th round Final Test Accuracy : 89.74%
|----1th round Final Test Accuracy : 89.46%
|----2th round Final Test Accuracy : 89.27%
|----3th round Final Test Accuracy : 89.65%
|----4th round Final Test Accuracy : 89.36%
|----5th round Final Test Accuracy : 89.72%
|----6th round Final Test Accuracy : 89.43%
|----7th round Final Test Accuracy : 89.18%
|----8th round Final Test Accuracy : 53.19%
|----9th round Final Test Accuracy : 89.00%
|----10th round Final Test Accuracy : 72.30%
|----11th round Final Test Accuracy : 89.09%
|----12th round Final Test Accuracy : 80.35%
|----13th round Final Test Accuracy : 88.69%
|----14th round Final Test Accuracy : 81.74%
|----15th round Final Test Accuracy : 89.14%
|----16th round Final Test Accuracy : 88.81%
|----17th round Final Test Accuracy : 89.27%
|----18th round Final Test Accuracy : 83.47%
|----19th round Final Test Accuracy : 89.20%
|----20th round Final Test Accuracy : 85.76%
|----21th round Final Test Accuracy : 89.16%
|----22th round Final Test Accuracy : 83.75%
|----23th round Final Test Accuracy : 89.07%
|----24th round Final Test Accuracy : 89.39%
|----25th round Final Test Accuracy : 89.06%
|----26th round Final Test Accuracy : 89.20%
|----27th round Final Test Accuracy : 86.37%
|----28th round Final Test Accuracy : 88.76%
|----29th round Final Test Accuracy : 89.34%
|----30th round Final Test Accuracy : 89.32%
|----31th round Final Test Accuracy : 89.60%
|----32th round Final Test Accuracy : 85.61%
|----33th round Final Test Accuracy : 89.38%
|----34th round Final Test Accuracy : 89.46%
|----35th round Final Test Accuracy : 89.63%
|----36th round Final Test Accuracy : 89.46%
|----37th round Final Test Accuracy : 89.29%
|----38th round Final Test Accuracy : 87.48%
|----39th round Final Test Accuracy : 89.62%
|----40th round Final Test Accuracy : 89.59%
|----41th round Final Test Accuracy : 89.77%
|----42th round Final Test Accuracy : 85.76%
|----43th round Final Test Accuracy : 89.40%
|----44th round Final Test Accuracy : 89.23%
|----45th round Final Test Accuracy : 86.28%
|----46th round Final Test Accuracy : 89.19%
|----47th round Final Test Accuracy : 89.45%
|----48th round Final Test Accuracy : 86.60%
|----49th round Final Test Accuracy : 89.34%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 29781.2674
