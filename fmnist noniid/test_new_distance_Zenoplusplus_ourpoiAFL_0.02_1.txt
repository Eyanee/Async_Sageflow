
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7149470951408148
distance 1 is tensor(107.1292, device='cuda:0')
distance 2 is tensor(8.0040, device='cuda:0')
benign distance is  tensor(8.0040, device='cuda:0')
norm1 res is  tensor(0.0878, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8736207783222198
distance 1 is tensor(97.7076, device='cuda:0')
distance 2 is tensor(7.2150, device='cuda:0')
benign distance is  tensor(7.2150, device='cuda:0')
norm1 res is  tensor(0.1284, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  1.0854709409177303
distance 1 is tensor(104.3145, device='cuda:0')
distance 2 is tensor(7.7346, device='cuda:0')
benign distance is  tensor(7.7346, device='cuda:0')
norm1 res is  tensor(0.1915, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.2050299160182476
distance 1 is tensor(135.7665, device='cuda:0')
distance 2 is tensor(9.9888, device='cuda:0')
benign distance is  tensor(9.9888, device='cuda:0')
norm1 res is  tensor(0.0930, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.2391009293496609
distance 1 is tensor(88.0598, device='cuda:0')
distance 2 is tensor(6.5996, device='cuda:0')
benign distance is  tensor(6.5996, device='cuda:0')
norm1 res is  tensor(0.0992, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.790561422239989
distance 1 is tensor(119.2453, device='cuda:0')
distance 2 is tensor(8.4867, device='cuda:0')
benign distance is  tensor(8.4867, device='cuda:0')
norm1 res is  tensor(0.1994, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.3023443259298801
distance 1 is tensor(71.3508, device='cuda:0')
distance 2 is tensor(5.4960, device='cuda:0')
benign distance is  tensor(5.4960, device='cuda:0')
norm1 res is  tensor(0.0825, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6955501679331064
distance 1 is tensor(79.8431, device='cuda:0')
distance 2 is tensor(5.8648, device='cuda:0')
benign distance is  tensor(5.8648, device='cuda:0')
norm1 res is  tensor(0.1256, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.70362950861454
distance 1 is tensor(116.1440, device='cuda:0')
distance 2 is tensor(8.6040, device='cuda:0')
benign distance is  tensor(8.6040, device='cuda:0')
norm1 res is  tensor(0.1301, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8937195036560297
distance 1 is tensor(126.9730, device='cuda:0')
distance 2 is tensor(9.4348, device='cuda:0')
benign distance is  tensor(9.4348, device='cuda:0')
norm1 res is  tensor(0.1385, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.130112987011671
distance 1 is tensor(73.6976, device='cuda:0')
distance 2 is tensor(5.7760, device='cuda:0')
benign distance is  tensor(5.7760, device='cuda:0')
norm1 res is  tensor(0.0986, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3179845809936523
distance 1 is tensor(112.7957, device='cuda:0')
distance 2 is tensor(8.6932, device='cuda:0')
benign distance is  tensor(8.6932, device='cuda:0')
norm1 res is  tensor(0.1197, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.218481220304966
distance 1 is tensor(177.6706, device='cuda:0')
distance 2 is tensor(12.7123, device='cuda:0')
benign distance is  tensor(12.7123, device='cuda:0')
norm1 res is  tensor(0.1162, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6733998083509505
distance 1 is tensor(54.1193, device='cuda:0')
distance 2 is tensor(4.0735, device='cuda:0')
benign distance is  tensor(4.0735, device='cuda:0')
norm1 res is  tensor(0.1393, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1824058312922716
distance 1 is tensor(165.3873, device='cuda:0')
distance 2 is tensor(11.9798, device='cuda:0')
benign distance is  tensor(11.9798, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.9938997998833656
distance 1 is tensor(145.8101, device='cuda:0')
distance 2 is tensor(10.8534, device='cuda:0')
benign distance is  tensor(10.8534, device='cuda:0')
norm1 res is  tensor(0.1418, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.1897266879677773
distance 1 is tensor(116.8461, device='cuda:0')
distance 2 is tensor(8.8588, device='cuda:0')
benign distance is  tensor(8.8588, device='cuda:0')
norm1 res is  tensor(0.1787, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7672623880207539
distance 1 is tensor(114.8213, device='cuda:0')
distance 2 is tensor(8.4735, device='cuda:0')
benign distance is  tensor(8.4735, device='cuda:0')
norm1 res is  tensor(0.1450, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.2015761882066727
distance 1 is tensor(137.5625, device='cuda:0')
distance 2 is tensor(9.9596, device='cuda:0')
benign distance is  tensor(9.9596, device='cuda:0')
norm1 res is  tensor(0.1377, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9123832769691944
distance 1 is tensor(141.6801, device='cuda:0')
distance 2 is tensor(10.3857, device='cuda:0')
benign distance is  tensor(10.3857, device='cuda:0')
norm1 res is  tensor(0.1279, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.1031943429261446
distance 1 is tensor(79.5462, device='cuda:0')
distance 2 is tensor(5.9437, device='cuda:0')
benign distance is  tensor(5.9437, device='cuda:0')
norm1 res is  tensor(0.1013, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.843677556142211
distance 1 is tensor(227.2985, device='cuda:0')
distance 2 is tensor(16.5783, device='cuda:0')
benign distance is  tensor(16.5783, device='cuda:0')
norm1 res is  tensor(0.1215, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.3990212604403496
distance 1 is tensor(150.5828, device='cuda:0')
distance 2 is tensor(11.0823, device='cuda:0')
benign distance is  tensor(11.0823, device='cuda:0')
norm1 res is  tensor(0.0979, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.9354286752641201
distance 1 is tensor(119.9651, device='cuda:0')
distance 2 is tensor(8.8245, device='cuda:0')
benign distance is  tensor(8.8245, device='cuda:0')
norm1 res is  tensor(0.1042, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.0930824913084507
distance 1 is tensor(136.2256, device='cuda:0')
distance 2 is tensor(10.1063, device='cuda:0')
benign distance is  tensor(10.1063, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6370676765218377
distance 1 is tensor(83.2702, device='cuda:0')
distance 2 is tensor(6.2445, device='cuda:0')
benign distance is  tensor(6.2445, device='cuda:0')
norm1 res is  tensor(0.2328, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.0676368065178394
distance 1 is tensor(155.6087, device='cuda:0')
distance 2 is tensor(11.5030, device='cuda:0')
benign distance is  tensor(11.5030, device='cuda:0')
norm1 res is  tensor(0.1347, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.72079648822546
distance 1 is tensor(117.5603, device='cuda:0')
distance 2 is tensor(9.0047, device='cuda:0')
benign distance is  tensor(9.0047, device='cuda:0')
norm1 res is  tensor(0.1326, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.7646138090640306
distance 1 is tensor(130.3317, device='cuda:0')
distance 2 is tensor(9.5058, device='cuda:0')
benign distance is  tensor(9.5058, device='cuda:0')
norm1 res is  tensor(0.1446, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8938136901706457
distance 1 is tensor(115.9192, device='cuda:0')
distance 2 is tensor(8.6677, device='cuda:0')
benign distance is  tensor(8.6677, device='cuda:0')
norm1 res is  tensor(0.1270, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.47943215910345316
distance 1 is tensor(127.6782, device='cuda:0')
distance 2 is tensor(9.3511, device='cuda:0')
benign distance is  tensor(9.3511, device='cuda:0')
norm1 res is  tensor(0.1430, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.755514245480299
distance 1 is tensor(192.3875, device='cuda:0')
distance 2 is tensor(13.9132, device='cuda:0')
benign distance is  tensor(13.9132, device='cuda:0')
norm1 res is  tensor(0.1713, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.6962223537266254
distance 1 is tensor(148.6427, device='cuda:0')
distance 2 is tensor(10.9940, device='cuda:0')
benign distance is  tensor(10.9940, device='cuda:0')
norm1 res is  tensor(0.1778, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.3645204044878483
distance 1 is tensor(107.0736, device='cuda:0')
distance 2 is tensor(7.9282, device='cuda:0')
benign distance is  tensor(7.9282, device='cuda:0')
norm1 res is  tensor(0.1456, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.6299594789743423
distance 1 is tensor(167.0734, device='cuda:0')
distance 2 is tensor(12.2276, device='cuda:0')
benign distance is  tensor(12.2276, device='cuda:0')
norm1 res is  tensor(0.1641, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.283795177936554
distance 1 is tensor(139.0216, device='cuda:0')
distance 2 is tensor(10.3392, device='cuda:0')
benign distance is  tensor(10.3392, device='cuda:0')
norm1 res is  tensor(0.1034, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.7874464131891727
distance 1 is tensor(113.2491, device='cuda:0')
distance 2 is tensor(8.5319, device='cuda:0')
benign distance is  tensor(8.5319, device='cuda:0')
norm1 res is  tensor(0.1200, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.996078860014677
distance 1 is tensor(110.8138, device='cuda:0')
distance 2 is tensor(8.4030, device='cuda:0')
benign distance is  tensor(8.4030, device='cuda:0')
norm1 res is  tensor(0.1423, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  1.4069628156721592
distance 1 is tensor(107.0107, device='cuda:0')
distance 2 is tensor(8.0123, device='cuda:0')
benign distance is  tensor(8.0123, device='cuda:0')
norm1 res is  tensor(0.2195, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.8830885179340839
distance 1 is tensor(129.4023, device='cuda:0')
distance 2 is tensor(9.8909, device='cuda:0')
benign distance is  tensor(9.8909, device='cuda:0')
norm1 res is  tensor(0.1566, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.0984027311205864
distance 1 is tensor(111.7866, device='cuda:0')
distance 2 is tensor(8.5886, device='cuda:0')
benign distance is  tensor(8.5886, device='cuda:0')
norm1 res is  tensor(0.1206, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.3079922795295715
distance 1 is tensor(152.5320, device='cuda:0')
distance 2 is tensor(11.4623, device='cuda:0')
benign distance is  tensor(11.4623, device='cuda:0')
norm1 res is  tensor(0.1666, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.4078035689890385
distance 1 is tensor(170.0460, device='cuda:0')
distance 2 is tensor(12.4802, device='cuda:0')
benign distance is  tensor(12.4802, device='cuda:0')
norm1 res is  tensor(0.1195, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.8696986101567745
distance 1 is tensor(100.9337, device='cuda:0')
distance 2 is tensor(7.8330, device='cuda:0')
benign distance is  tensor(7.8330, device='cuda:0')
norm1 res is  tensor(0.2419, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.8473426997661591
distance 1 is tensor(184.4288, device='cuda:0')
distance 2 is tensor(13.3250, device='cuda:0')
benign distance is  tensor(13.3250, device='cuda:0')
norm1 res is  tensor(0.1778, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.936380235478282
distance 1 is tensor(153.9847, device='cuda:0')
distance 2 is tensor(11.1381, device='cuda:0')
benign distance is  tensor(11.1381, device='cuda:0')
norm1 res is  tensor(0.1849, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8446116391569376
distance 1 is tensor(124.1511, device='cuda:0')
distance 2 is tensor(9.0943, device='cuda:0')
benign distance is  tensor(9.0943, device='cuda:0')
norm1 res is  tensor(0.1708, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5843713423237205
distance 1 is tensor(149.1489, device='cuda:0')
distance 2 is tensor(10.8177, device='cuda:0')
benign distance is  tensor(10.8177, device='cuda:0')
norm1 res is  tensor(0.1657, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(461.6403, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(420.3388, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(453.2552, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(593.6031, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(388.0726, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(503.5580, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(312.4712, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(339.2519, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4494.4292, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4544.8647, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4510.2437, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4502.4961, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4505.3188, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4531.5171, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4533.0303, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4510.2021, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4510.8711, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4500.0879, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4519.9263, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4560.8101, device='cuda:0')
norm_2 is  tensor(372.8549, device='cuda:0')
norm_2 * lamda is tensor(671.1387, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 84.13% 

Test Accuracy: 88.03% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  1.0478156339377165
distance 1 is tensor(95.1813, device='cuda:0')
distance 2 is tensor(7.2587, device='cuda:0')
benign distance is  tensor(7.2587, device='cuda:0')
norm1 res is  tensor(0.0840, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8858490195125341
distance 1 is tensor(107.5718, device='cuda:0')
distance 2 is tensor(7.8920, device='cuda:0')
benign distance is  tensor(7.8920, device='cuda:0')
norm1 res is  tensor(0.1468, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9970993511378765
distance 1 is tensor(115.9535, device='cuda:0')
distance 2 is tensor(8.4715, device='cuda:0')
benign distance is  tensor(8.4715, device='cuda:0')
norm1 res is  tensor(0.2238, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.054312277585268
distance 1 is tensor(175.8560, device='cuda:0')
distance 2 is tensor(12.7611, device='cuda:0')
benign distance is  tensor(12.7611, device='cuda:0')
norm1 res is  tensor(0.1258, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.1768223531544209
distance 1 is tensor(106.8213, device='cuda:0')
distance 2 is tensor(8.0388, device='cuda:0')
benign distance is  tensor(8.0388, device='cuda:0')
norm1 res is  tensor(0.1163, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8790859095752239
distance 1 is tensor(101.9967, device='cuda:0')
distance 2 is tensor(7.4072, device='cuda:0')
benign distance is  tensor(7.4072, device='cuda:0')
norm1 res is  tensor(0.1703, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2404644899070263
distance 1 is tensor(122.4062, device='cuda:0')
distance 2 is tensor(9.0330, device='cuda:0')
benign distance is  tensor(9.0330, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6926120202988386
distance 1 is tensor(84.0929, device='cuda:0')
distance 2 is tensor(6.2358, device='cuda:0')
benign distance is  tensor(6.2358, device='cuda:0')
norm1 res is  tensor(0.1378, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(418.0367, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(476.8148, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(513.4681, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(787.0516, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(481.9428, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(428.8721, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(532.2095, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(367.1080, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4531.8516, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4583.1323, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4541.5928, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4537.1851, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4536.5474, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4593.8765, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4566.3262, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4535.8613, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4566.7549, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4539.3140, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4552.8350, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4610.7183, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(523.9346, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(583.5995, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(344.1250, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(526.0999, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(789.5602, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(256.0299, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(733.6653, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(652.0275, device='cuda:0')
norm_2 is  tensor(455.8134, device='cuda:0')
norm_2 * lamda is tensor(820.4642, device='cuda:0')
satisfying 27
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 81.05% 

Test Accuracy: 87.12% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6814570855349302
distance 1 is tensor(107.2942, device='cuda:0')
distance 2 is tensor(8.0259, device='cuda:0')
benign distance is  tensor(8.0259, device='cuda:0')
norm1 res is  tensor(0.0895, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.809323275461793
distance 1 is tensor(110.1466, device='cuda:0')
distance 2 is tensor(8.1551, device='cuda:0')
benign distance is  tensor(8.1551, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8448648508638144
distance 1 is tensor(93.1394, device='cuda:0')
distance 2 is tensor(7.0632, device='cuda:0')
benign distance is  tensor(7.0632, device='cuda:0')
norm1 res is  tensor(0.1787, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.8684188202023506
distance 1 is tensor(148.8937, device='cuda:0')
distance 2 is tensor(10.8411, device='cuda:0')
benign distance is  tensor(10.8411, device='cuda:0')
norm1 res is  tensor(0.1068, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.131824528798461
distance 1 is tensor(78.9779, device='cuda:0')
distance 2 is tensor(6.0242, device='cuda:0')
benign distance is  tensor(6.0242, device='cuda:0')
norm1 res is  tensor(0.0828, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7594105638563633
distance 1 is tensor(111.5602, device='cuda:0')
distance 2 is tensor(8.1559, device='cuda:0')
benign distance is  tensor(8.1559, device='cuda:0')
norm1 res is  tensor(0.1875, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4084460381418467
distance 1 is tensor(79.0673, device='cuda:0')
distance 2 is tensor(6.0618, device='cuda:0')
benign distance is  tensor(6.0618, device='cuda:0')
norm1 res is  tensor(0.0945, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8722832053899765
distance 1 is tensor(72.8227, device='cuda:0')
distance 2 is tensor(5.4377, device='cuda:0')
benign distance is  tensor(5.4377, device='cuda:0')
norm1 res is  tensor(0.1170, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.0132496021687984
distance 1 is tensor(117.2285, device='cuda:0')
distance 2 is tensor(8.6226, device='cuda:0')
benign distance is  tensor(8.6226, device='cuda:0')
norm1 res is  tensor(0.1315, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.7910530129447579
distance 1 is tensor(132.9925, device='cuda:0')
distance 2 is tensor(9.8628, device='cuda:0')
benign distance is  tensor(9.8628, device='cuda:0')
norm1 res is  tensor(0.1461, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0568661261349916
distance 1 is tensor(62.5357, device='cuda:0')
distance 2 is tensor(4.9537, device='cuda:0')
benign distance is  tensor(4.9537, device='cuda:0')
norm1 res is  tensor(0.0858, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.2746076174080372
distance 1 is tensor(128.5518, device='cuda:0')
distance 2 is tensor(9.5561, device='cuda:0')
benign distance is  tensor(9.5561, device='cuda:0')
norm1 res is  tensor(0.1327, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.9662264063954353
distance 1 is tensor(189.7600, device='cuda:0')
distance 2 is tensor(13.7027, device='cuda:0')
benign distance is  tensor(13.7027, device='cuda:0')
norm1 res is  tensor(0.1252, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7431975081562996
distance 1 is tensor(44.3257, device='cuda:0')
distance 2 is tensor(3.4337, device='cuda:0')
benign distance is  tensor(3.4337, device='cuda:0')
norm1 res is  tensor(0.1175, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.609272800385952
distance 1 is tensor(150.8456, device='cuda:0')
distance 2 is tensor(11.0822, device='cuda:0')
benign distance is  tensor(11.0822, device='cuda:0')
norm1 res is  tensor(0.1514, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.6986579112708569
distance 1 is tensor(144.4070, device='cuda:0')
distance 2 is tensor(10.7816, device='cuda:0')
benign distance is  tensor(10.7816, device='cuda:0')
norm1 res is  tensor(0.1413, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(471.5037, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(489.2080, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(422.5915, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(659.8280, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(342.7483, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(469.2899, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(355.4691, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(313.3283, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4542.9697, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4597.9541, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4554.3018, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4554.3608, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4553.1641, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4577.7500, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4580.5625, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4558., device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4570.2305, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4547.6665, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4566.7925, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4614.2275, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(537.1174, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(514.7516, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(600.9991, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(625.2631, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(363.2687, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(992.6599, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(667.5087, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(540.2966, device='cuda:0')
norm_2 is  tensor(406.2981, device='cuda:0')
norm_2 * lamda is tensor(731.3365, device='cuda:0')
satisfying 27
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 82.21% 

Test Accuracy: 87.46% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7994996812194586
distance 1 is tensor(99.5111, device='cuda:0')
distance 2 is tensor(7.3334, device='cuda:0')
benign distance is  tensor(7.3334, device='cuda:0')
norm1 res is  tensor(0.0811, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.717408511787653
distance 1 is tensor(83.6499, device='cuda:0')
distance 2 is tensor(6.3208, device='cuda:0')
benign distance is  tensor(6.3208, device='cuda:0')
norm1 res is  tensor(0.1175, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9332386068999767
distance 1 is tensor(109.5535, device='cuda:0')
distance 2 is tensor(8.2646, device='cuda:0')
benign distance is  tensor(8.2646, device='cuda:0')
norm1 res is  tensor(0.2156, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.2119262255728245
distance 1 is tensor(140.0029, device='cuda:0')
distance 2 is tensor(10.2627, device='cuda:0')
benign distance is  tensor(10.2627, device='cuda:0')
norm1 res is  tensor(0.0968, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.2183696273714304
distance 1 is tensor(67.0241, device='cuda:0')
distance 2 is tensor(5.2116, device='cuda:0')
benign distance is  tensor(5.2116, device='cuda:0')
norm1 res is  tensor(0.0730, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.739080467261374
distance 1 is tensor(85.8370, device='cuda:0')
distance 2 is tensor(6.2682, device='cuda:0')
benign distance is  tensor(6.2682, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.7465485334396362
distance 1 is tensor(94.3537, device='cuda:0')
distance 2 is tensor(7.0741, device='cuda:0')
benign distance is  tensor(7.0741, device='cuda:0')
norm1 res is  tensor(0.1073, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7983952350914478
distance 1 is tensor(92.8695, device='cuda:0')
distance 2 is tensor(6.9152, device='cuda:0')
benign distance is  tensor(6.9152, device='cuda:0')
norm1 res is  tensor(0.1470, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.2858491837978363
distance 1 is tensor(120.9382, device='cuda:0')
distance 2 is tensor(9.6709, device='cuda:0')
benign distance is  tensor(9.6709, device='cuda:0')
norm1 res is  tensor(0.1953, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9365239329636097
distance 1 is tensor(138.2941, device='cuda:0')
distance 2 is tensor(10.3264, device='cuda:0')
benign distance is  tensor(10.3264, device='cuda:0')
norm1 res is  tensor(0.1827, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.3609756864607334
distance 1 is tensor(139.1269, device='cuda:0')
distance 2 is tensor(10.2213, device='cuda:0')
benign distance is  tensor(10.2213, device='cuda:0')
norm1 res is  tensor(0.1405, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.1244373358786106
distance 1 is tensor(127.5283, device='cuda:0')
distance 2 is tensor(9.5603, device='cuda:0')
benign distance is  tensor(9.5603, device='cuda:0')
norm1 res is  tensor(0.1171, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.008451978676021
distance 1 is tensor(71.0871, device='cuda:0')
distance 2 is tensor(5.2174, device='cuda:0')
benign distance is  tensor(5.2174, device='cuda:0')
norm1 res is  tensor(0.0882, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.0725330226123333
distance 1 is tensor(240.3124, device='cuda:0')
distance 2 is tensor(17.6147, device='cuda:0')
benign distance is  tensor(17.6147, device='cuda:0')
norm1 res is  tensor(0.1305, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.2991341538727283
distance 1 is tensor(151.4905, device='cuda:0')
distance 2 is tensor(11.2232, device='cuda:0')
benign distance is  tensor(11.2232, device='cuda:0')
norm1 res is  tensor(0.0997, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.8242891747504473
distance 1 is tensor(108.1786, device='cuda:0')
distance 2 is tensor(7.9867, device='cuda:0')
benign distance is  tensor(7.9867, device='cuda:0')
norm1 res is  tensor(0.0953, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(428.9580, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(370.2740, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(494.2358, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(616.5881, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(292.2880, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(363.5459, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(407.1763, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(403.8420, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4549.5874, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4602.1221, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4560.5762, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4572.4458, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4561.5396, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4570.6260, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4579.3057, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4563.7207, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4576.8774, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4559.8125, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4572.4839, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4622.2275, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(603.8661, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(392.6151, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(699.4119, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(537.6151, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(582.6935, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(539.7447, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(570.0292, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(849.2590, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(531.2011, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(609.6202, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(299.8313, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(576.2200, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(847.4104, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(222.6583, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(684.1411, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(648.7335, device='cuda:0')
norm_2 is  tensor(407.5569, device='cuda:0')
norm_2 * lamda is tensor(733.6023, device='cuda:0')
satisfying 35
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 81.70% 

Test Accuracy: 87.24% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
 benign loss is  0.783536572009325
distance 1 is tensor(95.2640, device='cuda:0')
distance 2 is tensor(7.1395, device='cuda:0')
benign distance is  tensor(7.1395, device='cuda:0')
norm1 res is  tensor(0.0758, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7703678198158741
distance 1 is tensor(88.1929, device='cuda:0')
distance 2 is tensor(6.4588, device='cuda:0')
benign distance is  tensor(6.4588, device='cuda:0')
norm1 res is  tensor(0.1165, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8258269894868135
distance 1 is tensor(124.5222, device='cuda:0')
distance 2 is tensor(9.1242, device='cuda:0')
benign distance is  tensor(9.1242, device='cuda:0')
norm1 res is  tensor(0.2337, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1196689903736115
distance 1 is tensor(138.2645, device='cuda:0')
distance 2 is tensor(10.0529, device='cuda:0')
benign distance is  tensor(10.0529, device='cuda:0')
norm1 res is  tensor(0.0936, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9657536363229156
distance 1 is tensor(106.2285, device='cuda:0')
distance 2 is tensor(8.2912, device='cuda:0')
benign distance is  tensor(8.2912, device='cuda:0')
norm1 res is  tensor(0.1165, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8482150798663497
distance 1 is tensor(93.7841, device='cuda:0')
distance 2 is tensor(6.8150, device='cuda:0')
benign distance is  tensor(6.8150, device='cuda:0')
norm1 res is  tensor(0.1629, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1566068939864635
distance 1 is tensor(74.6707, device='cuda:0')
distance 2 is tensor(5.5660, device='cuda:0')
benign distance is  tensor(5.5660, device='cuda:0')
norm1 res is  tensor(0.0854, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6452380549162626
distance 1 is tensor(77.0404, device='cuda:0')
distance 2 is tensor(5.7222, device='cuda:0')
benign distance is  tensor(5.7222, device='cuda:0')
norm1 res is  tensor(0.1208, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.2294998466968536
distance 1 is tensor(116.6534, device='cuda:0')
distance 2 is tensor(8.6143, device='cuda:0')
benign distance is  tensor(8.6143, device='cuda:0')
norm1 res is  tensor(0.1302, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9463659878820181
distance 1 is tensor(143.1718, device='cuda:0')
distance 2 is tensor(10.4219, device='cuda:0')
benign distance is  tensor(10.4219, device='cuda:0')
norm1 res is  tensor(0.1526, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9704928919672966
distance 1 is tensor(64.7706, device='cuda:0')
distance 2 is tensor(5.1298, device='cuda:0')
benign distance is  tensor(5.1298, device='cuda:0')
norm1 res is  tensor(0.0911, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.216711901128292
distance 1 is tensor(122.7400, device='cuda:0')
distance 2 is tensor(9.1212, device='cuda:0')
benign distance is  tensor(9.1212, device='cuda:0')
norm1 res is  tensor(0.1269, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.9832763671875
distance 1 is tensor(188.5244, device='cuda:0')
distance 2 is tensor(13.4690, device='cuda:0')
benign distance is  tensor(13.4690, device='cuda:0')
norm1 res is  tensor(0.1220, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6667411159723997
distance 1 is tensor(55.2923, device='cuda:0')
distance 2 is tensor(4.2184, device='cuda:0')
benign distance is  tensor(4.2184, device='cuda:0')
norm1 res is  tensor(0.1457, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.095326004549861
distance 1 is tensor(143.8158, device='cuda:0')
distance 2 is tensor(10.5079, device='cuda:0')
benign distance is  tensor(10.5079, device='cuda:0')
norm1 res is  tensor(0.1412, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.8557019904255867
distance 1 is tensor(125.2780, device='cuda:0')
distance 2 is tensor(9.2859, device='cuda:0')
benign distance is  tensor(9.2859, device='cuda:0')
norm1 res is  tensor(0.1210, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.083602437749505
distance 1 is tensor(124.9652, device='cuda:0')
distance 2 is tensor(9.3423, device='cuda:0')
benign distance is  tensor(9.3423, device='cuda:0')
norm1 res is  tensor(0.1404, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6501880353316665
distance 1 is tensor(90.1565, device='cuda:0')
distance 2 is tensor(6.8239, device='cuda:0')
benign distance is  tensor(6.8239, device='cuda:0')
norm1 res is  tensor(0.2574, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.2224404737353325
distance 1 is tensor(135.5264, device='cuda:0')
distance 2 is tensor(10.0322, device='cuda:0')
benign distance is  tensor(10.0322, device='cuda:0')
norm1 res is  tensor(0.1211, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.2146846931427717
distance 1 is tensor(124.0482, device='cuda:0')
distance 2 is tensor(9.3170, device='cuda:0')
benign distance is  tensor(9.3170, device='cuda:0')
norm1 res is  tensor(0.1391, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.0284021720290184
distance 1 is tensor(134.5284, device='cuda:0')
distance 2 is tensor(9.9647, device='cuda:0')
benign distance is  tensor(9.9647, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8776771426200867
distance 1 is tensor(120.0518, device='cuda:0')
distance 2 is tensor(9.0704, device='cuda:0')
benign distance is  tensor(9.0704, device='cuda:0')
norm1 res is  tensor(0.1299, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5035972390323877
distance 1 is tensor(126.2516, device='cuda:0')
distance 2 is tensor(9.3079, device='cuda:0')
benign distance is  tensor(9.3079, device='cuda:0')
norm1 res is  tensor(0.1418, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.9362948630005121
distance 1 is tensor(205.8380, device='cuda:0')
distance 2 is tensor(15.0727, device='cuda:0')
benign distance is  tensor(15.0727, device='cuda:0')
norm1 res is  tensor(0.1844, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(399.2018, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(382.7367, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(544.0770, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(594.9088, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(481.8871, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(393.6393, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(323.1747, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(328.8218, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4552.4790, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4608.9248, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4564.8438, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4559.4985, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4559.4214, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4587.8618, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4590.9990, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4569.8350, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4575.6553, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4566.3628, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4581.7603, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4623.9414, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(658.9988, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(481.3103, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(749.2086, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(613.9896, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(502.6031, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(506.1708, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(491.4173, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(584.6062, device='cuda:0')
norm_2 is  tensor(466.5127, device='cuda:0')
norm_2 * lamda is tensor(839.7228, device='cuda:0')
satisfying 27
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 86.54% 

Test Accuracy: 88.50% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
 benign loss is  0.692879443988204
distance 1 is tensor(110.2471, device='cuda:0')
distance 2 is tensor(8.2571, device='cuda:0')
benign distance is  tensor(8.2571, device='cuda:0')
norm1 res is  tensor(0.0917, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7037958279252052
distance 1 is tensor(91.9213, device='cuda:0')
distance 2 is tensor(6.8496, device='cuda:0')
benign distance is  tensor(6.8496, device='cuda:0')
norm1 res is  tensor(0.1221, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9718091450631618
distance 1 is tensor(106.4108, device='cuda:0')
distance 2 is tensor(7.9503, device='cuda:0')
benign distance is  tensor(7.9503, device='cuda:0')
norm1 res is  tensor(0.2030, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1451961565762758
distance 1 is tensor(125.1276, device='cuda:0')
distance 2 is tensor(9.2429, device='cuda:0')
benign distance is  tensor(9.2429, device='cuda:0')
norm1 res is  tensor(0.0876, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8802872751839459
distance 1 is tensor(67.8826, device='cuda:0')
distance 2 is tensor(5.1738, device='cuda:0')
benign distance is  tensor(5.1738, device='cuda:0')
norm1 res is  tensor(0.0725, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7136702861171216
distance 1 is tensor(82.6655, device='cuda:0')
distance 2 is tensor(6.1825, device='cuda:0')
benign distance is  tensor(6.1825, device='cuda:0')
norm1 res is  tensor(0.1372, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1366388807073236
distance 1 is tensor(92.3662, device='cuda:0')
distance 2 is tensor(6.9256, device='cuda:0')
benign distance is  tensor(6.9256, device='cuda:0')
norm1 res is  tensor(0.1064, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6010121358558536
distance 1 is tensor(73.2306, device='cuda:0')
distance 2 is tensor(5.4972, device='cuda:0')
benign distance is  tensor(5.4972, device='cuda:0')
norm1 res is  tensor(0.1167, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.6668418711051345
distance 1 is tensor(134.1120, device='cuda:0')
distance 2 is tensor(10.2317, device='cuda:0')
benign distance is  tensor(10.2317, device='cuda:0')
norm1 res is  tensor(0.1680, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.8712585717439651
distance 1 is tensor(100.6318, device='cuda:0')
distance 2 is tensor(7.3928, device='cuda:0')
benign distance is  tensor(7.3928, device='cuda:0')
norm1 res is  tensor(0.1358, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.6896054092794657
distance 1 is tensor(168.1660, device='cuda:0')
distance 2 is tensor(12.2723, device='cuda:0')
benign distance is  tensor(12.2723, device='cuda:0')
norm1 res is  tensor(0.1667, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.6885522454977036
distance 1 is tensor(154.9736, device='cuda:0')
distance 2 is tensor(11.2313, device='cuda:0')
benign distance is  tensor(11.2313, device='cuda:0')
norm1 res is  tensor(0.1144, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  1.2416408862918615
distance 1 is tensor(138.6341, device='cuda:0')
distance 2 is tensor(10.3423, device='cuda:0')
benign distance is  tensor(10.3423, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.7401013299822807
distance 1 is tensor(98.7707, device='cuda:0')
distance 2 is tensor(7.2679, device='cuda:0')
benign distance is  tensor(7.2679, device='cuda:0')
norm1 res is  tensor(0.1245, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.8473646454513073
distance 1 is tensor(104.8284, device='cuda:0')
distance 2 is tensor(7.6582, device='cuda:0')
benign distance is  tensor(7.6582, device='cuda:0')
norm1 res is  tensor(0.2069, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.8522644974291325
distance 1 is tensor(135.6550, device='cuda:0')
distance 2 is tensor(10.2153, device='cuda:0')
benign distance is  tensor(10.2153, device='cuda:0')
norm1 res is  tensor(0.1652, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(478.3868, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(400.0660, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(468.7415, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(552.7898, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(291.5551, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(354.1883, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(402.1572, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(315.2524, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4552.4526, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4616.2061, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4562.1851, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4555.4785, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4554.4761, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4584.5137, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4589.5562, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4567.1221, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4573.8760, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4560.5254, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4571.7388, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4620.0376, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(519.3015, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(689.5352, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(751.3030, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(468.4275, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(825.3295, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(677.4335, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(553.2004, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(651.1439, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(598.2801, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(625.7913, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(617.6931, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(574.7544, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(327.1412, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1061.2075, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(681.5244, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(501.2042, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(519.8518, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(635.5259, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(318.7103, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(557.7819, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(822.8120, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(266.3688, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(646.7321, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(559.5562, device='cuda:0')
norm_2 is  tensor(441.2633, device='cuda:0')
norm_2 * lamda is tensor(794.2739, device='cuda:0')
satisfying 43
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 83.10% 

Test Accuracy: 87.71% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7695963811129332
distance 1 is tensor(111.3708, device='cuda:0')
distance 2 is tensor(8.2391, device='cuda:0')
benign distance is  tensor(8.2391, device='cuda:0')
norm1 res is  tensor(0.0922, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7204352580010891
distance 1 is tensor(91.0694, device='cuda:0')
distance 2 is tensor(6.7268, device='cuda:0')
benign distance is  tensor(6.7268, device='cuda:0')
norm1 res is  tensor(0.1221, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7825147733092308
distance 1 is tensor(109.5583, device='cuda:0')
distance 2 is tensor(8.1492, device='cuda:0')
benign distance is  tensor(8.1492, device='cuda:0')
norm1 res is  tensor(0.2036, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.2821580171585083
distance 1 is tensor(135.5325, device='cuda:0')
distance 2 is tensor(10.0043, device='cuda:0')
benign distance is  tensor(10.0043, device='cuda:0')
norm1 res is  tensor(0.0957, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9398327372036874
distance 1 is tensor(93.4110, device='cuda:0')
distance 2 is tensor(7.1828, device='cuda:0')
benign distance is  tensor(7.1828, device='cuda:0')
norm1 res is  tensor(0.1013, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8857573354616761
distance 1 is tensor(72.7761, device='cuda:0')
distance 2 is tensor(5.4853, device='cuda:0')
benign distance is  tensor(5.4853, device='cuda:0')
norm1 res is  tensor(0.1249, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1408185921609402
distance 1 is tensor(71.8090, device='cuda:0')
distance 2 is tensor(5.4535, device='cuda:0')
benign distance is  tensor(5.4535, device='cuda:0')
norm1 res is  tensor(0.0818, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.640220096334815
distance 1 is tensor(73.3022, device='cuda:0')
distance 2 is tensor(5.4874, device='cuda:0')
benign distance is  tensor(5.4874, device='cuda:0')
norm1 res is  tensor(0.1151, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.9824456237256527
distance 1 is tensor(111.9559, device='cuda:0')
distance 2 is tensor(8.2260, device='cuda:0')
benign distance is  tensor(8.2260, device='cuda:0')
norm1 res is  tensor(0.1243, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.1764958389103413
distance 1 is tensor(140.3203, device='cuda:0')
distance 2 is tensor(10.3450, device='cuda:0')
benign distance is  tensor(10.3450, device='cuda:0')
norm1 res is  tensor(0.1504, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0368872676044703
distance 1 is tensor(68.9530, device='cuda:0')
distance 2 is tensor(5.1882, device='cuda:0')
benign distance is  tensor(5.1882, device='cuda:0')
norm1 res is  tensor(0.0886, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3335839584469795
distance 1 is tensor(124.6782, device='cuda:0')
distance 2 is tensor(9.1844, device='cuda:0')
benign distance is  tensor(9.1844, device='cuda:0')
norm1 res is  tensor(0.1241, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.241237998008728
distance 1 is tensor(179.6729, device='cuda:0')
distance 2 is tensor(13.0534, device='cuda:0')
benign distance is  tensor(13.0534, device='cuda:0')
norm1 res is  tensor(0.1184, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6456410782411695
distance 1 is tensor(59.6765, device='cuda:0')
distance 2 is tensor(4.4762, device='cuda:0')
benign distance is  tensor(4.4762, device='cuda:0')
norm1 res is  tensor(0.1557, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.0261833127588034
distance 1 is tensor(142.0095, device='cuda:0')
distance 2 is tensor(10.1489, device='cuda:0')
benign distance is  tensor(10.1489, device='cuda:0')
norm1 res is  tensor(0.1385, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.5894267112016678
distance 1 is tensor(120.9779, device='cuda:0')
distance 2 is tensor(9.1419, device='cuda:0')
benign distance is  tensor(9.1419, device='cuda:0')
norm1 res is  tensor(0.1180, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.2348066456615925
distance 1 is tensor(110.8952, device='cuda:0')
distance 2 is tensor(8.4684, device='cuda:0')
benign distance is  tensor(8.4684, device='cuda:0')
norm1 res is  tensor(0.1682, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.8100421549752355
distance 1 is tensor(125.9883, device='cuda:0')
distance 2 is tensor(9.2795, device='cuda:0')
benign distance is  tensor(9.2795, device='cuda:0')
norm1 res is  tensor(0.1649, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.9278066661208868
distance 1 is tensor(134.2672, device='cuda:0')
distance 2 is tensor(9.7760, device='cuda:0')
benign distance is  tensor(9.7760, device='cuda:0')
norm1 res is  tensor(0.1335, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.904723035171628
distance 1 is tensor(124.9615, device='cuda:0')
distance 2 is tensor(9.2727, device='cuda:0')
benign distance is  tensor(9.2727, device='cuda:0')
norm1 res is  tensor(0.1148, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9807821400463581
distance 1 is tensor(71.8857, device='cuda:0')
distance 2 is tensor(5.3680, device='cuda:0')
benign distance is  tensor(5.3680, device='cuda:0')
norm1 res is  tensor(0.0918, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8676673769950867
distance 1 is tensor(234.6189, device='cuda:0')
distance 2 is tensor(17.0981, device='cuda:0')
benign distance is  tensor(17.0981, device='cuda:0')
norm1 res is  tensor(0.1270, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.3906328901648521
distance 1 is tensor(146.6760, device='cuda:0')
distance 2 is tensor(10.8214, device='cuda:0')
benign distance is  tensor(10.8214, device='cuda:0')
norm1 res is  tensor(0.0943, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.8267655652016401
distance 1 is tensor(105.0556, device='cuda:0')
distance 2 is tensor(7.8232, device='cuda:0')
benign distance is  tensor(7.8232, device='cuda:0')
norm1 res is  tensor(0.0934, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.0493488870561123
distance 1 is tensor(113.5961, device='cuda:0')
distance 2 is tensor(8.6352, device='cuda:0')
benign distance is  tensor(8.6352, device='cuda:0')
norm1 res is  tensor(0.1195, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.7215174734592438
distance 1 is tensor(167.7931, device='cuda:0')
distance 2 is tensor(12.5330, device='cuda:0')
benign distance is  tensor(12.5330, device='cuda:0')
norm1 res is  tensor(0.1652, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.4531202428042889
distance 1 is tensor(160.7104, device='cuda:0')
distance 2 is tensor(11.8620, device='cuda:0')
benign distance is  tensor(11.8620, device='cuda:0')
norm1 res is  tensor(0.1130, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.8005932532250881
distance 1 is tensor(110.4096, device='cuda:0')
distance 2 is tensor(8.5322, device='cuda:0')
benign distance is  tensor(8.5322, device='cuda:0')
norm1 res is  tensor(0.2634, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.8901082314550877
distance 1 is tensor(188.4480, device='cuda:0')
distance 2 is tensor(13.6687, device='cuda:0')
benign distance is  tensor(13.6687, device='cuda:0')
norm1 res is  tensor(0.1817, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.7333970014005899
distance 1 is tensor(150.4094, device='cuda:0')
distance 2 is tensor(10.9654, device='cuda:0')
benign distance is  tensor(10.9654, device='cuda:0')
norm1 res is  tensor(0.1838, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  1.0400358699262142
distance 1 is tensor(113.9873, device='cuda:0')
distance 2 is tensor(8.2372, device='cuda:0')
benign distance is  tensor(8.2372, device='cuda:0')
norm1 res is  tensor(0.1522, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.4496695613488555
distance 1 is tensor(146.9160, device='cuda:0')
distance 2 is tensor(10.7535, device='cuda:0')
benign distance is  tensor(10.7535, device='cuda:0')
norm1 res is  tensor(0.1617, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(485.5796, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(389.4673, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(480.8289, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(604.8228, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(414.9042, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(314.7884, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(308.2968, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(313.9553, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4556.5103, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4616.9609, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4612.9912, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4568.2632, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4569.0586, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4589.0137, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4600.5698, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4574.9048, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4598.6606, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4568.9551, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4572.5693, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4627.4707, device='cuda:0')
norm_2 is  tensor(395.6872, device='cuda:0')
norm_2 * lamda is tensor(712.2370, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 84.11% 

Test Accuracy: 87.70% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7490839939564466
distance 1 is tensor(98.6246, device='cuda:0')
distance 2 is tensor(7.4172, device='cuda:0')
benign distance is  tensor(7.4172, device='cuda:0')
norm1 res is  tensor(0.0803, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9287152178585529
distance 1 is tensor(86.6019, device='cuda:0')
distance 2 is tensor(6.5393, device='cuda:0')
benign distance is  tensor(6.5393, device='cuda:0')
norm1 res is  tensor(0.1195, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8376201055943966
distance 1 is tensor(109.9259, device='cuda:0')
distance 2 is tensor(8.1488, device='cuda:0')
benign distance is  tensor(8.1488, device='cuda:0')
norm1 res is  tensor(0.2088, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1697132959961891
distance 1 is tensor(144.3159, device='cuda:0')
distance 2 is tensor(10.6742, device='cuda:0')
benign distance is  tensor(10.6742, device='cuda:0')
norm1 res is  tensor(0.1018, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0335605815052986
distance 1 is tensor(72.8686, device='cuda:0')
distance 2 is tensor(5.6882, device='cuda:0')
benign distance is  tensor(5.6882, device='cuda:0')
norm1 res is  tensor(0.0780, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6517352741211653
distance 1 is tensor(96.2855, device='cuda:0')
distance 2 is tensor(7.0415, device='cuda:0')
benign distance is  tensor(7.0415, device='cuda:0')
norm1 res is  tensor(0.1617, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.54451509937644
distance 1 is tensor(54.4458, device='cuda:0')
distance 2 is tensor(4.2462, device='cuda:0')
benign distance is  tensor(4.2462, device='cuda:0')
norm1 res is  tensor(0.0629, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7850464954972267
distance 1 is tensor(63.4362, device='cuda:0')
distance 2 is tensor(4.9205, device='cuda:0')
benign distance is  tensor(4.9205, device='cuda:0')
norm1 res is  tensor(0.1032, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(424.6494, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(385.0050, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(490.1538, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(649.1133, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(323.3230, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(408.2515, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(237.5926, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(278.6053, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4586.8257, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4665.8330, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4612.4048, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4625.2017, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4597.5791, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4625.5581, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4640.4136, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4613.0156, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4608.8774, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4604.7720, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4607.1914, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4659.4189, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(571.6106, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(435.9654, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(626.7690, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(567.8562, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(615.2621, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(571.7882, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(572.2749, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(914.1509, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(503.9987, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(633.2275, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(311.7953, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(547.2602, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(802.8685, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(277.4402, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(631.8979, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(545.0013, device='cuda:0')
norm_2 is  tensor(333.3461, device='cuda:0')
norm_2 * lamda is tensor(600.0230, device='cuda:0')
satisfying 35
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 84.87% 

Test Accuracy: 88.04% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6599665712565184
distance 1 is tensor(103.2010, device='cuda:0')
distance 2 is tensor(7.5885, device='cuda:0')
benign distance is  tensor(7.5885, device='cuda:0')
norm1 res is  tensor(0.0847, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7229721555486321
distance 1 is tensor(77.2126, device='cuda:0')
distance 2 is tensor(5.7522, device='cuda:0')
benign distance is  tensor(5.7522, device='cuda:0')
norm1 res is  tensor(0.1059, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9433272704482079
distance 1 is tensor(97.4739, device='cuda:0')
distance 2 is tensor(7.4025, device='cuda:0')
benign distance is  tensor(7.4025, device='cuda:0')
norm1 res is  tensor(0.1881, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.189684109762311
distance 1 is tensor(127.0939, device='cuda:0')
distance 2 is tensor(9.3143, device='cuda:0')
benign distance is  tensor(9.3143, device='cuda:0')
norm1 res is  tensor(0.0900, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.297923531383276
distance 1 is tensor(66.9876, device='cuda:0')
distance 2 is tensor(5.1504, device='cuda:0')
benign distance is  tensor(5.1504, device='cuda:0')
norm1 res is  tensor(0.0701, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6623444221913815
distance 1 is tensor(89.2990, device='cuda:0')
distance 2 is tensor(6.5610, device='cuda:0')
benign distance is  tensor(6.5610, device='cuda:0')
norm1 res is  tensor(0.1520, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1236075293272734
distance 1 is tensor(69.3116, device='cuda:0')
distance 2 is tensor(5.3457, device='cuda:0')
benign distance is  tensor(5.3457, device='cuda:0')
norm1 res is  tensor(0.0807, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6818098509684205
distance 1 is tensor(78.9147, device='cuda:0')
distance 2 is tensor(5.9284, device='cuda:0')
benign distance is  tensor(5.9284, device='cuda:0')
norm1 res is  tensor(0.1268, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.1615984179079533
distance 1 is tensor(113.1621, device='cuda:0')
distance 2 is tensor(8.4578, device='cuda:0')
benign distance is  tensor(8.4578, device='cuda:0')
norm1 res is  tensor(0.1286, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8283980544656515
distance 1 is tensor(150.5554, device='cuda:0')
distance 2 is tensor(10.9468, device='cuda:0')
benign distance is  tensor(10.9468, device='cuda:0')
norm1 res is  tensor(0.1587, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.000030541792512
distance 1 is tensor(63.0856, device='cuda:0')
distance 2 is tensor(4.9430, device='cuda:0')
benign distance is  tensor(4.9430, device='cuda:0')
norm1 res is  tensor(0.0871, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0989964492619038
distance 1 is tensor(123.0107, device='cuda:0')
distance 2 is tensor(9.0587, device='cuda:0')
benign distance is  tensor(9.0587, device='cuda:0')
norm1 res is  tensor(0.1270, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.211166124790907
distance 1 is tensor(182.7915, device='cuda:0')
distance 2 is tensor(13.1727, device='cuda:0')
benign distance is  tensor(13.1727, device='cuda:0')
norm1 res is  tensor(0.1179, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6187777062878013
distance 1 is tensor(59.6120, device='cuda:0')
distance 2 is tensor(4.4189, device='cuda:0')
benign distance is  tensor(4.4189, device='cuda:0')
norm1 res is  tensor(0.1535, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.9321570005267859
distance 1 is tensor(141.4049, device='cuda:0')
distance 2 is tensor(10.4985, device='cuda:0')
benign distance is  tensor(10.4985, device='cuda:0')
norm1 res is  tensor(0.1433, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.2728976346552372
distance 1 is tensor(121.3301, device='cuda:0')
distance 2 is tensor(9.0735, device='cuda:0')
benign distance is  tensor(9.0735, device='cuda:0')
norm1 res is  tensor(0.1186, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.904974490404129
distance 1 is tensor(115.0207, device='cuda:0')
distance 2 is tensor(8.6287, device='cuda:0')
benign distance is  tensor(8.6287, device='cuda:0')
norm1 res is  tensor(0.1278, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  1.0485893655568361
distance 1 is tensor(105.2426, device='cuda:0')
distance 2 is tensor(7.7765, device='cuda:0')
benign distance is  tensor(7.7765, device='cuda:0')
norm1 res is  tensor(0.2861, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.3122443221509457
distance 1 is tensor(141.4611, device='cuda:0')
distance 2 is tensor(10.5366, device='cuda:0')
benign distance is  tensor(10.5366, device='cuda:0')
norm1 res is  tensor(0.1235, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.183268615975976
distance 1 is tensor(133.2052, device='cuda:0')
distance 2 is tensor(9.9890, device='cuda:0')
benign distance is  tensor(9.9890, device='cuda:0')
norm1 res is  tensor(0.1531, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.7549772076308727
distance 1 is tensor(138.9310, device='cuda:0')
distance 2 is tensor(10.1086, device='cuda:0')
benign distance is  tensor(10.1086, device='cuda:0')
norm1 res is  tensor(0.1539, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.9344778098165989
distance 1 is tensor(143.8996, device='cuda:0')
distance 2 is tensor(10.8254, device='cuda:0')
benign distance is  tensor(10.8254, device='cuda:0')
norm1 res is  tensor(0.1577, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5544053092598915
distance 1 is tensor(123.1567, device='cuda:0')
distance 2 is tensor(9.1004, device='cuda:0')
benign distance is  tensor(9.1004, device='cuda:0')
norm1 res is  tensor(0.1416, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.777199873700738
distance 1 is tensor(193.0637, device='cuda:0')
distance 2 is tensor(13.9904, device='cuda:0')
benign distance is  tensor(13.9904, device='cuda:0')
norm1 res is  tensor(0.1725, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(446.3026, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(339.1564, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(429.7956, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(546.3168, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(290.5532, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(388.0963, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(306.1059, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(343.3106, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4591.2832, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4648.2300, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4608.7554, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4607.9541, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4609.1641, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4618.3408, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4629.3667, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4602.9673, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4626.2651, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4599.1685, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4605.5859, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4668.1943, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(514.6536, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(567.2883, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(581.1801, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(558.4344, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(323.1184, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1030.0164, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(636.8121, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(484.2631, device='cuda:0')
norm_2 is  tensor(470.9823, device='cuda:0')
norm_2 * lamda is tensor(847.7681, device='cuda:0')
satisfying 27
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 84.24% 

Test Accuracy: 87.86% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7139364955946803
distance 1 is tensor(94.1228, device='cuda:0')
distance 2 is tensor(7.0614, device='cuda:0')
benign distance is  tensor(7.0614, device='cuda:0')
norm1 res is  tensor(0.0781, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7232591602951288
distance 1 is tensor(83.5686, device='cuda:0')
distance 2 is tensor(6.2281, device='cuda:0')
benign distance is  tensor(6.2281, device='cuda:0')
norm1 res is  tensor(0.1108, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7579562719911337
distance 1 is tensor(100.6540, device='cuda:0')
distance 2 is tensor(7.4952, device='cuda:0')
benign distance is  tensor(7.4952, device='cuda:0')
norm1 res is  tensor(0.1910, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0016549788415432
distance 1 is tensor(150.1292, device='cuda:0')
distance 2 is tensor(11.0520, device='cuda:0')
benign distance is  tensor(11.0520, device='cuda:0')
norm1 res is  tensor(0.1083, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.709240609779954
distance 1 is tensor(67.5316, device='cuda:0')
distance 2 is tensor(5.1183, device='cuda:0')
benign distance is  tensor(5.1183, device='cuda:0')
norm1 res is  tensor(0.0708, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  1.0004880307242274
distance 1 is tensor(83.6729, device='cuda:0')
distance 2 is tensor(6.2181, device='cuda:0')
benign distance is  tensor(6.2181, device='cuda:0')
norm1 res is  tensor(0.1384, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.6118245832622051
distance 1 is tensor(75.7426, device='cuda:0')
distance 2 is tensor(5.7040, device='cuda:0')
benign distance is  tensor(5.7040, device='cuda:0')
norm1 res is  tensor(0.0865, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6975430995225906
distance 1 is tensor(74.6012, device='cuda:0')
distance 2 is tensor(5.6298, device='cuda:0')
benign distance is  tensor(5.6298, device='cuda:0')
norm1 res is  tensor(0.1219, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.0982836298644543
distance 1 is tensor(93.2267, device='cuda:0')
distance 2 is tensor(7.1573, device='cuda:0')
benign distance is  tensor(7.1573, device='cuda:0')
norm1 res is  tensor(0.1383, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7084727808833122
distance 1 is tensor(119.0763, device='cuda:0')
distance 2 is tensor(8.8334, device='cuda:0')
benign distance is  tensor(8.8334, device='cuda:0')
norm1 res is  tensor(0.1578, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.9376391619443893
distance 1 is tensor(133.2677, device='cuda:0')
distance 2 is tensor(9.8405, device='cuda:0')
benign distance is  tensor(9.8405, device='cuda:0')
norm1 res is  tensor(0.1368, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9047621320933104
distance 1 is tensor(119.1254, device='cuda:0')
distance 2 is tensor(8.8536, device='cuda:0')
benign distance is  tensor(8.8536, device='cuda:0')
norm1 res is  tensor(0.1090, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.1155522521585226
distance 1 is tensor(81.9215, device='cuda:0')
distance 2 is tensor(6.0656, device='cuda:0')
benign distance is  tensor(6.0656, device='cuda:0')
norm1 res is  tensor(0.1053, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9920687563717365
distance 1 is tensor(238.7156, device='cuda:0')
distance 2 is tensor(17.2704, device='cuda:0')
benign distance is  tensor(17.2704, device='cuda:0')
norm1 res is  tensor(0.1295, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.0989728048443794
distance 1 is tensor(147.7751, device='cuda:0')
distance 2 is tensor(10.9554, device='cuda:0')
benign distance is  tensor(10.9554, device='cuda:0')
norm1 res is  tensor(0.0969, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.7034753542393446
distance 1 is tensor(99.1282, device='cuda:0')
distance 2 is tensor(7.4060, device='cuda:0')
benign distance is  tensor(7.4060, device='cuda:0')
norm1 res is  tensor(0.0862, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(401.3439, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(359.1773, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(447.9651, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(674.3589, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(282.4890, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(359.1074, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(325.6465, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(329.3486, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4597.6440, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4679.7598, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4618.0879, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4618.4727, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4612.1304, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4640.3491, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4650.0093, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4616.1782, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4646.2119, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4608.2129, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4620.4121, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4676.0498, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(634.2017, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(458.3311, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(762.0294, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(687.2513, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(617.6235, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(461.2271, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(474.0691, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(623.2964, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(515.2719, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(661.5028, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(298.6087, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(552.9943, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(795.8685, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(271.9156, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(641.6361, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(543.6578, device='cuda:0')
norm_2 is  tensor(318.5637, device='cuda:0')
norm_2 * lamda is tensor(573.4146, device='cuda:0')
satisfying 35
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 84.14% 

Test Accuracy: 87.90% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
 benign loss is  0.819333866238594
distance 1 is tensor(101.9447, device='cuda:0')
distance 2 is tensor(7.6464, device='cuda:0')
benign distance is  tensor(7.6464, device='cuda:0')
norm1 res is  tensor(0.0855, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8237506151199341
distance 1 is tensor(84.6806, device='cuda:0')
distance 2 is tensor(6.4549, device='cuda:0')
benign distance is  tensor(6.4549, device='cuda:0')
norm1 res is  tensor(0.1167, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7806812282651663
distance 1 is tensor(87.4141, device='cuda:0')
distance 2 is tensor(6.6727, device='cuda:0')
benign distance is  tensor(6.6727, device='cuda:0')
norm1 res is  tensor(0.1668, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.9231589436531067
distance 1 is tensor(141.4611, device='cuda:0')
distance 2 is tensor(10.3845, device='cuda:0')
benign distance is  tensor(10.3845, device='cuda:0')
norm1 res is  tensor(0.0989, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9799103662371635
distance 1 is tensor(101.7437, device='cuda:0')
distance 2 is tensor(7.7197, device='cuda:0')
benign distance is  tensor(7.7197, device='cuda:0')
norm1 res is  tensor(0.1080, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.767825024202466
distance 1 is tensor(84.3731, device='cuda:0')
distance 2 is tensor(6.2227, device='cuda:0')
benign distance is  tensor(6.2227, device='cuda:0')
norm1 res is  tensor(0.1411, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1997472904622555
distance 1 is tensor(107.6749, device='cuda:0')
distance 2 is tensor(8.2096, device='cuda:0')
benign distance is  tensor(8.2096, device='cuda:0')
norm1 res is  tensor(0.1267, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7390134409070015
distance 1 is tensor(70.7003, device='cuda:0')
distance 2 is tensor(5.3625, device='cuda:0')
benign distance is  tensor(5.3625, device='cuda:0')
norm1 res is  tensor(0.1177, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.3280400335788727
distance 1 is tensor(105.8976, device='cuda:0')
distance 2 is tensor(7.9178, device='cuda:0')
benign distance is  tensor(7.9178, device='cuda:0')
norm1 res is  tensor(0.1197, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8920851182192564
distance 1 is tensor(145.5322, device='cuda:0')
distance 2 is tensor(10.7234, device='cuda:0')
benign distance is  tensor(10.7234, device='cuda:0')
norm1 res is  tensor(0.1570, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0200512986630201
distance 1 is tensor(61.7869, device='cuda:0')
distance 2 is tensor(4.8522, device='cuda:0')
benign distance is  tensor(4.8522, device='cuda:0')
norm1 res is  tensor(0.0851, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.1796582154929638
distance 1 is tensor(131.9226, device='cuda:0')
distance 2 is tensor(9.7669, device='cuda:0')
benign distance is  tensor(9.7669, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.2989553399384022
distance 1 is tensor(184.8598, device='cuda:0')
distance 2 is tensor(13.3874, device='cuda:0')
benign distance is  tensor(13.3874, device='cuda:0')
norm1 res is  tensor(0.1214, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.8344587730243802
distance 1 is tensor(57.6634, device='cuda:0')
distance 2 is tensor(4.3141, device='cuda:0')
benign distance is  tensor(4.3141, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.05986394174397
distance 1 is tensor(134.2681, device='cuda:0')
distance 2 is tensor(9.8103, device='cuda:0')
benign distance is  tensor(9.8103, device='cuda:0')
norm1 res is  tensor(0.1332, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.3443892411887646
distance 1 is tensor(116.7466, device='cuda:0')
distance 2 is tensor(8.7932, device='cuda:0')
benign distance is  tensor(8.7932, device='cuda:0')
norm1 res is  tensor(0.1147, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.748714892193675
distance 1 is tensor(138.3152, device='cuda:0')
distance 2 is tensor(10.5758, device='cuda:0')
benign distance is  tensor(10.5758, device='cuda:0')
norm1 res is  tensor(0.1730, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.8099506143480539
distance 1 is tensor(116.3142, device='cuda:0')
distance 2 is tensor(8.4604, device='cuda:0')
benign distance is  tensor(8.4604, device='cuda:0')
norm1 res is  tensor(0.1557, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.8353217896074057
distance 1 is tensor(174.8185, device='cuda:0')
distance 2 is tensor(12.7809, device='cuda:0')
benign distance is  tensor(12.7809, device='cuda:0')
norm1 res is  tensor(0.1688, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.371240358799696
distance 1 is tensor(142.6418, device='cuda:0')
distance 2 is tensor(10.4759, device='cuda:0')
benign distance is  tensor(10.4759, device='cuda:0')
norm1 res is  tensor(0.1059, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.7068140059709549
distance 1 is tensor(127.2434, device='cuda:0')
distance 2 is tensor(9.5263, device='cuda:0')
benign distance is  tensor(9.5263, device='cuda:0')
norm1 res is  tensor(0.1400, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  1.013192830607295
distance 1 is tensor(98.2927, device='cuda:0')
distance 2 is tensor(7.3065, device='cuda:0')
benign distance is  tensor(7.3065, device='cuda:0')
norm1 res is  tensor(0.1258, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  1.0207104347646236
distance 1 is tensor(102.2389, device='cuda:0')
distance 2 is tensor(7.6656, device='cuda:0')
benign distance is  tensor(7.6656, device='cuda:0')
norm1 res is  tensor(0.2121, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.7676236666738987
distance 1 is tensor(129.3258, device='cuda:0')
distance 2 is tensor(9.6470, device='cuda:0')
benign distance is  tensor(9.6470, device='cuda:0')
norm1 res is  tensor(0.1551, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(451.5722, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(380.9081, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(388.0904, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(628.3709, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(445.7533, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(363.5405, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(479.8364, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(309.3089, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4610.2227, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4675.3730, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4613.4087, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4639.7949, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4616.1421, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4641.2119, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4650.1431, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4618.5527, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4639.1807, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4618.1768, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4621.3765, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4699.4883, device='cuda:0')
norm_2 is  tensor(427.7591, device='cuda:0')
norm_2 * lamda is tensor(769.9663, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 86.60% 

Test Accuracy: 88.37% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7313846684992313
distance 1 is tensor(95.8434, device='cuda:0')
distance 2 is tensor(7.3644, device='cuda:0')
benign distance is  tensor(7.3644, device='cuda:0')
norm1 res is  tensor(0.0820, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8314930517226458
distance 1 is tensor(92.3454, device='cuda:0')
distance 2 is tensor(6.8850, device='cuda:0')
benign distance is  tensor(6.8850, device='cuda:0')
norm1 res is  tensor(0.1262, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7882674969732761
distance 1 is tensor(89.3136, device='cuda:0')
distance 2 is tensor(6.8423, device='cuda:0')
benign distance is  tensor(6.8423, device='cuda:0')
norm1 res is  tensor(0.1769, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0553485602140427
distance 1 is tensor(154.1258, device='cuda:0')
distance 2 is tensor(11.0787, device='cuda:0')
benign distance is  tensor(11.0787, device='cuda:0')
norm1 res is  tensor(0.1052, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7776452293619514
distance 1 is tensor(78.0620, device='cuda:0')
distance 2 is tensor(5.8755, device='cuda:0')
benign distance is  tensor(5.8755, device='cuda:0')
norm1 res is  tensor(0.0818, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7240748982876539
distance 1 is tensor(86.3432, device='cuda:0')
distance 2 is tensor(6.2353, device='cuda:0')
benign distance is  tensor(6.2353, device='cuda:0')
norm1 res is  tensor(0.1451, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.5499523766338825
distance 1 is tensor(73.9217, device='cuda:0')
distance 2 is tensor(5.5294, device='cuda:0')
benign distance is  tensor(5.5294, device='cuda:0')
norm1 res is  tensor(0.0871, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7789653474465013
distance 1 is tensor(76.6468, device='cuda:0')
distance 2 is tensor(5.6018, device='cuda:0')
benign distance is  tensor(5.6018, device='cuda:0')
norm1 res is  tensor(0.1195, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(431.6037, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(404.7213, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(402.1421, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(663.2521, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(335.3593, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(364.3990, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(321.0583, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(314.1646, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4635.6211, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4696.1924, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4655.8037, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4662.9326, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4647.3628, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4675.8862, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4685.7036, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4659.4219, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4665.9810, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4654.1489, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4662.6182, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4721.0513, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(540.1395, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(756.2695, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(724.9717, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(525.8334, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(850.7752, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(684.7426, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(516.0348, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(661.8452, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(535.8032, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(485.9447, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(648.0280, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(626.1736, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(625.9493, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(666.1124, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(566.6218, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(854.8390, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(441.1989, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(552.4011, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(598.3497, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(543.0793, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(384.3920, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1051.4500, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(666.6084, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(462.7272, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(487.3293, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(656.8757, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(302.6199, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(589.8915, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(820.0503, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
do  not satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(275.4649, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(607.7886, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(534.1860, device='cuda:0')
norm_2 is  tensor(413.4225, device='cuda:0')
norm_2 * lamda is tensor(744.1604, device='cuda:0')
satisfying 51
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 85.19% 

Test Accuracy: 88.06% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7276390884071589
distance 1 is tensor(87.3445, device='cuda:0')
distance 2 is tensor(6.5697, device='cuda:0')
benign distance is  tensor(6.5697, device='cuda:0')
norm1 res is  tensor(0.0722, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7436023205518723
distance 1 is tensor(94.4660, device='cuda:0')
distance 2 is tensor(7.0735, device='cuda:0')
benign distance is  tensor(7.0735, device='cuda:0')
norm1 res is  tensor(0.1301, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6817611930891871
distance 1 is tensor(103.6035, device='cuda:0')
distance 2 is tensor(7.6973, device='cuda:0')
benign distance is  tensor(7.6973, device='cuda:0')
norm1 res is  tensor(0.1953, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0757515765726566
distance 1 is tensor(128.4754, device='cuda:0')
distance 2 is tensor(9.4442, device='cuda:0')
benign distance is  tensor(9.4442, device='cuda:0')
norm1 res is  tensor(0.0917, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8364773821085691
distance 1 is tensor(75.4326, device='cuda:0')
distance 2 is tensor(5.7481, device='cuda:0')
benign distance is  tensor(5.7481, device='cuda:0')
norm1 res is  tensor(0.0787, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7066370844841003
distance 1 is tensor(80.5857, device='cuda:0')
distance 2 is tensor(5.9585, device='cuda:0')
benign distance is  tensor(5.9585, device='cuda:0')
norm1 res is  tensor(0.1323, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4516078308224678
distance 1 is tensor(65.7229, device='cuda:0')
distance 2 is tensor(5.1055, device='cuda:0')
benign distance is  tensor(5.1055, device='cuda:0')
norm1 res is  tensor(0.0768, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.676155773922801
distance 1 is tensor(86.5985, device='cuda:0')
distance 2 is tensor(6.4689, device='cuda:0')
benign distance is  tensor(6.4689, device='cuda:0')
norm1 res is  tensor(0.1375, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.6789967454969883
distance 1 is tensor(111.3643, device='cuda:0')
distance 2 is tensor(8.2123, device='cuda:0')
benign distance is  tensor(8.2123, device='cuda:0')
norm1 res is  tensor(0.1242, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.2020184695720673
distance 1 is tensor(156.0670, device='cuda:0')
distance 2 is tensor(11.4537, device='cuda:0')
benign distance is  tensor(11.4537, device='cuda:0')
norm1 res is  tensor(0.1681, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9411007519811392
distance 1 is tensor(76.4647, device='cuda:0')
distance 2 is tensor(5.8023, device='cuda:0')
benign distance is  tensor(5.8023, device='cuda:0')
norm1 res is  tensor(0.1024, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.176796618849039
distance 1 is tensor(103.6806, device='cuda:0')
distance 2 is tensor(7.8083, device='cuda:0')
benign distance is  tensor(7.8083, device='cuda:0')
norm1 res is  tensor(0.1078, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.168618731200695
distance 1 is tensor(214.8787, device='cuda:0')
distance 2 is tensor(15.6114, device='cuda:0')
benign distance is  tensor(15.6114, device='cuda:0')
norm1 res is  tensor(0.1618, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.8097619917243719
distance 1 is tensor(48.4776, device='cuda:0')
distance 2 is tensor(3.7243, device='cuda:0')
benign distance is  tensor(3.7243, device='cuda:0')
norm1 res is  tensor(0.1261, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.256407206878066
distance 1 is tensor(145.5210, device='cuda:0')
distance 2 is tensor(10.6964, device='cuda:0')
benign distance is  tensor(10.6964, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.5346201285719872
distance 1 is tensor(114.7263, device='cuda:0')
distance 2 is tensor(8.5524, device='cuda:0')
benign distance is  tensor(8.5524, device='cuda:0')
norm1 res is  tensor(0.1118, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.1051661595702171
distance 1 is tensor(109.5834, device='cuda:0')
distance 2 is tensor(8.3329, device='cuda:0')
benign distance is  tensor(8.3329, device='cuda:0')
norm1 res is  tensor(0.1637, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7971154283732176
distance 1 is tensor(124.4073, device='cuda:0')
distance 2 is tensor(9.1083, device='cuda:0')
benign distance is  tensor(9.1083, device='cuda:0')
norm1 res is  tensor(0.1585, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.0413788184523582
distance 1 is tensor(132.9009, device='cuda:0')
distance 2 is tensor(9.7859, device='cuda:0')
benign distance is  tensor(9.7859, device='cuda:0')
norm1 res is  tensor(0.1335, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9709470514208078
distance 1 is tensor(118.6298, device='cuda:0')
distance 2 is tensor(8.9361, device='cuda:0')
benign distance is  tensor(8.9361, device='cuda:0')
norm1 res is  tensor(0.1092, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9959438890218735
distance 1 is tensor(61.3159, device='cuda:0')
distance 2 is tensor(4.6636, device='cuda:0')
benign distance is  tensor(4.6636, device='cuda:0')
norm1 res is  tensor(0.0775, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  1.1232981532812119
distance 1 is tensor(232.6923, device='cuda:0')
distance 2 is tensor(16.8225, device='cuda:0')
benign distance is  tensor(16.8225, device='cuda:0')
norm1 res is  tensor(0.1254, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.1761711053550243
distance 1 is tensor(162.6479, device='cuda:0')
distance 2 is tensor(11.9592, device='cuda:0')
benign distance is  tensor(11.9592, device='cuda:0')
norm1 res is  tensor(0.1055, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.8031003763899207
distance 1 is tensor(128.2548, device='cuda:0')
distance 2 is tensor(9.5628, device='cuda:0')
benign distance is  tensor(9.5628, device='cuda:0')
norm1 res is  tensor(0.1132, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.1036983132362366
distance 1 is tensor(125.3516, device='cuda:0')
distance 2 is tensor(9.1642, device='cuda:0')
benign distance is  tensor(9.1642, device='cuda:0')
norm1 res is  tensor(0.1371, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6728732846677303
distance 1 is tensor(135.6810, device='cuda:0')
distance 2 is tensor(10.9260, device='cuda:0')
benign distance is  tensor(10.9260, device='cuda:0')
norm1 res is  tensor(0.4222, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.1166385989636183
distance 1 is tensor(142.3833, device='cuda:0')
distance 2 is tensor(10.4111, device='cuda:0')
benign distance is  tensor(10.4111, device='cuda:0')
norm1 res is  tensor(0.1215, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.5174365378916264
distance 1 is tensor(122.3004, device='cuda:0')
distance 2 is tensor(9.2332, device='cuda:0')
benign distance is  tensor(9.2332, device='cuda:0')
norm1 res is  tensor(0.1374, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.9958878606557846
distance 1 is tensor(131.9640, device='cuda:0')
distance 2 is tensor(9.6864, device='cuda:0')
benign distance is  tensor(9.6864, device='cuda:0')
norm1 res is  tensor(0.1482, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8958051893860102
distance 1 is tensor(121.8842, device='cuda:0')
distance 2 is tensor(9.2239, device='cuda:0')
benign distance is  tensor(9.2239, device='cuda:0')
norm1 res is  tensor(0.1312, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.4995791194960475
distance 1 is tensor(134.3064, device='cuda:0')
distance 2 is tensor(9.8496, device='cuda:0')
benign distance is  tensor(9.8496, device='cuda:0')
norm1 res is  tensor(0.1538, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.7352161053568125
distance 1 is tensor(206.0829, device='cuda:0')
distance 2 is tensor(14.9658, device='cuda:0')
benign distance is  tensor(14.9658, device='cuda:0')
norm1 res is  tensor(0.1839, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.1192264091223478
distance 1 is tensor(126.8955, device='cuda:0')
distance 2 is tensor(9.3628, device='cuda:0')
benign distance is  tensor(9.3628, device='cuda:0')
norm1 res is  tensor(0.1298, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.1823661290109158
distance 1 is tensor(199.9659, device='cuda:0')
distance 2 is tensor(14.9111, device='cuda:0')
benign distance is  tensor(14.9111, device='cuda:0')
norm1 res is  tensor(0.1997, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.5873985961079597
distance 1 is tensor(179.9662, device='cuda:0')
distance 2 is tensor(13.5519, device='cuda:0')
benign distance is  tensor(13.5519, device='cuda:0')
norm1 res is  tensor(0.1307, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.8460421226918697
distance 1 is tensor(106.6930, device='cuda:0')
distance 2 is tensor(8.1254, device='cuda:0')
benign distance is  tensor(8.1254, device='cuda:0')
norm1 res is  tensor(0.2532, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.862018920481205
distance 1 is tensor(188.4781, device='cuda:0')
distance 2 is tensor(14.0061, device='cuda:0')
benign distance is  tensor(14.0061, device='cuda:0')
norm1 res is  tensor(0.1873, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.7964336480945349
distance 1 is tensor(156.0989, device='cuda:0')
distance 2 is tensor(11.5212, device='cuda:0')
benign distance is  tensor(11.5212, device='cuda:0')
norm1 res is  tensor(0.1930, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.9058533441275358
distance 1 is tensor(123.0061, device='cuda:0')
distance 2 is tensor(9.0550, device='cuda:0')
benign distance is  tensor(9.0550, device='cuda:0')
norm1 res is  tensor(0.1664, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5579731399193406
distance 1 is tensor(152.9351, device='cuda:0')
distance 2 is tensor(11.1257, device='cuda:0')
benign distance is  tensor(11.1257, device='cuda:0')
norm1 res is  tensor(0.1695, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(380.0353, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(420.8339, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(451.7405, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(566.5983, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(322.1781, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(344.6014, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(291.6610, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(374.4359, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4626.4048, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4691.3750, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4634.2368, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4638.2666, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4630.5952, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4677.7231, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4659.7168, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4639.5508, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4654.1470, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4635.8979, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4640.3774, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4701.2861, device='cuda:0')
norm_2 is  tensor(368.4741, device='cuda:0')
norm_2 * lamda is tensor(663.2533, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 86.44% 

Test Accuracy: 88.66% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
 benign loss is  0.815976582467556
distance 1 is tensor(100.5601, device='cuda:0')
distance 2 is tensor(7.5916, device='cuda:0')
benign distance is  tensor(7.5916, device='cuda:0')
norm1 res is  tensor(0.0851, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.913869421929121
distance 1 is tensor(74.7278, device='cuda:0')
distance 2 is tensor(5.6835, device='cuda:0')
benign distance is  tensor(5.6835, device='cuda:0')
norm1 res is  tensor(0.1022, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.883469732478261
distance 1 is tensor(126.3068, device='cuda:0')
distance 2 is tensor(9.3232, device='cuda:0')
benign distance is  tensor(9.3232, device='cuda:0')
norm1 res is  tensor(0.2377, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.4160329475998878
distance 1 is tensor(154.6752, device='cuda:0')
distance 2 is tensor(11.0671, device='cuda:0')
benign distance is  tensor(11.0671, device='cuda:0')
norm1 res is  tensor(0.1053, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7705392809584737
distance 1 is tensor(60.5435, device='cuda:0')
distance 2 is tensor(4.6684, device='cuda:0')
benign distance is  tensor(4.6684, device='cuda:0')
norm1 res is  tensor(0.0645, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7571115763857961
distance 1 is tensor(94.6072, device='cuda:0')
distance 2 is tensor(6.9130, device='cuda:0')
benign distance is  tensor(6.9130, device='cuda:0')
norm1 res is  tensor(0.1574, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.6035970970988274
distance 1 is tensor(77.0340, device='cuda:0')
distance 2 is tensor(5.9248, device='cuda:0')
benign distance is  tensor(5.9248, device='cuda:0')
norm1 res is  tensor(0.0910, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6844351682811975
distance 1 is tensor(69.0707, device='cuda:0')
distance 2 is tensor(5.2315, device='cuda:0')
benign distance is  tensor(5.2315, device='cuda:0')
norm1 res is  tensor(0.1099, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(447.6573, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(335.6815, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(551.9698, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(666.9292, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(266.3616, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(409.0950, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(343.4055, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(301.3561, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4659.5737, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4716.9404, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4676.2007, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4670.9746, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4673.5747, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4698.6328, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4702.8789, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4670.2524, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4689.0718, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4670.8047, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4676.1533, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4748.8853, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(499.8578, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(697.7672, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(351.3134, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(472.9011, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(952.2625, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(234.1665, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(657.9449, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(514.5313, device='cuda:0')
norm_2 is  tensor(433.4668, device='cuda:0')
norm_2 * lamda is tensor(780.2403, device='cuda:0')
satisfying 27
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 82.58% 

Test Accuracy: 87.48% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6580518074333668
distance 1 is tensor(80.5847, device='cuda:0')
distance 2 is tensor(6.1463, device='cuda:0')
benign distance is  tensor(6.1463, device='cuda:0')
norm1 res is  tensor(0.0684, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7928393855690956
distance 1 is tensor(72.1663, device='cuda:0')
distance 2 is tensor(5.4482, device='cuda:0')
benign distance is  tensor(5.4482, device='cuda:0')
norm1 res is  tensor(0.1034, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8215641193091869
distance 1 is tensor(122.9906, device='cuda:0')
distance 2 is tensor(9.0321, device='cuda:0')
benign distance is  tensor(9.0321, device='cuda:0')
norm1 res is  tensor(0.2274, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.9978316156193614
distance 1 is tensor(138.0347, device='cuda:0')
distance 2 is tensor(10.1035, device='cuda:0')
benign distance is  tensor(10.1035, device='cuda:0')
norm1 res is  tensor(0.0960, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8375191306695342
distance 1 is tensor(84.0586, device='cuda:0')
distance 2 is tensor(6.4467, device='cuda:0')
benign distance is  tensor(6.4467, device='cuda:0')
norm1 res is  tensor(0.0895, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8591929171234369
distance 1 is tensor(105.6130, device='cuda:0')
distance 2 is tensor(7.5121, device='cuda:0')
benign distance is  tensor(7.5121, device='cuda:0')
norm1 res is  tensor(0.1709, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.7438183389604092
distance 1 is tensor(91.6242, device='cuda:0')
distance 2 is tensor(6.8916, device='cuda:0')
benign distance is  tensor(6.8916, device='cuda:0')
norm1 res is  tensor(0.1089, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8016269505023956
distance 1 is tensor(60.4779, device='cuda:0')
distance 2 is tensor(4.5950, device='cuda:0')
benign distance is  tensor(4.5950, device='cuda:0')
norm1 res is  tensor(0.0949, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.3024871088564396
distance 1 is tensor(117.0864, device='cuda:0')
distance 2 is tensor(8.6509, device='cuda:0')
benign distance is  tensor(8.6509, device='cuda:0')
norm1 res is  tensor(0.1311, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.082790995016694
distance 1 is tensor(140.9674, device='cuda:0')
distance 2 is tensor(10.4580, device='cuda:0')
benign distance is  tensor(10.4580, device='cuda:0')
norm1 res is  tensor(0.1521, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9031185153871775
distance 1 is tensor(79.0178, device='cuda:0')
distance 2 is tensor(6.0145, device='cuda:0')
benign distance is  tensor(6.0145, device='cuda:0')
norm1 res is  tensor(0.1071, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3820371069014072
distance 1 is tensor(112.9949, device='cuda:0')
distance 2 is tensor(8.4542, device='cuda:0')
benign distance is  tensor(8.4542, device='cuda:0')
norm1 res is  tensor(0.1194, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.694046176970005
distance 1 is tensor(188.8193, device='cuda:0')
distance 2 is tensor(13.9715, device='cuda:0')
benign distance is  tensor(13.9715, device='cuda:0')
norm1 res is  tensor(0.1266, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6996681718155742
distance 1 is tensor(55.5824, device='cuda:0')
distance 2 is tensor(4.2683, device='cuda:0')
benign distance is  tensor(4.2683, device='cuda:0')
norm1 res is  tensor(0.1618, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.2245132811367512
distance 1 is tensor(156.0945, device='cuda:0')
distance 2 is tensor(11.2051, device='cuda:0')
benign distance is  tensor(11.2051, device='cuda:0')
norm1 res is  tensor(0.1563, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.406461127102375
distance 1 is tensor(147.8403, device='cuda:0')
distance 2 is tensor(10.8643, device='cuda:0')
benign distance is  tensor(10.8643, device='cuda:0')
norm1 res is  tensor(0.1432, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(354.2899, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(318.5952, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(533.6175, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(602.3433, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(366.5234, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(443.4640, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(395.8400, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(256.4692, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4666.2041, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4731.4775, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4682.7993, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4693.8159, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4675.5962, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4702.9941, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4716.6309, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4678.9243, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4706.7661, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4712.3916, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4704.4014, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4738.6309, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(646.8430, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(519.4363, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(777.7407, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(633.0995, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(572.6710, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(460.2553, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(482.2869, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(581.8719, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(497.4803, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(551.6313, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(580.2849, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(535.4921, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(283.2474, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1020.9981, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(715.8429, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(583.0172, device='cuda:0')
norm_2 is  tensor(499.3221, device='cuda:0')
norm_2 * lamda is tensor(898.7798, device='cuda:0')
satisfying 35
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 85.74% 

Test Accuracy: 88.40% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7172966431826353
distance 1 is tensor(117.0853, device='cuda:0')
distance 2 is tensor(8.5200, device='cuda:0')
benign distance is  tensor(8.5200, device='cuda:0')
norm1 res is  tensor(0.1000, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8260588888078928
distance 1 is tensor(84.1776, device='cuda:0')
distance 2 is tensor(6.3729, device='cuda:0')
benign distance is  tensor(6.3729, device='cuda:0')
norm1 res is  tensor(0.1155, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7079241387546062
distance 1 is tensor(75.5827, device='cuda:0')
distance 2 is tensor(5.7619, device='cuda:0')
benign distance is  tensor(5.7619, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.195935083553195
distance 1 is tensor(110.7704, device='cuda:0')
distance 2 is tensor(8.1553, device='cuda:0')
benign distance is  tensor(8.1553, device='cuda:0')
norm1 res is  tensor(0.0756, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9088553879410028
distance 1 is tensor(65.5719, device='cuda:0')
distance 2 is tensor(5.2097, device='cuda:0')
benign distance is  tensor(5.2097, device='cuda:0')
norm1 res is  tensor(0.0712, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6256093822885305
distance 1 is tensor(57.2796, device='cuda:0')
distance 2 is tensor(4.4152, device='cuda:0')
benign distance is  tensor(4.4152, device='cuda:0')
norm1 res is  tensor(0.0966, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4284694008529186
distance 1 is tensor(71.2797, device='cuda:0')
distance 2 is tensor(5.3435, device='cuda:0')
benign distance is  tensor(5.3435, device='cuda:0')
norm1 res is  tensor(0.0785, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6943306960165501
distance 1 is tensor(64.7570, device='cuda:0')
distance 2 is tensor(4.8590, device='cuda:0')
benign distance is  tensor(4.8590, device='cuda:0')
norm1 res is  tensor(0.1130, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.1782897301018238
distance 1 is tensor(91.5233, device='cuda:0')
distance 2 is tensor(7.2985, device='cuda:0')
benign distance is  tensor(7.2985, device='cuda:0')
norm1 res is  tensor(0.1399, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.6609350182116032
distance 1 is tensor(129.8145, device='cuda:0')
distance 2 is tensor(9.6446, device='cuda:0')
benign distance is  tensor(9.6446, device='cuda:0')
norm1 res is  tensor(0.1699, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.8186965174973011
distance 1 is tensor(140.0729, device='cuda:0')
distance 2 is tensor(10.3728, device='cuda:0')
benign distance is  tensor(10.3728, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.76888432726264
distance 1 is tensor(131.0677, device='cuda:0')
distance 2 is tensor(9.7067, device='cuda:0')
benign distance is  tensor(9.7067, device='cuda:0')
norm1 res is  tensor(0.1200, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9357072543352842
distance 1 is tensor(81.7682, device='cuda:0')
distance 2 is tensor(6.2102, device='cuda:0')
benign distance is  tensor(6.2102, device='cuda:0')
norm1 res is  tensor(0.1058, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9818644784390926
distance 1 is tensor(255.3105, device='cuda:0')
distance 2 is tensor(18.3499, device='cuda:0')
benign distance is  tensor(18.3499, device='cuda:0')
norm1 res is  tensor(0.1335, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.3138423450291157
distance 1 is tensor(133.0940, device='cuda:0')
distance 2 is tensor(9.9429, device='cuda:0')
benign distance is  tensor(9.9429, device='cuda:0')
norm1 res is  tensor(0.0890, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.9339752048254013
distance 1 is tensor(132.5337, device='cuda:0')
distance 2 is tensor(9.7318, device='cuda:0')
benign distance is  tensor(9.7318, device='cuda:0')
norm1 res is  tensor(0.1159, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7023250870406628
distance 1 is tensor(136.2311, device='cuda:0')
distance 2 is tensor(10.3664, device='cuda:0')
benign distance is  tensor(10.3664, device='cuda:0')
norm1 res is  tensor(0.1704, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.9106017425656319
distance 1 is tensor(111.2535, device='cuda:0')
distance 2 is tensor(8.3043, device='cuda:0')
benign distance is  tensor(8.3043, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.6342925485223532
distance 1 is tensor(162.3237, device='cuda:0')
distance 2 is tensor(12.0228, device='cuda:0')
benign distance is  tensor(12.0228, device='cuda:0')
norm1 res is  tensor(0.1602, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.8482336588203907
distance 1 is tensor(148.2689, device='cuda:0')
distance 2 is tensor(10.8722, device='cuda:0')
benign distance is  tensor(10.8722, device='cuda:0')
norm1 res is  tensor(0.1126, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.6238097380846739
distance 1 is tensor(109.2637, device='cuda:0')
distance 2 is tensor(8.0929, device='cuda:0')
benign distance is  tensor(8.0929, device='cuda:0')
norm1 res is  tensor(0.1152, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.9236887050792575
distance 1 is tensor(97.2188, device='cuda:0')
distance 2 is tensor(7.3139, device='cuda:0')
benign distance is  tensor(7.3139, device='cuda:0')
norm1 res is  tensor(0.1246, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.7771637961268425
distance 1 is tensor(88.9383, device='cuda:0')
distance 2 is tensor(6.7391, device='cuda:0')
benign distance is  tensor(6.7391, device='cuda:0')
norm1 res is  tensor(0.1840, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.7269457280635834
distance 1 is tensor(132.9110, device='cuda:0')
distance 2 is tensor(9.7549, device='cuda:0')
benign distance is  tensor(9.7549, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(495.0205, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(374.3933, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(336.0812, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(482.9804, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(291.2315, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(254.3965, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(295.0727, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(275.8176, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4659.9292, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4719.3066, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4665.1343, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4671.9336, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4686.6216, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4706.6709, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4694.7471, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4676.4927, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4679.9883, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4671.8657, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4681.4634, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4733.4819, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(548.3619, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(674.6000, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(626.4312, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(552.2026, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(592.2581, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(565.6851, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(607.1268, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(910.6619, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(520.2390, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(635.2175, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(363.0157, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(513.6185, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(851.8912, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(268.6011, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(704.7728, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(655.7654, device='cuda:0')
norm_2 is  tensor(443.9965, device='cuda:0')
norm_2 * lamda is tensor(799.1937, device='cuda:0')
satisfying 35
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 84.37% 

Test Accuracy: 87.90% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6670616324990988
distance 1 is tensor(90.3576, device='cuda:0')
distance 2 is tensor(6.8597, device='cuda:0')
benign distance is  tensor(6.8597, device='cuda:0')
norm1 res is  tensor(0.0767, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.664777360856533
distance 1 is tensor(63.6787, device='cuda:0')
distance 2 is tensor(4.9345, device='cuda:0')
benign distance is  tensor(4.9345, device='cuda:0')
norm1 res is  tensor(0.0925, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.687177337706089
distance 1 is tensor(103.1377, device='cuda:0')
distance 2 is tensor(7.7262, device='cuda:0')
benign distance is  tensor(7.7262, device='cuda:0')
norm1 res is  tensor(0.1955, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0450706239789724
distance 1 is tensor(123.4373, device='cuda:0')
distance 2 is tensor(9.1066, device='cuda:0')
benign distance is  tensor(9.1066, device='cuda:0')
norm1 res is  tensor(0.0859, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.069006610661745
distance 1 is tensor(69.6081, device='cuda:0')
distance 2 is tensor(5.3054, device='cuda:0')
benign distance is  tensor(5.3054, device='cuda:0')
norm1 res is  tensor(0.0721, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7814523519482464
distance 1 is tensor(84.3282, device='cuda:0')
distance 2 is tensor(6.1179, device='cuda:0')
benign distance is  tensor(6.1179, device='cuda:0')
norm1 res is  tensor(0.1369, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2124746199697256
distance 1 is tensor(68.1124, device='cuda:0')
distance 2 is tensor(5.3770, device='cuda:0')
benign distance is  tensor(5.3770, device='cuda:0')
norm1 res is  tensor(0.0810, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5277062645182014
distance 1 is tensor(71.4612, device='cuda:0')
distance 2 is tensor(5.4793, device='cuda:0')
benign distance is  tensor(5.4793, device='cuda:0')
norm1 res is  tensor(0.1194, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.8590116957202554
distance 1 is tensor(105.6973, device='cuda:0')
distance 2 is tensor(7.8791, device='cuda:0')
benign distance is  tensor(7.8791, device='cuda:0')
norm1 res is  tensor(0.1207, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8163754451088607
distance 1 is tensor(156.7240, device='cuda:0')
distance 2 is tensor(11.4527, device='cuda:0')
benign distance is  tensor(11.4527, device='cuda:0')
norm1 res is  tensor(0.1714, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9591035470366478
distance 1 is tensor(54.6507, device='cuda:0')
distance 2 is tensor(4.3011, device='cuda:0')
benign distance is  tensor(4.3011, device='cuda:0')
norm1 res is  tensor(0.0730, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.2105262950062752
distance 1 is tensor(109.9108, device='cuda:0')
distance 2 is tensor(8.2147, device='cuda:0')
benign distance is  tensor(8.2147, device='cuda:0')
norm1 res is  tensor(0.1130, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.1871729865670204
distance 1 is tensor(199.5185, device='cuda:0')
distance 2 is tensor(14.2954, device='cuda:0')
benign distance is  tensor(14.2954, device='cuda:0')
norm1 res is  tensor(0.1279, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6212785160169005
distance 1 is tensor(46.1212, device='cuda:0')
distance 2 is tensor(3.5080, device='cuda:0')
benign distance is  tensor(3.5080, device='cuda:0')
norm1 res is  tensor(0.1206, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.7511106850579381
distance 1 is tensor(149.7860, device='cuda:0')
distance 2 is tensor(10.9224, device='cuda:0')
benign distance is  tensor(10.9224, device='cuda:0')
norm1 res is  tensor(0.1471, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.6290962807834148
distance 1 is tensor(120.2441, device='cuda:0')
distance 2 is tensor(9.0222, device='cuda:0')
benign distance is  tensor(9.0222, device='cuda:0')
norm1 res is  tensor(0.1161, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.3209566865116358
distance 1 is tensor(130.6485, device='cuda:0')
distance 2 is tensor(9.7174, device='cuda:0')
benign distance is  tensor(9.7174, device='cuda:0')
norm1 res is  tensor(0.1425, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.8748453631997108
distance 1 is tensor(99.4777, device='cuda:0')
distance 2 is tensor(7.5465, device='cuda:0')
benign distance is  tensor(7.5465, device='cuda:0')
norm1 res is  tensor(0.2811, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.130068002268672
distance 1 is tensor(130.5605, device='cuda:0')
distance 2 is tensor(9.7244, device='cuda:0')
benign distance is  tensor(9.7244, device='cuda:0')
norm1 res is  tensor(0.1154, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.3831807412207127
distance 1 is tensor(135.3326, device='cuda:0')
distance 2 is tensor(10.0686, device='cuda:0')
benign distance is  tensor(10.0686, device='cuda:0')
norm1 res is  tensor(0.1527, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.9991836082190275
distance 1 is tensor(139.7995, device='cuda:0')
distance 2 is tensor(10.2522, device='cuda:0')
benign distance is  tensor(10.2522, device='cuda:0')
norm1 res is  tensor(0.1565, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8386580888181925
distance 1 is tensor(123.9189, device='cuda:0')
distance 2 is tensor(9.2712, device='cuda:0')
benign distance is  tensor(9.2712, device='cuda:0')
norm1 res is  tensor(0.1336, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5703968368470669
distance 1 is tensor(128.7864, device='cuda:0')
distance 2 is tensor(9.3459, device='cuda:0')
benign distance is  tensor(9.3459, device='cuda:0')
norm1 res is  tensor(0.1439, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.9652245435863733
distance 1 is tensor(194.1387, device='cuda:0')
distance 2 is tensor(14.2174, device='cuda:0')
benign distance is  tensor(14.2174, device='cuda:0')
norm1 res is  tensor(0.1744, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(403.0308, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(291.3995, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(451.2007, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(537.9861, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(297.0413, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(360.7746, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(306.7894, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(319.1426, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4670.6016, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4738.2930, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4691.5015, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4692.2954, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4685.0601, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4710.2373, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4708.8574, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4688.2227, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4704.1665, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4683.3242, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4703.3921, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4749.1655, device='cuda:0')
norm_2 is  tensor(421.6689, device='cuda:0')
norm_2 * lamda is tensor(759.0040, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 87.25% 

Test Accuracy: 88.72% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6839023735374212
distance 1 is tensor(82.0172, device='cuda:0')
distance 2 is tensor(6.2993, device='cuda:0')
benign distance is  tensor(6.2993, device='cuda:0')
norm1 res is  tensor(0.0707, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6923360396176577
distance 1 is tensor(68.1248, device='cuda:0')
distance 2 is tensor(5.2917, device='cuda:0')
benign distance is  tensor(5.2917, device='cuda:0')
norm1 res is  tensor(0.0992, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.750281261280179
distance 1 is tensor(132.0597, device='cuda:0')
distance 2 is tensor(9.5562, device='cuda:0')
benign distance is  tensor(9.5562, device='cuda:0')
norm1 res is  tensor(0.2482, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1056187618523836
distance 1 is tensor(133.1814, device='cuda:0')
distance 2 is tensor(9.5929, device='cuda:0')
benign distance is  tensor(9.5929, device='cuda:0')
norm1 res is  tensor(0.0915, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7678170781582594
distance 1 is tensor(54.1396, device='cuda:0')
distance 2 is tensor(4.3617, device='cuda:0')
benign distance is  tensor(4.3617, device='cuda:0')
norm1 res is  tensor(0.0594, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7267843647859991
distance 1 is tensor(65.7955, device='cuda:0')
distance 2 is tensor(4.9158, device='cuda:0')
benign distance is  tensor(4.9158, device='cuda:0')
norm1 res is  tensor(0.1090, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4011867512017488
distance 1 is tensor(69.3937, device='cuda:0')
distance 2 is tensor(5.3266, device='cuda:0')
benign distance is  tensor(5.3266, device='cuda:0')
norm1 res is  tensor(0.0834, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.785715876147151
distance 1 is tensor(74.7038, device='cuda:0')
distance 2 is tensor(5.6465, device='cuda:0')
benign distance is  tensor(5.6465, device='cuda:0')
norm1 res is  tensor(0.1183, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(370.0747, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(307.7345, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(569.0906, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(572.3981, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(245.3475, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(282.6170, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(301.9821, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(323.6912, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4703.2471, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4758.9268, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4709.9312, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4716.3525, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4716.2144, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4735.1870, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4744.9604, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4716.7944, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4738.6470, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4708.8813, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4732.0308, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4763.0903, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(572.6555, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(899.4091, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(829.9345, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(491.5952, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(876.1130, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(706.5769, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(553.3564, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(682.9906, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(442.6424, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(604.5269, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(633.0904, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(588.8028, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(383.1702, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1090.7844, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(609.0328, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(599.1783, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(479.2622, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(708.4268, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(260.6853, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(497.5459, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(867.9711, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(219.4778, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(666.8611, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(538.9301, device='cuda:0')
norm_2 is  tensor(407.5510, device='cuda:0')
norm_2 * lamda is tensor(733.5917, device='cuda:0')
satisfying 43
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 86.15% 

Test Accuracy: 88.57% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8090839087963104
distance 1 is tensor(105.1529, device='cuda:0')
distance 2 is tensor(7.9223, device='cuda:0')
benign distance is  tensor(7.9223, device='cuda:0')
norm1 res is  tensor(0.0881, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8483375981450081
distance 1 is tensor(85.0379, device='cuda:0')
distance 2 is tensor(6.4344, device='cuda:0')
benign distance is  tensor(6.4344, device='cuda:0')
norm1 res is  tensor(0.1140, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9232193063944578
distance 1 is tensor(98.4558, device='cuda:0')
distance 2 is tensor(7.3138, device='cuda:0')
benign distance is  tensor(7.3138, device='cuda:0')
norm1 res is  tensor(0.1780, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.197337744757533
distance 1 is tensor(149.1307, device='cuda:0')
distance 2 is tensor(10.9428, device='cuda:0')
benign distance is  tensor(10.9428, device='cuda:0')
norm1 res is  tensor(0.1044, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7457418739795685
distance 1 is tensor(51.5326, device='cuda:0')
distance 2 is tensor(4.0552, device='cuda:0')
benign distance is  tensor(4.0552, device='cuda:0')
norm1 res is  tensor(0.0541, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6336358673870564
distance 1 is tensor(66.8937, device='cuda:0')
distance 2 is tensor(5.0995, device='cuda:0')
benign distance is  tensor(5.0995, device='cuda:0')
norm1 res is  tensor(0.1144, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4141156189143658
distance 1 is tensor(73.9551, device='cuda:0')
distance 2 is tensor(5.7712, device='cuda:0')
benign distance is  tensor(5.7712, device='cuda:0')
norm1 res is  tensor(0.0875, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6671410705894232
distance 1 is tensor(80.2599, device='cuda:0')
distance 2 is tensor(6.0352, device='cuda:0')
benign distance is  tensor(6.0352, device='cuda:0')
norm1 res is  tensor(0.1297, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.210184495896101
distance 1 is tensor(112.9719, device='cuda:0')
distance 2 is tensor(8.2038, device='cuda:0')
benign distance is  tensor(8.2038, device='cuda:0')
norm1 res is  tensor(0.1246, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.963743207976222
distance 1 is tensor(151.2633, device='cuda:0')
distance 2 is tensor(11.0007, device='cuda:0')
benign distance is  tensor(11.0007, device='cuda:0')
norm1 res is  tensor(0.1691, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.926738016307354
distance 1 is tensor(59.1383, device='cuda:0')
distance 2 is tensor(4.7093, device='cuda:0')
benign distance is  tensor(4.7093, device='cuda:0')
norm1 res is  tensor(0.0812, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.4340184889733791
distance 1 is tensor(121.7470, device='cuda:0')
distance 2 is tensor(9.1966, device='cuda:0')
benign distance is  tensor(9.1966, device='cuda:0')
norm1 res is  tensor(0.1248, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.0125829316675663
distance 1 is tensor(192.3736, device='cuda:0')
distance 2 is tensor(13.7523, device='cuda:0')
benign distance is  tensor(13.7523, device='cuda:0')
norm1 res is  tensor(0.1239, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6043846243992448
distance 1 is tensor(61.3266, device='cuda:0')
distance 2 is tensor(4.6096, device='cuda:0')
benign distance is  tensor(4.6096, device='cuda:0')
norm1 res is  tensor(0.1620, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.4018138870596886
distance 1 is tensor(145.1544, device='cuda:0')
distance 2 is tensor(10.5823, device='cuda:0')
benign distance is  tensor(10.5823, device='cuda:0')
norm1 res is  tensor(0.1438, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.4552507176995277
distance 1 is tensor(141.3211, device='cuda:0')
distance 2 is tensor(10.3628, device='cuda:0')
benign distance is  tensor(10.3628, device='cuda:0')
norm1 res is  tensor(0.1339, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.563486009836197
distance 1 is tensor(125.5213, device='cuda:0')
distance 2 is tensor(9.6494, device='cuda:0')
benign distance is  tensor(9.6494, device='cuda:0')
norm1 res is  tensor(0.1958, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9180281180888414
distance 1 is tensor(121.2258, device='cuda:0')
distance 2 is tensor(8.8625, device='cuda:0')
benign distance is  tensor(8.8625, device='cuda:0')
norm1 res is  tensor(0.1543, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.3951351828873158
distance 1 is tensor(135.3099, device='cuda:0')
distance 2 is tensor(9.8385, device='cuda:0')
benign distance is  tensor(9.8385, device='cuda:0')
norm1 res is  tensor(0.1386, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9979635663330555
distance 1 is tensor(125.8166, device='cuda:0')
distance 2 is tensor(9.4491, device='cuda:0')
benign distance is  tensor(9.4491, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9287485312670469
distance 1 is tensor(85.0881, device='cuda:0')
distance 2 is tensor(6.2575, device='cuda:0')
benign distance is  tensor(6.2575, device='cuda:0')
norm1 res is  tensor(0.1069, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.7568211760371923
distance 1 is tensor(245.7245, device='cuda:0')
distance 2 is tensor(17.7491, device='cuda:0')
benign distance is  tensor(17.7491, device='cuda:0')
norm1 res is  tensor(0.1308, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.0178841948509216
distance 1 is tensor(151.8391, device='cuda:0')
distance 2 is tensor(11.2055, device='cuda:0')
benign distance is  tensor(11.2055, device='cuda:0')
norm1 res is  tensor(0.0995, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.932077718898654
distance 1 is tensor(126.6203, device='cuda:0')
distance 2 is tensor(9.3918, device='cuda:0')
benign distance is  tensor(9.3918, device='cuda:0')
norm1 res is  tensor(0.1106, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.4971002712845802
distance 1 is tensor(140.6372, device='cuda:0')
distance 2 is tensor(10.7268, device='cuda:0')
benign distance is  tensor(10.7268, device='cuda:0')
norm1 res is  tensor(0.1488, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.373237308114767
distance 1 is tensor(161.0692, device='cuda:0')
distance 2 is tensor(12.0682, device='cuda:0')
benign distance is  tensor(12.0682, device='cuda:0')
norm1 res is  tensor(0.1615, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.2061378099024296
distance 1 is tensor(177.1660, device='cuda:0')
distance 2 is tensor(12.8689, device='cuda:0')
benign distance is  tensor(12.8689, device='cuda:0')
norm1 res is  tensor(0.1209, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  1.185410264879465
distance 1 is tensor(112.7676, device='cuda:0')
distance 2 is tensor(8.6896, device='cuda:0')
benign distance is  tensor(8.6896, device='cuda:0')
norm1 res is  tensor(0.2638, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.976275134831667
distance 1 is tensor(192.5196, device='cuda:0')
distance 2 is tensor(14.1924, device='cuda:0')
benign distance is  tensor(14.1924, device='cuda:0')
norm1 res is  tensor(0.1851, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.9708530381321907
distance 1 is tensor(161.7251, device='cuda:0')
distance 2 is tensor(11.7560, device='cuda:0')
benign distance is  tensor(11.7560, device='cuda:0')
norm1 res is  tensor(0.1953, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.7041398007422686
distance 1 is tensor(119.8190, device='cuda:0')
distance 2 is tensor(8.8782, device='cuda:0')
benign distance is  tensor(8.8782, device='cuda:0')
norm1 res is  tensor(0.1678, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5387759194709361
distance 1 is tensor(146.2593, device='cuda:0')
distance 2 is tensor(10.6488, device='cuda:0')
benign distance is  tensor(10.6488, device='cuda:0')
norm1 res is  tensor(0.1626, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(465.7699, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(371.0574, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(418.6455, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(664.6515, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(223.2794, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(293.9666, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(330.9776, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(350.6342, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4691.8877, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4753.6582, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4715.3423, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4698.5264, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4705.2046, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4718.3901, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4719.5830, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4707.2944, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4714.2412, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4700.1436, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4711.7939, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4762.5210, device='cuda:0')
norm_2 is  tensor(392.3432, device='cuda:0')
norm_2 * lamda is tensor(706.2177, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 86.79% 

Test Accuracy: 88.64% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8587624505162239
distance 1 is tensor(99.8954, device='cuda:0')
distance 2 is tensor(7.3557, device='cuda:0')
benign distance is  tensor(7.3557, device='cuda:0')
norm1 res is  tensor(0.0825, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8310240246355534
distance 1 is tensor(103.2959, device='cuda:0')
distance 2 is tensor(7.6196, device='cuda:0')
benign distance is  tensor(7.6196, device='cuda:0')
norm1 res is  tensor(0.1391, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8600447829812765
distance 1 is tensor(83.1542, device='cuda:0')
distance 2 is tensor(6.2388, device='cuda:0')
benign distance is  tensor(6.2388, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.4342642351984978
distance 1 is tensor(148.0549, device='cuda:0')
distance 2 is tensor(10.7859, device='cuda:0')
benign distance is  tensor(10.7859, device='cuda:0')
norm1 res is  tensor(0.1061, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.2560697700828314
distance 1 is tensor(95.2062, device='cuda:0')
distance 2 is tensor(7.0366, device='cuda:0')
benign distance is  tensor(7.0366, device='cuda:0')
norm1 res is  tensor(0.0976, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6815097378566861
distance 1 is tensor(75.6452, device='cuda:0')
distance 2 is tensor(5.5588, device='cuda:0')
benign distance is  tensor(5.5588, device='cuda:0')
norm1 res is  tensor(0.1264, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1898763552308083
distance 1 is tensor(46.5727, device='cuda:0')
distance 2 is tensor(3.7043, device='cuda:0')
benign distance is  tensor(3.7043, device='cuda:0')
norm1 res is  tensor(0.0546, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8629255555570126
distance 1 is tensor(69.6364, device='cuda:0')
distance 2 is tensor(5.2083, device='cuda:0')
benign distance is  tensor(5.2083, device='cuda:0')
norm1 res is  tensor(0.1062, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(434.7976, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(455.4702, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(370.0121, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(652.8173, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(404.0384, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(320.7963, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(203.7876, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(289.8840, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4725.0469, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4771.6387, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4730.0298, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4727.6084, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4740.7109, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4756.5996, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4764.3442, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4742.1440, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4758.0439, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4738.1362, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4740.0488, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4792.3345, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(643.8801, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(509.2978, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(743.2666, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(678.0438, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(486.4760, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(465.6062, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(434.4660, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(599.7064, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(590.1301, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(467.5181, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(603.9327, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(610.3651, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(633.4221, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(584.9744, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(575.9230, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(866.0674, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(502.5970, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(668.9942, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(285.6716, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(550.0849, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(838.9168, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(286.6506, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(653.7456, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(613.4291, device='cuda:0')
norm_2 is  tensor(434.9353, device='cuda:0')
norm_2 * lamda is tensor(782.8836, device='cuda:0')
satisfying 43
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 86.36% 

Test Accuracy: 88.36% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6839042482897639
distance 1 is tensor(98.6409, device='cuda:0')
distance 2 is tensor(7.3510, device='cuda:0')
benign distance is  tensor(7.3510, device='cuda:0')
norm1 res is  tensor(0.0821, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5822508735582232
distance 1 is tensor(79.4263, device='cuda:0')
distance 2 is tensor(6.0154, device='cuda:0')
benign distance is  tensor(6.0154, device='cuda:0')
norm1 res is  tensor(0.1121, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6650274153798819
distance 1 is tensor(105.8561, device='cuda:0')
distance 2 is tensor(7.9673, device='cuda:0')
benign distance is  tensor(7.9673, device='cuda:0')
norm1 res is  tensor(0.1993, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1788179874420166
distance 1 is tensor(132.2553, device='cuda:0')
distance 2 is tensor(9.6409, device='cuda:0')
benign distance is  tensor(9.6409, device='cuda:0')
norm1 res is  tensor(0.0895, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7006096164695919
distance 1 is tensor(54.7513, device='cuda:0')
distance 2 is tensor(4.4181, device='cuda:0')
benign distance is  tensor(4.4181, device='cuda:0')
norm1 res is  tensor(0.0594, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8555774195119739
distance 1 is tensor(74.1990, device='cuda:0')
distance 2 is tensor(5.5680, device='cuda:0')
benign distance is  tensor(5.5680, device='cuda:0')
norm1 res is  tensor(0.1252, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.177632812410593
distance 1 is tensor(67.5738, device='cuda:0')
distance 2 is tensor(5.2023, device='cuda:0')
benign distance is  tensor(5.2023, device='cuda:0')
norm1 res is  tensor(0.0825, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5820880755782127
distance 1 is tensor(67.3594, device='cuda:0')
distance 2 is tensor(5.0621, device='cuda:0')
benign distance is  tensor(5.0621, device='cuda:0')
norm1 res is  tensor(0.1083, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.611554391682148
distance 1 is tensor(104.2869, device='cuda:0')
distance 2 is tensor(7.6605, device='cuda:0')
benign distance is  tensor(7.6605, device='cuda:0')
norm1 res is  tensor(0.1141, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.086058845743537
distance 1 is tensor(121.5816, device='cuda:0')
distance 2 is tensor(8.9546, device='cuda:0')
benign distance is  tensor(8.9546, device='cuda:0')
norm1 res is  tensor(0.1291, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.8805772475898266
distance 1 is tensor(58.9341, device='cuda:0')
distance 2 is tensor(4.6331, device='cuda:0')
benign distance is  tensor(4.6331, device='cuda:0')
norm1 res is  tensor(0.0818, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  0.8494366984814405
distance 1 is tensor(116.1170, device='cuda:0')
distance 2 is tensor(8.6280, device='cuda:0')
benign distance is  tensor(8.6280, device='cuda:0')
norm1 res is  tensor(0.1173, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.189065646380186
distance 1 is tensor(200.3520, device='cuda:0')
distance 2 is tensor(14.3009, device='cuda:0')
benign distance is  tensor(14.3009, device='cuda:0')
norm1 res is  tensor(0.1310, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6894128993153572
distance 1 is tensor(62.2514, device='cuda:0')
distance 2 is tensor(4.6750, device='cuda:0')
benign distance is  tensor(4.6750, device='cuda:0')
norm1 res is  tensor(0.1660, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.9767848122864962
distance 1 is tensor(152.9128, device='cuda:0')
distance 2 is tensor(11.1342, device='cuda:0')
benign distance is  tensor(11.1342, device='cuda:0')
norm1 res is  tensor(0.1517, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.4807116724550724
distance 1 is tensor(132.1596, device='cuda:0')
distance 2 is tensor(9.9554, device='cuda:0')
benign distance is  tensor(9.9554, device='cuda:0')
norm1 res is  tensor(0.1306, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.8700800240039825
distance 1 is tensor(124.5005, device='cuda:0')
distance 2 is tensor(9.1725, device='cuda:0')
benign distance is  tensor(9.1725, device='cuda:0')
norm1 res is  tensor(0.1394, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.5780741106718779
distance 1 is tensor(79.4674, device='cuda:0')
distance 2 is tensor(6.0319, device='cuda:0')
benign distance is  tensor(6.0319, device='cuda:0')
norm1 res is  tensor(0.2252, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.191717877984047
distance 1 is tensor(163.0042, device='cuda:0')
distance 2 is tensor(11.9195, device='cuda:0')
benign distance is  tensor(11.9195, device='cuda:0')
norm1 res is  tensor(0.1420, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.2500125132501125
distance 1 is tensor(127.2264, device='cuda:0')
distance 2 is tensor(9.5684, device='cuda:0')
benign distance is  tensor(9.5684, device='cuda:0')
norm1 res is  tensor(0.1443, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.7568902354687452
distance 1 is tensor(135.7564, device='cuda:0')
distance 2 is tensor(9.9859, device='cuda:0')
benign distance is  tensor(9.9859, device='cuda:0')
norm1 res is  tensor(0.1515, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.7712452057749033
distance 1 is tensor(114.4753, device='cuda:0')
distance 2 is tensor(8.5574, device='cuda:0')
benign distance is  tensor(8.5574, device='cuda:0')
norm1 res is  tensor(0.1234, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.47968515381217003
distance 1 is tensor(120.0828, device='cuda:0')
distance 2 is tensor(8.7941, device='cuda:0')
benign distance is  tensor(8.7941, device='cuda:0')
norm1 res is  tensor(0.1334, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.8300763051956892
distance 1 is tensor(217.7968, device='cuda:0')
distance 2 is tensor(15.8304, device='cuda:0')
benign distance is  tensor(15.8304, device='cuda:0')
norm1 res is  tensor(0.1917, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.6882248660549521
distance 1 is tensor(136.8805, device='cuda:0')
distance 2 is tensor(10.2199, device='cuda:0')
benign distance is  tensor(10.2199, device='cuda:0')
norm1 res is  tensor(0.1693, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.0989596024155617
distance 1 is tensor(99.6014, device='cuda:0')
distance 2 is tensor(7.3644, device='cuda:0')
benign distance is  tensor(7.3644, device='cuda:0')
norm1 res is  tensor(0.1366, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.7098906058818102
distance 1 is tensor(180.0835, device='cuda:0')
distance 2 is tensor(13.2533, device='cuda:0')
benign distance is  tensor(13.2533, device='cuda:0')
norm1 res is  tensor(0.1770, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.8429282531142235
distance 1 is tensor(151.1938, device='cuda:0')
distance 2 is tensor(11.0102, device='cuda:0')
benign distance is  tensor(11.0102, device='cuda:0')
norm1 res is  tensor(0.1129, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.659973157569766
distance 1 is tensor(115.4155, device='cuda:0')
distance 2 is tensor(8.6177, device='cuda:0')
benign distance is  tensor(8.6177, device='cuda:0')
norm1 res is  tensor(0.1214, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.748865244910121
distance 1 is tensor(99.3161, device='cuda:0')
distance 2 is tensor(7.4061, device='cuda:0')
benign distance is  tensor(7.4061, device='cuda:0')
norm1 res is  tensor(0.1247, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.9099596068263054
distance 1 is tensor(101.1088, device='cuda:0')
distance 2 is tensor(7.4252, device='cuda:0')
benign distance is  tensor(7.4252, device='cuda:0')
norm1 res is  tensor(0.2018, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.5680094575509429
distance 1 is tensor(145.3429, device='cuda:0')
distance 2 is tensor(10.7561, device='cuda:0')
benign distance is  tensor(10.7561, device='cuda:0')
norm1 res is  tensor(0.1770, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(426.4545, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(351.6012, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(473.0835, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(567.3748, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(243.2445, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(319.0295, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(301.5015, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(294.4575, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4705.6572, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4762.5205, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4724.2505, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4719.9971, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4726.1699, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4745.2100, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4738.7363, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4723.0874, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4731.4575, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4720.0073, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4728.6313, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4777.6460, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(575.5912, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(536.9114, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(583.7258, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(575.3675, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(364.8268, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1055.9712, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(669.5737, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(561.5432, device='cuda:0')
norm_2 is  tensor(448.2495, device='cuda:0')
norm_2 * lamda is tensor(806.8491, device='cuda:0')
satisfying 27
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 85.31% 

Test Accuracy: 88.23% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7200553007423878
distance 1 is tensor(77.2982, device='cuda:0')
distance 2 is tensor(5.8965, device='cuda:0')
benign distance is  tensor(5.8965, device='cuda:0')
norm1 res is  tensor(0.0647, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7343645840883255
distance 1 is tensor(79.6792, device='cuda:0')
distance 2 is tensor(5.9401, device='cuda:0')
benign distance is  tensor(5.9401, device='cuda:0')
norm1 res is  tensor(0.1111, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8526742942631245
distance 1 is tensor(93.5258, device='cuda:0')
distance 2 is tensor(7.0174, device='cuda:0')
benign distance is  tensor(7.0174, device='cuda:0')
norm1 res is  tensor(0.1762, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1659509241580963
distance 1 is tensor(112.9998, device='cuda:0')
distance 2 is tensor(8.3513, device='cuda:0')
benign distance is  tensor(8.3513, device='cuda:0')
norm1 res is  tensor(0.0780, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8750489773228765
distance 1 is tensor(70.5502, device='cuda:0')
distance 2 is tensor(5.4367, device='cuda:0')
benign distance is  tensor(5.4367, device='cuda:0')
norm1 res is  tensor(0.0771, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7605485196691006
distance 1 is tensor(56.7891, device='cuda:0')
distance 2 is tensor(4.3191, device='cuda:0')
benign distance is  tensor(4.3191, device='cuda:0')
norm1 res is  tensor(0.0974, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.3205055892467499
distance 1 is tensor(61.9157, device='cuda:0')
distance 2 is tensor(4.6835, device='cuda:0')
benign distance is  tensor(4.6835, device='cuda:0')
norm1 res is  tensor(0.0706, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6621638862416148
distance 1 is tensor(71.8655, device='cuda:0')
distance 2 is tensor(5.4911, device='cuda:0')
benign distance is  tensor(5.4911, device='cuda:0')
norm1 res is  tensor(0.1150, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.0995879657566547
distance 1 is tensor(133.6252, device='cuda:0')
distance 2 is tensor(10.1587, device='cuda:0')
benign distance is  tensor(10.1587, device='cuda:0')
norm1 res is  tensor(0.1980, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7757700122892857
distance 1 is tensor(119.7119, device='cuda:0')
distance 2 is tensor(8.8657, device='cuda:0')
benign distance is  tensor(8.8657, device='cuda:0')
norm1 res is  tensor(0.1551, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.357677835971117
distance 1 is tensor(133.0249, device='cuda:0')
distance 2 is tensor(9.8036, device='cuda:0')
benign distance is  tensor(9.8036, device='cuda:0')
norm1 res is  tensor(0.1346, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.8796639572829008
distance 1 is tensor(132.7216, device='cuda:0')
distance 2 is tensor(9.9349, device='cuda:0')
benign distance is  tensor(9.9349, device='cuda:0')
norm1 res is  tensor(0.1225, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.8582043536007404
distance 1 is tensor(71.9938, device='cuda:0')
distance 2 is tensor(5.4367, device='cuda:0')
benign distance is  tensor(5.4367, device='cuda:0')
norm1 res is  tensor(0.0936, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.799735214561224
distance 1 is tensor(237.4717, device='cuda:0')
distance 2 is tensor(17.1645, device='cuda:0')
benign distance is  tensor(17.1645, device='cuda:0')
norm1 res is  tensor(0.1260, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.4923009313642979
distance 1 is tensor(178.9663, device='cuda:0')
distance 2 is tensor(13.2200, device='cuda:0')
benign distance is  tensor(13.2200, device='cuda:0')
norm1 res is  tensor(0.1170, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.7516466286033392
distance 1 is tensor(101.8987, device='cuda:0')
distance 2 is tensor(7.6533, device='cuda:0')
benign distance is  tensor(7.6533, device='cuda:0')
norm1 res is  tensor(0.0904, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(339.7122, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(356.1439, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(413.6432, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(493.5441, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(310.0941, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(250.0067, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(261.3135, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(314.6833, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4732.0259, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4788.0835, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4751.8496, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4735.1230, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4738.0303, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4762.9053, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4763.0654, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4741.6050, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4767.3325, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4739.9126, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4749.3633, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4795.1895, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(461.4216, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(543.6696, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(281.5246, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(508.9435, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(881.4152, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(283.2842, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(685.8289, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(600.0351, device='cuda:0')
norm_2 is  tensor(348.9388, device='cuda:0')
norm_2 * lamda is tensor(628.0898, device='cuda:0')
satisfying 27
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 84.89% 

Test Accuracy: 88.06% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8242893647402525
distance 1 is tensor(95.8247, device='cuda:0')
distance 2 is tensor(7.1663, device='cuda:0')
benign distance is  tensor(7.1663, device='cuda:0')
norm1 res is  tensor(0.0811, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.83680041693151
distance 1 is tensor(114.1019, device='cuda:0')
distance 2 is tensor(8.3377, device='cuda:0')
benign distance is  tensor(8.3377, device='cuda:0')
norm1 res is  tensor(0.1523, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7045839503407478
distance 1 is tensor(104.7472, device='cuda:0')
distance 2 is tensor(7.7391, device='cuda:0')
benign distance is  tensor(7.7391, device='cuda:0')
norm1 res is  tensor(0.2001, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0421321839094162
distance 1 is tensor(96.3539, device='cuda:0')
distance 2 is tensor(7.2453, device='cuda:0')
benign distance is  tensor(7.2453, device='cuda:0')
norm1 res is  tensor(0.0681, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9974812166765332
distance 1 is tensor(60.4361, device='cuda:0')
distance 2 is tensor(4.7800, device='cuda:0')
benign distance is  tensor(4.7800, device='cuda:0')
norm1 res is  tensor(0.0637, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.721341306809336
distance 1 is tensor(74.2119, device='cuda:0')
distance 2 is tensor(5.5485, device='cuda:0')
benign distance is  tensor(5.5485, device='cuda:0')
norm1 res is  tensor(0.1306, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2191794645041227
distance 1 is tensor(82.4528, device='cuda:0')
distance 2 is tensor(6.2838, device='cuda:0')
benign distance is  tensor(6.2838, device='cuda:0')
norm1 res is  tensor(0.0985, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.679635570384562
distance 1 is tensor(71.5424, device='cuda:0')
distance 2 is tensor(5.3771, device='cuda:0')
benign distance is  tensor(5.3771, device='cuda:0')
norm1 res is  tensor(0.1122, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.1522695198655128
distance 1 is tensor(112.1195, device='cuda:0')
distance 2 is tensor(8.1281, device='cuda:0')
benign distance is  tensor(8.1281, device='cuda:0')
norm1 res is  tensor(0.1222, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.1494844499975443
distance 1 is tensor(144.3521, device='cuda:0')
distance 2 is tensor(10.5495, device='cuda:0')
benign distance is  tensor(10.5495, device='cuda:0')
norm1 res is  tensor(0.1512, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.1403402481228113
distance 1 is tensor(59.8435, device='cuda:0')
distance 2 is tensor(4.7917, device='cuda:0')
benign distance is  tensor(4.7917, device='cuda:0')
norm1 res is  tensor(0.0844, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.113328892737627
distance 1 is tensor(132.3102, device='cuda:0')
distance 2 is tensor(9.8120, device='cuda:0')
benign distance is  tensor(9.8120, device='cuda:0')
norm1 res is  tensor(0.1355, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.277264753356576
distance 1 is tensor(193.8273, device='cuda:0')
distance 2 is tensor(13.7906, device='cuda:0')
benign distance is  tensor(13.7906, device='cuda:0')
norm1 res is  tensor(0.1244, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7598654720932245
distance 1 is tensor(49.6939, device='cuda:0')
distance 2 is tensor(3.8489, device='cuda:0')
benign distance is  tensor(3.8489, device='cuda:0')
norm1 res is  tensor(0.1382, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.252668958157301
distance 1 is tensor(141.5263, device='cuda:0')
distance 2 is tensor(10.4203, device='cuda:0')
benign distance is  tensor(10.4203, device='cuda:0')
norm1 res is  tensor(0.1412, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.6057274900376797
distance 1 is tensor(152.8295, device='cuda:0')
distance 2 is tensor(11.0763, device='cuda:0')
benign distance is  tensor(11.0763, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(428.4374, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(492.0243, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(462.8952, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(428.2642, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(262.2406, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(318.9492, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(365.1115, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(307.4865, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4742.1401, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4797.7739, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4769.5215, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4762.9243, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4754.2915, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4774.9980, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4772.7114, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4757.6909, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4789.4683, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4749.4448, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4772.4282, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4802.1152, device='cuda:0')
norm_2 is  tensor(415.0324, device='cuda:0')
norm_2 * lamda is tensor(747.0583, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 87.38% 

Test Accuracy: 88.57% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
 benign loss is  0.9311200361698866
distance 1 is tensor(120.3336, device='cuda:0')
distance 2 is tensor(9.0444, device='cuda:0')
benign distance is  tensor(9.0444, device='cuda:0')
norm1 res is  tensor(0.1038, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9355500601232052
distance 1 is tensor(66.6630, device='cuda:0')
distance 2 is tensor(5.0720, device='cuda:0')
benign distance is  tensor(5.0720, device='cuda:0')
norm1 res is  tensor(0.0982, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8173536062240601
distance 1 is tensor(81.3423, device='cuda:0')
distance 2 is tensor(6.0826, device='cuda:0')
benign distance is  tensor(6.0826, device='cuda:0')
norm1 res is  tensor(0.1522, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.288609903305769
distance 1 is tensor(148.5370, device='cuda:0')
distance 2 is tensor(10.8266, device='cuda:0')
benign distance is  tensor(10.8266, device='cuda:0')
norm1 res is  tensor(0.1042, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.3751868233084679
distance 1 is tensor(101.2955, device='cuda:0')
distance 2 is tensor(7.4826, device='cuda:0')
benign distance is  tensor(7.4826, device='cuda:0')
norm1 res is  tensor(0.1042, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7990489923395216
distance 1 is tensor(98.9794, device='cuda:0')
distance 2 is tensor(7.2798, device='cuda:0')
benign distance is  tensor(7.2798, device='cuda:0')
norm1 res is  tensor(0.1753, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.244654681533575
distance 1 is tensor(101.5832, device='cuda:0')
distance 2 is tensor(7.4890, device='cuda:0')
benign distance is  tensor(7.4890, device='cuda:0')
norm1 res is  tensor(0.1162, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6008463306352496
distance 1 is tensor(56.2167, device='cuda:0')
distance 2 is tensor(4.3398, device='cuda:0')
benign distance is  tensor(4.3398, device='cuda:0')
norm1 res is  tensor(0.0927, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(543.5847, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(291.9789, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(353.8169, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(652.9801, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(423.6848, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(422.8436, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(433.7729, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(252.7760, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4769.4048, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4836.9834, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4788.7241, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4788.3711, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4787.7480, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4803.7148, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4815.0869, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4792.8345, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4810.6621, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4781.7354, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4791.5586, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4849.1499, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(652.5583, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(736.9805, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(771.7869, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(527.4391, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(872.2221, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(725.6177, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(558.5657, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(652.3843, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(572.7344, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(389.7514, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(735.1824, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(583.6071, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(618.5164, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(540.4649, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(538.8657, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(949.7054, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(607.8218, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(553.7519, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(599.0337, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(605.5693, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(339.7238, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1029.4911, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(797.5099, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(476.6959, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(486.2228, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(632.3510, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(296.0926, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(591.9769, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(843.9802, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(245.2396, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(640.6736, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(677.6985, device='cuda:0')
norm_2 is  tensor(307.5307, device='cuda:0')
norm_2 * lamda is tensor(553.5552, device='cuda:0')
do  not satisfying 51
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 86.66% 

Test Accuracy: 88.60% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7890169583261013
distance 1 is tensor(86.3454, device='cuda:0')
distance 2 is tensor(6.4664, device='cuda:0')
benign distance is  tensor(6.4664, device='cuda:0')
norm1 res is  tensor(0.0711, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.79471973516047
distance 1 is tensor(93.8530, device='cuda:0')
distance 2 is tensor(6.9559, device='cuda:0')
benign distance is  tensor(6.9559, device='cuda:0')
norm1 res is  tensor(0.1325, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6961779370903969
distance 1 is tensor(114.5992, device='cuda:0')
distance 2 is tensor(8.4048, device='cuda:0')
benign distance is  tensor(8.4048, device='cuda:0')
norm1 res is  tensor(0.2153, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1930640749633312
distance 1 is tensor(111.7301, device='cuda:0')
distance 2 is tensor(8.1983, device='cuda:0')
benign distance is  tensor(8.1983, device='cuda:0')
norm1 res is  tensor(0.0761, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9649260360747576
distance 1 is tensor(78.1936, device='cuda:0')
distance 2 is tensor(6.0433, device='cuda:0')
benign distance is  tensor(6.0433, device='cuda:0')
norm1 res is  tensor(0.0847, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7157464465126395
distance 1 is tensor(103.1070, device='cuda:0')
distance 2 is tensor(7.5222, device='cuda:0')
benign distance is  tensor(7.5222, device='cuda:0')
norm1 res is  tensor(0.1706, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.0881514642387629
distance 1 is tensor(69.0121, device='cuda:0')
distance 2 is tensor(5.2337, device='cuda:0')
benign distance is  tensor(5.2337, device='cuda:0')
norm1 res is  tensor(0.0804, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6449854541569948
distance 1 is tensor(55.9680, device='cuda:0')
distance 2 is tensor(4.3827, device='cuda:0')
benign distance is  tensor(4.3827, device='cuda:0')
norm1 res is  tensor(0.0931, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.2240584529936314
distance 1 is tensor(109.8717, device='cuda:0')
distance 2 is tensor(8.2873, device='cuda:0')
benign distance is  tensor(8.2873, device='cuda:0')
norm1 res is  tensor(0.1255, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8020446663722396
distance 1 is tensor(141.3625, device='cuda:0')
distance 2 is tensor(10.3230, device='cuda:0')
benign distance is  tensor(10.3230, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.013639034703374
distance 1 is tensor(61.6755, device='cuda:0')
distance 2 is tensor(4.9518, device='cuda:0')
benign distance is  tensor(4.9518, device='cuda:0')
norm1 res is  tensor(0.0867, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3278325647115707
distance 1 is tensor(154.1122, device='cuda:0')
distance 2 is tensor(11.4480, device='cuda:0')
benign distance is  tensor(11.4480, device='cuda:0')
norm1 res is  tensor(0.1586, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.3681940026581287
distance 1 is tensor(191.4865, device='cuda:0')
distance 2 is tensor(13.7706, device='cuda:0')
benign distance is  tensor(13.7706, device='cuda:0')
norm1 res is  tensor(0.1248, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7389200776815414
distance 1 is tensor(66.9998, device='cuda:0')
distance 2 is tensor(4.9730, device='cuda:0')
benign distance is  tensor(4.9730, device='cuda:0')
norm1 res is  tensor(0.1735, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.2339767515659332
distance 1 is tensor(164.9250, device='cuda:0')
distance 2 is tensor(12.1823, device='cuda:0')
benign distance is  tensor(12.1823, device='cuda:0')
norm1 res is  tensor(0.1642, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.6008023768663406
distance 1 is tensor(133.8488, device='cuda:0')
distance 2 is tensor(9.9465, device='cuda:0')
benign distance is  tensor(9.9465, device='cuda:0')
norm1 res is  tensor(0.1322, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.3832563199102879
distance 1 is tensor(111.0170, device='cuda:0')
distance 2 is tensor(8.4652, device='cuda:0')
benign distance is  tensor(8.4652, device='cuda:0')
norm1 res is  tensor(0.1666, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9271089341491461
distance 1 is tensor(143.6052, device='cuda:0')
distance 2 is tensor(10.4431, device='cuda:0')
benign distance is  tensor(10.4431, device='cuda:0')
norm1 res is  tensor(0.1803, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.182478740811348
distance 1 is tensor(154.5399, device='cuda:0')
distance 2 is tensor(11.2969, device='cuda:0')
benign distance is  tensor(11.2969, device='cuda:0')
norm1 res is  tensor(0.1531, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.7712867502123117
distance 1 is tensor(149.6523, device='cuda:0')
distance 2 is tensor(11.0430, device='cuda:0')
benign distance is  tensor(11.0430, device='cuda:0')
norm1 res is  tensor(0.1363, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.8828118946403265
distance 1 is tensor(68.8969, device='cuda:0')
distance 2 is tensor(5.1845, device='cuda:0')
benign distance is  tensor(5.1845, device='cuda:0')
norm1 res is  tensor(0.0876, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8660426996648312
distance 1 is tensor(247.6584, device='cuda:0')
distance 2 is tensor(18.0154, device='cuda:0')
benign distance is  tensor(18.0154, device='cuda:0')
norm1 res is  tensor(0.1323, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.1959795374423265
distance 1 is tensor(147.2655, device='cuda:0')
distance 2 is tensor(10.9403, device='cuda:0')
benign distance is  tensor(10.9403, device='cuda:0')
norm1 res is  tensor(0.0955, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.7555771619081497
distance 1 is tensor(121.3882, device='cuda:0')
distance 2 is tensor(8.8440, device='cuda:0')
benign distance is  tensor(8.8440, device='cuda:0')
norm1 res is  tensor(0.1051, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.1872650943696499
distance 1 is tensor(122.2585, device='cuda:0')
distance 2 is tensor(9.1943, device='cuda:0')
benign distance is  tensor(9.1943, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  1.3144575580954552
distance 1 is tensor(95.9156, device='cuda:0')
distance 2 is tensor(7.3375, device='cuda:0')
benign distance is  tensor(7.3375, device='cuda:0')
norm1 res is  tensor(0.2752, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.1246251910924911
distance 1 is tensor(157.2525, device='cuda:0')
distance 2 is tensor(11.6927, device='cuda:0')
benign distance is  tensor(11.6927, device='cuda:0')
norm1 res is  tensor(0.1365, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.5371222235262394
distance 1 is tensor(128.8535, device='cuda:0')
distance 2 is tensor(9.7440, device='cuda:0')
benign distance is  tensor(9.7440, device='cuda:0')
norm1 res is  tensor(0.1431, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.8528940584510565
distance 1 is tensor(144.8762, device='cuda:0')
distance 2 is tensor(10.7008, device='cuda:0')
benign distance is  tensor(10.7008, device='cuda:0')
norm1 res is  tensor(0.1674, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.9011949524283409
distance 1 is tensor(133.8988, device='cuda:0')
distance 2 is tensor(10.0753, device='cuda:0')
benign distance is  tensor(10.0753, device='cuda:0')
norm1 res is  tensor(0.1453, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5904108677059412
distance 1 is tensor(156.6560, device='cuda:0')
distance 2 is tensor(11.2547, device='cuda:0')
benign distance is  tensor(11.2547, device='cuda:0')
norm1 res is  tensor(0.1737, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.9136453699320555
distance 1 is tensor(203.1131, device='cuda:0')
distance 2 is tensor(14.7340, device='cuda:0')
benign distance is  tensor(14.7340, device='cuda:0')
norm1 res is  tensor(0.1804, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.39664426445961
distance 1 is tensor(144.4750, device='cuda:0')
distance 2 is tensor(10.7735, device='cuda:0')
benign distance is  tensor(10.7735, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.527133483439684
distance 1 is tensor(168.6300, device='cuda:0')
distance 2 is tensor(12.8853, device='cuda:0')
benign distance is  tensor(12.8853, device='cuda:0')
norm1 res is  tensor(0.1729, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.138116966933012
distance 1 is tensor(183.1953, device='cuda:0')
distance 2 is tensor(13.5518, device='cuda:0')
benign distance is  tensor(13.5518, device='cuda:0')
norm1 res is  tensor(0.1277, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.9093121252954006
distance 1 is tensor(114.2189, device='cuda:0')
distance 2 is tensor(8.7120, device='cuda:0')
benign distance is  tensor(8.7120, device='cuda:0')
norm1 res is  tensor(0.2706, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.8739851228892803
distance 1 is tensor(205.7409, device='cuda:0')
distance 2 is tensor(14.8643, device='cuda:0')
benign distance is  tensor(14.8643, device='cuda:0')
norm1 res is  tensor(0.1948, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.67060262337327
distance 1 is tensor(171.4127, device='cuda:0')
distance 2 is tensor(12.4794, device='cuda:0')
benign distance is  tensor(12.4794, device='cuda:0')
norm1 res is  tensor(0.2120, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8811847474426031
distance 1 is tensor(134.5371, device='cuda:0')
distance 2 is tensor(9.6439, device='cuda:0')
benign distance is  tensor(9.6439, device='cuda:0')
norm1 res is  tensor(0.1889, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.6996292620897293
distance 1 is tensor(151.7384, device='cuda:0')
distance 2 is tensor(10.9018, device='cuda:0')
benign distance is  tensor(10.9018, device='cuda:0')
norm1 res is  tensor(0.1691, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(374.2107, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(419.5400, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(504.2066, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(481.0104, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(347.0472, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(447.6897, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(300.3865, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(251.3910, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4760.7222, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4818.6055, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4789.2085, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4778.1660, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4775.9072, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4799.6050, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4800.6719, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4787.0933, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4792.0703, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4795.9814, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4789.3174, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4833.6724, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(619.1382, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(453.6837, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(809.1763, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(674.4449, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(507.8615, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(455.2530, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(458.7990, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(654.0112, device='cuda:0')
norm_2 is  tensor(548.3372, device='cuda:0')
norm_2 * lamda is tensor(987.0068, device='cuda:0')
satisfying 27
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 88.91% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6370913535356522
distance 1 is tensor(78.5339, device='cuda:0')
distance 2 is tensor(6.0909, device='cuda:0')
benign distance is  tensor(6.0909, device='cuda:0')
norm1 res is  tensor(0.0676, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.852778472006321
distance 1 is tensor(79.0731, device='cuda:0')
distance 2 is tensor(6.0850, device='cuda:0')
benign distance is  tensor(6.0850, device='cuda:0')
norm1 res is  tensor(0.1100, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7012607548385859
distance 1 is tensor(90.2892, device='cuda:0')
distance 2 is tensor(6.7075, device='cuda:0')
benign distance is  tensor(6.7075, device='cuda:0')
norm1 res is  tensor(0.1721, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1196355056017637
distance 1 is tensor(120.5920, device='cuda:0')
distance 2 is tensor(8.8918, device='cuda:0')
benign distance is  tensor(8.8918, device='cuda:0')
norm1 res is  tensor(0.0838, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7720563225448132
distance 1 is tensor(56.6081, device='cuda:0')
distance 2 is tensor(4.4076, device='cuda:0')
benign distance is  tensor(4.4076, device='cuda:0')
norm1 res is  tensor(0.0604, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6422526377718896
distance 1 is tensor(72.0151, device='cuda:0')
distance 2 is tensor(5.3687, device='cuda:0')
benign distance is  tensor(5.3687, device='cuda:0')
norm1 res is  tensor(0.1175, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.245558014139533
distance 1 is tensor(67.0154, device='cuda:0')
distance 2 is tensor(5.1779, device='cuda:0')
benign distance is  tensor(5.1779, device='cuda:0')
norm1 res is  tensor(0.0771, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7525449246168137
distance 1 is tensor(76.9641, device='cuda:0')
distance 2 is tensor(5.6443, device='cuda:0')
benign distance is  tensor(5.6443, device='cuda:0')
norm1 res is  tensor(0.1198, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7728897118940949
distance 1 is tensor(136.5139, device='cuda:0')
distance 2 is tensor(10.2349, device='cuda:0')
benign distance is  tensor(10.2349, device='cuda:0')
norm1 res is  tensor(0.1690, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.8872329406440258
distance 1 is tensor(115.7066, device='cuda:0')
distance 2 is tensor(8.4994, device='cuda:0')
benign distance is  tensor(8.4994, device='cuda:0')
norm1 res is  tensor(0.1577, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.6632833369076252
distance 1 is tensor(185.8251, device='cuda:0')
distance 2 is tensor(13.6213, device='cuda:0')
benign distance is  tensor(13.6213, device='cuda:0')
norm1 res is  tensor(0.1834, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.2664237543940544
distance 1 is tensor(148.2999, device='cuda:0')
distance 2 is tensor(10.9875, device='cuda:0')
benign distance is  tensor(10.9875, device='cuda:0')
norm1 res is  tensor(0.1123, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.7098827213048935
distance 1 is tensor(126.4789, device='cuda:0')
distance 2 is tensor(9.5705, device='cuda:0')
benign distance is  tensor(9.5705, device='cuda:0')
norm1 res is  tensor(0.1369, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.8631110982969403
distance 1 is tensor(102.2157, device='cuda:0')
distance 2 is tensor(7.5773, device='cuda:0')
benign distance is  tensor(7.5773, device='cuda:0')
norm1 res is  tensor(0.1273, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.810968030244112
distance 1 is tensor(97.1927, device='cuda:0')
distance 2 is tensor(7.2334, device='cuda:0')
benign distance is  tensor(7.2334, device='cuda:0')
norm1 res is  tensor(0.1986, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6995226815342903
distance 1 is tensor(127.4920, device='cuda:0')
distance 2 is tensor(9.3719, device='cuda:0')
benign distance is  tensor(9.3719, device='cuda:0')
norm1 res is  tensor(0.1621, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(352.2471, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(359.2527, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(396.4950, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(526.0817, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(249.0054, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(308.5927, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(291.3840, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(324.3938, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4768.5576, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4822.2319, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4787.1816, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4771.6587, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4778.5498, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4799.5381, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4807.2915, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4775.2808, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4792.2842, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4776.8091, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4780.6973, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4831.0635, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(505.2541, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(631.5651, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(305.6237, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(682.6459, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(844.4144, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(302.6524, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(734.4855, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(595.2953, device='cuda:0')
norm_2 is  tensor(279.5964, device='cuda:0')
norm_2 * lamda is tensor(503.2735, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 88.37% 

Test Accuracy: 88.88% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5683960188180208
distance 1 is tensor(64.4290, device='cuda:0')
distance 2 is tensor(4.9832, device='cuda:0')
benign distance is  tensor(4.9832, device='cuda:0')
norm1 res is  tensor(0.0536, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.810072504915297
distance 1 is tensor(92.7722, device='cuda:0')
distance 2 is tensor(6.8628, device='cuda:0')
benign distance is  tensor(6.8628, device='cuda:0')
norm1 res is  tensor(0.1269, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7719409111887217
distance 1 is tensor(134.3174, device='cuda:0')
distance 2 is tensor(9.7865, device='cuda:0')
benign distance is  tensor(9.7865, device='cuda:0')
norm1 res is  tensor(0.2554, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3368354849517345
distance 1 is tensor(172.5839, device='cuda:0')
distance 2 is tensor(12.5508, device='cuda:0')
benign distance is  tensor(12.5508, device='cuda:0')
norm1 res is  tensor(0.1245, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.2517970353364944
distance 1 is tensor(70.4997, device='cuda:0')
distance 2 is tensor(5.4284, device='cuda:0')
benign distance is  tensor(5.4284, device='cuda:0')
norm1 res is  tensor(0.0785, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7661171508952975
distance 1 is tensor(79.7211, device='cuda:0')
distance 2 is tensor(5.7347, device='cuda:0')
benign distance is  tensor(5.7347, device='cuda:0')
norm1 res is  tensor(0.1288, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.097606785595417
distance 1 is tensor(77.6632, device='cuda:0')
distance 2 is tensor(5.8372, device='cuda:0')
benign distance is  tensor(5.8372, device='cuda:0')
norm1 res is  tensor(0.0892, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6678060740232468
distance 1 is tensor(53.5636, device='cuda:0')
distance 2 is tensor(4.1027, device='cuda:0')
benign distance is  tensor(4.1027, device='cuda:0')
norm1 res is  tensor(0.0846, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.0462433882057667
distance 1 is tensor(114.0393, device='cuda:0')
distance 2 is tensor(8.4219, device='cuda:0')
benign distance is  tensor(8.4219, device='cuda:0')
norm1 res is  tensor(0.1266, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8246040921658278
distance 1 is tensor(142.1217, device='cuda:0')
distance 2 is tensor(10.4337, device='cuda:0')
benign distance is  tensor(10.4337, device='cuda:0')
norm1 res is  tensor(0.1551, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9520812500268221
distance 1 is tensor(73.2529, device='cuda:0')
distance 2 is tensor(5.6540, device='cuda:0')
benign distance is  tensor(5.6540, device='cuda:0')
norm1 res is  tensor(0.1032, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.5022859275341034
distance 1 is tensor(126.5826, device='cuda:0')
distance 2 is tensor(9.4746, device='cuda:0')
benign distance is  tensor(9.4746, device='cuda:0')
norm1 res is  tensor(0.1307, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.339116308838129
distance 1 is tensor(209.5571, device='cuda:0')
distance 2 is tensor(14.9970, device='cuda:0')
benign distance is  tensor(14.9970, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7074432829394937
distance 1 is tensor(55.2100, device='cuda:0')
distance 2 is tensor(4.1468, device='cuda:0')
benign distance is  tensor(4.1468, device='cuda:0')
norm1 res is  tensor(0.1511, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.134270068258047
distance 1 is tensor(162.3498, device='cuda:0')
distance 2 is tensor(11.7379, device='cuda:0')
benign distance is  tensor(11.7379, device='cuda:0')
norm1 res is  tensor(0.1612, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.3053803890943527
distance 1 is tensor(146.3490, device='cuda:0')
distance 2 is tensor(10.8411, device='cuda:0')
benign distance is  tensor(10.8411, device='cuda:0')
norm1 res is  tensor(0.1416, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(281.8482, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(400.6671, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(592.5574, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(773.2595, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(311.7232, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(329.4855, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(335.5905, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(231.3318, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4781.2144, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4848.5537, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4791.5386, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4799.7148, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4791.0396, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4824.6147, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4818.0493, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4791.7305, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4835.2886, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4794.9102, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4803.1133, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4850.9976, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(514.6723, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(631.4894, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(660.5424, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(659.9067, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(316.0462, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1078.1246, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(647.8207, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(542.9154, device='cuda:0')
norm_2 is  tensor(320.5846, device='cuda:0')
norm_2 * lamda is tensor(577.0522, device='cuda:0')
satisfying 27
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 87.47% 

Test Accuracy: 88.34% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6440399345010519
distance 1 is tensor(90.3027, device='cuda:0')
distance 2 is tensor(6.7513, device='cuda:0')
benign distance is  tensor(6.7513, device='cuda:0')
norm1 res is  tensor(0.0765, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9308222327381372
distance 1 is tensor(96.2759, device='cuda:0')
distance 2 is tensor(7.0341, device='cuda:0')
benign distance is  tensor(7.0341, device='cuda:0')
norm1 res is  tensor(0.1281, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9072276279330254
distance 1 is tensor(143.4319, device='cuda:0')
distance 2 is tensor(10.4963, device='cuda:0')
benign distance is  tensor(10.4963, device='cuda:0')
norm1 res is  tensor(0.2786, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0439753886312246
distance 1 is tensor(150.1111, device='cuda:0')
distance 2 is tensor(10.7866, device='cuda:0')
benign distance is  tensor(10.7866, device='cuda:0')
norm1 res is  tensor(0.1057, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.2509568240493536
distance 1 is tensor(78.9431, device='cuda:0')
distance 2 is tensor(6.1621, device='cuda:0')
benign distance is  tensor(6.1621, device='cuda:0')
norm1 res is  tensor(0.0907, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8632990077603608
distance 1 is tensor(63.9927, device='cuda:0')
distance 2 is tensor(4.7849, device='cuda:0')
benign distance is  tensor(4.7849, device='cuda:0')
norm1 res is  tensor(0.1081, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2194914920255542
distance 1 is tensor(60.8658, device='cuda:0')
distance 2 is tensor(4.6704, device='cuda:0')
benign distance is  tensor(4.6704, device='cuda:0')
norm1 res is  tensor(0.0709, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  1.0612002834677696
distance 1 is tensor(92.4317, device='cuda:0')
distance 2 is tensor(6.8046, device='cuda:0')
benign distance is  tensor(6.8046, device='cuda:0')
norm1 res is  tensor(0.1489, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.2761538736522198
distance 1 is tensor(109.2044, device='cuda:0')
distance 2 is tensor(8.1772, device='cuda:0')
benign distance is  tensor(8.1772, device='cuda:0')
norm1 res is  tensor(0.1639, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.6907909139990807
distance 1 is tensor(126.2470, device='cuda:0')
distance 2 is tensor(9.3814, device='cuda:0')
benign distance is  tensor(9.3814, device='cuda:0')
norm1 res is  tensor(0.1639, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.048762844875455
distance 1 is tensor(159.9221, device='cuda:0')
distance 2 is tensor(11.6016, device='cuda:0')
benign distance is  tensor(11.6016, device='cuda:0')
norm1 res is  tensor(0.1606, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9962075427174568
distance 1 is tensor(143.3464, device='cuda:0')
distance 2 is tensor(10.5950, device='cuda:0')
benign distance is  tensor(10.5950, device='cuda:0')
norm1 res is  tensor(0.1311, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.0976190380752087
distance 1 is tensor(88.6422, device='cuda:0')
distance 2 is tensor(6.4663, device='cuda:0')
benign distance is  tensor(6.4663, device='cuda:0')
norm1 res is  tensor(0.1124, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.7899712054058909
distance 1 is tensor(244.6161, device='cuda:0')
distance 2 is tensor(17.8176, device='cuda:0')
benign distance is  tensor(17.8176, device='cuda:0')
norm1 res is  tensor(0.1333, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.0739082843065262
distance 1 is tensor(159.3207, device='cuda:0')
distance 2 is tensor(11.8357, device='cuda:0')
benign distance is  tensor(11.8357, device='cuda:0')
norm1 res is  tensor(0.1044, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.7006060499697924
distance 1 is tensor(134.9769, device='cuda:0')
distance 2 is tensor(9.7381, device='cuda:0')
benign distance is  tensor(9.7381, device='cuda:0')
norm1 res is  tensor(0.1170, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(399.0995, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(411.6363, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(628.5003, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(654.6871, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(358.4073, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(275.4262, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(268.6290, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(401.5999, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4786.3149, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4866.0239, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4799.4956, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4810.7012, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4803.7642, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4820.8745, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4830.7412, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4806.1030, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4820.4893, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4802.1787, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4820.2939, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4861.5835, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(556.3682, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(451.9608, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(705.7333, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(576.1414, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(667.5353, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(629.2424, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(682.8593, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(892.7582, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(508.4648, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(630.6252, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(341.0830, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(564.3442, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(922.1916, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(255.8691, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(721.8260, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(648.1564, device='cuda:0')
norm_2 is  tensor(622.3309, device='cuda:0')
norm_2 * lamda is tensor(1120.1957, device='cuda:0')
satisfying 35
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 85.75% 

Test Accuracy: 88.19% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6545948144048452
distance 1 is tensor(89.5624, device='cuda:0')
distance 2 is tensor(6.8013, device='cuda:0')
benign distance is  tensor(6.8013, device='cuda:0')
norm1 res is  tensor(0.0751, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6418713107705116
distance 1 is tensor(63.7584, device='cuda:0')
distance 2 is tensor(4.9017, device='cuda:0')
benign distance is  tensor(4.9017, device='cuda:0')
norm1 res is  tensor(0.0900, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6888163648545742
distance 1 is tensor(103.3535, device='cuda:0')
distance 2 is tensor(7.6659, device='cuda:0')
benign distance is  tensor(7.6659, device='cuda:0')
norm1 res is  tensor(0.1924, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.132500546053052
distance 1 is tensor(128.5347, device='cuda:0')
distance 2 is tensor(9.5801, device='cuda:0')
benign distance is  tensor(9.5801, device='cuda:0')
norm1 res is  tensor(0.0920, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.912406912073493
distance 1 is tensor(87.2777, device='cuda:0')
distance 2 is tensor(6.5658, device='cuda:0')
benign distance is  tensor(6.5658, device='cuda:0')
norm1 res is  tensor(0.0910, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7499938188120723
distance 1 is tensor(79.0861, device='cuda:0')
distance 2 is tensor(5.7996, device='cuda:0')
benign distance is  tensor(5.7996, device='cuda:0')
norm1 res is  tensor(0.1365, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.6800486333668232
distance 1 is tensor(73.2874, device='cuda:0')
distance 2 is tensor(5.8472, device='cuda:0')
benign distance is  tensor(5.8472, device='cuda:0')
norm1 res is  tensor(0.0946, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6709122955799103
distance 1 is tensor(54.7384, device='cuda:0')
distance 2 is tensor(4.1753, device='cuda:0')
benign distance is  tensor(4.1753, device='cuda:0')
norm1 res is  tensor(0.0840, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  0.8246978539973497
distance 1 is tensor(109.6754, device='cuda:0')
distance 2 is tensor(8.0387, device='cuda:0')
benign distance is  tensor(8.0387, device='cuda:0')
norm1 res is  tensor(0.1251, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.6471918411552906
distance 1 is tensor(148.4436, device='cuda:0')
distance 2 is tensor(10.8535, device='cuda:0')
benign distance is  tensor(10.8535, device='cuda:0')
norm1 res is  tensor(0.1570, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9394157528877258
distance 1 is tensor(51.2143, device='cuda:0')
distance 2 is tensor(4.1261, device='cuda:0')
benign distance is  tensor(4.1261, device='cuda:0')
norm1 res is  tensor(0.0710, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0422607306391
distance 1 is tensor(107.3541, device='cuda:0')
distance 2 is tensor(8.0719, device='cuda:0')
benign distance is  tensor(8.0719, device='cuda:0')
norm1 res is  tensor(0.1118, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.0067939385771751
distance 1 is tensor(190.7691, device='cuda:0')
distance 2 is tensor(13.8143, device='cuda:0')
benign distance is  tensor(13.8143, device='cuda:0')
norm1 res is  tensor(0.1248, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7229815823957324
distance 1 is tensor(50.3154, device='cuda:0')
distance 2 is tensor(3.8995, device='cuda:0')
benign distance is  tensor(3.8995, device='cuda:0')
norm1 res is  tensor(0.1346, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.0883412268012762
distance 1 is tensor(174.0244, device='cuda:0')
distance 2 is tensor(12.7961, device='cuda:0')
benign distance is  tensor(12.7961, device='cuda:0')
norm1 res is  tensor(0.1760, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.1022012121975422
distance 1 is tensor(117.7883, device='cuda:0')
distance 2 is tensor(8.9202, device='cuda:0')
benign distance is  tensor(8.9202, device='cuda:0')
norm1 res is  tensor(0.1165, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  0.9230080265551805
distance 1 is tensor(133.0935, device='cuda:0')
distance 2 is tensor(9.8660, device='cuda:0')
benign distance is  tensor(9.8660, device='cuda:0')
norm1 res is  tensor(0.1461, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.8043428333476186
distance 1 is tensor(107.6915, device='cuda:0')
distance 2 is tensor(8.1588, device='cuda:0')
benign distance is  tensor(8.1588, device='cuda:0')
norm1 res is  tensor(0.3033, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.9107053391635418
distance 1 is tensor(164.6867, device='cuda:0')
distance 2 is tensor(12.1542, device='cuda:0')
benign distance is  tensor(12.1542, device='cuda:0')
norm1 res is  tensor(0.1461, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.2974008191376925
distance 1 is tensor(126.4041, device='cuda:0')
distance 2 is tensor(9.5409, device='cuda:0')
benign distance is  tensor(9.5409, device='cuda:0')
norm1 res is  tensor(0.1411, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  0.9451014250516891
distance 1 is tensor(142.1132, device='cuda:0')
distance 2 is tensor(10.4650, device='cuda:0')
benign distance is  tensor(10.4650, device='cuda:0')
norm1 res is  tensor(0.1591, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.8206256050616503
distance 1 is tensor(150.5490, device='cuda:0')
distance 2 is tensor(11.3635, device='cuda:0')
benign distance is  tensor(11.3635, device='cuda:0')
norm1 res is  tensor(0.1636, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5942041054368019
distance 1 is tensor(146.4513, device='cuda:0')
distance 2 is tensor(10.5320, device='cuda:0')
benign distance is  tensor(10.5320, device='cuda:0')
norm1 res is  tensor(0.1632, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.6368410941213369
distance 1 is tensor(209.7124, device='cuda:0')
distance 2 is tensor(15.2124, device='cuda:0')
benign distance is  tensor(15.2124, device='cuda:0')
norm1 res is  tensor(0.1862, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(395.1373, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(282.5461, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(453.8420, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(573.5984, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(376.5573, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(329.9453, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(333.4842, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(227.9532, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4797.2397, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4852.1567, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4804.5210, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4807.0571, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4814.5332, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4838.0420, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4837.8232, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4811.8350, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4821.0132, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4813.1978, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4824.2773, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4869.0278, device='cuda:0')
norm_2 is  tensor(295.3847, device='cuda:0')
norm_2 * lamda is tensor(531.6924, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 88.89% 

Test Accuracy: 89.02% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
 benign loss is  0.9585729371756315
distance 1 is tensor(122.3149, device='cuda:0')
distance 2 is tensor(9.1521, device='cuda:0')
benign distance is  tensor(9.1521, device='cuda:0')
norm1 res is  tensor(0.1055, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7534626368433237
distance 1 is tensor(86.8918, device='cuda:0')
distance 2 is tensor(6.6222, device='cuda:0')
benign distance is  tensor(6.6222, device='cuda:0')
norm1 res is  tensor(0.1220, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7931209672242403
distance 1 is tensor(90.8711, device='cuda:0')
distance 2 is tensor(6.8133, device='cuda:0')
benign distance is  tensor(6.8133, device='cuda:0')
norm1 res is  tensor(0.1716, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3864578604698181
distance 1 is tensor(171.6225, device='cuda:0')
distance 2 is tensor(12.3942, device='cuda:0')
benign distance is  tensor(12.3942, device='cuda:0')
norm1 res is  tensor(0.1187, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.2699706181883812
distance 1 is tensor(68.6788, device='cuda:0')
distance 2 is tensor(5.2447, device='cuda:0')
benign distance is  tensor(5.2447, device='cuda:0')
norm1 res is  tensor(0.0743, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7592620844952762
distance 1 is tensor(67.1247, device='cuda:0')
distance 2 is tensor(4.9807, device='cuda:0')
benign distance is  tensor(4.9807, device='cuda:0')
norm1 res is  tensor(0.1101, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1804934917017817
distance 1 is tensor(46.9130, device='cuda:0')
distance 2 is tensor(3.6709, device='cuda:0')
benign distance is  tensor(3.6709, device='cuda:0')
norm1 res is  tensor(0.0534, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6388394553214312
distance 1 is tensor(60.8799, device='cuda:0')
distance 2 is tensor(4.6385, device='cuda:0')
benign distance is  tensor(4.6385, device='cuda:0')
norm1 res is  tensor(0.0991, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(550.2255, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(392.0767, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(402.5794, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(750.7527, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(296.5710, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(286.8781, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(202.4009, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(257.6010, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4813.9302, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4887.5635, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4831.6177, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4824.4790, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4832.7617, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4846.9082, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4858.0073, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4838.8472, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4851.0796, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4833.3286, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4841.7090, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4914.6318, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(652.6471, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(778.4278, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(808.6556, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(535.4819, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(912.7391, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(770.0702, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(589.7277, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(670.8923, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(635.5970, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(520.9165, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(843.5350, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(682.9604, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(575.3848, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(475.3687, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(467.3957, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(584.9440, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(506.9949, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(573.2685, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(695.2882, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(642.5541, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(398.2592, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1087.7789, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(711.9839, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(606.1741, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(488.4149, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(654.1791, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(252.2280, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(486.9485, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(841.7731, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(244.5378, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(793.8344, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(538.6524, device='cuda:0')
norm_2 is  tensor(517.8904, device='cuda:0')
norm_2 * lamda is tensor(932.2028, device='cuda:0')
satisfying 51
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 87.38% 

Test Accuracy: 88.59% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6981594851240516
distance 1 is tensor(65.5043, device='cuda:0')
distance 2 is tensor(4.9708, device='cuda:0')
benign distance is  tensor(4.9708, device='cuda:0')
norm1 res is  tensor(0.0532, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6706789750605822
distance 1 is tensor(78.3394, device='cuda:0')
distance 2 is tensor(5.9449, device='cuda:0')
benign distance is  tensor(5.9449, device='cuda:0')
norm1 res is  tensor(0.1074, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.6417319159954786
distance 1 is tensor(87.2943, device='cuda:0')
distance 2 is tensor(6.5453, device='cuda:0')
benign distance is  tensor(6.5453, device='cuda:0')
norm1 res is  tensor(0.1630, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  2.0774299576878548
distance 1 is tensor(152.7465, device='cuda:0')
distance 2 is tensor(11.1103, device='cuda:0')
benign distance is  tensor(11.1103, device='cuda:0')
norm1 res is  tensor(0.1079, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8869429240003228
distance 1 is tensor(55.1558, device='cuda:0')
distance 2 is tensor(4.4144, device='cuda:0')
benign distance is  tensor(4.4144, device='cuda:0')
norm1 res is  tensor(0.0596, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6136056496761739
distance 1 is tensor(73.0414, device='cuda:0')
distance 2 is tensor(5.3927, device='cuda:0')
benign distance is  tensor(5.3927, device='cuda:0')
norm1 res is  tensor(0.1219, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1256138747557998
distance 1 is tensor(51.3518, device='cuda:0')
distance 2 is tensor(4.0254, device='cuda:0')
benign distance is  tensor(4.0254, device='cuda:0')
norm1 res is  tensor(0.0581, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6239728042855859
distance 1 is tensor(46.1236, device='cuda:0')
distance 2 is tensor(3.6873, device='cuda:0')
benign distance is  tensor(3.6873, device='cuda:0')
norm1 res is  tensor(0.0737, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.0606046989560127
distance 1 is tensor(117.2976, device='cuda:0')
distance 2 is tensor(8.6911, device='cuda:0')
benign distance is  tensor(8.6911, device='cuda:0')
norm1 res is  tensor(0.1311, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8055883627384901
distance 1 is tensor(146.8224, device='cuda:0')
distance 2 is tensor(10.7123, device='cuda:0')
benign distance is  tensor(10.7123, device='cuda:0')
norm1 res is  tensor(0.1554, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.8433658462017775
distance 1 is tensor(59.6970, device='cuda:0')
distance 2 is tensor(4.6608, device='cuda:0')
benign distance is  tensor(4.6608, device='cuda:0')
norm1 res is  tensor(0.0804, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.1220953688025475
distance 1 is tensor(110.2878, device='cuda:0')
distance 2 is tensor(8.4151, device='cuda:0')
benign distance is  tensor(8.4151, device='cuda:0')
norm1 res is  tensor(0.1161, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.4156735241413116
distance 1 is tensor(193.9279, device='cuda:0')
distance 2 is tensor(13.9605, device='cuda:0')
benign distance is  tensor(13.9605, device='cuda:0')
norm1 res is  tensor(0.1277, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.5738536389544606
distance 1 is tensor(41.4666, device='cuda:0')
distance 2 is tensor(3.1855, device='cuda:0')
benign distance is  tensor(3.1855, device='cuda:0')
norm1 res is  tensor(0.1093, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1291145868599415
distance 1 is tensor(149.0545, device='cuda:0')
distance 2 is tensor(10.8357, device='cuda:0')
benign distance is  tensor(10.8357, device='cuda:0')
norm1 res is  tensor(0.1510, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.255824975669384
distance 1 is tensor(123.9599, device='cuda:0')
distance 2 is tensor(9.2432, device='cuda:0')
benign distance is  tensor(9.2432, device='cuda:0')
norm1 res is  tensor(0.1195, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.9457536116242409
distance 1 is tensor(100.1436, device='cuda:0')
distance 2 is tensor(7.7844, device='cuda:0')
benign distance is  tensor(7.7844, device='cuda:0')
norm1 res is  tensor(0.1495, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9135978184640408
distance 1 is tensor(118.9255, device='cuda:0')
distance 2 is tensor(8.8531, device='cuda:0')
benign distance is  tensor(8.8531, device='cuda:0')
norm1 res is  tensor(0.1545, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.5237259212881327
distance 1 is tensor(136.6057, device='cuda:0')
distance 2 is tensor(10.0176, device='cuda:0')
benign distance is  tensor(10.0176, device='cuda:0')
norm1 res is  tensor(0.1355, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9800124652683735
distance 1 is tensor(141.9406, device='cuda:0')
distance 2 is tensor(10.4127, device='cuda:0')
benign distance is  tensor(10.4127, device='cuda:0')
norm1 res is  tensor(0.1285, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.947122254408896
distance 1 is tensor(71.1245, device='cuda:0')
distance 2 is tensor(5.2664, device='cuda:0')
benign distance is  tensor(5.2664, device='cuda:0')
norm1 res is  tensor(0.0929, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.7626788653433323
distance 1 is tensor(250.8616, device='cuda:0')
distance 2 is tensor(18.0913, device='cuda:0')
benign distance is  tensor(18.0913, device='cuda:0')
norm1 res is  tensor(0.1350, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.4617080353200436
distance 1 is tensor(154.9836, device='cuda:0')
distance 2 is tensor(11.5508, device='cuda:0')
benign distance is  tensor(11.5508, device='cuda:0')
norm1 res is  tensor(0.1027, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.5695511437952518
distance 1 is tensor(113.0468, device='cuda:0')
distance 2 is tensor(8.3915, device='cuda:0')
benign distance is  tensor(8.3915, device='cuda:0')
norm1 res is  tensor(0.1000, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.8062040004879236
distance 1 is tensor(151.6462, device='cuda:0')
distance 2 is tensor(11.3588, device='cuda:0')
benign distance is  tensor(11.3588, device='cuda:0')
norm1 res is  tensor(0.1882, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.4366206303238869
distance 1 is tensor(120.2245, device='cuda:0')
distance 2 is tensor(8.7245, device='cuda:0')
benign distance is  tensor(8.7245, device='cuda:0')
norm1 res is  tensor(0.1603, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.6979508753865957
distance 1 is tensor(169.1219, device='cuda:0')
distance 2 is tensor(12.4997, device='cuda:0')
benign distance is  tensor(12.4997, device='cuda:0')
norm1 res is  tensor(0.1655, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.7941880524158478
distance 1 is tensor(145.5657, device='cuda:0')
distance 2 is tensor(10.6282, device='cuda:0')
benign distance is  tensor(10.6282, device='cuda:0')
norm1 res is  tensor(0.1109, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.6853389143943787
distance 1 is tensor(122.5417, device='cuda:0')
distance 2 is tensor(9.2948, device='cuda:0')
benign distance is  tensor(9.2948, device='cuda:0')
norm1 res is  tensor(0.1329, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.7479190109297633
distance 1 is tensor(106.7101, device='cuda:0')
distance 2 is tensor(7.8484, device='cuda:0')
benign distance is  tensor(7.8484, device='cuda:0')
norm1 res is  tensor(0.1342, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.7764999913051724
distance 1 is tensor(97.2737, device='cuda:0')
distance 2 is tensor(7.3430, device='cuda:0')
benign distance is  tensor(7.3430, device='cuda:0')
norm1 res is  tensor(0.2029, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6280174814164639
distance 1 is tensor(124.3044, device='cuda:0')
distance 2 is tensor(9.3131, device='cuda:0')
benign distance is  tensor(9.3131, device='cuda:0')
norm1 res is  tensor(0.1520, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  0.983976773917675
distance 1 is tensor(133.3649, device='cuda:0')
distance 2 is tensor(10.0628, device='cuda:0')
benign distance is  tensor(10.0628, device='cuda:0')
norm1 res is  tensor(0.1370, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.5023648738861084
distance 1 is tensor(164.3447, device='cuda:0')
distance 2 is tensor(12.3022, device='cuda:0')
benign distance is  tensor(12.3022, device='cuda:0')
norm1 res is  tensor(0.1662, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.4452369511127472
distance 1 is tensor(165.1331, device='cuda:0')
distance 2 is tensor(12.4011, device='cuda:0')
benign distance is  tensor(12.4011, device='cuda:0')
norm1 res is  tensor(0.1170, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.8259867075830698
distance 1 is tensor(103.5366, device='cuda:0')
distance 2 is tensor(7.9338, device='cuda:0')
benign distance is  tensor(7.9338, device='cuda:0')
norm1 res is  tensor(0.2388, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.6577543318271637
distance 1 is tensor(184.9010, device='cuda:0')
distance 2 is tensor(13.4185, device='cuda:0')
benign distance is  tensor(13.4185, device='cuda:0')
norm1 res is  tensor(0.1771, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.8576895892620087
distance 1 is tensor(161.2529, device='cuda:0')
distance 2 is tensor(11.8325, device='cuda:0')
benign distance is  tensor(11.8325, device='cuda:0')
norm1 res is  tensor(0.1972, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8523248946294188
distance 1 is tensor(107.9470, device='cuda:0')
distance 2 is tensor(8.0301, device='cuda:0')
benign distance is  tensor(8.0301, device='cuda:0')
norm1 res is  tensor(0.1476, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5612010899931192
distance 1 is tensor(151.0271, device='cuda:0')
distance 2 is tensor(10.9212, device='cuda:0')
benign distance is  tensor(10.9212, device='cuda:0')
norm1 res is  tensor(0.1653, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(279.0217, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(345.5225, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(385.2339, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(675.2426, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(242.3450, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(311.0992, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(220.3310, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(201.7347, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4803.7578, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4872.3643, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4816.2134, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4818.8184, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4816.5405, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4846.0332, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4847.5366, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4825.2090, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4826.5635, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4823.4731, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4826.3047, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4870.8174, device='cuda:0')
norm_2 is  tensor(314.4728, device='cuda:0')
norm_2 * lamda is tensor(566.0510, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.71% 

Test Accuracy: 89.01% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7394876452162862
distance 1 is tensor(60.4027, device='cuda:0')
distance 2 is tensor(4.6885, device='cuda:0')
benign distance is  tensor(4.6885, device='cuda:0')
norm1 res is  tensor(0.0495, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7426205463707447
distance 1 is tensor(62.1356, device='cuda:0')
distance 2 is tensor(4.7167, device='cuda:0')
benign distance is  tensor(4.7167, device='cuda:0')
norm1 res is  tensor(0.0859, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.879494484513998
distance 1 is tensor(104.6506, device='cuda:0')
distance 2 is tensor(7.8591, device='cuda:0')
benign distance is  tensor(7.8591, device='cuda:0')
norm1 res is  tensor(0.2006, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0265857633203268
distance 1 is tensor(156.5745, device='cuda:0')
distance 2 is tensor(11.4619, device='cuda:0')
benign distance is  tensor(11.4619, device='cuda:0')
norm1 res is  tensor(0.1095, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9231027783825994
distance 1 is tensor(76.9725, device='cuda:0')
distance 2 is tensor(5.9396, device='cuda:0')
benign distance is  tensor(5.9396, device='cuda:0')
norm1 res is  tensor(0.0869, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6912688845768571
distance 1 is tensor(67.5104, device='cuda:0')
distance 2 is tensor(5.0107, device='cuda:0')
benign distance is  tensor(5.0107, device='cuda:0')
norm1 res is  tensor(0.1112, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.274860279634595
distance 1 is tensor(49.1787, device='cuda:0')
distance 2 is tensor(3.8437, device='cuda:0')
benign distance is  tensor(3.8437, device='cuda:0')
norm1 res is  tensor(0.0588, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6011100737378001
distance 1 is tensor(62.7982, device='cuda:0')
distance 2 is tensor(4.6960, device='cuda:0')
benign distance is  tensor(4.6960, device='cuda:0')
norm1 res is  tensor(0.0995, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(261.1214, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(269.5179, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(459.1595, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(694.6396, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(342.7987, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(287.9788, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(209.0258, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(270.4716, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4827.8457, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4892.2676, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4837.2397, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4851.2041, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4836.5073, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4866.2427, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4858.7866, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4853.8086, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4860.1909, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4837.5225, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4848.4966, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4906.1387, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(594.3174, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(495.5596, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(752.6843, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(574.1290, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(638.4255, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(708.1808, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(647.2551, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(919.1854, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(522.0616, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(646.3820, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(276.1085, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(499.8789, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(857.2615, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(195.8486, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(661.6359, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(550.1945, device='cuda:0')
norm_2 is  tensor(476.9928, device='cuda:0')
norm_2 * lamda is tensor(858.5870, device='cuda:0')
satisfying 35
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 86.60% 

Test Accuracy: 88.34% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5626269392669201
distance 1 is tensor(55.2604, device='cuda:0')
distance 2 is tensor(4.3091, device='cuda:0')
benign distance is  tensor(4.3091, device='cuda:0')
norm1 res is  tensor(0.0457, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6672692904248834
distance 1 is tensor(86.5111, device='cuda:0')
distance 2 is tensor(6.3334, device='cuda:0')
benign distance is  tensor(6.3334, device='cuda:0')
norm1 res is  tensor(0.1157, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7043472267687321
distance 1 is tensor(79.9575, device='cuda:0')
distance 2 is tensor(6.1193, device='cuda:0')
benign distance is  tensor(6.1193, device='cuda:0')
norm1 res is  tensor(0.1507, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0098925307393074
distance 1 is tensor(114.1653, device='cuda:0')
distance 2 is tensor(8.4719, device='cuda:0')
benign distance is  tensor(8.4719, device='cuda:0')
norm1 res is  tensor(0.0795, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8798400247469544
distance 1 is tensor(54.3636, device='cuda:0')
distance 2 is tensor(4.3308, device='cuda:0')
benign distance is  tensor(4.3308, device='cuda:0')
norm1 res is  tensor(0.0575, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.573017661459744
distance 1 is tensor(78.7776, device='cuda:0')
distance 2 is tensor(5.8602, device='cuda:0')
benign distance is  tensor(5.8602, device='cuda:0')
norm1 res is  tensor(0.1320, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1142384354025126
distance 1 is tensor(43.5397, device='cuda:0')
distance 2 is tensor(3.4736, device='cuda:0')
benign distance is  tensor(3.4736, device='cuda:0')
norm1 res is  tensor(0.0496, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6203532237559557
distance 1 is tensor(84.7517, device='cuda:0')
distance 2 is tensor(6.6459, device='cuda:0')
benign distance is  tensor(6.6459, device='cuda:0')
norm1 res is  tensor(0.1426, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.0210091546177864
distance 1 is tensor(104.7986, device='cuda:0')
distance 2 is tensor(7.8173, device='cuda:0')
benign distance is  tensor(7.8173, device='cuda:0')
norm1 res is  tensor(0.1170, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.626501552760601
distance 1 is tensor(134.0221, device='cuda:0')
distance 2 is tensor(9.9288, device='cuda:0')
benign distance is  tensor(9.9288, device='cuda:0')
norm1 res is  tensor(0.1478, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.953301303088665
distance 1 is tensor(59.8738, device='cuda:0')
distance 2 is tensor(4.7266, device='cuda:0')
benign distance is  tensor(4.7266, device='cuda:0')
norm1 res is  tensor(0.0833, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0296992138028145
distance 1 is tensor(119.6038, device='cuda:0')
distance 2 is tensor(8.8960, device='cuda:0')
benign distance is  tensor(8.8960, device='cuda:0')
norm1 res is  tensor(0.1255, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.3885548375546932
distance 1 is tensor(187.4174, device='cuda:0')
distance 2 is tensor(13.6024, device='cuda:0')
benign distance is  tensor(13.6024, device='cuda:0')
norm1 res is  tensor(0.1270, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7708213422447443
distance 1 is tensor(44.1314, device='cuda:0')
distance 2 is tensor(3.3846, device='cuda:0')
benign distance is  tensor(3.3846, device='cuda:0')
norm1 res is  tensor(0.1144, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1281056571751833
distance 1 is tensor(125.8953, device='cuda:0')
distance 2 is tensor(9.1910, device='cuda:0')
benign distance is  tensor(9.1910, device='cuda:0')
norm1 res is  tensor(0.1237, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.3030673786997795
distance 1 is tensor(147.2571, device='cuda:0')
distance 2 is tensor(11.0094, device='cuda:0')
benign distance is  tensor(11.0094, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.0346763003617525
distance 1 is tensor(129.8029, device='cuda:0')
distance 2 is tensor(9.5707, device='cuda:0')
benign distance is  tensor(9.5707, device='cuda:0')
norm1 res is  tensor(0.1400, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6502880565822124
distance 1 is tensor(91.7866, device='cuda:0')
distance 2 is tensor(6.9189, device='cuda:0')
benign distance is  tensor(6.9189, device='cuda:0')
norm1 res is  tensor(0.2632, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  0.9548027236014605
distance 1 is tensor(159.3758, device='cuda:0')
distance 2 is tensor(11.7549, device='cuda:0')
benign distance is  tensor(11.7549, device='cuda:0')
norm1 res is  tensor(0.1393, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.8071878664195538
distance 1 is tensor(135.3943, device='cuda:0')
distance 2 is tensor(10.1486, device='cuda:0')
benign distance is  tensor(10.1486, device='cuda:0')
norm1 res is  tensor(0.1501, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.0488852486014366
distance 1 is tensor(140.9160, device='cuda:0')
distance 2 is tensor(10.4065, device='cuda:0')
benign distance is  tensor(10.4065, device='cuda:0')
norm1 res is  tensor(0.1580, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  1.2238796800374985
distance 1 is tensor(196.6496, device='cuda:0')
distance 2 is tensor(16.1704, device='cuda:0')
benign distance is  tensor(16.1704, device='cuda:0')
norm1 res is  tensor(0.2319, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5835000229999423
distance 1 is tensor(130.2587, device='cuda:0')
distance 2 is tensor(9.5425, device='cuda:0')
benign distance is  tensor(9.5425, device='cuda:0')
norm1 res is  tensor(0.1500, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  1.0400942713022232
distance 1 is tensor(213.4009, device='cuda:0')
distance 2 is tensor(15.5108, device='cuda:0')
benign distance is  tensor(15.5108, device='cuda:0')
norm1 res is  tensor(0.1897, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(241.5841, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(373.1721, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(355.7281, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(499.4093, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(236.3729, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(339.8293, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(187.9795, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(378.8832, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4831.3853, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4903.0474, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4865.1147, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4847.5317, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4844.0068, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4888.8794, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4872.7085, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4848.2744, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4861.7271, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4851.7856, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4866.7510, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4901.0977, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(457.7971, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(532.0555, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(589.2590, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(621.3059, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(308.5642, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1096.5485, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(691.7951, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(512.6779, device='cuda:0')
norm_2 is  tensor(247.1563, device='cuda:0')
norm_2 * lamda is tensor(444.8814, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 88.55% 

Test Accuracy: 88.67% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7802438177168369
distance 1 is tensor(108.5541, device='cuda:0')
distance 2 is tensor(8.1041, device='cuda:0')
benign distance is  tensor(8.1041, device='cuda:0')
norm1 res is  tensor(0.0907, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7055211868137121
distance 1 is tensor(57.3879, device='cuda:0')
distance 2 is tensor(4.3183, device='cuda:0')
benign distance is  tensor(4.3183, device='cuda:0')
norm1 res is  tensor(0.0786, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.760299801826477
distance 1 is tensor(66.8204, device='cuda:0')
distance 2 is tensor(5.2389, device='cuda:0')
benign distance is  tensor(5.2389, device='cuda:0')
norm1 res is  tensor(0.1285, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.9775118660181761
distance 1 is tensor(158.9589, device='cuda:0')
distance 2 is tensor(11.4604, device='cuda:0')
benign distance is  tensor(11.4604, device='cuda:0')
norm1 res is  tensor(0.1099, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.773829871788621
distance 1 is tensor(65.4516, device='cuda:0')
distance 2 is tensor(5.0763, device='cuda:0')
benign distance is  tensor(5.0763, device='cuda:0')
norm1 res is  tensor(0.0705, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6641331147402525
distance 1 is tensor(46.2558, device='cuda:0')
distance 2 is tensor(3.5716, device='cuda:0')
benign distance is  tensor(3.5716, device='cuda:0')
norm1 res is  tensor(0.0798, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2908152714371681
distance 1 is tensor(66.1600, device='cuda:0')
distance 2 is tensor(5.0912, device='cuda:0')
benign distance is  tensor(5.0912, device='cuda:0')
norm1 res is  tensor(0.0778, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.751548963598907
distance 1 is tensor(62.6420, device='cuda:0')
distance 2 is tensor(4.8537, device='cuda:0')
benign distance is  tensor(4.8537, device='cuda:0')
norm1 res is  tensor(0.1008, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.2144916243851185
distance 1 is tensor(191.8217, device='cuda:0')
distance 2 is tensor(14.5351, device='cuda:0')
benign distance is  tensor(14.5351, device='cuda:0')
norm1 res is  tensor(0.2770, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7585288789123297
distance 1 is tensor(134.1847, device='cuda:0')
distance 2 is tensor(9.8243, device='cuda:0')
benign distance is  tensor(9.8243, device='cuda:0')
norm1 res is  tensor(0.1712, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.3881611488759518
distance 1 is tensor(150.9757, device='cuda:0')
distance 2 is tensor(10.9664, device='cuda:0')
benign distance is  tensor(10.9664, device='cuda:0')
norm1 res is  tensor(0.1513, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.8381960857659578
distance 1 is tensor(138.8399, device='cuda:0')
distance 2 is tensor(10.3147, device='cuda:0')
benign distance is  tensor(10.3147, device='cuda:0')
norm1 res is  tensor(0.1263, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.9801551345735788
distance 1 is tensor(70.8042, device='cuda:0')
distance 2 is tensor(5.2053, device='cuda:0')
benign distance is  tensor(5.2053, device='cuda:0')
norm1 res is  tensor(0.0873, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.807251026853919
distance 1 is tensor(248.2965, device='cuda:0')
distance 2 is tensor(17.8394, device='cuda:0')
benign distance is  tensor(17.8394, device='cuda:0')
norm1 res is  tensor(0.1325, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.3757956214249134
distance 1 is tensor(151.2653, device='cuda:0')
distance 2 is tensor(11.3136, device='cuda:0')
benign distance is  tensor(11.3136, device='cuda:0')
norm1 res is  tensor(0.0998, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  1.008263174444437
distance 1 is tensor(127.7162, device='cuda:0')
distance 2 is tensor(9.3615, device='cuda:0')
benign distance is  tensor(9.3615, device='cuda:0')
norm1 res is  tensor(0.1111, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(472.2807, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(242.8146, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(303.0469, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(698.9022, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(290.3663, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(202.8447, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(293.8992, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(275.6338, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4860.2593, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4914.6787, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4866.4214, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4864.0708, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4865.7871, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4888.2812, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4883.5498, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4872.9370, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4889.5879, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4856.1011, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4869.1191, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4936.9443, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(467.9580, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(607.9431, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(281.9384, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(534.6340, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(852.8521, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(206.0560, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(559.2770, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(646.1880, device='cuda:0')
norm_2 is  tensor(289.4586, device='cuda:0')
norm_2 * lamda is tensor(521.0254, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 87.21% 

Test Accuracy: 88.82% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6473210621625185
distance 1 is tensor(79.9724, device='cuda:0')
distance 2 is tensor(6.1455, device='cuda:0')
benign distance is  tensor(6.1455, device='cuda:0')
norm1 res is  tensor(0.0667, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6634757742285728
distance 1 is tensor(60.3614, device='cuda:0')
distance 2 is tensor(4.6105, device='cuda:0')
benign distance is  tensor(4.6105, device='cuda:0')
norm1 res is  tensor(0.0807, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7482722233980894
distance 1 is tensor(109.4373, device='cuda:0')
distance 2 is tensor(8.1060, device='cuda:0')
benign distance is  tensor(8.1060, device='cuda:0')
norm1 res is  tensor(0.2049, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3164489641785622
distance 1 is tensor(166.9737, device='cuda:0')
distance 2 is tensor(12.0201, device='cuda:0')
benign distance is  tensor(12.0201, device='cuda:0')
norm1 res is  tensor(0.1155, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.997283878736198
distance 1 is tensor(60.9524, device='cuda:0')
distance 2 is tensor(4.7102, device='cuda:0')
benign distance is  tensor(4.7102, device='cuda:0')
norm1 res is  tensor(0.0634, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.5737077943049371
distance 1 is tensor(65.4817, device='cuda:0')
distance 2 is tensor(4.8643, device='cuda:0')
benign distance is  tensor(4.8643, device='cuda:0')
norm1 res is  tensor(0.1081, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2674333415925503
distance 1 is tensor(74.4566, device='cuda:0')
distance 2 is tensor(5.6631, device='cuda:0')
benign distance is  tensor(5.6631, device='cuda:0')
norm1 res is  tensor(0.0863, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5927401003427804
distance 1 is tensor(58.5997, device='cuda:0')
distance 2 is tensor(4.4427, device='cuda:0')
benign distance is  tensor(4.4427, device='cuda:0')
norm1 res is  tensor(0.0942, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.2148212306201458
distance 1 is tensor(107.6051, device='cuda:0')
distance 2 is tensor(7.9994, device='cuda:0')
benign distance is  tensor(7.9994, device='cuda:0')
norm1 res is  tensor(0.1179, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9714027596637607
distance 1 is tensor(143.6481, device='cuda:0')
distance 2 is tensor(10.7080, device='cuda:0')
benign distance is  tensor(10.7080, device='cuda:0')
norm1 res is  tensor(0.1543, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.091258730739355
distance 1 is tensor(63.4430, device='cuda:0')
distance 2 is tensor(4.9846, device='cuda:0')
benign distance is  tensor(4.9846, device='cuda:0')
norm1 res is  tensor(0.0874, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0769478864967823
distance 1 is tensor(130.2037, device='cuda:0')
distance 2 is tensor(9.6566, device='cuda:0')
benign distance is  tensor(9.6566, device='cuda:0')
norm1 res is  tensor(0.1360, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.2163745686411858
distance 1 is tensor(232.0794, device='cuda:0')
distance 2 is tensor(16.8488, device='cuda:0')
benign distance is  tensor(16.8488, device='cuda:0')
norm1 res is  tensor(0.1509, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7436563218943775
distance 1 is tensor(53.6457, device='cuda:0')
distance 2 is tensor(4.1331, device='cuda:0')
benign distance is  tensor(4.1331, device='cuda:0')
norm1 res is  tensor(0.1469, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.474884022027254
distance 1 is tensor(193.0277, device='cuda:0')
distance 2 is tensor(14.1035, device='cuda:0')
benign distance is  tensor(14.1035, device='cuda:0')
norm1 res is  tensor(0.1911, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.2358819022774696
distance 1 is tensor(140.3344, device='cuda:0')
distance 2 is tensor(10.5338, device='cuda:0')
benign distance is  tensor(10.5338, device='cuda:0')
norm1 res is  tensor(0.1382, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(350.3170, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(263.1796, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(480.9584, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(733.2667, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(262.9621, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(281.9847, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(326.4221, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(253.1793, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4868.8945, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4928.0371, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4874.5220, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4872.0166, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4870.1548, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4904.1094, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4898.1572, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4886.3853, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4897.7422, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4874.5322, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4897.1606, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4922.0840, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(695.8783, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(526.2681, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(762.4294, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(662.4570, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(553.9308, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(490.7477, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(460.3288, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(567.3627, device='cuda:0')
norm_2 is  tensor(304.7582, device='cuda:0')
norm_2 * lamda is tensor(548.5647, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 86.68% 

Test Accuracy: 88.50% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
 benign loss is  0.681258762255311
distance 1 is tensor(58.8573, device='cuda:0')
distance 2 is tensor(4.5034, device='cuda:0')
benign distance is  tensor(4.5034, device='cuda:0')
norm1 res is  tensor(0.0478, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7551399301737547
distance 1 is tensor(87.6854, device='cuda:0')
distance 2 is tensor(6.4302, device='cuda:0')
benign distance is  tensor(6.4302, device='cuda:0')
norm1 res is  tensor(0.1165, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7585950288921595
distance 1 is tensor(91.2961, device='cuda:0')
distance 2 is tensor(6.8119, device='cuda:0')
benign distance is  tensor(6.8119, device='cuda:0')
norm1 res is  tensor(0.1728, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.4926564283668995
distance 1 is tensor(160.4803, device='cuda:0')
distance 2 is tensor(11.6535, device='cuda:0')
benign distance is  tensor(11.6535, device='cuda:0')
norm1 res is  tensor(0.1115, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.782132538035512
distance 1 is tensor(97.4973, device='cuda:0')
distance 2 is tensor(7.5071, device='cuda:0')
benign distance is  tensor(7.5071, device='cuda:0')
norm1 res is  tensor(0.1135, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8230429077520967
distance 1 is tensor(72.9172, device='cuda:0')
distance 2 is tensor(5.5117, device='cuda:0')
benign distance is  tensor(5.5117, device='cuda:0')
norm1 res is  tensor(0.1246, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2811312973499298
distance 1 is tensor(48.8491, device='cuda:0')
distance 2 is tensor(3.9123, device='cuda:0')
benign distance is  tensor(3.9123, device='cuda:0')
norm1 res is  tensor(0.0573, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.8209174694493413
distance 1 is tensor(50.3541, device='cuda:0')
distance 2 is tensor(4.0091, device='cuda:0')
benign distance is  tensor(4.0091, device='cuda:0')
norm1 res is  tensor(0.0816, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7732010763138533
distance 1 is tensor(145.6176, device='cuda:0')
distance 2 is tensor(11.0273, device='cuda:0')
benign distance is  tensor(11.0273, device='cuda:0')
norm1 res is  tensor(0.1819, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.132132425904274
distance 1 is tensor(127.1595, device='cuda:0')
distance 2 is tensor(9.2405, device='cuda:0')
benign distance is  tensor(9.2405, device='cuda:0')
norm1 res is  tensor(0.1735, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.7757056765258312
distance 1 is tensor(193.6961, device='cuda:0')
distance 2 is tensor(14.0974, device='cuda:0')
benign distance is  tensor(14.0974, device='cuda:0')
norm1 res is  tensor(0.1868, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.8185792043805122
distance 1 is tensor(169.2838, device='cuda:0')
distance 2 is tensor(12.2603, device='cuda:0')
benign distance is  tensor(12.2603, device='cuda:0')
norm1 res is  tensor(0.1238, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.9700138792395592
distance 1 is tensor(144.7334, device='cuda:0')
distance 2 is tensor(10.7234, device='cuda:0')
benign distance is  tensor(10.7234, device='cuda:0')
norm1 res is  tensor(0.1563, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.7314513046294451
distance 1 is tensor(112.4407, device='cuda:0')
distance 2 is tensor(8.3075, device='cuda:0')
benign distance is  tensor(8.3075, device='cuda:0')
norm1 res is  tensor(0.1473, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.7933494001626968
distance 1 is tensor(111.2737, device='cuda:0')
distance 2 is tensor(8.3991, device='cuda:0')
benign distance is  tensor(8.3991, device='cuda:0')
norm1 res is  tensor(0.2323, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.6537546422332525
distance 1 is tensor(156.2998, device='cuda:0')
distance 2 is tensor(11.5026, device='cuda:0')
benign distance is  tensor(11.5026, device='cuda:0')
norm1 res is  tensor(0.1882, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(253.1923, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(374.2737, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(398.4767, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(712.0911, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(430.6913, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(324.1992, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(216.7826, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(223.7357, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4867.9937, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4921.6084, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4867.1646, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4878.7861, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4873.8315, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4899.6826, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4905.0127, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4883.9971, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4902.2241, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4883.4980, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4890.0513, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4942.7788, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(600.6969, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(746.4230, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(742.8438, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(470.1866, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(826.7277, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(722.8579, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(491.4391, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(666.8241, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(576.8401, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(429.3193, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(719.1709, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(604.9920, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(633.1420, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(992.2430, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(583.2058, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(933.0740, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(835.5717, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(597.3051, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(656.2282, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(611.5802, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(317.8553, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1079.0092, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(676.4658, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(569.9338, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(476.2882, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(643.2627, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(300.6568, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(574.4282, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(1016.9950, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(262.0577, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(856.2110, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
do  not satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(632.9404, device='cuda:0')
norm_2 is  tensor(372.2873, device='cuda:0')
norm_2 * lamda is tensor(670.1172, device='cuda:0')
satisfying 51
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 86.80% 

Test Accuracy: 88.68% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6811501067131758
distance 1 is tensor(56.6530, device='cuda:0')
distance 2 is tensor(4.3596, device='cuda:0')
benign distance is  tensor(4.3596, device='cuda:0')
norm1 res is  tensor(0.0462, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7098716348409653
distance 1 is tensor(64.4729, device='cuda:0')
distance 2 is tensor(4.9769, device='cuda:0')
benign distance is  tensor(4.9769, device='cuda:0')
norm1 res is  tensor(0.0890, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8001184202730656
distance 1 is tensor(100.5587, device='cuda:0')
distance 2 is tensor(7.4531, device='cuda:0')
benign distance is  tensor(7.4531, device='cuda:0')
norm1 res is  tensor(0.1887, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.96323361992836
distance 1 is tensor(136.9035, device='cuda:0')
distance 2 is tensor(10.1239, device='cuda:0')
benign distance is  tensor(10.1239, device='cuda:0')
norm1 res is  tensor(0.0960, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8167463280260563
distance 1 is tensor(54.8362, device='cuda:0')
distance 2 is tensor(4.2562, device='cuda:0')
benign distance is  tensor(4.2562, device='cuda:0')
norm1 res is  tensor(0.0562, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6569776441901922
distance 1 is tensor(80.5373, device='cuda:0')
distance 2 is tensor(5.9022, device='cuda:0')
benign distance is  tensor(5.9022, device='cuda:0')
norm1 res is  tensor(0.1327, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.177779521793127
distance 1 is tensor(93.6516, device='cuda:0')
distance 2 is tensor(7.1208, device='cuda:0')
benign distance is  tensor(7.1208, device='cuda:0')
norm1 res is  tensor(0.1086, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6437730407342315
distance 1 is tensor(58.1859, device='cuda:0')
distance 2 is tensor(4.4438, device='cuda:0')
benign distance is  tensor(4.4438, device='cuda:0')
norm1 res is  tensor(0.0952, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.5336611792445183
distance 1 is tensor(105.9587, device='cuda:0')
distance 2 is tensor(7.9370, device='cuda:0')
benign distance is  tensor(7.9370, device='cuda:0')
norm1 res is  tensor(0.1188, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8677021004259586
distance 1 is tensor(145.3437, device='cuda:0')
distance 2 is tensor(10.7518, device='cuda:0')
benign distance is  tensor(10.7518, device='cuda:0')
norm1 res is  tensor(0.1598, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.8758474700152874
distance 1 is tensor(65.5807, device='cuda:0')
distance 2 is tensor(5.0701, device='cuda:0')
benign distance is  tensor(5.0701, device='cuda:0')
norm1 res is  tensor(0.0882, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3290782496333122
distance 1 is tensor(140.8023, device='cuda:0')
distance 2 is tensor(10.3953, device='cuda:0')
benign distance is  tensor(10.3953, device='cuda:0')
norm1 res is  tensor(0.1429, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  0.9467935729771852
distance 1 is tensor(191.6467, device='cuda:0')
distance 2 is tensor(13.8328, device='cuda:0')
benign distance is  tensor(13.8328, device='cuda:0')
norm1 res is  tensor(0.1249, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6092756856232882
distance 1 is tensor(53.5923, device='cuda:0')
distance 2 is tensor(4.0174, device='cuda:0')
benign distance is  tensor(4.0174, device='cuda:0')
norm1 res is  tensor(0.1465, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.0129394074901938
distance 1 is tensor(144.1782, device='cuda:0')
distance 2 is tensor(10.6371, device='cuda:0')
benign distance is  tensor(10.6371, device='cuda:0')
norm1 res is  tensor(0.1451, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.3562150932848454
distance 1 is tensor(120.5925, device='cuda:0')
distance 2 is tensor(9.0588, device='cuda:0')
benign distance is  tensor(9.0588, device='cuda:0')
norm1 res is  tensor(0.1174, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.142011795192957
distance 1 is tensor(114.6484, device='cuda:0')
distance 2 is tensor(8.7288, device='cuda:0')
benign distance is  tensor(8.7288, device='cuda:0')
norm1 res is  tensor(0.1755, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7652738187462091
distance 1 is tensor(125.8874, device='cuda:0')
distance 2 is tensor(9.1264, device='cuda:0')
benign distance is  tensor(9.1264, device='cuda:0')
norm1 res is  tensor(0.1592, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.9552277959883213
distance 1 is tensor(132.5000, device='cuda:0')
distance 2 is tensor(9.6074, device='cuda:0')
benign distance is  tensor(9.6074, device='cuda:0')
norm1 res is  tensor(0.1327, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.1231843959540129
distance 1 is tensor(136.9301, device='cuda:0')
distance 2 is tensor(10.1158, device='cuda:0')
benign distance is  tensor(10.1158, device='cuda:0')
norm1 res is  tensor(0.1259, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.8829552317038178
distance 1 is tensor(101.9892, device='cuda:0')
distance 2 is tensor(7.4347, device='cuda:0')
benign distance is  tensor(7.4347, device='cuda:0')
norm1 res is  tensor(0.1299, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9345760773867369
distance 1 is tensor(247.2203, device='cuda:0')
distance 2 is tensor(17.9056, device='cuda:0')
benign distance is  tensor(17.9056, device='cuda:0')
norm1 res is  tensor(0.1328, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.3642060235142708
distance 1 is tensor(170.7335, device='cuda:0')
distance 2 is tensor(12.4617, device='cuda:0')
benign distance is  tensor(12.4617, device='cuda:0')
norm1 res is  tensor(0.1091, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.8693631384521723
distance 1 is tensor(119.7851, device='cuda:0')
distance 2 is tensor(8.7966, device='cuda:0')
benign distance is  tensor(8.7966, device='cuda:0')
norm1 res is  tensor(0.1070, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.2286525145173073
distance 1 is tensor(153.2945, device='cuda:0')
distance 2 is tensor(11.3148, device='cuda:0')
benign distance is  tensor(11.3148, device='cuda:0')
norm1 res is  tensor(0.1695, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.6891844421625137
distance 1 is tensor(90.5337, device='cuda:0')
distance 2 is tensor(6.9601, device='cuda:0')
benign distance is  tensor(6.9601, device='cuda:0')
norm1 res is  tensor(0.2664, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.2730318121612072
distance 1 is tensor(158.6849, device='cuda:0')
distance 2 is tensor(11.8347, device='cuda:0')
benign distance is  tensor(11.8347, device='cuda:0')
norm1 res is  tensor(0.1381, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.59386732801795
distance 1 is tensor(138.4209, device='cuda:0')
distance 2 is tensor(10.2863, device='cuda:0')
benign distance is  tensor(10.2863, device='cuda:0')
norm1 res is  tensor(0.1541, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.1004108861088753
distance 1 is tensor(137.6566, device='cuda:0')
distance 2 is tensor(10.1938, device='cuda:0')
benign distance is  tensor(10.1938, device='cuda:0')
norm1 res is  tensor(0.1554, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.9280240833759308
distance 1 is tensor(124.1334, device='cuda:0')
distance 2 is tensor(9.2775, device='cuda:0')
benign distance is  tensor(9.2775, device='cuda:0')
norm1 res is  tensor(0.1338, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5246937461197376
distance 1 is tensor(145.7357, device='cuda:0')
distance 2 is tensor(10.6033, device='cuda:0')
benign distance is  tensor(10.6033, device='cuda:0')
norm1 res is  tensor(0.1656, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.7192850448191166
distance 1 is tensor(197.1278, device='cuda:0')
distance 2 is tensor(14.4092, device='cuda:0')
benign distance is  tensor(14.4092, device='cuda:0')
norm1 res is  tensor(0.1768, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.160625584423542
distance 1 is tensor(146.8957, device='cuda:0')
distance 2 is tensor(11.2177, device='cuda:0')
benign distance is  tensor(11.2177, device='cuda:0')
norm1 res is  tensor(0.1599, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.460170865058899
distance 1 is tensor(197.9666, device='cuda:0')
distance 2 is tensor(14.9307, device='cuda:0')
benign distance is  tensor(14.9307, device='cuda:0')
norm1 res is  tensor(0.2006, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.6935554631054401
distance 1 is tensor(177.9163, device='cuda:0')
distance 2 is tensor(13.0748, device='cuda:0')
benign distance is  tensor(13.0748, device='cuda:0')
norm1 res is  tensor(0.1244, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  1.0023567844182253
distance 1 is tensor(105.3432, device='cuda:0')
distance 2 is tensor(8.1316, device='cuda:0')
benign distance is  tensor(8.1316, device='cuda:0')
norm1 res is  tensor(0.2465, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.7432611957192421
distance 1 is tensor(188.2326, device='cuda:0')
distance 2 is tensor(13.6663, device='cuda:0')
benign distance is  tensor(13.6663, device='cuda:0')
norm1 res is  tensor(0.1815, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.7746011577546597
distance 1 is tensor(162.3217, device='cuda:0')
distance 2 is tensor(11.7850, device='cuda:0')
benign distance is  tensor(11.7850, device='cuda:0')
norm1 res is  tensor(0.1992, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.8406906854361296
distance 1 is tensor(131.3501, device='cuda:0')
distance 2 is tensor(9.7702, device='cuda:0')
benign distance is  tensor(9.7702, device='cuda:0')
norm1 res is  tensor(0.1859, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5304550100117922
distance 1 is tensor(147.3564, device='cuda:0')
distance 2 is tensor(10.8154, device='cuda:0')
benign distance is  tensor(10.8154, device='cuda:0')
norm1 res is  tensor(0.1664, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(242.8474, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(275.2679, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(444.6466, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(609.9859, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(232.8470, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(345.4776, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(409.3531, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(253.8388, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4864.3286, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4914.3652, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4870.9185, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4903.7388, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4879.5063, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4903.9644, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4899.0693, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4879.9688, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4892.2197, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4894.1846, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4880.8784, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4945.3833, device='cuda:0')
norm_2 is  tensor(284.9516, device='cuda:0')
norm_2 * lamda is tensor(512.9128, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 88.91% 

Test Accuracy: 89.01% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6832047067582607
distance 1 is tensor(76.2488, device='cuda:0')
distance 2 is tensor(5.9107, device='cuda:0')
benign distance is  tensor(5.9107, device='cuda:0')
norm1 res is  tensor(0.0656, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6730024171993136
distance 1 is tensor(84.5801, device='cuda:0')
distance 2 is tensor(6.3970, device='cuda:0')
benign distance is  tensor(6.3970, device='cuda:0')
norm1 res is  tensor(0.1220, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7883449587970972
distance 1 is tensor(84.6868, device='cuda:0')
distance 2 is tensor(6.2881, device='cuda:0')
benign distance is  tensor(6.2881, device='cuda:0')
norm1 res is  tensor(0.1587, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.1124298349022865
distance 1 is tensor(148.7458, device='cuda:0')
distance 2 is tensor(10.8968, device='cuda:0')
benign distance is  tensor(10.8968, device='cuda:0')
norm1 res is  tensor(0.1079, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9247852955013514
distance 1 is tensor(97.4899, device='cuda:0')
distance 2 is tensor(7.1616, device='cuda:0')
benign distance is  tensor(7.1616, device='cuda:0')
norm1 res is  tensor(0.1018, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6045477173756808
distance 1 is tensor(39.5272, device='cuda:0')
distance 2 is tensor(3.1539, device='cuda:0')
benign distance is  tensor(3.1539, device='cuda:0')
norm1 res is  tensor(0.0692, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.1651675682514906
distance 1 is tensor(65.2243, device='cuda:0')
distance 2 is tensor(4.9562, device='cuda:0')
benign distance is  tensor(4.9562, device='cuda:0')
norm1 res is  tensor(0.0725, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6910774875432253
distance 1 is tensor(63.1607, device='cuda:0')
distance 2 is tensor(4.7784, device='cuda:0')
benign distance is  tensor(4.7784, device='cuda:0')
norm1 res is  tensor(0.1050, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(333.7213, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(381.2040, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(361.7917, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(664.4390, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(418.0264, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(176.4225, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(273.3965, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(273.0536, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4887.3545, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4946.8110, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4900.1294, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4909.4624, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4899.4312, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4931.6533, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4937.1963, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4907.9707, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4912.0015, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4888.2412, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4918.6123, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4965.1572, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(475.3047, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(660.0742, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(302.6721, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(619.3757, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(845.7632, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(246.5120, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(650.0999, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(540.9310, device='cuda:0')
norm_2 is  tensor(373.4833, device='cuda:0')
norm_2 * lamda is tensor(672.2700, device='cuda:0')
satisfying 27
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 86.37% 

Test Accuracy: 88.48% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6919682137668133
distance 1 is tensor(61.0577, device='cuda:0')
distance 2 is tensor(4.7435, device='cuda:0')
benign distance is  tensor(4.7435, device='cuda:0')
norm1 res is  tensor(0.0560, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.9283642806112766
distance 1 is tensor(59.3829, device='cuda:0')
distance 2 is tensor(4.5032, device='cuda:0')
benign distance is  tensor(4.5032, device='cuda:0')
norm1 res is  tensor(0.0785, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7094839699566364
distance 1 is tensor(74.5796, device='cuda:0')
distance 2 is tensor(5.8161, device='cuda:0')
benign distance is  tensor(5.8161, device='cuda:0')
norm1 res is  tensor(0.1448, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.6479340381920338
distance 1 is tensor(162.3744, device='cuda:0')
distance 2 is tensor(11.8200, device='cuda:0')
benign distance is  tensor(11.8200, device='cuda:0')
norm1 res is  tensor(0.1140, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8826539232395589
distance 1 is tensor(45.4738, device='cuda:0')
distance 2 is tensor(3.7478, device='cuda:0')
benign distance is  tensor(3.7478, device='cuda:0')
norm1 res is  tensor(0.0481, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7206630045548081
distance 1 is tensor(78.4121, device='cuda:0')
distance 2 is tensor(5.7151, device='cuda:0')
benign distance is  tensor(5.7151, device='cuda:0')
norm1 res is  tensor(0.1335, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.166940450668335
distance 1 is tensor(64.3175, device='cuda:0')
distance 2 is tensor(4.7408, device='cuda:0')
benign distance is  tensor(4.7408, device='cuda:0')
norm1 res is  tensor(0.0711, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7207020707428455
distance 1 is tensor(55.4159, device='cuda:0')
distance 2 is tensor(4.2104, device='cuda:0')
benign distance is  tensor(4.2104, device='cuda:0')
norm1 res is  tensor(0.0861, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.0863381084054708
distance 1 is tensor(93.7456, device='cuda:0')
distance 2 is tensor(6.9107, device='cuda:0')
benign distance is  tensor(6.9107, device='cuda:0')
norm1 res is  tensor(0.1004, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9271879587322474
distance 1 is tensor(144.9176, device='cuda:0')
distance 2 is tensor(10.5993, device='cuda:0')
benign distance is  tensor(10.5993, device='cuda:0')
norm1 res is  tensor(0.1575, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9414734654128551
distance 1 is tensor(60.3042, device='cuda:0')
distance 2 is tensor(4.7755, device='cuda:0')
benign distance is  tensor(4.7755, device='cuda:0')
norm1 res is  tensor(0.0819, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.5004227254539728
distance 1 is tensor(123.3182, device='cuda:0')
distance 2 is tensor(9.1633, device='cuda:0')
benign distance is  tensor(9.1633, device='cuda:0')
norm1 res is  tensor(0.1305, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.2714811451733112
distance 1 is tensor(204.3490, device='cuda:0')
distance 2 is tensor(14.9244, device='cuda:0')
benign distance is  tensor(14.9244, device='cuda:0')
norm1 res is  tensor(0.1348, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7586113912984729
distance 1 is tensor(49.9900, device='cuda:0')
distance 2 is tensor(3.8814, device='cuda:0')
benign distance is  tensor(3.8814, device='cuda:0')
norm1 res is  tensor(0.1345, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  0.9602957665920258
distance 1 is tensor(167.0647, device='cuda:0')
distance 2 is tensor(12.2108, device='cuda:0')
benign distance is  tensor(12.2108, device='cuda:0')
norm1 res is  tensor(0.1702, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.3646759502589703
distance 1 is tensor(135.9325, device='cuda:0')
distance 2 is tensor(10.1506, device='cuda:0')
benign distance is  tensor(10.1506, device='cuda:0')
norm1 res is  tensor(0.1332, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(267.6302, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(254.2377, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(338.9415, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(716.9468, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(197.5188, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(332.7134, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(260.9203, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(235.8967, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4898.6064, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4957.2065, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4907.3408, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4920.7080, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4905.7207, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4932.5527, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4923.9043, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4913.0708, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4939.4790, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4911.4043, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4914.6143, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4972.5010, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(528.6332, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(556.4686, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(574.7996, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(608.0308, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(433.4160, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(1080.2114, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(730.2455, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(540.4226, device='cuda:0')
norm_2 is  tensor(421.0987, device='cuda:0')
norm_2 * lamda is tensor(757.9777, device='cuda:0')
satisfying 27
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 85.76% 

Test Accuracy: 88.23% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6649934034794569
distance 1 is tensor(58.7023, device='cuda:0')
distance 2 is tensor(4.5351, device='cuda:0')
benign distance is  tensor(4.5351, device='cuda:0')
norm1 res is  tensor(0.0484, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6833840422332287
distance 1 is tensor(78.1081, device='cuda:0')
distance 2 is tensor(5.9227, device='cuda:0')
benign distance is  tensor(5.9227, device='cuda:0')
norm1 res is  tensor(0.1075, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8435408659279346
distance 1 is tensor(74.9028, device='cuda:0')
distance 2 is tensor(5.7380, device='cuda:0')
benign distance is  tensor(5.7380, device='cuda:0')
norm1 res is  tensor(0.1504, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.4466905184090137
distance 1 is tensor(152.5813, device='cuda:0')
distance 2 is tensor(11.0558, device='cuda:0')
benign distance is  tensor(11.0558, device='cuda:0')
norm1 res is  tensor(0.1084, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7736505973152816
distance 1 is tensor(43.7843, device='cuda:0')
distance 2 is tensor(3.5808, device='cuda:0')
benign distance is  tensor(3.5808, device='cuda:0')
norm1 res is  tensor(0.0501, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6425001272000372
distance 1 is tensor(56.9222, device='cuda:0')
distance 2 is tensor(4.2469, device='cuda:0')
benign distance is  tensor(4.2469, device='cuda:0')
norm1 res is  tensor(0.0979, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.4492658376693726
distance 1 is tensor(56.3030, device='cuda:0')
distance 2 is tensor(4.5385, device='cuda:0')
benign distance is  tensor(4.5385, device='cuda:0')
norm1 res is  tensor(0.0678, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6824352983385324
distance 1 is tensor(53.6050, device='cuda:0')
distance 2 is tensor(4.1646, device='cuda:0')
benign distance is  tensor(4.1646, device='cuda:0')
norm1 res is  tensor(0.0877, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  0.9298981465399265
distance 1 is tensor(104.1975, device='cuda:0')
distance 2 is tensor(8.0707, device='cuda:0')
benign distance is  tensor(8.0707, device='cuda:0')
norm1 res is  tensor(0.1575, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.7036907356232405
distance 1 is tensor(123.9991, device='cuda:0')
distance 2 is tensor(9.3331, device='cuda:0')
benign distance is  tensor(9.3331, device='cuda:0')
norm1 res is  tensor(0.1650, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  0.8072294350713491
distance 1 is tensor(149.7827, device='cuda:0')
distance 2 is tensor(10.7202, device='cuda:0')
benign distance is  tensor(10.7202, device='cuda:0')
norm1 res is  tensor(0.1486, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.0998906828463078
distance 1 is tensor(139.0976, device='cuda:0')
distance 2 is tensor(10.3041, device='cuda:0')
benign distance is  tensor(10.3041, device='cuda:0')
norm1 res is  tensor(0.1291, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.1258065178990364
distance 1 is tensor(81.8769, device='cuda:0')
distance 2 is tensor(6.0635, device='cuda:0')
benign distance is  tensor(6.0635, device='cuda:0')
norm1 res is  tensor(0.1036, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.700494697317481
distance 1 is tensor(239.4407, device='cuda:0')
distance 2 is tensor(17.5039, device='cuda:0')
benign distance is  tensor(17.5039, device='cuda:0')
norm1 res is  tensor(0.1294, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.2387550808489323
distance 1 is tensor(146.1391, device='cuda:0')
distance 2 is tensor(10.8112, device='cuda:0')
benign distance is  tensor(10.8112, device='cuda:0')
norm1 res is  tensor(0.0962, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.6475674714893103
distance 1 is tensor(107.1879, device='cuda:0')
distance 2 is tensor(8.0011, device='cuda:0')
benign distance is  tensor(8.0011, device='cuda:0')
norm1 res is  tensor(0.0956, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(256.2961, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(343.1111, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(330.4783, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(677.5725, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(200.4809, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(239.1590, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(255.1479, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(234.9928, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4900.3198, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4960.2876, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4912.2339, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4945.2041, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4924.4927, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4943.5977, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4957.5308, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4921.6050, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4928.6353, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4913.2842, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4937.8892, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4986.5815, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(677.9366, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(566.9467, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(856.3063, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(738.4191, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(640.9407, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(522.8380, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(527.1535, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(692.8398, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(685.1265, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(429.7395, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(712.9431, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(615.1845, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(621.6693, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(577.8760, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(655.8222, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(876.2869, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(409.4405, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(644.4553, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(285.7450, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(545.7888, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(910.3033, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(242.8907, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(755.6788, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(609.2426, device='cuda:0')
norm_2 is  tensor(225.8682, device='cuda:0')
norm_2 * lamda is tensor(406.5628, device='cuda:0')
do  not satisfying 43
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 86.82% 

Test Accuracy: 88.73% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7464753016829491
distance 1 is tensor(87.0734, device='cuda:0')
distance 2 is tensor(6.5091, device='cuda:0')
benign distance is  tensor(6.5091, device='cuda:0')
norm1 res is  tensor(0.0724, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.5944045875221491
distance 1 is tensor(66.5419, device='cuda:0')
distance 2 is tensor(5.0820, device='cuda:0')
benign distance is  tensor(5.0820, device='cuda:0')
norm1 res is  tensor(0.0962, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7959454096853733
distance 1 is tensor(74.8277, device='cuda:0')
distance 2 is tensor(5.6026, device='cuda:0')
benign distance is  tensor(5.6026, device='cuda:0')
norm1 res is  tensor(0.1388, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.4985057935118675
distance 1 is tensor(174.9660, device='cuda:0')
distance 2 is tensor(12.5918, device='cuda:0')
benign distance is  tensor(12.5918, device='cuda:0')
norm1 res is  tensor(0.1191, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.0743310553953052
distance 1 is tensor(136.4615, device='cuda:0')
distance 2 is tensor(10.7419, device='cuda:0')
benign distance is  tensor(10.7419, device='cuda:0')
norm1 res is  tensor(0.1531, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.802238468080759
distance 1 is tensor(65.9703, device='cuda:0')
distance 2 is tensor(5.0246, device='cuda:0')
benign distance is  tensor(5.0246, device='cuda:0')
norm1 res is  tensor(0.1182, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  0.9983976725488901
distance 1 is tensor(102.1512, device='cuda:0')
distance 2 is tensor(7.6392, device='cuda:0')
benign distance is  tensor(7.6392, device='cuda:0')
norm1 res is  tensor(0.1177, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7844588225707412
distance 1 is tensor(71.1539, device='cuda:0')
distance 2 is tensor(5.2814, device='cuda:0')
benign distance is  tensor(5.2814, device='cuda:0')
norm1 res is  tensor(0.1152, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.109021121636033
distance 1 is tensor(115.1191, device='cuda:0')
distance 2 is tensor(8.5122, device='cuda:0')
benign distance is  tensor(8.5122, device='cuda:0')
norm1 res is  tensor(0.1293, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0188524508848786
distance 1 is tensor(161.8111, device='cuda:0')
distance 2 is tensor(11.8460, device='cuda:0')
benign distance is  tensor(11.8460, device='cuda:0')
norm1 res is  tensor(0.1739, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.8602443430572748
distance 1 is tensor(70.8717, device='cuda:0')
distance 2 is tensor(5.5064, device='cuda:0')
benign distance is  tensor(5.5064, device='cuda:0')
norm1 res is  tensor(0.0983, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.2677444107830524
distance 1 is tensor(125.3968, device='cuda:0')
distance 2 is tensor(9.2698, device='cuda:0')
benign distance is  tensor(9.2698, device='cuda:0')
norm1 res is  tensor(0.1286, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.3733649887144566
distance 1 is tensor(212.5775, device='cuda:0')
distance 2 is tensor(15.2421, device='cuda:0')
benign distance is  tensor(15.2421, device='cuda:0')
norm1 res is  tensor(0.1376, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.6163894534111023
distance 1 is tensor(67.7919, device='cuda:0')
distance 2 is tensor(5.0636, device='cuda:0')
benign distance is  tensor(5.0636, device='cuda:0')
norm1 res is  tensor(0.1879, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.6158823743462563
distance 1 is tensor(170.8206, device='cuda:0')
distance 2 is tensor(12.1921, device='cuda:0')
benign distance is  tensor(12.1921, device='cuda:0')
norm1 res is  tensor(0.1704, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.3442133571952581
distance 1 is tensor(147.1529, device='cuda:0')
distance 2 is tensor(10.8898, device='cuda:0')
benign distance is  tensor(10.8898, device='cuda:0')
norm1 res is  tensor(0.1424, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.1032495778054
distance 1 is tensor(156.4543, device='cuda:0')
distance 2 is tensor(11.5503, device='cuda:0')
benign distance is  tensor(11.5503, device='cuda:0')
norm1 res is  tensor(0.1735, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.7073263376951218
distance 1 is tensor(96.8718, device='cuda:0')
distance 2 is tensor(7.3753, device='cuda:0')
benign distance is  tensor(7.3753, device='cuda:0')
norm1 res is  tensor(0.2800, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.3495561704039574
distance 1 is tensor(160.2567, device='cuda:0')
distance 2 is tensor(11.9293, device='cuda:0')
benign distance is  tensor(11.9293, device='cuda:0')
norm1 res is  tensor(0.1388, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.51107557117939
distance 1 is tensor(143.7829, device='cuda:0')
distance 2 is tensor(10.5680, device='cuda:0')
benign distance is  tensor(10.5680, device='cuda:0')
norm1 res is  tensor(0.1585, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.0027128662914038
distance 1 is tensor(149.3743, device='cuda:0')
distance 2 is tensor(11.0412, device='cuda:0')
benign distance is  tensor(11.0412, device='cuda:0')
norm1 res is  tensor(0.1688, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  0.899653029628098
distance 1 is tensor(132.6993, device='cuda:0')
distance 2 is tensor(9.9199, device='cuda:0')
benign distance is  tensor(9.9199, device='cuda:0')
norm1 res is  tensor(0.1421, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5313935438171029
distance 1 is tensor(162.5123, device='cuda:0')
distance 2 is tensor(11.8149, device='cuda:0')
benign distance is  tensor(11.8149, device='cuda:0')
norm1 res is  tensor(0.1835, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.938945185393095
distance 1 is tensor(212.7485, device='cuda:0')
distance 2 is tensor(15.3859, device='cuda:0')
benign distance is  tensor(15.3859, device='cuda:0')
norm1 res is  tensor(0.1873, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.8279075268656015
distance 1 is tensor(160.2910, device='cuda:0')
distance 2 is tensor(12.0118, device='cuda:0')
benign distance is  tensor(12.0118, device='cuda:0')
norm1 res is  tensor(0.1986, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  0.9306753426790237
distance 1 is tensor(153.2156, device='cuda:0')
distance 2 is tensor(12.0869, device='cuda:0')
benign distance is  tensor(12.0869, device='cuda:0')
norm1 res is  tensor(0.2272, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.7915489971637726
distance 1 is tensor(184.1650, device='cuda:0')
distance 2 is tensor(13.5770, device='cuda:0')
benign distance is  tensor(13.5770, device='cuda:0')
norm1 res is  tensor(0.1818, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.057115986943245
distance 1 is tensor(160.7591, device='cuda:0')
distance 2 is tensor(11.8821, device='cuda:0')
benign distance is  tensor(11.8821, device='cuda:0')
norm1 res is  tensor(0.1209, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.6557114757597446
distance 1 is tensor(156.8229, device='cuda:0')
distance 2 is tensor(11.7554, device='cuda:0')
benign distance is  tensor(11.7554, device='cuda:0')
norm1 res is  tensor(0.1718, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.8692388711497188
distance 1 is tensor(105.5943, device='cuda:0')
distance 2 is tensor(7.8894, device='cuda:0')
benign distance is  tensor(7.8894, device='cuda:0')
norm1 res is  tensor(0.1324, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  1.1697996035218239
distance 1 is tensor(113.3331, device='cuda:0')
distance 2 is tensor(8.4634, device='cuda:0')
benign distance is  tensor(8.4634, device='cuda:0')
norm1 res is  tensor(0.2346, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.7740954868495464
distance 1 is tensor(151.7308, device='cuda:0')
distance 2 is tensor(11.2610, device='cuda:0')
benign distance is  tensor(11.2610, device='cuda:0')
norm1 res is  tensor(0.1820, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(381.8512, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(293.9178, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(330.7353, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(757.8331, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(628.2835, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(290.8592, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(443.4354, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(298.3552, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4919.5825, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4989.7905, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4933.5488, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4939.0967, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4936.0015, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4960.1948, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4956.8247, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4927.2090, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4957.2954, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4924.1025, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4948.2314, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(4989.8887, device='cuda:0')
norm_2 is  tensor(478.3868, device='cuda:0')
norm_2 * lamda is tensor(861.0962, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 87.86% 

Test Accuracy: 88.66% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7962910924106836
distance 1 is tensor(84.2374, device='cuda:0')
distance 2 is tensor(6.2421, device='cuda:0')
benign distance is  tensor(6.2421, device='cuda:0')
norm1 res is  tensor(0.0676, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.77715621329844
distance 1 is tensor(54.0329, device='cuda:0')
distance 2 is tensor(4.1263, device='cuda:0')
benign distance is  tensor(4.1263, device='cuda:0')
norm1 res is  tensor(0.0722, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.5881261732429266
distance 1 is tensor(75.6488, device='cuda:0')
distance 2 is tensor(5.7490, device='cuda:0')
benign distance is  tensor(5.7490, device='cuda:0')
norm1 res is  tensor(0.1492, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0127375945448875
distance 1 is tensor(150.7619, device='cuda:0')
distance 2 is tensor(10.9504, device='cuda:0')
benign distance is  tensor(10.9504, device='cuda:0')
norm1 res is  tensor(0.1046, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7814306202344596
distance 1 is tensor(49.7658, device='cuda:0')
distance 2 is tensor(3.9543, device='cuda:0')
benign distance is  tensor(3.9543, device='cuda:0')
norm1 res is  tensor(0.0528, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6402631714008749
distance 1 is tensor(88.9174, device='cuda:0')
distance 2 is tensor(6.5872, device='cuda:0')
benign distance is  tensor(6.5872, device='cuda:0')
norm1 res is  tensor(0.1506, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2696192134171724
distance 1 is tensor(55.4449, device='cuda:0')
distance 2 is tensor(4.4983, device='cuda:0')
benign distance is  tensor(4.4983, device='cuda:0')
norm1 res is  tensor(0.0689, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7283305823802948
distance 1 is tensor(69.7841, device='cuda:0')
distance 2 is tensor(5.3837, device='cuda:0')
benign distance is  tensor(5.3837, device='cuda:0')
norm1 res is  tensor(0.1221, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(357.1798, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(228.9989, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(333.0337, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(659.7161, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(217.5761, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(387.1406, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(254.3879, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(309.1348, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4950.5347, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5000.3384, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4950.7852, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4972.0239, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4966.8101, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4980.8940, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4982.7476, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4953.9126, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4967.4785, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4955.6255, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4981.1309, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5007.3999, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(693.2633, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(910.2864, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(799.6232, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(497.6043, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(855.9803, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(746.5706, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(618.4117, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(673.7178, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(495.0968, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(583.5238, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(654.7397, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(632.4861, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(375.1437, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1056.9386, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(657.8576, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(504.7995, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(524.0707, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(728.5621, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(341.1541, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(568.4045, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(933.6791, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
do  not satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(321.1310, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(763.8875, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(653.7754, device='cuda:0')
norm_2 is  tensor(436.2350, device='cuda:0')
norm_2 * lamda is tensor(785.2230, device='cuda:0')
satisfying 43
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 86.73% 

Test Accuracy: 88.62% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7174056638032198
distance 1 is tensor(63.6005, device='cuda:0')
distance 2 is tensor(4.9146, device='cuda:0')
benign distance is  tensor(4.9146, device='cuda:0')
norm1 res is  tensor(0.0525, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.6895108707249165
distance 1 is tensor(64.9720, device='cuda:0')
distance 2 is tensor(5.0015, device='cuda:0')
benign distance is  tensor(5.0015, device='cuda:0')
norm1 res is  tensor(0.0879, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7756554670631886
distance 1 is tensor(83.7806, device='cuda:0')
distance 2 is tensor(6.3312, device='cuda:0')
benign distance is  tensor(6.3312, device='cuda:0')
norm1 res is  tensor(0.1566, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3685143124312162
distance 1 is tensor(142.3770, device='cuda:0')
distance 2 is tensor(10.4559, device='cuda:0')
benign distance is  tensor(10.4559, device='cuda:0')
norm1 res is  tensor(0.0987, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.7496032072231174
distance 1 is tensor(45.1457, device='cuda:0')
distance 2 is tensor(3.7199, device='cuda:0')
benign distance is  tensor(3.7199, device='cuda:0')
norm1 res is  tensor(0.0495, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.8081567483022809
distance 1 is tensor(60.9455, device='cuda:0')
distance 2 is tensor(4.5671, device='cuda:0')
benign distance is  tensor(4.5671, device='cuda:0')
norm1 res is  tensor(0.1039, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.0424585109576583
distance 1 is tensor(72.1991, device='cuda:0')
distance 2 is tensor(5.5354, device='cuda:0')
benign distance is  tensor(5.5354, device='cuda:0')
norm1 res is  tensor(0.0869, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6650763805955648
distance 1 is tensor(76.3610, device='cuda:0')
distance 2 is tensor(5.8024, device='cuda:0')
benign distance is  tensor(5.8024, device='cuda:0')
norm1 res is  tensor(0.1246, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.1280580200254917
distance 1 is tensor(120.2602, device='cuda:0')
distance 2 is tensor(8.7281, device='cuda:0')
benign distance is  tensor(8.7281, device='cuda:0')
norm1 res is  tensor(0.1339, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.8801979869604111
distance 1 is tensor(123.3512, device='cuda:0')
distance 2 is tensor(8.9931, device='cuda:0')
benign distance is  tensor(8.9931, device='cuda:0')
norm1 res is  tensor(0.1309, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.8934229705482721
distance 1 is tensor(60.5926, device='cuda:0')
distance 2 is tensor(4.8534, device='cuda:0')
benign distance is  tensor(4.8534, device='cuda:0')
norm1 res is  tensor(0.0841, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.0546515546739101
distance 1 is tensor(111.2506, device='cuda:0')
distance 2 is tensor(8.2764, device='cuda:0')
benign distance is  tensor(8.2764, device='cuda:0')
norm1 res is  tensor(0.1176, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.3279123939573765
distance 1 is tensor(191.9225, device='cuda:0')
distance 2 is tensor(13.7632, device='cuda:0')
benign distance is  tensor(13.7632, device='cuda:0')
norm1 res is  tensor(0.1249, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.594617719296366
distance 1 is tensor(51.4659, device='cuda:0')
distance 2 is tensor(3.8311, device='cuda:0')
benign distance is  tensor(3.8311, device='cuda:0')
norm1 res is  tensor(0.1343, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.2358342166990042
distance 1 is tensor(161.2301, device='cuda:0')
distance 2 is tensor(11.6294, device='cuda:0')
benign distance is  tensor(11.6294, device='cuda:0')
norm1 res is  tensor(0.1601, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.538530271500349
distance 1 is tensor(154.9812, device='cuda:0')
distance 2 is tensor(11.5141, device='cuda:0')
benign distance is  tensor(11.5141, device='cuda:0')
norm1 res is  tensor(0.1530, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.4544941671192646
distance 1 is tensor(162.3295, device='cuda:0')
distance 2 is tensor(11.9970, device='cuda:0')
benign distance is  tensor(11.9970, device='cuda:0')
norm1 res is  tensor(0.2373, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.8549768142402172
distance 1 is tensor(130.1668, device='cuda:0')
distance 2 is tensor(9.5391, device='cuda:0')
benign distance is  tensor(9.5391, device='cuda:0')
norm1 res is  tensor(0.1658, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.0820987224578857
distance 1 is tensor(132.9929, device='cuda:0')
distance 2 is tensor(9.6939, device='cuda:0')
benign distance is  tensor(9.6939, device='cuda:0')
norm1 res is  tensor(0.1356, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  0.9769316613674164
distance 1 is tensor(126.3726, device='cuda:0')
distance 2 is tensor(9.2970, device='cuda:0')
benign distance is  tensor(9.2970, device='cuda:0')
norm1 res is  tensor(0.1141, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  1.0923858005553484
distance 1 is tensor(78.2893, device='cuda:0')
distance 2 is tensor(5.7319, device='cuda:0')
benign distance is  tensor(5.7319, device='cuda:0')
norm1 res is  tensor(0.0977, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.9821531735360622
distance 1 is tensor(256.9103, device='cuda:0')
distance 2 is tensor(18.6572, device='cuda:0')
benign distance is  tensor(18.6572, device='cuda:0')
norm1 res is  tensor(0.1355, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.273863460868597
distance 1 is tensor(169.9380, device='cuda:0')
distance 2 is tensor(12.4476, device='cuda:0')
benign distance is  tensor(12.4476, device='cuda:0')
norm1 res is  tensor(0.1106, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.8598589152097702
distance 1 is tensor(125.1989, device='cuda:0')
distance 2 is tensor(9.2273, device='cuda:0')
benign distance is  tensor(9.2273, device='cuda:0')
norm1 res is  tensor(0.1121, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.7376376129686832
distance 1 is tensor(148.0406, device='cuda:0')
distance 2 is tensor(11.0669, device='cuda:0')
benign distance is  tensor(11.0669, device='cuda:0')
norm1 res is  tensor(0.1517, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.4349409155547619
distance 1 is tensor(162.3263, device='cuda:0')
distance 2 is tensor(12.1956, device='cuda:0')
benign distance is  tensor(12.1956, device='cuda:0')
norm1 res is  tensor(0.1618, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.2768352702260017
distance 1 is tensor(180.8577, device='cuda:0')
distance 2 is tensor(13.3323, device='cuda:0')
benign distance is  tensor(13.3323, device='cuda:0')
norm1 res is  tensor(0.1255, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  1.136943519115448
distance 1 is tensor(131.7184, device='cuda:0')
distance 2 is tensor(9.7851, device='cuda:0')
benign distance is  tensor(9.7851, device='cuda:0')
norm1 res is  tensor(0.3079, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.7909119408577681
distance 1 is tensor(200.8145, device='cuda:0')
distance 2 is tensor(14.7147, device='cuda:0')
benign distance is  tensor(14.7147, device='cuda:0')
norm1 res is  tensor(0.1939, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  1.0859431251883507
distance 1 is tensor(181.7531, device='cuda:0')
distance 2 is tensor(13.1187, device='cuda:0')
benign distance is  tensor(13.1187, device='cuda:0')
norm1 res is  tensor(0.2211, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.897414380684495
distance 1 is tensor(115.6825, device='cuda:0')
distance 2 is tensor(8.5967, device='cuda:0')
benign distance is  tensor(8.5967, device='cuda:0')
norm1 res is  tensor(0.1618, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5980749884620309
distance 1 is tensor(160.8437, device='cuda:0')
distance 2 is tensor(11.6334, device='cuda:0')
benign distance is  tensor(11.6334, device='cuda:0')
norm1 res is  tensor(0.1800, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(277.8317, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(280.6649, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(368.0305, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(620.9659, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(200.1565, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(261.7594, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(317.1318, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(333.3690, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4925.3198, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(4992.0610, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4944.6821, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4943.8228, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4946.7861, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4961.2173, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4966.0889, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4950.2671, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4986.5391, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4940.2539, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4960.5010, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5012.6675, device='cuda:0')
norm_2 is  tensor(376.3724, device='cuda:0')
norm_2 * lamda is tensor(677.4704, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 86.70% 

Test Accuracy: 88.60% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6353979241102934
distance 1 is tensor(45.9403, device='cuda:0')
distance 2 is tensor(3.5680, device='cuda:0')
benign distance is  tensor(3.5680, device='cuda:0')
norm1 res is  tensor(0.0371, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8339181188493967
distance 1 is tensor(73.6740, device='cuda:0')
distance 2 is tensor(5.6869, device='cuda:0')
benign distance is  tensor(5.6869, device='cuda:0')
norm1 res is  tensor(0.1046, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7218617033213377
distance 1 is tensor(79.3820, device='cuda:0')
distance 2 is tensor(5.9644, device='cuda:0')
benign distance is  tensor(5.9644, device='cuda:0')
norm1 res is  tensor(0.1479, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0668745581060648
distance 1 is tensor(159.7451, device='cuda:0')
distance 2 is tensor(11.6259, device='cuda:0')
benign distance is  tensor(11.6259, device='cuda:0')
norm1 res is  tensor(0.1111, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.713757541961968
distance 1 is tensor(67.0739, device='cuda:0')
distance 2 is tensor(5.1593, device='cuda:0')
benign distance is  tensor(5.1593, device='cuda:0')
norm1 res is  tensor(0.0712, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.9068178655579686
distance 1 is tensor(83.1421, device='cuda:0')
distance 2 is tensor(6.1816, device='cuda:0')
benign distance is  tensor(6.1816, device='cuda:0')
norm1 res is  tensor(0.1380, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2907341495156288
distance 1 is tensor(55.1520, device='cuda:0')
distance 2 is tensor(4.1853, device='cuda:0')
benign distance is  tensor(4.1853, device='cuda:0')
norm1 res is  tensor(0.0620, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7401768071576953
distance 1 is tensor(47.6638, device='cuda:0')
distance 2 is tensor(3.7747, device='cuda:0')
benign distance is  tensor(3.7747, device='cuda:0')
norm1 res is  tensor(0.0777, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(196.2816, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(335.8665, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(348.8768, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(703.8428, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(288.6182, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(357.5760, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(229.7187, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(212.4314, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4946.7090, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5018.8511, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4974.5693, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5025.2578, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4972.2017, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4980.2266, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4985.2207, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4976.7007, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4993.0703, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4971.3232, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4965.7695, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5032.4541, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(699.3987, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(465.7391, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(719.1404, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(634.1068, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(674.1648, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(612.8607, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(723.5615, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(924.8611, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(523.4807, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(548.4521, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(290.5290, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(497.4897, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(846.9169, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(238.0522, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(719.6413, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(698.1045, device='cuda:0')
norm_2 is  tensor(271.3178, device='cuda:0')
norm_2 * lamda is tensor(488.3721, device='cuda:0')
do  not satisfying 35
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 87.02% 

Test Accuracy: 88.79% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7292172536253929
distance 1 is tensor(83.5822, device='cuda:0')
distance 2 is tensor(6.2083, device='cuda:0')
benign distance is  tensor(6.2083, device='cuda:0')
norm1 res is  tensor(0.0707, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7965221721678972
distance 1 is tensor(70.1932, device='cuda:0')
distance 2 is tensor(5.3501, device='cuda:0')
benign distance is  tensor(5.3501, device='cuda:0')
norm1 res is  tensor(0.0982, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7603585943579674
distance 1 is tensor(56.7221, device='cuda:0')
distance 2 is tensor(4.4091, device='cuda:0')
benign distance is  tensor(4.4091, device='cuda:0')
norm1 res is  tensor(0.1055, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.5612670741975307
distance 1 is tensor(173.6655, device='cuda:0')
distance 2 is tensor(12.6777, device='cuda:0')
benign distance is  tensor(12.6777, device='cuda:0')
norm1 res is  tensor(0.1225, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8442072672769427
distance 1 is tensor(45.9356, device='cuda:0')
distance 2 is tensor(3.7749, device='cuda:0')
benign distance is  tensor(3.7749, device='cuda:0')
norm1 res is  tensor(0.0503, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6710396641865373
distance 1 is tensor(57.4583, device='cuda:0')
distance 2 is tensor(4.3856, device='cuda:0')
benign distance is  tensor(4.3856, device='cuda:0')
norm1 res is  tensor(0.0972, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.8215851448476315
distance 1 is tensor(75.6023, device='cuda:0')
distance 2 is tensor(5.8633, device='cuda:0')
benign distance is  tensor(5.8633, device='cuda:0')
norm1 res is  tensor(0.0888, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6839053258299828
distance 1 is tensor(50.1348, device='cuda:0')
distance 2 is tensor(3.8944, device='cuda:0')
benign distance is  tensor(3.8944, device='cuda:0')
norm1 res is  tensor(0.0791, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.1226581074297428
distance 1 is tensor(140.1459, device='cuda:0')
distance 2 is tensor(10.3087, device='cuda:0')
benign distance is  tensor(10.3087, device='cuda:0')
norm1 res is  tensor(0.1554, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9430321706458926
distance 1 is tensor(171.1586, device='cuda:0')
distance 2 is tensor(12.7173, device='cuda:0')
benign distance is  tensor(12.7173, device='cuda:0')
norm1 res is  tensor(0.1842, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.0940408408641815
distance 1 is tensor(66.7873, device='cuda:0')
distance 2 is tensor(5.3497, device='cuda:0')
benign distance is  tensor(5.3497, device='cuda:0')
norm1 res is  tensor(0.0971, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.1870948281139135
distance 1 is tensor(144.6407, device='cuda:0')
distance 2 is tensor(10.7353, device='cuda:0')
benign distance is  tensor(10.7353, device='cuda:0')
norm1 res is  tensor(0.1519, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.3014407828450203
distance 1 is tensor(205.9988, device='cuda:0')
distance 2 is tensor(14.9120, device='cuda:0')
benign distance is  tensor(14.9120, device='cuda:0')
norm1 res is  tensor(0.1351, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.7792312232777476
distance 1 is tensor(43.5561, device='cuda:0')
distance 2 is tensor(3.3744, device='cuda:0')
benign distance is  tensor(3.3744, device='cuda:0')
norm1 res is  tensor(0.1159, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.2942894883453846
distance 1 is tensor(173.0644, device='cuda:0')
distance 2 is tensor(12.5217, device='cuda:0')
benign distance is  tensor(12.5217, device='cuda:0')
norm1 res is  tensor(0.1712, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.851601354777813
distance 1 is tensor(151.0701, device='cuda:0')
distance 2 is tensor(11.2659, device='cuda:0')
benign distance is  tensor(11.2659, device='cuda:0')
norm1 res is  tensor(0.1503, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.0713120698928833
distance 1 is tensor(137.1261, device='cuda:0')
distance 2 is tensor(10.2293, device='cuda:0')
benign distance is  tensor(10.2293, device='cuda:0')
norm1 res is  tensor(0.1529, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.9563329126685858
distance 1 is tensor(116.6430, device='cuda:0')
distance 2 is tensor(8.6851, device='cuda:0')
benign distance is  tensor(8.6851, device='cuda:0')
norm1 res is  tensor(0.3334, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.3377880677580833
distance 1 is tensor(182.9306, device='cuda:0')
distance 2 is tensor(13.4362, device='cuda:0')
benign distance is  tensor(13.4362, device='cuda:0')
norm1 res is  tensor(0.1574, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.4258252680301666
distance 1 is tensor(151.9363, device='cuda:0')
distance 2 is tensor(11.3701, device='cuda:0')
benign distance is  tensor(11.3701, device='cuda:0')
norm1 res is  tensor(0.1706, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.0149037521332502
distance 1 is tensor(162.3310, device='cuda:0')
distance 2 is tensor(11.8726, device='cuda:0')
benign distance is  tensor(11.8726, device='cuda:0')
norm1 res is  tensor(0.1813, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  1.2771706990897655
distance 1 is tensor(144.7285, device='cuda:0')
distance 2 is tensor(10.7709, device='cuda:0')
benign distance is  tensor(10.7709, device='cuda:0')
norm1 res is  tensor(0.1531, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.45234706439077854
distance 1 is tensor(163.4058, device='cuda:0')
distance 2 is tensor(11.8164, device='cuda:0')
benign distance is  tensor(11.8164, device='cuda:0')
norm1 res is  tensor(0.1821, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.8281137980520725
distance 1 is tensor(215.7395, device='cuda:0')
distance 2 is tensor(15.8770, device='cuda:0')
benign distance is  tensor(15.8770, device='cuda:0')
norm1 res is  tensor(0.1966, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(363.0634, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(318.1164, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(251.9707, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(771.9478, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(208.9016, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(252.0267, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(333.5516, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(216.5313, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4957.4321, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5019.4067, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4966.7695, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4965.8677, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4968.2939, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4998.7148, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4994.8799, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4992.3711, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5002.1035, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4984.4238, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4977.2012, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5041.9785, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(731.9724, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(735.8609, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(830.5323, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(717.3015, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(676.6772, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(477.6982, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(517.3845, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(669.5992, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(712.5978, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(575.4164, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(586.5250, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(554.2740, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(343.2099, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(1103.0760, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(748.7751, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(573.1796, device='cuda:0')
norm_2 is  tensor(359.5479, device='cuda:0')
norm_2 * lamda is tensor(647.1862, device='cuda:0')
satisfying 35
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 85.08% 

Test Accuracy: 88.28% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6747723296284676
distance 1 is tensor(63.8459, device='cuda:0')
distance 2 is tensor(4.9047, device='cuda:0')
benign distance is  tensor(4.9047, device='cuda:0')
norm1 res is  tensor(0.0533, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.62284723110497
distance 1 is tensor(64.6732, device='cuda:0')
distance 2 is tensor(4.8671, device='cuda:0')
benign distance is  tensor(4.8671, device='cuda:0')
norm1 res is  tensor(0.0899, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.9180572088807821
distance 1 is tensor(107.8087, device='cuda:0')
distance 2 is tensor(7.9833, device='cuda:0')
benign distance is  tensor(7.9833, device='cuda:0')
norm1 res is  tensor(0.2028, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.4996644742786884
distance 1 is tensor(221.8128, device='cuda:0')
distance 2 is tensor(15.9178, device='cuda:0')
benign distance is  tensor(15.9178, device='cuda:0')
norm1 res is  tensor(0.1520, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8344693901017308
distance 1 is tensor(42.5378, device='cuda:0')
distance 2 is tensor(3.6239, device='cuda:0')
benign distance is  tensor(3.6239, device='cuda:0')
norm1 res is  tensor(0.0483, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7350380872376263
distance 1 is tensor(49.7806, device='cuda:0')
distance 2 is tensor(3.7196, device='cuda:0')
benign distance is  tensor(3.7196, device='cuda:0')
norm1 res is  tensor(0.0782, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.0692238472402096
distance 1 is tensor(52.1158, device='cuda:0')
distance 2 is tensor(4.1688, device='cuda:0')
benign distance is  tensor(4.1688, device='cuda:0')
norm1 res is  tensor(0.0648, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.6827413272112608
distance 1 is tensor(68.3305, device='cuda:0')
distance 2 is tensor(5.2428, device='cuda:0')
benign distance is  tensor(5.2428, device='cuda:0')
norm1 res is  tensor(0.1129, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.9680356942117214
distance 1 is tensor(134.0913, device='cuda:0')
distance 2 is tensor(9.8617, device='cuda:0')
benign distance is  tensor(9.8617, device='cuda:0')
norm1 res is  tensor(0.1949, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.8572143577039242
distance 1 is tensor(158.2632, device='cuda:0')
distance 2 is tensor(11.5351, device='cuda:0')
benign distance is  tensor(11.5351, device='cuda:0')
norm1 res is  tensor(0.2018, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  1.4020373113453388
distance 1 is tensor(151.5688, device='cuda:0')
distance 2 is tensor(11.1157, device='cuda:0')
benign distance is  tensor(11.1157, device='cuda:0')
norm1 res is  tensor(0.1525, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.176292261108756
distance 1 is tensor(145.5229, device='cuda:0')
distance 2 is tensor(10.7601, device='cuda:0')
benign distance is  tensor(10.7601, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.8410454206168652
distance 1 is tensor(66.4368, device='cuda:0')
distance 2 is tensor(4.9614, device='cuda:0')
benign distance is  tensor(4.9614, device='cuda:0')
norm1 res is  tensor(0.0861, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.8306813035160303
distance 1 is tensor(249.5853, device='cuda:0')
distance 2 is tensor(18.3578, device='cuda:0')
benign distance is  tensor(18.3578, device='cuda:0')
norm1 res is  tensor(0.1362, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.6198249608278275
distance 1 is tensor(162.4249, device='cuda:0')
distance 2 is tensor(12.0575, device='cuda:0')
benign distance is  tensor(12.0575, device='cuda:0')
norm1 res is  tensor(0.1057, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.7812701091170311
distance 1 is tensor(131.2535, device='cuda:0')
distance 2 is tensor(9.6641, device='cuda:0')
benign distance is  tensor(9.6641, device='cuda:0')
norm1 res is  tensor(0.1158, device='cuda:0')
current submit client idx and staleness is  32 5
 benign loss is  0.7575410418212414
distance 1 is tensor(150.2006, device='cuda:0')
distance 2 is tensor(11.3678, device='cuda:0')
benign distance is  tensor(11.3678, device='cuda:0')
norm1 res is  tensor(0.1858, device='cuda:0')
current submit client idx and staleness is  33 5
 benign loss is  1.2171688564121723
distance 1 is tensor(129.3964, device='cuda:0')
distance 2 is tensor(9.4190, device='cuda:0')
benign distance is  tensor(9.4190, device='cuda:0')
norm1 res is  tensor(0.1792, device='cuda:0')
current submit client idx and staleness is  34 5
 benign loss is  0.826644379645586
distance 1 is tensor(190.0667, device='cuda:0')
distance 2 is tensor(14.0231, device='cuda:0')
benign distance is  tensor(14.0231, device='cuda:0')
norm1 res is  tensor(0.1873, device='cuda:0')
current submit client idx and staleness is  35 5
 benign loss is  1.5080422535538673
distance 1 is tensor(168.0772, device='cuda:0')
distance 2 is tensor(12.2298, device='cuda:0')
benign distance is  tensor(12.2298, device='cuda:0')
norm1 res is  tensor(0.1252, device='cuda:0')
current submit client idx and staleness is  36 5
 benign loss is  0.9072921331971884
distance 1 is tensor(121.9390, device='cuda:0')
distance 2 is tensor(9.2489, device='cuda:0')
benign distance is  tensor(9.2489, device='cuda:0')
norm1 res is  tensor(0.1354, device='cuda:0')
current submit client idx and staleness is  37 5
 benign loss is  0.846589345484972
distance 1 is tensor(103.2845, device='cuda:0')
distance 2 is tensor(7.5707, device='cuda:0')
benign distance is  tensor(7.5707, device='cuda:0')
norm1 res is  tensor(0.1318, device='cuda:0')
current submit client idx and staleness is  38 5
 benign loss is  0.836568696424365
distance 1 is tensor(109.0362, device='cuda:0')
distance 2 is tensor(7.8896, device='cuda:0')
benign distance is  tensor(7.8896, device='cuda:0')
norm1 res is  tensor(0.2190, device='cuda:0')
current submit client idx and staleness is  39 5
 benign loss is  0.7641830425709486
distance 1 is tensor(153.7146, device='cuda:0')
distance 2 is tensor(11.4882, device='cuda:0')
benign distance is  tensor(11.4882, device='cuda:0')
norm1 res is  tensor(0.1884, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(272.0262, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(283.7189, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(467.5536, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(962.3761, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(200.5171, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(206.1115, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(240.3461, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(304.0390, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4969.5059, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5004.8174, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4971.8618, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4975.7168, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4977.2832, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(4997.4790, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(4995.5088, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4973.0376, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(4994.9395, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4973.9390, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4985.0034, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5035.8179, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(615.8430, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(762.7512, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(327.9802, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(652.6108, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(905.0842, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(217.0703, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(767.4362, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(679.7052, device='cuda:0')
norm_2 is  tensor(362.4777, device='cuda:0')
norm_2 * lamda is tensor(652.4598, device='cuda:0')
do  not satisfying 27
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 86.88% 

Test Accuracy: 88.67% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5516597172245383
distance 1 is tensor(69.0469, device='cuda:0')
distance 2 is tensor(5.3384, device='cuda:0')
benign distance is  tensor(5.3384, device='cuda:0')
norm1 res is  tensor(0.0610, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7356753703206778
distance 1 is tensor(53.0004, device='cuda:0')
distance 2 is tensor(4.1200, device='cuda:0')
benign distance is  tensor(4.1200, device='cuda:0')
norm1 res is  tensor(0.0717, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7050998453050852
distance 1 is tensor(56.8754, device='cuda:0')
distance 2 is tensor(4.3893, device='cuda:0')
benign distance is  tensor(4.3893, device='cuda:0')
norm1 res is  tensor(0.1070, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.0670367330312729
distance 1 is tensor(187.0142, device='cuda:0')
distance 2 is tensor(13.5645, device='cuda:0')
benign distance is  tensor(13.5645, device='cuda:0')
norm1 res is  tensor(0.1302, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8662148211151361
distance 1 is tensor(54.1205, device='cuda:0')
distance 2 is tensor(4.1510, device='cuda:0')
benign distance is  tensor(4.1510, device='cuda:0')
norm1 res is  tensor(0.0545, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7199703236110508
distance 1 is tensor(50.5821, device='cuda:0')
distance 2 is tensor(3.8735, device='cuda:0')
benign distance is  tensor(3.8735, device='cuda:0')
norm1 res is  tensor(0.0854, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.0271827690303326
distance 1 is tensor(70.2773, device='cuda:0')
distance 2 is tensor(5.3336, device='cuda:0')
benign distance is  tensor(5.3336, device='cuda:0')
norm1 res is  tensor(0.0789, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7737979721277952
distance 1 is tensor(69.2325, device='cuda:0')
distance 2 is tensor(5.1534, device='cuda:0')
benign distance is  tensor(5.1534, device='cuda:0')
norm1 res is  tensor(0.1191, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.330637276172638
distance 1 is tensor(88.6581, device='cuda:0')
distance 2 is tensor(6.6740, device='cuda:0')
benign distance is  tensor(6.6740, device='cuda:0')
norm1 res is  tensor(0.0996, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  1.0526237860321999
distance 1 is tensor(166.0253, device='cuda:0')
distance 2 is tensor(12.2243, device='cuda:0')
benign distance is  tensor(12.2243, device='cuda:0')
norm1 res is  tensor(0.1815, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  1.1639523524791002
distance 1 is tensor(60.5165, device='cuda:0')
distance 2 is tensor(4.8207, device='cuda:0')
benign distance is  tensor(4.8207, device='cuda:0')
norm1 res is  tensor(0.0853, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.176131159067154
distance 1 is tensor(148.1266, device='cuda:0')
distance 2 is tensor(10.9659, device='cuda:0')
benign distance is  tensor(10.9659, device='cuda:0')
norm1 res is  tensor(0.1507, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.315079227089882
distance 1 is tensor(215.8702, device='cuda:0')
distance 2 is tensor(15.3333, device='cuda:0')
benign distance is  tensor(15.3333, device='cuda:0')
norm1 res is  tensor(0.1388, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  1.0568362083286047
distance 1 is tensor(66.4857, device='cuda:0')
distance 2 is tensor(5.0410, device='cuda:0')
benign distance is  tensor(5.0410, device='cuda:0')
norm1 res is  tensor(0.1804, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1605854742228985
distance 1 is tensor(168.0323, device='cuda:0')
distance 2 is tensor(12.0937, device='cuda:0')
benign distance is  tensor(12.0937, device='cuda:0')
norm1 res is  tensor(0.1638, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.9698125123977661
distance 1 is tensor(164.7383, device='cuda:0')
distance 2 is tensor(12.2083, device='cuda:0')
benign distance is  tensor(12.2083, device='cuda:0')
norm1 res is  tensor(0.1567, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(296.3844, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(235.1424, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(255.6677, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(827.6270, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(225.3913, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(225.1606, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(298.8675, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(290.8676, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4973.8931, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5044.6821, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(4992.9492, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5003.1211, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4988.6890, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5002.2969, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5020.2412, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(4996.3550, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5015.1411, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(4984.3701, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(4994.1392, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5034.0396, device='cuda:0')
norm_2 is  tensor(356.2368, device='cuda:0')
norm_2 * lamda is tensor(641.2261, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 88.66% 

Test Accuracy: 89.07% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8013299498707056
distance 1 is tensor(97.5952, device='cuda:0')
distance 2 is tensor(7.5538, device='cuda:0')
benign distance is  tensor(7.5538, device='cuda:0')
norm1 res is  tensor(0.0841, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.7744088117033243
distance 1 is tensor(84.2890, device='cuda:0')
distance 2 is tensor(6.3473, device='cuda:0')
benign distance is  tensor(6.3473, device='cuda:0')
norm1 res is  tensor(0.1170, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.8085456471890211
distance 1 is tensor(88.7604, device='cuda:0')
distance 2 is tensor(6.7085, device='cuda:0')
benign distance is  tensor(6.7085, device='cuda:0')
norm1 res is  tensor(0.1856, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.3576311394572258
distance 1 is tensor(167.2623, device='cuda:0')
distance 2 is tensor(12.0453, device='cuda:0')
benign distance is  tensor(12.0453, device='cuda:0')
norm1 res is  tensor(0.1167, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.8913465859368443
distance 1 is tensor(72.4803, device='cuda:0')
distance 2 is tensor(5.5669, device='cuda:0')
benign distance is  tensor(5.5669, device='cuda:0')
norm1 res is  tensor(0.0764, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.6896959757432342
distance 1 is tensor(88.4855, device='cuda:0')
distance 2 is tensor(6.5293, device='cuda:0')
benign distance is  tensor(6.5293, device='cuda:0')
norm1 res is  tensor(0.1488, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.2014780081808567
distance 1 is tensor(64.4738, device='cuda:0')
distance 2 is tensor(4.8172, device='cuda:0')
benign distance is  tensor(4.8172, device='cuda:0')
norm1 res is  tensor(0.0729, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.7072527222335339
distance 1 is tensor(43.4086, device='cuda:0')
distance 2 is tensor(3.5055, device='cuda:0')
benign distance is  tensor(3.5055, device='cuda:0')
norm1 res is  tensor(0.0743, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(442.4227, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(377.4586, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(397.5781, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(732.6642, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(314.8987, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(384.8908, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(276.5148, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(202.7812, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4988.5190, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5058.4062, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5010.1235, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5010.1650, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5011.6221, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5018.2710, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5031.1978, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5007.4868, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5026.0244, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5005.3545, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5020.2734, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5063.0371, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(665.2707, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(734.7053, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(798.5299, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(587.8564, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(904.3991, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(809.0629, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(540.7125, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(711.8330, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(619.2596, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(544.6436, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(805.8466, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(688.6776, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(723.0057, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(658.9668, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(714.4691, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(971.2668, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 35
grad,shape is torch.Size([215370])
norm_1 is  tensor(588.6399, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 36
grad,shape is torch.Size([215370])
norm_1 is  tensor(705.4941, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 37
grad,shape is torch.Size([215370])
norm_1 is  tensor(665.8638, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 38
grad,shape is torch.Size([215370])
norm_1 is  tensor(652.7831, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 39
grad,shape is torch.Size([215370])
norm_1 is  tensor(305.9603, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 40
grad,shape is torch.Size([215370])
norm_1 is  tensor(1106.9165, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 41
grad,shape is torch.Size([215370])
norm_1 is  tensor(713.8022, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 42
grad,shape is torch.Size([215370])
norm_1 is  tensor(599.4351, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 43
grad,shape is torch.Size([215370])
norm_1 is  tensor(398.2890, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 44
grad,shape is torch.Size([215370])
norm_1 is  tensor(745.3076, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 45
grad,shape is torch.Size([215370])
norm_1 is  tensor(288.5458, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 46
grad,shape is torch.Size([215370])
norm_1 is  tensor(648.6420, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 47
grad,shape is torch.Size([215370])
norm_1 is  tensor(936.2471, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 48
grad,shape is torch.Size([215370])
norm_1 is  tensor(301.2306, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
satisfying 49
grad,shape is torch.Size([215370])
norm_1 is  tensor(739.4272, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 50
grad,shape is torch.Size([215370])
norm_1 is  tensor(714.3751, device='cuda:0')
norm_2 is  tensor(323.5909, device='cuda:0')
norm_2 * lamda is tensor(582.4636, device='cuda:0')
do  not satisfying 51
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 87.04% 

Test Accuracy: 88.51% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
 benign loss is  0.692516976967454
distance 1 is tensor(71.9752, device='cuda:0')
distance 2 is tensor(5.4335, device='cuda:0')
benign distance is  tensor(5.4335, device='cuda:0')
norm1 res is  tensor(0.0602, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  0.8729391675442457
distance 1 is tensor(98.6437, device='cuda:0')
distance 2 is tensor(7.2879, device='cuda:0')
benign distance is  tensor(7.2879, device='cuda:0')
norm1 res is  tensor(0.1336, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  0.7529109213501215
distance 1 is tensor(77.2030, device='cuda:0')
distance 2 is tensor(5.8414, device='cuda:0')
benign distance is  tensor(5.8414, device='cuda:0')
norm1 res is  tensor(0.1495, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  1.2297241520136595
distance 1 is tensor(162.7849, device='cuda:0')
distance 2 is tensor(11.8470, device='cuda:0')
benign distance is  tensor(11.8470, device='cuda:0')
norm1 res is  tensor(0.1153, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  0.9243012322112918
distance 1 is tensor(67.1542, device='cuda:0')
distance 2 is tensor(5.2034, device='cuda:0')
benign distance is  tensor(5.2034, device='cuda:0')
norm1 res is  tensor(0.0743, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7697259467095137
distance 1 is tensor(47.1638, device='cuda:0')
distance 2 is tensor(3.7444, device='cuda:0')
benign distance is  tensor(3.7444, device='cuda:0')
norm1 res is  tensor(0.0908, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.3448072504252195
distance 1 is tensor(68.7550, device='cuda:0')
distance 2 is tensor(5.2934, device='cuda:0')
benign distance is  tensor(5.2934, device='cuda:0')
norm1 res is  tensor(0.0809, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5959860272705555
distance 1 is tensor(42.8850, device='cuda:0')
distance 2 is tensor(3.4403, device='cuda:0')
benign distance is  tensor(3.4403, device='cuda:0')
norm1 res is  tensor(0.0707, device='cuda:0')
current submit client idx and staleness is  8 2
 benign loss is  1.1635560430586338
distance 1 is tensor(136.2036, device='cuda:0')
distance 2 is tensor(10.0794, device='cuda:0')
benign distance is  tensor(10.0794, device='cuda:0')
norm1 res is  tensor(0.1544, device='cuda:0')
current submit client idx and staleness is  9 2
 benign loss is  0.9037732486613095
distance 1 is tensor(174.1004, device='cuda:0')
distance 2 is tensor(12.7489, device='cuda:0')
benign distance is  tensor(12.7489, device='cuda:0')
norm1 res is  tensor(0.1892, device='cuda:0')
current submit client idx and staleness is  10 2
 benign loss is  0.9749243780970573
distance 1 is tensor(68.0927, device='cuda:0')
distance 2 is tensor(5.3770, device='cuda:0')
benign distance is  tensor(5.3770, device='cuda:0')
norm1 res is  tensor(0.0980, device='cuda:0')
current submit client idx and staleness is  11 2
 benign loss is  1.3449743539094925
distance 1 is tensor(134.7060, device='cuda:0')
distance 2 is tensor(10.0400, device='cuda:0')
benign distance is  tensor(10.0400, device='cuda:0')
norm1 res is  tensor(0.1442, device='cuda:0')
current submit client idx and staleness is  12 2
 benign loss is  1.063680686056614
distance 1 is tensor(214.9759, device='cuda:0')
distance 2 is tensor(15.5525, device='cuda:0')
benign distance is  tensor(15.5525, device='cuda:0')
norm1 res is  tensor(0.1404, device='cuda:0')
current submit client idx and staleness is  13 2
 benign loss is  0.784269517287612
distance 1 is tensor(46.4632, device='cuda:0')
distance 2 is tensor(3.6210, device='cuda:0')
benign distance is  tensor(3.6210, device='cuda:0')
norm1 res is  tensor(0.1278, device='cuda:0')
current submit client idx and staleness is  14 2
 benign loss is  1.1670743599534035
distance 1 is tensor(168.7496, device='cuda:0')
distance 2 is tensor(12.4563, device='cuda:0')
benign distance is  tensor(12.4563, device='cuda:0')
norm1 res is  tensor(0.1703, device='cuda:0')
current submit client idx and staleness is  15 2
 benign loss is  1.9321036860346794
distance 1 is tensor(174.4059, device='cuda:0')
distance 2 is tensor(12.8108, device='cuda:0')
benign distance is  tensor(12.8108, device='cuda:0')
norm1 res is  tensor(0.1652, device='cuda:0')
current submit client idx and staleness is  16 3
 benign loss is  1.4091702662408352
distance 1 is tensor(139.5584, device='cuda:0')
distance 2 is tensor(10.4348, device='cuda:0')
benign distance is  tensor(10.4348, device='cuda:0')
norm1 res is  tensor(0.2066, device='cuda:0')
current submit client idx and staleness is  17 3
 benign loss is  0.9478626307100058
distance 1 is tensor(143.8598, device='cuda:0')
distance 2 is tensor(10.5740, device='cuda:0')
benign distance is  tensor(10.5740, device='cuda:0')
norm1 res is  tensor(0.1826, device='cuda:0')
current submit client idx and staleness is  18 3
 benign loss is  2.023362420499325
distance 1 is tensor(166.7781, device='cuda:0')
distance 2 is tensor(12.2637, device='cuda:0')
benign distance is  tensor(12.2637, device='cuda:0')
norm1 res is  tensor(0.1676, device='cuda:0')
current submit client idx and staleness is  19 3
 benign loss is  1.0605703350156546
distance 1 is tensor(161.5226, device='cuda:0')
distance 2 is tensor(11.9391, device='cuda:0')
benign distance is  tensor(11.9391, device='cuda:0')
norm1 res is  tensor(0.1490, device='cuda:0')
current submit client idx and staleness is  20 3
 benign loss is  0.979783957824111
distance 1 is tensor(86.4772, device='cuda:0')
distance 2 is tensor(6.4783, device='cuda:0')
benign distance is  tensor(6.4783, device='cuda:0')
norm1 res is  tensor(0.1102, device='cuda:0')
current submit client idx and staleness is  21 3
 benign loss is  0.7777793603017926
distance 1 is tensor(245.6661, device='cuda:0')
distance 2 is tensor(17.8613, device='cuda:0')
benign distance is  tensor(17.8613, device='cuda:0')
norm1 res is  tensor(0.1327, device='cuda:0')
current submit client idx and staleness is  22 3
 benign loss is  1.3664831779897213
distance 1 is tensor(180.2841, device='cuda:0')
distance 2 is tensor(13.4000, device='cuda:0')
benign distance is  tensor(13.4000, device='cuda:0')
norm1 res is  tensor(0.1199, device='cuda:0')
current submit client idx and staleness is  23 3
 benign loss is  0.9800529144704342
distance 1 is tensor(147.0890, device='cuda:0')
distance 2 is tensor(10.7010, device='cuda:0')
benign distance is  tensor(10.7010, device='cuda:0')
norm1 res is  tensor(0.1278, device='cuda:0')
current submit client idx and staleness is  24 4
 benign loss is  1.2412742003798485
distance 1 is tensor(169.8449, device='cuda:0')
distance 2 is tensor(12.5434, device='cuda:0')
benign distance is  tensor(12.5434, device='cuda:0')
norm1 res is  tensor(0.1914, device='cuda:0')
current submit client idx and staleness is  25 4
 benign loss is  0.9558560438454151
distance 1 is tensor(169.6415, device='cuda:0')
distance 2 is tensor(13.7704, device='cuda:0')
benign distance is  tensor(13.7704, device='cuda:0')
norm1 res is  tensor(0.5177, device='cuda:0')
current submit client idx and staleness is  26 4
 benign loss is  1.1194834411144257
distance 1 is tensor(181.8544, device='cuda:0')
distance 2 is tensor(13.4963, device='cuda:0')
benign distance is  tensor(13.4963, device='cuda:0')
norm1 res is  tensor(0.1585, device='cuda:0')
current submit client idx and staleness is  27 4
 benign loss is  1.2478817496448755
distance 1 is tensor(154.4994, device='cuda:0')
distance 2 is tensor(11.5335, device='cuda:0')
benign distance is  tensor(11.5335, device='cuda:0')
norm1 res is  tensor(0.1755, device='cuda:0')
current submit client idx and staleness is  28 4
 benign loss is  1.0113332234323025
distance 1 is tensor(157.2020, device='cuda:0')
distance 2 is tensor(11.6053, device='cuda:0')
benign distance is  tensor(11.6053, device='cuda:0')
norm1 res is  tensor(0.1791, device='cuda:0')
current submit client idx and staleness is  29 4
 benign loss is  1.032236810773611
distance 1 is tensor(218.4348, device='cuda:0')
distance 2 is tensor(16.9337, device='cuda:0')
benign distance is  tensor(16.9337, device='cuda:0')
norm1 res is  tensor(0.2396, device='cuda:0')
current submit client idx and staleness is  30 4
 benign loss is  0.5299988258630037
distance 1 is tensor(148.4295, device='cuda:0')
distance 2 is tensor(10.9327, device='cuda:0')
benign distance is  tensor(10.9327, device='cuda:0')
norm1 res is  tensor(0.1706, device='cuda:0')
current submit client idx and staleness is  31 4
 benign loss is  0.7781474683433771
distance 1 is tensor(223.0954, device='cuda:0')
distance 2 is tensor(16.3262, device='cuda:0')
benign distance is  tensor(16.3262, device='cuda:0')
norm1 res is  tensor(0.1998, device='cuda:0')
current submit client idx and staleness is  40 6
 benign loss is  1.2886184193193913
distance 1 is tensor(147.5396, device='cuda:0')
distance 2 is tensor(11.1054, device='cuda:0')
benign distance is  tensor(11.1054, device='cuda:0')
norm1 res is  tensor(0.2073, device='cuda:0')
current submit client idx and staleness is  41 6
 benign loss is  1.7836211249232292
distance 1 is tensor(188.2238, device='cuda:0')
distance 2 is tensor(14.1915, device='cuda:0')
benign distance is  tensor(14.1915, device='cuda:0')
norm1 res is  tensor(0.1948, device='cuda:0')
current submit client idx and staleness is  42 6
 benign loss is  1.5328225307166576
distance 1 is tensor(201.4895, device='cuda:0')
distance 2 is tensor(14.7280, device='cuda:0')
benign distance is  tensor(14.7280, device='cuda:0')
norm1 res is  tensor(0.1403, device='cuda:0')
current submit client idx and staleness is  43 6
 benign loss is  0.9114967472851276
distance 1 is tensor(143.4441, device='cuda:0')
distance 2 is tensor(10.8541, device='cuda:0')
benign distance is  tensor(10.8541, device='cuda:0')
norm1 res is  tensor(0.3411, device='cuda:0')
current submit client idx and staleness is  44 6
 benign loss is  0.7048104144632816
distance 1 is tensor(209.1440, device='cuda:0')
distance 2 is tensor(15.4309, device='cuda:0')
benign distance is  tensor(15.4309, device='cuda:0')
norm1 res is  tensor(0.2008, device='cuda:0')
current submit client idx and staleness is  45 6
 benign loss is  0.7610299251973629
distance 1 is tensor(189.8454, device='cuda:0')
distance 2 is tensor(13.7161, device='cuda:0')
benign distance is  tensor(13.7161, device='cuda:0')
norm1 res is  tensor(0.2290, device='cuda:0')
current submit client idx and staleness is  46 6
 benign loss is  0.9265311453491449
distance 1 is tensor(143.1421, device='cuda:0')
distance 2 is tensor(10.6242, device='cuda:0')
benign distance is  tensor(10.6242, device='cuda:0')
norm1 res is  tensor(0.1992, device='cuda:0')
current submit client idx and staleness is  47 6
 benign loss is  0.5920382896438241
distance 1 is tensor(165.0830, device='cuda:0')
distance 2 is tensor(12.0998, device='cuda:0')
benign distance is  tensor(12.0998, device='cuda:0')
norm1 res is  tensor(0.1848, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(310.0553, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(436.5370, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(341.9604, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(722.1488, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(293.1749, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(210.7759, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(303.4569, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(190.6853, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(4993.4937, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5045.5947, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5001.2065, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(4997.0806, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(4997.5039, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5040.0322, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5030.3447, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5013.8096, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5047.5767, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5008.3174, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5016.5518, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5056.2007, device='cuda:0')
norm_2 is  tensor(362.2990, device='cuda:0')
norm_2 * lamda is tensor(652.1382, device='cuda:0')
do  not satisfying 19
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 89.08% 

Test Accuracy: 88.92% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8447082545608282
distance 1 is tensor(117.2593, device='cuda:0')
distance 2 is tensor(8.7854, device='cuda:0')
benign distance is  tensor(8.7854, device='cuda:0')
norm1 res is  tensor(0.0999, device='cuda:0')
current submit client idx and staleness is  1 1
 benign loss is  1.0336128287017345
distance 1 is tensor(62.3069, device='cuda:0')
distance 2 is tensor(4.8832, device='cuda:0')
benign distance is  tensor(4.8832, device='cuda:0')
norm1 res is  tensor(0.0916, device='cuda:0')
current submit client idx and staleness is  2 1
 benign loss is  1.2285147458314896
distance 1 is tensor(114.2747, device='cuda:0')
distance 2 is tensor(8.6149, device='cuda:0')
benign distance is  tensor(8.6149, device='cuda:0')
norm1 res is  tensor(0.2256, device='cuda:0')
current submit client idx and staleness is  3 1
 benign loss is  0.9568738378584385
distance 1 is tensor(156.2471, device='cuda:0')
distance 2 is tensor(11.3097, device='cuda:0')
benign distance is  tensor(11.3097, device='cuda:0')
norm1 res is  tensor(0.1092, device='cuda:0')
current submit client idx and staleness is  4 1
 benign loss is  1.1996735539287329
distance 1 is tensor(74.8659, device='cuda:0')
distance 2 is tensor(5.6167, device='cuda:0')
benign distance is  tensor(5.6167, device='cuda:0')
norm1 res is  tensor(0.0797, device='cuda:0')
current submit client idx and staleness is  5 1
 benign loss is  0.7338853925466537
distance 1 is tensor(65.6196, device='cuda:0')
distance 2 is tensor(4.9903, device='cuda:0')
benign distance is  tensor(4.9903, device='cuda:0')
norm1 res is  tensor(0.1170, device='cuda:0')
current submit client idx and staleness is  6 1
 benign loss is  1.3668798301368952
distance 1 is tensor(87.6697, device='cuda:0')
distance 2 is tensor(6.7639, device='cuda:0')
benign distance is  tensor(6.7639, device='cuda:0')
norm1 res is  tensor(0.1059, device='cuda:0')
current submit client idx and staleness is  7 1
 benign loss is  0.5984366415068507
distance 1 is tensor(43.2849, device='cuda:0')
distance 2 is tensor(3.4111, device='cuda:0')
benign distance is  tensor(3.4111, device='cuda:0')
norm1 res is  tensor(0.0702, device='cuda:0')
current submit client idx and staleness is  48 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
norm_1 is  tensor(524.9261, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 0
grad,shape is torch.Size([215370])
norm_1 is  tensor(282.9265, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
satisfying 1
grad,shape is torch.Size([215370])
norm_1 is  tensor(508.5947, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 2
grad,shape is torch.Size([215370])
norm_1 is  tensor(692.7924, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 3
grad,shape is torch.Size([215370])
norm_1 is  tensor(322.1595, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
satisfying 4
grad,shape is torch.Size([215370])
norm_1 is  tensor(282.2658, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
satisfying 5
grad,shape is torch.Size([215370])
norm_1 is  tensor(398.1060, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
satisfying 6
grad,shape is torch.Size([215370])
norm_1 is  tensor(187.9777, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
satisfying 7
grad,shape is torch.Size([215370])
norm_1 is  tensor(5004.9688, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 8
grad,shape is torch.Size([215370])
norm_1 is  tensor(5071.2031, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 9
grad,shape is torch.Size([215370])
norm_1 is  tensor(5025.6162, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 10
grad,shape is torch.Size([215370])
norm_1 is  tensor(5035.7559, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 11
grad,shape is torch.Size([215370])
norm_1 is  tensor(5009.7490, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 12
grad,shape is torch.Size([215370])
norm_1 is  tensor(5053.5352, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 13
grad,shape is torch.Size([215370])
norm_1 is  tensor(5050.1982, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 14
grad,shape is torch.Size([215370])
norm_1 is  tensor(5019.3169, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 15
grad,shape is torch.Size([215370])
norm_1 is  tensor(5042.1968, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 16
grad,shape is torch.Size([215370])
norm_1 is  tensor(5033.1074, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 17
grad,shape is torch.Size([215370])
norm_1 is  tensor(5024.3457, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 18
grad,shape is torch.Size([215370])
norm_1 is  tensor(5086.0356, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 19
grad,shape is torch.Size([215370])
norm_1 is  tensor(688.7043, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 20
grad,shape is torch.Size([215370])
norm_1 is  tensor(574.3002, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 21
grad,shape is torch.Size([215370])
norm_1 is  tensor(854.8476, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 22
grad,shape is torch.Size([215370])
norm_1 is  tensor(745.3265, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 23
grad,shape is torch.Size([215370])
norm_1 is  tensor(565.2726, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 24
grad,shape is torch.Size([215370])
norm_1 is  tensor(480.2694, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 25
grad,shape is torch.Size([215370])
norm_1 is  tensor(502.5607, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 26
grad,shape is torch.Size([215370])
norm_1 is  tensor(699.6331, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 27
grad,shape is torch.Size([215370])
norm_1 is  tensor(599.7798, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 28
grad,shape is torch.Size([215370])
norm_1 is  tensor(775.0695, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 29
grad,shape is torch.Size([215370])
norm_1 is  tensor(326.5966, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
satisfying 30
grad,shape is torch.Size([215370])
norm_1 is  tensor(609.4598, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 31
grad,shape is torch.Size([215370])
norm_1 is  tensor(950.2299, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 32
grad,shape is torch.Size([215370])
norm_1 is  tensor(229.1669, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
satisfying 33
grad,shape is torch.Size([215370])
norm_1 is  tensor(766.1003, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 34
grad,shape is torch.Size([215370])
norm_1 is  tensor(751.1543, device='cuda:0')
norm_2 is  tensor(249.5773, device='cuda:0')
norm_2 * lamda is tensor(449.2392, device='cuda:0')
do  not satisfying 35
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 85.11% 

Test Accuracy: 87.96% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 85.11%
|----0th round Training Accuracy : 84.13%
|----1th round Training Accuracy : 81.05%
|----2th round Training Accuracy : 82.21%
|----3th round Training Accuracy : 81.70%
|----4th round Training Accuracy : 86.54%
|----5th round Training Accuracy : 83.10%
|----6th round Training Accuracy : 84.11%
|----7th round Training Accuracy : 84.87%
|----8th round Training Accuracy : 84.24%
|----9th round Training Accuracy : 84.14%
|----10th round Training Accuracy : 86.60%
|----11th round Training Accuracy : 85.19%
|----12th round Training Accuracy : 86.44%
|----13th round Training Accuracy : 82.58%
|----14th round Training Accuracy : 85.74%
|----15th round Training Accuracy : 84.37%
|----16th round Training Accuracy : 87.25%
|----17th round Training Accuracy : 86.15%
|----18th round Training Accuracy : 86.79%
|----19th round Training Accuracy : 86.36%
|----20th round Training Accuracy : 85.31%
|----21th round Training Accuracy : 84.89%
|----22th round Training Accuracy : 87.38%
|----23th round Training Accuracy : 86.66%
|----24th round Training Accuracy : 88.93%
|----25th round Training Accuracy : 88.37%
|----26th round Training Accuracy : 87.47%
|----27th round Training Accuracy : 85.75%
|----28th round Training Accuracy : 88.89%
|----29th round Training Accuracy : 87.38%
|----30th round Training Accuracy : 88.71%
|----31th round Training Accuracy : 86.60%
|----32th round Training Accuracy : 88.55%
|----33th round Training Accuracy : 87.21%
|----34th round Training Accuracy : 86.68%
|----35th round Training Accuracy : 86.80%
|----36th round Training Accuracy : 88.91%
|----37th round Training Accuracy : 86.37%
|----38th round Training Accuracy : 85.76%
|----39th round Training Accuracy : 86.82%
|----40th round Training Accuracy : 87.86%
|----41th round Training Accuracy : 86.73%
|----42th round Training Accuracy : 86.70%
|----43th round Training Accuracy : 87.02%
|----44th round Training Accuracy : 85.08%
|----45th round Training Accuracy : 86.88%
|----46th round Training Accuracy : 88.66%
|----47th round Training Accuracy : 87.04%
|----48th round Training Accuracy : 89.08%
|----49th round Training Accuracy : 85.11%
|----Final Test Accuracy: 87.96%
|----0th round Final Test Accuracy : 88.03%
|----1th round Final Test Accuracy : 87.12%
|----2th round Final Test Accuracy : 87.46%
|----3th round Final Test Accuracy : 87.24%
|----4th round Final Test Accuracy : 88.50%
|----5th round Final Test Accuracy : 87.71%
|----6th round Final Test Accuracy : 87.70%
|----7th round Final Test Accuracy : 88.04%
|----8th round Final Test Accuracy : 87.86%
|----9th round Final Test Accuracy : 87.90%
|----10th round Final Test Accuracy : 88.37%
|----11th round Final Test Accuracy : 88.06%
|----12th round Final Test Accuracy : 88.66%
|----13th round Final Test Accuracy : 87.48%
|----14th round Final Test Accuracy : 88.40%
|----15th round Final Test Accuracy : 87.90%
|----16th round Final Test Accuracy : 88.72%
|----17th round Final Test Accuracy : 88.57%
|----18th round Final Test Accuracy : 88.64%
|----19th round Final Test Accuracy : 88.36%
|----20th round Final Test Accuracy : 88.23%
|----21th round Final Test Accuracy : 88.06%
|----22th round Final Test Accuracy : 88.57%
|----23th round Final Test Accuracy : 88.60%
|----24th round Final Test Accuracy : 88.91%
|----25th round Final Test Accuracy : 88.88%
|----26th round Final Test Accuracy : 88.34%
|----27th round Final Test Accuracy : 88.19%
|----28th round Final Test Accuracy : 89.02%
|----29th round Final Test Accuracy : 88.59%
|----30th round Final Test Accuracy : 89.01%
|----31th round Final Test Accuracy : 88.34%
|----32th round Final Test Accuracy : 88.67%
|----33th round Final Test Accuracy : 88.82%
|----34th round Final Test Accuracy : 88.50%
|----35th round Final Test Accuracy : 88.68%
|----36th round Final Test Accuracy : 89.01%
|----37th round Final Test Accuracy : 88.48%
|----38th round Final Test Accuracy : 88.23%
|----39th round Final Test Accuracy : 88.73%
|----40th round Final Test Accuracy : 88.66%
|----41th round Final Test Accuracy : 88.62%
|----42th round Final Test Accuracy : 88.60%
|----43th round Final Test Accuracy : 88.79%
|----44th round Final Test Accuracy : 88.28%
|----45th round Final Test Accuracy : 88.67%
|----46th round Final Test Accuracy : 89.07%
|----47th round Final Test Accuracy : 88.51%
|----48th round Final Test Accuracy : 88.92%
|----49th round Final Test Accuracy : 87.96%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!


 Total Run Time: 4162.3938
