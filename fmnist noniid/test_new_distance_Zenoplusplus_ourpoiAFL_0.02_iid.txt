
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.330733984708786
distance 1 is tensor(133.2933, device='cuda:1')
distance 2 is tensor(9.6115, device='cuda:1')
benign distance is  tensor(9.6115, device='cuda:1')
norm1 res is  tensor(0.1487, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.20605310797691345
distance 1 is tensor(143.4017, device='cuda:1')
distance 2 is tensor(10.5163, device='cuda:1')
benign distance is  tensor(10.5163, device='cuda:1')
norm1 res is  tensor(0.1593, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.17319469153881073
distance 1 is tensor(152.5171, device='cuda:1')
distance 2 is tensor(11.0308, device='cuda:1')
benign distance is  tensor(11.0308, device='cuda:1')
norm1 res is  tensor(0.1682, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.7980181574821472
distance 1 is tensor(144.5437, device='cuda:1')
distance 2 is tensor(10.5389, device='cuda:1')
benign distance is  tensor(10.5389, device='cuda:1')
norm1 res is  tensor(0.1585, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.6186164617538452
distance 1 is tensor(141.4750, device='cuda:1')
distance 2 is tensor(10.2774, device='cuda:1')
benign distance is  tensor(10.2774, device='cuda:1')
norm1 res is  tensor(0.1607, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.4940450191497803
distance 1 is tensor(154.3711, device='cuda:1')
distance 2 is tensor(11.3299, device='cuda:1')
benign distance is  tensor(11.3299, device='cuda:1')
norm1 res is  tensor(0.1726, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.686907172203064
distance 1 is tensor(144.6120, device='cuda:1')
distance 2 is tensor(10.3458, device='cuda:1')
benign distance is  tensor(10.3458, device='cuda:1')
norm1 res is  tensor(0.1564, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.41321712732315063
distance 1 is tensor(167.5155, device='cuda:1')
distance 2 is tensor(12.0549, device='cuda:1')
benign distance is  tensor(12.0549, device='cuda:1')
norm1 res is  tensor(0.1862, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.4262952208518982
distance 1 is tensor(159.4247, device='cuda:1')
distance 2 is tensor(11.5703, device='cuda:1')
benign distance is  tensor(11.5703, device='cuda:1')
norm1 res is  tensor(0.1764, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.6148607730865479
distance 1 is tensor(145.0183, device='cuda:1')
distance 2 is tensor(10.8227, device='cuda:1')
benign distance is  tensor(10.8227, device='cuda:1')
norm1 res is  tensor(0.1640, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  1.2117063999176025
distance 1 is tensor(146.4578, device='cuda:1')
distance 2 is tensor(10.5737, device='cuda:1')
benign distance is  tensor(10.5737, device='cuda:1')
norm1 res is  tensor(0.1616, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.3453253209590912
distance 1 is tensor(161.1511, device='cuda:1')
distance 2 is tensor(11.7385, device='cuda:1')
benign distance is  tensor(11.7385, device='cuda:1')
norm1 res is  tensor(0.1767, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.9829467535018921
distance 1 is tensor(169.2224, device='cuda:1')
distance 2 is tensor(12.5215, device='cuda:1')
benign distance is  tensor(12.5215, device='cuda:1')
norm1 res is  tensor(0.1894, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.23429302871227264
distance 1 is tensor(159.0167, device='cuda:1')
distance 2 is tensor(11.7351, device='cuda:1')
benign distance is  tensor(11.7351, device='cuda:1')
norm1 res is  tensor(0.1787, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.6012334823608398
distance 1 is tensor(150.9307, device='cuda:1')
distance 2 is tensor(11.0854, device='cuda:1')
benign distance is  tensor(11.0854, device='cuda:1')
norm1 res is  tensor(0.1703, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.3417920768260956
distance 1 is tensor(154.3810, device='cuda:1')
distance 2 is tensor(11.2484, device='cuda:1')
benign distance is  tensor(11.2484, device='cuda:1')
norm1 res is  tensor(0.1713, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.08921375125646591
distance 1 is tensor(157.9189, device='cuda:1')
distance 2 is tensor(11.3944, device='cuda:1')
benign distance is  tensor(11.3944, device='cuda:1')
norm1 res is  tensor(0.1791, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.9384048581123352
distance 1 is tensor(162.5600, device='cuda:1')
distance 2 is tensor(12.0682, device='cuda:1')
benign distance is  tensor(12.0682, device='cuda:1')
norm1 res is  tensor(0.1828, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.18052175641059875
distance 1 is tensor(146.6040, device='cuda:1')
distance 2 is tensor(10.8355, device='cuda:1')
benign distance is  tensor(10.8355, device='cuda:1')
norm1 res is  tensor(0.1629, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.6923930048942566
distance 1 is tensor(142.4372, device='cuda:1')
distance 2 is tensor(10.5114, device='cuda:1')
benign distance is  tensor(10.5114, device='cuda:1')
norm1 res is  tensor(0.1603, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.30343735218048096
distance 1 is tensor(155.9978, device='cuda:1')
distance 2 is tensor(11.4242, device='cuda:1')
benign distance is  tensor(11.4242, device='cuda:1')
norm1 res is  tensor(0.1730, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  1.071563482284546
distance 1 is tensor(161.8838, device='cuda:1')
distance 2 is tensor(11.8713, device='cuda:1')
benign distance is  tensor(11.8713, device='cuda:1')
norm1 res is  tensor(0.1767, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.7612230181694031
distance 1 is tensor(171.3179, device='cuda:1')
distance 2 is tensor(12.5721, device='cuda:1')
benign distance is  tensor(12.5721, device='cuda:1')
norm1 res is  tensor(0.1920, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  1.3119935989379883
distance 1 is tensor(140.8611, device='cuda:1')
distance 2 is tensor(10.4554, device='cuda:1')
benign distance is  tensor(10.4554, device='cuda:1')
norm1 res is  tensor(0.1570, device='cuda:1')
current submit client idx and staleness is  24 4
 benign loss is  0.46056851744651794
distance 1 is tensor(169.6244, device='cuda:1')
distance 2 is tensor(12.3258, device='cuda:1')
benign distance is  tensor(12.3258, device='cuda:1')
norm1 res is  tensor(0.1899, device='cuda:1')
current submit client idx and staleness is  25 4
 benign loss is  0.29859331250190735
distance 1 is tensor(153.5087, device='cuda:1')
distance 2 is tensor(11.0343, device='cuda:1')
benign distance is  tensor(11.0343, device='cuda:1')
norm1 res is  tensor(0.1682, device='cuda:1')
current submit client idx and staleness is  26 4
 benign loss is  0.3991917073726654
distance 1 is tensor(155.3110, device='cuda:1')
distance 2 is tensor(11.4704, device='cuda:1')
benign distance is  tensor(11.4704, device='cuda:1')
norm1 res is  tensor(0.1721, device='cuda:1')
current submit client idx and staleness is  27 4
 benign loss is  0.16861072182655334
distance 1 is tensor(157.3456, device='cuda:1')
distance 2 is tensor(11.5590, device='cuda:1')
benign distance is  tensor(11.5590, device='cuda:1')
norm1 res is  tensor(0.1796, device='cuda:1')
current submit client idx and staleness is  28 4
 benign loss is  0.7586953043937683
distance 1 is tensor(156.4501, device='cuda:1')
distance 2 is tensor(11.3776, device='cuda:1')
benign distance is  tensor(11.3776, device='cuda:1')
norm1 res is  tensor(0.1728, device='cuda:1')
current submit client idx and staleness is  29 4
 benign loss is  0.7453736066818237
distance 1 is tensor(161.4253, device='cuda:1')
distance 2 is tensor(11.6717, device='cuda:1')
benign distance is  tensor(11.6717, device='cuda:1')
norm1 res is  tensor(0.1780, device='cuda:1')
current submit client idx and staleness is  30 4
 benign loss is  0.4495723247528076
distance 1 is tensor(155.7320, device='cuda:1')
distance 2 is tensor(11.4682, device='cuda:1')
benign distance is  tensor(11.4682, device='cuda:1')
norm1 res is  tensor(0.1735, device='cuda:1')
current submit client idx and staleness is  31 4
 benign loss is  0.9232895970344543
distance 1 is tensor(145.1941, device='cuda:1')
distance 2 is tensor(10.7254, device='cuda:1')
benign distance is  tensor(10.7254, device='cuda:1')
norm1 res is  tensor(0.1639, device='cuda:1')
current submit client idx and staleness is  32 5
 benign loss is  0.8699847459793091
distance 1 is tensor(144.8834, device='cuda:1')
distance 2 is tensor(10.5867, device='cuda:1')
benign distance is  tensor(10.5867, device='cuda:1')
norm1 res is  tensor(0.1600, device='cuda:1')
current submit client idx and staleness is  33 5
 benign loss is  0.3324015736579895
distance 1 is tensor(158.3354, device='cuda:1')
distance 2 is tensor(11.6750, device='cuda:1')
benign distance is  tensor(11.6750, device='cuda:1')
norm1 res is  tensor(0.1761, device='cuda:1')
current submit client idx and staleness is  34 5
 benign loss is  0.19974347949028015
distance 1 is tensor(162.8526, device='cuda:1')
distance 2 is tensor(12.0268, device='cuda:1')
benign distance is  tensor(12.0268, device='cuda:1')
norm1 res is  tensor(0.1810, device='cuda:1')
current submit client idx and staleness is  35 5
 benign loss is  0.5706636309623718
distance 1 is tensor(150.5190, device='cuda:1')
distance 2 is tensor(11.0850, device='cuda:1')
benign distance is  tensor(11.0850, device='cuda:1')
norm1 res is  tensor(0.1667, device='cuda:1')
current submit client idx and staleness is  36 5
 benign loss is  0.4938074052333832
distance 1 is tensor(154.7427, device='cuda:1')
distance 2 is tensor(11.3910, device='cuda:1')
benign distance is  tensor(11.3910, device='cuda:1')
norm1 res is  tensor(0.1717, device='cuda:1')
current submit client idx and staleness is  37 5
 benign loss is  0.36540138721466064
distance 1 is tensor(149.0427, device='cuda:1')
distance 2 is tensor(10.9103, device='cuda:1')
benign distance is  tensor(10.9103, device='cuda:1')
norm1 res is  tensor(0.1643, device='cuda:1')
current submit client idx and staleness is  38 5
 benign loss is  0.12278591096401215
distance 1 is tensor(149.2583, device='cuda:1')
distance 2 is tensor(11.1325, device='cuda:1')
benign distance is  tensor(11.1325, device='cuda:1')
norm1 res is  tensor(0.1667, device='cuda:1')
current submit client idx and staleness is  39 5
 benign loss is  0.7407308220863342
distance 1 is tensor(147.0963, device='cuda:1')
distance 2 is tensor(10.7749, device='cuda:1')
benign distance is  tensor(10.7749, device='cuda:1')
norm1 res is  tensor(0.1610, device='cuda:1')
current submit client idx and staleness is  40 6
 benign loss is  0.24981066584587097
distance 1 is tensor(166.3741, device='cuda:1')
distance 2 is tensor(12.1709, device='cuda:1')
benign distance is  tensor(12.1709, device='cuda:1')
norm1 res is  tensor(0.1833, device='cuda:1')
current submit client idx and staleness is  41 6
 benign loss is  0.3871305286884308
distance 1 is tensor(165.7218, device='cuda:1')
distance 2 is tensor(12.0909, device='cuda:1')
benign distance is  tensor(12.0909, device='cuda:1')
norm1 res is  tensor(0.1828, device='cuda:1')
current submit client idx and staleness is  42 6
 benign loss is  0.5331341028213501
distance 1 is tensor(154.8420, device='cuda:1')
distance 2 is tensor(11.3220, device='cuda:1')
benign distance is  tensor(11.3220, device='cuda:1')
norm1 res is  tensor(0.1708, device='cuda:1')
current submit client idx and staleness is  43 6
 benign loss is  0.6945482492446899
distance 1 is tensor(164.7332, device='cuda:1')
distance 2 is tensor(12.1543, device='cuda:1')
benign distance is  tensor(12.1543, device='cuda:1')
norm1 res is  tensor(0.1849, device='cuda:1')
current submit client idx and staleness is  44 6
 benign loss is  0.20881569385528564
distance 1 is tensor(152.7119, device='cuda:1')
distance 2 is tensor(11.2012, device='cuda:1')
benign distance is  tensor(11.2012, device='cuda:1')
norm1 res is  tensor(0.1655, device='cuda:1')
current submit client idx and staleness is  45 6
 benign loss is  0.621756911277771
distance 1 is tensor(161.5555, device='cuda:1')
distance 2 is tensor(11.9274, device='cuda:1')
benign distance is  tensor(11.9274, device='cuda:1')
norm1 res is  tensor(0.1794, device='cuda:1')
current submit client idx and staleness is  46 6
 benign loss is  0.38326433300971985
distance 1 is tensor(155.2223, device='cuda:1')
distance 2 is tensor(11.3954, device='cuda:1')
benign distance is  tensor(11.3954, device='cuda:1')
norm1 res is  tensor(0.1728, device='cuda:1')
current submit client idx and staleness is  47 6
 benign loss is  0.5503740906715393
distance 1 is tensor(149.4650, device='cuda:1')
distance 2 is tensor(10.9842, device='cuda:1')
benign distance is  tensor(10.9842, device='cuda:1')
norm1 res is  tensor(0.1698, device='cuda:1')
current submit client idx and staleness is  48 1
 benign loss is  0.32863524556159973
distance 1 is tensor(139.5769, device='cuda:1')
distance 2 is tensor(10.2332, device='cuda:1')
benign distance is  tensor(10.2332, device='cuda:1')
norm1 res is  tensor(0.1530, device='cuda:1')
current submit client idx and staleness is  49 1
 benign loss is  0.7826055288314819
distance 1 is tensor(147.0639, device='cuda:1')
distance 2 is tensor(10.7654, device='cuda:1')
benign distance is  tensor(10.7654, device='cuda:1')
norm1 res is  tensor(0.1655, device='cuda:1')
current submit client idx and staleness is  50 1
 benign loss is  0.43003106117248535
distance 1 is tensor(159.2117, device='cuda:1')
distance 2 is tensor(11.7528, device='cuda:1')
benign distance is  tensor(11.7528, device='cuda:1')
norm1 res is  tensor(0.1777, device='cuda:1')
current submit client idx and staleness is  51 1
 benign loss is  0.9150878190994263
distance 1 is tensor(151.3456, device='cuda:1')
distance 2 is tensor(10.9304, device='cuda:1')
benign distance is  tensor(10.9304, device='cuda:1')
norm1 res is  tensor(0.1629, device='cuda:1')
current submit client idx and staleness is  52 1
 benign loss is  0.37311887741088867
distance 1 is tensor(155.9690, device='cuda:1')
distance 2 is tensor(11.3319, device='cuda:1')
benign distance is  tensor(11.3319, device='cuda:1')
norm1 res is  tensor(0.1705, device='cuda:1')
current submit client idx and staleness is  53 1
 benign loss is  0.6527214050292969
distance 1 is tensor(145.6125, device='cuda:1')
distance 2 is tensor(10.7336, device='cuda:1')
benign distance is  tensor(10.7336, device='cuda:1')
norm1 res is  tensor(0.1640, device='cuda:1')
current submit client idx and staleness is  54 1
 benign loss is  0.22739148139953613
distance 1 is tensor(155.9653, device='cuda:1')
distance 2 is tensor(11.4528, device='cuda:1')
benign distance is  tensor(11.4528, device='cuda:1')
norm1 res is  tensor(0.1740, device='cuda:1')
current submit client idx and staleness is  55 1
 benign loss is  0.3453037142753601
distance 1 is tensor(154.3396, device='cuda:1')
distance 2 is tensor(11.1410, device='cuda:1')
benign distance is  tensor(11.1410, device='cuda:1')
norm1 res is  tensor(0.1714, device='cuda:1')
current submit client idx and staleness is  56 1
 benign loss is  0.13479074835777283
distance 1 is tensor(146.1440, device='cuda:1')
distance 2 is tensor(10.5969, device='cuda:1')
benign distance is  tensor(10.5969, device='cuda:1')
norm1 res is  tensor(0.1609, device='cuda:1')
current submit client idx and staleness is  57 1
 benign loss is  0.39037030935287476
distance 1 is tensor(149.9129, device='cuda:1')
distance 2 is tensor(11.0335, device='cuda:1')
benign distance is  tensor(11.0335, device='cuda:1')
norm1 res is  tensor(0.1644, device='cuda:1')
current submit client idx and staleness is  58 1
 benign loss is  0.21832506358623505
distance 1 is tensor(162.3205, device='cuda:1')
distance 2 is tensor(11.7395, device='cuda:1')
benign distance is  tensor(11.7395, device='cuda:1')
norm1 res is  tensor(0.1787, device='cuda:1')
current submit client idx and staleness is  59 1
 benign loss is  0.18608546257019043
distance 1 is tensor(154.0654, device='cuda:1')
distance 2 is tensor(11.1528, device='cuda:1')
benign distance is  tensor(11.1528, device='cuda:1')
norm1 res is  tensor(0.1682, device='cuda:1')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.3655, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.2601, device='cuda:1')
c is  tensor(0.0253, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.8102, device='cuda:1')
c is  tensor(0.0241, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0015, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.8456, device='cuda:1')
c is  tensor(0.0234, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0028, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.0723, device='cuda:1')
c is  tensor(0.0241, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.5200, device='cuda:1')
c is  tensor(0.0243, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.0162, device='cuda:1')
c is  tensor(0.0232, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.7581, device='cuda:1')
c is  tensor(0.0242, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.8746, device='cuda:1')
c is  tensor(0.0223, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0012, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.1448, device='cuda:1')
c is  tensor(0.0246, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.4841, device='cuda:1')
c is  tensor(0.0238, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.6402, device='cuda:1')
c is  tensor(0.0229, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.6895, device='cuda:1')
c is  tensor(0.0238, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.2499, device='cuda:1')
c is  tensor(0.0233, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.1542, device='cuda:1')
c is  tensor(0.0236, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0008, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.5297, device='cuda:1')
c is  tensor(0.0230, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.8844, device='cuda:1')
c is  tensor(0.0232, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0013, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.4881, device='cuda:1')
c is  tensor(0.0239, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0011, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.1796, device='cuda:1')
c is  tensor(0.0237, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0010, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.8593, device='cuda:1')
c is  tensor(0.0228, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0021, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.5772, device='cuda:1')
c is  tensor(0.0235, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0007, device='cuda:1')
accept
len accept list 20
len all weights is 20
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 93.18% 

Test Accuracy: 89.99% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  0.136114239692688
distance 1 is tensor(107.7454, device='cuda:1')
distance 2 is tensor(7.8491, device='cuda:1')
benign distance is  tensor(7.8491, device='cuda:1')
norm1 res is  tensor(0.1199, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.5169466733932495
distance 1 is tensor(131.5181, device='cuda:1')
distance 2 is tensor(9.5539, device='cuda:1')
benign distance is  tensor(9.5539, device='cuda:1')
norm1 res is  tensor(0.1460, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.21406622231006622
distance 1 is tensor(147.5196, device='cuda:1')
distance 2 is tensor(10.5327, device='cuda:1')
benign distance is  tensor(10.5327, device='cuda:1')
norm1 res is  tensor(0.1593, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.9405167698860168
distance 1 is tensor(132.0957, device='cuda:1')
distance 2 is tensor(9.6351, device='cuda:1')
benign distance is  tensor(9.6351, device='cuda:1')
norm1 res is  tensor(0.1483, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.41239380836486816
distance 1 is tensor(127.6574, device='cuda:1')
distance 2 is tensor(9.1744, device='cuda:1')
benign distance is  tensor(9.1744, device='cuda:1')
norm1 res is  tensor(0.1383, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.585202157497406
distance 1 is tensor(139.5150, device='cuda:1')
distance 2 is tensor(10.0425, device='cuda:1')
benign distance is  tensor(10.0425, device='cuda:1')
norm1 res is  tensor(0.1538, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.37269556522369385
distance 1 is tensor(129.2041, device='cuda:1')
distance 2 is tensor(9.2860, device='cuda:1')
benign distance is  tensor(9.2860, device='cuda:1')
norm1 res is  tensor(0.1399, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.4050372540950775
distance 1 is tensor(145.1588, device='cuda:1')
distance 2 is tensor(10.4763, device='cuda:1')
benign distance is  tensor(10.4763, device='cuda:1')
norm1 res is  tensor(0.1599, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.2912, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(476.0077, device='cuda:1')
c is  tensor(0.0247, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.2125, device='cuda:1')
c is  tensor(0.0225, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0009, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.0433, device='cuda:1')
c is  tensor(0.0215, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.7297, device='cuda:1')
c is  tensor(0.0223, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.8782, device='cuda:1')
c is  tensor(0.0231, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.1823, device='cuda:1')
c is  tensor(0.0218, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.0173, device='cuda:1')
c is  tensor(0.0229, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.5707, device='cuda:1')
c is  tensor(0.0214, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.1762, device='cuda:1')
c is  tensor(0.0203, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.1572, device='cuda:1')
c is  tensor(0.0211, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.9047e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.3488, device='cuda:1')
c is  tensor(0.0212, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.2033, device='cuda:1')
c is  tensor(0.0204, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.9176e-06, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.3248, device='cuda:1')
c is  tensor(0.0196, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.3866e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(707.1759, device='cuda:1')
c is  tensor(0.0203, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.6367, device='cuda:1')
c is  tensor(0.0208, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.9065, device='cuda:1')
c is  tensor(0.0207, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
len accept list 4
len all weights is 4
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 93.01% 

Test Accuracy: 89.67% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.42543768882751465
distance 1 is tensor(126.4016, device='cuda:1')
distance 2 is tensor(9.1928, device='cuda:1')
benign distance is  tensor(9.1928, device='cuda:1')
norm1 res is  tensor(0.1392, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.44245773553848267
distance 1 is tensor(144.7309, device='cuda:1')
distance 2 is tensor(10.4950, device='cuda:1')
benign distance is  tensor(10.4950, device='cuda:1')
norm1 res is  tensor(0.1616, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.27186840772628784
distance 1 is tensor(115.9091, device='cuda:1')
distance 2 is tensor(8.3335, device='cuda:1')
benign distance is  tensor(8.3335, device='cuda:1')
norm1 res is  tensor(0.1280, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.4937650263309479
distance 1 is tensor(132.1349, device='cuda:1')
distance 2 is tensor(9.6097, device='cuda:1')
benign distance is  tensor(9.6097, device='cuda:1')
norm1 res is  tensor(0.1480, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.6347549557685852
distance 1 is tensor(127.5341, device='cuda:1')
distance 2 is tensor(9.2932, device='cuda:1')
benign distance is  tensor(9.2932, device='cuda:1')
norm1 res is  tensor(0.1410, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.24079883098602295
distance 1 is tensor(136.5415, device='cuda:1')
distance 2 is tensor(10.0168, device='cuda:1')
benign distance is  tensor(10.0168, device='cuda:1')
norm1 res is  tensor(0.1548, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.3904121518135071
distance 1 is tensor(142.7597, device='cuda:1')
distance 2 is tensor(10.2700, device='cuda:1')
benign distance is  tensor(10.2700, device='cuda:1')
norm1 res is  tensor(0.1561, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.5990756750106812
distance 1 is tensor(139.1346, device='cuda:1')
distance 2 is tensor(10.1593, device='cuda:1')
benign distance is  tensor(10.1593, device='cuda:1')
norm1 res is  tensor(0.1533, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.08434541523456573
distance 1 is tensor(151.7051, device='cuda:1')
distance 2 is tensor(11.0608, device='cuda:1')
benign distance is  tensor(11.0608, device='cuda:1')
norm1 res is  tensor(0.1696, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.7932273149490356
distance 1 is tensor(144.0313, device='cuda:1')
distance 2 is tensor(10.4490, device='cuda:1')
benign distance is  tensor(10.4490, device='cuda:1')
norm1 res is  tensor(0.1582, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.2358180731534958
distance 1 is tensor(141.7850, device='cuda:1')
distance 2 is tensor(10.1622, device='cuda:1')
benign distance is  tensor(10.1622, device='cuda:1')
norm1 res is  tensor(0.1528, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.8934783935546875
distance 1 is tensor(158.5963, device='cuda:1')
distance 2 is tensor(11.5042, device='cuda:1')
benign distance is  tensor(11.5042, device='cuda:1')
norm1 res is  tensor(0.1730, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.6327484846115112
distance 1 is tensor(140.7336, device='cuda:1')
distance 2 is tensor(10.3110, device='cuda:1')
benign distance is  tensor(10.3110, device='cuda:1')
norm1 res is  tensor(0.1577, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.42102891206741333
distance 1 is tensor(132.5362, device='cuda:1')
distance 2 is tensor(9.4919, device='cuda:1')
benign distance is  tensor(9.4919, device='cuda:1')
norm1 res is  tensor(0.1424, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.6826654672622681
distance 1 is tensor(132.1398, device='cuda:1')
distance 2 is tensor(9.5319, device='cuda:1')
benign distance is  tensor(9.5319, device='cuda:1')
norm1 res is  tensor(0.1448, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.5463040471076965
distance 1 is tensor(156.0661, device='cuda:1')
distance 2 is tensor(11.3263, device='cuda:1')
benign distance is  tensor(11.3263, device='cuda:1')
norm1 res is  tensor(0.1704, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.2574, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.5596, device='cuda:1')
c is  tensor(0.0216, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.0760, device='cuda:1')
c is  tensor(0.0201, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.4786e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(495.3883, device='cuda:1')
c is  tensor(0.0228, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.7484e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.7686, device='cuda:1')
c is  tensor(0.0210, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.2314, device='cuda:1')
c is  tensor(0.0216, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.0340e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.7932, device='cuda:1')
c is  tensor(0.0205, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.6992, device='cuda:1')
c is  tensor(0.0204, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.6268, device='cuda:1')
c is  tensor(0.0206, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.4077e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(741.8336, device='cuda:1')
c is  tensor(0.0186, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(766.9600, device='cuda:1')
c is  tensor(0.0183, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.8757, device='cuda:1')
c is  tensor(0.0193, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.3341e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.8726, device='cuda:1')
c is  tensor(0.0194, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.5976, device='cuda:1')
c is  tensor(0.0189, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.7617, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0006, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(795.9456, device='cuda:1')
c is  tensor(0.0180, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.2585, device='cuda:1')
c is  tensor(0.0196, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:1')
len accept list 2
len all weights is 2
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 92.58% 

Test Accuracy: 89.27% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2004355490207672
distance 1 is tensor(136.2666, device='cuda:1')
distance 2 is tensor(9.7672, device='cuda:1')
benign distance is  tensor(9.7672, device='cuda:1')
norm1 res is  tensor(0.1470, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.7910854816436768
distance 1 is tensor(141.9908, device='cuda:1')
distance 2 is tensor(10.3460, device='cuda:1')
benign distance is  tensor(10.3460, device='cuda:1')
norm1 res is  tensor(0.1566, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.3657858073711395
distance 1 is tensor(107.3281, device='cuda:1')
distance 2 is tensor(7.8447, device='cuda:1')
benign distance is  tensor(7.8447, device='cuda:1')
norm1 res is  tensor(0.1209, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.23903866112232208
distance 1 is tensor(143.2621, device='cuda:1')
distance 2 is tensor(10.3418, device='cuda:1')
benign distance is  tensor(10.3418, device='cuda:1')
norm1 res is  tensor(0.1557, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.3490960896015167
distance 1 is tensor(121.2501, device='cuda:1')
distance 2 is tensor(8.9116, device='cuda:1')
benign distance is  tensor(8.9116, device='cuda:1')
norm1 res is  tensor(0.1320, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.14444120228290558
distance 1 is tensor(148.5937, device='cuda:1')
distance 2 is tensor(10.8487, device='cuda:1')
benign distance is  tensor(10.8487, device='cuda:1')
norm1 res is  tensor(0.1641, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  1.028202772140503
distance 1 is tensor(162.3143, device='cuda:1')
distance 2 is tensor(11.6680, device='cuda:1')
benign distance is  tensor(11.6680, device='cuda:1')
norm1 res is  tensor(0.1778, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.3483125567436218
distance 1 is tensor(144.6801, device='cuda:1')
distance 2 is tensor(10.3844, device='cuda:1')
benign distance is  tensor(10.3844, device='cuda:1')
norm1 res is  tensor(0.1558, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.17619188129901886
distance 1 is tensor(110.4907, device='cuda:1')
distance 2 is tensor(8.1025, device='cuda:1')
benign distance is  tensor(8.1025, device='cuda:1')
norm1 res is  tensor(0.1239, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.4171128273010254
distance 1 is tensor(168.0428, device='cuda:1')
distance 2 is tensor(12.0646, device='cuda:1')
benign distance is  tensor(12.0646, device='cuda:1')
norm1 res is  tensor(0.1831, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.5962337255477905
distance 1 is tensor(152.4434, device='cuda:1')
distance 2 is tensor(11.0548, device='cuda:1')
benign distance is  tensor(11.0548, device='cuda:1')
norm1 res is  tensor(0.1626, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.35228613018989563
distance 1 is tensor(145.9941, device='cuda:1')
distance 2 is tensor(10.7128, device='cuda:1')
benign distance is  tensor(10.7128, device='cuda:1')
norm1 res is  tensor(0.1629, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.26422232389450073
distance 1 is tensor(148.1934, device='cuda:1')
distance 2 is tensor(10.7613, device='cuda:1')
benign distance is  tensor(10.7613, device='cuda:1')
norm1 res is  tensor(0.1614, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  0.3173947036266327
distance 1 is tensor(143.3184, device='cuda:1')
distance 2 is tensor(10.4756, device='cuda:1')
benign distance is  tensor(10.4756, device='cuda:1')
norm1 res is  tensor(0.1577, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.34699633717536926
distance 1 is tensor(154.9145, device='cuda:1')
distance 2 is tensor(11.3822, device='cuda:1')
benign distance is  tensor(11.3822, device='cuda:1')
norm1 res is  tensor(0.1737, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  0.552626371383667
distance 1 is tensor(153.7890, device='cuda:1')
distance 2 is tensor(11.2090, device='cuda:1')
benign distance is  tensor(11.2090, device='cuda:1')
norm1 res is  tensor(0.1670, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 24
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1146, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.7693, device='cuda:1')
c is  tensor(0.0140, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.5184e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.3813, device='cuda:1')
c is  tensor(0.0136, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.3320, device='cuda:1')
c is  tensor(0.0156, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.6777e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.8688, device='cuda:1')
c is  tensor(0.0137, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(525.8025, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.7206e-06, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(644.3955, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.4467, device='cuda:1')
c is  tensor(0.0127, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-9.6737e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.7296, device='cuda:1')
c is  tensor(0.0136, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(837.1355, device='cuda:1')
c is  tensor(0.0117, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(763.0330, device='cuda:1')
c is  tensor(0.0123, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.2239e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(770.7158, device='cuda:1')
c is  tensor(0.0122, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.0223e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(784.4177, device='cuda:1')
c is  tensor(0.0121, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.7950, device='cuda:1')
c is  tensor(0.0122, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(794.2188, device='cuda:1')
c is  tensor(0.0120, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.8706e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(775.9816, device='cuda:1')
c is  tensor(0.0122, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(738.9464, device='cuda:1')
c is  tensor(0.0125, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.0166e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(754.5882, device='cuda:1')
c is  tensor(0.0123, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(723.8684, device='cuda:1')
c is  tensor(0.0126, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.9002e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.5018, device='cuda:1')
c is  tensor(0.0128, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.7172e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(766.8315, device='cuda:1')
c is  tensor(0.0122, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.5592e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.9207, device='cuda:1')
c is  tensor(0.0127, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.7608e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.6572, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.1065e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.5200, device='cuda:1')
c is  tensor(0.0130, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.2915e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.3356, device='cuda:1')
c is  tensor(0.0123, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.0480e-05, device='cuda:1')
len accept list 13
len all weights is 13
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 92.98% 

Test Accuracy: 89.83% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3157549202442169
distance 1 is tensor(127.0517, device='cuda:1')
distance 2 is tensor(9.2034, device='cuda:1')
benign distance is  tensor(9.2034, device='cuda:1')
norm1 res is  tensor(0.1403, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  1.2117961645126343
distance 1 is tensor(127.4109, device='cuda:1')
distance 2 is tensor(9.2410, device='cuda:1')
benign distance is  tensor(9.2410, device='cuda:1')
norm1 res is  tensor(0.1443, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.15717145800590515
distance 1 is tensor(113.6276, device='cuda:1')
distance 2 is tensor(8.1829, device='cuda:1')
benign distance is  tensor(8.1829, device='cuda:1')
norm1 res is  tensor(0.1223, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.559150218963623
distance 1 is tensor(130.5409, device='cuda:1')
distance 2 is tensor(9.4243, device='cuda:1')
benign distance is  tensor(9.4243, device='cuda:1')
norm1 res is  tensor(0.1419, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.42818689346313477
distance 1 is tensor(149.8872, device='cuda:1')
distance 2 is tensor(10.6786, device='cuda:1')
benign distance is  tensor(10.6786, device='cuda:1')
norm1 res is  tensor(0.1623, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.5407007336616516
distance 1 is tensor(151.8466, device='cuda:1')
distance 2 is tensor(10.9752, device='cuda:1')
benign distance is  tensor(10.9752, device='cuda:1')
norm1 res is  tensor(0.1665, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.14849309623241425
distance 1 is tensor(147.9238, device='cuda:1')
distance 2 is tensor(10.6728, device='cuda:1')
benign distance is  tensor(10.6728, device='cuda:1')
norm1 res is  tensor(0.1644, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.9490159749984741
distance 1 is tensor(136.2516, device='cuda:1')
distance 2 is tensor(9.8083, device='cuda:1')
benign distance is  tensor(9.8083, device='cuda:1')
norm1 res is  tensor(0.1508, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.4310378432273865
distance 1 is tensor(168.6051, device='cuda:1')
distance 2 is tensor(12.2150, device='cuda:1')
benign distance is  tensor(12.2150, device='cuda:1')
norm1 res is  tensor(0.1865, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.40916138887405396
distance 1 is tensor(140.8411, device='cuda:1')
distance 2 is tensor(10.1230, device='cuda:1')
benign distance is  tensor(10.1230, device='cuda:1')
norm1 res is  tensor(0.1543, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.5418933629989624
distance 1 is tensor(150.8226, device='cuda:1')
distance 2 is tensor(10.7961, device='cuda:1')
benign distance is  tensor(10.7961, device='cuda:1')
norm1 res is  tensor(0.1647, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.9297954440116882
distance 1 is tensor(154.5598, device='cuda:1')
distance 2 is tensor(11.1930, device='cuda:1')
benign distance is  tensor(11.1930, device='cuda:1')
norm1 res is  tensor(0.1690, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.5275325775146484
distance 1 is tensor(135.6057, device='cuda:1')
distance 2 is tensor(10.0171, device='cuda:1')
benign distance is  tensor(10.0171, device='cuda:1')
norm1 res is  tensor(0.1529, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.1664036214351654
distance 1 is tensor(129.8341, device='cuda:1')
distance 2 is tensor(9.4523, device='cuda:1')
benign distance is  tensor(9.4523, device='cuda:1')
norm1 res is  tensor(0.1426, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.6909809112548828
distance 1 is tensor(148.2775, device='cuda:1')
distance 2 is tensor(10.8884, device='cuda:1')
benign distance is  tensor(10.8884, device='cuda:1')
norm1 res is  tensor(0.1652, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.9791005253791809
distance 1 is tensor(142.0851, device='cuda:1')
distance 2 is tensor(10.2026, device='cuda:1')
benign distance is  tensor(10.2026, device='cuda:1')
norm1 res is  tensor(0.1540, device='cuda:1')
current submit client idx and staleness is  24 4
 benign loss is  0.12873627245426178
distance 1 is tensor(148.7693, device='cuda:1')
distance 2 is tensor(10.7498, device='cuda:1')
benign distance is  tensor(10.7498, device='cuda:1')
norm1 res is  tensor(0.1643, device='cuda:1')
current submit client idx and staleness is  25 4
 benign loss is  0.5949403047561646
distance 1 is tensor(135.4150, device='cuda:1')
distance 2 is tensor(9.7243, device='cuda:1')
benign distance is  tensor(9.7243, device='cuda:1')
norm1 res is  tensor(0.1458, device='cuda:1')
current submit client idx and staleness is  26 4
 benign loss is  0.384067565202713
distance 1 is tensor(156.6790, device='cuda:1')
distance 2 is tensor(11.4122, device='cuda:1')
benign distance is  tensor(11.4122, device='cuda:1')
norm1 res is  tensor(0.1723, device='cuda:1')
current submit client idx and staleness is  27 4
 benign loss is  0.682242214679718
distance 1 is tensor(152.8874, device='cuda:1')
distance 2 is tensor(11.0924, device='cuda:1')
benign distance is  tensor(11.0924, device='cuda:1')
norm1 res is  tensor(0.1679, device='cuda:1')
current submit client idx and staleness is  28 4
 benign loss is  0.822403073310852
distance 1 is tensor(148.0852, device='cuda:1')
distance 2 is tensor(10.6640, device='cuda:1')
benign distance is  tensor(10.6640, device='cuda:1')
norm1 res is  tensor(0.1608, device='cuda:1')
current submit client idx and staleness is  29 4
 benign loss is  0.31397300958633423
distance 1 is tensor(147.2471, device='cuda:1')
distance 2 is tensor(10.6377, device='cuda:1')
benign distance is  tensor(10.6377, device='cuda:1')
norm1 res is  tensor(0.1639, device='cuda:1')
current submit client idx and staleness is  30 4
 benign loss is  0.19090548157691956
distance 1 is tensor(143.4261, device='cuda:1')
distance 2 is tensor(10.3954, device='cuda:1')
benign distance is  tensor(10.3954, device='cuda:1')
norm1 res is  tensor(0.1573, device='cuda:1')
current submit client idx and staleness is  31 4
 benign loss is  0.41068941354751587
distance 1 is tensor(153.9787, device='cuda:1')
distance 2 is tensor(11.0979, device='cuda:1')
benign distance is  tensor(11.0979, device='cuda:1')
norm1 res is  tensor(0.1703, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(0.1992, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(550.3656, device='cuda:1')
c is  tensor(0.0190, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.4102e-06, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.9588, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(485.7199, device='cuda:1')
c is  tensor(0.0203, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(9.3543e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(559.5193, device='cuda:1')
c is  tensor(0.0189, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.5606, device='cuda:1')
c is  tensor(0.0177, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.7459, device='cuda:1')
c is  tensor(0.0174, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.5623, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.3662e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(595.6528, device='cuda:1')
c is  tensor(0.0183, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.4114e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.7849, device='cuda:1')
c is  tensor(0.0171, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.7083, device='cuda:1')
c is  tensor(0.0164, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.2968, device='cuda:1')
c is  tensor(0.0162, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.4702, device='cuda:1')
c is  tensor(0.0168, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.9633, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.0662, device='cuda:1')
c is  tensor(0.0169, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(700.9758, device='cuda:1')
c is  tensor(0.0169, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.2588, device='cuda:1')
c is  tensor(0.0172, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.5214e-05, device='cuda:1')
len accept list 7
len all weights is 7
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 93.03% 

Test Accuracy: 89.67% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5678888559341431
distance 1 is tensor(109.6655, device='cuda:1')
distance 2 is tensor(8.1297, device='cuda:1')
benign distance is  tensor(8.1297, device='cuda:1')
norm1 res is  tensor(0.1229, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.10551904141902924
distance 1 is tensor(130.9256, device='cuda:1')
distance 2 is tensor(9.4390, device='cuda:1')
benign distance is  tensor(9.4390, device='cuda:1')
norm1 res is  tensor(0.1443, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.27039018273353577
distance 1 is tensor(120.3542, device='cuda:1')
distance 2 is tensor(8.7218, device='cuda:1')
benign distance is  tensor(8.7218, device='cuda:1')
norm1 res is  tensor(0.1331, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.16541780531406403
distance 1 is tensor(123.2005, device='cuda:1')
distance 2 is tensor(9.0710, device='cuda:1')
benign distance is  tensor(9.0710, device='cuda:1')
norm1 res is  tensor(0.1376, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.2810494005680084
distance 1 is tensor(121.2864, device='cuda:1')
distance 2 is tensor(8.6639, device='cuda:1')
benign distance is  tensor(8.6639, device='cuda:1')
norm1 res is  tensor(0.1309, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.47570711374282837
distance 1 is tensor(143.2989, device='cuda:1')
distance 2 is tensor(10.5252, device='cuda:1')
benign distance is  tensor(10.5252, device='cuda:1')
norm1 res is  tensor(0.1613, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.06493440270423889
distance 1 is tensor(127.0841, device='cuda:1')
distance 2 is tensor(9.1838, device='cuda:1')
benign distance is  tensor(9.1838, device='cuda:1')
norm1 res is  tensor(0.1396, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.29110658168792725
distance 1 is tensor(139.5230, device='cuda:1')
distance 2 is tensor(9.9872, device='cuda:1')
benign distance is  tensor(9.9872, device='cuda:1')
norm1 res is  tensor(0.1532, device='cuda:1')
current submit client idx and staleness is  32 5
 benign loss is  0.4696703851222992
distance 1 is tensor(140.9818, device='cuda:1')
distance 2 is tensor(10.2853, device='cuda:1')
benign distance is  tensor(10.2853, device='cuda:1')
norm1 res is  tensor(0.1555, device='cuda:1')
current submit client idx and staleness is  33 5
 benign loss is  0.25107264518737793
distance 1 is tensor(143.5576, device='cuda:1')
distance 2 is tensor(10.6458, device='cuda:1')
benign distance is  tensor(10.6458, device='cuda:1')
norm1 res is  tensor(0.1652, device='cuda:1')
current submit client idx and staleness is  34 5
 benign loss is  0.40160518884658813
distance 1 is tensor(129.8640, device='cuda:1')
distance 2 is tensor(9.4876, device='cuda:1')
benign distance is  tensor(9.4876, device='cuda:1')
norm1 res is  tensor(0.1407, device='cuda:1')
current submit client idx and staleness is  35 5
 benign loss is  0.09286434948444366
distance 1 is tensor(142.3377, device='cuda:1')
distance 2 is tensor(10.4973, device='cuda:1')
benign distance is  tensor(10.4973, device='cuda:1')
norm1 res is  tensor(0.1602, device='cuda:1')
current submit client idx and staleness is  36 5
 benign loss is  0.6480101943016052
distance 1 is tensor(144.8100, device='cuda:1')
distance 2 is tensor(10.5017, device='cuda:1')
benign distance is  tensor(10.5017, device='cuda:1')
norm1 res is  tensor(0.1599, device='cuda:1')
current submit client idx and staleness is  37 5
 benign loss is  0.4749196469783783
distance 1 is tensor(137.4771, device='cuda:1')
distance 2 is tensor(10.0283, device='cuda:1')
benign distance is  tensor(10.0283, device='cuda:1')
norm1 res is  tensor(0.1493, device='cuda:1')
current submit client idx and staleness is  38 5
 benign loss is  0.612275242805481
distance 1 is tensor(144.7692, device='cuda:1')
distance 2 is tensor(10.6269, device='cuda:1')
benign distance is  tensor(10.6269, device='cuda:1')
norm1 res is  tensor(0.1596, device='cuda:1')
current submit client idx and staleness is  39 5
 benign loss is  0.1724931001663208
distance 1 is tensor(130.4393, device='cuda:1')
distance 2 is tensor(9.4477, device='cuda:1')
benign distance is  tensor(9.4477, device='cuda:1')
norm1 res is  tensor(0.1436, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 32
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1684, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(481.7287, device='cuda:1')
c is  tensor(0.0187, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.4224e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(564.7670, device='cuda:1')
c is  tensor(0.0173, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.1260e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(526.2234, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(541.1196, device='cuda:1')
c is  tensor(0.0176, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(516.4561, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.2881e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.2114, device='cuda:1')
c is  tensor(0.0163, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.9893, device='cuda:1')
c is  tensor(0.0174, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.5069, device='cuda:1')
c is  tensor(0.0168, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.4261, device='cuda:1')
c is  tensor(0.0150, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(755.3544, device='cuda:1')
c is  tensor(0.0149, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.5334e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.8245, device='cuda:1')
c is  tensor(0.0155, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.8497e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.0898, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.2062, device='cuda:1')
c is  tensor(0.0156, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.5572, device='cuda:1')
c is  tensor(0.0150, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.3570, device='cuda:1')
c is  tensor(0.0153, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.6987e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.3860, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.9982, device='cuda:1')
c is  tensor(0.0167, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(782.5519, device='cuda:1')
c is  tensor(0.0147, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.8129, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-1.7616e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6459, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.0821e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.5120, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.8128, device='cuda:1')
c is  tensor(0.0156, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.8258, device='cuda:1')
c is  tensor(0.0150, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.9129e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.9100, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-5.1652e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.3555, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.3345e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.8122, device='cuda:1')
c is  tensor(0.0161, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.4764e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.5297, device='cuda:1')
c is  tensor(0.0157, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(703.8884, device='cuda:1')
c is  tensor(0.0155, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.0789, device='cuda:1')
c is  tensor(0.0162, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.5217, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.0532, device='cuda:1')
c is  tensor(0.0156, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.0355e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.2880, device='cuda:1')
c is  tensor(0.0161, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
len accept list 12
len all weights is 12
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 92.95% 

Test Accuracy: 89.86% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
 benign loss is  0.10962921380996704
distance 1 is tensor(130.2917, device='cuda:1')
distance 2 is tensor(9.1602, device='cuda:1')
benign distance is  tensor(9.1602, device='cuda:1')
norm1 res is  tensor(0.1386, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.2379399538040161
distance 1 is tensor(127.7036, device='cuda:1')
distance 2 is tensor(9.2681, device='cuda:1')
benign distance is  tensor(9.2681, device='cuda:1')
norm1 res is  tensor(0.1424, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.03155677020549774
distance 1 is tensor(113.7470, device='cuda:1')
distance 2 is tensor(8.1839, device='cuda:1')
benign distance is  tensor(8.1839, device='cuda:1')
norm1 res is  tensor(0.1234, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.3863750398159027
distance 1 is tensor(127.7026, device='cuda:1')
distance 2 is tensor(9.2862, device='cuda:1')
benign distance is  tensor(9.2862, device='cuda:1')
norm1 res is  tensor(0.1403, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.7685197591781616
distance 1 is tensor(118.8631, device='cuda:1')
distance 2 is tensor(8.5527, device='cuda:1')
benign distance is  tensor(8.5527, device='cuda:1')
norm1 res is  tensor(0.1303, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.5970531702041626
distance 1 is tensor(145.3501, device='cuda:1')
distance 2 is tensor(10.5792, device='cuda:1')
benign distance is  tensor(10.5792, device='cuda:1')
norm1 res is  tensor(0.1607, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.24297615885734558
distance 1 is tensor(138.9185, device='cuda:1')
distance 2 is tensor(9.9296, device='cuda:1')
benign distance is  tensor(9.9296, device='cuda:1')
norm1 res is  tensor(0.1489, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.32054924964904785
distance 1 is tensor(139.5976, device='cuda:1')
distance 2 is tensor(10.2356, device='cuda:1')
benign distance is  tensor(10.2356, device='cuda:1')
norm1 res is  tensor(0.1538, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.17047743499279022
distance 1 is tensor(156.8949, device='cuda:1')
distance 2 is tensor(11.1880, device='cuda:1')
benign distance is  tensor(11.1880, device='cuda:1')
norm1 res is  tensor(0.1681, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.524753212928772
distance 1 is tensor(129.3760, device='cuda:1')
distance 2 is tensor(9.4029, device='cuda:1')
benign distance is  tensor(9.4029, device='cuda:1')
norm1 res is  tensor(0.1416, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.7266963720321655
distance 1 is tensor(140.2283, device='cuda:1')
distance 2 is tensor(10.0567, device='cuda:1')
benign distance is  tensor(10.0567, device='cuda:1')
norm1 res is  tensor(0.1517, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.22013333439826965
distance 1 is tensor(137.9226, device='cuda:1')
distance 2 is tensor(10.1084, device='cuda:1')
benign distance is  tensor(10.1084, device='cuda:1')
norm1 res is  tensor(0.1521, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.5868061184883118
distance 1 is tensor(148.4030, device='cuda:1')
distance 2 is tensor(10.8840, device='cuda:1')
benign distance is  tensor(10.8840, device='cuda:1')
norm1 res is  tensor(0.1656, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.3794356882572174
distance 1 is tensor(160.1659, device='cuda:1')
distance 2 is tensor(11.4206, device='cuda:1')
benign distance is  tensor(11.4206, device='cuda:1')
norm1 res is  tensor(0.1762, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.35094892978668213
distance 1 is tensor(146.9375, device='cuda:1')
distance 2 is tensor(10.8004, device='cuda:1')
benign distance is  tensor(10.8004, device='cuda:1')
norm1 res is  tensor(0.1639, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.6331326365470886
distance 1 is tensor(152.9053, device='cuda:1')
distance 2 is tensor(10.9189, device='cuda:1')
benign distance is  tensor(10.9189, device='cuda:1')
norm1 res is  tensor(0.1649, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.07196982204914093
distance 1 is tensor(132.2677, device='cuda:1')
distance 2 is tensor(9.7157, device='cuda:1')
benign distance is  tensor(9.7157, device='cuda:1')
norm1 res is  tensor(0.1510, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.5977003574371338
distance 1 is tensor(150.9353, device='cuda:1')
distance 2 is tensor(10.9709, device='cuda:1')
benign distance is  tensor(10.9709, device='cuda:1')
norm1 res is  tensor(0.1682, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.028055410832166672
distance 1 is tensor(150.3766, device='cuda:1')
distance 2 is tensor(10.9126, device='cuda:1')
benign distance is  tensor(10.9126, device='cuda:1')
norm1 res is  tensor(0.1643, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.6327402591705322
distance 1 is tensor(133.3899, device='cuda:1')
distance 2 is tensor(9.7175, device='cuda:1')
benign distance is  tensor(9.7175, device='cuda:1')
norm1 res is  tensor(0.1498, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.4158724248409271
distance 1 is tensor(140.2885, device='cuda:1')
distance 2 is tensor(10.2588, device='cuda:1')
benign distance is  tensor(10.2588, device='cuda:1')
norm1 res is  tensor(0.1539, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  0.6953105926513672
distance 1 is tensor(127.5300, device='cuda:1')
distance 2 is tensor(9.2121, device='cuda:1')
benign distance is  tensor(9.2121, device='cuda:1')
norm1 res is  tensor(0.1392, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.22313478589057922
distance 1 is tensor(153.4667, device='cuda:1')
distance 2 is tensor(11.2322, device='cuda:1')
benign distance is  tensor(11.2322, device='cuda:1')
norm1 res is  tensor(0.1696, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  0.7608350515365601
distance 1 is tensor(147.5731, device='cuda:1')
distance 2 is tensor(10.8757, device='cuda:1')
benign distance is  tensor(10.8757, device='cuda:1')
norm1 res is  tensor(0.1635, device='cuda:1')
current submit client idx and staleness is  40 6
 benign loss is  0.00862053968012333
distance 1 is tensor(152.0227, device='cuda:1')
distance 2 is tensor(11.2594, device='cuda:1')
benign distance is  tensor(11.2594, device='cuda:1')
norm1 res is  tensor(0.1644, device='cuda:1')
current submit client idx and staleness is  41 6
 benign loss is  0.4295564591884613
distance 1 is tensor(144.5821, device='cuda:1')
distance 2 is tensor(10.5964, device='cuda:1')
benign distance is  tensor(10.5964, device='cuda:1')
norm1 res is  tensor(0.1590, device='cuda:1')
current submit client idx and staleness is  42 6
 benign loss is  0.1048717051744461
distance 1 is tensor(140.3933, device='cuda:1')
distance 2 is tensor(10.1696, device='cuda:1')
benign distance is  tensor(10.1696, device='cuda:1')
norm1 res is  tensor(0.1517, device='cuda:1')
current submit client idx and staleness is  43 6
 benign loss is  0.4165199398994446
distance 1 is tensor(162.5504, device='cuda:1')
distance 2 is tensor(11.7821, device='cuda:1')
benign distance is  tensor(11.7821, device='cuda:1')
norm1 res is  tensor(0.1807, device='cuda:1')
current submit client idx and staleness is  44 6
 benign loss is  0.020644504576921463
distance 1 is tensor(158.9480, device='cuda:1')
distance 2 is tensor(11.6266, device='cuda:1')
benign distance is  tensor(11.6266, device='cuda:1')
norm1 res is  tensor(0.1769, device='cuda:1')
current submit client idx and staleness is  45 6
 benign loss is  0.3260123133659363
distance 1 is tensor(148.3475, device='cuda:1')
distance 2 is tensor(10.8218, device='cuda:1')
benign distance is  tensor(10.8218, device='cuda:1')
norm1 res is  tensor(0.1630, device='cuda:1')
current submit client idx and staleness is  46 6
 benign loss is  0.7621329426765442
distance 1 is tensor(143.4149, device='cuda:1')
distance 2 is tensor(10.3171, device='cuda:1')
benign distance is  tensor(10.3171, device='cuda:1')
norm1 res is  tensor(0.1572, device='cuda:1')
current submit client idx and staleness is  47 6
 benign loss is  0.7727090716362
distance 1 is tensor(140.9657, device='cuda:1')
distance 2 is tensor(10.3924, device='cuda:1')
benign distance is  tensor(10.3924, device='cuda:1')
norm1 res is  tensor(0.1577, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(148.0418, device='cuda:1')
distance 2 is tensor(10.5681, device='cuda:1')
compute distance is  tensor(10.5681, device='cuda:1')
compute norm is  tensor(53.4831, device='cuda:1')
distance 1 is tensor(152.8931, device='cuda:1')
distance 2 is tensor(11.0885, device='cuda:1')
compute distance is  tensor(11.0885, device='cuda:1')
compute norm is  tensor(53.5891, device='cuda:1')
distance 1 is tensor(163.1408, device='cuda:1')
distance 2 is tensor(11.7522, device='cuda:1')
compute distance is  tensor(11.7522, device='cuda:1')
compute norm is  tensor(53.7917, device='cuda:1')
distance 1 is tensor(142.2764, device='cuda:1')
distance 2 is tensor(10.3446, device='cuda:1')
compute distance is  tensor(10.3446, device='cuda:1')
compute norm is  tensor(53.3583, device='cuda:1')
distance 1 is tensor(158.1345, device='cuda:1')
distance 2 is tensor(11.4837, device='cuda:1')
compute distance is  tensor(11.4837, device='cuda:1')
compute norm is  tensor(53.7210, device='cuda:1')
distance 1 is tensor(164.9509, device='cuda:1')
distance 2 is tensor(11.9111, device='cuda:1')
compute distance is  tensor(11.9111, device='cuda:1')
compute norm is  tensor(53.9739, device='cuda:1')
distance 1 is tensor(166.5943, device='cuda:1')
distance 2 is tensor(12.1875, device='cuda:1')
compute distance is  tensor(12.1875, device='cuda:1')
compute norm is  tensor(53.9184, device='cuda:1')
distance 1 is tensor(169.3006, device='cuda:1')
distance 2 is tensor(12.2961, device='cuda:1')
compute distance is  tensor(12.2961, device='cuda:1')
compute norm is  tensor(54.0020, device='cuda:1')
distance 1 is tensor(150.6975, device='cuda:1')
distance 2 is tensor(10.7756, device='cuda:1')
compute distance is  tensor(10.7756, device='cuda:1')
compute norm is  tensor(53.6325, device='cuda:1')
distance 1 is tensor(154.9089, device='cuda:1')
distance 2 is tensor(11.1358, device='cuda:1')
compute distance is  tensor(11.1358, device='cuda:1')
compute norm is  tensor(53.7178, device='cuda:1')
distance 1 is tensor(155.0117, device='cuda:1')
distance 2 is tensor(11.0479, device='cuda:1')
compute distance is  tensor(11.0479, device='cuda:1')
compute norm is  tensor(53.7372, device='cuda:1')
distance 1 is tensor(155.7782, device='cuda:1')
distance 2 is tensor(11.1299, device='cuda:1')
compute distance is  tensor(11.1299, device='cuda:1')
compute norm is  tensor(53.6886, device='cuda:1')
batch acc is 0.10333333348966525
batch acc is 0.1016666668230032
batch acc is 0.10111111126745076
batch acc is 0.10083333348967455
batch acc is 0.10066666682300882
batch acc is 0.10055555571189294
batch acc is 0.10047619063252096
batch acc is 0.10041666682299197
batch acc is 0.10037037052669164
batch acc is 0.10033333348965137
mal_rand_acc is 5e-10
mal_rand loss is 7.182077297720033e+17
len of model dicts is  12
distance 1 is tensor(148.0418, device='cuda:1')
distance 2 is tensor(10.5681, device='cuda:1')
compute distance is  tensor(10.5681, device='cuda:1')
compute norm is  tensor(53.4831, device='cuda:1')
distance 1 is tensor(152.8931, device='cuda:1')
distance 2 is tensor(11.0885, device='cuda:1')
compute distance is  tensor(11.0885, device='cuda:1')
compute norm is  tensor(53.5891, device='cuda:1')
distance 1 is tensor(163.1408, device='cuda:1')
distance 2 is tensor(11.7522, device='cuda:1')
compute distance is  tensor(11.7522, device='cuda:1')
compute norm is  tensor(53.7917, device='cuda:1')
distance 1 is tensor(142.2764, device='cuda:1')
distance 2 is tensor(10.3446, device='cuda:1')
compute distance is  tensor(10.3446, device='cuda:1')
compute norm is  tensor(53.3583, device='cuda:1')
distance 1 is tensor(158.1345, device='cuda:1')
distance 2 is tensor(11.4837, device='cuda:1')
compute distance is  tensor(11.4837, device='cuda:1')
compute norm is  tensor(53.7210, device='cuda:1')
distance 1 is tensor(164.9509, device='cuda:1')
distance 2 is tensor(11.9111, device='cuda:1')
compute distance is  tensor(11.9111, device='cuda:1')
compute norm is  tensor(53.9739, device='cuda:1')
distance 1 is tensor(166.5943, device='cuda:1')
distance 2 is tensor(12.1875, device='cuda:1')
compute distance is  tensor(12.1875, device='cuda:1')
compute norm is  tensor(53.9184, device='cuda:1')
distance 1 is tensor(169.3006, device='cuda:1')
distance 2 is tensor(12.2961, device='cuda:1')
compute distance is  tensor(12.2961, device='cuda:1')
compute norm is  tensor(54.0020, device='cuda:1')
distance 1 is tensor(150.6975, device='cuda:1')
distance 2 is tensor(10.7756, device='cuda:1')
compute distance is  tensor(10.7756, device='cuda:1')
compute norm is  tensor(53.6325, device='cuda:1')
distance 1 is tensor(154.9089, device='cuda:1')
distance 2 is tensor(11.1358, device='cuda:1')
compute distance is  tensor(11.1358, device='cuda:1')
compute norm is  tensor(53.7178, device='cuda:1')
distance 1 is tensor(155.0117, device='cuda:1')
distance 2 is tensor(11.0479, device='cuda:1')
compute distance is  tensor(11.0479, device='cuda:1')
compute norm is  tensor(53.7372, device='cuda:1')
distance 1 is tensor(155.7782, device='cuda:1')
distance 2 is tensor(11.1299, device='cuda:1')
compute distance is  tensor(11.1299, device='cuda:1')
compute norm is  tensor(53.6886, device='cuda:1')
distance Threshold  is  tensor(12.2961, device='cuda:1')
distance 1 is tensor(1020647.6250, device='cuda:1')
distance 2 is tensor(74287.1562, device='cuda:1')
________________________________
test distance is  tensor(74287.1562, device='cuda:1')
test similarity is  tensor(-0.1233, device='cuda:1')
test acc is  0.10000000015633198
test loss is 6.99404099501034e+17
test entropy is  0.0
________________________________
cal ratio is  0.01157895879998504
distance 1 is tensor(11818.0430, device='cuda:1')
distance 2 is tensor(860.1679, device='cuda:1')
cal_distance is  tensor(860.1679, device='cuda:1')
cal ratio is  0.10760557385484965
distance 1 is tensor(1271.6931, device='cuda:1')
distance 2 is tensor(92.5589, device='cuda:1')
cal_distance is  tensor(92.5589, device='cuda:1')
cal ratio is  0.3280328825664424
distance 1 is tensor(417.1615, device='cuda:1')
distance 2 is tensor(30.3624, device='cuda:1')
cal_distance is  tensor(30.3624, device='cuda:1')
cal ratio is  0.5727415523513822
distance 1 is tensor(238.9285, device='cuda:1')
distance 2 is tensor(17.3898, device='cuda:1')
cal_distance is  tensor(17.3898, device='cuda:1')
cal ratio is  0.7567968791112253
distance 1 is tensor(180.8219, device='cuda:1')
distance 2 is tensor(13.1605, device='cuda:1')
cal_distance is  tensor(13.1605, device='cuda:1')
cal ratio is  0.8699407502667337
distance 1 is tensor(157.3052, device='cuda:1')
distance 2 is tensor(11.4489, device='cuda:1')
cal_distance is  tensor(11.4489, device='cuda:1')
distance 1 is tensor(157.3052, device='cuda:1')
distance 2 is tensor(11.4489, device='cuda:1')
________________________________
test distance is  tensor(11.4489, device='cuda:1')
test similarity is  tensor(0.9475, device='cuda:1')
test acc is  0.7895833334896594
test loss is 202.72044637716655
test entropy is  0.004488878443319899
________________________________
distance 1 is tensor(157.3052, device='cuda:1')
distance 2 is tensor(11.4489, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.004382296107663553
avg test loss is  202.7703423896578
avg accuracy is  0.7875500001563261
solo acc is  0.14163333348966575
compute similarity  is  tensor(0.9475, device='cuda:1')
compute_distance is  tensor(11.4489, device='cuda:1')
compute_norm is  tensor(53.1685, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.0543, device='cuda:1')
distance 2 is tensor(12.9445, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9572629340803191
avg test loss is  1.603804331979772
avg accuracy is  0.8314666668229908
solo acc is  0.2950500001563394
compute similarity  is  tensor(0.9502, device='cuda:1')
compute_distance is  tensor(12.9445, device='cuda:1')
compute_norm is  tensor(51.9762, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.6533, device='cuda:1')
distance 2 is tensor(13.2241, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9049851556957912
avg test loss is  1.6528645567039946
avg accuracy is  0.8277666668229908
solo acc is  0.2442833334896714
compute similarity  is  tensor(0.9498, device='cuda:1')
compute_distance is  tensor(13.2241, device='cuda:1')
compute_norm is  tensor(51.6543, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.8132, device='cuda:1')
distance 2 is tensor(13.4190, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8923774109974599
avg test loss is  1.600089700237266
avg accuracy is  0.8277833334896575
solo acc is  0.23865000015633783
compute similarity  is  tensor(0.9494, device='cuda:1')
compute_distance is  tensor(13.4190, device='cuda:1')
compute_norm is  tensor(51.3487, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.7811, device='cuda:1')
distance 2 is tensor(13.5865, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8811966448323305
avg test loss is  1.5552029050489478
avg accuracy is  0.8305333334896575
solo acc is  0.242250000156338
compute similarity  is  tensor(0.9492, device='cuda:1')
compute_distance is  tensor(13.5865, device='cuda:1')
compute_norm is  tensor(51.0559, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.6033, device='cuda:1')
distance 2 is tensor(13.7377, device='cuda:1')
________________________________
test distance is  tensor(13.7377, device='cuda:1')
test similarity is  tensor(0.9489, device='cuda:1')
test acc is  0.8340833334896574
test loss is 1.515532872951361
test entropy is  0.8672400512166624
________________________________
cal ratio is  0.8514711908505744
distance 1 is tensor(132.4925, device='cuda:1')
distance 2 is tensor(11.6972, device='cuda:1')
cal_distance is  tensor(11.6972, device='cuda:1')
distance 1 is tensor(132.4925, device='cuda:1')
distance 2 is tensor(11.6972, device='cuda:1')
________________________________
test distance is  tensor(11.6972, device='cuda:1')
test similarity is  tensor(0.9631, device='cuda:1')
test acc is  0.8624166668229896
test loss is 1.1098848752248516
test entropy is  0.9318672055755851
________________________________
distance 1 is tensor(132.4925, device='cuda:1')
distance 2 is tensor(11.6972, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.9328839202552462
avg test loss is  1.109940132352589
avg accuracy is  0.8624666668229896
solo acc is  0.49766666682300875
compute similarity  is  tensor(0.9631, device='cuda:1')
compute_distance is  tensor(11.6972, device='cuda:1')
compute_norm is  tensor(50.8057, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.5347, device='cuda:1')
distance 2 is tensor(12.1255, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8610216510067108
avg test loss is  1.497650414006288
avg accuracy is  0.8535666668229899
solo acc is  0.2508000001563383
compute similarity  is  tensor(0.9621, device='cuda:1')
compute_distance is  tensor(12.1255, device='cuda:1')
compute_norm is  tensor(50.5195, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.9995, device='cuda:1')
distance 2 is tensor(12.3321, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8546075386279173
avg test loss is  1.4809025364643984
avg accuracy is  0.8546500001563231
solo acc is  0.24298333348967138
compute similarity  is  tensor(0.9617, device='cuda:1')
compute_distance is  tensor(12.3321, device='cuda:1')
compute_norm is  tensor(50.2403, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.1546, device='cuda:1')
distance 2 is tensor(12.5064, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8537220421757525
avg test loss is  1.4521462678400947
avg accuracy is  0.8562166668229898
solo acc is  0.24478333348967138
compute similarity  is  tensor(0.9614, device='cuda:1')
compute_distance is  tensor(12.5064, device='cuda:1')
compute_norm is  tensor(49.9710, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.1269, device='cuda:1')
distance 2 is tensor(12.6613, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8446312870171024
avg test loss is  1.4330607120162133
avg accuracy is  0.8594166668229897
solo acc is  0.243350000156338
compute similarity  is  tensor(0.9611, device='cuda:1')
compute_distance is  tensor(12.6613, device='cuda:1')
compute_norm is  tensor(49.7090, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.0651, device='cuda:1')
distance 2 is tensor(12.8091, device='cuda:1')
________________________________
test distance is  tensor(12.8091, device='cuda:1')
test similarity is  tensor(0.9608, device='cuda:1')
test acc is  0.8603833334896562
test loss is 1.4091270433814287
test entropy is  0.8386672217327394
________________________________
cal ratio is  0.8817922891859378
distance 1 is tensor(127.9179, device='cuda:1')
distance 2 is tensor(11.2950, device='cuda:1')
cal_distance is  tensor(11.2950, device='cuda:1')
distance 1 is tensor(127.9179, device='cuda:1')
distance 2 is tensor(11.2950, device='cuda:1')
________________________________
test distance is  tensor(11.2950, device='cuda:1')
test similarity is  tensor(0.9699, device='cuda:1')
test acc is  0.8762000001563223
test loss is 1.062281815672734
test entropy is  0.8948991454994755
________________________________
distance 1 is tensor(127.9179, device='cuda:1')
distance 2 is tensor(11.2950, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.895185335676299
avg test loss is  1.0613619435443553
avg accuracy is  0.8763500001563223
solo acc is  0.493400000156342
compute similarity  is  tensor(0.9699, device='cuda:1')
compute_distance is  tensor(11.2950, device='cuda:1')
compute_norm is  tensor(49.6679, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.8358, device='cuda:1')
distance 2 is tensor(11.6849, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8309561147618649
avg test loss is  1.4032940159220177
avg accuracy is  0.8717333334896559
solo acc is  0.24778333348967152
compute similarity  is  tensor(0.9690, device='cuda:1')
compute_distance is  tensor(11.6849, device='cuda:1')
compute_norm is  tensor(49.4126, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.3423, device='cuda:1')
distance 2 is tensor(11.8822, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.82731267161715
avg test loss is  1.3921459509111416
avg accuracy is  0.8719333334896557
solo acc is  0.24378333348967135
compute similarity  is  tensor(0.9686, device='cuda:1')
compute_distance is  tensor(11.8822, device='cuda:1')
compute_norm is  tensor(49.1548, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.6351, device='cuda:1')
distance 2 is tensor(12.0597, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8258513491799329
avg test loss is  1.373078185993471
avg accuracy is  0.8712833334896558
solo acc is  0.24278333348967135
compute similarity  is  tensor(0.9683, device='cuda:1')
compute_distance is  tensor(12.0597, device='cuda:1')
compute_norm is  tensor(48.9026, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.7755, device='cuda:1')
distance 2 is tensor(12.2253, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8243987980300683
avg test loss is  1.3594092518281835
avg accuracy is  0.8749333334896556
solo acc is  0.23595000015633777
compute similarity  is  tensor(0.9680, device='cuda:1')
compute_distance is  tensor(12.2253, device='cuda:1')
compute_norm is  tensor(48.6545, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.8159, device='cuda:1')
distance 2 is tensor(12.3807, device='cuda:1')
________________________________
test distance is  tensor(12.3807, device='cuda:1')
test similarity is  tensor(0.9677, device='cuda:1')
test acc is  0.8761166668229889
test loss is 1.3525943027884721
test entropy is  0.8152848992393469
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2447869777679443
mal norm is  tensor(6.1726, device='cuda:1')
distance 1 is tensor(140.8159, device='cuda:1')
distance 2 is tensor(12.3807, device='cuda:1')
mal distance is  tensor(12.3807, device='cuda:1')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1413, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.9626, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.5896e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.0642, device='cuda:1')
c is  tensor(0.0159, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.1688e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.0166, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.9905e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.4519, device='cuda:1')
c is  tensor(0.0159, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.1493e-06, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(513.7690, device='cuda:1')
c is  tensor(0.0166, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.3528, device='cuda:1')
c is  tensor(0.0149, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.1036e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.1297, device='cuda:1')
c is  tensor(0.0155, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.4891, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-2.7998e-06, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.2560, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
len accept list 5
len all weights is 5
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 92.73% 

Test Accuracy: 89.68% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
 benign loss is  0.13329163193702698
distance 1 is tensor(99.8436, device='cuda:1')
distance 2 is tensor(7.4183, device='cuda:1')
benign distance is  tensor(7.4183, device='cuda:1')
norm1 res is  tensor(0.1116, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.007286309264600277
distance 1 is tensor(153.8680, device='cuda:1')
distance 2 is tensor(11.1288, device='cuda:1')
benign distance is  tensor(11.1288, device='cuda:1')
norm1 res is  tensor(0.1707, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.0025580436922609806
distance 1 is tensor(97.0976, device='cuda:1')
distance 2 is tensor(7.0115, device='cuda:1')
benign distance is  tensor(7.0115, device='cuda:1')
norm1 res is  tensor(0.1041, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.3087253272533417
distance 1 is tensor(141.0027, device='cuda:1')
distance 2 is tensor(10.0902, device='cuda:1')
benign distance is  tensor(10.0902, device='cuda:1')
norm1 res is  tensor(0.1612, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  1.743880271911621
distance 1 is tensor(146.1160, device='cuda:1')
distance 2 is tensor(10.5975, device='cuda:1')
benign distance is  tensor(10.5975, device='cuda:1')
norm1 res is  tensor(0.1587, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.5170592069625854
distance 1 is tensor(146.2246, device='cuda:1')
distance 2 is tensor(10.5069, device='cuda:1')
benign distance is  tensor(10.5069, device='cuda:1')
norm1 res is  tensor(0.1615, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.20699544250965118
distance 1 is tensor(119.7307, device='cuda:1')
distance 2 is tensor(8.5829, device='cuda:1')
benign distance is  tensor(8.5829, device='cuda:1')
norm1 res is  tensor(0.1308, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.03592943400144577
distance 1 is tensor(144.8803, device='cuda:1')
distance 2 is tensor(10.5051, device='cuda:1')
benign distance is  tensor(10.5051, device='cuda:1')
norm1 res is  tensor(0.1596, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(158.2248, device='cuda:1')
distance 2 is tensor(11.4850, device='cuda:1')
compute distance is  tensor(11.4850, device='cuda:1')
compute norm is  tensor(53.9319, device='cuda:1')
distance 1 is tensor(157.2434, device='cuda:1')
distance 2 is tensor(11.3290, device='cuda:1')
compute distance is  tensor(11.3290, device='cuda:1')
compute norm is  tensor(53.8152, device='cuda:1')
distance 1 is tensor(169.4984, device='cuda:1')
distance 2 is tensor(12.2275, device='cuda:1')
compute distance is  tensor(12.2275, device='cuda:1')
compute norm is  tensor(54.1389, device='cuda:1')
distance 1 is tensor(148.9755, device='cuda:1')
distance 2 is tensor(10.7376, device='cuda:1')
compute distance is  tensor(10.7376, device='cuda:1')
compute norm is  tensor(53.6691, device='cuda:1')
distance 1 is tensor(168.4067, device='cuda:1')
distance 2 is tensor(12.2166, device='cuda:1')
compute distance is  tensor(12.2166, device='cuda:1')
compute norm is  tensor(54.0026, device='cuda:1')
distance 1 is tensor(172.3272, device='cuda:1')
distance 2 is tensor(12.5474, device='cuda:1')
compute distance is  tensor(12.5474, device='cuda:1')
compute norm is  tensor(54.2486, device='cuda:1')
distance 1 is tensor(163.6313, device='cuda:1')
distance 2 is tensor(11.6571, device='cuda:1')
compute distance is  tensor(11.6571, device='cuda:1')
compute norm is  tensor(54.0385, device='cuda:1')
distance 1 is tensor(163.3471, device='cuda:1')
distance 2 is tensor(11.6978, device='cuda:1')
compute distance is  tensor(11.6978, device='cuda:1')
compute norm is  tensor(53.8825, device='cuda:1')
distance 1 is tensor(162.1827, device='cuda:1')
distance 2 is tensor(11.6763, device='cuda:1')
compute distance is  tensor(11.6763, device='cuda:1')
compute norm is  tensor(54.1081, device='cuda:1')
distance 1 is tensor(163.0628, device='cuda:1')
distance 2 is tensor(11.6525, device='cuda:1')
compute distance is  tensor(11.6525, device='cuda:1')
compute norm is  tensor(53.9984, device='cuda:1')
distance 1 is tensor(162.3879, device='cuda:1')
distance 2 is tensor(11.5857, device='cuda:1')
compute distance is  tensor(11.5857, device='cuda:1')
compute norm is  tensor(53.9679, device='cuda:1')
distance 1 is tensor(153.0305, device='cuda:1')
distance 2 is tensor(10.9626, device='cuda:1')
compute distance is  tensor(10.9626, device='cuda:1')
compute norm is  tensor(53.7747, device='cuda:1')
distance Threshold  is  tensor(12.5474, device='cuda:1')
distance 1 is tensor(1020647.5000, device='cuda:1')
distance 2 is tensor(74287.1094, device='cuda:1')
________________________________
test distance is  tensor(74287.1094, device='cuda:1')
test similarity is  tensor(-0.1201, device='cuda:1')
test acc is  0.10000000015633198
test loss is 6.992648061107231e+17
test entropy is  0.0
________________________________
cal ratio is  0.011696697865892714
distance 1 is tensor(11938.2109, device='cuda:1')
distance 2 is tensor(868.9139, device='cuda:1')
cal_distance is  tensor(868.9139, device='cuda:1')
cal ratio is  0.10815126681765568
distance 1 is tensor(1291.1385, device='cuda:1')
distance 2 is tensor(93.9741, device='cuda:1')
cal_distance is  tensor(93.9741, device='cuda:1')
cal ratio is  0.32886361640924244
distance 1 is tensor(424.6128, device='cuda:1')
distance 2 is tensor(30.9047, device='cuda:1')
cal_distance is  tensor(30.9047, device='cuda:1')
cal ratio is  0.5734662914064397
distance 1 is tensor(243.5039, device='cuda:1')
distance 2 is tensor(17.7228, device='cuda:1')
cal_distance is  tensor(17.7228, device='cuda:1')
cal ratio is  0.7572755401727277
distance 1 is tensor(184.4011, device='cuda:1')
distance 2 is tensor(13.4210, device='cuda:1')
cal_distance is  tensor(13.4210, device='cuda:1')
cal ratio is  0.8702158646550278
distance 1 is tensor(160.4697, device='cuda:1')
distance 2 is tensor(11.6792, device='cuda:1')
cal_distance is  tensor(11.6792, device='cuda:1')
distance 1 is tensor(160.4697, device='cuda:1')
distance 2 is tensor(11.6792, device='cuda:1')
________________________________
test distance is  tensor(11.6792, device='cuda:1')
test similarity is  tensor(0.9465, device='cuda:1')
test acc is  0.7772166668229933
test loss is 229.01381585745415
test entropy is  0.004311920120465758
________________________________
distance 1 is tensor(160.4697, device='cuda:1')
distance 2 is tensor(11.6792, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.004309825317003951
avg test loss is  228.7837021752461
avg accuracy is  0.7796833334896598
solo acc is  0.137500000156332
compute similarity  is  tensor(0.9465, device='cuda:1')
compute_distance is  tensor(11.6792, device='cuda:1')
compute_norm is  tensor(53.6961, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(147.4264, device='cuda:1')
distance 2 is tensor(13.0909, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9647462120823769
avg test loss is  1.6072148249855935
avg accuracy is  0.8466666668229901
solo acc is  0.2948000001563394
compute similarity  is  tensor(0.9499, device='cuda:1')
compute_distance is  tensor(13.0909, device='cuda:1')
compute_norm is  tensor(52.4540, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.8008, device='cuda:1')
distance 2 is tensor(13.3611, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9094620289833053
avg test loss is  1.6479545311887127
avg accuracy is  0.8455000001563234
solo acc is  0.25043333348967156
compute similarity  is  tensor(0.9495, device='cuda:1')
compute_distance is  tensor(13.3611, device='cuda:1')
compute_norm is  tensor(52.1251, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.8547, device='cuda:1')
distance 2 is tensor(13.5511, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9004994207607911
avg test loss is  1.6010573079336936
avg accuracy is  0.8487333334896568
solo acc is  0.24308333348967132
compute similarity  is  tensor(0.9491, device='cuda:1')
compute_distance is  tensor(13.5511, device='cuda:1')
compute_norm is  tensor(51.8125, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.7455, device='cuda:1')
distance 2 is tensor(13.7167, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8845225775928132
avg test loss is  1.555517699291457
avg accuracy is  0.8514333334896566
solo acc is  0.24583333348967143
compute similarity  is  tensor(0.9489, device='cuda:1')
compute_distance is  tensor(13.7167, device='cuda:1')
compute_norm is  tensor(51.5127, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.5969, device='cuda:1')
distance 2 is tensor(13.8737, device='cuda:1')
________________________________
test distance is  tensor(13.8737, device='cuda:1')
test similarity is  tensor(0.9486, device='cuda:1')
test acc is  0.8522666668229899
test loss is 1.5235041097791464
test entropy is  0.8696461560121224
________________________________
cal ratio is  0.8559020609376565
distance 1 is tensor(133.1764, device='cuda:1')
distance 2 is tensor(11.8745, device='cuda:1')
cal_distance is  tensor(11.8745, device='cuda:1')
distance 1 is tensor(133.1764, device='cuda:1')
distance 2 is tensor(11.8745, device='cuda:1')
________________________________
test distance is  tensor(11.8745, device='cuda:1')
test similarity is  tensor(0.9625, device='cuda:1')
test acc is  0.8742500001563224
test loss is 1.0873861154005218
test entropy is  0.8908258876058338
________________________________
distance 1 is tensor(133.1764, device='cuda:1')
distance 2 is tensor(11.8745, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8910107727625223
avg test loss is  1.0899233871431493
avg accuracy is  0.8727333334896558
solo acc is  0.5176333334896756
compute similarity  is  tensor(0.9625, device='cuda:1')
compute_distance is  tensor(11.8745, device='cuda:1')
compute_norm is  tensor(51.2542, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.5173, device='cuda:1')
distance 2 is tensor(12.3290, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8560746946949949
avg test loss is  1.501531879276609
avg accuracy is  0.8649833334896561
solo acc is  0.2505000001563383
compute similarity  is  tensor(0.9615, device='cuda:1')
compute_distance is  tensor(12.3290, device='cuda:1')
compute_norm is  tensor(50.9608, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.9246, device='cuda:1')
distance 2 is tensor(12.5296, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.848862124213786
avg test loss is  1.473208434419083
avg accuracy is  0.8647166668229894
solo acc is  0.2521833334896716
compute similarity  is  tensor(0.9611, device='cuda:1')
compute_distance is  tensor(12.5296, device='cuda:1')
compute_norm is  tensor(50.6759, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.2171, device='cuda:1')
distance 2 is tensor(12.7123, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8488851790107897
avg test loss is  1.458001040827745
avg accuracy is  0.8679166668229893
solo acc is  0.2421166668230046
compute similarity  is  tensor(0.9608, device='cuda:1')
compute_distance is  tensor(12.7123, device='cuda:1')
compute_norm is  tensor(50.3982, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.3068, device='cuda:1')
distance 2 is tensor(12.8759, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8414016024136086
avg test loss is  1.4354094915044333
avg accuracy is  0.8672000001563226
solo acc is  0.24141666682300458
compute similarity  is  tensor(0.9604, device='cuda:1')
compute_distance is  tensor(12.8759, device='cuda:1')
compute_norm is  tensor(50.1310, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.2699, device='cuda:1')
distance 2 is tensor(13.0273, device='cuda:1')
________________________________
test distance is  tensor(13.0273, device='cuda:1')
test similarity is  tensor(0.9602, device='cuda:1')
test acc is  0.8718833334896557
test loss is 1.4198662528096995
test entropy is  0.8319645382956401
________________________________
cal ratio is  0.8832691334990451
distance 1 is tensor(129.1963, device='cuda:1')
distance 2 is tensor(11.5066, device='cuda:1')
cal_distance is  tensor(11.5066, device='cuda:1')
distance 1 is tensor(129.1963, device='cuda:1')
distance 2 is tensor(11.5066, device='cuda:1')
________________________________
test distance is  tensor(11.5066, device='cuda:1')
test similarity is  tensor(0.9692, device='cuda:1')
test acc is  0.8826833334896553
test loss is 1.0439310009037253
test entropy is  0.860192819000053
________________________________
distance 1 is tensor(129.1963, device='cuda:1')
distance 2 is tensor(11.5066, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8571270889183605
avg test loss is  1.0441133205189126
avg accuracy is  0.884200000156322
solo acc is  0.5118333334896755
compute similarity  is  tensor(0.9692, device='cuda:1')
compute_distance is  tensor(11.5066, device='cuda:1')
compute_norm is  tensor(50.0822, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.2841, device='cuda:1')
distance 2 is tensor(11.9076, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.824801985579513
avg test loss is  1.3963566254705255
avg accuracy is  0.8759833334896557
solo acc is  0.2550000001563384
compute similarity  is  tensor(0.9683, device='cuda:1')
compute_distance is  tensor(11.9076, device='cuda:1')
compute_norm is  tensor(49.8150, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.8513, device='cuda:1')
distance 2 is tensor(12.1058, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8235454348994217
avg test loss is  1.3831133351905514
avg accuracy is  0.8786666668229889
solo acc is  0.25236666682300496
compute similarity  is  tensor(0.9680, device='cuda:1')
compute_distance is  tensor(12.1058, device='cuda:1')
compute_norm is  tensor(49.5501, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.1577, device='cuda:1')
distance 2 is tensor(12.2823, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8192129409643633
avg test loss is  1.3628260073250036
avg accuracy is  0.8804333334896555
solo acc is  0.2487333334896715
compute similarity  is  tensor(0.9676, device='cuda:1')
compute_distance is  tensor(12.2823, device='cuda:1')
compute_norm is  tensor(49.2912, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.4089, device='cuda:1')
distance 2 is tensor(12.4504, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8134803555921705
avg test loss is  1.3539254289191922
avg accuracy is  0.8812166668229888
solo acc is  0.24711666682300484
compute similarity  is  tensor(0.9673, device='cuda:1')
compute_distance is  tensor(12.4504, device='cuda:1')
compute_norm is  tensor(49.0360, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.5708, device='cuda:1')
distance 2 is tensor(12.6095, device='cuda:1')
________________________________
test distance is  tensor(12.6095, device='cuda:1')
test similarity is  tensor(0.9670, device='cuda:1')
test acc is  0.883250000156322
test loss is 1.3409935393567278
test entropy is  0.807624213413389
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2087388038635254
mal norm is  tensor(6.2892, device='cuda:1')
distance 1 is tensor(142.5708, device='cuda:1')
distance 2 is tensor(12.6095, device='cuda:1')
mal distance is  tensor(12.6095, device='cuda:1')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1491, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(444.0406, device='cuda:1')
c is  tensor(0.0183, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.0825, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.9786e-06, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(410.5536, device='cuda:1')
c is  tensor(0.0191, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.4089, device='cuda:1')
c is  tensor(0.0156, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.5143, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.9587, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(515.7454, device='cuda:1')
c is  tensor(0.0170, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.1633, device='cuda:1')
c is  tensor(0.0153, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.9247e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.9153, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.9515, device='cuda:1')
c is  tensor(0.0146, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.3241, device='cuda:1')
c is  tensor(0.0153, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.4183, device='cuda:1')
c is  tensor(0.0143, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.3398, device='cuda:1')
c is  tensor(0.0144, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.0494e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.9556, device='cuda:1')
c is  tensor(0.0147, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.1613, device='cuda:1')
c is  tensor(0.0146, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.7272e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.6219, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.8321e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.0011, device='cuda:1')
c is  tensor(0.0144, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.7569, device='cuda:1')
c is  tensor(0.0146, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(7.8020e-06, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.7568, device='cuda:1')
c is  tensor(0.0158, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.9550e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.7932, device='cuda:1')
c is  tensor(0.0153, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.3078e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.4434, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.0450, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(722.4122, device='cuda:1')
c is  tensor(0.0144, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.3117e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.6089, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.4214, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.3508e-05, device='cuda:1')
accept
len accept list 13
len all weights is 13
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 93.02% 

Test Accuracy: 89.92% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3047294020652771
distance 1 is tensor(104.2138, device='cuda:1')
distance 2 is tensor(7.7271, device='cuda:1')
benign distance is  tensor(7.7271, device='cuda:1')
norm1 res is  tensor(0.1176, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.5408802032470703
distance 1 is tensor(115.4087, device='cuda:1')
distance 2 is tensor(8.4204, device='cuda:1')
benign distance is  tensor(8.4204, device='cuda:1')
norm1 res is  tensor(0.1278, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.13311327993869781
distance 1 is tensor(107.4979, device='cuda:1')
distance 2 is tensor(7.7794, device='cuda:1')
benign distance is  tensor(7.7794, device='cuda:1')
norm1 res is  tensor(0.1146, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.24941404163837433
distance 1 is tensor(112.6760, device='cuda:1')
distance 2 is tensor(8.1399, device='cuda:1')
benign distance is  tensor(8.1399, device='cuda:1')
norm1 res is  tensor(0.1220, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.23712077736854553
distance 1 is tensor(137.8172, device='cuda:1')
distance 2 is tensor(9.9125, device='cuda:1')
benign distance is  tensor(9.9125, device='cuda:1')
norm1 res is  tensor(0.1502, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.37545686960220337
distance 1 is tensor(142.0119, device='cuda:1')
distance 2 is tensor(10.2273, device='cuda:1')
benign distance is  tensor(10.2273, device='cuda:1')
norm1 res is  tensor(0.1565, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.1925734579563141
distance 1 is tensor(129.1070, device='cuda:1')
distance 2 is tensor(9.3022, device='cuda:1')
benign distance is  tensor(9.3022, device='cuda:1')
norm1 res is  tensor(0.1416, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.280278742313385
distance 1 is tensor(137.9894, device='cuda:1')
distance 2 is tensor(9.9045, device='cuda:1')
benign distance is  tensor(9.9045, device='cuda:1')
norm1 res is  tensor(0.1522, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  1.0340111255645752
distance 1 is tensor(157.6812, device='cuda:1')
distance 2 is tensor(11.3483, device='cuda:1')
benign distance is  tensor(11.3483, device='cuda:1')
norm1 res is  tensor(0.1748, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.29147154092788696
distance 1 is tensor(131.5803, device='cuda:1')
distance 2 is tensor(9.4918, device='cuda:1')
benign distance is  tensor(9.4918, device='cuda:1')
norm1 res is  tensor(0.1444, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.24465849995613098
distance 1 is tensor(140.1984, device='cuda:1')
distance 2 is tensor(10.0346, device='cuda:1')
benign distance is  tensor(10.0346, device='cuda:1')
norm1 res is  tensor(0.1500, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.41269034147262573
distance 1 is tensor(143.8929, device='cuda:1')
distance 2 is tensor(10.4658, device='cuda:1')
benign distance is  tensor(10.4658, device='cuda:1')
norm1 res is  tensor(0.1607, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.7814208269119263
distance 1 is tensor(151.8674, device='cuda:1')
distance 2 is tensor(11.1313, device='cuda:1')
benign distance is  tensor(11.1313, device='cuda:1')
norm1 res is  tensor(0.1688, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.2563783824443817
distance 1 is tensor(151.1431, device='cuda:1')
distance 2 is tensor(10.8609, device='cuda:1')
benign distance is  tensor(10.8609, device='cuda:1')
norm1 res is  tensor(0.1648, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.10623164474964142
distance 1 is tensor(144.9658, device='cuda:1')
distance 2 is tensor(10.5781, device='cuda:1')
benign distance is  tensor(10.5781, device='cuda:1')
norm1 res is  tensor(0.1608, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.4265698492527008
distance 1 is tensor(144.9710, device='cuda:1')
distance 2 is tensor(10.4909, device='cuda:1')
benign distance is  tensor(10.4909, device='cuda:1')
norm1 res is  tensor(0.1573, device='cuda:1')
current submit client idx and staleness is  24 4
 benign loss is  0.11071212589740753
distance 1 is tensor(134.5208, device='cuda:1')
distance 2 is tensor(9.8438, device='cuda:1')
benign distance is  tensor(9.8438, device='cuda:1')
norm1 res is  tensor(0.1520, device='cuda:1')
current submit client idx and staleness is  25 4
 benign loss is  0.4903948903083801
distance 1 is tensor(137.6938, device='cuda:1')
distance 2 is tensor(9.8765, device='cuda:1')
benign distance is  tensor(9.8765, device='cuda:1')
norm1 res is  tensor(0.1524, device='cuda:1')
current submit client idx and staleness is  26 4
 benign loss is  0.3832579255104065
distance 1 is tensor(145.3212, device='cuda:1')
distance 2 is tensor(10.5144, device='cuda:1')
benign distance is  tensor(10.5144, device='cuda:1')
norm1 res is  tensor(0.1590, device='cuda:1')
current submit client idx and staleness is  27 4
 benign loss is  0.42077288031578064
distance 1 is tensor(138.7570, device='cuda:1')
distance 2 is tensor(10.0361, device='cuda:1')
benign distance is  tensor(10.0361, device='cuda:1')
norm1 res is  tensor(0.1516, device='cuda:1')
current submit client idx and staleness is  28 4
 benign loss is  0.5873607397079468
distance 1 is tensor(144.6279, device='cuda:1')
distance 2 is tensor(10.6273, device='cuda:1')
benign distance is  tensor(10.6273, device='cuda:1')
norm1 res is  tensor(0.1571, device='cuda:1')
current submit client idx and staleness is  29 4
 benign loss is  0.5804726481437683
distance 1 is tensor(149.0308, device='cuda:1')
distance 2 is tensor(10.7386, device='cuda:1')
benign distance is  tensor(10.7386, device='cuda:1')
norm1 res is  tensor(0.1614, device='cuda:1')
current submit client idx and staleness is  30 4
 benign loss is  0.32293906807899475
distance 1 is tensor(154.6422, device='cuda:1')
distance 2 is tensor(11.2156, device='cuda:1')
benign distance is  tensor(11.2156, device='cuda:1')
norm1 res is  tensor(0.1713, device='cuda:1')
current submit client idx and staleness is  31 4
 benign loss is  0.14874866604804993
distance 1 is tensor(148.8060, device='cuda:1')
distance 2 is tensor(10.8577, device='cuda:1')
benign distance is  tensor(10.8577, device='cuda:1')
norm1 res is  tensor(0.1651, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(167.1861, device='cuda:1')
distance 2 is tensor(12.0814, device='cuda:1')
compute distance is  tensor(12.0814, device='cuda:1')
compute norm is  tensor(54.3461, device='cuda:1')
distance 1 is tensor(160.0071, device='cuda:1')
distance 2 is tensor(11.6177, device='cuda:1')
compute distance is  tensor(11.6177, device='cuda:1')
compute norm is  tensor(54.3060, device='cuda:1')
distance 1 is tensor(164.5168, device='cuda:1')
distance 2 is tensor(11.9115, device='cuda:1')
compute distance is  tensor(11.9115, device='cuda:1')
compute norm is  tensor(54.4893, device='cuda:1')
distance 1 is tensor(164.6835, device='cuda:1')
distance 2 is tensor(11.8037, device='cuda:1')
compute distance is  tensor(11.8037, device='cuda:1')
compute norm is  tensor(54.3470, device='cuda:1')
distance 1 is tensor(170.1230, device='cuda:1')
distance 2 is tensor(12.2345, device='cuda:1')
compute distance is  tensor(12.2345, device='cuda:1')
compute norm is  tensor(54.5326, device='cuda:1')
distance 1 is tensor(173.3299, device='cuda:1')
distance 2 is tensor(12.3585, device='cuda:1')
compute distance is  tensor(12.3585, device='cuda:1')
compute norm is  tensor(54.6724, device='cuda:1')
distance 1 is tensor(165.8498, device='cuda:1')
distance 2 is tensor(11.9623, device='cuda:1')
compute distance is  tensor(11.9623, device='cuda:1')
compute norm is  tensor(54.5424, device='cuda:1')
distance 1 is tensor(165.1844, device='cuda:1')
distance 2 is tensor(11.8054, device='cuda:1')
compute distance is  tensor(11.8054, device='cuda:1')
compute norm is  tensor(54.4725, device='cuda:1')
distance 1 is tensor(172.6798, device='cuda:1')
distance 2 is tensor(12.4364, device='cuda:1')
compute distance is  tensor(12.4364, device='cuda:1')
compute norm is  tensor(54.7720, device='cuda:1')
distance 1 is tensor(158.1317, device='cuda:1')
distance 2 is tensor(11.3740, device='cuda:1')
compute distance is  tensor(11.3740, device='cuda:1')
compute norm is  tensor(54.2538, device='cuda:1')
distance 1 is tensor(163.8235, device='cuda:1')
distance 2 is tensor(11.8687, device='cuda:1')
compute distance is  tensor(11.8687, device='cuda:1')
compute norm is  tensor(54.4578, device='cuda:1')
distance 1 is tensor(151.7110, device='cuda:1')
distance 2 is tensor(10.9059, device='cuda:1')
compute distance is  tensor(10.9059, device='cuda:1')
compute norm is  tensor(54.2301, device='cuda:1')
distance Threshold  is  tensor(12.4364, device='cuda:1')
distance 1 is tensor(1020649.2500, device='cuda:1')
distance 2 is tensor(74287.2422, device='cuda:1')
________________________________
test distance is  tensor(74287.2422, device='cuda:1')
test similarity is  tensor(-0.1230, device='cuda:1')
test acc is  0.10000000015633198
test loss is 6.99568517699094e+17
test entropy is  0.0
________________________________
cal ratio is  0.011644820539419475
distance 1 is tensor(11885.2822, device='cuda:1')
distance 2 is tensor(865.0616, device='cuda:1')
cal_distance is  tensor(865.0616, device='cuda:1')
cal ratio is  0.10791117024700453
distance 1 is tensor(1282.5607, device='cuda:1')
distance 2 is tensor(93.3498, device='cuda:1')
cal_distance is  tensor(93.3498, device='cuda:1')
cal ratio is  0.32849833911319115
distance 1 is tensor(421.3234, device='cuda:1')
distance 2 is tensor(30.6653, device='cuda:1')
cal_distance is  tensor(30.6653, device='cuda:1')
cal ratio is  0.5731477566717833
distance 1 is tensor(241.4833, device='cuda:1')
distance 2 is tensor(17.5757, device='cuda:1')
cal_distance is  tensor(17.5757, device='cuda:1')
cal ratio is  0.7570652165779471
distance 1 is tensor(182.8202, device='cuda:1')
distance 2 is tensor(13.3060, device='cuda:1')
cal_distance is  tensor(13.3060, device='cuda:1')
cal ratio is  0.8700949371267317
distance 1 is tensor(159.0718, device='cuda:1')
distance 2 is tensor(11.5775, device='cuda:1')
cal_distance is  tensor(11.5775, device='cuda:1')
distance 1 is tensor(159.0718, device='cuda:1')
distance 2 is tensor(11.5775, device='cuda:1')
________________________________
test distance is  tensor(11.5775, device='cuda:1')
test similarity is  tensor(0.9472, device='cuda:1')
test acc is  0.8089666668229917
test loss is 202.27370483788854
test entropy is  0.005321014244758594
________________________________
distance 1 is tensor(159.0718, device='cuda:1')
distance 2 is tensor(11.5775, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.005299342995858181
avg test loss is  202.82935546354443
avg accuracy is  0.8096000001563252
solo acc is  0.14603333348966618
compute similarity  is  tensor(0.9472, device='cuda:1')
compute_distance is  tensor(11.5775, device='cuda:1')
compute_norm is  tensor(53.5609, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(146.0592, device='cuda:1')
distance 2 is tensor(12.9721, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9606467798701736
avg test loss is  1.6245194453674594
avg accuracy is  0.8461500001563235
solo acc is  0.27890000015633903
compute similarity  is  tensor(0.9503, device='cuda:1')
compute_distance is  tensor(12.9721, device='cuda:1')
compute_norm is  tensor(52.2939, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.4752, device='cuda:1')
distance 2 is tensor(13.2535, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8973227333285407
avg test loss is  1.647763357487823
avg accuracy is  0.8442500001563236
solo acc is  0.2491666668230049
compute similarity  is  tensor(0.9499, device='cuda:1')
compute_distance is  tensor(13.2535, device='cuda:1')
compute_norm is  tensor(51.9627, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.4692, device='cuda:1')
distance 2 is tensor(13.4478, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8885269914227508
avg test loss is  1.6035300090368876
avg accuracy is  0.8445666668229901
solo acc is  0.24211666682300453
compute similarity  is  tensor(0.9496, device='cuda:1')
compute_distance is  tensor(13.4478, device='cuda:1')
compute_norm is  tensor(51.6555, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.2796, device='cuda:1')
distance 2 is tensor(13.6070, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8817091893031399
avg test loss is  1.5543386355391953
avg accuracy is  0.8474833334896567
solo acc is  0.24790000015633817
compute similarity  is  tensor(0.9493, device='cuda:1')
compute_distance is  tensor(13.6070, device='cuda:1')
compute_norm is  tensor(51.3580, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.1025, device='cuda:1')
distance 2 is tensor(13.7602, device='cuda:1')
________________________________
test distance is  tensor(13.7602, device='cuda:1')
test similarity is  tensor(0.9491, device='cuda:1')
test acc is  0.8510333334896566
test loss is 1.5302466717101872
test entropy is  0.8630743047067606
________________________________
cal ratio is  0.8556129490802734
distance 1 is tensor(131.8528, device='cuda:1')
distance 2 is tensor(11.7734, device='cuda:1')
cal_distance is  tensor(11.7734, device='cuda:1')
distance 1 is tensor(131.8528, device='cuda:1')
distance 2 is tensor(11.7734, device='cuda:1')
________________________________
test distance is  tensor(11.7734, device='cuda:1')
test similarity is  tensor(0.9628, device='cuda:1')
test acc is  0.8746166668229889
test loss is 1.087438179740011
test entropy is  0.9063759939884072
________________________________
distance 1 is tensor(131.8528, device='cuda:1')
distance 2 is tensor(11.7734, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.9051502397828011
avg test loss is  1.0879109740130175
avg accuracy is  0.8746333334896557
solo acc is  0.5171000001563422
compute similarity  is  tensor(0.9628, device='cuda:1')
compute_distance is  tensor(11.7734, device='cuda:1')
compute_norm is  tensor(51.1127, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.9895, device='cuda:1')
distance 2 is tensor(12.2159, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8599474757337875
avg test loss is  1.4949118855919665
avg accuracy is  0.8650666668229893
solo acc is  0.2523000001563383
compute similarity  is  tensor(0.9619, device='cuda:1')
compute_distance is  tensor(12.2159, device='cuda:1')
compute_norm is  tensor(50.8202, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.5486, device='cuda:1')
distance 2 is tensor(12.4194, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8466509351852352
avg test loss is  1.4700242298752515
avg accuracy is  0.8660833334896559
solo acc is  0.25276666682300497
compute similarity  is  tensor(0.9615, device='cuda:1')
compute_distance is  tensor(12.4194, device='cuda:1')
compute_norm is  tensor(50.5326, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.8575, device='cuda:1')
distance 2 is tensor(12.5947, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.844165456129798
avg test loss is  1.454636880838032
avg accuracy is  0.8684000001563225
solo acc is  0.24418333348967144
compute similarity  is  tensor(0.9612, device='cuda:1')
compute_distance is  tensor(12.5947, device='cuda:1')
compute_norm is  tensor(50.2548, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.0715, device='cuda:1')
distance 2 is tensor(12.7606, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8374576092020535
avg test loss is  1.4206945225119845
avg accuracy is  0.8698166668229892
solo acc is  0.2501500001563382
compute similarity  is  tensor(0.9609, device='cuda:1')
compute_distance is  tensor(12.7606, device='cuda:1')
compute_norm is  tensor(49.9863, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.1969, device='cuda:1')
distance 2 is tensor(12.9146, device='cuda:1')
________________________________
test distance is  tensor(12.9146, device='cuda:1')
test similarity is  tensor(0.9607, device='cuda:1')
test acc is  0.8699333334896557
test loss is 1.400766162729975
test entropy is  0.8355813487125104
________________________________
cal ratio is  0.8831803333660374
distance 1 is tensor(128.2356, device='cuda:1')
distance 2 is tensor(11.4059, device='cuda:1')
cal_distance is  tensor(11.4059, device='cuda:1')
distance 1 is tensor(128.2356, device='cuda:1')
distance 2 is tensor(11.4059, device='cuda:1')
________________________________
test distance is  tensor(11.4059, device='cuda:1')
test similarity is  tensor(0.9696, device='cuda:1')
test acc is  0.8866000001563219
test loss is 1.0339813152991377
test entropy is  0.868220152122888
________________________________
distance 1 is tensor(128.2356, device='cuda:1')
distance 2 is tensor(11.4059, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8667746905578988
avg test loss is  1.0346506694232478
avg accuracy is  0.8845166668229886
solo acc is  0.5143666668230089
compute similarity  is  tensor(0.9696, device='cuda:1')
compute_distance is  tensor(11.4059, device='cuda:1')
compute_norm is  tensor(49.9464, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.3952, device='cuda:1')
distance 2 is tensor(11.8187, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8293856972062004
avg test loss is  1.398369848092736
avg accuracy is  0.8778500001563221
solo acc is  0.24901666682300486
compute similarity  is  tensor(0.9687, device='cuda:1')
compute_distance is  tensor(11.8187, device='cuda:1')
compute_norm is  tensor(49.6816, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.0039, device='cuda:1')
distance 2 is tensor(12.0169, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.822321072316119
avg test loss is  1.3754244651367415
avg accuracy is  0.8809833334896555
solo acc is  0.2515833334896716
compute similarity  is  tensor(0.9684, device='cuda:1')
compute_distance is  tensor(12.0169, device='cuda:1')
compute_norm is  tensor(49.4154, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.4492, device='cuda:1')
distance 2 is tensor(12.1993, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8133131399718937
avg test loss is  1.361693715235826
avg accuracy is  0.881400000156322
solo acc is  0.25091666682300495
compute similarity  is  tensor(0.9680, device='cuda:1')
compute_distance is  tensor(12.1993, device='cuda:1')
compute_norm is  tensor(49.1542, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.7370, device='cuda:1')
distance 2 is tensor(12.3704, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8122885368907375
avg test loss is  1.3511609240635625
avg accuracy is  0.8842500001563219
solo acc is  0.24523333348967136
compute similarity  is  tensor(0.9677, device='cuda:1')
compute_distance is  tensor(12.3704, device='cuda:1')
compute_norm is  tensor(48.8977, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.9630, device='cuda:1')
distance 2 is tensor(12.5321, device='cuda:1')
________________________________
test distance is  tensor(12.5321, device='cuda:1')
test similarity is  tensor(0.9674, device='cuda:1')
test acc is  0.883450000156322
test loss is 1.3415102198688207
test entropy is  0.8040238677946998
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.265649676322937
mal norm is  tensor(6.2483, device='cuda:1')
distance 1 is tensor(141.9630, device='cuda:1')
distance 2 is tensor(12.5321, device='cuda:1')
mal distance is  tensor(12.5321, device='cuda:1')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(0.2495, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(455.4941, device='cuda:1')
c is  tensor(0.0234, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.1989, device='cuda:1')
c is  tensor(0.0223, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0007, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(453.9679, device='cuda:1')
c is  tensor(0.0234, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.7112e-07, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.4629, device='cuda:1')
c is  tensor(0.0227, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.9689, device='cuda:1')
c is  tensor(0.0206, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.6711, device='cuda:1')
c is  tensor(0.0201, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.1472, device='cuda:1')
c is  tensor(0.0212, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.3553, device='cuda:1')
c is  tensor(0.0205, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8322, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0008, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.6614, device='cuda:1')
c is  tensor(0.0201, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.9061e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.6234, device='cuda:1')
c is  tensor(0.0190, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(668.9432, device='cuda:1')
c is  tensor(0.0193, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.6174e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.6248, device='cuda:1')
c is  tensor(0.0202, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.6852, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.0856, device='cuda:1')
c is  tensor(0.0207, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.9943, device='cuda:1')
c is  tensor(0.0189, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3838, device='cuda:1')
c is  tensor(0.0194, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
len accept list 3
len all weights is 3
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 92.62% 

Test Accuracy: 89.40% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
 benign loss is  0.40953773260116577
distance 1 is tensor(101.6913, device='cuda:1')
distance 2 is tensor(7.5840, device='cuda:1')
benign distance is  tensor(7.5840, device='cuda:1')
norm1 res is  tensor(0.1108, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.20694208145141602
distance 1 is tensor(141.9216, device='cuda:1')
distance 2 is tensor(10.2634, device='cuda:1')
benign distance is  tensor(10.2634, device='cuda:1')
norm1 res is  tensor(0.1573, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.15640223026275635
distance 1 is tensor(117.9714, device='cuda:1')
distance 2 is tensor(8.6253, device='cuda:1')
benign distance is  tensor(8.6253, device='cuda:1')
norm1 res is  tensor(0.1301, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.4662008285522461
distance 1 is tensor(143.7331, device='cuda:1')
distance 2 is tensor(10.3251, device='cuda:1')
benign distance is  tensor(10.3251, device='cuda:1')
norm1 res is  tensor(0.1553, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.6461338400840759
distance 1 is tensor(117.9555, device='cuda:1')
distance 2 is tensor(8.6789, device='cuda:1')
benign distance is  tensor(8.6789, device='cuda:1')
norm1 res is  tensor(0.1296, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.29332858324050903
distance 1 is tensor(142.6328, device='cuda:1')
distance 2 is tensor(10.2696, device='cuda:1')
benign distance is  tensor(10.2696, device='cuda:1')
norm1 res is  tensor(0.1559, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.12898357212543488
distance 1 is tensor(138.2086, device='cuda:1')
distance 2 is tensor(9.9219, device='cuda:1')
benign distance is  tensor(9.9219, device='cuda:1')
norm1 res is  tensor(0.1493, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.20552048087120056
distance 1 is tensor(128.0150, device='cuda:1')
distance 2 is tensor(9.2985, device='cuda:1')
benign distance is  tensor(9.2985, device='cuda:1')
norm1 res is  tensor(0.1418, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.22717058658599854
distance 1 is tensor(107.4924, device='cuda:1')
distance 2 is tensor(7.8958, device='cuda:1')
benign distance is  tensor(7.8958, device='cuda:1')
norm1 res is  tensor(0.1186, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.4177126884460449
distance 1 is tensor(160.8024, device='cuda:1')
distance 2 is tensor(11.6506, device='cuda:1')
benign distance is  tensor(11.6506, device='cuda:1')
norm1 res is  tensor(0.1781, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.08574755489826202
distance 1 is tensor(129.6908, device='cuda:1')
distance 2 is tensor(9.5276, device='cuda:1')
benign distance is  tensor(9.5276, device='cuda:1')
norm1 res is  tensor(0.1418, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.17416855692863464
distance 1 is tensor(139.0045, device='cuda:1')
distance 2 is tensor(10.1187, device='cuda:1')
benign distance is  tensor(10.1187, device='cuda:1')
norm1 res is  tensor(0.1538, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.5187920928001404
distance 1 is tensor(143.6932, device='cuda:1')
distance 2 is tensor(10.3334, device='cuda:1')
benign distance is  tensor(10.3334, device='cuda:1')
norm1 res is  tensor(0.1542, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  0.5848553776741028
distance 1 is tensor(143.8515, device='cuda:1')
distance 2 is tensor(10.4565, device='cuda:1')
benign distance is  tensor(10.4565, device='cuda:1')
norm1 res is  tensor(0.1621, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.0829770416021347
distance 1 is tensor(153.9496, device='cuda:1')
distance 2 is tensor(11.1977, device='cuda:1')
benign distance is  tensor(11.1977, device='cuda:1')
norm1 res is  tensor(0.1725, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  0.43032512068748474
distance 1 is tensor(146.6242, device='cuda:1')
distance 2 is tensor(10.8455, device='cuda:1')
benign distance is  tensor(10.8455, device='cuda:1')
norm1 res is  tensor(0.1654, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(154.7639, device='cuda:1')
distance 2 is tensor(11.1428, device='cuda:1')
compute distance is  tensor(11.1428, device='cuda:1')
compute norm is  tensor(53.8545, device='cuda:1')
distance 1 is tensor(150.1300, device='cuda:1')
distance 2 is tensor(11.0166, device='cuda:1')
compute distance is  tensor(11.0166, device='cuda:1')
compute norm is  tensor(53.8313, device='cuda:1')
distance 1 is tensor(166.9794, device='cuda:1')
distance 2 is tensor(12.0920, device='cuda:1')
compute distance is  tensor(12.0920, device='cuda:1')
compute norm is  tensor(54.1448, device='cuda:1')
distance 1 is tensor(155.1742, device='cuda:1')
distance 2 is tensor(11.1304, device='cuda:1')
compute distance is  tensor(11.1304, device='cuda:1')
compute norm is  tensor(53.9354, device='cuda:1')
distance 1 is tensor(179.6594, device='cuda:1')
distance 2 is tensor(12.8538, device='cuda:1')
compute distance is  tensor(12.8538, device='cuda:1')
compute norm is  tensor(54.4438, device='cuda:1')
distance 1 is tensor(168.0065, device='cuda:1')
distance 2 is tensor(12.0624, device='cuda:1')
compute distance is  tensor(12.0624, device='cuda:1')
compute norm is  tensor(54.3173, device='cuda:1')
distance 1 is tensor(168.0633, device='cuda:1')
distance 2 is tensor(12.0787, device='cuda:1')
compute distance is  tensor(12.0787, device='cuda:1')
compute norm is  tensor(54.2239, device='cuda:1')
distance 1 is tensor(156.1169, device='cuda:1')
distance 2 is tensor(11.3710, device='cuda:1')
compute distance is  tensor(11.3710, device='cuda:1')
compute norm is  tensor(54.0628, device='cuda:1')
distance 1 is tensor(167.1252, device='cuda:1')
distance 2 is tensor(12.0681, device='cuda:1')
compute distance is  tensor(12.0681, device='cuda:1')
compute norm is  tensor(54.4041, device='cuda:1')
distance 1 is tensor(156.4032, device='cuda:1')
distance 2 is tensor(11.3714, device='cuda:1')
compute distance is  tensor(11.3714, device='cuda:1')
compute norm is  tensor(54.1251, device='cuda:1')
distance 1 is tensor(154.7531, device='cuda:1')
distance 2 is tensor(10.9880, device='cuda:1')
compute distance is  tensor(10.9880, device='cuda:1')
compute norm is  tensor(54.0952, device='cuda:1')
distance 1 is tensor(136.7131, device='cuda:1')
distance 2 is tensor(10.0063, device='cuda:1')
compute distance is  tensor(10.0063, device='cuda:1')
compute norm is  tensor(53.6925, device='cuda:1')
distance Threshold  is  tensor(12.8538, device='cuda:1')
distance 1 is tensor(1020650.6250, device='cuda:1')
distance 2 is tensor(74287.4062, device='cuda:1')
________________________________
test distance is  tensor(74287.4062, device='cuda:1')
test similarity is  tensor(-0.1255, device='cuda:1')
test acc is  0.10000000015633198
test loss is 6.99095386482772e+17
test entropy is  0.0
________________________________
cal ratio is  0.011838624839171329
distance 1 is tensor(12083.1074, device='cuda:1')
distance 2 is tensor(879.4606, device='cuda:1')
cal_distance is  tensor(879.4606, device='cuda:1')
cal ratio is  0.10880545110894037
distance 1 is tensor(1314.7136, device='cuda:1')
distance 2 is tensor(95.6901, device='cuda:1')
cal_distance is  tensor(95.6901, device='cuda:1')
cal ratio is  0.3298566851932456
distance 1 is tensor(433.6714, device='cuda:1')
distance 2 is tensor(31.5640, device='cuda:1')
cal_distance is  tensor(31.5640, device='cuda:1')
cal ratio is  0.5743315262888758
distance 1 is tensor(249.0739, device='cuda:1')
distance 2 is tensor(18.1282, device='cuda:1')
cal_distance is  tensor(18.1282, device='cuda:1')
cal ratio is  0.7578466293672255
distance 1 is tensor(188.7614, device='cuda:1')
distance 2 is tensor(13.7384, device='cuda:1')
cal_distance is  tensor(13.7384, device='cuda:1')
cal ratio is  0.8705438850773936
distance 1 is tensor(164.3260, device='cuda:1')
distance 2 is tensor(11.9599, device='cuda:1')
cal_distance is  tensor(11.9599, device='cuda:1')
distance 1 is tensor(164.3260, device='cuda:1')
distance 2 is tensor(11.9599, device='cuda:1')
________________________________
test distance is  tensor(11.9599, device='cuda:1')
test similarity is  tensor(0.9446, device='cuda:1')
test acc is  0.7787000001563265
test loss is 237.55723508334617
test entropy is  0.004151393701265041
________________________________
distance 1 is tensor(164.3260, device='cuda:1')
distance 2 is tensor(11.9599, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0044745953879195555
avg test loss is  237.43250320206826
avg accuracy is  0.7805333334896597
solo acc is  0.13135000015633191
compute similarity  is  tensor(0.9446, device='cuda:1')
compute_distance is  tensor(11.9599, device='cuda:1')
compute_norm is  tensor(53.9497, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(148.6744, device='cuda:1')
distance 2 is tensor(13.3140, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9543470191294705
avg test loss is  1.6007814286614277
avg accuracy is  0.8493333334896566
solo acc is  0.30040000015633955
compute similarity  is  tensor(0.9484, device='cuda:1')
compute_distance is  tensor(13.3140, device='cuda:1')
compute_norm is  tensor(52.6640, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.3619, device='cuda:1')
distance 2 is tensor(13.5985, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8995751152033491
avg test loss is  1.647689686528147
avg accuracy is  0.84931666682299
solo acc is  0.25183333348967163
compute similarity  is  tensor(0.9480, device='cuda:1')
compute_distance is  tensor(13.5985, device='cuda:1')
compute_norm is  tensor(52.3244, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.6706, device='cuda:1')
distance 2 is tensor(13.8037, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8798702127897917
avg test loss is  1.5798566816712238
avg accuracy is  0.85031666682299
solo acc is  0.2580000001563385
compute similarity  is  tensor(0.9476, device='cuda:1')
compute_distance is  tensor(13.8037, device='cuda:1')
compute_norm is  tensor(51.9956, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.9207, device='cuda:1')
distance 2 is tensor(13.9920, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8705043034004504
avg test loss is  1.5260333856031585
avg accuracy is  0.853000000156323
solo acc is  0.25833333348967186
compute similarity  is  tensor(0.9473, device='cuda:1')
compute_distance is  tensor(13.9920, device='cuda:1')
compute_norm is  tensor(51.6796, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.0791, device='cuda:1')
distance 2 is tensor(14.1685, device='cuda:1')
________________________________
test distance is  tensor(14.1685, device='cuda:1')
test similarity is  tensor(0.9469, device='cuda:1')
test acc is  0.8568166668229896
test loss is 1.4998818095813173
test entropy is  0.8623616328117436
________________________________
cal ratio is  0.8572292721562769
distance 1 is tensor(135.5108, device='cuda:1')
distance 2 is tensor(12.1456, device='cuda:1')
cal_distance is  tensor(12.1456, device='cuda:1')
distance 1 is tensor(135.5108, device='cuda:1')
distance 2 is tensor(12.1456, device='cuda:1')
________________________________
test distance is  tensor(12.1456, device='cuda:1')
test similarity is  tensor(0.9611, device='cuda:1')
test acc is  0.8768833334896554
test loss is 1.0833885568037216
test entropy is  0.8920947934137479
________________________________
distance 1 is tensor(135.5108, device='cuda:1')
distance 2 is tensor(12.1456, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8921665804091293
avg test loss is  1.082831523184583
avg accuracy is  0.8771833334896556
solo acc is  0.5140000001563422
compute similarity  is  tensor(0.9611, device='cuda:1')
compute_distance is  tensor(12.1456, device='cuda:1')
compute_norm is  tensor(51.4149, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.0855, device='cuda:1')
distance 2 is tensor(12.6108, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8499724769643121
avg test loss is  1.471574868983043
avg accuracy is  0.8685333334896558
solo acc is  0.2625000001563386
compute similarity  is  tensor(0.9601, device='cuda:1')
compute_distance is  tensor(12.6108, device='cuda:1')
compute_norm is  tensor(51.1079, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.8660, device='cuda:1')
distance 2 is tensor(12.8331, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8443112431812897
avg test loss is  1.45019259813752
avg accuracy is  0.8696666668229892
solo acc is  0.25538333348967174
compute similarity  is  tensor(0.9597, device='cuda:1')
compute_distance is  tensor(12.8331, device='cuda:1')
compute_norm is  tensor(50.8091, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.2788, device='cuda:1')
distance 2 is tensor(13.0143, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8329851505344611
avg test loss is  1.4336462735113051
avg accuracy is  0.8712833334896558
solo acc is  0.25070000015633825
compute similarity  is  tensor(0.9593, device='cuda:1')
compute_distance is  tensor(13.0143, device='cuda:1')
compute_norm is  tensor(50.5232, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.5166, device='cuda:1')
distance 2 is tensor(13.1808, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8305386797959871
avg test loss is  1.4026207592187405
avg accuracy is  0.8718833334896557
solo acc is  0.254566666823005
compute similarity  is  tensor(0.9590, device='cuda:1')
compute_distance is  tensor(13.1808, device='cuda:1')
compute_norm is  tensor(50.2459, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.6492, device='cuda:1')
distance 2 is tensor(13.3330, device='cuda:1')
________________________________
test distance is  tensor(13.3330, device='cuda:1')
test similarity is  tensor(0.9587, device='cuda:1')
test acc is  0.873316666822989
test loss is 1.3895992016487284
test entropy is  0.8228355020221109
________________________________
cal ratio is  0.883680493172221
distance 1 is tensor(132.2427, device='cuda:1')
distance 2 is tensor(11.7821, device='cuda:1')
cal_distance is  tensor(11.7821, device='cuda:1')
distance 1 is tensor(132.2427, device='cuda:1')
distance 2 is tensor(11.7821, device='cuda:1')
________________________________
test distance is  tensor(11.7821, device='cuda:1')
test similarity is  tensor(0.9681, device='cuda:1')
test acc is  0.8861000001563218
test loss is 1.023109860511731
test entropy is  0.8746066858519369
________________________________
distance 1 is tensor(132.2427, device='cuda:1')
distance 2 is tensor(11.7821, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8728246877569634
avg test loss is  1.0261486052577176
avg accuracy is  0.8866000001563219
solo acc is  0.5175000001563422
compute similarity  is  tensor(0.9681, device='cuda:1')
compute_distance is  tensor(11.7821, device='cuda:1')
compute_norm is  tensor(50.2053, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.4633, device='cuda:1')
distance 2 is tensor(12.1934, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8248290683287801
avg test loss is  1.3850465207211753
avg accuracy is  0.8799666668229889
solo acc is  0.2526000001563383
compute similarity  is  tensor(0.9672, device='cuda:1')
compute_distance is  tensor(12.1934, device='cuda:1')
compute_norm is  tensor(49.9355, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.2372, device='cuda:1')
distance 2 is tensor(12.4017, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8225536950742767
avg test loss is  1.364349635806419
avg accuracy is  0.8799000001563221
solo acc is  0.25248333348967167
compute similarity  is  tensor(0.9667, device='cuda:1')
compute_distance is  tensor(12.4017, device='cuda:1')
compute_norm is  tensor(49.6647, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.7051, device='cuda:1')
distance 2 is tensor(12.5793, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8108678634868247
avg test loss is  1.3480327561465917
avg accuracy is  0.882550000156322
solo acc is  0.25500000015633834
compute similarity  is  tensor(0.9664, device='cuda:1')
compute_distance is  tensor(12.5793, device='cuda:1')
compute_norm is  tensor(49.4023, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.0432, device='cuda:1')
distance 2 is tensor(12.7474, device='cuda:1')
exit early
distance 1 is tensor(144.0432, device='cuda:1')
distance 2 is tensor(12.7474, device='cuda:1')
________________________________
test distance is  tensor(12.7474, device='cuda:1')
test similarity is  tensor(0.9661, device='cuda:1')
test acc is  0.8821333334896554
test loss is 1.338271211078172
test entropy is  0.8055610449583546
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.421674132347107
mal norm is  tensor(6.3983, device='cuda:1')
distance 1 is tensor(144.0432, device='cuda:1')
distance 2 is tensor(12.7474, device='cuda:1')
mal distance is  tensor(12.7474, device='cuda:1')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1643, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(441.3780, device='cuda:1')
c is  tensor(0.0193, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-6.9331e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.2089, device='cuda:1')
c is  tensor(0.0164, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(8.8839e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(515.2350, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.4118, device='cuda:1')
c is  tensor(0.0163, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(5.9990e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(510.6435, device='cuda:1')
c is  tensor(0.0179, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.2365, device='cuda:1')
c is  tensor(0.0164, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.5894, device='cuda:1')
c is  tensor(0.0167, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(564.1590, device='cuda:1')
c is  tensor(0.0171, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.8301, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.0591, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-8.8024e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(752.5719, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.4097, device='cuda:1')
c is  tensor(0.0157, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(731.7073, device='cuda:1')
c is  tensor(0.0150, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.7700, device='cuda:1')
c is  tensor(0.0152, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.1801, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.3394, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.0950, device='cuda:1')
c is  tensor(0.0158, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(745.8118, device='cuda:1')
c is  tensor(0.0148, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.7111, device='cuda:1')
c is  tensor(0.0160, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-4.2265e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.3695, device='cuda:1')
c is  tensor(0.0157, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.9029e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.8204, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.0500, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(720.0615, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-7.2138e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.6590, device='cuda:1')
c is  tensor(0.0153, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.0385e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.5444, device='cuda:1')
c is  tensor(0.0154, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
len accept list 11
len all weights is 11
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 93.15% 

Test Accuracy: 89.69% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
 benign loss is  0.38634493947029114
distance 1 is tensor(128.2089, device='cuda:1')
distance 2 is tensor(9.1867, device='cuda:1')
benign distance is  tensor(9.1867, device='cuda:1')
norm1 res is  tensor(0.1423, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.6426181793212891
distance 1 is tensor(125.0745, device='cuda:1')
distance 2 is tensor(9.0923, device='cuda:1')
benign distance is  tensor(9.0923, device='cuda:1')
norm1 res is  tensor(0.1416, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.041575826704502106
distance 1 is tensor(97.6668, device='cuda:1')
distance 2 is tensor(7.0547, device='cuda:1')
benign distance is  tensor(7.0547, device='cuda:1')
norm1 res is  tensor(0.1039, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.21841645240783691
distance 1 is tensor(120.8037, device='cuda:1')
distance 2 is tensor(8.7988, device='cuda:1')
benign distance is  tensor(8.7988, device='cuda:1')
norm1 res is  tensor(0.1316, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.1383853554725647
distance 1 is tensor(116.0185, device='cuda:1')
distance 2 is tensor(8.4150, device='cuda:1')
benign distance is  tensor(8.4150, device='cuda:1')
norm1 res is  tensor(0.1241, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.2671775221824646
distance 1 is tensor(132.4907, device='cuda:1')
distance 2 is tensor(9.5967, device='cuda:1')
benign distance is  tensor(9.5967, device='cuda:1')
norm1 res is  tensor(0.1463, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.3738678991794586
distance 1 is tensor(119.1308, device='cuda:1')
distance 2 is tensor(8.6245, device='cuda:1')
benign distance is  tensor(8.6245, device='cuda:1')
norm1 res is  tensor(0.1304, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.08935544639825821
distance 1 is tensor(103.7464, device='cuda:1')
distance 2 is tensor(7.6445, device='cuda:1')
benign distance is  tensor(7.6445, device='cuda:1')
norm1 res is  tensor(0.1143, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.009808601811528206
distance 1 is tensor(164.9170, device='cuda:1')
distance 2 is tensor(11.8339, device='cuda:1')
benign distance is  tensor(11.8339, device='cuda:1')
norm1 res is  tensor(0.1804, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.08949632197618484
distance 1 is tensor(140.3110, device='cuda:1')
distance 2 is tensor(10.1517, device='cuda:1')
benign distance is  tensor(10.1517, device='cuda:1')
norm1 res is  tensor(0.1545, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.14845670759677887
distance 1 is tensor(111.8813, device='cuda:1')
distance 2 is tensor(8.2319, device='cuda:1')
benign distance is  tensor(8.2319, device='cuda:1')
norm1 res is  tensor(0.1238, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  1.1389131546020508
distance 1 is tensor(135.5057, device='cuda:1')
distance 2 is tensor(10.0761, device='cuda:1')
benign distance is  tensor(10.0761, device='cuda:1')
norm1 res is  tensor(0.1523, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.5254291296005249
distance 1 is tensor(139.7354, device='cuda:1')
distance 2 is tensor(10.3357, device='cuda:1')
benign distance is  tensor(10.3357, device='cuda:1')
norm1 res is  tensor(0.1587, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.07062697410583496
distance 1 is tensor(135.8963, device='cuda:1')
distance 2 is tensor(9.7538, device='cuda:1')
benign distance is  tensor(9.7538, device='cuda:1')
norm1 res is  tensor(0.1539, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.23190760612487793
distance 1 is tensor(134.3815, device='cuda:1')
distance 2 is tensor(9.6783, device='cuda:1')
benign distance is  tensor(9.6783, device='cuda:1')
norm1 res is  tensor(0.1453, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.47524482011795044
distance 1 is tensor(149.9546, device='cuda:1')
distance 2 is tensor(10.9047, device='cuda:1')
benign distance is  tensor(10.9047, device='cuda:1')
norm1 res is  tensor(0.1642, device='cuda:1')
current submit client idx and staleness is  32 5
 benign loss is  0.3764236569404602
distance 1 is tensor(138.2034, device='cuda:1')
distance 2 is tensor(10.1432, device='cuda:1')
benign distance is  tensor(10.1432, device='cuda:1')
norm1 res is  tensor(0.1513, device='cuda:1')
current submit client idx and staleness is  33 5
 benign loss is  0.09607884287834167
distance 1 is tensor(148.8233, device='cuda:1')
distance 2 is tensor(10.7221, device='cuda:1')
benign distance is  tensor(10.7221, device='cuda:1')
norm1 res is  tensor(0.1643, device='cuda:1')
current submit client idx and staleness is  34 5
 benign loss is  0.08526070415973663
distance 1 is tensor(124.9621, device='cuda:1')
distance 2 is tensor(9.1135, device='cuda:1')
benign distance is  tensor(9.1135, device='cuda:1')
norm1 res is  tensor(0.1369, device='cuda:1')
current submit client idx and staleness is  35 5
 benign loss is  0.5210084319114685
distance 1 is tensor(147.4601, device='cuda:1')
distance 2 is tensor(10.8875, device='cuda:1')
benign distance is  tensor(10.8875, device='cuda:1')
norm1 res is  tensor(0.1665, device='cuda:1')
current submit client idx and staleness is  36 5
 benign loss is  0.1039983257651329
distance 1 is tensor(148.0798, device='cuda:1')
distance 2 is tensor(10.7062, device='cuda:1')
benign distance is  tensor(10.7062, device='cuda:1')
norm1 res is  tensor(0.1614, device='cuda:1')
current submit client idx and staleness is  37 5
 benign loss is  0.24252717196941376
distance 1 is tensor(133.5830, device='cuda:1')
distance 2 is tensor(9.7647, device='cuda:1')
benign distance is  tensor(9.7647, device='cuda:1')
norm1 res is  tensor(0.1456, device='cuda:1')
current submit client idx and staleness is  38 5
 benign loss is  0.662787139415741
distance 1 is tensor(136.9404, device='cuda:1')
distance 2 is tensor(9.9979, device='cuda:1')
benign distance is  tensor(9.9979, device='cuda:1')
norm1 res is  tensor(0.1498, device='cuda:1')
current submit client idx and staleness is  39 5
 benign loss is  0.3452599048614502
distance 1 is tensor(136.5089, device='cuda:1')
distance 2 is tensor(9.8904, device='cuda:1')
benign distance is  tensor(9.8904, device='cuda:1')
norm1 res is  tensor(0.1469, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(143.5970, device='cuda:1')
distance 2 is tensor(10.3522, device='cuda:1')
compute distance is  tensor(10.3522, device='cuda:1')
compute norm is  tensor(53.9873, device='cuda:1')
distance 1 is tensor(145.4248, device='cuda:1')
distance 2 is tensor(10.6249, device='cuda:1')
compute distance is  tensor(10.6249, device='cuda:1')
compute norm is  tensor(53.8982, device='cuda:1')
distance 1 is tensor(148.5969, device='cuda:1')
distance 2 is tensor(10.8136, device='cuda:1')
compute distance is  tensor(10.8136, device='cuda:1')
compute norm is  tensor(54.0020, device='cuda:1')
distance 1 is tensor(148.6418, device='cuda:1')
distance 2 is tensor(10.7967, device='cuda:1')
compute distance is  tensor(10.7967, device='cuda:1')
compute norm is  tensor(53.9766, device='cuda:1')
distance 1 is tensor(150.5257, device='cuda:1')
distance 2 is tensor(10.9026, device='cuda:1')
compute distance is  tensor(10.9026, device='cuda:1')
compute norm is  tensor(53.9281, device='cuda:1')
distance 1 is tensor(159.3081, device='cuda:1')
distance 2 is tensor(11.5985, device='cuda:1')
compute distance is  tensor(11.5985, device='cuda:1')
compute norm is  tensor(54.2962, device='cuda:1')
distance 1 is tensor(150.6670, device='cuda:1')
distance 2 is tensor(11.0162, device='cuda:1')
compute distance is  tensor(11.0162, device='cuda:1')
compute norm is  tensor(54.0453, device='cuda:1')
distance 1 is tensor(147.4614, device='cuda:1')
distance 2 is tensor(10.6478, device='cuda:1')
compute distance is  tensor(10.6478, device='cuda:1')
compute norm is  tensor(53.9832, device='cuda:1')
distance 1 is tensor(139.2445, device='cuda:1')
distance 2 is tensor(10.1631, device='cuda:1')
compute distance is  tensor(10.1631, device='cuda:1')
compute norm is  tensor(53.8367, device='cuda:1')
distance 1 is tensor(171.4532, device='cuda:1')
distance 2 is tensor(12.3142, device='cuda:1')
compute distance is  tensor(12.3142, device='cuda:1')
compute norm is  tensor(54.5434, device='cuda:1')
distance 1 is tensor(154.6040, device='cuda:1')
distance 2 is tensor(11.1029, device='cuda:1')
compute distance is  tensor(11.1029, device='cuda:1')
compute norm is  tensor(54.2467, device='cuda:1')
distance 1 is tensor(129.5506, device='cuda:1')
distance 2 is tensor(9.3500, device='cuda:1')
compute distance is  tensor(9.3500, device='cuda:1')
compute norm is  tensor(53.6852, device='cuda:1')
distance Threshold  is  tensor(12.3142, device='cuda:1')
distance 1 is tensor(1020651.7500, device='cuda:1')
distance 2 is tensor(74287.4297, device='cuda:1')
________________________________
test distance is  tensor(74287.4297, device='cuda:1')
test similarity is  tensor(-0.1260, device='cuda:1')
test acc is  0.10000000015633198
test loss is 6.993528198626324e+17
test entropy is  0.0
________________________________
cal ratio is  0.011587460831414209
distance 1 is tensor(11826.7676, device='cuda:1')
distance 2 is tensor(860.8026, device='cuda:1')
cal_distance is  tensor(860.8026, device='cuda:1')
cal ratio is  0.10764507440375375
distance 1 is tensor(1273.0990, device='cuda:1')
distance 2 is tensor(92.6612, device='cuda:1')
cal_distance is  tensor(92.6612, device='cuda:1')
cal ratio is  0.32809307351784295
distance 1 is tensor(417.6994, device='cuda:1')
distance 2 is tensor(30.4015, device='cuda:1')
cal_distance is  tensor(30.4015, device='cuda:1')
cal ratio is  0.5727941084311355
distance 1 is tensor(239.2585, device='cuda:1')
distance 2 is tensor(17.4138, device='cuda:1')
cal_distance is  tensor(17.4138, device='cuda:1')
cal ratio is  0.7568316465194639
distance 1 is tensor(181.0800, device='cuda:1')
distance 2 is tensor(13.1793, device='cuda:1')
cal_distance is  tensor(13.1793, device='cuda:1')
cal ratio is  0.8699607292306248
distance 1 is tensor(157.5333, device='cuda:1')
distance 2 is tensor(11.4655, device='cuda:1')
cal_distance is  tensor(11.4655, device='cuda:1')
distance 1 is tensor(157.5333, device='cuda:1')
distance 2 is tensor(11.4655, device='cuda:1')
________________________________
test distance is  tensor(11.4655, device='cuda:1')
test similarity is  tensor(0.9485, device='cuda:1')
test acc is  0.818483333489658
test loss is 193.3427007061078
test entropy is  0.005372054536881715
________________________________
distance 1 is tensor(157.5333, device='cuda:1')
distance 2 is tensor(11.4655, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.005653294439884277
avg test loss is  192.96550449786156
avg accuracy is  0.8165166668229913
solo acc is  0.1468166668229996
compute similarity  is  tensor(0.9485, device='cuda:1')
compute_distance is  tensor(11.4655, device='cuda:1')
compute_norm is  tensor(53.7245, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(145.2531, device='cuda:1')
distance 2 is tensor(12.8710, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9435594662674455
avg test loss is  1.6183257142363836
avg accuracy is  0.8483833334896567
solo acc is  0.2848666668230058
compute similarity  is  tensor(0.9514, device='cuda:1')
compute_distance is  tensor(12.8710, device='cuda:1')
compute_norm is  tensor(52.4519, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.6791, device='cuda:1')
distance 2 is tensor(13.1403, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9005417635700087
avg test loss is  1.6405422532482188
avg accuracy is  0.84856666682299
solo acc is  0.24870000015633817
compute similarity  is  tensor(0.9510, device='cuda:1')
compute_distance is  tensor(13.1403, device='cuda:1')
compute_norm is  tensor(52.1181, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.7793, device='cuda:1')
distance 2 is tensor(13.3345, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8854669983198902
avg test loss is  1.5846282574159505
avg accuracy is  0.8488166668229901
solo acc is  0.2490833334896715
compute similarity  is  tensor(0.9507, device='cuda:1')
compute_distance is  tensor(13.3345, device='cuda:1')
compute_norm is  tensor(51.8035, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.7411, device='cuda:1')
distance 2 is tensor(13.5008, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8700169105646707
avg test loss is  1.540499310757814
avg accuracy is  0.8522500001563232
solo acc is  0.2482333334896715
compute similarity  is  tensor(0.9505, device='cuda:1')
compute_distance is  tensor(13.5008, device='cuda:1')
compute_norm is  tensor(51.5021, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.7296, device='cuda:1')
distance 2 is tensor(13.6654, device='cuda:1')
________________________________
test distance is  tensor(13.6654, device='cuda:1')
test similarity is  tensor(0.9502, device='cuda:1')
test acc is  0.8557333334896564
test loss is 1.5104774156613137
test entropy is  0.8559534591016993
________________________________
cal ratio is  0.8543479904141571
distance 1 is tensor(131.3393, device='cuda:1')
distance 2 is tensor(11.6750, device='cuda:1')
cal_distance is  tensor(11.6750, device='cuda:1')
distance 1 is tensor(131.3393, device='cuda:1')
distance 2 is tensor(11.6750, device='cuda:1')
________________________________
test distance is  tensor(11.6750, device='cuda:1')
test similarity is  tensor(0.9638, device='cuda:1')
test acc is  0.877066666822989
test loss is 1.0553132778545942
test entropy is  0.886271124582555
________________________________
distance 1 is tensor(131.3393, device='cuda:1')
distance 2 is tensor(11.6750, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8860767461470703
avg test loss is  1.0570607721678484
avg accuracy is  0.8781166668229888
solo acc is  0.531966666823009
compute similarity  is  tensor(0.9638, device='cuda:1')
compute_distance is  tensor(11.6750, device='cuda:1')
compute_norm is  tensor(51.2708, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.6130, device='cuda:1')
distance 2 is tensor(12.1232, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8477285037925248
avg test loss is  1.4805342247491198
avg accuracy is  0.8699166668229892
solo acc is  0.25440000015633835
compute similarity  is  tensor(0.9629, device='cuda:1')
compute_distance is  tensor(12.1232, device='cuda:1')
compute_norm is  tensor(50.9741, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.2300, device='cuda:1')
distance 2 is tensor(12.3331, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8470110416666531
avg test loss is  1.4500174472835272
avg accuracy is  0.8697000001563225
solo acc is  0.2533000001563383
compute similarity  is  tensor(0.9625, device='cuda:1')
compute_distance is  tensor(12.3331, device='cuda:1')
compute_norm is  tensor(50.6834, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.4636, device='cuda:1')
distance 2 is tensor(12.5092, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8306122648436377
avg test loss is  1.4254995539371393
avg accuracy is  0.8721500001563225
solo acc is  0.2557000001563385
compute similarity  is  tensor(0.9622, device='cuda:1')
compute_distance is  tensor(12.5092, device='cuda:1')
compute_norm is  tensor(50.4018, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.6492, device='cuda:1')
distance 2 is tensor(12.6777, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8338213482264009
avg test loss is  1.4104097692697033
avg accuracy is  0.8739666668229891
solo acc is  0.2458333334896714
compute similarity  is  tensor(0.9619, device='cuda:1')
compute_distance is  tensor(12.6777, device='cuda:1')
compute_norm is  tensor(50.1283, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.7262, device='cuda:1')
distance 2 is tensor(12.8320, device='cuda:1')
________________________________
test distance is  tensor(12.8320, device='cuda:1')
test similarity is  tensor(0.9616, device='cuda:1')
test acc is  0.8757666668229889
test loss is 1.3885563022292244
test entropy is  0.826055337180461
________________________________
cal ratio is  0.8816546049011089
distance 1 is tensor(127.5991, device='cuda:1')
distance 2 is tensor(11.3134, device='cuda:1')
cal_distance is  tensor(11.3134, device='cuda:1')
distance 1 is tensor(127.5991, device='cuda:1')
distance 2 is tensor(11.3134, device='cuda:1')
________________________________
test distance is  tensor(11.3134, device='cuda:1')
test similarity is  tensor(0.9705, device='cuda:1')
test acc is  0.8874333334896553
test loss is 0.997963603180863
test entropy is  0.8538037459097946
________________________________
distance 1 is tensor(127.5991, device='cuda:1')
distance 2 is tensor(11.3134, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8528388054259042
avg test loss is  1.0011384336551878
avg accuracy is  0.8868666668229885
solo acc is  0.5349000001563423
compute similarity  is  tensor(0.9705, device='cuda:1')
compute_distance is  tensor(11.3134, device='cuda:1')
compute_norm is  tensor(50.1049, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.7481, device='cuda:1')
distance 2 is tensor(11.7262, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8211270658446274
avg test loss is  1.3770069135531688
avg accuracy is  0.883050000156322
solo acc is  0.25543333348967173
compute similarity  is  tensor(0.9696, device='cuda:1')
compute_distance is  tensor(11.7262, device='cuda:1')
compute_norm is  tensor(49.8386, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.3379, device='cuda:1')
distance 2 is tensor(11.9265, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.817390574575233
avg test loss is  1.3627329328293993
avg accuracy is  0.8818166668229888
solo acc is  0.2519500001563383
compute similarity  is  tensor(0.9692, device='cuda:1')
compute_distance is  tensor(11.9265, device='cuda:1')
compute_norm is  tensor(49.5696, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.7956, device='cuda:1')
distance 2 is tensor(12.1122, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8134088334498375
avg test loss is  1.3505847067721108
avg accuracy is  0.8833333334896554
solo acc is  0.24835000015633818
compute similarity  is  tensor(0.9689, device='cuda:1')
compute_distance is  tensor(12.1122, device='cuda:1')
compute_norm is  tensor(49.3098, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.0826, device='cuda:1')
distance 2 is tensor(12.2803, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.808461211891825
avg test loss is  1.324858923583651
avg accuracy is  0.884050000156322
solo acc is  0.25676666682300514
compute similarity  is  tensor(0.9686, device='cuda:1')
compute_distance is  tensor(12.2803, device='cuda:1')
compute_norm is  tensor(49.0551, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.3358, device='cuda:1')
distance 2 is tensor(12.4462, device='cuda:1')
________________________________
test distance is  tensor(12.4462, device='cuda:1')
test similarity is  tensor(0.9683, device='cuda:1')
test acc is  0.8864500001563219
test loss is 1.3248206385925634
test entropy is  0.8008035329232084
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal loss is 1.351912260055542
mal norm is  tensor(6.2027, device='cuda:1')
distance 1 is tensor(141.3358, device='cuda:1')
distance 2 is tensor(12.4462, device='cuda:1')
mal distance is  tensor(12.4462, device='cuda:1')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.1096, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.5574, device='cuda:1')
c is  tensor(0.0140, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(2.2179e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.5092, device='cuda:1')
c is  tensor(0.0141, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.3998e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(412.4217, device='cuda:1')
c is  tensor(0.0163, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.4547, device='cuda:1')
c is  tensor(0.0145, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-3.5296e-05, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(493.4756, device='cuda:1')
c is  tensor(0.0149, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(580.6397, device='cuda:1')
c is  tensor(0.0137, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(4.7875e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(510.4573, device='cuda:1')
c is  tensor(0.0147, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(6.1346e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(452.9003, device='cuda:1')
c is  tensor(0.0156, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.2700, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.0734e-05, device='cuda:1')
accept
len accept list 19
len all weights is 19
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 90.23% 

Test Accuracy: 87.91% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
 benign loss is  0.0030021846760064363
distance 1 is tensor(143.6375, device='cuda:1')
distance 2 is tensor(10.4327, device='cuda:1')
benign distance is  tensor(10.4327, device='cuda:1')
norm1 res is  tensor(0.1494, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.6534079313278198
distance 1 is tensor(139.5541, device='cuda:1')
distance 2 is tensor(10.0704, device='cuda:1')
benign distance is  tensor(10.0704, device='cuda:1')
norm1 res is  tensor(0.1459, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.050900302827358246
distance 1 is tensor(145.1174, device='cuda:1')
distance 2 is tensor(10.6168, device='cuda:1')
benign distance is  tensor(10.6168, device='cuda:1')
norm1 res is  tensor(0.1512, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.07059331983327866
distance 1 is tensor(150.1408, device='cuda:1')
distance 2 is tensor(10.7269, device='cuda:1')
benign distance is  tensor(10.7269, device='cuda:1')
norm1 res is  tensor(0.1554, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.49819836020469666
distance 1 is tensor(134.0320, device='cuda:1')
distance 2 is tensor(9.5471, device='cuda:1')
benign distance is  tensor(9.5471, device='cuda:1')
norm1 res is  tensor(0.1377, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  1.3770874738693237
distance 1 is tensor(167.1553, device='cuda:1')
distance 2 is tensor(12.2063, device='cuda:1')
benign distance is  tensor(12.2063, device='cuda:1')
norm1 res is  tensor(0.1755, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.6308903098106384
distance 1 is tensor(156.7037, device='cuda:1')
distance 2 is tensor(11.2139, device='cuda:1')
benign distance is  tensor(11.2139, device='cuda:1')
norm1 res is  tensor(0.1610, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.0253271646797657
distance 1 is tensor(154.5050, device='cuda:1')
distance 2 is tensor(11.0085, device='cuda:1')
benign distance is  tensor(11.0085, device='cuda:1')
norm1 res is  tensor(0.1600, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(161.5328, device='cuda:1')
distance 2 is tensor(12.0770, device='cuda:1')
compute distance is  tensor(12.0770, device='cuda:1')
compute norm is  tensor(54.0987, device='cuda:1')
distance 1 is tensor(162.4594, device='cuda:1')
distance 2 is tensor(12.4052, device='cuda:1')
compute distance is  tensor(12.4052, device='cuda:1')
compute norm is  tensor(54.2305, device='cuda:1')
distance 1 is tensor(169.7037, device='cuda:1')
distance 2 is tensor(12.7649, device='cuda:1')
compute distance is  tensor(12.7649, device='cuda:1')
compute norm is  tensor(54.3763, device='cuda:1')
distance 1 is tensor(165.4121, device='cuda:1')
distance 2 is tensor(12.6230, device='cuda:1')
compute distance is  tensor(12.6230, device='cuda:1')
compute norm is  tensor(54.3434, device='cuda:1')
distance 1 is tensor(162.7695, device='cuda:1')
distance 2 is tensor(12.5727, device='cuda:1')
compute distance is  tensor(12.5727, device='cuda:1')
compute norm is  tensor(54.2799, device='cuda:1')
distance 1 is tensor(164.0786, device='cuda:1')
distance 2 is tensor(12.4933, device='cuda:1')
compute distance is  tensor(12.4933, device='cuda:1')
compute norm is  tensor(54.3344, device='cuda:1')
distance 1 is tensor(174.4645, device='cuda:1')
distance 2 is tensor(13.3727, device='cuda:1')
compute distance is  tensor(13.3727, device='cuda:1')
compute norm is  tensor(54.6801, device='cuda:1')
distance 1 is tensor(169.1917, device='cuda:1')
distance 2 is tensor(12.9069, device='cuda:1')
compute distance is  tensor(12.9069, device='cuda:1')
compute norm is  tensor(54.4397, device='cuda:1')
distance 1 is tensor(163.0478, device='cuda:1')
distance 2 is tensor(12.3666, device='cuda:1')
compute distance is  tensor(12.3666, device='cuda:1')
compute norm is  tensor(54.3672, device='cuda:1')
distance 1 is tensor(171.9312, device='cuda:1')
distance 2 is tensor(13.0706, device='cuda:1')
compute distance is  tensor(13.0706, device='cuda:1')
compute norm is  tensor(54.5245, device='cuda:1')
distance 1 is tensor(168.2760, device='cuda:1')
distance 2 is tensor(12.7171, device='cuda:1')
compute distance is  tensor(12.7171, device='cuda:1')
compute norm is  tensor(54.4207, device='cuda:1')
distance 1 is tensor(156.0620, device='cuda:1')
distance 2 is tensor(11.8635, device='cuda:1')
compute distance is  tensor(11.8635, device='cuda:1')
compute norm is  tensor(54.2610, device='cuda:1')
distance Threshold  is  tensor(13.3727, device='cuda:1')
distance 1 is tensor(1020615.3750, device='cuda:1')
distance 2 is tensor(74284.0859, device='cuda:1')
________________________________
test distance is  tensor(74284.0859, device='cuda:1')
test similarity is  tensor(-0.0277, device='cuda:1')
test acc is  0.10000000015633198
test loss is 6.993213979551566e+17
test entropy is  0.0
________________________________
cal ratio is  0.012075455839832364
distance 1 is tensor(12324.4023, device='cuda:1')
distance 2 is tensor(897.0142, device='cuda:1')
cal_distance is  tensor(897.0142, device='cuda:1')
cal ratio is  0.10988837527742941
distance 1 is tensor(1354.3141, device='cuda:1')
distance 2 is tensor(98.5714, device='cuda:1')
cal_distance is  tensor(98.5714, device='cuda:1')
cal ratio is  0.3314941689444482
distance 1 is tensor(448.9516, device='cuda:1')
distance 2 is tensor(32.6759, device='cuda:1')
cal_distance is  tensor(32.6759, device='cuda:1')
cal ratio is  0.5757552729819436
distance 1 is tensor(258.4890, device='cuda:1')
distance 2 is tensor(18.8133, device='cuda:1')
cal_distance is  tensor(18.8133, device='cuda:1')
cal ratio is  0.7587853049402468
distance 1 is tensor(196.1392, device='cuda:1')
distance 2 is tensor(14.2753, device='cuda:1')
cal_distance is  tensor(14.2753, device='cuda:1')
cal ratio is  0.8710828936118435
distance 1 is tensor(170.8544, device='cuda:1')
distance 2 is tensor(12.4349, device='cuda:1')
cal_distance is  tensor(12.4349, device='cuda:1')
distance 1 is tensor(170.8544, device='cuda:1')
distance 2 is tensor(12.4349, device='cuda:1')
________________________________
test distance is  tensor(12.4349, device='cuda:1')
test similarity is  tensor(0.9376, device='cuda:1')
test acc is  0.3176500001563399
test loss is 339.8539242286926
test entropy is  1.7109773676773136e-06
________________________________
distance 1 is tensor(170.8544, device='cuda:1')
distance 2 is tensor(12.4349, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  2.5123247288727137e-05
avg test loss is  339.2542335168639
avg accuracy is  0.3163666668230065
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9376, device='cuda:1')
compute_distance is  tensor(12.4349, device='cuda:1')
compute_norm is  tensor(52.6243, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(149.6045, device='cuda:1')
distance 2 is tensor(12.8189, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9218588238840164
avg test loss is  1.468138194033332
avg accuracy is  0.6844500001563316
solo acc is  0.3007333334896728
compute similarity  is  tensor(0.9425, device='cuda:1')
compute_distance is  tensor(12.8189, device='cuda:1')
compute_norm is  tensor(51.9977, device='cuda:1')
++++++++++++++++++++
distance 1 is tensor(149.6045, device='cuda:1')
distance 2 is tensor(12.8189, device='cuda:1')
________________________________
test distance is  tensor(12.8189, device='cuda:1')
test similarity is  tensor(0.9425, device='cuda:1')
test acc is  0.6822333334896651
test loss is 1.4676617178073061
test entropy is  0.9215403969353958
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.5449323654174805
mal norm is  tensor(8.0854, device='cuda:1')
distance 1 is tensor(149.6045, device='cuda:1')
distance 2 is tensor(12.8189, device='cuda:1')
mal distance is  tensor(12.8189, device='cuda:1')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(0.1246, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.1086, device='cuda:1')
c is  tensor(0.0146, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.0358, device='cuda:1')
c is  tensor(0.0147, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.1373, device='cuda:1')
c is  tensor(0.0144, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.4664, device='cuda:1')
c is  tensor(0.0142, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(546.4481, device='cuda:1')
c is  tensor(0.0151, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.1324, device='cuda:1')
c is  tensor(0.0134, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.6266, device='cuda:1')
c is  tensor(0.0139, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.2152, device='cuda:1')
c is  tensor(0.0140, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(808.5401, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0005, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(751.3356, device='cuda:1')
c is  tensor(0.0129, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(741.3268, device='cuda:1')
c is  tensor(0.0130, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.1334, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.9788, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(793.0701, device='cuda:1')
c is  tensor(0.0125, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(745.6434, device='cuda:1')
c is  tensor(0.0129, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.5603, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.9294, device='cuda:1')
c is  tensor(0.0130, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.0496, device='cuda:1')
c is  tensor(0.0132, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(714.0357, device='cuda:1')
c is  tensor(0.0132, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(745.4912, device='cuda:1')
c is  tensor(0.0129, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.0789, device='cuda:1')
c is  tensor(0.0132, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(740.6853, device='cuda:1')
c is  tensor(0.0130, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(752.6523, device='cuda:1')
c is  tensor(0.0129, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.8848, device='cuda:1')
c is  tensor(0.0127, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0002, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(768.3661, device='cuda:1')
c is  tensor(0.0127, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.9372, device='cuda:1')
c is  tensor(0.0143, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(804.4315, device='cuda:1')
c is  tensor(0.0124, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.1082, device='cuda:1')
c is  tensor(0.0134, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.4372, device='cuda:1')
c is  tensor(0.0132, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(717.4948, device='cuda:1')
c is  tensor(0.0132, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(733.3382, device='cuda:1')
c is  tensor(0.0130, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.3146, device='cuda:1')
c is  tensor(0.0127, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(748.1179, device='cuda:1')
c is  tensor(0.0129, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(782.7827, device='cuda:1')
c is  tensor(0.0126, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.3064, device='cuda:1')
c is  tensor(0.0134, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.7108, device='cuda:1')
c is  tensor(0.0146, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.1614, device='cuda:1')
c is  tensor(0.0135, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0003, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.6768, device='cuda:1')
c is  tensor(0.0133, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.0908, device='cuda:1')
c is  tensor(0.0136, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0006, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.5054, device='cuda:1')
c is  tensor(0.0138, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0005, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.3312, device='cuda:1')
c is  tensor(0.0131, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
len accept list 40
len all weights is 40
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 92.99% 

Test Accuracy: 89.86% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1316623091697693
distance 1 is tensor(104.0478, device='cuda:1')
distance 2 is tensor(7.6347, device='cuda:1')
benign distance is  tensor(7.6347, device='cuda:1')
norm1 res is  tensor(0.1130, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.8587942123413086
distance 1 is tensor(116.1623, device='cuda:1')
distance 2 is tensor(8.4157, device='cuda:1')
benign distance is  tensor(8.4157, device='cuda:1')
norm1 res is  tensor(0.1259, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.1230665072798729
distance 1 is tensor(95.3518, device='cuda:1')
distance 2 is tensor(6.8641, device='cuda:1')
benign distance is  tensor(6.8641, device='cuda:1')
norm1 res is  tensor(0.1028, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.5250069499015808
distance 1 is tensor(132.9769, device='cuda:1')
distance 2 is tensor(9.6977, device='cuda:1')
benign distance is  tensor(9.6977, device='cuda:1')
norm1 res is  tensor(0.1488, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.5750205516815186
distance 1 is tensor(121.1949, device='cuda:1')
distance 2 is tensor(8.7112, device='cuda:1')
benign distance is  tensor(8.7112, device='cuda:1')
norm1 res is  tensor(0.1277, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.39181071519851685
distance 1 is tensor(145.2246, device='cuda:1')
distance 2 is tensor(10.4332, device='cuda:1')
benign distance is  tensor(10.4332, device='cuda:1')
norm1 res is  tensor(0.1615, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.5141588449478149
distance 1 is tensor(121.6586, device='cuda:1')
distance 2 is tensor(8.8819, device='cuda:1')
benign distance is  tensor(8.8819, device='cuda:1')
norm1 res is  tensor(0.1360, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.14735153317451477
distance 1 is tensor(118.2300, device='cuda:1')
distance 2 is tensor(8.5884, device='cuda:1')
benign distance is  tensor(8.5884, device='cuda:1')
norm1 res is  tensor(0.1283, device='cuda:1')
current submit client idx and staleness is  8 2
 benign loss is  0.07230544090270996
distance 1 is tensor(132.3969, device='cuda:1')
distance 2 is tensor(9.5461, device='cuda:1')
benign distance is  tensor(9.5461, device='cuda:1')
norm1 res is  tensor(0.1434, device='cuda:1')
current submit client idx and staleness is  9 2
 benign loss is  0.3352017402648926
distance 1 is tensor(140.9687, device='cuda:1')
distance 2 is tensor(10.0398, device='cuda:1')
benign distance is  tensor(10.0398, device='cuda:1')
norm1 res is  tensor(0.1504, device='cuda:1')
current submit client idx and staleness is  10 2
 benign loss is  0.611516535282135
distance 1 is tensor(146.6171, device='cuda:1')
distance 2 is tensor(10.3825, device='cuda:1')
benign distance is  tensor(10.3825, device='cuda:1')
norm1 res is  tensor(0.1603, device='cuda:1')
current submit client idx and staleness is  11 2
 benign loss is  0.21867606043815613
distance 1 is tensor(144.9292, device='cuda:1')
distance 2 is tensor(10.5598, device='cuda:1')
benign distance is  tensor(10.5598, device='cuda:1')
norm1 res is  tensor(0.1593, device='cuda:1')
current submit client idx and staleness is  12 2
 benign loss is  0.4162304997444153
distance 1 is tensor(131.1060, device='cuda:1')
distance 2 is tensor(9.5174, device='cuda:1')
benign distance is  tensor(9.5174, device='cuda:1')
norm1 res is  tensor(0.1442, device='cuda:1')
current submit client idx and staleness is  13 2
 benign loss is  0.17428764700889587
distance 1 is tensor(141.4382, device='cuda:1')
distance 2 is tensor(10.2487, device='cuda:1')
benign distance is  tensor(10.2487, device='cuda:1')
norm1 res is  tensor(0.1552, device='cuda:1')
current submit client idx and staleness is  14 2
 benign loss is  0.4340289235115051
distance 1 is tensor(127.8683, device='cuda:1')
distance 2 is tensor(9.3931, device='cuda:1')
benign distance is  tensor(9.3931, device='cuda:1')
norm1 res is  tensor(0.1403, device='cuda:1')
current submit client idx and staleness is  15 2
 benign loss is  0.5695333480834961
distance 1 is tensor(130.5593, device='cuda:1')
distance 2 is tensor(9.5337, device='cuda:1')
benign distance is  tensor(9.5337, device='cuda:1')
norm1 res is  tensor(0.1423, device='cuda:1')
current submit client idx and staleness is  16 3
 benign loss is  0.319061815738678
distance 1 is tensor(114.6128, device='cuda:1')
distance 2 is tensor(8.3020, device='cuda:1')
benign distance is  tensor(8.3020, device='cuda:1')
norm1 res is  tensor(0.1245, device='cuda:1')
current submit client idx and staleness is  17 3
 benign loss is  0.5009536743164062
distance 1 is tensor(144.2063, device='cuda:1')
distance 2 is tensor(10.3964, device='cuda:1')
benign distance is  tensor(10.3964, device='cuda:1')
norm1 res is  tensor(0.1562, device='cuda:1')
current submit client idx and staleness is  18 3
 benign loss is  0.35304388403892517
distance 1 is tensor(127.8433, device='cuda:1')
distance 2 is tensor(9.3072, device='cuda:1')
benign distance is  tensor(9.3072, device='cuda:1')
norm1 res is  tensor(0.1378, device='cuda:1')
current submit client idx and staleness is  19 3
 benign loss is  0.5007315278053284
distance 1 is tensor(122.1295, device='cuda:1')
distance 2 is tensor(9.0262, device='cuda:1')
benign distance is  tensor(9.0262, device='cuda:1')
norm1 res is  tensor(0.1358, device='cuda:1')
current submit client idx and staleness is  20 3
 benign loss is  0.4646841883659363
distance 1 is tensor(136.2736, device='cuda:1')
distance 2 is tensor(9.7948, device='cuda:1')
benign distance is  tensor(9.7948, device='cuda:1')
norm1 res is  tensor(0.1450, device='cuda:1')
current submit client idx and staleness is  21 3
 benign loss is  0.5917996168136597
distance 1 is tensor(130.8909, device='cuda:1')
distance 2 is tensor(9.5001, device='cuda:1')
benign distance is  tensor(9.5001, device='cuda:1')
norm1 res is  tensor(0.1414, device='cuda:1')
current submit client idx and staleness is  22 3
 benign loss is  0.5558491349220276
distance 1 is tensor(133.0658, device='cuda:1')
distance 2 is tensor(9.7171, device='cuda:1')
benign distance is  tensor(9.7171, device='cuda:1')
norm1 res is  tensor(0.1454, device='cuda:1')
current submit client idx and staleness is  23 3
 benign loss is  0.45829978585243225
distance 1 is tensor(142.5658, device='cuda:1')
distance 2 is tensor(10.4439, device='cuda:1')
benign distance is  tensor(10.4439, device='cuda:1')
norm1 res is  tensor(0.1552, device='cuda:1')
current submit client idx and staleness is  24 4
 benign loss is  0.6114603281021118
distance 1 is tensor(151.0756, device='cuda:1')
distance 2 is tensor(10.9960, device='cuda:1')
benign distance is  tensor(10.9960, device='cuda:1')
norm1 res is  tensor(0.1682, device='cuda:1')
current submit client idx and staleness is  25 4
 benign loss is  0.5566486120223999
distance 1 is tensor(145.4594, device='cuda:1')
distance 2 is tensor(10.5602, device='cuda:1')
benign distance is  tensor(10.5602, device='cuda:1')
norm1 res is  tensor(0.1570, device='cuda:1')
current submit client idx and staleness is  26 4
 benign loss is  0.4658415913581848
distance 1 is tensor(150.7210, device='cuda:1')
distance 2 is tensor(10.8636, device='cuda:1')
benign distance is  tensor(10.8636, device='cuda:1')
norm1 res is  tensor(0.1630, device='cuda:1')
current submit client idx and staleness is  27 4
 benign loss is  0.4879720211029053
distance 1 is tensor(141.1563, device='cuda:1')
distance 2 is tensor(10.1474, device='cuda:1')
benign distance is  tensor(10.1474, device='cuda:1')
norm1 res is  tensor(0.1561, device='cuda:1')
current submit client idx and staleness is  28 4
 benign loss is  0.8165333867073059
distance 1 is tensor(142.3091, device='cuda:1')
distance 2 is tensor(10.2099, device='cuda:1')
benign distance is  tensor(10.2099, device='cuda:1')
norm1 res is  tensor(0.1541, device='cuda:1')
current submit client idx and staleness is  29 4
 benign loss is  0.25442010164260864
distance 1 is tensor(145.6926, device='cuda:1')
distance 2 is tensor(10.4769, device='cuda:1')
benign distance is  tensor(10.4769, device='cuda:1')
norm1 res is  tensor(0.1578, device='cuda:1')
current submit client idx and staleness is  30 4
 benign loss is  0.29270297288894653
distance 1 is tensor(137.7936, device='cuda:1')
distance 2 is tensor(10.1951, device='cuda:1')
benign distance is  tensor(10.1951, device='cuda:1')
norm1 res is  tensor(0.1535, device='cuda:1')
current submit client idx and staleness is  31 4
 benign loss is  0.39396968483924866
distance 1 is tensor(136.4733, device='cuda:1')
distance 2 is tensor(9.8003, device='cuda:1')
benign distance is  tensor(9.8003, device='cuda:1')
norm1 res is  tensor(0.1480, device='cuda:1')
current submit client idx and staleness is  40 6
 benign loss is  0.24667438864707947
distance 1 is tensor(156.7638, device='cuda:1')
distance 2 is tensor(11.4249, device='cuda:1')
benign distance is  tensor(11.4249, device='cuda:1')
norm1 res is  tensor(0.1691, device='cuda:1')
current submit client idx and staleness is  41 6
 benign loss is  0.572794497013092
distance 1 is tensor(127.4086, device='cuda:1')
distance 2 is tensor(9.2238, device='cuda:1')
benign distance is  tensor(9.2238, device='cuda:1')
norm1 res is  tensor(0.1356, device='cuda:1')
current submit client idx and staleness is  42 6
 benign loss is  0.032325249165296555
distance 1 is tensor(132.1027, device='cuda:1')
distance 2 is tensor(9.4950, device='cuda:1')
benign distance is  tensor(9.4950, device='cuda:1')
norm1 res is  tensor(0.1439, device='cuda:1')
current submit client idx and staleness is  43 6
 benign loss is  0.77779221534729
distance 1 is tensor(151.5490, device='cuda:1')
distance 2 is tensor(10.9267, device='cuda:1')
benign distance is  tensor(10.9267, device='cuda:1')
norm1 res is  tensor(0.1618, device='cuda:1')
current submit client idx and staleness is  44 6
 benign loss is  0.026595061644911766
distance 1 is tensor(142.7035, device='cuda:1')
distance 2 is tensor(10.3337, device='cuda:1')
benign distance is  tensor(10.3337, device='cuda:1')
norm1 res is  tensor(0.1553, device='cuda:1')
current submit client idx and staleness is  45 6
 benign loss is  0.36164391040802
distance 1 is tensor(150.7239, device='cuda:1')
distance 2 is tensor(10.8788, device='cuda:1')
benign distance is  tensor(10.8788, device='cuda:1')
norm1 res is  tensor(0.1599, device='cuda:1')
current submit client idx and staleness is  46 6
 benign loss is  0.8909055590629578
distance 1 is tensor(136.8135, device='cuda:1')
distance 2 is tensor(9.8114, device='cuda:1')
benign distance is  tensor(9.8114, device='cuda:1')
norm1 res is  tensor(0.1481, device='cuda:1')
current submit client idx and staleness is  47 6
 benign loss is  0.5512356758117676
distance 1 is tensor(147.6751, device='cuda:1')
distance 2 is tensor(10.7517, device='cuda:1')
benign distance is  tensor(10.7517, device='cuda:1')
norm1 res is  tensor(0.1626, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(160.4540, device='cuda:1')
distance 2 is tensor(11.5886, device='cuda:1')
compute distance is  tensor(11.5886, device='cuda:1')
compute norm is  tensor(54.8649, device='cuda:1')
distance 1 is tensor(168.7507, device='cuda:1')
distance 2 is tensor(12.2855, device='cuda:1')
compute distance is  tensor(12.2855, device='cuda:1')
compute norm is  tensor(55.0308, device='cuda:1')
distance 1 is tensor(182.4546, device='cuda:1')
distance 2 is tensor(13.0615, device='cuda:1')
compute distance is  tensor(13.0615, device='cuda:1')
compute norm is  tensor(55.5148, device='cuda:1')
distance 1 is tensor(147.1021, device='cuda:1')
distance 2 is tensor(10.6766, device='cuda:1')
compute distance is  tensor(10.6766, device='cuda:1')
compute norm is  tensor(54.6570, device='cuda:1')
distance 1 is tensor(158.5524, device='cuda:1')
distance 2 is tensor(11.4868, device='cuda:1')
compute distance is  tensor(11.4868, device='cuda:1')
compute norm is  tensor(54.8966, device='cuda:1')
distance 1 is tensor(169.6007, device='cuda:1')
distance 2 is tensor(12.2927, device='cuda:1')
compute distance is  tensor(12.2927, device='cuda:1')
compute norm is  tensor(55.2132, device='cuda:1')
distance 1 is tensor(163.8925, device='cuda:1')
distance 2 is tensor(11.8867, device='cuda:1')
compute distance is  tensor(11.8867, device='cuda:1')
compute norm is  tensor(55.1333, device='cuda:1')
distance 1 is tensor(140.5676, device='cuda:1')
distance 2 is tensor(10.3291, device='cuda:1')
compute distance is  tensor(10.3291, device='cuda:1')
compute norm is  tensor(54.6091, device='cuda:1')
distance 1 is tensor(156.5904, device='cuda:1')
distance 2 is tensor(11.3556, device='cuda:1')
compute distance is  tensor(11.3556, device='cuda:1')
compute norm is  tensor(55.0834, device='cuda:1')
distance 1 is tensor(152.0117, device='cuda:1')
distance 2 is tensor(11.0459, device='cuda:1')
compute distance is  tensor(11.0459, device='cuda:1')
compute norm is  tensor(54.8228, device='cuda:1')
distance 1 is tensor(161.9817, device='cuda:1')
distance 2 is tensor(11.6602, device='cuda:1')
compute distance is  tensor(11.6602, device='cuda:1')
compute norm is  tensor(55.1166, device='cuda:1')
distance 1 is tensor(153.4718, device='cuda:1')
distance 2 is tensor(11.1415, device='cuda:1')
compute distance is  tensor(11.1415, device='cuda:1')
compute norm is  tensor(54.8921, device='cuda:1')
distance Threshold  is  tensor(13.0615, device='cuda:1')
distance 1 is tensor(1020641.3125, device='cuda:1')
distance 2 is tensor(74286.5469, device='cuda:1')
________________________________
test distance is  tensor(74286.5469, device='cuda:1')
test similarity is  tensor(-0.0975, device='cuda:1')
test acc is  0.10000000015633198
test loss is 6.995091452433814e+17
test entropy is  0.0
________________________________
cal ratio is  0.011933964113467876
distance 1 is tensor(12180.3018, device='cuda:1')
distance 2 is tensor(886.5330, device='cuda:1')
cal_distance is  tensor(886.5330, device='cuda:1')
cal ratio is  0.10924268574346303
distance 1 is tensor(1330.6147, device='cuda:1')
distance 2 is tensor(96.8472, device='cuda:1')
cal_distance is  tensor(96.8472, device='cuda:1')
cal ratio is  0.3305188019366776
distance 1 is tensor(439.7975, device='cuda:1')
distance 2 is tensor(32.0098, device='cuda:1')
cal_distance is  tensor(32.0098, device='cuda:1')
cal ratio is  0.5749076541054694
distance 1 is tensor(252.8457, device='cuda:1')
distance 2 is tensor(18.4027, device='cuda:1')
cal_distance is  tensor(18.4027, device='cuda:1')
cal ratio is  0.7582266708090476
distance 1 is tensor(191.7160, device='cuda:1')
distance 2 is tensor(13.9534, device='cuda:1')
cal_distance is  tensor(13.9534, device='cuda:1')
cal ratio is  0.8707621178338284
distance 1 is tensor(166.9398, device='cuda:1')
distance 2 is tensor(12.1501, device='cuda:1')
cal_distance is  tensor(12.1501, device='cuda:1')
distance 1 is tensor(166.9398, device='cuda:1')
distance 2 is tensor(12.1501, device='cuda:1')
________________________________
test distance is  tensor(12.1501, device='cuda:1')
test similarity is  tensor(0.9413, device='cuda:1')
test acc is  0.6461333334896675
test loss is 271.99230916362836
test entropy is  0.0012647815547218806
________________________________
distance 1 is tensor(166.9398, device='cuda:1')
distance 2 is tensor(12.1501, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0014210893073272441
avg test loss is  271.88903092829656
avg accuracy is  0.6467166668230009
solo acc is  0.10635000015633196
compute similarity  is  tensor(0.9413, device='cuda:1')
compute_distance is  tensor(12.1501, device='cuda:1')
compute_norm is  tensor(53.3436, device='cuda:1')
++++++++++++++++++++
change alpha
distance 1 is tensor(150.4248, device='cuda:1')
distance 2 is tensor(13.1951, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9296793378492408
avg test loss is  1.5489164494248087
avg accuracy is  0.8217333334896577
solo acc is  0.29985000015633945
compute similarity  is  tensor(0.9453, device='cuda:1')
compute_distance is  tensor(13.1951, device='cuda:1')
compute_norm is  tensor(52.3629, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.3425, device='cuda:1')
distance 2 is tensor(13.4129, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8848617860376199
avg test loss is  1.617658756053778
avg accuracy is  0.8236166668229911
solo acc is  0.23915000015633792
compute similarity  is  tensor(0.9450, device='cuda:1')
compute_distance is  tensor(13.4129, device='cuda:1')
compute_norm is  tensor(52.0473, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.9522, device='cuda:1')
distance 2 is tensor(13.5583, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8768126062238648
avg test loss is  1.5574635238027268
avg accuracy is  0.8234166668229911
solo acc is  0.2449666668230048
compute similarity  is  tensor(0.9448, device='cuda:1')
compute_distance is  tensor(13.5583, device='cuda:1')
compute_norm is  tensor(51.7453, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.5133, device='cuda:1')
distance 2 is tensor(13.6887, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8681256942022075
avg test loss is  1.5137548521637663
avg accuracy is  0.827016666822991
solo acc is  0.2454500001563381
compute similarity  is  tensor(0.9446, device='cuda:1')
compute_distance is  tensor(13.6887, device='cuda:1')
compute_norm is  tensor(51.4551, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.0562, device='cuda:1')
distance 2 is tensor(13.8104, device='cuda:1')
________________________________
test distance is  tensor(13.8104, device='cuda:1')
test similarity is  tensor(0.9444, device='cuda:1')
test acc is  0.8295000001563242
test loss is 1.49749311162973
test entropy is  0.8581454085388671
________________________________
cal ratio is  0.8752603181118027
distance 1 is tensor(137.4658, device='cuda:1')
distance 2 is tensor(12.0877, device='cuda:1')
cal_distance is  tensor(12.0877, device='cuda:1')
distance 1 is tensor(137.4658, device='cuda:1')
distance 2 is tensor(12.0877, device='cuda:1')
________________________________
test distance is  tensor(12.0877, device='cuda:1')
test similarity is  tensor(0.9573, device='cuda:1')
test acc is  0.8549000001563231
test loss is 1.1812798101891842
test entropy is  0.9275781697174633
________________________________
distance 1 is tensor(137.4658, device='cuda:1')
distance 2 is tensor(12.0877, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.9280234649618552
avg test loss is  1.1815256798572378
avg accuracy is  0.8539333334896564
solo acc is  0.4276666668230081
compute similarity  is  tensor(0.9573, device='cuda:1')
compute_distance is  tensor(12.0877, device='cuda:1')
compute_norm is  tensor(51.1020, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.5033, device='cuda:1')
distance 2 is tensor(12.3973, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8463333273238973
avg test loss is  1.4624402800094345
avg accuracy is  0.8455000001563235
solo acc is  0.24966666682300492
compute similarity  is  tensor(0.9567, device='cuda:1')
compute_distance is  tensor(12.3973, device='cuda:1')
compute_norm is  tensor(50.8251, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.5447, device='cuda:1')
distance 2 is tensor(12.5599, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.845772346580969
avg test loss is  1.4361914349263156
avg accuracy is  0.8467833334896568
solo acc is  0.2462833334896715
compute similarity  is  tensor(0.9565, device='cuda:1')
compute_distance is  tensor(12.5599, device='cuda:1')
compute_norm is  tensor(50.5493, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.4361, device='cuda:1')
distance 2 is tensor(12.7081, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8426437807489814
avg test loss is  1.4115799080842593
avg accuracy is  0.8465666668229901
solo acc is  0.2472500001563382
compute similarity  is  tensor(0.9562, device='cuda:1')
compute_distance is  tensor(12.7081, device='cuda:1')
compute_norm is  tensor(50.2828, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.2113, device='cuda:1')
distance 2 is tensor(12.8406, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8380947733865872
avg test loss is  1.4030792927945346
avg accuracy is  0.8490000001563234
solo acc is  0.2402500001563379
compute similarity  is  tensor(0.9560, device='cuda:1')
compute_distance is  tensor(12.8406, device='cuda:1')
compute_norm is  tensor(50.0232, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.9305, device='cuda:1')
distance 2 is tensor(12.9647, device='cuda:1')
________________________________
test distance is  tensor(12.9647, device='cuda:1')
test similarity is  tensor(0.9558, device='cuda:1')
test acc is  0.8509666668229899
test loss is 1.3875256696743752
test entropy is  0.8321906099441463
________________________________
distance 1 is tensor(147.9305, device='cuda:1')
distance 2 is tensor(12.9647, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8315503701472333
avg test loss is  1.3867762543753521
avg accuracy is  0.8516333334896565
solo acc is  0.24403333348967132
compute similarity  is  tensor(0.9558, device='cuda:1')
compute_distance is  tensor(12.9647, device='cuda:1')
compute_norm is  tensor(49.7680, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.6181, device='cuda:1')
distance 2 is tensor(13.0868, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8292747847815313
avg test loss is  1.3727076971200483
avg accuracy is  0.8527833334896565
solo acc is  0.24221666682300463
compute similarity  is  tensor(0.9557, device='cuda:1')
compute_distance is  tensor(13.0868, device='cuda:1')
compute_norm is  tensor(49.5171, device='cuda:1')
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.3701, device='cuda:1')
distance 2 is tensor(13.2113, device='cuda:1')
exit early
distance 1 is tensor(151.3701, device='cuda:1')
distance 2 is tensor(13.2113, device='cuda:1')
________________________________
test distance is  tensor(13.2113, device='cuda:1')
test similarity is  tensor(0.9555, device='cuda:1')
test acc is  0.8535000001563232
test loss is 1.373545747321806
test entropy is  0.8188885891361277
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.1932504177093506
mal norm is  tensor(7.0698, device='cuda:1')
distance 1 is tensor(151.3701, device='cuda:1')
distance 2 is tensor(13.2113, device='cuda:1')
mal distance is  tensor(13.2113, device='cuda:1')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(0.2328, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(443.5438, device='cuda:1')
c is  tensor(0.0229, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0004, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.5819, device='cuda:1')
c is  tensor(0.0216, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0004, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(399.9272, device='cuda:1')
c is  tensor(0.0241, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(0.0001, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.1402, device='cuda:1')
c is  tensor(0.0200, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.8975, device='cuda:1')
c is  tensor(0.0214, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0001, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.5770, device='cuda:1')
c is  tensor(0.0192, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0002, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.5660, device='cuda:1')
c is  tensor(0.0210, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(1.5188e-05, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.2223, device='cuda:1')
c is  tensor(0.0213, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(3.2020e-06, device='cuda:1')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(706.9848, device='cuda:1')
c is  tensor(0.0181, device='cuda:1')
param_update shape torch.Size([215370])
global_update shape torch.Size([215370])
score : tensor(-0.0003, device='cuda:1')
len accept list 4
len all weights is 4
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 92.77% 

Test Accuracy: 89.85% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
 benign loss is  0.013896320946514606
distance 1 is tensor(119.7383, device='cuda:1')
distance 2 is tensor(8.5160, device='cuda:1')
benign distance is  tensor(8.5160, device='cuda:1')
norm1 res is  tensor(0.1279, device='cuda:1')
current submit client idx and staleness is  1 1
 benign loss is  0.5072071552276611
distance 1 is tensor(145.7371, device='cuda:1')
distance 2 is tensor(10.4674, device='cuda:1')
benign distance is  tensor(10.4674, device='cuda:1')
norm1 res is  tensor(0.1563, device='cuda:1')
current submit client idx and staleness is  2 1
 benign loss is  0.18519482016563416
distance 1 is tensor(96.7457, device='cuda:1')
distance 2 is tensor(6.9313, device='cuda:1')
benign distance is  tensor(6.9313, device='cuda:1')
norm1 res is  tensor(0.1023, device='cuda:1')
current submit client idx and staleness is  3 1
 benign loss is  0.4095706045627594
distance 1 is tensor(127.9745, device='cuda:1')
distance 2 is tensor(9.3293, device='cuda:1')
benign distance is  tensor(9.3293, device='cuda:1')
norm1 res is  tensor(0.1399, device='cuda:1')
current submit client idx and staleness is  4 1
 benign loss is  0.36371129751205444
distance 1 is tensor(150.5475, device='cuda:1')
distance 2 is tensor(10.8021, device='cuda:1')
benign distance is  tensor(10.8021, device='cuda:1')
norm1 res is  tensor(0.1669, device='cuda:1')
current submit client idx and staleness is  5 1
 benign loss is  0.8528882265090942
distance 1 is tensor(155.6559, device='cuda:1')
distance 2 is tensor(11.3800, device='cuda:1')
benign distance is  tensor(11.3800, device='cuda:1')
norm1 res is  tensor(0.1718, device='cuda:1')
current submit client idx and staleness is  6 1
 benign loss is  0.25702568888664246
distance 1 is tensor(114.6962, device='cuda:1')
distance 2 is tensor(8.1846, device='cuda:1')
benign distance is  tensor(8.1846, device='cuda:1')
norm1 res is  tensor(0.1237, device='cuda:1')
current submit client idx and staleness is  7 1
 benign loss is  0.2508600056171417
distance 1 is tensor(138.2653, device='cuda:1')
distance 2 is tensor(9.8679, device='cuda:1')
benign distance is  tensor(9.8679, device='cuda:1')
norm1 res is  tensor(0.1501, device='cuda:1')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(145.2155, device='cuda:1')
distance 2 is tensor(10.5597, device='cuda:1')
compute distance is  tensor(10.5597, device='cuda:1')
compute norm is  tensor(54.5081, device='cuda:1')
distance 1 is tensor(151.0747, device='cuda:1')
distance 2 is tensor(11.0560, device='cuda:1')
compute distance is  tensor(11.0560, device='cuda:1')
compute norm is  tensor(54.5615, device='cuda:1')
distance 1 is tensor(163.0793, device='cuda:1')
distance 2 is tensor(11.7157, device='cuda:1')
compute distance is  tensor(11.7157, device='cuda:1')
compute norm is  tensor(54.8689, device='cuda:1')
distance 1 is tensor(143.6372, device='cuda:1')
distance 2 is tensor(10.4205, device='cuda:1')
compute distance is  tensor(10.4205, device='cuda:1')
compute norm is  tensor(54.3790, device='cuda:1')
distance 1 is tensor(148.0084, device='cuda:1')
distance 2 is tensor(10.8435, device='cuda:1')
compute distance is  tensor(10.8435, device='cuda:1')
compute norm is  tensor(54.5563, device='cuda:1')
distance 1 is tensor(166.3035, device='cuda:1')
distance 2 is tensor(12.0518, device='cuda:1')
compute distance is  tensor(12.0518, device='cuda:1')
compute norm is  tensor(54.9807, device='cuda:1')
distance 1 is tensor(158.7381, device='cuda:1')
distance 2 is tensor(11.4544, device='cuda:1')
compute distance is  tensor(11.4544, device='cuda:1')
compute norm is  tensor(54.8600, device='cuda:1')
distance 1 is tensor(150.7825, device='cuda:1')
distance 2 is tensor(10.9539, device='cuda:1')
compute distance is  tensor(10.9539, device='cuda:1')
compute norm is  tensor(54.6975, device='cuda:1')
distance 1 is tensor(170.3812, device='cuda:1')
distance 2 is tensor(12.1683, device='cuda:1')
compute distance is  tensor(12.1683, device='cuda:1')
compute norm is  tensor(55.2582, device='cuda:1')
distance 1 is tensor(174.6754, device='cuda:1')
distance 2 is tensor(12.5876, device='cuda:1')
compute distance is  tensor(12.5876, device='cuda:1')
compute norm is  tensor(55.1416, device='cuda:1')
distance 1 is tensor(152.6351, device='cuda:1')
distance 2 is tensor(10.9487, device='cuda:1')
compute distance is  tensor(10.9487, device='cuda:1')
compute norm is  tensor(54.7554, device='cuda:1')
distance 1 is tensor(139.6996, device='cuda:1')
distance 2 is tensor(10.0445, device='cuda:1')
compute distance is  tensor(10.0445, device='cuda:1')
compute norm is  tensor(54.4924, device='cuda:1')
distance Threshold  is  tensor(12.5876, device='cuda:1')
distance 1 is tensor(1020638.6875, device='cuda:1')
distance 2 is tensor(74286.3984, device='cuda:1')
________________________________
test distance is  tensor(74286.3984, device='cuda:1')
test similarity is  tensor(-0.0971, device='cuda:1')
test acc is  0.10000000015633198
test loss is 6.994017155652419e+17
test entropy is  0.0
________________________________
cal ratio is  0.01171546075897705
distance 1 is tensor(11957.2568, device='cuda:1')
distance 2 is tensor(870.2995, device='cuda:1')
cal_distance is  tensor(870.2995, device='cuda:1')
cal ratio is  0.1082379750220558
distance 1 is tensor(1294.2350, device='cuda:1')
distance 2 is tensor(94.1994, device='cuda:1')
cal_distance is  tensor(94.1994, device='cuda:1')
cal ratio is  0.32899540510599573
distance 1 is tensor(425.8017, device='cuda:1')
distance 2 is tensor(30.9912, device='cuda:1')
cal_distance is  tensor(30.9912, device='cuda:1')
cal ratio is  0.5735811983759993
distance 1 is tensor(244.2346, device='cuda:1')
distance 2 is tensor(17.7760, device='cuda:1')
cal_distance is  tensor(17.7760, device='cuda:1')
cal ratio is  0.7573514680368812
distance 1 is tensor(184.9731, device='cuda:1')
distance 2 is tensor(13.4627, device='cuda:1')
cal_distance is  tensor(13.4627, device='cuda:1')
cal ratio is  0.8702593877944071
distance 1 is tensor(160.9754, device='cuda:1')
distance 2 is tensor(11.7160, device='cuda:1')
cal_distance is  tensor(11.7160, device='cuda:1')
distance 1 is tensor(160.9754, device='cuda:1')
distance 2 is tensor(11.7160, device='cuda:1')
________________________________
test distance is  tensor(11.7160, device='cuda:1')
test similarity is  tensor(0.9462, device='cuda:1')
test acc is  0.6661833334896662
test loss is 267.8190269063531
test entropy is  0.0013688765143452593
________________________________
distance 1 is tensor(160.9754, device='cuda:1')