
Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 20

    Attack ratio : 0.2
     None of attack is done!

Files already downloaded and verified
Files already downloaded and verified

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 20

    Attack ratio : 0.2
     None of attack is done!

Files already downloaded and verified
Files already downloaded and verified
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 20

    Attack ratio : 0.2
     None of attack is done!

Files already downloaded and verified
Files already downloaded and verified
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(54015.2903, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54015.2903, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3480885922908783
current submit client idx and staleness is  1 1
distance 2 is tensor(53781.7591, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53781.7591, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.010577414184808731
current submit client idx and staleness is  2 1
distance 2 is tensor(53756.8939, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53756.8939, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05411558598279953
current submit client idx and staleness is  3 1
distance 2 is tensor(54038.7294, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54038.7294, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5504646301269531
current submit client idx and staleness is  4 1
distance 2 is tensor(53987.7226, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53987.7226, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.39065229892730713
current submit client idx and staleness is  5 1
distance 2 is tensor(53964.7102, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53964.7102, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4623325765132904
current submit client idx and staleness is  6 1
distance 2 is tensor(53758.5198, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53758.5198, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.020466838032007217
current submit client idx and staleness is  7 1
distance 2 is tensor(53850.1417, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53850.1417, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20138581097126007
current submit client idx and staleness is  8 2
distance 2 is tensor(53781.6985, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53781.6985, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16207709908485413
current submit client idx and staleness is  9 2
distance 2 is tensor(54009.6262, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54009.6262, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28769850730895996
current submit client idx and staleness is  10 2
distance 2 is tensor(53986.1790, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53986.1790, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.551813006401062
current submit client idx and staleness is  11 2
distance 2 is tensor(53972.3703, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53972.3703, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8691176176071167
current submit client idx and staleness is  12 2
distance 2 is tensor(53971.6606, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53971.6606, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23601941764354706
current submit client idx and staleness is  13 2
distance 2 is tensor(53997.5528, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53997.5528, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.48590317368507385
current submit client idx and staleness is  14 2
distance 2 is tensor(54032.8726, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54032.8726, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7430973649024963
current submit client idx and staleness is  15 2
distance 2 is tensor(53779.8818, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53779.8818, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08368474245071411
current submit client idx and staleness is  16 3
distance 2 is tensor(53961.8734, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53961.8734, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.396115243434906
current submit client idx and staleness is  17 3
distance 2 is tensor(53974.0807, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53974.0807, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6619272828102112
current submit client idx and staleness is  18 3
distance 2 is tensor(54043.2206, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54043.2206, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14823149144649506
current submit client idx and staleness is  19 3
distance 2 is tensor(53981.9831, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53981.9831, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5319792628288269
current submit client idx and staleness is  20 3
distance 2 is tensor(53959.9460, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53959.9460, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.48612022399902344
current submit client idx and staleness is  21 3
distance 2 is tensor(54001.7370, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54001.7370, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01679464802145958
current submit client idx and staleness is  22 3
distance 2 is tensor(53965.6709, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53965.6709, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.261261522769928
current submit client idx and staleness is  23 3
distance 2 is tensor(53994.4220, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53994.4220, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.34025850892066956
current submit client idx and staleness is  24 4
distance 2 is tensor(53986.0051, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53986.0051, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5503951907157898
current submit client idx and staleness is  25 4
distance 2 is tensor(53963.2200, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53963.2200, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5077203512191772
current submit client idx and staleness is  26 4
distance 2 is tensor(53985.0275, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53985.0275, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.39496052265167236
current submit client idx and staleness is  27 4
distance 2 is tensor(53949.5838, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53949.5838, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7965574264526367
current submit client idx and staleness is  28 4
distance 2 is tensor(53983.4347, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53983.4347, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.522872805595398
current submit client idx and staleness is  29 4
distance 2 is tensor(53969.4566, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53969.4566, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3523615002632141
current submit client idx and staleness is  30 4
distance 2 is tensor(53954.2342, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53954.2342, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4908779263496399
current submit client idx and staleness is  31 4
distance 2 is tensor(53959.8371, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53959.8371, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22660419344902039
current submit client idx and staleness is  32 5
distance 2 is tensor(53948.6038, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53948.6038, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13421113789081573
current submit client idx and staleness is  33 5
distance 2 is tensor(53952.6502, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53952.6502, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4650149941444397
current submit client idx and staleness is  34 5
distance 2 is tensor(53981.0575, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53981.0575, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24125449359416962
current submit client idx and staleness is  35 5
distance 2 is tensor(53957.1153, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53957.1153, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5083082318305969
current submit client idx and staleness is  36 5
distance 2 is tensor(53917.8924, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53917.8924, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4316125810146332
current submit client idx and staleness is  37 5
distance 2 is tensor(53942.1159, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53942.1159, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6029912829399109
current submit client idx and staleness is  38 5
distance 2 is tensor(53917.9534, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53917.9534, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.029178952798247337
current submit client idx and staleness is  39 5
distance 2 is tensor(53990.9403, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53990.9403, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.646938145160675
current submit client idx and staleness is  40 6
distance 2 is tensor(53968.2858, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53968.2858, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5036085844039917
current submit client idx and staleness is  41 6
distance 2 is tensor(53961.9053, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53961.9053, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.27124452590942383
current submit client idx and staleness is  42 6
distance 2 is tensor(53922.4437, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53922.4437, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3437049388885498
current submit client idx and staleness is  43 6
distance 2 is tensor(53965.9126, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53965.9126, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6038923263549805
current submit client idx and staleness is  44 6
distance 2 is tensor(53921.1445, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53921.1445, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.43299683928489685
current submit client idx and staleness is  45 6
distance 2 is tensor(53940.1043, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53940.1043, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12878139317035675
current submit client idx and staleness is  46 6
distance 2 is tensor(53941.3660, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53941.3660, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3309568762779236
current submit client idx and staleness is  47 6
distance 2 is tensor(54000.6742, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54000.6742, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.633648693561554
current submit client idx and staleness is  48 1
distance 2 is tensor(53907.9970, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53907.9970, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.42527610063552856
current submit client idx and staleness is  49 1
distance 2 is tensor(53928.5444, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53928.5444, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5948993563652039
current submit client idx and staleness is  50 1
distance 2 is tensor(53825.7094, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53825.7094, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21173234283924103
current submit client idx and staleness is  51 1
distance 2 is tensor(53938.1614, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53938.1614, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2633586525917053
current submit client idx and staleness is  52 1
distance 2 is tensor(53783.1093, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53783.1093, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2672049403190613
current submit client idx and staleness is  53 1
distance 2 is tensor(53776.0580, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53776.0580, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.057127438485622406
current submit client idx and staleness is  54 1
distance 2 is tensor(54027.3256, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54027.3256, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7036375403404236
current submit client idx and staleness is  55 1
distance 2 is tensor(53774.1749, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53774.1749, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2924317717552185
current submit client idx and staleness is  56 1
distance 2 is tensor(53766.2509, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53766.2509, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21355509757995605
current submit client idx and staleness is  57 1
distance 2 is tensor(53812.3546, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53812.3546, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14089107513427734
current submit client idx and staleness is  58 1
distance 2 is tensor(53810.3838, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53810.3838, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2272489070892334
current submit client idx and staleness is  59 1
distance 2 is tensor(54057.4062, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54057.4062, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10192457586526871
benign_acc is 0.9500000005
benign_loss is 0.1685502976179123
benign_entropy is 0.025814389809966087
benign_acc is 0.9500000005
benign_loss is 0.06603202223777771
benign_entropy is 0.06633179634809494
benign_acc is 0.9500000005
benign_loss is 0.23845812678337097
benign_entropy is 0.020327016711235046
benign_acc is 0.9500000005
benign_loss is 0.14603771269321442
benign_entropy is 0.04681762680411339
benign_acc is 0.9500000005
benign_loss is 0.19659949839115143
benign_entropy is 0.05855146795511246
sync_acc is 0.9500000005
sync_loss is 0.08336701989173889
sync_entropy is 0.03628276288509369
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 75.79% 

Test Accuracy: 74.84% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53934.8183, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53934.8183, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1972830593585968
current submit client idx and staleness is  1 1
distance 2 is tensor(53795.7397, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53795.7397, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03971331566572189
current submit client idx and staleness is  2 1
distance 2 is tensor(53923.0319, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53923.0319, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2028614729642868
current submit client idx and staleness is  3 1
distance 2 is tensor(53742.9315, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53742.9315, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.33583322167396545
current submit client idx and staleness is  4 1
distance 2 is tensor(53701.0048, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53701.0048, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15476088225841522
current submit client idx and staleness is  5 1
distance 2 is tensor(54029.1970, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54029.1970, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5950154066085815
current submit client idx and staleness is  6 1
distance 2 is tensor(53899.0385, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53899.0385, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.37951549887657166
current submit client idx and staleness is  7 1
distance 2 is tensor(53967.5922, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53967.5922, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6126425862312317
current submit client idx and staleness is  48 1
distance 2 is tensor(53901.9611, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53901.9611, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.605140209197998
current submit client idx and staleness is  49 1
distance 2 is tensor(53910.7405, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53910.7405, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22456574440002441
current submit client idx and staleness is  50 1
distance 2 is tensor(54013.5614, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54013.5614, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.47106194496154785
current submit client idx and staleness is  51 1
distance 2 is tensor(53979.4578, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53979.4578, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.743313193321228
current submit client idx and staleness is  52 1
distance 2 is tensor(53957.4992, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53957.4992, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.771907389163971
current submit client idx and staleness is  53 1
distance 2 is tensor(54021.0921, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54021.0921, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04806589335203171
current submit client idx and staleness is  54 1
distance 2 is tensor(53757.7772, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53757.7772, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2393045723438263
current submit client idx and staleness is  55 1
distance 2 is tensor(53982.8079, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.8079, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8487364053726196
current submit client idx and staleness is  56 1
distance 2 is tensor(53768.5494, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53768.5494, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21547599136829376
current submit client idx and staleness is  57 1
distance 2 is tensor(53854.0627, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53854.0627, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.9556576013565063
current submit client idx and staleness is  58 1
distance 2 is tensor(53759.9520, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53759.9520, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01421753503382206
current submit client idx and staleness is  59 1
distance 2 is tensor(53695.4238, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53695.4238, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13526108860969543
sync_acc is 0.9500000005
sync_loss is 0.1154942661523819
sync_entropy is 0.027261709794402122
curent length is  20
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 75.28% 

Test Accuracy: 74.73% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53718.1909, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53718.1909, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11780426651239395
current submit client idx and staleness is  1 1
distance 2 is tensor(53768.7522, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53768.7522, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05028942972421646
current submit client idx and staleness is  2 1
distance 2 is tensor(53841.2924, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53841.2924, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5682593584060669
current submit client idx and staleness is  3 1
distance 2 is tensor(53752.0634, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53752.0634, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1430879831314087
current submit client idx and staleness is  4 1
distance 2 is tensor(53810.3709, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53810.3709, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6772971153259277
current submit client idx and staleness is  5 1
distance 2 is tensor(53775.5395, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53775.5395, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20477470755577087
current submit client idx and staleness is  6 1
distance 2 is tensor(53749.9508, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53749.9508, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.013389160856604576
current submit client idx and staleness is  7 1
distance 2 is tensor(53970.3432, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53970.3432, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4457823634147644
current submit client idx and staleness is  8 2
distance 2 is tensor(53763.1133, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53763.1133, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18012423813343048
current submit client idx and staleness is  9 2
distance 2 is tensor(53756.9605, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53756.9605, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04694482684135437
current submit client idx and staleness is  10 2
distance 2 is tensor(53966.5121, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53966.5121, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14194747805595398
current submit client idx and staleness is  11 2
distance 2 is tensor(53968.8490, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53968.8490, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  1.326326847076416
current submit client idx and staleness is  12 2
distance 2 is tensor(53843.6598, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53843.6598, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.31184670329093933
current submit client idx and staleness is  13 2
distance 2 is tensor(54035.6743, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54035.6743, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3956448435783386
current submit client idx and staleness is  14 2
distance 2 is tensor(53938.4423, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53938.4423, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4281046390533447
current submit client idx and staleness is  15 2
distance 2 is tensor(54010.7307, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54010.7307, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5819820165634155
current submit client idx and staleness is  48 1
distance 2 is tensor(53773.6500, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53773.6500, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23831260204315186
current submit client idx and staleness is  49 1
distance 2 is tensor(53749.1780, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53749.1780, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14662770926952362
current submit client idx and staleness is  50 1
distance 2 is tensor(53996.7697, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53996.7697, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28179922699928284
current submit client idx and staleness is  51 1
distance 2 is tensor(53979.8893, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53979.8893, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6112691760063171
current submit client idx and staleness is  52 1
distance 2 is tensor(53949.9217, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53949.9217, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13038936257362366
current submit client idx and staleness is  53 1
distance 2 is tensor(53851.6603, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53851.6603, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.426910400390625
current submit client idx and staleness is  54 1
distance 2 is tensor(53963.5955, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53963.5955, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7962223291397095
current submit client idx and staleness is  55 1
distance 2 is tensor(53777.5091, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53777.5091, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2591385841369629
current submit client idx and staleness is  56 1
distance 2 is tensor(54020.3416, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54020.3416, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20129232108592987
current submit client idx and staleness is  57 1
distance 2 is tensor(53759.5833, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53759.5833, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.007354149129241705
current submit client idx and staleness is  58 1
distance 2 is tensor(53977.5616, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53977.5616, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5056322813034058
current submit client idx and staleness is  59 1
distance 2 is tensor(53835.1064, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53835.1064, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05790628120303154
benign_acc is 0.9500000005
benign_loss is 0.040772948414087296
benign_entropy is 0.05152163654565811
sync_acc is 0.9500000005
sync_loss is 0.09887255728244781
sync_entropy is 0.02938702516257763
curent length is  20
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 75.38% 

Test Accuracy: 74.80% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53746.8861, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53746.8861, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10216120630502701
current submit client idx and staleness is  1 1
distance 2 is tensor(53878.2097, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53878.2097, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19653117656707764
current submit client idx and staleness is  2 1
distance 2 is tensor(53944.2511, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53944.2511, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32588571310043335
current submit client idx and staleness is  3 1
distance 2 is tensor(53915.4880, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53915.4880, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32772424817085266
current submit client idx and staleness is  4 1
distance 2 is tensor(53972.9180, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53972.9180, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4590235650539398
current submit client idx and staleness is  5 1
distance 2 is tensor(53991.4320, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53991.4320, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.27549824118614197
current submit client idx and staleness is  6 1
distance 2 is tensor(53751.5061, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53751.5061, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06836605072021484
current submit client idx and staleness is  7 1
distance 2 is tensor(53923.9124, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53923.9124, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6060647964477539
current submit client idx and staleness is  16 3
distance 2 is tensor(53985.2005, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53985.2005, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18226176500320435
current submit client idx and staleness is  17 3
distance 2 is tensor(53964.2910, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53964.2910, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2400246113538742
current submit client idx and staleness is  18 3
distance 2 is tensor(53967.9647, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53967.9647, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36851993203163147
current submit client idx and staleness is  19 3
distance 2 is tensor(53982.6192, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.6192, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.31179484724998474
current submit client idx and staleness is  20 3
distance 2 is tensor(53960.5695, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53960.5695, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7536183595657349
current submit client idx and staleness is  21 3
distance 2 is tensor(54050.3995, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54050.3995, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1813460737466812
current submit client idx and staleness is  22 3
distance 2 is tensor(53982.8116, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.8116, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1177070364356041
current submit client idx and staleness is  23 3
distance 2 is tensor(53987.2857, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53987.2857, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3150475025177002
current submit client idx and staleness is  48 1
distance 2 is tensor(54047.8536, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54047.8536, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5624557733535767
current submit client idx and staleness is  49 1
distance 2 is tensor(53740.1424, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53740.1424, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03472825512290001
current submit client idx and staleness is  50 1
distance 2 is tensor(53994.3500, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53994.3500, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6586000323295593
current submit client idx and staleness is  51 1
distance 2 is tensor(53727.9580, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53727.9580, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16291537880897522
current submit client idx and staleness is  52 1
distance 2 is tensor(53777.1244, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53777.1244, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6832543015480042
current submit client idx and staleness is  53 1
distance 2 is tensor(53981.2377, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53981.2377, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17871388792991638
current submit client idx and staleness is  54 1
distance 2 is tensor(53780.0966, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53780.0966, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07031869888305664
current submit client idx and staleness is  55 1
distance 2 is tensor(53746.2406, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53746.2406, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23772278428077698
current submit client idx and staleness is  56 1
distance 2 is tensor(53732.8766, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53732.8766, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17420020699501038
current submit client idx and staleness is  57 1
distance 2 is tensor(53759.6481, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53759.6481, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19341221451759338
current submit client idx and staleness is  58 1
distance 2 is tensor(53772.9399, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53772.9399, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09975919872522354
current submit client idx and staleness is  59 1
distance 2 is tensor(53734.8630, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53734.8630, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01832175813615322
benign_acc is 0.9500000005
benign_loss is 0.08655601739883423
benign_entropy is 0.06264816224575043
sync_acc is 0.9500000005
sync_loss is 0.10937738418579102
sync_entropy is 0.023448461666703224
curent length is  20
the length of epoch_weights is  2
alpha 1 is [0, 2]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 75.57% 

Test Accuracy: 75.16% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53863.3419, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53863.3419, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15056535601615906
current submit client idx and staleness is  1 1
distance 2 is tensor(53772.5098, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53772.5098, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12267252057790756
current submit client idx and staleness is  2 1
distance 2 is tensor(53843.3311, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53843.3311, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07671549916267395
current submit client idx and staleness is  3 1
distance 2 is tensor(53757.6647, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53757.6647, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05443090200424194
current submit client idx and staleness is  4 1
distance 2 is tensor(54020.8072, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54020.8072, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09568415582180023
current submit client idx and staleness is  5 1
distance 2 is tensor(53894.9726, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53894.9726, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6813496351242065
current submit client idx and staleness is  6 1
distance 2 is tensor(54059.6525, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54059.6525, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7665776014328003
current submit client idx and staleness is  7 1
distance 2 is tensor(53748.1138, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53748.1138, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.012427580542862415
current submit client idx and staleness is  8 2
distance 2 is tensor(53948.6013, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53948.6013, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6153782606124878
current submit client idx and staleness is  9 2
distance 2 is tensor(53979.7192, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53979.7192, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5916399955749512
current submit client idx and staleness is  10 2
distance 2 is tensor(53748.0989, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53748.0989, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.044271331280469894
current submit client idx and staleness is  11 2
distance 2 is tensor(53969.5169, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53969.5169, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8253768086433411
current submit client idx and staleness is  12 2
distance 2 is tensor(53893.0235, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53893.0235, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24380163848400116
current submit client idx and staleness is  13 2
distance 2 is tensor(53956.2823, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53956.2823, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.501101016998291
current submit client idx and staleness is  14 2
distance 2 is tensor(54002.6692, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54002.6692, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7741137742996216
current submit client idx and staleness is  15 2
distance 2 is tensor(53977.6178, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53977.6178, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1521138846874237
current submit client idx and staleness is  24 4
distance 2 is tensor(53950.7285, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53950.7285, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0644155815243721
current submit client idx and staleness is  25 4
distance 2 is tensor(53947.3639, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53947.3639, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.34881117939949036
current submit client idx and staleness is  26 4
distance 2 is tensor(53964.9262, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53964.9262, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07018140703439713
current submit client idx and staleness is  27 4
distance 2 is tensor(53948.3563, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53948.3563, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.45847225189208984
current submit client idx and staleness is  28 4
distance 2 is tensor(53960.8762, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53960.8762, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.73964923620224
current submit client idx and staleness is  29 4
distance 2 is tensor(53976.4918, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53976.4918, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3585944175720215
current submit client idx and staleness is  30 4
distance 2 is tensor(53949.9242, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53949.9242, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.48555439710617065
current submit client idx and staleness is  31 4
distance 2 is tensor(53993.9204, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53993.9204, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.052735019475221634
current submit client idx and staleness is  48 1
distance 2 is tensor(53779.6724, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53779.6724, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15439820289611816
current submit client idx and staleness is  49 1
distance 2 is tensor(53827.6528, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53827.6528, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12652137875556946
current submit client idx and staleness is  50 1
distance 2 is tensor(53943.2524, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53943.2524, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5027098059654236
current submit client idx and staleness is  51 1
distance 2 is tensor(53982.0459, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.0459, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.44242915511131287
current submit client idx and staleness is  52 1
distance 2 is tensor(53973.8929, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53973.8929, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7003821134567261
current submit client idx and staleness is  53 1
distance 2 is tensor(53732.2758, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53732.2758, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.020846394822001457
current submit client idx and staleness is  54 1
distance 2 is tensor(53753.9636, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53753.9636, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2515323758125305
current submit client idx and staleness is  55 1
distance 2 is tensor(53742.7247, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53742.7247, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35163402557373047
current submit client idx and staleness is  56 1
distance 2 is tensor(53990.6942, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53990.6942, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2017909735441208
current submit client idx and staleness is  57 1
distance 2 is tensor(53739.5255, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53739.5255, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19110366702079773
current submit client idx and staleness is  58 1
distance 2 is tensor(53942.5755, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53942.5755, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6978756189346313
current submit client idx and staleness is  59 1
distance 2 is tensor(53970.3187, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53970.3187, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3001730144023895
benign_acc is 0.9500000005
benign_loss is 0.18782292306423187
benign_entropy is 0.022768396884202957
benign_acc is 0.9500000005
benign_loss is 0.1396367847919464
benign_entropy is 0.025561193004250526
sync_acc is 0.9500000005
sync_loss is 0.12616941332817078
sync_entropy is 0.019803574308753014
curent length is  20
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 75.64% 

Test Accuracy: 74.99% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(54031.5233, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54031.5233, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8049370646476746
current submit client idx and staleness is  1 1
distance 2 is tensor(53981.1363, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53981.1363, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.41682904958724976
current submit client idx and staleness is  2 1
distance 2 is tensor(53733.5587, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53733.5587, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1100514680147171
current submit client idx and staleness is  3 1
distance 2 is tensor(53773.4796, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53773.4796, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1790248602628708
current submit client idx and staleness is  4 1
distance 2 is tensor(53704.8332, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53704.8332, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1271868795156479
current submit client idx and staleness is  5 1
distance 2 is tensor(53796.5481, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53796.5481, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.040965545922517776
current submit client idx and staleness is  6 1
distance 2 is tensor(54070.5253, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54070.5253, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4530365467071533
current submit client idx and staleness is  7 1
distance 2 is tensor(53764.9697, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53764.9697, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.021906569600105286
current submit client idx and staleness is  32 5
distance 2 is tensor(54034.1938, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54034.1938, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2614104151725769
current submit client idx and staleness is  33 5
distance 2 is tensor(53982.2511, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.2511, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.40723928809165955
current submit client idx and staleness is  34 5
distance 2 is tensor(54062.9549, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54062.9549, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35498014092445374
current submit client idx and staleness is  35 5
distance 2 is tensor(54018.0468, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54018.0468, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2718597650527954
current submit client idx and staleness is  36 5
distance 2 is tensor(53952.9920, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53952.9920, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.47128385305404663
current submit client idx and staleness is  37 5
distance 2 is tensor(53975.5070, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53975.5070, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36332663893699646
current submit client idx and staleness is  38 5
distance 2 is tensor(53927.7877, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53927.7877, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.031187132000923157
current submit client idx and staleness is  39 5
distance 2 is tensor(53971.6314, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53971.6314, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4243989586830139
current submit client idx and staleness is  48 1
distance 2 is tensor(53869.0510, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53869.0510, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.41402721405029297
current submit client idx and staleness is  49 1
distance 2 is tensor(53739.8265, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53739.8265, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09676770120859146
current submit client idx and staleness is  50 1
distance 2 is tensor(53734.3969, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53734.3969, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07608700543642044
current submit client idx and staleness is  51 1
distance 2 is tensor(53978.0350, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53978.0350, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3580903112888336
current submit client idx and staleness is  52 1
distance 2 is tensor(53868.5603, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53868.5603, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8752925992012024
current submit client idx and staleness is  53 1
distance 2 is tensor(53706.3810, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53706.3810, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07015831768512726
current submit client idx and staleness is  54 1
distance 2 is tensor(54016.1187, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54016.1187, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.515945553779602
current submit client idx and staleness is  55 1
distance 2 is tensor(53735.4496, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53735.4496, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17664089798927307
current submit client idx and staleness is  56 1
distance 2 is tensor(53750.4448, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53750.4448, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.27122852206230164
current submit client idx and staleness is  57 1
distance 2 is tensor(53840.1266, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53840.1266, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026537086814641953
current submit client idx and staleness is  58 1
distance 2 is tensor(53748.3996, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53748.3996, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15808157622814178
current submit client idx and staleness is  59 1
distance 2 is tensor(53723.2464, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53723.2464, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1498991698026657
benign_acc is 0.9500000005
benign_loss is 0.11540838330984116
benign_entropy is 0.05091748759150505
sync_acc is 0.9500000005
sync_loss is 0.07959982752799988
sync_entropy is 0.03146083652973175
curent length is  20
the length of epoch_weights is  3
alpha 1 is [0, 3, 4]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 75.40% 

Test Accuracy: 75.22% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53892.8135, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53892.8135, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3966762125492096
current submit client idx and staleness is  1 1
distance 2 is tensor(53743.4169, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53743.4169, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026270514354109764
current submit client idx and staleness is  2 1
distance 2 is tensor(53997.1118, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53997.1118, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1328125
current submit client idx and staleness is  3 1
distance 2 is tensor(53939.1918, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53939.1918, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.00893067754805088
current submit client idx and staleness is  4 1
distance 2 is tensor(53743.9463, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53743.9463, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.27247563004493713
current submit client idx and staleness is  5 1
distance 2 is tensor(53794.5461, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53794.5461, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.259798526763916
current submit client idx and staleness is  6 1
distance 2 is tensor(53764.3619, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53764.3619, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.007522072643041611
current submit client idx and staleness is  7 1
distance 2 is tensor(53793.8028, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53793.8028, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28320205211639404
current submit client idx and staleness is  8 2
distance 2 is tensor(53967.7195, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53967.7195, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.38659030199050903
current submit client idx and staleness is  9 2
distance 2 is tensor(53789.5493, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53789.5493, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.023083264008164406
current submit client idx and staleness is  10 2
distance 2 is tensor(54046.8337, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54046.8337, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.42066603899002075
current submit client idx and staleness is  11 2
distance 2 is tensor(53997.8050, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53997.8050, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.47942620515823364
current submit client idx and staleness is  12 2
distance 2 is tensor(53787.0052, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53787.0052, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1571376472711563
current submit client idx and staleness is  13 2
distance 2 is tensor(53831.4116, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53831.4116, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1399412900209427
current submit client idx and staleness is  14 2
distance 2 is tensor(53914.5354, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53914.5354, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.9026851654052734
current submit client idx and staleness is  15 2
distance 2 is tensor(53777.4241, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53777.4241, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1538296490907669
current submit client idx and staleness is  16 3
distance 2 is tensor(53989.0364, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53989.0364, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6034725308418274
current submit client idx and staleness is  17 3
distance 2 is tensor(53956.2250, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53956.2250, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8474284410476685
current submit client idx and staleness is  18 3
distance 2 is tensor(53990.9927, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53990.9927, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.40728840231895447
current submit client idx and staleness is  19 3
distance 2 is tensor(54005.4085, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54005.4085, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20435133576393127
current submit client idx and staleness is  20 3
distance 2 is tensor(54004.7028, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54004.7028, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6906423568725586
current submit client idx and staleness is  21 3
distance 2 is tensor(53936.1965, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53936.1965, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.48069220781326294
current submit client idx and staleness is  22 3
distance 2 is tensor(53952.2784, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53952.2784, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28646570444107056
current submit client idx and staleness is  23 3
distance 2 is tensor(53971.9027, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53971.9027, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2780109643936157
current submit client idx and staleness is  40 6
distance 2 is tensor(53965.5044, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53965.5044, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3517245352268219
current submit client idx and staleness is  41 6
distance 2 is tensor(53914.2580, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53914.2580, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2021934986114502
current submit client idx and staleness is  42 6
distance 2 is tensor(53957.1739, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53957.1739, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18133245408535004
current submit client idx and staleness is  43 6
distance 2 is tensor(53959.1107, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53959.1107, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5055879950523376
current submit client idx and staleness is  44 6
distance 2 is tensor(53972.1855, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53972.1855, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6388324499130249
current submit client idx and staleness is  45 6
distance 2 is tensor(53934.1671, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53934.1671, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.41346216201782227
current submit client idx and staleness is  46 6
distance 2 is tensor(53960.7305, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53960.7305, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08263114094734192
current submit client idx and staleness is  47 6
distance 2 is tensor(54004.0262, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54004.0262, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3926616311073303
current submit client idx and staleness is  48 1
distance 2 is tensor(53815.7346, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53815.7346, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20865941047668457
current submit client idx and staleness is  49 1
distance 2 is tensor(53766.5350, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53766.5350, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04013378918170929
current submit client idx and staleness is  50 1
distance 2 is tensor(53882.9658, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53882.9658, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1554144024848938
current submit client idx and staleness is  51 1
distance 2 is tensor(53756.2840, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53756.2840, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21046006679534912
current submit client idx and staleness is  52 1
distance 2 is tensor(53935.5111, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53935.5111, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5124279260635376
current submit client idx and staleness is  53 1
distance 2 is tensor(53774.7805, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53774.7805, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04516041278839111
current submit client idx and staleness is  54 1
distance 2 is tensor(53758.4763, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53758.4763, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1882895529270172
current submit client idx and staleness is  55 1
distance 2 is tensor(53786.5446, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53786.5446, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12008605152368546
current submit client idx and staleness is  56 1
distance 2 is tensor(53945.2413, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53945.2413, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2990860342979431
current submit client idx and staleness is  57 1
distance 2 is tensor(53756.9058, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53756.9058, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.004010386299341917
current submit client idx and staleness is  58 1
distance 2 is tensor(53777.0231, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53777.0231, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17084519565105438
current submit client idx and staleness is  59 1
distance 2 is tensor(54013.4228, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54013.4228, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2040373831987381
benign_acc is 0.9500000005
benign_loss is 0.1547599732875824
benign_entropy is 0.015616863034665585
benign_acc is 0.9500000005
benign_loss is 0.29398709535598755
benign_entropy is 0.02261253446340561
benign_acc is 0.9500000005
benign_loss is 0.11523817479610443
benign_entropy is 0.04620858654379845
sync_acc is 1.0000000005
sync_loss is 0.021885337308049202
sync_entropy is 0.03611699119210243
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 75.19% 

Test Accuracy: 74.98% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(54080.7906, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54080.7906, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1880134493112564
current submit client idx and staleness is  1 1
distance 2 is tensor(53722.0986, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53722.0986, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.044892482459545135
current submit client idx and staleness is  2 1
distance 2 is tensor(53702.7319, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.7319, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.054188329726457596
current submit client idx and staleness is  3 1
distance 2 is tensor(53693.0161, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.0161, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.049953557550907135
current submit client idx and staleness is  4 1
distance 2 is tensor(54030.4103, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54030.4103, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5112437009811401
current submit client idx and staleness is  5 1
distance 2 is tensor(54079.2107, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54079.2107, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6385775208473206
current submit client idx and staleness is  6 1
distance 2 is tensor(53946.1226, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53946.1226, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0456211119890213
current submit client idx and staleness is  7 1
distance 2 is tensor(53923.2366, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53923.2366, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3225451409816742
current submit client idx and staleness is  48 1
distance 2 is tensor(53939.0895, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53939.0895, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.25127753615379333
current submit client idx and staleness is  49 1
distance 2 is tensor(54013.9799, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54013.9799, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3457070589065552
current submit client idx and staleness is  50 1
distance 2 is tensor(53708.1561, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.1561, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0155868511646986
current submit client idx and staleness is  51 1
distance 2 is tensor(53710.6999, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53710.6999, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11434018611907959
current submit client idx and staleness is  52 1
distance 2 is tensor(54011.3864, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54011.3864, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8314521908760071
current submit client idx and staleness is  53 1
distance 2 is tensor(53718.5150, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53718.5150, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.011982728727161884
current submit client idx and staleness is  54 1
distance 2 is tensor(53983.6661, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53983.6661, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6310479044914246
current submit client idx and staleness is  55 1
distance 2 is tensor(53992.7003, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53992.7003, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7062755823135376
current submit client idx and staleness is  56 1
distance 2 is tensor(53732.8912, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53732.8912, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2679889500141144
current submit client idx and staleness is  57 1
distance 2 is tensor(53933.8593, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53933.8593, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14163561165332794
current submit client idx and staleness is  58 1
distance 2 is tensor(54003.5085, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54003.5085, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.29762667417526245
current submit client idx and staleness is  59 1
distance 2 is tensor(53690.3448, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.3448, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01584763452410698
sync_acc is 0.9500000005
sync_loss is 0.06150592491030693
sync_entropy is 0.0356762520968914
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [4, 6]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 75.41% 

Test Accuracy: 75.14% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53701.2972, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53701.2972, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13808535039424896
current submit client idx and staleness is  1 1
distance 2 is tensor(53720.6079, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53720.6079, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.016638604924082756
current submit client idx and staleness is  2 1
distance 2 is tensor(53729.8614, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53729.8614, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03346649929881096
current submit client idx and staleness is  3 1
distance 2 is tensor(53693.7543, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.7543, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08243197202682495
current submit client idx and staleness is  4 1
distance 2 is tensor(53913.5166, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53913.5166, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5692828297615051
current submit client idx and staleness is  5 1
distance 2 is tensor(53936.3998, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53936.3998, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.44961339235305786
current submit client idx and staleness is  6 1
distance 2 is tensor(54025.0204, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54025.0204, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5247300267219543
current submit client idx and staleness is  7 1
distance 2 is tensor(53869.0851, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53869.0851, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23540043830871582
current submit client idx and staleness is  8 2
distance 2 is tensor(53825.2907, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53825.2907, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4428575038909912
current submit client idx and staleness is  9 2
distance 2 is tensor(53736.0642, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53736.0642, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05436324328184128
current submit client idx and staleness is  10 2
distance 2 is tensor(54023.1237, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54023.1237, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.40734028816223145
current submit client idx and staleness is  11 2
distance 2 is tensor(54046.2870, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54046.2870, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.41451096534729004
current submit client idx and staleness is  12 2
distance 2 is tensor(53953.1876, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53953.1876, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.46244531869888306
current submit client idx and staleness is  13 2
distance 2 is tensor(53754.1246, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53754.1246, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18238528072834015
current submit client idx and staleness is  14 2
distance 2 is tensor(54089.6580, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54089.6580, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5135456323623657
current submit client idx and staleness is  15 2
distance 2 is tensor(53852.9601, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53852.9601, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.38619348406791687
current submit client idx and staleness is  24 4
distance 2 is tensor(53978.3923, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53978.3923, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1736135184764862
current submit client idx and staleness is  25 4
distance 2 is tensor(54002.7164, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54002.7164, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.26896873116493225
current submit client idx and staleness is  26 4
distance 2 is tensor(54010.3395, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54010.3395, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2649914622306824
current submit client idx and staleness is  27 4
distance 2 is tensor(53992.4882, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53992.4882, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3147011697292328
current submit client idx and staleness is  28 4
distance 2 is tensor(53995.5661, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53995.5661, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.41955775022506714
current submit client idx and staleness is  29 4
distance 2 is tensor(53992.7866, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53992.7866, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3654092252254486
current submit client idx and staleness is  30 4
distance 2 is tensor(53970.5341, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53970.5341, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5619639158248901
current submit client idx and staleness is  31 4
distance 2 is tensor(54047.4510, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54047.4510, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14799764752388
current submit client idx and staleness is  48 1
distance 2 is tensor(54002.3087, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54002.3087, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22938552498817444
current submit client idx and staleness is  49 1
distance 2 is tensor(53815.9933, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53815.9933, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.029644180089235306
current submit client idx and staleness is  50 1
distance 2 is tensor(54041.1096, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54041.1096, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.43262118101119995
current submit client idx and staleness is  51 1
distance 2 is tensor(53775.2168, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53775.2168, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3248474895954132
current submit client idx and staleness is  52 1
distance 2 is tensor(53930.3108, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53930.3108, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.45570096373558044
current submit client idx and staleness is  53 1
distance 2 is tensor(53708.2982, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.2982, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05266793444752693
current submit client idx and staleness is  54 1
distance 2 is tensor(53943.2239, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53943.2239, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4689674377441406
current submit client idx and staleness is  55 1
distance 2 is tensor(54009.2850, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54009.2850, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5671592354774475
current submit client idx and staleness is  56 1
distance 2 is tensor(54074.9549, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54074.9549, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12191826105117798
current submit client idx and staleness is  57 1
distance 2 is tensor(54037.6254, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54037.6254, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24623560905456543
current submit client idx and staleness is  58 1
distance 2 is tensor(53899.8440, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53899.8440, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2982953190803528
current submit client idx and staleness is  59 1
distance 2 is tensor(54078.2935, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54078.2935, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.33822840452194214
benign_acc is 0.9500000005
benign_loss is 0.19959014654159546
benign_entropy is 0.015058264136314392
benign_acc is 0.9500000005
benign_loss is 0.17569191753864288
benign_entropy is 0.018676452338695526
sync_acc is 0.9500000005
sync_loss is 0.14849868416786194
sync_entropy is 0.01595880091190338
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [6]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 75.18% 

Test Accuracy: 75.08% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53956.7319, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53956.7319, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1976175159215927
current submit client idx and staleness is  1 1
distance 2 is tensor(53911.7426, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53911.7426, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2087295949459076
current submit client idx and staleness is  2 1
distance 2 is tensor(53905.4432, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53905.4432, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026943763718008995
current submit client idx and staleness is  3 1
distance 2 is tensor(53754.2015, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53754.2015, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20184525847434998
current submit client idx and staleness is  4 1
distance 2 is tensor(53760.3012, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53760.3012, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.39966097474098206
current submit client idx and staleness is  5 1
distance 2 is tensor(53847.8599, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53847.8599, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2611791789531708
current submit client idx and staleness is  6 1
distance 2 is tensor(53725.7607, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53725.7607, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15777724981307983
current submit client idx and staleness is  7 1
distance 2 is tensor(53882.8691, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53882.8691, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.37271612882614136
current submit client idx and staleness is  16 3
distance 2 is tensor(53935.7084, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53935.7084, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.320686012506485
current submit client idx and staleness is  17 3
distance 2 is tensor(53970.7679, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53970.7679, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4677315652370453
current submit client idx and staleness is  18 3
distance 2 is tensor(53974.8193, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53974.8193, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4216391444206238
current submit client idx and staleness is  19 3
distance 2 is tensor(53944.0277, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53944.0277, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7698972821235657
current submit client idx and staleness is  20 3
distance 2 is tensor(53955.0698, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53955.0698, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7979095578193665
current submit client idx and staleness is  21 3
distance 2 is tensor(53946.6955, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53946.6955, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.000460360519355163
current submit client idx and staleness is  22 3
distance 2 is tensor(53965.6842, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53965.6842, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2561575472354889
current submit client idx and staleness is  23 3
distance 2 is tensor(54018.2959, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54018.2959, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.46933284401893616
current submit client idx and staleness is  48 1
distance 2 is tensor(53774.6370, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53774.6370, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16980929672718048
current submit client idx and staleness is  49 1
distance 2 is tensor(53995.2875, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53995.2875, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.31878742575645447
current submit client idx and staleness is  50 1
distance 2 is tensor(53748.9332, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53748.9332, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16335931420326233
current submit client idx and staleness is  51 1
distance 2 is tensor(53752.2039, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53752.2039, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18633224070072174
current submit client idx and staleness is  52 1
distance 2 is tensor(53991.7369, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53991.7369, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3492167592048645
current submit client idx and staleness is  53 1
distance 2 is tensor(53728.5097, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53728.5097, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12218229472637177
current submit client idx and staleness is  54 1
distance 2 is tensor(53788.5122, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53788.5122, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1013360396027565
current submit client idx and staleness is  55 1
distance 2 is tensor(53744.0451, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53744.0451, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13499592244625092
current submit client idx and staleness is  56 1
distance 2 is tensor(53735.8381, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53735.8381, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3154122233390808
current submit client idx and staleness is  57 1
distance 2 is tensor(53846.8696, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53846.8696, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.017986124381422997
current submit client idx and staleness is  58 1
distance 2 is tensor(53794.3620, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53794.3620, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.055295366793870926
current submit client idx and staleness is  59 1
distance 2 is tensor(53727.5324, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53727.5324, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2652379870414734
benign_acc is 1.0000000005
benign_loss is 0.0010132694151252508
benign_entropy is 0.006230969913303852
sync_acc is 0.9500000005
sync_loss is 0.0696878582239151
sync_entropy is 0.032942015677690506
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [5, 8]
alphas 3 is [1.  0.2 0.5]
alphas is  [0.58823529 0.11764706 0.29411765]
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 75.38% 

Test Accuracy: 75.07% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53718.5481, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53718.5481, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12879011034965515
current submit client idx and staleness is  1 1
distance 2 is tensor(53990.8054, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53990.8054, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.39323991537094116
current submit client idx and staleness is  2 1
distance 2 is tensor(53729.6904, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53729.6904, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.25571778416633606
current submit client idx and staleness is  3 1
distance 2 is tensor(53757.6395, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53757.6395, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.030137255787849426
current submit client idx and staleness is  4 1
distance 2 is tensor(53807.2100, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53807.2100, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.47796496748924255
current submit client idx and staleness is  5 1
distance 2 is tensor(53739.9670, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53739.9670, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1158619299530983
current submit client idx and staleness is  6 1
distance 2 is tensor(53714.7366, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53714.7366, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06028451398015022
current submit client idx and staleness is  7 1
distance 2 is tensor(53829.2231, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53829.2231, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3008318841457367
current submit client idx and staleness is  8 2
distance 2 is tensor(53842.5523, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53842.5523, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1584012806415558
current submit client idx and staleness is  9 2
distance 2 is tensor(53969.9270, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53969.9270, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09487736970186234
current submit client idx and staleness is  10 2
distance 2 is tensor(53952.3719, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53952.3719, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8223926424980164
current submit client idx and staleness is  11 2
distance 2 is tensor(53916.4422, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53916.4422, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35435202717781067
current submit client idx and staleness is  12 2
distance 2 is tensor(53897.9290, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53897.9290, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6376808285713196
current submit client idx and staleness is  13 2
distance 2 is tensor(53981.6294, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53981.6294, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2547299861907959
current submit client idx and staleness is  14 2
distance 2 is tensor(53795.3677, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53795.3677, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3386780023574829
current submit client idx and staleness is  15 2
distance 2 is tensor(54009.9985, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54009.9985, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2546616196632385
current submit client idx and staleness is  32 5
distance 2 is tensor(53953.2925, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53953.2925, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.34158453345298767
current submit client idx and staleness is  33 5
distance 2 is tensor(53982.7246, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.7246, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.402052104473114
current submit client idx and staleness is  34 5
distance 2 is tensor(53988.7668, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53988.7668, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5136240124702454
current submit client idx and staleness is  35 5
distance 2 is tensor(53962.4795, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53962.4795, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4452721178531647
current submit client idx and staleness is  36 5
distance 2 is tensor(53957.3135, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53957.3135, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.37342408299446106
current submit client idx and staleness is  37 5
distance 2 is tensor(53997.2027, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53997.2027, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.9359796643257141
current submit client idx and staleness is  38 5
distance 2 is tensor(53936.5453, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53936.5453, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06044043228030205
current submit client idx and staleness is  39 5
distance 2 is tensor(53980.0769, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53980.0769, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.31707149744033813
current submit client idx and staleness is  48 1
distance 2 is tensor(53757.0497, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53757.0497, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12456642091274261
current submit client idx and staleness is  49 1
distance 2 is tensor(53757.3554, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53757.3554, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2630122900009155
current submit client idx and staleness is  50 1
distance 2 is tensor(53716.2535, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53716.2535, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11919655650854111
current submit client idx and staleness is  51 1
distance 2 is tensor(53941.3783, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53941.3783, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.44079408049583435
current submit client idx and staleness is  52 1
distance 2 is tensor(53715.5020, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53715.5020, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2613620460033417
current submit client idx and staleness is  53 1
distance 2 is tensor(53813.5938, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53813.5938, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.016393136233091354
current submit client idx and staleness is  54 1
distance 2 is tensor(53798.3515, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53798.3515, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09940193593502045
current submit client idx and staleness is  55 1
distance 2 is tensor(53925.7891, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53925.7891, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4010777473449707
current submit client idx and staleness is  56 1
distance 2 is tensor(53852.9631, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53852.9631, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4728412628173828
current submit client idx and staleness is  57 1
distance 2 is tensor(53695.1680, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53695.1680, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1272260844707489
current submit client idx and staleness is  58 1
distance 2 is tensor(53757.0719, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53757.0719, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10019688308238983
current submit client idx and staleness is  59 1
distance 2 is tensor(54013.3971, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54013.3971, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8297221064567566
benign_acc is 0.9500000005
benign_loss is 0.09267942607402802
benign_entropy is 0.0682734027504921
benign_acc is 0.9500000005
benign_loss is 0.21024863421916962
benign_entropy is 0.03581990674138069
sync_acc is 0.9500000005
sync_loss is 0.11497825384140015
sync_entropy is 0.021966172382235527
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 75.58% 

Test Accuracy: 74.94% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53695.8385, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53695.8385, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20631344616413116
current submit client idx and staleness is  1 1
distance 2 is tensor(53669.7174, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53669.7174, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10397256910800934
current submit client idx and staleness is  2 1
distance 2 is tensor(53673.8706, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.8706, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.106148362159729
current submit client idx and staleness is  3 1
distance 2 is tensor(53696.9018, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53696.9018, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15983116626739502
current submit client idx and staleness is  4 1
distance 2 is tensor(53754.2801, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53754.2801, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04878135770559311
current submit client idx and staleness is  5 1
distance 2 is tensor(54019.2323, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54019.2323, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7017143368721008
current submit client idx and staleness is  6 1
distance 2 is tensor(53694.8367, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.8367, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0749904215335846
current submit client idx and staleness is  7 1
distance 2 is tensor(53929.4473, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53929.4473, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4094964861869812
current submit client idx and staleness is  48 1
distance 2 is tensor(54068.8538, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54068.8538, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.764417290687561
current submit client idx and staleness is  49 1
distance 2 is tensor(54137.4738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54137.4738, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5712842345237732
current submit client idx and staleness is  50 1
distance 2 is tensor(53710.9743, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53710.9743, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2211267501115799
current submit client idx and staleness is  51 1
distance 2 is tensor(53978.0819, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53978.0819, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.47012871503829956
current submit client idx and staleness is  52 1
distance 2 is tensor(53792.3252, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53792.3252, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.337128221988678
current submit client idx and staleness is  53 1
distance 2 is tensor(53687.5177, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.5177, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.038808174431324005
current submit client idx and staleness is  54 1
distance 2 is tensor(53703.9909, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53703.9909, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.304532527923584
current submit client idx and staleness is  55 1
distance 2 is tensor(54055.9356, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54055.9356, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2089996337890625
current submit client idx and staleness is  56 1
distance 2 is tensor(53954.8363, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53954.8363, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2770063281059265
current submit client idx and staleness is  57 1
distance 2 is tensor(53674.9830, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53674.9830, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20487424731254578
current submit client idx and staleness is  58 1
distance 2 is tensor(53691.5711, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.5711, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22254042327404022
current submit client idx and staleness is  59 1
distance 2 is tensor(53919.1981, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53919.1981, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19289857149124146
sync_acc is 0.9500000005
sync_loss is 0.13654658198356628
sync_entropy is 0.023159867152571678
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [6, 8, 9, 10]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 75.48% 

Test Accuracy: 75.16% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53743.7707, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53743.7707, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.26109009981155396
current submit client idx and staleness is  1 1
distance 2 is tensor(53794.6853, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53794.6853, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04150443151593208
current submit client idx and staleness is  2 1
distance 2 is tensor(53807.9307, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53807.9307, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3648565411567688
current submit client idx and staleness is  3 1
distance 2 is tensor(53791.5489, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53791.5489, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.006914302706718445
current submit client idx and staleness is  4 1
distance 2 is tensor(53745.5466, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53745.5466, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.033298857510089874
current submit client idx and staleness is  5 1
distance 2 is tensor(53849.0919, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53849.0919, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6417992115020752
current submit client idx and staleness is  6 1
distance 2 is tensor(54009.1976, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54009.1976, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4068792462348938
current submit client idx and staleness is  7 1
distance 2 is tensor(53852.0067, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53852.0067, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1706611067056656
current submit client idx and staleness is  8 2
distance 2 is tensor(53805.1962, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53805.1962, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.049877457320690155
current submit client idx and staleness is  9 2
distance 2 is tensor(53757.7958, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53757.7958, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.016813434660434723
current submit client idx and staleness is  10 2
distance 2 is tensor(53896.0367, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53896.0367, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1863587200641632
current submit client idx and staleness is  11 2
distance 2 is tensor(53928.3583, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53928.3583, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7508491277694702
current submit client idx and staleness is  12 2
distance 2 is tensor(53806.2359, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53806.2359, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7719392776489258
current submit client idx and staleness is  13 2
distance 2 is tensor(53868.7393, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53868.7393, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12479490041732788
current submit client idx and staleness is  14 2
distance 2 is tensor(53953.8128, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53953.8128, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8091330528259277
current submit client idx and staleness is  15 2
distance 2 is tensor(53866.4018, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53866.4018, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21001914143562317
current submit client idx and staleness is  16 3
distance 2 is tensor(53914.1131, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53914.1131, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20695385336875916
current submit client idx and staleness is  17 3
distance 2 is tensor(53953.5430, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53953.5430, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14826717972755432
current submit client idx and staleness is  18 3
distance 2 is tensor(53962.1544, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53962.1544, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14447768032550812
current submit client idx and staleness is  19 3
distance 2 is tensor(53941.7123, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53941.7123, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20745642483234406
current submit client idx and staleness is  20 3
distance 2 is tensor(53929.7304, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53929.7304, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36440545320510864
current submit client idx and staleness is  21 3
distance 2 is tensor(53739.2365, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53739.2365, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0839337557554245
current submit client idx and staleness is  22 3
distance 2 is tensor(53909.0155, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53909.0155, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11831583827733994
current submit client idx and staleness is  23 3
distance 2 is tensor(53962.6849, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53962.6849, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.25994765758514404
current submit client idx and staleness is  24 4
distance 2 is tensor(53933.8883, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53933.8883, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06103203445672989
current submit client idx and staleness is  25 4
distance 2 is tensor(53949.6895, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53949.6895, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13696597516536713
current submit client idx and staleness is  26 4
distance 2 is tensor(53951.8619, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53951.8619, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5230356454849243
current submit client idx and staleness is  27 4
distance 2 is tensor(53964.8863, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53964.8863, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5302096605300903
current submit client idx and staleness is  28 4
distance 2 is tensor(53927.5201, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53927.5201, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.44407281279563904
current submit client idx and staleness is  29 4
distance 2 is tensor(53945.8662, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53945.8662, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18912942707538605
current submit client idx and staleness is  30 4
distance 2 is tensor(53954.4385, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53954.4385, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32648706436157227
current submit client idx and staleness is  31 4
distance 2 is tensor(53903.2136, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53903.2136, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15001115202903748
current submit client idx and staleness is  40 6
distance 2 is tensor(53942.4835, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53942.4835, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.27013683319091797
current submit client idx and staleness is  41 6
distance 2 is tensor(53933.1760, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53933.1760, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.033597394824028015
current submit client idx and staleness is  42 6
distance 2 is tensor(53942.1984, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53942.1984, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28163212537765503
current submit client idx and staleness is  43 6
distance 2 is tensor(53928.6081, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53928.6081, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5382745862007141
current submit client idx and staleness is  44 6
distance 2 is tensor(53961.7159, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53961.7159, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5162553191184998
current submit client idx and staleness is  45 6
distance 2 is tensor(53980.2964, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53980.2964, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18333132565021515
current submit client idx and staleness is  46 6
distance 2 is tensor(53972.5528, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53972.5528, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.48200860619544983
current submit client idx and staleness is  47 6
distance 2 is tensor(53938.2669, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53938.2669, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.25068357586860657
current submit client idx and staleness is  48 1
distance 2 is tensor(53947.9596, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53947.9596, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5159890055656433
current submit client idx and staleness is  49 1
distance 2 is tensor(53770.5893, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53770.5893, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.015469498932361603
current submit client idx and staleness is  50 1
distance 2 is tensor(53845.5468, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53845.5468, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24251437187194824
current submit client idx and staleness is  51 1
distance 2 is tensor(53791.8995, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53791.8995, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3386732041835785
current submit client idx and staleness is  52 1
distance 2 is tensor(53745.9214, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53745.9214, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09403669089078903
current submit client idx and staleness is  53 1
distance 2 is tensor(53771.8839, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53771.8839, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11075092852115631
current submit client idx and staleness is  54 1
distance 2 is tensor(54064.1371, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54064.1371, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3552377223968506
current submit client idx and staleness is  55 1
distance 2 is tensor(53929.8000, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53929.8000, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08551066368818283
current submit client idx and staleness is  56 1
distance 2 is tensor(53750.4687, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53750.4687, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04816107824444771
current submit client idx and staleness is  57 1
distance 2 is tensor(53751.4080, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53751.4080, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.009313886053860188
current submit client idx and staleness is  58 1
distance 2 is tensor(53808.9669, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53808.9669, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06621488183736801
current submit client idx and staleness is  59 1
distance 2 is tensor(53931.2698, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53931.2698, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20448783040046692
benign_acc is 0.9500000005
benign_loss is 0.08257358521223068
benign_entropy is 0.030109688639640808
benign_acc is 0.9500000005
benign_loss is 0.13022302091121674
benign_entropy is 0.023434225469827652
benign_acc is 0.9500000005
benign_loss is 0.1543063372373581
benign_entropy is 0.021280117332935333
benign_acc is 0.9500000005
benign_loss is 0.06698596477508545
benign_entropy is 0.06591180711984634
sync_acc is 0.9500000005
sync_loss is 0.042445290833711624
sync_entropy is 0.035716429352760315
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 75.86% 

Test Accuracy: 75.03% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53982.5519, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.5519, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.9656537771224976
current submit client idx and staleness is  1 1
distance 2 is tensor(53762.4422, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53762.4422, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0035538834054023027
current submit client idx and staleness is  2 1
distance 2 is tensor(53684.4547, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.4547, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10882465541362762
current submit client idx and staleness is  3 1
distance 2 is tensor(53689.2927, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.2927, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.052182722836732864
current submit client idx and staleness is  4 1
distance 2 is tensor(53843.6856, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53843.6856, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11173872649669647
current submit client idx and staleness is  5 1
distance 2 is tensor(53705.6840, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.6840, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1833726018667221
current submit client idx and staleness is  6 1
distance 2 is tensor(53680.5384, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.5384, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01544563751667738
current submit client idx and staleness is  7 1
distance 2 is tensor(53735.9911, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53735.9911, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0030690671410411596
current submit client idx and staleness is  48 1
distance 2 is tensor(53726.0476, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53726.0476, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05805487185716629
current submit client idx and staleness is  49 1
distance 2 is tensor(53965.4514, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53965.4514, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0438157320022583
current submit client idx and staleness is  50 1
distance 2 is tensor(53972.2070, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53972.2070, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22200259566307068
current submit client idx and staleness is  51 1
distance 2 is tensor(53728.5459, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53728.5459, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10432110726833344
current submit client idx and staleness is  52 1
distance 2 is tensor(53725.2477, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53725.2477, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17225827276706696
current submit client idx and staleness is  53 1
distance 2 is tensor(53728.3413, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53728.3413, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03904155641794205
current submit client idx and staleness is  54 1
distance 2 is tensor(53962.0478, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53962.0478, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6435533165931702
current submit client idx and staleness is  55 1
distance 2 is tensor(53678.0316, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.0316, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.027266427874565125
current submit client idx and staleness is  56 1
distance 2 is tensor(53755.3453, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53755.3453, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.032270483672618866
current submit client idx and staleness is  57 1
distance 2 is tensor(53680.0539, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.0539, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.022399181500077248
current submit client idx and staleness is  58 1
distance 2 is tensor(54022.7073, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54022.7073, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5882208943367004
current submit client idx and staleness is  59 1
distance 2 is tensor(53771.3582, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53771.3582, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2899705767631531
sync_acc is 1.0000000005
sync_loss is 0.018346674740314484
sync_entropy is 0.03244644030928612
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [12]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 75.59% 

Test Accuracy: 74.77% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53702.6287, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.6287, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05686487630009651
current submit client idx and staleness is  1 1
distance 2 is tensor(53676.5120, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.5120, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.006471361964941025
current submit client idx and staleness is  2 1
distance 2 is tensor(53837.7827, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53837.7827, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1262863427400589
current submit client idx and staleness is  3 1
distance 2 is tensor(54094.9045, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54094.9045, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5755345225334167
current submit client idx and staleness is  4 1
distance 2 is tensor(53703.0905, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53703.0905, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12910054624080658
current submit client idx and staleness is  5 1
distance 2 is tensor(53697.4610, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53697.4610, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17893853783607483
current submit client idx and staleness is  6 1
distance 2 is tensor(54051.5217, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54051.5217, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.053841374814510345
current submit client idx and staleness is  7 1
distance 2 is tensor(54100.7331, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54100.7331, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36529314517974854
current submit client idx and staleness is  8 2
distance 2 is tensor(53725.2211, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53725.2211, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3051329553127289
current submit client idx and staleness is  9 2
distance 2 is tensor(53730.2531, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53730.2531, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026817506179213524
current submit client idx and staleness is  10 2
distance 2 is tensor(53884.9141, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53884.9141, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19160082936286926
current submit client idx and staleness is  11 2
distance 2 is tensor(54091.2367, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54091.2367, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1989516168832779
current submit client idx and staleness is  12 2
distance 2 is tensor(54047.6557, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54047.6557, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  1.014303207397461
current submit client idx and staleness is  13 2
distance 2 is tensor(53873.2090, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53873.2090, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19648486375808716
current submit client idx and staleness is  14 2
distance 2 is tensor(54065.1382, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54065.1382, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  1.2763901948928833
current submit client idx and staleness is  15 2
distance 2 is tensor(53968.7827, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53968.7827, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3195880353450775
current submit client idx and staleness is  48 1
distance 2 is tensor(53890.0066, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53890.0066, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20935821533203125
current submit client idx and staleness is  49 1
distance 2 is tensor(53687.1683, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.1683, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02394327148795128
current submit client idx and staleness is  50 1
distance 2 is tensor(53752.6307, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53752.6307, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.029807422310113907
current submit client idx and staleness is  51 1
distance 2 is tensor(53721.1239, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53721.1239, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08266560733318329
current submit client idx and staleness is  52 1
distance 2 is tensor(54051.5797, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54051.5797, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24218964576721191
current submit client idx and staleness is  53 1
distance 2 is tensor(53805.5879, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53805.5879, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02257843315601349
current submit client idx and staleness is  54 1
distance 2 is tensor(54053.1444, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54053.1444, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7819986343383789
current submit client idx and staleness is  55 1
distance 2 is tensor(53688.2413, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53688.2413, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07033582031726837
current submit client idx and staleness is  56 1
distance 2 is tensor(53674.7299, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53674.7299, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07115107774734497
current submit client idx and staleness is  57 1
distance 2 is tensor(53906.3670, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53906.3670, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09022969007492065
current submit client idx and staleness is  58 1
distance 2 is tensor(54105.9127, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54105.9127, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5426054000854492
current submit client idx and staleness is  59 1
distance 2 is tensor(54018.8079, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54018.8079, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05300676077604294
benign_acc is 0.9500000005
benign_loss is 0.13395507633686066
benign_entropy is 0.029505828395485878
sync_acc is 0.9500000005
sync_loss is 0.05237281322479248
sync_entropy is 0.03480562940239906
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [10, 12]
alphas 3 is [1.         0.2        0.33333333]
alphas is  [0.65217391 0.13043478 0.2173913 ]
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 75.82% 

Test Accuracy: 75.37% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(54014.6961, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54014.6961, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13226567208766937
current submit client idx and staleness is  1 1
distance 2 is tensor(53932.8610, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53932.8610, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04860270395874977
current submit client idx and staleness is  2 1
distance 2 is tensor(53723.1800, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53723.1800, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0645189881324768
current submit client idx and staleness is  3 1
distance 2 is tensor(53757.4390, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53757.4390, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01804788038134575
current submit client idx and staleness is  4 1
distance 2 is tensor(53725.9299, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53725.9299, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.30105507373809814
current submit client idx and staleness is  5 1
distance 2 is tensor(53946.6828, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53946.6828, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3333154618740082
current submit client idx and staleness is  6 1
distance 2 is tensor(53699.3763, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53699.3763, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04899166151881218
current submit client idx and staleness is  7 1
distance 2 is tensor(53752.2093, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53752.2093, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.054392922669649124
current submit client idx and staleness is  16 3
distance 2 is tensor(54026.3865, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54026.3865, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6991683840751648
current submit client idx and staleness is  17 3
distance 2 is tensor(53954.0005, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53954.0005, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4591943323612213
current submit client idx and staleness is  18 3
distance 2 is tensor(53989.4752, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53989.4752, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16721388697624207
current submit client idx and staleness is  19 3
distance 2 is tensor(53996.9257, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53996.9257, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2349395751953125
current submit client idx and staleness is  20 3
distance 2 is tensor(53947.8133, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53947.8133, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7143948674201965
current submit client idx and staleness is  21 3
distance 2 is tensor(53811.9093, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53811.9093, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0020418500062078238
current submit client idx and staleness is  22 3
distance 2 is tensor(53976.0313, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53976.0313, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.48912692070007324
current submit client idx and staleness is  23 3
distance 2 is tensor(53984.0432, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53984.0432, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20165777206420898
current submit client idx and staleness is  32 5
distance 2 is tensor(53973.9568, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53973.9568, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2372933328151703
current submit client idx and staleness is  33 5
distance 2 is tensor(53941.8923, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53941.8923, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2272433042526245
current submit client idx and staleness is  34 5
distance 2 is tensor(53971.7156, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53971.7156, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2685748338699341
current submit client idx and staleness is  35 5
distance 2 is tensor(54003.9521, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54003.9521, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35440757870674133
current submit client idx and staleness is  36 5
distance 2 is tensor(53933.4175, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53933.4175, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5349481701850891
current submit client idx and staleness is  37 5
distance 2 is tensor(53950.1242, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53950.1242, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4110599458217621
current submit client idx and staleness is  38 5
distance 2 is tensor(53932.1411, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53932.1411, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2517237067222595
current submit client idx and staleness is  39 5
distance 2 is tensor(54001.6301, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54001.6301, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1644614189863205
current submit client idx and staleness is  48 1
distance 2 is tensor(53749.8851, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53749.8851, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08093941956758499
current submit client idx and staleness is  49 1
distance 2 is tensor(53745.2790, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53745.2790, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.023079240694642067
current submit client idx and staleness is  50 1
distance 2 is tensor(53787.4913, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53787.4913, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10901264101266861
current submit client idx and staleness is  51 1
distance 2 is tensor(53720.6290, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53720.6290, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19982895255088806
current submit client idx and staleness is  52 1
distance 2 is tensor(53790.2231, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53790.2231, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04393080249428749
current submit client idx and staleness is  53 1
distance 2 is tensor(53707.4218, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53707.4218, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.010241655632853508
current submit client idx and staleness is  54 1
distance 2 is tensor(53742.9308, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53742.9308, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22578439116477966
current submit client idx and staleness is  55 1
distance 2 is tensor(53747.1899, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53747.1899, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0036217134911566973
current submit client idx and staleness is  56 1
distance 2 is tensor(53719.8806, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53719.8806, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13948315382003784
current submit client idx and staleness is  57 1
distance 2 is tensor(53708.5374, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.5374, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12876617908477783
current submit client idx and staleness is  58 1
distance 2 is tensor(53741.0196, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53741.0196, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03827898949384689
current submit client idx and staleness is  59 1
distance 2 is tensor(53721.2120, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53721.2120, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19731523096561432
benign_acc is 1.0000000005
benign_loss is 0.013894726522266865
benign_entropy is 0.03883431479334831
benign_acc is 0.9500000005
benign_loss is 0.11975656449794769
benign_entropy is 0.04793040081858635
sync_acc is 1.0000000005
sync_loss is 0.03292436897754669
sync_entropy is 0.03689324110746384
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [12, 14]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 75.78% 

Test Accuracy: 75.48% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53714.1041, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53714.1041, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03850599378347397
current submit client idx and staleness is  1 1
distance 2 is tensor(53867.9528, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53867.9528, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11923577636480331
current submit client idx and staleness is  2 1
distance 2 is tensor(53708.6548, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.6548, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10935070365667343
current submit client idx and staleness is  3 1
distance 2 is tensor(53703.2522, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53703.2522, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10931440442800522
current submit client idx and staleness is  4 1
distance 2 is tensor(53723.0937, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53723.0937, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13374769687652588
current submit client idx and staleness is  5 1
distance 2 is tensor(53742.8296, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53742.8296, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13096486032009125
current submit client idx and staleness is  6 1
distance 2 is tensor(53764.4947, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53764.4947, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.019347038120031357
current submit client idx and staleness is  7 1
distance 2 is tensor(53729.3560, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53729.3560, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08455803245306015
current submit client idx and staleness is  8 2
distance 2 is tensor(53957.7139, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53957.7139, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28313928842544556
current submit client idx and staleness is  9 2
distance 2 is tensor(53801.5285, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53801.5285, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0553806833922863
current submit client idx and staleness is  10 2
distance 2 is tensor(53747.6247, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53747.6247, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23669365048408508
current submit client idx and staleness is  11 2
distance 2 is tensor(53825.2287, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53825.2287, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4639894366264343
current submit client idx and staleness is  12 2
distance 2 is tensor(53900.1056, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53900.1056, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6208372712135315
current submit client idx and staleness is  13 2
distance 2 is tensor(53733.1806, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53733.1806, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.151159405708313
current submit client idx and staleness is  14 2
distance 2 is tensor(53971.7422, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53971.7422, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2695767283439636
current submit client idx and staleness is  15 2
distance 2 is tensor(53980.9687, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53980.9687, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6908600926399231
current submit client idx and staleness is  24 4
distance 2 is tensor(53991.5571, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53991.5571, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3138267993927002
current submit client idx and staleness is  25 4
distance 2 is tensor(54009.3496, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54009.3496, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.27602848410606384
current submit client idx and staleness is  26 4
distance 2 is tensor(53962.7266, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53962.7266, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17889545857906342
current submit client idx and staleness is  27 4
distance 2 is tensor(53976.1605, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53976.1605, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3200492858886719
current submit client idx and staleness is  28 4
distance 2 is tensor(54016.6562, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54016.6562, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23498359322547913
current submit client idx and staleness is  29 4
distance 2 is tensor(54024.6907, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54024.6907, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24422594904899597
current submit client idx and staleness is  30 4
distance 2 is tensor(53947.0143, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53947.0143, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35621803998947144
current submit client idx and staleness is  31 4
distance 2 is tensor(54015.7285, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54015.7285, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5401307344436646
current submit client idx and staleness is  48 1
distance 2 is tensor(53831.4420, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53831.4420, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6363500356674194
current submit client idx and staleness is  49 1
distance 2 is tensor(53731.6937, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53731.6937, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03881694748997688
current submit client idx and staleness is  50 1
distance 2 is tensor(53757.2891, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53757.2891, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.30388402938842773
current submit client idx and staleness is  51 1
distance 2 is tensor(53798.0451, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53798.0451, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6339350938796997
current submit client idx and staleness is  52 1
distance 2 is tensor(53910.8271, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53910.8271, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.30518436431884766
current submit client idx and staleness is  53 1
distance 2 is tensor(53723.5603, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53723.5603, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0067736441269516945
current submit client idx and staleness is  54 1
distance 2 is tensor(53984.3065, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53984.3065, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6756588220596313
current submit client idx and staleness is  55 1
distance 2 is tensor(53715.8298, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53715.8298, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10444842278957367
current submit client idx and staleness is  56 1
distance 2 is tensor(54016.4755, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54016.4755, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18034522235393524
current submit client idx and staleness is  57 1
distance 2 is tensor(53882.1241, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53882.1241, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.058105699717998505
current submit client idx and staleness is  58 1
distance 2 is tensor(53733.1059, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53733.1059, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05683385580778122
current submit client idx and staleness is  59 1
distance 2 is tensor(53706.0915, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53706.0915, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0604618601500988
benign_acc is 0.9500000005
benign_loss is 0.17644786834716797
benign_entropy is 0.015273752622306347
benign_acc is 0.9500000005
benign_loss is 0.1874159276485443
benign_entropy is 0.020540751516819
sync_acc is 0.9500000005
sync_loss is 0.08280538767576218
sync_entropy is 0.025991106405854225
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 75.74% 

Test Accuracy: 75.08% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53704.9322, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53704.9322, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10870162397623062
current submit client idx and staleness is  1 1
distance 2 is tensor(53681.7789, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53681.7789, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06772410124540329
current submit client idx and staleness is  2 1
distance 2 is tensor(54091.6099, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54091.6099, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20999924838542938
current submit client idx and staleness is  3 1
distance 2 is tensor(53687.1963, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.1963, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0990595817565918
current submit client idx and staleness is  4 1
distance 2 is tensor(54055.6721, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54055.6721, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1950252205133438
current submit client idx and staleness is  5 1
distance 2 is tensor(53694.4876, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.4876, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1459050178527832
current submit client idx and staleness is  6 1
distance 2 is tensor(53659.6618, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53659.6618, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.061807435005903244
current submit client idx and staleness is  7 1
distance 2 is tensor(53707.2632, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53707.2632, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06277565658092499
current submit client idx and staleness is  48 1
distance 2 is tensor(53820.6831, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53820.6831, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21631643176078796
current submit client idx and staleness is  49 1
distance 2 is tensor(53692.2896, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53692.2896, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0803142786026001
current submit client idx and staleness is  50 1
distance 2 is tensor(53699.0029, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53699.0029, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09991427510976791
current submit client idx and staleness is  51 1
distance 2 is tensor(53679.2738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.2738, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07214906811714172
current submit client idx and staleness is  52 1
distance 2 is tensor(53749.4484, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53749.4484, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1546436995267868
current submit client idx and staleness is  53 1
distance 2 is tensor(53670.6332, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.6332, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13179217278957367
current submit client idx and staleness is  54 1
distance 2 is tensor(53702.9713, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.9713, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13724076747894287
current submit client idx and staleness is  55 1
distance 2 is tensor(53674.7248, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53674.7248, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05673579126596451
current submit client idx and staleness is  56 1
distance 2 is tensor(53698.5405, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.5405, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16096462309360504
current submit client idx and staleness is  57 1
distance 2 is tensor(53670.0953, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.0953, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06485471874475479
current submit client idx and staleness is  58 1
distance 2 is tensor(53977.5235, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53977.5235, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5190615653991699
current submit client idx and staleness is  59 1
distance 2 is tensor(53739.3745, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53739.3745, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20603981614112854
sync_acc is 0.9500000005
sync_loss is 0.10099989175796509
sync_entropy is 0.020664667710661888
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [12, 15, 16]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 75.92% 

Test Accuracy: 75.25% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53754.0130, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53754.0130, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.017141511663794518
current submit client idx and staleness is  1 1
distance 2 is tensor(53691.1651, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.1651, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06658090651035309
current submit client idx and staleness is  2 1
distance 2 is tensor(53716.1850, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53716.1850, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08908163011074066
current submit client idx and staleness is  3 1
distance 2 is tensor(53964.5919, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53964.5919, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.058846019208431244
current submit client idx and staleness is  4 1
distance 2 is tensor(53937.5536, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53937.5536, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5735322833061218
current submit client idx and staleness is  5 1
distance 2 is tensor(53743.7778, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53743.7778, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09219403564929962
current submit client idx and staleness is  6 1
distance 2 is tensor(53712.5256, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53712.5256, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10527954250574112
current submit client idx and staleness is  7 1
distance 2 is tensor(53693.1480, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.1480, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.037109505385160446
current submit client idx and staleness is  8 2
distance 2 is tensor(53767.7988, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53767.7988, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.017752179875969887
current submit client idx and staleness is  9 2
distance 2 is tensor(53847.5594, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53847.5594, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.012546147219836712
current submit client idx and staleness is  10 2
distance 2 is tensor(53700.7609, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53700.7609, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09049735218286514
current submit client idx and staleness is  11 2
distance 2 is tensor(54067.6254, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54067.6254, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5082899928092957
current submit client idx and staleness is  12 2
distance 2 is tensor(53984.8693, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53984.8693, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32433614134788513
current submit client idx and staleness is  13 2
distance 2 is tensor(53924.7418, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53924.7418, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12283720821142197
current submit client idx and staleness is  14 2
distance 2 is tensor(53921.7254, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53921.7254, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7772322297096252
current submit client idx and staleness is  15 2
distance 2 is tensor(53948.5544, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53948.5544, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08576012402772903
current submit client idx and staleness is  16 3
distance 2 is tensor(54018.8049, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54018.8049, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.277471661567688
current submit client idx and staleness is  17 3
distance 2 is tensor(54014.7340, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54014.7340, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6058893203735352
current submit client idx and staleness is  18 3
distance 2 is tensor(54017.7701, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54017.7701, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8281328082084656
current submit client idx and staleness is  19 3
distance 2 is tensor(54005.6360, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54005.6360, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2676703929901123
current submit client idx and staleness is  20 3
distance 2 is tensor(53991.7579, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53991.7579, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5550817847251892
current submit client idx and staleness is  21 3
distance 2 is tensor(53734.2253, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53734.2253, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3653097450733185
current submit client idx and staleness is  22 3
distance 2 is tensor(53978.6336, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53978.6336, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.39645975828170776
current submit client idx and staleness is  23 3
distance 2 is tensor(54001.2810, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54001.2810, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07030868530273438
current submit client idx and staleness is  40 6
distance 2 is tensor(53980.5352, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53980.5352, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7342316508293152
current submit client idx and staleness is  41 6
distance 2 is tensor(54011.3216, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54011.3216, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.050071071833372116
current submit client idx and staleness is  42 6
distance 2 is tensor(54011.0227, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54011.0227, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.47391176223754883
current submit client idx and staleness is  43 6
distance 2 is tensor(54001.9860, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54001.9860, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3296552300453186
current submit client idx and staleness is  44 6
distance 2 is tensor(54048.6847, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54048.6847, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3339841961860657
current submit client idx and staleness is  45 6
distance 2 is tensor(54044.0888, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54044.0888, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06874682009220123
current submit client idx and staleness is  46 6
distance 2 is tensor(53985.5698, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53985.5698, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24202676117420197
current submit client idx and staleness is  47 6
distance 2 is tensor(53986.7908, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53986.7908, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5301715135574341
current submit client idx and staleness is  48 1
distance 2 is tensor(53713.0351, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53713.0351, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1863791048526764
current submit client idx and staleness is  49 1
distance 2 is tensor(53855.1981, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53855.1981, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03639870509505272
current submit client idx and staleness is  50 1
distance 2 is tensor(53728.7927, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53728.7927, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21870169043540955
current submit client idx and staleness is  51 1
distance 2 is tensor(53705.8910, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.8910, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17166203260421753
current submit client idx and staleness is  52 1
distance 2 is tensor(53786.7282, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53786.7282, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5045974254608154
current submit client idx and staleness is  53 1
distance 2 is tensor(53702.5880, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.5880, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07398266345262527
current submit client idx and staleness is  54 1
distance 2 is tensor(54001.4949, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54001.4949, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.26885777711868286
current submit client idx and staleness is  55 1
distance 2 is tensor(53863.8857, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53863.8857, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2502515912055969
current submit client idx and staleness is  56 1
distance 2 is tensor(53685.6281, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53685.6281, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1390824317932129
current submit client idx and staleness is  57 1
distance 2 is tensor(53701.9706, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53701.9706, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07562564313411713
current submit client idx and staleness is  58 1
distance 2 is tensor(53717.7339, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53717.7339, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.045034173876047134
current submit client idx and staleness is  59 1
distance 2 is tensor(53702.6385, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.6385, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2601624131202698
benign_acc is 0.9500000005
benign_loss is 0.054585494101047516
benign_entropy is 0.037032436579465866
benign_acc is 0.9500000005
benign_loss is 0.17323794960975647
benign_entropy is 0.03549300134181976
benign_acc is 0.9500000005
benign_loss is 0.13142243027687073
benign_entropy is 0.03863652050495148
sync_acc is 0.9500000005
sync_loss is 0.07754391431808472
sync_entropy is 0.02823980711400509
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 75.89% 

Test Accuracy: 75.17% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53698.2381, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.2381, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10824407637119293
current submit client idx and staleness is  1 1
distance 2 is tensor(53683.5961, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53683.5961, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.023000191897153854
current submit client idx and staleness is  2 1
distance 2 is tensor(53682.3720, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.3720, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04175735265016556
current submit client idx and staleness is  3 1
distance 2 is tensor(53667.2962, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53667.2962, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1556694358587265
current submit client idx and staleness is  4 1
distance 2 is tensor(53684.5635, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.5635, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15324562788009644
current submit client idx and staleness is  5 1
distance 2 is tensor(53913.2979, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53913.2979, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6393294334411621
current submit client idx and staleness is  6 1
distance 2 is tensor(53688.4629, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53688.4629, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03963839262723923
current submit client idx and staleness is  7 1
distance 2 is tensor(53681.8780, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53681.8780, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03830189257860184
current submit client idx and staleness is  48 1
distance 2 is tensor(53698.8789, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.8789, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0816023200750351
current submit client idx and staleness is  49 1
distance 2 is tensor(53716.3192, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53716.3192, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05149104446172714
current submit client idx and staleness is  50 1
distance 2 is tensor(53691.5486, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.5486, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18368525803089142
current submit client idx and staleness is  51 1
distance 2 is tensor(54002.0803, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54002.0803, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2863233983516693
current submit client idx and staleness is  52 1
distance 2 is tensor(53699.4316, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53699.4316, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21611663699150085
current submit client idx and staleness is  53 1
distance 2 is tensor(54039.4318, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54039.4318, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19673886895179749
current submit client idx and staleness is  54 1
distance 2 is tensor(53694.4360, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.4360, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10596974939107895
current submit client idx and staleness is  55 1
distance 2 is tensor(53727.4497, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53727.4497, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04369569569826126
current submit client idx and staleness is  56 1
distance 2 is tensor(53676.0015, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.0015, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07631950825452805
current submit client idx and staleness is  57 1
distance 2 is tensor(53701.6213, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53701.6213, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.011064158752560616
current submit client idx and staleness is  58 1
distance 2 is tensor(53719.4801, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53719.4801, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09985411167144775
current submit client idx and staleness is  59 1
distance 2 is tensor(53871.8426, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53871.8426, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11499228328466415
sync_acc is 0.9500000005
sync_loss is 0.05527845770120621
sync_entropy is 0.03428703173995018
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [15, 16, 18]
alphas 3 is [1.   0.2  0.25 0.5 ]
alphas is  [0.51282051 0.1025641  0.12820513 0.25641026]
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 75.85% 

Test Accuracy: 75.27% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53713.1040, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53713.1040, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15757158398628235
current submit client idx and staleness is  1 1
distance 2 is tensor(54047.4296, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54047.4296, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4422554075717926
current submit client idx and staleness is  2 1
distance 2 is tensor(53717.6050, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53717.6050, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.009331577457487583
current submit client idx and staleness is  3 1
distance 2 is tensor(53730.4671, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53730.4671, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17770865559577942
current submit client idx and staleness is  4 1
distance 2 is tensor(53730.5675, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53730.5675, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11783149093389511
current submit client idx and staleness is  5 1
distance 2 is tensor(53964.2547, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53964.2547, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22433233261108398
current submit client idx and staleness is  6 1
distance 2 is tensor(53696.8384, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53696.8384, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04386477544903755
current submit client idx and staleness is  7 1
distance 2 is tensor(53735.9557, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53735.9557, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12352043390274048
current submit client idx and staleness is  8 2
distance 2 is tensor(53718.0760, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53718.0760, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.047708407044410706
current submit client idx and staleness is  9 2
distance 2 is tensor(53706.3457, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53706.3457, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04324362054467201
current submit client idx and staleness is  10 2
distance 2 is tensor(53749.2664, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53749.2664, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.027646368369460106
current submit client idx and staleness is  11 2
distance 2 is tensor(53943.6204, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53943.6204, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3849363327026367
current submit client idx and staleness is  12 2
distance 2 is tensor(53850.3191, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53850.3191, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3480812609195709
current submit client idx and staleness is  13 2
distance 2 is tensor(53913.7300, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53913.7300, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10325463861227036
current submit client idx and staleness is  14 2
distance 2 is tensor(53877.8124, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53877.8124, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.235530287027359
current submit client idx and staleness is  15 2
distance 2 is tensor(53749.9947, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53749.9947, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02804490365087986
current submit client idx and staleness is  24 4
distance 2 is tensor(53965.6352, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53965.6352, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22195589542388916
current submit client idx and staleness is  25 4
distance 2 is tensor(53994.0313, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53994.0313, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1736762672662735
current submit client idx and staleness is  26 4
distance 2 is tensor(54010.4886, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54010.4886, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4914485812187195
current submit client idx and staleness is  27 4
distance 2 is tensor(53998.1522, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53998.1522, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32573461532592773
current submit client idx and staleness is  28 4
distance 2 is tensor(54021.0650, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54021.0650, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36688560247421265
current submit client idx and staleness is  29 4
distance 2 is tensor(54008.7534, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54008.7534, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21591003239154816
current submit client idx and staleness is  30 4
distance 2 is tensor(54002.4397, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54002.4397, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28267472982406616
current submit client idx and staleness is  31 4
distance 2 is tensor(53973.1139, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53973.1139, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03235401585698128
current submit client idx and staleness is  32 5
distance 2 is tensor(53973.0200, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53973.0200, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1678471565246582
current submit client idx and staleness is  33 5
distance 2 is tensor(53980.8866, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53980.8866, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3099251687526703
current submit client idx and staleness is  34 5
distance 2 is tensor(54003.5632, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54003.5632, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36477357149124146
current submit client idx and staleness is  35 5
distance 2 is tensor(54021.6175, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54021.6175, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3296206593513489
current submit client idx and staleness is  36 5
distance 2 is tensor(53992.1327, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53992.1327, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5897974371910095
current submit client idx and staleness is  37 5
distance 2 is tensor(53975.8584, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53975.8584, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.783959150314331
current submit client idx and staleness is  38 5
distance 2 is tensor(53969.8881, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53969.8881, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11935234069824219
current submit client idx and staleness is  39 5
distance 2 is tensor(53988.1696, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53988.1696, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13338801264762878
current submit client idx and staleness is  48 1
distance 2 is tensor(54003.6338, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54003.6338, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0631474107503891
current submit client idx and staleness is  49 1
distance 2 is tensor(53697.3153, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53697.3153, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04249917343258858
current submit client idx and staleness is  50 1
distance 2 is tensor(53992.4757, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53992.4757, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17294034361839294
current submit client idx and staleness is  51 1
distance 2 is tensor(53724.3411, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53724.3411, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14965787529945374
current submit client idx and staleness is  52 1
distance 2 is tensor(53735.6342, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53735.6342, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12786802649497986
current submit client idx and staleness is  53 1
distance 2 is tensor(53761.5738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53761.5738, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04548860341310501
current submit client idx and staleness is  54 1
distance 2 is tensor(53737.2718, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53737.2718, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05920078232884407
current submit client idx and staleness is  55 1
distance 2 is tensor(53748.1581, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53748.1581, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16429182887077332
current submit client idx and staleness is  56 1
distance 2 is tensor(53693.8524, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.8524, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11172083765268326
current submit client idx and staleness is  57 1
distance 2 is tensor(53710.0346, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53710.0346, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08182455599308014
current submit client idx and staleness is  58 1
distance 2 is tensor(53711.6109, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53711.6109, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08992461115121841
current submit client idx and staleness is  59 1
distance 2 is tensor(53712.3277, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53712.3277, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0920223593711853
benign_acc is 0.9500000005
benign_loss is 0.049419280141592026
benign_entropy is 0.03612165525555611
benign_acc is 0.9500000005
benign_loss is 0.10266773402690887
benign_entropy is 0.02912435494363308
benign_acc is 0.9500000005
benign_loss is 0.21859844028949738
benign_entropy is 0.029930267482995987
sync_acc is 0.9500000005
sync_loss is 0.06895594298839569
sync_entropy is 0.029997700825333595
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [18]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 75.99% 

Test Accuracy: 75.50% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53696.4401, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53696.4401, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10023652017116547
current submit client idx and staleness is  1 1
distance 2 is tensor(53717.4833, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53717.4833, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.008405446074903011
current submit client idx and staleness is  2 1
distance 2 is tensor(53742.0961, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53742.0961, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.00829615630209446
current submit client idx and staleness is  3 1
distance 2 is tensor(53697.9961, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53697.9961, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08937322348356247
current submit client idx and staleness is  4 1
distance 2 is tensor(53727.4799, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53727.4799, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12029081583023071
current submit client idx and staleness is  5 1
distance 2 is tensor(53780.9219, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53780.9219, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03499319404363632
current submit client idx and staleness is  6 1
distance 2 is tensor(53698.1553, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.1553, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05616794899106026
current submit client idx and staleness is  7 1
distance 2 is tensor(53722.2470, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53722.2470, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06732358783483505
current submit client idx and staleness is  16 3
distance 2 is tensor(53993.3428, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53993.3428, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2831621766090393
current submit client idx and staleness is  17 3
distance 2 is tensor(54052.3934, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54052.3934, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4529532492160797
current submit client idx and staleness is  18 3
distance 2 is tensor(54007.7034, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54007.7034, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21202294528484344
current submit client idx and staleness is  19 3
distance 2 is tensor(54021.5361, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54021.5361, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13103443384170532
current submit client idx and staleness is  20 3
distance 2 is tensor(53962.2173, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53962.2173, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36432480812072754
current submit client idx and staleness is  21 3
distance 2 is tensor(54075.2746, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54075.2746, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.179143026471138
current submit client idx and staleness is  22 3
distance 2 is tensor(54023.0417, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54023.0417, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2102956473827362
current submit client idx and staleness is  23 3
distance 2 is tensor(54100.8138, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54100.8138, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.38756442070007324
current submit client idx and staleness is  48 1
distance 2 is tensor(53716.5093, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53716.5093, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14546971023082733
current submit client idx and staleness is  49 1
distance 2 is tensor(53691.5281, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.5281, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.060628075152635574
current submit client idx and staleness is  50 1
distance 2 is tensor(53709.4542, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53709.4542, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13103732466697693
current submit client idx and staleness is  51 1
distance 2 is tensor(53951.6437, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53951.6437, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4234623908996582
current submit client idx and staleness is  52 1
distance 2 is tensor(53733.8962, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53733.8962, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.29053765535354614
current submit client idx and staleness is  53 1
distance 2 is tensor(53695.8883, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53695.8883, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01656567119061947
current submit client idx and staleness is  54 1
distance 2 is tensor(53995.6802, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53995.6802, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.601096510887146
current submit client idx and staleness is  55 1
distance 2 is tensor(53779.5505, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53779.5505, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19868358969688416
current submit client idx and staleness is  56 1
distance 2 is tensor(53730.5650, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53730.5650, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07815396040678024
current submit client idx and staleness is  57 1
distance 2 is tensor(53704.6251, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53704.6251, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09963850677013397
current submit client idx and staleness is  58 1
distance 2 is tensor(53939.9322, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53939.9322, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.47182950377464294
current submit client idx and staleness is  59 1
distance 2 is tensor(53722.2794, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53722.2794, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14174725115299225
benign_acc is 0.9500000005
benign_loss is 0.13719862699508667
benign_entropy is 0.039386071264743805
sync_acc is 0.9500000005
sync_loss is 0.05574530363082886
sync_entropy is 0.03332296013832092
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [20]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 75.95% 

Test Accuracy: 75.34% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53673.5803, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.5803, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11866594851016998
current submit client idx and staleness is  1 1
distance 2 is tensor(53657.7647, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53657.7647, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04018060117959976
current submit client idx and staleness is  2 1
distance 2 is tensor(53839.7435, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53839.7435, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12845884263515472
current submit client idx and staleness is  3 1
distance 2 is tensor(53666.4407, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53666.4407, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.055709682404994965
current submit client idx and staleness is  4 1
distance 2 is tensor(53675.2623, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.2623, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19859367609024048
current submit client idx and staleness is  5 1
distance 2 is tensor(53731.7501, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53731.7501, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08849185705184937
current submit client idx and staleness is  6 1
distance 2 is tensor(53698.6387, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.6387, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.018597986549139023
current submit client idx and staleness is  7 1
distance 2 is tensor(53682.7500, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.7500, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05203104764223099
current submit client idx and staleness is  8 2
distance 2 is tensor(53685.3396, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53685.3396, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09428570419549942
current submit client idx and staleness is  9 2
distance 2 is tensor(53687.1971, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.1971, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05312854051589966
current submit client idx and staleness is  10 2
distance 2 is tensor(53694.2829, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.2829, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07800502330064774
current submit client idx and staleness is  11 2
distance 2 is tensor(54043.2798, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54043.2798, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8455014228820801
current submit client idx and staleness is  12 2
distance 2 is tensor(53963.5993, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53963.5993, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4156467318534851
current submit client idx and staleness is  13 2
distance 2 is tensor(54082.6267, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54082.6267, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36801832914352417
current submit client idx and staleness is  14 2
distance 2 is tensor(53953.6651, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53953.6651, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4467765688896179
current submit client idx and staleness is  15 2
distance 2 is tensor(53675.1307, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.1307, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04023945331573486
current submit client idx and staleness is  48 1
distance 2 is tensor(53704.5453, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53704.5453, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08162857592105865
current submit client idx and staleness is  49 1
distance 2 is tensor(53707.4795, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53707.4795, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.016475073993206024
current submit client idx and staleness is  50 1
distance 2 is tensor(54014.2051, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54014.2051, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28025323152542114
current submit client idx and staleness is  51 1
distance 2 is tensor(54038.3595, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54038.3595, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23266001045703888
current submit client idx and staleness is  52 1
distance 2 is tensor(53706.7825, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53706.7825, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3568398356437683
current submit client idx and staleness is  53 1
distance 2 is tensor(53669.8225, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53669.8225, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0560581274330616
current submit client idx and staleness is  54 1
distance 2 is tensor(54050.0096, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54050.0096, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6962488889694214
current submit client idx and staleness is  55 1
distance 2 is tensor(53705.2253, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.2253, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09266988933086395
current submit client idx and staleness is  56 1
distance 2 is tensor(53743.7710, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53743.7710, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14828458428382874
current submit client idx and staleness is  57 1
distance 2 is tensor(53686.8791, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53686.8791, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07438892126083374
current submit client idx and staleness is  58 1
distance 2 is tensor(53968.4339, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53968.4339, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3285847008228302
current submit client idx and staleness is  59 1
distance 2 is tensor(53672.0755, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.0755, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07916559278964996
benign_acc is 0.9500000005
benign_loss is 0.13039173185825348
benign_entropy is 0.015932388603687286
sync_acc is 0.9500000005
sync_loss is 0.0631808489561081
sync_entropy is 0.031208623200654984
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 75.78% 

Test Accuracy: 75.17% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(54112.0692, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54112.0692, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24476106464862823
current submit client idx and staleness is  1 1
distance 2 is tensor(53664.7687, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53664.7687, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03621293604373932
current submit client idx and staleness is  2 1
distance 2 is tensor(53974.7491, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53974.7491, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1479712426662445
current submit client idx and staleness is  3 1
distance 2 is tensor(53902.2230, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53902.2230, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06559567153453827
current submit client idx and staleness is  4 1
distance 2 is tensor(54089.1232, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54089.1232, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23960807919502258
current submit client idx and staleness is  5 1
distance 2 is tensor(54049.1350, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54049.1350, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8379807472229004
current submit client idx and staleness is  6 1
distance 2 is tensor(53654.7389, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53654.7389, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04022113233804703
current submit client idx and staleness is  7 1
distance 2 is tensor(53677.2732, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53677.2732, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05605713650584221
current submit client idx and staleness is  48 1
distance 2 is tensor(53968.4319, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53968.4319, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3223545253276825
current submit client idx and staleness is  49 1
distance 2 is tensor(53661.1515, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53661.1515, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08547452837228775
current submit client idx and staleness is  50 1
distance 2 is tensor(53664.6659, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53664.6659, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05441303923726082
current submit client idx and staleness is  51 1
distance 2 is tensor(53735.8590, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53735.8590, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4382518231868744
current submit client idx and staleness is  52 1
distance 2 is tensor(54103.6939, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54103.6939, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  1.0044488906860352
current submit client idx and staleness is  53 1
distance 2 is tensor(53666.0753, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53666.0753, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.054850488901138306
current submit client idx and staleness is  54 1
distance 2 is tensor(54015.8930, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54015.8930, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.29838889837265015
current submit client idx and staleness is  55 1
distance 2 is tensor(53813.5168, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53813.5168, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.30605974793434143
current submit client idx and staleness is  56 1
distance 2 is tensor(54010.3329, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54010.3329, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3241683840751648
current submit client idx and staleness is  57 1
distance 2 is tensor(53653.9872, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53653.9872, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03801227733492851
current submit client idx and staleness is  58 1
distance 2 is tensor(53701.6423, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53701.6423, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.011462438851594925
current submit client idx and staleness is  59 1
distance 2 is tensor(53667.0887, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53667.0887, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.048983216285705566
sync_acc is 0.9500000005
sync_loss is 0.07997731119394302
sync_entropy is 0.027035463601350784
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [18, 20, 21, 22]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 75.88% 

Test Accuracy: 75.57% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53719.0667, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53719.0667, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.009819896891713142
current submit client idx and staleness is  1 1
distance 2 is tensor(53693.6097, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.6097, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05635979026556015
current submit client idx and staleness is  2 1
distance 2 is tensor(53810.8252, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53810.8252, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.33873799443244934
current submit client idx and staleness is  3 1
distance 2 is tensor(53696.0091, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53696.0091, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08093172311782837
current submit client idx and staleness is  4 1
distance 2 is tensor(53725.7281, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53725.7281, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1807500422000885
current submit client idx and staleness is  5 1
distance 2 is tensor(53777.7482, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53777.7482, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2062491476535797
current submit client idx and staleness is  6 1
distance 2 is tensor(53711.9578, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53711.9578, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0064510153606534
current submit client idx and staleness is  7 1
distance 2 is tensor(53761.0599, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53761.0599, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.021530119702219963
current submit client idx and staleness is  8 2
distance 2 is tensor(53715.6798, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53715.6798, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11807652562856674
current submit client idx and staleness is  9 2
distance 2 is tensor(53710.3930, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53710.3930, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09710963815450668
current submit client idx and staleness is  10 2
distance 2 is tensor(53744.2891, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53744.2891, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09374628216028214
current submit client idx and staleness is  11 2
distance 2 is tensor(53911.2686, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53911.2686, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1853909194469452
current submit client idx and staleness is  12 2
distance 2 is tensor(53784.1212, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53784.1212, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15515929460525513
current submit client idx and staleness is  13 2
distance 2 is tensor(53734.5737, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53734.5737, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12342631816864014
current submit client idx and staleness is  14 2
distance 2 is tensor(53885.6711, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53885.6711, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.38315898180007935
current submit client idx and staleness is  15 2
distance 2 is tensor(53718.9925, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53718.9925, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15618713200092316
current submit client idx and staleness is  16 3
distance 2 is tensor(54004.1918, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54004.1918, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32459378242492676
current submit client idx and staleness is  17 3
distance 2 is tensor(53983.1768, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53983.1768, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4365500509738922
current submit client idx and staleness is  18 3
distance 2 is tensor(53994.8553, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53994.8553, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3096829056739807
current submit client idx and staleness is  19 3
distance 2 is tensor(53970.0061, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53970.0061, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.40342193841934204
current submit client idx and staleness is  20 3
distance 2 is tensor(53976.5611, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53976.5611, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5552216172218323
current submit client idx and staleness is  21 3
distance 2 is tensor(53743.4677, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53743.4677, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06466426700353622
current submit client idx and staleness is  22 3
distance 2 is tensor(53968.8588, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53968.8588, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1609605848789215
current submit client idx and staleness is  23 3
distance 2 is tensor(53983.3800, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53983.3800, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.31069666147232056
current submit client idx and staleness is  24 4
distance 2 is tensor(53979.2448, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53979.2448, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16096726059913635
current submit client idx and staleness is  25 4
distance 2 is tensor(53996.2084, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53996.2084, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.055184610188007355
current submit client idx and staleness is  26 4
distance 2 is tensor(53937.4588, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53937.4588, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0866883397102356
current submit client idx and staleness is  27 4
distance 2 is tensor(53979.2720, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53979.2720, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8998578190803528
current submit client idx and staleness is  28 4
distance 2 is tensor(53922.4287, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53922.4287, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7251039743423462
current submit client idx and staleness is  29 4
distance 2 is tensor(53969.2202, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53969.2202, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3145652115345001
current submit client idx and staleness is  30 4
distance 2 is tensor(53943.0657, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53943.0657, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23559987545013428
current submit client idx and staleness is  31 4
distance 2 is tensor(53949.6561, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53949.6561, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.45999154448509216
current submit client idx and staleness is  40 6
distance 2 is tensor(53962.9471, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53962.9471, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.26347801089286804
current submit client idx and staleness is  41 6
distance 2 is tensor(53988.1509, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53988.1509, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12018028646707535
current submit client idx and staleness is  42 6
distance 2 is tensor(53991.2522, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53991.2522, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06546370685100555
current submit client idx and staleness is  43 6
distance 2 is tensor(53973.8630, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53973.8630, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7844997644424438
current submit client idx and staleness is  44 6
distance 2 is tensor(53961.9253, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53961.9253, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2773215174674988
current submit client idx and staleness is  45 6
distance 2 is tensor(53922.1805, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53922.1805, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03575917333364487
current submit client idx and staleness is  46 6
distance 2 is tensor(53999.9270, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53999.9270, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17296521365642548
current submit client idx and staleness is  47 6
distance 2 is tensor(53980.6294, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53980.6294, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.25996527075767517
current submit client idx and staleness is  48 1
distance 2 is tensor(53762.6874, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53762.6874, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14157156646251678
current submit client idx and staleness is  49 1
distance 2 is tensor(53751.0210, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53751.0210, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08659394085407257
current submit client idx and staleness is  50 1
distance 2 is tensor(53701.6155, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53701.6155, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06813023239374161
current submit client idx and staleness is  51 1
distance 2 is tensor(53715.9372, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53715.9372, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1050388440489769
current submit client idx and staleness is  52 1
distance 2 is tensor(53730.6451, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53730.6451, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36746710538864136
current submit client idx and staleness is  53 1
distance 2 is tensor(53778.1357, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53778.1357, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1289558708667755
current submit client idx and staleness is  54 1
distance 2 is tensor(53766.2768, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53766.2768, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.41254931688308716
current submit client idx and staleness is  55 1
distance 2 is tensor(53848.4648, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53848.4648, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3360588848590851
current submit client idx and staleness is  56 1
distance 2 is tensor(53918.6612, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53918.6612, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.051630884408950806
current submit client idx and staleness is  57 1
distance 2 is tensor(53728.0634, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53728.0634, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06008042022585869
current submit client idx and staleness is  58 1
distance 2 is tensor(53793.9125, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53793.9125, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32972270250320435
current submit client idx and staleness is  59 1
distance 2 is tensor(53715.6145, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53715.6145, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18403185904026031
benign_acc is 0.9500000005
benign_loss is 0.1016533374786377
benign_entropy is 0.02147231251001358
benign_acc is 0.9500000005
benign_loss is 0.16075322031974792
benign_entropy is 0.02803923562169075
benign_acc is 0.9500000005
benign_loss is 0.16737297177314758
benign_entropy is 0.021680762991309166
benign_acc is 0.9500000005
benign_loss is 0.09189774096012115
benign_entropy is 0.05035568028688431
sync_acc is 0.9500000005
sync_loss is 0.060728736221790314
sync_entropy is 0.03226202726364136
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [20]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 76.29% 

Test Accuracy: 75.89% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53696.4889, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53696.4889, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1372070014476776
current submit client idx and staleness is  1 1
distance 2 is tensor(53789.4057, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53789.4057, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03087274730205536
current submit client idx and staleness is  2 1
distance 2 is tensor(53701.0437, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53701.0437, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09295984357595444
current submit client idx and staleness is  3 1
distance 2 is tensor(54031.3799, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54031.3799, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16565576195716858
current submit client idx and staleness is  4 1
distance 2 is tensor(53712.0388, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53712.0388, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1966715306043625
current submit client idx and staleness is  5 1
distance 2 is tensor(53679.7759, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.7759, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06105963513255119
current submit client idx and staleness is  6 1
distance 2 is tensor(53722.4502, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53722.4502, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.052489541471004486
current submit client idx and staleness is  7 1
distance 2 is tensor(53703.8488, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53703.8488, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.055795975029468536
current submit client idx and staleness is  32 5
distance 2 is tensor(54048.4692, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54048.4692, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21145062148571014
current submit client idx and staleness is  33 5
distance 2 is tensor(54017.1929, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54017.1929, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3627931475639343
current submit client idx and staleness is  34 5
distance 2 is tensor(54007.3282, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54007.3282, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5089226961135864
current submit client idx and staleness is  35 5
distance 2 is tensor(54022.2542, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54022.2542, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5400782227516174
current submit client idx and staleness is  36 5
distance 2 is tensor(53987.9673, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53987.9673, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4634915888309479
current submit client idx and staleness is  37 5
distance 2 is tensor(54066.4920, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54066.4920, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4761448800563812
current submit client idx and staleness is  38 5
distance 2 is tensor(54008.2561, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54008.2561, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2669433653354645
current submit client idx and staleness is  39 5
distance 2 is tensor(54020.5361, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54020.5361, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.31481021642684937
current submit client idx and staleness is  48 1
distance 2 is tensor(53717.6550, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53717.6550, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09670854359865189
current submit client idx and staleness is  49 1
distance 2 is tensor(53690.9557, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.9557, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.033368416130542755
current submit client idx and staleness is  50 1
distance 2 is tensor(53683.9254, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53683.9254, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12663736939430237
current submit client idx and staleness is  51 1
distance 2 is tensor(53697.5890, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53697.5890, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1430211216211319
current submit client idx and staleness is  52 1
distance 2 is tensor(53838.9501, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53838.9501, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2503727972507477
current submit client idx and staleness is  53 1
distance 2 is tensor(53716.0907, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53716.0907, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  3.5444245440885425e-05
current submit client idx and staleness is  54 1
distance 2 is tensor(53751.4966, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53751.4966, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.008734209463000298
current submit client idx and staleness is  55 1
distance 2 is tensor(53708.5128, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.5128, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08722557127475739
current submit client idx and staleness is  56 1
distance 2 is tensor(53670.2472, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.2472, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09316639602184296
current submit client idx and staleness is  57 1
distance 2 is tensor(53714.0072, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53714.0072, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0775192528963089
current submit client idx and staleness is  58 1
distance 2 is tensor(53988.6556, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53988.6556, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4473233222961426
current submit client idx and staleness is  59 1
distance 2 is tensor(53717.8839, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53717.8839, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.013936889357864857
benign_acc is 0.9500000005
benign_loss is 0.18657061457633972
benign_entropy is 0.047547370195388794
sync_acc is 1.0000000005
sync_loss is 0.0001040416318573989
sync_entropy is 0.0008889962336979806
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [24]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 75.83% 

Test Accuracy: 75.48% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53831.6119, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53831.6119, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2592467963695526
current submit client idx and staleness is  1 1
distance 2 is tensor(53719.5815, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53719.5815, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.015401707962155342
current submit client idx and staleness is  2 1
distance 2 is tensor(53690.5945, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.5945, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.004980568774044514
current submit client idx and staleness is  3 1
distance 2 is tensor(53686.3228, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53686.3228, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.015316339209675789
current submit client idx and staleness is  4 1
distance 2 is tensor(53879.6360, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53879.6360, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13599459826946259
current submit client idx and staleness is  5 1
distance 2 is tensor(53720.0718, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53720.0718, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.020245498046278954
current submit client idx and staleness is  6 1
distance 2 is tensor(53843.1750, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53843.1750, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1938691884279251
current submit client idx and staleness is  7 1
distance 2 is tensor(53680.3147, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.3147, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03315715491771698
current submit client idx and staleness is  8 2
distance 2 is tensor(53704.1123, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53704.1123, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08348517119884491
current submit client idx and staleness is  9 2
distance 2 is tensor(54004.8830, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54004.8830, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22476701438426971
current submit client idx and staleness is  10 2
distance 2 is tensor(53693.9225, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.9225, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04442915320396423
current submit client idx and staleness is  11 2
distance 2 is tensor(54029.4305, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54029.4305, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5603151321411133
current submit client idx and staleness is  12 2
distance 2 is tensor(53957.1970, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53957.1970, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3599533140659332
current submit client idx and staleness is  13 2
distance 2 is tensor(53676.0873, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.0873, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04711630195379257
current submit client idx and staleness is  14 2
distance 2 is tensor(53996.2931, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53996.2931, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14971062541007996
current submit client idx and staleness is  15 2
distance 2 is tensor(53700.0138, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53700.0138, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.005495738238096237
current submit client idx and staleness is  48 1
distance 2 is tensor(53684.7650, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.7650, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03816945105791092
current submit client idx and staleness is  49 1
distance 2 is tensor(53673.0984, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.0984, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.007080411072820425
current submit client idx and staleness is  50 1
distance 2 is tensor(53831.6922, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53831.6922, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.014866207726299763
current submit client idx and staleness is  51 1
distance 2 is tensor(53712.5030, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53712.5030, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15906742215156555
current submit client idx and staleness is  52 1
distance 2 is tensor(54020.5612, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54020.5612, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5713902711868286
current submit client idx and staleness is  53 1
distance 2 is tensor(53654.9205, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53654.9205, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0013478801120072603
current submit client idx and staleness is  54 1
distance 2 is tensor(53675.8707, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.8707, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.006109895650297403
current submit client idx and staleness is  55 1
distance 2 is tensor(53937.0206, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53937.0206, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02575262263417244
current submit client idx and staleness is  56 1
distance 2 is tensor(53673.0261, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.0261, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1318349838256836
current submit client idx and staleness is  57 1
distance 2 is tensor(53676.6547, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.6547, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01813512295484543
current submit client idx and staleness is  58 1
distance 2 is tensor(53672.3762, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.3762, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03511735051870346
current submit client idx and staleness is  59 1
distance 2 is tensor(53686.0181, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53686.0181, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.009851815178990364
benign_acc is 1.0000000005
benign_loss is 0.02887827157974243
benign_entropy is 0.0378950759768486
sync_acc is 1.0000000005
sync_loss is 0.012081807479262352
sync_entropy is 0.02693874016404152
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [24]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 76.11% 

Test Accuracy: 75.52% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(54048.2013, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54048.2013, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8312655687332153
current submit client idx and staleness is  1 1
distance 2 is tensor(53847.0258, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53847.0258, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.060988545417785645
current submit client idx and staleness is  2 1
distance 2 is tensor(53687.9986, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.9986, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05017681047320366
current submit client idx and staleness is  3 1
distance 2 is tensor(53898.2373, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53898.2373, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13370302319526672
current submit client idx and staleness is  4 1
distance 2 is tensor(53686.9556, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53686.9556, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19235914945602417
current submit client idx and staleness is  5 1
distance 2 is tensor(53684.5212, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.5212, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06021515280008316
current submit client idx and staleness is  6 1
distance 2 is tensor(53759.6723, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53759.6723, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01574856974184513
current submit client idx and staleness is  7 1
distance 2 is tensor(53996.1164, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53996.1164, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4234052300453186
current submit client idx and staleness is  16 3
distance 2 is tensor(54061.9426, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54061.9426, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.43164414167404175
current submit client idx and staleness is  17 3
distance 2 is tensor(54030.0540, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54030.0540, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35019880533218384
current submit client idx and staleness is  18 3
distance 2 is tensor(54017.5072, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54017.5072, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21769115328788757
current submit client idx and staleness is  19 3
distance 2 is tensor(54022.7881, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54022.7881, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8300577402114868
current submit client idx and staleness is  20 3
distance 2 is tensor(54046.8626, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54046.8626, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2802879810333252
current submit client idx and staleness is  21 3
distance 2 is tensor(53694.9935, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.9935, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03915710002183914
current submit client idx and staleness is  22 3
distance 2 is tensor(53978.9454, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53978.9454, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.377957820892334
current submit client idx and staleness is  23 3
distance 2 is tensor(54067.4546, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54067.4546, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03682665526866913
current submit client idx and staleness is  48 1
distance 2 is tensor(53691.6231, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.6231, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11925091594457626
current submit client idx and staleness is  49 1
distance 2 is tensor(53682.7548, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.7548, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03647223487496376
current submit client idx and staleness is  50 1
distance 2 is tensor(53677.4197, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53677.4197, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1334134191274643
current submit client idx and staleness is  51 1
distance 2 is tensor(54052.2262, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54052.2262, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4019017219543457
current submit client idx and staleness is  52 1
distance 2 is tensor(53851.0568, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53851.0568, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.533352255821228
current submit client idx and staleness is  53 1
distance 2 is tensor(53691.5080, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.5080, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.004101390950381756
current submit client idx and staleness is  54 1
distance 2 is tensor(53695.8367, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53695.8367, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04993768036365509
current submit client idx and staleness is  55 1
distance 2 is tensor(53698.2973, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.2973, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.043057095259428024
current submit client idx and staleness is  56 1
distance 2 is tensor(53690.4857, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.4857, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06781933456659317
current submit client idx and staleness is  57 1
distance 2 is tensor(53689.3009, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.3009, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03959479555487633
current submit client idx and staleness is  58 1
distance 2 is tensor(53873.7158, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53873.7158, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10025826841592789
current submit client idx and staleness is  59 1
distance 2 is tensor(53675.0354, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.0354, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1431271731853485
benign_acc is 1.0000000005
benign_loss is 0.03663022443652153
benign_entropy is 0.0481133796274662
sync_acc is 0.9500000005
sync_loss is 0.035392407327890396
sync_entropy is 0.03701060637831688
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [24, 26]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 76.11% 

Test Accuracy: 75.58% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53670.3965, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.3965, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16551637649536133
current submit client idx and staleness is  1 1
distance 2 is tensor(53897.0505, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53897.0505, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16689714789390564
current submit client idx and staleness is  2 1
distance 2 is tensor(53707.1968, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53707.1968, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36539405584335327
current submit client idx and staleness is  3 1
distance 2 is tensor(53671.6256, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53671.6256, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07005608826875687
current submit client idx and staleness is  4 1
distance 2 is tensor(54003.9270, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54003.9270, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10180064290761948
current submit client idx and staleness is  5 1
distance 2 is tensor(53993.0044, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53993.0044, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5202714204788208
current submit client idx and staleness is  6 1
distance 2 is tensor(53684.2547, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.2547, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026141557842493057
current submit client idx and staleness is  7 1
distance 2 is tensor(53703.0478, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53703.0478, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.013602648861706257
current submit client idx and staleness is  8 2
distance 2 is tensor(53750.3246, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53750.3246, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15484890341758728
current submit client idx and staleness is  9 2
distance 2 is tensor(53699.2268, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53699.2268, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.031820327043533325
current submit client idx and staleness is  10 2
distance 2 is tensor(53796.6171, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53796.6171, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.021632203832268715
current submit client idx and staleness is  11 2
distance 2 is tensor(53914.3340, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53914.3340, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6370164155960083
current submit client idx and staleness is  12 2
distance 2 is tensor(54013.1425, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54013.1425, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7002159357070923
current submit client idx and staleness is  13 2
distance 2 is tensor(53692.9738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53692.9738, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04891125485301018
current submit client idx and staleness is  14 2
distance 2 is tensor(53705.0771, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.0771, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0484924241900444
current submit client idx and staleness is  15 2
distance 2 is tensor(53714.1982, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53714.1982, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0777633786201477
current submit client idx and staleness is  24 4
distance 2 is tensor(54053.5778, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54053.5778, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.49747759103775024
current submit client idx and staleness is  25 4
distance 2 is tensor(54023.6142, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54023.6142, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1265551596879959
current submit client idx and staleness is  26 4
distance 2 is tensor(54025.3039, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54025.3039, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.42247629165649414
current submit client idx and staleness is  27 4
distance 2 is tensor(53999.3933, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53999.3933, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2905237078666687
current submit client idx and staleness is  28 4
distance 2 is tensor(54053.9339, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54053.9339, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23474951088428497
current submit client idx and staleness is  29 4
distance 2 is tensor(54049.2314, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54049.2314, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4678325057029724
current submit client idx and staleness is  30 4
distance 2 is tensor(54003.5681, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54003.5681, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3125033974647522
current submit client idx and staleness is  31 4
distance 2 is tensor(54044.2015, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54044.2015, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.029479002580046654
current submit client idx and staleness is  48 1
distance 2 is tensor(53707.8114, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53707.8114, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07995185256004333
current submit client idx and staleness is  49 1
distance 2 is tensor(53675.0943, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.0943, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07444600015878677
current submit client idx and staleness is  50 1
distance 2 is tensor(53781.9517, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53781.9517, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16975037753582
current submit client idx and staleness is  51 1
distance 2 is tensor(53707.0335, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53707.0335, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17454245686531067
current submit client idx and staleness is  52 1
distance 2 is tensor(53929.1202, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53929.1202, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4817051291465759
current submit client idx and staleness is  53 1
distance 2 is tensor(53684.0373, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.0373, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.023232122883200645
current submit client idx and staleness is  54 1
distance 2 is tensor(53694.4874, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.4874, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07222819328308105
current submit client idx and staleness is  55 1
distance 2 is tensor(53744.6855, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53744.6855, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2212916612625122
current submit client idx and staleness is  56 1
distance 2 is tensor(53938.2066, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53938.2066, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08301927149295807
current submit client idx and staleness is  57 1
distance 2 is tensor(53674.7194, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53674.7194, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07644034922122955
current submit client idx and staleness is  58 1
distance 2 is tensor(53715.4515, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53715.4515, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.029954183846712112
current submit client idx and staleness is  59 1
distance 2 is tensor(53986.7947, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53986.7947, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1300847828388214
benign_acc is 0.9500000005
benign_loss is 0.05289459228515625
benign_entropy is 0.034137140959501266
benign_acc is 0.9500000005
benign_loss is 0.07982682436704636
benign_entropy is 0.038732271641492844
sync_acc is 0.9500000005
sync_loss is 0.056526780128479004
sync_entropy is 0.03384377434849739
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 75.96% 

Test Accuracy: 75.15% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(54017.2770, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54017.2770, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.43849095702171326
current submit client idx and staleness is  1 1
distance 2 is tensor(53673.8815, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.8815, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03342432528734207
current submit client idx and staleness is  2 1
distance 2 is tensor(54074.9507, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54074.9507, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.48001208901405334
current submit client idx and staleness is  3 1
distance 2 is tensor(53659.4097, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53659.4097, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0418647862970829
current submit client idx and staleness is  4 1
distance 2 is tensor(53712.5570, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53712.5570, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36428284645080566
current submit client idx and staleness is  5 1
distance 2 is tensor(53709.7601, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53709.7601, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.021960049867630005
current submit client idx and staleness is  6 1
distance 2 is tensor(53661.8159, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53661.8159, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03022746741771698
current submit client idx and staleness is  7 1
distance 2 is tensor(54093.0586, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54093.0586, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7030321955680847
current submit client idx and staleness is  48 1
distance 2 is tensor(53686.2712, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53686.2712, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07491686195135117
current submit client idx and staleness is  49 1
distance 2 is tensor(53702.4364, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.4364, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11832334101200104
current submit client idx and staleness is  50 1
distance 2 is tensor(53819.9220, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53819.9220, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08850537240505219
current submit client idx and staleness is  51 1
distance 2 is tensor(53732.1991, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53732.1991, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19212403893470764
current submit client idx and staleness is  52 1
distance 2 is tensor(53677.1161, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53677.1161, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12040077149868011
current submit client idx and staleness is  53 1
distance 2 is tensor(53659.8257, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53659.8257, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.052986614406108856
current submit client idx and staleness is  54 1
distance 2 is tensor(53946.6376, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53946.6376, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32357698678970337
current submit client idx and staleness is  55 1
distance 2 is tensor(53678.3761, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.3761, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03871137276291847
current submit client idx and staleness is  56 1
distance 2 is tensor(53659.3958, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53659.3958, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17457246780395508
current submit client idx and staleness is  57 1
distance 2 is tensor(53719.6172, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53719.6172, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0020524540450423956
current submit client idx and staleness is  58 1
distance 2 is tensor(53695.8054, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53695.8054, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06519920378923416
current submit client idx and staleness is  59 1
distance 2 is tensor(53779.4746, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53779.4746, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13987194001674652
sync_acc is 0.9500000005
sync_loss is 0.04724511504173279
sync_entropy is 0.03509598597884178
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [24, 25, 27, 28]
alphas 3 is [1.         0.16666667 0.2        0.33333333 0.5       ]
alphas is  [0.45454545 0.07575758 0.09090909 0.15151515 0.22727273]
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 76.34% 

Test Accuracy: 75.80% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53681.8465, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53681.8465, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07017327845096588
current submit client idx and staleness is  1 1
distance 2 is tensor(53699.8691, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53699.8691, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0021465762984007597
current submit client idx and staleness is  2 1
distance 2 is tensor(53767.2875, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53767.2875, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17158274352550507
current submit client idx and staleness is  3 1
distance 2 is tensor(53689.0318, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.0318, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04694068059325218
current submit client idx and staleness is  4 1
distance 2 is tensor(53768.5550, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53768.5550, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11521530151367188
current submit client idx and staleness is  5 1
distance 2 is tensor(53769.5620, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53769.5620, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06041909381747246
current submit client idx and staleness is  6 1
distance 2 is tensor(53690.3229, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.3229, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03612615913152695
current submit client idx and staleness is  7 1
distance 2 is tensor(53914.5185, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53914.5185, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.42110562324523926
current submit client idx and staleness is  8 2
distance 2 is tensor(53698.2180, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.2180, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.039470698684453964
current submit client idx and staleness is  9 2
distance 2 is tensor(53689.8798, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.8798, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0375903882086277
current submit client idx and staleness is  10 2
distance 2 is tensor(53703.7825, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53703.7825, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15117906033992767
current submit client idx and staleness is  11 2
distance 2 is tensor(53748.0164, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53748.0164, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13606855273246765
current submit client idx and staleness is  12 2
distance 2 is tensor(53786.8644, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53786.8644, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14933188259601593
current submit client idx and staleness is  13 2
distance 2 is tensor(53736.9722, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53736.9722, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03493545204401016
current submit client idx and staleness is  14 2
distance 2 is tensor(53857.2603, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53857.2603, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6780464053153992
current submit client idx and staleness is  15 2
distance 2 is tensor(53813.7588, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53813.7588, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16404931247234344
current submit client idx and staleness is  16 3
distance 2 is tensor(54011.7725, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54011.7725, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2126203030347824
current submit client idx and staleness is  17 3
distance 2 is tensor(53963.0091, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53963.0091, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2656216621398926
current submit client idx and staleness is  18 3
distance 2 is tensor(53997.5738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53997.5738, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.474567174911499
current submit client idx and staleness is  19 3
distance 2 is tensor(53983.4293, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53983.4293, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16407383978366852
current submit client idx and staleness is  20 3
distance 2 is tensor(53974.2718, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53974.2718, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.535455584526062
current submit client idx and staleness is  21 3
distance 2 is tensor(53726.9488, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53726.9488, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03344036638736725
current submit client idx and staleness is  22 3
distance 2 is tensor(53876.9396, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53876.9396, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.006294865161180496
current submit client idx and staleness is  23 3
distance 2 is tensor(54000.7175, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54000.7175, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.31389886140823364
current submit client idx and staleness is  32 5
distance 2 is tensor(53987.5079, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53987.5079, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11745140701532364
current submit client idx and staleness is  33 5
distance 2 is tensor(54002.4955, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54002.4955, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4193996787071228
current submit client idx and staleness is  34 5
distance 2 is tensor(54037.5837, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54037.5837, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2891747057437897
current submit client idx and staleness is  35 5
distance 2 is tensor(54035.6630, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54035.6630, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2830786108970642
current submit client idx and staleness is  36 5
distance 2 is tensor(53998.2960, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53998.2960, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3813958466053009
current submit client idx and staleness is  37 5
distance 2 is tensor(53993.4999, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53993.4999, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6578836441040039
current submit client idx and staleness is  38 5
distance 2 is tensor(53965.9922, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53965.9922, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2189440280199051
current submit client idx and staleness is  39 5
distance 2 is tensor(53996.0632, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53996.0632, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2489008903503418
current submit client idx and staleness is  40 6
distance 2 is tensor(54064.5326, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54064.5326, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3706055283546448
current submit client idx and staleness is  41 6
distance 2 is tensor(53960.8963, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53960.8963, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06761996448040009
current submit client idx and staleness is  42 6
distance 2 is tensor(54044.4491, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54044.4491, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2568815052509308
current submit client idx and staleness is  43 6
distance 2 is tensor(54071.9844, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54071.9844, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7021569013595581
current submit client idx and staleness is  44 6
distance 2 is tensor(54020.3819, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54020.3819, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12864285707473755
current submit client idx and staleness is  45 6
distance 2 is tensor(54065.5870, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54065.5870, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11247879266738892
current submit client idx and staleness is  46 6
distance 2 is tensor(53963.3894, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53963.3894, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24310705065727234
current submit client idx and staleness is  47 6
distance 2 is tensor(54052.2703, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54052.2703, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1330423802137375
current submit client idx and staleness is  48 1
distance 2 is tensor(53721.8226, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53721.8226, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13930073380470276
current submit client idx and staleness is  49 1
distance 2 is tensor(53692.3860, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53692.3860, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.019334467127919197
current submit client idx and staleness is  50 1
distance 2 is tensor(53694.1371, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.1371, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0439179353415966
current submit client idx and staleness is  51 1
distance 2 is tensor(53694.7075, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.7075, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16092164814472198
current submit client idx and staleness is  52 1
distance 2 is tensor(53722.8486, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53722.8486, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17534944415092468
current submit client idx and staleness is  53 1
distance 2 is tensor(53672.7549, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.7549, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.033342380076646805
current submit client idx and staleness is  54 1
distance 2 is tensor(53829.9884, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53829.9884, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22627761960029602
current submit client idx and staleness is  55 1
distance 2 is tensor(53712.1429, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53712.1429, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07174889743328094
current submit client idx and staleness is  56 1
distance 2 is tensor(53705.6050, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.6050, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12349516153335571
current submit client idx and staleness is  57 1
distance 2 is tensor(53889.2320, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53889.2320, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11079458147287369
current submit client idx and staleness is  58 1
distance 2 is tensor(53730.2064, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53730.2064, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13832645118236542
current submit client idx and staleness is  59 1
distance 2 is tensor(53721.5382, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53721.5382, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09100373089313507
benign_acc is 0.9500000005
benign_loss is 0.08564301580190659
benign_entropy is 0.025282954797148705
benign_acc is 0.9500000005
benign_loss is 0.09169438481330872
benign_entropy is 0.026509275659918785
benign_acc is 0.9500000005
benign_loss is 0.1061536893248558
benign_entropy is 0.05528156831860542
benign_acc is 0.9500000005
benign_loss is 0.12357503175735474
benign_entropy is 0.047678425908088684
sync_acc is 1.0000000005
sync_loss is 0.03080456517636776
sync_entropy is 0.0363151989877224
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 76.20% 

Test Accuracy: 75.60% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(54041.5051, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54041.5051, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1979849636554718
current submit client idx and staleness is  1 1
distance 2 is tensor(53667.0418, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53667.0418, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026782184839248657
current submit client idx and staleness is  2 1
distance 2 is tensor(53680.8665, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.8665, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.010754749178886414
current submit client idx and staleness is  3 1
distance 2 is tensor(53665.3689, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.3689, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.021417727693915367
current submit client idx and staleness is  4 1
distance 2 is tensor(53660.1566, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53660.1566, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06480716168880463
current submit client idx and staleness is  5 1
distance 2 is tensor(53672.6736, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.6736, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03941011428833008
current submit client idx and staleness is  6 1
distance 2 is tensor(53680.8365, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.8365, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.01180395670235157
current submit client idx and staleness is  7 1
distance 2 is tensor(53688.2131, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53688.2131, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0018985422793775797
current submit client idx and staleness is  48 1
distance 2 is tensor(54010.5156, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54010.5156, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19226595759391785
current submit client idx and staleness is  49 1
distance 2 is tensor(53665.8439, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.8439, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03560077026486397
current submit client idx and staleness is  50 1
distance 2 is tensor(53663.1089, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53663.1089, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.062207192182540894
current submit client idx and staleness is  51 1
distance 2 is tensor(53674.1268, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53674.1268, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08219949901103973
current submit client idx and staleness is  52 1
distance 2 is tensor(53711.5020, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53711.5020, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2416955530643463
current submit client idx and staleness is  53 1
distance 2 is tensor(53665.7735, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.7735, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.021147433668375015
current submit client idx and staleness is  54 1
distance 2 is tensor(53682.8305, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.8305, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.005139445886015892
current submit client idx and staleness is  55 1
distance 2 is tensor(53690.3594, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.3594, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04075177386403084
current submit client idx and staleness is  56 1
distance 2 is tensor(53788.7282, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53788.7282, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.29559651017189026
current submit client idx and staleness is  57 1
distance 2 is tensor(53663.5465, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53663.5465, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.020647410303354263
current submit client idx and staleness is  58 1
distance 2 is tensor(53670.9548, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.9548, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03589760139584541
current submit client idx and staleness is  59 1
distance 2 is tensor(53675.8378, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.8378, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.018059443682432175
sync_acc is 1.0000000005
sync_loss is 0.02235576882958412
sync_entropy is 0.03376314043998718
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [28, 30]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 76.20% 

Test Accuracy: 75.79% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53821.6215, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53821.6215, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3956718146800995
current submit client idx and staleness is  1 1
distance 2 is tensor(53676.1188, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.1188, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.017041200771927834
current submit client idx and staleness is  2 1
distance 2 is tensor(53970.3200, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53970.3200, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3659302592277527
current submit client idx and staleness is  3 1
distance 2 is tensor(53996.6382, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53996.6382, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5347989797592163
current submit client idx and staleness is  4 1
distance 2 is tensor(53684.9986, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.9986, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17095322906970978
current submit client idx and staleness is  5 1
distance 2 is tensor(53713.9023, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53713.9023, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2617468237876892
current submit client idx and staleness is  6 1
distance 2 is tensor(53691.4288, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.4288, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.020368538796901703
current submit client idx and staleness is  7 1
distance 2 is tensor(53700.0013, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53700.0013, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.008468631654977798
current submit client idx and staleness is  8 2
distance 2 is tensor(53980.2075, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53980.2075, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3922661542892456
current submit client idx and staleness is  9 2
distance 2 is tensor(53684.6316, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.6316, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.017907027155160904
current submit client idx and staleness is  10 2
distance 2 is tensor(53693.4106, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.4106, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02329886704683304
current submit client idx and staleness is  11 2
distance 2 is tensor(54040.7294, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54040.7294, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.46417561173439026
current submit client idx and staleness is  12 2
distance 2 is tensor(53849.2600, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53849.2600, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15018539130687714
current submit client idx and staleness is  13 2
distance 2 is tensor(53688.1938, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53688.1938, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1326761692762375
current submit client idx and staleness is  14 2
distance 2 is tensor(53901.3867, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53901.3867, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35952749848365784
current submit client idx and staleness is  15 2
distance 2 is tensor(53679.9219, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.9219, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.011924779042601585
current submit client idx and staleness is  24 4
distance 2 is tensor(54011.7164, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54011.7164, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22056512534618378
current submit client idx and staleness is  25 4
distance 2 is tensor(54028.2774, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54028.2774, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28157132863998413
current submit client idx and staleness is  26 4
distance 2 is tensor(54026.3586, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54026.3586, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.566495418548584
current submit client idx and staleness is  27 4
distance 2 is tensor(54018.1521, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54018.1521, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2976054251194
current submit client idx and staleness is  28 4
distance 2 is tensor(54101.3466, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54101.3466, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7910961508750916
current submit client idx and staleness is  29 4
distance 2 is tensor(54101.8037, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54101.8037, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5451244115829468
current submit client idx and staleness is  30 4
distance 2 is tensor(54073.2753, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54073.2753, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4481624960899353
current submit client idx and staleness is  31 4
distance 2 is tensor(54085.2230, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54085.2230, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4695773720741272
current submit client idx and staleness is  48 1
distance 2 is tensor(53954.0984, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53954.0984, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24234266579151154
current submit client idx and staleness is  49 1
distance 2 is tensor(53983.1237, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53983.1237, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17901822924613953
current submit client idx and staleness is  50 1
distance 2 is tensor(53669.1347, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53669.1347, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1071501150727272
current submit client idx and staleness is  51 1
distance 2 is tensor(53708.3109, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.3109, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.060091085731983185
current submit client idx and staleness is  52 1
distance 2 is tensor(53703.7909, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53703.7909, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11011457443237305
current submit client idx and staleness is  53 1
distance 2 is tensor(53662.7267, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53662.7267, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.008151373825967312
current submit client idx and staleness is  54 1
distance 2 is tensor(53702.0417, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.0417, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.037134382873773575
current submit client idx and staleness is  55 1
distance 2 is tensor(53755.7466, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53755.7466, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.029019558802247047
current submit client idx and staleness is  56 1
distance 2 is tensor(53678.9562, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.9562, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12641693651676178
current submit client idx and staleness is  57 1
distance 2 is tensor(53662.1947, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53662.1947, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.045090850442647934
current submit client idx and staleness is  58 1
distance 2 is tensor(53672.1938, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.1938, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08333227783441544
current submit client idx and staleness is  59 1
distance 2 is tensor(53673.1010, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.1010, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.013319263234734535
benign_acc is 0.9500000005
benign_loss is 0.07113774120807648
benign_entropy is 0.029251161962747574
benign_acc is 0.9500000005
benign_loss is 0.19930820167064667
benign_entropy is 0.024076705798506737
sync_acc is 0.9500000005
sync_loss is 0.03519352525472641
sync_entropy is 0.03573710471391678
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [30]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 76.30% 

Test Accuracy: 75.72% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53690.3065, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.3065, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.023681703954935074
current submit client idx and staleness is  1 1
distance 2 is tensor(53668.0137, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53668.0137, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.022322261705994606
current submit client idx and staleness is  2 1
distance 2 is tensor(53676.8690, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.8690, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05011656880378723
current submit client idx and staleness is  3 1
distance 2 is tensor(53678.7070, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.7070, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0512237474322319
current submit client idx and staleness is  4 1
distance 2 is tensor(54033.3018, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54033.3018, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2260388880968094
current submit client idx and staleness is  5 1
distance 2 is tensor(54013.0386, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54013.0386, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2824714779853821
current submit client idx and staleness is  6 1
distance 2 is tensor(53687.5701, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.5701, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.013994721695780754
current submit client idx and staleness is  7 1
distance 2 is tensor(53877.7406, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53877.7406, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12625929713249207
current submit client idx and staleness is  16 3
distance 2 is tensor(54017.9881, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54017.9881, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6316977143287659
current submit client idx and staleness is  17 3
distance 2 is tensor(54051.4264, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54051.4264, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4109885096549988
current submit client idx and staleness is  18 3
distance 2 is tensor(54059.3682, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54059.3682, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.39226868748664856
current submit client idx and staleness is  19 3
distance 2 is tensor(54035.2029, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54035.2029, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2586328983306885
current submit client idx and staleness is  20 3
distance 2 is tensor(54096.4808, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54096.4808, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3591635525226593
current submit client idx and staleness is  21 3
distance 2 is tensor(54051.3429, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54051.3429, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.33965015411376953
current submit client idx and staleness is  22 3
distance 2 is tensor(53732.2969, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53732.2969, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09751246124505997
current submit client idx and staleness is  23 3
distance 2 is tensor(54134.8995, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54134.8995, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16863876581192017
current submit client idx and staleness is  48 1
distance 2 is tensor(54125.0468, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54125.0468, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15003401041030884
current submit client idx and staleness is  49 1
distance 2 is tensor(53708.4061, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.4061, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0001284738100366667
current submit client idx and staleness is  50 1
distance 2 is tensor(53947.1834, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53947.1834, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06802980601787567
current submit client idx and staleness is  51 1
distance 2 is tensor(53898.3349, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53898.3349, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4952365458011627
current submit client idx and staleness is  52 1
distance 2 is tensor(54039.8248, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54039.8248, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3471035957336426
current submit client idx and staleness is  53 1
distance 2 is tensor(53687.0870, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.0870, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05113764479756355
current submit client idx and staleness is  54 1
distance 2 is tensor(53979.0888, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53979.0888, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5468281507492065
current submit client idx and staleness is  55 1
distance 2 is tensor(53780.3693, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53780.3693, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0910571962594986
current submit client idx and staleness is  56 1
distance 2 is tensor(53723.1545, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53723.1545, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.002154851332306862
current submit client idx and staleness is  57 1
distance 2 is tensor(53682.9607, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.9607, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0021337654907256365
current submit client idx and staleness is  58 1
distance 2 is tensor(53675.8915, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.8915, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03712709993124008
current submit client idx and staleness is  59 1
distance 2 is tensor(53682.6156, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.6156, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0358680821955204
benign_acc is 0.9500000005
benign_loss is 0.22046244144439697
benign_entropy is 0.017268106341362
sync_acc is 1.0000000005
sync_loss is 0.0017243071924895048
sync_entropy is 0.007768960203975439
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [32]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 76.02% 

Test Accuracy: 75.32% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53695.4982, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53695.4982, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08751652389764786
current submit client idx and staleness is  1 1
distance 2 is tensor(54116.8176, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54116.8176, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3245217502117157
current submit client idx and staleness is  2 1
distance 2 is tensor(53679.4978, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.4978, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.025534573942422867
current submit client idx and staleness is  3 1
distance 2 is tensor(53758.9281, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53758.9281, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23665408790111542
current submit client idx and staleness is  4 1
distance 2 is tensor(53673.3839, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.3839, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04064256697893143
current submit client idx and staleness is  5 1
distance 2 is tensor(53682.8669, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.8669, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.009310930967330933
current submit client idx and staleness is  6 1
distance 2 is tensor(53668.1684, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53668.1684, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0014940728433430195
current submit client idx and staleness is  7 1
distance 2 is tensor(54019.6885, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54019.6885, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7381079792976379
current submit client idx and staleness is  8 2
distance 2 is tensor(53677.3743, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53677.3743, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05506666749715805
current submit client idx and staleness is  9 2
distance 2 is tensor(54074.3825, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54074.3825, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6554974317550659
current submit client idx and staleness is  10 2
distance 2 is tensor(54101.8696, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54101.8696, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23144981265068054
current submit client idx and staleness is  11 2
distance 2 is tensor(53906.1190, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53906.1190, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.46426957845687866
current submit client idx and staleness is  12 2
distance 2 is tensor(54006.8209, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54006.8209, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.37822139263153076
current submit client idx and staleness is  13 2
distance 2 is tensor(53992.5500, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53992.5500, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24483899772167206
current submit client idx and staleness is  14 2
distance 2 is tensor(53908.2317, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53908.2317, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10004343837499619
current submit client idx and staleness is  15 2
distance 2 is tensor(53676.9660, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.9660, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.005242845509201288
current submit client idx and staleness is  48 1
distance 2 is tensor(53702.7329, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.7329, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0326683446764946
current submit client idx and staleness is  49 1
distance 2 is tensor(53651.9375, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53651.9375, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.004629918839782476
current submit client idx and staleness is  50 1
distance 2 is tensor(53663.6581, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53663.6581, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.014038404449820518
current submit client idx and staleness is  51 1
distance 2 is tensor(53691.4072, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.4072, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08145610243082047
current submit client idx and staleness is  52 1
distance 2 is tensor(53676.2594, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.2594, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24537333846092224
current submit client idx and staleness is  53 1
distance 2 is tensor(53666.0866, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53666.0866, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0053758760914206505
current submit client idx and staleness is  54 1
distance 2 is tensor(53697.3329, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53697.3329, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04001545533537865
current submit client idx and staleness is  55 1
distance 2 is tensor(53783.4300, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53783.4300, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18706266582012177
current submit client idx and staleness is  56 1
distance 2 is tensor(53731.4708, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53731.4708, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06697837263345718
current submit client idx and staleness is  57 1
distance 2 is tensor(53690.2370, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.2370, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.005210299044847488
current submit client idx and staleness is  58 1
distance 2 is tensor(53699.5530, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53699.5530, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0719350129365921
current submit client idx and staleness is  59 1
distance 2 is tensor(53658.1186, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53658.1186, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04508812353014946
benign_acc is 1.0000000005
benign_loss is 0.02018965221941471
benign_entropy is 0.03522346168756485
sync_acc is 1.0000000005
sync_loss is 0.010183854959905148
sync_entropy is 0.02462635189294815
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [30]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 76.26% 

Test Accuracy: 75.73% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53705.7744, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.7744, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06000799685716629
current submit client idx and staleness is  1 1
distance 2 is tensor(53674.4674, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53674.4674, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.012300299480557442
current submit client idx and staleness is  2 1
distance 2 is tensor(53691.3454, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.3454, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02308744564652443
current submit client idx and staleness is  3 1
distance 2 is tensor(53671.4031, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53671.4031, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.00927688367664814
current submit client idx and staleness is  4 1
distance 2 is tensor(53681.4296, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53681.4296, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06417877972126007
current submit client idx and staleness is  5 1
distance 2 is tensor(53681.9891, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53681.9891, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13704945147037506
current submit client idx and staleness is  6 1
distance 2 is tensor(53669.1906, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53669.1906, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.013562698848545551
current submit client idx and staleness is  7 1
distance 2 is tensor(53683.1808, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53683.1808, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0017381671350449324
current submit client idx and staleness is  32 5
distance 2 is tensor(54024.7484, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54024.7484, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35631656646728516
current submit client idx and staleness is  33 5
distance 2 is tensor(54046.8496, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54046.8496, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1161232441663742
current submit client idx and staleness is  34 5
distance 2 is tensor(54045.3535, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54045.3535, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.36737462878227234
current submit client idx and staleness is  35 5
distance 2 is tensor(54050.7195, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54050.7195, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21522435545921326
current submit client idx and staleness is  36 5
distance 2 is tensor(54077.0269, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54077.0269, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19216449558734894
current submit client idx and staleness is  37 5
distance 2 is tensor(54012.6488, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54012.6488, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.37000617384910583
current submit client idx and staleness is  38 5
distance 2 is tensor(54029.5299, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54029.5299, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18510958552360535
current submit client idx and staleness is  39 5
distance 2 is tensor(54084.4860, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54084.4860, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3194829523563385
current submit client idx and staleness is  48 1
distance 2 is tensor(53676.2697, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.2697, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08274652063846588
current submit client idx and staleness is  49 1
distance 2 is tensor(53664.0559, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53664.0559, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.020126553252339363
current submit client idx and staleness is  50 1
distance 2 is tensor(53673.6291, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.6291, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04634159430861473
current submit client idx and staleness is  51 1
distance 2 is tensor(54021.1102, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54021.1102, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.45413780212402344
current submit client idx and staleness is  52 1
distance 2 is tensor(53988.8292, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53988.8292, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5707012414932251
current submit client idx and staleness is  53 1
distance 2 is tensor(53667.2479, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53667.2479, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.006990228779613972
current submit client idx and staleness is  54 1
distance 2 is tensor(53882.0206, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53882.0206, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.30501917004585266
current submit client idx and staleness is  55 1
distance 2 is tensor(53679.2359, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.2359, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0032061568927019835
current submit client idx and staleness is  56 1
distance 2 is tensor(53702.9866, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.9866, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0618317648768425
current submit client idx and staleness is  57 1
distance 2 is tensor(53685.8395, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53685.8395, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.005187743343412876
current submit client idx and staleness is  58 1
distance 2 is tensor(53678.3760, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.3760, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15199542045593262
current submit client idx and staleness is  59 1
distance 2 is tensor(53690.9725, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.9725, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026769716292619705
benign_acc is 0.9500000005
benign_loss is 0.13814373314380646
benign_entropy is 0.04295150190591812
sync_acc is 1.0000000005
sync_loss is 0.014518579468131065
sync_entropy is 0.029057541862130165
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [30, 32, 33, 34]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 76.32% 

Test Accuracy: 75.90% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53698.6028, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.6028, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07485481351613998
current submit client idx and staleness is  1 1
distance 2 is tensor(53705.5740, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.5740, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13158643245697021
current submit client idx and staleness is  2 1
distance 2 is tensor(53691.6810, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.6810, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.053290266543626785
current submit client idx and staleness is  3 1
distance 2 is tensor(53700.8752, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53700.8752, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11379997432231903
current submit client idx and staleness is  4 1
distance 2 is tensor(53711.6482, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53711.6482, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.159846693277359
current submit client idx and staleness is  5 1
distance 2 is tensor(53693.4203, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.4203, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10125366598367691
current submit client idx and staleness is  6 1
distance 2 is tensor(53699.6208, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53699.6208, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.034548889845609665
current submit client idx and staleness is  7 1
distance 2 is tensor(53759.0880, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53759.0880, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03967530280351639
current submit client idx and staleness is  8 2
distance 2 is tensor(53728.4806, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53728.4806, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03209737688302994
current submit client idx and staleness is  9 2
distance 2 is tensor(53690.6957, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.6957, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14029450714588165
current submit client idx and staleness is  10 2
distance 2 is tensor(53698.4578, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.4578, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.027556821703910828
current submit client idx and staleness is  11 2
distance 2 is tensor(53725.5465, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53725.5465, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.014434981159865856
current submit client idx and staleness is  12 2
distance 2 is tensor(53777.7531, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53777.7531, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.45071229338645935
current submit client idx and staleness is  13 2
distance 2 is tensor(53848.6319, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53848.6319, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22924180328845978
current submit client idx and staleness is  14 2
distance 2 is tensor(53716.4801, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53716.4801, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05473559349775314
current submit client idx and staleness is  15 2
distance 2 is tensor(53702.9743, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.9743, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10638923943042755
current submit client idx and staleness is  16 3
distance 2 is tensor(53957.8149, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53957.8149, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35938316583633423
current submit client idx and staleness is  17 3
distance 2 is tensor(53982.2891, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.2891, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.418093204498291
current submit client idx and staleness is  18 3
distance 2 is tensor(54086.6067, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54086.6067, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22254279255867004
current submit client idx and staleness is  19 3
distance 2 is tensor(53998.3109, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53998.3109, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3938044011592865
current submit client idx and staleness is  20 3
distance 2 is tensor(54012.6660, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54012.6660, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.34118032455444336
current submit client idx and staleness is  21 3
distance 2 is tensor(53817.9293, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53817.9293, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07155132293701172
current submit client idx and staleness is  22 3
distance 2 is tensor(53871.9717, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53871.9717, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10722942650318146
current submit client idx and staleness is  23 3
distance 2 is tensor(53963.7075, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53963.7075, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.31883031129837036
current submit client idx and staleness is  24 4
distance 2 is tensor(53973.5736, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53973.5736, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4179869592189789
current submit client idx and staleness is  25 4
distance 2 is tensor(53976.1130, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53976.1130, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.26467010378837585
current submit client idx and staleness is  26 4
distance 2 is tensor(53985.5312, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53985.5312, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09939396381378174
current submit client idx and staleness is  27 4
distance 2 is tensor(54035.7784, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54035.7784, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3766723573207855
current submit client idx and staleness is  28 4
distance 2 is tensor(53975.5585, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53975.5585, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4077800214290619
current submit client idx and staleness is  29 4
distance 2 is tensor(54002.0535, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54002.0535, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14922010898590088
current submit client idx and staleness is  30 4
distance 2 is tensor(53992.2522, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53992.2522, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2504420876502991
current submit client idx and staleness is  31 4
distance 2 is tensor(54007.3748, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54007.3748, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10866520553827286
current submit client idx and staleness is  40 6
distance 2 is tensor(54028.5219, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54028.5219, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5999298095703125
current submit client idx and staleness is  41 6
distance 2 is tensor(53992.1305, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53992.1305, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15606173872947693
current submit client idx and staleness is  42 6
distance 2 is tensor(53970.7920, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53970.7920, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07707582414150238
current submit client idx and staleness is  43 6
distance 2 is tensor(54025.6731, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54025.6731, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.42074671387672424
current submit client idx and staleness is  44 6
distance 2 is tensor(54079.1275, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54079.1275, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15428434312343597
current submit client idx and staleness is  45 6
distance 2 is tensor(54044.3372, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54044.3372, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12642396986484528
current submit client idx and staleness is  46 6
distance 2 is tensor(54013.7624, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54013.7624, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35686683654785156
current submit client idx and staleness is  47 6
distance 2 is tensor(54050.5841, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54050.5841, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.46989068388938904
current submit client idx and staleness is  48 1
distance 2 is tensor(53755.3826, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53755.3826, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04606173560023308
current submit client idx and staleness is  49 1
distance 2 is tensor(53679.7994, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.7994, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04471259564161301
current submit client idx and staleness is  50 1
distance 2 is tensor(53721.7580, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53721.7580, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19649554789066315
current submit client idx and staleness is  51 1
distance 2 is tensor(53704.7166, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53704.7166, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1358141303062439
current submit client idx and staleness is  52 1
distance 2 is tensor(53718.7432, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53718.7432, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07144581526517868
current submit client idx and staleness is  53 1
distance 2 is tensor(53684.6705, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.6705, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07909853756427765
current submit client idx and staleness is  54 1
distance 2 is tensor(53696.9803, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53696.9803, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05075656622648239
current submit client idx and staleness is  55 1
distance 2 is tensor(53877.9449, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53877.9449, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3181142508983612
current submit client idx and staleness is  56 1
distance 2 is tensor(53706.3515, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53706.3515, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1761777698993683
current submit client idx and staleness is  57 1
distance 2 is tensor(53691.0416, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.0416, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04238423705101013
current submit client idx and staleness is  58 1
distance 2 is tensor(53724.9181, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53724.9181, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1259237825870514
current submit client idx and staleness is  59 1
distance 2 is tensor(53696.5452, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53696.5452, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10356787592172623
benign_acc is 0.9500000005
benign_loss is 0.06353097409009933
benign_entropy is 0.032674435526132584
benign_acc is 0.9500000005
benign_loss is 0.12330927699804306
benign_entropy is 0.027557486668229103
benign_acc is 0.9500000005
benign_loss is 0.07739094644784927
benign_entropy is 0.03891349956393242
benign_acc is 1.0000000005
benign_loss is 0.03409790247678757
benign_entropy is 0.08198931068181992
sync_acc is 0.9500000005
sync_loss is 0.05360104888677597
sync_entropy is 0.03422285616397858
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 76.27% 

Test Accuracy: 75.77% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53972.4781, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53972.4781, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23383334279060364
current submit client idx and staleness is  1 1
distance 2 is tensor(53837.2696, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53837.2696, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1184285506606102
current submit client idx and staleness is  2 1
distance 2 is tensor(53673.2630, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.2630, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.018411576747894287
current submit client idx and staleness is  3 1
distance 2 is tensor(53658.6690, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53658.6690, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02039336785674095
current submit client idx and staleness is  4 1
distance 2 is tensor(54018.5717, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54018.5717, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.49508461356163025
current submit client idx and staleness is  5 1
distance 2 is tensor(53682.0386, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.0386, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07055783271789551
current submit client idx and staleness is  6 1
distance 2 is tensor(53898.8970, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53898.8970, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0066640181466937065
current submit client idx and staleness is  7 1
distance 2 is tensor(53860.9367, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53860.9367, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10043410211801529
current submit client idx and staleness is  48 1
distance 2 is tensor(53711.0130, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53711.0130, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10228680074214935
current submit client idx and staleness is  49 1
distance 2 is tensor(53665.5050, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.5050, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03817670792341232
current submit client idx and staleness is  50 1
distance 2 is tensor(53672.4314, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.4314, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16808141767978668
current submit client idx and staleness is  51 1
distance 2 is tensor(54055.3685, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54055.3685, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1520799845457077
current submit client idx and staleness is  52 1
distance 2 is tensor(53717.2903, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53717.2903, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14116376638412476
current submit client idx and staleness is  53 1
distance 2 is tensor(53890.8930, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53890.8930, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20519618690013885
current submit client idx and staleness is  54 1
distance 2 is tensor(53671.7877, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53671.7877, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.060179997235536575
current submit client idx and staleness is  55 1
distance 2 is tensor(53828.3693, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53828.3693, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06266743689775467
current submit client idx and staleness is  56 1
distance 2 is tensor(53661.6903, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53661.6903, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07003363966941833
current submit client idx and staleness is  57 1
distance 2 is tensor(53726.2971, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53726.2971, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.040451064705848694
current submit client idx and staleness is  58 1
distance 2 is tensor(53684.0150, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.0150, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12072776257991791
current submit client idx and staleness is  59 1
distance 2 is tensor(54071.7894, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54071.7894, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13194580376148224
sync_acc is 0.9500000005
sync_loss is 0.0374734103679657
sync_entropy is 0.03689790889620781
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [36]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 76.06% 

Test Accuracy: 75.59% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53832.7981, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53832.7981, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3020079731941223
current submit client idx and staleness is  1 1
distance 2 is tensor(54013.7351, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54013.7351, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23560109734535217
current submit client idx and staleness is  2 1
distance 2 is tensor(53679.0582, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.0582, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.011477853171527386
current submit client idx and staleness is  3 1
distance 2 is tensor(53665.4966, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.4966, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08646263927221298
current submit client idx and staleness is  4 1
distance 2 is tensor(53666.4144, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53666.4144, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10857585817575455
current submit client idx and staleness is  5 1
distance 2 is tensor(53933.3893, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53933.3893, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8331446647644043
current submit client idx and staleness is  6 1
distance 2 is tensor(53649.3698, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53649.3698, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.030614208430051804
current submit client idx and staleness is  7 1
distance 2 is tensor(53677.6673, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53677.6673, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07401859760284424
current submit client idx and staleness is  8 2
distance 2 is tensor(53668.6248, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53668.6248, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0494273342192173
current submit client idx and staleness is  9 2
distance 2 is tensor(53682.1737, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.1737, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06801876425743103
current submit client idx and staleness is  10 2
distance 2 is tensor(53918.5077, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53918.5077, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35746926069259644
current submit client idx and staleness is  11 2
distance 2 is tensor(53752.1140, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53752.1140, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08583179861307144
current submit client idx and staleness is  12 2
distance 2 is tensor(53791.3117, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53791.3117, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20064978301525116
current submit client idx and staleness is  13 2
distance 2 is tensor(53692.2361, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53692.2361, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.048107653856277466
current submit client idx and staleness is  14 2
distance 2 is tensor(53999.2502, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53999.2502, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09927761554718018
current submit client idx and staleness is  15 2
distance 2 is tensor(53923.8607, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53923.8607, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2045319825410843
current submit client idx and staleness is  48 1
distance 2 is tensor(53964.1592, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53964.1592, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.354108989238739
current submit client idx and staleness is  49 1
distance 2 is tensor(53662.4782, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53662.4782, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.028285298496484756
current submit client idx and staleness is  50 1
distance 2 is tensor(53698.7351, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.7351, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04544640704989433
current submit client idx and staleness is  51 1
distance 2 is tensor(53682.9268, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.9268, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07379493117332458
current submit client idx and staleness is  52 1
distance 2 is tensor(54041.7738, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54041.7738, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.531093955039978
current submit client idx and staleness is  53 1
distance 2 is tensor(53689.1014, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.1014, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04579322040081024
current submit client idx and staleness is  54 1
distance 2 is tensor(53949.4212, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53949.4212, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3220503628253937
current submit client idx and staleness is  55 1
distance 2 is tensor(53672.1231, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.1231, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0664215162396431
current submit client idx and staleness is  56 1
distance 2 is tensor(53854.4345, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53854.4345, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6128128170967102
current submit client idx and staleness is  57 1
distance 2 is tensor(53689.7702, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.7702, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15665945410728455
current submit client idx and staleness is  58 1
distance 2 is tensor(53691.7216, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.7216, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03402865678071976
current submit client idx and staleness is  59 1
distance 2 is tensor(53656.4263, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53656.4263, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04046973958611488
benign_acc is 0.9500000005
benign_loss is 0.052041590213775635
benign_entropy is 0.03709014877676964
sync_acc is 0.9500000005
sync_loss is 0.07522352039813995
sync_entropy is 0.028170961886644363
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [36]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 76.32% 

Test Accuracy: 75.94% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53676.3797, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.3797, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14602886140346527
current submit client idx and staleness is  1 1
distance 2 is tensor(53735.2159, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53735.2159, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.030093472450971603
current submit client idx and staleness is  2 1
distance 2 is tensor(53676.8966, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.8966, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07937486469745636
current submit client idx and staleness is  3 1
distance 2 is tensor(53673.2874, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.2874, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.053129661828279495
current submit client idx and staleness is  4 1
distance 2 is tensor(53680.8352, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.8352, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16172842681407928
current submit client idx and staleness is  5 1
distance 2 is tensor(53890.3020, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53890.3020, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10099700838327408
current submit client idx and staleness is  6 1
distance 2 is tensor(53664.7108, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53664.7108, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07110490649938583
current submit client idx and staleness is  7 1
distance 2 is tensor(53691.1527, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.1527, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.033344417810440063
current submit client idx and staleness is  16 3
distance 2 is tensor(53954.9501, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53954.9501, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22961001098155975
current submit client idx and staleness is  17 3
distance 2 is tensor(54115.9281, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54115.9281, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8511649370193481
current submit client idx and staleness is  18 3
distance 2 is tensor(54025.1826, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54025.1826, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.40419802069664
current submit client idx and staleness is  19 3
distance 2 is tensor(54019.4328, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54019.4328, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19307473301887512
current submit client idx and staleness is  20 3
distance 2 is tensor(53989.4165, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53989.4165, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.7476638555526733
current submit client idx and staleness is  21 3
distance 2 is tensor(53708.0403, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.0403, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.23333080112934113
current submit client idx and staleness is  22 3
distance 2 is tensor(54006.2535, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54006.2535, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15807834267616272
current submit client idx and staleness is  23 3
distance 2 is tensor(54025.6446, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54025.6446, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2603420317173004
current submit client idx and staleness is  48 1
distance 2 is tensor(53677.9295, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53677.9295, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04244326800107956
current submit client idx and staleness is  49 1
distance 2 is tensor(53672.3089, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.3089, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0882159024477005
current submit client idx and staleness is  50 1
distance 2 is tensor(53711.3859, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53711.3859, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15650731325149536
current submit client idx and staleness is  51 1
distance 2 is tensor(53679.5332, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.5332, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06759358942508698
current submit client idx and staleness is  52 1
distance 2 is tensor(53775.6089, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53775.6089, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3685547411441803
current submit client idx and staleness is  53 1
distance 2 is tensor(53678.2284, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.2284, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06943348050117493
current submit client idx and staleness is  54 1
distance 2 is tensor(53698.6442, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.6442, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.094956174492836
current submit client idx and staleness is  55 1
distance 2 is tensor(53692.5251, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53692.5251, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08469700813293457
current submit client idx and staleness is  56 1
distance 2 is tensor(53686.2526, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53686.2526, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2162143439054489
current submit client idx and staleness is  57 1
distance 2 is tensor(53673.7417, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.7417, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08399631083011627
current submit client idx and staleness is  58 1
distance 2 is tensor(53987.9919, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53987.9919, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4503494203090668
current submit client idx and staleness is  59 1
distance 2 is tensor(53693.1968, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.1968, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09780983626842499
benign_acc is 0.9500000005
benign_loss is 0.18119306862354279
benign_entropy is 0.026772765442728996
sync_acc is 0.9500000005
sync_loss is 0.06441285461187363
sync_entropy is 0.03263280913233757
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [35, 36, 38]
alphas 3 is [1.   0.2  0.25 0.5 ]
alphas is  [0.51282051 0.1025641  0.12820513 0.25641026]
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 76.34% 

Test Accuracy: 76.01% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53683.5233, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53683.5233, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0833476334810257
current submit client idx and staleness is  1 1
distance 2 is tensor(53675.7224, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.7224, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07418002188205719
current submit client idx and staleness is  2 1
distance 2 is tensor(53685.7998, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53685.7998, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08400709927082062
current submit client idx and staleness is  3 1
distance 2 is tensor(53702.1797, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.1797, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04717346653342247
current submit client idx and staleness is  4 1
distance 2 is tensor(53752.3062, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53752.3062, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0738644227385521
current submit client idx and staleness is  5 1
distance 2 is tensor(53704.9471, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53704.9471, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1761789619922638
current submit client idx and staleness is  6 1
distance 2 is tensor(53665.0695, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.0695, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04123765975236893
current submit client idx and staleness is  7 1
distance 2 is tensor(53679.8721, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.8721, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.016926173120737076
current submit client idx and staleness is  8 2
distance 2 is tensor(53707.0335, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53707.0335, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08679552376270294
current submit client idx and staleness is  9 2
distance 2 is tensor(53728.6446, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53728.6446, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.038592029362916946
current submit client idx and staleness is  10 2
distance 2 is tensor(53703.0899, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53703.0899, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2258191555738449
current submit client idx and staleness is  11 2
distance 2 is tensor(53779.6015, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53779.6015, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04639459401369095
current submit client idx and staleness is  12 2
distance 2 is tensor(53735.3872, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53735.3872, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07463395595550537
current submit client idx and staleness is  13 2
distance 2 is tensor(53708.2674, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.2674, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0902244821190834
current submit client idx and staleness is  14 2
distance 2 is tensor(53999.2863, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53999.2863, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.9429356455802917
current submit client idx and staleness is  15 2
distance 2 is tensor(53899.5065, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53899.5065, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12123441696166992
current submit client idx and staleness is  24 4
distance 2 is tensor(54009.8185, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54009.8185, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.35666951537132263
current submit client idx and staleness is  25 4
distance 2 is tensor(53977.6690, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53977.6690, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22664079070091248
current submit client idx and staleness is  26 4
distance 2 is tensor(54060.6753, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54060.6753, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24774399399757385
current submit client idx and staleness is  27 4
distance 2 is tensor(54003.8567, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54003.8567, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4035421311855316
current submit client idx and staleness is  28 4
distance 2 is tensor(54059.1463, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54059.1463, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5809077024459839
current submit client idx and staleness is  29 4
distance 2 is tensor(54023.8966, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54023.8966, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.31003138422966003
current submit client idx and staleness is  30 4
distance 2 is tensor(53983.0982, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53983.0982, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2362111508846283
current submit client idx and staleness is  31 4
distance 2 is tensor(54024.5487, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54024.5487, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2864624857902527
current submit client idx and staleness is  32 5
distance 2 is tensor(53962.1931, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53962.1931, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19995786249637604
current submit client idx and staleness is  33 5
distance 2 is tensor(54036.5883, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54036.5883, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13348467648029327
current submit client idx and staleness is  34 5
distance 2 is tensor(54038.1993, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54038.1993, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5588319897651672
current submit client idx and staleness is  35 5
distance 2 is tensor(53978.1278, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53978.1278, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10413229465484619
current submit client idx and staleness is  36 5
distance 2 is tensor(54000.3089, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54000.3089, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8500609397888184
current submit client idx and staleness is  37 5
distance 2 is tensor(54049.7621, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54049.7621, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5168412923812866
current submit client idx and staleness is  38 5
distance 2 is tensor(53962.3755, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53962.3755, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12905481457710266
current submit client idx and staleness is  39 5
distance 2 is tensor(54023.1410, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54023.1410, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026035863906145096
current submit client idx and staleness is  48 1
distance 2 is tensor(53702.7156, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53702.7156, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12354619801044464
current submit client idx and staleness is  49 1
distance 2 is tensor(53683.9370, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53683.9370, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1427474170923233
current submit client idx and staleness is  50 1
distance 2 is tensor(53705.0053, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.0053, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1190665140748024
current submit client idx and staleness is  51 1
distance 2 is tensor(53923.5875, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53923.5875, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16101986169815063
current submit client idx and staleness is  52 1
distance 2 is tensor(53961.1529, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53961.1529, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09153197705745697
current submit client idx and staleness is  53 1
distance 2 is tensor(53680.4272, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.4272, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.029751047492027283
current submit client idx and staleness is  54 1
distance 2 is tensor(53708.8855, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.8855, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08180253207683563
current submit client idx and staleness is  55 1
distance 2 is tensor(53868.1253, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53868.1253, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32387107610702515
current submit client idx and staleness is  56 1
distance 2 is tensor(53736.1540, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53736.1540, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16036739945411682
current submit client idx and staleness is  57 1
distance 2 is tensor(53682.0857, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.0857, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.031369395554065704
current submit client idx and staleness is  58 1
distance 2 is tensor(53704.2690, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53704.2690, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05883895233273506
current submit client idx and staleness is  59 1
distance 2 is tensor(53698.2227, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.2227, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.043539874255657196
benign_acc is 0.9500000005
benign_loss is 0.07259546220302582
benign_entropy is 0.029621973633766174
benign_acc is 0.9500000005
benign_loss is 0.14737504720687866
benign_entropy is 0.02003171108663082
benign_acc is 1.0000000005
benign_loss is 0.03721880167722702
benign_entropy is 0.0630389153957367
sync_acc is 0.9500000005
sync_loss is 0.054174065589904785
sync_entropy is 0.03395473584532738
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 76.31% 

Test Accuracy: 76.02% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53688.9847, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53688.9847, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0870741680264473
current submit client idx and staleness is  1 1
distance 2 is tensor(53669.0945, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53669.0945, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.012414587661623955
current submit client idx and staleness is  2 1
distance 2 is tensor(53676.2598, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.2598, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.025220150128006935
current submit client idx and staleness is  3 1
distance 2 is tensor(53665.8496, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.8496, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05475718900561333
current submit client idx and staleness is  4 1
distance 2 is tensor(53699.3227, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53699.3227, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05089116096496582
current submit client idx and staleness is  5 1
distance 2 is tensor(53916.1797, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53916.1797, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2741648256778717
current submit client idx and staleness is  6 1
distance 2 is tensor(53655.7346, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53655.7346, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.020376283675432205
current submit client idx and staleness is  7 1
distance 2 is tensor(53707.0659, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53707.0659, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1463947594165802
current submit client idx and staleness is  48 1
distance 2 is tensor(53763.4765, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53763.4765, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.20839174091815948
current submit client idx and staleness is  49 1
distance 2 is tensor(53682.9099, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.9099, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026895347982645035
current submit client idx and staleness is  50 1
distance 2 is tensor(53673.6655, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.6655, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.061135612428188324
current submit client idx and staleness is  51 1
distance 2 is tensor(53694.6410, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.6410, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12655000388622284
current submit client idx and staleness is  52 1
distance 2 is tensor(53681.9656, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53681.9656, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2592262327671051
current submit client idx and staleness is  53 1
distance 2 is tensor(53650.2358, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53650.2358, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02908724918961525
current submit client idx and staleness is  54 1
distance 2 is tensor(53697.9692, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53697.9692, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09005264937877655
current submit client idx and staleness is  55 1
distance 2 is tensor(53681.1972, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53681.1972, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0834527537226677
current submit client idx and staleness is  56 1
distance 2 is tensor(53670.8842, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.8842, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.32064560055732727
current submit client idx and staleness is  57 1
distance 2 is tensor(53687.5741, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.5741, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08293139934539795
current submit client idx and staleness is  58 1
distance 2 is tensor(53716.0656, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53716.0656, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1788182556629181
current submit client idx and staleness is  59 1
distance 2 is tensor(53662.1714, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53662.1714, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04488291218876839
sync_acc is 0.9500000005
sync_loss is 0.05410146713256836
sync_entropy is 0.033863019198179245
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [36, 39, 40]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 76.39% 

Test Accuracy: 76.26% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53698.9062, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.9062, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06771272420883179
current submit client idx and staleness is  1 1
distance 2 is tensor(53671.6669, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53671.6669, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.017877468839287758
current submit client idx and staleness is  2 1
distance 2 is tensor(53690.6184, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.6184, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02717619575560093
current submit client idx and staleness is  3 1
distance 2 is tensor(53671.4074, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53671.4074, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05261703580617905
current submit client idx and staleness is  4 1
distance 2 is tensor(53686.4978, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53686.4978, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2741079330444336
current submit client idx and staleness is  5 1
distance 2 is tensor(53854.7358, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53854.7358, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19065822660923004
current submit client idx and staleness is  6 1
distance 2 is tensor(53935.3294, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53935.3294, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09709031134843826
current submit client idx and staleness is  7 1
distance 2 is tensor(53687.8674, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.8674, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07885619252920151
current submit client idx and staleness is  8 2
distance 2 is tensor(53802.2491, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53802.2491, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.012206519022583961
current submit client idx and staleness is  9 2
distance 2 is tensor(53708.9403, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53708.9403, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3016760051250458
current submit client idx and staleness is  10 2
distance 2 is tensor(54019.7013, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54019.7013, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5032073259353638
current submit client idx and staleness is  11 2
distance 2 is tensor(53942.6283, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53942.6283, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5561591386795044
current submit client idx and staleness is  12 2
distance 2 is tensor(53904.4251, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53904.4251, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4801761507987976
current submit client idx and staleness is  13 2
distance 2 is tensor(53854.7722, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53854.7722, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.40536633133888245
current submit client idx and staleness is  14 2
distance 2 is tensor(53824.0030, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53824.0030, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18875832855701447
current submit client idx and staleness is  15 2
distance 2 is tensor(53675.7908, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.7908, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0940236896276474
current submit client idx and staleness is  16 3
distance 2 is tensor(54061.9975, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54061.9975, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.43972116708755493
current submit client idx and staleness is  17 3
distance 2 is tensor(53942.9708, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53942.9708, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3795805871486664
current submit client idx and staleness is  18 3
distance 2 is tensor(53983.1197, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53983.1197, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.25647279620170593
current submit client idx and staleness is  19 3
distance 2 is tensor(54069.6418, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54069.6418, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.662084698677063
current submit client idx and staleness is  20 3
distance 2 is tensor(54112.5669, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54112.5669, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.46268749237060547
current submit client idx and staleness is  21 3
distance 2 is tensor(53724.6463, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53724.6463, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10463591665029526
current submit client idx and staleness is  22 3
distance 2 is tensor(53738.6429, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53738.6429, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10017553716897964
current submit client idx and staleness is  23 3
distance 2 is tensor(53929.4243, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53929.4243, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.30681654810905457
current submit client idx and staleness is  40 6
distance 2 is tensor(54039.3600, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54039.3600, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3441384434700012
current submit client idx and staleness is  41 6
distance 2 is tensor(54009.1380, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54009.1380, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08910511434078217
current submit client idx and staleness is  42 6
distance 2 is tensor(54035.7022, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54035.7022, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.33088219165802
current submit client idx and staleness is  43 6
distance 2 is tensor(54090.1413, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54090.1413, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.391354501247406
current submit client idx and staleness is  44 6
distance 2 is tensor(54052.0684, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54052.0684, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0367593877017498
current submit client idx and staleness is  45 6
distance 2 is tensor(54065.7586, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54065.7586, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09157312661409378
current submit client idx and staleness is  46 6
distance 2 is tensor(54036.9419, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54036.9419, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.38763365149497986
current submit client idx and staleness is  47 6
distance 2 is tensor(54095.8661, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54095.8661, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.43046703934669495
current submit client idx and staleness is  48 1
distance 2 is tensor(53704.1189, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53704.1189, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09694193303585052
current submit client idx and staleness is  49 1
distance 2 is tensor(53670.4516, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.4516, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.011891992762684822
current submit client idx and staleness is  50 1
distance 2 is tensor(53700.8534, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53700.8534, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07065069675445557
current submit client idx and staleness is  51 1
distance 2 is tensor(53734.4370, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53734.4370, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11179278045892715
current submit client idx and staleness is  52 1
distance 2 is tensor(53755.3098, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53755.3098, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2507912516593933
current submit client idx and staleness is  53 1
distance 2 is tensor(53673.8706, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.8706, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07121049612760544
current submit client idx and staleness is  54 1
distance 2 is tensor(53718.0127, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53718.0127, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026435863226652145
current submit client idx and staleness is  55 1
distance 2 is tensor(53838.1496, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53838.1496, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10008760541677475
current submit client idx and staleness is  56 1
distance 2 is tensor(53683.8187, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53683.8187, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15591666102409363
current submit client idx and staleness is  57 1
distance 2 is tensor(53685.0627, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53685.0627, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17946727573871613
current submit client idx and staleness is  58 1
distance 2 is tensor(53782.7416, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53782.7416, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22674477100372314
current submit client idx and staleness is  59 1
distance 2 is tensor(53684.8099, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.8099, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06684157997369766
benign_acc is 0.9500000005
benign_loss is 0.05689143016934395
benign_entropy is 0.042962636798620224
benign_acc is 0.9500000005
benign_loss is 0.21484661102294922
benign_entropy is 0.010286670178174973
benign_acc is 0.9500000005
benign_loss is 0.05381295830011368
benign_entropy is 0.07013746351003647
sync_acc is 0.9500000005
sync_loss is 0.05845186859369278
sync_entropy is 0.034750018268823624
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 76.41% 

Test Accuracy: 75.97% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53661.8701, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53661.8701, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.077010378241539
current submit client idx and staleness is  1 1
distance 2 is tensor(53667.8619, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53667.8619, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.040731482207775116
current submit client idx and staleness is  2 1
distance 2 is tensor(53665.1224, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.1224, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0796792060136795
current submit client idx and staleness is  3 1
distance 2 is tensor(53967.4062, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53967.4062, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15799814462661743
current submit client idx and staleness is  4 1
distance 2 is tensor(53682.0436, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.0436, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05457253009080887
current submit client idx and staleness is  5 1
distance 2 is tensor(54003.2560, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54003.2560, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1554567962884903
current submit client idx and staleness is  6 1
distance 2 is tensor(53812.4047, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53812.4047, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.030388835817575455
current submit client idx and staleness is  7 1
distance 2 is tensor(53670.4310, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.4310, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.041230618953704834
current submit client idx and staleness is  48 1
distance 2 is tensor(53686.7115, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53686.7115, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.038191862404346466
current submit client idx and staleness is  49 1
distance 2 is tensor(53668.7728, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53668.7728, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.052354324609041214
current submit client idx and staleness is  50 1
distance 2 is tensor(53690.0394, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.0394, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1305219829082489
current submit client idx and staleness is  51 1
distance 2 is tensor(53679.4891, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.4891, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07692869752645493
current submit client idx and staleness is  52 1
distance 2 is tensor(53942.3263, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53942.3263, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.47408485412597656
current submit client idx and staleness is  53 1
distance 2 is tensor(53652.9458, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53652.9458, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06256548315286636
current submit client idx and staleness is  54 1
distance 2 is tensor(53693.4713, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.4713, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04254753515124321
current submit client idx and staleness is  55 1
distance 2 is tensor(54089.5225, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54089.5225, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3826323449611664
current submit client idx and staleness is  56 1
distance 2 is tensor(53668.5862, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53668.5862, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04237981140613556
current submit client idx and staleness is  57 1
distance 2 is tensor(53698.3667, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.3667, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.00995578058063984
current submit client idx and staleness is  58 1
distance 2 is tensor(53684.9424, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.9424, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11900843679904938
current submit client idx and staleness is  59 1
distance 2 is tensor(53681.1443, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53681.1443, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22133386135101318
sync_acc is 0.9500000005
sync_loss is 0.058277785778045654
sync_entropy is 0.03432733938097954
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [40, 42]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 76.31% 

Test Accuracy: 76.08% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53730.6996, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53730.6996, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.15926852822303772
current submit client idx and staleness is  1 1
distance 2 is tensor(53655.0828, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53655.0828, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0414944663643837
current submit client idx and staleness is  2 1
distance 2 is tensor(53896.5027, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53896.5027, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3026304244995117
current submit client idx and staleness is  3 1
distance 2 is tensor(53683.7865, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53683.7865, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.059358157217502594
current submit client idx and staleness is  4 1
distance 2 is tensor(53721.9169, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53721.9169, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13868510723114014
current submit client idx and staleness is  5 1
distance 2 is tensor(53684.3566, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53684.3566, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08372413367033005
current submit client idx and staleness is  6 1
distance 2 is tensor(53678.9937, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.9937, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.028450772166252136
current submit client idx and staleness is  7 1
distance 2 is tensor(53728.3408, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53728.3408, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02890353836119175
current submit client idx and staleness is  8 2
distance 2 is tensor(53670.6870, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.6870, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0624634250998497
current submit client idx and staleness is  9 2
distance 2 is tensor(53691.4918, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.4918, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09002260863780975
current submit client idx and staleness is  10 2
distance 2 is tensor(53721.5690, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53721.5690, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1241263598203659
current submit client idx and staleness is  11 2
distance 2 is tensor(53713.0326, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53713.0326, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06185392290353775
current submit client idx and staleness is  12 2
distance 2 is tensor(53892.4285, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53892.4285, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13657638430595398
current submit client idx and staleness is  13 2
distance 2 is tensor(53745.2680, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53745.2680, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03601071238517761
current submit client idx and staleness is  14 2
distance 2 is tensor(53698.7758, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53698.7758, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.017673583701252937
current submit client idx and staleness is  15 2
distance 2 is tensor(53723.3611, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53723.3611, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.051251061260700226
current submit client idx and staleness is  24 4
distance 2 is tensor(54049.2862, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54049.2862, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16833078861236572
current submit client idx and staleness is  25 4
distance 2 is tensor(53995.1132, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53995.1132, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2835826277732849
current submit client idx and staleness is  26 4
distance 2 is tensor(54016.8574, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54016.8574, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14357180893421173
current submit client idx and staleness is  27 4
distance 2 is tensor(53982.9763, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.9763, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08162073791027069
current submit client idx and staleness is  28 4
distance 2 is tensor(54028.3138, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54028.3138, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.25644415616989136
current submit client idx and staleness is  29 4
distance 2 is tensor(54034.6829, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54034.6829, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12316624820232391
current submit client idx and staleness is  30 4
distance 2 is tensor(54001.5447, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54001.5447, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2873613238334656
current submit client idx and staleness is  31 4
distance 2 is tensor(54036.8692, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54036.8692, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5403701066970825
current submit client idx and staleness is  48 1
distance 2 is tensor(53693.3177, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.3177, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21485118567943573
current submit client idx and staleness is  49 1
distance 2 is tensor(53678.3616, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.3616, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04001574218273163
current submit client idx and staleness is  50 1
distance 2 is tensor(53718.4552, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53718.4552, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04379100352525711
current submit client idx and staleness is  51 1
distance 2 is tensor(53700.8102, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53700.8102, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10860302299261093
current submit client idx and staleness is  52 1
distance 2 is tensor(53971.6781, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53971.6781, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.30453944206237793
current submit client idx and staleness is  53 1
distance 2 is tensor(53689.8632, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.8632, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.046804480254650116
current submit client idx and staleness is  54 1
distance 2 is tensor(53854.8591, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53854.8591, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03176121413707733
current submit client idx and staleness is  55 1
distance 2 is tensor(53680.0335, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.0335, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06951149553060532
current submit client idx and staleness is  56 1
distance 2 is tensor(53685.0495, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53685.0495, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12447545677423477
current submit client idx and staleness is  57 1
distance 2 is tensor(53709.8011, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53709.8011, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0017236589919775724
current submit client idx and staleness is  58 1
distance 2 is tensor(53692.4577, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53692.4577, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06265828758478165
current submit client idx and staleness is  59 1
distance 2 is tensor(53725.8117, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53725.8117, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.12297345697879791
benign_acc is 0.9500000005
benign_loss is 0.04971865192055702
benign_entropy is 0.03576211258769035
benign_acc is 0.9500000005
benign_loss is 0.15042586624622345
benign_entropy is 0.025245556607842445
sync_acc is 0.9500000005
sync_loss is 0.03970341384410858
sync_entropy is 0.03630124032497406
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [40, 42]
alphas 3 is [1.         0.2        0.33333333]
alphas is  [0.65217391 0.13043478 0.2173913 ]
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 76.56% 

Test Accuracy: 76.26% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53688.2338, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53688.2338, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.058290548622608185
current submit client idx and staleness is  1 1
distance 2 is tensor(53672.9627, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.9627, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06403256207704544
current submit client idx and staleness is  2 1
distance 2 is tensor(53701.8031, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53701.8031, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08659782260656357
current submit client idx and staleness is  3 1
distance 2 is tensor(53690.3803, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.3803, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06461603194475174
current submit client idx and staleness is  4 1
distance 2 is tensor(53692.8216, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53692.8216, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19608063995838165
current submit client idx and staleness is  5 1
distance 2 is tensor(53689.9154, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.9154, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0588192418217659
current submit client idx and staleness is  6 1
distance 2 is tensor(53662.6901, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53662.6901, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.052432529628276825
current submit client idx and staleness is  7 1
distance 2 is tensor(53690.2903, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.2903, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.033184491097927094
current submit client idx and staleness is  16 3
distance 2 is tensor(53974.6539, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53974.6539, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5672906637191772
current submit client idx and staleness is  17 3
distance 2 is tensor(54020.0984, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54020.0984, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.536185085773468
current submit client idx and staleness is  18 3
distance 2 is tensor(54009.7171, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54009.7171, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17005939781665802
current submit client idx and staleness is  19 3
distance 2 is tensor(54028.0600, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54028.0600, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.342607319355011
current submit client idx and staleness is  20 3
distance 2 is tensor(54062.4984, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54062.4984, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6008385419845581
current submit client idx and staleness is  21 3
distance 2 is tensor(53732.2688, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53732.2688, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09633545577526093
current submit client idx and staleness is  22 3
distance 2 is tensor(53956.3015, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53956.3015, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3799270987510681
current submit client idx and staleness is  23 3
distance 2 is tensor(53932.0610, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53932.0610, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02799525484442711
current submit client idx and staleness is  32 5
distance 2 is tensor(53961.1575, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53961.1575, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1242850050330162
current submit client idx and staleness is  33 5
distance 2 is tensor(53991.1630, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53991.1630, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10678191483020782
current submit client idx and staleness is  34 5
distance 2 is tensor(54008.1366, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54008.1366, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.43786054849624634
current submit client idx and staleness is  35 5
distance 2 is tensor(54023.9656, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54023.9656, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4239075779914856
current submit client idx and staleness is  36 5
distance 2 is tensor(54011.9835, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54011.9835, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.8422239422798157
current submit client idx and staleness is  37 5
distance 2 is tensor(53982.6366, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53982.6366, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.34797143936157227
current submit client idx and staleness is  38 5
distance 2 is tensor(54019.7985, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54019.7985, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3502187430858612
current submit client idx and staleness is  39 5
distance 2 is tensor(53983.3546, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53983.3546, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4574265480041504
current submit client idx and staleness is  48 1
distance 2 is tensor(53693.1845, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.1845, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07799004018306732
current submit client idx and staleness is  49 1
distance 2 is tensor(53689.4248, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.4248, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.022541068494319916
current submit client idx and staleness is  50 1
distance 2 is tensor(53685.5187, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53685.5187, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07053379714488983
current submit client idx and staleness is  51 1
distance 2 is tensor(53786.3160, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53786.3160, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05673544481396675
current submit client idx and staleness is  52 1
distance 2 is tensor(53692.2580, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53692.2580, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08537720143795013
current submit client idx and staleness is  53 1
distance 2 is tensor(53707.0185, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53707.0185, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0409679040312767
current submit client idx and staleness is  54 1
distance 2 is tensor(53678.2371, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.2371, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06834636628627777
current submit client idx and staleness is  55 1
distance 2 is tensor(53727.6305, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53727.6305, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19904467463493347
current submit client idx and staleness is  56 1
distance 2 is tensor(53691.8806, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.8806, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05691174417734146
current submit client idx and staleness is  57 1
distance 2 is tensor(53675.3829, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.3829, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07328270375728607
current submit client idx and staleness is  58 1
distance 2 is tensor(53807.0327, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53807.0327, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.02372310869395733
current submit client idx and staleness is  59 1
distance 2 is tensor(53701.2308, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53701.2308, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07492677122354507
benign_acc is 0.9500000005
benign_loss is 0.1313888281583786
benign_entropy is 0.020395943894982338
benign_acc is 0.9500000005
benign_loss is 0.1209828108549118
benign_entropy is 0.05138976126909256
sync_acc is 0.9500000005
sync_loss is 0.04725675657391548
sync_entropy is 0.035636287182569504
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [44]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 76.65% 

Test Accuracy: 76.08% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53934.1266, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53934.1266, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3886796832084656
current submit client idx and staleness is  1 1
distance 2 is tensor(53664.9851, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53664.9851, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.026252055540680885
current submit client idx and staleness is  2 1
distance 2 is tensor(53851.8463, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53851.8463, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3395019769668579
current submit client idx and staleness is  3 1
distance 2 is tensor(53665.9162, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.9162, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1096915751695633
current submit client idx and staleness is  4 1
distance 2 is tensor(53854.1496, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53854.1496, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03041907772421837
current submit client idx and staleness is  5 1
distance 2 is tensor(53872.4308, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53872.4308, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6590056419372559
current submit client idx and staleness is  6 1
distance 2 is tensor(53934.8917, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53934.8917, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16767632961273193
current submit client idx and staleness is  7 1
distance 2 is tensor(53849.4506, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53849.4506, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2632823586463928
current submit client idx and staleness is  8 2
distance 2 is tensor(53663.1081, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53663.1081, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07327117770910263
current submit client idx and staleness is  9 2
distance 2 is tensor(53690.3608, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53690.3608, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.024566693231463432
current submit client idx and staleness is  10 2
distance 2 is tensor(53803.4461, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53803.4461, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2546868920326233
current submit client idx and staleness is  11 2
distance 2 is tensor(53687.2771, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.2771, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09389419853687286
current submit client idx and staleness is  12 2
distance 2 is tensor(53867.4471, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53867.4471, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.002740631578490138
current submit client idx and staleness is  13 2
distance 2 is tensor(53656.5547, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53656.5547, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08147004246711731
current submit client idx and staleness is  14 2
distance 2 is tensor(53793.9377, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53793.9377, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08644158393144608
current submit client idx and staleness is  15 2
distance 2 is tensor(53676.1373, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.1373, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07691194862127304
current submit client idx and staleness is  48 1
distance 2 is tensor(53959.3820, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53959.3820, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4174225926399231
current submit client idx and staleness is  49 1
distance 2 is tensor(53661.6159, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53661.6159, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.019012216478586197
current submit client idx and staleness is  50 1
distance 2 is tensor(53955.2571, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53955.2571, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.4007345139980316
current submit client idx and staleness is  51 1
distance 2 is tensor(54115.7057, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54115.7057, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28366217017173767
current submit client idx and staleness is  52 1
distance 2 is tensor(53675.9409, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53675.9409, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.18620160222053528
current submit client idx and staleness is  53 1
distance 2 is tensor(53709.2038, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53709.2038, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0038875825703144073
current submit client idx and staleness is  54 1
distance 2 is tensor(53658.4644, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53658.4644, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08100051432847977
current submit client idx and staleness is  55 1
distance 2 is tensor(53665.3823, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.3823, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08377435058355331
current submit client idx and staleness is  56 1
distance 2 is tensor(53661.8973, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53661.8973, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04718532785773277
current submit client idx and staleness is  57 1
distance 2 is tensor(53693.8911, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.8911, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05013164132833481
current submit client idx and staleness is  58 1
distance 2 is tensor(53665.0895, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.0895, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09983272850513458
current submit client idx and staleness is  59 1
distance 2 is tensor(53663.2713, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53663.2713, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.048714425414800644
benign_acc is 1.0000000005
benign_loss is 0.011395664885640144
benign_entropy is 0.028123417869210243
sync_acc is 0.9500000005
sync_loss is 0.06260399520397186
sync_entropy is 0.03266681358218193
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 76.22% 

Test Accuracy: 75.59% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53669.9220, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53669.9220, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.047676973044872284
current submit client idx and staleness is  1 1
distance 2 is tensor(53652.8739, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53652.8739, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04968150332570076
current submit client idx and staleness is  2 1
distance 2 is tensor(53673.4140, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53673.4140, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08863286674022675
current submit client idx and staleness is  3 1
distance 2 is tensor(53674.2981, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53674.2981, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.061862457543611526
current submit client idx and staleness is  4 1
distance 2 is tensor(53692.9165, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53692.9165, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.24788792431354523
current submit client idx and staleness is  5 1
distance 2 is tensor(53670.2135, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.2135, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03484664112329483
current submit client idx and staleness is  6 1
distance 2 is tensor(53651.3553, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53651.3553, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05299043655395508
current submit client idx and staleness is  7 1
distance 2 is tensor(53678.0902, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.0902, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09807079285383224
current submit client idx and staleness is  48 1
distance 2 is tensor(53674.6396, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53674.6396, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06717506796121597
current submit client idx and staleness is  49 1
distance 2 is tensor(53685.2588, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53685.2588, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08366482704877853
current submit client idx and staleness is  50 1
distance 2 is tensor(53676.3705, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53676.3705, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.003324005752801895
current submit client idx and staleness is  51 1
distance 2 is tensor(53666.3779, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53666.3779, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11193610727787018
current submit client idx and staleness is  52 1
distance 2 is tensor(53664.5537, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53664.5537, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08886799216270447
current submit client idx and staleness is  53 1
distance 2 is tensor(53831.7940, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53831.7940, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.044122058898210526
current submit client idx and staleness is  54 1
distance 2 is tensor(53664.3104, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53664.3104, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03653715178370476
current submit client idx and staleness is  55 1
distance 2 is tensor(53672.4319, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53672.4319, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06846117973327637
current submit client idx and staleness is  56 1
distance 2 is tensor(53657.0196, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53657.0196, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09295324236154556
current submit client idx and staleness is  57 1
distance 2 is tensor(53659.2949, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53659.2949, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09208238124847412
current submit client idx and staleness is  58 1
distance 2 is tensor(53682.2927, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.2927, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.163962259888649
current submit client idx and staleness is  59 1
distance 2 is tensor(53670.5136, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.5136, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04974891617894173
sync_acc is 0.9500000005
sync_loss is 0.04730094224214554
sync_entropy is 0.03582749143242836
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [42, 44, 45, 46]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 76.51% 

Test Accuracy: 76.34% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53680.1888, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.1888, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06811277568340302
current submit client idx and staleness is  1 1
distance 2 is tensor(53670.1703, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53670.1703, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0383182056248188
current submit client idx and staleness is  2 1
distance 2 is tensor(53691.6955, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.6955, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07375694811344147
current submit client idx and staleness is  3 1
distance 2 is tensor(53678.8819, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53678.8819, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0546155646443367
current submit client idx and staleness is  4 1
distance 2 is tensor(53685.6745, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53685.6745, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.14813734591007233
current submit client idx and staleness is  5 1
distance 2 is tensor(53703.2127, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53703.2127, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13250043988227844
current submit client idx and staleness is  6 1
distance 2 is tensor(53669.0071, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53669.0071, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.036972351372241974
current submit client idx and staleness is  7 1
distance 2 is tensor(53680.1994, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53680.1994, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04962781444191933
current submit client idx and staleness is  8 2
distance 2 is tensor(53706.3332, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53706.3332, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.13092967867851257
current submit client idx and staleness is  9 2
distance 2 is tensor(53697.9102, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53697.9102, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.017331577837467194
current submit client idx and staleness is  10 2
distance 2 is tensor(53691.5051, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.5051, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05968818813562393
current submit client idx and staleness is  11 2
distance 2 is tensor(54010.9826, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54010.9826, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6179426908493042
current submit client idx and staleness is  12 2
distance 2 is tensor(53712.5832, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53712.5832, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1434951275587082
current submit client idx and staleness is  13 2
distance 2 is tensor(53733.9253, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53733.9253, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.014072360470890999
current submit client idx and staleness is  14 2
distance 2 is tensor(53695.9218, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53695.9218, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.060024194419384
current submit client idx and staleness is  15 2
distance 2 is tensor(53682.2971, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53682.2971, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08571243286132812
current submit client idx and staleness is  16 3
distance 2 is tensor(54022.8188, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54022.8188, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6773695349693298
current submit client idx and staleness is  17 3
distance 2 is tensor(53967.2465, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53967.2465, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.9210551977157593
current submit client idx and staleness is  18 3
distance 2 is tensor(53899.6293, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53899.6293, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05097229406237602
current submit client idx and staleness is  19 3
distance 2 is tensor(54037.7771, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54037.7771, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3250243663787842
current submit client idx and staleness is  20 3
distance 2 is tensor(53968.9425, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53968.9425, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.366646945476532
current submit client idx and staleness is  21 3
distance 2 is tensor(53709.7425, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53709.7425, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.19267494976520538
current submit client idx and staleness is  22 3
distance 2 is tensor(53768.2533, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53768.2533, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.024008193984627724
current submit client idx and staleness is  23 3
distance 2 is tensor(53964.5128, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53964.5128, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2006317675113678
current submit client idx and staleness is  24 4
distance 2 is tensor(54009.6308, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54009.6308, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.06850389391183853
current submit client idx and staleness is  25 4
distance 2 is tensor(54068.5942, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54068.5942, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.16927416622638702
current submit client idx and staleness is  26 4
distance 2 is tensor(53999.6263, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53999.6263, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6551830172538757
current submit client idx and staleness is  27 4
distance 2 is tensor(54034.6987, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54034.6987, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.42619389295578003
current submit client idx and staleness is  28 4
distance 2 is tensor(54019.2851, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54019.2851, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.411235511302948
current submit client idx and staleness is  29 4
distance 2 is tensor(53980.9160, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53980.9160, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.5156658887863159
current submit client idx and staleness is  30 4
distance 2 is tensor(53986.5661, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53986.5661, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2772081792354584
current submit client idx and staleness is  31 4
distance 2 is tensor(54016.7982, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54016.7982, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.6987159848213196
current submit client idx and staleness is  40 6
distance 2 is tensor(54115.6998, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54115.6998, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3424740731716156
current submit client idx and staleness is  41 6
distance 2 is tensor(53989.6340, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53989.6340, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.22604858875274658
current submit client idx and staleness is  42 6
distance 2 is tensor(54002.4046, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54002.4046, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3968398869037628
current submit client idx and staleness is  43 6
distance 2 is tensor(54001.2053, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54001.2053, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.34951555728912354
current submit client idx and staleness is  44 6
distance 2 is tensor(53995.8248, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53995.8248, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.1989004909992218
current submit client idx and staleness is  45 6
distance 2 is tensor(54084.9128, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54084.9128, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.11148512363433838
current submit client idx and staleness is  46 6
distance 2 is tensor(54086.8647, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54086.8647, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10067011415958405
current submit client idx and staleness is  47 6
distance 2 is tensor(54064.0674, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54064.0674, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1., device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.39953693747520447
current submit client idx and staleness is  48 1
distance 2 is tensor(53711.8091, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53711.8091, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.28751862049102783
current submit client idx and staleness is  49 1
distance 2 is tensor(53679.5868, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53679.5868, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07401751726865768
current submit client idx and staleness is  50 1
distance 2 is tensor(53810.3604, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53810.3604, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0010886389063671231
current submit client idx and staleness is  51 1
distance 2 is tensor(53691.6357, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.6357, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08770067989826202
current submit client idx and staleness is  52 1
distance 2 is tensor(53791.4611, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53791.4611, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2312614917755127
current submit client idx and staleness is  53 1
distance 2 is tensor(53687.2168, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53687.2168, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.04857184737920761
current submit client idx and staleness is  54 1
distance 2 is tensor(53695.2277, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53695.2277, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07153601944446564
current submit client idx and staleness is  55 1
distance 2 is tensor(53697.3122, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53697.3122, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.09366028010845184
current submit client idx and staleness is  56 1
distance 2 is tensor(53693.4769, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53693.4769, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.08333561569452286
current submit client idx and staleness is  57 1
distance 2 is tensor(53700.8185, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53700.8185, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.17704160511493683
current submit client idx and staleness is  58 1
distance 2 is tensor(53705.1640, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.1640, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.05816624313592911
current submit client idx and staleness is  59 1
distance 2 is tensor(53719.7743, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53719.7743, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.07201015949249268
benign_acc is 0.9500000005
benign_loss is 0.04584132134914398
benign_entropy is 0.03547480329871178
benign_acc is 0.9500000005
benign_loss is 0.12685754895210266
benign_entropy is 0.023345207795500755
benign_acc is 0.9500000005
benign_loss is 0.16452591121196747
benign_entropy is 0.019493484869599342
benign_acc is 0.9500000005
benign_loss is 0.08420141041278839
benign_entropy is 0.07889273017644882
sync_acc is 1.0000000005
sync_loss is 0.0030884528532624245
sync_entropy is 0.011935054324567318
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 76.02% 

Test Accuracy: 75.63% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
distance 2 is tensor(53900.0264, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53900.0264, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.10713932663202286
current submit client idx and staleness is  1 1
distance 2 is tensor(53677.4627, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53677.4627, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.004662609659135342
current submit client idx and staleness is  2 1
distance 2 is tensor(53978.4999, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53978.4999, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3524754047393799
current submit client idx and staleness is  3 1
distance 2 is tensor(53667.4879, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53667.4879, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0018630411941558123
current submit client idx and staleness is  4 1
distance 2 is tensor(53669.8935, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53669.8935, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.011069969274103642
current submit client idx and staleness is  5 1
distance 2 is tensor(53689.7141, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53689.7141, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.028009489178657532
current submit client idx and staleness is  6 1
distance 2 is tensor(53666.9883, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53666.9883, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.0011520988773554564
current submit client idx and staleness is  7 1
distance 2 is tensor(53908.6035, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53908.6035, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.03690357878804207
current submit client idx and staleness is  48 1
distance 2 is tensor(53686.5811, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53686.5811, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.028465554118156433
current submit client idx and staleness is  49 1
distance 2 is tensor(53705.0240, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53705.0240, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.008675637654960155
current submit client idx and staleness is  50 1
distance 2 is tensor(53652.6025, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53652.6025, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.011479257605969906
current submit client idx and staleness is  51 1
distance 2 is tensor(53665.1539, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53665.1539, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.012915430590510368
current submit client idx and staleness is  52 1
distance 2 is tensor(53898.7399, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53898.7399, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3491969108581543
current submit client idx and staleness is  53 1
distance 2 is tensor(53691.2346, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53691.2346, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.005190639290958643
current submit client idx and staleness is  54 1
distance 2 is tensor(54045.7686, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54045.7686, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.2772342264652252
current submit client idx and staleness is  55 1
distance 2 is tensor(53966.4223, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53966.4223, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.25336992740631104
current submit client idx and staleness is  56 1
distance 2 is tensor(54037.4089, device='cuda:3', dtype=torch.float64)
check distance is  tensor(54037.4089, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.3653484880924225
current submit client idx and staleness is  57 1
distance 2 is tensor(53814.9005, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53814.9005, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.21526238322257996
current submit client idx and staleness is  58 1
distance 2 is tensor(53694.5251, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53694.5251, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.014414126984775066
current submit client idx and staleness is  59 1
distance 2 is tensor(53671.2231, device='cuda:3', dtype=torch.float64)
check distance is  tensor(53671.2231, device='cuda:3', dtype=torch.float64)
benign similarity is  tensor(1.0000, device='cuda:3')
grad,shape is torch.Size([11183582])
 benign loss is  0.007740604691207409
sync_acc is 1.0000000005
sync_loss is 0.009135780856013298
sync_entropy is 0.023650342598557472
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [45, 48]
alphas 3 is [1.  0.2 0.5]
alphas is  [0.58823529 0.11764706 0.29411765]
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 76.60% 

Test Accuracy: 75.96% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 76.60%
|----0th round Training Accuracy : 75.79%
|----1th round Training Accuracy : 75.28%
|----2th round Training Accuracy : 75.38%
|----3th round Training Accuracy : 75.57%
|----4th round Training Accuracy : 75.64%
|----5th round Training Accuracy : 75.40%
|----6th round Training Accuracy : 75.19%
|----7th round Training Accuracy : 75.41%
|----8th round Training Accuracy : 75.18%
|----9th round Training Accuracy : 75.38%
|----10th round Training Accuracy : 75.58%
|----11th round Training Accuracy : 75.48%
|----12th round Training Accuracy : 75.86%
|----13th round Training Accuracy : 75.59%
|----14th round Training Accuracy : 75.82%
|----15th round Training Accuracy : 75.78%
|----16th round Training Accuracy : 75.74%
|----17th round Training Accuracy : 75.92%
|----18th round Training Accuracy : 75.89%
|----19th round Training Accuracy : 75.85%
|----20th round Training Accuracy : 75.99%
|----21th round Training Accuracy : 75.95%
|----22th round Training Accuracy : 75.78%
|----23th round Training Accuracy : 75.88%
|----24th round Training Accuracy : 76.29%
|----25th round Training Accuracy : 75.83%
|----26th round Training Accuracy : 76.11%
|----27th round Training Accuracy : 76.11%
|----28th round Training Accuracy : 75.96%
|----29th round Training Accuracy : 76.34%
|----30th round Training Accuracy : 76.20%
|----31th round Training Accuracy : 76.20%
|----32th round Training Accuracy : 76.30%
|----33th round Training Accuracy : 76.02%
|----34th round Training Accuracy : 76.26%
|----35th round Training Accuracy : 76.32%
|----36th round Training Accuracy : 76.27%
|----37th round Training Accuracy : 76.06%
|----38th round Training Accuracy : 76.32%
|----39th round Training Accuracy : 76.34%
|----40th round Training Accuracy : 76.31%
|----41th round Training Accuracy : 76.39%
|----42th round Training Accuracy : 76.41%
|----43th round Training Accuracy : 76.31%
|----44th round Training Accuracy : 76.56%
|----45th round Training Accuracy : 76.65%
|----46th round Training Accuracy : 76.22%
|----47th round Training Accuracy : 76.51%
|----48th round Training Accuracy : 76.02%
|----49th round Training Accuracy : 76.60%
|----Final Test Accuracy: 75.96%
|----0th round Final Test Accuracy : 74.84%
|----1th round Final Test Accuracy : 74.73%
|----2th round Final Test Accuracy : 74.80%
|----3th round Final Test Accuracy : 75.16%
|----4th round Final Test Accuracy : 74.99%
|----5th round Final Test Accuracy : 75.22%
|----6th round Final Test Accuracy : 74.98%
|----7th round Final Test Accuracy : 75.14%
|----8th round Final Test Accuracy : 75.08%
|----9th round Final Test Accuracy : 75.07%
|----10th round Final Test Accuracy : 74.94%
|----11th round Final Test Accuracy : 75.16%
|----12th round Final Test Accuracy : 75.03%
|----13th round Final Test Accuracy : 74.77%
|----14th round Final Test Accuracy : 75.37%
|----15th round Final Test Accuracy : 75.48%
|----16th round Final Test Accuracy : 75.08%
|----17th round Final Test Accuracy : 75.25%
|----18th round Final Test Accuracy : 75.17%
|----19th round Final Test Accuracy : 75.27%
|----20th round Final Test Accuracy : 75.50%
|----21th round Final Test Accuracy : 75.34%
|----22th round Final Test Accuracy : 75.17%
|----23th round Final Test Accuracy : 75.57%
|----24th round Final Test Accuracy : 75.89%
|----25th round Final Test Accuracy : 75.48%
|----26th round Final Test Accuracy : 75.52%
|----27th round Final Test Accuracy : 75.58%
|----28th round Final Test Accuracy : 75.15%
|----29th round Final Test Accuracy : 75.80%
|----30th round Final Test Accuracy : 75.60%
|----31th round Final Test Accuracy : 75.79%
|----32th round Final Test Accuracy : 75.72%
|----33th round Final Test Accuracy : 75.32%
|----34th round Final Test Accuracy : 75.73%
|----35th round Final Test Accuracy : 75.90%
|----36th round Final Test Accuracy : 75.77%
|----37th round Final Test Accuracy : 75.59%
|----38th round Final Test Accuracy : 75.94%
|----39th round Final Test Accuracy : 76.01%
|----40th round Final Test Accuracy : 76.02%
|----41th round Final Test Accuracy : 76.26%
|----42th round Final Test Accuracy : 75.97%
|----43th round Final Test Accuracy : 76.08%
|----44th round Final Test Accuracy : 76.26%
|----45th round Final Test Accuracy : 76.08%
|----46th round Final Test Accuracy : 75.59%
|----47th round Final Test Accuracy : 76.34%
|----48th round Final Test Accuracy : 75.63%
|----49th round Final Test Accuracy : 75.96%

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 20

    Attack ratio : 0.2
     None of attack is done!


 Total Run Time: 57696.4589
