
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8949815630912781
distance x is tensor(114.7625, device='cuda:0')
benign distance is  tensor(114.7625, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1981083154678345
distance x is tensor(135.1446, device='cuda:0')
benign distance is  tensor(135.1446, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.44775867462158203
distance x is tensor(121.7111, device='cuda:0')
benign distance is  tensor(121.7111, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.597631573677063
distance x is tensor(118.8730, device='cuda:0')
benign distance is  tensor(118.8730, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7292677164077759
distance x is tensor(111.0310, device='cuda:0')
benign distance is  tensor(111.0310, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.21593086421489716
distance x is tensor(119.2729, device='cuda:0')
benign distance is  tensor(119.2729, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9075304865837097
distance x is tensor(105.4870, device='cuda:0')
benign distance is  tensor(105.4870, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3358372151851654
distance x is tensor(124.2652, device='cuda:0')
benign distance is  tensor(124.2652, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.09856133908033371
distance x is tensor(138.5375, device='cuda:0')
benign distance is  tensor(138.5375, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.583225429058075
distance x is tensor(139.7608, device='cuda:0')
benign distance is  tensor(139.7608, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.42806512117385864
distance x is tensor(116.8470, device='cuda:0')
benign distance is  tensor(116.8470, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.07977796345949173
distance x is tensor(130.3347, device='cuda:0')
benign distance is  tensor(130.3347, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2592073082923889
distance x is tensor(128.6375, device='cuda:0')
benign distance is  tensor(128.6375, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.21947577595710754
distance x is tensor(149.9057, device='cuda:0')
benign distance is  tensor(149.9057, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9479848146438599
distance x is tensor(140.4685, device='cuda:0')
benign distance is  tensor(140.4685, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.22480244934558868
distance x is tensor(137.4157, device='cuda:0')
benign distance is  tensor(137.4157, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.18903818726539612
distance x is tensor(125.5471, device='cuda:0')
benign distance is  tensor(125.5471, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5823007822036743
distance x is tensor(148.2336, device='cuda:0')
benign distance is  tensor(148.2336, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6963798403739929
distance x is tensor(125.0114, device='cuda:0')
benign distance is  tensor(125.0114, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5439327955245972
distance x is tensor(125.5134, device='cuda:0')
benign distance is  tensor(125.5134, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.11867283284664154
distance x is tensor(129.4188, device='cuda:0')
benign distance is  tensor(129.4188, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.13112773001194
distance x is tensor(122.8286, device='cuda:0')
benign distance is  tensor(122.8286, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.41360044479370117
distance x is tensor(147.8933, device='cuda:0')
benign distance is  tensor(147.8933, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0498117208480835
distance x is tensor(133.0307, device='cuda:0')
benign distance is  tensor(133.0307, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8578889966011047
distance x is tensor(145.2571, device='cuda:0')
benign distance is  tensor(145.2571, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.49333006143569946
distance x is tensor(120.4535, device='cuda:0')
benign distance is  tensor(120.4535, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.38652387261390686
distance x is tensor(139.5026, device='cuda:0')
benign distance is  tensor(139.5026, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4373229146003723
distance x is tensor(139.0876, device='cuda:0')
benign distance is  tensor(139.0876, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7731853127479553
distance x is tensor(122.3976, device='cuda:0')
benign distance is  tensor(122.3976, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.560893177986145
distance x is tensor(134.2487, device='cuda:0')
benign distance is  tensor(134.2487, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4035249352455139
distance x is tensor(123.7553, device='cuda:0')
benign distance is  tensor(123.7553, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6676496267318726
distance x is tensor(135.3001, device='cuda:0')
benign distance is  tensor(135.3001, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3334227204322815
distance x is tensor(139.7370, device='cuda:0')
benign distance is  tensor(139.7370, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.29310640692710876
distance x is tensor(126.1778, device='cuda:0')
benign distance is  tensor(126.1778, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5374071598052979
distance x is tensor(136.4622, device='cuda:0')
benign distance is  tensor(136.4622, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.05965280532836914
distance x is tensor(126.1567, device='cuda:0')
benign distance is  tensor(126.1567, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.49224671721458435
distance x is tensor(128.4301, device='cuda:0')
benign distance is  tensor(128.4301, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.33379682898521423
distance x is tensor(127.5495, device='cuda:0')
benign distance is  tensor(127.5495, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2336440086364746
distance x is tensor(123.4963, device='cuda:0')
benign distance is  tensor(123.4963, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.312631756067276
distance x is tensor(128.9056, device='cuda:0')
benign distance is  tensor(128.9056, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.15676221251487732
distance x is tensor(123.2343, device='cuda:0')
benign distance is  tensor(123.2343, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2562551498413086
distance x is tensor(125.9254, device='cuda:0')
benign distance is  tensor(125.9254, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.13318900763988495
distance x is tensor(136.7248, device='cuda:0')
benign distance is  tensor(136.7248, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.23048833012580872
distance x is tensor(132.6790, device='cuda:0')
benign distance is  tensor(132.6790, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4495163559913635
distance x is tensor(136.9177, device='cuda:0')
benign distance is  tensor(136.9177, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.49293413758277893
distance x is tensor(128.9789, device='cuda:0')
benign distance is  tensor(128.9789, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7429676055908203
distance x is tensor(136.8577, device='cuda:0')
benign distance is  tensor(136.8577, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.06237853318452835
distance x is tensor(143.1285, device='cuda:0')
benign distance is  tensor(143.1285, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 518.6932,  623.7817,  538.1400,  544.0667,  499.1891,  547.8549,
         471.6116,  578.8311, 3973.4595, 3981.5737, 3989.2356, 3984.3486,
        3981.2136, 3981.8440, 3983.7502, 3984.5908, 3987.3059, 3985.5310,
        3990.9272, 3984.9392], device='cuda:0')
sorted_norm is   tensor([ 471.6116,  499.1891,  518.6932,  538.1400,  544.0667,  547.8549,
         578.8311,  623.7817, 3973.4595, 3981.2136, 3981.5737, 3981.8440,
        3983.7502, 3984.3486, 3984.5908, 3984.9392, 3985.5310, 3987.3059,
        3989.2356, 3990.9272], device='cuda:0')
used idx is  tensor([ 6,  4,  0,  2,  3,  5,  7,  1,  8, 12,  9, 13, 14, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 10.23% 

Test Accuracy: 10.02% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4245334565639496
distance x is tensor(149.0672, device='cuda:0')
benign distance is  tensor(149.0672, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.32528191804885864
distance x is tensor(147.5459, device='cuda:0')
benign distance is  tensor(147.5459, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23112502694129944
distance x is tensor(147.6677, device='cuda:0')
benign distance is  tensor(147.6677, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4492174983024597
distance x is tensor(153.7459, device='cuda:0')
benign distance is  tensor(153.7459, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1984567940235138
distance x is tensor(155.0423, device='cuda:0')
benign distance is  tensor(155.0423, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.377987265586853
distance x is tensor(153.3550, device='cuda:0')
benign distance is  tensor(153.3550, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2519824206829071
distance x is tensor(152.3144, device='cuda:0')
benign distance is  tensor(152.3144, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.28953370451927185
distance x is tensor(153.5322, device='cuda:0')
benign distance is  tensor(153.5322, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 649.4605,  640.1622,  644.8621,  654.8633,  675.6359,  661.0384,
         653.5773,  659.6682, 1070.0045, 1046.8296, 1064.6996, 1085.3916,
        1082.7821, 1070.2229, 1076.1599, 1068.5514, 1083.0675, 1072.7657,
        1087.3108, 1075.1801, 1809.1675, 1805.5642, 1782.8361, 1799.0095,
        1790.2279, 1823.5927, 1810.2816, 1810.3882], device='cuda:0')
sorted_norm is   tensor([ 640.1622,  644.8621,  649.4605,  653.5773,  654.8633,  659.6682,
         661.0384,  675.6359, 1046.8296, 1064.6996, 1068.5514, 1070.0045,
        1070.2229, 1072.7657, 1075.1801, 1076.1599, 1082.7821, 1083.0675,
        1085.3916, 1087.3108, 1782.8361, 1790.2279, 1799.0095, 1805.5642,
        1809.1675, 1810.2816, 1810.3882, 1823.5927], device='cuda:0')
used idx is  tensor([ 1,  2,  0,  6,  3,  7,  5,  4,  9, 10, 15,  8, 13, 17, 19, 14, 12, 16,
        11], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 10.16% 

Test Accuracy: 10.25% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4064515233039856
distance x is tensor(142.7990, device='cuda:0')
benign distance is  tensor(142.7990, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6720560789108276
distance x is tensor(144.1002, device='cuda:0')
benign distance is  tensor(144.1002, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.48258933424949646
distance x is tensor(143.8901, device='cuda:0')
benign distance is  tensor(143.8901, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47109872102737427
distance x is tensor(144.8739, device='cuda:0')
benign distance is  tensor(144.8739, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.563444972038269
distance x is tensor(149.0705, device='cuda:0')
benign distance is  tensor(149.0705, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5520561933517456
distance x is tensor(139.1184, device='cuda:0')
benign distance is  tensor(139.1184, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.49529510736465454
distance x is tensor(147.2806, device='cuda:0')
benign distance is  tensor(147.2806, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5284528136253357
distance x is tensor(150.6376, device='cuda:0')
benign distance is  tensor(150.6376, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4396955072879791
distance x is tensor(141.9624, device='cuda:0')
benign distance is  tensor(141.9624, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.40626540780067444
distance x is tensor(136.2795, device='cuda:0')
benign distance is  tensor(136.2795, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.32008570432662964
distance x is tensor(150.2226, device='cuda:0')
benign distance is  tensor(150.2226, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4384053647518158
distance x is tensor(148.6785, device='cuda:0')
benign distance is  tensor(148.6785, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8033650517463684
distance x is tensor(148.0291, device='cuda:0')
benign distance is  tensor(148.0291, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3706308901309967
distance x is tensor(148.9548, device='cuda:0')
benign distance is  tensor(148.9548, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4035753309726715
distance x is tensor(139.4421, device='cuda:0')
benign distance is  tensor(139.4421, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5021450519561768
distance x is tensor(142.8918, device='cuda:0')
benign distance is  tensor(142.8918, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 733.9939,  721.1330,  717.0036,  752.4096,  748.7974,  727.0468,
         731.1056,  749.1481,  836.5003,  846.7391,  822.2828,  859.8660,
         865.0679,  850.7661,  843.3403,  838.6068,  866.0274,  844.7194,
         823.7745,  833.7496, 2137.0044, 2169.0430, 2145.8054, 2147.6633,
        2139.7405, 2134.9058, 2165.6543, 2143.0342], device='cuda:0')
sorted_norm is   tensor([ 717.0036,  721.1330,  727.0468,  731.1056,  733.9939,  748.7974,
         749.1481,  752.4096,  822.2828,  823.7745,  833.7496,  836.5003,
         838.6068,  843.3403,  844.7194,  846.7391,  850.7661,  859.8660,
         865.0679,  866.0274, 2134.9058, 2137.0044, 2139.7405, 2143.0342,
        2145.8054, 2147.6633, 2165.6543, 2169.0430], device='cuda:0')
used idx is  tensor([ 2,  1,  5,  6,  0,  4,  7,  3, 10, 18, 19,  8, 15, 14, 17,  9, 13, 11,
        12], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 17.82% 

Test Accuracy: 17.29% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4907805323600769
distance x is tensor(147.9381, device='cuda:0')
benign distance is  tensor(147.9381, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4910741448402405
distance x is tensor(144.8414, device='cuda:0')
benign distance is  tensor(144.8414, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.39728498458862305
distance x is tensor(148.8994, device='cuda:0')
benign distance is  tensor(148.8994, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5428766012191772
distance x is tensor(145.0604, device='cuda:0')
benign distance is  tensor(145.0604, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.35954663157463074
distance x is tensor(150.0888, device='cuda:0')
benign distance is  tensor(150.0888, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6769407391548157
distance x is tensor(143.4859, device='cuda:0')
benign distance is  tensor(143.4859, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.33689993619918823
distance x is tensor(148.5002, device='cuda:0')
benign distance is  tensor(148.5002, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46667608618736267
distance x is tensor(143.6263, device='cuda:0')
benign distance is  tensor(143.6263, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5428733825683594
distance x is tensor(145.2058, device='cuda:0')
benign distance is  tensor(145.2058, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5388950109481812
distance x is tensor(152.6704, device='cuda:0')
benign distance is  tensor(152.6704, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.34359675645828247
distance x is tensor(150.7562, device='cuda:0')
benign distance is  tensor(150.7562, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4991774559020996
distance x is tensor(150.3429, device='cuda:0')
benign distance is  tensor(150.3429, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3134440779685974
distance x is tensor(149.2271, device='cuda:0')
benign distance is  tensor(149.2271, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.35231682658195496
distance x is tensor(151.7983, device='cuda:0')
benign distance is  tensor(151.7983, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6000571250915527
distance x is tensor(154.8670, device='cuda:0')
benign distance is  tensor(154.8670, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.46926212310791016
distance x is tensor(147.7067, device='cuda:0')
benign distance is  tensor(147.7067, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 711.4681,  708.6229,  719.2202,  708.6817,  745.4227,  715.6858,
         707.7010,  708.0825,  848.7013,  842.2875,  840.9694,  866.7814,
         839.3304,  856.6899,  847.6819,  873.1575,  883.4802,  861.3146,
         837.1832,  857.3404, 2061.8962, 2028.0480, 2048.3149, 2046.9310,
        2031.0621, 2049.1545, 2033.2614, 2044.2025,  826.3485,  808.5467,
         861.5197,  849.9756,  845.8666,  852.4372,  843.3334,  840.6882],
       device='cuda:0')
sorted_norm is   tensor([ 707.7010,  708.0825,  708.6229,  708.6817,  711.4681,  715.6858,
         719.2202,  745.4227,  808.5467,  826.3485,  837.1832,  839.3304,
         840.6882,  840.9694,  842.2875,  843.3334,  845.8666,  847.6819,
         848.7013,  849.9756,  852.4372,  856.6899,  857.3404,  861.3146,
         861.5197,  866.7814,  873.1575,  883.4802, 2028.0480, 2031.0621,
        2033.2614, 2044.2025, 2046.9310, 2048.3149, 2049.1545, 2061.8962],
       device='cuda:0')
used idx is  tensor([ 6,  7,  1,  3,  0,  5,  2,  4, 29, 28, 18, 12, 35, 10,  9, 34, 32, 14,
         8, 31, 33, 13, 19, 17, 30], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 20.42% 

Test Accuracy: 19.52% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5240186452865601
distance x is tensor(143.7600, device='cuda:0')
benign distance is  tensor(143.7600, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3531150221824646
distance x is tensor(143.9529, device='cuda:0')
benign distance is  tensor(143.9529, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5325071215629578
distance x is tensor(136.0933, device='cuda:0')
benign distance is  tensor(136.0933, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.41159558296203613
distance x is tensor(137.6071, device='cuda:0')
benign distance is  tensor(137.6071, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.40788525342941284
distance x is tensor(145.0265, device='cuda:0')
benign distance is  tensor(145.0265, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6760563254356384
distance x is tensor(140.4144, device='cuda:0')
benign distance is  tensor(140.4144, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3245854675769806
distance x is tensor(136.8507, device='cuda:0')
benign distance is  tensor(136.8507, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.43725118041038513
distance x is tensor(137.2683, device='cuda:0')
benign distance is  tensor(137.2683, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3275656998157501
distance x is tensor(141.1881, device='cuda:0')
benign distance is  tensor(141.1881, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4888175129890442
distance x is tensor(135.2583, device='cuda:0')
benign distance is  tensor(135.2583, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.43220019340515137
distance x is tensor(139.3949, device='cuda:0')
benign distance is  tensor(139.3949, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.1898893117904663
distance x is tensor(133.2878, device='cuda:0')
benign distance is  tensor(133.2878, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.520606517791748
distance x is tensor(134.4265, device='cuda:0')
benign distance is  tensor(134.4265, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.45594510436058044
distance x is tensor(139.4386, device='cuda:0')
benign distance is  tensor(139.4386, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4651479721069336
distance x is tensor(131.3596, device='cuda:0')
benign distance is  tensor(131.3596, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4878758490085602
distance x is tensor(139.8777, device='cuda:0')
benign distance is  tensor(139.8777, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5734844207763672
distance x is tensor(140.4845, device='cuda:0')
benign distance is  tensor(140.4845, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5101460218429565
distance x is tensor(138.3822, device='cuda:0')
benign distance is  tensor(138.3822, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4203297197818756
distance x is tensor(139.7419, device='cuda:0')
benign distance is  tensor(139.7419, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4614686965942383
distance x is tensor(146.0423, device='cuda:0')
benign distance is  tensor(146.0423, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.43784579634666443
distance x is tensor(144.0794, device='cuda:0')
benign distance is  tensor(144.0794, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5073574781417847
distance x is tensor(139.4512, device='cuda:0')
benign distance is  tensor(139.4512, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3294348120689392
distance x is tensor(138.9650, device='cuda:0')
benign distance is  tensor(138.9650, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3444230258464813
distance x is tensor(134.8654, device='cuda:0')
benign distance is  tensor(134.8654, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 705.0916,  705.1214,  663.0483,  681.3959,  709.8795,  675.2264,
         660.2412,  674.3485,  960.2415,  923.2678,  943.9913,  954.4027,
         968.3773,  956.6638,  919.7393,  939.3195,  945.6778,  935.2413,
         926.4199,  952.7744, 2138.2881, 2121.4177, 2139.6223, 2122.0193,
        2127.9065, 2123.5251, 2126.7202, 2125.5520], device='cuda:0')
sorted_norm is   tensor([ 660.2412,  663.0483,  674.3485,  675.2264,  681.3959,  705.0916,
         705.1214,  709.8795,  919.7393,  923.2678,  926.4199,  935.2413,
         939.3195,  943.9913,  945.6778,  952.7744,  954.4027,  956.6638,
         960.2415,  968.3773, 2121.4177, 2122.0193, 2123.5251, 2125.5520,
        2126.7202, 2127.9065, 2138.2881, 2139.6223], device='cuda:0')
used idx is  tensor([ 6,  2,  7,  5,  3,  0,  1,  4, 14,  9, 18, 17, 15, 10, 16, 19, 11, 13,
         8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.42241016030311584
distance x is tensor(145.8537, device='cuda:0')
benign distance is  tensor(145.8537, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5595393180847168
distance x is tensor(140.3671, device='cuda:0')
benign distance is  tensor(140.3671, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.45783916115760803
distance x is tensor(142.7439, device='cuda:0')
benign distance is  tensor(142.7439, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45289626717567444
distance x is tensor(147.6782, device='cuda:0')
benign distance is  tensor(147.6782, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9553791284561157
distance x is tensor(140.9820, device='cuda:0')
benign distance is  tensor(140.9820, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.42445889115333557
distance x is tensor(135.1741, device='cuda:0')
benign distance is  tensor(135.1741, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.606861412525177
distance x is tensor(142.0331, device='cuda:0')
benign distance is  tensor(142.0331, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3652568459510803
distance x is tensor(142.1676, device='cuda:0')
benign distance is  tensor(142.1676, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5319356322288513
distance x is tensor(148.6224, device='cuda:0')
benign distance is  tensor(148.6224, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.28513774275779724
distance x is tensor(146.9693, device='cuda:0')
benign distance is  tensor(146.9693, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.47079524397850037
distance x is tensor(149.8194, device='cuda:0')
benign distance is  tensor(149.8194, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.4636377692222595
distance x is tensor(145.9146, device='cuda:0')
benign distance is  tensor(145.9146, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4078074097633362
distance x is tensor(150.0059, device='cuda:0')
benign distance is  tensor(150.0059, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.34973448514938354
distance x is tensor(139.7448, device='cuda:0')
benign distance is  tensor(139.7448, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3198702037334442
distance x is tensor(147.4403, device='cuda:0')
benign distance is  tensor(147.4403, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1466134786605835
distance x is tensor(145.7783, device='cuda:0')
benign distance is  tensor(145.7783, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 30
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 728.9887,  702.2952,  718.6656,  740.1212,  713.2075,  690.8832,
         715.3559,  713.1135,  882.7270,  845.5994,  859.0098,  864.5066,
         870.3970,  842.1721,  844.3719,  864.0286,  860.3484,  852.0294,
         844.3729,  865.9542, 2027.9928, 2040.2222, 2047.5515, 2045.1245,
        2050.8171, 2038.4620, 2056.7742, 2061.1125,  749.0752,  780.9469,
         773.0045,  773.2856,  777.0402,  772.1910,  780.5494,  767.6568,
         892.7853,  869.9518,  875.9714,  863.4734,  872.6083,  882.3181,
         867.3368,  892.3932], device='cuda:0')
sorted_norm is   tensor([ 690.8832,  702.2952,  713.1135,  713.2075,  715.3559,  718.6656,
         728.9887,  740.1212,  749.0752,  767.6568,  772.1910,  773.0045,
         773.2856,  777.0402,  780.5494,  780.9469,  842.1721,  844.3719,
         844.3729,  845.5994,  852.0294,  859.0098,  860.3484,  863.4734,
         864.0286,  864.5066,  865.9542,  867.3368,  869.9518,  870.3970,
         872.6083,  875.9714,  882.3181,  882.7270,  892.3932,  892.7853,
        2027.9928, 2038.4620, 2040.2222, 2045.1245, 2047.5515, 2050.8171,
        2056.7742, 2061.1125], device='cuda:0')
used idx is  tensor([ 5,  1,  7,  4,  6,  2,  0,  3, 28, 35, 33, 30, 31, 32, 34, 29, 13, 14,
        18,  9, 17, 10, 16, 39, 15, 11, 19, 42, 37, 12], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 10.21% 

Test Accuracy: 10.01% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6620221734046936
distance x is tensor(134.3822, device='cuda:0')
benign distance is  tensor(134.3822, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2795127332210541
distance x is tensor(135.2396, device='cuda:0')
benign distance is  tensor(135.2396, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.27308693528175354
distance x is tensor(131.9231, device='cuda:0')
benign distance is  tensor(131.9231, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5117429494857788
distance x is tensor(141.7607, device='cuda:0')
benign distance is  tensor(141.7607, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.36862650513648987
distance x is tensor(135.2086, device='cuda:0')
benign distance is  tensor(135.2086, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5294766426086426
distance x is tensor(130.7555, device='cuda:0')
benign distance is  tensor(130.7555, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3106277883052826
distance x is tensor(128.8172, device='cuda:0')
benign distance is  tensor(128.8172, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2220458984375
distance x is tensor(133.7784, device='cuda:0')
benign distance is  tensor(133.7784, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.319897323846817
distance x is tensor(132.5011, device='cuda:0')
benign distance is  tensor(132.5011, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.281093955039978
distance x is tensor(136.9270, device='cuda:0')
benign distance is  tensor(136.9270, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6942091584205627
distance x is tensor(137.8395, device='cuda:0')
benign distance is  tensor(137.8395, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5557568073272705
distance x is tensor(137.6995, device='cuda:0')
benign distance is  tensor(137.6995, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2719098627567291
distance x is tensor(134.8628, device='cuda:0')
benign distance is  tensor(134.8628, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3928648829460144
distance x is tensor(133.8962, device='cuda:0')
benign distance is  tensor(133.8962, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5761648416519165
distance x is tensor(127.9484, device='cuda:0')
benign distance is  tensor(127.9484, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5901930332183838
distance x is tensor(129.2580, device='cuda:0')
benign distance is  tensor(129.2580, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.47038769721984863
distance x is tensor(129.0100, device='cuda:0')
benign distance is  tensor(129.0100, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5907008647918701
distance x is tensor(134.7780, device='cuda:0')
benign distance is  tensor(134.7780, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.687895655632019
distance x is tensor(138.7051, device='cuda:0')
benign distance is  tensor(138.7051, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4205138683319092
distance x is tensor(134.5898, device='cuda:0')
benign distance is  tensor(134.5898, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4195992350578308
distance x is tensor(132.0592, device='cuda:0')
benign distance is  tensor(132.0592, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5455089211463928
distance x is tensor(137.8011, device='cuda:0')
benign distance is  tensor(137.8011, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4974903166294098
distance x is tensor(134.5174, device='cuda:0')
benign distance is  tensor(134.5174, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.53962242603302
distance x is tensor(131.8176, device='cuda:0')
benign distance is  tensor(131.8176, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.6257057785987854
distance x is tensor(133.4527, device='cuda:0')
benign distance is  tensor(133.4527, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.351458340883255
distance x is tensor(135.5372, device='cuda:0')
benign distance is  tensor(135.5372, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.5103753805160522
distance x is tensor(137.9777, device='cuda:0')
benign distance is  tensor(137.9777, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.29105353355407715
distance x is tensor(136.2522, device='cuda:0')
benign distance is  tensor(136.2522, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3260580599308014
distance x is tensor(128.9951, device='cuda:0')
benign distance is  tensor(128.9951, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6417708992958069
distance x is tensor(132.6781, device='cuda:0')
benign distance is  tensor(132.6781, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.3949887156486511
distance x is tensor(129.9045, device='cuda:0')
benign distance is  tensor(129.9045, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.33287686109542847
distance x is tensor(140.6439, device='cuda:0')
benign distance is  tensor(140.6439, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([686.1227, 681.1273, 671.2312, 711.2493, 695.9969, 667.3497, 669.1828,
        683.8168, 861.0869, 848.9921, 837.0840, 868.1443, 854.4578, 844.6372,
        845.7336, 862.3411, 865.5123, 844.7941, 859.1882, 863.3698],
       device='cuda:0')
sorted_norm is   tensor([667.3497, 669.1828, 671.2312, 681.1273, 683.8168, 686.1227, 695.9969,
        711.2493, 837.0840, 844.6372, 844.7941, 845.7336, 848.9921, 854.4578,
        859.1882, 861.0869, 862.3411, 863.3698, 865.5123, 868.1443],
       device='cuda:0')
used idx is  tensor([ 5,  6,  2,  1,  7,  0,  4,  3, 10, 13, 17, 14,  9, 12],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.28449052572250366
distance x is tensor(131.3790, device='cuda:0')
benign distance is  tensor(131.3790, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5803468227386475
distance x is tensor(136.9364, device='cuda:0')
benign distance is  tensor(136.9364, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.48708805441856384
distance x is tensor(135.6568, device='cuda:0')
benign distance is  tensor(135.6568, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.38488516211509705
distance x is tensor(133.6640, device='cuda:0')
benign distance is  tensor(133.6640, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5509120225906372
distance x is tensor(127.3704, device='cuda:0')
benign distance is  tensor(127.3704, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.41583508253097534
distance x is tensor(134.7526, device='cuda:0')
benign distance is  tensor(134.7526, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.33523768186569214
distance x is tensor(130.8680, device='cuda:0')
benign distance is  tensor(130.8680, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.303924024105072
distance x is tensor(129.3633, device='cuda:0')
benign distance is  tensor(129.3633, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([686.6068, 708.9129, 710.9853, 693.0508, 670.2080, 693.4904, 674.3237,
        679.4384, 848.4702, 820.6359, 855.0962, 849.6796, 864.7458, 842.8074,
        845.4838, 869.7762, 855.6553, 875.3945, 844.7523, 848.8031, 810.3409,
        820.3240, 807.7947, 831.2757, 827.1132, 804.6186, 809.7997, 806.8179,
        701.3110, 714.3196, 730.9394, 725.2745, 719.3077, 709.2030, 710.2397,
        705.9023], device='cuda:0')
sorted_norm is   tensor([670.2080, 674.3237, 679.4384, 686.6068, 693.0508, 693.4904, 701.3110,
        705.9023, 708.9129, 709.2030, 710.2397, 710.9853, 714.3196, 719.3077,
        725.2745, 730.9394, 804.6186, 806.8179, 807.7947, 809.7997, 810.3409,
        820.3240, 820.6359, 827.1132, 831.2757, 842.8074, 844.7523, 845.4838,
        848.4702, 848.8031, 849.6796, 855.0962, 855.6553, 864.7458, 869.7762,
        875.3945], device='cuda:0')
used idx is  tensor([ 4,  6,  7,  0,  3,  5, 28, 35,  1, 33, 34,  2, 29, 32, 31, 30, 25, 27,
        22, 26, 20, 21,  9, 24, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 48.16% 

Test Accuracy: 47.39% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6260172724723816
distance x is tensor(129.8828, device='cuda:0')
benign distance is  tensor(129.8828, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.19285878539085388
distance x is tensor(128.2547, device='cuda:0')
benign distance is  tensor(128.2547, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.43108615279197693
distance x is tensor(120.6190, device='cuda:0')
benign distance is  tensor(120.6190, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6993528008460999
distance x is tensor(121.1069, device='cuda:0')
benign distance is  tensor(121.1069, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8120881915092468
distance x is tensor(129.3963, device='cuda:0')
benign distance is  tensor(129.3963, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3522464632987976
distance x is tensor(125.3914, device='cuda:0')
benign distance is  tensor(125.3914, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7574198246002197
distance x is tensor(122.8190, device='cuda:0')
benign distance is  tensor(122.8190, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6588588356971741
distance x is tensor(135.5503, device='cuda:0')
benign distance is  tensor(135.5503, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.34894442558288574
distance x is tensor(127.3023, device='cuda:0')
benign distance is  tensor(127.3023, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3540579378604889
distance x is tensor(119.1511, device='cuda:0')
benign distance is  tensor(119.1511, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4905625879764557
distance x is tensor(126.6192, device='cuda:0')
benign distance is  tensor(126.6192, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4968401789665222
distance x is tensor(126.4660, device='cuda:0')
benign distance is  tensor(126.4660, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4304113984107971
distance x is tensor(129.5008, device='cuda:0')
benign distance is  tensor(129.5008, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5659055113792419
distance x is tensor(114.8073, device='cuda:0')
benign distance is  tensor(114.8073, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7990471124649048
distance x is tensor(119.5147, device='cuda:0')
benign distance is  tensor(119.5147, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.37028709053993225
distance x is tensor(128.3944, device='cuda:0')
benign distance is  tensor(128.3944, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.13112543523311615
distance x is tensor(129.0687, device='cuda:0')
benign distance is  tensor(129.0687, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6257722973823547
distance x is tensor(116.4344, device='cuda:0')
benign distance is  tensor(116.4344, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8272110223770142
distance x is tensor(122.3805, device='cuda:0')
benign distance is  tensor(122.3805, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4498145580291748
distance x is tensor(117.4746, device='cuda:0')
benign distance is  tensor(117.4746, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6051340699195862
distance x is tensor(128.6669, device='cuda:0')
benign distance is  tensor(128.6669, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3853030800819397
distance x is tensor(124.7017, device='cuda:0')
benign distance is  tensor(124.7017, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.31546443700790405
distance x is tensor(121.9843, device='cuda:0')
benign distance is  tensor(121.9843, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.24445851147174835
distance x is tensor(120.7261, device='cuda:0')
benign distance is  tensor(120.7261, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 619.6506,  617.1563,  588.3606,  564.3655,  612.1458,  600.6425,
         582.5981,  652.8105, 1140.0098, 1134.3427, 1145.1659, 1141.2408,
        1170.7059, 1146.3474, 1134.8236, 1134.2908, 1155.2343, 1149.8336,
        1150.8611, 1161.4436,  604.3580,  618.5481,  630.2101,  623.3119,
         610.3629,  625.8429,  624.1132,  612.7325], device='cuda:0')
sorted_norm is   tensor([ 564.3655,  582.5981,  588.3606,  600.6425,  604.3580,  610.3629,
         612.1458,  612.7325,  617.1563,  618.5481,  619.6506,  623.3119,
         624.1132,  625.8429,  630.2101,  652.8105, 1134.2908, 1134.3427,
        1134.8236, 1140.0098, 1141.2408, 1145.1659, 1146.3474, 1149.8336,
        1150.8611, 1155.2343, 1161.4436, 1170.7059], device='cuda:0')
used idx is  tensor([ 3,  6,  2,  5, 20, 24,  4, 27,  1, 21,  0, 23, 26, 25, 22,  7, 15,  9,
        14], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 73.68% 

Test Accuracy: 72.49% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.41773661971092224
distance x is tensor(117.6146, device='cuda:0')
benign distance is  tensor(117.6146, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5675636529922485
distance x is tensor(119.3074, device='cuda:0')
benign distance is  tensor(119.3074, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3947012722492218
distance x is tensor(111.0305, device='cuda:0')
benign distance is  tensor(111.0305, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.46752071380615234
distance x is tensor(113.5657, device='cuda:0')
benign distance is  tensor(113.5657, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.18061822652816772
distance x is tensor(117.9650, device='cuda:0')
benign distance is  tensor(117.9650, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5657855272293091
distance x is tensor(113.9979, device='cuda:0')
benign distance is  tensor(113.9979, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.29268136620521545
distance x is tensor(115.6624, device='cuda:0')
benign distance is  tensor(115.6624, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6532321572303772
distance x is tensor(121.8489, device='cuda:0')
benign distance is  tensor(121.8489, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5783896446228027
distance x is tensor(117.3587, device='cuda:0')
benign distance is  tensor(117.3587, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.25992387533187866
distance x is tensor(116.0278, device='cuda:0')
benign distance is  tensor(116.0278, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4630642533302307
distance x is tensor(115.4529, device='cuda:0')
benign distance is  tensor(115.4529, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3123041093349457
distance x is tensor(114.6692, device='cuda:0')
benign distance is  tensor(114.6692, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.39853107929229736
distance x is tensor(111.3895, device='cuda:0')
benign distance is  tensor(111.3895, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.2556251883506775
distance x is tensor(114.3399, device='cuda:0')
benign distance is  tensor(114.3399, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.765169620513916
distance x is tensor(119.4296, device='cuda:0')
benign distance is  tensor(119.4296, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3902874290943146
distance x is tensor(112.3103, device='cuda:0')
benign distance is  tensor(112.3103, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 561.4962,  568.6072,  538.1694,  550.8151,  569.1361,  537.3557,
         560.0469,  577.9372, 1175.0914, 1169.2214, 1177.4061, 1203.4114,
        1220.9794, 1179.4232, 1163.9728, 1159.7766, 1173.8545, 1185.1857,
        1176.7606, 1197.4756,  881.5215,  864.8848,  871.7684,  872.9463,
         879.1044,  846.5432,  874.9005,  862.8677,  602.9662,  573.6065,
         617.5012,  609.8895,  633.4943,  572.9612,  588.3600,  633.7033],
       device='cuda:0')
sorted_norm is   tensor([ 537.3557,  538.1694,  550.8151,  560.0469,  561.4962,  568.6072,
         569.1361,  572.9612,  573.6065,  577.9372,  588.3600,  602.9662,
         609.8895,  617.5012,  633.4943,  633.7033,  846.5432,  862.8677,
         864.8848,  871.7684,  872.9463,  874.9005,  879.1044,  881.5215,
        1159.7766, 1163.9728, 1169.2214, 1173.8545, 1175.0914, 1176.7606,
        1177.4061, 1179.4232, 1185.1857, 1197.4756, 1203.4114, 1220.9794],
       device='cuda:0')
used idx is  tensor([ 5,  2,  3,  6,  0,  1,  4, 33, 29,  7, 34, 28, 31, 30, 32, 35, 25, 27,
        21, 22, 23, 26, 24, 20, 15], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 74.03% 

Test Accuracy: 72.87% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6547823548316956
distance x is tensor(116.8339, device='cuda:0')
benign distance is  tensor(116.8339, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4032861590385437
distance x is tensor(114.6792, device='cuda:0')
benign distance is  tensor(114.6792, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.37024635076522827
distance x is tensor(118.6557, device='cuda:0')
benign distance is  tensor(118.6557, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7472019791603088
distance x is tensor(116.0790, device='cuda:0')
benign distance is  tensor(116.0790, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.29490596055984497
distance x is tensor(114.5704, device='cuda:0')
benign distance is  tensor(114.5704, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8326352834701538
distance x is tensor(117.5529, device='cuda:0')
benign distance is  tensor(117.5529, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19592472910881042
distance x is tensor(120.2196, device='cuda:0')
benign distance is  tensor(120.2196, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2694048285484314
distance x is tensor(113.1837, device='cuda:0')
benign distance is  tensor(113.1837, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.30658939480781555
distance x is tensor(116.2188, device='cuda:0')
benign distance is  tensor(116.2188, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.36533594131469727
distance x is tensor(115.1171, device='cuda:0')
benign distance is  tensor(115.1171, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4247693121433258
distance x is tensor(113.9986, device='cuda:0')
benign distance is  tensor(113.9986, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2728903293609619
distance x is tensor(115.7931, device='cuda:0')
benign distance is  tensor(115.7931, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.48997727036476135
distance x is tensor(110.8026, device='cuda:0')
benign distance is  tensor(110.8026, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.24948839843273163
distance x is tensor(113.7671, device='cuda:0')
benign distance is  tensor(113.7671, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5512855648994446
distance x is tensor(112.2208, device='cuda:0')
benign distance is  tensor(112.2208, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5949141979217529
distance x is tensor(117.9427, device='cuda:0')
benign distance is  tensor(117.9427, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.31992819905281067
distance x is tensor(109.7351, device='cuda:0')
benign distance is  tensor(109.7351, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.25662457942962646
distance x is tensor(115.3007, device='cuda:0')
benign distance is  tensor(115.3007, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6123499274253845
distance x is tensor(111.2544, device='cuda:0')
benign distance is  tensor(111.2544, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.43684086203575134
distance x is tensor(115.4211, device='cuda:0')
benign distance is  tensor(115.4211, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5468963384628296
distance x is tensor(114.8814, device='cuda:0')
benign distance is  tensor(114.8814, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.40243062376976013
distance x is tensor(114.3605, device='cuda:0')
benign distance is  tensor(114.3605, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.16342206299304962
distance x is tensor(113.7666, device='cuda:0')
benign distance is  tensor(113.7666, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2894512116909027
distance x is tensor(112.4046, device='cuda:0')
benign distance is  tensor(112.4046, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 573.8717,  553.4426,  571.2838,  555.2466,  565.9902,  573.9708,
         570.8138,  564.0800, 1206.1949, 1202.5859, 1245.8712, 1222.8881,
        1246.8403, 1226.3145, 1217.8573, 1218.4421, 1240.8369, 1224.3910,
        1229.2056, 1222.1616], device='cuda:0')
sorted_norm is   tensor([ 553.4426,  555.2466,  564.0800,  565.9902,  570.8138,  571.2838,
         573.8717,  573.9708, 1202.5859, 1206.1949, 1217.8573, 1218.4421,
        1222.1616, 1222.8881, 1224.3910, 1226.3145, 1229.2056, 1240.8369,
        1245.8712, 1246.8403], device='cuda:0')
used idx is  tensor([ 1,  3,  7,  4,  6,  2,  0,  5,  9,  8, 14, 15, 19, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 15.46% 

Test Accuracy: 15.52% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3401431441307068
distance x is tensor(137.8545, device='cuda:0')
benign distance is  tensor(137.8545, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3862065374851227
distance x is tensor(129.5535, device='cuda:0')
benign distance is  tensor(129.5535, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2613397538661957
distance x is tensor(130.3282, device='cuda:0')
benign distance is  tensor(130.3282, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6110512018203735
distance x is tensor(134.3620, device='cuda:0')
benign distance is  tensor(134.3620, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5679908394813538
distance x is tensor(131.0465, device='cuda:0')
benign distance is  tensor(131.0465, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4688118100166321
distance x is tensor(135.5827, device='cuda:0')
benign distance is  tensor(135.5827, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.47822195291519165
distance x is tensor(131.6328, device='cuda:0')
benign distance is  tensor(131.6328, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2518603801727295
distance x is tensor(128.8899, device='cuda:0')
benign distance is  tensor(128.8899, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 36
weight size is  torch.Size([52, 215370])
norm res is  tensor([688.9753, 656.0670, 661.6396, 675.0060, 676.3939, 684.2651, 668.3787,
        662.8791, 840.3630, 831.1655, 860.5915, 849.8596, 876.4099, 843.1628,
        839.1682, 830.4312, 846.4867, 857.1450, 859.9973, 846.1094, 708.2341,
        727.5613, 736.2209, 732.5191, 695.9878, 723.1113, 708.4460, 744.0518,
        780.6431, 738.1675, 769.7304, 748.8806, 782.9888, 770.0908, 772.8755,
        753.1467, 762.2465, 756.5396, 767.3796, 764.1893, 746.4896, 750.1940,
        780.3609, 753.9631, 777.9268, 770.9930, 766.1066, 768.1735, 761.7177,
        755.7886, 768.2845, 787.3790], device='cuda:0')
sorted_norm is   tensor([656.0670, 661.6396, 662.8791, 668.3787, 675.0060, 676.3939, 684.2651,
        688.9753, 695.9878, 708.2341, 708.4460, 723.1113, 727.5613, 732.5191,
        736.2209, 738.1675, 744.0518, 746.4896, 748.8806, 750.1940, 753.1467,
        753.9631, 755.7886, 756.5396, 761.7177, 762.2465, 764.1893, 766.1066,
        767.3796, 768.1735, 768.2845, 769.7304, 770.0908, 770.9930, 772.8755,
        777.9268, 780.3609, 780.6431, 782.9888, 787.3790, 830.4312, 831.1655,
        839.1682, 840.3630, 843.1628, 846.1094, 846.4867, 849.8596, 857.1450,
        859.9973, 860.5915, 876.4099], device='cuda:0')
used idx is  tensor([ 1,  2,  7,  6,  3,  4,  5,  0, 24, 20, 26, 25, 21, 23, 22, 29, 27, 40,
        31, 41, 35, 43, 49, 37, 48, 36, 39, 46, 38, 47, 50, 30, 33, 45, 34, 44],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 81.47% 

Test Accuracy: 80.22% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.471550852060318
distance x is tensor(101.7306, device='cuda:0')
benign distance is  tensor(101.7306, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.43576639890670776
distance x is tensor(103.4810, device='cuda:0')
benign distance is  tensor(103.4810, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1863308697938919
distance x is tensor(98.9117, device='cuda:0')
benign distance is  tensor(98.9117, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6504491567611694
distance x is tensor(97.2895, device='cuda:0')
benign distance is  tensor(97.2895, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3739425539970398
distance x is tensor(96.8660, device='cuda:0')
benign distance is  tensor(96.8660, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6077858805656433
distance x is tensor(104.2945, device='cuda:0')
benign distance is  tensor(104.2945, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23554761707782745
distance x is tensor(102.6737, device='cuda:0')
benign distance is  tensor(102.6737, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6689845323562622
distance x is tensor(102.5633, device='cuda:0')
benign distance is  tensor(102.5633, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.24101869761943817
distance x is tensor(110.9397, device='cuda:0')
benign distance is  tensor(110.9397, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2370760440826416
distance x is tensor(99.3690, device='cuda:0')
benign distance is  tensor(99.3690, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.573551595211029
distance x is tensor(104.6368, device='cuda:0')
benign distance is  tensor(104.6368, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5882126092910767
distance x is tensor(102.0369, device='cuda:0')
benign distance is  tensor(102.0369, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.27427545189857483
distance x is tensor(105.8047, device='cuda:0')
benign distance is  tensor(105.8047, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.40481334924697876
distance x is tensor(101.3141, device='cuda:0')
benign distance is  tensor(101.3141, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6663418412208557
distance x is tensor(99.0517, device='cuda:0')
benign distance is  tensor(99.0517, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3355598747730255
distance x is tensor(102.9404, device='cuda:0')
benign distance is  tensor(102.9404, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6409887671470642
distance x is tensor(95.9859, device='cuda:0')
benign distance is  tensor(95.9859, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5832434296607971
distance x is tensor(101.6093, device='cuda:0')
benign distance is  tensor(101.6093, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3304341733455658
distance x is tensor(111.7357, device='cuda:0')
benign distance is  tensor(111.7357, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3047254681587219
distance x is tensor(104.1881, device='cuda:0')
benign distance is  tensor(104.1881, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.41299834847450256
distance x is tensor(95.1902, device='cuda:0')
benign distance is  tensor(95.1902, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.568006157875061
distance x is tensor(103.1571, device='cuda:0')
benign distance is  tensor(103.1571, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5852597951889038
distance x is tensor(100.9320, device='cuda:0')
benign distance is  tensor(100.9320, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.2666211426258087
distance x is tensor(94.1656, device='cuda:0')
benign distance is  tensor(94.1656, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.32538285851478577
distance x is tensor(108.6090, device='cuda:0')
benign distance is  tensor(108.6090, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.28304997086524963
distance x is tensor(94.5427, device='cuda:0')
benign distance is  tensor(94.5427, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.34268054366111755
distance x is tensor(97.2610, device='cuda:0')
benign distance is  tensor(97.2610, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.29543453454971313
distance x is tensor(100.9384, device='cuda:0')
benign distance is  tensor(100.9384, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.3958433270454407
distance x is tensor(106.9171, device='cuda:0')
benign distance is  tensor(106.9171, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3553950786590576
distance x is tensor(97.1089, device='cuda:0')
benign distance is  tensor(97.1089, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.17664995789527893
distance x is tensor(103.1511, device='cuda:0')
benign distance is  tensor(103.1511, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.42369192838668823
distance x is tensor(97.7873, device='cuda:0')
benign distance is  tensor(97.7873, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.18025913834571838
distance x is tensor(99.4022, device='cuda:0')
benign distance is  tensor(99.4022, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.7136520147323608
distance x is tensor(103.8869, device='cuda:0')
benign distance is  tensor(103.8869, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3128295838832855
distance x is tensor(95.9499, device='cuda:0')
benign distance is  tensor(95.9499, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5648654103279114
distance x is tensor(99.8986, device='cuda:0')
benign distance is  tensor(99.8986, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.40751856565475464
distance x is tensor(94.9934, device='cuda:0')
benign distance is  tensor(94.9934, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.38368532061576843
distance x is tensor(105.8220, device='cuda:0')
benign distance is  tensor(105.8220, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.4041297435760498
distance x is tensor(100.4403, device='cuda:0')
benign distance is  tensor(100.4403, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2398202121257782
distance x is tensor(101.9940, device='cuda:0')
benign distance is  tensor(101.9940, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 500.7222,  500.2895,  481.4511,  477.2621,  468.3573,  501.4230,
         491.8118,  494.4797, 1422.4379, 1401.2086, 1438.3267, 1395.6609,
        1457.7347, 1435.4395, 1412.5264, 1415.1785, 1421.3529, 1432.8864,
        1423.5017, 1422.6681], device='cuda:0')
sorted_norm is   tensor([ 468.3573,  477.2621,  481.4511,  491.8118,  494.4797,  500.2895,
         500.7222,  501.4230, 1395.6609, 1401.2086, 1412.5264, 1415.1785,
        1421.3529, 1422.4379, 1422.6681, 1423.5017, 1432.8864, 1435.4395,
        1438.3267, 1457.7347], device='cuda:0')
used idx is  tensor([ 4,  3,  2,  6,  7,  1,  0,  5, 11,  9, 14, 15, 16,  8],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.38890811800956726
distance x is tensor(140.5364, device='cuda:0')
benign distance is  tensor(140.5364, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4611254632472992
distance x is tensor(138.3270, device='cuda:0')
benign distance is  tensor(138.3270, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3391302525997162
distance x is tensor(148.1554, device='cuda:0')
benign distance is  tensor(148.1554, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4971603453159332
distance x is tensor(141.9674, device='cuda:0')
benign distance is  tensor(141.9674, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5587939023971558
distance x is tensor(142.1407, device='cuda:0')
benign distance is  tensor(142.1407, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.29557478427886963
distance x is tensor(141.4833, device='cuda:0')
benign distance is  tensor(141.4833, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3237505555152893
distance x is tensor(140.0200, device='cuda:0')
benign distance is  tensor(140.0200, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2075854241847992
distance x is tensor(141.4670, device='cuda:0')
benign distance is  tensor(141.4670, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([688.1287, 675.0372, 721.2143, 686.7678, 689.5661, 694.0294, 678.6790,
        684.6269, 836.4277, 847.5206, 885.1312, 865.3955, 879.6824, 842.4921,
        863.4470, 889.7401, 877.5062, 891.3881, 869.2388, 892.1296, 834.0236,
        787.8265, 803.4943, 788.3255, 806.7937, 791.5603, 789.8217, 802.5347],
       device='cuda:0')
sorted_norm is   tensor([675.0372, 678.6790, 684.6269, 686.7678, 688.1287, 689.5661, 694.0294,
        721.2143, 787.8265, 788.3255, 789.8217, 791.5603, 802.5347, 803.4943,
        806.7937, 834.0236, 836.4277, 842.4921, 847.5206, 863.4470, 865.3955,
        869.2388, 877.5062, 879.6824, 885.1312, 889.7401, 891.3881, 892.1296],
       device='cuda:0')
used idx is  tensor([ 1,  6,  7,  3,  0,  4,  5,  2, 21, 23, 26, 25, 27, 22, 24, 20,  8, 13,
         9], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 80.67% 

Test Accuracy: 79.90% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6248577833175659
distance x is tensor(114.3938, device='cuda:0')
benign distance is  tensor(114.3938, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4255361557006836
distance x is tensor(109.7879, device='cuda:0')
benign distance is  tensor(109.7879, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2937988340854645
distance x is tensor(108.8010, device='cuda:0')
benign distance is  tensor(108.8010, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5318378806114197
distance x is tensor(112.1660, device='cuda:0')
benign distance is  tensor(112.1660, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1307968944311142
distance x is tensor(110.2127, device='cuda:0')
benign distance is  tensor(110.2127, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5465790629386902
distance x is tensor(119.8826, device='cuda:0')
benign distance is  tensor(119.8826, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7365936040878296
distance x is tensor(111.2063, device='cuda:0')
benign distance is  tensor(111.2063, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9456155896186829
distance x is tensor(115.7197, device='cuda:0')
benign distance is  tensor(115.7197, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3899143636226654
distance x is tensor(116.2963, device='cuda:0')
benign distance is  tensor(116.2963, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4776119589805603
distance x is tensor(107.8274, device='cuda:0')
benign distance is  tensor(107.8274, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6023685932159424
distance x is tensor(113.9025, device='cuda:0')
benign distance is  tensor(113.9025, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.241567924618721
distance x is tensor(115.5194, device='cuda:0')
benign distance is  tensor(115.5194, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5843589305877686
distance x is tensor(106.9548, device='cuda:0')
benign distance is  tensor(106.9548, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3790980577468872
distance x is tensor(112.6036, device='cuda:0')
benign distance is  tensor(112.6036, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.701039731502533
distance x is tensor(107.3365, device='cuda:0')
benign distance is  tensor(107.3365, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3170689046382904
distance x is tensor(113.8832, device='cuda:0')
benign distance is  tensor(113.8832, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 536.8105,  520.0953,  520.0111,  526.3049,  527.2510,  561.9280,
         526.6551,  552.1553, 1262.1488, 1259.5841, 1300.1556, 1273.4941,
        1314.1632, 1296.4496, 1269.1410, 1273.9342, 1276.4938, 1287.8152,
        1311.9672, 1292.5459,  552.7170,  566.0921,  562.1731,  569.9496,
         569.4283,  553.7791,  556.9493,  554.1237,  536.9129,  546.5761,
         577.3489,  569.3182,  522.0912,  548.8558,  551.1010,  527.0623],
       device='cuda:0')
sorted_norm is   tensor([ 520.0111,  520.0953,  522.0912,  526.3049,  526.6551,  527.0623,
         527.2510,  536.8105,  536.9129,  546.5761,  548.8558,  551.1010,
         552.1553,  552.7170,  553.7791,  554.1237,  556.9493,  561.9280,
         562.1731,  566.0921,  569.3182,  569.4283,  569.9496,  577.3489,
        1259.5841, 1262.1488, 1269.1410, 1273.4941, 1273.9342, 1276.4938,
        1287.8152, 1292.5459, 1296.4496, 1300.1556, 1311.9672, 1314.1632],
       device='cuda:0')
used idx is  tensor([ 2,  1, 32,  3,  6, 35,  4,  0, 28, 29, 33, 34,  7, 20, 25, 27, 26,  5,
        22, 21, 31, 24, 23, 30,  9], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 84.32% 

Test Accuracy: 83.64% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4751155972480774
distance x is tensor(103.3739, device='cuda:0')
benign distance is  tensor(103.3739, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.29279249906539917
distance x is tensor(101.3696, device='cuda:0')
benign distance is  tensor(101.3696, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.35820746421813965
distance x is tensor(101.7630, device='cuda:0')
benign distance is  tensor(101.7630, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47878140211105347
distance x is tensor(102.4146, device='cuda:0')
benign distance is  tensor(102.4146, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3189641535282135
distance x is tensor(94.8070, device='cuda:0')
benign distance is  tensor(94.8070, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5582212209701538
distance x is tensor(102.7164, device='cuda:0')
benign distance is  tensor(102.7164, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3111545443534851
distance x is tensor(106.1840, device='cuda:0')
benign distance is  tensor(106.1840, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2734777331352234
distance x is tensor(107.0099, device='cuda:0')
benign distance is  tensor(107.0099, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.48768162727355957
distance x is tensor(102.9303, device='cuda:0')
benign distance is  tensor(102.9303, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.47575879096984863
distance x is tensor(103.3828, device='cuda:0')
benign distance is  tensor(103.3828, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.22157022356987
distance x is tensor(107.7612, device='cuda:0')
benign distance is  tensor(107.7612, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.50754714012146
distance x is tensor(101.1263, device='cuda:0')
benign distance is  tensor(101.1263, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.30201131105422974
distance x is tensor(94.4826, device='cuda:0')
benign distance is  tensor(94.4826, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.1380016952753067
distance x is tensor(96.9320, device='cuda:0')
benign distance is  tensor(96.9320, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3431283235549927
distance x is tensor(101.5287, device='cuda:0')
benign distance is  tensor(101.5287, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.2972777783870697
distance x is tensor(97.4662, device='cuda:0')
benign distance is  tensor(97.4662, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5502914190292358
distance x is tensor(98.0516, device='cuda:0')
benign distance is  tensor(98.0516, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.2808874249458313
distance x is tensor(98.9934, device='cuda:0')
benign distance is  tensor(98.9934, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.24252469837665558
distance x is tensor(99.5424, device='cuda:0')
benign distance is  tensor(99.5424, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.44441646337509155
distance x is tensor(98.3458, device='cuda:0')
benign distance is  tensor(98.3458, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4037068784236908
distance x is tensor(102.0874, device='cuda:0')
benign distance is  tensor(102.0874, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4361763894557953
distance x is tensor(99.4236, device='cuda:0')
benign distance is  tensor(99.4236, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2850082814693451
distance x is tensor(99.8934, device='cuda:0')
benign distance is  tensor(99.8934, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.11949177831411362
distance x is tensor(105.9592, device='cuda:0')
benign distance is  tensor(105.9592, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 492.1047,  482.5190,  483.6794,  491.7729,  465.3374,  502.3873,
         500.3875,  510.1815, 1511.3466, 1507.4073, 1557.8196, 1526.4275,
        1557.7357, 1544.7712, 1513.0765, 1518.7950, 1518.7161, 1554.0226,
        1539.4069, 1525.5809,  486.1867,  461.5800,  468.2106,  466.1344,
         483.8908,  460.5444,  483.1597,  461.1063,  509.7958,  472.0224,
         491.3392,  503.0915,  479.6943,  490.5015,  482.1919,  514.3011],
       device='cuda:0')
sorted_norm is   tensor([ 460.5444,  461.1063,  461.5800,  465.3374,  466.1344,  468.2106,
         472.0224,  479.6943,  482.1919,  482.5190,  483.1597,  483.6794,
         483.8908,  486.1867,  490.5015,  491.3392,  491.7729,  492.1047,
         500.3875,  502.3873,  503.0915,  509.7958,  510.1815,  514.3011,
        1507.4073, 1511.3466, 1513.0765, 1518.7161, 1518.7950, 1525.5809,
        1526.4275, 1539.4069, 1544.7712, 1554.0226, 1557.7357, 1557.8196],
       device='cuda:0')
used idx is  tensor([25, 27, 21,  4, 23, 22, 29, 32, 34,  1, 26,  2, 24, 20, 33, 30,  3,  0,
         6,  5, 31, 28,  7, 35,  9], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 84.81% 

Test Accuracy: 83.99% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.158002108335495
distance x is tensor(100.9161, device='cuda:0')
benign distance is  tensor(100.9161, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2949667274951935
distance x is tensor(94.5954, device='cuda:0')
benign distance is  tensor(94.5954, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12852300703525543
distance x is tensor(101.1453, device='cuda:0')
benign distance is  tensor(101.1453, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6451571583747864
distance x is tensor(96.0262, device='cuda:0')
benign distance is  tensor(96.0262, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5044771432876587
distance x is tensor(92.4575, device='cuda:0')
benign distance is  tensor(92.4575, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7852033972740173
distance x is tensor(109.9636, device='cuda:0')
benign distance is  tensor(109.9636, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.14659856259822845
distance x is tensor(102.2059, device='cuda:0')
benign distance is  tensor(102.2059, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.416830837726593
distance x is tensor(99.6564, device='cuda:0')
benign distance is  tensor(99.6564, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20395700633525848
distance x is tensor(107.6539, device='cuda:0')
benign distance is  tensor(107.6539, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4811408519744873
distance x is tensor(94.8127, device='cuda:0')
benign distance is  tensor(94.8127, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5628522634506226
distance x is tensor(98.8673, device='cuda:0')
benign distance is  tensor(98.8673, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0081970691680908
distance x is tensor(100.2356, device='cuda:0')
benign distance is  tensor(100.2356, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2935566008090973
distance x is tensor(99.4149, device='cuda:0')
benign distance is  tensor(99.4149, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2061721384525299
distance x is tensor(97.7307, device='cuda:0')
benign distance is  tensor(97.7307, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.47582536935806274
distance x is tensor(100.7829, device='cuda:0')
benign distance is  tensor(100.7829, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3922778367996216
distance x is tensor(105.9121, device='cuda:0')
benign distance is  tensor(105.9121, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.45574456453323364
distance x is tensor(114.7324, device='cuda:0')
benign distance is  tensor(114.7324, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7211419343948364
distance x is tensor(96.1576, device='cuda:0')
benign distance is  tensor(96.1576, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6144453883171082
distance x is tensor(108.1664, device='cuda:0')
benign distance is  tensor(108.1664, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.27071380615234375
distance x is tensor(98.7561, device='cuda:0')
benign distance is  tensor(98.7561, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5375206470489502
distance x is tensor(104.9194, device='cuda:0')
benign distance is  tensor(104.9194, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5386826992034912
distance x is tensor(99.1355, device='cuda:0')
benign distance is  tensor(99.1355, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1973595917224884
distance x is tensor(102.4504, device='cuda:0')
benign distance is  tensor(102.4504, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3903173506259918
distance x is tensor(93.2448, device='cuda:0')
benign distance is  tensor(93.2448, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 479.8477,  450.1381,  482.7809,  457.9610,  445.1402,  518.0242,
         472.4529,  481.8497, 1573.4602, 1582.9813, 1603.7856, 1582.6079,
        1608.2775, 1611.6570, 1579.9427, 1584.2178, 1588.6689, 1595.6366,
        1605.8396, 1606.9692], device='cuda:0')
sorted_norm is   tensor([ 445.1402,  450.1381,  457.9610,  472.4529,  479.8477,  481.8497,
         482.7809,  518.0242, 1573.4602, 1579.9427, 1582.6079, 1582.9813,
        1584.2178, 1588.6689, 1595.6366, 1603.7856, 1605.8396, 1606.9692,
        1608.2775, 1611.6570], device='cuda:0')
used idx is  tensor([ 4,  1,  3,  6,  0,  7,  2,  5,  8, 14, 11,  9, 15, 16],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 13.07% 

Test Accuracy: 13.23% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2873707711696625
distance x is tensor(140.8022, device='cuda:0')
benign distance is  tensor(140.8022, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.39858758449554443
distance x is tensor(144.7945, device='cuda:0')
benign distance is  tensor(144.7945, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.29346421360969543
distance x is tensor(138.5101, device='cuda:0')
benign distance is  tensor(138.5101, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.36894896626472473
distance x is tensor(141.5717, device='cuda:0')
benign distance is  tensor(141.5717, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4116212725639343
distance x is tensor(138.5822, device='cuda:0')
benign distance is  tensor(138.5822, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.45578107237815857
distance x is tensor(145.2974, device='cuda:0')
benign distance is  tensor(145.2974, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4589059352874756
distance x is tensor(141.0816, device='cuda:0')
benign distance is  tensor(141.0816, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5407117605209351
distance x is tensor(137.6537, device='cuda:0')
benign distance is  tensor(137.6537, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 30
weight size is  torch.Size([44, 215370])
norm res is  tensor([684.7723, 702.1221, 676.7745, 689.4319, 676.6390, 690.9648, 693.3843,
        680.5363, 858.7902, 866.3995, 872.1216, 862.7701, 883.7303, 859.7258,
        844.0851, 844.9589, 860.0125, 874.2655, 873.3158, 883.0827, 773.9738,
        796.8257, 777.1598, 791.5710, 775.2605, 807.9075, 791.2811, 785.6585,
        837.1014, 839.7304, 852.9468, 845.0043, 805.1416, 818.0483, 830.6291,
        822.3855, 881.8669, 833.0718, 836.7328, 853.4639, 850.6201, 839.0923,
        852.5145, 875.7686], device='cuda:0')
sorted_norm is   tensor([676.6390, 676.7745, 680.5363, 684.7723, 689.4319, 690.9648, 693.3843,
        702.1221, 773.9738, 775.2605, 777.1598, 785.6585, 791.2811, 791.5710,
        796.8257, 805.1416, 807.9075, 818.0483, 822.3855, 830.6291, 833.0718,
        836.7328, 837.1014, 839.0923, 839.7304, 844.0851, 844.9589, 845.0043,
        850.6201, 852.5145, 852.9468, 853.4639, 858.7902, 859.7258, 860.0125,
        862.7701, 866.3995, 872.1216, 873.3158, 874.2655, 875.7686, 881.8669,
        883.0827, 883.7303], device='cuda:0')
used idx is  tensor([ 4,  2,  7,  0,  3,  5,  6,  1, 20, 24, 22, 27, 26, 23, 21, 32, 25, 33,
        35, 34, 37, 38, 28, 41, 29, 14, 15, 31, 40, 42], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 85.11% 

Test Accuracy: 84.45% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5636852979660034
distance x is tensor(107.3404, device='cuda:0')
benign distance is  tensor(107.3404, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4772878587245941
distance x is tensor(100.2592, device='cuda:0')
benign distance is  tensor(100.2592, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19075798988342285
distance x is tensor(97.5255, device='cuda:0')
benign distance is  tensor(97.5255, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.31018581986427307
distance x is tensor(101.1936, device='cuda:0')
benign distance is  tensor(101.1936, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.32948946952819824
distance x is tensor(97.5190, device='cuda:0')
benign distance is  tensor(97.5190, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0154677629470825
distance x is tensor(114.2487, device='cuda:0')
benign distance is  tensor(114.2487, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.37335944175720215
distance x is tensor(103.1198, device='cuda:0')
benign distance is  tensor(103.1198, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.24567916989326477
distance x is tensor(107.8837, device='cuda:0')
benign distance is  tensor(107.8837, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.489475816488266
distance x is tensor(108.6153, device='cuda:0')
benign distance is  tensor(108.6153, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.20631130039691925
distance x is tensor(100.0434, device='cuda:0')
benign distance is  tensor(100.0434, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7639312744140625
distance x is tensor(99.6021, device='cuda:0')
benign distance is  tensor(99.6021, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.37670689821243286
distance x is tensor(103.1449, device='cuda:0')
benign distance is  tensor(103.1449, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4104997515678406
distance x is tensor(98.3180, device='cuda:0')
benign distance is  tensor(98.3180, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.35912829637527466
distance x is tensor(101.7307, device='cuda:0')
benign distance is  tensor(101.7307, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5293976068496704
distance x is tensor(101.4849, device='cuda:0')
benign distance is  tensor(101.4849, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5802541375160217
distance x is tensor(107.5261, device='cuda:0')
benign distance is  tensor(107.5261, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.24571171402931213
distance x is tensor(100.5236, device='cuda:0')
benign distance is  tensor(100.5236, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6897910237312317
distance x is tensor(105.1748, device='cuda:0')
benign distance is  tensor(105.1748, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4424683153629303
distance x is tensor(114.8725, device='cuda:0')
benign distance is  tensor(114.8725, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3431360721588135
distance x is tensor(104.7410, device='cuda:0')
benign distance is  tensor(104.7410, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.20947358012199402
distance x is tensor(99.5181, device='cuda:0')
benign distance is  tensor(99.5181, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.28754889965057373
distance x is tensor(98.7802, device='cuda:0')
benign distance is  tensor(98.7802, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.27462488412857056
distance x is tensor(112.2338, device='cuda:0')
benign distance is  tensor(112.2338, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.49671173095703125
distance x is tensor(100.6521, device='cuda:0')
benign distance is  tensor(100.6521, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1944904625415802
distance x is tensor(101.9703, device='cuda:0')
benign distance is  tensor(101.9703, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5678859949111938
distance x is tensor(113.8966, device='cuda:0')
benign distance is  tensor(113.8966, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.6972318887710571
distance x is tensor(99.2439, device='cuda:0')
benign distance is  tensor(99.2439, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4976758360862732
distance x is tensor(106.2781, device='cuda:0')
benign distance is  tensor(106.2781, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4142690598964691
distance x is tensor(99.0837, device='cuda:0')
benign distance is  tensor(99.0837, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.4855107367038727
distance x is tensor(100.7292, device='cuda:0')
benign distance is  tensor(100.7292, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7940317392349243
distance x is tensor(103.2677, device='cuda:0')
benign distance is  tensor(103.2677, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2911573052406311
distance x is tensor(102.2652, device='cuda:0')
benign distance is  tensor(102.2652, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 507.2650,  490.1624,  466.8673,  476.1483,  467.5331,  536.4041,
         481.2214,  509.2468, 1475.8326, 1479.1168, 1515.5647, 1501.5051,
        1514.3237, 1508.7021, 1494.2549, 1485.2246, 1490.1423, 1497.8812,
        1508.6614, 1500.7052], device='cuda:0')
sorted_norm is   tensor([ 466.8673,  467.5331,  476.1483,  481.2214,  490.1624,  507.2650,
         509.2468,  536.4041, 1475.8326, 1479.1168, 1485.2246, 1490.1423,
        1494.2549, 1497.8812, 1500.7052, 1501.5051, 1508.6614, 1508.7021,
        1514.3237, 1515.5647], device='cuda:0')
used idx is  tensor([ 2,  4,  3,  6,  1,  0,  7,  5,  8,  9, 15, 16, 14, 17],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8254834413528442
distance x is tensor(143.1811, device='cuda:0')
benign distance is  tensor(143.1811, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6728896498680115
distance x is tensor(136.9924, device='cuda:0')
benign distance is  tensor(136.9924, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.33140066266059875
distance x is tensor(143.9497, device='cuda:0')
benign distance is  tensor(143.9497, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5395206212997437
distance x is tensor(142.6346, device='cuda:0')
benign distance is  tensor(142.6346, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5626208782196045
distance x is tensor(144.2425, device='cuda:0')
benign distance is  tensor(144.2425, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5869455933570862
distance x is tensor(143.4361, device='cuda:0')
benign distance is  tensor(143.4361, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.499310165643692
distance x is tensor(143.3813, device='cuda:0')
benign distance is  tensor(143.3813, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3557165861129761
distance x is tensor(145.6761, device='cuda:0')
benign distance is  tensor(145.6761, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 30
weight size is  torch.Size([44, 215370])
norm res is  tensor([683.0609, 670.2994, 693.9181, 675.1993, 692.3588, 690.7654, 694.8447,
        694.2262, 864.3163, 829.2557, 869.3194, 863.1379, 895.3414, 863.4540,
        855.4823, 850.6064, 878.3699, 866.1693, 868.5713, 882.8649, 831.1494,
        826.5450, 831.4139, 822.4197, 832.1443, 831.4453, 834.6069, 848.0524,
        904.9753, 839.9573, 885.1532, 848.3200, 864.1288, 854.6296, 860.2986,
        831.4748, 845.6483, 819.1820, 811.5035, 820.2385, 817.0483, 820.9163,
        824.7308, 848.8704], device='cuda:0')
sorted_norm is   tensor([670.2994, 675.1993, 683.0609, 690.7654, 692.3588, 693.9181, 694.2262,
        694.8447, 811.5035, 817.0483, 819.1820, 820.2385, 820.9163, 822.4197,
        824.7308, 826.5450, 829.2557, 831.1494, 831.4139, 831.4453, 831.4748,
        832.1443, 834.6069, 839.9573, 845.6483, 848.0524, 848.3200, 848.8704,
        850.6064, 854.6296, 855.4823, 860.2986, 863.1379, 863.4540, 864.1288,
        864.3163, 866.1693, 868.5713, 869.3194, 878.3699, 882.8649, 885.1532,
        895.3414, 904.9753], device='cuda:0')
used idx is  tensor([ 1,  3,  0,  5,  4,  2,  7,  6, 38, 40, 37, 39, 41, 23, 42, 21,  9, 20,
        22, 25, 35, 24, 26, 29, 36, 27, 31, 43, 15, 33], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 85.33% 

Test Accuracy: 84.40% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5359426140785217
distance x is tensor(105.9169, device='cuda:0')
benign distance is  tensor(105.9169, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.30824217200279236
distance x is tensor(101.6196, device='cuda:0')
benign distance is  tensor(101.6196, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3940003216266632
distance x is tensor(102.8804, device='cuda:0')
benign distance is  tensor(102.8804, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4507925510406494
distance x is tensor(101.0406, device='cuda:0')
benign distance is  tensor(101.0406, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.925157368183136
distance x is tensor(99.6899, device='cuda:0')
benign distance is  tensor(99.6899, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.34682348370552063
distance x is tensor(109.4676, device='cuda:0')
benign distance is  tensor(109.4676, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31996822357177734
distance x is tensor(101.7362, device='cuda:0')
benign distance is  tensor(101.7362, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.417097806930542
distance x is tensor(107.1608, device='cuda:0')
benign distance is  tensor(107.1608, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6184149384498596
distance x is tensor(106.0575, device='cuda:0')
benign distance is  tensor(106.0575, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2779276967048645
distance x is tensor(100.4421, device='cuda:0')
benign distance is  tensor(100.4421, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.28995728492736816
distance x is tensor(99.8834, device='cuda:0')
benign distance is  tensor(99.8834, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5754355788230896
distance x is tensor(105.1050, device='cuda:0')
benign distance is  tensor(105.1050, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.27997127175331116
distance x is tensor(105.0596, device='cuda:0')
benign distance is  tensor(105.0596, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.46126770973205566
distance x is tensor(100.4495, device='cuda:0')
benign distance is  tensor(100.4495, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.38392388820648193
distance x is tensor(99.8023, device='cuda:0')
benign distance is  tensor(99.8023, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0132933855056763
distance x is tensor(103.8078, device='cuda:0')
benign distance is  tensor(103.8078, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.35568347573280334
distance x is tensor(111.5035, device='cuda:0')
benign distance is  tensor(111.5035, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4622885584831238
distance x is tensor(94.1079, device='cuda:0')
benign distance is  tensor(94.1079, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2566102147102356
distance x is tensor(103.3122, device='cuda:0')
benign distance is  tensor(103.3122, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5462273359298706
distance x is tensor(103.1961, device='cuda:0')
benign distance is  tensor(103.1961, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5541449785232544
distance x is tensor(102.9376, device='cuda:0')
benign distance is  tensor(102.9376, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.28875383734703064
distance x is tensor(101.1953, device='cuda:0')
benign distance is  tensor(101.1953, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2699604332447052
distance x is tensor(107.8473, device='cuda:0')
benign distance is  tensor(107.8473, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.27067169547080994
distance x is tensor(100.9754, device='cuda:0')
benign distance is  tensor(100.9754, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.40830761194229126
distance x is tensor(105.9191, device='cuda:0')
benign distance is  tensor(105.9191, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.31619518995285034
distance x is tensor(101.5572, device='cuda:0')
benign distance is  tensor(101.5572, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.27570515871047974
distance x is tensor(105.2172, device='cuda:0')
benign distance is  tensor(105.2172, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3460642993450165
distance x is tensor(104.4363, device='cuda:0')
benign distance is  tensor(104.4363, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5878612995147705
distance x is tensor(97.6666, device='cuda:0')
benign distance is  tensor(97.6666, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.94610595703125
distance x is tensor(100.9083, device='cuda:0')
benign distance is  tensor(100.9083, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.19038709998130798
distance x is tensor(105.5935, device='cuda:0')
benign distance is  tensor(105.5935, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.10306836664676666
distance x is tensor(103.7548, device='cuda:0')
benign distance is  tensor(103.7548, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 500.6190,  478.2849,  495.0839,  476.5620,  476.8207,  516.4497,
         481.9178,  507.7889, 1511.9435, 1507.7994, 1536.3337, 1516.2332,
        1537.1606, 1545.3091, 1519.2476, 1518.5007, 1526.6698, 1535.1027,
        1541.5215, 1531.8799,  487.2412,  493.9554,  534.8754,  514.7278,
         470.7107,  470.4876,  532.6437,  486.0890], device='cuda:0')
sorted_norm is   tensor([ 470.4876,  470.7107,  476.5620,  476.8207,  478.2849,  481.9178,
         486.0890,  487.2412,  493.9554,  495.0839,  500.6190,  507.7889,
         514.7278,  516.4497,  532.6437,  534.8754, 1507.7994, 1511.9435,
        1516.2332, 1518.5007, 1519.2476, 1526.6698, 1531.8799, 1535.1027,
        1536.3337, 1537.1606, 1541.5215, 1545.3091], device='cuda:0')
used idx is  tensor([25, 24,  3,  4,  1,  6, 27, 20, 21,  2,  0,  7, 23,  5, 26, 22,  9,  8,
        11], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 84.84% 

Test Accuracy: 83.91% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6912538409233093
distance x is tensor(114.1751, device='cuda:0')
benign distance is  tensor(114.1751, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6174854040145874
distance x is tensor(110.7844, device='cuda:0')
benign distance is  tensor(110.7844, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4452818036079407
distance x is tensor(113.0240, device='cuda:0')
benign distance is  tensor(113.0240, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.631415843963623
distance x is tensor(115.6943, device='cuda:0')
benign distance is  tensor(115.6943, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.17375987768173218
distance x is tensor(108.1337, device='cuda:0')
benign distance is  tensor(108.1337, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.32011422514915466
distance x is tensor(119.6723, device='cuda:0')
benign distance is  tensor(119.6723, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5580591559410095
distance x is tensor(113.9536, device='cuda:0')
benign distance is  tensor(113.9536, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4894418716430664
distance x is tensor(116.6392, device='cuda:0')
benign distance is  tensor(116.6392, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.28435319662094116
distance x is tensor(109.1004, device='cuda:0')
benign distance is  tensor(109.1004, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.34841489791870117
distance x is tensor(113.6630, device='cuda:0')
benign distance is  tensor(113.6630, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3359765410423279
distance x is tensor(122.7903, device='cuda:0')
benign distance is  tensor(122.7903, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5712361931800842
distance x is tensor(111.2569, device='cuda:0')
benign distance is  tensor(111.2569, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.17755790054798126
distance x is tensor(105.3968, device='cuda:0')
benign distance is  tensor(105.3968, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4762945771217346
distance x is tensor(108.7414, device='cuda:0')
benign distance is  tensor(108.7414, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3244241178035736
distance x is tensor(114.5526, device='cuda:0')
benign distance is  tensor(114.5526, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4520723223686218
distance x is tensor(111.9804, device='cuda:0')
benign distance is  tensor(111.9804, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 527.4536,  514.8711,  521.3448,  523.6855,  511.5930,  548.0941,
         525.7251,  540.7077, 1417.9456, 1390.3798, 1433.2017, 1413.1414,
        1438.2920, 1421.9445, 1403.2772, 1392.1887, 1419.9896, 1416.6696,
        1429.0819, 1416.2330,  556.8395,  535.0989,  518.8089,  537.6312,
         549.1818,  524.4157,  527.5938,  558.6058], device='cuda:0')
sorted_norm is   tensor([ 511.5930,  514.8711,  518.8089,  521.3448,  523.6855,  524.4157,
         525.7251,  527.4536,  527.5938,  535.0989,  537.6312,  540.7077,
         548.0941,  549.1818,  556.8395,  558.6058, 1390.3798, 1392.1887,
        1403.2772, 1413.1414, 1416.2330, 1416.6696, 1417.9456, 1419.9896,
        1421.9445, 1429.0819, 1433.2017, 1438.2920], device='cuda:0')
used idx is  tensor([ 4,  1, 22,  2,  3, 25,  6,  0, 26, 21, 23,  7,  5, 24, 20, 27,  9, 15,
        14], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 85.13% 

Test Accuracy: 84.36% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.36568212509155273
distance x is tensor(108.6407, device='cuda:0')
benign distance is  tensor(108.6407, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.16525085270404816
distance x is tensor(107.1377, device='cuda:0')
benign distance is  tensor(107.1377, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19028837978839874
distance x is tensor(108.6515, device='cuda:0')
benign distance is  tensor(108.6515, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5237533450126648
distance x is tensor(110.5807, device='cuda:0')
benign distance is  tensor(110.5807, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3469492793083191
distance x is tensor(107.2406, device='cuda:0')
benign distance is  tensor(107.2406, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8259914517402649
distance x is tensor(120.1606, device='cuda:0')
benign distance is  tensor(120.1606, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2511274218559265
distance x is tensor(109.3562, device='cuda:0')
benign distance is  tensor(109.3562, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3532247543334961
distance x is tensor(119.8058, device='cuda:0')
benign distance is  tensor(119.8058, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.45402565598487854
distance x is tensor(120.5920, device='cuda:0')
benign distance is  tensor(120.5920, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2119198590517044
distance x is tensor(108.5989, device='cuda:0')
benign distance is  tensor(108.5989, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.33759063482284546
distance x is tensor(112.6091, device='cuda:0')
benign distance is  tensor(112.6091, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6888521313667297
distance x is tensor(116.4882, device='cuda:0')
benign distance is  tensor(116.4882, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5008878111839294
distance x is tensor(110.2933, device='cuda:0')
benign distance is  tensor(110.2933, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.36447787284851074
distance x is tensor(111.9922, device='cuda:0')
benign distance is  tensor(111.9922, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6669212579727173
distance x is tensor(107.2106, device='cuda:0')
benign distance is  tensor(107.2106, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.44865384697914124
distance x is tensor(117.5312, device='cuda:0')
benign distance is  tensor(117.5312, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 512.7664,  510.9665,  510.5612,  504.8605,  502.8408,  561.6889,
         523.4058,  554.8306, 1395.8231, 1391.2783, 1411.9310, 1404.2690,
        1426.2435, 1422.1659, 1409.7393, 1405.5836, 1417.9574, 1427.8788,
        1417.7959, 1395.4773], device='cuda:0')
sorted_norm is   tensor([ 502.8408,  504.8605,  510.5612,  510.9665,  512.7664,  523.4058,
         554.8306,  561.6889, 1391.2783, 1395.4773, 1395.8231, 1404.2690,
        1405.5836, 1409.7393, 1411.9310, 1417.7959, 1417.9574, 1422.1659,
        1426.2435, 1427.8788], device='cuda:0')
used idx is  tensor([ 4,  3,  2,  1,  0,  6,  7,  5,  9, 19,  8, 11, 15, 14],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 12.72% 

Test Accuracy: 12.86% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.41142740845680237
distance x is tensor(141.9226, device='cuda:0')
benign distance is  tensor(141.9226, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7843084335327148
distance x is tensor(144.0558, device='cuda:0')
benign distance is  tensor(144.0558, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.44629454612731934
distance x is tensor(137.9823, device='cuda:0')
benign distance is  tensor(137.9823, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45640936493873596
distance x is tensor(146.8143, device='cuda:0')
benign distance is  tensor(146.8143, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.34584373235702515
distance x is tensor(151.5719, device='cuda:0')
benign distance is  tensor(151.5719, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.32272419333457947
distance x is tensor(140.4661, device='cuda:0')
benign distance is  tensor(140.4661, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.41062769293785095
distance x is tensor(140.2788, device='cuda:0')
benign distance is  tensor(140.2788, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2773117423057556
distance x is tensor(146.0690, device='cuda:0')
benign distance is  tensor(146.0690, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 36
weight size is  torch.Size([52, 215370])
norm res is  tensor([670.1039, 685.8116, 675.4443, 692.9935, 719.0865, 675.2889, 674.1165,
        690.7816, 853.0001, 830.6172, 868.9324, 846.7267, 895.2026, 859.4465,
        844.5205, 847.5170, 876.1667, 887.0369, 864.2652, 856.5297, 833.0986,
        867.2122, 818.4608, 842.3216, 818.1480, 824.6495, 833.8556, 827.5741,
        872.8542, 806.4883, 842.2441, 838.6352, 843.2634, 844.1788, 856.5120,
        837.1530, 823.5397, 828.6505, 856.4528, 826.0854, 796.6743, 810.1639,
        827.1345, 821.6960, 859.2123, 809.9384, 821.2007, 837.5192, 821.3183,
        822.8023, 807.8694, 845.3317], device='cuda:0')
sorted_norm is   tensor([670.1039, 674.1165, 675.2889, 675.4443, 685.8116, 690.7816, 692.9935,
        719.0865, 796.6743, 806.4883, 807.8694, 809.9384, 810.1639, 818.1480,
        818.4608, 821.2007, 821.3183, 821.6960, 822.8023, 823.5397, 824.6495,
        826.0854, 827.1345, 827.5741, 828.6505, 830.6172, 833.0986, 833.8556,
        837.1530, 837.5192, 838.6352, 842.2441, 842.3216, 843.2634, 844.1788,
        844.5205, 845.3317, 846.7267, 847.5170, 853.0001, 856.4528, 856.5120,
        856.5297, 859.2123, 859.4465, 864.2652, 867.2122, 868.9324, 872.8542,
        876.1667, 887.0369, 895.2026], device='cuda:0')
used idx is  tensor([ 0,  6,  5,  2,  1,  7,  3,  4, 40, 29, 50, 45, 41, 24, 22, 46, 48, 43,
        49, 36, 25, 39, 42, 27, 37,  9, 20, 26, 35, 47, 31, 30, 23, 32, 33, 14],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 85.62% 

Test Accuracy: 84.52% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.14117944240570068
distance x is tensor(106.8092, device='cuda:0')
benign distance is  tensor(106.8092, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5820629596710205
distance x is tensor(99.5959, device='cuda:0')
benign distance is  tensor(99.5959, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.404440313577652
distance x is tensor(101.9910, device='cuda:0')
benign distance is  tensor(101.9910, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3318248987197876
distance x is tensor(103.8930, device='cuda:0')
benign distance is  tensor(103.8930, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5337924361228943
distance x is tensor(101.6801, device='cuda:0')
benign distance is  tensor(101.6801, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.23828351497650146
distance x is tensor(108.6799, device='cuda:0')
benign distance is  tensor(108.6799, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5107399821281433
distance x is tensor(102.0591, device='cuda:0')
benign distance is  tensor(102.0591, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2639649510383606
distance x is tensor(109.6911, device='cuda:0')
benign distance is  tensor(109.6911, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.32674676179885864
distance x is tensor(107.9840, device='cuda:0')
benign distance is  tensor(107.9840, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.28187164664268494
distance x is tensor(103.5495, device='cuda:0')
benign distance is  tensor(103.5495, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.13101722300052643
distance x is tensor(100.2211, device='cuda:0')
benign distance is  tensor(100.2211, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.43116116523742676
distance x is tensor(109.6746, device='cuda:0')
benign distance is  tensor(109.6746, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.37104901671409607
distance x is tensor(105.1520, device='cuda:0')
benign distance is  tensor(105.1520, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.26486608386039734
distance x is tensor(103.7590, device='cuda:0')
benign distance is  tensor(103.7590, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3918780982494354
distance x is tensor(100.9317, device='cuda:0')
benign distance is  tensor(100.9317, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7745068669319153
distance x is tensor(108.0319, device='cuda:0')
benign distance is  tensor(108.0319, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.34307587146759033
distance x is tensor(101.5996, device='cuda:0')
benign distance is  tensor(101.5996, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5155469179153442
distance x is tensor(110.2561, device='cuda:0')
benign distance is  tensor(110.2561, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.08252169191837311
distance x is tensor(115.0093, device='cuda:0')
benign distance is  tensor(115.0093, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2608562111854553
distance x is tensor(106.3802, device='cuda:0')
benign distance is  tensor(106.3802, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.12193183600902557
distance x is tensor(95.6698, device='cuda:0')
benign distance is  tensor(95.6698, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4558629095554352
distance x is tensor(101.5126, device='cuda:0')
benign distance is  tensor(101.5126, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.22612221539020538
distance x is tensor(107.4615, device='cuda:0')
benign distance is  tensor(107.4615, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.22934365272521973
distance x is tensor(106.8955, device='cuda:0')
benign distance is  tensor(106.8955, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6773353815078735
distance x is tensor(112.9902, device='cuda:0')
benign distance is  tensor(112.9902, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8517023324966431
distance x is tensor(98.3198, device='cuda:0')
benign distance is  tensor(98.3198, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3703747093677521
distance x is tensor(109.2867, device='cuda:0')
benign distance is  tensor(109.2867, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5119456648826599
distance x is tensor(106.1490, device='cuda:0')
benign distance is  tensor(106.1490, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6757148504257202
distance x is tensor(106.9716, device='cuda:0')
benign distance is  tensor(106.9716, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.36464184522628784
distance x is tensor(105.0287, device='cuda:0')
benign distance is  tensor(105.0287, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.16135625541210175
distance x is tensor(105.9667, device='cuda:0')
benign distance is  tensor(105.9667, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2605718970298767
distance x is tensor(95.6205, device='cuda:0')
benign distance is  tensor(95.6205, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4449695944786072
distance x is tensor(101.1065, device='cuda:0')
benign distance is  tensor(101.1065, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.32537415623664856
distance x is tensor(108.1644, device='cuda:0')
benign distance is  tensor(108.1644, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3210103213787079
distance x is tensor(97.9984, device='cuda:0')
benign distance is  tensor(97.9984, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4394870698451996
distance x is tensor(101.9629, device='cuda:0')
benign distance is  tensor(101.9629, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.20653340220451355
distance x is tensor(103.6545, device='cuda:0')
benign distance is  tensor(103.6545, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5629426836967468
distance x is tensor(104.8365, device='cuda:0')
benign distance is  tensor(104.8365, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.4487382471561432
distance x is tensor(100.7147, device='cuda:0')
benign distance is  tensor(100.7147, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.38521263003349304
distance x is tensor(101.8412, device='cuda:0')
benign distance is  tensor(101.8412, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 500.9821,  468.3807,  491.4510,  485.5727,  482.7172,  511.7461,
         475.4646,  520.0997, 1548.2815, 1524.6177, 1565.5686, 1552.7626,
        1565.6449, 1552.6935, 1540.9929, 1525.2026, 1554.4415, 1547.9714,
        1567.6030, 1550.8518,  507.3529,  491.3771,  513.9918,  496.6083,
         476.7694,  487.3924,  510.8354,  502.4217], device='cuda:0')
sorted_norm is   tensor([ 468.3807,  475.4646,  476.7694,  482.7172,  485.5727,  487.3924,
         491.3771,  491.4510,  496.6083,  500.9821,  502.4217,  507.3529,
         510.8354,  511.7461,  513.9918,  520.0997, 1524.6177, 1525.2026,
        1540.9929, 1547.9714, 1548.2815, 1550.8518, 1552.6935, 1552.7626,
        1554.4415, 1565.5686, 1565.6449, 1567.6030], device='cuda:0')
used idx is  tensor([ 1,  6, 24,  4,  3, 25, 21,  2, 23,  0, 27, 20, 26,  5, 22,  7,  9, 15,
        14], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 85.71% 

Test Accuracy: 85.03% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.44538798928260803
distance x is tensor(117.0619, device='cuda:0')
benign distance is  tensor(117.0619, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6158856749534607
distance x is tensor(111.5758, device='cuda:0')
benign distance is  tensor(111.5758, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22007779777050018
distance x is tensor(117.8267, device='cuda:0')
benign distance is  tensor(117.8267, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4283686578273773
distance x is tensor(114.3505, device='cuda:0')
benign distance is  tensor(114.3505, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.870185375213623
distance x is tensor(115.8306, device='cuda:0')
benign distance is  tensor(115.8306, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9270048141479492
distance x is tensor(117.5555, device='cuda:0')
benign distance is  tensor(117.5555, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4574572443962097
distance x is tensor(112.3845, device='cuda:0')
benign distance is  tensor(112.3845, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.28635963797569275
distance x is tensor(111.0272, device='cuda:0')
benign distance is  tensor(111.0272, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2752600610256195
distance x is tensor(109.1154, device='cuda:0')
benign distance is  tensor(109.1154, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.22492527961730957
distance x is tensor(115.4344, device='cuda:0')
benign distance is  tensor(115.4344, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3140968680381775
distance x is tensor(110.9119, device='cuda:0')
benign distance is  tensor(110.9119, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.35830941796302795
distance x is tensor(107.3497, device='cuda:0')
benign distance is  tensor(107.3497, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.28141671419143677
distance x is tensor(117.1006, device='cuda:0')
benign distance is  tensor(117.1006, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.12067750841379166
distance x is tensor(117.1245, device='cuda:0')
benign distance is  tensor(117.1245, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4130108952522278
distance x is tensor(109.1350, device='cuda:0')
benign distance is  tensor(109.1350, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2668387293815613
distance x is tensor(115.8090, device='cuda:0')
benign distance is  tensor(115.8090, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 549.7407,  521.1513,  547.4727,  523.1628,  532.4012,  552.8004,
         520.4675,  522.3038, 1415.3025, 1399.1609, 1428.7468, 1416.0748,
        1424.7766, 1441.7720, 1402.4229, 1417.1820, 1421.4722, 1437.4603,
        1432.0226, 1428.2628,  561.8492,  543.7606,  531.5336,  563.7378,
         553.9810,  537.2742,  531.3752,  564.7864], device='cuda:0')
sorted_norm is   tensor([ 520.4675,  521.1513,  522.3038,  523.1628,  531.3752,  531.5336,
         532.4012,  537.2742,  543.7606,  547.4727,  549.7407,  552.8004,
         553.9810,  561.8492,  563.7378,  564.7864, 1399.1609, 1402.4229,
        1415.3025, 1416.0748, 1417.1820, 1421.4722, 1424.7766, 1428.2628,
        1428.7468, 1432.0226, 1437.4603, 1441.7720], device='cuda:0')
used idx is  tensor([ 6,  1,  7,  3, 26, 22,  4, 25, 21,  2,  0,  5, 24, 20, 23, 27,  9, 14,
         8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 85.66% 

Test Accuracy: 84.95% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6247748136520386
distance x is tensor(116.4468, device='cuda:0')
benign distance is  tensor(116.4468, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.15412788093090057
distance x is tensor(110.4501, device='cuda:0')
benign distance is  tensor(110.4501, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20343902707099915
distance x is tensor(118.3821, device='cuda:0')
benign distance is  tensor(118.3821, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6513311266899109
distance x is tensor(114.4709, device='cuda:0')
benign distance is  tensor(114.4709, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5885477066040039
distance x is tensor(110.1424, device='cuda:0')
benign distance is  tensor(110.1424, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6284406781196594
distance x is tensor(123.5342, device='cuda:0')
benign distance is  tensor(123.5342, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.301914244890213
distance x is tensor(112.3448, device='cuda:0')
benign distance is  tensor(112.3448, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3230760395526886
distance x is tensor(115.5489, device='cuda:0')
benign distance is  tensor(115.5489, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5159673094749451
distance x is tensor(115.6957, device='cuda:0')
benign distance is  tensor(115.6957, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.25783148407936096
distance x is tensor(108.6463, device='cuda:0')
benign distance is  tensor(108.6463, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8509090542793274
distance x is tensor(113.0144, device='cuda:0')
benign distance is  tensor(113.0144, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3258579671382904
distance x is tensor(116.5253, device='cuda:0')
benign distance is  tensor(116.5253, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5901403427124023
distance x is tensor(109.3015, device='cuda:0')
benign distance is  tensor(109.3015, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3233543038368225
distance x is tensor(117.4118, device='cuda:0')
benign distance is  tensor(117.4118, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.538628876209259
distance x is tensor(109.8363, device='cuda:0')
benign distance is  tensor(109.8363, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6083813309669495
distance x is tensor(117.5361, device='cuda:0')
benign distance is  tensor(117.5361, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 539.6777,  510.0715,  537.8865,  516.3514,  504.9508,  571.1408,
         515.7782,  533.2321, 1404.1791, 1397.5203, 1429.7145, 1440.8828,
        1436.0183, 1443.5536, 1410.1161, 1420.9077, 1415.9091, 1435.0413,
        1436.3425, 1423.3826,  538.5678,  566.0784,  578.1075,  555.0521,
         506.1687,  532.7759,  562.0002,  558.1625], device='cuda:0')
sorted_norm is   tensor([ 504.9508,  506.1687,  510.0715,  515.7782,  516.3514,  532.7759,
         533.2321,  537.8865,  538.5678,  539.6777,  555.0521,  558.1625,
         562.0002,  566.0784,  571.1408,  578.1075, 1397.5203, 1404.1791,
        1410.1161, 1415.9091, 1420.9077, 1423.3826, 1429.7145, 1435.0413,
        1436.0183, 1436.3425, 1440.8828, 1443.5536], device='cuda:0')
used idx is  tensor([ 4, 24,  1,  6,  3, 25,  7,  2, 20,  0, 23, 27, 26, 21,  5, 22,  9,  8,
        14], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 86.16% 

Test Accuracy: 84.98% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6535778641700745
distance x is tensor(113.5016, device='cuda:0')
benign distance is  tensor(113.5016, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.44868654012680054
distance x is tensor(112.8033, device='cuda:0')
benign distance is  tensor(112.8033, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.32103413343429565
distance x is tensor(115.5022, device='cuda:0')
benign distance is  tensor(115.5022, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3275378942489624
distance x is tensor(114.3344, device='cuda:0')
benign distance is  tensor(114.3344, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4990067481994629
distance x is tensor(112.5004, device='cuda:0')
benign distance is  tensor(112.5004, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6870003938674927
distance x is tensor(122.5133, device='cuda:0')
benign distance is  tensor(122.5133, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.456979900598526
distance x is tensor(114.4285, device='cuda:0')
benign distance is  tensor(114.4285, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4795230031013489
distance x is tensor(117.6901, device='cuda:0')
benign distance is  tensor(117.6901, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.26705801486968994
distance x is tensor(106.4505, device='cuda:0')
benign distance is  tensor(106.4505, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8581922650337219
distance x is tensor(118.1404, device='cuda:0')
benign distance is  tensor(118.1404, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2997558116912842
distance x is tensor(124.6639, device='cuda:0')
benign distance is  tensor(124.6639, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.20986723899841309
distance x is tensor(115.4113, device='cuda:0')
benign distance is  tensor(115.4113, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1781526356935501
distance x is tensor(113.8842, device='cuda:0')
benign distance is  tensor(113.8842, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6155419945716858
distance x is tensor(112.4898, device='cuda:0')
benign distance is  tensor(112.4898, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.22806799411773682
distance x is tensor(116.2417, device='cuda:0')
benign distance is  tensor(116.2417, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.31866252422332764
distance x is tensor(110.0411, device='cuda:0')
benign distance is  tensor(110.0411, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 531.9396,  528.0015,  527.5948,  520.7407,  516.4663,  559.9290,
         517.1713,  536.0190, 1410.2090, 1394.9058, 1441.6320, 1430.1737,
        1432.9747, 1458.9812, 1415.2512, 1424.7334, 1428.7821, 1440.0104,
        1429.9600, 1434.8307,  577.2610,  523.9592,  568.4312,  545.2637,
         546.6138,  543.4647,  557.8102,  517.9409,  560.0935,  521.9577,
         537.7720,  547.9041,  527.2991,  554.2761,  531.0809,  567.0305],
       device='cuda:0')
sorted_norm is   tensor([ 516.4663,  517.1713,  517.9409,  520.7407,  521.9577,  523.9592,
         527.2991,  527.5948,  528.0015,  531.0809,  531.9396,  536.0190,
         537.7720,  543.4647,  545.2637,  546.6138,  547.9041,  554.2761,
         557.8102,  559.9290,  560.0935,  567.0305,  568.4312,  577.2610,
        1394.9058, 1410.2090, 1415.2512, 1424.7334, 1428.7821, 1429.9600,
        1430.1737, 1432.9747, 1434.8307, 1440.0104, 1441.6320, 1458.9812],
       device='cuda:0')
used idx is  tensor([ 4,  6, 27,  3, 29, 21, 32,  2,  1, 34,  0,  7, 30, 25, 23, 24, 31, 33,
        26,  5, 28, 35, 22, 20,  9], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 86.79% 

Test Accuracy: 86.00% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.27560099959373474
distance x is tensor(102.8628, device='cuda:0')
benign distance is  tensor(102.8628, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5880365967750549
distance x is tensor(103.0518, device='cuda:0')
benign distance is  tensor(103.0518, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2852681279182434
distance x is tensor(101.2054, device='cuda:0')
benign distance is  tensor(101.2054, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.32544389367103577
distance x is tensor(105.1765, device='cuda:0')
benign distance is  tensor(105.1765, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33780696988105774
distance x is tensor(96.4435, device='cuda:0')
benign distance is  tensor(96.4435, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.522212564945221
distance x is tensor(114.4695, device='cuda:0')
benign distance is  tensor(114.4695, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6845394968986511
distance x is tensor(107.4091, device='cuda:0')
benign distance is  tensor(107.4091, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.402881920337677
distance x is tensor(107.1018, device='cuda:0')
benign distance is  tensor(107.1018, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.500960648059845
distance x is tensor(106.4822, device='cuda:0')
benign distance is  tensor(106.4822, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.33064278960227966
distance x is tensor(100.2443, device='cuda:0')
benign distance is  tensor(100.2443, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.378137469291687
distance x is tensor(98.1166, device='cuda:0')
benign distance is  tensor(98.1166, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8057032823562622
distance x is tensor(102.6020, device='cuda:0')
benign distance is  tensor(102.6020, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.40536555647850037
distance x is tensor(104.6118, device='cuda:0')
benign distance is  tensor(104.6118, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1942775398492813
distance x is tensor(101.7647, device='cuda:0')
benign distance is  tensor(101.7647, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5122071504592896
distance x is tensor(97.8148, device='cuda:0')
benign distance is  tensor(97.8148, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7430695295333862
distance x is tensor(108.6471, device='cuda:0')
benign distance is  tensor(108.6471, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.22977490723133087
distance x is tensor(113.8940, device='cuda:0')
benign distance is  tensor(113.8940, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.48423534631729126
distance x is tensor(99.9982, device='cuda:0')
benign distance is  tensor(99.9982, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.583452045917511
distance x is tensor(107.9125, device='cuda:0')
benign distance is  tensor(107.9125, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4267936646938324
distance x is tensor(108.3216, device='cuda:0')
benign distance is  tensor(108.3216, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6412760019302368
distance x is tensor(108.2030, device='cuda:0')
benign distance is  tensor(108.2030, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4990818500518799
distance x is tensor(104.9185, device='cuda:0')
benign distance is  tensor(104.9185, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3707636892795563
distance x is tensor(104.3852, device='cuda:0')
benign distance is  tensor(104.3852, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.21106114983558655
distance x is tensor(103.1817, device='cuda:0')
benign distance is  tensor(103.1817, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 495.4471,  479.1697,  476.4688,  488.8047,  455.2065,  538.7681,
         499.6973,  505.5410, 1666.5222, 1658.2262, 1693.4635, 1666.0723,
        1666.8994, 1691.8154, 1654.7704, 1666.6078, 1670.3959, 1688.8818,
        1692.0939, 1663.4542], device='cuda:0')
sorted_norm is   tensor([ 455.2065,  476.4688,  479.1697,  488.8047,  495.4471,  499.6973,
         505.5410,  538.7681, 1654.7704, 1658.2262, 1663.4542, 1666.0723,
        1666.5222, 1666.6078, 1666.8994, 1670.3959, 1688.8818, 1691.8154,
        1692.0939, 1693.4635], device='cuda:0')
used idx is  tensor([ 4,  2,  1,  3,  0,  6,  7,  5, 14,  9, 19, 11,  8, 15],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4088035225868225
distance x is tensor(140.0209, device='cuda:0')
benign distance is  tensor(140.0209, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5008633136749268
distance x is tensor(139.3415, device='cuda:0')
benign distance is  tensor(139.3415, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3499383330345154
distance x is tensor(140.8396, device='cuda:0')
benign distance is  tensor(140.8396, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.46013373136520386
distance x is tensor(142.1548, device='cuda:0')
benign distance is  tensor(142.1548, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.35886308550834656
distance x is tensor(138.8456, device='cuda:0')
benign distance is  tensor(138.8456, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2710021734237671
distance x is tensor(145.6892, device='cuda:0')
benign distance is  tensor(145.6892, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.44087862968444824
distance x is tensor(142.5887, device='cuda:0')
benign distance is  tensor(142.5887, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2894105315208435
distance x is tensor(142.3378, device='cuda:0')
benign distance is  tensor(142.3378, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 36
weight size is  torch.Size([52, 215370])
norm res is  tensor([665.3699, 659.9862, 673.6669, 668.3233, 671.6852, 687.0204, 676.5065,
        675.4210, 853.2120, 857.6313, 874.4889, 870.4399, 894.8710, 868.6378,
        857.4092, 845.8763, 878.2952, 883.4396, 857.7770, 879.8778, 821.9249,
        847.7087, 821.9930, 837.4642, 846.0786, 841.1270, 838.3740, 825.2966,
        809.0262, 828.3914, 821.3337, 793.8740, 832.3107, 829.3411, 810.4479,
        835.6918, 801.8810, 840.6575, 860.7084, 835.2186, 820.3926, 823.1755,
        831.0943, 807.7507, 904.6025, 872.0016, 859.4167, 878.6146, 888.5714,
        872.1431, 864.1697, 909.8954], device='cuda:0')
sorted_norm is   tensor([659.9862, 665.3699, 668.3233, 671.6852, 673.6669, 675.4210, 676.5065,
        687.0204, 793.8740, 801.8810, 807.7507, 809.0262, 810.4479, 820.3926,
        821.3337, 821.9249, 821.9930, 823.1755, 825.2966, 828.3914, 829.3411,
        831.0943, 832.3107, 835.2186, 835.6918, 837.4642, 838.3740, 840.6575,
        841.1270, 845.8763, 846.0786, 847.7087, 853.2120, 857.4092, 857.6313,
        857.7770, 859.4167, 860.7084, 864.1697, 868.6378, 870.4399, 872.0016,
        872.1431, 874.4889, 878.2952, 878.6146, 879.8778, 883.4396, 888.5714,
        894.8710, 904.6025, 909.8954], device='cuda:0')
used idx is  tensor([ 1,  0,  3,  4,  2,  7,  6,  5, 31, 36, 43, 28, 34, 40, 30, 20, 22, 41,
        27, 29, 33, 42, 32, 39, 35, 23, 26, 37, 25, 15, 24, 21,  8, 14,  9, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 85.93% 

Test Accuracy: 84.73% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5909168124198914
distance x is tensor(108.9443, device='cuda:0')
benign distance is  tensor(108.9443, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.36989742517471313
distance x is tensor(109.0461, device='cuda:0')
benign distance is  tensor(109.0461, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25908151268959045
distance x is tensor(109.7722, device='cuda:0')
benign distance is  tensor(109.7722, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5191173553466797
distance x is tensor(112.2389, device='cuda:0')
benign distance is  tensor(112.2389, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3028886914253235
distance x is tensor(104.3212, device='cuda:0')
benign distance is  tensor(104.3212, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7247735261917114
distance x is tensor(119.2764, device='cuda:0')
benign distance is  tensor(119.2764, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22617276012897491
distance x is tensor(106.8744, device='cuda:0')
benign distance is  tensor(106.8744, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40867629647254944
distance x is tensor(116.0793, device='cuda:0')
benign distance is  tensor(116.0793, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.21064798533916473
distance x is tensor(113.7768, device='cuda:0')
benign distance is  tensor(113.7768, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.14691811800003052
distance x is tensor(106.5835, device='cuda:0')
benign distance is  tensor(106.5835, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4426211416721344
distance x is tensor(113.6063, device='cuda:0')
benign distance is  tensor(113.6063, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5164589285850525
distance x is tensor(114.1924, device='cuda:0')
benign distance is  tensor(114.1924, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4887620508670807
distance x is tensor(112.2757, device='cuda:0')
benign distance is  tensor(112.2757, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.32041406631469727
distance x is tensor(108.9826, device='cuda:0')
benign distance is  tensor(108.9826, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5273343324661255
distance x is tensor(109.4043, device='cuda:0')
benign distance is  tensor(109.4043, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6218997836112976
distance x is tensor(118.0715, device='cuda:0')
benign distance is  tensor(118.0715, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3060050308704376
distance x is tensor(111.4510, device='cuda:0')
benign distance is  tensor(111.4510, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.46629342436790466
distance x is tensor(112.0858, device='cuda:0')
benign distance is  tensor(112.0858, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2812027335166931
distance x is tensor(128.1135, device='cuda:0')
benign distance is  tensor(128.1135, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4885663092136383
distance x is tensor(113.1604, device='cuda:0')
benign distance is  tensor(113.1604, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2121059149503708
distance x is tensor(105.6302, device='cuda:0')
benign distance is  tensor(105.6302, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5509994029998779
distance x is tensor(106.8677, device='cuda:0')
benign distance is  tensor(106.8677, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.41916337609291077
distance x is tensor(116.3767, device='cuda:0')
benign distance is  tensor(116.3767, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.37175148725509644
distance x is tensor(111.1907, device='cuda:0')
benign distance is  tensor(111.1907, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.21897725760936737
distance x is tensor(114.3500, device='cuda:0')
benign distance is  tensor(114.3500, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.21185190975666046
distance x is tensor(111.7466, device='cuda:0')
benign distance is  tensor(111.7466, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4782857894897461
distance x is tensor(116.7444, device='cuda:0')
benign distance is  tensor(116.7444, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.8503464460372925
distance x is tensor(114.4140, device='cuda:0')
benign distance is  tensor(114.4140, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.31672215461730957
distance x is tensor(113.1468, device='cuda:0')
benign distance is  tensor(113.1468, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.16490334272384644
distance x is tensor(109.9870, device='cuda:0')
benign distance is  tensor(109.9870, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.44287052750587463
distance x is tensor(116.1833, device='cuda:0')
benign distance is  tensor(116.1833, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2758343517780304
distance x is tensor(120.1878, device='cuda:0')
benign distance is  tensor(120.1878, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.39463573694229126
distance x is tensor(109.4127, device='cuda:0')
benign distance is  tensor(109.4127, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.14688894152641296
distance x is tensor(119.9555, device='cuda:0')
benign distance is  tensor(119.9555, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.6314979791641235
distance x is tensor(107.0785, device='cuda:0')
benign distance is  tensor(107.0785, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.1356782615184784
distance x is tensor(114.6733, device='cuda:0')
benign distance is  tensor(114.6733, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5137555003166199
distance x is tensor(113.2777, device='cuda:0')
benign distance is  tensor(113.2777, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.577055811882019
distance x is tensor(113.7431, device='cuda:0')
benign distance is  tensor(113.7431, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.2772054374217987
distance x is tensor(113.3060, device='cuda:0')
benign distance is  tensor(113.3060, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.29878416657447815
distance x is tensor(111.9534, device='cuda:0')
benign distance is  tensor(111.9534, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 509.9594,  515.9730,  515.1232,  514.6247,  487.9392,  551.1693,
         496.3104,  547.7872, 1410.1942, 1386.4922, 1443.4073, 1409.0109,
        1434.0854, 1427.0972, 1405.7859, 1398.2739, 1416.4120, 1420.9895,
        1438.3013, 1421.8167], device='cuda:0')
sorted_norm is   tensor([ 487.9392,  496.3104,  509.9594,  514.6247,  515.1232,  515.9730,
         547.7872,  551.1693, 1386.4922, 1398.2739, 1405.7859, 1409.0109,
        1410.1942, 1416.4120, 1420.9895, 1421.8167, 1427.0972, 1434.0854,
        1438.3013, 1443.4073], device='cuda:0')
used idx is  tensor([ 4,  6,  0,  3,  2,  1,  7,  5,  9, 15, 14, 11,  8, 16],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.22009965777397156
distance x is tensor(149.5198, device='cuda:0')
benign distance is  tensor(149.5198, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.28179699182510376
distance x is tensor(141.8505, device='cuda:0')
benign distance is  tensor(141.8505, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3588239550590515
distance x is tensor(141.1322, device='cuda:0')
benign distance is  tensor(141.1322, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.49326425790786743
distance x is tensor(142.0551, device='cuda:0')
benign distance is  tensor(142.0551, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5431485176086426
distance x is tensor(145.5285, device='cuda:0')
benign distance is  tensor(145.5285, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8999336957931519
distance x is tensor(142.0754, device='cuda:0')
benign distance is  tensor(142.0754, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.46707218885421753
distance x is tensor(143.1230, device='cuda:0')
benign distance is  tensor(143.1230, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.329260915517807
distance x is tensor(143.9314, device='cuda:0')
benign distance is  tensor(143.9314, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([710.6779, 670.0287, 672.1223, 670.8085, 712.6569, 690.4845, 683.9650,
        690.5560, 869.0974, 843.3006, 866.2559, 848.9364, 878.1331, 863.1234,
        846.2203, 847.1024, 861.3423, 870.0436, 854.1730, 874.1901, 932.9842,
        879.3020, 910.2460, 907.8486, 914.1140, 904.5381, 895.4833, 893.4362,
        833.5527, 803.1642, 816.4169, 827.2310, 814.9338, 812.9754, 810.5404,
        845.7236], device='cuda:0')
sorted_norm is   tensor([670.0287, 670.8085, 672.1223, 683.9650, 690.4845, 690.5560, 710.6779,
        712.6569, 803.1642, 810.5404, 812.9754, 814.9338, 816.4169, 827.2310,
        833.5527, 843.3006, 845.7236, 846.2203, 847.1024, 848.9364, 854.1730,
        861.3423, 863.1234, 866.2559, 869.0974, 870.0436, 874.1901, 878.1331,
        879.3020, 893.4362, 895.4833, 904.5381, 907.8486, 910.2460, 914.1140,
        932.9842], device='cuda:0')
used idx is  tensor([ 1,  3,  2,  6,  5,  7,  0,  4, 29, 34, 33, 32, 30, 31, 28,  9, 35, 14,
        15, 11, 18, 16, 13, 10,  8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 29.80% 

Test Accuracy: 29.85% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4374142587184906
distance x is tensor(147.3136, device='cuda:0')
benign distance is  tensor(147.3136, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46703872084617615
distance x is tensor(143.8276, device='cuda:0')
benign distance is  tensor(143.8276, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.39570099115371704
distance x is tensor(149.4938, device='cuda:0')
benign distance is  tensor(149.4938, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6150871515274048
distance x is tensor(149.0124, device='cuda:0')
benign distance is  tensor(149.0124, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.31291663646698
distance x is tensor(142.3492, device='cuda:0')
benign distance is  tensor(142.3492, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2669210731983185
distance x is tensor(147.3306, device='cuda:0')
benign distance is  tensor(147.3306, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.30201753973960876
distance x is tensor(143.3624, device='cuda:0')
benign distance is  tensor(143.3624, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37058210372924805
distance x is tensor(146.3225, device='cuda:0')
benign distance is  tensor(146.3225, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.39114874601364136
distance x is tensor(150.0605, device='cuda:0')
benign distance is  tensor(150.0605, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.45039135217666626
distance x is tensor(141.7280, device='cuda:0')
benign distance is  tensor(141.7280, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5870603322982788
distance x is tensor(143.0471, device='cuda:0')
benign distance is  tensor(143.0471, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6466937065124512
distance x is tensor(145.6712, device='cuda:0')
benign distance is  tensor(145.6712, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4655227065086365
distance x is tensor(149.9425, device='cuda:0')
benign distance is  tensor(149.9425, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17928120493888855
distance x is tensor(143.9620, device='cuda:0')
benign distance is  tensor(143.9620, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.38971373438835144
distance x is tensor(140.6825, device='cuda:0')
benign distance is  tensor(140.6825, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5940955281257629
distance x is tensor(148.4335, device='cuda:0')
benign distance is  tensor(148.4335, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.19665956497192383
distance x is tensor(150.5141, device='cuda:0')
benign distance is  tensor(150.5141, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6567926406860352
distance x is tensor(141.8915, device='cuda:0')
benign distance is  tensor(141.8915, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2949892282485962
distance x is tensor(148.9005, device='cuda:0')
benign distance is  tensor(148.9005, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4563533365726471
distance x is tensor(145.7686, device='cuda:0')
benign distance is  tensor(145.7686, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5663099884986877
distance x is tensor(145.0112, device='cuda:0')
benign distance is  tensor(145.0112, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.44749459624290466
distance x is tensor(152.6221, device='cuda:0')
benign distance is  tensor(152.6221, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3875664174556732
distance x is tensor(147.9093, device='cuda:0')
benign distance is  tensor(147.9093, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2985026240348816
distance x is tensor(137.6758, device='cuda:0')
benign distance is  tensor(137.6758, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 660.6794,  646.8086,  671.0154,  659.0097,  640.1625,  660.1885,
         642.4177,  661.7457, 1023.2364, 1018.0751, 1037.4757, 1028.3524,
        1068.8052, 1046.7391, 1042.5660, 1006.8000, 1044.4733, 1038.2496,
        1060.4879, 1015.7466,  726.1896,  733.8993,  768.4881,  735.7260,
         702.2844,  708.6948,  745.1505,  718.0802], device='cuda:0')
sorted_norm is   tensor([ 640.1625,  642.4177,  646.8086,  659.0097,  660.1885,  660.6794,
         661.7457,  671.0154,  702.2844,  708.6948,  718.0802,  726.1896,
         733.8993,  735.7260,  745.1505,  768.4881, 1006.8000, 1015.7466,
        1018.0751, 1023.2364, 1028.3524, 1037.4757, 1038.2496, 1042.5660,
        1044.4733, 1046.7391, 1060.4879, 1068.8052], device='cuda:0')
used idx is  tensor([ 4,  6,  1,  3,  5,  0,  7,  2, 24, 25, 27, 20, 21, 23, 26, 22, 15, 19,
         9], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 85.57% 

Test Accuracy: 84.68% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4182058870792389
distance x is tensor(116.7016, device='cuda:0')
benign distance is  tensor(116.7016, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4913635849952698
distance x is tensor(112.4239, device='cuda:0')
benign distance is  tensor(112.4239, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.130153089761734
distance x is tensor(121.2113, device='cuda:0')
benign distance is  tensor(121.2113, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4758639335632324
distance x is tensor(118.1476, device='cuda:0')
benign distance is  tensor(118.1476, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5520609617233276
distance x is tensor(113.5200, device='cuda:0')
benign distance is  tensor(113.5200, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7602590322494507
distance x is tensor(123.4219, device='cuda:0')
benign distance is  tensor(123.4219, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35371309518814087
distance x is tensor(115.6419, device='cuda:0')
benign distance is  tensor(115.6419, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7389034032821655
distance x is tensor(129.2187, device='cuda:0')
benign distance is  tensor(129.2187, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.16232362389564514
distance x is tensor(115.1217, device='cuda:0')
benign distance is  tensor(115.1217, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.2917177081108093
distance x is tensor(120.7067, device='cuda:0')
benign distance is  tensor(120.7067, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.526928722858429
distance x is tensor(125.1368, device='cuda:0')
benign distance is  tensor(125.1368, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3010407090187073
distance x is tensor(116.5601, device='cuda:0')
benign distance is  tensor(116.5601, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.49718499183654785
distance x is tensor(113.0026, device='cuda:0')
benign distance is  tensor(113.0026, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.2356204241514206
distance x is tensor(120.5889, device='cuda:0')
benign distance is  tensor(120.5889, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.15207768976688385
distance x is tensor(122.0907, device='cuda:0')
benign distance is  tensor(122.0907, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.35638096928596497
distance x is tensor(113.8341, device='cuda:0')
benign distance is  tensor(113.8341, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 540.5857,  513.6992,  549.4433,  542.3350,  511.2451,  560.6926,
         532.5176,  583.4063, 1352.5822, 1338.0576, 1374.6923, 1347.7172,
        1367.8732, 1371.9576, 1348.5042, 1341.6747, 1366.3046, 1369.7069,
        1370.9192, 1365.8981,  557.1315,  526.2310,  514.8266,  529.9882,
         550.8480,  517.2197,  521.9155,  559.7258], device='cuda:0')
sorted_norm is   tensor([ 511.2451,  513.6992,  514.8266,  517.2197,  521.9155,  526.2310,
         529.9882,  532.5176,  540.5857,  542.3350,  549.4433,  550.8480,
         557.1315,  559.7258,  560.6926,  583.4063, 1338.0576, 1341.6747,
        1347.7172, 1348.5042, 1352.5822, 1365.8981, 1366.3046, 1367.8732,
        1369.7069, 1370.9192, 1371.9576, 1374.6923], device='cuda:0')
used idx is  tensor([ 4,  1, 22, 25, 26, 21, 23,  6,  0,  3,  2, 24, 20, 27,  5,  7,  9, 15,
        11], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 85.07% 

Test Accuracy: 84.48% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.44372326135635376
distance x is tensor(116.4699, device='cuda:0')
benign distance is  tensor(116.4699, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5024722814559937
distance x is tensor(116.3122, device='cuda:0')
benign distance is  tensor(116.3122, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3061144948005676
distance x is tensor(119.6194, device='cuda:0')
benign distance is  tensor(119.6194, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.21178582310676575
distance x is tensor(116.5775, device='cuda:0')
benign distance is  tensor(116.5775, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8220468759536743
distance x is tensor(113.4538, device='cuda:0')
benign distance is  tensor(113.4538, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6235506534576416
distance x is tensor(124.0468, device='cuda:0')
benign distance is  tensor(124.0468, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3471202850341797
distance x is tensor(115.8215, device='cuda:0')
benign distance is  tensor(115.8215, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.45509082078933716
distance x is tensor(119.0005, device='cuda:0')
benign distance is  tensor(119.0005, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2907628118991852
distance x is tensor(121.3839, device='cuda:0')
benign distance is  tensor(121.3839, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.26833322644233704
distance x is tensor(114.1270, device='cuda:0')
benign distance is  tensor(114.1270, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.698885440826416
distance x is tensor(119.9133, device='cuda:0')
benign distance is  tensor(119.9133, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.27733850479125977
distance x is tensor(122.1398, device='cuda:0')
benign distance is  tensor(122.1398, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5858709216117859
distance x is tensor(119.7736, device='cuda:0')
benign distance is  tensor(119.7736, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3373831808567047
distance x is tensor(114.4154, device='cuda:0')
benign distance is  tensor(114.4154, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4809379577636719
distance x is tensor(115.7980, device='cuda:0')
benign distance is  tensor(115.7980, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4825564920902252
distance x is tensor(121.1265, device='cuda:0')
benign distance is  tensor(121.1265, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 535.1602,  533.9973,  553.0930,  529.0882,  528.2032,  563.7264,
         535.8797,  564.7851, 1330.1499, 1300.8448, 1331.4385, 1325.1793,
        1350.6222, 1358.9906, 1323.2875, 1312.2806, 1329.6204, 1341.8429,
        1333.7717, 1335.1074,  584.2807,  584.0131,  597.6476,  589.4728,
         573.4019,  568.8257,  601.6298,  612.8293], device='cuda:0')
sorted_norm is   tensor([ 528.2032,  529.0882,  533.9973,  535.1602,  535.8797,  553.0930,
         563.7264,  564.7851,  568.8257,  573.4019,  584.0131,  584.2807,
         589.4728,  597.6476,  601.6298,  612.8293, 1300.8448, 1312.2806,
        1323.2875, 1325.1793, 1329.6204, 1330.1499, 1331.4385, 1333.7717,
        1335.1074, 1341.8429, 1350.6222, 1358.9906], device='cuda:0')
used idx is  tensor([ 4,  3,  1,  0,  6,  2,  5,  7, 25, 24, 21, 20, 23, 22, 26, 27,  9, 15,
        14], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 86.17% 

Test Accuracy: 85.12% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5025106072425842
distance x is tensor(120.9165, device='cuda:0')
benign distance is  tensor(120.9165, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46009430289268494
distance x is tensor(116.5360, device='cuda:0')
benign distance is  tensor(116.5360, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.26991161704063416
distance x is tensor(112.7552, device='cuda:0')
benign distance is  tensor(112.7552, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.37176159024238586
distance x is tensor(119.7681, device='cuda:0')
benign distance is  tensor(119.7681, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.48861631751060486
distance x is tensor(106.2941, device='cuda:0')
benign distance is  tensor(106.2941, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8407436609268188
distance x is tensor(125.0272, device='cuda:0')
benign distance is  tensor(125.0272, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.32585740089416504
distance x is tensor(115.5705, device='cuda:0')
benign distance is  tensor(115.5705, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5116969347000122
distance x is tensor(120.4131, device='cuda:0')
benign distance is  tensor(120.4131, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.41604822874069214
distance x is tensor(116.7095, device='cuda:0')
benign distance is  tensor(116.7095, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.216501384973526
distance x is tensor(116.6589, device='cuda:0')
benign distance is  tensor(116.6589, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.21262207627296448
distance x is tensor(117.1314, device='cuda:0')
benign distance is  tensor(117.1314, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.31604012846946716
distance x is tensor(116.2827, device='cuda:0')
benign distance is  tensor(116.2827, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8228546380996704
distance x is tensor(119.1453, device='cuda:0')
benign distance is  tensor(119.1453, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2986830472946167
distance x is tensor(114.9329, device='cuda:0')
benign distance is  tensor(114.9329, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3394710421562195
distance x is tensor(113.4338, device='cuda:0')
benign distance is  tensor(113.4338, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1628384292125702
distance x is tensor(119.1106, device='cuda:0')
benign distance is  tensor(119.1106, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 36
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 563.8511,  533.0045,  525.0348,  535.5648,  493.8590,  575.5513,
         530.5968,  558.0330, 1373.0028, 1374.6897, 1405.1134, 1377.2240,
        1401.2904, 1406.8208, 1373.7794, 1375.1885, 1381.2368, 1384.6317,
        1391.8086, 1393.1635,  540.5437,  576.6072,  529.5445,  553.6311,
         559.7935,  553.7445,  558.0994,  549.3360,  544.6203,  523.3150,
         547.1276,  540.4468,  521.0630,  544.6366,  544.3306,  506.9915,
         546.5980,  568.1074,  585.4938,  556.9861,  533.4297,  561.3217,
         571.3217,  531.9899,  560.7394,  530.3239,  541.6223,  553.1575,
         556.3101,  525.7969,  533.4571,  562.6271], device='cuda:0')
sorted_norm is   tensor([ 493.8590,  506.9915,  521.0630,  523.3150,  525.0348,  525.7969,
         529.5445,  530.3239,  530.5968,  531.9899,  533.0045,  533.4297,
         533.4571,  535.5648,  540.4468,  540.5437,  541.6223,  544.3306,
         544.6203,  544.6366,  546.5980,  547.1276,  549.3360,  553.1575,
         553.6311,  553.7445,  556.3101,  556.9861,  558.0330,  558.0994,
         559.7935,  560.7394,  561.3217,  562.6271,  563.8511,  568.1074,
         571.3217,  575.5513,  576.6072,  585.4938, 1373.0028, 1373.7794,
        1374.6897, 1375.1885, 1377.2240, 1381.2368, 1384.6317, 1391.8086,
        1393.1635, 1401.2904, 1405.1134, 1406.8208], device='cuda:0')
used idx is  tensor([ 4, 35, 32, 29,  2, 49, 22, 45,  6, 43,  1, 40, 50,  3, 31, 20, 46, 34,
        28, 33, 36, 30, 27, 47, 23, 25, 48, 39,  7, 26, 24, 44, 41, 51,  0, 37],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 86.45% 

Test Accuracy: 85.42% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7591807842254639
distance x is tensor(108.4337, device='cuda:0')
benign distance is  tensor(108.4337, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.16214509308338165
distance x is tensor(100.4575, device='cuda:0')
benign distance is  tensor(100.4575, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19267995655536652
distance x is tensor(105.6925, device='cuda:0')
benign distance is  tensor(105.6925, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.766774594783783
distance x is tensor(104.3659, device='cuda:0')
benign distance is  tensor(104.3659, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.752790093421936
distance x is tensor(87.3185, device='cuda:0')
benign distance is  tensor(87.3185, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.27361851930618286
distance x is tensor(110.1753, device='cuda:0')
benign distance is  tensor(110.1753, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.18324556946754456
distance x is tensor(104.2699, device='cuda:0')
benign distance is  tensor(104.2699, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5883356332778931
distance x is tensor(105.6443, device='cuda:0')
benign distance is  tensor(105.6443, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2297419011592865
distance x is tensor(108.0215, device='cuda:0')
benign distance is  tensor(108.0215, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3830314874649048
distance x is tensor(100.0276, device='cuda:0')
benign distance is  tensor(100.0276, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.32469576597213745
distance x is tensor(103.0794, device='cuda:0')
benign distance is  tensor(103.0794, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5514625310897827
distance x is tensor(106.1239, device='cuda:0')
benign distance is  tensor(106.1239, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.47429442405700684
distance x is tensor(99.1199, device='cuda:0')
benign distance is  tensor(99.1199, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3519953787326813
distance x is tensor(103.2971, device='cuda:0')
benign distance is  tensor(103.2971, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.12054077535867691
distance x is tensor(97.2627, device='cuda:0')
benign distance is  tensor(97.2627, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.248563528060913
distance x is tensor(107.2855, device='cuda:0')
benign distance is  tensor(107.2855, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.20030538737773895
distance x is tensor(102.8685, device='cuda:0')
benign distance is  tensor(102.8685, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.2745533883571625
distance x is tensor(103.7425, device='cuda:0')
benign distance is  tensor(103.7425, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5044857859611511
distance x is tensor(110.3295, device='cuda:0')
benign distance is  tensor(110.3295, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5101674795150757
distance x is tensor(108.1115, device='cuda:0')
benign distance is  tensor(108.1115, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2961840033531189
distance x is tensor(101.4705, device='cuda:0')
benign distance is  tensor(101.4705, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5510213971138
distance x is tensor(101.0133, device='cuda:0')
benign distance is  tensor(101.0133, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5638366937637329
distance x is tensor(110.8418, device='cuda:0')
benign distance is  tensor(110.8418, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4017677903175354
distance x is tensor(95.7328, device='cuda:0')
benign distance is  tensor(95.7328, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1778113692998886
distance x is tensor(108.3497, device='cuda:0')
benign distance is  tensor(108.3497, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5707471966743469
distance x is tensor(101.6426, device='cuda:0')
benign distance is  tensor(101.6426, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.21113625168800354
distance x is tensor(104.1811, device='cuda:0')
benign distance is  tensor(104.1811, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3786279261112213
distance x is tensor(106.4606, device='cuda:0')
benign distance is  tensor(106.4606, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.637623131275177
distance x is tensor(98.4118, device='cuda:0')
benign distance is  tensor(98.4118, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.37107032537460327
distance x is tensor(108.2574, device='cuda:0')
benign distance is  tensor(108.2574, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.34242957830429077
distance x is tensor(103.3579, device='cuda:0')
benign distance is  tensor(103.3579, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2555693984031677
distance x is tensor(100.4709, device='cuda:0')
benign distance is  tensor(100.4709, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.11407698690891266
distance x is tensor(100.1735, device='cuda:0')
benign distance is  tensor(100.1735, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.8258525729179382
distance x is tensor(102.6797, device='cuda:0')
benign distance is  tensor(102.6797, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3466607928276062
distance x is tensor(102.0946, device='cuda:0')
benign distance is  tensor(102.0946, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.224982351064682
distance x is tensor(103.5909, device='cuda:0')
benign distance is  tensor(103.5909, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.31076133251190186
distance x is tensor(99.8279, device='cuda:0')
benign distance is  tensor(99.8279, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3305821716785431
distance x is tensor(105.3795, device='cuda:0')
benign distance is  tensor(105.3795, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.4754059314727783
distance x is tensor(107.3668, device='cuda:0')
benign distance is  tensor(107.3668, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3850101828575134
distance x is tensor(107.3564, device='cuda:0')
benign distance is  tensor(107.3564, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 515.3300,  468.4179,  494.2359,  489.4364,  415.3570,  514.8035,
         493.3609,  499.1166, 1658.6927, 1639.6177, 1702.5149, 1674.2773,
        1694.8230, 1696.4194, 1661.5093, 1654.9387, 1669.1324, 1678.8254,
        1677.5254, 1683.2887], device='cuda:0')
sorted_norm is   tensor([ 415.3570,  468.4179,  489.4364,  493.3609,  494.2359,  499.1166,
         514.8035,  515.3300, 1639.6177, 1654.9387, 1658.6927, 1661.5093,
        1669.1324, 1674.2773, 1677.5254, 1678.8254, 1683.2887, 1694.8230,
        1696.4194, 1702.5149], device='cuda:0')
used idx is  tensor([ 4,  1,  3,  6,  2,  7,  5,  0,  9, 15,  8, 14, 16, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.23854024708271027
distance x is tensor(150.6608, device='cuda:0')
benign distance is  tensor(150.6608, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3187728524208069
distance x is tensor(142.3711, device='cuda:0')
benign distance is  tensor(142.3711, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5311520099639893
distance x is tensor(143.7012, device='cuda:0')
benign distance is  tensor(143.7012, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4360591769218445
distance x is tensor(143.2088, device='cuda:0')
benign distance is  tensor(143.2088, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2856683135032654
distance x is tensor(146.1646, device='cuda:0')
benign distance is  tensor(146.1646, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.24002698063850403
distance x is tensor(144.2677, device='cuda:0')
benign distance is  tensor(144.2677, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.38502591848373413
distance x is tensor(143.4438, device='cuda:0')
benign distance is  tensor(143.4438, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6014359593391418
distance x is tensor(153.2133, device='cuda:0')
benign distance is  tensor(153.2133, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([683.3321, 663.1933, 680.8997, 656.0183, 678.7289, 672.4290, 669.2338,
        705.2872, 859.6603, 870.4659, 881.2325, 873.0541, 923.4435, 866.5577,
        873.3945, 871.5461, 880.5852, 871.9904, 890.3047, 889.2365, 895.3133,
        868.1828, 871.7139, 887.2661, 861.6411, 873.4080, 858.3441, 898.7383],
       device='cuda:0')
sorted_norm is   tensor([656.0183, 663.1933, 669.2338, 672.4290, 678.7289, 680.8997, 683.3321,
        705.2872, 858.3441, 859.6603, 861.6411, 866.5577, 868.1828, 870.4659,
        871.5461, 871.7139, 871.9904, 873.0541, 873.3945, 873.4080, 880.5852,
        881.2325, 887.2661, 889.2365, 890.3047, 895.3133, 898.7383, 923.4435],
       device='cuda:0')
used idx is  tensor([ 3,  1,  6,  5,  4,  2,  0,  7, 26,  8, 24, 13, 21,  9, 15, 22, 17, 11,
        14], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 15.98% 

Test Accuracy: 16.18% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6560293436050415
distance x is tensor(154.2571, device='cuda:0')
benign distance is  tensor(154.2571, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.35755398869514465
distance x is tensor(145.2922, device='cuda:0')
benign distance is  tensor(145.2922, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3564983904361725
distance x is tensor(145.7404, device='cuda:0')
benign distance is  tensor(145.7404, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4415413737297058
distance x is tensor(156.1220, device='cuda:0')
benign distance is  tensor(156.1220, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.491736501455307
distance x is tensor(147.5803, device='cuda:0')
benign distance is  tensor(147.5803, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.375505268573761
distance x is tensor(150.8536, device='cuda:0')
benign distance is  tensor(150.8536, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1646919846534729
distance x is tensor(153.7157, device='cuda:0')
benign distance is  tensor(153.7157, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.376055508852005
distance x is tensor(145.6495, device='cuda:0')
benign distance is  tensor(145.6495, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20590317249298096
distance x is tensor(156.6209, device='cuda:0')
benign distance is  tensor(156.6209, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3604815602302551
distance x is tensor(143.2567, device='cuda:0')
benign distance is  tensor(143.2567, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.27563127875328064
distance x is tensor(155.0315, device='cuda:0')
benign distance is  tensor(155.0315, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.29404014348983765
distance x is tensor(144.0684, device='cuda:0')
benign distance is  tensor(144.0684, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.20792952179908752
distance x is tensor(149.1857, device='cuda:0')
benign distance is  tensor(149.1857, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3474839925765991
distance x is tensor(146.4344, device='cuda:0')
benign distance is  tensor(146.4344, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.34297558665275574
distance x is tensor(144.8702, device='cuda:0')
benign distance is  tensor(144.8702, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4153483510017395
distance x is tensor(149.1440, device='cuda:0')
benign distance is  tensor(149.1440, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 680.1864,  649.3206,  655.7879,  681.1215,  665.0851,  674.0327,
         691.5930,  661.7263,  992.5370, 1002.3925, 1016.2673, 1017.7663,
        1033.1597, 1018.8155, 1009.6948,  978.9194, 1015.1976, 1006.7359,
        1033.1609, 1033.5383,  801.4366,  804.3354,  815.9367,  835.8919,
         790.0898,  789.2209,  826.2013,  771.1408], device='cuda:0')
sorted_norm is   tensor([ 649.3206,  655.7879,  661.7263,  665.0851,  674.0327,  680.1864,
         681.1215,  691.5930,  771.1408,  789.2209,  790.0898,  801.4366,
         804.3354,  815.9367,  826.2013,  835.8919,  978.9194,  992.5370,
        1002.3925, 1006.7359, 1009.6948, 1015.1976, 1016.2673, 1017.7663,
        1018.8155, 1033.1597, 1033.1609, 1033.5383], device='cuda:0')
used idx is  tensor([ 1,  2,  7,  4,  5,  0,  3,  6, 27, 25, 24, 20, 21, 22, 26, 23, 15,  8,
         9], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 85.76% 

Test Accuracy: 84.94% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49228519201278687
distance x is tensor(116.0254, device='cuda:0')
benign distance is  tensor(116.0254, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7752031087875366
distance x is tensor(109.5962, device='cuda:0')
benign distance is  tensor(109.5962, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.47511234879493713
distance x is tensor(111.5522, device='cuda:0')
benign distance is  tensor(111.5522, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7224650979042053
distance x is tensor(113.5600, device='cuda:0')
benign distance is  tensor(113.5600, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5194067358970642
distance x is tensor(104.2875, device='cuda:0')
benign distance is  tensor(104.2875, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.28866106271743774
distance x is tensor(122.6609, device='cuda:0')
benign distance is  tensor(122.6609, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.47069674730300903
distance x is tensor(113.0758, device='cuda:0')
benign distance is  tensor(113.0758, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3610023856163025
distance x is tensor(120.2291, device='cuda:0')
benign distance is  tensor(120.2291, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.27288204431533813
distance x is tensor(114.9845, device='cuda:0')
benign distance is  tensor(114.9845, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5534096956253052
distance x is tensor(116.2881, device='cuda:0')
benign distance is  tensor(116.2881, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.20447883009910583
distance x is tensor(120.5184, device='cuda:0')
benign distance is  tensor(120.5184, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2880192697048187
distance x is tensor(113.6190, device='cuda:0')
benign distance is  tensor(113.6190, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3061707019805908
distance x is tensor(113.3818, device='cuda:0')
benign distance is  tensor(113.3818, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.2520197629928589
distance x is tensor(111.1992, device='cuda:0')
benign distance is  tensor(111.1992, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.501059889793396
distance x is tensor(120.0316, device='cuda:0')
benign distance is  tensor(120.0316, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3888264298439026
distance x is tensor(105.6401, device='cuda:0')
benign distance is  tensor(105.6401, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 30
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 535.7575,  501.6304,  515.7930,  516.5674,  475.6951,  562.7618,
         514.8774,  551.1734, 1387.7941, 1372.9429, 1418.0929, 1414.5812,
        1396.6268, 1417.3457, 1394.6614, 1378.3302, 1391.2195, 1395.0636,
        1409.4696, 1420.9445,  546.0508,  560.8351,  559.0726,  550.0151,
         570.2310,  551.9386,  546.4316,  553.3451,  612.3186,  570.1749,
         580.0347,  599.4644,  566.9377,  596.1848,  578.2560,  567.8806,
         572.8389,  506.9006,  544.5580,  501.5718,  535.8561,  517.7145,
         518.4838,  542.3279], device='cuda:0')
sorted_norm is   tensor([ 475.6951,  501.5718,  501.6304,  506.9006,  514.8774,  515.7930,
         516.5674,  517.7145,  518.4838,  535.7575,  535.8561,  542.3279,
         544.5580,  546.0508,  546.4316,  550.0151,  551.1734,  551.9386,
         553.3451,  559.0726,  560.8351,  562.7618,  566.9377,  567.8806,
         570.1749,  570.2310,  572.8389,  578.2560,  580.0347,  596.1848,
         599.4644,  612.3186, 1372.9429, 1378.3302, 1387.7941, 1391.2195,
        1394.6614, 1395.0636, 1396.6268, 1409.4696, 1414.5812, 1417.3457,
        1418.0929, 1420.9445], device='cuda:0')
used idx is  tensor([ 4, 39,  1, 37,  6,  2,  3, 41, 42,  0, 40, 43, 38, 20, 26, 23,  7, 25,
        27, 22, 21,  5, 32, 35, 29, 24, 36, 34, 30, 33], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 86.56% 

Test Accuracy: 85.73% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3116377592086792
distance x is tensor(103.6811, device='cuda:0')
benign distance is  tensor(103.6811, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.28876370191574097
distance x is tensor(103.2339, device='cuda:0')
benign distance is  tensor(103.2339, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2827136814594269
distance x is tensor(100.0250, device='cuda:0')
benign distance is  tensor(100.0250, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2042425572872162
distance x is tensor(103.2487, device='cuda:0')
benign distance is  tensor(103.2487, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5009134411811829
distance x is tensor(93.1957, device='cuda:0')
benign distance is  tensor(93.1957, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6174615621566772
distance x is tensor(112.3777, device='cuda:0')
benign distance is  tensor(112.3777, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3721911609172821
distance x is tensor(104.0438, device='cuda:0')
benign distance is  tensor(104.0438, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4073237478733063
distance x is tensor(108.2116, device='cuda:0')
benign distance is  tensor(108.2116, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.45417580008506775
distance x is tensor(106.3115, device='cuda:0')
benign distance is  tensor(106.3115, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4528574049472809
distance x is tensor(104.1956, device='cuda:0')
benign distance is  tensor(104.1956, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.37006914615631104
distance x is tensor(100.1552, device='cuda:0')
benign distance is  tensor(100.1552, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.32122522592544556
distance x is tensor(104.7800, device='cuda:0')
benign distance is  tensor(104.7800, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.251064270734787
distance x is tensor(106.5485, device='cuda:0')
benign distance is  tensor(106.5485, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3315170407295227
distance x is tensor(104.7560, device='cuda:0')
benign distance is  tensor(104.7560, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7443068623542786
distance x is tensor(97.6991, device='cuda:0')
benign distance is  tensor(97.6991, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5573700666427612
distance x is tensor(106.1213, device='cuda:0')
benign distance is  tensor(106.1213, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1273646205663681
distance x is tensor(114.1114, device='cuda:0')
benign distance is  tensor(114.1114, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4906936287879944
distance x is tensor(95.9920, device='cuda:0')
benign distance is  tensor(95.9920, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5093972682952881
distance x is tensor(108.4259, device='cuda:0')
benign distance is  tensor(108.4259, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3826635479927063
distance x is tensor(104.9068, device='cuda:0')
benign distance is  tensor(104.9068, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6771701574325562
distance x is tensor(108.1957, device='cuda:0')
benign distance is  tensor(108.1957, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6476358771324158
distance x is tensor(109.4525, device='cuda:0')
benign distance is  tensor(109.4525, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.13557568192481995
distance x is tensor(106.6649, device='cuda:0')
benign distance is  tensor(106.6649, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.48544374108314514
distance x is tensor(103.7975, device='cuda:0')
benign distance is  tensor(103.7975, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.39651790261268616
distance x is tensor(101.9577, device='cuda:0')
benign distance is  tensor(101.9577, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.06433757394552231
distance x is tensor(109.6479, device='cuda:0')
benign distance is  tensor(109.6479, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3781299889087677
distance x is tensor(103.2570, device='cuda:0')
benign distance is  tensor(103.2570, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.6398378610610962
distance x is tensor(100.4050, device='cuda:0')
benign distance is  tensor(100.4050, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5586080551147461
distance x is tensor(100.8909, device='cuda:0')
benign distance is  tensor(100.8909, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.18360106647014618
distance x is tensor(104.3150, device='cuda:0')
benign distance is  tensor(104.3150, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2972971796989441
distance x is tensor(107.6034, device='cuda:0')
benign distance is  tensor(107.6034, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.20086154341697693
distance x is tensor(107.9091, device='cuda:0')
benign distance is  tensor(107.9091, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 490.3841,  481.1847,  474.5471,  478.8607,  434.8721,  527.7182,
         491.7638,  510.4284, 1684.0653, 1672.9050, 1706.6658, 1677.2887,
        1695.7046, 1716.9546, 1689.3083, 1683.3119, 1678.5341, 1699.0344,
        1702.3212, 1698.5602], device='cuda:0')
sorted_norm is   tensor([ 434.8721,  474.5471,  478.8607,  481.1847,  490.3841,  491.7638,
         510.4284,  527.7182, 1672.9050, 1677.2887, 1678.5341, 1683.3119,
        1684.0653, 1689.3083, 1695.7046, 1698.5602, 1699.0344, 1702.3212,
        1706.6658, 1716.9546], device='cuda:0')
used idx is  tensor([ 4,  2,  3,  1,  0,  6,  7,  5,  9, 11, 16, 15,  8, 14],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 10.83% 

Test Accuracy: 11.21% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.375957190990448
distance x is tensor(142.9106, device='cuda:0')
benign distance is  tensor(142.9106, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.17914612591266632
distance x is tensor(140.9938, device='cuda:0')
benign distance is  tensor(140.9938, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3986227810382843
distance x is tensor(141.6288, device='cuda:0')
benign distance is  tensor(141.6288, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5367881655693054
distance x is tensor(143.3880, device='cuda:0')
benign distance is  tensor(143.3880, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.14533750712871552
distance x is tensor(144.3588, device='cuda:0')
benign distance is  tensor(144.3588, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3811187148094177
distance x is tensor(144.6781, device='cuda:0')
benign distance is  tensor(144.6781, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2142171561717987
distance x is tensor(137.1360, device='cuda:0')
benign distance is  tensor(137.1360, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2813006341457367
distance x is tensor(141.9876, device='cuda:0')
benign distance is  tensor(141.9876, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 30
weight size is  torch.Size([44, 215370])
norm res is  tensor([666.1321, 663.5873, 671.8638, 663.9507, 678.3295, 686.3500, 650.8734,
        668.4131, 864.1857, 851.2975, 887.9233, 854.5479, 895.1801, 877.3052,
        869.6199, 876.7092, 876.1476, 886.9460, 881.5766, 881.2773, 864.0235,
        876.8532, 870.9658, 873.5477, 872.0377, 875.0685, 894.0631, 886.5789,
        816.1717, 818.7758, 824.9900, 818.2643, 805.7479, 801.7830, 828.5413,
        780.7411, 896.1573, 883.2336, 870.4513, 876.2802, 887.4923, 882.8127,
        868.3862, 893.9572], device='cuda:0')
sorted_norm is   tensor([650.8734, 663.5873, 663.9507, 666.1321, 668.4131, 671.8638, 678.3295,
        686.3500, 780.7411, 801.7830, 805.7479, 816.1717, 818.2643, 818.7758,
        824.9900, 828.5413, 851.2975, 854.5479, 864.0235, 864.1857, 868.3862,
        869.6199, 870.4513, 870.9658, 872.0377, 873.5477, 875.0685, 876.1476,
        876.2802, 876.7092, 876.8532, 877.3052, 881.2773, 881.5766, 882.8127,
        883.2336, 886.5789, 886.9460, 887.4923, 887.9233, 893.9572, 894.0631,
        895.1801, 896.1573], device='cuda:0')
used idx is  tensor([ 6,  1,  3,  0,  7,  2,  4,  5, 35, 33, 32, 28, 31, 29, 30, 34,  9, 11,
        20,  8, 42, 14, 38, 22, 24, 23, 25, 16, 39, 15], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 84.95% 

Test Accuracy: 84.27% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.23659615218639374
distance x is tensor(123.4240, device='cuda:0')
benign distance is  tensor(123.4240, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3448213040828705
distance x is tensor(119.2403, device='cuda:0')
benign distance is  tensor(119.2403, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18656407296657562
distance x is tensor(123.7941, device='cuda:0')
benign distance is  tensor(123.7941, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4784519672393799
distance x is tensor(124.6575, device='cuda:0')
benign distance is  tensor(124.6575, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7050094604492188
distance x is tensor(116.0999, device='cuda:0')
benign distance is  tensor(116.0999, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6110187768936157
distance x is tensor(132.2483, device='cuda:0')
benign distance is  tensor(132.2483, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.44041070342063904
distance x is tensor(126.6472, device='cuda:0')
benign distance is  tensor(126.6472, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2668476700782776
distance x is tensor(126.9646, device='cuda:0')
benign distance is  tensor(126.9646, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.28759247064590454
distance x is tensor(130.6511, device='cuda:0')
benign distance is  tensor(130.6511, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.24145770072937012
distance x is tensor(123.4448, device='cuda:0')
benign distance is  tensor(123.4448, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6479130387306213
distance x is tensor(123.1634, device='cuda:0')
benign distance is  tensor(123.1634, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7889631390571594
distance x is tensor(128.9381, device='cuda:0')
benign distance is  tensor(128.9381, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3542945981025696
distance x is tensor(120.4580, device='cuda:0')
benign distance is  tensor(120.4580, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.284254252910614
distance x is tensor(121.1426, device='cuda:0')
benign distance is  tensor(121.1426, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3339143395423889
distance x is tensor(122.0913, device='cuda:0')
benign distance is  tensor(122.0913, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.35420364141464233
distance x is tensor(125.6917, device='cuda:0')
benign distance is  tensor(125.6917, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3330002427101135
distance x is tensor(118.1232, device='cuda:0')
benign distance is  tensor(118.1232, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.44789034128189087
distance x is tensor(126.3651, device='cuda:0')
benign distance is  tensor(126.3651, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.29726076126098633
distance x is tensor(131.9124, device='cuda:0')
benign distance is  tensor(131.9124, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2353638857603073
distance x is tensor(119.7052, device='cuda:0')
benign distance is  tensor(119.7052, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.12708516418933868
distance x is tensor(114.7373, device='cuda:0')
benign distance is  tensor(114.7373, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.49758562445640564
distance x is tensor(121.9191, device='cuda:0')
benign distance is  tensor(121.9191, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4311453402042389
distance x is tensor(125.5370, device='cuda:0')
benign distance is  tensor(125.5370, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.2560326159000397
distance x is tensor(120.8763, device='cuda:0')
benign distance is  tensor(120.8763, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2196226418018341
distance x is tensor(121.2924, device='cuda:0')
benign distance is  tensor(121.2924, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.286900132894516
distance x is tensor(127.4719, device='cuda:0')
benign distance is  tensor(127.4719, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.18204393982887268
distance x is tensor(124.2040, device='cuda:0')
benign distance is  tensor(124.2040, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.15380877256393433
distance x is tensor(128.5631, device='cuda:0')
benign distance is  tensor(128.5631, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4502289891242981
distance x is tensor(121.7660, device='cuda:0')
benign distance is  tensor(121.7660, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3743119239807129
distance x is tensor(125.1218, device='cuda:0')
benign distance is  tensor(125.1218, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.49125751852989197
distance x is tensor(120.7315, device='cuda:0')
benign distance is  tensor(120.7315, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5008405447006226
distance x is tensor(123.5426, device='cuda:0')
benign distance is  tensor(123.5426, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 551.1146,  538.2278,  559.0225,  556.9482,  525.7262,  595.4816,
         580.1288,  578.8625, 1310.2787, 1308.1571, 1328.9196, 1320.1892,
        1335.9589, 1340.8120, 1315.3495, 1310.6664, 1316.9368, 1330.0731,
        1331.8319, 1326.9430], device='cuda:0')
sorted_norm is   tensor([ 525.7262,  538.2278,  551.1146,  556.9482,  559.0225,  578.8625,
         580.1288,  595.4816, 1308.1571, 1310.2787, 1310.6664, 1315.3495,
        1316.9368, 1320.1892, 1326.9430, 1328.9196, 1330.0731, 1331.8319,
        1335.9589, 1340.8120], device='cuda:0')
used idx is  tensor([ 4,  1,  0,  3,  2,  7,  6,  5,  9,  8, 15, 14, 16, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.34213536977767944
distance x is tensor(144.7893, device='cuda:0')
benign distance is  tensor(144.7893, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46848875284194946
distance x is tensor(151.3781, device='cuda:0')
benign distance is  tensor(151.3781, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.541953444480896
distance x is tensor(144.4753, device='cuda:0')
benign distance is  tensor(144.4753, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.43932414054870605
distance x is tensor(144.6974, device='cuda:0')
benign distance is  tensor(144.6974, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.38361120223999023
distance x is tensor(143.1970, device='cuda:0')
benign distance is  tensor(143.1970, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6204251646995544
distance x is tensor(149.7751, device='cuda:0')
benign distance is  tensor(149.7751, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.44833096861839294
distance x is tensor(143.9620, device='cuda:0')
benign distance is  tensor(143.9620, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46939554810523987
distance x is tensor(145.2408, device='cuda:0')
benign distance is  tensor(145.2408, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([671.0244, 690.5680, 672.8659, 668.6559, 668.4234, 680.3173, 668.2335,
        668.0181, 837.1641, 840.1520, 865.4448, 855.1801, 886.3624, 867.6380,
        850.6774, 848.4272, 842.8731, 880.5682, 862.1905, 854.6552, 928.5070,
        874.9010, 905.9065, 898.3809, 925.2927, 915.8519, 899.8007, 889.2747,
        839.8536, 811.9390, 812.3820, 832.8248, 800.2772, 797.6760, 811.1229,
        818.5771], device='cuda:0')
sorted_norm is   tensor([668.0181, 668.2335, 668.4234, 668.6559, 671.0244, 672.8659, 680.3173,
        690.5680, 797.6760, 800.2772, 811.1229, 811.9390, 812.3820, 818.5771,
        832.8248, 837.1641, 839.8536, 840.1520, 842.8731, 848.4272, 850.6774,
        854.6552, 855.1801, 862.1905, 865.4448, 867.6380, 874.9010, 880.5682,
        886.3624, 889.2747, 898.3809, 899.8007, 905.9065, 915.8519, 925.2927,
        928.5070], device='cuda:0')
used idx is  tensor([ 7,  6,  4,  3,  0,  2,  5,  1, 33, 32, 34, 29, 30, 35, 31,  8, 28,  9,
        16, 15, 14, 19, 11, 18, 10], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 38.83% 

Test Accuracy: 38.65% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4611603319644928
distance x is tensor(148.5753, device='cuda:0')
benign distance is  tensor(148.5753, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3338245749473572
distance x is tensor(151.6377, device='cuda:0')
benign distance is  tensor(151.6377, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.37494587898254395
distance x is tensor(146.7004, device='cuda:0')
benign distance is  tensor(146.7004, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5036372542381287
distance x is tensor(152.6705, device='cuda:0')
benign distance is  tensor(152.6705, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.27905017137527466
distance x is tensor(143.1194, device='cuda:0')
benign distance is  tensor(143.1194, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.335604727268219
distance x is tensor(152.8945, device='cuda:0')
benign distance is  tensor(152.8945, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.34029334783554077
distance x is tensor(144.0745, device='cuda:0')
benign distance is  tensor(144.0745, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3207622468471527
distance x is tensor(151.6905, device='cuda:0')
benign distance is  tensor(151.6905, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3366371691226959
distance x is tensor(153.6463, device='cuda:0')
benign distance is  tensor(153.6463, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.18666471540927887
distance x is tensor(146.5079, device='cuda:0')
benign distance is  tensor(146.5079, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.554700493812561
distance x is tensor(149.8109, device='cuda:0')
benign distance is  tensor(149.8109, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4683207869529724
distance x is tensor(151.0930, device='cuda:0')
benign distance is  tensor(151.0930, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2599582076072693
distance x is tensor(145.5516, device='cuda:0')
benign distance is  tensor(145.5516, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.22485888004302979
distance x is tensor(148.4996, device='cuda:0')
benign distance is  tensor(148.4996, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2940860390663147
distance x is tensor(146.1237, device='cuda:0')
benign distance is  tensor(146.1237, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4049800932407379
distance x is tensor(153.5777, device='cuda:0')
benign distance is  tensor(153.5777, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.26063594222068787
distance x is tensor(151.5704, device='cuda:0')
benign distance is  tensor(151.5704, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6834951639175415
distance x is tensor(142.1479, device='cuda:0')
benign distance is  tensor(142.1479, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.45612460374832153
distance x is tensor(153.2264, device='cuda:0')
benign distance is  tensor(153.2264, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5388872623443604
distance x is tensor(140.8708, device='cuda:0')
benign distance is  tensor(140.8708, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9438183903694153
distance x is tensor(151.2688, device='cuda:0')
benign distance is  tensor(151.2688, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7217207551002502
distance x is tensor(152.9570, device='cuda:0')
benign distance is  tensor(152.9570, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2890322506427765
distance x is tensor(148.1125, device='cuda:0')
benign distance is  tensor(148.1125, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.34984976053237915
distance x is tensor(147.7745, device='cuda:0')
benign distance is  tensor(147.7745, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 663.9525,  664.1753,  649.5763,  674.3036,  638.6144,  670.7369,
         640.1077,  674.0197, 1018.0657, 1012.8015, 1034.2662, 1044.2952,
        1037.9125, 1063.6997, 1039.4375, 1009.6505, 1047.8223, 1032.5828,
        1034.0400, 1034.1582,  801.7133,  824.6806,  797.0706,  797.3493,
         790.2722,  803.0181,  811.0948,  808.4957,  700.9058,  733.9766,
         748.0421,  710.8409,  694.2991,  714.6953,  734.1900,  703.9004],
       device='cuda:0')
sorted_norm is   tensor([ 638.6144,  640.1077,  649.5763,  663.9525,  664.1753,  670.7369,
         674.0197,  674.3036,  694.2991,  700.9058,  703.9004,  710.8409,
         714.6953,  733.9766,  734.1900,  748.0421,  790.2722,  797.0706,
         797.3493,  801.7133,  803.0181,  808.4957,  811.0948,  824.6806,
        1009.6505, 1012.8015, 1018.0657, 1032.5828, 1034.0400, 1034.1582,
        1034.2662, 1037.9125, 1039.4375, 1044.2952, 1047.8223, 1063.6997],
       device='cuda:0')
used idx is  tensor([ 4,  6,  2,  0,  1,  5,  7,  3, 32, 28, 35, 31, 33, 29, 34, 30, 24, 22,
        23, 20, 25, 27, 26, 21, 15], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 86.73% 

Test Accuracy: 85.58% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.16668647527694702
distance x is tensor(100.9308, device='cuda:0')
benign distance is  tensor(100.9308, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.29905158281326294
distance x is tensor(103.0891, device='cuda:0')
benign distance is  tensor(103.0891, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14164496958255768
distance x is tensor(103.1156, device='cuda:0')
benign distance is  tensor(103.1156, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39568349719047546
distance x is tensor(101.6161, device='cuda:0')
benign distance is  tensor(101.6161, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.49230217933654785
distance x is tensor(98.5631, device='cuda:0')
benign distance is  tensor(98.5631, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.47331175208091736
distance x is tensor(112.2998, device='cuda:0')
benign distance is  tensor(112.2998, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1987626999616623
distance x is tensor(104.3745, device='cuda:0')
benign distance is  tensor(104.3745, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5247515439987183
distance x is tensor(107.6007, device='cuda:0')
benign distance is  tensor(107.6007, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5075982809066772
distance x is tensor(104.5112, device='cuda:0')
benign distance is  tensor(104.5112, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.46514812111854553
distance x is tensor(109.3005, device='cuda:0')
benign distance is  tensor(109.3005, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.24560284614562988
distance x is tensor(109.6631, device='cuda:0')
benign distance is  tensor(109.6631, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4371626377105713
distance x is tensor(109.6779, device='cuda:0')
benign distance is  tensor(109.6779, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.37740299105644226
distance x is tensor(95.1177, device='cuda:0')
benign distance is  tensor(95.1177, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.23713286221027374
distance x is tensor(98.9622, device='cuda:0')
benign distance is  tensor(98.9622, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.20421543717384338
distance x is tensor(110.3564, device='cuda:0')
benign distance is  tensor(110.3564, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.46548980474472046
distance x is tensor(100.3473, device='cuda:0')
benign distance is  tensor(100.3473, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.26884856820106506
distance x is tensor(100.6095, device='cuda:0')
benign distance is  tensor(100.6095, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.13349312543869019
distance x is tensor(102.6007, device='cuda:0')
benign distance is  tensor(102.6007, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3463154435157776
distance x is tensor(102.3837, device='cuda:0')
benign distance is  tensor(102.3837, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.5653015971183777
distance x is tensor(101.1613, device='cuda:0')
benign distance is  tensor(101.1613, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4818054139614105
distance x is tensor(107.7957, device='cuda:0')
benign distance is  tensor(107.7957, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3918706774711609
distance x is tensor(105.9789, device='cuda:0')
benign distance is  tensor(105.9789, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2572174668312073
distance x is tensor(106.5432, device='cuda:0')
benign distance is  tensor(106.5432, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2938643991947174
distance x is tensor(101.0552, device='cuda:0')
benign distance is  tensor(101.0552, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 480.5171,  482.4456,  484.9471,  479.2952,  460.3833,  525.4943,
         491.0934,  510.7646, 1609.1107, 1597.8950, 1642.3685, 1618.5563,
        1630.8809, 1644.2837, 1625.5150, 1622.0829, 1608.1826, 1630.3148,
        1639.3615, 1618.3167,  521.0364,  500.8670,  509.6846,  500.4673,
         499.5985,  507.3346,  505.7129,  532.7254], device='cuda:0')
sorted_norm is   tensor([ 460.3833,  479.2952,  480.5171,  482.4456,  484.9471,  491.0934,
         499.5985,  500.4673,  500.8670,  505.7129,  507.3346,  509.6846,
         510.7646,  521.0364,  525.4943,  532.7254, 1597.8950, 1608.1826,
        1609.1107, 1618.3167, 1618.5563, 1622.0829, 1625.5150, 1630.3148,
        1630.8809, 1639.3615, 1642.3685, 1644.2837], device='cuda:0')
used idx is  tensor([ 4,  3,  0,  1,  2,  6, 24, 23, 21, 26, 25, 22,  7, 20,  5, 27,  9, 16,
         8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 86.60% 

Test Accuracy: 85.69% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5559834241867065
distance x is tensor(119.6790, device='cuda:0')
benign distance is  tensor(119.6790, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.23974475264549255
distance x is tensor(114.9694, device='cuda:0')
benign distance is  tensor(114.9694, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23941867053508759
distance x is tensor(116.0700, device='cuda:0')
benign distance is  tensor(116.0700, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4975964426994324
distance x is tensor(116.3683, device='cuda:0')
benign distance is  tensor(116.3683, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7475860714912415
distance x is tensor(118.5223, device='cuda:0')
benign distance is  tensor(118.5223, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.47787603735923767
distance x is tensor(123.1830, device='cuda:0')
benign distance is  tensor(123.1830, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26955267786979675
distance x is tensor(121.5145, device='cuda:0')
benign distance is  tensor(121.5145, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6325629949569702
distance x is tensor(127.6172, device='cuda:0')
benign distance is  tensor(127.6172, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2222287952899933
distance x is tensor(121.6696, device='cuda:0')
benign distance is  tensor(121.6696, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.39789456129074097
distance x is tensor(118.8294, device='cuda:0')
benign distance is  tensor(118.8294, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7391265630722046
distance x is tensor(116.0625, device='cuda:0')
benign distance is  tensor(116.0625, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.22034958004951477
distance x is tensor(114.9398, device='cuda:0')
benign distance is  tensor(114.9398, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.822172999382019
distance x is tensor(116.2833, device='cuda:0')
benign distance is  tensor(116.2833, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1321868896484375
distance x is tensor(116.3142, device='cuda:0')
benign distance is  tensor(116.3142, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3351042568683624
distance x is tensor(117.3820, device='cuda:0')
benign distance is  tensor(117.3820, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6131208539009094
distance x is tensor(126.8784, device='cuda:0')
benign distance is  tensor(126.8784, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 539.2573,  522.7512,  526.4385,  524.1882,  531.1237,  561.3519,
         546.1562,  571.3809, 1352.0181, 1336.0143, 1358.0210, 1356.9418,
        1378.8540, 1366.3175, 1353.0114, 1344.3862, 1345.8496, 1371.7631,
        1380.6001, 1363.9294], device='cuda:0')
sorted_norm is   tensor([ 522.7512,  524.1882,  526.4385,  531.1237,  539.2573,  546.1562,
         561.3519,  571.3809, 1336.0143, 1344.3862, 1345.8496, 1352.0181,
        1353.0114, 1356.9418, 1358.0210, 1363.9294, 1366.3175, 1371.7631,
        1378.8540, 1380.6001], device='cuda:0')
used idx is  tensor([ 1,  3,  2,  4,  0,  6,  5,  7,  9, 15, 16,  8, 14, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.27597084641456604
distance x is tensor(149.6672, device='cuda:0')
benign distance is  tensor(149.6672, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5316134691238403
distance x is tensor(144.1550, device='cuda:0')
benign distance is  tensor(144.1550, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.372102290391922
distance x is tensor(144.8030, device='cuda:0')
benign distance is  tensor(144.8030, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3951117694377899
distance x is tensor(145.0945, device='cuda:0')
benign distance is  tensor(145.0945, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.17622599005699158
distance x is tensor(152.6413, device='cuda:0')
benign distance is  tensor(152.6413, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7496872544288635
distance x is tensor(147.7095, device='cuda:0')
benign distance is  tensor(147.7095, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.36225149035453796
distance x is tensor(145.9335, device='cuda:0')
benign distance is  tensor(145.9335, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.16468530893325806
distance x is tensor(147.0757, device='cuda:0')
benign distance is  tensor(147.0757, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 36
weight size is  torch.Size([52, 215370])
norm res is  tensor([690.8335, 663.7725, 674.8403, 667.4519, 712.1201, 682.6228, 673.8039,
        690.3080, 856.0183, 854.3318, 858.2401, 859.6843, 891.0134, 872.0676,
        855.6723, 863.3362, 877.3400, 867.1363, 866.4047, 877.3672, 806.5490,
        827.2939, 821.2844, 832.0147, 808.4207, 819.6907, 805.2752, 812.0760,
        762.3701, 735.6025, 766.7529, 728.8599, 768.1562, 769.6177, 753.1370,
        749.8832, 874.9289, 894.7869, 899.1964, 905.7958, 850.0843, 861.7562,
        897.9581, 870.2651, 826.1621, 819.1417, 798.3450, 800.7781, 804.8460,
        801.1656, 810.1301, 851.8204], device='cuda:0')
sorted_norm is   tensor([663.7725, 667.4519, 673.8039, 674.8403, 682.6228, 690.3080, 690.8335,
        712.1201, 728.8599, 735.6025, 749.8832, 753.1370, 762.3701, 766.7529,
        768.1562, 769.6177, 798.3450, 800.7781, 801.1656, 804.8460, 805.2752,
        806.5490, 808.4207, 810.1301, 812.0760, 819.1417, 819.6907, 821.2844,
        826.1621, 827.2939, 832.0147, 850.0843, 851.8204, 854.3318, 855.6723,
        856.0183, 858.2401, 859.6843, 861.7562, 863.3362, 866.4047, 867.1363,
        870.2651, 872.0676, 874.9289, 877.3400, 877.3672, 891.0134, 894.7869,
        897.9581, 899.1964, 905.7958], device='cuda:0')
used idx is  tensor([ 1,  3,  6,  2,  5,  7,  0,  4, 31, 29, 35, 34, 28, 30, 32, 33, 46, 47,
        49, 48, 26, 20, 24, 50, 27, 45, 25, 22, 44, 21, 23, 40, 51,  9, 14,  8],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 86.16% 

Test Accuracy: 85.20% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.41773390769958496
distance x is tensor(107.9736, device='cuda:0')
benign distance is  tensor(107.9736, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3294249475002289
distance x is tensor(106.3321, device='cuda:0')
benign distance is  tensor(106.3321, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25533270835876465
distance x is tensor(105.8071, device='cuda:0')
benign distance is  tensor(105.8071, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3982517123222351
distance x is tensor(116.5146, device='cuda:0')
benign distance is  tensor(116.5146, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.40537795424461365
distance x is tensor(105.8225, device='cuda:0')
benign distance is  tensor(105.8225, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7303141355514526
distance x is tensor(120.8520, device='cuda:0')
benign distance is  tensor(120.8520, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5055322051048279
distance x is tensor(112.8624, device='cuda:0')
benign distance is  tensor(112.8624, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.45606860518455505
distance x is tensor(115.2849, device='cuda:0')
benign distance is  tensor(115.2849, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5123794674873352
distance x is tensor(116.9509, device='cuda:0')
benign distance is  tensor(116.9509, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6665977835655212
distance x is tensor(107.7753, device='cuda:0')
benign distance is  tensor(107.7753, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.69672691822052
distance x is tensor(108.1350, device='cuda:0')
benign distance is  tensor(108.1350, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5908117890357971
distance x is tensor(109.9330, device='cuda:0')
benign distance is  tensor(109.9330, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5520827174186707
distance x is tensor(104.8724, device='cuda:0')
benign distance is  tensor(104.8724, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.510278582572937
distance x is tensor(108.2905, device='cuda:0')
benign distance is  tensor(108.2905, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5212517976760864
distance x is tensor(114.4385, device='cuda:0')
benign distance is  tensor(114.4385, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6623008847236633
distance x is tensor(114.3368, device='cuda:0')
benign distance is  tensor(114.3368, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3574797213077545
distance x is tensor(107.5699, device='cuda:0')
benign distance is  tensor(107.5699, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.31265491247177124
distance x is tensor(115.9165, device='cuda:0')
benign distance is  tensor(115.9165, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4983246922492981
distance x is tensor(114.6106, device='cuda:0')
benign distance is  tensor(114.6106, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2361581027507782
distance x is tensor(110.8111, device='cuda:0')
benign distance is  tensor(110.8111, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.22825798392295837
distance x is tensor(104.9630, device='cuda:0')
benign distance is  tensor(104.9630, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3053656220436096
distance x is tensor(106.1155, device='cuda:0')
benign distance is  tensor(106.1155, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.21678420901298523
distance x is tensor(112.4505, device='cuda:0')
benign distance is  tensor(112.4505, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.26898759603500366
distance x is tensor(106.6788, device='cuda:0')
benign distance is  tensor(106.6788, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3139955997467041
distance x is tensor(115.5410, device='cuda:0')
benign distance is  tensor(115.5410, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3206646740436554
distance x is tensor(104.9278, device='cuda:0')
benign distance is  tensor(104.9278, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5906137228012085
distance x is tensor(111.3134, device='cuda:0')
benign distance is  tensor(111.3134, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.39428895711898804
distance x is tensor(112.5571, device='cuda:0')
benign distance is  tensor(112.5571, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5410180687904358
distance x is tensor(109.9950, device='cuda:0')
benign distance is  tensor(109.9950, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.25780612230300903
distance x is tensor(112.1227, device='cuda:0')
benign distance is  tensor(112.1227, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.33762019872665405
distance x is tensor(109.7177, device='cuda:0')
benign distance is  tensor(109.7177, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3079133629798889
distance x is tensor(100.9049, device='cuda:0')
benign distance is  tensor(100.9049, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4648185670375824
distance x is tensor(105.8527, device='cuda:0')
benign distance is  tensor(105.8527, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2916381359100342
distance x is tensor(112.9974, device='cuda:0')
benign distance is  tensor(112.9974, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.2840261161327362
distance x is tensor(106.0134, device='cuda:0')
benign distance is  tensor(106.0134, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.34202080965042114
distance x is tensor(108.2380, device='cuda:0')
benign distance is  tensor(108.2380, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4089909493923187
distance x is tensor(106.9549, device='cuda:0')
benign distance is  tensor(106.9549, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.46684518456459045
distance x is tensor(115.9183, device='cuda:0')
benign distance is  tensor(115.9183, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.21990084648132324
distance x is tensor(112.1602, device='cuda:0')
benign distance is  tensor(112.1602, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3294164538383484
distance x is tensor(108.1932, device='cuda:0')
benign distance is  tensor(108.1932, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 505.6585,  490.6213,  490.4071,  531.0912,  487.1675,  551.7831,
         518.8617,  531.5289, 1449.3450, 1426.1643, 1457.6584, 1447.2310,
        1462.7455, 1478.1459, 1440.5718, 1446.7612, 1444.5875, 1455.3643,
        1457.0050, 1449.5916], device='cuda:0')
sorted_norm is   tensor([ 487.1675,  490.4071,  490.6213,  505.6585,  518.8617,  531.0912,
         531.5289,  551.7831, 1426.1643, 1440.5718, 1444.5875, 1446.7612,
        1447.2310, 1449.3450, 1449.5916, 1455.3643, 1457.0050, 1457.6584,
        1462.7455, 1478.1459], device='cuda:0')
used idx is  tensor([ 4,  2,  1,  0,  6,  3,  7,  5,  9, 14, 16, 15, 11,  8],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5046073794364929
distance x is tensor(152.2755, device='cuda:0')
benign distance is  tensor(152.2755, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2773888409137726
distance x is tensor(147.9261, device='cuda:0')
benign distance is  tensor(147.9261, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.26550301909446716
distance x is tensor(149.2377, device='cuda:0')
benign distance is  tensor(149.2377, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45691317319869995
distance x is tensor(145.1821, device='cuda:0')
benign distance is  tensor(145.1821, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.28879863023757935
distance x is tensor(142.7292, device='cuda:0')
benign distance is  tensor(142.7292, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5665534734725952
distance x is tensor(144.6995, device='cuda:0')
benign distance is  tensor(144.6995, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.34663695096969604
distance x is tensor(146.5122, device='cuda:0')
benign distance is  tensor(146.5122, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.33980485796928406
distance x is tensor(144.5889, device='cuda:0')
benign distance is  tensor(144.5889, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([680.2045, 670.4415, 682.8365, 660.6370, 651.7584, 661.6514, 679.8737,
        683.0422, 849.8947, 847.3893, 856.7793, 863.8517, 875.1963, 870.4050,
        849.1174, 837.9883, 870.0494, 884.7391, 850.8277, 863.3896, 868.6448,
        872.1248, 875.9040, 873.6703, 881.5602, 876.7106, 889.6661, 858.7573,
        857.3909, 810.0219, 826.1744, 822.2533, 806.1997, 820.8901, 840.0500,
        844.3833], device='cuda:0')
sorted_norm is   tensor([651.7584, 660.6370, 661.6514, 670.4415, 679.8737, 680.2045, 682.8365,
        683.0422, 806.1997, 810.0219, 820.8901, 822.2533, 826.1744, 837.9883,
        840.0500, 844.3833, 847.3893, 849.1174, 849.8947, 850.8277, 856.7793,
        857.3909, 858.7573, 863.3896, 863.8517, 868.6448, 870.0494, 870.4050,
        872.1248, 873.6703, 875.1963, 875.9040, 876.7106, 881.5602, 884.7391,
        889.6661], device='cuda:0')
used idx is  tensor([ 4,  3,  5,  1,  6,  0,  2,  7, 32, 29, 33, 31, 30, 15, 34, 35,  9, 14,
         8, 18, 10, 28, 27, 19, 11], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 71.39% 

Test Accuracy: 70.91% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 71.39%
|----0th round Training Accuracy : 10.23%
|----1th round Training Accuracy : 10.16%
|----2th round Training Accuracy : 17.82%
|----3th round Training Accuracy : 20.42%
|----4th round Training Accuracy : 9.90%
|----5th round Training Accuracy : 10.21%
|----6th round Training Accuracy : 10.20%
|----7th round Training Accuracy : 48.16%
|----8th round Training Accuracy : 73.68%
|----9th round Training Accuracy : 74.03%
|----10th round Training Accuracy : 15.46%
|----11th round Training Accuracy : 81.47%
|----12th round Training Accuracy : 9.86%
|----13th round Training Accuracy : 80.67%
|----14th round Training Accuracy : 84.32%
|----15th round Training Accuracy : 84.81%
|----16th round Training Accuracy : 13.07%
|----17th round Training Accuracy : 85.11%
|----18th round Training Accuracy : 9.86%
|----19th round Training Accuracy : 85.33%
|----20th round Training Accuracy : 84.84%
|----21th round Training Accuracy : 85.13%
|----22th round Training Accuracy : 12.72%
|----23th round Training Accuracy : 85.62%
|----24th round Training Accuracy : 85.71%
|----25th round Training Accuracy : 85.66%
|----26th round Training Accuracy : 86.16%
|----27th round Training Accuracy : 86.79%
|----28th round Training Accuracy : 9.86%
|----29th round Training Accuracy : 85.93%
|----30th round Training Accuracy : 9.86%
|----31th round Training Accuracy : 29.80%
|----32th round Training Accuracy : 85.57%
|----33th round Training Accuracy : 85.07%
|----34th round Training Accuracy : 86.17%
|----35th round Training Accuracy : 86.45%
|----36th round Training Accuracy : 9.86%
|----37th round Training Accuracy : 15.98%
|----38th round Training Accuracy : 85.76%
|----39th round Training Accuracy : 86.56%
|----40th round Training Accuracy : 10.83%
|----41th round Training Accuracy : 84.95%
|----42th round Training Accuracy : 9.86%
|----43th round Training Accuracy : 38.83%
|----44th round Training Accuracy : 86.73%
|----45th round Training Accuracy : 86.60%
|----46th round Training Accuracy : 9.86%
|----47th round Training Accuracy : 86.16%
|----48th round Training Accuracy : 10.20%
|----49th round Training Accuracy : 71.39%
|----Final Test Accuracy: 70.91%
|----0th round Final Test Accuracy : 10.02%
|----1th round Final Test Accuracy : 10.25%
|----2th round Final Test Accuracy : 17.29%
|----3th round Final Test Accuracy : 19.52%
|----4th round Final Test Accuracy : 10.00%
|----5th round Final Test Accuracy : 10.01%
|----6th round Final Test Accuracy : 10.00%
|----7th round Final Test Accuracy : 47.39%
|----8th round Final Test Accuracy : 72.49%
|----9th round Final Test Accuracy : 72.87%
|----10th round Final Test Accuracy : 15.52%
|----11th round Final Test Accuracy : 80.22%
|----12th round Final Test Accuracy : 10.00%
|----13th round Final Test Accuracy : 79.90%
|----14th round Final Test Accuracy : 83.64%
|----15th round Final Test Accuracy : 83.99%
|----16th round Final Test Accuracy : 13.23%
|----17th round Final Test Accuracy : 84.45%
|----18th round Final Test Accuracy : 10.00%
|----19th round Final Test Accuracy : 84.40%
|----20th round Final Test Accuracy : 83.91%
|----21th round Final Test Accuracy : 84.36%
|----22th round Final Test Accuracy : 12.86%
|----23th round Final Test Accuracy : 84.52%
|----24th round Final Test Accuracy : 85.03%
|----25th round Final Test Accuracy : 84.95%
|----26th round Final Test Accuracy : 84.98%
|----27th round Final Test Accuracy : 86.00%
|----28th round Final Test Accuracy : 10.00%
|----29th round Final Test Accuracy : 84.73%
|----30th round Final Test Accuracy : 10.00%
|----31th round Final Test Accuracy : 29.85%
|----32th round Final Test Accuracy : 84.68%
|----33th round Final Test Accuracy : 84.48%
|----34th round Final Test Accuracy : 85.12%
|----35th round Final Test Accuracy : 85.42%
|----36th round Final Test Accuracy : 10.00%
|----37th round Final Test Accuracy : 16.18%
|----38th round Final Test Accuracy : 84.94%
|----39th round Final Test Accuracy : 85.73%
|----40th round Final Test Accuracy : 11.21%
|----41th round Final Test Accuracy : 84.27%
|----42th round Final Test Accuracy : 10.00%
|----43th round Final Test Accuracy : 38.65%
|----44th round Final Test Accuracy : 85.58%
|----45th round Final Test Accuracy : 85.69%
|----46th round Final Test Accuracy : 10.00%
|----47th round Final Test Accuracy : 85.20%
|----48th round Final Test Accuracy : 10.00%
|----49th round Final Test Accuracy : 70.91%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!


 Total Run Time: 3312.6541
