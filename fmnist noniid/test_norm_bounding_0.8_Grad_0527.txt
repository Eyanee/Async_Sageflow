
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4517156481742859
distance x is tensor(106.4239, device='cuda:0')
benign distance is  tensor(106.4239, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5986272692680359
distance x is tensor(117.6364, device='cuda:0')
benign distance is  tensor(117.6364, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.51777583360672
distance x is tensor(118.1354, device='cuda:0')
benign distance is  tensor(118.1354, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4509586691856384
distance x is tensor(119.1354, device='cuda:0')
benign distance is  tensor(119.1354, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5602610111236572
distance x is tensor(104.7480, device='cuda:0')
benign distance is  tensor(104.7480, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.543986439704895
distance x is tensor(124.5414, device='cuda:0')
benign distance is  tensor(124.5414, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6507711410522461
distance x is tensor(110.5803, device='cuda:0')
benign distance is  tensor(110.5803, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5314013361930847
distance x is tensor(120.5936, device='cuda:0')
benign distance is  tensor(120.5936, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.15252357721328735
distance x is tensor(138.0990, device='cuda:0')
benign distance is  tensor(138.0990, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5052932500839233
distance x is tensor(135.7347, device='cuda:0')
benign distance is  tensor(135.7347, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5338603258132935
distance x is tensor(122.9978, device='cuda:0')
benign distance is  tensor(122.9978, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.24305430054664612
distance x is tensor(127.2558, device='cuda:0')
benign distance is  tensor(127.2558, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4566642642021179
distance x is tensor(125.9630, device='cuda:0')
benign distance is  tensor(125.9630, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5290412902832031
distance x is tensor(145.2872, device='cuda:0')
benign distance is  tensor(145.2872, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8198836445808411
distance x is tensor(134.6928, device='cuda:0')
benign distance is  tensor(134.6928, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3482930660247803
distance x is tensor(137.9305, device='cuda:0')
benign distance is  tensor(137.9305, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3157831132411957
distance x is tensor(125.3491, device='cuda:0')
benign distance is  tensor(125.3491, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8819781541824341
distance x is tensor(144.6467, device='cuda:0')
benign distance is  tensor(144.6467, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4109305739402771
distance x is tensor(126.4011, device='cuda:0')
benign distance is  tensor(126.4011, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7427933216094971
distance x is tensor(122.4058, device='cuda:0')
benign distance is  tensor(122.4058, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.07486440241336823
distance x is tensor(126.1070, device='cuda:0')
benign distance is  tensor(126.1070, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.1914900839328766
distance x is tensor(123.9095, device='cuda:0')
benign distance is  tensor(123.9095, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5414273142814636
distance x is tensor(143.4329, device='cuda:0')
benign distance is  tensor(143.4329, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9212771654129028
distance x is tensor(129.7358, device='cuda:0')
benign distance is  tensor(129.7358, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2891521453857422
distance x is tensor(144.3344, device='cuda:0')
benign distance is  tensor(144.3344, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5622348785400391
distance x is tensor(118.9141, device='cuda:0')
benign distance is  tensor(118.9141, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.127678394317627
distance x is tensor(143.5258, device='cuda:0')
benign distance is  tensor(143.5258, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.1957092136144638
distance x is tensor(136.8433, device='cuda:0')
benign distance is  tensor(136.8433, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1398553848266602
distance x is tensor(123.8142, device='cuda:0')
benign distance is  tensor(123.8142, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6709946393966675
distance x is tensor(136.2844, device='cuda:0')
benign distance is  tensor(136.2844, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.34016677737236023
distance x is tensor(125.5534, device='cuda:0')
benign distance is  tensor(125.5534, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.650313675403595
distance x is tensor(134.2764, device='cuda:0')
benign distance is  tensor(134.2764, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.26055413484573364
distance x is tensor(133.1147, device='cuda:0')
benign distance is  tensor(133.1147, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.15871500968933105
distance x is tensor(132.3809, device='cuda:0')
benign distance is  tensor(132.3809, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.38882139325141907
distance x is tensor(138.8896, device='cuda:0')
benign distance is  tensor(138.8896, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.026826446875929832
distance x is tensor(125.3183, device='cuda:0')
benign distance is  tensor(125.3183, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3413013517856598
distance x is tensor(127.8918, device='cuda:0')
benign distance is  tensor(127.8918, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.22809842228889465
distance x is tensor(130.2180, device='cuda:0')
benign distance is  tensor(130.2180, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3904361426830292
distance x is tensor(130.5795, device='cuda:0')
benign distance is  tensor(130.5795, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.19389374554157257
distance x is tensor(126.9740, device='cuda:0')
benign distance is  tensor(126.9740, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.20875859260559082
distance x is tensor(122.4173, device='cuda:0')
benign distance is  tensor(122.4173, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.34384581446647644
distance x is tensor(121.4071, device='cuda:0')
benign distance is  tensor(121.4071, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1284576803445816
distance x is tensor(131.4982, device='cuda:0')
benign distance is  tensor(131.4982, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.625485360622406
distance x is tensor(132.3993, device='cuda:0')
benign distance is  tensor(132.3993, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.41716891527175903
distance x is tensor(133.7255, device='cuda:0')
benign distance is  tensor(133.7255, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5963748097419739
distance x is tensor(131.6190, device='cuda:0')
benign distance is  tensor(131.6190, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9285675883293152
distance x is tensor(132.5421, device='cuda:0')
benign distance is  tensor(132.5421, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.1717165857553482
distance x is tensor(134.2325, device='cuda:0')
benign distance is  tensor(134.2325, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.27700960636138916
mal_entropy is 0.17651355266571045
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([479.9023, 547.9161, 531.0873, 539.2451, 487.8082, 569.9774, 498.2731,
        561.5845, 460.8914, 460.8915, 460.8914, 460.8915, 460.8914, 460.8915,
        460.8914, 460.8915, 460.8914, 460.8915, 460.8914, 460.8915],
       device='cuda:0')
sorted_norm is   tensor([460.8914, 460.8914, 460.8914, 460.8914, 460.8914, 460.8914, 460.8915,
        460.8915, 460.8915, 460.8915, 460.8915, 460.8915, 479.9023, 487.8082,
        498.2731, 531.0873, 539.2451, 547.9161, 561.5845, 569.9774],
       device='cuda:0')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  0,  4,  6,  2],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 88.82% 

Test Accuracy: 88.11% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9065502285957336
distance x is tensor(108.1268, device='cuda:0')
benign distance is  tensor(108.1268, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.836016833782196
distance x is tensor(119.7959, device='cuda:0')
benign distance is  tensor(119.7959, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.39511510729789734
distance x is tensor(122.0286, device='cuda:0')
benign distance is  tensor(122.0286, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7874858379364014
distance x is tensor(108.4370, device='cuda:0')
benign distance is  tensor(108.4370, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.15160071849823
distance x is tensor(104.8460, device='cuda:0')
benign distance is  tensor(104.8460, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1212190389633179
distance x is tensor(123.8221, device='cuda:0')
benign distance is  tensor(123.8221, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1792999804019928
distance x is tensor(110.3872, device='cuda:0')
benign distance is  tensor(110.3872, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3622859716415405
distance x is tensor(131.6906, device='cuda:0')
benign distance is  tensor(131.6906, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.43641096353530884
mal_entropy is 0.1781238466501236
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([494.1527, 550.2280, 557.1773, 482.7584, 483.2159, 563.1232, 494.8832,
        602.7312, 459.3657, 459.3657, 459.3657, 459.3657, 459.3657, 459.3657,
        459.3657, 459.3657, 459.3657, 459.3657, 459.3657, 459.3657, 715.6253,
        712.5651, 671.2741, 679.7505, 675.6454, 755.6750, 707.7732, 715.5214],
       device='cuda:0')
sorted_norm is   tensor([459.3657, 459.3657, 459.3657, 459.3657, 459.3657, 459.3657, 459.3657,
        459.3657, 459.3657, 459.3657, 459.3657, 459.3657, 482.7584, 483.2159,
        494.1527, 494.8832, 550.2280, 557.1773, 563.1232, 602.7312, 671.2741,
        675.6454, 679.7505, 707.7732, 712.5651, 715.5214, 715.6253, 755.6750],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  3,  4,  0,  6,  1,  2,
         5,  7, 22, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 88.28% 

Test Accuracy: 87.69% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5909594893455505
distance x is tensor(121.7975, device='cuda:0')
benign distance is  tensor(121.7975, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.23215928673744202
distance x is tensor(137.0372, device='cuda:0')
benign distance is  tensor(137.0372, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13950319588184357
distance x is tensor(128.1719, device='cuda:0')
benign distance is  tensor(128.1719, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.16097192466259003
distance x is tensor(99.6105, device='cuda:0')
benign distance is  tensor(99.6105, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5451029539108276
distance x is tensor(105.3571, device='cuda:0')
benign distance is  tensor(105.3571, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5668678283691406
distance x is tensor(136.3887, device='cuda:0')
benign distance is  tensor(136.3887, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.21803352236747742
distance x is tensor(123.6427, device='cuda:0')
benign distance is  tensor(123.6427, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5600609183311462
distance x is tensor(129.3946, device='cuda:0')
benign distance is  tensor(129.3946, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5458139181137085
distance x is tensor(148.8884, device='cuda:0')
benign distance is  tensor(148.8884, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.34754037857055664
distance x is tensor(143.1035, device='cuda:0')
benign distance is  tensor(143.1035, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9591597318649292
distance x is tensor(131.4846, device='cuda:0')
benign distance is  tensor(131.4846, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8374720811843872
distance x is tensor(133.8725, device='cuda:0')
benign distance is  tensor(133.8725, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5208255052566528
distance x is tensor(134.0160, device='cuda:0')
benign distance is  tensor(134.0160, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.19666948914527893
distance x is tensor(141.1859, device='cuda:0')
benign distance is  tensor(141.1859, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2835877537727356
distance x is tensor(144.9279, device='cuda:0')
benign distance is  tensor(144.9279, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3758867383003235
distance x is tensor(149.0389, device='cuda:0')
benign distance is  tensor(149.0389, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.706015944480896
mal_entropy is 0.21055106818675995
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([561.0417, 629.8549, 579.4646, 442.3933, 475.7990, 620.0308, 553.6600,
        594.0905, 461.3817, 461.3817, 461.3817, 461.3817, 461.3817, 461.3817,
        461.3817, 461.3817, 461.3817, 461.3817, 461.3817, 461.3817, 715.3505,
        798.1802, 729.4485, 730.1115, 722.8530, 715.8942, 791.7421, 728.5930],
       device='cuda:0')
sorted_norm is   tensor([442.3933, 461.3817, 461.3817, 461.3817, 461.3817, 461.3817, 461.3817,
        461.3817, 461.3817, 461.3817, 461.3817, 461.3817, 461.3817, 475.7990,
        553.6600, 561.0417, 579.4646, 594.0905, 620.0308, 629.8549, 715.3505,
        715.8942, 722.8530, 728.5930, 729.4485, 730.1115, 791.7421, 798.1802],
       device='cuda:0')
used idx is  tensor([ 3, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4,  6,  0,  2,  7,
         5,  1, 20, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 87.87% 

Test Accuracy: 86.92% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.492022842168808
distance x is tensor(130.3258, device='cuda:0')
benign distance is  tensor(130.3258, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0391849279403687
distance x is tensor(127.2300, device='cuda:0')
benign distance is  tensor(127.2300, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5913815498352051
distance x is tensor(147.9940, device='cuda:0')
benign distance is  tensor(147.9940, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5145066976547241
distance x is tensor(128.8620, device='cuda:0')
benign distance is  tensor(128.8620, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.933890700340271
distance x is tensor(124.6475, device='cuda:0')
benign distance is  tensor(124.6475, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.535003125667572
distance x is tensor(127.3098, device='cuda:0')
benign distance is  tensor(127.3098, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7033776640892029
distance x is tensor(131.4780, device='cuda:0')
benign distance is  tensor(131.4780, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5180245637893677
distance x is tensor(138.5933, device='cuda:0')
benign distance is  tensor(138.5933, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.22802197933197021
distance x is tensor(139.7326, device='cuda:0')
benign distance is  tensor(139.7326, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9670524597167969
distance x is tensor(159.1640, device='cuda:0')
benign distance is  tensor(159.1640, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2652794122695923
distance x is tensor(143.8382, device='cuda:0')
benign distance is  tensor(143.8382, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.0604841485619545
distance x is tensor(142.7533, device='cuda:0')
benign distance is  tensor(142.7533, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3374063968658447
distance x is tensor(147.5364, device='cuda:0')
benign distance is  tensor(147.5364, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9466144442558289
distance x is tensor(142.3540, device='cuda:0')
benign distance is  tensor(142.3540, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.20978593826293945
distance x is tensor(167.2941, device='cuda:0')
benign distance is  tensor(167.2941, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5477176904678345
distance x is tensor(145.1933, device='cuda:0')
benign distance is  tensor(145.1933, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.7000000005
mal_loss is 1.8557472229003906
mal_entropy is 0.32210174202919006
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([602.8580, 582.6606, 661.6714, 588.3131, 562.8469, 576.4305, 576.2872,
        622.7963, 462.4217, 462.4217, 462.4217, 462.4217, 462.4217, 462.4217,
        462.4217, 462.4217, 462.4217, 462.4217, 462.4217, 462.4217, 845.3774,
        746.2158, 838.8088, 799.3213, 765.6466, 823.0478, 778.2636, 819.8188,
        726.5152, 693.4154, 661.4435, 652.3376, 670.8593, 692.2874, 704.7552,
        729.9327], device='cuda:0')
sorted_norm is   tensor([462.4217, 462.4217, 462.4217, 462.4217, 462.4217, 462.4217, 462.4217,
        462.4217, 462.4217, 462.4217, 462.4217, 462.4217, 562.8469, 576.2872,
        576.4305, 582.6606, 588.3131, 602.8580, 622.7963, 652.3376, 661.4435,
        661.6714, 670.8593, 692.2874, 693.4154, 704.7552, 726.5152, 729.9327,
        746.2158, 765.6466, 778.2636, 799.3213, 819.8188, 823.0478, 838.8088,
        845.3774], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  4,  6,  5,  1,  3,  0,
         7, 31, 30,  2, 32, 33, 29, 34, 28, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.62% 

Test Accuracy: 86.27% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8877819180488586
distance x is tensor(128.6145, device='cuda:0')
benign distance is  tensor(128.6145, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8702813982963562
distance x is tensor(129.4607, device='cuda:0')
benign distance is  tensor(129.4607, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1746998131275177
distance x is tensor(126.5739, device='cuda:0')
benign distance is  tensor(126.5739, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4462626874446869
distance x is tensor(147.8063, device='cuda:0')
benign distance is  tensor(147.8063, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.37683382630348206
distance x is tensor(125.9942, device='cuda:0')
benign distance is  tensor(125.9942, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.699288010597229
distance x is tensor(132.5081, device='cuda:0')
benign distance is  tensor(132.5081, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0410614013671875
distance x is tensor(124.2110, device='cuda:0')
benign distance is  tensor(124.2110, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.12039413303136826
distance x is tensor(125.9287, device='cuda:0')
benign distance is  tensor(125.9287, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3090117573738098
distance x is tensor(151.6356, device='cuda:0')
benign distance is  tensor(151.6356, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7081360816955566
distance x is tensor(141.5522, device='cuda:0')
benign distance is  tensor(141.5522, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.37952107191085815
distance x is tensor(138.2188, device='cuda:0')
benign distance is  tensor(138.2188, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.710975706577301
distance x is tensor(142.1323, device='cuda:0')
benign distance is  tensor(142.1323, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5511104464530945
distance x is tensor(151.9161, device='cuda:0')
benign distance is  tensor(151.9161, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.09753122925758362
distance x is tensor(160.7989, device='cuda:0')
benign distance is  tensor(160.7989, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6212536096572876
distance x is tensor(147.0419, device='cuda:0')
benign distance is  tensor(147.0419, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6107537150382996
distance x is tensor(149.1319, device='cuda:0')
benign distance is  tensor(149.1319, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2654265761375427
distance x is tensor(152.7552, device='cuda:0')
benign distance is  tensor(152.7552, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5880738496780396
distance x is tensor(152.1922, device='cuda:0')
benign distance is  tensor(152.1922, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.33272281289100647
distance x is tensor(150.2019, device='cuda:0')
benign distance is  tensor(150.2019, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.41200700402259827
distance x is tensor(147.8192, device='cuda:0')
benign distance is  tensor(147.8192, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7409483194351196
distance x is tensor(148.7227, device='cuda:0')
benign distance is  tensor(148.7227, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.35941067337989807
distance x is tensor(147.9324, device='cuda:0')
benign distance is  tensor(147.9324, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2508491277694702
distance x is tensor(153.0675, device='cuda:0')
benign distance is  tensor(153.0675, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.1677999049425125
distance x is tensor(143.8351, device='cuda:0')
benign distance is  tensor(143.8351, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5500000005000001
mal_loss is 4.60134744644165
mal_entropy is 0.19891580939292908
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([576.2933, 592.2204, 570.7501, 682.0563, 561.1765, 592.6711, 546.0443,
        579.7852, 462.5269, 462.5269, 462.5269, 462.5269, 462.5269, 462.5269,
        462.5269, 462.5269, 462.5269, 462.5269, 462.5269, 462.5269, 837.7908,
        825.5020, 848.9039, 803.7142, 822.7780, 813.3943, 827.7968, 804.3652],
       device='cuda:0')
sorted_norm is   tensor([462.5269, 462.5269, 462.5269, 462.5269, 462.5269, 462.5269, 462.5269,
        462.5269, 462.5269, 462.5269, 462.5269, 462.5269, 546.0443, 561.1765,
        570.7501, 576.2933, 579.7852, 592.2204, 592.6711, 682.0563, 803.7142,
        804.3652, 813.3943, 822.7780, 825.5020, 827.7968, 837.7908, 848.9039],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  4,  2,  0,  7,  1,
         5,  3, 23, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 84.21% 

Test Accuracy: 82.75% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.35231539607048035
distance x is tensor(141.8704, device='cuda:0')
benign distance is  tensor(141.8704, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2074005603790283
distance x is tensor(149.3802, device='cuda:0')
benign distance is  tensor(149.3802, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.259011447429657
distance x is tensor(142.5412, device='cuda:0')
benign distance is  tensor(142.5412, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.28302955627441406
distance x is tensor(144.2979, device='cuda:0')
benign distance is  tensor(144.2979, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.20664775371551514
distance x is tensor(128.6879, device='cuda:0')
benign distance is  tensor(128.6879, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0947797298431396
distance x is tensor(145.6245, device='cuda:0')
benign distance is  tensor(145.6245, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4731667935848236
distance x is tensor(176.2462, device='cuda:0')
benign distance is  tensor(176.2462, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4326038360595703
distance x is tensor(157.2301, device='cuda:0')
benign distance is  tensor(157.2301, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7508198618888855
distance x is tensor(157.5173, device='cuda:0')
benign distance is  tensor(157.5173, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.11179902404546738
distance x is tensor(159.8824, device='cuda:0')
benign distance is  tensor(159.8824, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.44213104248046875
distance x is tensor(160.4812, device='cuda:0')
benign distance is  tensor(160.4812, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1841810643672943
distance x is tensor(154.2376, device='cuda:0')
benign distance is  tensor(154.2376, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3809318542480469
distance x is tensor(156.3300, device='cuda:0')
benign distance is  tensor(156.3300, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.15034881234169006
distance x is tensor(153.4412, device='cuda:0')
benign distance is  tensor(153.4412, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3999052047729492
distance x is tensor(161.3561, device='cuda:0')
benign distance is  tensor(161.3561, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.27042096853256226
distance x is tensor(152.5644, device='cuda:0')
benign distance is  tensor(152.5644, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal_loss is 17.600908279418945
mal_entropy is 0.1940365880727768
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([653.1802, 662.0851, 628.0285, 634.6883, 569.1358, 652.7712, 765.9920,
        701.6253, 463.0215, 463.0215, 463.0215, 463.0215, 463.0215, 463.0215,
        463.0215, 463.0215, 463.0215, 463.0215, 463.0215, 463.0215, 853.9060,
        841.9469, 867.4064, 870.9730, 879.2411, 869.7709, 873.8475, 891.3511,
        722.7070, 797.1496, 730.7063, 728.8351, 749.3594, 735.4620, 821.2670,
        735.1531, 736.0739, 685.6547, 674.3466, 679.2933, 736.0956, 760.0178,
        701.9700, 719.5627], device='cuda:0')
sorted_norm is   tensor([463.0215, 463.0215, 463.0215, 463.0215, 463.0215, 463.0215, 463.0215,
        463.0215, 463.0215, 463.0215, 463.0215, 463.0215, 569.1358, 628.0285,
        634.6883, 652.7712, 653.1802, 662.0851, 674.3466, 679.2933, 685.6547,
        701.6253, 701.9700, 719.5627, 722.7070, 728.8351, 730.7063, 735.1531,
        735.4620, 736.0739, 736.0956, 749.3594, 760.0178, 765.9920, 797.1496,
        821.2670, 841.9469, 853.9060, 867.4064, 869.7709, 870.9730, 873.8475,
        879.2411, 891.3511], device='cuda:0')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10,  4,  2,  3,  5,  0,  1,
        38, 39, 37,  7, 42, 43, 28, 31, 30, 35, 33, 36, 40, 32, 41,  6, 29],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 87.54% 

Test Accuracy: 85.89% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.19983965158462524
distance x is tensor(114.7320, device='cuda:0')
benign distance is  tensor(114.7320, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6236120462417603
distance x is tensor(133.3137, device='cuda:0')
benign distance is  tensor(133.3137, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08400999009609222
distance x is tensor(140.9228, device='cuda:0')
benign distance is  tensor(140.9228, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6217697858810425
distance x is tensor(124.7253, device='cuda:0')
benign distance is  tensor(124.7253, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7723541855812073
distance x is tensor(128.4890, device='cuda:0')
benign distance is  tensor(128.4890, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8595393896102905
distance x is tensor(132.9300, device='cuda:0')
benign distance is  tensor(132.9300, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4353366792201996
distance x is tensor(147.7134, device='cuda:0')
benign distance is  tensor(147.7134, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4442601203918457
distance x is tensor(146.9490, device='cuda:0')
benign distance is  tensor(146.9490, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7731925845146179
distance x is tensor(156.4989, device='cuda:0')
benign distance is  tensor(156.4989, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5213807225227356
distance x is tensor(147.9530, device='cuda:0')
benign distance is  tensor(147.9530, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3060090243816376
distance x is tensor(140.3516, device='cuda:0')
benign distance is  tensor(140.3516, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3345375657081604
distance x is tensor(143.3634, device='cuda:0')
benign distance is  tensor(143.3634, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.469226598739624
distance x is tensor(139.2282, device='cuda:0')
benign distance is  tensor(139.2282, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8473029136657715
distance x is tensor(149.6917, device='cuda:0')
benign distance is  tensor(149.6917, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.24755358695983887
distance x is tensor(147.2372, device='cuda:0')
benign distance is  tensor(147.2372, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5304344296455383
distance x is tensor(161.3142, device='cuda:0')
benign distance is  tensor(161.3142, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2529199719429016
distance x is tensor(150.3672, device='cuda:0')
benign distance is  tensor(150.3672, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5075215101242065
distance x is tensor(159.4142, device='cuda:0')
benign distance is  tensor(159.4142, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4001683294773102
distance x is tensor(143.1188, device='cuda:0')
benign distance is  tensor(143.1188, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.21985062956809998
distance x is tensor(157.6223, device='cuda:0')
benign distance is  tensor(157.6223, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3304041922092438
distance x is tensor(173.4973, device='cuda:0')
benign distance is  tensor(173.4973, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0148721933364868
distance x is tensor(138.4330, device='cuda:0')
benign distance is  tensor(138.4330, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.39884117245674133
distance x is tensor(141.5820, device='cuda:0')
benign distance is  tensor(141.5820, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7874424457550049
distance x is tensor(158.9591, device='cuda:0')
benign distance is  tensor(158.9591, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4055057168006897
distance x is tensor(139.0611, device='cuda:0')
benign distance is  tensor(139.0611, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.19749698042869568
distance x is tensor(152.8372, device='cuda:0')
benign distance is  tensor(152.8372, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1609109789133072
distance x is tensor(139.4030, device='cuda:0')
benign distance is  tensor(139.4030, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.34952250123023987
distance x is tensor(162.0983, device='cuda:0')
benign distance is  tensor(162.0983, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4709891378879547
distance x is tensor(146.7211, device='cuda:0')
benign distance is  tensor(146.7211, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.549927830696106
distance x is tensor(144.1176, device='cuda:0')
benign distance is  tensor(144.1176, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9559739232063293
distance x is tensor(154.3439, device='cuda:0')
benign distance is  tensor(154.3439, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.9612960815429688
distance x is tensor(148.8869, device='cuda:0')
benign distance is  tensor(148.8869, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5500000005000001
mal_loss is 8.544862747192383
mal_entropy is 0.2624610364437103
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([527.1223, 603.9946, 630.4285, 566.6184, 594.4772, 613.2291, 659.1690,
        660.1367, 462.3643, 462.3643, 462.3643, 462.3643, 462.3643, 462.3643,
        462.3643, 462.3643, 462.3643, 462.3643, 462.3643, 462.3643],
       device='cuda:0')
sorted_norm is   tensor([462.3643, 462.3643, 462.3643, 462.3643, 462.3643, 462.3643, 462.3643,
        462.3643, 462.3643, 462.3643, 462.3643, 462.3643, 527.1223, 566.6184,
        594.4772, 603.9946, 613.2291, 630.4285, 659.1690, 660.1367],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  0,  3,  4,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 61.85% 

Test Accuracy: 61.56% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6594207286834717
distance x is tensor(184.7037, device='cuda:0')
benign distance is  tensor(184.7037, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3992627263069153
distance x is tensor(179.2366, device='cuda:0')
benign distance is  tensor(179.2366, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.008430341258645058
distance x is tensor(203.8629, device='cuda:0')
benign distance is  tensor(203.8629, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.48633232712745667
distance x is tensor(182.7912, device='cuda:0')
benign distance is  tensor(182.7912, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0389032363891602
distance x is tensor(159.5148, device='cuda:0')
benign distance is  tensor(159.5148, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8032137155532837
distance x is tensor(185.6765, device='cuda:0')
benign distance is  tensor(185.6765, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20994296669960022
distance x is tensor(193.9806, device='cuda:0')
benign distance is  tensor(193.9806, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7226559519767761
distance x is tensor(181.9875, device='cuda:0')
benign distance is  tensor(181.9875, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 47.47300338745117
mal_entropy is 0.1159016489982605
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([802.2719, 753.2317, 855.0228, 765.1720, 679.0137, 792.6708, 810.7192,
        765.4981, 463.1355, 463.1355, 463.1355, 463.1355, 463.1355, 463.1355,
        463.1355, 463.1355, 463.1355, 463.1355, 463.1355, 463.1355, 836.1982,
        827.0552, 827.2067, 811.5120, 814.5316, 812.8794, 849.5827, 815.3755,
        793.8051, 767.0659, 727.9246, 753.5571, 731.1259, 767.7128, 773.6155,
        813.8813], device='cuda:0')
sorted_norm is   tensor([463.1355, 463.1355, 463.1355, 463.1355, 463.1355, 463.1355, 463.1355,
        463.1355, 463.1355, 463.1355, 463.1355, 463.1355, 679.0137, 727.9246,
        731.1259, 753.2317, 753.5571, 765.1720, 765.4981, 767.0659, 767.7128,
        773.6155, 792.6708, 793.8051, 802.2719, 810.7192, 811.5120, 812.8794,
        813.8813, 814.5316, 815.3755, 827.0552, 827.2067, 836.1982, 849.5827,
        855.0228], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  4, 30, 32,  1, 31,  3,
         7, 29, 33, 34,  5, 28,  0,  6, 23, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 84.51% 

Test Accuracy: 83.20% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3506670594215393
distance x is tensor(142.3883, device='cuda:0')
benign distance is  tensor(142.3883, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6093871593475342
distance x is tensor(160.0565, device='cuda:0')
benign distance is  tensor(160.0565, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05123225599527359
distance x is tensor(147.8611, device='cuda:0')
benign distance is  tensor(147.8611, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9671161770820618
distance x is tensor(156.7006, device='cuda:0')
benign distance is  tensor(156.7006, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8739197254180908
distance x is tensor(148.0734, device='cuda:0')
benign distance is  tensor(148.0734, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1070489883422852
distance x is tensor(145.0020, device='cuda:0')
benign distance is  tensor(145.0020, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2648009657859802
distance x is tensor(154.6107, device='cuda:0')
benign distance is  tensor(154.6107, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.223726749420166
distance x is tensor(167.6156, device='cuda:0')
benign distance is  tensor(167.6156, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.15968622267246246
distance x is tensor(173.8371, device='cuda:0')
benign distance is  tensor(173.8371, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.42527681589126587
distance x is tensor(165.8079, device='cuda:0')
benign distance is  tensor(165.8079, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4500665068626404
distance x is tensor(161.3877, device='cuda:0')
benign distance is  tensor(161.3877, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4225548803806305
distance x is tensor(164.5171, device='cuda:0')
benign distance is  tensor(164.5171, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4744226336479187
distance x is tensor(170.1356, device='cuda:0')
benign distance is  tensor(170.1356, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9093368649482727
distance x is tensor(165.2667, device='cuda:0')
benign distance is  tensor(165.2667, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31317925453186035
distance x is tensor(157.4652, device='cuda:0')
benign distance is  tensor(157.4652, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4853845238685608
distance x is tensor(166.7497, device='cuda:0')
benign distance is  tensor(166.7497, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3579779267311096
distance x is tensor(181.1460, device='cuda:0')
benign distance is  tensor(181.1460, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8151580691337585
distance x is tensor(149.7579, device='cuda:0')
benign distance is  tensor(149.7579, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3605462908744812
distance x is tensor(170.3085, device='cuda:0')
benign distance is  tensor(170.3085, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.36281818151474
distance x is tensor(174.7196, device='cuda:0')
benign distance is  tensor(174.7196, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6570534706115723
distance x is tensor(166.8664, device='cuda:0')
benign distance is  tensor(166.8664, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8349567651748657
distance x is tensor(153.2413, device='cuda:0')
benign distance is  tensor(153.2413, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.31150397658348083
distance x is tensor(153.0994, device='cuda:0')
benign distance is  tensor(153.0994, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2681484818458557
distance x is tensor(165.7689, device='cuda:0')
benign distance is  tensor(165.7689, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal_loss is 9.029095649719238
mal_entropy is 0.2442467212677002
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([649.0377, 726.4432, 678.8699, 719.3185, 671.8547, 660.0440, 701.2625,
        765.3444, 458.3450, 458.3450, 458.3450, 458.3450, 458.3450, 458.3450,
        458.3450, 458.3450, 458.3450, 458.3450, 458.3450, 458.3450, 752.8090,
        791.0959, 734.3365, 800.9752, 846.6035, 718.2307, 733.6950, 806.6524],
       device='cuda:0')
sorted_norm is   tensor([458.3450, 458.3450, 458.3450, 458.3450, 458.3450, 458.3450, 458.3450,
        458.3450, 458.3450, 458.3450, 458.3450, 458.3450, 649.0377, 660.0440,
        671.8547, 678.8699, 701.2625, 718.2307, 719.3185, 726.4432, 733.6950,
        734.3365, 752.8090, 765.3444, 791.0959, 800.9752, 806.6524, 846.6035],
       device='cuda:0')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10,  0,  5,  4,  2,  6, 25,
         3,  1, 26, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 79.52% 

Test Accuracy: 78.19% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5005519986152649
distance x is tensor(177.1848, device='cuda:0')
benign distance is  tensor(177.1848, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.29889383912086487
distance x is tensor(162.2833, device='cuda:0')
benign distance is  tensor(162.2833, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.30660417675971985
distance x is tensor(171.7937, device='cuda:0')
benign distance is  tensor(171.7937, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7420927882194519
distance x is tensor(173.6219, device='cuda:0')
benign distance is  tensor(173.6219, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6776638031005859
distance x is tensor(156.1110, device='cuda:0')
benign distance is  tensor(156.1110, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5852532386779785
distance x is tensor(176.2163, device='cuda:0')
benign distance is  tensor(176.2163, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.588394284248352
distance x is tensor(152.5828, device='cuda:0')
benign distance is  tensor(152.5828, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8164591789245605
distance x is tensor(179.9420, device='cuda:0')
benign distance is  tensor(179.9420, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.42887169122695923
distance x is tensor(169.2094, device='cuda:0')
benign distance is  tensor(169.2094, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3123866319656372
distance x is tensor(184.7792, device='cuda:0')
benign distance is  tensor(184.7792, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.768881618976593
distance x is tensor(173.4558, device='cuda:0')
benign distance is  tensor(173.4558, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.44042253494262695
distance x is tensor(179.3862, device='cuda:0')
benign distance is  tensor(179.3862, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2026273012161255
distance x is tensor(183.1711, device='cuda:0')
benign distance is  tensor(183.1711, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.2658795714378357
distance x is tensor(169.7068, device='cuda:0')
benign distance is  tensor(169.7068, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.7382508516311646
distance x is tensor(180.5614, device='cuda:0')
benign distance is  tensor(180.5614, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.49633750319480896
distance x is tensor(178.5017, device='cuda:0')
benign distance is  tensor(178.5017, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal_loss is 23.81179428100586
mal_entropy is 0.08824392408132553
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([782.2175, 744.6279, 759.2660, 785.0073, 703.9036, 785.4274, 669.2598,
        807.9061, 461.0815, 461.0815, 461.0815, 461.0815, 461.0815, 461.0815,
        461.0815, 461.0815, 461.0815, 461.0815, 461.0815, 461.0815, 828.5084,
        853.3458, 868.2537, 848.2526, 854.6254, 828.8094, 850.1676, 836.3636,
        823.1887, 775.0952, 777.5362, 795.7673, 806.4192, 789.1219, 763.9918,
        783.9285], device='cuda:0')
sorted_norm is   tensor([461.0815, 461.0815, 461.0815, 461.0815, 461.0815, 461.0815, 461.0815,
        461.0815, 461.0815, 461.0815, 461.0815, 461.0815, 669.2598, 703.9036,
        744.6279, 759.2660, 763.9918, 775.0952, 777.5362, 782.2175, 783.9285,
        785.0073, 785.4274, 789.1219, 795.7673, 806.4192, 807.9061, 823.1887,
        828.5084, 828.8094, 836.3636, 848.2526, 850.1676, 853.3458, 854.6254,
        868.2537], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  6,  4,  1,  2, 34, 29,
        30,  0, 35,  3,  5, 33, 31, 32,  7, 28], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 84.57% 

Test Accuracy: 83.14% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2350871562957764
distance x is tensor(175.5670, device='cuda:0')
benign distance is  tensor(175.5670, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.116426944732666
distance x is tensor(164.7644, device='cuda:0')
benign distance is  tensor(164.7644, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.40274399518966675
distance x is tensor(173.3683, device='cuda:0')
benign distance is  tensor(173.3683, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.44402796030044556
distance x is tensor(158.8078, device='cuda:0')
benign distance is  tensor(158.8078, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6191387176513672
distance x is tensor(176.0250, device='cuda:0')
benign distance is  tensor(176.0250, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.589745819568634
distance x is tensor(163.7825, device='cuda:0')
benign distance is  tensor(163.7825, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39513683319091797
distance x is tensor(149.7496, device='cuda:0')
benign distance is  tensor(149.7496, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7236008048057556
distance x is tensor(173.1053, device='cuda:0')
benign distance is  tensor(173.1053, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3860882520675659
distance x is tensor(182.1751, device='cuda:0')
benign distance is  tensor(182.1751, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6932790279388428
distance x is tensor(169.0019, device='cuda:0')
benign distance is  tensor(169.0019, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7540837526321411
distance x is tensor(173.5299, device='cuda:0')
benign distance is  tensor(173.5299, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6788331866264343
distance x is tensor(185.6994, device='cuda:0')
benign distance is  tensor(185.6994, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.28018662333488464
distance x is tensor(157.1212, device='cuda:0')
benign distance is  tensor(157.1212, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5411836504936218
distance x is tensor(161.3822, device='cuda:0')
benign distance is  tensor(161.3822, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.563506007194519
distance x is tensor(157.7243, device='cuda:0')
benign distance is  tensor(157.7243, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.058122992515564
distance x is tensor(169.1980, device='cuda:0')
benign distance is  tensor(169.1980, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3152427077293396
distance x is tensor(182.3643, device='cuda:0')
benign distance is  tensor(182.3643, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.12667059898376465
distance x is tensor(163.8632, device='cuda:0')
benign distance is  tensor(163.8632, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6247565150260925
distance x is tensor(165.7813, device='cuda:0')
benign distance is  tensor(165.7813, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.6132327914237976
distance x is tensor(174.8318, device='cuda:0')
benign distance is  tensor(174.8318, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4095638692378998
distance x is tensor(165.2582, device='cuda:0')
benign distance is  tensor(165.2582, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2483859807252884
distance x is tensor(151.4369, device='cuda:0')
benign distance is  tensor(151.4369, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3332921266555786
distance x is tensor(169.3208, device='cuda:0')
benign distance is  tensor(169.3208, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6791423559188843
distance x is tensor(158.8867, device='cuda:0')
benign distance is  tensor(158.8867, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal_loss is 21.03499984741211
mal_entropy is 0.04658353701233864
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([808.6004, 743.5115, 781.1888, 714.8189, 793.9778, 737.6445, 675.5200,
        775.6003, 462.2441, 462.2441, 462.2441, 462.2441, 462.2441, 462.2441,
        462.2441, 462.2441, 462.2441, 462.2441, 462.2441, 462.2441],
       device='cuda:0')
sorted_norm is   tensor([462.2441, 462.2441, 462.2441, 462.2441, 462.2441, 462.2441, 462.2441,
        462.2441, 462.2441, 462.2441, 462.2441, 462.2441, 675.5200, 714.8189,
        737.6445, 743.5115, 775.6003, 781.1888, 793.9778, 808.6004],
       device='cuda:0')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10,  6,  3,  5,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 44.34% 

Test Accuracy: 44.15% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3628248870372772
distance x is tensor(256.7526, device='cuda:0')
benign distance is  tensor(256.7526, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.18614797294139862
distance x is tensor(227.6023, device='cuda:0')
benign distance is  tensor(227.6023, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2180311679840088
distance x is tensor(255.8137, device='cuda:0')
benign distance is  tensor(255.8137, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6202003955841064
distance x is tensor(239.1864, device='cuda:0')
benign distance is  tensor(239.1864, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0094127655029297
distance x is tensor(213.6984, device='cuda:0')
benign distance is  tensor(213.6984, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8749246597290039
distance x is tensor(247.3782, device='cuda:0')
benign distance is  tensor(247.3782, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8225963115692139
distance x is tensor(238.8288, device='cuda:0')
benign distance is  tensor(238.8288, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1956823170185089
distance x is tensor(231.9585, device='cuda:0')
benign distance is  tensor(231.9585, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 65.43170928955078
mal_entropy is 0.03075752966105938
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1047.3014,  935.1706, 1014.0703,  965.2358,  869.9396, 1000.7569,
         976.2089,  942.0316,  462.7724,  462.7724,  462.7724,  462.7724,
         462.7724,  462.7724,  462.7724,  462.7724,  462.7724,  462.7724,
         462.7724,  462.7724,  923.9312,  971.0075,  926.1648,  995.1024,
         962.6193,  940.3113,  979.1590,  967.0128,  982.0715,  853.4930,
         943.0765,  932.9755,  909.5099,  864.6039,  869.4644,  926.8147,
         880.7748,  938.6931,  886.6425,  907.6813,  921.7455,  879.4172,
         924.5930,  902.3436,  899.3400,  848.5032,  867.6436,  919.7340,
         810.3306,  809.3651,  809.3869,  854.5905], device='cuda:0')
sorted_norm is   tensor([ 462.7724,  462.7724,  462.7724,  462.7724,  462.7724,  462.7724,
         462.7724,  462.7724,  462.7724,  462.7724,  462.7724,  462.7724,
         809.3651,  809.3869,  810.3306,  848.5032,  853.4930,  854.5905,
         864.6039,  867.6436,  869.4644,  869.9396,  879.4172,  880.7748,
         886.6425,  899.3400,  902.3436,  907.6813,  909.5099,  919.7340,
         921.7455,  923.9312,  924.5930,  926.1648,  926.8147,  932.9755,
         935.1706,  938.6931,  940.3113,  942.0316,  943.0765,  962.6193,
         965.2358,  967.0128,  971.0075,  976.2089,  979.1590,  982.0715,
         995.1024, 1000.7569, 1014.0703, 1047.3014], device='cuda:0')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10, 49, 50, 48, 45, 29, 51,
        33, 46, 34,  4, 41, 36, 38, 44, 43, 39, 32, 47, 40, 20, 42, 22, 35, 31,
         1, 37, 25,  7, 30], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 87.29% 

Test Accuracy: 85.98% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8535332679748535
distance x is tensor(156.9129, device='cuda:0')
benign distance is  tensor(156.9129, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2332432270050049
distance x is tensor(142.5595, device='cuda:0')
benign distance is  tensor(142.5595, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20896780490875244
distance x is tensor(141.7699, device='cuda:0')
benign distance is  tensor(141.7699, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7582053542137146
distance x is tensor(131.6980, device='cuda:0')
benign distance is  tensor(131.6980, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5550211668014526
distance x is tensor(134.0257, device='cuda:0')
benign distance is  tensor(134.0257, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6490530967712402
distance x is tensor(149.8478, device='cuda:0')
benign distance is  tensor(149.8478, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39268529415130615
distance x is tensor(140.6693, device='cuda:0')
benign distance is  tensor(140.6693, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4331676959991455
distance x is tensor(154.4405, device='cuda:0')
benign distance is  tensor(154.4405, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.30896657705307007
distance x is tensor(155.4981, device='cuda:0')
benign distance is  tensor(155.4981, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5027409791946411
distance x is tensor(158.4250, device='cuda:0')
benign distance is  tensor(158.4250, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5876078009605408
distance x is tensor(151.5162, device='cuda:0')
benign distance is  tensor(151.5162, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1105306148529053
distance x is tensor(149.5869, device='cuda:0')
benign distance is  tensor(149.5869, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.508580207824707
distance x is tensor(145.6070, device='cuda:0')
benign distance is  tensor(145.6070, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1369948834180832
distance x is tensor(164.1081, device='cuda:0')
benign distance is  tensor(164.1081, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0734950304031372
distance x is tensor(145.3971, device='cuda:0')
benign distance is  tensor(145.3971, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2064088582992554
distance x is tensor(158.9165, device='cuda:0')
benign distance is  tensor(158.9165, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5947291851043701
distance x is tensor(154.9391, device='cuda:0')
benign distance is  tensor(154.9391, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7133265733718872
distance x is tensor(158.7149, device='cuda:0')
benign distance is  tensor(158.7149, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.13649237155914307
distance x is tensor(157.4684, device='cuda:0')
benign distance is  tensor(157.4684, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3538777232170105
distance x is tensor(151.8022, device='cuda:0')
benign distance is  tensor(151.8022, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.48998624086380005
distance x is tensor(159.3555, device='cuda:0')
benign distance is  tensor(159.3555, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6968450546264648
distance x is tensor(146.2126, device='cuda:0')
benign distance is  tensor(146.2126, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.05233532190322876
distance x is tensor(166.7694, device='cuda:0')
benign distance is  tensor(166.7694, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6453264355659485
distance x is tensor(163.5758, device='cuda:0')
benign distance is  tensor(163.5758, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2824620306491852
distance x is tensor(166.1988, device='cuda:0')
benign distance is  tensor(166.1988, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6435616612434387
distance x is tensor(152.2822, device='cuda:0')
benign distance is  tensor(152.2822, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.32830995321273804
distance x is tensor(158.6760, device='cuda:0')
benign distance is  tensor(158.6760, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8045900464057922
distance x is tensor(161.1702, device='cuda:0')
benign distance is  tensor(161.1702, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7616073489189148
distance x is tensor(151.1409, device='cuda:0')
benign distance is  tensor(151.1409, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6384415030479431
distance x is tensor(160.3159, device='cuda:0')
benign distance is  tensor(160.3159, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1925567090511322
distance x is tensor(159.8774, device='cuda:0')
benign distance is  tensor(159.8774, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6609657406806946
distance x is tensor(159.0743, device='cuda:0')
benign distance is  tensor(159.0743, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.27752813696861267
distance x is tensor(162.1990, device='cuda:0')
benign distance is  tensor(162.1990, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.6491748094558716
distance x is tensor(149.2452, device='cuda:0')
benign distance is  tensor(149.2452, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.2673942744731903
distance x is tensor(156.0050, device='cuda:0')
benign distance is  tensor(156.0050, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.40924662351608276
distance x is tensor(161.1667, device='cuda:0')
benign distance is  tensor(161.1667, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.667974591255188
distance x is tensor(155.3530, device='cuda:0')
benign distance is  tensor(155.3530, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5922568440437317
distance x is tensor(163.8707, device='cuda:0')
benign distance is  tensor(163.8707, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.073498249053955
distance x is tensor(156.5656, device='cuda:0')
benign distance is  tensor(156.5656, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.49076828360557556
distance x is tensor(158.3628, device='cuda:0')
benign distance is  tensor(158.3628, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5500000005000001
mal_loss is 4.041324138641357
mal_entropy is 0.38350293040275574
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([725.1426, 656.1903, 635.8754, 593.0694, 593.3572, 681.4566, 625.3367,
        699.2698, 458.6401, 458.6401, 458.6401, 458.6401, 458.6401, 458.6401,
        458.6401, 458.6401, 458.6401, 458.6401, 458.6401, 458.6401],
       device='cuda:0')
sorted_norm is   tensor([458.6401, 458.6401, 458.6401, 458.6401, 458.6401, 458.6401, 458.6401,
        458.6401, 458.6401, 458.6401, 458.6401, 458.6401, 593.0694, 593.3572,
        625.3367, 635.8754, 656.1903, 681.4566, 699.2698, 725.1426],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  3,  4,  6,  2],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 74.76% 

Test Accuracy: 73.62% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0115966796875
distance x is tensor(184.6748, device='cuda:0')
benign distance is  tensor(184.6748, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3663715124130249
distance x is tensor(196.6331, device='cuda:0')
benign distance is  tensor(196.6331, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13264580070972443
distance x is tensor(196.5079, device='cuda:0')
benign distance is  tensor(196.5079, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8021662831306458
distance x is tensor(197.7943, device='cuda:0')
benign distance is  tensor(197.7943, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6958697438240051
distance x is tensor(193.7471, device='cuda:0')
benign distance is  tensor(193.7471, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8822094202041626
distance x is tensor(188.1273, device='cuda:0')
benign distance is  tensor(188.1273, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3983597159385681
distance x is tensor(187.6003, device='cuda:0')
benign distance is  tensor(187.6003, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.39122074842453003
distance x is tensor(203.2848, device='cuda:0')
benign distance is  tensor(203.2848, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 33.4734001159668
mal_entropy is 0.10090050846338272
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([827.6404, 853.7613, 871.7514, 880.3105, 844.5368, 815.4508, 813.7205,
        921.1878, 462.5938, 462.5938, 462.5938, 462.5938, 462.5938, 462.5938,
        462.5938, 462.5938, 462.5938, 462.5938, 462.5938, 462.5938, 803.2405,
        826.4295, 793.9676, 775.7435, 758.3158, 834.1880, 757.9119, 822.3414],
       device='cuda:0')
sorted_norm is   tensor([462.5938, 462.5938, 462.5938, 462.5938, 462.5938, 462.5938, 462.5938,
        462.5938, 462.5938, 462.5938, 462.5938, 462.5938, 757.9119, 758.3158,
        775.7435, 793.9676, 803.2405, 813.7205, 815.4508, 822.3414, 826.4295,
        827.6404, 834.1880, 844.5368, 853.7613, 871.7514, 880.3105, 921.1878],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 26, 24, 23, 22, 20,  6,
         5, 27, 21,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 66.24% 

Test Accuracy: 65.62% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6804682016372681
distance x is tensor(268.4241, device='cuda:0')
benign distance is  tensor(268.4241, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8015696406364441
distance x is tensor(211.3684, device='cuda:0')
benign distance is  tensor(211.3684, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38356587290763855
distance x is tensor(203.9373, device='cuda:0')
benign distance is  tensor(203.9373, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6412796974182129
distance x is tensor(209.8331, device='cuda:0')
benign distance is  tensor(209.8331, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1801860332489014
distance x is tensor(208.4943, device='cuda:0')
benign distance is  tensor(208.4943, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3960305452346802
distance x is tensor(221.3625, device='cuda:0')
benign distance is  tensor(221.3625, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6665579080581665
distance x is tensor(204.4915, device='cuda:0')
benign distance is  tensor(204.4915, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5705522298812866
distance x is tensor(215.1217, device='cuda:0')
benign distance is  tensor(215.1217, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.41971176862716675
distance x is tensor(221.2009, device='cuda:0')
benign distance is  tensor(221.2009, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.20320245623588562
distance x is tensor(206.7727, device='cuda:0')
benign distance is  tensor(206.7727, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4073072373867035
distance x is tensor(207.5531, device='cuda:0')
benign distance is  tensor(207.5531, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4587388038635254
distance x is tensor(225.5993, device='cuda:0')
benign distance is  tensor(225.5993, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.29664772748947144
distance x is tensor(191.1390, device='cuda:0')
benign distance is  tensor(191.1390, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.39562922716140747
distance x is tensor(199.0598, device='cuda:0')
benign distance is  tensor(199.0598, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31928807497024536
distance x is tensor(198.3172, device='cuda:0')
benign distance is  tensor(198.3172, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4271093010902405
distance x is tensor(206.7678, device='cuda:0')
benign distance is  tensor(206.7678, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 61.14287185668945
mal_entropy is 0.03490544483065605
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([1077.4274,  894.2131,  869.7935,  893.9180,  899.8254,  922.8299,
         860.7432,  891.9518,  462.9298,  462.9298,  462.9298,  462.9298,
         462.9298,  462.9298,  462.9298,  462.9298,  462.9298,  462.9298,
         462.9298,  462.9298,  938.5716,  867.2230,  869.5397,  904.1082,
         863.8162,  810.6771,  877.8918,  838.7354,  804.4044,  831.2842,
         825.4374,  810.9318,  833.6877,  789.9830,  856.4678,  842.2067],
       device='cuda:0')
sorted_norm is   tensor([ 462.9298,  462.9298,  462.9298,  462.9298,  462.9298,  462.9298,
         462.9298,  462.9298,  462.9298,  462.9298,  462.9298,  462.9298,
         789.9830,  804.4044,  810.6771,  810.9318,  825.4374,  831.2842,
         833.6877,  838.7354,  842.2067,  856.4678,  860.7432,  863.8162,
         867.2230,  869.5397,  869.7935,  877.8918,  891.9518,  893.9180,
         894.2131,  899.8254,  904.1082,  922.8299,  938.5716, 1077.4274],
       device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33, 28, 25, 31, 30, 29,
        32, 27, 35, 34,  6, 24, 21, 22,  2, 26], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 83.43% 

Test Accuracy: 82.30% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.33754318952560425
distance x is tensor(186.7087, device='cuda:0')
benign distance is  tensor(186.7087, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5393897294998169
distance x is tensor(176.8708, device='cuda:0')
benign distance is  tensor(176.8708, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.545211911201477
distance x is tensor(167.9301, device='cuda:0')
benign distance is  tensor(167.9301, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7590516209602356
distance x is tensor(160.6440, device='cuda:0')
benign distance is  tensor(160.6440, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.485187828540802
distance x is tensor(165.2697, device='cuda:0')
benign distance is  tensor(165.2697, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1883715391159058
distance x is tensor(181.7698, device='cuda:0')
benign distance is  tensor(181.7698, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11449378728866577
distance x is tensor(167.9116, device='cuda:0')
benign distance is  tensor(167.9116, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.49010196328163147
distance x is tensor(170.6734, device='cuda:0')
benign distance is  tensor(170.6734, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2476622313261032
distance x is tensor(169.6607, device='cuda:0')
benign distance is  tensor(169.6607, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6446112394332886
distance x is tensor(183.2294, device='cuda:0')
benign distance is  tensor(183.2294, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7396308183670044
distance x is tensor(166.8178, device='cuda:0')
benign distance is  tensor(166.8178, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3518626093864441
distance x is tensor(173.7966, device='cuda:0')
benign distance is  tensor(173.7966, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.7885258197784424
distance x is tensor(178.9070, device='cuda:0')
benign distance is  tensor(178.9070, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.728790819644928
distance x is tensor(170.4198, device='cuda:0')
benign distance is  tensor(170.4198, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5866690874099731
distance x is tensor(181.3380, device='cuda:0')
benign distance is  tensor(181.3380, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6529582738876343
distance x is tensor(171.3764, device='cuda:0')
benign distance is  tensor(171.3764, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5473619699478149
distance x is tensor(183.9592, device='cuda:0')
benign distance is  tensor(183.9592, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.2849638760089874
distance x is tensor(180.7172, device='cuda:0')
benign distance is  tensor(180.7172, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.44008564949035645
distance x is tensor(178.5981, device='cuda:0')
benign distance is  tensor(178.5981, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.14048627018928528
distance x is tensor(170.8942, device='cuda:0')
benign distance is  tensor(170.8942, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.2031996250152588
distance x is tensor(174.2264, device='cuda:0')
benign distance is  tensor(174.2264, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.45263370871543884
distance x is tensor(161.6139, device='cuda:0')
benign distance is  tensor(161.6139, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0332791805267334
distance x is tensor(169.6727, device='cuda:0')
benign distance is  tensor(169.6727, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6697111129760742
distance x is tensor(165.9232, device='cuda:0')
benign distance is  tensor(165.9232, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 36.087303161621094
mal_entropy is 0.07270898669958115
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([834.3934, 781.2680, 725.4072, 719.5144, 716.6855, 809.0977, 753.2664,
        778.8306, 462.3054, 462.3054, 462.3054, 462.3054, 462.3054, 462.3054,
        462.3054, 462.3054, 462.3054, 462.3054, 462.3054, 462.3054, 825.2586,
        742.9600, 792.9385, 772.5402, 746.0213, 775.8826, 800.7328, 783.9766,
        944.7141, 888.5475, 882.7437, 974.8749, 824.8588, 852.7482, 850.4500,
        860.0673], device='cuda:0')
sorted_norm is   tensor([462.3054, 462.3054, 462.3054, 462.3054, 462.3054, 462.3054, 462.3054,
        462.3054, 462.3054, 462.3054, 462.3054, 462.3054, 716.6855, 719.5144,
        725.4072, 742.9600, 746.0213, 753.2664, 772.5402, 775.8826, 778.8306,
        781.2680, 783.9766, 792.9385, 800.7328, 809.0977, 824.8588, 825.2586,
        834.3934, 850.4500, 852.7482, 860.0673, 882.7437, 888.5475, 944.7141,
        974.8749], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  4,  3,  2, 21, 24,  6,
        23, 25,  7,  1, 27, 22, 26,  5, 32, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 86.33% 

Test Accuracy: 84.93% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5899973511695862
distance x is tensor(173.6564, device='cuda:0')
benign distance is  tensor(173.6564, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8371162414550781
distance x is tensor(158.7647, device='cuda:0')
benign distance is  tensor(158.7647, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4638305604457855
distance x is tensor(173.0166, device='cuda:0')
benign distance is  tensor(173.0166, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.35388636589050293
distance x is tensor(158.6843, device='cuda:0')
benign distance is  tensor(158.6843, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8068008422851562
distance x is tensor(153.1573, device='cuda:0')
benign distance is  tensor(153.1573, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6565393209457397
distance x is tensor(173.7391, device='cuda:0')
benign distance is  tensor(173.7391, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.29763275384902954
distance x is tensor(162.7636, device='cuda:0')
benign distance is  tensor(162.7636, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9720386266708374
distance x is tensor(162.4138, device='cuda:0')
benign distance is  tensor(162.4138, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.38401371240615845
distance x is tensor(168.5459, device='cuda:0')
benign distance is  tensor(168.5459, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2946845293045044
distance x is tensor(173.2106, device='cuda:0')
benign distance is  tensor(173.2106, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4010798931121826
distance x is tensor(170.6157, device='cuda:0')
benign distance is  tensor(170.6157, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4619376063346863
distance x is tensor(180.7182, device='cuda:0')
benign distance is  tensor(180.7182, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8385078310966492
distance x is tensor(162.6168, device='cuda:0')
benign distance is  tensor(162.6168, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5341720581054688
distance x is tensor(177.1093, device='cuda:0')
benign distance is  tensor(177.1093, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5685514211654663
distance x is tensor(175.2031, device='cuda:0')
benign distance is  tensor(175.2031, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5909943580627441
distance x is tensor(170.6503, device='cuda:0')
benign distance is  tensor(170.6503, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.09321526437997818
distance x is tensor(177.2548, device='cuda:0')
benign distance is  tensor(177.2548, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5282557606697083
distance x is tensor(176.8070, device='cuda:0')
benign distance is  tensor(176.8070, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2499474585056305
distance x is tensor(177.0830, device='cuda:0')
benign distance is  tensor(177.0830, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8000444173812866
distance x is tensor(173.5601, device='cuda:0')
benign distance is  tensor(173.5601, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.4507651925086975
distance x is tensor(171.8068, device='cuda:0')
benign distance is  tensor(171.8068, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7809900045394897
distance x is tensor(173.8027, device='cuda:0')
benign distance is  tensor(173.8027, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6246086359024048
distance x is tensor(169.6878, device='cuda:0')
benign distance is  tensor(169.6878, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.753212571144104
distance x is tensor(161.8336, device='cuda:0')
benign distance is  tensor(161.8336, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal_loss is 20.7452335357666
mal_entropy is 0.17421236634254456
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([779.6501, 707.4084, 767.4450, 711.9282, 669.8660, 784.0424, 719.5032,
        731.4531, 462.5752, 462.5752, 462.5752, 462.5752, 462.5752, 462.5752,
        462.5752, 462.5752, 462.5752, 462.5752, 462.5752, 462.5752],
       device='cuda:0')
sorted_norm is   tensor([462.5752, 462.5752, 462.5752, 462.5752, 462.5752, 462.5752, 462.5752,
        462.5752, 462.5752, 462.5752, 462.5752, 462.5752, 669.8660, 707.4084,
        711.9282, 719.5032, 731.4531, 767.4450, 779.6501, 784.0424],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  1,  3,  6],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 39.35% 

Test Accuracy: 38.88% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3577864170074463
distance x is tensor(330.8943, device='cuda:0')
benign distance is  tensor(330.8943, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.127293348312378
distance x is tensor(228.1510, device='cuda:0')
benign distance is  tensor(228.1510, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8413752317428589
distance x is tensor(278.8311, device='cuda:0')
benign distance is  tensor(278.8311, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9415837526321411
distance x is tensor(258.1250, device='cuda:0')
benign distance is  tensor(258.1250, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2813553810119629
distance x is tensor(262.7914, device='cuda:0')
benign distance is  tensor(262.7914, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9696711301803589
distance x is tensor(263.7375, device='cuda:0')
benign distance is  tensor(263.7375, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7310584783554077
distance x is tensor(269.8695, device='cuda:0')
benign distance is  tensor(269.8695, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4800480306148529
distance x is tensor(257.7449, device='cuda:0')
benign distance is  tensor(257.7449, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 123.56581115722656
mal_entropy is 4.5852004859625595e-08
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([1347.1600,  935.2445, 1116.3833, 1038.7142, 1045.7465, 1051.9445,
        1071.1761, 1014.2563,  462.9550,  462.9550,  462.9550,  462.9550,
         462.9550,  462.9550,  462.9550,  462.9550,  462.9550,  462.9550,
         462.9550,  462.9550,  934.4099,  875.9583,  903.1835,  921.6390,
         906.7899,  931.1252,  906.9491,  908.1354,  873.3779,  914.9873,
         861.7576,  888.3464,  899.5220,  885.2193,  913.0223,  862.5187,
         844.2256,  867.7390,  859.5666,  897.0135,  820.2047,  883.7607,
         877.2610,  846.8148], device='cuda:0')
sorted_norm is   tensor([ 462.9550,  462.9550,  462.9550,  462.9550,  462.9550,  462.9550,
         462.9550,  462.9550,  462.9550,  462.9550,  462.9550,  462.9550,
         820.2047,  844.2256,  846.8148,  859.5666,  861.7576,  862.5187,
         867.7390,  873.3779,  875.9583,  877.2610,  883.7607,  885.2193,
         888.3464,  897.0135,  899.5220,  903.1835,  906.7899,  906.9491,
         908.1354,  913.0223,  914.9873,  921.6390,  931.1252,  934.4099,
         935.2445, 1014.2563, 1038.7142, 1045.7465, 1051.9445, 1071.1761,
        1116.3833, 1347.1600], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 40, 36, 43, 38, 30, 35,
        37, 28, 21, 42, 41, 33, 31, 39, 32, 22, 24, 26, 27, 34, 29, 23, 25],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 86.43% 

Test Accuracy: 84.81% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2723580300807953
distance x is tensor(182.7991, device='cuda:0')
benign distance is  tensor(182.7991, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6706116795539856
distance x is tensor(181.9513, device='cuda:0')
benign distance is  tensor(181.9513, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38016754388809204
distance x is tensor(174.1295, device='cuda:0')
benign distance is  tensor(174.1295, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5754016041755676
distance x is tensor(172.0962, device='cuda:0')
benign distance is  tensor(172.0962, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8757478594779968
distance x is tensor(152.9576, device='cuda:0')
benign distance is  tensor(152.9576, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9771448969841003
distance x is tensor(173.1171, device='cuda:0')
benign distance is  tensor(173.1171, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6227412223815918
distance x is tensor(158.3922, device='cuda:0')
benign distance is  tensor(158.3922, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8287471532821655
distance x is tensor(172.0438, device='cuda:0')
benign distance is  tensor(172.0438, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16036513447761536
distance x is tensor(151.6008, device='cuda:0')
benign distance is  tensor(151.6008, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7818092703819275
distance x is tensor(174.9974, device='cuda:0')
benign distance is  tensor(174.9974, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6168330311775208
distance x is tensor(158.5019, device='cuda:0')
benign distance is  tensor(158.5019, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3478875160217285
distance x is tensor(174.2027, device='cuda:0')
benign distance is  tensor(174.2027, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3917173445224762
distance x is tensor(157.1772, device='cuda:0')
benign distance is  tensor(157.1772, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.37367334961891174
distance x is tensor(170.1780, device='cuda:0')
benign distance is  tensor(170.1780, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.641391932964325
distance x is tensor(165.7135, device='cuda:0')
benign distance is  tensor(165.7135, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5332294702529907
distance x is tensor(173.4958, device='cuda:0')
benign distance is  tensor(173.4958, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.35102128982543945
distance x is tensor(158.6122, device='cuda:0')
benign distance is  tensor(158.6122, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.2618127763271332
distance x is tensor(183.2997, device='cuda:0')
benign distance is  tensor(183.2997, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.20390740036964417
distance x is tensor(162.4635, device='cuda:0')
benign distance is  tensor(162.4635, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.09764627367258072
distance x is tensor(164.5199, device='cuda:0')
benign distance is  tensor(164.5199, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8820291757583618
distance x is tensor(185.7055, device='cuda:0')
benign distance is  tensor(185.7055, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9929924011230469
distance x is tensor(158.7359, device='cuda:0')
benign distance is  tensor(158.7359, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.11700433492660522
distance x is tensor(189.7327, device='cuda:0')
benign distance is  tensor(189.7327, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4243242144584656
distance x is tensor(161.6641, device='cuda:0')
benign distance is  tensor(161.6641, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4522377550601959
distance x is tensor(175.7460, device='cuda:0')
benign distance is  tensor(175.7460, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.8763364553451538
distance x is tensor(182.0699, device='cuda:0')
benign distance is  tensor(182.0699, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1701856255531311
distance x is tensor(170.1183, device='cuda:0')
benign distance is  tensor(170.1183, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3274001479148865
distance x is tensor(189.0417, device='cuda:0')
benign distance is  tensor(189.0417, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.32391032576560974
distance x is tensor(168.3480, device='cuda:0')
benign distance is  tensor(168.3480, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3795985281467438
distance x is tensor(178.0697, device='cuda:0')
benign distance is  tensor(178.0697, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.35174375772476196
distance x is tensor(181.4311, device='cuda:0')
benign distance is  tensor(181.4311, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3643413782119751
distance x is tensor(183.4532, device='cuda:0')
benign distance is  tensor(183.4532, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 33.239158630371094
mal_entropy is 0.09946601837873459
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([806.5809, 809.7242, 769.0546, 771.4056, 671.3448, 768.6474, 698.0789,
        777.7499, 462.4811, 462.4811, 462.4811, 462.4811, 462.4811, 462.4811,
        462.4811, 462.4811, 462.4811, 462.4811, 462.4811, 462.4811],
       device='cuda:0')
sorted_norm is   tensor([462.4811, 462.4811, 462.4811, 462.4811, 462.4811, 462.4811, 462.4811,
        462.4811, 462.4811, 462.4811, 462.4811, 462.4811, 671.3448, 698.0789,
        768.6474, 769.0546, 771.4056, 777.7499, 806.5809, 809.7242],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  6,  5,  2],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 35.56% 

Test Accuracy: 35.54% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.40342655777931213
distance x is tensor(330.8941, device='cuda:0')
benign distance is  tensor(330.8941, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8637177348136902
distance x is tensor(259.9552, device='cuda:0')
benign distance is  tensor(259.9552, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14982911944389343
distance x is tensor(277.4242, device='cuda:0')
benign distance is  tensor(277.4242, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6054679155349731
distance x is tensor(265.9310, device='cuda:0')
benign distance is  tensor(265.9310, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.22324684262275696
distance x is tensor(406.9904, device='cuda:0')
benign distance is  tensor(406.9904, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7005384564399719
distance x is tensor(298.7346, device='cuda:0')
benign distance is  tensor(298.7346, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.14738912880420685
distance x is tensor(264.5411, device='cuda:0')
benign distance is  tensor(264.5411, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4239223599433899
distance x is tensor(284.9591, device='cuda:0')
benign distance is  tensor(284.9591, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 125.12199401855469
mal_entropy is 8.727100639371876e-12
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([1319.2568, 1037.5486, 1095.3491, 1037.7130, 1713.9635, 1186.3491,
        1048.0178, 1121.1053,  462.8599,  462.8600,  462.8599,  462.8600,
         462.8599,  462.8600,  462.8599,  462.8600,  462.8599,  462.8600,
         462.8599,  462.8600,  920.1182,  936.4854,  919.2448,  897.0783,
         902.6570,  842.0065,  876.7004,  859.6292,  901.1082,  893.0159,
         913.9365,  891.5683,  889.6815,  899.8622,  879.9494,  856.8616,
         776.9897,  880.0557,  782.3411,  856.6514,  784.0819,  847.6235,
         825.8896,  863.6447], device='cuda:0')
sorted_norm is   tensor([ 462.8599,  462.8599,  462.8599,  462.8599,  462.8599,  462.8599,
         462.8600,  462.8600,  462.8600,  462.8600,  462.8600,  462.8600,
         776.9897,  782.3411,  784.0819,  825.8896,  842.0065,  847.6235,
         856.6514,  856.8616,  859.6292,  863.6447,  876.7004,  879.9494,
         880.0557,  889.6815,  891.5683,  893.0159,  897.0783,  899.8622,
         901.1082,  902.6570,  913.9365,  919.2448,  920.1182,  936.4854,
        1037.5486, 1037.7130, 1048.0178, 1095.3491, 1121.1053, 1186.3491,
        1319.2568, 1713.9635], device='cuda:0')
used idx is  tensor([10,  8, 18, 16, 12, 14, 17, 19, 15, 13,  9, 11, 36, 38, 40, 42, 25, 41,
        39, 35, 27, 43, 26, 34, 37, 32, 31, 29, 23, 33, 28, 24, 30, 22, 20],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 86.28% 

Test Accuracy: 84.78% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2419649362564087
distance x is tensor(166.0937, device='cuda:0')
benign distance is  tensor(166.0937, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.41143664717674255
distance x is tensor(170.6588, device='cuda:0')
benign distance is  tensor(170.6588, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9136701822280884
distance x is tensor(166.6477, device='cuda:0')
benign distance is  tensor(166.6477, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7609012722969055
distance x is tensor(170.4836, device='cuda:0')
benign distance is  tensor(170.4836, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8909802436828613
distance x is tensor(147.6052, device='cuda:0')
benign distance is  tensor(147.6052, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7974416017532349
distance x is tensor(166.0410, device='cuda:0')
benign distance is  tensor(166.0410, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0866663455963135
distance x is tensor(161.2199, device='cuda:0')
benign distance is  tensor(161.2199, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.734171986579895
distance x is tensor(177.2434, device='cuda:0')
benign distance is  tensor(177.2434, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3220665454864502
distance x is tensor(162.0919, device='cuda:0')
benign distance is  tensor(162.0919, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8645223379135132
distance x is tensor(171.1057, device='cuda:0')
benign distance is  tensor(171.1057, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4654425084590912
distance x is tensor(170.4054, device='cuda:0')
benign distance is  tensor(170.4054, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.594085693359375
distance x is tensor(176.2743, device='cuda:0')
benign distance is  tensor(176.2743, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0532171726226807
distance x is tensor(160.2566, device='cuda:0')
benign distance is  tensor(160.2566, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.11292288452386856
distance x is tensor(156.7289, device='cuda:0')
benign distance is  tensor(156.7289, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5350357294082642
distance x is tensor(159.8328, device='cuda:0')
benign distance is  tensor(159.8328, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1939443349838257
distance x is tensor(169.7333, device='cuda:0')
benign distance is  tensor(169.7333, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.47462454438209534
distance x is tensor(169.9990, device='cuda:0')
benign distance is  tensor(169.9990, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3260084390640259
distance x is tensor(165.4151, device='cuda:0')
benign distance is  tensor(165.4151, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.38514336943626404
distance x is tensor(163.8140, device='cuda:0')
benign distance is  tensor(163.8140, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5072389841079712
distance x is tensor(178.5862, device='cuda:0')
benign distance is  tensor(178.5862, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9595853686332703
distance x is tensor(163.3165, device='cuda:0')
benign distance is  tensor(163.3165, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5319050550460815
distance x is tensor(165.3246, device='cuda:0')
benign distance is  tensor(165.3246, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.44085493683815
distance x is tensor(171.8376, device='cuda:0')
benign distance is  tensor(171.8376, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5042457580566406
distance x is tensor(162.4112, device='cuda:0')
benign distance is  tensor(162.4112, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.573771595954895
distance x is tensor(165.3864, device='cuda:0')
benign distance is  tensor(165.3864, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.26238206028938293
distance x is tensor(181.3779, device='cuda:0')
benign distance is  tensor(181.3779, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.3174207210540771
distance x is tensor(161.0262, device='cuda:0')
benign distance is  tensor(161.0262, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.16787374019622803
distance x is tensor(172.4815, device='cuda:0')
benign distance is  tensor(172.4815, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8729537725448608
distance x is tensor(159.0048, device='cuda:0')
benign distance is  tensor(159.0048, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.41063636541366577
distance x is tensor(168.9714, device='cuda:0')
benign distance is  tensor(168.9714, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5938629508018494
distance x is tensor(162.4306, device='cuda:0')
benign distance is  tensor(162.4306, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.17721422016620636
distance x is tensor(168.0331, device='cuda:0')
benign distance is  tensor(168.0331, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 34.882930755615234
mal_entropy is 0.1439751833677292
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([760.4290, 749.6714, 752.9930, 764.7773, 644.8148, 719.1300, 692.7562,
        799.8271, 462.7710, 462.7710, 462.7710, 462.7710, 462.7710, 462.7710,
        462.7710, 462.7710, 462.7710, 462.7710, 462.7710, 462.7710, 708.7106,
        826.8315, 745.4376, 761.3340, 829.8193, 730.2210, 856.1492, 746.0018],
       device='cuda:0')
sorted_norm is   tensor([462.7710, 462.7710, 462.7710, 462.7710, 462.7710, 462.7710, 462.7710,
        462.7710, 462.7710, 462.7710, 462.7710, 462.7710, 644.8148, 692.7562,
        708.7106, 719.1300, 730.2210, 745.4376, 746.0018, 749.6714, 752.9930,
        760.4290, 761.3340, 764.7773, 799.8271, 826.8315, 829.8193, 856.1492],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  6, 20,  5, 25, 22,
        27,  1,  2,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 79.15% 

Test Accuracy: 78.32% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9077755808830261
distance x is tensor(178.7501, device='cuda:0')
benign distance is  tensor(178.7501, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.20905578136444092
distance x is tensor(190.8007, device='cuda:0')
benign distance is  tensor(190.8007, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7048709988594055
distance x is tensor(185.8525, device='cuda:0')
benign distance is  tensor(185.8525, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6611953973770142
distance x is tensor(191.0025, device='cuda:0')
benign distance is  tensor(191.0025, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6295602321624756
distance x is tensor(184.5724, device='cuda:0')
benign distance is  tensor(184.5724, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6984623670578003
distance x is tensor(185.6918, device='cuda:0')
benign distance is  tensor(185.6918, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6092873811721802
distance x is tensor(218.4102, device='cuda:0')
benign distance is  tensor(218.4102, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8102200627326965
distance x is tensor(204.2019, device='cuda:0')
benign distance is  tensor(204.2019, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4759743809700012
distance x is tensor(188.5438, device='cuda:0')
benign distance is  tensor(188.5438, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5881589651107788
distance x is tensor(196.5656, device='cuda:0')
benign distance is  tensor(196.5656, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.29838502407073975
distance x is tensor(187.3519, device='cuda:0')
benign distance is  tensor(187.3519, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4372042119503021
distance x is tensor(194.9939, device='cuda:0')
benign distance is  tensor(194.9939, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4321322441101074
distance x is tensor(212.8012, device='cuda:0')
benign distance is  tensor(212.8012, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.48683279752731323
distance x is tensor(183.6515, device='cuda:0')
benign distance is  tensor(183.6515, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.33576998114585876
distance x is tensor(183.9292, device='cuda:0')
benign distance is  tensor(183.9292, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6485618352890015
distance x is tensor(190.3007, device='cuda:0')
benign distance is  tensor(190.3007, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 70.96614837646484
mal_entropy is 0.024644596502184868
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([791.4280, 802.2387, 797.0256, 825.6387, 794.9837, 818.1214, 879.8077,
        869.7332, 463.1001, 463.1001, 463.1001, 463.1001, 463.1001, 463.1001,
        463.1001, 463.1001, 463.1001, 463.1001, 463.1001, 463.1001, 766.6480,
        797.9514, 772.5417, 840.8049, 741.4297, 722.1059, 753.4656, 781.3240],
       device='cuda:0')
sorted_norm is   tensor([463.1001, 463.1001, 463.1001, 463.1001, 463.1001, 463.1001, 463.1001,
        463.1001, 463.1001, 463.1001, 463.1001, 463.1001, 722.1059, 741.4297,
        753.4656, 766.6480, 772.5417, 781.3240, 791.4280, 794.9837, 797.0256,
        797.9514, 802.2387, 818.1214, 825.6387, 840.8049, 869.7332, 879.8077],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25, 24, 26, 20, 22, 27,
         0,  4,  2, 21], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 79.72% 

Test Accuracy: 78.55% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2743595838546753
distance x is tensor(200.5764, device='cuda:0')
benign distance is  tensor(200.5764, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.1892857849597931
distance x is tensor(209.3867, device='cuda:0')
benign distance is  tensor(209.3867, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20361074805259705
distance x is tensor(177.7565, device='cuda:0')
benign distance is  tensor(177.7565, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8757861256599426
distance x is tensor(202.5804, device='cuda:0')
benign distance is  tensor(202.5804, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2231451272964478
distance x is tensor(188.1211, device='cuda:0')
benign distance is  tensor(188.1211, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5629350543022156
distance x is tensor(200.9025, device='cuda:0')
benign distance is  tensor(200.9025, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5342670679092407
distance x is tensor(194.2481, device='cuda:0')
benign distance is  tensor(194.2481, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7459170818328857
distance x is tensor(189.2549, device='cuda:0')
benign distance is  tensor(189.2549, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2716822624206543
distance x is tensor(193.1675, device='cuda:0')
benign distance is  tensor(193.1675, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.15369100868701935
distance x is tensor(200.9173, device='cuda:0')
benign distance is  tensor(200.9173, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3013056516647339
distance x is tensor(200.2491, device='cuda:0')
benign distance is  tensor(200.2491, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5323712229728699
distance x is tensor(198.3285, device='cuda:0')
benign distance is  tensor(198.3285, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2721021175384521
distance x is tensor(177.5760, device='cuda:0')
benign distance is  tensor(177.5760, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4718717038631439
distance x is tensor(181.8344, device='cuda:0')
benign distance is  tensor(181.8344, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5959120988845825
distance x is tensor(190.8042, device='cuda:0')
benign distance is  tensor(190.8042, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4420296251773834
distance x is tensor(185.8970, device='cuda:0')
benign distance is  tensor(185.8970, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 75.27483367919922
mal_entropy is 0.023724785074591637
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([889.9413, 880.2672, 760.2904, 846.0115, 793.5315, 855.5919, 809.9525,
        818.6187, 462.3531, 462.3531, 462.3531, 462.3531, 462.3531, 462.3531,
        462.3531, 462.3531, 462.3531, 462.3531, 462.3531, 462.3531],
       device='cuda:0')
sorted_norm is   tensor([462.3531, 462.3531, 462.3531, 462.3531, 462.3531, 462.3531, 462.3531,
        462.3531, 462.3531, 462.3531, 462.3531, 462.3531, 760.2904, 793.5315,
        809.9525, 818.6187, 846.0115, 855.5919, 880.2672, 889.9413],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2,  4,  6,  7],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 31.68% 

Test Accuracy: 31.45% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6887640953063965
distance x is tensor(311.7197, device='cuda:0')
benign distance is  tensor(311.7197, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.831758975982666
distance x is tensor(349.6560, device='cuda:0')
benign distance is  tensor(349.6560, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2775452733039856
distance x is tensor(308.2818, device='cuda:0')
benign distance is  tensor(308.2818, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5447031855583191
distance x is tensor(356.5981, device='cuda:0')
benign distance is  tensor(356.5981, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33755671977996826
distance x is tensor(313.5608, device='cuda:0')
benign distance is  tensor(313.5608, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.880529522895813
distance x is tensor(397.9193, device='cuda:0')
benign distance is  tensor(397.9193, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3292536437511444
distance x is tensor(303.1588, device='cuda:0')
benign distance is  tensor(303.1588, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6667352914810181
distance x is tensor(417.3180, device='cuda:0')
benign distance is  tensor(417.3180, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 199.3865966796875
mal_entropy is 2.905305440670247e-10
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1217.8971, 1380.8256, 1184.4573, 1369.9094, 1229.3096, 1546.7211,
        1187.6337, 1651.9635,  462.7328,  462.7328,  462.7328,  462.7328,
         462.7328,  462.7328,  462.7328,  462.7328,  462.7328,  462.7328,
         462.7328,  462.7328,  994.1939, 1028.8153,  994.5101, 1061.4642,
         986.3252, 1007.1036, 1031.0739, 1027.6003,  942.1030,  930.3138,
         914.3461,  985.9235,  914.0391,  935.7079,  951.5953,  908.3388,
         914.5756,  970.4995,  964.7170,  992.0031, 1011.9701,  919.6259,
         924.3500,  937.8052,  915.3710,  935.3987,  914.0081,  916.3506,
         862.4016,  868.0440,  915.2264,  871.0550], device='cuda:0')
sorted_norm is   tensor([ 462.7328,  462.7328,  462.7328,  462.7328,  462.7328,  462.7328,
         462.7328,  462.7328,  462.7328,  462.7328,  462.7328,  462.7328,
         862.4016,  868.0440,  871.0550,  908.3388,  914.0081,  914.0391,
         914.3461,  914.5756,  915.2264,  915.3710,  916.3506,  919.6259,
         924.3500,  930.3138,  935.3987,  935.7079,  937.8052,  942.1030,
         951.5953,  964.7170,  970.4995,  985.9235,  986.3252,  992.0031,
         994.1939,  994.5101, 1007.1036, 1011.9701, 1027.6003, 1028.8153,
        1031.0739, 1061.4642, 1184.4573, 1187.6337, 1217.8971, 1229.3096,
        1369.9094, 1380.8256, 1546.7211, 1651.9635], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 48, 49, 51, 35, 46, 32,
        30, 36, 50, 44, 47, 41, 42, 29, 45, 33, 43, 28, 34, 38, 37, 31, 24, 39,
        20, 22, 25, 40, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 87.68% 

Test Accuracy: 86.24% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9488495588302612
distance x is tensor(156.6262, device='cuda:0')
benign distance is  tensor(156.6262, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3465549349784851
distance x is tensor(158.5518, device='cuda:0')
benign distance is  tensor(158.5518, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6001942753791809
distance x is tensor(159.8312, device='cuda:0')
benign distance is  tensor(159.8312, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9041314125061035
distance x is tensor(148.8342, device='cuda:0')
benign distance is  tensor(148.8342, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7660223841667175
distance x is tensor(152.9866, device='cuda:0')
benign distance is  tensor(152.9866, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.27540668845176697
distance x is tensor(156.2637, device='cuda:0')
benign distance is  tensor(156.2637, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39826500415802
distance x is tensor(144.3497, device='cuda:0')
benign distance is  tensor(144.3497, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9698693156242371
distance x is tensor(161.5801, device='cuda:0')
benign distance is  tensor(161.5801, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.754306435585022
distance x is tensor(160.6633, device='cuda:0')
benign distance is  tensor(160.6633, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5338289141654968
distance x is tensor(179.3335, device='cuda:0')
benign distance is  tensor(179.3335, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9025947451591492
distance x is tensor(155.5201, device='cuda:0')
benign distance is  tensor(155.5201, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.46324554085731506
distance x is tensor(156.7975, device='cuda:0')
benign distance is  tensor(156.7975, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.46259957551956177
distance x is tensor(142.5644, device='cuda:0')
benign distance is  tensor(142.5644, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.20626041293144226
distance x is tensor(159.4670, device='cuda:0')
benign distance is  tensor(159.4670, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.28123706579208374
distance x is tensor(147.3317, device='cuda:0')
benign distance is  tensor(147.3317, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0433437824249268
distance x is tensor(171.7430, device='cuda:0')
benign distance is  tensor(171.7430, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.23080697655677795
distance x is tensor(157.5884, device='cuda:0')
benign distance is  tensor(157.5884, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.026595950126648
distance x is tensor(166.9831, device='cuda:0')
benign distance is  tensor(166.9831, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5693677067756653
distance x is tensor(174.0844, device='cuda:0')
benign distance is  tensor(174.0844, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3715146481990814
distance x is tensor(161.0675, device='cuda:0')
benign distance is  tensor(161.0675, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4029329717159271
distance x is tensor(161.3066, device='cuda:0')
benign distance is  tensor(161.3066, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6651484370231628
distance x is tensor(163.6503, device='cuda:0')
benign distance is  tensor(163.6503, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.7401998043060303
distance x is tensor(222.7461, device='cuda:0')
benign distance is  tensor(222.7461, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.26508742570877075
distance x is tensor(162.0342, device='cuda:0')
benign distance is  tensor(162.0342, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4015374183654785
distance x is tensor(188.9966, device='cuda:0')
benign distance is  tensor(188.9966, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.051592469215393
distance x is tensor(151.7174, device='cuda:0')
benign distance is  tensor(151.7174, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.31411057710647583
distance x is tensor(164.5984, device='cuda:0')
benign distance is  tensor(164.5984, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3145376741886139
distance x is tensor(158.9195, device='cuda:0')
benign distance is  tensor(158.9195, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8239482641220093
distance x is tensor(165.3612, device='cuda:0')
benign distance is  tensor(165.3612, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4616416096687317
distance x is tensor(161.5340, device='cuda:0')
benign distance is  tensor(161.5340, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6174443960189819
distance x is tensor(156.5735, device='cuda:0')
benign distance is  tensor(156.5735, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.13180169463157654
distance x is tensor(159.2591, device='cuda:0')
benign distance is  tensor(159.2591, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3134663701057434
distance x is tensor(161.5700, device='cuda:0')
benign distance is  tensor(161.5700, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4781703054904938
distance x is tensor(165.4675, device='cuda:0')
benign distance is  tensor(165.4675, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1890363097190857
distance x is tensor(171.7008, device='cuda:0')
benign distance is  tensor(171.7008, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4133833944797516
distance x is tensor(171.8977, device='cuda:0')
benign distance is  tensor(171.8977, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.22492673993110657
distance x is tensor(153.5792, device='cuda:0')
benign distance is  tensor(153.5792, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.29047659039497375
distance x is tensor(160.3984, device='cuda:0')
benign distance is  tensor(160.3984, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8302041292190552
distance x is tensor(163.0392, device='cuda:0')
benign distance is  tensor(163.0392, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.46828189492225647
distance x is tensor(161.4657, device='cuda:0')
benign distance is  tensor(161.4657, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal_loss is 5.688841819763184
mal_entropy is 0.2663862407207489
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([694.0494, 707.9449, 725.9131, 671.1943, 691.0809, 690.5188, 655.7139,
        715.0027, 450.6266, 450.6266, 450.6266, 450.6266, 450.6266, 450.6266,
        450.6266, 450.6266, 450.6266, 450.6266, 450.6266, 450.6266, 763.9063,
        805.8800, 755.2796, 798.8973, 770.3361, 775.7449, 748.5413, 781.2163],
       device='cuda:0')
sorted_norm is   tensor([450.6266, 450.6266, 450.6266, 450.6266, 450.6266, 450.6266, 450.6266,
        450.6266, 450.6266, 450.6266, 450.6266, 450.6266, 655.7139, 671.1943,
        690.5188, 691.0809, 694.0494, 707.9449, 715.0027, 725.9131, 748.5413,
        755.2796, 763.9063, 770.3361, 775.7449, 781.2163, 798.8973, 805.8800],
       device='cuda:0')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10,  6,  3,  5,  4,  0,  1,
         7,  2, 26, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 86.28% 

Test Accuracy: 84.49% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6255155801773071
distance x is tensor(165.1092, device='cuda:0')
benign distance is  tensor(165.1092, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5805600881576538
distance x is tensor(187.3515, device='cuda:0')
benign distance is  tensor(187.3515, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4999043941497803
distance x is tensor(175.8020, device='cuda:0')
benign distance is  tensor(175.8020, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7827142477035522
distance x is tensor(178.4124, device='cuda:0')
benign distance is  tensor(178.4124, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2067878246307373
distance x is tensor(188.4782, device='cuda:0')
benign distance is  tensor(188.4782, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0888022184371948
distance x is tensor(175.3126, device='cuda:0')
benign distance is  tensor(175.3126, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.30443376302719116
distance x is tensor(183.1346, device='cuda:0')
benign distance is  tensor(183.1346, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4072485864162445
distance x is tensor(176.8371, device='cuda:0')
benign distance is  tensor(176.8371, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6178092956542969
distance x is tensor(182.2331, device='cuda:0')
benign distance is  tensor(182.2331, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.08759594708681107
distance x is tensor(188.7861, device='cuda:0')
benign distance is  tensor(188.7861, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4663020968437195
distance x is tensor(177.2493, device='cuda:0')
benign distance is  tensor(177.2493, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.12149771302938461
distance x is tensor(183.4348, device='cuda:0')
benign distance is  tensor(183.4348, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.35046201944351196
distance x is tensor(164.2213, device='cuda:0')
benign distance is  tensor(164.2213, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.1895250380039215
distance x is tensor(166.8241, device='cuda:0')
benign distance is  tensor(166.8241, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3399181663990021
distance x is tensor(166.2825, device='cuda:0')
benign distance is  tensor(166.2825, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7485461831092834
distance x is tensor(190.4081, device='cuda:0')
benign distance is  tensor(190.4081, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 16.57881736755371
mal_entropy is 0.191538006067276
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([734.5507, 832.9445, 787.0231, 803.9983, 822.4168, 769.5010, 795.9515,
        784.9180, 456.8530, 456.8530, 456.8530, 456.8530, 456.8530, 456.8530,
        456.8530, 456.8530, 456.8530, 456.8530, 456.8530, 456.8530, 776.4655,
        850.1033, 723.3990, 742.7474, 690.0567, 761.6068, 705.9589, 811.6468],
       device='cuda:0')
sorted_norm is   tensor([456.8530, 456.8530, 456.8530, 456.8530, 456.8530, 456.8530, 456.8530,
        456.8530, 456.8530, 456.8530, 456.8530, 456.8530, 690.0567, 705.9589,
        723.3990, 734.5507, 742.7474, 761.6068, 769.5010, 776.4655, 784.9180,
        787.0231, 795.9515, 803.9983, 811.6468, 822.4168, 832.9445, 850.1033],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 24, 26, 22,  0, 23, 25,
         5, 20,  7,  2], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 84.70% 

Test Accuracy: 83.01% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7988868951797485
distance x is tensor(206.5321, device='cuda:0')
benign distance is  tensor(206.5321, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.24666568636894226
distance x is tensor(169.6162, device='cuda:0')
benign distance is  tensor(169.6162, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11260209232568741
distance x is tensor(179.2434, device='cuda:0')
benign distance is  tensor(179.2434, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7118930220603943
distance x is tensor(198.9266, device='cuda:0')
benign distance is  tensor(198.9266, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.806780219078064
distance x is tensor(184.8537, device='cuda:0')
benign distance is  tensor(184.8537, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7249279022216797
distance x is tensor(188.7718, device='cuda:0')
benign distance is  tensor(188.7718, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31393519043922424
distance x is tensor(180.0010, device='cuda:0')
benign distance is  tensor(180.0010, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7200478315353394
distance x is tensor(197.0709, device='cuda:0')
benign distance is  tensor(197.0709, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1952499896287918
distance x is tensor(193.2063, device='cuda:0')
benign distance is  tensor(193.2063, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.791253387928009
distance x is tensor(192.8529, device='cuda:0')
benign distance is  tensor(192.8529, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8704319000244141
distance x is tensor(186.6992, device='cuda:0')
benign distance is  tensor(186.6992, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8309329748153687
distance x is tensor(201.4328, device='cuda:0')
benign distance is  tensor(201.4328, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6047948598861694
distance x is tensor(183.8958, device='cuda:0')
benign distance is  tensor(183.8958, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4677439332008362
distance x is tensor(178.5635, device='cuda:0')
benign distance is  tensor(178.5635, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6323189735412598
distance x is tensor(183.5156, device='cuda:0')
benign distance is  tensor(183.5156, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8472638130187988
distance x is tensor(205.5854, device='cuda:0')
benign distance is  tensor(205.5854, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 45.174381256103516
mal_entropy is 0.014971601776778698
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([903.0579, 749.6253, 792.0082, 874.2421, 793.0144, 814.1729, 782.9883,
        857.2297, 460.2638, 460.2638, 460.2638, 460.2638, 460.2638, 460.2638,
        460.2638, 460.2638, 460.2638, 460.2638, 460.2638, 460.2638, 775.3833,
        815.5490, 856.2277, 789.4036, 792.8166, 818.1388, 956.7943, 804.5455],
       device='cuda:0')
sorted_norm is   tensor([460.2638, 460.2638, 460.2638, 460.2638, 460.2638, 460.2638, 460.2638,
        460.2638, 460.2638, 460.2638, 460.2638, 460.2638, 749.6253, 775.3833,
        782.9883, 789.4036, 792.0082, 792.8166, 793.0144, 804.5455, 814.1729,
        815.5490, 818.1388, 856.2277, 857.2297, 874.2421, 903.0579, 956.7943],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  1, 20,  6, 23,  2, 24,
         4, 27,  5, 21], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 82.30% 

Test Accuracy: 80.91% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.771408200263977
distance x is tensor(206.8210, device='cuda:0')
benign distance is  tensor(206.8210, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7393938302993774
distance x is tensor(196.7525, device='cuda:0')
benign distance is  tensor(196.7525, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.026876959949731827
distance x is tensor(173.1231, device='cuda:0')
benign distance is  tensor(173.1231, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8790504336357117
distance x is tensor(217.8018, device='cuda:0')
benign distance is  tensor(217.8018, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9522302746772766
distance x is tensor(199.0898, device='cuda:0')
benign distance is  tensor(199.0898, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8238741755485535
distance x is tensor(187.7289, device='cuda:0')
benign distance is  tensor(187.7289, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.37971916794776917
distance x is tensor(189.7061, device='cuda:0')
benign distance is  tensor(189.7061, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3237718939781189
distance x is tensor(195.8447, device='cuda:0')
benign distance is  tensor(195.8447, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.32034921646118164
distance x is tensor(190.4669, device='cuda:0')
benign distance is  tensor(190.4669, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8712155222892761
distance x is tensor(193.4638, device='cuda:0')
benign distance is  tensor(193.4638, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3524944484233856
distance x is tensor(203.8329, device='cuda:0')
benign distance is  tensor(203.8329, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.28437119722366333
distance x is tensor(196.5773, device='cuda:0')
benign distance is  tensor(196.5773, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3907453715801239
distance x is tensor(214.5517, device='cuda:0')
benign distance is  tensor(214.5517, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9829989671707153
distance x is tensor(183.6507, device='cuda:0')
benign distance is  tensor(183.6507, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2627137005329132
distance x is tensor(212.4035, device='cuda:0')
benign distance is  tensor(212.4035, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7402364611625671
distance x is tensor(191.5401, device='cuda:0')
benign distance is  tensor(191.5401, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 59.5682258605957
mal_entropy is 0.08836351335048676
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([895.2677, 841.5897, 756.4683, 941.8152, 836.2243, 800.6667, 823.0597,
        819.8610, 461.7236, 461.7236, 461.7236, 461.7236, 461.7236, 461.7236,
        461.7236, 461.7236, 461.7236, 461.7236, 461.7236, 461.7236, 920.6871,
        779.9357, 836.9485, 813.5724, 844.8246, 824.1274, 806.1498, 817.4928,
        880.0713, 862.4880, 821.1911, 914.7031, 814.5415, 806.7089, 829.1447,
        895.4379], device='cuda:0')
sorted_norm is   tensor([461.7236, 461.7236, 461.7236, 461.7236, 461.7236, 461.7236, 461.7236,
        461.7236, 461.7236, 461.7236, 461.7236, 461.7236, 756.4683, 779.9357,
        800.6667, 806.1498, 806.7089, 813.5724, 814.5415, 817.4928, 819.8610,
        821.1911, 823.0597, 824.1274, 829.1447, 836.2243, 836.9485, 841.5897,
        844.8246, 862.4880, 880.0713, 895.2677, 895.4379, 914.7031, 920.6871,
        941.8152], device='cuda:0')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10,  2, 21,  5, 26, 33, 23,
        32, 27,  7, 30,  6, 25, 34,  4, 22,  1], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 86.48% 

Test Accuracy: 84.74% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2590725421905518
distance x is tensor(181.4914, device='cuda:0')
benign distance is  tensor(181.4914, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2967141568660736
distance x is tensor(172.9495, device='cuda:0')
benign distance is  tensor(172.9495, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3383615016937256
distance x is tensor(166.6024, device='cuda:0')
benign distance is  tensor(166.6024, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5244587063789368
distance x is tensor(171.6060, device='cuda:0')
benign distance is  tensor(171.6060, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8609648942947388
distance x is tensor(176.9968, device='cuda:0')
benign distance is  tensor(176.9968, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.995143711566925
distance x is tensor(169.4807, device='cuda:0')
benign distance is  tensor(169.4807, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2119443416595459
distance x is tensor(185.8382, device='cuda:0')
benign distance is  tensor(185.8382, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.33607691526412964
distance x is tensor(181.1356, device='cuda:0')
benign distance is  tensor(181.1356, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4715953469276428
distance x is tensor(192.8972, device='cuda:0')
benign distance is  tensor(192.8972, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9868665933609009
distance x is tensor(172.5778, device='cuda:0')
benign distance is  tensor(172.5778, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9580413699150085
distance x is tensor(170.2680, device='cuda:0')
benign distance is  tensor(170.2680, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4380224645137787
distance x is tensor(174.8617, device='cuda:0')
benign distance is  tensor(174.8617, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3677917420864105
distance x is tensor(169.8457, device='cuda:0')
benign distance is  tensor(169.8457, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.40739768743515015
distance x is tensor(175.6709, device='cuda:0')
benign distance is  tensor(175.6709, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5385193824768066
distance x is tensor(175.0533, device='cuda:0')
benign distance is  tensor(175.0533, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3827507793903351
distance x is tensor(178.6430, device='cuda:0')
benign distance is  tensor(178.6430, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.7514172792434692
distance x is tensor(178.5272, device='cuda:0')
benign distance is  tensor(178.5272, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.39101478457450867
distance x is tensor(169.8550, device='cuda:0')
benign distance is  tensor(169.8550, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4623018801212311
distance x is tensor(190.3817, device='cuda:0')
benign distance is  tensor(190.3817, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5666829347610474
distance x is tensor(184.1904, device='cuda:0')
benign distance is  tensor(184.1904, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0566469430923462
distance x is tensor(176.1409, device='cuda:0')
benign distance is  tensor(176.1409, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5541271567344666
distance x is tensor(167.4061, device='cuda:0')
benign distance is  tensor(167.4061, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5321148037910461
distance x is tensor(177.5448, device='cuda:0')
benign distance is  tensor(177.5448, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3520999848842621
distance x is tensor(184.3244, device='cuda:0')
benign distance is  tensor(184.3244, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 21.49452018737793
mal_entropy is 0.17610011994838715
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([798.6001, 774.5053, 717.0244, 758.6325, 765.7487, 739.5244, 769.8030,
        764.8869, 460.6543, 460.6543, 460.6543, 460.6543, 460.6543, 460.6543,
        460.6543, 460.6543, 460.6543, 460.6543, 460.6543, 460.6543],
       device='cuda:0')
sorted_norm is   tensor([460.6543, 460.6543, 460.6543, 460.6543, 460.6543, 460.6543, 460.6543,
        460.6543, 460.6543, 460.6543, 460.6543, 460.6543, 717.0244, 739.5244,
        758.6325, 764.8869, 765.7487, 769.8030, 774.5053, 798.6001],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2,  5,  3,  7],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 63.48% 

Test Accuracy: 62.62% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.41426849365234375
distance x is tensor(289.6328, device='cuda:0')
benign distance is  tensor(289.6328, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.28335708379745483
distance x is tensor(274.5856, device='cuda:0')
benign distance is  tensor(274.5856, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5527613162994385
distance x is tensor(237.3996, device='cuda:0')
benign distance is  tensor(237.3996, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7505558133125305
distance x is tensor(238.5291, device='cuda:0')
benign distance is  tensor(238.5291, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7957742810249329
distance x is tensor(234.6468, device='cuda:0')
benign distance is  tensor(234.6468, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3260953426361084
distance x is tensor(248.9665, device='cuda:0')
benign distance is  tensor(248.9665, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.85674649477005
distance x is tensor(245.9899, device='cuda:0')
benign distance is  tensor(245.9899, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5094922184944153
distance x is tensor(245.7608, device='cuda:0')
benign distance is  tensor(245.7608, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 110.32167053222656
mal_entropy is 0.022564919665455818
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1113.6434, 1090.3353,  959.0527,  960.0758,  950.8598,  986.6491,
         978.4230, 1006.0086,  460.9525,  460.9525,  460.9525,  460.9525,
         460.9525,  460.9525,  460.9525,  460.9525,  460.9525,  460.9525,
         460.9525,  460.9525,  923.8187,  948.9695,  978.0207,  989.9066,
         922.7768,  923.9857,  936.5444,  944.3895,  985.3286,  999.9702,
         969.1824,  941.9735,  907.8513,  907.6731,  915.5286,  991.6065,
         890.9581,  922.9479,  960.4278,  960.9276, 1001.8527,  889.3068,
         988.1722,  933.6629,  917.3159,  831.3456,  820.8700,  862.1755,
         827.8652,  847.2722,  865.7844,  864.5812], device='cuda:0')
sorted_norm is   tensor([ 460.9525,  460.9525,  460.9525,  460.9525,  460.9525,  460.9525,
         460.9525,  460.9525,  460.9525,  460.9525,  460.9525,  460.9525,
         820.8700,  827.8652,  831.3456,  847.2722,  862.1755,  864.5812,
         865.7844,  889.3068,  890.9581,  907.6731,  907.8513,  915.5286,
         917.3159,  922.7768,  922.9479,  923.8187,  923.9857,  933.6629,
         936.5444,  941.9735,  944.3895,  948.9695,  950.8598,  959.0527,
         960.0758,  960.4278,  960.9276,  969.1824,  978.0207,  978.4230,
         985.3286,  986.6491,  988.1722,  989.9066,  991.6065,  999.9702,
        1001.8527, 1006.0086, 1090.3353, 1113.6434], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 46, 48, 45, 49, 47, 51,
        50, 41, 36, 33, 32, 34, 44, 24, 37, 20, 25, 43, 26, 31, 27, 21,  4,  2,
         3, 38, 39, 30, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 87.87% 

Test Accuracy: 86.36% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6749552488327026
distance x is tensor(163.4773, device='cuda:0')
benign distance is  tensor(163.4773, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5642532110214233
distance x is tensor(155.9708, device='cuda:0')
benign distance is  tensor(155.9708, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23418104648590088
distance x is tensor(144.9892, device='cuda:0')
benign distance is  tensor(144.9892, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7426797151565552
distance x is tensor(164.4898, device='cuda:0')
benign distance is  tensor(164.4898, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6164324879646301
distance x is tensor(166.5092, device='cuda:0')
benign distance is  tensor(166.5092, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4350654184818268
distance x is tensor(155.9785, device='cuda:0')
benign distance is  tensor(155.9785, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4827439785003662
distance x is tensor(159.4823, device='cuda:0')
benign distance is  tensor(159.4823, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6475968956947327
distance x is tensor(168.0284, device='cuda:0')
benign distance is  tensor(168.0284, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4551475942134857
distance x is tensor(165.8763, device='cuda:0')
benign distance is  tensor(165.8763, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7791882753372192
distance x is tensor(167.1350, device='cuda:0')
benign distance is  tensor(167.1350, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8702917098999023
distance x is tensor(168.0103, device='cuda:0')
benign distance is  tensor(168.0103, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5683025121688843
distance x is tensor(163.0033, device='cuda:0')
benign distance is  tensor(163.0033, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.45296788215637207
distance x is tensor(154.8336, device='cuda:0')
benign distance is  tensor(154.8336, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2148827314376831
distance x is tensor(152.2006, device='cuda:0')
benign distance is  tensor(152.2006, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6083277463912964
distance x is tensor(152.1312, device='cuda:0')
benign distance is  tensor(152.1312, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7022165060043335
distance x is tensor(167.3443, device='cuda:0')
benign distance is  tensor(167.3443, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.40527454018592834
distance x is tensor(147.8541, device='cuda:0')
benign distance is  tensor(147.8541, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5748680830001831
distance x is tensor(168.3357, device='cuda:0')
benign distance is  tensor(168.3357, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5383477807044983
distance x is tensor(161.3926, device='cuda:0')
benign distance is  tensor(161.3926, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5607746243476868
distance x is tensor(156.7043, device='cuda:0')
benign distance is  tensor(156.7043, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2989628314971924
distance x is tensor(161.6898, device='cuda:0')
benign distance is  tensor(161.6898, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.651776134967804
distance x is tensor(162.3648, device='cuda:0')
benign distance is  tensor(162.3648, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.09420569241046906
distance x is tensor(166.8217, device='cuda:0')
benign distance is  tensor(166.8217, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5866307020187378
distance x is tensor(156.3936, device='cuda:0')
benign distance is  tensor(156.3936, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5546389818191528
distance x is tensor(167.6574, device='cuda:0')
benign distance is  tensor(167.6574, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.15649709105491638
distance x is tensor(162.9089, device='cuda:0')
benign distance is  tensor(162.9089, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.2275025844573975
distance x is tensor(173.5049, device='cuda:0')
benign distance is  tensor(173.5049, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.5506030917167664
distance x is tensor(166.8566, device='cuda:0')
benign distance is  tensor(166.8566, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6473353505134583
distance x is tensor(153.5472, device='cuda:0')
benign distance is  tensor(153.5472, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.41882458329200745
distance x is tensor(170.0819, device='cuda:0')
benign distance is  tensor(170.0819, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3645615875720978
distance x is tensor(160.0860, device='cuda:0')
benign distance is  tensor(160.0860, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.22624024748802185
distance x is tensor(147.7591, device='cuda:0')
benign distance is  tensor(147.7591, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.35335981845855713
distance x is tensor(157.7574, device='cuda:0')
benign distance is  tensor(157.7574, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.16593219339847565
distance x is tensor(168.4001, device='cuda:0')
benign distance is  tensor(168.4001, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.7596470713615417
distance x is tensor(154.7236, device='cuda:0')
benign distance is  tensor(154.7236, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.7361710667610168
distance x is tensor(174.9913, device='cuda:0')
benign distance is  tensor(174.9913, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3890492022037506
distance x is tensor(157.1190, device='cuda:0')
benign distance is  tensor(157.1190, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5459816455841064
distance x is tensor(154.1355, device='cuda:0')
benign distance is  tensor(154.1355, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.45843377709388733
distance x is tensor(161.5753, device='cuda:0')
benign distance is  tensor(161.5753, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4396752417087555
distance x is tensor(153.2260, device='cuda:0')
benign distance is  tensor(153.2260, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.6500000005000001
mal_loss is 2.7324891090393066
mal_entropy is 0.1976054310798645
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([734.2009, 704.6717, 634.2831, 732.1747, 736.6106, 692.1917, 694.5048,
        737.1589, 448.8065, 448.8065, 448.8065, 448.8065, 448.8065, 448.8065,
        448.8065, 448.8065, 448.8065, 448.8065, 448.8065, 448.8065],
       device='cuda:0')
sorted_norm is   tensor([448.8065, 448.8065, 448.8065, 448.8065, 448.8065, 448.8065, 448.8065,
        448.8065, 448.8065, 448.8065, 448.8065, 448.8065, 634.2831, 692.1917,
        694.5048, 704.6717, 732.1747, 734.2009, 736.6106, 737.1589],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2,  5,  6,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 83.25% 

Test Accuracy: 81.81% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6489051580429077
distance x is tensor(205.0224, device='cuda:0')
benign distance is  tensor(205.0224, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.1349562108516693
distance x is tensor(206.2184, device='cuda:0')
benign distance is  tensor(206.2184, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.33427590131759644
distance x is tensor(189.2250, device='cuda:0')
benign distance is  tensor(189.2250, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3887255787849426
distance x is tensor(193.0869, device='cuda:0')
benign distance is  tensor(193.0869, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.313141405582428
distance x is tensor(217.8147, device='cuda:0')
benign distance is  tensor(217.8147, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.22439619898796082
distance x is tensor(194.3335, device='cuda:0')
benign distance is  tensor(194.3335, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7819455862045288
distance x is tensor(230.8289, device='cuda:0')
benign distance is  tensor(230.8289, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37115103006362915
distance x is tensor(196.1253, device='cuda:0')
benign distance is  tensor(196.1253, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 41.73816680908203
mal_entropy is 0.021291395649313927
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 891.3121,  894.6635,  781.9943,  825.6218,  932.4399,  814.0191,
        1055.9813,  865.6426,  461.4439,  461.4439,  461.4439,  461.4439,
         461.4439,  461.4439,  461.4439,  461.4439,  461.4439,  461.4439,
         461.4439,  461.4439,  864.8027,  843.1087,  931.8718,  884.6173,
         857.9407,  855.6951,  872.5164,  908.4247,  816.4192,  846.2116,
         826.2000,  818.9258,  781.4238,  773.5264,  769.2664,  816.0237],
       device='cuda:0')
sorted_norm is   tensor([ 461.4439,  461.4439,  461.4439,  461.4439,  461.4439,  461.4439,
         461.4439,  461.4439,  461.4439,  461.4439,  461.4439,  461.4439,
         769.2664,  773.5264,  781.4238,  781.9943,  814.0191,  816.0237,
         816.4192,  818.9258,  825.6218,  826.2000,  843.1087,  846.2116,
         855.6951,  857.9407,  864.8027,  865.6426,  872.5164,  884.6173,
         891.3121,  894.6635,  908.4247,  931.8718,  932.4399, 1055.9813],
       device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 34, 33, 32,  2,  5, 35,
        28, 31,  3, 30, 21, 29, 25, 24, 20,  7], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 86.44% 

Test Accuracy: 84.73% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8396100997924805
distance x is tensor(176.8465, device='cuda:0')
benign distance is  tensor(176.8465, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8126935958862305
distance x is tensor(174.7697, device='cuda:0')
benign distance is  tensor(174.7697, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11746479570865631
distance x is tensor(176.4870, device='cuda:0')
benign distance is  tensor(176.4870, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5133956670761108
distance x is tensor(184.9449, device='cuda:0')
benign distance is  tensor(184.9449, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.36811554431915283
distance x is tensor(187.5893, device='cuda:0')
benign distance is  tensor(187.5893, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9548953175544739
distance x is tensor(176.8540, device='cuda:0')
benign distance is  tensor(176.8540, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3726741373538971
distance x is tensor(170.5989, device='cuda:0')
benign distance is  tensor(170.5989, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.42477139830589294
distance x is tensor(197.9807, device='cuda:0')
benign distance is  tensor(197.9807, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5034545660018921
distance x is tensor(185.2952, device='cuda:0')
benign distance is  tensor(185.2952, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6407424807548523
distance x is tensor(176.2243, device='cuda:0')
benign distance is  tensor(176.2243, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.39065203070640564
distance x is tensor(185.2895, device='cuda:0')
benign distance is  tensor(185.2895, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6074260473251343
distance x is tensor(176.4221, device='cuda:0')
benign distance is  tensor(176.4221, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6992068886756897
distance x is tensor(183.3136, device='cuda:0')
benign distance is  tensor(183.3136, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.44458118081092834
distance x is tensor(174.3996, device='cuda:0')
benign distance is  tensor(174.3996, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6092628836631775
distance x is tensor(169.0425, device='cuda:0')
benign distance is  tensor(169.0425, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.675245463848114
distance x is tensor(188.9380, device='cuda:0')
benign distance is  tensor(188.9380, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.07792286574840546
distance x is tensor(176.2704, device='cuda:0')
benign distance is  tensor(176.2704, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5735722184181213
distance x is tensor(181.8915, device='cuda:0')
benign distance is  tensor(181.8915, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6131851673126221
distance x is tensor(199.9928, device='cuda:0')
benign distance is  tensor(199.9928, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.42448902130126953
distance x is tensor(189.8818, device='cuda:0')
benign distance is  tensor(189.8818, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.892210841178894
distance x is tensor(158.0476, device='cuda:0')
benign distance is  tensor(158.0476, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.23846301436424255
distance x is tensor(178.1207, device='cuda:0')
benign distance is  tensor(178.1207, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.20581495761871338
distance x is tensor(182.0190, device='cuda:0')
benign distance is  tensor(182.0190, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.65203857421875
distance x is tensor(180.5287, device='cuda:0')
benign distance is  tensor(180.5287, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal_loss is 31.715444564819336
mal_entropy is 0.05908043310046196
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([765.8491, 758.2189, 753.1382, 807.4788, 817.9877, 779.4036, 728.2363,
        855.0084, 461.5007, 461.5006, 461.5007, 461.5006, 461.5007, 461.5006,
        461.5007, 461.5006, 461.5007, 461.5006, 461.5007, 461.5006, 715.9464,
        809.6479, 785.4980, 770.9339, 780.8214, 789.1124, 801.7900, 747.5180],
       device='cuda:0')
sorted_norm is   tensor([461.5006, 461.5006, 461.5006, 461.5006, 461.5006, 461.5006, 461.5007,
        461.5007, 461.5007, 461.5007, 461.5007, 461.5007, 715.9464, 728.2363,
        747.5180, 753.1382, 758.2189, 765.8491, 770.9339, 779.4036, 780.8214,
        785.4980, 789.1124, 801.7900, 807.4788, 809.6479, 817.9877, 855.0084],
       device='cuda:0')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10, 20,  6, 27,  2,  1,  0,
        23,  5, 24, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 84.91% 

Test Accuracy: 83.53% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9359279870986938
distance x is tensor(199.5295, device='cuda:0')
benign distance is  tensor(199.5295, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.38785406947135925
distance x is tensor(202.3375, device='cuda:0')
benign distance is  tensor(202.3375, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7144333124160767
distance x is tensor(182.8448, device='cuda:0')
benign distance is  tensor(182.8448, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3848336338996887
distance x is tensor(179.8181, device='cuda:0')
benign distance is  tensor(179.8181, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3878765106201172
distance x is tensor(179.5457, device='cuda:0')
benign distance is  tensor(179.5457, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8681282997131348
distance x is tensor(188.2709, device='cuda:0')
benign distance is  tensor(188.2709, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4955971837043762
distance x is tensor(186.8217, device='cuda:0')
benign distance is  tensor(186.8217, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.25009042024612427
distance x is tensor(216.4814, device='cuda:0')
benign distance is  tensor(216.4814, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.31131553649902344
distance x is tensor(174.8500, device='cuda:0')
benign distance is  tensor(174.8500, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9666937589645386
distance x is tensor(205.9350, device='cuda:0')
benign distance is  tensor(205.9350, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2748037576675415
distance x is tensor(192.9047, device='cuda:0')
benign distance is  tensor(192.9047, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5690798759460449
distance x is tensor(198.3293, device='cuda:0')
benign distance is  tensor(198.3293, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.39075589179992676
distance x is tensor(192.8902, device='cuda:0')
benign distance is  tensor(192.8902, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5429378151893616
distance x is tensor(199.1487, device='cuda:0')
benign distance is  tensor(199.1487, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4710870385169983
distance x is tensor(196.8466, device='cuda:0')
benign distance is  tensor(196.8466, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.43460193276405334
distance x is tensor(190.0797, device='cuda:0')
benign distance is  tensor(190.0797, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 58.05973434448242
mal_entropy is 0.009633522480726242
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([863.8016, 865.8898, 774.0984, 786.1631, 757.3200, 806.8156, 804.1531,
        922.1068, 462.2332, 462.2332, 462.2332, 462.2332, 462.2332, 462.2332,
        462.2332, 462.2332, 462.2332, 462.2332, 462.2332, 462.2332, 829.2583,
        783.4686, 828.0978, 798.4521, 824.5726, 780.1944, 763.5803, 829.2269],
       device='cuda:0')
sorted_norm is   tensor([462.2332, 462.2332, 462.2332, 462.2332, 462.2332, 462.2332, 462.2332,
        462.2332, 462.2332, 462.2332, 462.2332, 462.2332, 757.3200, 763.5803,
        774.0984, 780.1944, 783.4686, 786.1631, 798.4521, 804.1531, 806.8156,
        824.5726, 828.0978, 829.2269, 829.2583, 863.8016, 865.8898, 922.1068],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4, 26,  2, 25, 21,  3,
        23,  6,  5, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 82.21% 

Test Accuracy: 80.65% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6091280579566956
distance x is tensor(204.4075, device='cuda:0')
benign distance is  tensor(204.4075, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6613685488700867
distance x is tensor(216.6709, device='cuda:0')
benign distance is  tensor(216.6709, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.36172303557395935
distance x is tensor(191.3267, device='cuda:0')
benign distance is  tensor(191.3267, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.19917818903923035
distance x is tensor(198.2847, device='cuda:0')
benign distance is  tensor(198.2847, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.656152069568634
distance x is tensor(206.4126, device='cuda:0')
benign distance is  tensor(206.4126, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5635918378829956
distance x is tensor(203.5867, device='cuda:0')
benign distance is  tensor(203.5867, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2560192346572876
distance x is tensor(193.7530, device='cuda:0')
benign distance is  tensor(193.7530, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37045419216156006
distance x is tensor(216.1173, device='cuda:0')
benign distance is  tensor(216.1173, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5382708311080933
distance x is tensor(198.5479, device='cuda:0')
benign distance is  tensor(198.5479, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8624511957168579
distance x is tensor(191.7328, device='cuda:0')
benign distance is  tensor(191.7328, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.35713666677474976
distance x is tensor(222.8424, device='cuda:0')
benign distance is  tensor(222.8424, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.14540138840675354
distance x is tensor(202.9460, device='cuda:0')
benign distance is  tensor(202.9460, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.32413458824157715
distance x is tensor(190.5727, device='cuda:0')
benign distance is  tensor(190.5727, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4558675289154053
distance x is tensor(221.6595, device='cuda:0')
benign distance is  tensor(221.6595, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5002305507659912
distance x is tensor(183.9849, device='cuda:0')
benign distance is  tensor(183.9849, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.45307856798171997
distance x is tensor(194.8846, device='cuda:0')
benign distance is  tensor(194.8846, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 75.5443344116211
mal_entropy is 0.017550868913531303
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([871.8118, 886.2371, 822.7528, 835.4506, 873.2872, 851.9822, 800.2026,
        931.5645, 461.7067, 461.7067, 461.7067, 461.7067, 461.7067, 461.7067,
        461.7067, 461.7067, 461.7067, 461.7067, 461.7067, 461.7067, 880.6091,
        855.5053, 913.0731, 877.4600, 831.7078, 897.9838, 854.3323, 820.0745],
       device='cuda:0')
sorted_norm is   tensor([461.7067, 461.7067, 461.7067, 461.7067, 461.7067, 461.7067, 461.7067,
        461.7067, 461.7067, 461.7067, 461.7067, 461.7067, 800.2026, 820.0745,
        822.7528, 831.7078, 835.4506, 851.9822, 854.3323, 855.5053, 871.8118,
        873.2872, 877.4600, 880.6091, 886.2371, 897.9838, 913.0731, 931.5645],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6, 27,  2, 24,  3,  5,
        26, 21,  0,  4], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 78.30% 

Test Accuracy: 77.27% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9992369413375854
distance x is tensor(192.0264, device='cuda:0')
benign distance is  tensor(192.0264, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46531614661216736
distance x is tensor(199.4947, device='cuda:0')
benign distance is  tensor(199.4947, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1999821960926056
distance x is tensor(238.6289, device='cuda:0')
benign distance is  tensor(238.6289, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.553637683391571
distance x is tensor(190.0333, device='cuda:0')
benign distance is  tensor(190.0333, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.802970290184021
distance x is tensor(205.1503, device='cuda:0')
benign distance is  tensor(205.1503, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5209173560142517
distance x is tensor(210.6244, device='cuda:0')
benign distance is  tensor(210.6244, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2714052200317383
distance x is tensor(198.4961, device='cuda:0')
benign distance is  tensor(198.4961, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3005066514015198
distance x is tensor(209.8953, device='cuda:0')
benign distance is  tensor(209.8953, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3174390494823456
distance x is tensor(206.0375, device='cuda:0')
benign distance is  tensor(206.0375, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.13349442183971405
distance x is tensor(218.3968, device='cuda:0')
benign distance is  tensor(218.3968, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3693085014820099
distance x is tensor(188.2508, device='cuda:0')
benign distance is  tensor(188.2508, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.22150352597236633
distance x is tensor(194.1005, device='cuda:0')
benign distance is  tensor(194.1005, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7745896577835083
distance x is tensor(195.6687, device='cuda:0')
benign distance is  tensor(195.6687, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2577560842037201
distance x is tensor(204.5001, device='cuda:0')
benign distance is  tensor(204.5001, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4438864588737488
distance x is tensor(259.3876, device='cuda:0')
benign distance is  tensor(259.3876, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.13634160161018372
distance x is tensor(239.7141, device='cuda:0')
benign distance is  tensor(239.7141, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 97.32764434814453
mal_entropy is 0.03158045560121536
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([824.1876, 840.2057, 973.9006, 788.3182, 858.9327, 857.7362, 811.0466,
        856.1241, 461.1390, 461.1390, 461.1390, 461.1390, 461.1390, 461.1390,
        461.1390, 461.1390, 461.1390, 461.1390, 461.1390, 461.1390, 866.4694,
        906.8901, 867.6305, 931.3678, 864.9557, 851.0754, 883.3890, 843.7576,
        862.8364, 874.2366, 918.8550, 905.6616, 791.7229, 855.2181, 892.6925,
        876.0408, 816.7945, 909.0408, 875.2502, 902.1976, 874.7912, 905.6886,
        901.1517, 888.6706, 873.7646, 834.8474, 935.4891, 872.0755, 839.7349,
        918.4025, 819.1432, 837.5752], device='cuda:0')
sorted_norm is   tensor([461.1390, 461.1390, 461.1390, 461.1390, 461.1390, 461.1390, 461.1390,
        461.1390, 461.1390, 461.1390, 461.1390, 461.1390, 788.3182, 791.7229,
        811.0466, 816.7945, 819.1432, 824.1876, 834.8474, 837.5752, 839.7349,
        840.2057, 843.7576, 851.0754, 855.2181, 856.1241, 857.7362, 858.9327,
        862.8364, 864.9557, 866.4694, 867.6305, 872.0755, 873.7646, 874.2366,
        874.7912, 875.2502, 876.0408, 883.3890, 888.6706, 892.6925, 901.1517,
        902.1976, 905.6616, 905.6886, 906.8901, 909.0408, 918.4025, 918.8550,
        931.3678, 935.4891, 973.9006], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  3, 32,  6, 36, 50,  0,
        45, 51, 48,  1, 27, 25, 33,  7,  5,  4, 28, 24, 20, 22, 47, 44, 29, 40,
        38, 35, 26, 43, 34], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 87.68% 

Test Accuracy: 86.27% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.793243408203125
distance x is tensor(162.8684, device='cuda:0')
benign distance is  tensor(162.8684, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5565186142921448
distance x is tensor(158.3538, device='cuda:0')
benign distance is  tensor(158.3538, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2840123474597931
distance x is tensor(150.7528, device='cuda:0')
benign distance is  tensor(150.7528, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7039538621902466
distance x is tensor(156.3075, device='cuda:0')
benign distance is  tensor(156.3075, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.578458309173584
distance x is tensor(153.1194, device='cuda:0')
benign distance is  tensor(153.1194, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.954481303691864
distance x is tensor(160.1556, device='cuda:0')
benign distance is  tensor(160.1556, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5475047826766968
distance x is tensor(150.9273, device='cuda:0')
benign distance is  tensor(150.9273, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5928348898887634
distance x is tensor(165.5995, device='cuda:0')
benign distance is  tensor(165.5995, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8796659708023071
distance x is tensor(159.5379, device='cuda:0')
benign distance is  tensor(159.5379, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.47077566385269165
distance x is tensor(159.3785, device='cuda:0')
benign distance is  tensor(159.3785, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.686676025390625
distance x is tensor(159.1730, device='cuda:0')
benign distance is  tensor(159.1730, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.43750816583633423
distance x is tensor(172.8130, device='cuda:0')
benign distance is  tensor(172.8130, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5184069871902466
distance x is tensor(150.1435, device='cuda:0')
benign distance is  tensor(150.1435, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.07997338473796844
distance x is tensor(159.2989, device='cuda:0')
benign distance is  tensor(159.2989, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.20084193348884583
distance x is tensor(157.7062, device='cuda:0')
benign distance is  tensor(157.7062, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3149181306362152
distance x is tensor(164.4126, device='cuda:0')
benign distance is  tensor(164.4126, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5114893913269043
distance x is tensor(159.1350, device='cuda:0')
benign distance is  tensor(159.1350, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4406186044216156
distance x is tensor(171.0731, device='cuda:0')
benign distance is  tensor(171.0731, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4659586548805237
distance x is tensor(162.1725, device='cuda:0')
benign distance is  tensor(162.1725, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3968580365180969
distance x is tensor(150.2826, device='cuda:0')
benign distance is  tensor(150.2826, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3960782587528229
distance x is tensor(160.9723, device='cuda:0')
benign distance is  tensor(160.9723, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9538606405258179
distance x is tensor(150.2841, device='cuda:0')
benign distance is  tensor(150.2841, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4697789251804352
distance x is tensor(165.7105, device='cuda:0')
benign distance is  tensor(165.7105, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8339006304740906
distance x is tensor(152.7272, device='cuda:0')
benign distance is  tensor(152.7272, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.28883349895477295
distance x is tensor(164.1532, device='cuda:0')
benign distance is  tensor(164.1532, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.2040606439113617
distance x is tensor(149.1783, device='cuda:0')
benign distance is  tensor(149.1783, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5737325549125671
distance x is tensor(151.2916, device='cuda:0')
benign distance is  tensor(151.2916, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5837182998657227
distance x is tensor(172.6172, device='cuda:0')
benign distance is  tensor(172.6172, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0631476640701294
distance x is tensor(162.8620, device='cuda:0')
benign distance is  tensor(162.8620, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2838727831840515
distance x is tensor(163.9357, device='cuda:0')
benign distance is  tensor(163.9357, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.36584410071372986
distance x is tensor(150.9021, device='cuda:0')
benign distance is  tensor(150.9021, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7337270975112915
distance x is tensor(162.2193, device='cuda:0')
benign distance is  tensor(162.2193, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.7202351689338684
distance x is tensor(150.8169, device='cuda:0')
benign distance is  tensor(150.8169, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4138058125972748
distance x is tensor(158.4544, device='cuda:0')
benign distance is  tensor(158.4544, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3200789988040924
distance x is tensor(152.8033, device='cuda:0')
benign distance is  tensor(152.8033, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6799308061599731
distance x is tensor(171.6594, device='cuda:0')
benign distance is  tensor(171.6594, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3335649371147156
distance x is tensor(158.0317, device='cuda:0')
benign distance is  tensor(158.0317, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.23142671585083008
distance x is tensor(164.9475, device='cuda:0')
benign distance is  tensor(164.9475, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.257508397102356
distance x is tensor(160.6376, device='cuda:0')
benign distance is  tensor(160.6376, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.20618633925914764
distance x is tensor(156.9773, device='cuda:0')
benign distance is  tensor(156.9773, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 1.4816747903823853
mal_entropy is 0.13965432345867157
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([729.4544, 703.3262, 668.0502, 686.0020, 660.9670, 693.8761, 660.0997,
        712.2559, 448.2988, 448.2988, 448.2988, 448.2988, 448.2988, 448.2988,
        448.2988, 448.2988, 448.2988, 448.2988, 448.2988, 448.2988],
       device='cuda:0')
sorted_norm is   tensor([448.2988, 448.2988, 448.2988, 448.2988, 448.2988, 448.2988, 448.2988,
        448.2988, 448.2988, 448.2988, 448.2988, 448.2988, 660.0997, 660.9670,
        668.0502, 686.0020, 693.8761, 703.3262, 712.2559, 729.4544],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  4,  2,  3],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 84.87% 

Test Accuracy: 83.23% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6423875093460083
distance x is tensor(212.5277, device='cuda:0')
benign distance is  tensor(212.5277, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9158465266227722
distance x is tensor(205.4302, device='cuda:0')
benign distance is  tensor(205.4302, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3030180037021637
distance x is tensor(197.7671, device='cuda:0')
benign distance is  tensor(197.7671, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5081700682640076
distance x is tensor(181.0232, device='cuda:0')
benign distance is  tensor(181.0232, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5356360673904419
distance x is tensor(184.2280, device='cuda:0')
benign distance is  tensor(184.2280, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8376903533935547
distance x is tensor(189.5807, device='cuda:0')
benign distance is  tensor(189.5807, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19648726284503937
distance x is tensor(183.7333, device='cuda:0')
benign distance is  tensor(183.7333, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.34580281376838684
distance x is tensor(176.4809, device='cuda:0')
benign distance is  tensor(176.4809, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 36.706817626953125
mal_entropy is 0.058771174401044846
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([915.6478, 865.8687, 843.4514, 776.1293, 782.7383, 814.1291, 780.8360,
        758.6090, 453.6003, 453.6003, 453.6003, 453.6003, 453.6003, 453.6003,
        453.6003, 453.6003, 453.6003, 453.6003, 453.6003, 453.6003, 798.3712,
        794.1835, 792.5845, 825.3667, 749.4006, 793.9233, 789.6171, 802.4718],
       device='cuda:0')
sorted_norm is   tensor([453.6003, 453.6003, 453.6003, 453.6003, 453.6003, 453.6003, 453.6003,
        453.6003, 453.6003, 453.6003, 453.6003, 453.6003, 749.4006, 758.6090,
        776.1293, 780.8360, 782.7383, 789.6171, 792.5845, 793.9233, 794.1835,
        798.3712, 802.4718, 814.1291, 825.3667, 843.4514, 865.8687, 915.6478],
       device='cuda:0')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10, 24,  7,  3,  6,  4, 26,
        22, 25, 21, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 83.47% 

Test Accuracy: 82.05% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.451359361410141
distance x is tensor(232.0820, device='cuda:0')
benign distance is  tensor(232.0820, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3995524048805237
distance x is tensor(191.4477, device='cuda:0')
benign distance is  tensor(191.4477, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20673415064811707
distance x is tensor(206.2278, device='cuda:0')
benign distance is  tensor(206.2278, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6208871006965637
distance x is tensor(212.5768, device='cuda:0')
benign distance is  tensor(212.5768, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5144193172454834
distance x is tensor(199.2625, device='cuda:0')
benign distance is  tensor(199.2625, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.12767967581748962
distance x is tensor(191.6402, device='cuda:0')
benign distance is  tensor(191.6402, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.33672013878822327
distance x is tensor(223.1214, device='cuda:0')
benign distance is  tensor(223.1214, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8307254910469055
distance x is tensor(186.2342, device='cuda:0')
benign distance is  tensor(186.2342, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.12679536640644073
distance x is tensor(204.8481, device='cuda:0')
benign distance is  tensor(204.8481, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3385167717933655
distance x is tensor(205.3250, device='cuda:0')
benign distance is  tensor(205.3250, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0255663394927979
distance x is tensor(208.3998, device='cuda:0')
benign distance is  tensor(208.3998, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3305710256099701
distance x is tensor(202.3414, device='cuda:0')
benign distance is  tensor(202.3414, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8902156949043274
distance x is tensor(169.0315, device='cuda:0')
benign distance is  tensor(169.0315, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.172007754445076
distance x is tensor(193.1559, device='cuda:0')
benign distance is  tensor(193.1559, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5908817648887634
distance x is tensor(201.2121, device='cuda:0')
benign distance is  tensor(201.2121, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.832187294960022
distance x is tensor(230.6361, device='cuda:0')
benign distance is  tensor(230.6361, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 71.45433044433594
mal_entropy is 0.05858289822936058
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([963.9083, 805.0200, 838.3871, 885.0593, 835.4207, 813.8579, 882.8821,
        791.0211, 458.5453, 458.5453, 458.5453, 458.5453, 458.5453, 458.5453,
        458.5453, 458.5453, 458.5453, 458.5453, 458.5453, 458.5453, 792.1525,
        858.9146, 820.1962, 796.7182, 808.4736, 775.0208, 836.1653, 800.1710],
       device='cuda:0')
sorted_norm is   tensor([458.5453, 458.5453, 458.5453, 458.5453, 458.5453, 458.5453, 458.5453,
        458.5453, 458.5453, 458.5453, 458.5453, 458.5453, 775.0208, 791.0211,
        792.1525, 796.7182, 800.1710, 805.0200, 808.4736, 813.8579, 820.1962,
        835.4207, 836.1653, 838.3871, 858.9146, 882.8821, 885.0593, 963.9083],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25,  7, 20, 23, 27,  1,
        24,  5, 22,  4], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 82.92% 

Test Accuracy: 81.17% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8536291122436523
distance x is tensor(199.9218, device='cuda:0')
benign distance is  tensor(199.9218, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.590620219707489
distance x is tensor(192.8749, device='cuda:0')
benign distance is  tensor(192.8749, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12494506686925888
distance x is tensor(185.4285, device='cuda:0')
benign distance is  tensor(185.4285, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.36134132742881775
distance x is tensor(201.0853, device='cuda:0')
benign distance is  tensor(201.0853, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.458301842212677
distance x is tensor(227.3158, device='cuda:0')
benign distance is  tensor(227.3158, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7560113668441772
distance x is tensor(198.5563, device='cuda:0')
benign distance is  tensor(198.5563, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.38816767930984497
distance x is tensor(198.8766, device='cuda:0')
benign distance is  tensor(198.8766, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4921698570251465
distance x is tensor(218.8201, device='cuda:0')
benign distance is  tensor(218.8201, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.8192430734634399
distance x is tensor(181.3337, device='cuda:0')
benign distance is  tensor(181.3337, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4870021939277649
distance x is tensor(189.7167, device='cuda:0')
benign distance is  tensor(189.7167, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2849723100662231
distance x is tensor(226.4811, device='cuda:0')
benign distance is  tensor(226.4811, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2617571949958801
distance x is tensor(205.4367, device='cuda:0')
benign distance is  tensor(205.4367, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.31428924202919006
distance x is tensor(202.6109, device='cuda:0')
benign distance is  tensor(202.6109, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7129154801368713
distance x is tensor(197.7726, device='cuda:0')
benign distance is  tensor(197.7726, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4396752715110779
distance x is tensor(283.0598, device='cuda:0')
benign distance is  tensor(283.0598, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.46146631240844727
distance x is tensor(206.9178, device='cuda:0')
benign distance is  tensor(206.9178, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 96.08200073242188
mal_entropy is 0.000587365822866559
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 850.8078,  830.2030,  787.2474,  867.9336,  920.2859,  836.7700,
         850.0752,  891.5417,  458.5434,  458.5434,  458.5434,  458.5434,
         458.5434,  458.5434,  458.5434,  458.5434,  458.5434,  458.5434,
         458.5434,  458.5434,  929.3259,  965.2805,  885.9366,  882.8022,
         887.5963,  901.1935, 1083.7264, 1021.4265,  845.3416,  777.7866,
         795.6540,  880.1790,  828.6279,  841.0448,  803.3201,  845.0015,
         895.5526,  856.6198,  873.5223,  887.7066,  752.2057,  838.8818,
         853.3187,  949.1954], device='cuda:0')
sorted_norm is   tensor([ 458.5434,  458.5434,  458.5434,  458.5434,  458.5434,  458.5434,
         458.5434,  458.5434,  458.5434,  458.5434,  458.5434,  458.5434,
         752.2057,  777.7866,  787.2474,  795.6540,  803.3201,  828.6279,
         830.2030,  836.7700,  838.8818,  841.0448,  845.0015,  845.3416,
         850.0752,  850.8078,  853.3187,  856.6198,  867.9336,  873.5223,
         880.1790,  882.8022,  885.9366,  887.5963,  887.7066,  891.5417,
         895.5526,  901.1935,  920.2859,  929.3259,  949.1954,  965.2805,
        1021.4265, 1083.7264], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 40, 29,  2, 30, 34, 32,
         1,  5, 41, 33, 35, 28,  6,  0, 42, 37,  3, 38, 31, 23, 22, 24, 39],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 87.54% 

Test Accuracy: 85.97% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7463318109512329
distance x is tensor(163.7512, device='cuda:0')
benign distance is  tensor(163.7512, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3540930449962616
distance x is tensor(189.6753, device='cuda:0')
benign distance is  tensor(189.6753, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3997378647327423
distance x is tensor(147.1585, device='cuda:0')
benign distance is  tensor(147.1585, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6172353029251099
distance x is tensor(160.3705, device='cuda:0')
benign distance is  tensor(160.3705, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4396514892578125
distance x is tensor(165.0390, device='cuda:0')
benign distance is  tensor(165.0390, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4241357743740082
distance x is tensor(176.5611, device='cuda:0')
benign distance is  tensor(176.5611, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9070766568183899
distance x is tensor(160.4677, device='cuda:0')
benign distance is  tensor(160.4677, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8800733685493469
distance x is tensor(179.3951, device='cuda:0')
benign distance is  tensor(179.3951, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.46323853731155396
distance x is tensor(167.8578, device='cuda:0')
benign distance is  tensor(167.8578, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8250247836112976
distance x is tensor(166.2045, device='cuda:0')
benign distance is  tensor(166.2045, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.10318281501531601
distance x is tensor(163.8440, device='cuda:0')
benign distance is  tensor(163.8440, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.47936415672302246
distance x is tensor(167.7422, device='cuda:0')
benign distance is  tensor(167.7422, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4215835630893707
distance x is tensor(144.3019, device='cuda:0')
benign distance is  tensor(144.3019, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5693630576133728
distance x is tensor(159.3777, device='cuda:0')
benign distance is  tensor(159.3777, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6432596445083618
distance x is tensor(173.8282, device='cuda:0')
benign distance is  tensor(173.8282, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3637785315513611
distance x is tensor(164.1824, device='cuda:0')
benign distance is  tensor(164.1824, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4313969016075134
distance x is tensor(161.8232, device='cuda:0')
benign distance is  tensor(161.8232, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6876966953277588
distance x is tensor(157.2417, device='cuda:0')
benign distance is  tensor(157.2417, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.4664688110351562
distance x is tensor(167.7926, device='cuda:0')
benign distance is  tensor(167.7926, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3020811676979065
distance x is tensor(174.1939, device='cuda:0')
benign distance is  tensor(174.1939, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0482628345489502
distance x is tensor(154.8467, device='cuda:0')
benign distance is  tensor(154.8467, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4474247097969055
distance x is tensor(171.4724, device='cuda:0')
benign distance is  tensor(171.4724, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4358766973018646
distance x is tensor(159.5841, device='cuda:0')
benign distance is  tensor(159.5841, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9627320170402527
distance x is tensor(500.4087, device='cuda:0')
benign distance is  tensor(500.4087, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.599886417388916
distance x is tensor(172.8606, device='cuda:0')
benign distance is  tensor(172.8606, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.15404388308525085
distance x is tensor(178.2434, device='cuda:0')
benign distance is  tensor(178.2434, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.28839629888534546
distance x is tensor(172.6644, device='cuda:0')
benign distance is  tensor(172.6644, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.12114312499761581
distance x is tensor(161.7870, device='cuda:0')
benign distance is  tensor(161.7870, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6129956245422363
distance x is tensor(147.4547, device='cuda:0')
benign distance is  tensor(147.4547, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5118438601493835
distance x is tensor(159.0414, device='cuda:0')
benign distance is  tensor(159.0414, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.43094831705093384
distance x is tensor(157.1341, device='cuda:0')
benign distance is  tensor(157.1341, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6637663245201111
distance x is tensor(161.4458, device='cuda:0')
benign distance is  tensor(161.4458, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal_loss is 6.087681770324707
mal_entropy is 0.25275304913520813
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([724.2333, 818.5132, 648.0375, 708.1119, 711.2361, 768.5795, 682.6452,
        736.7690, 452.7717, 452.7717, 452.7717, 452.7717, 452.7717, 452.7717,
        452.7717, 452.7717, 452.7717, 452.7717, 452.7717, 452.7717],
       device='cuda:0')
sorted_norm is   tensor([452.7717, 452.7717, 452.7717, 452.7717, 452.7717, 452.7717, 452.7717,
        452.7717, 452.7717, 452.7717, 452.7717, 452.7717, 648.0375, 682.6452,
        708.1119, 711.2361, 724.2333, 736.7690, 768.5795, 818.5132],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2,  6,  3,  4],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 81.75% 

Test Accuracy: 80.51% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.5011913776397705
distance x is tensor(202.7596, device='cuda:0')
benign distance is  tensor(202.7596, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4659058451652527
distance x is tensor(199.7693, device='cuda:0')
benign distance is  tensor(199.7693, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.32666441798210144
distance x is tensor(196.5899, device='cuda:0')
benign distance is  tensor(196.5899, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39792492985725403
distance x is tensor(211.3976, device='cuda:0')
benign distance is  tensor(211.3976, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9970952868461609
distance x is tensor(219.7411, device='cuda:0')
benign distance is  tensor(219.7411, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6803993582725525
distance x is tensor(229.6718, device='cuda:0')
benign distance is  tensor(229.6718, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.33992910385131836
distance x is tensor(192.9795, device='cuda:0')
benign distance is  tensor(192.9795, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.29570579528808594
distance x is tensor(206.7796, device='cuda:0')
benign distance is  tensor(206.7796, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 90.71763610839844
mal_entropy is 0.020439190790057182
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 828.8840,  864.4536,  817.3157,  884.3257,  880.5078,  912.7594,
         794.3354,  858.9906,  459.9273,  459.9272,  459.9273,  459.9272,
         459.9273,  459.9272,  459.9273,  459.9272,  459.9273,  459.9272,
         459.9273,  459.9272,  847.9172,  887.0417,  882.7281,  935.6830,
         886.1231,  903.8820,  898.3684,  871.1188,  835.3751,  875.3397,
         981.0411,  935.6080,  897.1466,  895.4222, 1166.5719,  948.0331,
         823.2140,  813.8646,  797.4131,  826.5088,  739.4436,  804.9466,
         839.7866,  797.2073], device='cuda:0')
sorted_norm is   tensor([ 459.9272,  459.9272,  459.9272,  459.9272,  459.9272,  459.9272,
         459.9273,  459.9273,  459.9273,  459.9273,  459.9273,  459.9273,
         739.4436,  794.3354,  797.2073,  797.4131,  804.9466,  813.8646,
         817.3157,  823.2140,  826.5088,  828.8840,  835.3751,  839.7866,
         847.9172,  858.9906,  864.4536,  871.1188,  875.3397,  880.5078,
         882.7281,  884.3257,  886.1231,  887.0417,  895.4222,  897.1466,
         898.3684,  903.8820,  912.7594,  935.6080,  935.6830,  948.0331,
         981.0411, 1166.5719], device='cuda:0')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10, 40,  6, 43, 38, 41, 37,
         2, 36, 39,  0, 28, 42, 20,  7,  1, 27, 29,  4, 22,  3, 24, 21, 33],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 87.48% 

Test Accuracy: 85.94% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3137488067150116
distance x is tensor(179.5218, device='cuda:0')
benign distance is  tensor(179.5218, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.30976402759552
distance x is tensor(163.7494, device='cuda:0')
benign distance is  tensor(163.7494, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12496491521596909
distance x is tensor(161.1345, device='cuda:0')
benign distance is  tensor(161.1345, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0686298608779907
distance x is tensor(153.2220, device='cuda:0')
benign distance is  tensor(153.2220, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3803524374961853
distance x is tensor(151.5795, device='cuda:0')
benign distance is  tensor(151.5795, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.48104768991470337
distance x is tensor(172.5939, device='cuda:0')
benign distance is  tensor(172.5939, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7845550775527954
distance x is tensor(161.4677, device='cuda:0')
benign distance is  tensor(161.4677, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8611838221549988
distance x is tensor(163.4206, device='cuda:0')
benign distance is  tensor(163.4206, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20089440047740936
distance x is tensor(161.4488, device='cuda:0')
benign distance is  tensor(161.4488, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7760864496231079
distance x is tensor(155.3894, device='cuda:0')
benign distance is  tensor(155.3894, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0106346607208252
distance x is tensor(158.0990, device='cuda:0')
benign distance is  tensor(158.0990, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.24738574028015137
distance x is tensor(181.7845, device='cuda:0')
benign distance is  tensor(181.7845, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6685147881507874
distance x is tensor(164.5155, device='cuda:0')
benign distance is  tensor(164.5155, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.33770641684532166
distance x is tensor(222.7109, device='cuda:0')
benign distance is  tensor(222.7109, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7183727025985718
distance x is tensor(167.5916, device='cuda:0')
benign distance is  tensor(167.5916, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7882676124572754
distance x is tensor(163.6652, device='cuda:0')
benign distance is  tensor(163.6652, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2706112861633301
distance x is tensor(167.0196, device='cuda:0')
benign distance is  tensor(167.0196, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.22652363777160645
distance x is tensor(161.7710, device='cuda:0')
benign distance is  tensor(161.7710, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9045677185058594
distance x is tensor(164.3135, device='cuda:0')
benign distance is  tensor(164.3135, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.27622660994529724
distance x is tensor(170.8770, device='cuda:0')
benign distance is  tensor(170.8770, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.35446763038635254
distance x is tensor(160.4636, device='cuda:0')
benign distance is  tensor(160.4636, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1413538455963135
distance x is tensor(165.8131, device='cuda:0')
benign distance is  tensor(165.8131, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.23117876052856445
distance x is tensor(173.5909, device='cuda:0')
benign distance is  tensor(173.5909, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.2706747353076935
distance x is tensor(169.2811, device='cuda:0')
benign distance is  tensor(169.2811, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.26959747076034546
distance x is tensor(171.4025, device='cuda:0')
benign distance is  tensor(171.4025, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.44162893295288086
distance x is tensor(165.2871, device='cuda:0')
benign distance is  tensor(165.2871, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.2686818242073059
distance x is tensor(156.2824, device='cuda:0')
benign distance is  tensor(156.2824, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5636281967163086
distance x is tensor(166.4105, device='cuda:0')
benign distance is  tensor(166.4105, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2318577766418457
distance x is tensor(158.0604, device='cuda:0')
benign distance is  tensor(158.0604, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.2993040680885315
distance x is tensor(176.3655, device='cuda:0')
benign distance is  tensor(176.3655, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9731577038764954
distance x is tensor(174.4112, device='cuda:0')
benign distance is  tensor(174.4112, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.30991166830062866
distance x is tensor(159.8954, device='cuda:0')
benign distance is  tensor(159.8954, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal_loss is 9.386871337890625
mal_entropy is 0.17437221109867096
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([782.9636, 724.5514, 701.8694, 659.5686, 647.4609, 741.2613, 683.1550,
        710.5281, 453.9454, 453.9454, 453.9454, 453.9454, 453.9454, 453.9454,
        453.9454, 453.9454, 453.9454, 453.9454, 453.9454, 453.9454],
       device='cuda:0')
sorted_norm is   tensor([453.9454, 453.9454, 453.9454, 453.9454, 453.9454, 453.9454, 453.9454,
        453.9454, 453.9454, 453.9454, 453.9454, 453.9454, 647.4609, 659.5686,
        683.1550, 701.8694, 710.5281, 724.5514, 741.2613, 782.9636],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  3,  6,  2],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 82.68% 

Test Accuracy: 81.42% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6678845882415771
distance x is tensor(199.9815, device='cuda:0')
benign distance is  tensor(199.9815, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6874379515647888
distance x is tensor(221.8230, device='cuda:0')
benign distance is  tensor(221.8230, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2468438446521759
distance x is tensor(199.3295, device='cuda:0')
benign distance is  tensor(199.3295, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3130764067173004
distance x is tensor(212.7438, device='cuda:0')
benign distance is  tensor(212.7438, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5384236574172974
distance x is tensor(194.8341, device='cuda:0')
benign distance is  tensor(194.8341, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5088071227073669
distance x is tensor(218.7229, device='cuda:0')
benign distance is  tensor(218.7229, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.40305957198143005
distance x is tensor(200.0172, device='cuda:0')
benign distance is  tensor(200.0172, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8665156364440918
distance x is tensor(231.8861, device='cuda:0')
benign distance is  tensor(231.8861, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 85.39521789550781
mal_entropy is 0.03756217285990715
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 835.3335,  888.1696,  808.2230,  875.7487,  783.8347,  870.0179,
         811.6480,  938.7692,  458.9141,  458.9141,  458.9141,  458.9141,
         458.9141,  458.9141,  458.9141,  458.9141,  458.9141,  458.9141,
         458.9141,  458.9141,  864.8660,  826.9471,  867.6605,  886.9215,
         827.5332,  888.5331,  849.1273, 2051.7019,  805.2413,  777.9409,
         790.4893,  871.9548,  818.6725,  968.3937,  827.0585,  803.2793],
       device='cuda:0')
sorted_norm is   tensor([ 458.9141,  458.9141,  458.9141,  458.9141,  458.9141,  458.9141,
         458.9141,  458.9141,  458.9141,  458.9141,  458.9141,  458.9141,
         777.9409,  783.8347,  790.4893,  803.2793,  805.2413,  808.2230,
         811.6480,  818.6725,  826.9471,  827.0585,  827.5332,  835.3335,
         849.1273,  864.8660,  867.6605,  870.0179,  871.9548,  875.7487,
         886.9215,  888.1696,  888.5331,  938.7692,  968.3937, 2051.7019],
       device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 29,  4, 30, 35, 28,  2,
         6, 32, 21, 34, 24,  0, 26, 20, 22,  5], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 86.51% 

Test Accuracy: 85.00% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6761727929115295
distance x is tensor(180.6449, device='cuda:0')
benign distance is  tensor(180.6449, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4808932840824127
distance x is tensor(179.1295, device='cuda:0')
benign distance is  tensor(179.1295, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5983771681785583
distance x is tensor(166.5977, device='cuda:0')
benign distance is  tensor(166.5977, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3883240222930908
distance x is tensor(190.3861, device='cuda:0')
benign distance is  tensor(190.3861, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3284221291542053
distance x is tensor(167.7493, device='cuda:0')
benign distance is  tensor(167.7493, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.856662392616272
distance x is tensor(168.6353, device='cuda:0')
benign distance is  tensor(168.6353, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1820725202560425
distance x is tensor(161.4750, device='cuda:0')
benign distance is  tensor(161.4750, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1497720628976822
distance x is tensor(178.4931, device='cuda:0')
benign distance is  tensor(178.4931, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.18464133143424988
distance x is tensor(182.7763, device='cuda:0')
benign distance is  tensor(182.7763, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2589458227157593
distance x is tensor(178.6303, device='cuda:0')
benign distance is  tensor(178.6303, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3374975323677063
distance x is tensor(254.9838, device='cuda:0')
benign distance is  tensor(254.9838, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7270403504371643
distance x is tensor(177.9226, device='cuda:0')
benign distance is  tensor(177.9226, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6184366941452026
distance x is tensor(169.8944, device='cuda:0')
benign distance is  tensor(169.8944, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.39684998989105225
distance x is tensor(196.8064, device='cuda:0')
benign distance is  tensor(196.8064, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.413971483707428
distance x is tensor(169.7337, device='cuda:0')
benign distance is  tensor(169.7337, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.41474246978759766
distance x is tensor(189.3088, device='cuda:0')
benign distance is  tensor(189.3088, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.48357194662094116
distance x is tensor(177.8832, device='cuda:0')
benign distance is  tensor(177.8832, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7588938474655151
distance x is tensor(182.4243, device='cuda:0')
benign distance is  tensor(182.4243, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6138224601745605
distance x is tensor(176.7305, device='cuda:0')
benign distance is  tensor(176.7305, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.0942902565002441
distance x is tensor(185.5550, device='cuda:0')
benign distance is  tensor(185.5550, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.4342544078826904
distance x is tensor(173.5229, device='cuda:0')
benign distance is  tensor(173.5229, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.29814404249191284
distance x is tensor(176.1671, device='cuda:0')
benign distance is  tensor(176.1671, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.57695072889328
distance x is tensor(167.9497, device='cuda:0')
benign distance is  tensor(167.9497, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.0975959300994873
distance x is tensor(181.4372, device='cuda:0')
benign distance is  tensor(181.4372, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 27.451147079467773
mal_entropy is 0.08123670518398285
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([761.0970, 767.2909, 719.0375, 806.5302, 691.6960, 738.0527, 675.2702,
        761.6153, 454.6685, 454.6685, 454.6685, 454.6685, 454.6685, 454.6685,
        454.6685, 454.6685, 454.6685, 454.6685, 454.6685, 454.6685, 858.1519,
        868.6064, 856.5770, 795.5852, 765.0449, 796.4564, 787.6687, 807.5225,
        789.3912, 780.5438, 773.7042, 800.4019, 768.4855, 786.9974, 798.6802,
        793.7526], device='cuda:0')
sorted_norm is   tensor([454.6685, 454.6685, 454.6685, 454.6685, 454.6685, 454.6685, 454.6685,
        454.6685, 454.6685, 454.6685, 454.6685, 454.6685, 675.2702, 691.6960,
        719.0375, 738.0527, 761.0970, 761.6153, 765.0449, 767.2909, 768.4855,
        773.7042, 780.5438, 786.9974, 787.6687, 789.3912, 793.7526, 795.5852,
        796.4564, 798.6802, 800.4019, 806.5302, 807.5225, 856.5770, 858.1519,
        868.6064], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  6,  4,  2,  5,  0,  7,
        24,  1, 32, 30, 29, 33, 26, 28, 35, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 87.19% 

Test Accuracy: 85.65% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4922734797000885
distance x is tensor(195.8024, device='cuda:0')
benign distance is  tensor(195.8024, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6292308568954468
distance x is tensor(174.4063, device='cuda:0')
benign distance is  tensor(174.4063, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.9360361099243164
distance x is tensor(165.0151, device='cuda:0')
benign distance is  tensor(165.0151, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8540663719177246
distance x is tensor(197.7999, device='cuda:0')
benign distance is  tensor(197.7999, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7649396657943726
distance x is tensor(175.2504, device='cuda:0')
benign distance is  tensor(175.2504, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.801132082939148
distance x is tensor(183.4880, device='cuda:0')
benign distance is  tensor(183.4880, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.33441758155822754
distance x is tensor(206.2091, device='cuda:0')
benign distance is  tensor(206.2091, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.44876378774642944
distance x is tensor(188.0217, device='cuda:0')
benign distance is  tensor(188.0217, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4054137170314789
distance x is tensor(155.9240, device='cuda:0')
benign distance is  tensor(155.9240, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5824394822120667
distance x is tensor(216.5822, device='cuda:0')
benign distance is  tensor(216.5822, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9059782028198242
distance x is tensor(179.7500, device='cuda:0')
benign distance is  tensor(179.7500, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5964556932449341
distance x is tensor(175.6480, device='cuda:0')
benign distance is  tensor(175.6480, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5273280143737793
distance x is tensor(196.6838, device='cuda:0')
benign distance is  tensor(196.6838, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.24902477860450745
distance x is tensor(175.8242, device='cuda:0')
benign distance is  tensor(175.8242, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.34330564737319946
distance x is tensor(167.8802, device='cuda:0')
benign distance is  tensor(167.8802, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6916589140892029
distance x is tensor(153.4399, device='cuda:0')
benign distance is  tensor(153.4399, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6713274121284485
distance x is tensor(171.3630, device='cuda:0')
benign distance is  tensor(171.3630, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.10607489198446274
distance x is tensor(178.0380, device='cuda:0')
benign distance is  tensor(178.0380, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7554141879081726
distance x is tensor(172.4690, device='cuda:0')
benign distance is  tensor(172.4690, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.4243218004703522
distance x is tensor(164.2488, device='cuda:0')
benign distance is  tensor(164.2488, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.552502453327179
distance x is tensor(173.3184, device='cuda:0')
benign distance is  tensor(173.3184, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.17505213618278503
distance x is tensor(171.0523, device='cuda:0')
benign distance is  tensor(171.0523, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7034369707107544
distance x is tensor(168.6072, device='cuda:0')
benign distance is  tensor(168.6072, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14402765035629272
distance x is tensor(172.5407, device='cuda:0')
benign distance is  tensor(172.5407, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 36.965843200683594
mal_entropy is 0.0887012779712677
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([811.2858, 753.3789, 701.7871, 836.9252, 733.4200, 788.0095, 807.6893,
        773.2181, 458.2376, 458.2376, 458.2376, 458.2376, 458.2376, 458.2376,
        458.2376, 458.2376, 458.2376, 458.2376, 458.2376, 458.2376, 796.2945,
        763.0749, 999.8049, 759.7833, 744.7044, 810.6200, 746.8742, 807.8076],
       device='cuda:0')
sorted_norm is   tensor([458.2376, 458.2376, 458.2376, 458.2376, 458.2376, 458.2376, 458.2376,
        458.2376, 458.2376, 458.2376, 458.2376, 458.2376, 701.7871, 733.4200,
        744.7044, 746.8742, 753.3789, 759.7833, 763.0749, 773.2181, 788.0095,
        796.2945, 807.6893, 807.8076, 810.6200, 811.2858, 836.9252, 999.8049],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2,  4, 24, 26,  1, 23,
        21,  7,  5, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 86.64% 

Test Accuracy: 85.10% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.27761316299438477
distance x is tensor(178.0773, device='cuda:0')
benign distance is  tensor(178.0773, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4807768762111664
distance x is tensor(176.6600, device='cuda:0')
benign distance is  tensor(176.6600, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.41712936758995056
distance x is tensor(183.7946, device='cuda:0')
benign distance is  tensor(183.7946, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6428027153015137
distance x is tensor(189.9705, device='cuda:0')
benign distance is  tensor(189.9705, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4580066204071045
distance x is tensor(170.2411, device='cuda:0')
benign distance is  tensor(170.2411, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5843395590782166
distance x is tensor(178.7877, device='cuda:0')
benign distance is  tensor(178.7877, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.29571548104286194
distance x is tensor(212.4830, device='cuda:0')
benign distance is  tensor(212.4830, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5478189587593079
distance x is tensor(183.5039, device='cuda:0')
benign distance is  tensor(183.5039, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.37840571999549866
distance x is tensor(186.9566, device='cuda:0')
benign distance is  tensor(186.9566, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5468930006027222
distance x is tensor(188.4657, device='cuda:0')
benign distance is  tensor(188.4657, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6412901878356934
distance x is tensor(182.2070, device='cuda:0')
benign distance is  tensor(182.2070, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.24504046142101288
distance x is tensor(177.5858, device='cuda:0')
benign distance is  tensor(177.5858, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.988913893699646
distance x is tensor(167.5130, device='cuda:0')
benign distance is  tensor(167.5130, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1409849226474762
distance x is tensor(175.3259, device='cuda:0')
benign distance is  tensor(175.3259, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8147486448287964
distance x is tensor(189.7696, device='cuda:0')
benign distance is  tensor(189.7696, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.09697687625885
distance x is tensor(173.0663, device='cuda:0')
benign distance is  tensor(173.0663, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 49.983673095703125
mal_entropy is 0.04108725115656853
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([766.6347, 738.7034, 791.4022, 825.4529, 725.9086, 748.3984, 885.6116,
        774.7003, 458.2174, 458.2174, 458.2174, 458.2174, 458.2174, 458.2174,
        458.2174, 458.2174, 458.2174, 458.2174, 458.2174, 458.2174],
       device='cuda:0')
sorted_norm is   tensor([458.2174, 458.2174, 458.2174, 458.2174, 458.2174, 458.2174, 458.2174,
        458.2174, 458.2174, 458.2174, 458.2174, 458.2174, 725.9086, 738.7034,
        748.3984, 766.6347, 774.7003, 791.4022, 825.4529, 885.6116],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  1,  5,  0],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 55.40% 

Test Accuracy: 54.80% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.45342475175857544
distance x is tensor(365.1970, device='cuda:0')
benign distance is  tensor(365.1970, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9231668710708618
distance x is tensor(463.7842, device='cuda:0')
benign distance is  tensor(463.7842, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31765952706336975
distance x is tensor(382.4013, device='cuda:0')
benign distance is  tensor(382.4013, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7993795275688171
distance x is tensor(493.1172, device='cuda:0')
benign distance is  tensor(493.1172, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2166321724653244
distance x is tensor(427.6919, device='cuda:0')
benign distance is  tensor(427.6919, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.633760929107666
distance x is tensor(341.9281, device='cuda:0')
benign distance is  tensor(341.9281, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8484756350517273
distance x is tensor(230.4458, device='cuda:0')
benign distance is  tensor(230.4458, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8665670156478882
distance x is tensor(555.8652, device='cuda:0')
benign distance is  tensor(555.8652, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 193.05836486816406
mal_entropy is 8.68236807726212e-15
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1479.5178, 1876.5891, 1451.9827, 1954.6954, 1728.8365, 1358.7329,
         904.2252, 2431.4236,  460.2245,  460.2245,  460.2245,  460.2245,
         460.2245,  460.2245,  460.2245,  460.2245,  460.2245,  460.2245,
         460.2245,  460.2245,  968.1098,  954.0635,  923.3832,  962.7967,
         929.9828,  958.3963,  988.2180,  938.5737,  918.7225,  932.7627,
         913.5608,  929.4708,  898.0450,  909.4039,  887.2196,  913.8757,
         833.6494, 1022.4460,  899.8077,  908.4028,  960.6011,  898.6476,
         880.5998,  816.5308,  868.3776,  876.0557,  852.4418,  840.8187,
         806.6048,  828.8018,  905.0539,  813.2809], device='cuda:0')
sorted_norm is   tensor([ 460.2245,  460.2245,  460.2245,  460.2245,  460.2245,  460.2245,
         460.2245,  460.2245,  460.2245,  460.2245,  460.2245,  460.2245,
         806.6048,  813.2809,  816.5308,  828.8018,  833.6494,  840.8187,
         852.4418,  868.3776,  876.0557,  880.5998,  887.2196,  898.0450,
         898.6476,  899.8077,  904.2252,  905.0539,  908.4028,  909.4039,
         913.5608,  913.8757,  918.7225,  923.3832,  929.4708,  929.9828,
         932.7627,  938.5737,  954.0635,  958.3963,  960.6011,  962.7967,
         968.1098,  988.2180, 1022.4460, 1358.7329, 1451.9827, 1479.5178,
        1728.8365, 1876.5891, 1954.6954, 2431.4236], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 48, 51, 43, 49, 36, 47,
        46, 44, 45, 42, 34, 32, 41, 38,  6, 50, 39, 33, 30, 35, 28, 22, 31, 24,
        29, 27, 21, 25, 40], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 87.53% 

Test Accuracy: 86.07% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7409195303916931
distance x is tensor(157.2088, device='cuda:0')
benign distance is  tensor(157.2088, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5105270147323608
distance x is tensor(172.1319, device='cuda:0')
benign distance is  tensor(172.1319, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.40323764085769653
distance x is tensor(166.1774, device='cuda:0')
benign distance is  tensor(166.1774, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.24904699623584747
distance x is tensor(164.5421, device='cuda:0')
benign distance is  tensor(164.5421, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5155419111251831
distance x is tensor(142.6480, device='cuda:0')
benign distance is  tensor(142.6480, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6042134165763855
distance x is tensor(180.0179, device='cuda:0')
benign distance is  tensor(180.0179, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3957943320274353
distance x is tensor(174.9023, device='cuda:0')
benign distance is  tensor(174.9023, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.36390525102615356
distance x is tensor(171.4964, device='cuda:0')
benign distance is  tensor(171.4964, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3894560933113098
distance x is tensor(180.3323, device='cuda:0')
benign distance is  tensor(180.3323, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5470497012138367
distance x is tensor(153.1671, device='cuda:0')
benign distance is  tensor(153.1671, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1617177724838257
distance x is tensor(172.6188, device='cuda:0')
benign distance is  tensor(172.6188, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2402205914258957
distance x is tensor(184.1375, device='cuda:0')
benign distance is  tensor(184.1375, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7939976453781128
distance x is tensor(132.4412, device='cuda:0')
benign distance is  tensor(132.4412, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.44702500104904175
distance x is tensor(151.5141, device='cuda:0')
benign distance is  tensor(151.5141, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7759519815444946
distance x is tensor(183.8615, device='cuda:0')
benign distance is  tensor(183.8615, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1873095035552979
distance x is tensor(163.4606, device='cuda:0')
benign distance is  tensor(163.4606, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.36324232816696167
distance x is tensor(164.9924, device='cuda:0')
benign distance is  tensor(164.9924, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7094051241874695
distance x is tensor(175.2271, device='cuda:0')
benign distance is  tensor(175.2271, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6323202848434448
distance x is tensor(167.7442, device='cuda:0')
benign distance is  tensor(167.7442, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.32230931520462036
distance x is tensor(168.6540, device='cuda:0')
benign distance is  tensor(168.6540, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.42580294609069824
distance x is tensor(157.1419, device='cuda:0')
benign distance is  tensor(157.1419, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.23204557597637177
distance x is tensor(171.6588, device='cuda:0')
benign distance is  tensor(171.6588, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4390691816806793
distance x is tensor(173.1425, device='cuda:0')
benign distance is  tensor(173.1425, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.25461381673812866
distance x is tensor(174.0492, device='cuda:0')
benign distance is  tensor(174.0492, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3333924412727356
distance x is tensor(166.3111, device='cuda:0')
benign distance is  tensor(166.3111, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4896990656852722
distance x is tensor(171.5495, device='cuda:0')
benign distance is  tensor(171.5495, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.45743298530578613
distance x is tensor(174.6949, device='cuda:0')
benign distance is  tensor(174.6949, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4876890182495117
distance x is tensor(162.7509, device='cuda:0')
benign distance is  tensor(162.7509, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8483168482780457
distance x is tensor(165.3192, device='cuda:0')
benign distance is  tensor(165.3192, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.45923152565956116
distance x is tensor(173.9278, device='cuda:0')
benign distance is  tensor(173.9278, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6169871091842651
distance x is tensor(150.3927, device='cuda:0')
benign distance is  tensor(150.3927, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3558725416660309
distance x is tensor(165.3743, device='cuda:0')
benign distance is  tensor(165.3743, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2757931351661682
distance x is tensor(158.8322, device='cuda:0')
benign distance is  tensor(158.8322, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.6259108185768127
distance x is tensor(163.2753, device='cuda:0')
benign distance is  tensor(163.2753, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3938283324241638
distance x is tensor(156.7296, device='cuda:0')
benign distance is  tensor(156.7296, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2975838780403137
distance x is tensor(160.3348, device='cuda:0')
benign distance is  tensor(160.3348, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.2716312408447266
distance x is tensor(158.1947, device='cuda:0')
benign distance is  tensor(158.1947, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.4295590817928314
distance x is tensor(166.3656, device='cuda:0')
benign distance is  tensor(166.3656, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5323182344436646
distance x is tensor(167.3685, device='cuda:0')
benign distance is  tensor(167.3685, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.619881808757782
distance x is tensor(158.1734, device='cuda:0')
benign distance is  tensor(158.1734, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 22.18720054626465
mal_entropy is 0.16785694658756256
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([664.4633, 723.8356, 734.6284, 720.5790, 603.4023, 767.5087, 690.4271,
        719.8527, 453.9501, 453.9501, 453.9501, 453.9501, 453.9501, 453.9501,
        453.9501, 453.9501, 453.9501, 453.9501, 453.9501, 453.9501],
       device='cuda:0')
sorted_norm is   tensor([453.9501, 453.9501, 453.9501, 453.9501, 453.9501, 453.9501, 453.9501,
        453.9501, 453.9501, 453.9501, 453.9501, 453.9501, 603.4023, 664.4633,
        690.4271, 719.8527, 720.5790, 723.8356, 734.6284, 767.5087],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  0,  6,  7],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 83.48% 

Test Accuracy: 81.93% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.556735634803772
distance x is tensor(179.8264, device='cuda:0')
benign distance is  tensor(179.8264, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7279645204544067
distance x is tensor(224.7616, device='cuda:0')
benign distance is  tensor(224.7616, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.36707401275634766
distance x is tensor(194.2461, device='cuda:0')
benign distance is  tensor(194.2461, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5124310255050659
distance x is tensor(218.6006, device='cuda:0')
benign distance is  tensor(218.6006, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7869322896003723
distance x is tensor(219.5715, device='cuda:0')
benign distance is  tensor(219.5715, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0866649150848389
distance x is tensor(206.0955, device='cuda:0')
benign distance is  tensor(206.0955, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4576869606971741
distance x is tensor(195.6230, device='cuda:0')
benign distance is  tensor(195.6230, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5952600240707397
distance x is tensor(199.6519, device='cuda:0')
benign distance is  tensor(199.6519, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 93.48399353027344
mal_entropy is 5.764470552094281e-05
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([766.1194, 905.3967, 811.7787, 857.8701, 906.3755, 839.5803, 785.3392,
        819.4694, 456.3187, 456.3187, 456.3187, 456.3187, 456.3187, 456.3187,
        456.3187, 456.3187, 456.3187, 456.3187, 456.3187, 456.3187, 858.4849,
        884.9854, 854.1535, 854.0557, 861.4406, 852.7532, 851.6286, 869.9160,
        860.6582, 759.0001, 806.5807, 867.0586, 676.5988, 749.4869, 869.9264,
        790.4848], device='cuda:0')
sorted_norm is   tensor([456.3187, 456.3187, 456.3187, 456.3187, 456.3187, 456.3187, 456.3187,
        456.3187, 456.3187, 456.3187, 456.3187, 456.3187, 676.5988, 749.4869,
        759.0001, 766.1194, 785.3392, 790.4848, 806.5807, 811.7787, 819.4694,
        839.5803, 851.6286, 852.7532, 854.0557, 854.1535, 857.8701, 858.4849,
        860.6582, 861.4406, 867.0586, 869.9160, 869.9264, 884.9854, 905.3967,
        906.3755], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 32, 33, 29,  0,  6, 35,
        30,  2,  7,  5, 26, 25, 23, 22,  3, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 86.72% 

Test Accuracy: 85.34% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 86.72%
|----0th round Training Accuracy : 88.82%
|----1th round Training Accuracy : 88.28%
|----2th round Training Accuracy : 87.87%
|----3th round Training Accuracy : 87.62%
|----4th round Training Accuracy : 84.21%
|----5th round Training Accuracy : 87.54%
|----6th round Training Accuracy : 61.85%
|----7th round Training Accuracy : 84.51%
|----8th round Training Accuracy : 79.52%
|----9th round Training Accuracy : 84.57%
|----10th round Training Accuracy : 44.34%
|----11th round Training Accuracy : 87.29%
|----12th round Training Accuracy : 74.76%
|----13th round Training Accuracy : 66.24%
|----14th round Training Accuracy : 83.43%
|----15th round Training Accuracy : 86.33%
|----16th round Training Accuracy : 39.35%
|----17th round Training Accuracy : 86.43%
|----18th round Training Accuracy : 35.56%
|----19th round Training Accuracy : 86.28%
|----20th round Training Accuracy : 79.15%
|----21th round Training Accuracy : 79.72%
|----22th round Training Accuracy : 31.68%
|----23th round Training Accuracy : 87.68%
|----24th round Training Accuracy : 86.28%
|----25th round Training Accuracy : 84.70%
|----26th round Training Accuracy : 82.30%
|----27th round Training Accuracy : 86.48%
|----28th round Training Accuracy : 63.48%
|----29th round Training Accuracy : 87.87%
|----30th round Training Accuracy : 83.25%
|----31th round Training Accuracy : 86.44%
|----32th round Training Accuracy : 84.91%
|----33th round Training Accuracy : 82.21%
|----34th round Training Accuracy : 78.30%
|----35th round Training Accuracy : 87.68%
|----36th round Training Accuracy : 84.87%
|----37th round Training Accuracy : 83.47%
|----38th round Training Accuracy : 82.92%
|----39th round Training Accuracy : 87.54%
|----40th round Training Accuracy : 81.75%
|----41th round Training Accuracy : 87.48%
|----42th round Training Accuracy : 82.68%
|----43th round Training Accuracy : 86.51%
|----44th round Training Accuracy : 87.19%
|----45th round Training Accuracy : 86.64%
|----46th round Training Accuracy : 55.40%
|----47th round Training Accuracy : 87.53%
|----48th round Training Accuracy : 83.48%
|----49th round Training Accuracy : 86.72%
|----Final Test Accuracy: 85.34%
|----0th round Final Test Accuracy : 88.11%
|----1th round Final Test Accuracy : 87.69%
|----2th round Final Test Accuracy : 86.92%
|----3th round Final Test Accuracy : 86.27%
|----4th round Final Test Accuracy : 82.75%
|----5th round Final Test Accuracy : 85.89%
|----6th round Final Test Accuracy : 61.56%
|----7th round Final Test Accuracy : 83.20%
|----8th round Final Test Accuracy : 78.19%
|----9th round Final Test Accuracy : 83.14%
|----10th round Final Test Accuracy : 44.15%
|----11th round Final Test Accuracy : 85.98%
|----12th round Final Test Accuracy : 73.62%
|----13th round Final Test Accuracy : 65.62%
|----14th round Final Test Accuracy : 82.30%
|----15th round Final Test Accuracy : 84.93%
|----16th round Final Test Accuracy : 38.88%
|----17th round Final Test Accuracy : 84.81%
|----18th round Final Test Accuracy : 35.54%
|----19th round Final Test Accuracy : 84.78%
|----20th round Final Test Accuracy : 78.32%
|----21th round Final Test Accuracy : 78.55%
|----22th round Final Test Accuracy : 31.45%
|----23th round Final Test Accuracy : 86.24%
|----24th round Final Test Accuracy : 84.49%
|----25th round Final Test Accuracy : 83.01%
|----26th round Final Test Accuracy : 80.91%
|----27th round Final Test Accuracy : 84.74%
|----28th round Final Test Accuracy : 62.62%
|----29th round Final Test Accuracy : 86.36%
|----30th round Final Test Accuracy : 81.81%
|----31th round Final Test Accuracy : 84.73%
|----32th round Final Test Accuracy : 83.53%
|----33th round Final Test Accuracy : 80.65%
|----34th round Final Test Accuracy : 77.27%
|----35th round Final Test Accuracy : 86.27%
|----36th round Final Test Accuracy : 83.23%
|----37th round Final Test Accuracy : 82.05%
|----38th round Final Test Accuracy : 81.17%
|----39th round Final Test Accuracy : 85.97%
|----40th round Final Test Accuracy : 80.51%
|----41th round Final Test Accuracy : 85.94%
|----42th round Final Test Accuracy : 81.42%
|----43th round Final Test Accuracy : 85.00%
|----44th round Final Test Accuracy : 85.65%
|----45th round Final Test Accuracy : 85.10%
|----46th round Final Test Accuracy : 54.80%
|----47th round Final Test Accuracy : 86.07%
|----48th round Final Test Accuracy : 81.93%
|----49th round Final Test Accuracy : 85.34%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3184.7905
