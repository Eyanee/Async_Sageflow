
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7074366211891174
distance x is tensor(113.9393, device='cuda:3')
benign distance is  tensor(113.9393, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4423202872276306
distance x is tensor(113.1407, device='cuda:3')
benign distance is  tensor(113.1407, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5390409231185913
distance x is tensor(122.8813, device='cuda:3')
benign distance is  tensor(122.8813, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6241439580917358
distance x is tensor(116.9993, device='cuda:3')
benign distance is  tensor(116.9993, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9934912919998169
distance x is tensor(103.2931, device='cuda:3')
benign distance is  tensor(103.2931, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2991641163825989
distance x is tensor(116.5647, device='cuda:3')
benign distance is  tensor(116.5647, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5775601267814636
distance x is tensor(111.1418, device='cuda:3')
benign distance is  tensor(111.1418, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.34577488899230957
distance x is tensor(123.4090, device='cuda:3')
benign distance is  tensor(123.4090, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1420544683933258
distance x is tensor(138.1086, device='cuda:3')
benign distance is  tensor(138.1086, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.44736894965171814
distance x is tensor(140.5182, device='cuda:3')
benign distance is  tensor(140.5182, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4554060101509094
distance x is tensor(117.8107, device='cuda:3')
benign distance is  tensor(117.8107, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.21628758311271667
distance x is tensor(125.1076, device='cuda:3')
benign distance is  tensor(125.1076, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5583084225654602
distance x is tensor(129.7257, device='cuda:3')
benign distance is  tensor(129.7257, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4619668424129486
distance x is tensor(136.9954, device='cuda:3')
benign distance is  tensor(136.9954, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8641031980514526
distance x is tensor(138.4146, device='cuda:3')
benign distance is  tensor(138.4146, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.254917174577713
distance x is tensor(134.2981, device='cuda:3')
benign distance is  tensor(134.2981, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.25893518328666687
distance x is tensor(126.3092, device='cuda:3')
benign distance is  tensor(126.3092, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8636066317558289
distance x is tensor(143.3085, device='cuda:3')
benign distance is  tensor(143.3085, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.30540627241134644
distance x is tensor(129.3274, device='cuda:3')
benign distance is  tensor(129.3274, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7427971959114075
distance x is tensor(126.5641, device='cuda:3')
benign distance is  tensor(126.5641, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.15671539306640625
distance x is tensor(129.9653, device='cuda:3')
benign distance is  tensor(129.9653, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.38993385434150696
distance x is tensor(123.9096, device='cuda:3')
benign distance is  tensor(123.9096, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3258308172225952
distance x is tensor(142.7241, device='cuda:3')
benign distance is  tensor(142.7241, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7888821363449097
distance x is tensor(130.3127, device='cuda:3')
benign distance is  tensor(130.3127, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5170038342475891
distance x is tensor(138.6372, device='cuda:3')
benign distance is  tensor(138.6372, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.636953592300415
distance x is tensor(120.6736, device='cuda:3')
benign distance is  tensor(120.6736, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8094943761825562
distance x is tensor(142.0973, device='cuda:3')
benign distance is  tensor(142.0973, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.23904362320899963
distance x is tensor(137.7696, device='cuda:3')
benign distance is  tensor(137.7696, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9363735318183899
distance x is tensor(129.7886, device='cuda:3')
benign distance is  tensor(129.7886, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.89751797914505
distance x is tensor(134.1480, device='cuda:3')
benign distance is  tensor(134.1480, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4333941340446472
distance x is tensor(128.0354, device='cuda:3')
benign distance is  tensor(128.0354, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5360584259033203
distance x is tensor(134.7592, device='cuda:3')
benign distance is  tensor(134.7592, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.40169841051101685
distance x is tensor(138.0658, device='cuda:3')
benign distance is  tensor(138.0658, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.5059400796890259
distance x is tensor(126.7681, device='cuda:3')
benign distance is  tensor(126.7681, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5461167097091675
distance x is tensor(136.8678, device='cuda:3')
benign distance is  tensor(136.8678, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04858499765396118
distance x is tensor(124.8821, device='cuda:3')
benign distance is  tensor(124.8821, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5540920495986938
distance x is tensor(128.4655, device='cuda:3')
benign distance is  tensor(128.4655, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.35354629158973694
distance x is tensor(124.3981, device='cuda:3')
benign distance is  tensor(124.3981, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.21773521602153778
distance x is tensor(123.8284, device='cuda:3')
benign distance is  tensor(123.8284, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.11157377809286118
distance x is tensor(129.4891, device='cuda:3')
benign distance is  tensor(129.4891, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1592458337545395
distance x is tensor(121.1087, device='cuda:3')
benign distance is  tensor(121.1087, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.46261101961135864
distance x is tensor(123.5465, device='cuda:3')
benign distance is  tensor(123.5465, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.06305905431509018
distance x is tensor(131.3725, device='cuda:3')
benign distance is  tensor(131.3725, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2651315927505493
distance x is tensor(132.1891, device='cuda:3')
benign distance is  tensor(132.1891, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6004424691200256
distance x is tensor(134.9750, device='cuda:3')
benign distance is  tensor(134.9750, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5068021416664124
distance x is tensor(130.8846, device='cuda:3')
benign distance is  tensor(130.8846, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5655251741409302
distance x is tensor(133.4379, device='cuda:3')
benign distance is  tensor(133.4379, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.09542624652385712
distance x is tensor(136.7333, device='cuda:3')
benign distance is  tensor(136.7333, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.18579892814159393
mal_entropy is 0.14543171226978302
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([516.9414, 528.4520, 551.4873, 533.6699, 474.1018, 537.6200, 500.1351,
        578.3019, 616.4430, 616.4430, 616.4430, 616.4430, 616.4430, 616.4430,
        616.4430, 616.4430, 616.4430, 616.4430, 616.4430, 616.4430],
       device='cuda:3')
sorted_norm is   tensor([474.1018, 500.1351, 516.9414, 528.4520, 533.6699, 537.6200, 551.4873,
        578.3019, 616.4430, 616.4430, 616.4430, 616.4430, 616.4430, 616.4430,
        616.4430, 616.4430, 616.4430, 616.4430, 616.4430, 616.4430],
       device='cuda:3')
used idx is  tensor([ 4,  6,  0,  1,  3,  5,  2,  7, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 88.92% 

Test Accuracy: 88.10% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7559912204742432
distance x is tensor(110.8790, device='cuda:3')
benign distance is  tensor(110.8790, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8949340581893921
distance x is tensor(128.6822, device='cuda:3')
benign distance is  tensor(128.6822, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.606714129447937
distance x is tensor(128.4412, device='cuda:3')
benign distance is  tensor(128.4412, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45366477966308594
distance x is tensor(121.0232, device='cuda:3')
benign distance is  tensor(121.0232, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6431101560592651
distance x is tensor(114.9543, device='cuda:3')
benign distance is  tensor(114.9543, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8014127612113953
distance x is tensor(117.5027, device='cuda:3')
benign distance is  tensor(117.5027, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3444235920906067
distance x is tensor(124.8029, device='cuda:3')
benign distance is  tensor(124.8029, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3650759160518646
distance x is tensor(121.0581, device='cuda:3')
benign distance is  tensor(121.0581, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6539264917373657
mal_entropy is 0.06421449780464172
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([497.3708, 583.2881, 564.3308, 528.8442, 516.0142, 533.2924, 562.0181,
        552.5762, 552.5762, 552.5762, 552.5762, 552.5762, 552.5762, 552.5762,
        552.5762, 552.5762, 552.5762, 552.5762, 552.5762, 552.5762, 701.7714,
        699.0438, 627.8906, 651.0346, 668.3425, 702.4205, 697.4901, 677.4340],
       device='cuda:3')
sorted_norm is   tensor([497.3708, 516.0142, 528.8442, 533.2924, 552.5762, 552.5762, 552.5762,
        552.5762, 552.5762, 552.5762, 552.5762, 552.5762, 552.5762, 552.5762,
        552.5762, 552.5762, 552.5762, 562.0181, 564.3308, 583.2881, 627.8906,
        651.0346, 668.3425, 677.4340, 697.4901, 699.0438, 701.7714, 702.4205],
       device='cuda:3')
used idx is  tensor([ 0,  4,  3,  5, 19, 18, 16, 17, 13, 12, 14, 15,  7, 10,  8,  9, 11,  6,
         2,  1, 22, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 88.80% 

Test Accuracy: 88.09% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9167793393135071
distance x is tensor(126.0734, device='cuda:3')
benign distance is  tensor(126.0734, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.15902183949947357
distance x is tensor(145.6454, device='cuda:3')
benign distance is  tensor(145.6454, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5784643292427063
distance x is tensor(131.9075, device='cuda:3')
benign distance is  tensor(131.9075, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7445584535598755
distance x is tensor(122.9099, device='cuda:3')
benign distance is  tensor(122.9099, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6017229557037354
distance x is tensor(130.7803, device='cuda:3')
benign distance is  tensor(130.7803, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7767559289932251
distance x is tensor(141.8884, device='cuda:3')
benign distance is  tensor(141.8884, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7299855351448059
distance x is tensor(135.2884, device='cuda:3')
benign distance is  tensor(135.2884, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.39894431829452515
distance x is tensor(112.2482, device='cuda:3')
benign distance is  tensor(112.2482, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.47043055295944214
distance x is tensor(159.4565, device='cuda:3')
benign distance is  tensor(159.4565, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3561663031578064
distance x is tensor(142.6511, device='cuda:3')
benign distance is  tensor(142.6511, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.248570442199707
distance x is tensor(145.7965, device='cuda:3')
benign distance is  tensor(145.7965, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4514322876930237
distance x is tensor(137.7917, device='cuda:3')
benign distance is  tensor(137.7917, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5298739671707153
distance x is tensor(135.5004, device='cuda:3')
benign distance is  tensor(135.5004, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.26274415850639343
distance x is tensor(152.7143, device='cuda:3')
benign distance is  tensor(152.7143, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.27186107635498047
distance x is tensor(139.0243, device='cuda:3')
benign distance is  tensor(139.0243, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.48312297463417053
distance x is tensor(159.6639, device='cuda:3')
benign distance is  tensor(159.6639, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.8964088559150696
mal_entropy is 0.1570921689271927
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([563.6288, 650.9241, 573.3076, 545.8182, 574.7403, 627.6907, 594.0447,
        490.7828, 703.7670, 703.7670, 703.7670, 703.7670, 703.7670, 703.7670,
        703.7670, 703.7670, 703.7670, 703.7670, 703.7670, 703.7670, 699.8416,
        780.8291, 716.7473, 722.1697, 730.0065, 701.0063, 768.2290, 717.0557],
       device='cuda:3')
sorted_norm is   tensor([490.7828, 545.8182, 563.6288, 573.3076, 574.7403, 594.0447, 627.6907,
        650.9241, 699.8416, 701.0063, 703.7670, 703.7670, 703.7670, 703.7670,
        703.7670, 703.7670, 703.7670, 703.7670, 703.7670, 703.7670, 703.7670,
        703.7670, 716.7473, 717.0557, 722.1697, 730.0065, 768.2290, 780.8291],
       device='cuda:3')
used idx is  tensor([ 7,  3,  0,  2,  4,  6,  5,  1, 20, 25, 16, 18, 19, 17, 14, 15, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 89.07% 

Test Accuracy: 88.18% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8809696435928345
distance x is tensor(118.7496, device='cuda:3')
benign distance is  tensor(118.7496, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6168330311775208
distance x is tensor(125.4248, device='cuda:3')
benign distance is  tensor(125.4248, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1764337718486786
distance x is tensor(136.6080, device='cuda:3')
benign distance is  tensor(136.6080, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1363493204116821
distance x is tensor(120.4412, device='cuda:3')
benign distance is  tensor(120.4412, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7434223890304565
distance x is tensor(119.3013, device='cuda:3')
benign distance is  tensor(119.3013, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3580414652824402
distance x is tensor(134.0433, device='cuda:3')
benign distance is  tensor(134.0433, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6180433034896851
distance x is tensor(131.6057, device='cuda:3')
benign distance is  tensor(131.6057, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1692265272140503
distance x is tensor(106.3247, device='cuda:3')
benign distance is  tensor(106.3247, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4445539116859436
distance x is tensor(143.7271, device='cuda:3')
benign distance is  tensor(143.7271, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0312342643737793
distance x is tensor(148.0791, device='cuda:3')
benign distance is  tensor(148.0791, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3396042585372925
distance x is tensor(145.3592, device='cuda:3')
benign distance is  tensor(145.3592, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.35676640272140503
distance x is tensor(136.4904, device='cuda:3')
benign distance is  tensor(136.4904, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5356791615486145
distance x is tensor(139.3383, device='cuda:3')
benign distance is  tensor(139.3383, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5073680281639099
distance x is tensor(144.6659, device='cuda:3')
benign distance is  tensor(144.6659, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.8909305334091187
distance x is tensor(148.6966, device='cuda:3')
benign distance is  tensor(148.6966, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.15885013341903687
distance x is tensor(145.4667, device='cuda:3')
benign distance is  tensor(145.4667, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.0587281659245491
mal_entropy is 0.0708899199962616
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([532.0289, 566.3161, 592.8364, 521.7512, 523.7515, 607.6925, 575.6843,
        458.8499, 631.9901, 631.9902, 631.9901, 631.9902, 631.9901, 631.9902,
        631.9901, 631.9902, 631.9901, 631.9902, 631.9901, 631.9902, 829.2281,
        759.0298, 831.4968, 811.6251, 788.4894, 817.3145, 790.2999, 820.0554,
        790.1684, 727.5203, 745.5049, 719.2548, 706.6501, 777.1745, 721.7927,
        328.6802], device='cuda:3')
sorted_norm is   tensor([328.6802, 458.8499, 521.7512, 523.7515, 532.0289, 566.3161, 575.6843,
        592.8364, 607.6925, 631.9901, 631.9901, 631.9901, 631.9901, 631.9901,
        631.9901, 631.9902, 631.9902, 631.9902, 631.9902, 631.9902, 631.9902,
        706.6501, 719.2548, 721.7927, 727.5203, 745.5049, 759.0298, 777.1745,
        788.4894, 790.1684, 790.2999, 811.6251, 817.3145, 820.0554, 829.2281,
        831.4968], device='cuda:3')
used idx is  tensor([35,  7,  3,  4,  0,  1,  6,  2,  5, 10, 18, 16, 12,  8, 14, 17, 15, 13,
         9, 11, 19, 32, 31, 34, 29, 30, 21, 33], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 88.55% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5299876928329468
distance x is tensor(107.2604, device='cuda:3')
benign distance is  tensor(107.2604, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6590507626533508
distance x is tensor(106.2325, device='cuda:3')
benign distance is  tensor(106.2325, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0502438060939312
distance x is tensor(129.3391, device='cuda:3')
benign distance is  tensor(129.3391, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9603285789489746
distance x is tensor(121.1176, device='cuda:3')
benign distance is  tensor(121.1176, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7853041887283325
distance x is tensor(112.3575, device='cuda:3')
benign distance is  tensor(112.3575, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.792087972164154
distance x is tensor(118.1814, device='cuda:3')
benign distance is  tensor(118.1814, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.34750762581825256
distance x is tensor(109.2764, device='cuda:3')
benign distance is  tensor(109.2764, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.27746477723121643
distance x is tensor(92.9506, device='cuda:3')
benign distance is  tensor(92.9506, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1852957308292389
distance x is tensor(135.1969, device='cuda:3')
benign distance is  tensor(135.1969, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.076311707496643
distance x is tensor(132.8808, device='cuda:3')
benign distance is  tensor(132.8808, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3909527659416199
distance x is tensor(119.1833, device='cuda:3')
benign distance is  tensor(119.1833, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.27846759557724
distance x is tensor(126.3648, device='cuda:3')
benign distance is  tensor(126.3648, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.37556520104408264
distance x is tensor(128.6533, device='cuda:3')
benign distance is  tensor(128.6533, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.291581928730011
distance x is tensor(137.4657, device='cuda:3')
benign distance is  tensor(137.4657, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4526239037513733
distance x is tensor(132.9589, device='cuda:3')
benign distance is  tensor(132.9589, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0793040990829468
distance x is tensor(116.4412, device='cuda:3')
benign distance is  tensor(116.4412, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4431764483451843
distance x is tensor(139.4141, device='cuda:3')
benign distance is  tensor(139.4141, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.850427508354187
distance x is tensor(127.1883, device='cuda:3')
benign distance is  tensor(127.1883, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2756038308143616
distance x is tensor(140.6263, device='cuda:3')
benign distance is  tensor(140.6263, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3811419606208801
distance x is tensor(135.8061, device='cuda:3')
benign distance is  tensor(135.8061, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0512773990631104
distance x is tensor(138.0976, device='cuda:3')
benign distance is  tensor(138.0976, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6535662412643433
distance x is tensor(128.7753, device='cuda:3')
benign distance is  tensor(128.7753, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2802627682685852
distance x is tensor(131.3839, device='cuda:3')
benign distance is  tensor(131.3839, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.18847163021564484
distance x is tensor(131.3413, device='cuda:3')
benign distance is  tensor(131.3413, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.4830356240272522
mal_entropy is 0.09159524738788605
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([476.0242, 472.9929, 560.1777, 519.9869, 477.7351, 520.2898, 468.0355,
        400.8025, 583.3951, 583.3951, 583.3951, 583.3951, 583.3951, 583.3951,
        583.3951, 583.3951, 583.3951, 583.3951, 583.3951, 583.3951, 819.3232,
        785.9742, 825.7335, 781.1238, 801.1456, 778.6722, 784.6224, 782.7581],
       device='cuda:3')
sorted_norm is   tensor([400.8025, 468.0355, 472.9929, 476.0242, 477.7351, 519.9869, 520.2898,
        560.1777, 583.3951, 583.3951, 583.3951, 583.3951, 583.3951, 583.3951,
        583.3951, 583.3951, 583.3951, 583.3951, 583.3951, 583.3951, 778.6722,
        781.1238, 782.7581, 784.6224, 785.9742, 801.1456, 819.3232, 825.7335],
       device='cuda:3')
used idx is  tensor([ 7,  6,  1,  0,  4,  3,  5,  2, 19, 17, 13, 15, 11,  9, 16, 18, 14, 12,
         8, 10, 25, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 89.37% 

Test Accuracy: 88.29% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3679273724555969
distance x is tensor(121.4774, device='cuda:3')
benign distance is  tensor(121.4774, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6395395994186401
distance x is tensor(131.5661, device='cuda:3')
benign distance is  tensor(131.5661, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4393637776374817
distance x is tensor(133.3471, device='cuda:3')
benign distance is  tensor(133.3471, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.49061259627342224
distance x is tensor(115.4624, device='cuda:3')
benign distance is  tensor(115.4624, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.37215834856033325
distance x is tensor(116.0295, device='cuda:3')
benign distance is  tensor(116.0295, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4214179515838623
distance x is tensor(132.1290, device='cuda:3')
benign distance is  tensor(132.1290, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5481206178665161
distance x is tensor(126.8405, device='cuda:3')
benign distance is  tensor(126.8405, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1550530642271042
distance x is tensor(101.1466, device='cuda:3')
benign distance is  tensor(101.1466, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7355388402938843
distance x is tensor(134.5467, device='cuda:3')
benign distance is  tensor(134.5467, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1557255983352661
distance x is tensor(141.1898, device='cuda:3')
benign distance is  tensor(141.1898, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.510489821434021
distance x is tensor(137.9409, device='cuda:3')
benign distance is  tensor(137.9409, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.28770503401756287
distance x is tensor(131.0163, device='cuda:3')
benign distance is  tensor(131.0163, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3878745436668396
distance x is tensor(144.6230, device='cuda:3')
benign distance is  tensor(144.6230, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.23596855998039246
distance x is tensor(132.4112, device='cuda:3')
benign distance is  tensor(132.4112, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2545415759086609
distance x is tensor(134.2561, device='cuda:3')
benign distance is  tensor(134.2561, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.11762182414531708
distance x is tensor(139.0595, device='cuda:3')
benign distance is  tensor(139.0595, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.23394116759300232
mal_entropy is 0.14804242551326752
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([534.8387, 582.4439, 584.2519, 504.6792, 500.9732, 580.9001, 551.4573,
        436.9840, 606.2817, 606.2817, 606.2817, 606.2817, 606.2817, 606.2817,
        606.2817, 606.2817, 606.2817, 606.2817, 606.2817, 606.2817, 801.2559,
        797.9390, 819.0662, 825.9878, 842.0933, 816.5082, 833.2724, 709.4225,
        746.2253, 767.7152, 764.8661, 724.7121, 731.2341, 760.7448, 767.6700,
        539.2933, 671.8036, 656.4921, 616.5741, 650.1602, 644.3132, 681.0006,
        662.4581, 612.8425], device='cuda:3')
sorted_norm is   tensor([436.9840, 500.9732, 504.6792, 534.8387, 539.2933, 551.4573, 580.9001,
        582.4439, 584.2519, 606.2817, 606.2817, 606.2817, 606.2817, 606.2817,
        606.2817, 606.2817, 606.2817, 606.2817, 606.2817, 606.2817, 606.2817,
        612.8425, 616.5741, 644.3132, 650.1602, 656.4921, 662.4581, 671.8036,
        681.0006, 709.4225, 724.7121, 731.2341, 746.2253, 760.7448, 764.8661,
        767.6700, 767.7152, 797.9390, 801.2559, 816.5082, 819.0662, 825.9878,
        833.2724, 842.0933], device='cuda:3')
used idx is  tensor([ 7,  4,  3,  0, 35,  6,  5,  1,  2, 19, 16, 18, 13, 12, 14, 17, 11, 10,
         8,  9, 15, 43, 38, 40, 39, 37, 42, 36, 41, 27, 31, 32, 28, 33, 30],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.59% 

Test Accuracy: 88.84% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.09508354961872101
distance x is tensor(108.8057, device='cuda:3')
benign distance is  tensor(108.8057, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5830288529396057
distance x is tensor(110.5354, device='cuda:3')
benign distance is  tensor(110.5354, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19518843293190002
distance x is tensor(119.0579, device='cuda:3')
benign distance is  tensor(119.0579, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6779834628105164
distance x is tensor(103.1969, device='cuda:3')
benign distance is  tensor(103.1969, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2204345166683197
distance x is tensor(112.7828, device='cuda:3')
benign distance is  tensor(112.7828, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.688755214214325
distance x is tensor(110.1074, device='cuda:3')
benign distance is  tensor(110.1074, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5006638765335083
distance x is tensor(116.5763, device='cuda:3')
benign distance is  tensor(116.5763, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.11190096288919449
distance x is tensor(108.7186, device='cuda:3')
benign distance is  tensor(108.7186, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16829876601696014
distance x is tensor(133.4123, device='cuda:3')
benign distance is  tensor(133.4123, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.10457231104373932
distance x is tensor(128.6061, device='cuda:3')
benign distance is  tensor(128.6061, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.23403790593147278
distance x is tensor(131.3058, device='cuda:3')
benign distance is  tensor(131.3058, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.44586890935897827
distance x is tensor(127.5012, device='cuda:3')
benign distance is  tensor(127.5012, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2461032122373581
distance x is tensor(128.3901, device='cuda:3')
benign distance is  tensor(128.3901, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.16288673877716064
distance x is tensor(148.4638, device='cuda:3')
benign distance is  tensor(148.4638, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.36267751455307007
distance x is tensor(127.2726, device='cuda:3')
benign distance is  tensor(127.2726, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6514096260070801
distance x is tensor(126.9968, device='cuda:3')
benign distance is  tensor(126.9968, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.23359139263629913
distance x is tensor(129.1730, device='cuda:3')
benign distance is  tensor(129.1730, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.40439778566360474
distance x is tensor(142.5894, device='cuda:3')
benign distance is  tensor(142.5894, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.16302932798862457
distance x is tensor(126.5037, device='cuda:3')
benign distance is  tensor(126.5037, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.33802738785743713
distance x is tensor(123.5311, device='cuda:3')
benign distance is  tensor(123.5311, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6758375763893127
distance x is tensor(125.0992, device='cuda:3')
benign distance is  tensor(125.0992, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6055198907852173
distance x is tensor(121.7872, device='cuda:3')
benign distance is  tensor(121.7872, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2112566977739334
distance x is tensor(144.2875, device='cuda:3')
benign distance is  tensor(144.2875, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6575220823287964
distance x is tensor(112.9716, device='cuda:3')
benign distance is  tensor(112.9716, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.14628620445728302
distance x is tensor(137.6232, device='cuda:3')
benign distance is  tensor(137.6232, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4020174443721771
distance x is tensor(122.8490, device='cuda:3')
benign distance is  tensor(122.8490, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.47704213857650757
distance x is tensor(127.5717, device='cuda:3')
benign distance is  tensor(127.5717, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.391956627368927
distance x is tensor(131.2838, device='cuda:3')
benign distance is  tensor(131.2838, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3106204569339752
distance x is tensor(131.3882, device='cuda:3')
benign distance is  tensor(131.3882, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.14429053664207458
distance x is tensor(133.5675, device='cuda:3')
benign distance is  tensor(133.5675, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.3896147608757019
distance x is tensor(132.9799, device='cuda:3')
benign distance is  tensor(132.9799, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7108871340751648
distance x is tensor(124.1831, device='cuda:3')
benign distance is  tensor(124.1831, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5582183003425598
mal_entropy is 0.06509675830602646
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([491.6540, 493.6636, 520.6952, 443.2670, 479.2639, 485.5188, 493.2549,
        479.9682, 546.9359, 546.9359, 546.9359, 546.9359, 546.9359, 546.9359,
        546.9359, 546.9359, 546.9359, 546.9359, 546.9359, 546.9359],
       device='cuda:3')
sorted_norm is   tensor([443.2670, 479.2639, 479.9682, 485.5188, 491.6540, 493.2549, 493.6636,
        520.6952, 546.9359, 546.9359, 546.9359, 546.9359, 546.9359, 546.9359,
        546.9359, 546.9359, 546.9359, 546.9359, 546.9359, 546.9359],
       device='cuda:3')
used idx is  tensor([ 3,  4,  7,  5,  0,  6,  1,  2, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 89.51% 

Test Accuracy: 88.23% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7835888862609863
distance x is tensor(115.3609, device='cuda:3')
benign distance is  tensor(115.3609, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7654620409011841
distance x is tensor(119.4482, device='cuda:3')
benign distance is  tensor(119.4482, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1732216328382492
distance x is tensor(139.6277, device='cuda:3')
benign distance is  tensor(139.6277, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9532396197319031
distance x is tensor(125.6565, device='cuda:3')
benign distance is  tensor(125.6565, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3806348145008087
distance x is tensor(113.9509, device='cuda:3')
benign distance is  tensor(113.9509, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5647386908531189
distance x is tensor(120.0460, device='cuda:3')
benign distance is  tensor(120.0460, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.09505012631416321
distance x is tensor(125.3759, device='cuda:3')
benign distance is  tensor(125.3759, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7408829927444458
distance x is tensor(106.6121, device='cuda:3')
benign distance is  tensor(106.6121, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.8988305330276489
mal_entropy is 0.08254494518041611
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([512.0824, 529.3670, 596.9869, 540.1493, 487.8398, 532.9175, 540.3175,
        468.2340, 468.2340, 468.2340, 468.2340, 468.2340, 468.2340, 468.2340,
        468.2340, 468.2340, 468.2340, 468.2340, 468.2340, 468.2340, 717.1420,
        677.9986, 725.4728, 702.3580, 712.9879, 688.4117, 691.0460, 563.5700,
        645.8996, 623.3871, 636.4691, 629.2655, 633.4824, 708.0771, 626.3767,
        619.9108], device='cuda:3')
sorted_norm is   tensor([468.2340, 468.2340, 468.2340, 468.2340, 468.2340, 468.2340, 468.2340,
        468.2340, 468.2340, 468.2340, 468.2340, 468.2340, 468.2340, 487.8398,
        512.0824, 529.3670, 532.9175, 540.1493, 540.3175, 563.5700, 596.9869,
        619.9108, 623.3871, 626.3767, 629.2655, 633.4824, 636.4691, 645.8996,
        677.9986, 688.4117, 691.0460, 702.3580, 708.0771, 712.9879, 717.1420,
        725.4728], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  4,  0,  1,  5,  3,
         6, 27,  2, 35, 29, 34, 31, 32, 30, 28], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.16% 

Test Accuracy: 87.92% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0455315113067627
distance x is tensor(131.8125, device='cuda:3')
benign distance is  tensor(131.8125, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7302473187446594
distance x is tensor(128.6133, device='cuda:3')
benign distance is  tensor(128.6133, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13184291124343872
distance x is tensor(130.5259, device='cuda:3')
benign distance is  tensor(130.5259, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7829774618148804
distance x is tensor(116.1727, device='cuda:3')
benign distance is  tensor(116.1727, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8791898488998413
distance x is tensor(119.8236, device='cuda:3')
benign distance is  tensor(119.8236, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6554065942764282
distance x is tensor(120.0544, device='cuda:3')
benign distance is  tensor(120.0544, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2893624007701874
distance x is tensor(119.9390, device='cuda:3')
benign distance is  tensor(119.9390, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.720298707485199
distance x is tensor(88.6229, device='cuda:3')
benign distance is  tensor(88.6229, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.746177613735199
distance x is tensor(151.6665, device='cuda:3')
benign distance is  tensor(151.6665, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.30637767910957336
distance x is tensor(139.4155, device='cuda:3')
benign distance is  tensor(139.4155, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3206079602241516
distance x is tensor(145.3242, device='cuda:3')
benign distance is  tensor(145.3242, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5468654036521912
distance x is tensor(146.4943, device='cuda:3')
benign distance is  tensor(146.4943, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5841382145881653
distance x is tensor(141.6098, device='cuda:3')
benign distance is  tensor(141.6098, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.46006831526756287
distance x is tensor(133.7370, device='cuda:3')
benign distance is  tensor(133.7370, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2272435426712036
distance x is tensor(131.6513, device='cuda:3')
benign distance is  tensor(131.6513, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2510776221752167
distance x is tensor(142.2496, device='cuda:3')
benign distance is  tensor(142.2496, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.18973954021930695
distance x is tensor(153.6499, device='cuda:3')
benign distance is  tensor(153.6499, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5161498785018921
distance x is tensor(144.3907, device='cuda:3')
benign distance is  tensor(144.3907, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6762418746948242
distance x is tensor(152.5682, device='cuda:3')
benign distance is  tensor(152.5682, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.14842143654823303
distance x is tensor(157.2768, device='cuda:3')
benign distance is  tensor(157.2768, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.3692086935043335
distance x is tensor(152.2616, device='cuda:3')
benign distance is  tensor(152.2616, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.49367719888687134
distance x is tensor(134.2325, device='cuda:3')
benign distance is  tensor(134.2325, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3717275857925415
distance x is tensor(135.1066, device='cuda:3')
benign distance is  tensor(135.1066, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.09753932058811188
distance x is tensor(124.5520, device='cuda:3')
benign distance is  tensor(124.5520, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.08730939030647278
mal_entropy is 0.0994323194026947
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([575.3366, 577.3634, 565.8479, 504.9637, 505.0214, 521.7840, 514.9522,
        383.7476, 569.5165, 569.5165, 569.5165, 569.5165, 569.5165, 569.5165,
        569.5165, 569.5165, 569.5165, 569.5165, 569.5165, 569.5165, 638.9978,
        693.6717, 621.8779, 619.7003, 620.9045, 603.2442, 696.7795, 574.7694],
       device='cuda:3')
sorted_norm is   tensor([383.7476, 504.9637, 505.0214, 514.9522, 521.7840, 565.8479, 569.5165,
        569.5165, 569.5165, 569.5165, 569.5165, 569.5165, 569.5165, 569.5165,
        569.5165, 569.5165, 569.5165, 569.5165, 574.7694, 575.3366, 577.3634,
        603.2442, 619.7003, 620.9045, 621.8779, 638.9978, 693.6717, 696.7795],
       device='cuda:3')
used idx is  tensor([ 7,  3,  4,  6,  5,  2, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,
        27,  0,  1, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.57% 

Test Accuracy: 88.32% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6334555149078369
distance x is tensor(128.3036, device='cuda:3')
benign distance is  tensor(128.3036, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45066308975219727
distance x is tensor(132.2617, device='cuda:3')
benign distance is  tensor(132.2617, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11422183364629745
distance x is tensor(124.8389, device='cuda:3')
benign distance is  tensor(124.8389, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7512245774269104
distance x is tensor(123.5870, device='cuda:3')
benign distance is  tensor(123.5870, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.754371166229248
distance x is tensor(106.0147, device='cuda:3')
benign distance is  tensor(106.0147, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.21458466351032257
distance x is tensor(125.4448, device='cuda:3')
benign distance is  tensor(125.4448, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.07953860610723495
distance x is tensor(127.9542, device='cuda:3')
benign distance is  tensor(127.9542, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5574777722358704
distance x is tensor(96.6787, device='cuda:3')
benign distance is  tensor(96.6787, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3229448199272156
distance x is tensor(146.2178, device='cuda:3')
benign distance is  tensor(146.2178, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5321923494338989
distance x is tensor(152.1920, device='cuda:3')
benign distance is  tensor(152.1920, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.28778812289237976
distance x is tensor(135.9662, device='cuda:3')
benign distance is  tensor(135.9662, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.17769555747509003
distance x is tensor(139.4573, device='cuda:3')
benign distance is  tensor(139.4573, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4829785227775574
distance x is tensor(140.4304, device='cuda:3')
benign distance is  tensor(140.4304, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3856622576713562
distance x is tensor(147.1718, device='cuda:3')
benign distance is  tensor(147.1718, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.05827414244413376
distance x is tensor(150.5142, device='cuda:3')
benign distance is  tensor(150.5142, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5537480115890503
distance x is tensor(126.1765, device='cuda:3')
benign distance is  tensor(126.1765, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.20297923684120178
mal_entropy is 0.12658905982971191
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([572.9286, 591.2065, 550.1027, 532.0270, 483.6248, 558.4327, 529.7611,
        412.5652, 545.6200, 545.6200, 545.6200, 545.6200, 545.6200, 545.6200,
        545.6200, 545.6200, 545.6200, 545.6200, 545.6200, 545.6200, 735.8955,
        751.9938, 759.1187, 730.4996, 779.4055, 728.6994, 718.1061, 608.0007,
        720.1367, 670.4232, 708.4729, 704.3375, 695.5771, 666.9128, 657.7695,
        712.2141], device='cuda:3')
sorted_norm is   tensor([412.5652, 483.6248, 529.7611, 532.0270, 545.6200, 545.6200, 545.6200,
        545.6200, 545.6200, 545.6200, 545.6200, 545.6200, 545.6200, 545.6200,
        545.6200, 545.6200, 550.1027, 558.4327, 572.9286, 591.2065, 608.0007,
        657.7695, 666.9128, 670.4232, 695.5771, 704.3375, 708.4729, 712.2141,
        718.1061, 720.1367, 728.6994, 730.4996, 735.8955, 751.9938, 759.1187,
        779.4055], device='cuda:3')
used idx is  tensor([ 7,  4,  6,  3, 13, 12, 14, 15, 11, 10,  8,  9, 19, 18, 16, 17,  2,  5,
         0,  1, 27, 34, 33, 29, 32, 31, 30, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 89.46% 

Test Accuracy: 88.64% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9404020309448242
distance x is tensor(124.0412, device='cuda:3')
benign distance is  tensor(124.0412, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.477583646774292
distance x is tensor(124.3830, device='cuda:3')
benign distance is  tensor(124.3830, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.33075159788131714
distance x is tensor(124.9019, device='cuda:3')
benign distance is  tensor(124.9019, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5066426396369934
distance x is tensor(112.0873, device='cuda:3')
benign distance is  tensor(112.0873, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7904701232910156
distance x is tensor(125.0336, device='cuda:3')
benign distance is  tensor(125.0336, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.378917396068573
distance x is tensor(119.0494, device='cuda:3')
benign distance is  tensor(119.0494, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2473902702331543
distance x is tensor(119.9520, device='cuda:3')
benign distance is  tensor(119.9520, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5164440274238586
distance x is tensor(85.5092, device='cuda:3')
benign distance is  tensor(85.5092, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1816808432340622
distance x is tensor(152.1297, device='cuda:3')
benign distance is  tensor(152.1297, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5534799695014954
distance x is tensor(132.5923, device='cuda:3')
benign distance is  tensor(132.5923, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.19437633454799652
distance x is tensor(128.5667, device='cuda:3')
benign distance is  tensor(128.5667, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3951873779296875
distance x is tensor(130.2541, device='cuda:3')
benign distance is  tensor(130.2541, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.21155166625976562
distance x is tensor(125.3609, device='cuda:3')
benign distance is  tensor(125.3609, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.11198440939188004
distance x is tensor(136.0676, device='cuda:3')
benign distance is  tensor(136.0676, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.16712114214897156
distance x is tensor(128.5486, device='cuda:3')
benign distance is  tensor(128.5486, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8301104307174683
distance x is tensor(123.8476, device='cuda:3')
benign distance is  tensor(123.8476, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.203884556889534
distance x is tensor(133.2146, device='cuda:3')
benign distance is  tensor(133.2146, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.06991754472255707
distance x is tensor(141.9678, device='cuda:3')
benign distance is  tensor(141.9678, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.10473810136318207
distance x is tensor(138.9562, device='cuda:3')
benign distance is  tensor(138.9562, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.045572876930236816
distance x is tensor(131.9455, device='cuda:3')
benign distance is  tensor(131.9455, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4755552411079407
distance x is tensor(139.3597, device='cuda:3')
benign distance is  tensor(139.3597, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3650990128517151
distance x is tensor(133.9997, device='cuda:3')
benign distance is  tensor(133.9997, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.21480397880077362
distance x is tensor(127.0602, device='cuda:3')
benign distance is  tensor(127.0602, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.583905041217804
distance x is tensor(116.9303, device='cuda:3')
benign distance is  tensor(116.9303, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.19060735404491425
mal_entropy is 0.0627223402261734
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([545.7026, 550.0218, 539.8355, 499.6027, 533.8597, 518.5580, 520.3724,
        376.9942, 501.8624, 501.8624, 501.8624, 501.8624, 501.8624, 501.8624,
        501.8624, 501.8624, 501.8624, 501.8624, 501.8624, 501.8624],
       device='cuda:3')
sorted_norm is   tensor([376.9942, 499.6027, 501.8624, 501.8624, 501.8624, 501.8624, 501.8624,
        501.8624, 501.8624, 501.8624, 501.8624, 501.8624, 501.8624, 501.8624,
        518.5580, 520.3724, 533.8597, 539.8355, 545.7026, 550.0218],
       device='cuda:3')
used idx is  tensor([ 7,  3, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  5,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 88.77% 

Test Accuracy: 87.81% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6054158210754395
distance x is tensor(137.5077, device='cuda:3')
benign distance is  tensor(137.5077, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3271812200546265
distance x is tensor(137.6601, device='cuda:3')
benign distance is  tensor(137.6601, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7446908950805664
distance x is tensor(144.0871, device='cuda:3')
benign distance is  tensor(144.0871, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2588825523853302
distance x is tensor(141.7454, device='cuda:3')
benign distance is  tensor(141.7454, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5746153593063354
distance x is tensor(127.1884, device='cuda:3')
benign distance is  tensor(127.1884, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6240858435630798
distance x is tensor(143.4823, device='cuda:3')
benign distance is  tensor(143.4823, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8415535092353821
distance x is tensor(129.2108, device='cuda:3')
benign distance is  tensor(129.2108, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.06313879787921906
distance x is tensor(105.7343, device='cuda:3')
benign distance is  tensor(105.7343, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.1921984702348709
mal_entropy is 0.148904949426651
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([584.2048, 592.5146, 618.1557, 614.1463, 551.9794, 622.5303, 560.5614,
        453.0087, 453.0087, 453.0087, 453.0087, 453.0087, 453.0087, 453.0087,
        453.0087, 453.0087, 453.0087, 453.0087, 453.0087, 453.0087, 803.7391,
        756.5315, 771.7066, 781.9865, 786.3952, 791.4844, 788.2234, 667.7200,
        835.9720, 789.2175, 822.7199, 825.6465, 831.8386, 771.4598, 767.2031,
        598.8453, 777.8949, 800.2222, 736.3179, 770.6472, 758.9273, 787.1432,
        802.3854, 522.8109, 756.4149, 683.0737, 678.8068, 687.5026, 669.9703,
        698.6713, 676.6649, 660.4749], device='cuda:3')
sorted_norm is   tensor([453.0087, 453.0087, 453.0087, 453.0087, 453.0087, 453.0087, 453.0087,
        453.0087, 453.0087, 453.0087, 453.0087, 453.0087, 453.0087, 522.8109,
        551.9794, 560.5614, 584.2048, 592.5146, 598.8453, 614.1463, 618.1557,
        622.5303, 660.4749, 667.7200, 669.9703, 676.6649, 678.8068, 683.0737,
        687.5026, 698.6713, 736.3179, 756.4149, 756.5315, 758.9273, 767.2031,
        770.6472, 771.4598, 771.7066, 777.8949, 781.9865, 786.3952, 787.1432,
        788.2234, 789.2175, 791.4844, 800.2222, 802.3854, 803.7391, 822.7199,
        825.6465, 831.8386, 835.9720], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 43,  4,  6,  0,  1,
        35,  3,  2,  5, 51, 27, 48, 50, 46, 45, 47, 49, 38, 44, 21, 40, 34, 39,
        33, 22, 36, 23, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.49% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4111059308052063
distance x is tensor(122.0505, device='cuda:3')
benign distance is  tensor(122.0505, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0069376230239868
distance x is tensor(127.3481, device='cuda:3')
benign distance is  tensor(127.3481, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07421411573886871
distance x is tensor(121.9301, device='cuda:3')
benign distance is  tensor(121.9301, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.637600302696228
distance x is tensor(120.8867, device='cuda:3')
benign distance is  tensor(120.8867, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.362370103597641
distance x is tensor(114.8294, device='cuda:3')
benign distance is  tensor(114.8294, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5836762189865112
distance x is tensor(120.6654, device='cuda:3')
benign distance is  tensor(120.6654, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2716333866119385
distance x is tensor(121.0937, device='cuda:3')
benign distance is  tensor(121.0937, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3582107722759247
distance x is tensor(68.9700, device='cuda:3')
benign distance is  tensor(68.9700, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2038552463054657
distance x is tensor(143.5096, device='cuda:3')
benign distance is  tensor(143.5096, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.45896977186203003
distance x is tensor(143.5695, device='cuda:3')
benign distance is  tensor(143.5695, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5364002585411072
distance x is tensor(116.2262, device='cuda:3')
benign distance is  tensor(116.2262, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.37479209899902344
distance x is tensor(129.6829, device='cuda:3')
benign distance is  tensor(129.6829, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.40826550126075745
distance x is tensor(128.9291, device='cuda:3')
benign distance is  tensor(128.9291, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15553399920463562
distance x is tensor(137.1422, device='cuda:3')
benign distance is  tensor(137.1422, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6011818647384644
distance x is tensor(130.9681, device='cuda:3')
benign distance is  tensor(130.9681, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.826653778553009
distance x is tensor(125.0258, device='cuda:3')
benign distance is  tensor(125.0258, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.21576456725597382
distance x is tensor(135.0449, device='cuda:3')
benign distance is  tensor(135.0449, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5682465434074402
distance x is tensor(148.0683, device='cuda:3')
benign distance is  tensor(148.0683, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.06279240548610687
distance x is tensor(138.1797, device='cuda:3')
benign distance is  tensor(138.1797, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.36301130056381226
distance x is tensor(143.1325, device='cuda:3')
benign distance is  tensor(143.1325, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3076106607913971
distance x is tensor(137.4690, device='cuda:3')
benign distance is  tensor(137.4690, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3852785527706146
distance x is tensor(137.5351, device='cuda:3')
benign distance is  tensor(137.5351, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.23627729713916779
distance x is tensor(146.9878, device='cuda:3')
benign distance is  tensor(146.9878, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4067535400390625
distance x is tensor(118.0900, device='cuda:3')
benign distance is  tensor(118.0900, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2895325720310211
distance x is tensor(153.3518, device='cuda:3')
benign distance is  tensor(153.3518, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8766521215438843
distance x is tensor(135.3362, device='cuda:3')
benign distance is  tensor(135.3362, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.15833330154418945
distance x is tensor(151.3545, device='cuda:3')
benign distance is  tensor(151.3545, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.21662771701812744
distance x is tensor(144.5202, device='cuda:3')
benign distance is  tensor(144.5202, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6573978662490845
distance x is tensor(149.7305, device='cuda:3')
benign distance is  tensor(149.7305, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6601047515869141
distance x is tensor(141.2400, device='cuda:3')
benign distance is  tensor(141.2400, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6230149865150452
distance x is tensor(143.0125, device='cuda:3')
benign distance is  tensor(143.0125, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.37894460558891296
distance x is tensor(136.6585, device='cuda:3')
benign distance is  tensor(136.6585, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2950785458087921
distance x is tensor(144.2590, device='cuda:3')
benign distance is  tensor(144.2590, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.48986291885375977
distance x is tensor(137.7485, device='cuda:3')
benign distance is  tensor(137.7485, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.40873995423316956
distance x is tensor(135.8456, device='cuda:3')
benign distance is  tensor(135.8456, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.14893366396427155
distance x is tensor(140.9191, device='cuda:3')
benign distance is  tensor(140.9191, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3916763663291931
distance x is tensor(129.5318, device='cuda:3')
benign distance is  tensor(129.5318, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.31513112783432007
distance x is tensor(145.2137, device='cuda:3')
benign distance is  tensor(145.2137, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6768800020217896
distance x is tensor(146.9979, device='cuda:3')
benign distance is  tensor(146.9979, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.19232478737831116
distance x is tensor(125.6226, device='cuda:3')
benign distance is  tensor(125.6226, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.2890075147151947
mal_entropy is 0.06311634927988052
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([543.7598, 556.1309, 526.5281, 525.9236, 501.6181, 529.8660, 517.6452,
        291.7394, 560.9890, 560.9890, 560.9890, 560.9890, 560.9890, 560.9890,
        560.9890, 560.9890, 560.9890, 560.9890, 560.9890, 560.9890],
       device='cuda:3')
sorted_norm is   tensor([291.7394, 501.6181, 517.6452, 525.9236, 526.5281, 529.8660, 543.7598,
        556.1309, 560.9890, 560.9890, 560.9890, 560.9890, 560.9890, 560.9890,
        560.9890, 560.9890, 560.9890, 560.9890, 560.9890, 560.9890],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  3,  2,  5,  0,  1, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 89.82% 

Test Accuracy: 88.41% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2779622972011566
distance x is tensor(144.7765, device='cuda:3')
benign distance is  tensor(144.7765, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3619029223918915
distance x is tensor(125.5202, device='cuda:3')
benign distance is  tensor(125.5202, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10048843920230865
distance x is tensor(135.7138, device='cuda:3')
benign distance is  tensor(135.7138, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47583475708961487
distance x is tensor(130.6351, device='cuda:3')
benign distance is  tensor(130.6351, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.436500608921051
distance x is tensor(113.7886, device='cuda:3')
benign distance is  tensor(113.7886, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6356105208396912
distance x is tensor(131.4321, device='cuda:3')
benign distance is  tensor(131.4321, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13183525204658508
distance x is tensor(115.8705, device='cuda:3')
benign distance is  tensor(115.8705, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1853783130645752
distance x is tensor(88.7118, device='cuda:3')
benign distance is  tensor(88.7118, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3425000309944153
mal_entropy is 0.10425613075494766
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([643.7612, 544.9136, 587.0715, 574.9535, 489.7544, 571.8834, 499.4860,
        388.9892, 388.9892, 388.9892, 388.9892, 388.9892, 388.9892, 388.9892,
        388.9892, 388.9892, 388.9892, 388.9892, 388.9892, 388.9892, 700.7745,
        675.9659, 588.9789, 642.0259, 634.5326, 661.7894, 632.4025, 624.3790],
       device='cuda:3')
sorted_norm is   tensor([388.9892, 388.9892, 388.9892, 388.9892, 388.9892, 388.9892, 388.9892,
        388.9892, 388.9892, 388.9892, 388.9892, 388.9892, 388.9892, 489.7544,
        499.4860, 544.9136, 571.8834, 574.9535, 587.0715, 588.9789, 624.3790,
        632.4025, 634.5326, 642.0259, 643.7612, 661.7894, 675.9659, 700.7745],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14,  7, 11, 10,  8,  9, 15,  4,  6,  1,  5,  3,
         2, 22, 27, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.62% 

Test Accuracy: 88.84% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4571940302848816
distance x is tensor(128.9696, device='cuda:3')
benign distance is  tensor(128.9696, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5289015769958496
distance x is tensor(135.4849, device='cuda:3')
benign distance is  tensor(135.4849, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.48853597044944763
distance x is tensor(146.6274, device='cuda:3')
benign distance is  tensor(146.6274, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7925033569335938
distance x is tensor(133.4587, device='cuda:3')
benign distance is  tensor(133.4587, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4362815022468567
distance x is tensor(114.0550, device='cuda:3')
benign distance is  tensor(114.0550, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6362455487251282
distance x is tensor(154.7319, device='cuda:3')
benign distance is  tensor(154.7319, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3199193775653839
distance x is tensor(144.4779, device='cuda:3')
benign distance is  tensor(144.4779, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6275867223739624
distance x is tensor(62.0452, device='cuda:3')
benign distance is  tensor(62.0452, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.15292277932167053
distance x is tensor(161.3919, device='cuda:3')
benign distance is  tensor(161.3919, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7264996767044067
distance x is tensor(149.6385, device='cuda:3')
benign distance is  tensor(149.6385, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.26838862895965576
distance x is tensor(142.2992, device='cuda:3')
benign distance is  tensor(142.2992, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2703856825828552
distance x is tensor(153.3141, device='cuda:3')
benign distance is  tensor(153.3141, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3420582413673401
distance x is tensor(136.8226, device='cuda:3')
benign distance is  tensor(136.8226, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1396174132823944
distance x is tensor(156.1411, device='cuda:3')
benign distance is  tensor(156.1411, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.33444109559059143
distance x is tensor(147.0544, device='cuda:3')
benign distance is  tensor(147.0544, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.100429892539978
distance x is tensor(145.9989, device='cuda:3')
benign distance is  tensor(145.9989, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.4645617604255676
mal_entropy is 0.06980519741773605
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([568.2396, 599.3306, 639.1196, 581.9234, 485.3816, 688.7704, 617.8757,
        269.4819, 632.5945, 632.5944, 632.5945, 632.5944, 632.5945, 632.5944,
        632.5945, 632.5944, 632.5945, 632.5944, 632.5945, 632.5944, 713.6568,
        737.6522, 725.6375, 707.3713, 735.3484, 707.7908, 689.4524, 525.2211,
        682.2185, 731.1736, 689.8560, 707.3030, 678.7048, 685.8886, 735.1928,
        609.9185], device='cuda:3')
sorted_norm is   tensor([269.4819, 485.3816, 525.2211, 568.2396, 581.9234, 599.3306, 609.9185,
        617.8757, 632.5944, 632.5944, 632.5944, 632.5944, 632.5944, 632.5944,
        632.5945, 632.5945, 632.5945, 632.5945, 632.5945, 632.5945, 639.1196,
        678.7048, 682.2185, 685.8886, 688.7704, 689.4524, 689.8560, 707.3030,
        707.3713, 707.7908, 713.6568, 725.6375, 731.1736, 735.1928, 735.3484,
        737.6522], device='cuda:3')
used idx is  tensor([ 7,  4, 27,  0,  3,  1, 35,  6, 11, 15, 13,  9, 19, 17, 16, 10,  8, 12,
        14, 18,  2, 32, 28, 33,  5, 26, 30, 31], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 89.28% 

Test Accuracy: 88.07% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7479755878448486
distance x is tensor(115.3538, device='cuda:3')
benign distance is  tensor(115.3538, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6159626841545105
distance x is tensor(130.2645, device='cuda:3')
benign distance is  tensor(130.2645, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5589162707328796
distance x is tensor(131.9014, device='cuda:3')
benign distance is  tensor(131.9014, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5755708813667297
distance x is tensor(117.7300, device='cuda:3')
benign distance is  tensor(117.7300, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7659638524055481
distance x is tensor(112.6648, device='cuda:3')
benign distance is  tensor(112.6648, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0584049224853516
distance x is tensor(125.8272, device='cuda:3')
benign distance is  tensor(125.8272, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22856655716896057
distance x is tensor(130.9698, device='cuda:3')
benign distance is  tensor(130.9698, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.815356433391571
distance x is tensor(71.1098, device='cuda:3')
benign distance is  tensor(71.1098, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.06631341576576233
distance x is tensor(137.2666, device='cuda:3')
benign distance is  tensor(137.2666, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3953102827072144
distance x is tensor(157.1028, device='cuda:3')
benign distance is  tensor(157.1028, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.19895072281360626
distance x is tensor(142.1719, device='cuda:3')
benign distance is  tensor(142.1719, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.25306183099746704
distance x is tensor(138.7421, device='cuda:3')
benign distance is  tensor(138.7421, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6678019762039185
distance x is tensor(141.9000, device='cuda:3')
benign distance is  tensor(141.9000, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7067413926124573
distance x is tensor(123.5025, device='cuda:3')
benign distance is  tensor(123.5025, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.336540162563324
distance x is tensor(146.1378, device='cuda:3')
benign distance is  tensor(146.1378, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.18910956382751465
distance x is tensor(126.0865, device='cuda:3')
benign distance is  tensor(126.0865, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6997700929641724
distance x is tensor(142.6360, device='cuda:3')
benign distance is  tensor(142.6360, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3042539656162262
distance x is tensor(147.4039, device='cuda:3')
benign distance is  tensor(147.4039, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.2784486413002014
distance x is tensor(138.2517, device='cuda:3')
benign distance is  tensor(138.2517, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.12520454823970795
distance x is tensor(128.8777, device='cuda:3')
benign distance is  tensor(128.8777, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6542971730232239
distance x is tensor(137.8445, device='cuda:3')
benign distance is  tensor(137.8445, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5268369913101196
distance x is tensor(141.1176, device='cuda:3')
benign distance is  tensor(141.1176, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.224053978919983
distance x is tensor(146.5034, device='cuda:3')
benign distance is  tensor(146.5034, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3957313299179077
distance x is tensor(123.0068, device='cuda:3')
benign distance is  tensor(123.0068, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6259973645210266
mal_entropy is 0.043734095990657806
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([504.7853, 575.6089, 583.5047, 509.1243, 488.2798, 544.9128, 559.2549,
        303.0971, 535.7803, 535.7803, 535.7803, 535.7803, 535.7803, 535.7803,
        535.7803, 535.7803, 535.7803, 535.7803, 535.7803, 535.7803, 758.2280,
        682.6577, 734.1964, 721.1161, 734.4724, 712.7675, 724.1946, 702.4642,
        757.0839, 700.5122, 677.1900, 727.7582, 658.7294, 724.1882, 692.7386,
        378.0184], device='cuda:3')
sorted_norm is   tensor([303.0971, 378.0184, 488.2798, 504.7853, 509.1243, 535.7803, 535.7803,
        535.7803, 535.7803, 535.7803, 535.7803, 535.7803, 535.7803, 535.7803,
        535.7803, 535.7803, 535.7803, 544.9128, 559.2549, 575.6089, 583.5047,
        658.7294, 677.1900, 682.6577, 692.7386, 700.5122, 702.4642, 712.7675,
        721.1161, 724.1882, 724.1946, 727.7582, 734.1964, 734.4724, 757.0839,
        758.2280], device='cuda:3')
used idx is  tensor([ 7, 35,  4,  0,  3, 13, 14, 12, 11, 10,  8, 15, 19, 18, 16, 17,  9,  5,
         6,  1,  2, 32, 30, 21, 34, 29, 27, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.43% 

Test Accuracy: 88.47% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5009318590164185
distance x is tensor(138.3155, device='cuda:3')
benign distance is  tensor(138.3155, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.187809944152832
distance x is tensor(131.4423, device='cuda:3')
benign distance is  tensor(131.4423, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06986118853092194
distance x is tensor(129.3412, device='cuda:3')
benign distance is  tensor(129.3412, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6165817975997925
distance x is tensor(110.6509, device='cuda:3')
benign distance is  tensor(110.6509, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.48435816168785095
distance x is tensor(130.4817, device='cuda:3')
benign distance is  tensor(130.4817, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0371743440628052
distance x is tensor(137.1897, device='cuda:3')
benign distance is  tensor(137.1897, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3069579303264618
distance x is tensor(122.2797, device='cuda:3')
benign distance is  tensor(122.2797, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.23120279610157013
distance x is tensor(92.8519, device='cuda:3')
benign distance is  tensor(92.8519, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4416618347167969
distance x is tensor(147.4586, device='cuda:3')
benign distance is  tensor(147.4586, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6392414569854736
distance x is tensor(143.7609, device='cuda:3')
benign distance is  tensor(143.7609, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.47003012895584106
distance x is tensor(148.3849, device='cuda:3')
benign distance is  tensor(148.3849, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2832469642162323
distance x is tensor(156.7402, device='cuda:3')
benign distance is  tensor(156.7402, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7408615946769714
distance x is tensor(140.8764, device='cuda:3')
benign distance is  tensor(140.8764, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.16944551467895508
distance x is tensor(138.2071, device='cuda:3')
benign distance is  tensor(138.2071, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.1417447328567505
distance x is tensor(142.7921, device='cuda:3')
benign distance is  tensor(142.7921, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.303071528673172
distance x is tensor(124.2082, device='cuda:3')
benign distance is  tensor(124.2082, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.06014270707964897
distance x is tensor(152.5358, device='cuda:3')
benign distance is  tensor(152.5358, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7678383588790894
distance x is tensor(146.7707, device='cuda:3')
benign distance is  tensor(146.7707, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4812661111354828
distance x is tensor(155.0830, device='cuda:3')
benign distance is  tensor(155.0830, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3555179238319397
distance x is tensor(153.4443, device='cuda:3')
benign distance is  tensor(153.4443, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.4841253161430359
distance x is tensor(147.3224, device='cuda:3')
benign distance is  tensor(147.3224, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6648693084716797
distance x is tensor(152.5544, device='cuda:3')
benign distance is  tensor(152.5544, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.40713953971862793
distance x is tensor(153.0694, device='cuda:3')
benign distance is  tensor(153.0694, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.23174333572387695
distance x is tensor(130.6315, device='cuda:3')
benign distance is  tensor(130.6315, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.28170114755630493
mal_entropy is 0.08988716453313828
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([601.9329, 571.8877, 564.5004, 484.6192, 566.7388, 601.1825, 534.7086,
        396.0496, 586.5352, 586.5352, 586.5352, 586.5352, 586.5352, 586.5352,
        586.5352, 586.5352, 586.5352, 586.5352, 586.5352, 586.5352],
       device='cuda:3')
sorted_norm is   tensor([396.0496, 484.6192, 534.7086, 564.5004, 566.7388, 571.8877, 586.5352,
        586.5352, 586.5352, 586.5352, 586.5352, 586.5352, 586.5352, 586.5352,
        586.5352, 586.5352, 586.5352, 586.5352, 601.1825, 601.9329],
       device='cuda:3')
used idx is  tensor([ 7,  3,  6,  2,  4,  1, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 89.33% 

Test Accuracy: 88.17% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4094446301460266
distance x is tensor(141.2297, device='cuda:3')
benign distance is  tensor(141.2297, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0680506229400635
distance x is tensor(136.3056, device='cuda:3')
benign distance is  tensor(136.3056, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.49235400557518005
distance x is tensor(135.0941, device='cuda:3')
benign distance is  tensor(135.0941, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7251997590065002
distance x is tensor(125.3683, device='cuda:3')
benign distance is  tensor(125.3683, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.15709154307842255
distance x is tensor(123.7923, device='cuda:3')
benign distance is  tensor(123.7923, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6368634700775146
distance x is tensor(138.5010, device='cuda:3')
benign distance is  tensor(138.5010, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.08172200620174408
distance x is tensor(142.3713, device='cuda:3')
benign distance is  tensor(142.3713, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4046934247016907
distance x is tensor(88.3362, device='cuda:3')
benign distance is  tensor(88.3362, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.771968424320221
mal_entropy is 0.015646817162632942
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([622.8945, 609.7195, 576.0286, 534.8591, 535.4431, 609.9013, 608.6351,
        388.3017, 388.3017, 388.3017, 388.3017, 388.3017, 388.3017, 388.3017,
        388.3017, 388.3017, 388.3017, 388.3017, 388.3017, 388.3017, 802.9904,
        783.0949, 780.6019, 805.8309, 766.1248, 820.0286, 805.3480, 665.8077,
        741.4301, 794.4348, 752.2747, 753.9622, 746.5573, 702.6379, 787.3788,
        707.3732, 745.6144, 724.2397, 744.4888, 770.5500, 709.8217, 709.0813,
        721.3492, 654.5616], device='cuda:3')
sorted_norm is   tensor([388.3017, 388.3017, 388.3017, 388.3017, 388.3017, 388.3017, 388.3017,
        388.3017, 388.3017, 388.3017, 388.3017, 388.3017, 388.3017, 534.8591,
        535.4431, 576.0286, 608.6351, 609.7195, 609.9013, 622.8945, 654.5616,
        665.8077, 702.6379, 707.3732, 709.0813, 709.8217, 721.3492, 724.2397,
        741.4301, 744.4888, 745.6144, 746.5573, 752.2747, 753.9622, 766.1248,
        770.5500, 780.6019, 783.0949, 787.3788, 794.4348, 802.9904, 805.3480,
        805.8309, 820.0286], device='cuda:3')
used idx is  tensor([10,  8, 18, 16, 12, 14, 17, 19,  7, 13,  9, 15, 11,  3,  4,  2,  6,  1,
         5,  0, 43, 27, 33, 35, 41, 40, 42, 37, 28, 38, 36, 32, 30, 31, 24],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 90.04% 

Test Accuracy: 88.96% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.29807043075561523
distance x is tensor(129.1573, device='cuda:3')
benign distance is  tensor(129.1573, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8223770260810852
distance x is tensor(128.5407, device='cuda:3')
benign distance is  tensor(128.5407, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.04478241875767708
distance x is tensor(136.4624, device='cuda:3')
benign distance is  tensor(136.4624, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7471765875816345
distance x is tensor(119.6851, device='cuda:3')
benign distance is  tensor(119.6851, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6307488679885864
distance x is tensor(110.7494, device='cuda:3')
benign distance is  tensor(110.7494, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6888698935508728
distance x is tensor(121.9227, device='cuda:3')
benign distance is  tensor(121.9227, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.41756582260131836
distance x is tensor(126.5533, device='cuda:3')
benign distance is  tensor(126.5533, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.553454577922821
distance x is tensor(49.8607, device='cuda:3')
benign distance is  tensor(49.8607, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5172213315963745
distance x is tensor(149.0439, device='cuda:3')
benign distance is  tensor(149.0439, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5156230926513672
distance x is tensor(146.0228, device='cuda:3')
benign distance is  tensor(146.0228, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.23949959874153137
distance x is tensor(139.0210, device='cuda:3')
benign distance is  tensor(139.0210, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.19401061534881592
distance x is tensor(158.9519, device='cuda:3')
benign distance is  tensor(158.9519, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.491774320602417
distance x is tensor(137.8115, device='cuda:3')
benign distance is  tensor(137.8115, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4998158812522888
distance x is tensor(162.9921, device='cuda:3')
benign distance is  tensor(162.9921, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.062309931963682175
distance x is tensor(142.5170, device='cuda:3')
benign distance is  tensor(142.5170, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2940620481967926
distance x is tensor(117.1173, device='cuda:3')
benign distance is  tensor(117.1173, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4827871322631836
distance x is tensor(144.0497, device='cuda:3')
benign distance is  tensor(144.0497, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6800862550735474
distance x is tensor(169.0045, device='cuda:3')
benign distance is  tensor(169.0045, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.05854909494519234
distance x is tensor(143.9665, device='cuda:3')
benign distance is  tensor(143.9665, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.33486616611480713
distance x is tensor(138.9252, device='cuda:3')
benign distance is  tensor(138.9252, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6303935050964355
distance x is tensor(148.0553, device='cuda:3')
benign distance is  tensor(148.0553, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2982581853866577
distance x is tensor(141.4309, device='cuda:3')
benign distance is  tensor(141.4309, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.1985677182674408
distance x is tensor(160.6629, device='cuda:3')
benign distance is  tensor(160.6629, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6006464958190918
distance x is tensor(125.6262, device='cuda:3')
benign distance is  tensor(125.6262, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.15430982410907745
distance x is tensor(144.7573, device='cuda:3')
benign distance is  tensor(144.7573, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3707656264305115
distance x is tensor(142.8496, device='cuda:3')
benign distance is  tensor(142.8496, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.43998709321022034
distance x is tensor(158.0288, device='cuda:3')
benign distance is  tensor(158.0288, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2506711781024933
distance x is tensor(145.7716, device='cuda:3')
benign distance is  tensor(145.7716, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.14952382445335388
distance x is tensor(138.2070, device='cuda:3')
benign distance is  tensor(138.2070, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.12013649940490723
distance x is tensor(149.5739, device='cuda:3')
benign distance is  tensor(149.5739, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.43754807114601135
distance x is tensor(161.8737, device='cuda:3')
benign distance is  tensor(161.8737, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2791360318660736
distance x is tensor(121.8639, device='cuda:3')
benign distance is  tensor(121.8639, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.36275357007980347
mal_entropy is 0.05984354764223099
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([563.6549, 565.3924, 605.8492, 508.3080, 479.2542, 533.4114, 542.5137,
        223.1450, 535.1341, 535.1341, 535.1341, 535.1341, 535.1341, 535.1341,
        535.1341, 535.1341, 535.1341, 535.1341, 535.1341, 535.1341],
       device='cuda:3')
sorted_norm is   tensor([223.1450, 479.2542, 508.3080, 533.4114, 535.1341, 535.1341, 535.1341,
        535.1341, 535.1341, 535.1341, 535.1341, 535.1341, 535.1341, 535.1341,
        535.1341, 535.1341, 542.5137, 563.6549, 565.3924, 605.8492],
       device='cuda:3')
used idx is  tensor([ 7,  4,  3,  5, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 88.92% 

Test Accuracy: 88.15% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.22196392714977264
distance x is tensor(145.3545, device='cuda:3')
benign distance is  tensor(145.3545, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0187034606933594
distance x is tensor(146.2625, device='cuda:3')
benign distance is  tensor(146.2625, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.047850798815488815
distance x is tensor(137.4252, device='cuda:3')
benign distance is  tensor(137.4252, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.42177635431289673
distance x is tensor(148.4527, device='cuda:3')
benign distance is  tensor(148.4527, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.49684858322143555
distance x is tensor(130.1955, device='cuda:3')
benign distance is  tensor(130.1955, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3477707803249359
distance x is tensor(161.7223, device='cuda:3')
benign distance is  tensor(161.7223, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11616271734237671
distance x is tensor(132.3392, device='cuda:3')
benign distance is  tensor(132.3392, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2723845839500427
distance x is tensor(89.2827, device='cuda:3')
benign distance is  tensor(89.2827, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.9008125066757202
mal_entropy is 0.04387664794921875
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([620.7946, 640.8882, 581.2924, 638.9979, 563.3356, 705.5870, 560.4012,
        392.3659, 392.3659, 392.3659, 392.3659, 392.3659, 392.3659, 392.3659,
        392.3659, 392.3659, 392.3659, 392.3659, 392.3659, 392.3659, 798.7957,
        804.9185, 791.5924, 770.4136, 774.7052, 781.3048, 800.9081, 621.7704,
        811.2419, 796.2589, 816.3273, 799.2104, 796.7363, 811.8658, 818.3828,
        601.9718, 762.3818, 742.6089, 724.9457, 789.9379, 726.7811, 801.3047,
        742.7921, 651.6146], device='cuda:3')
sorted_norm is   tensor([392.3659, 392.3659, 392.3659, 392.3659, 392.3659, 392.3659, 392.3659,
        392.3659, 392.3659, 392.3659, 392.3659, 392.3659, 392.3659, 560.4012,
        563.3356, 581.2924, 601.9718, 620.7946, 621.7704, 638.9979, 640.8882,
        651.6146, 705.5870, 724.9457, 726.7811, 742.6089, 742.7921, 762.3818,
        770.4136, 774.7052, 781.3048, 789.9379, 791.5924, 796.2589, 796.7363,
        798.7957, 799.2104, 800.9081, 801.3047, 804.9185, 811.2419, 811.8658,
        816.3273, 818.3828], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  6,  4,  2, 35,  0,
        27,  3,  1, 43,  5, 38, 40, 37, 42, 36, 23, 24, 25, 39, 22, 29, 32],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.75% 

Test Accuracy: 88.85% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5707634091377258
distance x is tensor(123.9796, device='cuda:3')
benign distance is  tensor(123.9796, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4524397850036621
distance x is tensor(120.7388, device='cuda:3')
benign distance is  tensor(120.7388, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24296613037586212
distance x is tensor(131.1385, device='cuda:3')
benign distance is  tensor(131.1385, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0026729106903076
distance x is tensor(117.0840, device='cuda:3')
benign distance is  tensor(117.0840, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0034173727035522
distance x is tensor(104.8360, device='cuda:3')
benign distance is  tensor(104.8360, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6939077973365784
distance x is tensor(122.0063, device='cuda:3')
benign distance is  tensor(122.0063, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25701338052749634
distance x is tensor(121.0480, device='cuda:3')
benign distance is  tensor(121.0480, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22590866684913635
distance x is tensor(49.6310, device='cuda:3')
benign distance is  tensor(49.6310, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.09856702387332916
distance x is tensor(147.7695, device='cuda:3')
benign distance is  tensor(147.7695, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8502902984619141
distance x is tensor(150.3649, device='cuda:3')
benign distance is  tensor(150.3649, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.575596809387207
distance x is tensor(130.5283, device='cuda:3')
benign distance is  tensor(130.5283, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8534899950027466
distance x is tensor(144.3375, device='cuda:3')
benign distance is  tensor(144.3375, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5837568044662476
distance x is tensor(142.1994, device='cuda:3')
benign distance is  tensor(142.1994, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.516995906829834
distance x is tensor(151.5882, device='cuda:3')
benign distance is  tensor(151.5882, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.25909224152565
distance x is tensor(135.9880, device='cuda:3')
benign distance is  tensor(135.9880, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8049971461296082
distance x is tensor(135.5342, device='cuda:3')
benign distance is  tensor(135.5342, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3730873465538025
distance x is tensor(155.5619, device='cuda:3')
benign distance is  tensor(155.5619, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.638154923915863
distance x is tensor(145.5860, device='cuda:3')
benign distance is  tensor(145.5860, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.20103105902671814
distance x is tensor(153.0777, device='cuda:3')
benign distance is  tensor(153.0777, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.39164024591445923
distance x is tensor(161.8967, device='cuda:3')
benign distance is  tensor(161.8967, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.4743112623691559
distance x is tensor(150.0003, device='cuda:3')
benign distance is  tensor(150.0003, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.17730970680713654
distance x is tensor(166.5133, device='cuda:3')
benign distance is  tensor(166.5133, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.44814881682395935
distance x is tensor(143.8201, device='cuda:3')
benign distance is  tensor(143.8201, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.1750333309173584
distance x is tensor(120.8916, device='cuda:3')
benign distance is  tensor(120.8916, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.37486863136291504
distance x is tensor(151.1098, device='cuda:3')
benign distance is  tensor(151.1098, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.10097867250442505
distance x is tensor(146.3307, device='cuda:3')
benign distance is  tensor(146.3307, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.44138312339782715
distance x is tensor(156.4270, device='cuda:3')
benign distance is  tensor(156.4270, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2511414885520935
distance x is tensor(147.3412, device='cuda:3')
benign distance is  tensor(147.3412, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6136470437049866
distance x is tensor(152.2874, device='cuda:3')
benign distance is  tensor(152.2874, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5511565804481506
distance x is tensor(140.5501, device='cuda:3')
benign distance is  tensor(140.5501, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.43452659249305725
distance x is tensor(145.7498, device='cuda:3')
benign distance is  tensor(145.7498, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.219111368060112
distance x is tensor(115.6399, device='cuda:3')
benign distance is  tensor(115.6399, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3652961552143097
mal_entropy is 0.09504730254411697
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([546.6040, 539.2612, 573.4741, 498.5895, 441.6910, 525.2561, 506.6187,
        212.4791, 495.5464, 495.5464, 495.5464, 495.5464, 495.5464, 495.5464,
        495.5464, 495.5464, 495.5464, 495.5464, 495.5464, 495.5464, 673.6210,
        777.2151, 669.0660, 674.8409, 676.0471, 653.6884, 748.5668, 614.0034],
       device='cuda:3')
sorted_norm is   tensor([212.4791, 441.6910, 495.5464, 495.5464, 495.5464, 495.5464, 495.5464,
        495.5464, 495.5464, 495.5464, 495.5464, 495.5464, 495.5464, 495.5464,
        498.5895, 506.6187, 525.2561, 539.2612, 546.6040, 573.4741, 614.0034,
        653.6884, 669.0660, 673.6210, 674.8409, 676.0471, 748.5668, 777.2151],
       device='cuda:3')
used idx is  tensor([ 7,  4, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  3,  6,  5,  1,
         0,  2, 27, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 89.45% 

Test Accuracy: 88.79% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7831531763076782
distance x is tensor(128.9887, device='cuda:3')
benign distance is  tensor(128.9887, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.09615083783864975
distance x is tensor(133.8611, device='cuda:3')
benign distance is  tensor(133.8611, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3123566806316376
distance x is tensor(131.2234, device='cuda:3')
benign distance is  tensor(131.2234, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.1230202466249466
distance x is tensor(121.2886, device='cuda:3')
benign distance is  tensor(121.2886, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.21690090000629425
distance x is tensor(138.0293, device='cuda:3')
benign distance is  tensor(138.0293, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.38544440269470215
distance x is tensor(125.9019, device='cuda:3')
benign distance is  tensor(125.9019, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5641870498657227
distance x is tensor(133.5293, device='cuda:3')
benign distance is  tensor(133.5293, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.23397207260131836
distance x is tensor(95.5545, device='cuda:3')
benign distance is  tensor(95.5545, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4398033022880554
distance x is tensor(153.1632, device='cuda:3')
benign distance is  tensor(153.1632, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7378412485122681
distance x is tensor(159.6813, device='cuda:3')
benign distance is  tensor(159.6813, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.19096367061138153
distance x is tensor(147.5232, device='cuda:3')
benign distance is  tensor(147.5232, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.27096641063690186
distance x is tensor(147.8038, device='cuda:3')
benign distance is  tensor(147.8038, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.27052515745162964
distance x is tensor(159.6183, device='cuda:3')
benign distance is  tensor(159.6183, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7734156250953674
distance x is tensor(152.3002, device='cuda:3')
benign distance is  tensor(152.3002, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.177674800157547
distance x is tensor(159.1577, device='cuda:3')
benign distance is  tensor(159.1577, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.16078808903694153
distance x is tensor(128.9278, device='cuda:3')
benign distance is  tensor(128.9278, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.24311070144176483
mal_entropy is 0.1470336765050888
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([558.5794, 581.3296, 560.8644, 513.3386, 602.6931, 555.2089, 574.8149,
        403.6578, 555.4045, 555.4045, 555.4045, 555.4045, 555.4045, 555.4045,
        555.4045, 555.4045, 555.4045, 555.4045, 555.4045, 555.4045, 689.7515,
        702.4899, 636.5565, 681.8838, 677.4834, 714.2679, 657.2431, 647.3369],
       device='cuda:3')
sorted_norm is   tensor([403.6578, 513.3386, 555.2089, 555.4045, 555.4045, 555.4045, 555.4045,
        555.4045, 555.4045, 555.4045, 555.4045, 555.4045, 555.4045, 555.4045,
        555.4045, 558.5794, 560.8644, 574.8149, 581.3296, 602.6931, 636.5565,
        647.3369, 657.2431, 677.4834, 681.8838, 689.7515, 702.4899, 714.2679],
       device='cuda:3')
used idx is  tensor([ 7,  3,  5, 19, 15, 18, 16, 17, 13, 12, 14,  9,  8, 11, 10,  0,  2,  6,
         1,  4, 22, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 89.27% 

Test Accuracy: 88.54% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.24401883780956268
distance x is tensor(144.7412, device='cuda:3')
benign distance is  tensor(144.7412, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.12943843007087708
distance x is tensor(127.0420, device='cuda:3')
benign distance is  tensor(127.0420, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15074118971824646
distance x is tensor(136.4225, device='cuda:3')
benign distance is  tensor(136.4225, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2047892063856125
distance x is tensor(122.8079, device='cuda:3')
benign distance is  tensor(122.8079, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8623803853988647
distance x is tensor(115.2966, device='cuda:3')
benign distance is  tensor(115.2966, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6027606129646301
distance x is tensor(152.3358, device='cuda:3')
benign distance is  tensor(152.3358, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4618975520133972
distance x is tensor(123.1078, device='cuda:3')
benign distance is  tensor(123.1078, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.41261547803878784
distance x is tensor(94.1222, device='cuda:3')
benign distance is  tensor(94.1222, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.17304062843322754
distance x is tensor(163.2606, device='cuda:3')
benign distance is  tensor(163.2606, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.14667969942092896
distance x is tensor(138.5531, device='cuda:3')
benign distance is  tensor(138.5531, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.29728639125823975
distance x is tensor(145.6703, device='cuda:3')
benign distance is  tensor(145.6703, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3842875063419342
distance x is tensor(156.9142, device='cuda:3')
benign distance is  tensor(156.9142, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4196472764015198
distance x is tensor(145.9832, device='cuda:3')
benign distance is  tensor(145.9832, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2963736057281494
distance x is tensor(153.7728, device='cuda:3')
benign distance is  tensor(153.7728, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6848555207252502
distance x is tensor(145.7758, device='cuda:3')
benign distance is  tensor(145.7758, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7158188819885254
distance x is tensor(115.8736, device='cuda:3')
benign distance is  tensor(115.8736, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5850750803947449
mal_entropy is 0.0725826695561409
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([631.7440, 562.9476, 579.4324, 528.4734, 496.1742, 674.0038, 534.1011,
        399.2674, 501.9815, 501.9815, 501.9815, 501.9815, 501.9815, 501.9815,
        501.9815, 501.9815, 501.9815, 501.9815, 501.9815, 501.9815],
       device='cuda:3')
sorted_norm is   tensor([399.2674, 496.1742, 501.9815, 501.9815, 501.9815, 501.9815, 501.9815,
        501.9815, 501.9815, 501.9815, 501.9815, 501.9815, 501.9815, 501.9815,
        528.4734, 534.1011, 562.9476, 579.4324, 631.7440, 674.0038],
       device='cuda:3')
used idx is  tensor([ 7,  4, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  3,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 89.22% 

Test Accuracy: 88.50% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.780720591545105
distance x is tensor(161.1953, device='cuda:3')
benign distance is  tensor(161.1953, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5944024324417114
distance x is tensor(181.0755, device='cuda:3')
benign distance is  tensor(181.0755, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22881576418876648
distance x is tensor(158.5264, device='cuda:3')
benign distance is  tensor(158.5264, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7468355894088745
distance x is tensor(149.6098, device='cuda:3')
benign distance is  tensor(149.6098, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.19142727553844452
distance x is tensor(148.0287, device='cuda:3')
benign distance is  tensor(148.0287, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6069581508636475
distance x is tensor(161.4174, device='cuda:3')
benign distance is  tensor(161.4174, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4933594763278961
distance x is tensor(147.9666, device='cuda:3')
benign distance is  tensor(147.9666, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5341940522193909
distance x is tensor(109.0140, device='cuda:3')
benign distance is  tensor(109.0140, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.8229732513427734
mal_entropy is 0.11998450011014938
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([699.6432, 764.4107, 688.7782, 635.4152, 630.8377, 706.2752, 639.2855,
        470.8750, 470.8750, 470.8750, 470.8750, 470.8750, 470.8750, 470.8750,
        470.8750, 470.8750, 470.8750, 470.8750, 470.8750, 470.8750, 840.3851,
        836.8185, 884.3994, 839.1994, 828.0395, 842.8546, 901.1111, 663.7802,
        856.3124, 802.7347, 831.5429, 865.4758, 838.2529, 884.5831, 804.8394,
        747.7083, 800.9150, 836.2015, 795.2786, 802.7935, 825.4991, 806.5381,
        842.2140, 492.5217, 783.7640, 702.8458, 736.5936, 768.6223, 717.6196,
        752.6838, 732.5483, 137.6581], device='cuda:3')
sorted_norm is   tensor([137.6581, 470.8750, 470.8750, 470.8750, 470.8750, 470.8750, 470.8750,
        470.8750, 470.8750, 470.8750, 470.8750, 470.8750, 470.8750, 470.8750,
        492.5217, 630.8377, 635.4152, 639.2855, 663.7802, 688.7782, 699.6432,
        702.8458, 706.2752, 717.6196, 732.5483, 736.5936, 747.7083, 752.6838,
        764.4107, 768.6223, 783.7640, 795.2786, 800.9150, 802.7347, 802.7935,
        804.8394, 806.5381, 825.4991, 828.0395, 831.5429, 836.2015, 836.8185,
        838.2529, 839.1994, 840.3851, 842.2140, 842.8546, 856.3124, 865.4758,
        884.3994, 884.5831, 901.1111], device='cuda:3')
used idx is  tensor([51, 11, 19, 10, 13, 18, 16, 17, 15, 12,  8,  9, 14,  7, 43,  4,  3,  6,
        27,  2,  0, 45,  5, 48, 50, 46, 35, 49,  1, 47, 44, 38, 36, 29, 39, 34,
        41, 40, 24, 30, 37], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.93% 

Test Accuracy: 88.85% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.09552277624607086
distance x is tensor(125.4394, device='cuda:3')
benign distance is  tensor(125.4394, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.613956868648529
distance x is tensor(117.8324, device='cuda:3')
benign distance is  tensor(117.8324, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08853726089000702
distance x is tensor(127.4834, device='cuda:3')
benign distance is  tensor(127.4834, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3266766667366028
distance x is tensor(115.4330, device='cuda:3')
benign distance is  tensor(115.4330, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6867576241493225
distance x is tensor(103.5753, device='cuda:3')
benign distance is  tensor(103.5753, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4360552728176117
distance x is tensor(128.7752, device='cuda:3')
benign distance is  tensor(128.7752, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3320108950138092
distance x is tensor(114.9407, device='cuda:3')
benign distance is  tensor(114.9407, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46779632568359375
distance x is tensor(54.2814, device='cuda:3')
benign distance is  tensor(54.2814, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4114881157875061
distance x is tensor(151.7025, device='cuda:3')
benign distance is  tensor(151.7025, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.38181304931640625
distance x is tensor(150.4431, device='cuda:3')
benign distance is  tensor(150.4431, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.18454939126968384
distance x is tensor(138.8096, device='cuda:3')
benign distance is  tensor(138.8096, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.136329174041748
distance x is tensor(147.7656, device='cuda:3')
benign distance is  tensor(147.7656, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.18940900266170502
distance x is tensor(140.3858, device='cuda:3')
benign distance is  tensor(140.3858, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.13533957302570343
distance x is tensor(145.2606, device='cuda:3')
benign distance is  tensor(145.2606, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5393384695053101
distance x is tensor(140.0418, device='cuda:3')
benign distance is  tensor(140.0418, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6795786619186401
distance x is tensor(121.6803, device='cuda:3')
benign distance is  tensor(121.6803, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.18691539764404297
distance x is tensor(146.6938, device='cuda:3')
benign distance is  tensor(146.6938, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6448635458946228
distance x is tensor(154.4416, device='cuda:3')
benign distance is  tensor(154.4416, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.04512224346399307
distance x is tensor(149.1502, device='cuda:3')
benign distance is  tensor(149.1502, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.26384633779525757
distance x is tensor(140.6470, device='cuda:3')
benign distance is  tensor(140.6470, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4897440969944
distance x is tensor(145.7664, device='cuda:3')
benign distance is  tensor(145.7664, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5691925883293152
distance x is tensor(142.5270, device='cuda:3')
benign distance is  tensor(142.5270, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.21125812828540802
distance x is tensor(144.3674, device='cuda:3')
benign distance is  tensor(144.3674, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.1119690090417862
distance x is tensor(110.3096, device='cuda:3')
benign distance is  tensor(110.3096, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4237857758998871
distance x is tensor(171.0184, device='cuda:3')
benign distance is  tensor(171.0184, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3576365113258362
distance x is tensor(138.6602, device='cuda:3')
benign distance is  tensor(138.6602, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3119369149208069
distance x is tensor(156.9662, device='cuda:3')
benign distance is  tensor(156.9662, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3529745638370514
distance x is tensor(159.1562, device='cuda:3')
benign distance is  tensor(159.1562, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.576115071773529
distance x is tensor(153.2980, device='cuda:3')
benign distance is  tensor(153.2980, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7778192758560181
distance x is tensor(145.4978, device='cuda:3')
benign distance is  tensor(145.4978, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.41969186067581177
distance x is tensor(154.5634, device='cuda:3')
benign distance is  tensor(154.5634, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.17339903116226196
distance x is tensor(118.9338, device='cuda:3')
benign distance is  tensor(118.9338, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.16509169340133667
distance x is tensor(147.7040, device='cuda:3')
benign distance is  tensor(147.7040, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.39029616117477417
distance x is tensor(149.5687, device='cuda:3')
benign distance is  tensor(149.5687, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.5301734209060669
distance x is tensor(161.7368, device='cuda:3')
benign distance is  tensor(161.7368, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8444740176200867
distance x is tensor(171.9010, device='cuda:3')
benign distance is  tensor(171.9010, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2273118942975998
distance x is tensor(142.8740, device='cuda:3')
benign distance is  tensor(142.8740, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.2011755257844925
distance x is tensor(153.6481, device='cuda:3')
benign distance is  tensor(153.6481, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5420604348182678
distance x is tensor(162.2088, device='cuda:3')
benign distance is  tensor(162.2088, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.38476109504699707
distance x is tensor(116.2361, device='cuda:3')
benign distance is  tensor(116.2361, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.1813327521085739
mal_entropy is 0.07099832594394684
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([551.0173, 521.1786, 552.4532, 492.3207, 436.8461, 563.6815, 498.6130,
        242.2945, 500.6315, 500.6315, 500.6315, 500.6315, 500.6315, 500.6315,
        500.6315, 500.6315, 500.6315, 500.6315, 500.6315, 500.6315, 738.9985,
        725.0657, 764.4017, 729.7505, 754.7107, 696.4396, 730.2415, 463.7064],
       device='cuda:3')
sorted_norm is   tensor([242.2945, 436.8461, 463.7064, 492.3207, 498.6130, 500.6315, 500.6315,
        500.6315, 500.6315, 500.6315, 500.6315, 500.6315, 500.6315, 500.6315,
        500.6315, 500.6315, 500.6315, 521.1786, 551.0173, 552.4532, 563.6815,
        696.4396, 725.0657, 729.7505, 730.2415, 738.9985, 754.7107, 764.4017],
       device='cuda:3')
used idx is  tensor([ 7,  4, 27,  3,  6, 18, 16, 17, 13, 12, 14, 15, 19, 10,  8,  9, 11,  1,
         0,  2,  5, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 89.61% 

Test Accuracy: 88.61% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.46968403458595276
distance x is tensor(126.3240, device='cuda:3')
benign distance is  tensor(126.3240, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9248437881469727
distance x is tensor(139.2319, device='cuda:3')
benign distance is  tensor(139.2319, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3798793852329254
distance x is tensor(138.5248, device='cuda:3')
benign distance is  tensor(138.5248, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8384418487548828
distance x is tensor(130.7280, device='cuda:3')
benign distance is  tensor(130.7280, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4088039994239807
distance x is tensor(121.9458, device='cuda:3')
benign distance is  tensor(121.9458, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4231800138950348
distance x is tensor(134.3633, device='cuda:3')
benign distance is  tensor(134.3633, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.30353885889053345
distance x is tensor(139.9618, device='cuda:3')
benign distance is  tensor(139.9618, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.563879132270813
distance x is tensor(66.4451, device='cuda:3')
benign distance is  tensor(66.4451, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5612180829048157
distance x is tensor(166.4866, device='cuda:3')
benign distance is  tensor(166.4866, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.17020727694034576
distance x is tensor(159.4775, device='cuda:3')
benign distance is  tensor(159.4775, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.20918241143226624
distance x is tensor(156.3380, device='cuda:3')
benign distance is  tensor(156.3380, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04577023535966873
distance x is tensor(152.1613, device='cuda:3')
benign distance is  tensor(152.1613, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.31120622158050537
distance x is tensor(149.5929, device='cuda:3')
benign distance is  tensor(149.5929, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2393210232257843
distance x is tensor(150.7442, device='cuda:3')
benign distance is  tensor(150.7442, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.10987895727157593
distance x is tensor(154.5267, device='cuda:3')
benign distance is  tensor(154.5267, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.45838937163352966
distance x is tensor(103.1615, device='cuda:3')
benign distance is  tensor(103.1615, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.2881785035133362
mal_entropy is 0.07708800584077835
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([561.9834, 619.1594, 596.4995, 563.0497, 520.0358, 590.0695, 599.6482,
        276.0965, 443.0453, 443.0453, 443.0453, 443.0453, 443.0453, 443.0453,
        443.0453, 443.0453, 443.0453, 443.0453, 443.0453, 443.0453, 717.8964,
        706.3193, 659.3685, 704.5457, 658.8297, 687.9250, 672.9656, 606.6865],
       device='cuda:3')
sorted_norm is   tensor([276.0965, 443.0453, 443.0453, 443.0453, 443.0453, 443.0453, 443.0453,
        443.0453, 443.0453, 443.0453, 443.0453, 443.0453, 443.0453, 520.0358,
        561.9834, 563.0497, 590.0695, 596.4995, 599.6482, 606.6865, 619.1594,
        658.8297, 659.3685, 672.9656, 687.9250, 704.5457, 706.3193, 717.8964],
       device='cuda:3')
used idx is  tensor([ 7, 18, 14, 16, 12,  8, 10, 17,  9, 13, 11, 19, 15,  4,  0,  3,  5,  2,
         6, 27,  1, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.15% 

Test Accuracy: 88.48% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.42396897077560425
distance x is tensor(141.8133, device='cuda:3')
benign distance is  tensor(141.8133, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.25680726766586304
distance x is tensor(133.2911, device='cuda:3')
benign distance is  tensor(133.2911, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2597370147705078
distance x is tensor(145.0150, device='cuda:3')
benign distance is  tensor(145.0150, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7747417688369751
distance x is tensor(171.0844, device='cuda:3')
benign distance is  tensor(171.0844, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.42703476548194885
distance x is tensor(127.0700, device='cuda:3')
benign distance is  tensor(127.0700, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8477779626846313
distance x is tensor(148.5648, device='cuda:3')
benign distance is  tensor(148.5648, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23313310742378235
distance x is tensor(129.3980, device='cuda:3')
benign distance is  tensor(129.3980, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3260381817817688
distance x is tensor(67.3201, device='cuda:3')
benign distance is  tensor(67.3201, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5911141633987427
distance x is tensor(165.0914, device='cuda:3')
benign distance is  tensor(165.0914, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.0955730527639389
distance x is tensor(152.2355, device='cuda:3')
benign distance is  tensor(152.2355, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.23542150855064392
distance x is tensor(154.3438, device='cuda:3')
benign distance is  tensor(154.3438, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2899210453033447
distance x is tensor(168.4930, device='cuda:3')
benign distance is  tensor(168.4930, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6852868795394897
distance x is tensor(159.5496, device='cuda:3')
benign distance is  tensor(159.5496, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2233184278011322
distance x is tensor(160.7514, device='cuda:3')
benign distance is  tensor(160.7514, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.16751977801322937
distance x is tensor(141.3358, device='cuda:3')
benign distance is  tensor(141.3358, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2099976539611816
distance x is tensor(119.4626, device='cuda:3')
benign distance is  tensor(119.4626, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.6708374619483948
mal_entropy is 0.06924101710319519
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([625.6574, 586.1873, 625.6094, 743.1154, 546.1007, 648.8968, 546.0405,
        283.8917, 520.4332, 520.4332, 520.4332, 520.4332, 520.4332, 520.4332,
        520.4332, 520.4332, 520.4332, 520.4332, 520.4332, 520.4332, 705.0822,
        759.1454, 721.5349, 708.9648, 706.9946, 704.3977, 724.1273, 581.9797],
       device='cuda:3')
sorted_norm is   tensor([283.8917, 520.4332, 520.4332, 520.4332, 520.4332, 520.4332, 520.4332,
        520.4332, 520.4332, 520.4332, 520.4332, 520.4332, 520.4332, 546.0405,
        546.1007, 581.9797, 586.1873, 625.6094, 625.6574, 648.8968, 704.3977,
        705.0822, 706.9946, 708.9648, 721.5349, 724.1273, 743.1154, 759.1454],
       device='cuda:3')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  6,  4, 27,  1,  2,
         0,  5, 25, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 89.32% 

Test Accuracy: 88.46% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3532540202140808
distance x is tensor(138.9942, device='cuda:3')
benign distance is  tensor(138.9942, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.47314104437828064
distance x is tensor(141.7137, device='cuda:3')
benign distance is  tensor(141.7137, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16599678993225098
distance x is tensor(162.3035, device='cuda:3')
benign distance is  tensor(162.3035, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.21587292850017548
distance x is tensor(149.9425, device='cuda:3')
benign distance is  tensor(149.9425, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5100497007369995
distance x is tensor(136.5489, device='cuda:3')
benign distance is  tensor(136.5489, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6751723289489746
distance x is tensor(144.6873, device='cuda:3')
benign distance is  tensor(144.6873, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2740582823753357
distance x is tensor(151.5819, device='cuda:3')
benign distance is  tensor(151.5819, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2691851258277893
distance x is tensor(93.0544, device='cuda:3')
benign distance is  tensor(93.0544, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.41324862837791443
distance x is tensor(165.1480, device='cuda:3')
benign distance is  tensor(165.1480, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4311465620994568
distance x is tensor(173.9431, device='cuda:3')
benign distance is  tensor(173.9431, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.06795339286327362
distance x is tensor(169.5554, device='cuda:3')
benign distance is  tensor(169.5554, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3263426423072815
distance x is tensor(158.4689, device='cuda:3')
benign distance is  tensor(158.4689, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6196410059928894
distance x is tensor(167.7872, device='cuda:3')
benign distance is  tensor(167.7872, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.2635190784931183
distance x is tensor(154.8654, device='cuda:3')
benign distance is  tensor(154.8654, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3177741765975952
distance x is tensor(171.8073, device='cuda:3')
benign distance is  tensor(171.8073, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.20650093257427216
distance x is tensor(144.1130, device='cuda:3')
benign distance is  tensor(144.1130, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.7405186891555786
mal_entropy is 0.0742107406258583
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([605.0853, 625.6360, 720.8516, 634.7202, 580.0032, 635.7786, 645.4617,
        394.9313, 621.2715, 621.2715, 621.2715, 621.2715, 621.2715, 621.2715,
        621.2715, 621.2715, 621.2715, 621.2715, 621.2715, 621.2715, 838.2437,
        711.9417, 791.1785, 782.6719, 769.9796, 750.3149, 782.2161, 652.4540,
        756.5613, 700.5340, 738.2982, 770.1595, 745.1310, 745.6138, 683.8488,
        251.5341], device='cuda:3')
sorted_norm is   tensor([251.5341, 394.9313, 580.0032, 605.0853, 621.2715, 621.2715, 621.2715,
        621.2715, 621.2715, 621.2715, 621.2715, 621.2715, 621.2715, 621.2715,
        621.2715, 621.2715, 625.6360, 634.7202, 635.7786, 645.4617, 652.4540,
        683.8488, 700.5340, 711.9417, 720.8516, 738.2982, 745.1310, 745.6138,
        750.3149, 756.5613, 769.9796, 770.1595, 782.2161, 782.6719, 791.1785,
        838.2437], device='cuda:3')
used idx is  tensor([35,  7,  4,  0, 13, 12, 14, 19,  8, 11, 10,  9, 15, 18, 16, 17,  1,  3,
         5,  6, 27, 34, 29, 21,  2, 30, 32, 33], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.35% 

Test Accuracy: 88.99% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.05867438390851021
distance x is tensor(139.9299, device='cuda:3')
benign distance is  tensor(139.9299, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.34743109345436096
distance x is tensor(140.2530, device='cuda:3')
benign distance is  tensor(140.2530, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4914589822292328
distance x is tensor(144.6173, device='cuda:3')
benign distance is  tensor(144.6173, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7019659280776978
distance x is tensor(131.1785, device='cuda:3')
benign distance is  tensor(131.1785, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6509261131286621
distance x is tensor(133.6467, device='cuda:3')
benign distance is  tensor(133.6467, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.30287259817123413
distance x is tensor(122.5160, device='cuda:3')
benign distance is  tensor(122.5160, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.615140438079834
distance x is tensor(107.7698, device='cuda:3')
benign distance is  tensor(107.7698, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.25242453813552856
distance x is tensor(96.2650, device='cuda:3')
benign distance is  tensor(96.2650, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.530752420425415
distance x is tensor(173.0028, device='cuda:3')
benign distance is  tensor(173.0028, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5794796943664551
distance x is tensor(161.5345, device='cuda:3')
benign distance is  tensor(161.5345, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4978635907173157
distance x is tensor(138.1181, device='cuda:3')
benign distance is  tensor(138.1181, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.343752920627594
distance x is tensor(153.6217, device='cuda:3')
benign distance is  tensor(153.6217, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6273297071456909
distance x is tensor(141.5610, device='cuda:3')
benign distance is  tensor(141.5610, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.19925238192081451
distance x is tensor(151.0229, device='cuda:3')
benign distance is  tensor(151.0229, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.21528704464435577
distance x is tensor(148.4858, device='cuda:3')
benign distance is  tensor(148.4858, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.36658257246017456
distance x is tensor(95.4304, device='cuda:3')
benign distance is  tensor(95.4304, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1827315390110016
distance x is tensor(182.5238, device='cuda:3')
benign distance is  tensor(182.5238, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.2552981376647949
distance x is tensor(142.5908, device='cuda:3')
benign distance is  tensor(142.5908, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.43472161889076233
distance x is tensor(161.9673, device='cuda:3')
benign distance is  tensor(161.9673, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.36542850732803345
distance x is tensor(174.3350, device='cuda:3')
benign distance is  tensor(174.3350, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.758476972579956
distance x is tensor(167.9795, device='cuda:3')
benign distance is  tensor(167.9795, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6025534272193909
distance x is tensor(159.6537, device='cuda:3')
benign distance is  tensor(159.6537, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.39434391260147095
distance x is tensor(160.2399, device='cuda:3')
benign distance is  tensor(160.2399, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.38004007935523987
distance x is tensor(138.8705, device='cuda:3')
benign distance is  tensor(138.8705, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.2858789563179016
mal_entropy is 0.09181461483240128
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([615.9735, 610.6889, 623.9442, 562.8610, 565.3828, 522.0819, 464.8428,
        413.1904, 606.1772, 606.1772, 606.1772, 606.1772, 606.1772, 606.1772,
        606.1772, 606.1772, 606.1772, 606.1772, 606.1772, 606.1772],
       device='cuda:3')
sorted_norm is   tensor([413.1904, 464.8428, 522.0819, 562.8610, 565.3828, 606.1772, 606.1772,
        606.1772, 606.1772, 606.1772, 606.1772, 606.1772, 606.1772, 606.1772,
        606.1772, 606.1772, 606.1772, 610.6889, 615.9735, 623.9442],
       device='cuda:3')
used idx is  tensor([ 7,  6,  5,  3,  4, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 88.72% 

Test Accuracy: 87.84% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.39145562052726746
distance x is tensor(142.2090, device='cuda:3')
benign distance is  tensor(142.2090, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6917451620101929
distance x is tensor(138.6867, device='cuda:3')
benign distance is  tensor(138.6867, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4216931462287903
distance x is tensor(149.8196, device='cuda:3')
benign distance is  tensor(149.8196, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6248579621315002
distance x is tensor(138.5345, device='cuda:3')
benign distance is  tensor(138.5345, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8013195991516113
distance x is tensor(147.1121, device='cuda:3')
benign distance is  tensor(147.1121, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8283126950263977
distance x is tensor(158.8307, device='cuda:3')
benign distance is  tensor(158.8307, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3772716224193573
distance x is tensor(145.6062, device='cuda:3')
benign distance is  tensor(145.6062, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7111374139785767
distance x is tensor(101.3844, device='cuda:3')
benign distance is  tensor(101.3844, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.731839120388031
mal_entropy is 0.054187215864658356
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([621.5270, 609.9581, 647.9883, 590.6891, 627.2290, 692.2527, 630.7554,
        431.9950, 431.9950, 431.9950, 431.9950, 431.9950, 431.9950, 431.9950,
        431.9950, 431.9950, 431.9950, 431.9950, 431.9950, 431.9950, 858.8878,
        862.7377, 913.2708, 945.7598, 852.8682, 879.5398, 905.0684, 665.9005,
        898.2855, 885.8911, 866.6644, 874.1327, 854.4747, 844.7933, 863.6103,
        621.4291, 871.3381, 896.4764, 879.7236, 847.3867, 872.7426, 834.1113,
        897.9671, 583.9373, 850.2035, 805.3386, 727.0186, 786.2773, 741.7380,
        780.9902, 764.6091, 585.4749], device='cuda:3')
sorted_norm is   tensor([431.9950, 431.9950, 431.9950, 431.9950, 431.9950, 431.9950, 431.9950,
        431.9950, 431.9950, 431.9950, 431.9950, 431.9950, 431.9950, 583.9373,
        585.4749, 590.6891, 609.9581, 621.4291, 621.5270, 627.2290, 630.7554,
        647.9883, 665.9005, 692.2527, 727.0186, 741.7380, 764.6091, 780.9902,
        786.2773, 805.3386, 834.1113, 844.7933, 847.3867, 850.2035, 852.8682,
        854.4747, 858.8878, 862.7377, 863.6103, 866.6644, 871.3381, 872.7426,
        874.1327, 879.5398, 879.7236, 885.8911, 896.4764, 897.9671, 898.2855,
        905.0684, 913.2708, 945.7598], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 43, 51,  3,  1, 35,
         0,  4,  6,  2, 27,  5, 46, 48, 50, 49, 47, 45, 41, 33, 39, 44, 24, 32,
        20, 21, 34, 30, 36], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 88.70% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.22114327549934387
distance x is tensor(105.4620, device='cuda:3')
benign distance is  tensor(105.4620, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.22796137630939484
distance x is tensor(122.8434, device='cuda:3')
benign distance is  tensor(122.8434, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7307922840118408
distance x is tensor(133.4935, device='cuda:3')
benign distance is  tensor(133.4935, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.502088725566864
distance x is tensor(116.2747, device='cuda:3')
benign distance is  tensor(116.2747, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5116199254989624
distance x is tensor(116.5556, device='cuda:3')
benign distance is  tensor(116.5556, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.23473677039146423
distance x is tensor(130.0546, device='cuda:3')
benign distance is  tensor(130.0546, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8711144328117371
distance x is tensor(119.3296, device='cuda:3')
benign distance is  tensor(119.3296, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.601214587688446
distance x is tensor(43.1470, device='cuda:3')
benign distance is  tensor(43.1470, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.08246229588985443
distance x is tensor(160.8186, device='cuda:3')
benign distance is  tensor(160.8186, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.239188551902771
distance x is tensor(136.0259, device='cuda:3')
benign distance is  tensor(136.0259, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.43569833040237427
distance x is tensor(132.5145, device='cuda:3')
benign distance is  tensor(132.5145, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4704377055168152
distance x is tensor(152.9295, device='cuda:3')
benign distance is  tensor(152.9295, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5494219064712524
distance x is tensor(139.0828, device='cuda:3')
benign distance is  tensor(139.0828, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3324466645717621
distance x is tensor(140.0354, device='cuda:3')
benign distance is  tensor(140.0354, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.40539413690567017
distance x is tensor(135.5299, device='cuda:3')
benign distance is  tensor(135.5299, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3096635937690735
distance x is tensor(103.4752, device='cuda:3')
benign distance is  tensor(103.4752, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.09654898941516876
distance x is tensor(142.8444, device='cuda:3')
benign distance is  tensor(142.8444, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6704598665237427
distance x is tensor(171.3640, device='cuda:3')
benign distance is  tensor(171.3640, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.08251060545444489
distance x is tensor(140.9371, device='cuda:3')
benign distance is  tensor(140.9371, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1723153293132782
distance x is tensor(153.4504, device='cuda:3')
benign distance is  tensor(153.4504, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2897603213787079
distance x is tensor(162.5204, device='cuda:3')
benign distance is  tensor(162.5204, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5375950336456299
distance x is tensor(139.4748, device='cuda:3')
benign distance is  tensor(139.4748, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3291279673576355
distance x is tensor(164.0646, device='cuda:3')
benign distance is  tensor(164.0646, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6985040903091431
distance x is tensor(103.8799, device='cuda:3')
benign distance is  tensor(103.8799, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.30531710386276245
distance x is tensor(146.9847, device='cuda:3')
benign distance is  tensor(146.9847, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.024581989273428917
distance x is tensor(154.1004, device='cuda:3')
benign distance is  tensor(154.1004, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.825362503528595
distance x is tensor(157.7375, device='cuda:3')
benign distance is  tensor(157.7375, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.09874843060970306
distance x is tensor(142.0663, device='cuda:3')
benign distance is  tensor(142.0663, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7221496105194092
distance x is tensor(140.3757, device='cuda:3')
benign distance is  tensor(140.3757, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5287620425224304
distance x is tensor(154.5955, device='cuda:3')
benign distance is  tensor(154.5955, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.21008753776550293
distance x is tensor(140.8527, device='cuda:3')
benign distance is  tensor(140.8527, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.16268712282180786
distance x is tensor(94.1028, device='cuda:3')
benign distance is  tensor(94.1028, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.11365143954753876
distance x is tensor(145.6898, device='cuda:3')
benign distance is  tensor(145.6898, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.1327146589756012
distance x is tensor(154.4834, device='cuda:3')
benign distance is  tensor(154.4834, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.23929479718208313
distance x is tensor(143.1197, device='cuda:3')
benign distance is  tensor(143.1197, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.42630934715270996
distance x is tensor(154.1786, device='cuda:3')
benign distance is  tensor(154.1786, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2840787470340729
distance x is tensor(139.6651, device='cuda:3')
benign distance is  tensor(139.6651, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.49589425325393677
distance x is tensor(164.6616, device='cuda:3')
benign distance is  tensor(164.6616, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7920026779174805
distance x is tensor(156.6913, device='cuda:3')
benign distance is  tensor(156.6913, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6077102422714233
distance x is tensor(107.1136, device='cuda:3')
benign distance is  tensor(107.1136, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.37233394384384155
mal_entropy is 0.07528610527515411
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([461.6938, 541.3876, 571.1177, 494.8205, 500.7420, 570.4595, 521.3133,
        187.5139, 474.2098, 474.2098, 474.2098, 474.2098, 474.2098, 474.2098,
        474.2098, 474.2098, 474.2098, 474.2098, 474.2098, 474.2098],
       device='cuda:3')
sorted_norm is   tensor([187.5139, 461.6938, 474.2098, 474.2098, 474.2098, 474.2098, 474.2098,
        474.2098, 474.2098, 474.2098, 474.2098, 474.2098, 474.2098, 474.2098,
        494.8205, 500.7420, 521.3133, 541.3876, 570.4595, 571.1177],
       device='cuda:3')
used idx is  tensor([ 7,  0, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  3,  4],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 88.14% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.902187705039978
distance x is tensor(154.3042, device='cuda:3')
benign distance is  tensor(154.3042, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.08853545784950256
distance x is tensor(145.8888, device='cuda:3')
benign distance is  tensor(145.8888, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17474998533725739
distance x is tensor(136.1194, device='cuda:3')
benign distance is  tensor(136.1194, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6873465776443481
distance x is tensor(144.9868, device='cuda:3')
benign distance is  tensor(144.9868, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6181856989860535
distance x is tensor(140.9280, device='cuda:3')
benign distance is  tensor(140.9280, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7482823133468628
distance x is tensor(153.2153, device='cuda:3')
benign distance is  tensor(153.2153, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24866509437561035
distance x is tensor(153.8223, device='cuda:3')
benign distance is  tensor(153.8223, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7794706225395203
distance x is tensor(105.5355, device='cuda:3')
benign distance is  tensor(105.5355, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5060909390449524
mal_entropy is 0.07079117745161057
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([666.5678, 630.2739, 587.4777, 609.2025, 606.8757, 667.3171, 658.7470,
        445.3512, 445.3512, 445.3512, 445.3512, 445.3512, 445.3512, 445.3512,
        445.3512, 445.3512, 445.3512, 445.3512, 445.3512, 445.3512, 917.1340,
        756.7505, 827.8522, 860.4240, 839.4769, 813.8705, 820.3861, 592.0253,
        775.0475, 693.9666, 675.9219, 746.6780, 709.2408, 705.8675, 695.1052,
        564.2465], device='cuda:3')
sorted_norm is   tensor([445.3512, 445.3512, 445.3512, 445.3512, 445.3512, 445.3512, 445.3512,
        445.3512, 445.3512, 445.3512, 445.3512, 445.3512, 445.3512, 564.2465,
        587.4777, 592.0253, 606.8757, 609.2025, 630.2739, 658.7470, 666.5678,
        667.3171, 675.9219, 693.9666, 695.1052, 705.8675, 709.2408, 746.6780,
        756.7505, 775.0475, 813.8705, 820.3861, 827.8522, 839.4769, 860.4240,
        917.1340], device='cuda:3')
used idx is  tensor([11, 19, 13, 17, 15,  9,  7, 16, 14, 12, 10,  8, 18, 35,  2, 27,  4,  3,
         1,  6,  0,  5, 30, 29, 34, 33, 32, 31], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.48% 

Test Accuracy: 88.48% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49518904089927673
distance x is tensor(165.8149, device='cuda:3')
benign distance is  tensor(165.8149, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6437810659408569
distance x is tensor(142.4760, device='cuda:3')
benign distance is  tensor(142.4760, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21512126922607422
distance x is tensor(146.8032, device='cuda:3')
benign distance is  tensor(146.8032, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5024818778038025
distance x is tensor(117.9426, device='cuda:3')
benign distance is  tensor(117.9426, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2784590423107147
distance x is tensor(109.8799, device='cuda:3')
benign distance is  tensor(109.8799, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.47308507561683655
distance x is tensor(144.1278, device='cuda:3')
benign distance is  tensor(144.1278, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28402310609817505
distance x is tensor(123.1006, device='cuda:3')
benign distance is  tensor(123.1006, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5914331674575806
distance x is tensor(43.0596, device='cuda:3')
benign distance is  tensor(43.0596, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5653523206710815
distance x is tensor(165.5078, device='cuda:3')
benign distance is  tensor(165.5078, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.47456398606300354
distance x is tensor(160.0156, device='cuda:3')
benign distance is  tensor(160.0156, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6331990957260132
distance x is tensor(162.1444, device='cuda:3')
benign distance is  tensor(162.1444, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.31969350576400757
distance x is tensor(150.5379, device='cuda:3')
benign distance is  tensor(150.5379, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.057115912437439
distance x is tensor(156.3459, device='cuda:3')
benign distance is  tensor(156.3459, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.40715330839157104
distance x is tensor(152.0525, device='cuda:3')
benign distance is  tensor(152.0525, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6789476275444031
distance x is tensor(142.7281, device='cuda:3')
benign distance is  tensor(142.7281, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7321367263793945
distance x is tensor(108.1355, device='cuda:3')
benign distance is  tensor(108.1355, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.04458559304475784
distance x is tensor(187.4366, device='cuda:3')
benign distance is  tensor(187.4366, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5509270429611206
distance x is tensor(165.8650, device='cuda:3')
benign distance is  tensor(165.8650, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0699131488800049
distance x is tensor(182.5180, device='cuda:3')
benign distance is  tensor(182.5180, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5727788805961609
distance x is tensor(173.0951, device='cuda:3')
benign distance is  tensor(173.0951, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3967376947402954
distance x is tensor(161.9824, device='cuda:3')
benign distance is  tensor(161.9824, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.22509634494781494
distance x is tensor(167.4874, device='cuda:3')
benign distance is  tensor(167.4874, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2866693139076233
distance x is tensor(170.5060, device='cuda:3')
benign distance is  tensor(170.5060, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3873659074306488
distance x is tensor(123.8760, device='cuda:3')
benign distance is  tensor(123.8760, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.2613171935081482
mal_entropy is 0.09026958048343658
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([733.6556, 634.8786, 639.6669, 500.3065, 462.2033, 616.8792, 532.3406,
        179.2652, 549.4349, 549.4349, 549.4349, 549.4349, 549.4349, 549.4349,
        549.4349, 549.4349, 549.4349, 549.4349, 549.4349, 549.4349, 690.2885,
        808.5344, 686.5654, 727.9878, 752.8660, 683.2194, 787.7264, 552.7614],
       device='cuda:3')
sorted_norm is   tensor([179.2652, 462.2033, 500.3065, 532.3406, 549.4349, 549.4349, 549.4349,
        549.4349, 549.4349, 549.4349, 549.4349, 549.4349, 549.4349, 549.4349,
        549.4349, 549.4349, 552.7614, 616.8792, 634.8786, 639.6669, 683.2194,
        686.5654, 690.2885, 727.9878, 733.6556, 752.8660, 787.7264, 808.5344],
       device='cuda:3')
used idx is  tensor([ 7,  4,  3,  6, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 27,  5,
         1,  2, 25, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.21% 

Test Accuracy: 88.61% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6897252202033997
distance x is tensor(132.4135, device='cuda:3')
benign distance is  tensor(132.4135, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7743710875511169
distance x is tensor(137.4342, device='cuda:3')
benign distance is  tensor(137.4342, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5378416776657104
distance x is tensor(143.1258, device='cuda:3')
benign distance is  tensor(143.1258, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.28908437490463257
distance x is tensor(131.3911, device='cuda:3')
benign distance is  tensor(131.3911, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.561102032661438
distance x is tensor(117.7514, device='cuda:3')
benign distance is  tensor(117.7514, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.526370644569397
distance x is tensor(148.7382, device='cuda:3')
benign distance is  tensor(148.7382, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3746062219142914
distance x is tensor(130.6795, device='cuda:3')
benign distance is  tensor(130.6795, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3597637712955475
distance x is tensor(65.5325, device='cuda:3')
benign distance is  tensor(65.5325, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3581175208091736
distance x is tensor(170.1770, device='cuda:3')
benign distance is  tensor(170.1770, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9197729229927063
distance x is tensor(168.4291, device='cuda:3')
benign distance is  tensor(168.4291, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.13427481055259705
distance x is tensor(158.0617, device='cuda:3')
benign distance is  tensor(158.0617, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6611180305480957
distance x is tensor(148.9849, device='cuda:3')
benign distance is  tensor(148.9849, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.23255491256713867
distance x is tensor(153.0827, device='cuda:3')
benign distance is  tensor(153.0827, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5767037272453308
distance x is tensor(150.3516, device='cuda:3')
benign distance is  tensor(150.3516, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6566742062568665
distance x is tensor(167.7707, device='cuda:3')
benign distance is  tensor(167.7707, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.2590019106864929
distance x is tensor(120.0281, device='cuda:3')
benign distance is  tensor(120.0281, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.47421854734420776
mal_entropy is 0.07889007776975632
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([589.2789, 599.1733, 619.0460, 574.7100, 514.6565, 641.0928, 548.9788,
        284.9426, 504.4825, 504.4825, 504.4825, 504.4825, 504.4825, 504.4825,
        504.4825, 504.4825, 504.4825, 504.4825, 504.4825, 504.4825, 780.9415,
        756.0123, 760.7970, 709.7744, 751.9501, 744.0320, 695.0527, 556.2240],
       device='cuda:3')
sorted_norm is   tensor([284.9426, 504.4825, 504.4825, 504.4825, 504.4825, 504.4825, 504.4825,
        504.4825, 504.4825, 504.4825, 504.4825, 504.4825, 504.4825, 514.6565,
        548.9788, 556.2240, 574.7100, 589.2789, 599.1733, 619.0460, 641.0928,
        695.0527, 709.7744, 744.0320, 751.9501, 756.0123, 760.7970, 780.9415],
       device='cuda:3')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4,  6, 27,  3,  0,
         1,  2,  5, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.18% 

Test Accuracy: 88.67% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5955169796943665
distance x is tensor(168.0063, device='cuda:3')
benign distance is  tensor(168.0063, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.24481871724128723
distance x is tensor(142.7033, device='cuda:3')
benign distance is  tensor(142.7033, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.024820372462272644
distance x is tensor(146.3831, device='cuda:3')
benign distance is  tensor(146.3831, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.20350567996501923
distance x is tensor(139.6159, device='cuda:3')
benign distance is  tensor(139.6159, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.844630241394043
distance x is tensor(149.7016, device='cuda:3')
benign distance is  tensor(149.7016, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5762078762054443
distance x is tensor(135.8384, device='cuda:3')
benign distance is  tensor(135.8384, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.48121732473373413
distance x is tensor(143.1892, device='cuda:3')
benign distance is  tensor(143.1892, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7522724866867065
distance x is tensor(71.8513, device='cuda:3')
benign distance is  tensor(71.8513, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16420626640319824
distance x is tensor(165.7129, device='cuda:3')
benign distance is  tensor(165.7129, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7636076211929321
distance x is tensor(158.0794, device='cuda:3')
benign distance is  tensor(158.0794, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.36664915084838867
distance x is tensor(160.6555, device='cuda:3')
benign distance is  tensor(160.6555, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.928433895111084
distance x is tensor(165.0947, device='cuda:3')
benign distance is  tensor(165.0947, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3442002832889557
distance x is tensor(173.6243, device='cuda:3')
benign distance is  tensor(173.6243, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3778924345970154
distance x is tensor(166.1302, device='cuda:3')
benign distance is  tensor(166.1302, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7621694803237915
distance x is tensor(154.7111, device='cuda:3')
benign distance is  tensor(154.7111, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3584286570549011
distance x is tensor(113.2711, device='cuda:3')
benign distance is  tensor(113.2711, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5401687622070312
mal_entropy is 0.08333160728216171
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([718.6765, 624.2360, 632.2057, 595.1509, 637.6108, 590.6210, 612.6541,
        306.9227, 482.4744, 482.4744, 482.4744, 482.4744, 482.4744, 482.4744,
        482.4744, 482.4744, 482.4744, 482.4744, 482.4744, 482.4744, 792.6517,
        801.9523, 827.5671, 758.3726, 759.3304, 796.4847, 754.3011, 612.8244],
       device='cuda:3')
sorted_norm is   tensor([306.9227, 482.4744, 482.4744, 482.4744, 482.4744, 482.4744, 482.4744,
        482.4744, 482.4744, 482.4744, 482.4744, 482.4744, 482.4744, 590.6210,
        595.1509, 612.6541, 612.8244, 624.2360, 632.2057, 637.6108, 718.6765,
        754.3011, 758.3726, 759.3304, 792.6517, 796.4847, 801.9523, 827.5671],
       device='cuda:3')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  5,  3,  6, 27,  1,
         2,  4,  0, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.12% 

Test Accuracy: 88.15% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4208490252494812
distance x is tensor(163.2114, device='cuda:3')
benign distance is  tensor(163.2114, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3316333293914795
distance x is tensor(149.7100, device='cuda:3')
benign distance is  tensor(149.7100, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05695546790957451
distance x is tensor(150.9345, device='cuda:3')
benign distance is  tensor(150.9345, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7652184963226318
distance x is tensor(130.6114, device='cuda:3')
benign distance is  tensor(130.6114, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9807630777359009
distance x is tensor(124.7244, device='cuda:3')
benign distance is  tensor(124.7244, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4684988558292389
distance x is tensor(152.3970, device='cuda:3')
benign distance is  tensor(152.3970, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.311873435974121
distance x is tensor(137.6998, device='cuda:3')
benign distance is  tensor(137.6998, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.269681841135025
distance x is tensor(92.0525, device='cuda:3')
benign distance is  tensor(92.0525, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3029402494430542
distance x is tensor(168.2037, device='cuda:3')
benign distance is  tensor(168.2037, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.09757857024669647
distance x is tensor(186.8797, device='cuda:3')
benign distance is  tensor(186.8797, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.32328543066978455
distance x is tensor(186.8811, device='cuda:3')
benign distance is  tensor(186.8811, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2672496438026428
distance x is tensor(163.0900, device='cuda:3')
benign distance is  tensor(163.0900, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.21634607017040253
distance x is tensor(163.2548, device='cuda:3')
benign distance is  tensor(163.2548, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3395935893058777
distance x is tensor(173.3509, device='cuda:3')
benign distance is  tensor(173.3509, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7248116135597229
distance x is tensor(158.6632, device='cuda:3')
benign distance is  tensor(158.6632, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.37365666031837463
distance x is tensor(122.7051, device='cuda:3')
benign distance is  tensor(122.7051, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.844569206237793
mal_entropy is 0.08388182520866394
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([715.3698, 653.2271, 663.1149, 553.9047, 527.3527, 653.9827, 583.1660,
        389.3148, 509.9694, 509.9694, 509.9694, 509.9694, 509.9694, 509.9694,
        509.9694, 509.9694, 509.9694, 509.9694, 509.9694, 509.9694, 783.0176,
        825.7504, 774.2163, 829.1465, 771.5169, 866.2472, 828.9312, 564.8105,
        907.5554, 831.4764, 885.5070, 843.6660, 817.3619, 823.2896, 858.0692,
        512.8817, 820.8884, 822.0798, 771.5146, 746.9376, 748.9943, 735.7537,
        799.7748, 409.3372, 759.8165, 731.1418, 746.0752, 760.2289, 780.0814,
        762.1447, 713.5264, 237.1904], device='cuda:3')
sorted_norm is   tensor([237.1904, 389.3148, 409.3372, 509.9694, 509.9694, 509.9694, 509.9694,
        509.9694, 509.9694, 509.9694, 509.9694, 509.9694, 509.9694, 509.9694,
        509.9694, 512.8817, 527.3527, 553.9047, 564.8105, 583.1660, 653.2271,
        653.9827, 663.1149, 713.5264, 715.3698, 731.1418, 735.7537, 746.0752,
        746.9376, 748.9943, 759.8165, 760.2289, 762.1447, 771.5146, 771.5169,
        774.2163, 780.0814, 783.0176, 799.7748, 817.3619, 820.8884, 822.0798,
        823.2896, 825.7504, 828.9312, 829.1465, 831.4764, 843.6660, 858.0692,
        866.2472, 885.5070, 907.5554], device='cuda:3')
used idx is  tensor([51,  7, 43, 13,  9, 19, 15, 17, 11, 14, 10,  8, 16, 12, 18, 35,  4,  3,
        27,  6,  1,  5,  2, 50,  0, 45, 41, 46, 39, 40, 44, 47, 49, 38, 24, 22,
        48, 20, 42, 32, 36], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 88.89% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.115005612373352
distance x is tensor(122.7608, device='cuda:3')
benign distance is  tensor(122.7608, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.19201454520225525
distance x is tensor(113.7187, device='cuda:3')
benign distance is  tensor(113.7187, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05500262975692749
distance x is tensor(129.7503, device='cuda:3')
benign distance is  tensor(129.7503, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7572585940361023
distance x is tensor(112.4201, device='cuda:3')
benign distance is  tensor(112.4201, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.29207390546798706
distance x is tensor(101.6066, device='cuda:3')
benign distance is  tensor(101.6066, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.494987428188324
distance x is tensor(135.9705, device='cuda:3')
benign distance is  tensor(135.9705, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.07368391007184982
distance x is tensor(135.8788, device='cuda:3')
benign distance is  tensor(135.8788, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.13183172047138214
distance x is tensor(52.5591, device='cuda:3')
benign distance is  tensor(52.5591, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.385953813791275
distance x is tensor(150.2351, device='cuda:3')
benign distance is  tensor(150.2351, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.25961315631866455
distance x is tensor(157.2837, device='cuda:3')
benign distance is  tensor(157.2837, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.32717862725257874
distance x is tensor(141.8338, device='cuda:3')
benign distance is  tensor(141.8338, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.16675081849098206
distance x is tensor(154.0464, device='cuda:3')
benign distance is  tensor(154.0464, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6741021871566772
distance x is tensor(137.2185, device='cuda:3')
benign distance is  tensor(137.2185, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.22872431576251984
distance x is tensor(161.8649, device='cuda:3')
benign distance is  tensor(161.8649, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3057994842529297
distance x is tensor(151.8077, device='cuda:3')
benign distance is  tensor(151.8077, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7767362594604492
distance x is tensor(83.8412, device='cuda:3')
benign distance is  tensor(83.8412, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.45078057050704956
distance x is tensor(141.2050, device='cuda:3')
benign distance is  tensor(141.2050, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5151898264884949
distance x is tensor(167.3956, device='cuda:3')
benign distance is  tensor(167.3956, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3433672785758972
distance x is tensor(139.4574, device='cuda:3')
benign distance is  tensor(139.4574, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1827831119298935
distance x is tensor(137.0224, device='cuda:3')
benign distance is  tensor(137.0224, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.32489344477653503
distance x is tensor(152.8882, device='cuda:3')
benign distance is  tensor(152.8882, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0319950580596924
distance x is tensor(133.6792, device='cuda:3')
benign distance is  tensor(133.6792, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2904241681098938
distance x is tensor(156.7796, device='cuda:3')
benign distance is  tensor(156.7796, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.36384332180023193
distance x is tensor(96.2275, device='cuda:3')
benign distance is  tensor(96.2275, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.13972371816635132
distance x is tensor(177.3493, device='cuda:3')
benign distance is  tensor(177.3493, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.13398858904838562
distance x is tensor(142.9522, device='cuda:3')
benign distance is  tensor(142.9522, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.25724488496780396
distance x is tensor(156.6079, device='cuda:3')
benign distance is  tensor(156.6079, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.42850393056869507
distance x is tensor(157.8429, device='cuda:3')
benign distance is  tensor(157.8429, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8645319938659668
distance x is tensor(151.7303, device='cuda:3')
benign distance is  tensor(151.7303, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4024604260921478
distance x is tensor(153.9891, device='cuda:3')
benign distance is  tensor(153.9891, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2685496211051941
distance x is tensor(144.6347, device='cuda:3')
benign distance is  tensor(144.6347, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.16516877710819244
distance x is tensor(127.7858, device='cuda:3')
benign distance is  tensor(127.7858, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.38886135816574097
distance x is tensor(151.4682, device='cuda:3')
benign distance is  tensor(151.4682, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.23691213130950928
distance x is tensor(159.0572, device='cuda:3')
benign distance is  tensor(159.0572, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.5910725593566895
distance x is tensor(144.3180, device='cuda:3')
benign distance is  tensor(144.3180, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5205705165863037
distance x is tensor(157.0424, device='cuda:3')
benign distance is  tensor(157.0424, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.31211915612220764
distance x is tensor(149.2725, device='cuda:3')
benign distance is  tensor(149.2725, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6864848136901855
distance x is tensor(156.3132, device='cuda:3')
benign distance is  tensor(156.3132, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5723106265068054
distance x is tensor(163.9225, device='cuda:3')
benign distance is  tensor(163.9225, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.24734516441822052
distance x is tensor(103.7174, device='cuda:3')
benign distance is  tensor(103.7174, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.511756956577301
mal_entropy is 0.07893653959035873
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([538.1172, 503.7322, 569.8222, 477.4801, 433.2637, 585.2429, 572.2200,
        223.8858, 441.4207, 441.4207, 441.4207, 441.4207, 441.4207, 441.4207,
        441.4207, 441.4207, 441.4207, 441.4207, 441.4207, 441.4207],
       device='cuda:3')
sorted_norm is   tensor([223.8858, 433.2637, 441.4207, 441.4207, 441.4207, 441.4207, 441.4207,
        441.4207, 441.4207, 441.4207, 441.4207, 441.4207, 441.4207, 441.4207,
        477.4801, 503.7322, 538.1172, 569.8222, 572.2200, 585.2429],
       device='cuda:3')
used idx is  tensor([ 7,  4, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  3,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 89.38% 

Test Accuracy: 88.23% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2712734043598175
distance x is tensor(153.2414, device='cuda:3')
benign distance is  tensor(153.2414, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3645285964012146
distance x is tensor(162.1595, device='cuda:3')
benign distance is  tensor(162.1595, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2389024943113327
distance x is tensor(146.8447, device='cuda:3')
benign distance is  tensor(146.8447, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.920588493347168
distance x is tensor(136.3574, device='cuda:3')
benign distance is  tensor(136.3574, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.806174099445343
distance x is tensor(118.6474, device='cuda:3')
benign distance is  tensor(118.6474, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4133738875389099
distance x is tensor(145.2294, device='cuda:3')
benign distance is  tensor(145.2294, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20642812550067902
distance x is tensor(131.1991, device='cuda:3')
benign distance is  tensor(131.1991, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35250601172447205
distance x is tensor(90.3130, device='cuda:3')
benign distance is  tensor(90.3130, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.40919917821884155
mal_entropy is 0.008377901278436184
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([678.1432, 692.6970, 627.5394, 591.3091, 506.2483, 633.0455, 566.0508,
        396.0350, 396.0350, 396.0350, 396.0350, 396.0350, 396.0350, 396.0350,
        396.0350, 396.0350, 396.0350, 396.0350, 396.0350, 396.0350, 729.6451,
        747.8638, 694.6295, 725.6033, 682.8434, 767.4859, 740.5948, 480.8213],
       device='cuda:3')
sorted_norm is   tensor([396.0350, 396.0350, 396.0350, 396.0350, 396.0350, 396.0350, 396.0350,
        396.0350, 396.0350, 396.0350, 396.0350, 396.0350, 396.0350, 480.8213,
        506.2483, 566.0508, 591.3091, 627.5394, 633.0455, 678.1432, 682.8434,
        692.6970, 694.6295, 725.6033, 729.6451, 740.5948, 747.8638, 767.4859],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14,  7, 11, 10,  8,  9, 15, 27,  4,  6,  3,  2,
         5,  0, 24,  1], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.58% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.43609386682510376
distance x is tensor(172.8833, device='cuda:3')
benign distance is  tensor(172.8833, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6979579925537109
distance x is tensor(147.3462, device='cuda:3')
benign distance is  tensor(147.3462, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2994171380996704
distance x is tensor(152.1722, device='cuda:3')
benign distance is  tensor(152.1722, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.818522572517395
distance x is tensor(151.9635, device='cuda:3')
benign distance is  tensor(151.9635, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1148039102554321
distance x is tensor(133.1066, device='cuda:3')
benign distance is  tensor(133.1066, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5313313007354736
distance x is tensor(150.6341, device='cuda:3')
benign distance is  tensor(150.6341, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4096983075141907
distance x is tensor(136.6033, device='cuda:3')
benign distance is  tensor(136.6033, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5296354293823242
distance x is tensor(50.1007, device='cuda:3')
benign distance is  tensor(50.1007, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1098628044128418
distance x is tensor(172.2971, device='cuda:3')
benign distance is  tensor(172.2971, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.22850947082042694
distance x is tensor(163.0153, device='cuda:3')
benign distance is  tensor(163.0153, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.47644662857055664
distance x is tensor(159.3295, device='cuda:3')
benign distance is  tensor(159.3295, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.45695406198501587
distance x is tensor(162.9737, device='cuda:3')
benign distance is  tensor(162.9737, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4180469512939453
distance x is tensor(174.2892, device='cuda:3')
benign distance is  tensor(174.2892, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.06990374624729156
distance x is tensor(154.9097, device='cuda:3')
benign distance is  tensor(154.9097, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6672979593276978
distance x is tensor(162.5976, device='cuda:3')
benign distance is  tensor(162.5976, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3298409581184387
distance x is tensor(115.1359, device='cuda:3')
benign distance is  tensor(115.1359, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6289461851119995
mal_entropy is 0.08028217405080795
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([754.3780, 643.9489, 664.4939, 670.4732, 572.3005, 643.8856, 585.2363,
        212.2120, 481.5430, 481.5430, 481.5430, 481.5430, 481.5430, 481.5430,
        481.5430, 481.5430, 481.5430, 481.5430, 481.5430, 481.5430, 707.8116,
        810.1388, 692.8018, 690.5541, 743.7211, 681.6020, 763.4060, 548.1454],
       device='cuda:3')
sorted_norm is   tensor([212.2120, 481.5430, 481.5430, 481.5430, 481.5430, 481.5430, 481.5430,
        481.5430, 481.5430, 481.5430, 481.5430, 481.5430, 481.5430, 548.1454,
        572.3005, 585.2363, 643.8856, 643.9489, 664.4939, 670.4732, 681.6020,
        690.5541, 692.8018, 707.8116, 743.7211, 754.3780, 763.4060, 810.1388],
       device='cuda:3')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11, 27,  4,  6,  5,  1,
         2,  3, 25, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 89.61% 

Test Accuracy: 88.78% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2392309606075287
distance x is tensor(143.2816, device='cuda:3')
benign distance is  tensor(143.2816, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4093935489654541
distance x is tensor(135.9467, device='cuda:3')
benign distance is  tensor(135.9467, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2172277867794037
distance x is tensor(152.2033, device='cuda:3')
benign distance is  tensor(152.2033, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8750053644180298
distance x is tensor(154.5369, device='cuda:3')
benign distance is  tensor(154.5369, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.34701886773109436
distance x is tensor(155.2378, device='cuda:3')
benign distance is  tensor(155.2378, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5338432192802429
distance x is tensor(139.1644, device='cuda:3')
benign distance is  tensor(139.1644, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7642926573753357
distance x is tensor(144.6928, device='cuda:3')
benign distance is  tensor(144.6928, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6604817509651184
distance x is tensor(77.3437, device='cuda:3')
benign distance is  tensor(77.3437, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3414885103702545
distance x is tensor(181.9392, device='cuda:3')
benign distance is  tensor(181.9392, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.2435029000043869
distance x is tensor(183.6982, device='cuda:3')
benign distance is  tensor(183.6982, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3330729603767395
distance x is tensor(162.8134, device='cuda:3')
benign distance is  tensor(162.8134, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6497124433517456
distance x is tensor(170.4307, device='cuda:3')
benign distance is  tensor(170.4307, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.49953493475914
distance x is tensor(168.8488, device='cuda:3')
benign distance is  tensor(168.8488, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8961346745491028
distance x is tensor(171.9278, device='cuda:3')
benign distance is  tensor(171.9278, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.7509325742721558
distance x is tensor(171.3604, device='cuda:3')
benign distance is  tensor(171.3604, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.25164613127708435
distance x is tensor(127.0312, device='cuda:3')
benign distance is  tensor(127.0312, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.23149578273296356
mal_entropy is 0.08546837419271469
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([609.4726, 593.5375, 651.6818, 659.2646, 655.4992, 602.9290, 608.2561,
        334.4891, 528.4896, 528.4896, 528.4896, 528.4896, 528.4896, 528.4896,
        528.4896, 528.4896, 528.4896, 528.4896, 528.4896, 528.4896, 846.7001,
        900.7068, 902.4912, 824.9261, 823.3544, 842.5370, 810.8062, 575.5233,
        865.7124, 726.3884, 776.2203, 776.9071, 761.7021, 779.2188, 743.6852,
        692.4226, 781.8711, 752.9626, 741.4746, 748.0499, 805.7601, 716.5493,
        746.3135, 235.0180], device='cuda:3')
sorted_norm is   tensor([235.0180, 334.4891, 528.4896, 528.4896, 528.4896, 528.4896, 528.4896,
        528.4896, 528.4896, 528.4896, 528.4896, 528.4896, 528.4896, 528.4896,
        575.5233, 593.5375, 602.9290, 608.2561, 609.4726, 651.6818, 655.4992,
        659.2646, 692.4226, 716.5493, 726.3884, 741.4746, 743.6852, 746.3135,
        748.0499, 752.9626, 761.7021, 776.2203, 776.9071, 779.2188, 781.8711,
        805.7601, 810.8062, 823.3544, 824.9261, 842.5370, 846.7001, 865.7124,
        900.7068, 902.4912], device='cuda:3')
used idx is  tensor([43,  7, 12, 18, 10,  8, 14, 16, 15, 13,  9, 19, 11, 17, 27,  1,  5,  6,
         0,  2,  4,  3, 35, 41, 29, 38, 34, 42, 39, 37, 32, 30, 31, 33, 36],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.77% 

Test Accuracy: 89.09% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1580957174301147
distance x is tensor(146.8179, device='cuda:3')
benign distance is  tensor(146.8179, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1420645713806152
distance x is tensor(124.0159, device='cuda:3')
benign distance is  tensor(124.0159, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.022322747856378555
distance x is tensor(131.8979, device='cuda:3')
benign distance is  tensor(131.8979, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4785563051700592
distance x is tensor(106.4275, device='cuda:3')
benign distance is  tensor(106.4275, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.34439897537231445
distance x is tensor(100.0876, device='cuda:3')
benign distance is  tensor(100.0876, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.12406627833843231
distance x is tensor(121.5503, device='cuda:3')
benign distance is  tensor(121.5503, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.45685020089149475
distance x is tensor(128.1446, device='cuda:3')
benign distance is  tensor(128.1446, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6237075328826904
distance x is tensor(58.8099, device='cuda:3')
benign distance is  tensor(58.8099, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3120747208595276
distance x is tensor(165.4244, device='cuda:3')
benign distance is  tensor(165.4244, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4269704818725586
distance x is tensor(152.8612, device='cuda:3')
benign distance is  tensor(152.8612, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5568267703056335
distance x is tensor(141.0598, device='cuda:3')
benign distance is  tensor(141.0598, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.559721827507019
distance x is tensor(161.5302, device='cuda:3')
benign distance is  tensor(161.5302, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7649272680282593
distance x is tensor(139.9617, device='cuda:3')
benign distance is  tensor(139.9617, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.07768655568361282
distance x is tensor(169.3314, device='cuda:3')
benign distance is  tensor(169.3314, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.12727129459381104
distance x is tensor(145.6385, device='cuda:3')
benign distance is  tensor(145.6385, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2282012403011322
distance x is tensor(76.7112, device='cuda:3')
benign distance is  tensor(76.7112, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.18978630006313324
distance x is tensor(175.0235, device='cuda:3')
benign distance is  tensor(175.0235, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.47227707505226135
distance x is tensor(147.4336, device='cuda:3')
benign distance is  tensor(147.4336, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.37979310750961304
distance x is tensor(164.7796, device='cuda:3')
benign distance is  tensor(164.7796, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.16416843235492706
distance x is tensor(159.8874, device='cuda:3')
benign distance is  tensor(159.8874, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7877181172370911
distance x is tensor(157.8536, device='cuda:3')
benign distance is  tensor(157.8536, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8924851417541504
distance x is tensor(169.5743, device='cuda:3')
benign distance is  tensor(169.5743, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.19541005790233612
distance x is tensor(150.2659, device='cuda:3')
benign distance is  tensor(150.2659, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2903668284416199
distance x is tensor(117.4223, device='cuda:3')
benign distance is  tensor(117.4223, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.36977964639663696
distance x is tensor(180.8236, device='cuda:3')
benign distance is  tensor(180.8236, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.22335557639598846
distance x is tensor(175.9994, device='cuda:3')
benign distance is  tensor(175.9994, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.33538737893104553
distance x is tensor(161.0559, device='cuda:3')
benign distance is  tensor(161.0559, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.30371659994125366
distance x is tensor(152.6724, device='cuda:3')
benign distance is  tensor(152.6724, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0147864818572998
distance x is tensor(153.4756, device='cuda:3')
benign distance is  tensor(153.4756, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3560403287410736
distance x is tensor(157.6888, device='cuda:3')
benign distance is  tensor(157.6888, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5217370390892029
distance x is tensor(154.4351, device='cuda:3')
benign distance is  tensor(154.4351, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6082162857055664
distance x is tensor(113.5212, device='cuda:3')
benign distance is  tensor(113.5212, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.42832836508750916
mal_entropy is 0.10443534702062607
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([636.8502, 538.5482, 565.4239, 447.8582, 447.8444, 527.9994, 545.6035,
        241.0884, 482.5919, 482.5919, 482.5919, 482.5919, 482.5919, 482.5919,
        482.5919, 482.5919, 482.5919, 482.5919, 482.5919, 482.5919],
       device='cuda:3')
sorted_norm is   tensor([241.0884, 447.8444, 447.8582, 482.5919, 482.5919, 482.5919, 482.5919,
        482.5919, 482.5919, 482.5919, 482.5919, 482.5919, 482.5919, 482.5919,
        482.5919, 527.9994, 538.5482, 545.6035, 565.4239, 636.8502],
       device='cuda:3')
used idx is  tensor([ 7,  4,  3, 19, 15, 17, 13,  9, 11, 10, 16, 18,  8, 14, 12,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 88.75% 

Test Accuracy: 87.87% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.39798569679260254
distance x is tensor(155.9747, device='cuda:3')
benign distance is  tensor(155.9747, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.38605737686157227
distance x is tensor(165.3740, device='cuda:3')
benign distance is  tensor(165.3740, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15362834930419922
distance x is tensor(173.4618, device='cuda:3')
benign distance is  tensor(173.4618, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7545377016067505
distance x is tensor(159.0789, device='cuda:3')
benign distance is  tensor(159.0789, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8128713369369507
distance x is tensor(138.9686, device='cuda:3')
benign distance is  tensor(138.9686, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4266735017299652
distance x is tensor(156.7987, device='cuda:3')
benign distance is  tensor(156.7987, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5418047308921814
distance x is tensor(159.0253, device='cuda:3')
benign distance is  tensor(159.0253, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7063446640968323
distance x is tensor(97.0359, device='cuda:3')
benign distance is  tensor(97.0359, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.6587450504302979
mal_entropy is 0.06433108448982239
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([683.3404, 713.4387, 737.4318, 682.5248, 583.8314, 686.3841, 663.1988,
        401.5195, 401.5195, 401.5195, 401.5195, 401.5195, 401.5195, 401.5195,
        401.5195, 401.5195, 401.5195, 401.5195, 401.5195, 401.5195, 813.5047,
        839.9681, 786.1807, 830.7700, 797.9963, 819.9334, 845.3234, 541.6711,
        896.9498, 889.2222, 818.4495, 849.3271, 833.2551, 851.1407, 838.1187,
        531.1885, 793.8044, 755.6810, 714.1985, 778.1780, 696.5091, 806.6741,
        725.7891, 488.9114], device='cuda:3')
sorted_norm is   tensor([401.5195, 401.5195, 401.5195, 401.5195, 401.5195, 401.5195, 401.5195,
        401.5195, 401.5195, 401.5195, 401.5195, 401.5195, 401.5195, 488.9114,
        531.1885, 541.6711, 583.8314, 663.1988, 682.5248, 683.3404, 686.3841,
        696.5091, 713.4387, 714.1985, 725.7891, 737.4318, 755.6810, 778.1780,
        786.1807, 793.8044, 797.9963, 806.6741, 813.5047, 818.4495, 819.9334,
        830.7700, 833.2551, 838.1187, 839.9681, 845.3234, 849.3271, 851.1407,
        889.2222, 896.9498], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 43, 35, 27,  4,  6,
         3,  0,  5, 40,  1, 38, 42,  2, 37, 39, 22, 36, 24, 41, 20, 30, 25],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.88% 

Test Accuracy: 89.12% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.47663450241088867
distance x is tensor(144.9959, device='cuda:3')
benign distance is  tensor(144.9959, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6745330095291138
distance x is tensor(115.4722, device='cuda:3')
benign distance is  tensor(115.4722, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07908224314451218
distance x is tensor(153.5108, device='cuda:3')
benign distance is  tensor(153.5108, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5046008825302124
distance x is tensor(130.6703, device='cuda:3')
benign distance is  tensor(130.6703, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1230921521782875
distance x is tensor(110.4361, device='cuda:3')
benign distance is  tensor(110.4361, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8840154409408569
distance x is tensor(134.2495, device='cuda:3')
benign distance is  tensor(134.2495, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.44730573892593384
distance x is tensor(130.1913, device='cuda:3')
benign distance is  tensor(130.1913, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6709349751472473
distance x is tensor(55.2586, device='cuda:3')
benign distance is  tensor(55.2586, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25480514764785767
distance x is tensor(152.8440, device='cuda:3')
benign distance is  tensor(152.8440, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3216989040374756
distance x is tensor(154.7548, device='cuda:3')
benign distance is  tensor(154.7548, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6330704689025879
distance x is tensor(169.4249, device='cuda:3')
benign distance is  tensor(169.4249, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4061804413795471
distance x is tensor(162.4339, device='cuda:3')
benign distance is  tensor(162.4339, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.15480753779411316
distance x is tensor(139.9642, device='cuda:3')
benign distance is  tensor(139.9642, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.348137229681015
distance x is tensor(156.6473, device='cuda:3')
benign distance is  tensor(156.6473, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6832500696182251
distance x is tensor(161.4613, device='cuda:3')
benign distance is  tensor(161.4613, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.38477712869644165
distance x is tensor(79.4202, device='cuda:3')
benign distance is  tensor(79.4202, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.19877134263515472
distance x is tensor(148.4841, device='cuda:3')
benign distance is  tensor(148.4841, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7421368360519409
distance x is tensor(176.3196, device='cuda:3')
benign distance is  tensor(176.3196, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2224513590335846
distance x is tensor(158.3789, device='cuda:3')
benign distance is  tensor(158.3789, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.09681635349988937
distance x is tensor(155.8482, device='cuda:3')
benign distance is  tensor(155.8482, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2596420645713806
distance x is tensor(160.7386, device='cuda:3')
benign distance is  tensor(160.7386, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.40540584921836853
distance x is tensor(147.4719, device='cuda:3')
benign distance is  tensor(147.4719, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.06543026864528656
distance x is tensor(166.3371, device='cuda:3')
benign distance is  tensor(166.3371, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8239014744758606
distance x is tensor(84.0212, device='cuda:3')
benign distance is  tensor(84.0212, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2536575496196747
distance x is tensor(160.8698, device='cuda:3')
benign distance is  tensor(160.8698, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2012314349412918
distance x is tensor(158.4065, device='cuda:3')
benign distance is  tensor(158.4065, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.05639330670237541
distance x is tensor(157.4174, device='cuda:3')
benign distance is  tensor(157.4174, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.30079394578933716
distance x is tensor(161.1964, device='cuda:3')
benign distance is  tensor(161.1964, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2821139991283417
distance x is tensor(154.8326, device='cuda:3')
benign distance is  tensor(154.8326, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3088544011116028
distance x is tensor(159.1437, device='cuda:3')
benign distance is  tensor(159.1437, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.13256624341011047
distance x is tensor(174.0629, device='cuda:3')
benign distance is  tensor(174.0629, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7015582919120789
distance x is tensor(79.3317, device='cuda:3')
benign distance is  tensor(79.3317, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.7858389019966125
mal_entropy is 0.06001029163599014
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([645.8657, 510.4953, 665.1543, 549.4543, 476.8324, 582.1957, 544.4771,
        242.8322, 340.0045, 340.0046, 340.0045, 340.0046, 340.0045, 340.0046,
        340.0045, 340.0046, 340.0045, 340.0046, 340.0045, 340.0046],
       device='cuda:3')
sorted_norm is   tensor([242.8322, 340.0045, 340.0045, 340.0045, 340.0045, 340.0045, 340.0045,
        340.0046, 340.0046, 340.0046, 340.0046, 340.0046, 340.0046, 476.8324,
        510.4953, 544.4771, 549.4543, 582.1957, 645.8657, 665.1543],
       device='cuda:3')
used idx is  tensor([ 7, 18, 14, 16, 12,  8, 10, 17,  9, 13, 11, 19, 15,  4,  1,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 89.47% 

Test Accuracy: 88.61% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.39899811148643494
distance x is tensor(154.3319, device='cuda:3')
benign distance is  tensor(154.3319, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.39930376410484314
distance x is tensor(163.5613, device='cuda:3')
benign distance is  tensor(163.5613, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.37864917516708374
distance x is tensor(170.3703, device='cuda:3')
benign distance is  tensor(170.3703, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5469194650650024
distance x is tensor(154.4308, device='cuda:3')
benign distance is  tensor(154.4308, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3300260901451111
distance x is tensor(134.4133, device='cuda:3')
benign distance is  tensor(134.4133, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4178265631198883
distance x is tensor(154.7579, device='cuda:3')
benign distance is  tensor(154.7579, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3430212438106537
distance x is tensor(128.1209, device='cuda:3')
benign distance is  tensor(128.1209, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8415573239326477
distance x is tensor(71.5785, device='cuda:3')
benign distance is  tensor(71.5785, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.795012354850769
mal_entropy is 0.0422884002327919
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([659.3549, 708.3398, 727.0833, 671.5035, 571.0667, 680.3881, 556.0121,
        320.1856, 320.1856, 320.1856, 320.1856, 320.1856, 320.1856, 320.1856,
        320.1856, 320.1856, 320.1856, 320.1856, 320.1856, 320.1856, 838.4138,
        720.8820, 781.2932, 766.5308, 762.3134, 809.9845, 744.4523, 625.3879,
        698.0750, 723.7291, 786.3040, 735.2114, 650.0391, 718.8901, 738.1277,
        429.0511], device='cuda:3')
sorted_norm is   tensor([320.1856, 320.1856, 320.1856, 320.1856, 320.1856, 320.1856, 320.1856,
        320.1856, 320.1856, 320.1856, 320.1856, 320.1856, 320.1856, 429.0511,
        556.0121, 571.0667, 625.3879, 650.0391, 659.3549, 671.5035, 680.3881,
        698.0750, 708.3398, 718.8901, 720.8820, 723.7291, 727.0833, 735.2114,
        738.1277, 744.4523, 762.3134, 766.5308, 781.2932, 786.3040, 809.9845,
        838.4138], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 35,  6,  4, 27, 32,
         0,  3,  5, 28,  1, 33, 21, 29,  2, 31], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 89.87% 

Test Accuracy: 89.05% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8904359936714172
distance x is tensor(135.1377, device='cuda:3')
benign distance is  tensor(135.1377, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8329804539680481
distance x is tensor(124.7595, device='cuda:3')
benign distance is  tensor(124.7595, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4721006751060486
distance x is tensor(150.5169, device='cuda:3')
benign distance is  tensor(150.5169, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.16317406296730042
distance x is tensor(126.0527, device='cuda:3')
benign distance is  tensor(126.0527, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2487814724445343
distance x is tensor(109.3839, device='cuda:3')
benign distance is  tensor(109.3839, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8518745303153992
distance x is tensor(119.1961, device='cuda:3')
benign distance is  tensor(119.1961, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3365466892719269
distance x is tensor(125.2080, device='cuda:3')
benign distance is  tensor(125.2080, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6392748951911926
distance x is tensor(44.4667, device='cuda:3')
benign distance is  tensor(44.4667, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.30258408188819885
distance x is tensor(157.2903, device='cuda:3')
benign distance is  tensor(157.2903, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5695280432701111
distance x is tensor(166.7217, device='cuda:3')
benign distance is  tensor(166.7217, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5288998484611511
distance x is tensor(152.3025, device='cuda:3')
benign distance is  tensor(152.3025, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6237547397613525
distance x is tensor(154.7483, device='cuda:3')
benign distance is  tensor(154.7483, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6142593622207642
distance x is tensor(139.1723, device='cuda:3')
benign distance is  tensor(139.1723, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.26416075229644775
distance x is tensor(159.7365, device='cuda:3')
benign distance is  tensor(159.7365, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.36926719546318054
distance x is tensor(157.4866, device='cuda:3')
benign distance is  tensor(157.4866, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.364146888256073
distance x is tensor(124.6521, device='cuda:3')
benign distance is  tensor(124.6521, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6372478604316711
distance x is tensor(187.0166, device='cuda:3')
benign distance is  tensor(187.0166, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.37475281953811646
distance x is tensor(164.1495, device='cuda:3')
benign distance is  tensor(164.1495, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.13031534850597382
distance x is tensor(177.6184, device='cuda:3')
benign distance is  tensor(177.6184, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3547809422016144
distance x is tensor(173.6735, device='cuda:3')
benign distance is  tensor(173.6735, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1490060091018677
distance x is tensor(179.0461, device='cuda:3')
benign distance is  tensor(179.0461, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7765854597091675
distance x is tensor(172.2754, device='cuda:3')
benign distance is  tensor(172.2754, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.9989681243896484
distance x is tensor(173.2079, device='cuda:3')
benign distance is  tensor(173.2079, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5566445589065552
distance x is tensor(139.6492, device='cuda:3')
benign distance is  tensor(139.6492, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.17827844619750977
mal_entropy is 0.12928204238414764
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([592.4541, 549.1808, 634.2730, 549.3157, 459.8221, 522.0622, 524.0380,
        185.6770, 607.5166, 607.5166, 607.5166, 607.5166, 607.5166, 607.5166,
        607.5166, 607.5166, 607.5166, 607.5166, 607.5166, 607.5166, 855.3121,
        803.9994, 764.7238, 723.5223, 740.7134, 729.0085, 736.2715, 442.3571,
        693.5449, 794.3595, 704.1963, 720.3021, 727.5923, 675.2983, 752.1699,
        424.0787], device='cuda:3')
sorted_norm is   tensor([185.6770, 424.0787, 442.3571, 459.8221, 522.0622, 524.0380, 549.1808,
        549.3157, 592.4541, 607.5166, 607.5166, 607.5166, 607.5166, 607.5166,
        607.5166, 607.5166, 607.5166, 607.5166, 607.5166, 607.5166, 607.5166,
        634.2730, 675.2983, 693.5449, 704.1963, 720.3021, 723.5223, 727.5923,
        729.0085, 736.2715, 740.7134, 752.1699, 764.7238, 794.3595, 803.9994,
        855.3121], device='cuda:3')
used idx is  tensor([ 7, 35, 27,  4,  5,  6,  1,  3,  0, 15, 16, 18, 19, 12, 14, 17, 13, 11,
         8, 10,  9,  2, 33, 28, 30, 31, 23, 32], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.69% 

Test Accuracy: 88.44% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2800011932849884
distance x is tensor(142.7126, device='cuda:3')
benign distance is  tensor(142.7126, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.31385481357574463
distance x is tensor(132.7743, device='cuda:3')
benign distance is  tensor(132.7743, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17532996833324432
distance x is tensor(143.9752, device='cuda:3')
benign distance is  tensor(143.9752, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3680986762046814
distance x is tensor(123.4461, device='cuda:3')
benign distance is  tensor(123.4461, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5652480125427246
distance x is tensor(148.2742, device='cuda:3')
benign distance is  tensor(148.2742, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.427508682012558
distance x is tensor(133.6587, device='cuda:3')
benign distance is  tensor(133.6587, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.15178878605365753
distance x is tensor(115.9184, device='cuda:3')
benign distance is  tensor(115.9184, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.63581383228302
distance x is tensor(51.4394, device='cuda:3')
benign distance is  tensor(51.4394, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.18573294579982758
distance x is tensor(152.7826, device='cuda:3')
benign distance is  tensor(152.7826, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5797814130783081
distance x is tensor(202.4894, device='cuda:3')
benign distance is  tensor(202.4894, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3376186192035675
distance x is tensor(155.2159, device='cuda:3')
benign distance is  tensor(155.2159, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.18601351976394653
distance x is tensor(162.3360, device='cuda:3')
benign distance is  tensor(162.3360, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.14969190955162048
distance x is tensor(160.4267, device='cuda:3')
benign distance is  tensor(160.4267, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3837730884552002
distance x is tensor(155.4712, device='cuda:3')
benign distance is  tensor(155.4712, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3294346034526825
distance x is tensor(177.4813, device='cuda:3')
benign distance is  tensor(177.4813, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.2029448002576828
distance x is tensor(116.0806, device='cuda:3')
benign distance is  tensor(116.0806, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6757237315177917
distance x is tensor(170.2087, device='cuda:3')
benign distance is  tensor(170.2087, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.09499268233776093
distance x is tensor(179.5672, device='cuda:3')
benign distance is  tensor(179.5672, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8079898953437805
distance x is tensor(171.7402, device='cuda:3')
benign distance is  tensor(171.7402, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.18637803196907043
distance x is tensor(154.7603, device='cuda:3')
benign distance is  tensor(154.7603, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5329087972640991
distance x is tensor(157.3527, device='cuda:3')
benign distance is  tensor(157.3527, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.16555051505565643
distance x is tensor(143.9640, device='cuda:3')
benign distance is  tensor(143.9640, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.21054688096046448
distance x is tensor(158.1523, device='cuda:3')
benign distance is  tensor(158.1523, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.11882822215557098
distance x is tensor(85.8231, device='cuda:3')
benign distance is  tensor(85.8231, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3291015326976776
mal_entropy is 0.04134136810898781
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([606.8528, 575.0165, 627.4381, 534.3375, 648.6263, 584.4033, 490.0706,
        221.7786, 361.2279, 361.2279, 361.2279, 361.2279, 361.2279, 361.2279,
        361.2279, 361.2279, 361.2279, 361.2279, 361.2279, 361.2279, 724.0413,
        764.7373, 712.0373, 717.8189, 666.5137, 746.4426, 731.9321, 601.8594],
       device='cuda:3')
sorted_norm is   tensor([221.7786, 361.2279, 361.2279, 361.2279, 361.2279, 361.2279, 361.2279,
        361.2279, 361.2279, 361.2279, 361.2279, 361.2279, 361.2279, 490.0706,
        534.3375, 575.0165, 584.4033, 601.8594, 606.8528, 627.4381, 648.6263,
        666.5137, 712.0373, 717.8189, 724.0413, 731.9321, 746.4426, 764.7373],
       device='cuda:3')
used idx is  tensor([ 7, 18, 14, 16, 12,  8, 10, 17,  9, 13, 11, 19, 15,  6,  3,  1,  5, 27,
         0,  2,  4, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 89.67% 

Test Accuracy: 88.69% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3921476900577545
distance x is tensor(149.8431, device='cuda:3')
benign distance is  tensor(149.8431, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2024215459823608
distance x is tensor(147.1956, device='cuda:3')
benign distance is  tensor(147.1956, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22371366620063782
distance x is tensor(142.8836, device='cuda:3')
benign distance is  tensor(142.8836, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2098965644836426
distance x is tensor(143.9098, device='cuda:3')
benign distance is  tensor(143.9098, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5015672445297241
distance x is tensor(108.6753, device='cuda:3')
benign distance is  tensor(108.6753, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7815702557563782
distance x is tensor(143.9359, device='cuda:3')
benign distance is  tensor(143.9359, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.09572675079107285
distance x is tensor(147.9883, device='cuda:3')
benign distance is  tensor(147.9883, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.07553160190582275
distance x is tensor(68.3208, device='cuda:3')
benign distance is  tensor(68.3208, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.06545054912567139
distance x is tensor(182.9244, device='cuda:3')
benign distance is  tensor(182.9244, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.17009398341178894
distance x is tensor(182.8579, device='cuda:3')
benign distance is  tensor(182.8579, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.12838348746299744
distance x is tensor(154.9594, device='cuda:3')
benign distance is  tensor(154.9594, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4503245949745178
distance x is tensor(167.6873, device='cuda:3')
benign distance is  tensor(167.6873, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8429538607597351
distance x is tensor(169.5251, device='cuda:3')
benign distance is  tensor(169.5251, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1623697727918625
distance x is tensor(155.3066, device='cuda:3')
benign distance is  tensor(155.3066, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5651138424873352
distance x is tensor(170.5606, device='cuda:3')
benign distance is  tensor(170.5606, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5164790749549866
distance x is tensor(107.6780, device='cuda:3')
benign distance is  tensor(107.6780, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5284708738327026
mal_entropy is 0.045338910073041916
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([651.0457, 633.9573, 607.3325, 613.0178, 459.1351, 625.5876, 619.2485,
        306.9210, 460.2403, 460.2403, 460.2403, 460.2403, 460.2403, 460.2403,
        460.2403, 460.2403, 460.2403, 460.2403, 460.2403, 460.2403],
       device='cuda:3')
sorted_norm is   tensor([306.9210, 459.1351, 460.2403, 460.2403, 460.2403, 460.2403, 460.2403,
        460.2403, 460.2403, 460.2403, 460.2403, 460.2403, 460.2403, 460.2403,
        607.3325, 613.0178, 619.2485, 625.5876, 633.9573, 651.0457],
       device='cuda:3')
used idx is  tensor([ 7,  4, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  2,  3],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 89.47% 

Test Accuracy: 88.17% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5103036165237427
distance x is tensor(172.3941, device='cuda:3')
benign distance is  tensor(172.3941, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7989699244499207
distance x is tensor(164.0488, device='cuda:3')
benign distance is  tensor(164.0488, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06546718627214432
distance x is tensor(155.9150, device='cuda:3')
benign distance is  tensor(155.9150, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5609678626060486
distance x is tensor(176.2213, device='cuda:3')
benign distance is  tensor(176.2213, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8128652572631836
distance x is tensor(143.5306, device='cuda:3')
benign distance is  tensor(143.5306, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5995794534683228
distance x is tensor(171.2435, device='cuda:3')
benign distance is  tensor(171.2435, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6392003893852234
distance x is tensor(152.3701, device='cuda:3')
benign distance is  tensor(152.3701, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1665191501379013
distance x is tensor(110.5202, device='cuda:3')
benign distance is  tensor(110.5202, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.22645100951194763
mal_entropy is 0.04411335662007332
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([723.2320, 717.1191, 651.8958, 741.7769, 606.0870, 741.2730, 636.2733,
        471.7762, 471.7761, 471.7762, 471.7761, 471.7762, 471.7761, 471.7762,
        471.7761, 471.7762, 471.7761, 471.7762, 471.7761, 471.7762, 824.9996,
        832.0327, 833.6418, 847.4218, 809.8135, 833.8736, 874.7905, 533.7452,
        922.1694, 828.5083, 886.3997, 869.9833, 901.7317, 880.3549, 869.7731,
        579.1490, 777.2549, 941.7800, 771.9053, 816.9465, 789.5418, 763.8421,
        868.2104, 622.7366, 853.8271, 858.2273, 746.3766, 782.1021, 814.8959,
        737.1277, 807.8232, 130.9036], device='cuda:3')
sorted_norm is   tensor([130.9036, 471.7761, 471.7761, 471.7761, 471.7761, 471.7761, 471.7761,
        471.7762, 471.7762, 471.7762, 471.7762, 471.7762, 471.7762, 471.7762,
        533.7452, 579.1490, 606.0870, 622.7366, 636.2733, 651.8958, 717.1191,
        723.2320, 737.1277, 741.2730, 741.7769, 746.3766, 763.8421, 771.9053,
        777.2549, 782.1021, 789.5418, 807.8232, 809.8135, 814.8959, 816.9465,
        824.9996, 828.5083, 832.0327, 833.6418, 833.8736, 847.4218, 853.8271,
        858.2273, 868.2104, 869.7731, 869.9833, 874.7905, 880.3549, 886.3997,
        901.7317, 922.1694, 941.7800], device='cuda:3')
used idx is  tensor([51, 10, 18, 16, 12,  8, 14, 17,  7, 13, 15, 11,  9, 19, 27, 35,  4, 43,
         6,  2,  1,  0, 49,  5,  3, 46, 41, 38, 36, 47, 40, 50, 24, 48, 39, 20,
        29, 21, 22, 25, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.80% 

Test Accuracy: 88.75% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4260781407356262
distance x is tensor(130.6196, device='cuda:3')
benign distance is  tensor(130.6196, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5478624105453491
distance x is tensor(142.7543, device='cuda:3')
benign distance is  tensor(142.7543, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05155886337161064
distance x is tensor(133.4887, device='cuda:3')
benign distance is  tensor(133.4887, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4985426962375641
distance x is tensor(104.9009, device='cuda:3')
benign distance is  tensor(104.9009, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3680710792541504
distance x is tensor(96.4643, device='cuda:3')
benign distance is  tensor(96.4643, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4404071271419525
distance x is tensor(124.0573, device='cuda:3')
benign distance is  tensor(124.0573, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2757710814476013
distance x is tensor(139.3999, device='cuda:3')
benign distance is  tensor(139.3999, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2820718288421631
distance x is tensor(32.6595, device='cuda:3')
benign distance is  tensor(32.6595, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.22315537929534912
distance x is tensor(169.6963, device='cuda:3')
benign distance is  tensor(169.6963, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4940611720085144
distance x is tensor(149.9785, device='cuda:3')
benign distance is  tensor(149.9785, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.28164616227149963
distance x is tensor(141.0652, device='cuda:3')
benign distance is  tensor(141.0652, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.42332905530929565
distance x is tensor(165.4664, device='cuda:3')
benign distance is  tensor(165.4664, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3172284960746765
distance x is tensor(147.9059, device='cuda:3')
benign distance is  tensor(147.9059, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.23101794719696045
distance x is tensor(145.4099, device='cuda:3')
benign distance is  tensor(145.4099, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.46879109740257263
distance x is tensor(143.6334, device='cuda:3')
benign distance is  tensor(143.6334, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2521626353263855
distance x is tensor(65.0559, device='cuda:3')
benign distance is  tensor(65.0559, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3013322055339813
distance x is tensor(160.8750, device='cuda:3')
benign distance is  tensor(160.8750, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4497915208339691
distance x is tensor(184.7787, device='cuda:3')
benign distance is  tensor(184.7787, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.20715343952178955
distance x is tensor(165.2882, device='cuda:3')
benign distance is  tensor(165.2882, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.10186312347650528
distance x is tensor(159.9280, device='cuda:3')
benign distance is  tensor(159.9280, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.12088377773761749
distance x is tensor(165.2961, device='cuda:3')
benign distance is  tensor(165.2961, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.57794588804245
distance x is tensor(151.6834, device='cuda:3')
benign distance is  tensor(151.6834, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2701127827167511
distance x is tensor(162.0714, device='cuda:3')
benign distance is  tensor(162.0714, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.18474914133548737
distance x is tensor(96.1364, device='cuda:3')
benign distance is  tensor(96.1364, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3920212686061859
distance x is tensor(175.3139, device='cuda:3')
benign distance is  tensor(175.3139, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4042896628379822
distance x is tensor(152.7417, device='cuda:3')
benign distance is  tensor(152.7417, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7668782472610474
distance x is tensor(189.3725, device='cuda:3')
benign distance is  tensor(189.3725, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.41328153014183044
distance x is tensor(164.0494, device='cuda:3')
benign distance is  tensor(164.0494, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0415315628051758
distance x is tensor(163.9127, device='cuda:3')
benign distance is  tensor(163.9127, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2420550286769867
distance x is tensor(153.7251, device='cuda:3')
benign distance is  tensor(153.7251, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.40240684151649475
distance x is tensor(170.4796, device='cuda:3')
benign distance is  tensor(170.4796, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5274257659912109
distance x is tensor(82.1196, device='cuda:3')
benign distance is  tensor(82.1196, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.25015369057655334
distance x is tensor(143.7128, device='cuda:3')
benign distance is  tensor(143.7128, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5807186961174011
distance x is tensor(152.9768, device='cuda:3')
benign distance is  tensor(152.9768, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.42485809326171875
distance x is tensor(151.0031, device='cuda:3')
benign distance is  tensor(151.0031, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.23776200413703918
distance x is tensor(171.0525, device='cuda:3')
benign distance is  tensor(171.0525, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.47365155816078186
distance x is tensor(155.7278, device='cuda:3')
benign distance is  tensor(155.7278, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.34032201766967773
distance x is tensor(155.9688, device='cuda:3')
benign distance is  tensor(155.9688, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.16535761952400208
distance x is tensor(157.5340, device='cuda:3')
benign distance is  tensor(157.5340, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4234592020511627
distance x is tensor(97.4427, device='cuda:3')
benign distance is  tensor(97.4427, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6589463949203491
mal_entropy is 0.0675755962729454
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([573.6083, 613.5250, 564.5740, 433.1174, 399.9518, 539.7139, 586.2814,
        137.6732, 429.3472, 429.3472, 429.3472, 429.3472, 429.3472, 429.3472,
        429.3472, 429.3472, 429.3472, 429.3472, 429.3472, 429.3472],
       device='cuda:3')
sorted_norm is   tensor([137.6732, 399.9518, 429.3472, 429.3472, 429.3472, 429.3472, 429.3472,
        429.3472, 429.3472, 429.3472, 429.3472, 429.3472, 429.3472, 429.3472,
        433.1174, 539.7139, 564.5740, 573.6083, 586.2814, 613.5250],
       device='cuda:3')
used idx is  tensor([ 7,  4, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  3,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 89.67% 

Test Accuracy: 88.65% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7880133390426636
distance x is tensor(166.6101, device='cuda:3')
benign distance is  tensor(166.6101, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5566846132278442
distance x is tensor(130.1770, device='cuda:3')
benign distance is  tensor(130.1770, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1211898922920227
distance x is tensor(164.9204, device='cuda:3')
benign distance is  tensor(164.9204, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2792928218841553
distance x is tensor(133.1702, device='cuda:3')
benign distance is  tensor(133.1702, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8550812602043152
distance x is tensor(158.8846, device='cuda:3')
benign distance is  tensor(158.8846, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8285910487174988
distance x is tensor(134.9159, device='cuda:3')
benign distance is  tensor(134.9159, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.49849575757980347
distance x is tensor(159.1109, device='cuda:3')
benign distance is  tensor(159.1109, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22232238948345184
distance x is tensor(113.6749, device='cuda:3')
benign distance is  tensor(113.6749, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.17335234582424164
mal_entropy is 0.10395558178424835
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([726.7119, 565.3436, 693.1479, 558.9464, 656.6805, 569.2953, 669.2397,
        499.1880, 499.1880, 499.1880, 499.1880, 499.1880, 499.1880, 499.1880,
        499.1880, 499.1880, 499.1880, 499.1880, 499.1880, 499.1880, 839.2145,
        877.2208, 836.3411, 791.2655, 794.3011, 742.0737, 791.1194, 483.4620,
        806.8499, 722.6948, 689.2198, 768.5441, 705.1177, 706.6971, 706.3127,
        428.1013], device='cuda:3')
sorted_norm is   tensor([428.1013, 483.4620, 499.1880, 499.1880, 499.1880, 499.1880, 499.1880,
        499.1880, 499.1880, 499.1880, 499.1880, 499.1880, 499.1880, 499.1880,
        499.1880, 558.9464, 565.3436, 569.2953, 656.6805, 669.2397, 689.2198,
        693.1479, 705.1177, 706.3127, 706.6971, 722.6948, 726.7119, 742.0737,
        768.5441, 791.1194, 791.2655, 794.3011, 806.8499, 836.3411, 839.2145,
        877.2208], device='cuda:3')
used idx is  tensor([35, 27, 13, 18, 19, 12, 11, 17, 14, 10,  8,  9, 16, 15,  7,  3,  1,  5,
         4,  6, 30,  2, 32, 34, 33, 29,  0, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 90.05% 

Test Accuracy: 88.81% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 90.05%
|----0th round Training Accuracy : 88.92%
|----1th round Training Accuracy : 88.80%
|----2th round Training Accuracy : 89.07%
|----3th round Training Accuracy : 88.93%
|----4th round Training Accuracy : 89.37%
|----5th round Training Accuracy : 89.59%
|----6th round Training Accuracy : 89.51%
|----7th round Training Accuracy : 89.16%
|----8th round Training Accuracy : 89.57%
|----9th round Training Accuracy : 89.46%
|----10th round Training Accuracy : 88.77%
|----11th round Training Accuracy : 89.58%
|----12th round Training Accuracy : 89.82%
|----13th round Training Accuracy : 89.62%
|----14th round Training Accuracy : 89.28%
|----15th round Training Accuracy : 89.43%
|----16th round Training Accuracy : 89.33%
|----17th round Training Accuracy : 90.04%
|----18th round Training Accuracy : 88.92%
|----19th round Training Accuracy : 89.75%
|----20th round Training Accuracy : 89.45%
|----21th round Training Accuracy : 89.27%
|----22th round Training Accuracy : 89.22%
|----23th round Training Accuracy : 89.93%
|----24th round Training Accuracy : 89.61%
|----25th round Training Accuracy : 89.15%
|----26th round Training Accuracy : 89.32%
|----27th round Training Accuracy : 89.35%
|----28th round Training Accuracy : 88.72%
|----29th round Training Accuracy : 89.52%
|----30th round Training Accuracy : 88.93%
|----31th round Training Accuracy : 89.48%
|----32th round Training Accuracy : 89.21%
|----33th round Training Accuracy : 89.18%
|----34th round Training Accuracy : 89.12%
|----35th round Training Accuracy : 89.78%
|----36th round Training Accuracy : 89.38%
|----37th round Training Accuracy : 89.58%
|----38th round Training Accuracy : 89.61%
|----39th round Training Accuracy : 89.77%
|----40th round Training Accuracy : 88.75%
|----41th round Training Accuracy : 89.88%
|----42th round Training Accuracy : 89.47%
|----43th round Training Accuracy : 89.87%
|----44th round Training Accuracy : 89.69%
|----45th round Training Accuracy : 89.67%
|----46th round Training Accuracy : 89.47%
|----47th round Training Accuracy : 89.80%
|----48th round Training Accuracy : 89.67%
|----49th round Training Accuracy : 90.05%
|----Final Test Accuracy: 88.81%
|----0th round Final Test Accuracy : 88.10%
|----1th round Final Test Accuracy : 88.09%
|----2th round Final Test Accuracy : 88.18%
|----3th round Final Test Accuracy : 88.55%
|----4th round Final Test Accuracy : 88.29%
|----5th round Final Test Accuracy : 88.84%
|----6th round Final Test Accuracy : 88.23%
|----7th round Final Test Accuracy : 87.92%
|----8th round Final Test Accuracy : 88.32%
|----9th round Final Test Accuracy : 88.64%
|----10th round Final Test Accuracy : 87.81%
|----11th round Final Test Accuracy : 88.49%
|----12th round Final Test Accuracy : 88.41%
|----13th round Final Test Accuracy : 88.84%
|----14th round Final Test Accuracy : 88.07%
|----15th round Final Test Accuracy : 88.47%
|----16th round Final Test Accuracy : 88.17%
|----17th round Final Test Accuracy : 88.96%
|----18th round Final Test Accuracy : 88.15%
|----19th round Final Test Accuracy : 88.85%
|----20th round Final Test Accuracy : 88.79%
|----21th round Final Test Accuracy : 88.54%
|----22th round Final Test Accuracy : 88.50%
|----23th round Final Test Accuracy : 88.85%
|----24th round Final Test Accuracy : 88.61%
|----25th round Final Test Accuracy : 88.48%
|----26th round Final Test Accuracy : 88.46%
|----27th round Final Test Accuracy : 88.99%
|----28th round Final Test Accuracy : 87.84%
|----29th round Final Test Accuracy : 88.70%
|----30th round Final Test Accuracy : 88.14%
|----31th round Final Test Accuracy : 88.48%
|----32th round Final Test Accuracy : 88.61%
|----33th round Final Test Accuracy : 88.67%
|----34th round Final Test Accuracy : 88.15%
|----35th round Final Test Accuracy : 88.89%
|----36th round Final Test Accuracy : 88.23%
|----37th round Final Test Accuracy : 88.58%
|----38th round Final Test Accuracy : 88.78%
|----39th round Final Test Accuracy : 89.09%
|----40th round Final Test Accuracy : 87.87%
|----41th round Final Test Accuracy : 89.12%
|----42th round Final Test Accuracy : 88.61%
|----43th round Final Test Accuracy : 89.05%
|----44th round Final Test Accuracy : 88.44%
|----45th round Final Test Accuracy : 88.69%
|----46th round Final Test Accuracy : 88.17%
|----47th round Final Test Accuracy : 88.75%
|----48th round Final Test Accuracy : 88.65%
|----49th round Final Test Accuracy : 88.81%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3963.3464
