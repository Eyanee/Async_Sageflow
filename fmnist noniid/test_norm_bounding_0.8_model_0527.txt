
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3553426265716553
distance x is tensor(109.7278, device='cuda:0')
benign distance is  tensor(109.7278, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7045865654945374
distance x is tensor(120.1823, device='cuda:0')
benign distance is  tensor(120.1823, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5406290888786316
distance x is tensor(122.2537, device='cuda:0')
benign distance is  tensor(122.2537, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.48146384954452515
distance x is tensor(120.3909, device='cuda:0')
benign distance is  tensor(120.3909, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7629255056381226
distance x is tensor(105.5813, device='cuda:0')
benign distance is  tensor(105.5813, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.39223724603652954
distance x is tensor(117.4939, device='cuda:0')
benign distance is  tensor(117.4939, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7997885942459106
distance x is tensor(103.6649, device='cuda:0')
benign distance is  tensor(103.6649, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.36569875478744507
distance x is tensor(128.0938, device='cuda:0')
benign distance is  tensor(128.0938, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5594932436943054
distance x is tensor(140.5251, device='cuda:0')
benign distance is  tensor(140.5251, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3350607752799988
distance x is tensor(131.6375, device='cuda:0')
benign distance is  tensor(131.6375, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.42810001969337463
distance x is tensor(135.2976, device='cuda:0')
benign distance is  tensor(135.2976, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.23013043403625488
distance x is tensor(126.0420, device='cuda:0')
benign distance is  tensor(126.0420, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.43205809593200684
distance x is tensor(133.2058, device='cuda:0')
benign distance is  tensor(133.2058, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.322290301322937
distance x is tensor(148.3898, device='cuda:0')
benign distance is  tensor(148.3898, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9462450742721558
distance x is tensor(133.1814, device='cuda:0')
benign distance is  tensor(133.1814, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.40465348958969116
distance x is tensor(138.9180, device='cuda:0')
benign distance is  tensor(138.9180, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3487255871295929
distance x is tensor(122.1206, device='cuda:0')
benign distance is  tensor(122.1206, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7777518033981323
distance x is tensor(147.1412, device='cuda:0')
benign distance is  tensor(147.1412, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5336905717849731
distance x is tensor(127.0453, device='cuda:0')
benign distance is  tensor(127.0453, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7584120631217957
distance x is tensor(132.8839, device='cuda:0')
benign distance is  tensor(132.8839, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.0983039066195488
distance x is tensor(129.0847, device='cuda:0')
benign distance is  tensor(129.0847, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.22011509537696838
distance x is tensor(121.8394, device='cuda:0')
benign distance is  tensor(121.8394, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6289790868759155
distance x is tensor(140.1349, device='cuda:0')
benign distance is  tensor(140.1349, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1545557975769043
distance x is tensor(132.3337, device='cuda:0')
benign distance is  tensor(132.3337, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4694625735282898
distance x is tensor(138.9061, device='cuda:0')
benign distance is  tensor(138.9061, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.43099910020828247
distance x is tensor(118.7624, device='cuda:0')
benign distance is  tensor(118.7624, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7130895853042603
distance x is tensor(144.2998, device='cuda:0')
benign distance is  tensor(144.2998, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.14997948706150055
distance x is tensor(133.8076, device='cuda:0')
benign distance is  tensor(133.8076, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7101722955703735
distance x is tensor(124.7607, device='cuda:0')
benign distance is  tensor(124.7607, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6032553911209106
distance x is tensor(134.4040, device='cuda:0')
benign distance is  tensor(134.4040, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5380991101264954
distance x is tensor(126.9507, device='cuda:0')
benign distance is  tensor(126.9507, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6970945596694946
distance x is tensor(135.0001, device='cuda:0')
benign distance is  tensor(135.0001, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3818831741809845
distance x is tensor(138.1251, device='cuda:0')
benign distance is  tensor(138.1251, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.5237594842910767
distance x is tensor(127.9946, device='cuda:0')
benign distance is  tensor(127.9946, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4556071162223816
distance x is tensor(137.1294, device='cuda:0')
benign distance is  tensor(137.1294, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.03934298828244209
distance x is tensor(125.0127, device='cuda:0')
benign distance is  tensor(125.0127, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4660063683986664
distance x is tensor(127.8396, device='cuda:0')
benign distance is  tensor(127.8396, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2654173970222473
distance x is tensor(124.2010, device='cuda:0')
benign distance is  tensor(124.2010, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2620469927787781
distance x is tensor(128.0350, device='cuda:0')
benign distance is  tensor(128.0350, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.20187649130821228
distance x is tensor(131.3522, device='cuda:0')
benign distance is  tensor(131.3522, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.14401914179325104
distance x is tensor(127.4169, device='cuda:0')
benign distance is  tensor(127.4169, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3569236397743225
distance x is tensor(124.3094, device='cuda:0')
benign distance is  tensor(124.3094, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08090553432703018
distance x is tensor(128.3680, device='cuda:0')
benign distance is  tensor(128.3680, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.253650963306427
distance x is tensor(133.3589, device='cuda:0')
benign distance is  tensor(133.3589, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3444787859916687
distance x is tensor(141.6697, device='cuda:0')
benign distance is  tensor(141.6697, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8686403036117554
distance x is tensor(128.2791, device='cuda:0')
benign distance is  tensor(128.2791, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9193313717842102
distance x is tensor(136.7073, device='cuda:0')
benign distance is  tensor(136.7073, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.1707669198513031
distance x is tensor(134.1327, device='cuda:0')
benign distance is  tensor(134.1327, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 493.8270,  569.0493,  550.8337,  544.0002,  480.7481,  537.0666,
         463.3626,  595.4317, 3975.0132, 3978.1094, 3988.7883, 3993.9424,
        3977.1755, 3981.3386, 3986.1301, 3974.3594, 3990.6167, 3985.9336,
        3993.3279, 3983.4312], device='cuda:0')
sorted_norm is   tensor([ 463.3626,  480.7481,  493.8270,  537.0666,  544.0002,  550.8337,
         569.0493,  595.4317, 3974.3594, 3975.0132, 3977.1755, 3978.1094,
        3981.3386, 3983.4312, 3985.9336, 3986.1301, 3988.7883, 3990.6167,
        3993.3279, 3993.9424], device='cuda:0')
used idx is  tensor([ 6,  4,  0,  5,  3,  2,  1,  7, 15,  8, 12,  9, 13, 19, 17, 14],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9951260685920715
distance x is tensor(67.0084, device='cuda:0')
benign distance is  tensor(67.0084, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1193568706512451
distance x is tensor(68.4336, device='cuda:0')
benign distance is  tensor(68.4336, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1063594818115234
distance x is tensor(71.7650, device='cuda:0')
benign distance is  tensor(71.7650, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0438640117645264
distance x is tensor(69.3321, device='cuda:0')
benign distance is  tensor(69.3321, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1375072002410889
distance x is tensor(63.2246, device='cuda:0')
benign distance is  tensor(63.2246, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9856878519058228
distance x is tensor(65.8736, device='cuda:0')
benign distance is  tensor(65.8736, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3881442546844482
distance x is tensor(72.5851, device='cuda:0')
benign distance is  tensor(72.5851, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8428497314453125
distance x is tensor(65.1677, device='cuda:0')
benign distance is  tensor(65.1677, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 493.2365,  497.7603,  513.2455,  501.1586,  499.5996,  486.7928,
         521.7709,  476.7871,  616.1559,  587.5904,  598.3947,  594.6003,
         571.8376,  525.7999,  584.7445,  603.6437,  558.8812,  587.6084,
         582.3563,  590.8378, 2078.6362, 2064.8472, 2082.0171, 2061.4434,
        2064.4939, 2085.9453, 2072.0076, 2081.3748], device='cuda:0')
sorted_norm is   tensor([ 476.7871,  486.7928,  493.2365,  497.7603,  499.5996,  501.1586,
         513.2455,  521.7709,  525.7999,  558.8812,  571.8376,  582.3563,
         584.7445,  587.5904,  587.6084,  590.8378,  594.6003,  598.3947,
         603.6437,  616.1559, 2061.4434, 2064.4939, 2064.8472, 2072.0076,
        2078.6362, 2081.3748, 2082.0171, 2085.9453], device='cuda:0')
used idx is  tensor([ 7,  5,  0,  1,  4,  3,  2,  6, 13, 16, 12, 18, 14,  9, 17, 19, 11, 10,
        15,  8, 23, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3887285590171814
distance x is tensor(135.3391, device='cuda:0')
benign distance is  tensor(135.3391, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.49492114782333374
distance x is tensor(130.3772, device='cuda:0')
benign distance is  tensor(130.3772, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2482069432735443
distance x is tensor(129.1813, device='cuda:0')
benign distance is  tensor(129.1813, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4617580473423004
distance x is tensor(130.1515, device='cuda:0')
benign distance is  tensor(130.1515, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.39845141768455505
distance x is tensor(137.4526, device='cuda:0')
benign distance is  tensor(137.4526, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5651378631591797
distance x is tensor(124.9414, device='cuda:0')
benign distance is  tensor(124.9414, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.34231895208358765
distance x is tensor(131.0742, device='cuda:0')
benign distance is  tensor(131.0742, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.48668211698532104
distance x is tensor(133.4435, device='cuda:0')
benign distance is  tensor(133.4435, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.586190402507782
distance x is tensor(129.0957, device='cuda:0')
benign distance is  tensor(129.0957, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4617767930030823
distance x is tensor(135.3805, device='cuda:0')
benign distance is  tensor(135.3805, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.37388962507247925
distance x is tensor(129.9772, device='cuda:0')
benign distance is  tensor(129.9772, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6028313636779785
distance x is tensor(129.1203, device='cuda:0')
benign distance is  tensor(129.1203, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.41245555877685547
distance x is tensor(127.7125, device='cuda:0')
benign distance is  tensor(127.7125, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.23295196890830994
distance x is tensor(132.1047, device='cuda:0')
benign distance is  tensor(132.1047, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2672678828239441
distance x is tensor(128.9919, device='cuda:0')
benign distance is  tensor(128.9919, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4778353273868561
distance x is tensor(127.1223, device='cuda:0')
benign distance is  tensor(127.1223, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 677.8458,  664.7351,  656.3095,  666.6740,  687.4469,  637.1481,
         648.0981,  675.2239,  869.4592,  836.2388,  848.4954,  877.6751,
         867.2404,  861.9657,  877.6438,  861.7573,  854.4611,  873.7357,
         861.2968,  871.6764, 1881.3972, 1923.4543, 1895.7152, 1904.5537,
        1888.1052, 1883.4595, 1911.3007, 1890.9713], device='cuda:0')
sorted_norm is   tensor([ 637.1481,  648.0981,  656.3095,  664.7351,  666.6740,  675.2239,
         677.8458,  687.4469,  836.2388,  848.4954,  854.4611,  861.2968,
         861.7573,  861.9657,  867.2404,  869.4592,  871.6764,  873.7357,
         877.6438,  877.6751, 1881.3972, 1883.4595, 1888.1052, 1890.9713,
        1895.7152, 1904.5537, 1911.3007, 1923.4543], device='cuda:0')
used idx is  tensor([ 5,  6,  2,  1,  3,  7,  0,  4,  9, 10, 16, 18, 15, 13, 12,  8, 19, 17,
        14, 11, 20, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8863961100578308
distance x is tensor(92.9348, device='cuda:0')
benign distance is  tensor(92.9348, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2529375553131104
distance x is tensor(63.7903, device='cuda:0')
benign distance is  tensor(63.7903, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8837190866470337
distance x is tensor(77.1818, device='cuda:0')
benign distance is  tensor(77.1818, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1703695058822632
distance x is tensor(81.9509, device='cuda:0')
benign distance is  tensor(81.9509, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.156487226486206
distance x is tensor(86.0160, device='cuda:0')
benign distance is  tensor(86.0160, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2130382061004639
distance x is tensor(71.8138, device='cuda:0')
benign distance is  tensor(71.8138, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6678643822669983
distance x is tensor(83.8914, device='cuda:0')
benign distance is  tensor(83.8914, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0682179927825928
distance x is tensor(78.7784, device='cuda:0')
benign distance is  tensor(78.7784, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.953723132610321
distance x is tensor(84.9517, device='cuda:0')
benign distance is  tensor(84.9517, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9185975193977356
distance x is tensor(73.0273, device='cuda:0')
benign distance is  tensor(73.0273, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7083927392959595
distance x is tensor(85.2768, device='cuda:0')
benign distance is  tensor(85.2768, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.1077262163162231
distance x is tensor(76.1538, device='cuda:0')
benign distance is  tensor(76.1538, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1456992626190186
distance x is tensor(81.2934, device='cuda:0')
benign distance is  tensor(81.2934, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0881160497665405
distance x is tensor(69.1016, device='cuda:0')
benign distance is  tensor(69.1016, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.8733030557632446
distance x is tensor(81.1926, device='cuda:0')
benign distance is  tensor(81.1926, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9701878428459167
distance x is tensor(78.7757, device='cuda:0')
benign distance is  tensor(78.7757, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 584.9515,  446.3413,  515.2015,  527.0701,  541.8416,  482.6021,
         546.4631,  521.0933,  662.7163,  705.0563,  695.9335,  654.5453,
         718.7310,  646.4318,  682.1500,  696.1581,  673.2687,  672.3604,
         616.4862,  672.4186, 1964.7212, 1936.2688, 1963.4521, 1955.7727,
        1946.3907, 1955.4694, 1947.1342, 1953.3528,  756.6992,  769.3165,
         753.0293,  752.9520,  743.9698,  764.0620,  762.2157,  756.3692],
       device='cuda:0')
sorted_norm is   tensor([ 446.3413,  482.6021,  515.2015,  521.0933,  527.0701,  541.8416,
         546.4631,  584.9515,  616.4862,  646.4318,  654.5453,  662.7163,
         672.3604,  672.4186,  673.2687,  682.1500,  695.9335,  696.1581,
         705.0563,  718.7310,  743.9698,  752.9520,  753.0293,  756.3692,
         756.6992,  762.2157,  764.0620,  769.3165, 1936.2688, 1946.3907,
        1947.1342, 1953.3528, 1955.4694, 1955.7727, 1963.4521, 1964.7212],
       device='cuda:0')
used idx is  tensor([ 1,  5,  2,  7,  3,  4,  6,  0, 18, 13, 11,  8, 17, 19, 16, 14, 10, 15,
         9, 12, 32, 31, 30, 35, 28, 34, 33, 29], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 59.99% 

Test Accuracy: 58.94% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6065806746482849
distance x is tensor(136.2035, device='cuda:0')
benign distance is  tensor(136.2035, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3546939194202423
distance x is tensor(138.1619, device='cuda:0')
benign distance is  tensor(138.1619, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3410356640815735
distance x is tensor(129.9671, device='cuda:0')
benign distance is  tensor(129.9671, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3905737102031708
distance x is tensor(129.4881, device='cuda:0')
benign distance is  tensor(129.4881, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3964642882347107
distance x is tensor(134.0568, device='cuda:0')
benign distance is  tensor(134.0568, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6311150193214417
distance x is tensor(132.9275, device='cuda:0')
benign distance is  tensor(132.9275, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39020100235939026
distance x is tensor(129.0694, device='cuda:0')
benign distance is  tensor(129.0694, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3695389926433563
distance x is tensor(138.0938, device='cuda:0')
benign distance is  tensor(138.0938, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4739896357059479
distance x is tensor(127.8008, device='cuda:0')
benign distance is  tensor(127.8008, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.46229225397109985
distance x is tensor(134.3826, device='cuda:0')
benign distance is  tensor(134.3826, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5499610900878906
distance x is tensor(133.8694, device='cuda:0')
benign distance is  tensor(133.8694, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.479464590549469
distance x is tensor(128.4986, device='cuda:0')
benign distance is  tensor(128.4986, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5053703188896179
distance x is tensor(127.9094, device='cuda:0')
benign distance is  tensor(127.9094, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.27532342076301575
distance x is tensor(128.5784, device='cuda:0')
benign distance is  tensor(128.5784, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4156961441040039
distance x is tensor(126.8106, device='cuda:0')
benign distance is  tensor(126.8106, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3183862566947937
distance x is tensor(134.2760, device='cuda:0')
benign distance is  tensor(134.2760, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6121812462806702
distance x is tensor(136.3470, device='cuda:0')
benign distance is  tensor(136.3470, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.590370774269104
distance x is tensor(136.6583, device='cuda:0')
benign distance is  tensor(136.6583, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.42848286032676697
distance x is tensor(131.3553, device='cuda:0')
benign distance is  tensor(131.3553, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4156607985496521
distance x is tensor(132.7504, device='cuda:0')
benign distance is  tensor(132.7504, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5286138653755188
distance x is tensor(134.5345, device='cuda:0')
benign distance is  tensor(134.5345, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.35392993688583374
distance x is tensor(131.6177, device='cuda:0')
benign distance is  tensor(131.6177, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6869932413101196
distance x is tensor(130.4135, device='cuda:0')
benign distance is  tensor(130.4135, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.46476927399635315
distance x is tensor(131.9841, device='cuda:0')
benign distance is  tensor(131.9841, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 663.0135,  667.7661,  641.6691,  644.0112,  681.6776,  654.0214,
         637.5815,  674.1249,  902.1166,  880.7110,  901.0413,  897.1883,
         911.3249,  897.3221,  889.5889,  891.4537,  892.7393,  903.1474,
         893.3442,  902.7098, 2008.1869, 1994.6763, 2012.4301, 1994.7216,
        1998.2531, 1987.8982, 1999.8379, 1996.5667], device='cuda:0')
sorted_norm is   tensor([ 637.5815,  641.6691,  644.0112,  654.0214,  663.0135,  667.7661,
         674.1249,  681.6776,  880.7110,  889.5889,  891.4537,  892.7393,
         893.3442,  897.1883,  897.3221,  901.0413,  902.1166,  902.7098,
         903.1474,  911.3249, 1987.8982, 1994.6763, 1994.7216, 1996.5667,
        1998.2531, 1999.8379, 2008.1869, 2012.4301], device='cuda:0')
used idx is  tensor([ 6,  2,  3,  5,  0,  1,  7,  4,  9, 14, 15, 16, 18, 11, 13, 10,  8, 19,
        17, 12, 25, 21], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3616196811199188
distance x is tensor(129.6626, device='cuda:0')
benign distance is  tensor(129.6626, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6681103706359863
distance x is tensor(120.0072, device='cuda:0')
benign distance is  tensor(120.0072, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7344852685928345
distance x is tensor(122.4900, device='cuda:0')
benign distance is  tensor(122.4900, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5490427613258362
distance x is tensor(123.8206, device='cuda:0')
benign distance is  tensor(123.8206, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9095726013183594
distance x is tensor(135.1821, device='cuda:0')
benign distance is  tensor(135.1821, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5424911975860596
distance x is tensor(125.8540, device='cuda:0')
benign distance is  tensor(125.8540, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3906513452529907
distance x is tensor(121.5024, device='cuda:0')
benign distance is  tensor(121.5024, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5769041776657104
distance x is tensor(124.3913, device='cuda:0')
benign distance is  tensor(124.3913, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6207640767097473
distance x is tensor(126.7916, device='cuda:0')
benign distance is  tensor(126.7916, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.6232816576957703
distance x is tensor(124.8711, device='cuda:0')
benign distance is  tensor(124.8711, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.548693060874939
distance x is tensor(125.5864, device='cuda:0')
benign distance is  tensor(125.5864, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.5591956973075867
distance x is tensor(128.2657, device='cuda:0')
benign distance is  tensor(128.2657, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5146095752716064
distance x is tensor(123.0559, device='cuda:0')
benign distance is  tensor(123.0559, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3896458148956299
distance x is tensor(125.4766, device='cuda:0')
benign distance is  tensor(125.4766, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4992002844810486
distance x is tensor(134.3620, device='cuda:0')
benign distance is  tensor(134.3620, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.36502212285995483
distance x is tensor(126.7517, device='cuda:0')
benign distance is  tensor(126.7517, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 718.1971,  679.7013,  702.8568,  704.8689,  751.0598,  695.1015,
         673.9363,  710.2756,  852.0389,  879.2258,  857.2448,  854.2171,
         876.3173,  847.8977,  867.3242,  879.7538,  884.1201,  879.3400,
         855.7809,  870.3597, 1917.3096, 1918.2808, 1920.3423, 1931.3833,
        1943.3130, 1920.1705, 1941.2638, 1931.8662,  561.6367,  504.6627,
         582.6266,  540.6794,  547.3787,  496.1305,  547.5188,  529.7101,
         808.6903,  823.9979,  818.0501,  809.3159,  813.1751,  806.4245,
         803.9348,  831.8203], device='cuda:0')
sorted_norm is   tensor([ 496.1305,  504.6627,  529.7101,  540.6794,  547.3787,  547.5188,
         561.6367,  582.6266,  673.9363,  679.7013,  695.1015,  702.8568,
         704.8689,  710.2756,  718.1971,  751.0598,  803.9348,  806.4245,
         808.6903,  809.3159,  813.1751,  818.0501,  823.9979,  831.8203,
         847.8977,  852.0389,  854.2171,  855.7809,  857.2448,  867.3242,
         870.3597,  876.3173,  879.2258,  879.3400,  879.7538,  884.1201,
        1917.3096, 1918.2808, 1920.1705, 1920.3423, 1931.3833, 1931.8662,
        1941.2638, 1943.3130], device='cuda:0')
used idx is  tensor([33, 29, 35, 31, 32, 34, 28, 30,  6,  1,  5,  2,  3,  7,  0,  4, 42, 41,
        36, 39, 40, 38, 37, 43, 13,  8, 11, 18, 10, 14, 19, 12,  9, 17, 15],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4815298020839691
distance x is tensor(133.2981, device='cuda:0')
benign distance is  tensor(133.2981, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.484586626291275
distance x is tensor(127.0996, device='cuda:0')
benign distance is  tensor(127.0996, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38861018419265747
distance x is tensor(134.6869, device='cuda:0')
benign distance is  tensor(134.6869, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45758867263793945
distance x is tensor(130.0116, device='cuda:0')
benign distance is  tensor(130.0116, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3290068209171295
distance x is tensor(132.0733, device='cuda:0')
benign distance is  tensor(132.0733, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3701499402523041
distance x is tensor(131.3782, device='cuda:0')
benign distance is  tensor(131.3782, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5089964270591736
distance x is tensor(128.8625, device='cuda:0')
benign distance is  tensor(128.8625, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4130265712738037
distance x is tensor(134.1317, device='cuda:0')
benign distance is  tensor(134.1317, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.462895005941391
distance x is tensor(131.4463, device='cuda:0')
benign distance is  tensor(131.4463, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5010756254196167
distance x is tensor(129.9735, device='cuda:0')
benign distance is  tensor(129.9735, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2798416018486023
distance x is tensor(138.8260, device='cuda:0')
benign distance is  tensor(138.8260, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5142146944999695
distance x is tensor(128.6354, device='cuda:0')
benign distance is  tensor(128.6354, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3617226481437683
distance x is tensor(134.4791, device='cuda:0')
benign distance is  tensor(134.4791, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2247682511806488
distance x is tensor(131.3763, device='cuda:0')
benign distance is  tensor(131.3763, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5234952569007874
distance x is tensor(131.7274, device='cuda:0')
benign distance is  tensor(131.7274, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5081745386123657
distance x is tensor(128.9626, device='cuda:0')
benign distance is  tensor(128.9626, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4961932301521301
distance x is tensor(128.4176, device='cuda:0')
benign distance is  tensor(128.4176, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6454206705093384
distance x is tensor(138.0129, device='cuda:0')
benign distance is  tensor(138.0129, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4667736887931824
distance x is tensor(135.8573, device='cuda:0')
benign distance is  tensor(135.8573, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2787369191646576
distance x is tensor(127.5841, device='cuda:0')
benign distance is  tensor(127.5841, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.29086679220199585
distance x is tensor(126.9600, device='cuda:0')
benign distance is  tensor(126.9600, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.38903146982192993
distance x is tensor(131.1087, device='cuda:0')
benign distance is  tensor(131.1087, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4909292161464691
distance x is tensor(133.8974, device='cuda:0')
benign distance is  tensor(133.8974, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5816435813903809
distance x is tensor(135.8168, device='cuda:0')
benign distance is  tensor(135.8168, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.5893518924713135
distance x is tensor(130.7160, device='cuda:0')
benign distance is  tensor(130.7160, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5179241299629211
distance x is tensor(134.8316, device='cuda:0')
benign distance is  tensor(134.8316, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3716680109500885
distance x is tensor(130.1014, device='cuda:0')
benign distance is  tensor(130.1014, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.24336571991443634
distance x is tensor(134.5327, device='cuda:0')
benign distance is  tensor(134.5327, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2780129611492157
distance x is tensor(130.4936, device='cuda:0')
benign distance is  tensor(130.4936, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.717736005783081
distance x is tensor(133.4964, device='cuda:0')
benign distance is  tensor(133.4964, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.42414718866348267
distance x is tensor(126.2273, device='cuda:0')
benign distance is  tensor(126.2273, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.21216706931591034
distance x is tensor(131.4352, device='cuda:0')
benign distance is  tensor(131.4352, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([665.4940, 633.8784, 662.2968, 649.6356, 662.4883, 650.3203, 638.5917,
        661.5877, 864.3346, 839.8279, 847.3063, 883.2525, 866.2858, 868.3393,
        859.2067, 853.0540, 866.3666, 863.3701, 853.3849, 866.0964],
       device='cuda:0')
sorted_norm is   tensor([633.8784, 638.5917, 649.6356, 650.3203, 661.5877, 662.2968, 662.4883,
        665.4940, 839.8279, 847.3063, 853.0540, 853.3849, 859.2067, 863.3701,
        864.3346, 866.0964, 866.2858, 866.3666, 868.3393, 883.2525],
       device='cuda:0')
used idx is  tensor([ 1,  6,  3,  5,  7,  2,  4,  0,  9, 10, 15, 18, 14, 17,  8, 19],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7858421206474304
distance x is tensor(96.5598, device='cuda:0')
benign distance is  tensor(96.5598, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6616026163101196
distance x is tensor(95.6617, device='cuda:0')
benign distance is  tensor(95.6617, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8193401098251343
distance x is tensor(100.6952, device='cuda:0')
benign distance is  tensor(100.6952, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6553922891616821
distance x is tensor(95.2572, device='cuda:0')
benign distance is  tensor(95.2572, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7742119431495667
distance x is tensor(106.2042, device='cuda:0')
benign distance is  tensor(106.2042, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5662369132041931
distance x is tensor(94.6493, device='cuda:0')
benign distance is  tensor(94.6493, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.071136236190796
distance x is tensor(94.1968, device='cuda:0')
benign distance is  tensor(94.1968, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7350291013717651
distance x is tensor(95.1210, device='cuda:0')
benign distance is  tensor(95.1210, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([606.2299, 627.7993, 641.3059, 614.6902, 667.5667, 601.9501, 608.9590,
        604.7464, 696.5413, 694.4647, 680.8110, 684.4590, 690.9987, 620.7574,
        699.1360, 701.1323, 687.3040, 708.8513, 663.6348, 696.7418, 781.5345,
        788.3242, 761.7796, 766.6026, 773.1082, 756.1739, 770.7338, 764.7407,
        753.9113, 755.9618, 771.8533, 747.1655, 765.6318, 747.2936, 756.9073,
        761.8605], device='cuda:0')
sorted_norm is   tensor([601.9501, 604.7464, 606.2299, 608.9590, 614.6902, 620.7574, 627.7993,
        641.3059, 663.6348, 667.5667, 680.8110, 684.4590, 687.3040, 690.9987,
        694.4647, 696.5413, 696.7418, 699.1360, 701.1323, 708.8513, 747.1655,
        747.2936, 753.9113, 755.9618, 756.1739, 756.9073, 761.7796, 761.8605,
        764.7407, 765.6318, 766.6026, 770.7338, 771.8533, 773.1082, 781.5345,
        788.3242], device='cuda:0')
used idx is  tensor([ 5,  7,  0,  6,  3, 13,  1,  2, 18,  4, 10, 11, 16, 12,  9,  8, 19, 14,
        15, 17, 31, 33, 28, 29, 25, 34, 22, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 43.58% 

Test Accuracy: 43.42% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5547524690628052
distance x is tensor(130.6424, device='cuda:0')
benign distance is  tensor(130.6424, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3466128706932068
distance x is tensor(134.2705, device='cuda:0')
benign distance is  tensor(134.2705, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3537643551826477
distance x is tensor(128.9559, device='cuda:0')
benign distance is  tensor(128.9559, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5562931299209595
distance x is tensor(132.7023, device='cuda:0')
benign distance is  tensor(132.7023, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.590666651725769
distance x is tensor(133.5714, device='cuda:0')
benign distance is  tensor(133.5714, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6771708726882935
distance x is tensor(129.4555, device='cuda:0')
benign distance is  tensor(129.4555, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6065212488174438
distance x is tensor(135.7218, device='cuda:0')
benign distance is  tensor(135.7218, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3813299536705017
distance x is tensor(136.8107, device='cuda:0')
benign distance is  tensor(136.8107, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.395155131816864
distance x is tensor(133.7024, device='cuda:0')
benign distance is  tensor(133.7024, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5207282900810242
distance x is tensor(130.6975, device='cuda:0')
benign distance is  tensor(130.6975, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5455164313316345
distance x is tensor(134.7429, device='cuda:0')
benign distance is  tensor(134.7429, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4111112654209137
distance x is tensor(129.6913, device='cuda:0')
benign distance is  tensor(129.6913, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7554419636726379
distance x is tensor(133.6856, device='cuda:0')
benign distance is  tensor(133.6856, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.25810930132865906
distance x is tensor(130.9150, device='cuda:0')
benign distance is  tensor(130.9150, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7063651084899902
distance x is tensor(130.1616, device='cuda:0')
benign distance is  tensor(130.1616, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4198759198188782
distance x is tensor(130.9012, device='cuda:0')
benign distance is  tensor(130.9012, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.20631830394268036
distance x is tensor(134.8048, device='cuda:0')
benign distance is  tensor(134.8048, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7391766309738159
distance x is tensor(131.6971, device='cuda:0')
benign distance is  tensor(131.6971, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5079262256622314
distance x is tensor(137.8247, device='cuda:0')
benign distance is  tensor(137.8247, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.23312298953533173
distance x is tensor(132.2835, device='cuda:0')
benign distance is  tensor(132.2835, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.26074695587158203
distance x is tensor(132.4443, device='cuda:0')
benign distance is  tensor(132.4443, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4265379309654236
distance x is tensor(135.2307, device='cuda:0')
benign distance is  tensor(135.2307, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.30957695841789246
distance x is tensor(130.2095, device='cuda:0')
benign distance is  tensor(130.2095, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.43686217069625854
distance x is tensor(132.2458, device='cuda:0')
benign distance is  tensor(132.2458, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([638.1441, 650.0565, 631.4568, 634.8093, 654.1875, 634.5355, 650.7007,
        659.9843, 897.0834, 870.3875, 908.7779, 887.5306, 917.4459, 894.2306,
        906.3630, 903.2041, 914.4280, 891.9255, 913.6855, 914.8091, 633.3942,
        668.0433, 649.4839, 628.0461, 636.4488, 650.2219, 650.9271, 661.6599],
       device='cuda:0')
sorted_norm is   tensor([628.0461, 631.4568, 633.3942, 634.5355, 634.8093, 636.4488, 638.1441,
        649.4839, 650.0565, 650.2219, 650.7007, 650.9271, 654.1875, 659.9843,
        661.6599, 668.0433, 870.3875, 887.5306, 891.9255, 894.2306, 897.0834,
        903.2041, 906.3630, 908.7779, 913.6855, 914.4280, 914.8091, 917.4459],
       device='cuda:0')
used idx is  tensor([23,  2, 20,  5,  3, 24,  0, 22,  1, 25,  6, 26,  4,  7, 27, 21,  9, 11,
        17, 13,  8, 15], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 64.63% 

Test Accuracy: 63.70% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.31871724128723145
distance x is tensor(122.7295, device='cuda:0')
benign distance is  tensor(122.7295, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5027144551277161
distance x is tensor(129.6574, device='cuda:0')
benign distance is  tensor(129.6574, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.27300605177879333
distance x is tensor(123.6038, device='cuda:0')
benign distance is  tensor(123.6038, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6092281937599182
distance x is tensor(115.7862, device='cuda:0')
benign distance is  tensor(115.7862, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4252367615699768
distance x is tensor(124.8039, device='cuda:0')
benign distance is  tensor(124.8039, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0262205600738525
distance x is tensor(125.5897, device='cuda:0')
benign distance is  tensor(125.5897, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.246408149600029
distance x is tensor(124.8734, device='cuda:0')
benign distance is  tensor(124.8734, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6487777233123779
distance x is tensor(126.3700, device='cuda:0')
benign distance is  tensor(126.3700, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5901398658752441
distance x is tensor(116.6831, device='cuda:0')
benign distance is  tensor(116.6831, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.42523640394210815
distance x is tensor(124.1875, device='cuda:0')
benign distance is  tensor(124.1875, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.229496031999588
distance x is tensor(123.2270, device='cuda:0')
benign distance is  tensor(123.2270, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4598524570465088
distance x is tensor(120.6831, device='cuda:0')
benign distance is  tensor(120.6831, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6000151634216309
distance x is tensor(116.1072, device='cuda:0')
benign distance is  tensor(116.1072, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.2422819584608078
distance x is tensor(122.4988, device='cuda:0')
benign distance is  tensor(122.4988, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.62001633644104
distance x is tensor(127.5301, device='cuda:0')
benign distance is  tensor(127.5301, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.43951520323753357
distance x is tensor(121.8887, device='cuda:0')
benign distance is  tensor(121.8887, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 583.1888,  608.1344,  592.4830,  562.9871,  598.5457,  593.7294,
         602.2339,  598.1769, 1014.7098,  995.5506, 1016.5478, 1016.9440,
        1037.9810, 1014.1264,  996.4474, 1010.5011, 1027.7227, 1021.2237,
        1024.2714, 1021.2040,  835.1332,  844.6664,  842.7927,  844.3662,
         829.3198,  841.5067,  873.9132,  833.3771,  615.8489,  597.1649,
         595.1797,  595.0900,  606.6236,  592.1940,  596.5256,  614.0136],
       device='cuda:0')
sorted_norm is   tensor([ 562.9871,  583.1888,  592.1940,  592.4830,  593.7294,  595.0900,
         595.1797,  596.5256,  597.1649,  598.1769,  598.5457,  602.2339,
         606.6236,  608.1344,  614.0136,  615.8489,  829.3198,  833.3771,
         835.1332,  841.5067,  842.7927,  844.3662,  844.6664,  873.9132,
         995.5506,  996.4474, 1010.5011, 1014.1264, 1014.7098, 1016.5478,
        1016.9440, 1021.2040, 1021.2237, 1024.2714, 1027.7227, 1037.9810],
       device='cuda:0')
used idx is  tensor([ 3,  0, 33,  2,  5, 31, 30, 34, 29,  7,  4,  6, 32,  1, 35, 28, 24, 27,
        20, 25, 22, 23, 21, 26,  9, 14, 15, 13], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 17.78% 

Test Accuracy: 17.16% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6453903913497925
distance x is tensor(130.6236, device='cuda:0')
benign distance is  tensor(130.6236, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3828742504119873
distance x is tensor(130.4006, device='cuda:0')
benign distance is  tensor(130.4006, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4216274619102478
distance x is tensor(130.8732, device='cuda:0')
benign distance is  tensor(130.8732, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5284687876701355
distance x is tensor(130.1853, device='cuda:0')
benign distance is  tensor(130.1853, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4822232127189636
distance x is tensor(126.4916, device='cuda:0')
benign distance is  tensor(126.4916, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4812287390232086
distance x is tensor(129.0278, device='cuda:0')
benign distance is  tensor(129.0278, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39819470047950745
distance x is tensor(129.6276, device='cuda:0')
benign distance is  tensor(129.6276, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37236881256103516
distance x is tensor(132.5601, device='cuda:0')
benign distance is  tensor(132.5601, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5163358449935913
distance x is tensor(126.9348, device='cuda:0')
benign distance is  tensor(126.9348, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.30957847833633423
distance x is tensor(121.1440, device='cuda:0')
benign distance is  tensor(121.1440, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5366783142089844
distance x is tensor(126.3271, device='cuda:0')
benign distance is  tensor(126.3271, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.343051016330719
distance x is tensor(128.4092, device='cuda:0')
benign distance is  tensor(128.4092, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4697694778442383
distance x is tensor(124.9464, device='cuda:0')
benign distance is  tensor(124.9464, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.26006880402565
distance x is tensor(126.3462, device='cuda:0')
benign distance is  tensor(126.3462, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4544652998447418
distance x is tensor(128.4334, device='cuda:0')
benign distance is  tensor(128.4334, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5206031203269958
distance x is tensor(128.7239, device='cuda:0')
benign distance is  tensor(128.7239, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3670526444911957
distance x is tensor(127.6401, device='cuda:0')
benign distance is  tensor(127.6401, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3565719425678253
distance x is tensor(130.2331, device='cuda:0')
benign distance is  tensor(130.2331, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7093674540519714
distance x is tensor(131.7484, device='cuda:0')
benign distance is  tensor(131.7484, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.6526964902877808
distance x is tensor(124.3957, device='cuda:0')
benign distance is  tensor(124.3957, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5264519453048706
distance x is tensor(128.2322, device='cuda:0')
benign distance is  tensor(128.2322, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6228736639022827
distance x is tensor(125.7733, device='cuda:0')
benign distance is  tensor(125.7733, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.37544509768486023
distance x is tensor(124.9908, device='cuda:0')
benign distance is  tensor(124.9908, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.5397399067878723
distance x is tensor(129.4100, device='cuda:0')
benign distance is  tensor(129.4100, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 601.0070,  603.6796,  615.5239,  601.5532,  597.4442,  616.7528,
         606.4246,  618.0958, 1019.4079,  983.9599, 1029.0968, 1015.3105,
        1062.1097, 1033.7909, 1022.1416, 1018.4969, 1036.9476, 1023.4691,
        1031.8436, 1027.1763], device='cuda:0')
sorted_norm is   tensor([ 597.4442,  601.0070,  601.5532,  603.6796,  606.4246,  615.5239,
         616.7528,  618.0958,  983.9599, 1015.3105, 1018.4969, 1019.4079,
        1022.1416, 1023.4691, 1027.1763, 1029.0968, 1031.8436, 1033.7909,
        1036.9476, 1062.1097], device='cuda:0')
used idx is  tensor([ 4,  0,  3,  1,  6,  2,  5,  7,  9, 11, 15,  8, 14, 17, 19, 10],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.871512770652771
distance x is tensor(81.5478, device='cuda:0')
benign distance is  tensor(81.5478, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5687657594680786
distance x is tensor(79.8188, device='cuda:0')
benign distance is  tensor(79.8188, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9868952035903931
distance x is tensor(85.5088, device='cuda:0')
benign distance is  tensor(85.5088, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9497182965278625
distance x is tensor(81.0979, device='cuda:0')
benign distance is  tensor(81.0979, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5599102973937988
distance x is tensor(75.9765, device='cuda:0')
benign distance is  tensor(75.9765, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.834987998008728
distance x is tensor(76.1403, device='cuda:0')
benign distance is  tensor(76.1403, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8636199235916138
distance x is tensor(74.9193, device='cuda:0')
benign distance is  tensor(74.9193, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7006595730781555
distance x is tensor(79.3191, device='cuda:0')
benign distance is  tensor(79.3191, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([569.6927, 571.4279, 581.6172, 578.7309, 538.8190, 551.8137, 539.4003,
        557.1320, 644.9414, 613.2288, 633.8566, 622.7390, 641.2953, 622.8954,
        617.5547, 622.9139, 625.1865, 632.0715, 625.3311, 640.5519, 748.3558,
        760.6447, 749.4503, 759.6276, 748.3361, 757.4564, 731.6208, 743.1686,
        772.4351, 753.9639, 791.4151, 769.4190, 771.9105, 770.5338, 763.9028,
        768.5367, 770.1680, 796.0987, 788.1988, 792.5104, 770.2596, 789.1945,
        800.5534, 786.8879, 794.2725, 783.1640, 786.0788, 791.6449, 798.4265,
        795.0534, 797.6517, 802.1805], device='cuda:0')
sorted_norm is   tensor([538.8190, 539.4003, 551.8137, 557.1320, 569.6927, 571.4279, 578.7309,
        581.6172, 613.2288, 617.5547, 622.7390, 622.8954, 622.9139, 625.1865,
        625.3311, 632.0715, 633.8566, 640.5519, 641.2953, 644.9414, 731.6208,
        743.1686, 748.3361, 748.3558, 749.4503, 753.9639, 757.4564, 759.6276,
        760.6447, 763.9028, 768.5367, 769.4190, 770.1680, 770.2596, 770.5338,
        771.9105, 772.4351, 783.1640, 786.0788, 786.8879, 788.1988, 789.1945,
        791.4151, 791.6449, 792.5104, 794.2725, 795.0534, 796.0987, 797.6517,
        798.4265, 800.5534, 802.1805], device='cuda:0')
used idx is  tensor([ 4,  6,  5,  7,  0,  1,  3,  2,  9, 14, 11, 13, 15, 16, 18, 17, 10, 19,
        12,  8, 26, 27, 24, 20, 22, 29, 25, 23, 21, 34, 35, 31, 36, 40, 33, 32,
        28, 45, 46, 43, 38], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 73.12% 

Test Accuracy: 72.30% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5228862166404724
distance x is tensor(124.5193, device='cuda:0')
benign distance is  tensor(124.5193, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.44471532106399536
distance x is tensor(120.8239, device='cuda:0')
benign distance is  tensor(120.8239, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3511613607406616
distance x is tensor(122.7713, device='cuda:0')
benign distance is  tensor(122.7713, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3173733949661255
distance x is tensor(125.5580, device='cuda:0')
benign distance is  tensor(125.5580, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7039074301719666
distance x is tensor(121.1856, device='cuda:0')
benign distance is  tensor(121.1856, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7683975696563721
distance x is tensor(124.9353, device='cuda:0')
benign distance is  tensor(124.9353, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2497776448726654
distance x is tensor(124.9766, device='cuda:0')
benign distance is  tensor(124.9766, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4589214324951172
distance x is tensor(126.0983, device='cuda:0')
benign distance is  tensor(126.0983, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.24917538464069366
distance x is tensor(127.9722, device='cuda:0')
benign distance is  tensor(127.9722, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.39464807510375977
distance x is tensor(119.8767, device='cuda:0')
benign distance is  tensor(119.8767, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5435090661048889
distance x is tensor(121.7172, device='cuda:0')
benign distance is  tensor(121.7172, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.1978340446949005
distance x is tensor(121.1509, device='cuda:0')
benign distance is  tensor(121.1509, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6772633790969849
distance x is tensor(122.0519, device='cuda:0')
benign distance is  tensor(122.0519, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2766411006450653
distance x is tensor(122.3455, device='cuda:0')
benign distance is  tensor(122.3455, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.41071003675460815
distance x is tensor(123.6024, device='cuda:0')
benign distance is  tensor(123.6024, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4468459486961365
distance x is tensor(122.3142, device='cuda:0')
benign distance is  tensor(122.3142, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.34226787090301514
distance x is tensor(114.5674, device='cuda:0')
benign distance is  tensor(114.5674, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5181971788406372
distance x is tensor(123.2049, device='cuda:0')
benign distance is  tensor(123.2049, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3697323203086853
distance x is tensor(127.2101, device='cuda:0')
benign distance is  tensor(127.2101, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.29050737619400024
distance x is tensor(121.9244, device='cuda:0')
benign distance is  tensor(121.9244, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5121577978134155
distance x is tensor(116.9954, device='cuda:0')
benign distance is  tensor(116.9954, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3566887378692627
distance x is tensor(115.8134, device='cuda:0')
benign distance is  tensor(115.8134, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.32014134526252747
distance x is tensor(128.8997, device='cuda:0')
benign distance is  tensor(128.8997, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.46035146713256836
distance x is tensor(114.6239, device='cuda:0')
benign distance is  tensor(114.6239, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4947049021720886
distance x is tensor(124.7474, device='cuda:0')
benign distance is  tensor(124.7474, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6404175162315369
distance x is tensor(123.7738, device='cuda:0')
benign distance is  tensor(123.7738, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3412255644798279
distance x is tensor(121.4811, device='cuda:0')
benign distance is  tensor(121.4811, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.34153059124946594
distance x is tensor(121.8165, device='cuda:0')
benign distance is  tensor(121.8165, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6420843005180359
distance x is tensor(122.2808, device='cuda:0')
benign distance is  tensor(122.2808, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.23319390416145325
distance x is tensor(129.2349, device='cuda:0')
benign distance is  tensor(129.2349, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2619583308696747
distance x is tensor(122.5240, device='cuda:0')
benign distance is  tensor(122.5240, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5312969088554382
distance x is tensor(121.6382, device='cuda:0')
benign distance is  tensor(121.6382, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.28225070238113403
distance x is tensor(115.7086, device='cuda:0')
benign distance is  tensor(115.7086, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.6132267713546753
distance x is tensor(122.9519, device='cuda:0')
benign distance is  tensor(122.9519, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.2000030279159546
distance x is tensor(121.7850, device='cuda:0')
benign distance is  tensor(121.7850, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2716576159000397
distance x is tensor(123.6588, device='cuda:0')
benign distance is  tensor(123.6588, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.48420190811157227
distance x is tensor(117.6050, device='cuda:0')
benign distance is  tensor(117.6050, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.34762075543403625
distance x is tensor(127.7739, device='cuda:0')
benign distance is  tensor(127.7739, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.66569584608078
distance x is tensor(127.3324, device='cuda:0')
benign distance is  tensor(127.3324, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.15782472491264343
distance x is tensor(125.4202, device='cuda:0')
benign distance is  tensor(125.4202, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 578.7393,  571.5961,  577.8008,  583.8117,  578.5349,  584.5974,
         584.8250,  581.1776, 1041.2189, 1010.1932, 1025.8257, 1030.3580,
        1090.0503, 1045.1362, 1034.0468, 1030.9022, 1041.6447, 1042.4679,
        1040.1959, 1046.7697], device='cuda:0')
sorted_norm is   tensor([ 571.5961,  577.8008,  578.5349,  578.7393,  581.1776,  583.8117,
         584.5974,  584.8250, 1010.1932, 1025.8257, 1030.3580, 1030.9022,
        1034.0468, 1040.1959, 1041.2189, 1041.6447, 1042.4679, 1045.1362,
        1046.7697, 1090.0503], device='cuda:0')
used idx is  tensor([ 1,  2,  4,  0,  7,  3,  5,  6,  9, 10, 11, 15, 14, 18,  8, 16],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6286345720291138
distance x is tensor(93.9563, device='cuda:0')
benign distance is  tensor(93.9563, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7230187654495239
distance x is tensor(86.3491, device='cuda:0')
benign distance is  tensor(86.3491, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3954477906227112
distance x is tensor(92.3374, device='cuda:0')
benign distance is  tensor(92.3374, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5943213701248169
distance x is tensor(95.6734, device='cuda:0')
benign distance is  tensor(95.6734, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6165902018547058
distance x is tensor(98.2520, device='cuda:0')
benign distance is  tensor(98.2520, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6950244307518005
distance x is tensor(93.2179, device='cuda:0')
benign distance is  tensor(93.2179, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0268844366073608
distance x is tensor(82.4354, device='cuda:0')
benign distance is  tensor(82.4354, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.049456000328064
distance x is tensor(85.9413, device='cuda:0')
benign distance is  tensor(85.9413, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([607.3214, 572.0728, 604.7668, 617.9825, 623.7385, 601.0057, 561.8517,
        581.7224, 655.0293, 663.7081, 641.1426, 696.4271, 678.9868, 630.6127,
        648.6869, 665.0939, 683.7426, 689.8958, 652.0287, 641.6828, 814.8497,
        787.6877, 787.2211, 782.9490, 790.1878, 800.1539, 803.7349, 806.1121],
       device='cuda:0')
sorted_norm is   tensor([561.8517, 572.0728, 581.7224, 601.0057, 604.7668, 607.3214, 617.9825,
        623.7385, 630.6127, 641.1426, 641.6828, 648.6869, 652.0287, 655.0293,
        663.7081, 665.0939, 678.9868, 683.7426, 689.8958, 696.4271, 782.9490,
        787.2211, 787.6877, 790.1878, 800.1539, 803.7349, 806.1121, 814.8497],
       device='cuda:0')
used idx is  tensor([ 6,  1,  7,  5,  2,  0,  3,  4, 13, 10, 19, 14, 18,  8,  9, 15, 12, 16,
        17, 11, 23, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 9.73% 

Test Accuracy: 10.00% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7237614393234253
distance x is tensor(136.1041, device='cuda:0')
benign distance is  tensor(136.1041, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3654629588127136
distance x is tensor(124.1932, device='cuda:0')
benign distance is  tensor(124.1932, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4148709774017334
distance x is tensor(128.0419, device='cuda:0')
benign distance is  tensor(128.0419, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6335710287094116
distance x is tensor(130.1480, device='cuda:0')
benign distance is  tensor(130.1480, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3239511251449585
distance x is tensor(135.7599, device='cuda:0')
benign distance is  tensor(135.7599, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.47035685181617737
distance x is tensor(128.7386, device='cuda:0')
benign distance is  tensor(128.7386, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5279739499092102
distance x is tensor(133.0970, device='cuda:0')
benign distance is  tensor(133.0970, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.30660954117774963
distance x is tensor(130.1053, device='cuda:0')
benign distance is  tensor(130.1053, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4691842198371887
distance x is tensor(132.3154, device='cuda:0')
benign distance is  tensor(132.3154, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.40698885917663574
distance x is tensor(133.3845, device='cuda:0')
benign distance is  tensor(133.3845, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.43622249364852905
distance x is tensor(144.2522, device='cuda:0')
benign distance is  tensor(144.2522, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4455767571926117
distance x is tensor(141.1225, device='cuda:0')
benign distance is  tensor(141.1225, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5574830770492554
distance x is tensor(131.7138, device='cuda:0')
benign distance is  tensor(131.7138, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4790303707122803
distance x is tensor(122.9223, device='cuda:0')
benign distance is  tensor(122.9223, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6502731442451477
distance x is tensor(125.4393, device='cuda:0')
benign distance is  tensor(125.4393, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3420235812664032
distance x is tensor(130.7426, device='cuda:0')
benign distance is  tensor(130.7426, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([715.8604, 678.1144, 681.9290, 698.3644, 722.0168, 680.1902, 700.1069,
        705.5786, 814.1852, 800.0211, 808.7375, 796.5378, 814.8671, 801.2552,
        792.6074, 800.0658, 812.6608, 800.7024, 796.2454, 829.4100, 769.3794,
        782.8698, 781.2705, 763.5630, 771.9383, 761.2559, 754.0044, 770.6544,
        735.0457, 764.6378, 772.6924, 764.7591, 744.7244, 739.5536, 783.1139,
        741.8462], device='cuda:0')
sorted_norm is   tensor([678.1144, 680.1902, 681.9290, 698.3644, 700.1069, 705.5786, 715.8604,
        722.0168, 735.0457, 739.5536, 741.8462, 744.7244, 754.0044, 761.2559,
        763.5630, 764.6378, 764.7591, 769.3794, 770.6544, 771.9383, 772.6924,
        781.2705, 782.8698, 783.1139, 792.6074, 796.2454, 796.5378, 800.0211,
        800.0658, 800.7024, 801.2552, 808.7375, 812.6608, 814.1852, 814.8671,
        829.4100], device='cuda:0')
used idx is  tensor([ 1,  5,  2,  3,  6,  7,  0,  4, 28, 33, 35, 32, 26, 25, 23, 29, 31, 20,
        27, 24, 30, 22, 21, 34, 14, 18, 11,  9], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 76.93% 

Test Accuracy: 76.04% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.48820558190345764
distance x is tensor(118.7114, device='cuda:0')
benign distance is  tensor(118.7114, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.18815448880195618
distance x is tensor(115.8246, device='cuda:0')
benign distance is  tensor(115.8246, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.45457419753074646
distance x is tensor(118.1361, device='cuda:0')
benign distance is  tensor(118.1361, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4773368835449219
distance x is tensor(121.8120, device='cuda:0')
benign distance is  tensor(121.8120, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.495013564825058
distance x is tensor(118.0311, device='cuda:0')
benign distance is  tensor(118.0311, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.42120543122291565
distance x is tensor(111.2510, device='cuda:0')
benign distance is  tensor(111.2510, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.41854244470596313
distance x is tensor(116.6386, device='cuda:0')
benign distance is  tensor(116.6386, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35241326689720154
distance x is tensor(121.5692, device='cuda:0')
benign distance is  tensor(121.5692, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.7529141902923584
distance x is tensor(109.4156, device='cuda:0')
benign distance is  tensor(109.4156, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.413607656955719
distance x is tensor(115.7018, device='cuda:0')
benign distance is  tensor(115.7018, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6680995225906372
distance x is tensor(120.2424, device='cuda:0')
benign distance is  tensor(120.2424, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.39751169085502625
distance x is tensor(114.7243, device='cuda:0')
benign distance is  tensor(114.7243, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.29894155263900757
distance x is tensor(111.1359, device='cuda:0')
benign distance is  tensor(111.1359, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3183198571205139
distance x is tensor(108.2708, device='cuda:0')
benign distance is  tensor(108.2708, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.30703121423721313
distance x is tensor(121.3560, device='cuda:0')
benign distance is  tensor(121.3560, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4469582438468933
distance x is tensor(113.0659, device='cuda:0')
benign distance is  tensor(113.0659, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.23802757263183594
distance x is tensor(114.8307, device='cuda:0')
benign distance is  tensor(114.8307, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.4492500424385071
distance x is tensor(112.6717, device='cuda:0')
benign distance is  tensor(112.6717, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5640259385108948
distance x is tensor(115.4949, device='cuda:0')
benign distance is  tensor(115.4949, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.21057243645191193
distance x is tensor(110.3263, device='cuda:0')
benign distance is  tensor(110.3263, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4878133237361908
distance x is tensor(112.8523, device='cuda:0')
benign distance is  tensor(112.8523, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.35336393117904663
distance x is tensor(121.2183, device='cuda:0')
benign distance is  tensor(121.2183, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.38448578119277954
distance x is tensor(120.4281, device='cuda:0')
benign distance is  tensor(120.4281, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2619861364364624
distance x is tensor(113.8128, device='cuda:0')
benign distance is  tensor(113.8128, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 550.9506,  539.9170,  546.9721,  555.9893,  559.3265,  532.8736,
         538.0735,  566.3444, 1150.8021, 1139.9009, 1157.5302, 1159.1451,
        1192.3043, 1180.4364, 1157.8403, 1153.8286, 1161.0020, 1161.3412,
        1168.0840, 1158.6266,  568.9103,  549.1550,  546.1864,  541.7386,
         543.3748,  570.5706,  548.4338,  525.4111,  692.3429,  719.1157,
         763.8760,  719.9335,  715.7803,  684.8935,  696.6566,  707.2859],
       device='cuda:0')
sorted_norm is   tensor([ 525.4111,  532.8736,  538.0735,  539.9170,  541.7386,  543.3748,
         546.1864,  546.9721,  548.4338,  549.1550,  550.9506,  555.9893,
         559.3265,  566.3444,  568.9103,  570.5706,  684.8935,  692.3429,
         696.6566,  707.2859,  715.7803,  719.1157,  719.9335,  763.8760,
        1139.9009, 1150.8021, 1153.8286, 1157.5302, 1157.8403, 1158.6266,
        1159.1451, 1161.0020, 1161.3412, 1168.0840, 1180.4364, 1192.3043],
       device='cuda:0')
used idx is  tensor([27,  5,  6,  1, 23, 24, 22,  2, 26, 21,  0,  3,  4,  7, 20, 25, 33, 28,
        34, 35, 32, 29, 31, 30,  9,  8, 15, 10], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 75.93% 

Test Accuracy: 74.89% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.37674468755722046
distance x is tensor(124.6089, device='cuda:0')
benign distance is  tensor(124.6089, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3945824205875397
distance x is tensor(124.8458, device='cuda:0')
benign distance is  tensor(124.8458, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2092982530593872
distance x is tensor(117.2013, device='cuda:0')
benign distance is  tensor(117.2013, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5421594381332397
distance x is tensor(118.4025, device='cuda:0')
benign distance is  tensor(118.4025, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3311994671821594
distance x is tensor(121.6716, device='cuda:0')
benign distance is  tensor(121.6716, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5085247159004211
distance x is tensor(126.3623, device='cuda:0')
benign distance is  tensor(126.3623, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2633550465106964
distance x is tensor(125.2136, device='cuda:0')
benign distance is  tensor(125.2136, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2985451817512512
distance x is tensor(124.0873, device='cuda:0')
benign distance is  tensor(124.0873, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3393097519874573
distance x is tensor(125.2221, device='cuda:0')
benign distance is  tensor(125.2221, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3690599501132965
distance x is tensor(116.0125, device='cuda:0')
benign distance is  tensor(116.0125, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8416553735733032
distance x is tensor(118.4195, device='cuda:0')
benign distance is  tensor(118.4195, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7043749094009399
distance x is tensor(120.0969, device='cuda:0')
benign distance is  tensor(120.0969, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3123570680618286
distance x is tensor(116.8019, device='cuda:0')
benign distance is  tensor(116.8019, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5435393452644348
distance x is tensor(119.0040, device='cuda:0')
benign distance is  tensor(119.0040, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4995952248573303
distance x is tensor(116.4896, device='cuda:0')
benign distance is  tensor(116.4896, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5532716512680054
distance x is tensor(127.2696, device='cuda:0')
benign distance is  tensor(127.2696, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3925077021121979
distance x is tensor(124.0709, device='cuda:0')
benign distance is  tensor(124.0709, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.40045228600502014
distance x is tensor(122.3039, device='cuda:0')
benign distance is  tensor(122.3039, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2990618348121643
distance x is tensor(123.6413, device='cuda:0')
benign distance is  tensor(123.6413, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5815039873123169
distance x is tensor(118.0675, device='cuda:0')
benign distance is  tensor(118.0675, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.46116647124290466
distance x is tensor(122.3359, device='cuda:0')
benign distance is  tensor(122.3359, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.25982463359832764
distance x is tensor(118.8487, device='cuda:0')
benign distance is  tensor(118.8487, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.11572439968585968
distance x is tensor(117.7425, device='cuda:0')
benign distance is  tensor(117.7425, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2921488583087921
distance x is tensor(124.0108, device='cuda:0')
benign distance is  tensor(124.0108, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 572.0891,  581.4660,  550.2091,  552.6606,  567.5568,  586.6431,
         574.7087,  571.4353, 1118.5581, 1119.6315, 1147.6779, 1141.9457,
        1175.7194, 1154.4530, 1138.3519, 1143.7026, 1166.0408, 1141.5905,
        1150.7628, 1160.1470], device='cuda:0')
sorted_norm is   tensor([ 550.2091,  552.6606,  567.5568,  571.4353,  572.0891,  574.7087,
         581.4660,  586.6431, 1118.5581, 1119.6315, 1138.3519, 1141.5905,
        1141.9457, 1143.7026, 1147.6779, 1150.7628, 1154.4530, 1160.1470,
        1166.0408, 1175.7194], device='cuda:0')
used idx is  tensor([ 2,  3,  4,  7,  0,  6,  1,  5,  8,  9, 14, 17, 11, 15, 10, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.8317455053329468
distance x is tensor(20.1393, device='cuda:0')
benign distance is  tensor(20.1393, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6949058771133423
distance x is tensor(23.1989, device='cuda:0')
benign distance is  tensor(23.1989, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.7613881826400757
distance x is tensor(30.7205, device='cuda:0')
benign distance is  tensor(30.7205, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4731816053390503
distance x is tensor(26.5941, device='cuda:0')
benign distance is  tensor(26.5941, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5421597957611084
distance x is tensor(26.6726, device='cuda:0')
benign distance is  tensor(26.6726, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.9245097637176514
distance x is tensor(25.9586, device='cuda:0')
benign distance is  tensor(25.9586, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8590446710586548
distance x is tensor(17.0652, device='cuda:0')
benign distance is  tensor(17.0652, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0311217308044434
distance x is tensor(25.9162, device='cuda:0')
benign distance is  tensor(25.9162, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([136.4099, 149.5025, 245.0703, 186.2147, 206.2806, 206.8340, 112.2085,
        203.3850, 289.9902, 260.9423, 256.0502, 424.6596, 295.6846, 246.7372,
        269.1808, 367.6471, 249.7673, 355.7161, 299.0742, 345.3390, 775.9861,
        803.4133, 801.3633, 808.8288, 783.5344, 813.9717, 811.5464, 796.6000,
        803.8268, 824.6028, 828.7349, 821.6789, 804.5950, 796.4374, 834.9498,
        827.5324, 841.3834, 806.4609, 818.0914, 822.1591, 817.9018, 822.9748,
        818.1072, 843.9678], device='cuda:0')
sorted_norm is   tensor([112.2085, 136.4099, 149.5025, 186.2147, 203.3850, 206.2806, 206.8340,
        245.0703, 246.7372, 249.7673, 256.0502, 260.9423, 269.1808, 289.9902,
        295.6846, 299.0742, 345.3390, 355.7161, 367.6471, 424.6596, 775.9861,
        783.5344, 796.4374, 796.6000, 801.3633, 803.4133, 803.8268, 804.5950,
        806.4609, 808.8288, 811.5464, 813.9717, 817.9018, 818.0914, 818.1072,
        821.6789, 822.1591, 822.9748, 824.6028, 827.5324, 828.7349, 834.9498,
        841.3834, 843.9678], device='cuda:0')
used idx is  tensor([ 6,  0,  1,  3,  7,  4,  5,  2, 13, 16, 10,  9, 14,  8, 12, 18, 19, 17,
        15, 11, 20, 24, 33, 27, 22, 21, 28, 32, 37, 23, 26, 25, 40, 38, 42],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 67.30% 

Test Accuracy: 66.48% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6684749126434326
distance x is tensor(132.0396, device='cuda:0')
benign distance is  tensor(132.0396, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3404156565666199
distance x is tensor(129.7811, device='cuda:0')
benign distance is  tensor(129.7811, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24520961940288544
distance x is tensor(130.4701, device='cuda:0')
benign distance is  tensor(130.4701, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40636730194091797
distance x is tensor(135.1955, device='cuda:0')
benign distance is  tensor(135.1955, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.639018714427948
distance x is tensor(129.2939, device='cuda:0')
benign distance is  tensor(129.2939, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5205143094062805
distance x is tensor(126.4347, device='cuda:0')
benign distance is  tensor(126.4347, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25841420888900757
distance x is tensor(130.1477, device='cuda:0')
benign distance is  tensor(130.1477, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4734203815460205
distance x is tensor(129.2789, device='cuda:0')
benign distance is  tensor(129.2789, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3581610321998596
distance x is tensor(130.5927, device='cuda:0')
benign distance is  tensor(130.5927, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2946849465370178
distance x is tensor(123.4413, device='cuda:0')
benign distance is  tensor(123.4413, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9087337255477905
distance x is tensor(131.8697, device='cuda:0')
benign distance is  tensor(131.8697, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4199022352695465
distance x is tensor(126.9546, device='cuda:0')
benign distance is  tensor(126.9546, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3382365107536316
distance x is tensor(127.9323, device='cuda:0')
benign distance is  tensor(127.9323, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.19202163815498352
distance x is tensor(131.3672, device='cuda:0')
benign distance is  tensor(131.3672, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5896574854850769
distance x is tensor(129.6358, device='cuda:0')
benign distance is  tensor(129.6358, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8276931643486023
distance x is tensor(130.1596, device='cuda:0')
benign distance is  tensor(130.1596, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.714425802230835
distance x is tensor(121.5674, device='cuda:0')
benign distance is  tensor(121.5674, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.47070398926734924
distance x is tensor(126.0093, device='cuda:0')
benign distance is  tensor(126.0093, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4169582426548004
distance x is tensor(131.3998, device='cuda:0')
benign distance is  tensor(131.3998, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.650323748588562
distance x is tensor(125.3645, device='cuda:0')
benign distance is  tensor(125.3645, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.29765188694000244
distance x is tensor(128.7347, device='cuda:0')
benign distance is  tensor(128.7347, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4980568289756775
distance x is tensor(132.8152, device='cuda:0')
benign distance is  tensor(132.8152, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.41114386916160583
distance x is tensor(127.9208, device='cuda:0')
benign distance is  tensor(127.9208, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3417035639286041
distance x is tensor(123.6828, device='cuda:0')
benign distance is  tensor(123.6828, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3469390571117401
distance x is tensor(123.7508, device='cuda:0')
benign distance is  tensor(123.7508, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.7655864953994751
distance x is tensor(139.3374, device='cuda:0')
benign distance is  tensor(139.3374, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.43130308389663696
distance x is tensor(131.2506, device='cuda:0')
benign distance is  tensor(131.2506, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.282503217458725
distance x is tensor(131.1059, device='cuda:0')
benign distance is  tensor(131.1059, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.23858603835105896
distance x is tensor(129.2049, device='cuda:0')
benign distance is  tensor(129.2049, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.676001250743866
distance x is tensor(133.5580, device='cuda:0')
benign distance is  tensor(133.5580, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5546978712081909
distance x is tensor(137.2509, device='cuda:0')
benign distance is  tensor(137.2509, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2685074806213379
distance x is tensor(129.5301, device='cuda:0')
benign distance is  tensor(129.5301, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 608.3868,  586.1217,  624.9270,  605.1553,  594.8002,  591.0206,
         604.8589,  599.0555, 1020.4742, 1010.6455, 1037.9641, 1020.6357,
        1038.6456, 1033.9371, 1032.8037, 1012.3987, 1029.2147, 1031.3512,
        1035.0715, 1035.1748], device='cuda:0')
sorted_norm is   tensor([ 586.1217,  591.0206,  594.8002,  599.0555,  604.8589,  605.1553,
         608.3868,  624.9270, 1010.6455, 1012.3987, 1020.4742, 1020.6357,
        1029.2147, 1031.3512, 1032.8037, 1033.9371, 1035.0715, 1035.1748,
        1037.9641, 1038.6456], device='cuda:0')
used idx is  tensor([ 1,  5,  4,  7,  6,  3,  0,  2,  9, 15,  8, 11, 16, 17, 14, 13],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.099772334098816
distance x is tensor(68.7192, device='cuda:0')
benign distance is  tensor(68.7192, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8728498220443726
distance x is tensor(70.9119, device='cuda:0')
benign distance is  tensor(70.9119, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4186660051345825
distance x is tensor(73.0123, device='cuda:0')
benign distance is  tensor(73.0123, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4782661199569702
distance x is tensor(63.1294, device='cuda:0')
benign distance is  tensor(63.1294, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0779402256011963
distance x is tensor(71.3076, device='cuda:0')
benign distance is  tensor(71.3076, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.180260419845581
distance x is tensor(65.8423, device='cuda:0')
benign distance is  tensor(65.8423, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2798206806182861
distance x is tensor(73.9695, device='cuda:0')
benign distance is  tensor(73.9695, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8726669549942017
distance x is tensor(78.3146, device='cuda:0')
benign distance is  tensor(78.3146, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([492.5594, 507.5359, 510.6931, 473.9180, 506.1251, 475.5743, 515.3195,
        524.9155, 538.3319, 585.3427, 569.4393, 573.1673, 572.4230, 551.7898,
        568.2606, 552.5170, 609.0674, 568.5480, 550.9457, 568.9944, 821.9312,
        811.3687, 815.7852, 807.7625, 808.7393, 836.8066, 833.2889, 816.4768,
        848.0328, 831.0812, 845.7297, 814.5090, 836.7349, 817.9828, 826.0518,
        840.9030, 807.2894, 782.4092, 811.1573, 792.1778, 802.1589, 803.3069,
        809.8537, 804.8718], device='cuda:0')
sorted_norm is   tensor([473.9180, 475.5743, 492.5594, 506.1251, 507.5359, 510.6931, 515.3195,
        524.9155, 538.3319, 550.9457, 551.7898, 552.5170, 568.2606, 568.5480,
        568.9944, 569.4393, 572.4230, 573.1673, 585.3427, 609.0674, 782.4092,
        792.1778, 802.1589, 803.3069, 804.8718, 807.2894, 807.7625, 808.7393,
        809.8537, 811.1573, 811.3687, 814.5090, 815.7852, 816.4768, 817.9828,
        821.9312, 826.0518, 831.0812, 833.2889, 836.7349, 836.8066, 840.9030,
        845.7297, 848.0328], device='cuda:0')
used idx is  tensor([ 3,  5,  0,  4,  1,  2,  6,  7,  8, 18, 13, 15, 14, 17, 19, 10, 12, 11,
         9, 16, 37, 39, 40, 41, 43, 36, 23, 24, 42, 38, 21, 31, 22, 27, 33],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 70.07% 

Test Accuracy: 68.91% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3159021735191345
distance x is tensor(134.9529, device='cuda:0')
benign distance is  tensor(134.9529, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.23723025619983673
distance x is tensor(130.6363, device='cuda:0')
benign distance is  tensor(130.6363, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24094541370868683
distance x is tensor(129.6621, device='cuda:0')
benign distance is  tensor(129.6621, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5736051201820374
distance x is tensor(136.0666, device='cuda:0')
benign distance is  tensor(136.0666, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3305601477622986
distance x is tensor(137.4210, device='cuda:0')
benign distance is  tensor(137.4210, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5637295246124268
distance x is tensor(130.9021, device='cuda:0')
benign distance is  tensor(130.9021, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19094496965408325
distance x is tensor(128.5620, device='cuda:0')
benign distance is  tensor(128.5620, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.28787800669670105
distance x is tensor(132.2273, device='cuda:0')
benign distance is  tensor(132.2273, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5513854622840881
distance x is tensor(136.5828, device='cuda:0')
benign distance is  tensor(136.5828, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.28284308314323425
distance x is tensor(129.2052, device='cuda:0')
benign distance is  tensor(129.2052, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6483945250511169
distance x is tensor(135.4221, device='cuda:0')
benign distance is  tensor(135.4221, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5798255801200867
distance x is tensor(130.6733, device='cuda:0')
benign distance is  tensor(130.6733, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3839547038078308
distance x is tensor(134.8634, device='cuda:0')
benign distance is  tensor(134.8634, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5721240639686584
distance x is tensor(131.3560, device='cuda:0')
benign distance is  tensor(131.3560, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5840906500816345
distance x is tensor(131.4776, device='cuda:0')
benign distance is  tensor(131.4776, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5721707344055176
distance x is tensor(138.4919, device='cuda:0')
benign distance is  tensor(138.4919, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4017098844051361
distance x is tensor(136.0220, device='cuda:0')
benign distance is  tensor(136.0220, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.527283251285553
distance x is tensor(130.5404, device='cuda:0')
benign distance is  tensor(130.5404, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.20092423260211945
distance x is tensor(131.8481, device='cuda:0')
benign distance is  tensor(131.8481, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5267593264579773
distance x is tensor(129.7050, device='cuda:0')
benign distance is  tensor(129.7050, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6474548578262329
distance x is tensor(133.1499, device='cuda:0')
benign distance is  tensor(133.1499, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.49066394567489624
distance x is tensor(130.7436, device='cuda:0')
benign distance is  tensor(130.7436, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.25275009870529175
distance x is tensor(133.7336, device='cuda:0')
benign distance is  tensor(133.7336, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5016825795173645
distance x is tensor(138.1952, device='cuda:0')
benign distance is  tensor(138.1952, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3628358542919159
distance x is tensor(134.6361, device='cuda:0')
benign distance is  tensor(134.6361, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1368989795446396
distance x is tensor(132.7704, device='cuda:0')
benign distance is  tensor(132.7704, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.49716585874557495
distance x is tensor(137.3369, device='cuda:0')
benign distance is  tensor(137.3369, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3320894241333008
distance x is tensor(125.9621, device='cuda:0')
benign distance is  tensor(125.9621, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4120336174964905
distance x is tensor(127.7870, device='cuda:0')
benign distance is  tensor(127.7870, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.645492672920227
distance x is tensor(137.0980, device='cuda:0')
benign distance is  tensor(137.0980, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2282111644744873
distance x is tensor(133.2862, device='cuda:0')
benign distance is  tensor(133.2862, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.326083779335022
distance x is tensor(133.5022, device='cuda:0')
benign distance is  tensor(133.5022, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 608.2435,  583.8641,  601.6220,  607.5465,  620.4861,  599.5054,
         581.2141,  597.1135, 1028.6271, 1026.7852, 1036.7069, 1014.5002,
        1058.7600, 1062.9054, 1026.1147, 1031.0433, 1043.5632, 1023.9969,
        1048.5345, 1050.0186,  581.4377,  591.5665,  599.0550,  593.9476,
         603.9035,  609.7503,  589.1626,  586.2613], device='cuda:0')
sorted_norm is   tensor([ 581.2141,  581.4377,  583.8641,  586.2613,  589.1626,  591.5665,
         593.9476,  597.1135,  599.0550,  599.5054,  601.6220,  603.9035,
         607.5465,  608.2435,  609.7503,  620.4861, 1014.5002, 1023.9969,
        1026.1147, 1026.7852, 1028.6271, 1031.0433, 1036.7069, 1043.5632,
        1048.5345, 1050.0186, 1058.7600, 1062.9054], device='cuda:0')
used idx is  tensor([ 6, 20,  1, 27, 26, 21, 23,  7, 22,  5,  2, 24,  3,  0, 25,  4, 11, 17,
        14,  9,  8, 15], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 72.89% 

Test Accuracy: 72.00% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7115194797515869
distance x is tensor(135.4984, device='cuda:0')
benign distance is  tensor(135.4984, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.47461676597595215
distance x is tensor(126.8600, device='cuda:0')
benign distance is  tensor(126.8600, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24088218808174133
distance x is tensor(126.5703, device='cuda:0')
benign distance is  tensor(126.5703, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.43178239464759827
distance x is tensor(129.7049, device='cuda:0')
benign distance is  tensor(129.7049, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.47726860642433167
distance x is tensor(127.9907, device='cuda:0')
benign distance is  tensor(127.9907, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.36253851652145386
distance x is tensor(135.3175, device='cuda:0')
benign distance is  tensor(135.3175, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3170902132987976
distance x is tensor(130.6552, device='cuda:0')
benign distance is  tensor(130.6552, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4506341516971588
distance x is tensor(136.4229, device='cuda:0')
benign distance is  tensor(136.4229, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5026072263717651
distance x is tensor(123.5402, device='cuda:0')
benign distance is  tensor(123.5402, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.47682303190231323
distance x is tensor(128.7092, device='cuda:0')
benign distance is  tensor(128.7092, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2759239673614502
distance x is tensor(137.5338, device='cuda:0')
benign distance is  tensor(137.5338, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4045604169368744
distance x is tensor(133.8713, device='cuda:0')
benign distance is  tensor(133.8713, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.13530781865119934
distance x is tensor(120.1033, device='cuda:0')
benign distance is  tensor(120.1033, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3714683949947357
distance x is tensor(124.3722, device='cuda:0')
benign distance is  tensor(124.3722, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.35169100761413574
distance x is tensor(134.3733, device='cuda:0')
benign distance is  tensor(134.3733, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5112578868865967
distance x is tensor(123.2125, device='cuda:0')
benign distance is  tensor(123.2125, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 606.0627,  573.6683,  585.9344,  585.2786,  580.4928,  612.0545,
         597.5380,  618.3999, 1053.8656, 1034.3430, 1068.9904, 1063.1326,
        1081.4384, 1073.1520, 1064.4745, 1056.5858, 1075.1438, 1068.6323,
        1071.5416, 1079.3633,  613.0704,  590.0604,  613.2452,  592.8671,
         615.4382,  608.3890,  595.8427,  624.2331], device='cuda:0')
sorted_norm is   tensor([ 573.6683,  580.4928,  585.2786,  585.9344,  590.0604,  592.8671,
         595.8427,  597.5380,  606.0627,  608.3890,  612.0545,  613.0704,
         613.2452,  615.4382,  618.3999,  624.2331, 1034.3430, 1053.8656,
        1056.5858, 1063.1326, 1064.4745, 1068.6323, 1068.9904, 1071.5416,
        1073.1520, 1075.1438, 1079.3633, 1081.4384], device='cuda:0')
used idx is  tensor([ 1,  4,  3,  2, 21, 23, 26,  6,  0, 25,  5, 20, 22, 24,  7, 27,  9,  8,
        15, 11, 14, 17], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 72.23% 

Test Accuracy: 71.56% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5871400833129883
distance x is tensor(129.2990, device='cuda:0')
benign distance is  tensor(129.2990, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2027197778224945
distance x is tensor(129.5599, device='cuda:0')
benign distance is  tensor(129.5599, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3455045521259308
distance x is tensor(132.8512, device='cuda:0')
benign distance is  tensor(132.8512, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4907515048980713
distance x is tensor(135.8543, device='cuda:0')
benign distance is  tensor(135.8543, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5479410886764526
distance x is tensor(133.9912, device='cuda:0')
benign distance is  tensor(133.9912, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3591795861721039
distance x is tensor(137.7679, device='cuda:0')
benign distance is  tensor(137.7679, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3129672408103943
distance x is tensor(130.9170, device='cuda:0')
benign distance is  tensor(130.9170, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2851150631904602
distance x is tensor(137.0670, device='cuda:0')
benign distance is  tensor(137.0670, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2992166578769684
distance x is tensor(134.5342, device='cuda:0')
benign distance is  tensor(134.5342, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.207192063331604
distance x is tensor(126.7667, device='cuda:0')
benign distance is  tensor(126.7667, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4877046048641205
distance x is tensor(135.5636, device='cuda:0')
benign distance is  tensor(135.5636, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.426475465297699
distance x is tensor(132.4165, device='cuda:0')
benign distance is  tensor(132.4165, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3168072998523712
distance x is tensor(124.4212, device='cuda:0')
benign distance is  tensor(124.4212, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3762010931968689
distance x is tensor(124.4679, device='cuda:0')
benign distance is  tensor(124.4679, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.33882975578308105
distance x is tensor(125.6143, device='cuda:0')
benign distance is  tensor(125.6143, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3417230248451233
distance x is tensor(134.3948, device='cuda:0')
benign distance is  tensor(134.3948, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 578.1577,  580.8174,  595.0573,  605.8641,  603.0690,  636.6678,
         599.8697,  616.3423, 1054.5204, 1055.4928, 1085.6902, 1074.2983,
        1109.9011, 1091.2108, 1072.0410, 1057.2797, 1081.0244, 1087.8053,
        1081.1150, 1091.6350], device='cuda:0')
sorted_norm is   tensor([ 578.1577,  580.8174,  595.0573,  599.8697,  603.0690,  605.8641,
         616.3423,  636.6678, 1054.5204, 1055.4928, 1057.2797, 1072.0410,
        1074.2983, 1081.0244, 1081.1150, 1085.6902, 1087.8053, 1091.2108,
        1091.6350, 1109.9011], device='cuda:0')
used idx is  tensor([ 0,  1,  2,  6,  4,  3,  7,  5,  8,  9, 15, 14, 11, 16, 18, 10],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8996533155441284
distance x is tensor(79.6318, device='cuda:0')
benign distance is  tensor(79.6318, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0286468267440796
distance x is tensor(80.0571, device='cuda:0')
benign distance is  tensor(80.0571, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.006962537765503
distance x is tensor(77.0686, device='cuda:0')
benign distance is  tensor(77.0686, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9501857757568359
distance x is tensor(78.6600, device='cuda:0')
benign distance is  tensor(78.6600, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7405936121940613
distance x is tensor(81.5107, device='cuda:0')
benign distance is  tensor(81.5107, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0314738750457764
distance x is tensor(79.1527, device='cuda:0')
benign distance is  tensor(79.1527, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0148454904556274
distance x is tensor(82.5714, device='cuda:0')
benign distance is  tensor(82.5714, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8949287533760071
distance x is tensor(77.2236, device='cuda:0')
benign distance is  tensor(77.2236, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([602.0115, 615.5941, 583.1155, 593.5588, 606.2659, 588.3831, 584.3514,
        576.8134, 646.1669, 635.5264, 663.7028, 680.8125, 655.7881, 649.6506,
        656.8792, 679.6166, 651.2231, 659.4023, 665.3215, 673.4295, 780.6414,
        837.4443, 806.5233, 805.3851, 809.7758, 816.9492, 825.7700, 808.0209,
        826.9601, 799.3176, 809.7585, 802.8332, 808.7913, 809.0109, 818.3030,
        827.9998, 806.2287, 816.7917, 847.5576, 836.1694, 784.8222, 803.6337,
        833.3843, 798.6036, 834.5994, 809.4633, 833.4916, 823.2269, 803.3421,
        803.4761, 800.8630, 837.8166], device='cuda:0')
sorted_norm is   tensor([576.8134, 583.1155, 584.3514, 588.3831, 593.5588, 602.0115, 606.2659,
        615.5941, 635.5264, 646.1669, 649.6506, 651.2231, 655.7881, 656.8792,
        659.4023, 663.7028, 665.3215, 673.4295, 679.6166, 680.8125, 780.6414,
        784.8222, 798.6036, 799.3176, 800.8630, 802.8332, 803.3421, 803.4761,
        803.6337, 805.3851, 806.2287, 806.5233, 808.0209, 808.7913, 809.0109,
        809.4633, 809.7585, 809.7758, 816.7917, 816.9492, 818.3030, 823.2269,
        825.7700, 826.9601, 827.9998, 833.3843, 833.4916, 834.5994, 836.1694,
        837.4443, 837.8166, 847.5576], device='cuda:0')
used idx is  tensor([ 7,  2,  6,  5,  3,  0,  4,  1,  9,  8, 13, 16, 12, 14, 17, 10, 18, 19,
        15, 11, 20, 40, 43, 29, 50, 31, 48, 49, 41, 23, 36, 22, 27, 32, 33, 45,
        30, 24, 37, 25, 34], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 78.21% 

Test Accuracy: 77.63% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5414968729019165
distance x is tensor(131.0874, device='cuda:0')
benign distance is  tensor(131.0874, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.33920997381210327
distance x is tensor(122.1370, device='cuda:0')
benign distance is  tensor(122.1370, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3585757911205292
distance x is tensor(124.3225, device='cuda:0')
benign distance is  tensor(124.3225, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.30215397477149963
distance x is tensor(129.9738, device='cuda:0')
benign distance is  tensor(129.9738, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3258591294288635
distance x is tensor(125.1283, device='cuda:0')
benign distance is  tensor(125.1283, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7123904228210449
distance x is tensor(130.5607, device='cuda:0')
benign distance is  tensor(130.5607, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2512722611427307
distance x is tensor(127.1872, device='cuda:0')
benign distance is  tensor(127.1872, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3187609016895294
distance x is tensor(130.9202, device='cuda:0')
benign distance is  tensor(130.9202, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7580169439315796
distance x is tensor(129.4982, device='cuda:0')
benign distance is  tensor(129.4982, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2349000722169876
distance x is tensor(124.3152, device='cuda:0')
benign distance is  tensor(124.3152, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0550662279129028
distance x is tensor(125.3026, device='cuda:0')
benign distance is  tensor(125.3026, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.45063653588294983
distance x is tensor(126.3070, device='cuda:0')
benign distance is  tensor(126.3070, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3483448624610901
distance x is tensor(120.3291, device='cuda:0')
benign distance is  tensor(120.3291, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.22047320008277893
distance x is tensor(126.2714, device='cuda:0')
benign distance is  tensor(126.2714, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.47083085775375366
distance x is tensor(126.1285, device='cuda:0')
benign distance is  tensor(126.1285, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7031564116477966
distance x is tensor(127.9799, device='cuda:0')
benign distance is  tensor(127.9799, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.42234477400779724
distance x is tensor(121.4652, device='cuda:0')
benign distance is  tensor(121.4652, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6361950635910034
distance x is tensor(132.3349, device='cuda:0')
benign distance is  tensor(132.3349, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4550129771232605
distance x is tensor(131.3223, device='cuda:0')
benign distance is  tensor(131.3223, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.32326921820640564
distance x is tensor(133.1685, device='cuda:0')
benign distance is  tensor(133.1685, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.16370832920074463
distance x is tensor(122.8907, device='cuda:0')
benign distance is  tensor(122.8907, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4046413004398346
distance x is tensor(121.9603, device='cuda:0')
benign distance is  tensor(121.9603, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4723491072654724
distance x is tensor(131.2149, device='cuda:0')
benign distance is  tensor(131.2149, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.19330336153507233
distance x is tensor(121.5059, device='cuda:0')
benign distance is  tensor(121.5059, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5336706638336182
distance x is tensor(130.6128, device='cuda:0')
benign distance is  tensor(130.6128, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7606492042541504
distance x is tensor(127.7935, device='cuda:0')
benign distance is  tensor(127.7935, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3342497944831848
distance x is tensor(130.0381, device='cuda:0')
benign distance is  tensor(130.0381, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2917219400405884
distance x is tensor(127.5412, device='cuda:0')
benign distance is  tensor(127.5412, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.574990451335907
distance x is tensor(130.4333, device='cuda:0')
benign distance is  tensor(130.4333, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5280832052230835
distance x is tensor(132.2515, device='cuda:0')
benign distance is  tensor(132.2515, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4525349736213684
distance x is tensor(123.7925, device='cuda:0')
benign distance is  tensor(123.7925, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.34970948100090027
distance x is tensor(126.2459, device='cuda:0')
benign distance is  tensor(126.2459, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.6571556925773621
distance x is tensor(125.1414, device='cuda:0')
benign distance is  tensor(125.1414, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5148748159408569
distance x is tensor(138.4673, device='cuda:0')
benign distance is  tensor(138.4673, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.32537075877189636
distance x is tensor(123.9937, device='cuda:0')
benign distance is  tensor(123.9937, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3855152130126953
distance x is tensor(127.9455, device='cuda:0')
benign distance is  tensor(127.9455, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.24900737404823303
distance x is tensor(123.3320, device='cuda:0')
benign distance is  tensor(123.3320, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.48101815581321716
distance x is tensor(127.3254, device='cuda:0')
benign distance is  tensor(127.3254, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6172053813934326
distance x is tensor(124.4621, device='cuda:0')
benign distance is  tensor(124.4621, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.25097519159317017
distance x is tensor(131.3289, device='cuda:0')
benign distance is  tensor(131.3289, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 584.4800,  554.8242,  563.4098,  589.2356,  569.6373,  588.6130,
         577.5355,  597.3176, 1087.2864, 1075.0758, 1108.9763, 1116.3303,
        1123.0869, 1110.6167, 1104.5299, 1100.6304, 1114.2455, 1104.3474,
        1122.1774, 1112.1744,  584.8445,  586.9930,  603.5530,  558.5403,
         570.2808,  596.0181,  575.9490,  582.4447], device='cuda:0')
sorted_norm is   tensor([ 554.8242,  558.5403,  563.4098,  569.6373,  570.2808,  575.9490,
         577.5355,  582.4447,  584.4800,  584.8445,  586.9930,  588.6130,
         589.2356,  596.0181,  597.3176,  603.5530, 1075.0758, 1087.2864,
        1100.6304, 1104.3474, 1104.5299, 1108.9763, 1110.6167, 1112.1744,
        1114.2455, 1116.3303, 1122.1774, 1123.0869], device='cuda:0')
used idx is  tensor([ 1, 23,  2,  4, 24, 26,  6, 27,  0, 20, 21,  5,  3, 25,  7, 22,  9,  8,
        15, 17, 14, 10], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 76.17% 

Test Accuracy: 75.35% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6036983132362366
distance x is tensor(129.9714, device='cuda:0')
benign distance is  tensor(129.9714, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.40512871742248535
distance x is tensor(129.9088, device='cuda:0')
benign distance is  tensor(129.9088, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09067346155643463
distance x is tensor(131.3531, device='cuda:0')
benign distance is  tensor(131.3531, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47489961981773376
distance x is tensor(130.8431, device='cuda:0')
benign distance is  tensor(130.8431, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0080894231796265
distance x is tensor(127.9748, device='cuda:0')
benign distance is  tensor(127.9748, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7328230142593384
distance x is tensor(136.5298, device='cuda:0')
benign distance is  tensor(136.5298, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4961102604866028
distance x is tensor(130.6931, device='cuda:0')
benign distance is  tensor(130.6931, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3749638795852661
distance x is tensor(133.1894, device='cuda:0')
benign distance is  tensor(133.1894, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.34174445271492004
distance x is tensor(136.7588, device='cuda:0')
benign distance is  tensor(136.7588, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.39163821935653687
distance x is tensor(135.0058, device='cuda:0')
benign distance is  tensor(135.0058, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.47480112314224243
distance x is tensor(131.2928, device='cuda:0')
benign distance is  tensor(131.2928, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.5077716708183289
distance x is tensor(126.8827, device='cuda:0')
benign distance is  tensor(126.8827, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.44607535004615784
distance x is tensor(128.5506, device='cuda:0')
benign distance is  tensor(128.5506, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.25980573892593384
distance x is tensor(134.4634, device='cuda:0')
benign distance is  tensor(134.4634, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.18229156732559204
distance x is tensor(132.0625, device='cuda:0')
benign distance is  tensor(132.0625, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.272490918636322
distance x is tensor(131.4048, device='cuda:0')
benign distance is  tensor(131.4048, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 588.9158,  585.7445,  594.6827,  589.3026,  577.8762,  624.0376,
         578.8925,  596.9163, 1078.8774, 1057.2719, 1084.3053, 1086.1750,
        1080.8716, 1083.9912, 1050.4565, 1065.0299, 1070.8062, 1073.4690,
        1085.0994, 1085.3998,  615.5225,  598.7744,  598.6720,  595.0833,
         593.9244,  608.8034,  604.5774,  618.1311], device='cuda:0')
sorted_norm is   tensor([ 577.8762,  578.8925,  585.7445,  588.9158,  589.3026,  593.9244,
         594.6827,  595.0833,  596.9163,  598.6720,  598.7744,  604.5774,
         608.8034,  615.5225,  618.1311,  624.0376, 1050.4565, 1057.2719,
        1065.0299, 1070.8062, 1073.4690, 1078.8774, 1080.8716, 1083.9912,
        1084.3053, 1085.0994, 1085.3998, 1086.1750], device='cuda:0')
used idx is  tensor([ 4,  6,  1,  0,  3, 24,  2, 23,  7, 22, 21, 26, 25, 20, 27,  5, 14,  9,
        15, 16, 17,  8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 74.38% 

Test Accuracy: 73.59% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.835128664970398
distance x is tensor(134.1217, device='cuda:0')
benign distance is  tensor(134.1217, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.17312875390052795
distance x is tensor(128.8611, device='cuda:0')
benign distance is  tensor(128.8611, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31369924545288086
distance x is tensor(133.7290, device='cuda:0')
benign distance is  tensor(133.7290, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6171115636825562
distance x is tensor(136.8010, device='cuda:0')
benign distance is  tensor(136.8010, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5445348620414734
distance x is tensor(132.1187, device='cuda:0')
benign distance is  tensor(132.1187, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5609334707260132
distance x is tensor(133.7595, device='cuda:0')
benign distance is  tensor(133.7595, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5028293132781982
distance x is tensor(133.2853, device='cuda:0')
benign distance is  tensor(133.2853, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.38332560658454895
distance x is tensor(140.2976, device='cuda:0')
benign distance is  tensor(140.2976, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7696953415870667
distance x is tensor(133.2794, device='cuda:0')
benign distance is  tensor(133.2794, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5215285420417786
distance x is tensor(124.7141, device='cuda:0')
benign distance is  tensor(124.7141, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9736869931221008
distance x is tensor(131.0045, device='cuda:0')
benign distance is  tensor(131.0045, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6666067242622375
distance x is tensor(135.7533, device='cuda:0')
benign distance is  tensor(135.7533, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5762672424316406
distance x is tensor(122.1524, device='cuda:0')
benign distance is  tensor(122.1524, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4972497522830963
distance x is tensor(131.8750, device='cuda:0')
benign distance is  tensor(131.8750, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3989964723587036
distance x is tensor(129.1893, device='cuda:0')
benign distance is  tensor(129.1893, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.44275131821632385
distance x is tensor(129.7227, device='cuda:0')
benign distance is  tensor(129.7227, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 599.5880,  569.9116,  599.5673,  604.8489,  596.6514,  594.7795,
         587.8444,  616.1453, 1084.1743, 1070.2640, 1093.8574, 1088.8108,
        1105.7471, 1089.8738, 1090.3827, 1084.9923, 1080.2195, 1077.5684,
        1094.5183, 1096.2100,  582.2394,  627.2998,  611.0504,  627.6616,
         583.6271,  585.6541,  611.5179,  581.1080], device='cuda:0')
sorted_norm is   tensor([ 569.9116,  581.1080,  582.2394,  583.6271,  585.6541,  587.8444,
         594.7795,  596.6514,  599.5673,  599.5880,  604.8489,  611.0504,
         611.5179,  616.1453,  627.2998,  627.6616, 1070.2640, 1077.5684,
        1080.2195, 1084.1743, 1084.9923, 1088.8108, 1089.8738, 1090.3827,
        1093.8574, 1094.5183, 1096.2100, 1105.7471], device='cuda:0')
used idx is  tensor([ 1, 27, 20, 24, 25,  6,  5,  4,  2,  0,  3, 22, 26,  7, 21, 23,  9, 17,
        16,  8, 15, 11], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 76.28% 

Test Accuracy: 75.36% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7147480249404907
distance x is tensor(138.3310, device='cuda:0')
benign distance is  tensor(138.3310, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.27270472049713135
distance x is tensor(127.0275, device='cuda:0')
benign distance is  tensor(127.0275, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.34114816784858704
distance x is tensor(136.9788, device='cuda:0')
benign distance is  tensor(136.9788, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5101320147514343
distance x is tensor(133.1966, device='cuda:0')
benign distance is  tensor(133.1966, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5900520086288452
distance x is tensor(131.5995, device='cuda:0')
benign distance is  tensor(131.5995, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.34319981932640076
distance x is tensor(134.6496, device='cuda:0')
benign distance is  tensor(134.6496, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5612529516220093
distance x is tensor(134.7314, device='cuda:0')
benign distance is  tensor(134.7314, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2960750460624695
distance x is tensor(138.0603, device='cuda:0')
benign distance is  tensor(138.0603, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3949227035045624
distance x is tensor(126.6118, device='cuda:0')
benign distance is  tensor(126.6118, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.23168113827705383
distance x is tensor(136.9082, device='cuda:0')
benign distance is  tensor(136.9082, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.41938671469688416
distance x is tensor(142.8529, device='cuda:0')
benign distance is  tensor(142.8529, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.25307896733283997
distance x is tensor(131.7198, device='cuda:0')
benign distance is  tensor(131.7198, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.25800201296806335
distance x is tensor(127.0974, device='cuda:0')
benign distance is  tensor(127.0974, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3399834930896759
distance x is tensor(132.6790, device='cuda:0')
benign distance is  tensor(132.6790, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4332341253757477
distance x is tensor(136.5843, device='cuda:0')
benign distance is  tensor(136.5843, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7886399626731873
distance x is tensor(124.0036, device='cuda:0')
benign distance is  tensor(124.0036, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 613.2006,  579.5535,  614.1728,  597.5795,  591.2664,  616.8000,
         596.1580,  619.0566, 1077.8337, 1068.2676, 1101.1500, 1098.4105,
        1117.1611, 1096.5725, 1091.6218, 1092.9429, 1116.7654, 1114.5035,
        1106.6531, 1091.3534,  616.4870,  604.8561,  609.5301,  607.5881,
         614.0201,  609.7086,  594.6178,  608.3315,  613.2502,  586.0376,
         596.4077,  616.3720,  583.6541,  600.0378,  608.7841,  609.1759],
       device='cuda:0')
sorted_norm is   tensor([ 579.5535,  583.6541,  586.0376,  591.2664,  594.6178,  596.1580,
         596.4077,  597.5795,  600.0378,  604.8561,  607.5881,  608.3315,
         608.7841,  609.1759,  609.5301,  609.7086,  613.2006,  613.2502,
         614.0201,  614.1728,  616.3720,  616.4870,  616.8000,  619.0566,
        1068.2676, 1077.8337, 1091.3534, 1091.6218, 1092.9429, 1096.5725,
        1098.4105, 1101.1500, 1106.6531, 1114.5035, 1116.7654, 1117.1611],
       device='cuda:0')
used idx is  tensor([ 1, 32, 29,  4, 26,  6, 30,  3, 33, 21, 23, 27, 34, 35, 22, 25,  0, 28,
        24,  2, 31, 20,  5,  7,  9,  8, 19, 14], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 83.87% 

Test Accuracy: 83.16% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5486131906509399
distance x is tensor(116.9975, device='cuda:0')
benign distance is  tensor(116.9975, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5356228351593018
distance x is tensor(110.1697, device='cuda:0')
benign distance is  tensor(110.1697, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.26755666732788086
distance x is tensor(113.0371, device='cuda:0')
benign distance is  tensor(113.0371, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.416879266500473
distance x is tensor(111.2609, device='cuda:0')
benign distance is  tensor(111.2609, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.30118346214294434
distance x is tensor(112.6168, device='cuda:0')
benign distance is  tensor(112.6168, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8639312982559204
distance x is tensor(120.4127, device='cuda:0')
benign distance is  tensor(120.4127, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6371363401412964
distance x is tensor(113.3525, device='cuda:0')
benign distance is  tensor(113.3525, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2051314413547516
distance x is tensor(118.5939, device='cuda:0')
benign distance is  tensor(118.5939, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.48905491828918457
distance x is tensor(116.1313, device='cuda:0')
benign distance is  tensor(116.1313, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.40494304895401
distance x is tensor(108.3062, device='cuda:0')
benign distance is  tensor(108.3062, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7158353924751282
distance x is tensor(113.2894, device='cuda:0')
benign distance is  tensor(113.2894, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.15199795365333557
distance x is tensor(115.1040, device='cuda:0')
benign distance is  tensor(115.1040, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.44346755743026733
distance x is tensor(110.1922, device='cuda:0')
benign distance is  tensor(110.1922, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2054482400417328
distance x is tensor(112.4333, device='cuda:0')
benign distance is  tensor(112.4333, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4344514310359955
distance x is tensor(109.3986, device='cuda:0')
benign distance is  tensor(109.3986, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.43582239747047424
distance x is tensor(117.9132, device='cuda:0')
benign distance is  tensor(117.9132, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1209157332777977
distance x is tensor(122.3108, device='cuda:0')
benign distance is  tensor(122.3108, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5474026203155518
distance x is tensor(111.0696, device='cuda:0')
benign distance is  tensor(111.0696, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.533949613571167
distance x is tensor(112.5386, device='cuda:0')
benign distance is  tensor(112.5386, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6590183973312378
distance x is tensor(112.2484, device='cuda:0')
benign distance is  tensor(112.2484, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.647733211517334
distance x is tensor(115.1710, device='cuda:0')
benign distance is  tensor(115.1710, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2777532637119293
distance x is tensor(116.6609, device='cuda:0')
benign distance is  tensor(116.6609, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2555885910987854
distance x is tensor(111.7941, device='cuda:0')
benign distance is  tensor(111.7941, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3444375693798065
distance x is tensor(110.1257, device='cuda:0')
benign distance is  tensor(110.1257, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 529.6907,  502.1292,  517.5794,  508.9636,  515.0546,  547.6933,
         516.5820,  534.8538, 1267.1139, 1261.1257, 1293.1456, 1269.7074,
        1318.4014, 1310.4888, 1281.6986, 1289.1481, 1285.9065, 1286.2791,
        1290.1257, 1288.4274], device='cuda:0')
sorted_norm is   tensor([ 502.1292,  508.9636,  515.0546,  516.5820,  517.5794,  529.6907,
         534.8538,  547.6933, 1261.1257, 1267.1139, 1269.7074, 1281.6986,
        1285.9065, 1286.2791, 1288.4274, 1289.1481, 1290.1257, 1293.1456,
        1310.4888, 1318.4014], device='cuda:0')
used idx is  tensor([ 1,  3,  4,  6,  2,  0,  7,  5,  9,  8, 11, 14, 16, 17, 19, 15],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0338261127471924
distance x is tensor(42.7496, device='cuda:0')
benign distance is  tensor(42.7496, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1656168699264526
distance x is tensor(51.7948, device='cuda:0')
benign distance is  tensor(51.7948, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5741280317306519
distance x is tensor(44.1029, device='cuda:0')
benign distance is  tensor(44.1029, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1685163974761963
distance x is tensor(53.8969, device='cuda:0')
benign distance is  tensor(53.8969, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1132233142852783
distance x is tensor(54.2429, device='cuda:0')
benign distance is  tensor(54.2429, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.25325608253479
distance x is tensor(48.7390, device='cuda:0')
benign distance is  tensor(48.7390, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1288566589355469
distance x is tensor(55.6947, device='cuda:0')
benign distance is  tensor(55.6947, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0818915367126465
distance x is tensor(53.8383, device='cuda:0')
benign distance is  tensor(53.8383, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([332.2650, 405.2841, 362.8870, 418.0883, 412.0984, 390.5528, 435.2168,
        407.7287, 494.6506, 532.7939, 506.9896, 441.8362, 417.6337, 440.5615,
        471.0231, 460.2324, 469.2125, 379.9730, 386.0614, 388.8563, 816.8029,
        854.7506, 807.8068, 818.3561, 816.7670, 826.1140, 814.5590, 833.8865,
        832.8176, 838.1237, 821.9382, 799.5834, 811.1754, 832.4065, 826.1853,
        835.1311, 811.3669, 846.5309, 854.9977, 834.9914, 816.9520, 827.5946,
        835.4257, 807.0746, 868.8933, 842.6330, 853.6713, 861.2200, 846.8664,
        853.4658, 853.6115, 876.7170], device='cuda:0')
sorted_norm is   tensor([332.2650, 362.8870, 379.9730, 386.0614, 388.8563, 390.5528, 405.2841,
        407.7287, 412.0984, 417.6337, 418.0883, 435.2168, 440.5615, 441.8362,
        460.2324, 469.2125, 471.0231, 494.6506, 506.9896, 532.7939, 799.5834,
        807.0746, 807.8068, 811.1754, 811.3669, 814.5590, 816.7670, 816.8029,
        816.9520, 818.3561, 821.9382, 826.1140, 826.1853, 827.5946, 832.4065,
        832.8176, 833.8865, 834.9914, 835.1311, 835.4257, 838.1237, 842.6330,
        846.5309, 846.8664, 853.4658, 853.6115, 853.6713, 854.7506, 854.9977,
        861.2200, 868.8933, 876.7170], device='cuda:0')
used idx is  tensor([ 0,  2, 17, 18, 19,  5,  1,  7,  4, 12,  3,  6, 13, 11, 15, 16, 14,  8,
        10,  9, 31, 43, 22, 32, 36, 26, 24, 20, 40, 23, 30, 25, 34, 41, 33, 28,
        27, 39, 35, 42, 29], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 77.74% 

Test Accuracy: 76.95% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3704596161842346
distance x is tensor(129.0644, device='cuda:0')
benign distance is  tensor(129.0644, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2767319679260254
distance x is tensor(122.3335, device='cuda:0')
benign distance is  tensor(122.3335, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3684500455856323
distance x is tensor(123.6835, device='cuda:0')
benign distance is  tensor(123.6835, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4310913681983948
distance x is tensor(128.3714, device='cuda:0')
benign distance is  tensor(128.3714, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5799441337585449
distance x is tensor(128.7364, device='cuda:0')
benign distance is  tensor(128.7364, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6032027006149292
distance x is tensor(131.8819, device='cuda:0')
benign distance is  tensor(131.8819, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.32669171690940857
distance x is tensor(124.6392, device='cuda:0')
benign distance is  tensor(124.6392, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2396223545074463
distance x is tensor(132.3854, device='cuda:0')
benign distance is  tensor(132.3854, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4408671259880066
distance x is tensor(129.8615, device='cuda:0')
benign distance is  tensor(129.8615, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4335154891014099
distance x is tensor(131.1504, device='cuda:0')
benign distance is  tensor(131.1504, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5199315547943115
distance x is tensor(129.8902, device='cuda:0')
benign distance is  tensor(129.8902, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.474661260843277
distance x is tensor(129.0812, device='cuda:0')
benign distance is  tensor(129.0812, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3752944767475128
distance x is tensor(121.0904, device='cuda:0')
benign distance is  tensor(121.0904, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.37851235270500183
distance x is tensor(122.6794, device='cuda:0')
benign distance is  tensor(122.6794, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.47780299186706543
distance x is tensor(125.8473, device='cuda:0')
benign distance is  tensor(125.8473, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6015125513076782
distance x is tensor(129.7252, device='cuda:0')
benign distance is  tensor(129.7252, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3269505202770233
distance x is tensor(121.9049, device='cuda:0')
benign distance is  tensor(121.9049, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.514776349067688
distance x is tensor(134.1137, device='cuda:0')
benign distance is  tensor(134.1137, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5059840083122253
distance x is tensor(137.6606, device='cuda:0')
benign distance is  tensor(137.6606, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.30928462743759155
distance x is tensor(134.7767, device='cuda:0')
benign distance is  tensor(134.7767, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.32323139905929565
distance x is tensor(123.6309, device='cuda:0')
benign distance is  tensor(123.6309, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3844423294067383
distance x is tensor(127.2177, device='cuda:0')
benign distance is  tensor(127.2177, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5596504211425781
distance x is tensor(132.6135, device='cuda:0')
benign distance is  tensor(132.6135, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5481839179992676
distance x is tensor(122.8499, device='cuda:0')
benign distance is  tensor(122.8499, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.23604121804237366
distance x is tensor(127.8403, device='cuda:0')
benign distance is  tensor(127.8403, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.24180686473846436
distance x is tensor(131.7978, device='cuda:0')
benign distance is  tensor(131.7978, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.23681843280792236
distance x is tensor(131.3371, device='cuda:0')
benign distance is  tensor(131.3371, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.5543444752693176
distance x is tensor(126.6648, device='cuda:0')
benign distance is  tensor(126.6648, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.46901875734329224
distance x is tensor(129.2306, device='cuda:0')
benign distance is  tensor(129.2306, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3501582741737366
distance x is tensor(127.3811, device='cuda:0')
benign distance is  tensor(127.3811, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3207891285419464
distance x is tensor(137.3460, device='cuda:0')
benign distance is  tensor(137.3460, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6681357622146606
distance x is tensor(131.8897, device='cuda:0')
benign distance is  tensor(131.8897, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.26315003633499146
distance x is tensor(128.8828, device='cuda:0')
benign distance is  tensor(128.8828, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3322122395038605
distance x is tensor(135.4965, device='cuda:0')
benign distance is  tensor(135.4965, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.6315517425537109
distance x is tensor(123.8830, device='cuda:0')
benign distance is  tensor(123.8830, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2940143942832947
distance x is tensor(130.5163, device='cuda:0')
benign distance is  tensor(130.5163, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.27110812067985535
distance x is tensor(128.9467, device='cuda:0')
benign distance is  tensor(128.9467, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.46304717659950256
distance x is tensor(134.8313, device='cuda:0')
benign distance is  tensor(134.8313, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8673407435417175
distance x is tensor(127.2133, device='cuda:0')
benign distance is  tensor(127.2133, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.16050516068935394
distance x is tensor(126.5431, device='cuda:0')
benign distance is  tensor(126.5431, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 583.1091,  562.1344,  566.2194,  573.1864,  578.8619,  598.7524,
         567.2109,  604.7030, 1115.8658, 1092.0411, 1111.8103, 1104.9647,
        1125.0592, 1114.4250, 1103.1035, 1106.9376, 1122.6281, 1120.5806,
        1121.5597, 1127.7576], device='cuda:0')
sorted_norm is   tensor([ 562.1344,  566.2194,  567.2109,  573.1864,  578.8619,  583.1091,
         598.7524,  604.7030, 1092.0411, 1103.1035, 1104.9647, 1106.9376,
        1111.8103, 1114.4250, 1115.8658, 1120.5806, 1121.5597, 1122.6281,
        1125.0592, 1127.7576], device='cuda:0')
used idx is  tensor([ 1,  2,  6,  3,  4,  0,  5,  7,  9, 14, 11, 15, 10, 13,  8, 17],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1099631786346436
distance x is tensor(76.2104, device='cuda:0')
benign distance is  tensor(76.2104, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0839401483535767
distance x is tensor(74.7031, device='cuda:0')
benign distance is  tensor(74.7031, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9045268893241882
distance x is tensor(86.9651, device='cuda:0')
benign distance is  tensor(86.9651, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2004673480987549
distance x is tensor(77.0572, device='cuda:0')
benign distance is  tensor(77.0572, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8593136668205261
distance x is tensor(79.4071, device='cuda:0')
benign distance is  tensor(79.4071, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1273329257965088
distance x is tensor(72.0236, device='cuda:0')
benign distance is  tensor(72.0236, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.161813497543335
distance x is tensor(76.7014, device='cuda:0')
benign distance is  tensor(76.7014, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1606460809707642
distance x is tensor(77.1505, device='cuda:0')
benign distance is  tensor(77.1505, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([524.2943, 535.8737, 573.3255, 538.9562, 564.8115, 522.4937, 538.6943,
        552.7640, 602.4346, 651.6504, 595.5574, 628.3530, 622.1099, 616.4999,
        627.5565, 606.9066, 609.1992, 602.3200, 628.9356, 625.8685, 888.8468,
        850.7087, 854.4216, 853.9221, 872.4193, 869.2591, 854.9715, 852.5676,
        839.1614, 836.2406, 826.2358, 837.3787, 809.8375, 807.4263, 822.8318,
        842.1212], device='cuda:0')
sorted_norm is   tensor([522.4937, 524.2943, 535.8737, 538.6943, 538.9562, 552.7640, 564.8115,
        573.3255, 595.5574, 602.3200, 602.4346, 606.9066, 609.1992, 616.4999,
        622.1099, 625.8685, 627.5565, 628.3530, 628.9356, 651.6504, 807.4263,
        809.8375, 822.8318, 826.2358, 836.2406, 837.3787, 839.1614, 842.1212,
        850.7087, 852.5676, 853.9221, 854.4216, 854.9715, 869.2591, 872.4193,
        888.8468], device='cuda:0')
used idx is  tensor([ 5,  0,  1,  6,  3,  7,  4,  2, 10, 17,  8, 15, 16, 13, 12, 19, 14, 11,
        18,  9, 33, 32, 34, 30, 29, 31, 28, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 20.96% 

Test Accuracy: 21.43% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4098018705844879
distance x is tensor(137.9839, device='cuda:0')
benign distance is  tensor(137.9839, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3071661591529846
distance x is tensor(139.1461, device='cuda:0')
benign distance is  tensor(139.1461, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.34645310044288635
distance x is tensor(148.8859, device='cuda:0')
benign distance is  tensor(148.8859, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6922524571418762
distance x is tensor(150.4917, device='cuda:0')
benign distance is  tensor(150.4917, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3961729407310486
distance x is tensor(144.4644, device='cuda:0')
benign distance is  tensor(144.4644, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4456821084022522
distance x is tensor(144.4020, device='cuda:0')
benign distance is  tensor(144.4020, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.40502047538757324
distance x is tensor(143.7569, device='cuda:0')
benign distance is  tensor(143.7569, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4227408468723297
distance x is tensor(145.0787, device='cuda:0')
benign distance is  tensor(145.0787, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5787729024887085
distance x is tensor(151.3679, device='cuda:0')
benign distance is  tensor(151.3679, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.24317380785942078
distance x is tensor(136.6222, device='cuda:0')
benign distance is  tensor(136.6222, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8196966052055359
distance x is tensor(148.0153, device='cuda:0')
benign distance is  tensor(148.0153, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5473348498344421
distance x is tensor(144.4671, device='cuda:0')
benign distance is  tensor(144.4671, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4130471348762512
distance x is tensor(138.4607, device='cuda:0')
benign distance is  tensor(138.4607, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5537059307098389
distance x is tensor(142.2664, device='cuda:0')
benign distance is  tensor(142.2664, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8820430636405945
distance x is tensor(143.5899, device='cuda:0')
benign distance is  tensor(143.5899, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7027910947799683
distance x is tensor(148.1063, device='cuda:0')
benign distance is  tensor(148.1063, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.31438910961151123
distance x is tensor(148.6500, device='cuda:0')
benign distance is  tensor(148.6500, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5974828004837036
distance x is tensor(147.1345, device='cuda:0')
benign distance is  tensor(147.1345, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3211927115917206
distance x is tensor(144.6746, device='cuda:0')
benign distance is  tensor(144.6746, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.37306228280067444
distance x is tensor(146.7673, device='cuda:0')
benign distance is  tensor(146.7673, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6417927742004395
distance x is tensor(142.0040, device='cuda:0')
benign distance is  tensor(142.0040, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3863348364830017
distance x is tensor(145.9768, device='cuda:0')
benign distance is  tensor(145.9768, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.27841252088546753
distance x is tensor(140.8141, device='cuda:0')
benign distance is  tensor(140.8141, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3129483163356781
distance x is tensor(144.4051, device='cuda:0')
benign distance is  tensor(144.4051, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([624.8311, 627.4003, 664.1019, 655.4105, 645.8327, 644.7858, 637.9464,
        647.1170, 947.2812, 932.2296, 962.0156, 951.4830, 985.2756, 955.4875,
        964.3536, 943.2158, 971.0400, 952.1874, 978.6563, 966.0045, 662.1959,
        704.2347, 703.4015, 716.5187, 670.3940, 685.1046, 697.5239, 669.7475],
       device='cuda:0')
sorted_norm is   tensor([624.8311, 627.4003, 637.9464, 644.7858, 645.8327, 647.1170, 655.4105,
        662.1959, 664.1019, 669.7475, 670.3940, 685.1046, 697.5239, 703.4015,
        704.2347, 716.5187, 932.2296, 943.2158, 947.2812, 951.4830, 952.1874,
        955.4875, 962.0156, 964.3536, 966.0045, 971.0400, 978.6563, 985.2756],
       device='cuda:0')
used idx is  tensor([ 0,  1,  6,  5,  4,  7,  3, 20,  2, 27, 24, 25, 26, 22, 21, 23,  9, 15,
         8, 11, 17, 13], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 72.82% 

Test Accuracy: 71.98% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.33187738060951233
distance x is tensor(133.5862, device='cuda:0')
benign distance is  tensor(133.5862, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.43393006920814514
distance x is tensor(130.0118, device='cuda:0')
benign distance is  tensor(130.0118, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23094868659973145
distance x is tensor(132.4780, device='cuda:0')
benign distance is  tensor(132.4780, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.36995160579681396
distance x is tensor(130.8038, device='cuda:0')
benign distance is  tensor(130.8038, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.32888755202293396
distance x is tensor(134.4215, device='cuda:0')
benign distance is  tensor(134.4215, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.732296347618103
distance x is tensor(132.8654, device='cuda:0')
benign distance is  tensor(132.8654, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3868444561958313
distance x is tensor(129.6528, device='cuda:0')
benign distance is  tensor(129.6528, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5460022687911987
distance x is tensor(138.0964, device='cuda:0')
benign distance is  tensor(138.0964, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6750116348266602
distance x is tensor(129.3197, device='cuda:0')
benign distance is  tensor(129.3197, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.31047114729881287
distance x is tensor(132.0055, device='cuda:0')
benign distance is  tensor(132.0055, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5139369368553162
distance x is tensor(135.2412, device='cuda:0')
benign distance is  tensor(135.2412, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2695414423942566
distance x is tensor(135.2773, device='cuda:0')
benign distance is  tensor(135.2773, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.37714990973472595
distance x is tensor(124.7203, device='cuda:0')
benign distance is  tensor(124.7203, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4760330319404602
distance x is tensor(133.9457, device='cuda:0')
benign distance is  tensor(133.9457, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3672625422477722
distance x is tensor(132.7220, device='cuda:0')
benign distance is  tensor(132.7220, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7295867800712585
distance x is tensor(122.8050, device='cuda:0')
benign distance is  tensor(122.8050, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 599.4976,  585.1691,  591.6584,  585.6166,  597.5776,  596.3508,
         581.5488,  613.9354, 1065.8303, 1066.1031, 1087.4388, 1075.1066,
        1103.6475, 1088.3960, 1083.8856, 1077.1188, 1101.1467, 1088.9001,
        1095.2025, 1097.4861,  616.0447,  568.1122,  602.3389,  593.4929,
         578.9583,  580.4608,  595.3790,  616.3687], device='cuda:0')
sorted_norm is   tensor([ 568.1122,  578.9583,  580.4608,  581.5488,  585.1691,  585.6166,
         591.6584,  593.4929,  595.3790,  596.3508,  597.5776,  599.4976,
         602.3389,  613.9354,  616.0447,  616.3687, 1065.8303, 1066.1031,
        1075.1066, 1077.1188, 1083.8856, 1087.4388, 1088.3960, 1088.9001,
        1095.2025, 1097.4861, 1101.1467, 1103.6475], device='cuda:0')
used idx is  tensor([21, 24, 25,  6,  1,  3,  2, 23, 26,  5,  4,  0, 22,  7, 20, 27,  8,  9,
        11, 15, 14, 10], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 78.77% 

Test Accuracy: 78.00% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.356736421585083
distance x is tensor(135.9023, device='cuda:0')
benign distance is  tensor(135.9023, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5685884952545166
distance x is tensor(132.6439, device='cuda:0')
benign distance is  tensor(132.6439, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4753681719303131
distance x is tensor(134.3608, device='cuda:0')
benign distance is  tensor(134.3608, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5372544527053833
distance x is tensor(131.1194, device='cuda:0')
benign distance is  tensor(131.1194, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4640558660030365
distance x is tensor(129.8425, device='cuda:0')
benign distance is  tensor(129.8425, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0427166223526
distance x is tensor(134.9815, device='cuda:0')
benign distance is  tensor(134.9815, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7235711812973022
distance x is tensor(134.6635, device='cuda:0')
benign distance is  tensor(134.6635, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4812704920768738
distance x is tensor(138.9563, device='cuda:0')
benign distance is  tensor(138.9563, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.48654595017433167
distance x is tensor(133.1187, device='cuda:0')
benign distance is  tensor(133.1187, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.29626619815826416
distance x is tensor(128.6173, device='cuda:0')
benign distance is  tensor(128.6173, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9240065813064575
distance x is tensor(134.8287, device='cuda:0')
benign distance is  tensor(134.8287, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5679492950439453
distance x is tensor(132.3918, device='cuda:0')
benign distance is  tensor(132.3918, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4210894703865051
distance x is tensor(124.0538, device='cuda:0')
benign distance is  tensor(124.0538, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5163257122039795
distance x is tensor(131.7753, device='cuda:0')
benign distance is  tensor(131.7753, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4907911419868469
distance x is tensor(129.6917, device='cuda:0')
benign distance is  tensor(129.6917, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3546143174171448
distance x is tensor(137.7203, device='cuda:0')
benign distance is  tensor(137.7203, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 610.8138,  586.1599,  600.4941,  588.3456,  592.7927,  608.2565,
         608.3177,  622.2524, 1077.3052, 1045.2941, 1071.5548, 1058.4017,
        1091.2881, 1081.7416, 1079.2477, 1056.4586, 1077.8365, 1077.8195,
        1077.0845, 1082.1199,  619.1210,  639.5084,  629.3145,  615.4156,
         620.0121,  619.8932,  654.6246,  637.9323], device='cuda:0')
sorted_norm is   tensor([ 586.1599,  588.3456,  592.7927,  600.4941,  608.2565,  608.3177,
         610.8138,  615.4156,  619.1210,  619.8932,  620.0121,  622.2524,
         629.3145,  637.9323,  639.5084,  654.6246, 1045.2941, 1056.4586,
        1058.4017, 1071.5548, 1077.0845, 1077.3052, 1077.8195, 1077.8365,
        1079.2477, 1081.7416, 1082.1199, 1091.2881], device='cuda:0')
used idx is  tensor([ 1,  3,  4,  2,  5,  6,  0, 23, 20, 25, 24,  7, 22, 27, 21, 26,  9, 15,
        11, 10, 18,  8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 78.48% 

Test Accuracy: 77.76% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8086106181144714
distance x is tensor(137.9028, device='cuda:0')
benign distance is  tensor(137.9028, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.37235158681869507
distance x is tensor(135.8606, device='cuda:0')
benign distance is  tensor(135.8606, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5319632887840271
distance x is tensor(133.5743, device='cuda:0')
benign distance is  tensor(133.5743, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5297762751579285
distance x is tensor(136.8180, device='cuda:0')
benign distance is  tensor(136.8180, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5873828530311584
distance x is tensor(129.4340, device='cuda:0')
benign distance is  tensor(129.4340, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.598450779914856
distance x is tensor(137.1918, device='cuda:0')
benign distance is  tensor(137.1918, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24977877736091614
distance x is tensor(128.7690, device='cuda:0')
benign distance is  tensor(128.7690, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.41346439719200134
distance x is tensor(137.9937, device='cuda:0')
benign distance is  tensor(137.9937, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3568011522293091
distance x is tensor(134.3030, device='cuda:0')
benign distance is  tensor(134.3030, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.4924941062927246
distance x is tensor(131.2240, device='cuda:0')
benign distance is  tensor(131.2240, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7377836108207703
distance x is tensor(131.9653, device='cuda:0')
benign distance is  tensor(131.9653, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.43792882561683655
distance x is tensor(136.3143, device='cuda:0')
benign distance is  tensor(136.3143, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6694885492324829
distance x is tensor(131.9973, device='cuda:0')
benign distance is  tensor(131.9973, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.18758456408977509
distance x is tensor(137.7235, device='cuda:0')
benign distance is  tensor(137.7235, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5428323149681091
distance x is tensor(142.1751, device='cuda:0')
benign distance is  tensor(142.1751, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2829896807670593
distance x is tensor(133.2626, device='cuda:0')
benign distance is  tensor(133.2626, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 617.2770,  605.8795,  604.5458,  603.8598,  582.3979,  619.1494,
         575.2281,  620.4247, 1064.8162, 1068.4432, 1093.4485, 1092.3837,
        1122.6742, 1103.3096, 1090.5839, 1074.5616, 1095.8448, 1087.1840,
        1103.8973, 1101.7203,  605.5530,  626.7543,  589.1014,  625.2705,
         612.5303,  628.8361,  603.0066,  605.8336,  608.7237,  598.6901,
         598.7334,  598.5652,  578.8857,  592.8391,  581.3647,  583.9880,
         598.8654,  602.6841,  618.4615,  628.8301,  585.1974,  621.9800,
         610.2097,  577.4112,  612.7704,  589.3906,  612.1388,  607.0764,
         583.2750,  607.4545,  596.9985,  626.4934], device='cuda:0')
sorted_norm is   tensor([ 575.2281,  577.4112,  578.8857,  581.3647,  582.3979,  583.2750,
         583.9880,  585.1974,  589.1014,  589.3906,  592.8391,  596.9985,
         598.5652,  598.6901,  598.7334,  598.8654,  602.6841,  603.0066,
         603.8598,  604.5458,  605.5530,  605.8336,  605.8795,  607.0764,
         607.4545,  608.7237,  610.2097,  612.1388,  612.5303,  612.7704,
         617.2770,  618.4615,  619.1494,  620.4247,  621.9800,  625.2705,
         626.4934,  626.7543,  628.8301,  628.8361, 1064.8162, 1068.4432,
        1074.5616, 1087.1840, 1090.5839, 1092.3837, 1093.4485, 1095.8448,
        1101.7203, 1103.3096, 1103.8973, 1122.6742], device='cuda:0')
used idx is  tensor([ 6, 43, 32, 34,  4, 48, 35, 40, 22, 45, 33, 50, 31, 29, 30, 36, 37, 26,
         3,  2, 20, 27,  1, 47, 49, 28, 42, 46, 24, 44,  0, 38,  5,  7, 41, 23,
        51, 21, 39, 25,  8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 84.04% 

Test Accuracy: 83.51% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8983294367790222
distance x is tensor(105.1362, device='cuda:0')
benign distance is  tensor(105.1362, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6614362001419067
distance x is tensor(100.7566, device='cuda:0')
benign distance is  tensor(100.7566, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0946120172739029
distance x is tensor(99.3436, device='cuda:0')
benign distance is  tensor(99.3436, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.35897037386894226
distance x is tensor(100.2515, device='cuda:0')
benign distance is  tensor(100.2515, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5282043814659119
distance x is tensor(99.0885, device='cuda:0')
benign distance is  tensor(99.0885, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4044213891029358
distance x is tensor(108.5737, device='cuda:0')
benign distance is  tensor(108.5737, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23223230242729187
distance x is tensor(103.9650, device='cuda:0')
benign distance is  tensor(103.9650, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5885385274887085
distance x is tensor(114.3480, device='cuda:0')
benign distance is  tensor(114.3480, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5178009867668152
distance x is tensor(105.4116, device='cuda:0')
benign distance is  tensor(105.4116, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3216918408870697
distance x is tensor(97.3195, device='cuda:0')
benign distance is  tensor(97.3195, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6545466184616089
distance x is tensor(98.0611, device='cuda:0')
benign distance is  tensor(98.0611, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5207067131996155
distance x is tensor(102.7002, device='cuda:0')
benign distance is  tensor(102.7002, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4396215081214905
distance x is tensor(99.9018, device='cuda:0')
benign distance is  tensor(99.9018, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.300538569688797
distance x is tensor(100.0711, device='cuda:0')
benign distance is  tensor(100.0711, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.44581133127212524
distance x is tensor(101.2342, device='cuda:0')
benign distance is  tensor(101.2342, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7681605219841003
distance x is tensor(104.6531, device='cuda:0')
benign distance is  tensor(104.6531, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5244353413581848
distance x is tensor(99.9317, device='cuda:0')
benign distance is  tensor(99.9317, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9577562212944031
distance x is tensor(107.4914, device='cuda:0')
benign distance is  tensor(107.4914, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7053772211074829
distance x is tensor(110.9336, device='cuda:0')
benign distance is  tensor(110.9336, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.30818161368370056
distance x is tensor(102.4848, device='cuda:0')
benign distance is  tensor(102.4848, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5403028726577759
distance x is tensor(98.0801, device='cuda:0')
benign distance is  tensor(98.0801, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4429346024990082
distance x is tensor(99.6137, device='cuda:0')
benign distance is  tensor(99.6137, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.44806694984436035
distance x is tensor(108.2637, device='cuda:0')
benign distance is  tensor(108.2637, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5719367265701294
distance x is tensor(97.1862, device='cuda:0')
benign distance is  tensor(97.1862, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.17057524621486664
distance x is tensor(112.9931, device='cuda:0')
benign distance is  tensor(112.9931, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3622758984565735
distance x is tensor(98.5354, device='cuda:0')
benign distance is  tensor(98.5354, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3050723075866699
distance x is tensor(100.9342, device='cuda:0')
benign distance is  tensor(100.9342, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3603251576423645
distance x is tensor(106.1607, device='cuda:0')
benign distance is  tensor(106.1607, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6415421366691589
distance x is tensor(99.3929, device='cuda:0')
benign distance is  tensor(99.3929, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3464471399784088
distance x is tensor(103.9190, device='cuda:0')
benign distance is  tensor(103.9190, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3225184977054596
distance x is tensor(106.9450, device='cuda:0')
benign distance is  tensor(106.9450, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.18922856450080872
distance x is tensor(100.5481, device='cuda:0')
benign distance is  tensor(100.5481, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3386014401912689
distance x is tensor(96.6124, device='cuda:0')
benign distance is  tensor(96.6124, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.9086100459098816
distance x is tensor(107.2298, device='cuda:0')
benign distance is  tensor(107.2298, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.33364924788475037
distance x is tensor(97.3928, device='cuda:0')
benign distance is  tensor(97.3928, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.25613006949424744
distance x is tensor(104.3939, device='cuda:0')
benign distance is  tensor(104.3939, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4118162989616394
distance x is tensor(97.3084, device='cuda:0')
benign distance is  tensor(97.3084, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5258549451828003
distance x is tensor(103.8559, device='cuda:0')
benign distance is  tensor(103.8559, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6404980421066284
distance x is tensor(102.7015, device='cuda:0')
benign distance is  tensor(102.7015, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.44986796379089355
distance x is tensor(102.6399, device='cuda:0')
benign distance is  tensor(102.6399, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 494.7516,  465.3426,  461.5052,  462.2090,  467.3643,  505.6042,
         481.6982,  515.2328, 1453.5621, 1449.2539, 1482.2435, 1453.3391,
        1480.4329, 1488.4071, 1462.6959, 1464.6874, 1466.5162, 1460.6818,
        1495.3618, 1480.1816], device='cuda:0')
sorted_norm is   tensor([ 461.5052,  462.2090,  465.3426,  467.3643,  481.6982,  494.7516,
         505.6042,  515.2328, 1449.2539, 1453.3391, 1453.5621, 1460.6818,
        1462.6959, 1464.6874, 1466.5162, 1480.1816, 1480.4329, 1482.2435,
        1488.4071, 1495.3618], device='cuda:0')
used idx is  tensor([ 2,  3,  1,  4,  6,  0,  5,  7,  9, 11,  8, 17, 14, 15, 16, 19],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.096681833267212
distance x is tensor(65.7452, device='cuda:0')
benign distance is  tensor(65.7452, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.036548137664795
distance x is tensor(64.3341, device='cuda:0')
benign distance is  tensor(64.3341, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2636439800262451
distance x is tensor(71.8977, device='cuda:0')
benign distance is  tensor(71.8977, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2714412212371826
distance x is tensor(69.3252, device='cuda:0')
benign distance is  tensor(69.3252, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9742895364761353
distance x is tensor(66.7696, device='cuda:0')
benign distance is  tensor(66.7696, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.052964448928833
distance x is tensor(61.4995, device='cuda:0')
benign distance is  tensor(61.4995, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9730215072631836
distance x is tensor(61.6278, device='cuda:0')
benign distance is  tensor(61.6278, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3020317554473877
distance x is tensor(68.6474, device='cuda:0')
benign distance is  tensor(68.6474, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([461.6842, 464.4236, 513.8025, 495.5878, 485.2428, 452.9492, 460.0809,
        497.0760, 532.1965, 520.3314, 495.4106, 581.1115, 523.8922, 568.4460,
        595.9722, 586.6982, 561.9165, 571.2373, 573.7457, 568.4438, 908.5305,
        878.0948, 884.9197, 900.0291, 891.0965, 887.8940, 898.0273, 902.1472],
       device='cuda:0')
sorted_norm is   tensor([452.9492, 460.0809, 461.6842, 464.4236, 485.2428, 495.4106, 495.5878,
        497.0760, 513.8025, 520.3314, 523.8922, 532.1965, 561.9165, 568.4438,
        568.4460, 571.2373, 573.7457, 581.1115, 586.6982, 595.9722, 878.0948,
        884.9197, 887.8940, 891.0965, 898.0273, 900.0291, 902.1472, 908.5305],
       device='cuda:0')
used idx is  tensor([ 5,  6,  0,  1,  4, 10,  3,  7,  2,  9, 12,  8, 16, 19, 13, 17, 18, 11,
        15, 14, 21, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5292205214500427
distance x is tensor(146.3227, device='cuda:0')
benign distance is  tensor(146.3227, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4152771532535553
distance x is tensor(143.2880, device='cuda:0')
benign distance is  tensor(143.2880, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4313589930534363
distance x is tensor(138.5994, device='cuda:0')
benign distance is  tensor(138.5994, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5120088458061218
distance x is tensor(138.5743, device='cuda:0')
benign distance is  tensor(138.5743, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.42129993438720703
distance x is tensor(143.8856, device='cuda:0')
benign distance is  tensor(143.8856, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.33052191138267517
distance x is tensor(136.1598, device='cuda:0')
benign distance is  tensor(136.1598, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.33400657773017883
distance x is tensor(134.3428, device='cuda:0')
benign distance is  tensor(134.3428, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5720580816268921
distance x is tensor(139.9281, device='cuda:0')
benign distance is  tensor(139.9281, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4284236431121826
distance x is tensor(143.9650, device='cuda:0')
benign distance is  tensor(143.9650, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3344568610191345
distance x is tensor(133.7573, device='cuda:0')
benign distance is  tensor(133.7573, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7141069769859314
distance x is tensor(150.7294, device='cuda:0')
benign distance is  tensor(150.7294, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3228476345539093
distance x is tensor(141.5277, device='cuda:0')
benign distance is  tensor(141.5277, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.41143983602523804
distance x is tensor(129.6318, device='cuda:0')
benign distance is  tensor(129.6318, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6776715517044067
distance x is tensor(133.6867, device='cuda:0')
benign distance is  tensor(133.6867, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4689517617225647
distance x is tensor(136.4669, device='cuda:0')
benign distance is  tensor(136.4669, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.44933176040649414
distance x is tensor(139.5610, device='cuda:0')
benign distance is  tensor(139.5610, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([765.9072, 728.1961, 733.1531, 736.5483, 763.0372, 732.6542, 709.3770,
        738.2761, 836.7230, 847.0934, 824.5336, 862.7612, 844.1866, 832.0775,
        865.7897, 843.0886, 845.2988, 891.7601, 800.9643, 859.7930, 827.9916,
        862.9462, 858.6066, 857.4512, 833.5734, 834.5448, 861.4000, 834.2228],
       device='cuda:0')
sorted_norm is   tensor([709.3770, 728.1961, 732.6542, 733.1531, 736.5483, 738.2761, 763.0372,
        765.9072, 800.9643, 824.5336, 827.9916, 832.0775, 833.5734, 834.2228,
        834.5448, 836.7230, 843.0886, 844.1866, 845.2988, 847.0934, 857.4512,
        858.6066, 859.7930, 861.4000, 862.7612, 862.9462, 865.7897, 891.7601],
       device='cuda:0')
used idx is  tensor([ 6,  1,  5,  2,  3,  7,  4,  0, 18, 10, 20, 13, 24, 27, 25,  8, 15, 12,
        16,  9, 23, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 19.65% 

Test Accuracy: 19.88% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5410556197166443
distance x is tensor(145.8791, device='cuda:0')
benign distance is  tensor(145.8791, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45838671922683716
distance x is tensor(145.0357, device='cuda:0')
benign distance is  tensor(145.0357, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5734724402427673
distance x is tensor(147.1360, device='cuda:0')
benign distance is  tensor(147.1360, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6105044484138489
distance x is tensor(145.4102, device='cuda:0')
benign distance is  tensor(145.4102, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5682355165481567
distance x is tensor(143.6510, device='cuda:0')
benign distance is  tensor(143.6510, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5427477955818176
distance x is tensor(145.8476, device='cuda:0')
benign distance is  tensor(145.8476, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26842397451400757
distance x is tensor(141.7496, device='cuda:0')
benign distance is  tensor(141.7496, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.38634181022644043
distance x is tensor(149.0612, device='cuda:0')
benign distance is  tensor(149.0612, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6887348890304565
distance x is tensor(140.7805, device='cuda:0')
benign distance is  tensor(140.7805, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.43462005257606506
distance x is tensor(143.0461, device='cuda:0')
benign distance is  tensor(143.0461, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.34496158361434937
distance x is tensor(150.4560, device='cuda:0')
benign distance is  tensor(150.4560, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.41535648703575134
distance x is tensor(148.5079, device='cuda:0')
benign distance is  tensor(148.5079, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.40334707498550415
distance x is tensor(140.2133, device='cuda:0')
benign distance is  tensor(140.2133, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.26971855759620667
distance x is tensor(142.1469, device='cuda:0')
benign distance is  tensor(142.1469, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4096532464027405
distance x is tensor(148.3019, device='cuda:0')
benign distance is  tensor(148.3019, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.33309710025787354
distance x is tensor(138.7598, device='cuda:0')
benign distance is  tensor(138.7598, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 647.1765,  632.8531,  651.3544,  637.1074,  631.9296,  645.8711,
         633.2283,  652.4841,  980.4357,  971.9340, 1006.2211,  979.3823,
        1001.6633,  998.9719,  992.9085,  965.4404, 1009.4656,  976.1337,
         993.9382, 1008.7419,  681.0204,  687.0475,  676.3546,  690.9189,
         676.0184,  703.6610,  699.8809,  673.9780,  770.1348,  714.6091,
         720.6509,  730.2903,  713.6243,  731.9078,  743.6454,  708.7762,
         756.1627,  747.7584,  810.6544,  756.2418,  760.5898,  740.1968,
         740.5622,  750.0024], device='cuda:0')
sorted_norm is   tensor([ 631.9296,  632.8531,  633.2283,  637.1074,  645.8711,  647.1765,
         651.3544,  652.4841,  673.9780,  676.0184,  676.3546,  681.0204,
         687.0475,  690.9189,  699.8809,  703.6610,  708.7762,  713.6243,
         714.6091,  720.6509,  730.2903,  731.9078,  740.1968,  740.5622,
         743.6454,  747.7584,  750.0024,  756.1627,  756.2418,  760.5898,
         770.1348,  810.6544,  965.4404,  971.9340,  976.1337,  979.3823,
         980.4357,  992.9085,  993.9382,  998.9719, 1001.6633, 1006.2211,
        1008.7419, 1009.4656], device='cuda:0')
used idx is  tensor([ 4,  1,  6,  3,  5,  0,  2,  7, 27, 24, 22, 20, 21, 23, 26, 25, 35, 32,
        29, 30, 31, 33, 41, 42, 34, 37, 43, 36, 39, 40, 28, 38, 15,  9, 17],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 82.67% 

Test Accuracy: 82.00% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4600791335105896
distance x is tensor(117.4928, device='cuda:0')
benign distance is  tensor(117.4928, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2670230269432068
distance x is tensor(116.5588, device='cuda:0')
benign distance is  tensor(116.5588, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25039973855018616
distance x is tensor(113.8504, device='cuda:0')
benign distance is  tensor(113.8504, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2893686890602112
distance x is tensor(115.2316, device='cuda:0')
benign distance is  tensor(115.2316, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8405728340148926
distance x is tensor(116.2486, device='cuda:0')
benign distance is  tensor(116.2486, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.34526965022087097
distance x is tensor(119.6104, device='cuda:0')
benign distance is  tensor(119.6104, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3742680251598358
distance x is tensor(111.1940, device='cuda:0')
benign distance is  tensor(111.1940, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3742613196372986
distance x is tensor(116.2947, device='cuda:0')
benign distance is  tensor(116.2947, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.537024736404419
distance x is tensor(113.8523, device='cuda:0')
benign distance is  tensor(113.8523, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.41245952248573303
distance x is tensor(112.7962, device='cuda:0')
benign distance is  tensor(112.7962, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6761878132820129
distance x is tensor(112.0667, device='cuda:0')
benign distance is  tensor(112.0667, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.24620512127876282
distance x is tensor(114.9242, device='cuda:0')
benign distance is  tensor(114.9242, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.49130550026893616
distance x is tensor(114.0248, device='cuda:0')
benign distance is  tensor(114.0248, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2804079055786133
distance x is tensor(113.0258, device='cuda:0')
benign distance is  tensor(113.0258, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.39877668023109436
distance x is tensor(113.2375, device='cuda:0')
benign distance is  tensor(113.2375, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.26456236839294434
distance x is tensor(118.1007, device='cuda:0')
benign distance is  tensor(118.1007, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.15185905992984772
distance x is tensor(124.1752, device='cuda:0')
benign distance is  tensor(124.1752, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.39876788854599
distance x is tensor(112.7228, device='cuda:0')
benign distance is  tensor(112.7228, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3861238956451416
distance x is tensor(116.6506, device='cuda:0')
benign distance is  tensor(116.6506, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.37987327575683594
distance x is tensor(119.0801, device='cuda:0')
benign distance is  tensor(119.0801, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.29578226804733276
distance x is tensor(115.4308, device='cuda:0')
benign distance is  tensor(115.4308, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4337645173072815
distance x is tensor(117.7837, device='cuda:0')
benign distance is  tensor(117.7837, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.13830195367336273
distance x is tensor(116.8477, device='cuda:0')
benign distance is  tensor(116.8477, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.158755362033844
distance x is tensor(108.9431, device='cuda:0')
benign distance is  tensor(108.9431, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.39125803112983704
distance x is tensor(116.1104, device='cuda:0')
benign distance is  tensor(116.1104, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.10062198340892792
distance x is tensor(115.1936, device='cuda:0')
benign distance is  tensor(115.1936, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.611240804195404
distance x is tensor(119.0650, device='cuda:0')
benign distance is  tensor(119.0650, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.4989703595638275
distance x is tensor(114.7062, device='cuda:0')
benign distance is  tensor(114.7062, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3753792345523834
distance x is tensor(111.0699, device='cuda:0')
benign distance is  tensor(111.0699, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7314669489860535
distance x is tensor(121.1540, device='cuda:0')
benign distance is  tensor(121.1540, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2518538534641266
distance x is tensor(116.4809, device='cuda:0')
benign distance is  tensor(116.4809, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.25762051343917847
distance x is tensor(113.8418, device='cuda:0')
benign distance is  tensor(113.8418, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 538.6434,  528.6210,  523.6407,  534.4381,  533.3750,  556.8682,
         506.3660,  531.6779, 1270.1251, 1271.5614, 1298.8386, 1288.1332,
        1309.9565, 1307.8855, 1302.5465, 1282.6858, 1300.5673, 1284.3864,
        1302.7299, 1302.5194], device='cuda:0')
sorted_norm is   tensor([ 506.3660,  523.6407,  528.6210,  531.6779,  533.3750,  534.4381,
         538.6434,  556.8682, 1270.1251, 1271.5614, 1282.6858, 1284.3864,
        1288.1332, 1298.8386, 1300.5673, 1302.5194, 1302.5465, 1302.7299,
        1307.8855, 1309.9565], device='cuda:0')
used idx is  tensor([ 6,  2,  1,  7,  4,  3,  0,  5,  8,  9, 15, 17, 11, 10, 16, 19],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.295255422592163
distance x is tensor(0.7816, device='cuda:0')
benign distance is  tensor(0.7816, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.304854154586792
distance x is tensor(0.8496, device='cuda:0')
benign distance is  tensor(0.8496, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.307058334350586
distance x is tensor(0.9140, device='cuda:0')
benign distance is  tensor(0.9140, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2927870750427246
distance x is tensor(0.8103, device='cuda:0')
benign distance is  tensor(0.8103, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3105978965759277
distance x is tensor(0.9731, device='cuda:0')
benign distance is  tensor(0.9731, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.311196804046631
distance x is tensor(0.8954, device='cuda:0')
benign distance is  tensor(0.8954, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2953407764434814
distance x is tensor(0.8120, device='cuda:0')
benign distance is  tensor(0.8120, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2960948944091797
distance x is tensor(0.9988, device='cuda:0')
benign distance is  tensor(0.9988, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 23.0559,  27.6071,  30.9388,  26.5167,  29.5504,  22.8701,  22.2099,
         28.3699, 232.1387, 230.3699, 229.3051, 230.1407, 229.8458, 229.5232,
        228.4314, 230.0268, 228.8219, 229.5687, 231.9663, 229.8390, 872.4304,
        905.6000, 876.9592, 906.6915, 886.8104, 898.1874, 895.9537, 899.0100,
        794.7063, 803.6632, 827.7354, 829.6742, 802.0634, 803.8930, 811.6562,
        799.1412, 870.6460, 860.4115, 854.1755, 868.5295, 866.3152, 857.1206,
        859.4828, 879.0798], device='cuda:0')
sorted_norm is   tensor([ 22.2099,  22.8701,  23.0559,  26.5167,  27.6071,  28.3699,  29.5504,
         30.9388, 228.4314, 228.8219, 229.3051, 229.5232, 229.5687, 229.8390,
        229.8458, 230.0268, 230.1407, 230.3699, 231.9663, 232.1387, 794.7063,
        799.1412, 802.0634, 803.6632, 803.8930, 811.6562, 827.7354, 829.6742,
        854.1755, 857.1206, 859.4828, 860.4115, 866.3152, 868.5295, 870.6460,
        872.4304, 876.9592, 879.0798, 886.8104, 895.9537, 898.1874, 899.0100,
        905.6000, 906.6915], device='cuda:0')
used idx is  tensor([ 6,  5,  0,  3,  1,  7,  4,  2, 14, 16, 10, 13, 17, 19, 12, 15, 11,  9,
        18,  8, 28, 35, 32, 29, 33, 34, 30, 31, 38, 41, 42, 37, 40, 39, 36],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 70.76% 

Test Accuracy: 70.20% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6045870780944824
distance x is tensor(133.9536, device='cuda:0')
benign distance is  tensor(133.9536, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3054273724555969
distance x is tensor(133.9093, device='cuda:0')
benign distance is  tensor(133.9093, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16038855910301208
distance x is tensor(136.4580, device='cuda:0')
benign distance is  tensor(136.4580, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39054518938064575
distance x is tensor(133.7589, device='cuda:0')
benign distance is  tensor(133.7589, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.27893951535224915
distance x is tensor(134.0971, device='cuda:0')
benign distance is  tensor(134.0971, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3657894432544708
distance x is tensor(137.8839, device='cuda:0')
benign distance is  tensor(137.8839, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5790390968322754
distance x is tensor(138.3658, device='cuda:0')
benign distance is  tensor(138.3658, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.48791512846946716
distance x is tensor(138.7658, device='cuda:0')
benign distance is  tensor(138.7658, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.35082918405532837
distance x is tensor(140.3292, device='cuda:0')
benign distance is  tensor(140.3292, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.305972695350647
distance x is tensor(128.1413, device='cuda:0')
benign distance is  tensor(128.1413, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1017751693725586
distance x is tensor(136.8231, device='cuda:0')
benign distance is  tensor(136.8231, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6157468557357788
distance x is tensor(138.8208, device='cuda:0')
benign distance is  tensor(138.8208, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3366338610649109
distance x is tensor(132.4954, device='cuda:0')
benign distance is  tensor(132.4954, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.345642626285553
distance x is tensor(134.7065, device='cuda:0')
benign distance is  tensor(134.7065, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4763101041316986
distance x is tensor(131.4504, device='cuda:0')
benign distance is  tensor(131.4504, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7490438222885132
distance x is tensor(139.3087, device='cuda:0')
benign distance is  tensor(139.3087, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6189123392105103
distance x is tensor(132.6864, device='cuda:0')
benign distance is  tensor(132.6864, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5587233901023865
distance x is tensor(138.8928, device='cuda:0')
benign distance is  tensor(138.8928, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2613033950328827
distance x is tensor(142.2957, device='cuda:0')
benign distance is  tensor(142.2957, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.48265233635902405
distance x is tensor(139.5087, device='cuda:0')
benign distance is  tensor(139.5087, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2846764922142029
distance x is tensor(124.8423, device='cuda:0')
benign distance is  tensor(124.8423, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3955644369125366
distance x is tensor(133.1548, device='cuda:0')
benign distance is  tensor(133.1548, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4435575604438782
distance x is tensor(141.3501, device='cuda:0')
benign distance is  tensor(141.3501, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.596288800239563
distance x is tensor(131.2878, device='cuda:0')
benign distance is  tensor(131.2878, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.32517123222351074
distance x is tensor(132.2060, device='cuda:0')
benign distance is  tensor(132.2060, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.21395564079284668
distance x is tensor(142.2877, device='cuda:0')
benign distance is  tensor(142.2877, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.18185612559318542
distance x is tensor(133.8030, device='cuda:0')
benign distance is  tensor(133.8030, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4459775388240814
distance x is tensor(134.2572, device='cuda:0')
benign distance is  tensor(134.2572, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.30032238364219666
distance x is tensor(135.1498, device='cuda:0')
benign distance is  tensor(135.1498, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.2224128544330597
distance x is tensor(135.3561, device='cuda:0')
benign distance is  tensor(135.3561, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.49992114305496216
distance x is tensor(138.8339, device='cuda:0')
benign distance is  tensor(138.8339, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.31140801310539246
distance x is tensor(136.3723, device='cuda:0')
benign distance is  tensor(136.3723, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 604.2795,  591.5287,  609.6909,  600.7916,  602.4394,  628.0727,
         617.0878,  620.2275, 1055.1927, 1051.8076, 1067.6967, 1053.5715,
        1078.8363, 1068.6538, 1072.1044, 1061.1006, 1068.2778, 1077.5194,
        1072.5674, 1073.8589], device='cuda:0')
sorted_norm is   tensor([ 591.5287,  600.7916,  602.4394,  604.2795,  609.6909,  617.0878,
         620.2275,  628.0727, 1051.8076, 1053.5715, 1055.1927, 1061.1006,
        1067.6967, 1068.2778, 1068.6538, 1072.1044, 1072.5674, 1073.8589,
        1077.5194, 1078.8363], device='cuda:0')
used idx is  tensor([ 1,  3,  4,  0,  2,  6,  7,  5,  9, 11,  8, 15, 10, 16, 13, 14],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.800454318523407
distance x is tensor(93.8739, device='cuda:0')
benign distance is  tensor(93.8739, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.867444634437561
distance x is tensor(89.6708, device='cuda:0')
benign distance is  tensor(89.6708, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1558758020401
distance x is tensor(96.2568, device='cuda:0')
benign distance is  tensor(96.2568, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0372776985168457
distance x is tensor(88.1491, device='cuda:0')
benign distance is  tensor(88.1491, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.993199348449707
distance x is tensor(102.2561, device='cuda:0')
benign distance is  tensor(102.2561, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8070905804634094
distance x is tensor(82.6132, device='cuda:0')
benign distance is  tensor(82.6132, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0457667112350464
distance x is tensor(83.1108, device='cuda:0')
benign distance is  tensor(83.1108, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8603998422622681
distance x is tensor(89.1066, device='cuda:0')
benign distance is  tensor(89.1066, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([602.5257, 592.1865, 629.0243, 594.2637, 637.9174, 573.4306, 565.9552,
        587.4968, 663.4321, 698.5732, 679.7560, 667.9053, 673.8802, 634.7914,
        663.9114, 693.4320, 671.5462, 663.2545, 674.6257, 641.2646, 895.1495,
        859.5262, 878.5597, 880.2132, 869.5070, 872.8339, 867.3117, 849.0226,
        843.5579, 801.7791, 821.3150, 833.1617, 823.7010, 820.8965, 813.9626,
        845.2074], device='cuda:0')
sorted_norm is   tensor([565.9552, 573.4306, 587.4968, 592.1865, 594.2637, 602.5257, 629.0243,
        634.7914, 637.9174, 641.2646, 663.2545, 663.4321, 663.9114, 667.9053,
        671.5462, 673.8802, 674.6257, 679.7560, 693.4320, 698.5732, 801.7791,
        813.9626, 820.8965, 821.3150, 823.7010, 833.1617, 843.5579, 845.2074,
        849.0226, 859.5262, 867.3117, 869.5070, 872.8339, 878.5597, 880.2132,
        895.1495], device='cuda:0')
used idx is  tensor([ 6,  5,  7,  1,  3,  0,  2, 13,  4, 19, 17,  8, 14, 11, 16, 12, 18, 10,
        15,  9, 29, 34, 33, 30, 32, 31, 28, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 50.15% 

Test Accuracy: 49.84% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5718604326248169
distance x is tensor(140.4341, device='cuda:0')
benign distance is  tensor(140.4341, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.445138543844223
distance x is tensor(137.3688, device='cuda:0')
benign distance is  tensor(137.3688, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.39567044377326965
distance x is tensor(143.7887, device='cuda:0')
benign distance is  tensor(143.7887, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4273560047149658
distance x is tensor(143.4207, device='cuda:0')
benign distance is  tensor(143.4207, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5391533374786377
distance x is tensor(145.3846, device='cuda:0')
benign distance is  tensor(145.3846, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4554429054260254
distance x is tensor(143.8336, device='cuda:0')
benign distance is  tensor(143.8336, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3506673276424408
distance x is tensor(143.4953, device='cuda:0')
benign distance is  tensor(143.4953, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5443919897079468
distance x is tensor(144.7980, device='cuda:0')
benign distance is  tensor(144.7980, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3952120244503021
distance x is tensor(146.0543, device='cuda:0')
benign distance is  tensor(146.0543, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4577217698097229
distance x is tensor(142.1648, device='cuda:0')
benign distance is  tensor(142.1648, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8664001226425171
distance x is tensor(145.6304, device='cuda:0')
benign distance is  tensor(145.6304, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6078571677207947
distance x is tensor(145.1883, device='cuda:0')
benign distance is  tensor(145.1883, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2341630756855011
distance x is tensor(136.0939, device='cuda:0')
benign distance is  tensor(136.0939, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.31456148624420166
distance x is tensor(145.6736, device='cuda:0')
benign distance is  tensor(145.6736, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.30735155940055847
distance x is tensor(143.7726, device='cuda:0')
benign distance is  tensor(143.7726, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5543444156646729
distance x is tensor(145.1987, device='cuda:0')
benign distance is  tensor(145.1987, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3120865225791931
distance x is tensor(145.1053, device='cuda:0')
benign distance is  tensor(145.1053, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6279061436653137
distance x is tensor(140.6359, device='cuda:0')
benign distance is  tensor(140.6359, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.48660725355148315
distance x is tensor(147.0722, device='cuda:0')
benign distance is  tensor(147.0722, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2805289626121521
distance x is tensor(141.6567, device='cuda:0')
benign distance is  tensor(141.6567, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8384898900985718
distance x is tensor(141.1144, device='cuda:0')
benign distance is  tensor(141.1144, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5825544595718384
distance x is tensor(150.1904, device='cuda:0')
benign distance is  tensor(150.1904, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4013814330101013
distance x is tensor(142.1560, device='cuda:0')
benign distance is  tensor(142.1560, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.41877827048301697
distance x is tensor(143.8404, device='cuda:0')
benign distance is  tensor(143.8404, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([644.5534, 615.7691, 654.0216, 656.3628, 657.9968, 653.1750, 651.2393,
        651.7211, 948.9174, 940.1439, 945.5526, 945.8602, 978.6157, 971.5416,
        948.4300, 946.3440, 950.3040, 972.8204, 967.8652, 962.8481, 729.0562,
        733.8106, 737.6868, 717.7490, 712.5227, 747.6270, 730.6253, 721.1973,
        679.8602, 694.3398, 702.4091, 701.8895, 658.6489, 679.1713, 699.0056,
        666.7746], device='cuda:0')
sorted_norm is   tensor([615.7691, 644.5534, 651.2393, 651.7211, 653.1750, 654.0216, 656.3628,
        657.9968, 658.6489, 666.7746, 679.1713, 679.8602, 694.3398, 699.0056,
        701.8895, 702.4091, 712.5227, 717.7490, 721.1973, 729.0562, 730.6253,
        733.8106, 737.6868, 747.6270, 940.1439, 945.5526, 945.8602, 946.3440,
        948.4300, 948.9174, 950.3040, 962.8481, 967.8652, 971.5416, 972.8204,
        978.6157], device='cuda:0')
used idx is  tensor([ 1,  0,  6,  7,  5,  2,  3,  4, 32, 35, 33, 28, 29, 34, 31, 30, 24, 23,
        27, 20, 26, 21, 22, 25,  9, 10, 11, 15], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 84.74% 

Test Accuracy: 83.62% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7432072758674622
distance x is tensor(116.0766, device='cuda:0')
benign distance is  tensor(116.0766, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.38440564274787903
distance x is tensor(121.1827, device='cuda:0')
benign distance is  tensor(121.1827, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.28548330068588257
distance x is tensor(112.9091, device='cuda:0')
benign distance is  tensor(112.9091, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.33748698234558105
distance x is tensor(118.1163, device='cuda:0')
benign distance is  tensor(118.1163, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6857601404190063
distance x is tensor(112.3043, device='cuda:0')
benign distance is  tensor(112.3043, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8586515188217163
distance x is tensor(120.4387, device='cuda:0')
benign distance is  tensor(120.4387, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23708085715770721
distance x is tensor(115.3855, device='cuda:0')
benign distance is  tensor(115.3855, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4232824742794037
distance x is tensor(115.1902, device='cuda:0')
benign distance is  tensor(115.1902, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.44912877678871155
distance x is tensor(107.7481, device='cuda:0')
benign distance is  tensor(107.7481, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8636065721511841
distance x is tensor(117.1655, device='cuda:0')
benign distance is  tensor(117.1655, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6984959840774536
distance x is tensor(119.5080, device='cuda:0')
benign distance is  tensor(119.5080, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2718748450279236
distance x is tensor(113.1079, device='cuda:0')
benign distance is  tensor(113.1079, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2832338213920593
distance x is tensor(105.5204, device='cuda:0')
benign distance is  tensor(105.5204, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.20892664790153503
distance x is tensor(109.3920, device='cuda:0')
benign distance is  tensor(109.3920, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.1480134129524231
distance x is tensor(116.7669, device='cuda:0')
benign distance is  tensor(116.7669, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.36028164625167847
distance x is tensor(111.5300, device='cuda:0')
benign distance is  tensor(111.5300, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.39725324511528015
distance x is tensor(120.6853, device='cuda:0')
benign distance is  tensor(120.6853, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.12836328148841858
distance x is tensor(120.5638, device='cuda:0')
benign distance is  tensor(120.5638, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5540348291397095
distance x is tensor(120.8088, device='cuda:0')
benign distance is  tensor(120.8088, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.8010985255241394
distance x is tensor(111.2296, device='cuda:0')
benign distance is  tensor(111.2296, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5442841649055481
distance x is tensor(120.6716, device='cuda:0')
benign distance is  tensor(120.6716, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5176495313644409
distance x is tensor(113.8935, device='cuda:0')
benign distance is  tensor(113.8935, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.32996851205825806
distance x is tensor(115.9776, device='cuda:0')
benign distance is  tensor(115.9776, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.33747562766075134
distance x is tensor(114.7838, device='cuda:0')
benign distance is  tensor(114.7838, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 535.0125,  536.6603,  517.1115,  539.1724,  515.0009,  551.2628,
         515.4448,  523.3085, 1281.1478, 1276.9601, 1299.1218, 1283.2877,
        1308.1313, 1298.4882, 1300.6007, 1286.0410, 1287.6689, 1316.2764,
        1301.1051, 1307.3546,  537.9850,  516.2579,  530.6555,  525.5992,
         514.7159,  531.6306,  518.9379,  536.7349], device='cuda:0')
sorted_norm is   tensor([ 514.7159,  515.0009,  515.4448,  516.2579,  517.1115,  518.9379,
         523.3085,  525.5992,  530.6555,  531.6306,  535.0125,  536.6603,
         536.7349,  537.9850,  539.1724,  551.2628, 1276.9601, 1281.1478,
        1283.2877, 1286.0410, 1287.6689, 1298.4882, 1299.1218, 1300.6007,
        1301.1051, 1307.3546, 1308.1313, 1316.2764], device='cuda:0')
used idx is  tensor([24,  4,  6, 21,  2, 26,  7, 23, 22, 25,  0,  1, 27, 20,  3,  5,  9,  8,
        11, 15, 16, 13], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 80.14% 

Test Accuracy: 79.05% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9525583982467651
distance x is tensor(138.4073, device='cuda:0')
benign distance is  tensor(138.4073, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2942301630973816
distance x is tensor(134.5553, device='cuda:0')
benign distance is  tensor(134.5553, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2785935699939728
distance x is tensor(136.7635, device='cuda:0')
benign distance is  tensor(136.7635, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40194281935691833
distance x is tensor(135.7108, device='cuda:0')
benign distance is  tensor(135.7108, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6566320657730103
distance x is tensor(132.8026, device='cuda:0')
benign distance is  tensor(132.8026, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5531156063079834
distance x is tensor(138.0988, device='cuda:0')
benign distance is  tensor(138.0988, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35283252596855164
distance x is tensor(134.7287, device='cuda:0')
benign distance is  tensor(134.7287, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6103482246398926
distance x is tensor(138.1251, device='cuda:0')
benign distance is  tensor(138.1251, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.540413498878479
distance x is tensor(141.6483, device='cuda:0')
benign distance is  tensor(141.6483, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6259169578552246
distance x is tensor(129.7246, device='cuda:0')
benign distance is  tensor(129.7246, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.831489086151123
distance x is tensor(135.5234, device='cuda:0')
benign distance is  tensor(135.5234, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5270119309425354
distance x is tensor(138.0938, device='cuda:0')
benign distance is  tensor(138.0938, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5066632032394409
distance x is tensor(131.9177, device='cuda:0')
benign distance is  tensor(131.9177, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4080527722835541
distance x is tensor(132.0485, device='cuda:0')
benign distance is  tensor(132.0485, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6573008298873901
distance x is tensor(134.8834, device='cuda:0')
benign distance is  tensor(134.8834, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6676973104476929
distance x is tensor(136.4088, device='cuda:0')
benign distance is  tensor(136.4088, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 620.7826,  590.5973,  610.5441,  604.5823,  597.4073,  611.5563,
         598.9328,  605.6205, 1069.5768, 1055.1486, 1096.8440, 1094.4327,
        1109.4691, 1088.3158, 1071.4371, 1063.3700, 1118.8195, 1076.0757,
        1093.7006, 1093.3217], device='cuda:0')
sorted_norm is   tensor([ 590.5973,  597.4073,  598.9328,  604.5823,  605.6205,  610.5441,
         611.5563,  620.7826, 1055.1486, 1063.3700, 1069.5768, 1071.4371,
        1076.0757, 1088.3158, 1093.3217, 1093.7006, 1094.4327, 1096.8440,
        1109.4691, 1118.8195], device='cuda:0')
used idx is  tensor([ 1,  4,  6,  3,  7,  2,  5,  0,  9, 15,  8, 14, 17, 13, 19, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.314990520477295
distance x is tensor(37.9474, device='cuda:0')
benign distance is  tensor(37.9474, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5450459718704224
distance x is tensor(32.3613, device='cuda:0')
benign distance is  tensor(32.3613, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4048795700073242
distance x is tensor(43.5207, device='cuda:0')
benign distance is  tensor(43.5207, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3379936218261719
distance x is tensor(30.0388, device='cuda:0')
benign distance is  tensor(30.0388, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.485357642173767
distance x is tensor(32.8172, device='cuda:0')
benign distance is  tensor(32.8172, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5476781129837036
distance x is tensor(35.4845, device='cuda:0')
benign distance is  tensor(35.4845, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2066051959991455
distance x is tensor(35.0810, device='cuda:0')
benign distance is  tensor(35.0810, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.456068754196167
distance x is tensor(34.7112, device='cuda:0')
benign distance is  tensor(34.7112, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([303.2287, 252.9508, 335.5040, 210.3093, 259.4536, 278.0135, 252.8013,
        276.8824, 343.3610, 286.2510, 392.5312, 468.2097, 433.6086, 344.2710,
        356.7116, 347.3052, 430.9983, 402.2160, 382.7338, 375.8146, 814.2980,
        839.6247, 816.9096, 818.3562, 823.0258, 824.0647, 835.4214, 824.8941,
        803.7889, 792.0975, 806.7930, 790.6694, 790.5386, 806.4108, 794.7076,
        800.7537, 846.7449, 866.9659, 872.2375, 871.3033, 841.8383, 849.8146,
        876.1335, 855.4255, 843.7119, 818.9318, 826.6805, 833.9668, 822.1877,
        816.6948, 833.4622, 840.7103], device='cuda:0')
sorted_norm is   tensor([210.3093, 252.8013, 252.9508, 259.4536, 276.8824, 278.0135, 286.2510,
        303.2287, 335.5040, 343.3610, 344.2710, 347.3052, 356.7116, 375.8146,
        382.7338, 392.5312, 402.2160, 430.9983, 433.6086, 468.2097, 790.5386,
        790.6694, 792.0975, 794.7076, 800.7537, 803.7889, 806.4108, 806.7930,
        814.2980, 816.6948, 816.9096, 818.3562, 818.9318, 822.1877, 823.0258,
        824.0647, 824.8941, 826.6805, 833.4622, 833.9668, 835.4214, 839.6247,
        840.7103, 841.8383, 843.7119, 846.7449, 849.8146, 855.4255, 866.9659,
        871.3033, 872.2375, 876.1335], device='cuda:0')
used idx is  tensor([ 3,  6,  1,  4,  7,  5,  9,  0,  2,  8, 13, 15, 14, 19, 18, 10, 17, 16,
        12, 11, 32, 31, 29, 34, 35, 28, 33, 30, 20, 49, 22, 23, 45, 48, 24, 25,
        27, 46, 50, 47, 26], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 79.88% 

Test Accuracy: 79.00% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1707538366317749
distance x is tensor(139.9254, device='cuda:0')
benign distance is  tensor(139.9254, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2608424723148346
distance x is tensor(129.3557, device='cuda:0')
benign distance is  tensor(129.3557, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.49522238969802856
distance x is tensor(134.9201, device='cuda:0')
benign distance is  tensor(134.9201, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.26536399126052856
distance x is tensor(132.4168, device='cuda:0')
benign distance is  tensor(132.4168, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3357403874397278
distance x is tensor(130.6893, device='cuda:0')
benign distance is  tensor(130.6893, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7179007530212402
distance x is tensor(136.3807, device='cuda:0')
benign distance is  tensor(136.3807, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28478264808654785
distance x is tensor(129.6100, device='cuda:0')
benign distance is  tensor(129.6100, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.52735835313797
distance x is tensor(134.9136, device='cuda:0')
benign distance is  tensor(134.9136, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.38556843996047974
distance x is tensor(132.7759, device='cuda:0')
benign distance is  tensor(132.7759, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.46137213706970215
distance x is tensor(128.9298, device='cuda:0')
benign distance is  tensor(128.9298, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4398897588253021
distance x is tensor(134.1592, device='cuda:0')
benign distance is  tensor(134.1592, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.34502628445625305
distance x is tensor(129.2817, device='cuda:0')
benign distance is  tensor(129.2817, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.42089739441871643
distance x is tensor(128.1323, device='cuda:0')
benign distance is  tensor(128.1323, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5384944677352905
distance x is tensor(129.6728, device='cuda:0')
benign distance is  tensor(129.6728, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.655451238155365
distance x is tensor(125.1715, device='cuda:0')
benign distance is  tensor(125.1715, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5690785646438599
distance x is tensor(133.8180, device='cuda:0')
benign distance is  tensor(133.8180, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5211726427078247
distance x is tensor(126.2038, device='cuda:0')
benign distance is  tensor(126.2038, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.602715790271759
distance x is tensor(139.8799, device='cuda:0')
benign distance is  tensor(139.8799, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5061697363853455
distance x is tensor(136.3484, device='cuda:0')
benign distance is  tensor(136.3484, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5486959218978882
distance x is tensor(133.8930, device='cuda:0')
benign distance is  tensor(133.8930, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.48395752906799316
distance x is tensor(123.1304, device='cuda:0')
benign distance is  tensor(123.1304, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.2783912122249603
distance x is tensor(126.6462, device='cuda:0')
benign distance is  tensor(126.6462, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.26859182119369507
distance x is tensor(132.6914, device='cuda:0')
benign distance is  tensor(132.6914, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.43165889382362366
distance x is tensor(127.0388, device='cuda:0')
benign distance is  tensor(127.0388, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.325188547372818
distance x is tensor(137.2218, device='cuda:0')
benign distance is  tensor(137.2218, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5399125814437866
distance x is tensor(126.0767, device='cuda:0')
benign distance is  tensor(126.0767, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.624239981174469
distance x is tensor(131.1729, device='cuda:0')
benign distance is  tensor(131.1729, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.36731550097465515
distance x is tensor(134.1935, device='cuda:0')
benign distance is  tensor(134.1935, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.4386642873287201
distance x is tensor(126.8427, device='cuda:0')
benign distance is  tensor(126.8427, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8275033831596375
distance x is tensor(138.0659, device='cuda:0')
benign distance is  tensor(138.0659, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.37151971459388733
distance x is tensor(126.6618, device='cuda:0')
benign distance is  tensor(126.6618, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3517109453678131
distance x is tensor(127.4077, device='cuda:0')
benign distance is  tensor(127.4077, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4457644820213318
distance x is tensor(134.7726, device='cuda:0')
benign distance is  tensor(134.7726, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.25318458676338196
distance x is tensor(135.3970, device='cuda:0')
benign distance is  tensor(135.3970, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.5374354720115662
distance x is tensor(128.7869, device='cuda:0')
benign distance is  tensor(128.7869, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4849192500114441
distance x is tensor(132.2714, device='cuda:0')
benign distance is  tensor(132.2714, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.19170933961868286
distance x is tensor(125.0299, device='cuda:0')
benign distance is  tensor(125.0299, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.25190165638923645
distance x is tensor(135.2257, device='cuda:0')
benign distance is  tensor(135.2257, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.3282347321510315
distance x is tensor(132.1443, device='cuda:0')
benign distance is  tensor(132.1443, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2945733070373535
distance x is tensor(134.5772, device='cuda:0')
benign distance is  tensor(134.5772, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 618.6515,  573.1979,  590.3483,  590.3278,  590.9650,  608.4304,
         579.0564,  597.8054, 1112.0637, 1094.8904, 1118.3275, 1098.8248,
        1123.4019, 1122.0000, 1101.3433, 1114.6188, 1105.1023, 1106.6888,
        1130.3463, 1146.9550], device='cuda:0')
sorted_norm is   tensor([ 573.1979,  579.0564,  590.3278,  590.3483,  590.9650,  597.8054,
         608.4304,  618.6515, 1094.8904, 1098.8248, 1101.3433, 1105.1023,
        1106.6888, 1112.0637, 1114.6188, 1118.3275, 1122.0000, 1123.4019,
        1130.3463, 1146.9550], device='cuda:0')
used idx is  tensor([ 1,  6,  3,  2,  4,  7,  5,  0,  9, 11, 14, 16, 17,  8, 15, 10],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 10.33% 

Test Accuracy: 10.00% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1034201383590698
distance x is tensor(39.8888, device='cuda:0')
benign distance is  tensor(39.8888, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3938242197036743
distance x is tensor(45.3309, device='cuda:0')
benign distance is  tensor(45.3309, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2455313205718994
distance x is tensor(44.4938, device='cuda:0')
benign distance is  tensor(44.4938, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.385565161705017
distance x is tensor(39.3219, device='cuda:0')
benign distance is  tensor(39.3219, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2043192386627197
distance x is tensor(45.0979, device='cuda:0')
benign distance is  tensor(45.0979, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3760707378387451
distance x is tensor(45.9442, device='cuda:0')
benign distance is  tensor(45.9442, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1149638891220093
distance x is tensor(45.8756, device='cuda:0')
benign distance is  tensor(45.8756, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.71038019657135
distance x is tensor(38.4714, device='cuda:0')
benign distance is  tensor(38.4714, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([306.1736, 348.8729, 344.5895, 318.5893, 333.4616, 360.3557, 344.2384,
        297.8076, 422.7362, 424.3175, 466.4880, 501.5828, 423.1186, 371.9135,
        461.2854, 445.7390, 448.6823, 461.3122, 388.0162, 438.4545, 885.9827,
        885.8457, 883.2798, 852.8145, 878.0735, 862.6928, 873.8870, 865.0322,
        841.2675, 827.7346, 843.1068, 826.6956, 830.5898, 828.0338, 813.4991,
        852.2080], device='cuda:0')
sorted_norm is   tensor([297.8076, 306.1736, 318.5893, 333.4616, 344.2384, 344.5895, 348.8729,
        360.3557, 371.9135, 388.0162, 422.7362, 423.1186, 424.3175, 438.4545,
        445.7390, 448.6823, 461.2854, 461.3122, 466.4880, 501.5828, 813.4991,
        826.6956, 827.7346, 828.0338, 830.5898, 841.2675, 843.1068, 852.2080,
        852.8145, 862.6928, 865.0322, 873.8870, 878.0735, 883.2798, 885.8457,
        885.9827], device='cuda:0')
used idx is  tensor([ 7,  0,  3,  4,  6,  2,  1,  5, 13, 18,  8, 12,  9, 19, 15, 16, 14, 17,
        10, 11, 34, 31, 29, 33, 32, 28, 30, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 20.10% 

Test Accuracy: 20.26% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 20.10%
|----0th round Training Accuracy : 9.86%
|----1th round Training Accuracy : 10.20%
|----2th round Training Accuracy : 10.20%
|----3th round Training Accuracy : 59.99%
|----4th round Training Accuracy : 9.86%
|----5th round Training Accuracy : 10.20%
|----6th round Training Accuracy : 10.20%
|----7th round Training Accuracy : 43.58%
|----8th round Training Accuracy : 64.63%
|----9th round Training Accuracy : 17.78%
|----10th round Training Accuracy : 10.20%
|----11th round Training Accuracy : 73.12%
|----12th round Training Accuracy : 9.86%
|----13th round Training Accuracy : 9.73%
|----14th round Training Accuracy : 76.93%
|----15th round Training Accuracy : 75.93%
|----16th round Training Accuracy : 9.86%
|----17th round Training Accuracy : 67.30%
|----18th round Training Accuracy : 9.86%
|----19th round Training Accuracy : 70.07%
|----20th round Training Accuracy : 72.89%
|----21th round Training Accuracy : 72.23%
|----22th round Training Accuracy : 9.71%
|----23th round Training Accuracy : 78.21%
|----24th round Training Accuracy : 76.17%
|----25th round Training Accuracy : 74.38%
|----26th round Training Accuracy : 76.28%
|----27th round Training Accuracy : 83.87%
|----28th round Training Accuracy : 9.90%
|----29th round Training Accuracy : 77.74%
|----30th round Training Accuracy : 9.86%
|----31th round Training Accuracy : 20.96%
|----32th round Training Accuracy : 72.82%
|----33th round Training Accuracy : 78.77%
|----34th round Training Accuracy : 78.48%
|----35th round Training Accuracy : 84.04%
|----36th round Training Accuracy : 9.86%
|----37th round Training Accuracy : 9.86%
|----38th round Training Accuracy : 19.65%
|----39th round Training Accuracy : 82.67%
|----40th round Training Accuracy : 10.20%
|----41th round Training Accuracy : 70.76%
|----42th round Training Accuracy : 9.86%
|----43th round Training Accuracy : 50.15%
|----44th round Training Accuracy : 84.74%
|----45th round Training Accuracy : 80.14%
|----46th round Training Accuracy : 9.71%
|----47th round Training Accuracy : 79.88%
|----48th round Training Accuracy : 10.33%
|----49th round Training Accuracy : 20.10%
|----Final Test Accuracy: 20.26%
|----0th round Final Test Accuracy : 10.00%
|----1th round Final Test Accuracy : 10.00%
|----2th round Final Test Accuracy : 10.00%
|----3th round Final Test Accuracy : 58.94%
|----4th round Final Test Accuracy : 10.00%
|----5th round Final Test Accuracy : 10.00%
|----6th round Final Test Accuracy : 10.00%
|----7th round Final Test Accuracy : 43.42%
|----8th round Final Test Accuracy : 63.70%
|----9th round Final Test Accuracy : 17.16%
|----10th round Final Test Accuracy : 10.00%
|----11th round Final Test Accuracy : 72.30%
|----12th round Final Test Accuracy : 10.00%
|----13th round Final Test Accuracy : 10.00%
|----14th round Final Test Accuracy : 76.04%
|----15th round Final Test Accuracy : 74.89%
|----16th round Final Test Accuracy : 10.00%
|----17th round Final Test Accuracy : 66.48%
|----18th round Final Test Accuracy : 10.00%
|----19th round Final Test Accuracy : 68.91%
|----20th round Final Test Accuracy : 72.00%
|----21th round Final Test Accuracy : 71.56%
|----22th round Final Test Accuracy : 10.00%
|----23th round Final Test Accuracy : 77.63%
|----24th round Final Test Accuracy : 75.35%
|----25th round Final Test Accuracy : 73.59%
|----26th round Final Test Accuracy : 75.36%
|----27th round Final Test Accuracy : 83.16%
|----28th round Final Test Accuracy : 10.00%
|----29th round Final Test Accuracy : 76.95%
|----30th round Final Test Accuracy : 10.00%
|----31th round Final Test Accuracy : 21.43%
|----32th round Final Test Accuracy : 71.98%
|----33th round Final Test Accuracy : 78.00%
|----34th round Final Test Accuracy : 77.76%
|----35th round Final Test Accuracy : 83.51%
|----36th round Final Test Accuracy : 10.00%
|----37th round Final Test Accuracy : 10.00%
|----38th round Final Test Accuracy : 19.88%
|----39th round Final Test Accuracy : 82.00%
|----40th round Final Test Accuracy : 10.00%
|----41th round Final Test Accuracy : 70.20%
|----42th round Final Test Accuracy : 10.00%
|----43th round Final Test Accuracy : 49.84%
|----44th round Final Test Accuracy : 83.62%
|----45th round Final Test Accuracy : 79.05%
|----46th round Final Test Accuracy : 10.00%
|----47th round Final Test Accuracy : 79.00%
|----48th round Final Test Accuracy : 10.00%
|----49th round Final Test Accuracy : 20.26%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!


 Total Run Time: 3101.9626
